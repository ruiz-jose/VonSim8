var c7=Object.defineProperty;var dP=t=>{throw TypeError(t)};var u7=(t,e,n)=>e in t?c7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var be=(t,e,n)=>u7(t,typeof e!="symbol"?e+"":e,n),O1=(t,e,n)=>e.has(t)||dP("Cannot "+n);var N=(t,e,n)=>(O1(t,e,"read from private field"),n?n.call(t):e.get(t)),Ue=(t,e,n)=>e.has(t)?dP("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),ie=(t,e,n,i)=>(O1(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),zt=(t,e,n)=>(O1(t,e,"access private method"),n);function d7(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var f7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function du(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var T4={exports:{}},rb={},O4={exports:{}},wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wm=Symbol.for("react.element"),h7=Symbol.for("react.portal"),p7=Symbol.for("react.fragment"),m7=Symbol.for("react.strict_mode"),g7=Symbol.for("react.profiler"),v7=Symbol.for("react.provider"),y7=Symbol.for("react.context"),b7=Symbol.for("react.forward_ref"),x7=Symbol.for("react.suspense"),w7=Symbol.for("react.memo"),S7=Symbol.for("react.lazy"),fP=Symbol.iterator;function k7(t){return t===null||typeof t!="object"?null:(t=fP&&t[fP]||t["@@iterator"],typeof t=="function"?t:null)}var L4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D4=Object.assign,j4={};function Sf(t,e,n){this.props=t,this.context=e,this.refs=j4,this.updater=n||L4}Sf.prototype.isReactComponent={};Sf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Sf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function B4(){}B4.prototype=Sf.prototype;function EC(t,e,n){this.props=t,this.context=e,this.refs=j4,this.updater=n||L4}var AC=EC.prototype=new B4;AC.constructor=EC;D4(AC,Sf.prototype);AC.isPureReactComponent=!0;var hP=Array.isArray,$4=Object.prototype.hasOwnProperty,PC={current:null},F4={key:!0,ref:!0,__self:!0,__source:!0};function z4(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)$4.call(e,i)&&!F4.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:wm,type:t,key:s,ref:o,props:r,_owner:PC.current}}function C7(t,e){return{$$typeof:wm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function NC(t){return typeof t=="object"&&t!==null&&t.$$typeof===wm}function _7(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var pP=/\/+/g;function L1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?_7(""+t.key):e.toString(36)}function N0(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case wm:case h7:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+L1(o,0):i,hP(r)?(n="",t!=null&&(n=t.replace(pP,"$&/")+"/"),N0(r,e,n,"",function(c){return c})):r!=null&&(NC(r)&&(r=C7(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(pP,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",hP(t))for(var a=0;a<t.length;a++){s=t[a];var l=i+L1(s,a);o+=N0(s,e,n,l,r)}else if(l=k7(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=i+L1(s,a++),o+=N0(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Qm(t,e,n){if(t==null)return t;var i=[],r=0;return N0(t,i,"","",function(s){return e.call(n,s,r++)}),i}function E7(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $i={current:null},M0={transition:null},A7={ReactCurrentDispatcher:$i,ReactCurrentBatchConfig:M0,ReactCurrentOwner:PC};function U4(){throw Error("act(...) is not supported in production builds of React.")}wt.Children={map:Qm,forEach:function(t,e,n){Qm(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Qm(t,function(){e++}),e},toArray:function(t){return Qm(t,function(e){return e})||[]},only:function(t){if(!NC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};wt.Component=Sf;wt.Fragment=p7;wt.Profiler=g7;wt.PureComponent=EC;wt.StrictMode=m7;wt.Suspense=x7;wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A7;wt.act=U4;wt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=D4({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=PC.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)$4.call(e,l)&&!F4.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];i.children=a}return{$$typeof:wm,type:t.type,key:r,ref:s,props:i,_owner:o}};wt.createContext=function(t){return t={$$typeof:y7,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:v7,_context:t},t.Consumer=t};wt.createElement=z4;wt.createFactory=function(t){var e=z4.bind(null,t);return e.type=t,e};wt.createRef=function(){return{current:null}};wt.forwardRef=function(t){return{$$typeof:b7,render:t}};wt.isValidElement=NC;wt.lazy=function(t){return{$$typeof:S7,_payload:{_status:-1,_result:t},_init:E7}};wt.memo=function(t,e){return{$$typeof:w7,type:t,compare:e===void 0?null:e}};wt.startTransition=function(t){var e=M0.transition;M0.transition={};try{t()}finally{M0.transition=e}};wt.unstable_act=U4;wt.useCallback=function(t,e){return $i.current.useCallback(t,e)};wt.useContext=function(t){return $i.current.useContext(t)};wt.useDebugValue=function(){};wt.useDeferredValue=function(t){return $i.current.useDeferredValue(t)};wt.useEffect=function(t,e){return $i.current.useEffect(t,e)};wt.useId=function(){return $i.current.useId()};wt.useImperativeHandle=function(t,e,n){return $i.current.useImperativeHandle(t,e,n)};wt.useInsertionEffect=function(t,e){return $i.current.useInsertionEffect(t,e)};wt.useLayoutEffect=function(t,e){return $i.current.useLayoutEffect(t,e)};wt.useMemo=function(t,e){return $i.current.useMemo(t,e)};wt.useReducer=function(t,e,n){return $i.current.useReducer(t,e,n)};wt.useRef=function(t){return $i.current.useRef(t)};wt.useState=function(t){return $i.current.useState(t)};wt.useSyncExternalStore=function(t,e,n){return $i.current.useSyncExternalStore(t,e,n)};wt.useTransition=function(){return $i.current.useTransition()};wt.version="18.3.1";O4.exports=wt;var x=O4.exports;const en=du(x),sb=d7({__proto__:null,default:en},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P7=x,N7=Symbol.for("react.element"),M7=Symbol.for("react.fragment"),R7=Object.prototype.hasOwnProperty,I7=P7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,T7={key:!0,ref:!0,__self:!0,__source:!0};function V4(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)R7.call(e,i)&&!T7.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:N7,type:t,key:s,ref:o,props:r,_owner:I7.current}}rb.Fragment=M7;rb.jsx=V4;rb.jsxs=V4;T4.exports=rb;var h=T4.exports,J=typeof window<"u"?window:void 0,sr=typeof globalThis<"u"?globalThis:J,H4=Array.prototype,mP=H4.forEach,gP=H4.indexOf,Cr=sr==null?void 0:sr.navigator,Me=sr==null?void 0:sr.document,tr=sr==null?void 0:sr.location,Hw=sr==null?void 0:sr.fetch,Ww=sr!=null&&sr.XMLHttpRequest&&"withCredentials"in new sr.XMLHttpRequest?sr.XMLHttpRequest:void 0,vP=sr==null?void 0:sr.AbortController,Qi=Cr==null?void 0:Cr.userAgent,st=J??{},Uo={DEBUG:!1,LIB_VERSION:"1.256.2"},D1="$copy_autocapture",O7=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"],ta=function(t){return t.GZipJS="gzip-js",t.Base64="base64",t}({}),L7=["fatal","error","warning","log","info","debug"];function xt(t,e){return t.indexOf(e)!==-1}var ob=function(t){return t.trim()},Gw=function(t){return t.replace(/^\$/,"")},D7=Array.isArray,W4=Object.prototype,G4=W4.hasOwnProperty,ab=W4.toString,ln=D7||function(t){return ab.call(t)==="[object Array]"},ts=t=>typeof t=="function",wn=t=>t===Object(t)&&!ln(t),Hu=t=>{if(wn(t)){for(var e in t)if(G4.call(t,e))return!1;return!0}return!1},Se=t=>t===void 0,Sn=t=>ab.call(t)=="[object String]",Xw=t=>Sn(t)&&t.trim().length===0,Xl=t=>t===null,Dt=t=>Se(t)||Xl(t),wi=t=>ab.call(t)=="[object Number]",fo=t=>ab.call(t)==="[object Boolean]",j7=t=>t instanceof FormData,B7=t=>xt(O7,t),X4=t=>{var e={t:function(n){if(J&&(Uo.DEBUG||st.POSTHOG_DEBUG)&&!Se(J.console)&&J.console){for(var i=("__rrweb_original__"in J.console[n])?J.console[n].__rrweb_original__:J.console[n],r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];i(t,...s)}},info:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];e.t("log",...i)},warn:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];e.t("warn",...i)},error:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];e.t("error",...i)},critical:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];console.error(t,...i)},uninitializedWarning:n=>{e.error("You must initialize PostHog before calling "+n)},createLogger:n=>X4(t+" "+n)};return e},Ie=X4("[PostHog.js]"),qn=Ie.createLogger,$7=qn("[ExternalScriptsLoader]"),yP=(t,e,n)=>{if(t.config.disable_external_dependency_loading)return $7.warn(e+" was requested but loading of external scripts is disabled."),n("Loading of external scripts is disabled");var i=Me==null?void 0:Me.querySelectorAll("script");if(i){for(var r=0;r<i.length;r++)if(i[r].src===e)return n()}var s=()=>{if(!Me)return n("document not found");var o=Me.createElement("script");if(o.type="text/javascript",o.crossOrigin="anonymous",o.src=e,o.onload=c=>n(void 0,c),o.onerror=c=>n(c),t.config.prepare_external_dependency_script&&(o=t.config.prepare_external_dependency_script(o)),!o)return n("prepare_external_dependency_script returned null");var a,l=Me.querySelectorAll("body > script");l.length>0?(a=l[0].parentNode)==null||a.insertBefore(o,l[0]):Me.body.appendChild(o)};Me!=null&&Me.body?s():Me==null||Me.addEventListener("DOMContentLoaded",s)};function Ae(){return Ae=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Ae.apply(null,arguments)}function q4(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)!==-1)continue;n[i]=t[i]}return n}st.__PosthogExtensions__=st.__PosthogExtensions__||{},st.__PosthogExtensions__.loadExternalDependency=(t,e,n)=>{var i="/static/"+e+".js?v="+t.version;if(e==="remote-config"&&(i="/array/"+t.config.token+"/config.js"),e==="toolbar"){var r=3e5;i=i+"&t="+Math.floor(Date.now()/r)*r}var s=t.requestRouter.endpointFor("assets",i);yP(t,s,n)},st.__PosthogExtensions__.loadSiteApp=(t,e,n)=>{var i=t.requestRouter.endpointFor("api",e);yP(t,i,n)};var gv={};function pl(t,e,n){if(ln(t)){if(mP&&t.forEach===mP)t.forEach(e,n);else if("length"in t&&t.length===+t.length){for(var i=0,r=t.length;i<r;i++)if(i in t&&e.call(n,t[i],i)===gv)return}}}function Ut(t,e,n){if(!Dt(t)){if(ln(t))return pl(t,e,n);if(j7(t)){for(var i of t.entries())if(e.call(n,i[1],i[0])===gv)return}else for(var r in t)if(G4.call(t,r)&&e.call(n,t[r],r)===gv)return}}var An=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return pl(n,function(r){for(var s in r)r[s]!==void 0&&(t[s]=r[s])}),t},lb=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return pl(n,function(r){pl(r,function(s){t.push(s)})}),t};function R0(t){for(var e=Object.keys(t),n=e.length,i=new Array(n);n--;)i[n]=[e[n],t[e[n]]];return i}var bP=function(t){try{return t()}catch{return}},F7=function(t){return function(){try{for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,n)}catch(r){Ie.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),Ie.critical(r)}}},MC=function(t){var e={};return Ut(t,function(n,i){(Sn(n)&&n.length>0||wi(n))&&(e[i]=n)}),e};function z7(t,e){return n=t,i=s=>Sn(s)&&!Xl(e)?s.slice(0,e):s,r=new Set,function s(o,a){return o!==Object(o)?i?i(o,a):o:r.has(o)?void 0:(r.add(o),ln(o)?(l=[],pl(o,c=>{l.push(s(c))})):(l={},Ut(o,(c,u)=>{r.has(c)||(l[u]=s(c,u))})),l);var l}(n);var n,i,r}var U7=["herokuapp.com","vercel.app","netlify.app"];function V7(t){var e=t==null?void 0:t.hostname;if(!Sn(e))return!1;var n=e.split(".").slice(-2).join(".");for(var i of U7)if(n===i)return!1;return!0}function K4(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return t[n]}function pn(t,e,n,i){var{capture:r=!1,passive:s=!0}=i??{};t==null||t.addEventListener(e,n,{capture:r,passive:s})}var Y4="$people_distinct_id",ch="__alias",uh="__timers",xP="$autocapture_disabled_server_side",qw="$heatmaps_enabled_server_side",wP="$exception_capture_enabled_server_side",Kw="$error_tracking_suppression_rules",SP="$web_vitals_enabled_server_side",J4="$dead_clicks_enabled_server_side",kP="$web_vitals_allowed_metrics",Yw="$session_recording_enabled_server_side",CP="$console_log_recording_enabled_server_side",_P="$session_recording_network_payload_capture",EP="$session_recording_masking",AP="$session_recording_canvas_recording",PP="$replay_sample_rate",NP="$replay_minimum_duration",MP="$replay_script_config",vv="$sesid",dh="$session_is_sampled",Jw="$session_recording_url_trigger_activated_session",Zw="$session_recording_event_trigger_activated_session",Wu="$enabled_feature_flags",I0="$early_access_features",Qw="$feature_flag_details",fh="$stored_person_properties",xc="$stored_group_properties",eS="$surveys",eg="$surveys_activated",yv="$flag_call_reported",Bo="$user_state",tS="$client_session_props",nS="$capture_rate_limit",iS="$initial_campaign_params",rS="$initial_referrer_info",bv="$initial_person_info",xv="$epp",Z4="__POSTHOG_TOOLBAR__",tg="$posthog_cookieless",H7=[Y4,ch,"__cmpns",uh,Yw,qw,vv,Wu,Kw,Bo,I0,Qw,xc,fh,eS,yv,tS,nS,iS,rS,xv,bv];function RP(t){return t instanceof Element&&(t.id===Z4||!(t.closest==null||!t.closest(".toolbar-global-fade-container")))}function cb(t){return!!t&&t.nodeType===1}function ml(t,e){return!!t&&!!t.tagName&&t.tagName.toLowerCase()===e.toLowerCase()}function Q4(t){return!!t&&t.nodeType===3}function eO(t){return!!t&&t.nodeType===11}function RC(t){return t?ob(t).split(/\s+/):[]}function IP(t){var e=J==null?void 0:J.location.href;return!!(e&&t&&t.some(n=>e.match(n)))}function wv(t){var e="";switch(typeof t.className){case"string":e=t.className;break;case"object":e=(t.className&&"baseVal"in t.className?t.className.baseVal:null)||t.getAttribute("class")||"";break;default:e=""}return RC(e)}function tO(t){return Dt(t)?null:ob(t).split(/(\s+)/).filter(e=>$d(e)).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function ub(t){var e="";return oS(t)&&!rO(t)&&t.childNodes&&t.childNodes.length&&Ut(t.childNodes,function(n){var i;Q4(n)&&n.textContent&&(e+=(i=tO(n.textContent))!==null&&i!==void 0?i:"")}),ob(e)}function nO(t){return Se(t.target)?t.srcElement||null:(e=t.target)!=null&&e.shadowRoot?t.composedPath()[0]||null:t.target||null;var e}var sS=["a","button","form","input","select","textarea","label"];function iO(t){var e=t.parentNode;return!(!e||!cb(e))&&e}function W7(t,e,n,i,r){var s,o,a;if(n===void 0&&(n=void 0),!J||!t||ml(t,"html")||!cb(t)||(s=n)!=null&&s.url_allowlist&&!IP(n.url_allowlist)||(o=n)!=null&&o.url_ignorelist&&IP(n.url_ignorelist))return!1;if((a=n)!=null&&a.dom_event_allowlist){var l=n.dom_event_allowlist;if(l&&!l.some(y=>e.type===y))return!1}for(var c=!1,u=[t],d=!0,f=t;f.parentNode&&!ml(f,"body");)if(eO(f.parentNode))u.push(f.parentNode.host),f=f.parentNode.host;else{if(!(d=iO(f)))break;if(i||sS.indexOf(d.tagName.toLowerCase())>-1)c=!0;else{var p=J.getComputedStyle(d);p&&p.getPropertyValue("cursor")==="pointer"&&(c=!0)}u.push(d),f=d}if(!function(y,v){var b=v==null?void 0:v.element_allowlist;if(Se(b))return!0;var w,k=function(E){if(b.some(_=>E.tagName.toLowerCase()===_))return{v:!0}};for(var C of y)if(w=k(C))return w.v;return!1}(u,n)||!function(y,v){var b=v==null?void 0:v.css_selector_allowlist;if(Se(b))return!0;var w,k=function(E){if(b.some(_=>E.matches(_)))return{v:!0}};for(var C of y)if(w=k(C))return w.v;return!1}(u,n))return!1;var m=J.getComputedStyle(t);if(m&&m.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var g=t.tagName.toLowerCase();switch(g){case"html":return!1;case"form":return(r||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(r||["change","click"]).indexOf(e.type)>=0;default:return c?(r||["click"]).indexOf(e.type)>=0:(r||["click"]).indexOf(e.type)>=0&&(sS.indexOf(g)>-1||t.getAttribute("contenteditable")==="true")}}function oS(t){for(var e=t;e.parentNode&&!ml(e,"body");e=e.parentNode){var n=wv(e);if(xt(n,"ph-sensitive")||xt(n,"ph-no-capture"))return!1}if(xt(wv(t),"ph-include"))return!0;var i=t.type||"";if(Sn(i))switch(i.toLowerCase()){case"hidden":case"password":return!1}var r=t.name||t.id||"";return!(Sn(r)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(r.replace(/[^a-zA-Z0-9]/g,"")))}function rO(t){return!!(ml(t,"input")&&!["button","checkbox","submit","reset"].includes(t.type)||ml(t,"select")||ml(t,"textarea")||t.getAttribute("contenteditable")==="true")}var sO="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",G7=new RegExp("^(?:"+sO+")$"),X7=new RegExp(sO),oO="\\d{3}-?\\d{2}-?\\d{4}",q7=new RegExp("^("+oO+")$"),K7=new RegExp("("+oO+")");function $d(t,e){return e===void 0&&(e=!0),!(Dt(t)||Sn(t)&&(t=ob(t),(e?G7:X7).test((t||"").replace(/[- ]/g,""))||(e?q7:K7).test(t)))}function aO(t){var e=ub(t);return $d(e=(e+" "+lO(t)).trim())?e:""}function lO(t){var e="";return t&&t.childNodes&&t.childNodes.length&&Ut(t.childNodes,function(n){var i;if(n&&((i=n.tagName)==null?void 0:i.toLowerCase())==="span")try{var r=ub(n);e=(e+" "+r).trim(),n.childNodes&&n.childNodes.length&&(e=(e+" "+lO(n)).trim())}catch(s){Ie.error("[AutoCapture]",s)}}),e}function Y7(t){return function(e){var n=e.map(i=>{var r,s,o="";if(i.tag_name&&(o+=i.tag_name),i.attr_class)for(var a of(i.attr_class.sort(),i.attr_class))o+="."+a.replace(/"/g,"");var l=Ae({},i.text?{text:i.text}:{},{"nth-child":(r=i.nth_child)!==null&&r!==void 0?r:0,"nth-of-type":(s=i.nth_of_type)!==null&&s!==void 0?s:0},i.href?{href:i.href}:{},i.attr_id?{attr_id:i.attr_id}:{},i.attributes),c={};return R0(l).sort((u,d)=>{var[f]=u,[p]=d;return f.localeCompare(p)}).forEach(u=>{var[d,f]=u;return c[TP(d.toString())]=TP(f.toString())}),o+=":",o+=R0(c).map(u=>{var[d,f]=u;return d+'="'+f+'"'}).join("")});return n.join(";")}(function(e){return e.map(n=>{var i,r,s={text:(i=n.$el_text)==null?void 0:i.slice(0,400),tag_name:n.tag_name,href:(r=n.attr__href)==null?void 0:r.slice(0,2048),attr_class:J7(n),attr_id:n.attr__id,nth_child:n.nth_child,nth_of_type:n.nth_of_type,attributes:{}};return R0(n).filter(o=>{var[a]=o;return a.indexOf("attr__")===0}).forEach(o=>{var[a,l]=o;return s.attributes[a]=l}),s})}(t))}function TP(t){return t.replace(/"|\\"/g,'\\"')}function J7(t){var e=t.attr__class;return e?ln(e)?e:RC(e):void 0}let cO=class{constructor(){this.clicks=[]}isRageClick(e,n,i){var r=this.clicks[this.clicks.length-1];if(r&&Math.abs(e-r.x)+Math.abs(n-r.y)<30&&i-r.timestamp<1e3){if(this.clicks.push({x:e,y:n,timestamp:i}),this.clicks.length===3)return!0}else this.clicks=[{x:e,y:n,timestamp:i}];return!1}};var Z7=["localhost","127.0.0.1"],Fd=t=>{var e=Me==null?void 0:Me.createElement("a");return Se(e)?null:(e.href=t,e)},Q7=function(t,e){var n,i;e===void 0&&(e="&");var r=[];return Ut(t,function(s,o){Se(s)||Se(o)||o==="undefined"||(n=encodeURIComponent((a=>a instanceof File)(s)?s.name:s.toString()),i=encodeURIComponent(o),r[r.length]=i+"="+n)}),r.join(e)},Sv=function(t,e){for(var n,i=((t.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),r=0;r<i.length;r++){var s=i[r].split("=");if(s[0]===e){n=s;break}}if(!ln(n)||n.length<2)return"";var o=n[1];try{o=decodeURIComponent(o)}catch{Ie.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},IC=function(t,e,n){if(!t||!e||!e.length)return t;for(var i=t.split("#"),r=i[0]||"",s=i[1],o=r.split("?"),a=o[1],l=o[0],c=(a||"").split("&"),u=[],d=0;d<c.length;d++){var f=c[d].split("=");ln(f)&&(e.includes(f[0])?u.push(f[0]+"="+n):u.push(c[d]))}var p=l;return a!=null&&(p+="?"+u.join("&")),s!=null&&(p+="#"+s),p},kv=function(t,e){var n=t.match(new RegExp(e+"=([^&]*)"));return n?n[1]:null},OP=qn("[AutoCapture]");function j1(t,e){return e.length>t?e.slice(0,t)+"...":e}function eV(t){if(t.previousElementSibling)return t.previousElementSibling;var e=t;do e=e.previousSibling;while(e&&!cb(e));return e}function tV(t,e,n,i){var r=t.tagName.toLowerCase(),s={tag_name:r};sS.indexOf(r)>-1&&!n&&(r.toLowerCase()==="a"||r.toLowerCase()==="button"?s.$el_text=j1(1024,aO(t)):s.$el_text=j1(1024,ub(t)));var o=wv(t);o.length>0&&(s.classes=o.filter(function(u){return u!==""})),Ut(t.attributes,function(u){var d;if((!rO(t)||["name","id","class","aria-label"].indexOf(u.name)!==-1)&&(i==null||!i.includes(u.name))&&!e&&$d(u.value)&&(d=u.name,!Sn(d)||d.substring(0,10)!=="_ngcontent"&&d.substring(0,7)!=="_nghost")){var f=u.value;u.name==="class"&&(f=RC(f).join(" ")),s["attr__"+u.name]=j1(1024,f)}});for(var a=1,l=1,c=t;c=eV(c);)a++,c.tagName===t.tagName&&l++;return s.nth_child=a,s.nth_of_type=l,s}function nV(t,e){for(var n,i,{e:r,maskAllElementAttributes:s,maskAllText:o,elementAttributeIgnoreList:a,elementsChainAsString:l}=e,c=[t],u=t;u.parentNode&&!ml(u,"body");)eO(u.parentNode)?(c.push(u.parentNode.host),u=u.parentNode.host):(c.push(u.parentNode),u=u.parentNode);var d,f=[],p={},m=!1,g=!1;if(Ut(c,k=>{var C=oS(k);k.tagName.toLowerCase()==="a"&&(m=k.getAttribute("href"),m=C&&m&&$d(m)&&m),xt(wv(k),"ph-no-capture")&&(g=!0),f.push(tV(k,s,o,a));var E=function(_){if(!oS(_))return{};var M={};return Ut(_.attributes,function(R){if(R.name&&R.name.indexOf("data-ph-capture-attribute")===0){var T=R.name.replace("data-ph-capture-attribute-",""),L=R.value;T&&L&&$d(L)&&(M[T]=L)}}),M}(k);An(p,E)}),g)return{props:{},explicitNoCapture:g};if(o||(t.tagName.toLowerCase()==="a"||t.tagName.toLowerCase()==="button"?f[0].$el_text=aO(t):f[0].$el_text=ub(t)),m){var y,v;f[0].attr__href=m;var b=(y=Fd(m))==null?void 0:y.host,w=J==null||(v=J.location)==null?void 0:v.host;b&&w&&b!==w&&(d=m)}return{props:An({$event_type:r.type,$ce_version:1},l?{}:{$elements:f},{$elements_chain:Y7(f)},(n=f[0])!=null&&n.$el_text?{$el_text:(i=f[0])==null?void 0:i.$el_text}:{},d&&r.type==="click"?{$external_click_url:d}:{},p)}}let iV=class{constructor(e){this.i=!1,this.o=null,this.rageclicks=new cO,this.h=!1,this.instance=e,this.m=null}get S(){var e,n,i=wn(this.instance.config.autocapture)?this.instance.config.autocapture:{};return i.url_allowlist=(e=i.url_allowlist)==null?void 0:e.map(r=>new RegExp(r)),i.url_ignorelist=(n=i.url_ignorelist)==null?void 0:n.map(r=>new RegExp(r)),i}$(){if(this.isBrowserSupported()){if(J&&Me){var e=i=>{i=i||(J==null?void 0:J.event);try{this.k(i)}catch(r){OP.error("Failed to capture event",r)}};if(pn(Me,"submit",e,{capture:!0}),pn(Me,"change",e,{capture:!0}),pn(Me,"click",e,{capture:!0}),this.S.capture_copied_text){var n=i=>{i=i||(J==null?void 0:J.event),this.k(i,D1)};pn(Me,"copy",n,{capture:!0}),pn(Me,"cut",n,{capture:!0})}}}else OP.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.i&&(this.$(),this.i=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.h=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[xP]:!!e.autocapture_opt_out}),this.o=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.m=e}getElementSelectors(e){var n,i=[];return(n=this.m)==null||n.forEach(r=>{var s=Me==null?void 0:Me.querySelectorAll(r);s==null||s.forEach(o=>{e===o&&i.push(r)})}),i}get isEnabled(){var e,n,i=(e=this.instance.persistence)==null?void 0:e.props[xP],r=this.o;if(Xl(r)&&!fo(i)&&!this.instance.I())return!1;var s=(n=this.o)!==null&&n!==void 0?n:!!i;return!!this.instance.config.autocapture&&!s}k(e,n){if(n===void 0&&(n="$autocapture"),this.isEnabled){var i,r=nO(e);Q4(r)&&(r=r.parentNode||null),n==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(i=this.rageclicks)!=null&&i.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.k(e,"$rageclick");var s=n===D1;if(r&&W7(r,e,this.S,s,s?["copy","cut"]:void 0)){var{props:o,explicitNoCapture:a}=nV(r,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.S.element_attribute_ignorelist,elementsChainAsString:this.h});if(a)return!1;var l=this.getElementSelectors(r);if(l&&l.length>0&&(o.$element_selectors=l),n===D1){var c,u=tO(J==null||(c=J.getSelection())==null?void 0:c.toString()),d=e.type||"clipboard";if(!u)return!1;o.$selected_content=u,o.$copy_type=d}return this.instance.capture(n,o),!0}}}isBrowserSupported(){return ts(Me==null?void 0:Me.querySelectorAll)}};Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Number.isInteger||(Number.isInteger=function(t){return wi(t)&&isFinite(t)&&Math.floor(t)===t});var LP="0123456789abcdef";let rV=class aS{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,n,i,r){if(!Number.isInteger(e)||!Number.isInteger(n)||!Number.isInteger(i)||!Number.isInteger(r)||e<0||n<0||i<0||r<0||e>0xffffffffffff||n>4095||i>1073741823||r>4294967295)throw new RangeError("invalid field value");var s=new Uint8Array(16);return s[0]=e/Math.pow(2,40),s[1]=e/Math.pow(2,32),s[2]=e/Math.pow(2,24),s[3]=e/Math.pow(2,16),s[4]=e/Math.pow(2,8),s[5]=e,s[6]=112|n>>>8,s[7]=n,s[8]=128|i>>>24,s[9]=i>>>16,s[10]=i>>>8,s[11]=i,s[12]=r>>>24,s[13]=r>>>16,s[14]=r>>>8,s[15]=r,new aS(s)}toString(){for(var e="",n=0;n<this.bytes.length;n++)e=e+LP.charAt(this.bytes[n]>>>4)+LP.charAt(15&this.bytes[n]),n!==3&&n!==5&&n!==7&&n!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new aS(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var n=0;n<16;n++){var i=this.bytes[n]-e.bytes[n];if(i!==0)return Math.sign(i)}return 0}},sV=class{constructor(){this.P=0,this.R=0,this.T=new oV}generate(){var e=this.generateOrAbort();if(Se(e)){this.P=0;var n=this.generateOrAbort();if(Se(n))throw new Error("Could not generate UUID after timestamp reset");return n}return e}generateOrAbort(){var e=Date.now();if(e>this.P)this.P=e,this.M();else{if(!(e+1e4>this.P))return;this.R++,this.R>4398046511103&&(this.P++,this.M())}return rV.fromFieldsV7(this.P,Math.trunc(this.R/Math.pow(2,30)),this.R&Math.pow(2,30)-1,this.T.nextUint32())}M(){this.R=1024*this.T.nextUint32()+(1023&this.T.nextUint32())}};var DP,uO=t=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<t.length;e++)t[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return t};J&&!Se(J.crypto)&&crypto.getRandomValues&&(uO=t=>crypto.getRandomValues(t));let oV=class{constructor(){this.C=new Uint32Array(8),this.F=1/0}nextUint32(){return this.F>=this.C.length&&(uO(this.C),this.F=0),this.C[this.F++]}};var nl=()=>aV().toString(),aV=()=>(DP||(DP=new sV)).generate(),jf="",lV=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function cV(t,e){if(e){var n=function(r,s){if(s===void 0&&(s=Me),jf)return jf;if(!s||["localhost","127.0.0.1"].includes(r))return"";for(var o=r.split("."),a=Math.min(o.length,8),l="dmn_chk_"+nl();!jf&&a--;){var c=o.slice(a).join("."),u=l+"=1;domain=."+c+";path=/";s.cookie=u+";max-age=3",s.cookie.includes(l)&&(s.cookie=u+";max-age=0",jf=c)}return jf}(t);if(!n){var i=(r=>{var s=r.match(lV);return s?s[0]:""})(t);i!==n&&Ie.info("Warning: cookie subdomain discovery mismatch",i,n),n=i}return n?"; domain=."+n:""}return""}var xo={O:()=>!!Me,A:function(t){Ie.error("cookieStore error: "+t)},D:function(t){if(Me){try{for(var e=t+"=",n=Me.cookie.split(";").filter(s=>s.length),i=0;i<n.length;i++){for(var r=n[i];r.charAt(0)==" ";)r=r.substring(1,r.length);if(r.indexOf(e)===0)return decodeURIComponent(r.substring(e.length,r.length))}}catch{}return null}},L:function(t){var e;try{e=JSON.parse(xo.D(t))||{}}catch{}return e},j:function(t,e,n,i,r){if(Me)try{var s="",o="",a=cV(Me.location.hostname,i);if(n){var l=new Date;l.setTime(l.getTime()+24*n*60*60*1e3),s="; expires="+l.toUTCString()}r&&(o="; secure");var c=t+"="+encodeURIComponent(JSON.stringify(e))+s+"; SameSite=Lax; path=/"+a+o;return c.length>3686.4&&Ie.warn("cookieStore warning: large cookie, len="+c.length),Me.cookie=c,c}catch{return}},N:function(t,e){try{xo.j(t,"",-1,e)}catch{return}}},B1=null,jn={O:function(){if(!Xl(B1))return B1;var t=!0;if(Se(J))t=!1;else try{var e="__mplssupport__";jn.j(e,"xyz"),jn.D(e)!=='"xyz"'&&(t=!1),jn.N(e)}catch{t=!1}return t||Ie.error("localStorage unsupported; falling back to cookie store"),B1=t,t},A:function(t){Ie.error("localStorage error: "+t)},D:function(t){try{return J==null?void 0:J.localStorage.getItem(t)}catch(e){jn.A(e)}return null},L:function(t){try{return JSON.parse(jn.D(t))||{}}catch{}return null},j:function(t,e){try{J==null||J.localStorage.setItem(t,JSON.stringify(e))}catch(n){jn.A(n)}},N:function(t){try{J==null||J.localStorage.removeItem(t)}catch(e){jn.A(e)}}},uV=["distinct_id",vv,dh,xv,bv],ng=Ae({},jn,{L:function(t){try{var e={};try{e=xo.L(t)||{}}catch{}var n=An(e,JSON.parse(jn.D(t)||"{}"));return jn.j(t,n),n}catch{}return null},j:function(t,e,n,i,r,s){try{jn.j(t,e,void 0,void 0,s);var o={};uV.forEach(a=>{e[a]&&(o[a]=e[a])}),Object.keys(o).length&&xo.j(t,o,n,i,r,s)}catch(a){jn.A(a)}},N:function(t,e){try{J==null||J.localStorage.removeItem(t),xo.N(t,e)}catch(n){jn.A(n)}}}),ig={},dV={O:function(){return!0},A:function(t){Ie.error("memoryStorage error: "+t)},D:function(t){return ig[t]||null},L:function(t){return ig[t]||null},j:function(t,e){ig[t]=e},N:function(t){delete ig[t]}},lc=null,ii={O:function(){if(!Xl(lc))return lc;if(lc=!0,Se(J))lc=!1;else try{var t="__support__";ii.j(t,"xyz"),ii.D(t)!=='"xyz"'&&(lc=!1),ii.N(t)}catch{lc=!1}return lc},A:function(t){Ie.error("sessionStorage error: ",t)},D:function(t){try{return J==null?void 0:J.sessionStorage.getItem(t)}catch(e){ii.A(e)}return null},L:function(t){try{return JSON.parse(ii.D(t))||null}catch{}return null},j:function(t,e){try{J==null||J.sessionStorage.setItem(t,JSON.stringify(e))}catch(n){ii.A(n)}},N:function(t){try{J==null||J.sessionStorage.removeItem(t)}catch(e){ii.A(e)}}},yu=function(t){return t[t.PENDING=-1]="PENDING",t[t.DENIED=0]="DENIED",t[t.GRANTED=1]="GRANTED",t}({});let fV=class{constructor(e){this._instance=e}get S(){return this._instance.config}get consent(){return this.U()?yu.DENIED:this.q}isOptedOut(){return this.consent===yu.DENIED||this.consent===yu.PENDING&&this.S.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(e){this.B.j(this.H,e?1:0,this.S.cookie_expiration,this.S.cross_subdomain_cookie,this.S.secure_cookie)}reset(){this.B.N(this.H,this.S.cross_subdomain_cookie)}get H(){var{token:e,opt_out_capturing_cookie_prefix:n}=this._instance.config;return(n||"__ph_opt_in_out_")+e}get q(){var e=this.B.D(this.H);return e==="1"?yu.GRANTED:e==="0"?yu.DENIED:yu.PENDING}get B(){if(!this.W){var e=this.S.opt_out_capturing_persistence_type;this.W=e==="localStorage"?jn:xo;var n=e==="localStorage"?xo:jn;n.D(this.H)&&(this.W.D(this.H)||this.optInOut(n.D(this.H)==="1"),n.N(this.H,this.S.cross_subdomain_cookie))}return this.W}U(){return!!this.S.respect_dnt&&!!K4([Cr==null?void 0:Cr.doNotTrack,Cr==null?void 0:Cr.msDoNotTrack,st.doNotTrack],e=>xt([!0,1,"1","yes"],e))}};var rg=qn("[Dead Clicks]"),hV=()=>!0,pV=t=>{var e,n=!((e=t.instance.persistence)==null||!e.get_property(J4)),i=t.instance.config.capture_dead_clicks;return fo(i)?i:n};let dO=class{get lazyLoadedDeadClicksAutocapture(){return this.G}constructor(e,n,i){this.instance=e,this.isEnabled=n,this.onCapture=i,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[J4]:e==null?void 0:e.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.J(()=>{this.V()})}J(e){var n,i;(n=st.__PosthogExtensions__)!=null&&n.initDeadClicksAutocapture&&e(),(i=st.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this.instance,"dead-clicks-autocapture",r=>{r?rg.error("failed to load script",r):e()})}V(){var e;if(Me){if(!this.G&&(e=st.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var n=wn(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};n.__onCapture=this.onCapture,this.G=st.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,n),this.G.start(Me),rg.info("starting...")}}else rg.error("`document` not found. Cannot start.")}stop(){this.G&&(this.G.stop(),this.G=void 0,rg.info("stopping..."))}};function _r(t,e,n,i,r){return e>n&&(Ie.warn("min cannot be greater than max."),e=n),wi(t)?t>n?(i&&Ie.warn(i+" cannot be  greater than max: "+n+". Using max value instead."),n):t<e?(i&&Ie.warn(i+" cannot be less than min: "+e+". Using min value instead."),e):t:(i&&Ie.warn(i+" must be a number. using max or fallback. max: "+n+", fallback: "+r),_r(r||n,e,n,i))}let fO=class{constructor(e){this.K={},this.Y=()=>{Object.keys(this.K).forEach(n=>{var i=this.X(n)+this.Z;i>=this.tt?delete this.K[n]:this.it(n,i)})},this.X=n=>this.K[String(n)],this.it=(n,i)=>{this.K[String(n)]=i},this.consumeRateLimit=n=>{var i,r=(i=this.X(n))!==null&&i!==void 0?i:this.tt;if((r=Math.max(r-1,0))===0)return!0;this.it(n,r);var s,o=r===0;return o&&((s=this.et)==null||s.call(this,n)),o},this.rt=e,this.et=this.rt.et,this.tt=_r(this.rt.bucketSize,0,100,"rate limiter bucket size"),this.Z=_r(this.rt.refillRate,0,this.tt,"rate limiter refill rate"),this.st=_r(this.rt.refillInterval,0,864e5,"rate limiter refill interval"),setInterval(()=>{this.Y()},this.st)}};var sg=qn("[ExceptionAutocapture]");let mV=class{constructor(e){var n,i,r;this.nt=()=>{var s;if(J&&this.isEnabled&&(s=st.__PosthogExtensions__)!=null&&s.errorWrappingFunctions){var o=st.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,a=st.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,l=st.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.ot&&this.S.capture_unhandled_errors&&(this.ot=o(this.captureException.bind(this))),!this.lt&&this.S.capture_unhandled_rejections&&(this.lt=a(this.captureException.bind(this))),!this.ut&&this.S.capture_console_errors&&(this.ut=l(this.captureException.bind(this)))}catch(c){sg.error("failed to start",c),this.ht()}}},this._instance=e,this.dt=!((n=this._instance.persistence)==null||!n.props[wP]),this.S=this.vt(),this.ct=new fO({refillRate:(i=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&i!==void 0?i:1,bucketSize:(r=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&r!==void 0?r:10,refillInterval:1e4}),this.startIfEnabled()}vt(){var e=this._instance.config.capture_exceptions,n={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return wn(e)?n=Ae({},n,e):(Se(e)?this.dt:e)&&(n=Ae({},n,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),n}get isEnabled(){return this.S.capture_console_errors||this.S.capture_unhandled_errors||this.S.capture_unhandled_rejections}startIfEnabled(){this.isEnabled&&(sg.info("enabled"),this.J(this.nt))}J(e){var n,i;(n=st.__PosthogExtensions__)!=null&&n.errorWrappingFunctions&&e(),(i=st.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,"exception-autocapture",r=>{if(r)return sg.error("failed to load script",r);e()})}ht(){var e,n,i;(e=this.ot)==null||e.call(this),this.ot=void 0,(n=this.lt)==null||n.call(this),this.lt=void 0,(i=this.ut)==null||i.call(this),this.ut=void 0}onRemoteConfig(e){var n=e.autocaptureExceptions;this.dt=!!n||!1,this.S=this.vt(),this._instance.persistence&&this._instance.persistence.register({[wP]:this.dt}),this.startIfEnabled()}captureException(e){var n,i=this._instance.requestRouter.endpointFor("ui");e.$exception_personURL=i+"/project/"+this._instance.config.token+"/person/"+this._instance.get_distinct_id();var r=(n=e.$exception_list[0].type)!==null&&n!==void 0?n:"Exception";this.ct.consumeRateLimit(r)?sg.info("Skipping exception capture because of client rate limiting.",{exception:e.$exception_list[0].type}):this._instance.exceptions.sendExceptionEvent(e)}};function hO(t){return!Se(Event)&&pO(t,Event)}function pO(t,e){try{return t instanceof e}catch{return!1}}function mO(t){switch(Object.prototype.toString.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object DOMError]":return!0;default:return pO(t,Error)}}function T0(t,e){return Object.prototype.toString.call(t)==="[object "+e+"]"}function $1(t){return T0(t,"DOMError")}var jP=/\(error: (.*)\)/,BP=50,Gu="?";function F1(t,e,n,i){var r={platform:"web:javascript",filename:t,function:e==="<anonymous>"?Gu:e,in_app:!0};return Se(n)||(r.lineno=n),Se(i)||(r.colno=i),r}var gV=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,vV=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,yV=/\((\S*)(?::(\d+))(?::(\d+))\)/,bV=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,xV=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,wV=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=e.sort((r,s)=>r[0]-s[0]).map(r=>r[1]);return function(r,s){s===void 0&&(s=0);for(var o=[],a=r.split(`
`),l=s;l<a.length;l++){var c=a[l];if(!(c.length>1024)){var u=jP.test(c)?c.replace(jP,"$1"):c;if(!u.match(/\S*Error: /)){for(var d of i){var f=d(u);if(f){o.push(f);break}}if(o.length>=BP)break}}}return function(p){if(!p.length)return[];var m=Array.from(p);return m.reverse(),m.slice(0,BP).map(g=>Ae({},g,{filename:g.filename||SV(m).filename,function:g.function||Gu}))}(o)}}([30,t=>{var e=gV.exec(t);if(e){var[,n,i,r]=e;return F1(n,Gu,+i,+r)}var s=vV.exec(t);if(s){if(s[2]&&s[2].indexOf("eval")===0){var o=yV.exec(s[2]);o&&(s[2]=o[1],s[3]=o[2],s[4]=o[3])}var[a,l]=FP(s[1]||Gu,s[2]);return F1(l,a,s[3]?+s[3]:void 0,s[4]?+s[4]:void 0)}}],[50,t=>{var e=bV.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){var n=xV.exec(e[3]);n&&(e[1]=e[1]||"eval",e[3]=n[1],e[4]=n[2],e[5]="")}var i=e[3],r=e[1]||Gu;return[r,i]=FP(r,i),F1(i,r,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}]);function SV(t){return t[t.length-1]||{}}var og,$P,z1,FP=(t,e)=>{var n=t.indexOf("safari-extension")!==-1,i=t.indexOf("safari-web-extension")!==-1;return n||i?[t.indexOf("@")!==-1?t.split("@")[0]:Gu,n?"safari-extension:"+e:"safari-web-extension:"+e]:[t,e]},kV=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;function TC(t,e){e===void 0&&(e=0);var n=t.stacktrace||t.stack||"",i=function(o){return o&&CV.test(o.message)?1:0}(t);try{var r=wV,s=function(o,a){var l=function(c){var u=globalThis._posthogChunkIds;if(!u)return{};var d=Object.keys(u);return z1&&d.length===$P||($P=d.length,z1=d.reduce((f,p)=>{og||(og={});var m=og[p];if(m)f[m[0]]=m[1];else for(var g=c(p),y=g.length-1;y>=0;y--){var v=g[y],b=v==null?void 0:v.filename,w=u[p];if(b&&w){f[b]=w,og[p]=[b,w];break}}return f},{})),z1}(a);return o.forEach(c=>{c.filename&&(c.chunk_id=l[c.filename])}),o}(r(n,i),r);return s.slice(0,s.length-e)}catch{}return[]}var CV=/Minified React error #\d+;/i;function _V(t,e){var n,i,r=TC(t),s=(n=e==null?void 0:e.handled)===null||n===void 0||n,o=(i=e==null?void 0:e.synthetic)!==null&&i!==void 0&&i;return{type:e!=null&&e.overrideExceptionType?e.overrideExceptionType:t.name,value:function(a){var l=a.message;return l.error&&typeof l.error.message=="string"?String(l.error.message):String(l)}(t),stacktrace:{frames:r,type:"raw"},mechanism:{handled:s,synthetic:o}}}function gO(t,e){var n=_V(t,e);return t.cause&&mO(t.cause)&&t.cause!==t?[n,...gO(t.cause,{handled:e==null?void 0:e.handled,synthetic:e==null?void 0:e.synthetic})]:[n]}function U1(t,e){return{$exception_list:gO(t,e),$exception_level:"error"}}function V1(t,e){var n,i,r,s=(n=e==null?void 0:e.handled)===null||n===void 0||n,o=(i=e==null?void 0:e.synthetic)===null||i===void 0||i,a={type:e!=null&&e.overrideExceptionType?e.overrideExceptionType:(r=e==null?void 0:e.defaultExceptionType)!==null&&r!==void 0?r:"Error",value:t||(e==null?void 0:e.defaultExceptionMessage),mechanism:{handled:s,synthetic:o}};if(e!=null&&e.syntheticException){var l=TC(e.syntheticException,1);l.length&&(a.stacktrace={frames:l,type:"raw"})}return{$exception_list:[a],$exception_level:"error"}}function EV(t){return Sn(t)&&!Xw(t)&&L7.indexOf(t)>=0}function AV(t,e){var n,i,r=(n=e==null?void 0:e.handled)===null||n===void 0||n,s=(i=e==null?void 0:e.synthetic)===null||i===void 0||i,o=e!=null&&e.overrideExceptionType?e.overrideExceptionType:hO(t)?t.constructor.name:"Error",a="Non-Error 'exception' captured with keys: "+function(u,d){d===void 0&&(d=40);var f=Object.keys(u);if(f.sort(),!f.length)return"[object has no keys]";for(var p=f.length;p>0;p--){var m=f.slice(0,p).join(", ");if(!(m.length>d))return p===f.length||m.length<=d?m:m.slice(0,d)+"..."}return""}(t),l={type:o,value:a,mechanism:{handled:r,synthetic:s}};if(e!=null&&e.syntheticException){var c=TC(e==null?void 0:e.syntheticException,1);c.length&&(l.stacktrace={frames:c,type:"raw"})}return{$exception_list:[l],$exception_level:EV(t.level)?t.level:"error"}}function PV(t,e){var{error:n,event:i}=t,r={$exception_list:[]},s=n||i;if($1(s)||function(f){return T0(f,"DOMException")}(s)){var o=s;if(function(f){return"stack"in f}(s))r=U1(s,e);else{var a=o.name||($1(o)?"DOMError":"DOMException"),l=o.message?a+": "+o.message:a;r=V1(l,Ae({},e,{overrideExceptionType:$1(o)?"DOMError":"DOMException",defaultExceptionMessage:l}))}return"code"in o&&(r.$exception_DOMException_code=""+o.code),r}if(function(f){return T0(f,"ErrorEvent")}(s)&&s.error)return U1(s.error,e);if(mO(s))return U1(s,e);if(function(f){return T0(f,"Object")}(s)||hO(s))return AV(s,e);if(Se(n)&&Sn(i)){var c="Error",u=i,d=i.match(kV);return d&&(c=d[1],u=d[2]),V1(u,Ae({},e,{overrideExceptionType:c,defaultExceptionMessage:u}))}return V1(s,e)}function zP(t,e,n){try{if(!(e in t))return()=>{};var i=t[e],r=n(i);return ts(r)&&(r.prototype=r.prototype||{},Object.defineProperties(r,{__posthog_wrapped__:{enumerable:!1,value:!0}})),t[e]=r,()=>{t[e]=i}}catch{return()=>{}}}let NV=class{constructor(e){var n;this._instance=e,this.ft=(J==null||(n=J.location)==null?void 0:n.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(Ie.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.gt&&this.gt(),this.gt=void 0,Ie.info("History API monitoring stopped")}monitorHistoryChanges(){var e,n;if(J&&J.history){var i=this;(e=J.history.pushState)!=null&&e.__posthog_wrapped__||zP(J.history,"pushState",r=>function(s,o,a){r.call(this,s,o,a),i._t("pushState")}),(n=J.history.replaceState)!=null&&n.__posthog_wrapped__||zP(J.history,"replaceState",r=>function(s,o,a){r.call(this,s,o,a),i._t("replaceState")}),this.bt()}}_t(e){try{var n,i=J==null||(n=J.location)==null?void 0:n.pathname;if(!i)return;i!==this.ft&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.ft=i}catch(r){Ie.error("Error capturing "+e+" pageview",r)}}bt(){if(!this.gt){var e=()=>{this._t("popstate")};pn(J,"popstate",e),this.gt=()=>{J&&J.removeEventListener("popstate",e)}}}};function Cv(t){var e,n;return((e=JSON.stringify(t,(n=[],function(i,r){if(wn(r)){for(;n.length>0&&n[n.length-1]!==this;)n.pop();return n.includes(r)?"[Circular]":(n.push(r),r)}return r})))==null?void 0:e.length)||0}function lS(t,e){if(e===void 0&&(e=66060288e-1),t.size>=e&&t.data.length>1){var n=Math.floor(t.data.length/2),i=t.data.slice(0,n),r=t.data.slice(n);return[lS({size:Cv(i),data:i,sessionId:t.sessionId,windowId:t.windowId}),lS({size:Cv(r),data:r,sessionId:t.sessionId,windowId:t.windowId})].flatMap(s=>s)}return[t]}var $o=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))($o||{}),bs=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t))(bs||{}),cS="[SessionRecording]",uS="redacted",ag={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:t=>t,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com","bam.nr-data.net"]},MV=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],RV=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],IV=["/s/","/e/","/i/"];function UP(t,e,n,i){if(Dt(t))return t;var r=(e==null?void 0:e["content-length"])||function(s){return new Blob([s]).size}(t);return Sn(r)&&(r=parseInt(r)),r>n?cS+" "+i+" body too large to record ("+r+" bytes)":t}function VP(t,e){if(Dt(t))return t;var n=t;return $d(n,!1)||(n=cS+" "+e+" body "+uS),Ut(RV,i=>{var r,s;(r=n)!=null&&r.length&&((s=n)==null?void 0:s.indexOf(i))!==-1&&(n=cS+" "+e+" body "+uS+" as might contain: "+i)}),n}var TV=(t,e)=>{var n,i,r,s={payloadSizeLimitBytes:ag.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...ag.performanceEntryTypeToObserve],payloadHostDenyList:[...e.payloadHostDenyList||[],...ag.payloadHostDenyList]},o=t.session_recording.recordHeaders!==!1&&e.recordHeaders,a=t.session_recording.recordBody!==!1&&e.recordBody,l=t.capture_performance!==!1&&e.recordPerformance,c=(n=s,r=Math.min(1e6,(i=n.payloadSizeLimitBytes)!==null&&i!==void 0?i:1e6),f=>(f!=null&&f.requestBody&&(f.requestBody=UP(f.requestBody,f.requestHeaders,r,"Request")),f!=null&&f.responseBody&&(f.responseBody=UP(f.responseBody,f.responseHeaders,r,"Response")),f)),u=f=>{return c(((g,y)=>{var v,b=Fd(g.name),w=y.indexOf("http")===0?(v=Fd(y))==null?void 0:v.pathname:y;w==="/"&&(w="");var k=b==null?void 0:b.pathname.replace(w||"","");if(!(b&&k&&IV.some(C=>k.indexOf(C)===0)))return g})((m=(p=f).requestHeaders,Dt(m)||Ut(Object.keys(m??{}),g=>{MV.includes(g.toLowerCase())&&(m[g]=uS)}),p),t.api_host));var p,m},d=ts(t.session_recording.maskNetworkRequestFn);return d&&ts(t.session_recording.maskCapturedNetworkRequestFn)&&Ie.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),d&&(t.session_recording.maskCapturedNetworkRequestFn=f=>{var p=t.session_recording.maskNetworkRequestFn({url:f.name});return Ae({},f,{name:p==null?void 0:p.url})}),s.maskRequestFn=ts(t.session_recording.maskCapturedNetworkRequestFn)?f=>{var p,m=u(f);return m&&(p=t.session_recording.maskCapturedNetworkRequestFn==null?void 0:t.session_recording.maskCapturedNetworkRequestFn(m))!==null&&p!==void 0?p:void 0}:f=>function(p){if(!Se(p))return p.requestBody=VP(p.requestBody,"Request"),p.responseBody=VP(p.responseBody,"Response"),p}(u(f)),Ae({},ag,s,{recordHeaders:o,recordBody:a,recordPerformance:l,recordInitialRequests:l})};let OV=class{constructor(e,n){var i,r;n===void 0&&(n={}),this.yt={},this.wt=s=>{if(!this.yt[s]){var o,a;this.yt[s]=!0;var l=this.St(s);(o=(a=this.rt).onBlockedNode)==null||o.call(a,s,l)}},this.$t=s=>{var o=this.St(s);if((o==null?void 0:o.nodeName)!=="svg"&&o instanceof Element){var a=o.closest("svg");if(a)return[this._rrweb.mirror.getId(a),a]}return[s,o]},this.St=s=>this._rrweb.mirror.getNode(s),this.kt=s=>{var o,a,l,c,u,d,f,p;return((o=(a=s.removes)==null?void 0:a.length)!==null&&o!==void 0?o:0)+((l=(c=s.attributes)==null?void 0:c.length)!==null&&l!==void 0?l:0)+((u=(d=s.texts)==null?void 0:d.length)!==null&&u!==void 0?u:0)+((f=(p=s.adds)==null?void 0:p.length)!==null&&f!==void 0?f:0)},this.throttleMutations=s=>{if(s.type!==3||s.data.source!==0)return s;var o=s.data,a=this.kt(o);o.attributes&&(o.attributes=o.attributes.filter(c=>{var[u]=this.$t(c.id);return!this.ct.consumeRateLimit(u)&&c}));var l=this.kt(o);return l!==0||a===l?s:void 0},this._rrweb=e,this.rt=n,this.ct=new fO({bucketSize:(i=this.rt.bucketSize)!==null&&i!==void 0?i:100,refillRate:(r=this.rt.refillRate)!==null&&r!==void 0?r:10,refillInterval:1e3,et:this.wt})}};var ns=Uint8Array,or=Uint16Array,zd=Uint32Array,OC=new ns([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),LC=new ns([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),HP=new ns([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vO=function(t,e){for(var n=new or(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];var r=new zd(n[30]);for(i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)r[s]=s-n[i]<<5|i;return[n,r]},yO=vO(OC,2),LV=yO[0],dS=yO[1];LV[28]=258,dS[258]=28;for(var WP=vO(LC,0)[1],bO=new or(32768),tn=0;tn<32768;++tn){var cc=(43690&tn)>>>1|(21845&tn)<<1;cc=(61680&(cc=(52428&cc)>>>2|(13107&cc)<<2))>>>4|(3855&cc)<<4,bO[tn]=((65280&cc)>>>8|(255&cc)<<8)>>>1}var jh=function(t,e,n){for(var i=t.length,r=0,s=new or(e);r<i;++r)++s[t[r]-1];var o,a=new or(e);for(r=0;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;for(o=new or(i),r=0;r<i;++r)o[r]=bO[a[t[r]-1]++]>>>15-t[r];return o},Hc=new ns(288);for(tn=0;tn<144;++tn)Hc[tn]=8;for(tn=144;tn<256;++tn)Hc[tn]=9;for(tn=256;tn<280;++tn)Hc[tn]=7;for(tn=280;tn<288;++tn)Hc[tn]=8;var _v=new ns(32);for(tn=0;tn<32;++tn)_v[tn]=5;var DV=jh(Hc,9),jV=jh(_v,5),xO=function(t){return(t/8>>0)+(7&t&&1)},wO=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var i=new(t instanceof or?or:t instanceof zd?zd:ns)(n-e);return i.set(t.subarray(e,n)),i},Do=function(t,e,n){n<<=7&e;var i=e/8>>0;t[i]|=n,t[i+1]|=n>>>8},Bf=function(t,e,n){n<<=7&e;var i=e/8>>0;t[i]|=n,t[i+1]|=n>>>8,t[i+2]|=n>>>16},H1=function(t,e){for(var n=[],i=0;i<t.length;++i)t[i]&&n.push({s:i,f:t[i]});var r=n.length,s=n.slice();if(!r)return[new ns(0),0];if(r==1){var o=new ns(n[0].s+1);return o[n[0].s]=1,[o,1]}n.sort(function(C,E){return C.f-E.f}),n.push({s:-1,f:25001});var a=n[0],l=n[1],c=0,u=1,d=2;for(n[0]={s:-1,f:a.f+l.f,l:a,r:l};u!=r-1;)a=n[n[c].f<n[d].f?c++:d++],l=n[c!=u&&n[c].f<n[d].f?c++:d++],n[u++]={s:-1,f:a.f+l.f,l:a,r:l};var f=s[0].s;for(i=1;i<r;++i)s[i].s>f&&(f=s[i].s);var p=new or(f+1),m=fS(n[u-1],p,0);if(m>e){i=0;var g=0,y=m-e,v=1<<y;for(s.sort(function(C,E){return p[E.s]-p[C.s]||C.f-E.f});i<r;++i){var b=s[i].s;if(!(p[b]>e))break;g+=v-(1<<m-p[b]),p[b]=e}for(g>>>=y;g>0;){var w=s[i].s;p[w]<e?g-=1<<e-p[w]++-1:++i}for(;i>=0&&g;--i){var k=s[i].s;p[k]==e&&(--p[k],++g)}m=e}return[new ns(p),m]},fS=function(t,e,n){return t.s==-1?Math.max(fS(t.l,e,n+1),fS(t.r,e,n+1)):e[t.s]=n},GP=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new or(++e),i=0,r=t[0],s=1,o=function(l){n[i++]=l},a=1;a<=e;++a)if(t[a]==r&&a!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(r),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(r);s=1,r=t[a]}return[n.subarray(0,i),e]},$f=function(t,e){for(var n=0,i=0;i<e.length;++i)n+=t[i]*e[i];return n},hS=function(t,e,n){var i=n.length,r=xO(e+2);t[r]=255&i,t[r+1]=i>>>8,t[r+2]=255^t[r],t[r+3]=255^t[r+1];for(var s=0;s<i;++s)t[r+s+4]=n[s];return 8*(r+4+i)},XP=function(t,e,n,i,r,s,o,a,l,c,u){Do(e,u++,n),++r[256];for(var d=H1(r,15),f=d[0],p=d[1],m=H1(s,15),g=m[0],y=m[1],v=GP(f),b=v[0],w=v[1],k=GP(g),C=k[0],E=k[1],_=new or(19),M=0;M<b.length;++M)_[31&b[M]]++;for(M=0;M<C.length;++M)_[31&C[M]]++;for(var R=H1(_,7),T=R[0],L=R[1],I=19;I>4&&!T[HP[I-1]];--I);var G,B,q,Y,ne=c+5<<3,V=$f(r,Hc)+$f(s,_v)+o,U=$f(r,f)+$f(s,g)+o+14+3*I+$f(_,T)+(2*_[16]+3*_[17]+7*_[18]);if(ne<=V&&ne<=U)return hS(e,u,t.subarray(l,l+c));if(Do(e,u,1+(U<V)),u+=2,U<V){G=jh(f,p),B=f,q=jh(g,y),Y=g;var se=jh(T,L);for(Do(e,u,w-257),Do(e,u+5,E-1),Do(e,u+10,I-4),u+=14,M=0;M<I;++M)Do(e,u+3*M,T[HP[M]]);u+=3*I;for(var Ce=[b,C],Q=0;Q<2;++Q){var ae=Ce[Q];for(M=0;M<ae.length;++M){var z=31&ae[M];Do(e,u,se[z]),u+=T[z],z>15&&(Do(e,u,ae[M]>>>5&127),u+=ae[M]>>>12)}}}else G=DV,B=Hc,q=jV,Y=_v;for(M=0;M<a;++M)if(i[M]>255){z=i[M]>>>18&31,Bf(e,u,G[z+257]),u+=B[z+257],z>7&&(Do(e,u,i[M]>>>23&31),u+=OC[z]);var $=31&i[M];Bf(e,u,q[$]),u+=Y[$],$>3&&(Bf(e,u,i[M]>>>5&8191),u+=LC[$])}else Bf(e,u,G[i[M]]),u+=B[i[M]];return Bf(e,u,G[256]),u+B[256]},BV=new zd([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),$V=function(){for(var t=new zd(256),e=0;e<256;++e){for(var n=e,i=9;--i;)n=(1&n&&3988292384)^n>>>1;t[e]=n}return t}(),FV=function(){var t=4294967295;return{p:function(e){for(var n=t,i=0;i<e.length;++i)n=$V[255&n^e[i]]^n>>>8;t=n},d:function(){return 4294967295^t}}},zV=function(t,e,n,i,r){return function(s,o,a,l,c,u){var d=s.length,f=new ns(l+d+5*(1+Math.floor(d/7e3))+c),p=f.subarray(l,f.length-c),m=0;if(!o||d<8)for(var g=0;g<=d;g+=65535){var y=g+65535;y<d?m=hS(p,m,s.subarray(g,y)):(p[g]=u,m=hS(p,m,s.subarray(g,d)))}else{for(var v=BV[o-1],b=v>>>13,w=8191&v,k=(1<<a)-1,C=new or(32768),E=new or(k+1),_=Math.ceil(a/3),M=2*_,R=function(Je){return(s[Je]^s[Je+1]<<_^s[Je+2]<<M)&k},T=new zd(25e3),L=new or(288),I=new or(32),G=0,B=0,q=(g=0,0),Y=0,ne=0;g<d;++g){var V=R(g),U=32767&g,se=E[V];if(C[U]=se,E[V]=U,Y<=g){var Ce=d-g;if((G>7e3||q>24576)&&Ce>423){m=XP(s,p,0,T,L,I,B,q,ne,g-ne,m),q=G=B=0,ne=g;for(var Q=0;Q<286;++Q)L[Q]=0;for(Q=0;Q<30;++Q)I[Q]=0}var ae=2,z=0,$=w,W=U-se&32767;if(Ce>2&&V==R(g-W))for(var S=Math.min(b,Ce)-1,O=Math.min(32767,g),j=Math.min(258,Ce);W<=O&&--$&&U!=se;){if(s[g+ae]==s[g+ae-W]){for(var D=0;D<j&&s[g+D]==s[g+D-W];++D);if(D>ae){if(ae=D,z=W,D>S)break;var Z=Math.min(W,D-2),K=0;for(Q=0;Q<Z;++Q){var oe=g-W+Q+32768&32767,te=oe-C[oe]+32768&32767;te>K&&(K=te,se=oe)}}}W+=(U=se)-(se=C[U])+32768&32767}if(z){T[q++]=268435456|dS[ae]<<18|WP[z];var Oe=31&dS[ae],Xe=31&WP[z];B+=OC[Oe]+LC[Xe],++L[257+Oe],++I[Xe],Y=g+ae,++G}else T[q++]=s[g],++L[s[g]]}}m=XP(s,p,u,T,L,I,B,q,ne,g-ne,m)}return wO(f,0,l+xO(m)+c)}(t,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,n,i,!0)},pS=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},UV=function(t,e){var n=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:e.level==9?2:0,t[9]=3,e.mtime!=0&&pS(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),n){t[3]=8;for(var i=0;i<=n.length;++i)t[i+10]=n.charCodeAt(i)}},VV=function(t){return 10+(t.filename&&t.filename.length+1||0)};function SO(t,e){e===void 0&&(e={});var n=FV(),i=t.length;n.p(t);var r=zV(t,e,VV(e),8),s=r.length;return UV(r,e),pS(r,s-8,n.d()),pS(r,s-4,i),r}function kO(t,e){var n=t.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(t);for(var i=new ns(t.length+(t.length>>>1)),r=0,s=function(c){i[r++]=c},o=0;o<n;++o){if(r+5>i.length){var a=new ns(r+8+(n-o<<1));a.set(i),i=a}var l=t.charCodeAt(o);l<128||e?s(l):l<2048?(s(192|l>>>6),s(128|63&l)):l>55295&&l<57344?(s(240|(l=65536+(1047552&l)|1023&t.charCodeAt(++o))>>>18),s(128|l>>>12&63),s(128|l>>>6&63),s(128|63&l)):(s(224|l>>>12),s(128|l>>>6&63),s(128|63&l))}return wO(i,0,r)}function HV(t,e){return function(n){for(var i=0,r=0;r<n.length;r++)i=(i<<5)-i+n.charCodeAt(r),i|=0;return Math.abs(i)}(t)%100<_r(100*e,0,100)}var Pl="disabled",DC="sampled",Ev="active",Wc="buffering",jC="paused",BC="trigger",wo=BC+"_activated",Ci=BC+"_pending",Po=BC+"_"+Pl;function qP(t,e){return e.some(n=>n.matching==="regex"&&new RegExp(n.url).test(t))}class CO{constructor(e){this.xt=e}triggerStatus(e){var n=this.xt.map(i=>i.triggerStatus(e));return n.includes(wo)?wo:n.includes(Ci)?Ci:Po}stop(){this.xt.forEach(e=>e.stop())}}class _O{constructor(e){this.xt=e}triggerStatus(e){var n=new Set;for(var i of this.xt)n.add(i.triggerStatus(e));switch(n.delete(Po),n.size){case 0:return Po;case 1:return Array.from(n)[0];default:return Ci}}stop(){this.xt.forEach(e=>e.stop())}}class WV{triggerStatus(){return Ci}stop(){}}class GV{constructor(e){this.Et=[],this.It=[],this.urlBlocked=!1,this._instance=e}onRemoteConfig(e){var n,i;this.Et=((n=e.sessionRecording)==null?void 0:n.urlTriggers)||[],this.It=((i=e.sessionRecording)==null?void 0:i.urlBlocklist)||[]}Pt(e){var n;return this.Et.length===0?Po:((n=this._instance)==null?void 0:n.get_property(Jw))===e?wo:Ci}triggerStatus(e){var n=this.Pt(e),i=n===wo?wo:n===Ci?Ci:Po;return this._instance.register_for_session({$sdk_debug_replay_url_trigger_status:i}),i}checkUrlTriggerConditions(e,n,i){if(J!==void 0&&J.location.href){var r=J.location.href,s=this.urlBlocked,o=qP(r,this.It);s&&o||(o&&!s?e():!o&&s&&n(),qP(r,this.Et)&&i("url"))}}stop(){}}class XV{constructor(e){this.linkedFlag=null,this.linkedFlagSeen=!1,this.Rt=()=>{},this._instance=e}triggerStatus(){var e=Ci;return Dt(this.linkedFlag)&&(e=Po),this.linkedFlagSeen&&(e=wo),this._instance.register_for_session({$sdk_debug_replay_linked_flag_trigger_status:e}),e}onRemoteConfig(e,n){var i;if(this.linkedFlag=((i=e.sessionRecording)==null?void 0:i.linkedFlag)||null,!Dt(this.linkedFlag)&&!this.linkedFlagSeen){var r=Sn(this.linkedFlag)?this.linkedFlag:this.linkedFlag.flag,s=Sn(this.linkedFlag)?null:this.linkedFlag.variant;this.Rt=this._instance.onFeatureFlags((o,a)=>{var l=!1;if(wn(a)&&r in a){var c=a[r];l=fo(c)?c===!0:s?c===s:!!c}this.linkedFlagSeen=l,l&&n(r,s)})}}stop(){this.Rt()}}let qV=class{constructor(e){this.Tt=[],this._instance=e}onRemoteConfig(e){var n;this.Tt=((n=e.sessionRecording)==null?void 0:n.eventTriggers)||[]}Mt(e){var n;return this.Tt.length===0?Po:((n=this._instance)==null?void 0:n.get_property(Zw))===e?wo:Ci}triggerStatus(e){var n=this.Mt(e),i=n===wo?wo:n===Ci?Ci:Po;return this._instance.register_for_session({$sdk_debug_replay_event_trigger_status:i}),i}stop(){}};function KV(t){return t.isRecordingEnabled?Wc:Pl}function YV(t){if(!t.receivedFlags)return Wc;if(!t.isRecordingEnabled)return Pl;if(t.urlTriggerMatching.urlBlocked)return jC;var e=t.isSampled===!0,n=new CO([t.eventTriggerMatching,t.urlTriggerMatching,t.linkedFlagMatching]).triggerStatus(t.sessionId);return e?DC:n===wo?Ev:n===Ci?Wc:t.isSampled===!1?Pl:Ev}function JV(t){if(!t.receivedFlags)return Wc;if(!t.isRecordingEnabled)return Pl;if(t.urlTriggerMatching.urlBlocked)return jC;var e=new _O([t.eventTriggerMatching,t.urlTriggerMatching,t.linkedFlagMatching]).triggerStatus(t.sessionId),n=e!==Po,i=fo(t.isSampled);return n&&e===Ci?Wc:n&&e===Po||i&&!t.isSampled?Pl:t.isSampled===!0?DC:Ev}var hh="[SessionRecording]",mi=qn(hh);function lg(){var t;return st==null||(t=st.__PosthogExtensions__)==null||(t=t.rrweb)==null?void 0:t.record}var ZV=3e5,QV=[bs.MouseMove,bs.MouseInteraction,bs.Scroll,bs.ViewportResize,bs.Input,bs.TouchMove,bs.MediaInteraction,bs.Drag],KP=t=>({rrwebMethod:t,enqueuedAt:Date.now(),attempt:1});function uc(t){return function(e,n){for(var i="",r=0;r<e.length;){var s=e[r++];i+=String.fromCharCode(s)}return i}(SO(kO(JSON.stringify(t))))}function YP(t){return t.type===$o.Custom&&t.data.tag==="sessionIdle"}class eH{get sessionId(){return this.Ct}get Ft(){return this._instance.config.session_recording.session_idle_threshold_ms||3e5}get started(){return this.Ot}get At(){if(!this._instance.sessionManager)throw new Error(hh+" must be started with a valid sessionManager.");return this._instance.sessionManager}get Dt(){var e,n;return this.Lt.triggerStatus(this.sessionId)===Ci?6e4:(e=(n=this._instance.config.session_recording)==null?void 0:n.full_snapshot_interval_millis)!==null&&e!==void 0?e:ZV}get jt(){var e=this._instance.get_property(dh);return fo(e)?e:null}get Nt(){var e,n,i=(e=this.C)==null?void 0:e.data[((n=this.C)==null?void 0:n.data.length)-1],{sessionStartTimestamp:r}=this.At.checkAndGetSessionAndWindowId(!0);return i?i.timestamp-r:null}get zt(){var e=!!this._instance.get_property(Yw),n=!this._instance.config.disable_session_recording;return J&&e&&n}get Ut(){var e=!!this._instance.get_property(CP),n=this._instance.config.enable_recording_console_log;return n??e}get qt(){var e,n,i,r,s,o,a=this._instance.config.session_recording.captureCanvas,l=this._instance.get_property(AP),c=(e=(n=a==null?void 0:a.recordCanvas)!==null&&n!==void 0?n:l==null?void 0:l.enabled)!==null&&e!==void 0&&e,u=(i=(r=a==null?void 0:a.canvasFps)!==null&&r!==void 0?r:l==null?void 0:l.fps)!==null&&i!==void 0?i:4,d=(s=(o=a==null?void 0:a.canvasQuality)!==null&&o!==void 0?o:l==null?void 0:l.quality)!==null&&s!==void 0?s:.4;if(typeof d=="string"){var f=parseFloat(d);d=isNaN(f)?.4:f}return{enabled:c,fps:_r(u,0,12,"canvas recording fps",4),quality:_r(d,0,1,"canvas recording quality",.4)}}get Bt(){var e,n,i=this._instance.get_property(_P),r={recordHeaders:(e=this._instance.config.session_recording)==null?void 0:e.recordHeaders,recordBody:(n=this._instance.config.session_recording)==null?void 0:n.recordBody},s=(r==null?void 0:r.recordHeaders)||(i==null?void 0:i.recordHeaders),o=(r==null?void 0:r.recordBody)||(i==null?void 0:i.recordBody),a=wn(this._instance.config.capture_performance)?this._instance.config.capture_performance.network_timing:this._instance.config.capture_performance,l=!!(fo(a)?a:i!=null&&i.capturePerformance);return s||o||l?{recordHeaders:s,recordBody:o,recordPerformance:l}:void 0}get Ht(){var e,n,i,r,s,o,a=this._instance.get_property(EP),l={maskAllInputs:(e=this._instance.config.session_recording)==null?void 0:e.maskAllInputs,maskTextSelector:(n=this._instance.config.session_recording)==null?void 0:n.maskTextSelector,blockSelector:(i=this._instance.config.session_recording)==null?void 0:i.blockSelector},c=(r=l==null?void 0:l.maskAllInputs)!==null&&r!==void 0?r:a==null?void 0:a.maskAllInputs,u=(s=l==null?void 0:l.maskTextSelector)!==null&&s!==void 0?s:a==null?void 0:a.maskTextSelector,d=(o=l==null?void 0:l.blockSelector)!==null&&o!==void 0?o:a==null?void 0:a.blockSelector;return Se(c)&&Se(u)&&Se(d)?void 0:{maskAllInputs:c==null||c,maskTextSelector:u,blockSelector:d}}get Wt(){var e=this._instance.get_property(PP);return wi(e)?e:null}get Gt(){var e=this._instance.get_property(NP);return wi(e)?e:null}get status(){return this.Jt?this.Vt({receivedFlags:this.Jt,isRecordingEnabled:this.zt,isSampled:this.jt,urlTriggerMatching:this.Kt,eventTriggerMatching:this.Yt,linkedFlagMatching:this.Xt,sessionId:this.sessionId}):Wc}constructor(e){if(this.Vt=KV,this.Jt=!1,this.Qt=[],this.Zt="unknown",this.ti=Date.now(),this.Lt=new WV,this.ii=void 0,this.ei=void 0,this.ri=void 0,this.si=void 0,this.ni=void 0,this._forceAllowLocalhostNetworkCapture=!1,this.oi=()=>{this.ai()},this.li=()=>{this.ui("browser offline",{})},this.hi=()=>{this.ui("browser online",{})},this.di=()=>{if(Me!=null&&Me.visibilityState){var r="window "+Me.visibilityState;this.ui(r,{})}},this._instance=e,this.Ot=!1,this.vi="/s/",this.ci=void 0,this.Jt=!1,!this._instance.sessionManager)throw mi.error("started without valid sessionManager"),new Error(hh+" started without valid sessionManager. This is a bug.");if(this._instance.config.__preview_experimental_cookieless_mode)throw new Error(hh+" cannot be used with __preview_experimental_cookieless_mode.");this.Xt=new XV(this._instance),this.Kt=new GV(this._instance),this.Yt=new qV(this._instance);var{sessionId:n,windowId:i}=this.At.checkAndGetSessionAndWindowId();this.Ct=n,this.fi=i,this.C=this.pi(),this.Ft>=this.At.sessionTimeoutMs&&mi.warn("session_idle_threshold_ms ("+this.Ft+") is greater than the session timeout ("+this.At.sessionTimeoutMs+"). Session will never be detected as idle")}startIfEnabledOrStop(e){this.zt?(this.gi(e),pn(J,"beforeunload",this.oi),pn(J,"offline",this.li),pn(J,"online",this.hi),pn(J,"visibilitychange",this.di),this.mi(),this.bi(),Dt(this.ii)&&(this.ii=this._instance.on("eventCaptured",n=>{try{if(n.event==="$pageview"){var i=n!=null&&n.properties.$current_url?this.yi(n==null?void 0:n.properties.$current_url):"";if(!i)return;this.ui("$pageview",{href:i})}}catch(r){mi.error("Could not add $pageview to rrweb session",r)}})),this.ei||(this.ei=this.At.onSessionId((n,i,r)=>{var s,o;r&&(this.ui("$session_id_change",{sessionId:n,windowId:i,changeReason:r}),(s=this._instance)==null||(s=s.persistence)==null||s.unregister(Zw),(o=this._instance)==null||(o=o.persistence)==null||o.unregister(Jw))}))):this.stopRecording()}stopRecording(){var e,n,i,r;this.Ot&&this.ci&&(this.ci(),this.ci=void 0,this.Ot=!1,J==null||J.removeEventListener("beforeunload",this.oi),J==null||J.removeEventListener("offline",this.li),J==null||J.removeEventListener("online",this.hi),J==null||J.removeEventListener("visibilitychange",this.di),this.pi(),clearInterval(this.wi),(e=this.ii)==null||e.call(this),this.ii=void 0,(n=this.ni)==null||n.call(this),this.ni=void 0,(i=this.ei)==null||i.call(this),this.ei=void 0,(r=this.si)==null||r.call(this),this.si=void 0,this.Yt.stop(),this.Kt.stop(),this.Xt.stop(),mi.info("stopped"))}Si(){var e;(e=this._instance.persistence)==null||e.unregister(dh)}$i(e){var n,i=this.Ct!==e,r=this.Wt;if(wi(r)){var s=this.jt,o=i||!fo(s),a=o?HV(e,r):s;o&&(a?this.ki(DC):mi.warn("Sample rate ("+r+") has determined that this sessionId ("+e+") will not be sent to the server."),this.ui("samplingDecisionMade",{sampleRate:r,isSampled:a})),(n=this._instance.persistence)==null||n.register({[dh]:a})}else this.Si()}onRemoteConfig(e){var n,i,r,s;this.ui("$remote_config_received",e),this.xi(e),(n=e.sessionRecording)!=null&&n.endpoint&&(this.vi=(s=e.sessionRecording)==null?void 0:s.endpoint),this.mi(),((i=e.sessionRecording)==null?void 0:i.triggerMatchType)==="any"?(this.Vt=YV,this.Lt=new CO([this.Yt,this.Kt])):(this.Vt=JV,this.Lt=new _O([this.Yt,this.Kt])),this._instance.register_for_session({$sdk_debug_replay_remote_trigger_matching_config:(r=e.sessionRecording)==null?void 0:r.triggerMatchType}),this.Kt.onRemoteConfig(e),this.Yt.onRemoteConfig(e),this.Xt.onRemoteConfig(e,(o,a)=>{this.ki("linked_flag_matched",{flag:o,variant:a})}),this.Jt=!0,this.startIfEnabledOrStop()}mi(){wi(this.Wt)&&Dt(this.si)&&(this.si=this.At.onSessionId(e=>{this.$i(e)}))}xi(e){if(this._instance.persistence){var n,i=this._instance.persistence,r=()=>{var s,o,a,l,c,u,d,f,p,m=(s=e.sessionRecording)==null?void 0:s.sampleRate,g=Dt(m)?null:parseFloat(m);Dt(g)&&this.Si();var y=(o=e.sessionRecording)==null?void 0:o.minimumDurationMilliseconds;i.register({[Yw]:!!e.sessionRecording,[CP]:(a=e.sessionRecording)==null?void 0:a.consoleLogRecordingEnabled,[_P]:Ae({capturePerformance:e.capturePerformance},(l=e.sessionRecording)==null?void 0:l.networkPayloadCapture),[EP]:(c=e.sessionRecording)==null?void 0:c.masking,[AP]:{enabled:(u=e.sessionRecording)==null?void 0:u.recordCanvas,fps:(d=e.sessionRecording)==null?void 0:d.canvasFps,quality:(f=e.sessionRecording)==null?void 0:f.canvasQuality},[PP]:g,[NP]:Se(y)?null:y,[MP]:(p=e.sessionRecording)==null?void 0:p.scriptConfig})};r(),(n=this.ri)==null||n.call(this),this.ri=this.At.onSessionId(r)}}log(e,n){var i;n===void 0&&(n="log"),(i=this._instance.sessionRecording)==null||i.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:n,trace:[],payload:[JSON.stringify(e)]}},timestamp:Date.now()})}gi(e){if(!Se(Object.assign)&&!Se(Array.from)&&!(this.Ot||this._instance.config.disable_session_recording||this._instance.consent.isOptedOut())){var n;this.Ot=!0,this.At.checkAndGetSessionAndWindowId(),lg()?this.Ei():(n=st.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,this.Ii,i=>{if(i)return mi.error("could not load recorder",i);this.Ei()}),mi.info("starting"),this.status===Ev&&this.ki(e||"recording_initialized")}}get Ii(){var e;return((e=this._instance)==null||(e=e.persistence)==null||(e=e.get_property(MP))==null?void 0:e.script)||"recorder"}Pi(e){var n;return e.type===3&&QV.indexOf((n=e.data)==null?void 0:n.source)!==-1}Ri(e){var n=this.Pi(e);n||this.Zt||e.timestamp-this.ti>this.Ft&&(this.Zt=!0,clearInterval(this.wi),this.ui("sessionIdle",{eventTimestamp:e.timestamp,lastActivityTimestamp:this.ti,threshold:this.Ft,bufferLength:this.C.data.length,bufferSize:this.C.size}),this.ai());var i=!1;if(n&&(this.ti=e.timestamp,this.Zt)){var r=this.Zt==="unknown";this.Zt=!1,r||(this.ui("sessionNoLongerIdle",{reason:"user activity",type:e.type}),i=!0)}if(!this.Zt){var{windowId:s,sessionId:o}=this.At.checkAndGetSessionAndWindowId(!n,e.timestamp),a=this.Ct!==o,l=this.fi!==s;this.fi=s,this.Ct=o,a||l?(this.stopRecording(),this.startIfEnabledOrStop("session_id_changed")):i&&this.Ti()}}Mi(e){try{return e.rrwebMethod(),!0}catch(n){return this.Qt.length<10?this.Qt.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}):mi.warn("could not emit queued rrweb event.",n,e),!1}}ui(e,n){return this.Mi(KP(()=>lg().addCustomEvent(e,n)))}Ci(){return this.Mi(KP(()=>lg().takeFullSnapshot()))}Ei(){var e,n,i,r,s={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},o=this._instance.config.session_recording;for(var[a,l]of Object.entries(o||{}))a in s&&(a==="maskInputOptions"?s.maskInputOptions=Ae({password:!0},l):s[a]=l);this.qt&&this.qt.enabled&&(s.recordCanvas=!0,s.sampling={canvas:this.qt.fps},s.dataURLOptions={type:"image/webp",quality:this.qt.quality}),this.Ht&&(s.maskAllInputs=(n=this.Ht.maskAllInputs)===null||n===void 0||n,s.maskTextSelector=(i=this.Ht.maskTextSelector)!==null&&i!==void 0?i:void 0,s.blockSelector=(r=this.Ht.blockSelector)!==null&&r!==void 0?r:void 0);var c=lg();if(c){this.Fi=(e=this.Fi)!==null&&e!==void 0?e:new OV(c,{refillRate:this._instance.config.session_recording.__mutationThrottlerRefillRate,bucketSize:this._instance.config.session_recording.__mutationThrottlerBucketSize,onBlockedNode:(d,f)=>{var p="Too many mutations on node '"+d+"'. Rate limiting. This could be due to SVG animations or something similar";mi.info(p,{node:f}),this.log(hh+" "+p,"warn")}});var u=this.Oi();this.ci=c(Ae({emit:d=>{this.onRRwebEmit(d)},plugins:u},s)),this.ti=Date.now(),this.Zt=fo(this.Zt)?this.Zt:"unknown",this.ui("$session_options",{sessionRecordingOptions:s,activePlugins:u.map(d=>d==null?void 0:d.name)}),this.ui("$posthog_config",{config:this._instance.config})}else mi.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}Ti(){if(this.wi&&clearInterval(this.wi),this.Zt!==!0){var e=this.Dt;e&&(this.wi=setInterval(()=>{this.Ci()},e))}}Oi(){var e,n,i=[],r=(e=st.__PosthogExtensions__)==null||(e=e.rrwebPlugins)==null?void 0:e.getRecordConsolePlugin;r&&this.Ut&&i.push(r());var s=(n=st.__PosthogExtensions__)==null||(n=n.rrwebPlugins)==null?void 0:n.getRecordNetworkPlugin;return this.Bt&&ts(s)&&(!Z7.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?i.push(s(TV(this._instance.config,this.Bt))):mi.info("NetworkCapture not started because we are on localhost.")),i}onRRwebEmit(e){var n;if(this.Ai(),e&&wn(e)){if(e.type===$o.Meta){var i=this.yi(e.data.href);if(this.Di=i,!i)return;e.data.href=i}else this.Li();if(this.Kt.checkUrlTriggerConditions(()=>this.ji(),()=>this.Ni(),f=>this.zi(f)),!this.Kt.urlBlocked||(r=e).type===$o.Custom&&r.data.tag==="recording paused"){var r;e.type===$o.FullSnapshot&&this.Ti(),e.type===$o.FullSnapshot&&this.Jt&&this.Lt.triggerStatus(this.sessionId)===Ci&&this.pi();var s=this.Fi?this.Fi.throttleMutations(e):e;if(s){var o=function(f){var p=f;if(p&&wn(p)&&p.type===6&&wn(p.data)&&p.data.plugin==="rrweb/console@1"){p.data.payload.payload.length>10&&(p.data.payload.payload=p.data.payload.payload.slice(0,10),p.data.payload.payload.push("...[truncated]"));for(var m=[],g=0;g<p.data.payload.payload.length;g++)p.data.payload.payload[g]&&p.data.payload.payload[g].length>2e3?m.push(p.data.payload.payload[g].slice(0,2e3)+"...[truncated]"):m.push(p.data.payload.payload[g]);return p.data.payload.payload=m,f}return f}(s);if(this.Ri(o),this.Zt!==!0||YP(o)){if(YP(o)){var a=o.data.payload;if(a){var l=a.lastActivityTimestamp,c=a.threshold;o.timestamp=l+c}}var u=(n=this._instance.config.session_recording.compress_events)===null||n===void 0||n?function(f){if(Cv(f)<1024)return f;try{if(f.type===$o.FullSnapshot)return Ae({},f,{data:uc(f.data),cv:"2024-10"});if(f.type===$o.IncrementalSnapshot&&f.data.source===bs.Mutation)return Ae({},f,{cv:"2024-10",data:Ae({},f.data,{texts:uc(f.data.texts),attributes:uc(f.data.attributes),removes:uc(f.data.removes),adds:uc(f.data.adds)})});if(f.type===$o.IncrementalSnapshot&&f.data.source===bs.StyleSheetRule)return Ae({},f,{cv:"2024-10",data:Ae({},f.data,{adds:f.data.adds?uc(f.data.adds):void 0,removes:f.data.removes?uc(f.data.removes):void 0})})}catch(p){mi.error("could not compress event - will use uncompressed event",p)}return f}(o):o,d={$snapshot_bytes:Cv(u),$snapshot_data:u,$session_id:this.Ct,$window_id:this.fi};this.status!==Pl?this.Ui(d):this.pi()}}}}}Li(){if(!this._instance.config.capture_pageview&&J){var e=this.yi(J.location.href);this.Di!==e&&(this.ui("$url_changed",{href:e}),this.Di=e)}}Ai(){if(this.Qt.length){var e=[...this.Qt];this.Qt=[],e.forEach(n=>{Date.now()-n.enqueuedAt<=2e3&&this.Mi(n)})}}yi(e){var n=this._instance.config.session_recording;if(n.maskNetworkRequestFn){var i,r={url:e};return(i=r=n.maskNetworkRequestFn(r))==null?void 0:i.url}return e}pi(){return this.C={size:0,data:[],sessionId:this.Ct,windowId:this.fi},this.C}ai(){this.qi&&(clearTimeout(this.qi),this.qi=void 0);var e=this.Gt,n=this.Nt,i=wi(n)&&n>=0,r=wi(e)&&i&&n<e;return this.status===Wc||this.status===jC||this.status===Pl||r?(this.qi=setTimeout(()=>{this.ai()},2e3),this.C):(this.C.data.length>0&&lS(this.C).forEach(s=>{this.Bi({$snapshot_bytes:s.size,$snapshot_data:s.data,$session_id:s.sessionId,$window_id:s.windowId,$lib:"web",$lib_version:Uo.LIB_VERSION})}),this.pi())}Ui(e){var n,i=2+(((n=this.C)==null?void 0:n.data.length)||0);!this.Zt&&(this.C.size+e.$snapshot_bytes+i>943718.4||this.C.sessionId!==this.Ct)&&(this.C=this.ai()),this.C.size+=e.$snapshot_bytes,this.C.data.push(e.$snapshot_data),this.qi||this.Zt||(this.qi=setTimeout(()=>{this.ai()},2e3))}Bi(e){this._instance.capture("$snapshot",e,{_url:this._instance.requestRouter.endpointFor("api",this.vi),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}zi(e){var n;this.Lt.triggerStatus(this.sessionId)===Ci&&((n=this._instance)==null||(n=n.persistence)==null||n.register({[e==="url"?Jw:Zw]:this.Ct}),this.ai(),this.ki(e+"_trigger_matched"))}ji(){this.Kt.urlBlocked||(this.Kt.urlBlocked=!0,clearInterval(this.wi),mi.info("recording paused due to URL blocker"),this.ui("recording paused",{reason:"url blocker"}))}Ni(){this.Kt.urlBlocked&&(this.Kt.urlBlocked=!1,this.Ci(),this.Ti(),this.ui("recording resumed",{reason:"left blocked url"}),mi.info("recording resumed"))}bi(){this.Yt.Tt.length!==0&&Dt(this.ni)&&(this.ni=this._instance.on("eventCaptured",e=>{try{this.Yt.Tt.includes(e.event)&&this.zi("event")}catch(n){mi.error("Could not activate event trigger",n)}}))}overrideLinkedFlag(){this.Xt.linkedFlagSeen=!0,this.Ci(),this.ki("linked_flag_overridden")}overrideSampling(){var e;(e=this._instance.persistence)==null||e.register({[dh]:!0}),this.Ci(),this.ki("sampling_overridden")}overrideTrigger(e){this.zi(e)}ki(e,n){this._instance.register_for_session({$session_recording_start_reason:e}),mi.info(e.replace("_"," "),n),xt(["recording_initialized","session_id_changed"],e)||this.ui(e,n)}get sdkDebugProperties(){var{sessionStartTimestamp:e}=this.At.checkAndGetSessionAndWindowId(!0);return{$recording_status:this.status,$sdk_debug_replay_internal_buffer_length:this.C.data.length,$sdk_debug_replay_internal_buffer_size:this.C.size,$sdk_debug_current_session_duration:this.Nt,$sdk_debug_session_start:e}}}var W1=qn("[SegmentIntegration]");function tH(t,e){var n=t.config.segment;if(!n)return e();(function(i,r){var s=i.config.segment;if(!s)return r();var o=l=>{var c=()=>l.anonymousId()||nl();i.config.get_device_id=c,l.id()&&(i.register({distinct_id:l.id(),$device_id:c()}),i.persistence.set_property(Bo,"identified")),r()},a=s.user();"then"in a&&ts(a.then)?a.then(l=>o(l)):o(a)})(t,()=>{n.register((i=>{Promise&&Promise.resolve||W1.warn("This browser does not have Promise support, and can not use the segment integration");var r=(s,o)=>{if(!o)return s;s.event.userId||s.event.anonymousId===i.get_distinct_id()||(W1.info("No userId set, resetting PostHog"),i.reset()),s.event.userId&&s.event.userId!==i.get_distinct_id()&&(W1.info("UserId set, identifying with PostHog"),i.identify(s.event.userId));var a=i.calculateEventProperties(o,s.event.properties);return s.event.properties=Object.assign({},a,s.event.properties),s};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:s=>r(s,s.event.event),page:s=>r(s,"$pageview"),identify:s=>r(s,"$identify"),screen:s=>r(s,"$screen")}})(t)).then(()=>{e()})})}var EO="posthog-js";function AO(t,e){var{organization:n,projectId:i,prefix:r,severityAllowList:s=["error"]}=e===void 0?{}:e;return o=>{var a,l,c,u,d;if(!(s==="*"||s.includes(o.level))||!t.__loaded)return o;o.tags||(o.tags={});var f=t.requestRouter.endpointFor("ui","/project/"+t.config.token+"/person/"+t.get_distinct_id());o.tags["PostHog Person URL"]=f,t.sessionRecordingStarted()&&(o.tags["PostHog Recording URL"]=t.get_session_replay_url({withTimestamp:!0}));var p=((a=o.exception)==null?void 0:a.values)||[],m=p.map(y=>Ae({},y,{stacktrace:y.stacktrace?Ae({},y.stacktrace,{type:"raw",frames:(y.stacktrace.frames||[]).map(v=>Ae({},v,{platform:"web:javascript"}))}):void 0})),g={$exception_message:((l=p[0])==null?void 0:l.value)||o.message,$exception_type:(c=p[0])==null?void 0:c.type,$exception_personURL:f,$exception_level:o.level,$exception_list:m,$sentry_event_id:o.event_id,$sentry_exception:o.exception,$sentry_exception_message:((u=p[0])==null?void 0:u.value)||o.message,$sentry_exception_type:(d=p[0])==null?void 0:d.type,$sentry_tags:o.tags};return n&&i&&(g.$sentry_url=(r||"https://sentry.io/organizations/")+n+"/issues/?project="+i+"&query="+o.event_id),t.exceptions.sendExceptionEvent(g),o}}class nH{constructor(e,n,i,r,s){this.name=EO,this.setupOnce=function(o){o(AO(e,{organization:n,projectId:i,prefix:r,severityAllowList:s}))}}}var iH=J!=null&&J.location?kv(J.location.hash,"__posthog")||kv(location.hash,"state"):null,JP="_postHogToolbarParams",ZP=qn("[Toolbar]"),Da=function(t){return t[t.UNINITIALIZED=0]="UNINITIALIZED",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED",t}(Da||{});class rH{constructor(e){this.instance=e}Hi(e){st.ph_toolbar_state=e}Wi(){var e;return(e=st.ph_toolbar_state)!==null&&e!==void 0?e:Da.UNINITIALIZED}maybeLoadToolbar(e,n,i){if(e===void 0&&(e=void 0),n===void 0&&(n=void 0),i===void 0&&(i=void 0),!J||!Me)return!1;e=e??J.location,i=i??J.history;try{if(!n){try{J.localStorage.setItem("test","test"),J.localStorage.removeItem("test")}catch{return!1}n=J==null?void 0:J.localStorage}var r,s=iH||kv(e.hash,"__posthog")||kv(e.hash,"state"),o=s?bP(()=>JSON.parse(atob(decodeURIComponent(s))))||bP(()=>JSON.parse(decodeURIComponent(s))):null;return o&&o.action==="ph_authorize"?((r=o).source="url",r&&Object.keys(r).length>0&&(o.desiredHash?e.hash=o.desiredHash:i?i.replaceState(i.state,"",e.pathname+e.search):e.hash="")):((r=JSON.parse(n.getItem(JP)||"{}")).source="localstorage",delete r.userIntent),!(!r.token||this.instance.config.token!==r.token)&&(this.loadToolbar(r),!0)}catch{return!1}}Gi(e){var n=st.ph_load_toolbar||st.ph_load_editor;!Dt(n)&&ts(n)?n(e,this.instance):ZP.warn("No toolbar load function found")}loadToolbar(e){var n=!(Me==null||!Me.getElementById(Z4));if(!J||n)return!1;var i=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,r=Ae({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},i?{instrument:!1}:{});if(J.localStorage.setItem(JP,JSON.stringify(Ae({},r,{source:void 0}))),this.Wi()===Da.LOADED)this.Gi(r);else if(this.Wi()===Da.UNINITIALIZED){var s;this.Hi(Da.LOADING),(s=st.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this.instance,"toolbar",o=>{if(o)return ZP.error("[Toolbar] Failed to load",o),void this.Hi(Da.UNINITIALIZED);this.Hi(Da.LOADED),this.Gi(r)}),pn(J,"turbolinks:load",()=>{this.Hi(Da.UNINITIALIZED),this.loadToolbar(r)})}return!0}Ji(e){return this.loadToolbar(e)}maybeLoadEditor(e,n,i){return e===void 0&&(e=void 0),n===void 0&&(n=void 0),i===void 0&&(i=void 0),this.maybeLoadToolbar(e,n,i)}}var sH=qn("[TracingHeaders]");class oH{constructor(e){this.Vi=void 0,this.Ki=void 0,this.nt=()=>{var n,i;Se(this.Vi)&&((n=st.__PosthogExtensions__)==null||(n=n.tracingHeadersPatchFns)==null||n._patchXHR(this._instance.get_distinct_id(),this._instance.sessionManager)),Se(this.Ki)&&((i=st.__PosthogExtensions__)==null||(i=i.tracingHeadersPatchFns)==null||i._patchFetch(this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}J(e){var n,i;(n=st.__PosthogExtensions__)!=null&&n.tracingHeadersPatchFns&&e(),(i=st.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,"tracing-headers",r=>{if(r)return sH.error("failed to load script",r);e()})}startIfEnabledOrStop(){var e,n;this._instance.config.__add_tracing_headers?this.J(this.nt):((e=this.Vi)==null||e.call(this),(n=this.Ki)==null||n.call(this),this.Vi=void 0,this.Ki=void 0)}}var Pa=qn("[Web Vitals]"),QP=9e5;class aH{constructor(e){var n;this.Yi=!1,this.i=!1,this.C={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Xi=()=>{clearTimeout(this.Qi),this.C.metrics.length!==0&&(this._instance.capture("$web_vitals",this.C.metrics.reduce((i,r)=>Ae({},i,{["$web_vitals_"+r.name+"_event"]:Ae({},r),["$web_vitals_"+r.name+"_value"]:r.value}),{})),this.C={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.Zi=i=>{var r,s=(r=this._instance.sessionManager)==null?void 0:r.checkAndGetSessionAndWindowId(!0);if(Se(s))Pa.error("Could not read session ID. Dropping metrics!");else{this.C=this.C||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var o=this.te();Se(o)||(Dt(i==null?void 0:i.name)||Dt(i==null?void 0:i.value)?Pa.error("Invalid metric received",i):this.ie&&i.value>=this.ie?Pa.error("Ignoring metric with value >= "+this.ie,i):(this.C.url!==o&&(this.Xi(),this.Qi=setTimeout(this.Xi,this.flushToCaptureTimeoutMs)),Se(this.C.url)&&(this.C.url=o),this.C.firstMetricTimestamp=Se(this.C.firstMetricTimestamp)?Date.now():this.C.firstMetricTimestamp,i.attribution&&i.attribution.interactionTargetElement&&(i.attribution.interactionTargetElement=void 0),this.C.metrics.push(Ae({},i,{$current_url:o,$session_id:s.sessionId,$window_id:s.windowId,timestamp:Date.now()})),this.C.metrics.length===this.allowedMetrics.length&&this.Xi()))}},this.nt=()=>{var i,r,s,o,a=st.__PosthogExtensions__;Se(a)||Se(a.postHogWebVitalsCallbacks)||({onLCP:i,onCLS:r,onFCP:s,onINP:o}=a.postHogWebVitalsCallbacks),i&&r&&s&&o?(this.allowedMetrics.indexOf("LCP")>-1&&i(this.Zi.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&r(this.Zi.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&s(this.Zi.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&o(this.Zi.bind(this)),this.i=!0):Pa.error("web vitals callbacks not loaded - not starting")},this._instance=e,this.Yi=!((n=this._instance.persistence)==null||!n.props[SP]),this.startIfEnabled()}get allowedMetrics(){var e,n,i=wn(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return Se(i)?((n=this._instance.persistence)==null?void 0:n.props[kP])||["CLS","FCP","INP","LCP"]:i}get flushToCaptureTimeoutMs(){return(wn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get ie(){var e=wn(this._instance.config.capture_performance)&&wi(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:QP;return 0<e&&e<=6e4?QP:e}get isEnabled(){var e=tr==null?void 0:tr.protocol;if(e!=="http:"&&e!=="https:")return Pa.info("Web Vitals are disabled on non-http/https protocols"),!1;var n=wn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:fo(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return fo(n)?n:this.Yi}startIfEnabled(){this.isEnabled&&!this.i&&(Pa.info("enabled, starting..."),this.J(this.nt))}onRemoteConfig(e){var n=wn(e.capturePerformance)&&!!e.capturePerformance.web_vitals,i=wn(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[SP]:n}),this._instance.persistence.register({[kP]:i})),this.Yi=n,this.startIfEnabled()}J(e){var n,i;(n=st.__PosthogExtensions__)!=null&&n.postHogWebVitalsCallbacks&&e(),(i=st.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,"web-vitals",r=>{r?Pa.error("failed to load script",r):e()})}te(){var e=J?J.location.href:void 0;return e||Pa.error("Could not determine current URL"),e}}var lH=qn("[Heatmaps]");function eN(t){return wn(t)&&"clientX"in t&&"clientY"in t&&wi(t.clientX)&&wi(t.clientY)}class cH{constructor(e){var n;this.rageclicks=new cO,this.Yi=!1,this.i=!1,this.ee=null,this.instance=e,this.Yi=!((n=this.instance.persistence)==null||!n.props[qw])}get flushIntervalMilliseconds(){var e=5e3;return wn(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return Se(this.instance.config.capture_heatmaps)?Se(this.instance.config.enable_heatmaps)?this.Yi:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.i)return;lH.info("starting..."),this.re(),this.ee=setInterval(this.se.bind(this),this.flushIntervalMilliseconds)}else{var e,n;clearInterval((e=this.ee)!==null&&e!==void 0?e:void 0),(n=this.ne)==null||n.stop(),this.getAndClearBuffer()}}onRemoteConfig(e){var n=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[qw]:n}),this.Yi=n,this.startIfEnabled()}getAndClearBuffer(){var e=this.C;return this.C=void 0,e}oe(e){this.ae(e.originalEvent,"deadclick")}re(){J&&Me&&(pn(J,"beforeunload",this.se.bind(this)),pn(Me,"click",e=>this.ae(e||(J==null?void 0:J.event)),{capture:!0}),pn(Me,"mousemove",e=>this.le(e||(J==null?void 0:J.event)),{capture:!0}),this.ne=new dO(this.instance,hV,this.oe.bind(this)),this.ne.startIfEnabled(),this.i=!0)}ue(e,n){var i=this.instance.scrollManager.scrollY(),r=this.instance.scrollManager.scrollX(),s=this.instance.scrollManager.scrollElement(),o=function(a,l,c){for(var u=a;u&&cb(u)&&!ml(u,"body");){if(u===c)return!1;if(xt(l,J==null?void 0:J.getComputedStyle(u).position))return!0;u=iO(u)}return!1}(nO(e),["fixed","sticky"],s);return{x:e.clientX+(o?0:r),y:e.clientY+(o?0:i),target_fixed:o,type:n}}ae(e,n){var i;if(n===void 0&&(n="click"),!RP(e.target)&&eN(e)){var r=this.ue(e,n);(i=this.rageclicks)!=null&&i.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.he(Ae({},r,{type:"rageclick"})),this.he(r)}}le(e){!RP(e.target)&&eN(e)&&(clearTimeout(this.de),this.de=setTimeout(()=>{this.he(this.ue(e,"mousemove"))},500))}he(e){if(J){var n=J.location.href;this.C=this.C||{},this.C[n]||(this.C[n]=[]),this.C[n].push(e)}}se(){this.C&&!Hu(this.C)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class uH{constructor(e){this._instance=e}doPageView(e,n){var i,r=this.ve(e,n);return this.ce={pathname:(i=J==null?void 0:J.location.pathname)!==null&&i!==void 0?i:"",pageViewId:n,timestamp:e},this._instance.scrollManager.resetContext(),r}doPageLeave(e){var n;return this.ve(e,(n=this.ce)==null?void 0:n.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.ce)==null?void 0:e.pageViewId}}ve(e,n){var i=this.ce;if(!i)return{$pageview_id:n};var r={$pageview_id:n,$prev_pageview_id:i.pageViewId},s=this._instance.scrollManager.getContext();if(s&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:o,lastScrollY:a,maxScrollY:l,maxContentHeight:c,lastContentY:u,maxContentY:d}=s;if(!(Se(o)||Se(a)||Se(l)||Se(c)||Se(u)||Se(d))){o=Math.ceil(o),a=Math.ceil(a),l=Math.ceil(l),c=Math.ceil(c),u=Math.ceil(u),d=Math.ceil(d);var f=o<=1?1:_r(a/o,0,1),p=o<=1?1:_r(l/o,0,1),m=c<=1?1:_r(u/c,0,1),g=c<=1?1:_r(d/c,0,1);r=An(r,{$prev_pageview_last_scroll:a,$prev_pageview_last_scroll_percentage:f,$prev_pageview_max_scroll:l,$prev_pageview_max_scroll_percentage:p,$prev_pageview_last_content:u,$prev_pageview_last_content_percentage:m,$prev_pageview_max_content:d,$prev_pageview_max_content_percentage:g})}}return i.pathname&&(r.$prev_pageview_pathname=i.pathname),i.timestamp&&(r.$prev_pageview_duration=(e.getTime()-i.timestamp.getTime())/1e3),r}}var dH=function(t){var e,n,i,r,s="";for(e=n=0,i=(t=(t+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,r=0;r<i;r++){var o=t.charCodeAt(r),a=null;o<128?n++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),Xl(a)||(n>e&&(s+=t.substring(e,n)),s+=a,e=n=r+1)}return n>e&&(s+=t.substring(e,t.length)),s},fH=!!Ww||!!Hw,tN="text/plain",Av=(t,e)=>{var[n,i]=t.split("?"),r=Ae({},e);i==null||i.split("&").forEach(o=>{var[a]=o.split("=");delete r[a]});var s=Q7(r);return n+"?"+(s=s?(i?i+"&":"")+s:i)},ph=(t,e)=>JSON.stringify(t,(n,i)=>typeof i=="bigint"?i.toString():i,e),G1=t=>{var{data:e,compression:n}=t;if(e){if(n===ta.GZipJS){var i=SO(kO(ph(e)),{mtime:0}),r=new Blob([i],{type:tN});return{contentType:tN,body:r,estimatedSize:r.size}}if(n===ta.Base64){var s=function(l){var c,u,d,f,p,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g=0,y=0,v="",b=[];if(!l)return l;l=dH(l);do c=(p=l.charCodeAt(g++)<<16|l.charCodeAt(g++)<<8|l.charCodeAt(g++))>>18&63,u=p>>12&63,d=p>>6&63,f=63&p,b[y++]=m.charAt(c)+m.charAt(u)+m.charAt(d)+m.charAt(f);while(g<l.length);switch(v=b.join(""),l.length%3){case 1:v=v.slice(0,-2)+"==";break;case 2:v=v.slice(0,-1)+"="}return v}(ph(e)),o=(l=>"data="+encodeURIComponent(typeof l=="string"?l:ph(l)))(s);return{contentType:"application/x-www-form-urlencoded",body:o,estimatedSize:new Blob([o]).size}}var a=ph(e);return{contentType:"application/json",body:a,estimatedSize:new Blob([a]).size}}},Bh=[];Hw&&Bh.push({transport:"fetch",method:t=>{var e,n,{contentType:i,body:r,estimatedSize:s}=(e=G1(t))!==null&&e!==void 0?e:{},o=new Headers;Ut(t.headers,function(u,d){o.append(d,u)}),i&&o.append("Content-Type",i);var a=t.url,l=null;if(vP){var c=new vP;l={signal:c.signal,timeout:setTimeout(()=>c.abort(),t.timeout)}}Hw(a,Ae({method:(t==null?void 0:t.method)||"GET",headers:o,keepalive:t.method==="POST"&&(s||0)<52428.8,body:r,signal:(n=l)==null?void 0:n.signal},t.fetchOptions)).then(u=>u.text().then(d=>{var f={statusCode:u.status,text:d};if(u.status===200)try{f.json=JSON.parse(d)}catch(p){Ie.error(p)}t.callback==null||t.callback(f)})).catch(u=>{Ie.error(u),t.callback==null||t.callback({statusCode:0,text:u})}).finally(()=>l?clearTimeout(l.timeout):null)}}),Ww&&Bh.push({transport:"XHR",method:t=>{var e,n=new Ww;n.open(t.method||"GET",t.url,!0);var{contentType:i,body:r}=(e=G1(t))!==null&&e!==void 0?e:{};Ut(t.headers,function(s,o){n.setRequestHeader(o,s)}),i&&n.setRequestHeader("Content-Type",i),t.timeout&&(n.timeout=t.timeout),n.withCredentials=!0,n.onreadystatechange=()=>{if(n.readyState===4){var s={statusCode:n.status,text:n.responseText};if(n.status===200)try{s.json=JSON.parse(n.responseText)}catch{}t.callback==null||t.callback(s)}},n.send(r)}}),Cr!=null&&Cr.sendBeacon&&Bh.push({transport:"sendBeacon",method:t=>{var e=Av(t.url,{beacon:"1"});try{var n,{contentType:i,body:r}=(n=G1(t))!==null&&n!==void 0?n:{},s=typeof r=="string"?new Blob([r],{type:i}):r;Cr.sendBeacon(e,s)}catch{}}});var Ud=function(t,e){if(!function(n){try{new RegExp(n)}catch{return!1}return!0}(e))return!1;try{return new RegExp(e).test(t)}catch{return!1}};function nN(t,e,n){return ph({distinct_id:t,userPropertiesToSet:e,userPropertiesToSetOnce:n})}var hH={exact:(t,e)=>e.some(n=>t.some(i=>n===i)),is_not:(t,e)=>e.every(n=>t.every(i=>n!==i)),regex:(t,e)=>e.some(n=>t.some(i=>Ud(n,i))),not_regex:(t,e)=>e.every(n=>t.every(i=>!Ud(n,i))),icontains:(t,e)=>e.map(cg).some(n=>t.map(cg).some(i=>n.includes(i))),not_icontains:(t,e)=>e.map(cg).every(n=>t.map(cg).every(i=>!n.includes(i)))},cg=t=>t.toLowerCase(),pH=qn("[Error tracking]");class mH{constructor(e){var n,i;this.fe=[],this._instance=e,this.fe=(n=(i=this._instance.persistence)==null?void 0:i.get_property(Kw))!==null&&n!==void 0?n:[]}onRemoteConfig(e){var n,i,r=(n=(i=e.errorTracking)==null?void 0:i.suppressionRules)!==null&&n!==void 0?n:[];this.fe=r,this._instance.persistence&&this._instance.persistence.register({[Kw]:this.fe})}sendExceptionEvent(e){this.pe(e)?pH.info("Skipping exception capture because a suppression rule matched"):this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}pe(e){var n=e.$exception_list;if(!n||!ln(n)||n.length===0)return!1;var i=n.reduce((r,s)=>{var{type:o,value:a}=s;return Sn(o)&&o.length>0&&r.$exception_types.push(o),Sn(a)&&a.length>0&&r.$exception_values.push(a),r},{$exception_types:[],$exception_values:[]});return this.fe.some(r=>{var s=r.values.map(o=>{var a,l=hH[o.operator],c=ln(o.value)?o.value:[o.value],u=(a=i[o.key])!==null&&a!==void 0?a:[];return c.length>0&&l(c,u)});return r.type==="OR"?s.some(Boolean):s.every(Boolean)})}}var is="Mobile",Pv="iOS",ho="Android",dp="Tablet",PO=ho+" "+dp,NO="iPad",MO="Apple",RO=MO+" Watch",fp="Safari",Vd="BlackBerry",IO="Samsung",TO=IO+"Browser",OO=IO+" Internet",Gc="Chrome",gH=Gc+" OS",LO=Gc+" "+Pv,$C="Internet Explorer",DO=$C+" "+is,FC="Opera",vH=FC+" Mini",zC="Edge",jO="Microsoft "+zC,fd="Firefox",BO=fd+" "+Pv,hp="Nintendo",pp="PlayStation",hd="Xbox",$O=ho+" "+is,FO=is+" "+fp,mh="Windows",mS=mh+" Phone",iN="Nokia",gS="Ouya",zO="Generic",yH=zO+" "+is.toLowerCase(),UO=zO+" "+dp.toLowerCase(),vS="Konqueror",Ai="(\\d+(\\.\\d+)?)",X1=new RegExp("Version/"+Ai),bH=new RegExp(hd,"i"),xH=new RegExp(pp+" \\w+","i"),wH=new RegExp(hp+" \\w+","i"),UC=new RegExp(Vd+"|PlayBook|BB10","i"),SH={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},kH=(t,e)=>e&&xt(e,MO)||function(n){return xt(n,fp)&&!xt(n,Gc)&&!xt(n,ho)}(t),VO=function(t,e){return e=e||"",xt(t," OPR/")&&xt(t,"Mini")?vH:xt(t," OPR/")?FC:UC.test(t)?Vd:xt(t,"IE"+is)||xt(t,"WPDesktop")?DO:xt(t,TO)?OO:xt(t,zC)||xt(t,"Edg/")?jO:xt(t,"FBIOS")?"Facebook "+is:xt(t,"UCWEB")||xt(t,"UCBrowser")?"UC Browser":xt(t,"CriOS")?LO:xt(t,"CrMo")||xt(t,Gc)?Gc:xt(t,ho)&&xt(t,fp)?$O:xt(t,"FxiOS")?BO:xt(t.toLowerCase(),vS.toLowerCase())?vS:kH(t,e)?xt(t,is)?FO:fp:xt(t,fd)?fd:xt(t,"MSIE")||xt(t,"Trident/")?$C:xt(t,"Gecko")?fd:""},CH={[DO]:[new RegExp("rv:"+Ai)],[jO]:[new RegExp(zC+"?\\/"+Ai)],[Gc]:[new RegExp("("+Gc+"|CrMo)\\/"+Ai)],[LO]:[new RegExp("CriOS\\/"+Ai)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+Ai)],[fp]:[X1],[FO]:[X1],[FC]:[new RegExp("(Opera|OPR)\\/"+Ai)],[fd]:[new RegExp(fd+"\\/"+Ai)],[BO]:[new RegExp("FxiOS\\/"+Ai)],[vS]:[new RegExp("Konqueror[:/]?"+Ai,"i")],[Vd]:[new RegExp(Vd+" "+Ai),X1],[$O]:[new RegExp("android\\s"+Ai,"i")],[OO]:[new RegExp(TO+"\\/"+Ai)],[$C]:[new RegExp("(rv:|MSIE )"+Ai)],Mozilla:[new RegExp("rv:"+Ai)]},_H=function(t,e){var n=VO(t,e),i=CH[n];if(Se(i))return null;for(var r=0;r<i.length;r++){var s=i[r],o=t.match(s);if(o)return parseFloat(o[o.length-2])}return null},rN=[[new RegExp(hd+"; "+hd+" (.*?)[);]","i"),t=>[hd,t&&t[1]||""]],[new RegExp(hp,"i"),[hp,""]],[new RegExp(pp,"i"),[pp,""]],[UC,[Vd,""]],[new RegExp(mh,"i"),(t,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[mS,""];if(new RegExp(is).test(e)&&!/IEMobile\b/.test(e))return[mh+" "+is,""];var n=/Windows NT ([0-9.]+)/i.exec(e);if(n&&n[1]){var i=n[1],r=SH[i]||"";return/arm/i.test(e)&&(r="RT"),[mh,r]}return[mh,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,t=>{if(t&&t[3]){var e=[t[3],t[4],t[5]||"0"];return[Pv,e.join(".")]}return[Pv,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,t=>{var e="";return t&&t.length>=3&&(e=Se(t[2])?t[3]:t[2]),["watchOS",e]}],[new RegExp("("+ho+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+ho+")","i"),t=>{if(t&&t[2]){var e=[t[2],t[3],t[4]||"0"];return[ho,e.join(".")]}return[ho,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,t=>{var e=["Mac OS X",""];if(t&&t[1]){var n=[t[1],t[2],t[3]||"0"];e[1]=n.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[gH,""]],[/Linux|debian/i,["Linux",""]]],sN=function(t){return wH.test(t)?hp:xH.test(t)?pp:bH.test(t)?hd:new RegExp(gS,"i").test(t)?gS:new RegExp("("+mS+"|WPDesktop)","i").test(t)?mS:/iPad/.test(t)?NO:/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(t)?RO:UC.test(t)?Vd:/(kobo)\s(ereader|touch)/i.test(t)?"Kobo":new RegExp(iN,"i").test(t)?iN:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(t)||/(kf[a-z]+)( bui|\)).+silk\//i.test(t)?"Kindle Fire":/(Android|ZTE)/i.test(t)?!new RegExp(is).test(t)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(t)?/pixel[\daxl ]{1,6}/i.test(t)&&!/pixel c/i.test(t)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(t)||/lmy47v/i.test(t)&&!/QTAQZ3/i.test(t)?ho:PO:ho:new RegExp("(pda|"+is+")","i").test(t)?yH:new RegExp(dp,"i").test(t)&&!new RegExp(dp+" pc","i").test(t)?UO:""},ug="https?://(.*)",db=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],EH=lb(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],db),VC="<masked>",AH=["li_fat_id"];function HO(t,e,n){if(!Me)return{};var i,r=e?lb([],db,n||[]):[],s=WO(IC(Me.URL,r,VC),t),o=(i={},Ut(AH,function(a){var l=xo.D(a);i[a]=l||null}),i);return An(o,s)}function WO(t,e){var n=EH.concat(e||[]),i={};return Ut(n,function(r){var s=Sv(t,r);i[r]=s||null}),i}function GO(t){var e=function(s){return s?s.search(ug+"google.([^/?]*)")===0?"google":s.search(ug+"bing.com")===0?"bing":s.search(ug+"yahoo.com")===0?"yahoo":s.search(ug+"duckduckgo.com")===0?"duckduckgo":null:null}(t),n=e!="yahoo"?"q":"p",i={};if(!Xl(e)){i.$search_engine=e;var r=Me?Sv(Me.referrer,n):"";r.length&&(i.ph_keyword=r)}return i}function oN(){return navigator.language||navigator.userLanguage}function XO(){return(Me==null?void 0:Me.referrer)||"$direct"}function qO(t,e){var n=t?lb([],db,e||[]):[],i=tr==null?void 0:tr.href.substring(0,1e3);return{r:XO().substring(0,1e3),u:i?IC(i,n,VC):void 0}}function KO(t){var e,{r:n,u:i}=t,r={$referrer:n,$referring_domain:n==null?void 0:n=="$direct"?"$direct":(e=Fd(n))==null?void 0:e.host};if(i){r.$current_url=i;var s=Fd(i);r.$host=s==null?void 0:s.host,r.$pathname=s==null?void 0:s.pathname;var o=WO(i);An(r,o)}if(n){var a=GO(n);An(r,a)}return r}function YO(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function PH(){try{return new Date().getTimezoneOffset()}catch{return}}function NH(t,e){if(!Qi)return{};var n,i,r,s=t?lb([],db,e||[]):[],[o,a]=function(l){for(var c=0;c<rN.length;c++){var[u,d]=rN[c],f=u.exec(l),p=f&&(ts(d)?d(f,l):d);if(p)return p}return["",""]}(Qi);return An(MC({$os:o,$os_version:a,$browser:VO(Qi,navigator.vendor),$device:sN(Qi),$device_type:(i=Qi,r=sN(i),r===NO||r===PO||r==="Kobo"||r==="Kindle Fire"||r===UO?dp:r===hp||r===hd||r===pp||r===gS?"Console":r===RO?"Wearable":r?is:"Desktop"),$timezone:YO(),$timezone_offset:PH()}),{$current_url:IC(tr==null?void 0:tr.href,s,VC),$host:tr==null?void 0:tr.host,$pathname:tr==null?void 0:tr.pathname,$raw_user_agent:Qi.length>1e3?Qi.substring(0,997)+"...":Qi,$browser_version:_H(Qi,navigator.vendor),$browser_language:oN(),$browser_language_prefix:(n=oN(),typeof n=="string"?n.split("-")[0]:void 0),$screen_height:J==null?void 0:J.screen.height,$screen_width:J==null?void 0:J.screen.width,$viewport_height:J==null?void 0:J.innerHeight,$viewport_width:J==null?void 0:J.innerWidth,$lib:"web",$lib_version:Uo.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var qs=qn("[FeatureFlags]"),q1="$active_feature_flags",bu="$override_feature_flags",aN="$feature_flag_payloads",Ff="$override_feature_flag_payloads",lN="$feature_flag_request_id",cN=t=>{var e={};for(var[n,i]of R0(t||{}))i&&(e[n]=i);return e},MH=t=>{var e=t.flags;return e?(t.featureFlags=Object.fromEntries(Object.keys(e).map(n=>{var i;return[n,(i=e[n].variant)!==null&&i!==void 0?i:e[n].enabled]})),t.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter(n=>e[n].enabled).filter(n=>{var i;return(i=e[n].metadata)==null?void 0:i.payload}).map(n=>{var i;return[n,(i=e[n].metadata)==null?void 0:i.payload]}))):qs.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),t},RH=function(t){return t.FeatureFlags="feature_flags",t.Recordings="recordings",t}({}),uN=new Set(["7c6f7b45","66c1f69c","2727f65a","f3287528","8cc9a311","eb9f671b","c0e1c6f9","057989ec","723f4019","7b102104","563359d3","bad973ea","f6f2c4f4","59454a61","89ad1076","4edd0da1","26c52e72","a970bd2e","89cf4454","16e2b4e7","fba0e7b6","301c8488","bc65d69e","fe66a3c5","37926ca6","52a196df","d32a7577","42c4c9ef","6883bd5a","04809ff7","e59430a8","61be3dd8","7fa5500b","bf027177","8cfdba9b","96f6df5f","569798e9","0ebc61a5","1b5d7b92","17ebb0a4","f97ea965","85cc817b","3044dfc1","0c3fe5c3","b1f95fa3","8a6342e8","72365c68","12d34ad9","733853ec","3beeb69a","0645bb64","32de7f98","5dcbee21","3fe85053","ad960278","9466e5dd","7ca97b2d","2ee2a65c","28fde5f2","85c52f49","0ad823f4","f11b6cc9","aacf8af9","ab3e62b3","3a85ff15","8a67d3c4","f5e91ef1","4b873698","c5dae949","5b643d76","9599c892","34377448","2189e408","3be9ad53","1a14ce7c","2a164ded","8d53ea86","53bdb37d","bfc3f590","8df38ede","bdb81e49","38fde5c0","8d707e6d","73cbc496","f9d8a5ef","d3a9f8c4","a980d8cd","5bcfe086","e4818f68","4f11fb39","a13c6ae3","150c7fbb","98f3d658","f84f7377","1924dd9c","1f6b63b3","24748755","7c0f717c","8a87f11b","49f57f22","3c9e9234","3772f65b","dff631b6","cd609d40","f853c7f7","952db5ee","c5aa8a79","2d21b6fd","79b7164c","4110e26c","a7d3b43f","84e1b8f6","75cc0998","07f78e33","10ca9b1a","ce441b18","01eb8256","c0ac4b67","8e8e5216","db7943dd","fa133a95","498a4508","21bbda67","7dbfed69","be3ec24c","fc80b8e2"]);class IH{constructor(e){this.ge=!1,this._e=!1,this.me=!1,this.be=!1,this.ye=!1,this.we=!1,this.Se=!1,this._instance=e,this.featureFlagEventHandlers=[]}flags(){if(this._instance.config.__preview_remote_config)this.we=!0;else{var e=!this.$e&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.ke({disableFlags:e})}}get hasLoadedFlags(){return this._e}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(Qw),n=this._instance.get_property(bu),i=this._instance.get_property(Ff);if(!i&&!n)return e||{};var r=An({},e||{}),s=[...new Set([...Object.keys(i||{}),...Object.keys(n||{})])];for(var o of s){var a,l,c=r[o],u=n==null?void 0:n[o],d=Se(u)?(a=c==null?void 0:c.enabled)!==null&&a!==void 0&&a:!!u,f=Se(u)?c.variant:typeof u=="string"?u:void 0,p=i==null?void 0:i[o],m=Ae({},c,{enabled:d,variant:d?f??(c==null?void 0:c.variant):void 0});d!==(c==null?void 0:c.enabled)&&(m.original_enabled=c==null?void 0:c.enabled),f!==(c==null?void 0:c.variant)&&(m.original_variant=c==null?void 0:c.variant),p&&(m.metadata=Ae({},c==null?void 0:c.metadata,{payload:p,original_payload:c==null||(l=c.metadata)==null?void 0:l.payload})),r[o]=m}return this.ge||(qs.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:i,finalDetails:r}),this.ge=!0),r}getFlagVariants(){var e=this._instance.get_property(Wu),n=this._instance.get_property(bu);if(!n)return e||{};for(var i=An({},e),r=Object.keys(n),s=0;s<r.length;s++)i[r[s]]=n[r[s]];return this.ge||(qs.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:n,finalFlags:i}),this.ge=!0),i}getFlagPayloads(){var e=this._instance.get_property(aN),n=this._instance.get_property(Ff);if(!n)return e||{};for(var i=An({},e||{}),r=Object.keys(n),s=0;s<r.length;s++)i[r[s]]=n[r[s]];return this.ge||(qs.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:n,finalPayloads:i}),this.ge=!0),i}reloadFeatureFlags(){this.be||this._instance.config.advanced_disable_feature_flags||this.$e||(this.$e=setTimeout(()=>{this.ke()},5))}xe(){clearTimeout(this.$e),this.$e=void 0}ensureFlagsLoaded(){this._e||this.me||this.$e||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.be=e}ke(e){var n;if(this.xe(),!this._instance.I())if(this.me)this.ye=!0;else{var i={token:this._instance.config.token,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:Ae({},((n=this._instance.persistence)==null?void 0:n.get_initial_props())||{},this._instance.get_property(fh)||{}),group_properties:this._instance.get_property(xc)};(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(i.disable_flags=!0);var r=this._instance.config.__preview_flags_v2&&this._instance.config.__preview_remote_config,s=function(l){var c=function(u){for(var d=2166136261,f=0;f<u.length;f++)d^=u.charCodeAt(f),d+=(d<<1)+(d<<4)+(d<<7)+(d<<8)+(d<<24);return("00000000"+(d>>>0).toString(16)).slice(-8)}(l);return uN==null?void 0:uN.has(c)}(this._instance.config.token)?"/decide?v=4":r?"/flags/?v=2":"/flags/?v=2&config=true",o=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",a=this._instance.requestRouter.endpointFor("api",s+o);r&&(i.timezone=YO()),this.me=!0,this._instance.Ee({method:"POST",url:a,data:i,compression:this._instance.config.disable_compression?void 0:ta.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:l=>{var c,u,d=!0;if(l.statusCode===200&&(this.ye||(this.$anon_distinct_id=void 0),d=!1),this.me=!1,this.we||(this.we=!0,this._instance.Ie((u=l.json)!==null&&u!==void 0?u:{})),!i.disable_flags||this.ye)if(this.Se=!d,l.json&&(c=l.json.quotaLimited)!=null&&c.includes(RH.FeatureFlags))qs.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var f;i.disable_flags||this.receivedFeatureFlags((f=l.json)!==null&&f!==void 0?f:{},d),this.ye&&(this.ye=!1,this.ke())}}})}}getFeatureFlag(e,n){if(n===void 0&&(n={}),this._e||this.getFlags()&&this.getFlags().length>0){var i=this.getFlagVariants()[e],r=""+i,s=this._instance.get_property(lN)||void 0,o=this._instance.get_property(yv)||{};if((n.send_event||!("send_event"in n))&&(!(e in o)||!o[e].includes(r))){var a,l,c,u,d,f,p,m,g;ln(o[e])?o[e].push(r):o[e]=[r],(a=this._instance.persistence)==null||a.register({[yv]:o});var y=this.getFeatureFlagDetails(e),v={$feature_flag:e,$feature_flag_response:i,$feature_flag_payload:this.getFeatureFlagPayload(e)||null,$feature_flag_request_id:s,$feature_flag_bootstrapped_response:((l=this._instance.config.bootstrap)==null||(l=l.featureFlags)==null?void 0:l[e])||null,$feature_flag_bootstrapped_payload:((c=this._instance.config.bootstrap)==null||(c=c.featureFlagPayloads)==null?void 0:c[e])||null,$used_bootstrap_value:!this.Se};Se(y==null||(u=y.metadata)==null?void 0:u.version)||(v.$feature_flag_version=y.metadata.version);var b,w=(d=y==null||(f=y.reason)==null?void 0:f.description)!==null&&d!==void 0?d:y==null||(p=y.reason)==null?void 0:p.code;w&&(v.$feature_flag_reason=w),y!=null&&(m=y.metadata)!=null&&m.id&&(v.$feature_flag_id=y.metadata.id),Se(y==null?void 0:y.original_variant)&&Se(y==null?void 0:y.original_enabled)||(v.$feature_flag_original_response=Se(y.original_variant)?y.original_enabled:y.original_variant),y!=null&&(g=y.metadata)!=null&&g.original_payload&&(v.$feature_flag_original_payload=y==null||(b=y.metadata)==null?void 0:b.original_payload),this._instance.capture("$feature_flag_called",v)}return i}qs.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){return this.getFlagPayloads()[e]}getRemoteConfigPayload(e,n){var i=this._instance.config.token;this._instance.Ee({method:"POST",url:this._instance.requestRouter.endpointFor("api","/flags/?v=2&config=true"),data:{distinct_id:this._instance.get_distinct_id(),token:i},compression:this._instance.config.disable_compression?void 0:ta.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:r=>{var s,o=(s=r.json)==null?void 0:s.featureFlagPayloads;n((o==null?void 0:o[e])||void 0)}})}isFeatureEnabled(e,n){if(n===void 0&&(n={}),this._e||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(e,n);qs.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(n=>n!==e)}receivedFeatureFlags(e,n){if(this._instance.persistence){this._e=!0;var i=this.getFlagVariants(),r=this.getFlagPayloads(),s=this.getFlagsWithDetails();(function(o,a,l,c,u){l===void 0&&(l={}),c===void 0&&(c={}),u===void 0&&(u={});var d=MH(o),f=d.flags,p=d.featureFlags,m=d.featureFlagPayloads;if(p){var g=o.requestId;if(ln(p)){qs.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var y={};if(p)for(var v=0;v<p.length;v++)y[p[v]]=!0;a&&a.register({[q1]:p,[Wu]:y})}else{var b=p,w=m,k=f;o.errorsWhileComputingFlags&&(b=Ae({},l,b),w=Ae({},c,w),k=Ae({},u,k)),a&&a.register(Ae({[q1]:Object.keys(cN(b)),[Wu]:b||{},[aN]:w||{},[Qw]:k||{}},g?{[lN]:g}:{}))}}})(e,this._instance.persistence,i,r,s),this.Pe(n)}}override(e,n){n===void 0&&(n=!1),qs.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:n})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return qs.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(bu),this._instance.persistence.unregister(Ff),void this.Pe();if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var n,i=e;if(this.ge=!!((n=i.suppressWarning)!==null&&n!==void 0&&n),"flags"in i){if(i.flags===!1)this._instance.persistence.unregister(bu);else if(i.flags)if(ln(i.flags)){for(var r={},s=0;s<i.flags.length;s++)r[i.flags[s]]=!0;this._instance.persistence.register({[bu]:r})}else this._instance.persistence.register({[bu]:i.flags})}return"payloads"in i&&(i.payloads===!1?this._instance.persistence.unregister(Ff):i.payloads&&this._instance.persistence.register({[Ff]:i.payloads})),void this.Pe()}this.Pe()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this._e){var{flags:n,flagVariants:i}=this.Re();e(n,i)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,n){var i,r=(this._instance.get_property(I0)||[]).find(l=>l.flagKey===e),s={["$feature_enrollment/"+e]:n},o={$feature_flag:e,$feature_enrollment:n,$set:s};r&&(o.$early_access_feature_name=r.name),this._instance.capture("$feature_enrollment_update",o),this.setPersonPropertiesForFlags(s,!1);var a=Ae({},this.getFlagVariants(),{[e]:n});(i=this._instance.persistence)==null||i.register({[q1]:Object.keys(cN(a)),[Wu]:a}),this.Pe()}getEarlyAccessFeatures(e,n,i){n===void 0&&(n=!1);var r=this._instance.get_property(I0),s=i?"&"+i.map(o=>"stage="+o).join("&"):"";if(r&&!n)return e(r);this._instance.Ee({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+s),method:"GET",callback:o=>{var a;if(o.json){var l=o.json.earlyAccessFeatures;return(a=this._instance.persistence)==null||a.register({[I0]:l}),e(l)}}})}Re(){var e=this.getFlags(),n=this.getFlagVariants();return{flags:e.filter(i=>n[i]),flagVariants:Object.keys(n).filter(i=>n[i]).reduce((i,r)=>(i[r]=n[r],i),{})}}Pe(e){var{flags:n,flagVariants:i}=this.Re();this.featureFlagEventHandlers.forEach(r=>r(n,i,{errorsLoading:e}))}setPersonPropertiesForFlags(e,n){n===void 0&&(n=!0);var i=this._instance.get_property(fh)||{};this._instance.register({[fh]:Ae({},i,e)}),n&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(fh)}setGroupPropertiesForFlags(e,n){n===void 0&&(n=!0);var i=this._instance.get_property(xc)||{};Object.keys(i).length!==0&&Object.keys(i).forEach(r=>{i[r]=Ae({},i[r],e[r]),delete e[r]}),this._instance.register({[xc]:Ae({},i,e)}),n&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var n=this._instance.get_property(xc)||{};this._instance.register({[xc]:Ae({},n,{[e]:{}})})}else this._instance.unregister(xc)}}var TH=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class K1{constructor(e){this.S=e,this.props={},this.Te=!1,this.Me=(n=>{var i="";return n.token&&(i=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+i+"_posthog"})(e),this.B=this.Ce(e),this.load(),e.debug&&Ie.info("Persistence loaded",e.persistence,Ae({},this.props)),this.update_config(e,e),this.save()}Ce(e){TH.indexOf(e.persistence.toLowerCase())===-1&&(Ie.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var n=e.persistence.toLowerCase();return n==="localstorage"&&jn.O()?jn:n==="localstorage+cookie"&&ng.O()?ng:n==="sessionstorage"&&ii.O()?ii:n==="memory"?dV:n==="cookie"?xo:ng.O()?ng:xo}properties(){var e={};return Ut(this.props,function(n,i){if(i===Wu&&wn(n))for(var r=Object.keys(n),s=0;s<r.length;s++)e["$feature/"+r[s]]=n[r[s]];else a=i,l=!1,(Xl(o=H7)?l:gP&&o.indexOf===gP?o.indexOf(a)!=-1:(Ut(o,function(c){if(l||(l=c===a))return gv}),l))||(e[i]=n);var o,a,l}),e}load(){if(!this.Fe){var e=this.B.L(this.Me);e&&(this.props=An({},e))}}save(){this.Fe||this.B.j(this.Me,this.props,this.Oe,this.Ae,this.De,this.S.debug)}remove(){this.B.N(this.Me,!1),this.B.N(this.Me,!0)}clear(){this.remove(),this.props={}}register_once(e,n,i){if(wn(e)){Se(n)&&(n="None"),this.Oe=Se(i)?this.Le:i;var r=!1;if(Ut(e,(s,o)=>{this.props.hasOwnProperty(o)&&this.props[o]!==n||(this.props[o]=s,r=!0)}),r)return this.save(),!0}return!1}register(e,n){if(wn(e)){this.Oe=Se(n)?this.Le:n;var i=!1;if(Ut(e,(r,s)=>{e.hasOwnProperty(s)&&this.props[s]!==r&&(this.props[s]=r,i=!0)}),i)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.Te){var e=HO(this.S.custom_campaign_params,this.S.mask_personal_data_properties,this.S.custom_personal_data_properties);Hu(MC(e))||this.register(e),this.Te=!0}}update_search_keyword(){var e;this.register((e=Me==null?void 0:Me.referrer)?GO(e):{})}update_referrer_info(){var e;this.register_once({$referrer:XO(),$referring_domain:Me!=null&&Me.referrer&&((e=Fd(Me.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[iS]||this.props[rS]||this.register_once({[bv]:qO(this.S.mask_personal_data_properties,this.S.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};Ut([rS,iS],o=>{var a=this.props[o];a&&Ut(a,function(l,c){e["$initial_"+Gw(c)]=l})});var n,i,r=this.props[bv];if(r){var s=(n=KO(r),i={},Ut(n,function(o,a){i["$initial_"+Gw(a)]=o}),i);An(e,s)}return e}safe_merge(e){return Ut(this.props,function(n,i){i in e||(e[i]=n)}),e}update_config(e,n){if(this.Le=this.Oe=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==n.persistence){var i=this.Ce(e),r=this.props;this.clear(),this.B=i,this.props=r,this.save()}}set_disabled(e){this.Fe=e,this.Fe?this.remove():this.save()}set_cross_subdomain(e){e!==this.Ae&&(this.Ae=e,this.remove(),this.save())}set_secure(e){e!==this.De&&(this.De=e,this.remove(),this.save())}set_event_timer(e,n){var i=this.props[uh]||{};i[e]=n,this.props[uh]=i,this.save()}remove_event_timer(e){var n=(this.props[uh]||{})[e];return Se(n)||(delete this.props[uh][e],this.save()),n}get_property(e){return this.props[e]}set_property(e,n){this.props[e]=n,this.save()}}class JO{constructor(){this.je={},this.je={}}on(e,n){return this.je[e]||(this.je[e]=[]),this.je[e].push(n),()=>{this.je[e]=this.je[e].filter(i=>i!==n)}}emit(e,n){for(var i of this.je[e]||[])i(n);for(var r of this.je["*"]||[])r(e,n)}}class Ec{constructor(e){this.Ne=new JO,this.ze=(n,i)=>this.Ue(n,i)&&this.qe(n,i)&&this.Be(n,i),this.Ue=(n,i)=>i==null||!i.event||(n==null?void 0:n.event)===(i==null?void 0:i.event),this._instance=e,this.He=new Set,this.We=new Set}init(){var e;if(!Se((e=this._instance)==null?void 0:e.Ge)){var n;(n=this._instance)==null||n.Ge((i,r)=>{this.on(i,r)})}}register(e){var n,i;if(!Se((n=this._instance)==null?void 0:n.Ge)&&(e.forEach(o=>{var a,l;(a=this.We)==null||a.add(o),(l=o.steps)==null||l.forEach(c=>{var u;(u=this.He)==null||u.add((c==null?void 0:c.event)||"")})}),(i=this._instance)!=null&&i.autocapture)){var r,s=new Set;e.forEach(o=>{var a;(a=o.steps)==null||a.forEach(l=>{l!=null&&l.selector&&s.add(l==null?void 0:l.selector)})}),(r=this._instance)==null||r.autocapture.setElementSelectors(s)}}on(e,n){var i;n!=null&&e.length!=0&&(this.He.has(e)||this.He.has(n==null?void 0:n.event))&&this.We&&((i=this.We)==null?void 0:i.size)>0&&this.We.forEach(r=>{this.Je(n,r)&&this.Ne.emit("actionCaptured",r.name)})}Ve(e){this.onAction("actionCaptured",n=>e(n))}Je(e,n){if((n==null?void 0:n.steps)==null)return!1;for(var i of n.steps)if(this.ze(e,i))return!0;return!1}onAction(e,n){return this.Ne.on(e,n)}qe(e,n){if(n!=null&&n.url){var i,r=e==null||(i=e.properties)==null?void 0:i.$current_url;if(!r||typeof r!="string"||!Ec.Ke(r,n==null?void 0:n.url,(n==null?void 0:n.url_matching)||"contains"))return!1}return!0}static Ke(e,n,i){switch(i){case"regex":return!!J&&Ud(e,n);case"exact":return n===e;case"contains":var r=Ec.Ye(n).replace(/_/g,".").replace(/%/g,".*");return Ud(e,r);default:return!1}}static Ye(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}Be(e,n){if((n!=null&&n.href||n!=null&&n.tag_name||n!=null&&n.text)&&!this.Xe(e).some(s=>!(n!=null&&n.href&&!Ec.Ke(s.href||"",n==null?void 0:n.href,(n==null?void 0:n.href_matching)||"exact"))&&(n==null||!n.tag_name||s.tag_name===(n==null?void 0:n.tag_name))&&!(n!=null&&n.text&&!Ec.Ke(s.text||"",n==null?void 0:n.text,(n==null?void 0:n.text_matching)||"exact")&&!Ec.Ke(s.$el_text||"",n==null?void 0:n.text,(n==null?void 0:n.text_matching)||"exact"))))return!1;if(n!=null&&n.selector){var i,r=e==null||(i=e.properties)==null?void 0:i.$element_selectors;if(!r||!r.includes(n==null?void 0:n.selector))return!1}return!0}Xe(e){return(e==null?void 0:e.properties.$elements)==null?[]:e==null?void 0:e.properties.$elements}}var Hn=qn("[Surveys]"),yS="seenSurvey_",OH=(t,e)=>{var n="$survey_"+e+"/"+t.id;return t.current_iteration&&t.current_iteration>0&&(n="$survey_"+e+"/"+t.id+"/"+t.current_iteration),n};class LH{constructor(e){this._instance=e,this.Qe=new Map,this.Ze=new Map}register(e){var n;Se((n=this._instance)==null?void 0:n.Ge)||(this.tr(e),this.ir(e))}ir(e){var n=e.filter(i=>{var r,s;return((r=i.conditions)==null?void 0:r.actions)&&((s=i.conditions)==null||(s=s.actions)==null||(s=s.values)==null?void 0:s.length)>0});n.length!==0&&(this.er==null&&(this.er=new Ec(this._instance),this.er.init(),this.er.Ve(i=>{this.onAction(i)})),n.forEach(i=>{var r,s,o,a,l;i.conditions&&(r=i.conditions)!=null&&r.actions&&(s=i.conditions)!=null&&(s=s.actions)!=null&&s.values&&((o=i.conditions)==null||(o=o.actions)==null||(o=o.values)==null?void 0:o.length)>0&&((a=this.er)==null||a.register(i.conditions.actions.values),(l=i.conditions)==null||(l=l.actions)==null||(l=l.values)==null||l.forEach(c=>{if(c&&c.name){var u=this.Ze.get(c.name);u&&u.push(i.id),this.Ze.set(c.name,u||[i.id])}}))}))}tr(e){var n;e.filter(i=>{var r,s;return((r=i.conditions)==null?void 0:r.events)&&((s=i.conditions)==null||(s=s.events)==null||(s=s.values)==null?void 0:s.length)>0}).length!==0&&((n=this._instance)==null||n.Ge((i,r)=>{this.onEvent(i,r)}),e.forEach(i=>{var r;(r=i.conditions)==null||(r=r.events)==null||(r=r.values)==null||r.forEach(s=>{if(s&&s.name){var o=this.Qe.get(s.name);o&&o.push(i.id),this.Qe.set(s.name,o||[i.id])}})}))}onEvent(e,n){var i,r=((i=this._instance)==null||(i=i.persistence)==null?void 0:i.props[eg])||[];if(e==="survey shown"&&n&&r.length>0){var s;Hn.info("survey event matched, removing survey from activated surveys",{event:e,eventPayload:n,existingActivatedSurveys:r});var o=n==null||(s=n.properties)==null?void 0:s.$survey_id;if(o){var a=r.indexOf(o);a>=0&&(r.splice(a,1),this.rr(r))}}else this.Qe.has(e)&&(Hn.info("survey event matched, updating activated surveys",{event:e,surveys:this.Qe.get(e)}),this.rr(r.concat(this.Qe.get(e)||[])))}onAction(e){var n,i=((n=this._instance)==null||(n=n.persistence)==null?void 0:n.props[eg])||[];this.Ze.has(e)&&this.rr(i.concat(this.Ze.get(e)||[]))}rr(e){var n;(n=this._instance)==null||(n=n.persistence)==null||n.register({[eg]:[...new Set(e)]})}getSurveys(){var e,n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[eg];return n||[]}getEventToSurveys(){return this.Qe}sr(){return this.er}}class DH{constructor(e){this.nr=void 0,this.ar=null,this.lr=!1,this.ur=!1,this.hr=[],this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){var n=e.surveys;if(Dt(n))return Hn.warn("Flags not loaded yet. Not loading surveys.");var i=ln(n);this.nr=i?n.length>0:n,Hn.info("flags response received, isSurveysEnabled: "+this.nr),this.loadIfEnabled()}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],n=0;n<localStorage.length;n++){var i=localStorage.key(n);(i!=null&&i.startsWith(yS)||i!=null&&i.startsWith("inProgressSurvey_"))&&e.push(i)}e.forEach(r=>localStorage.removeItem(r))}loadIfEnabled(){if(!this.ar)if(this.ur)Hn.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)Hn.info("Disabled. Not loading surveys.");else{var e=st==null?void 0:st.__PosthogExtensions__;if(e){var n=this.nr;if(!Se(n)){this.ur=!0;try{var i=e.generateSurveys;if(i)return void this.dr(i,n);var r=e.loadExternalDependency;if(!r)return void this.vr("PostHog loadExternalDependency extension not found.");r(this._instance,"surveys",s=>{s||!e.generateSurveys?this.vr("Could not load surveys script",s):this.dr(e.generateSurveys,n)})}catch(s){throw this.vr("Error initializing surveys",s),s}finally{this.ur=!1}}}else Hn.error("PostHog Extensions not found.")}}dr(e,n){this.ar=e(this._instance,n),this._surveyEventReceiver=new LH(this._instance),Hn.info("Surveys loaded successfully"),this.cr({isLoaded:!0})}vr(e,n){Hn.error(e,n),this.cr({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.hr.push(e),this.ar&&this.cr({isLoaded:!0}),()=>{this.hr=this.hr.filter(n=>n!==e)}}getSurveys(e,n){if(n===void 0&&(n=!1),this._instance.config.disable_surveys)return Hn.info("Disabled. Not loading surveys."),e([]);var i=this._instance.get_property(eS);if(i&&!n)return e(i,{isLoaded:!0});if(this.lr)return e([],{isLoaded:!1,error:"Surveys are already being loaded"});try{this.lr=!0,this._instance.Ee({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:r=>{var s;this.lr=!1;var o=r.statusCode;if(o!==200||!r.json){var a="Surveys API could not be loaded, status: "+o;return Hn.error(a),e([],{isLoaded:!1,error:a})}var l,c=r.json.surveys||[],u=c.filter(d=>function(f){return!(!f.start_date||f.end_date)}(d)&&(function(f){var p;return!((p=f.conditions)==null||(p=p.events)==null||(p=p.values)==null||!p.length)}(d)||function(f){var p;return!((p=f.conditions)==null||(p=p.actions)==null||(p=p.values)==null||!p.length)}(d)));return u.length>0&&((l=this._surveyEventReceiver)==null||l.register(u)),(s=this._instance.persistence)==null||s.register({[eS]:c}),e(c,{isLoaded:!0})}})}catch(r){throw this.lr=!1,r}}cr(e){for(var n of this.hr)try{e.isLoaded?this.getSurveys(n):n([],e)}catch(i){Hn.error("Error in survey callback",i)}}getActiveMatchingSurveys(e,n){if(n===void 0&&(n=!1),!Dt(this.ar))return this.ar.getActiveMatchingSurveys(e,n);Hn.warn("init was not called")}pr(e){var n=null;return this.getSurveys(i=>{var r;n=(r=i.find(s=>s.id===e))!==null&&r!==void 0?r:null}),n}gr(e){if(Dt(this.ar))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var n=typeof e=="string"?this.pr(e):e;return n?this.ar.checkSurveyEligibility(n):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(Dt(this.ar))return Hn.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var n=this.gr(e);return{visible:n.eligible,disabledReason:n.reason}}canRenderSurveyAsync(e,n){return Dt(this.ar)?(Hn.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise(i=>{this.getSurveys(r=>{var s,o=(s=r.find(l=>l.id===e))!==null&&s!==void 0?s:null;if(o){var a=this.gr(o);i({visible:a.eligible,disabledReason:a.reason})}else i({visible:!1,disabledReason:"Survey not found"})},n)})}renderSurvey(e,n){if(Dt(this.ar))Hn.warn("init was not called");else{var i=this.pr(e),r=Me==null?void 0:Me.querySelector(n);i?r?this.ar.renderSurvey(i,r):Hn.warn("Survey element not found"):Hn.warn("Survey not found")}}}(function(t){return t.Button="button",t.Tab="tab",t.Selector="selector",t})({});(function(t){return t.TopLeft="top_left",t.TopRight="top_right",t.TopCenter="top_center",t.MiddleLeft="middle_left",t.MiddleRight="middle_right",t.MiddleCenter="middle_center",t.Left="left",t.Center="center",t.Right="right",t.NextToTrigger="next_to_trigger",t})({});(function(t){return t.Popover="popover",t.API="api",t.Widget="widget",t})({});(function(t){return t.Open="open",t.MultipleChoice="multiple_choice",t.SingleChoice="single_choice",t.Rating="rating",t.Link="link",t})({});(function(t){return t.NextQuestion="next_question",t.End="end",t.ResponseBased="response_based",t.SpecificQuestion="specific_question",t})({});(function(t){return t.Once="once",t.Recurring="recurring",t.Always="always",t})({});var Y1=function(t){return t.SHOWN="survey shown",t.DISMISSED="survey dismissed",t.SENT="survey sent",t}({}),dN=function(t){return t.SURVEY_ID="$survey_id",t.SURVEY_NAME="$survey_name",t.SURVEY_RESPONSE="$survey_response",t.SURVEY_ITERATION="$survey_iteration",t.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",t.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",t.SURVEY_SUBMISSION_ID="$survey_submission_id",t.SURVEY_QUESTIONS="$survey_questions",t.SURVEY_COMPLETED="$survey_completed",t}({}),fN=qn("[RateLimiter]");let jH=class{constructor(e){var n,i;this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=r=>{var s=r.text;if(s&&s.length)try{(JSON.parse(s).quota_limited||[]).forEach(o=>{fN.info((o||"events")+" is quota limited."),this.serverLimits[o]=new Date().getTime()+6e4})}catch(o){return void fN.warn('could not rate limit - continuing. Error: "'+(o==null?void 0:o.message)+'"',{text:s})}},this.instance=e,this.captureEventsPerSecond=((n=e.config.rate_limiting)==null?void 0:n.events_per_second)||10,this.captureEventsBurstLimit=Math.max(((i=e.config.rate_limiting)==null?void 0:i.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(e){var n,i,r;e===void 0&&(e=!1);var s=new Date().getTime(),o=(n=(i=this.instance.persistence)==null?void 0:i.get_property(nS))!==null&&n!==void 0?n:{tokens:this.captureEventsBurstLimit,last:s};o.tokens+=(s-o.last)/1e3*this.captureEventsPerSecond,o.last=s,o.tokens>this.captureEventsBurstLimit&&(o.tokens=this.captureEventsBurstLimit);var a=o.tokens<1;return a||e||(o.tokens=Math.max(0,o.tokens-1)),!a||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+this.captureEventsPerSecond+" events per second and "+this.captureEventsBurstLimit+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=a,(r=this.instance.persistence)==null||r.set_property(nS,o),{isRateLimited:a,remainingTokens:o.tokens}}isServerRateLimited(e){var n=this.serverLimits[e||"events"]||!1;return n!==!1&&new Date().getTime()<n}};var dc=qn("[RemoteConfig]");class BH{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=st._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}_r(e){var n,i;(n=st.__PosthogExtensions__)!=null&&n.loadExternalDependency?(i=st.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,"remote-config",()=>e(this.remoteConfig)):(dc.error("PostHog Extensions not found. Cannot load remote config."),e())}mr(e){this._instance.Ee({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:n=>{e(n.json)}})}load(){try{if(this.remoteConfig)return dc.info("Using preloaded remote config",this.remoteConfig),void this.Ie(this.remoteConfig);if(this._instance.I())return void dc.warn("Remote config is disabled. Falling back to local config.");this._r(e=>{if(!e)return dc.info("No config found after loading remote JS config. Falling back to JSON."),void this.mr(n=>{this.Ie(n)});this.Ie(e)})}catch(e){dc.error("Error loading remote config",e)}}Ie(e){e?this._instance.config.__preview_remote_config?(this._instance.Ie(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):dc.info("__preview_remote_config is disabled. Logging config instead",e):dc.error("Failed to fetch remote config from PostHog.")}}var bS=3e3;class $H{constructor(e,n){this.br=!0,this.yr=[],this.wr=_r((n==null?void 0:n.flush_interval_ms)||bS,250,5e3,"flush interval",bS),this.Sr=e}enqueue(e){this.yr.push(e),this.$r||this.kr()}unload(){this.Er();var e=this.yr.length>0?this.Ir():{},n=Object.values(e);[...n.filter(i=>i.url.indexOf("/e")===0),...n.filter(i=>i.url.indexOf("/e")!==0)].map(i=>{this.Sr(Ae({},i,{transport:"sendBeacon"}))})}enable(){this.br=!1,this.kr()}kr(){var e=this;this.br||(this.$r=setTimeout(()=>{if(this.Er(),this.yr.length>0){var n=this.Ir(),i=function(){var s=n[r],o=new Date().getTime();s.data&&ln(s.data)&&Ut(s.data,a=>{a.offset=Math.abs(a.timestamp-o),delete a.timestamp}),e.Sr(s)};for(var r in n)i()}},this.wr))}Er(){clearTimeout(this.$r),this.$r=void 0}Ir(){var e={};return Ut(this.yr,n=>{var i,r=n,s=(r?r.batchKey:null)||r.url;Se(e[s])&&(e[s]=Ae({},r,{data:[]})),(i=e[s].data)==null||i.push(r.data)}),this.yr=[],e}}var FH=["retriesPerformedSoFar"];class zH{constructor(e){this.Pr=!1,this.Rr=3e3,this.yr=[],this._instance=e,this.yr=[],this.Tr=!0,!Se(J)&&"onLine"in J.navigator&&(this.Tr=J.navigator.onLine,pn(J,"online",()=>{this.Tr=!0,this.se()}),pn(J,"offline",()=>{this.Tr=!1}))}get length(){return this.yr.length}retriableRequest(e){var{retriesPerformedSoFar:n}=e,i=q4(e,FH);wi(n)&&n>0&&(i.url=Av(i.url,{retry_count:n})),this._instance.Ee(Ae({},i,{callback:r=>{r.statusCode!==200&&(r.statusCode<400||r.statusCode>=500)&&(n??0)<10?this.Mr(Ae({retriesPerformedSoFar:n},i)):i.callback==null||i.callback(r)}}))}Mr(e){var n=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=n+1;var i=function(o){var a=3e3*Math.pow(2,o),l=a/2,c=Math.min(18e5,a),u=(Math.random()-.5)*(c-l);return Math.ceil(c+u)}(n),r=Date.now()+i;this.yr.push({retryAt:r,requestOptions:e});var s="Enqueued failed request for retry in "+i;navigator.onLine||(s+=" (Browser is offline)"),Ie.warn(s),this.Pr||(this.Pr=!0,this.Cr())}Cr(){this.Fr&&clearTimeout(this.Fr),this.Fr=setTimeout(()=>{this.Tr&&this.yr.length>0&&this.se(),this.Cr()},this.Rr)}se(){var e=Date.now(),n=[],i=this.yr.filter(s=>s.retryAt<e||(n.push(s),!1));if(this.yr=n,i.length>0)for(var{requestOptions:r}of i)this.retriableRequest(r)}unload(){for(var{requestOptions:e}of(this.Fr&&(clearTimeout(this.Fr),this.Fr=void 0),this.yr))try{this._instance.Ee(Ae({},e,{transport:"sendBeacon"}))}catch(n){Ie.error(n)}this.yr=[]}}class UH{constructor(e){this.Or=()=>{var n,i,r,s;this.Ar||(this.Ar={});var o=this.scrollElement(),a=this.scrollY(),l=o?Math.max(0,o.scrollHeight-o.clientHeight):0,c=a+((o==null?void 0:o.clientHeight)||0),u=(o==null?void 0:o.scrollHeight)||0;this.Ar.lastScrollY=Math.ceil(a),this.Ar.maxScrollY=Math.max(a,(n=this.Ar.maxScrollY)!==null&&n!==void 0?n:0),this.Ar.maxScrollHeight=Math.max(l,(i=this.Ar.maxScrollHeight)!==null&&i!==void 0?i:0),this.Ar.lastContentY=c,this.Ar.maxContentY=Math.max(c,(r=this.Ar.maxContentY)!==null&&r!==void 0?r:0),this.Ar.maxContentHeight=Math.max(u,(s=this.Ar.maxContentHeight)!==null&&s!==void 0?s:0)},this._instance=e}getContext(){return this.Ar}resetContext(){var e=this.Ar;return setTimeout(this.Or,0),e}startMeasuringScrollPosition(){pn(J,"scroll",this.Or,{capture:!0}),pn(J,"scrollend",this.Or,{capture:!0}),pn(J,"resize",this.Or)}scrollElement(){if(!this._instance.config.scroll_root_selector)return J==null?void 0:J.document.documentElement;var e=ln(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var n of e){var i=J==null?void 0:J.document.querySelector(n);if(i)return i}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return J&&(J.scrollY||J.pageYOffset||J.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return J&&(J.scrollX||J.pageXOffset||J.document.documentElement.scrollLeft)||0}}var VH=t=>qO(t==null?void 0:t.config.mask_personal_data_properties,t==null?void 0:t.config.custom_personal_data_properties);class HH{constructor(e,n,i,r){this.Dr=s=>{var o=this.Lr();if(!o||o.sessionId!==s){var a={sessionId:s,props:this.jr(this._instance)};this.Nr.register({[tS]:a})}},this._instance=e,this.zr=n,this.Nr=i,this.jr=r||VH,this.zr.onSessionId(this.Dr)}Lr(){return this.Nr.props[tS]}getSetOnceProps(){var e,n=(e=this.Lr())==null?void 0:e.props;return n?"r"in n?KO(n):{$referring_domain:n.referringDomain,$pathname:n.initialPathName,utm_source:n.utm_source,utm_campaign:n.utm_campaign,utm_medium:n.utm_medium,utm_content:n.utm_content,utm_term:n.utm_term}:{}}getSessionProps(){var e={};return Ut(MC(this.getSetOnceProps()),(n,i)=>{i==="$current_url"&&(i="url"),e["$session_entry_"+Gw(i)]=n}),e}}var hN=qn("[SessionId]");class WH{constructor(e,n,i){var r;if(this.Ur=[],!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.__preview_experimental_cookieless_mode)throw new Error("SessionIdManager cannot be used with __preview_experimental_cookieless_mode");this.S=e.config,this.Nr=e.persistence,this.fi=void 0,this.Ct=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.qr=n||nl,this.Br=i||nl;var s=this.S.persistence_name||this.S.token,o=this.S.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*_r(o,60,36e3,"session_idle_timeout_seconds",1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.Hr(),this.Wr="ph_"+s+"_window_id",this.Gr="ph_"+s+"_primary_window_exists",this.Jr()){var a=ii.L(this.Wr),l=ii.L(this.Gr);a&&!l?this.fi=a:ii.N(this.Wr),ii.j(this.Gr,!0)}if((r=this.S.bootstrap)!=null&&r.sessionID)try{var c=(u=>{var d=u.replace(/-/g,"");if(d.length!==32)throw new Error("Not a valid UUID");if(d[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(d.substring(0,12),16)})(this.S.bootstrap.sessionID);this.Vr(this.S.bootstrap.sessionID,new Date().getTime(),c)}catch(u){hN.error("Invalid sessionID in bootstrap",u)}this.Kr()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return Se(this.Ur)&&(this.Ur=[]),this.Ur.push(e),this.Ct&&e(this.Ct,this.fi),()=>{this.Ur=this.Ur.filter(n=>n!==e)}}Jr(){return this.S.persistence!=="memory"&&!this.Nr.Fe&&ii.O()}Yr(e){e!==this.fi&&(this.fi=e,this.Jr()&&ii.j(this.Wr,e))}Xr(){return this.fi?this.fi:this.Jr()?ii.L(this.Wr):null}Vr(e,n,i){e===this.Ct&&n===this._sessionActivityTimestamp&&i===this._sessionStartTimestamp||(this._sessionStartTimestamp=i,this._sessionActivityTimestamp=n,this.Ct=e,this.Nr.register({[vv]:[n,e,i]}))}Qr(){if(this.Ct&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this.Ct,this._sessionStartTimestamp];var e=this.Nr.props[vv];return ln(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.Vr(null,null,null)}Kr(){pn(J,"beforeunload",()=>{this.Jr()&&ii.N(this.Gr)},{capture:!1})}checkAndGetSessionAndWindowId(e,n){if(e===void 0&&(e=!1),n===void 0&&(n=null),this.S.__preview_experimental_cookieless_mode)throw new Error("checkAndGetSessionAndWindowId should not be called in __preview_experimental_cookieless_mode");var i=n||new Date().getTime(),[r,s,o]=this.Qr(),a=this.Xr(),l=wi(o)&&o>0&&Math.abs(i-o)>864e5,c=!1,u=!s,d=!e&&Math.abs(i-r)>this.sessionTimeoutMs;u||d||l?(s=this.qr(),a=this.Br(),hN.info("new session ID generated",{sessionId:s,windowId:a,changeReason:{noSessionId:u,activityTimeout:d,sessionPastMaximumLength:l}}),o=i,c=!0):a||(a=this.Br(),c=!0);var f=r===0||!e||l?i:r,p=o===0?new Date().getTime():o;return this.Yr(a),this.Vr(s,f,p),e||this.Hr(),c&&this.Ur.forEach(m=>m(s,a,c?{noSessionId:u,activityTimeout:d,sessionPastMaximumLength:l}:void 0)),{sessionId:s,windowId:a,sessionStartTimestamp:p,changeReason:c?{noSessionId:u,activityTimeout:d,sessionPastMaximumLength:l}:void 0,lastActivityTimestamp:r}}Hr(){clearTimeout(this.Zr),this.Zr=setTimeout(()=>{this.resetSessionId()},1.1*this.sessionTimeoutMs)}}var GH=["$set_once","$set"],Na=qn("[SiteApps]");class XH{constructor(e){this._instance=e,this.ts=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}es(e,n){if(n){var i=this.globalsForEvent(n);this.ts.push(i),this.ts.length>1e3&&(this.ts=this.ts.slice(10))}}get siteAppLoaders(){var e;return(e=st._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance.Ge(this.es.bind(this));this.rs=()=>{e(),this.ts=[],this.rs=void 0}}}globalsForEvent(e){var n,i,r,s,o,a,l;if(!e)throw new Error("Event payload is required");var c={},u=this._instance.get_property("$groups")||[],d=this._instance.get_property("$stored_group_properties")||{};for(var[f,p]of Object.entries(d))c[f]={id:u[f],type:f,properties:p};var{$set_once:m,$set:g}=e;return{event:Ae({},q4(e,GH),{properties:Ae({},e.properties,g?{$set:Ae({},(n=(i=e.properties)==null?void 0:i.$set)!==null&&n!==void 0?n:{},g)}:{},m?{$set_once:Ae({},(r=(s=e.properties)==null?void 0:s.$set_once)!==null&&r!==void 0?r:{},m)}:{}),elements_chain:(o=(a=e.properties)==null?void 0:a.$elements_chain)!==null&&o!==void 0?o:"",distinct_id:(l=e.properties)==null?void 0:l.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:c}}setupSiteApp(e){var n=this.apps[e.id],i=()=>{var a;!n.errored&&this.ts.length&&(Na.info("Processing "+this.ts.length+" events for site app with id "+e.id),this.ts.forEach(l=>n.processEvent==null?void 0:n.processEvent(l)),n.processedBuffer=!0),Object.values(this.apps).every(l=>l.processedBuffer||l.errored)&&((a=this.rs)==null||a.call(this))},r=!1,s=a=>{n.errored=!a,n.loaded=!0,Na.info("Site app with id "+e.id+" "+(a?"loaded":"errored")),r&&i()};try{var{processEvent:o}=e.init({posthog:this._instance,callback:a=>{s(a)}});o&&(n.processEvent=o),r=!0}catch(a){Na.error("Error while initializing PostHog app with config id "+e.id,a),s(!1)}if(r&&n.loaded)try{i()}catch(a){Na.error("Error while processing buffered events PostHog app with config id "+e.id,a),n.errored=!0}}ss(){var e=this.siteAppLoaders||[];for(var n of e)this.apps[n.id]={id:n.id,loaded:!1,errored:!1,processedBuffer:!1};for(var i of e)this.setupSiteApp(i)}ns(e){if(Object.keys(this.apps).length!==0){var n=this.globalsForEvent(e);for(var i of Object.values(this.apps))try{i.processEvent==null||i.processEvent(n)}catch(r){Na.error("Error while processing event "+e.event+" for site app "+i.id,r)}}}onRemoteConfig(e){var n,i,r,s=this;if((n=this.siteAppLoaders)!=null&&n.length)return this.isEnabled?(this.ss(),void this._instance.on("eventCaptured",c=>this.ns(c))):void Na.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((i=this.rs)==null||i.call(this),(r=e.siteApps)!=null&&r.length)if(this.isEnabled){var o=function(c){var u;st["__$$ph_site_app_"+c]=s._instance,(u=st.__PosthogExtensions__)==null||u.loadSiteApp==null||u.loadSiteApp(s._instance,l,d=>{if(d)return Na.error("Error while initializing PostHog app with config id "+c,d)})};for(var{id:a,url:l}of e.siteApps)o(a)}else Na.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var qH=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],pN=function(t,e){if(!t)return!1;var n=t.toLowerCase();return qH.concat(e||[]).some(i=>{var r=i.toLowerCase();return n.indexOf(r)!==-1})},ZO=function(t,e){if(!t)return!1;var n=t.userAgent;if(n&&pN(n,e))return!0;try{var i=t==null?void 0:t.userAgentData;if(i!=null&&i.brands&&i.brands.some(r=>pN(r==null?void 0:r.brand,e)))return!0}catch{}return!!t.webdriver},gh=function(t){return t.US="us",t.EU="eu",t.CUSTOM="custom",t}({}),mN="i.posthog.com";class KH{constructor(e){this.os={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get uiHost(){var e,n=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return n||(n=this.apiHost.replace("."+mN,".posthog.com")),n==="https://app.posthog.com"?"https://us.posthog.com":n}get region(){return this.os[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.os[this.apiHost]=gh.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.os[this.apiHost]=gh.EU:this.os[this.apiHost]=gh.CUSTOM),this.os[this.apiHost]}endpointFor(e,n){if(n===void 0&&(n=""),n&&(n=n[0]==="/"?n:"/"+n),e==="ui")return this.uiHost+n;if(this.region===gh.CUSTOM)return this.apiHost+n;var i=mN+n;switch(e){case"assets":return"https://"+this.region+"-assets."+i;case"api":return"https://"+this.region+"."+i}}}var YH={icontains:(t,e)=>!!J&&e.href.toLowerCase().indexOf(t.toLowerCase())>-1,not_icontains:(t,e)=>!!J&&e.href.toLowerCase().indexOf(t.toLowerCase())===-1,regex:(t,e)=>!!J&&Ud(e.href,t),not_regex:(t,e)=>!!J&&!Ud(e.href,t),exact:(t,e)=>e.href===t,is_not:(t,e)=>e.href!==t};let JH=class Pi{constructor(e){var n=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(i){i===void 0&&(i=!1),n.getWebExperiments(r=>{Pi.ls("retrieved web experiments from the server"),n.us=new Map,r.forEach(s=>{if(s.feature_flag_key){var o;n.us&&(Pi.ls("setting flag key ",s.feature_flag_key," to web experiment ",s),(o=n.us)==null||o.set(s.feature_flag_key,s));var a=n._instance.getFeatureFlag(s.feature_flag_key);Sn(a)&&s.variants[a]&&n.hs(s.name,a,s.variants[a].transforms)}else if(s.variants)for(var l in s.variants){var c=s.variants[l];Pi.ds(c)&&n.hs(s.name,l,c.transforms)}})},i)},this._instance=e,this._instance.onFeatureFlags(i=>{this.onFeatureFlags(i)})}onFeatureFlags(e){if(this._is_bot())Pi.ls("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(Dt(this.us))return this.us=new Map,this.loadIfEnabled(),void this.previewWebExperiment();Pi.ls("applying feature flags",e),e.forEach(n=>{var i;if(this.us&&(i=this.us)!=null&&i.has(n)){var r,s=this._instance.getFeatureFlag(n),o=(r=this.us)==null?void 0:r.get(n);s&&o!=null&&o.variants[s]&&this.hs(o.name,s,o.variants[s].transforms)}})}}previewWebExperiment(){var e=Pi.getWindowLocation();if(e!=null&&e.search){var n=Sv(e==null?void 0:e.search,"__experiment_id"),i=Sv(e==null?void 0:e.search,"__experiment_variant");n&&i&&(Pi.ls("previewing web experiments "+n+" && "+i),this.getWebExperiments(r=>{this.vs(parseInt(n),i,r)},!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,n,i){if(this._instance.config.disable_web_experiments&&!i)return e([]);var r=this._instance.get_property("$web_experiments");if(r&&!n)return e(r);this._instance.Ee({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:s=>{if(s.statusCode!==200||!s.json)return e([]);var o=s.json.experiments||[];return e(o)}})}vs(e,n,i){var r=i.filter(s=>s.id===e);r&&r.length>0&&(Pi.ls("Previewing web experiment ["+r[0].name+"] with variant ["+n+"]"),this.hs(r[0].name,n,r[0].variants[n].transforms))}static ds(e){return!Dt(e.conditions)&&Pi.cs(e)&&Pi.fs(e)}static cs(e){var n;if(Dt(e.conditions)||Dt((n=e.conditions)==null?void 0:n.url))return!0;var i,r,s,o=Pi.getWindowLocation();return!!o&&((i=e.conditions)==null||!i.url||YH[(r=(s=e.conditions)==null?void 0:s.urlMatchType)!==null&&r!==void 0?r:"icontains"](e.conditions.url,o))}static getWindowLocation(){return J==null?void 0:J.location}static fs(e){var n;if(Dt(e.conditions)||Dt((n=e.conditions)==null?void 0:n.utm))return!0;var i=HO();if(i.utm_source){var r,s,o,a,l,c,u,d,f=(r=e.conditions)==null||(r=r.utm)==null||!r.utm_campaign||((s=e.conditions)==null||(s=s.utm)==null?void 0:s.utm_campaign)==i.utm_campaign,p=(o=e.conditions)==null||(o=o.utm)==null||!o.utm_source||((a=e.conditions)==null||(a=a.utm)==null?void 0:a.utm_source)==i.utm_source,m=(l=e.conditions)==null||(l=l.utm)==null||!l.utm_medium||((c=e.conditions)==null||(c=c.utm)==null?void 0:c.utm_medium)==i.utm_medium,g=(u=e.conditions)==null||(u=u.utm)==null||!u.utm_term||((d=e.conditions)==null||(d=d.utm)==null?void 0:d.utm_term)==i.utm_term;return f&&m&&g&&p}return!1}static ls(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];Ie.info("[WebExperiments] "+e,i)}hs(e,n,i){this._is_bot()?Pi.ls("Refusing to render web experiment since the viewer is a likely bot"):n!=="control"?i.forEach(r=>{if(r.selector){var s;Pi.ls("applying transform of variant "+n+" for experiment "+e+" ",r);var o=(s=document)==null?void 0:s.querySelectorAll(r.selector);o==null||o.forEach(a=>{var l=a;r.html&&(l.innerHTML=r.html),r.css&&l.setAttribute("style",r.css)})}}):Pi.ls("Control variants leave the page unmodified.")}_is_bot(){return Cr&&this._instance?ZO(Cr,this._instance.config.custom_blocked_useragents):void 0}};var ZH=qn("[PostHog ExternalIntegrations]"),QH={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};let eW=class{constructor(e){this._instance=e}J(e,n){var i;(i=st.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,e,r=>{if(r)return ZH.error("failed to load script",r);n()})}startIfEnabledOrStop(){var e=this,n=function(o){var a,l,c;!r||(a=st.__PosthogExtensions__)!=null&&(a=a.integrations)!=null&&a[o]||e.J(QH[o],()=>{var u;(u=st.__PosthogExtensions__)==null||(u=u.integrations)==null||(u=u[o])==null||u.start(e._instance)}),!r&&(l=st.__PosthogExtensions__)!=null&&(l=l.integrations)!=null&&l[o]&&((c=st.__PosthogExtensions__)==null||(c=c.integrations)==null||(c=c[o])==null||c.stop())};for(var[i,r]of Object.entries((s=this._instance.config.integrations)!==null&&s!==void 0?s:{})){var s;n(i)}}};var $h={},xS=()=>{},Lu="posthog",QO=!fH&&(Qi==null?void 0:Qi.indexOf("MSIE"))===-1&&(Qi==null?void 0:Qi.indexOf("Mozilla"))===-1,gN=t=>{var e;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:V7(Me==null?void 0:Me.location),persistence:"localStorage+cookie",persistence_name:"",loaded:xS,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:t!=="2025-05-24"||"history_change",capture_pageleave:"if_capture_pageview",defaults:t??"unset",debug:tr&&Sn(tr==null?void 0:tr.search)&&tr.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(J==null||(e=J.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:n=>{var i="Bad HTTP status: "+n.statusCode+" "+n.text;Ie.error(i)},get_device_id:n=>n,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:bS},error_tracking:{},_onCapture:xS}},vN=t=>{var e={};Se(t.process_person)||(e.person_profiles=t.process_person),Se(t.xhr_headers)||(e.request_headers=t.xhr_headers),Se(t.cookie_name)||(e.persistence_name=t.cookie_name),Se(t.disable_cookie)||(e.disable_persistence=t.disable_cookie),Se(t.store_google)||(e.save_campaign_params=t.store_google),Se(t.verbose)||(e.debug=t.verbose);var n=An({},e,t);return ln(t.property_blacklist)&&(Se(t.property_denylist)?n.property_denylist=t.property_blacklist:ln(t.property_denylist)?n.property_denylist=[...t.property_blacklist,...t.property_denylist]:Ie.error("Invalid value for property_denylist config: "+t.property_denylist)),n};let tW=class{constructor(){this.__forceAllowLocalhost=!1}get ps(){return this.__forceAllowLocalhost}set ps(e){Ie.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}},e5=class t5{get decideEndpointWasHit(){var e,n;return(e=(n=this.featureFlags)==null?void 0:n.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,n;return(e=(n=this.featureFlags)==null?void 0:n.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new tW,this.gs=!1,this.version=Uo.LIB_VERSION,this._s=new JO,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=gN(),this.SentryIntegration=nH,this.sentryIntegration=e=>function(n,i){var r=AO(n,i);return{name:EO,processEvent:s=>r(s)}}(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.bs=!1,this.ys=null,this.ws=null,this.Ss=null,this.featureFlags=new IH(this),this.toolbar=new rH(this),this.scrollManager=new UH(this),this.pageViewManager=new uH(this),this.surveys=new DH(this),this.experiments=new JH(this),this.exceptions=new mH(this),this.rateLimiter=new jH(this),this.requestRouter=new KH(this),this.consent=new fV(this),this.externalIntegrations=new eW(this),this.people={set:(e,n,i)=>{var r=Sn(e)?{[e]:n}:e;this.setPersonProperties(r),i==null||i({})},set_once:(e,n,i)=>{var r=Sn(e)?{[e]:n}:e;this.setPersonProperties(void 0,r),i==null||i({})}},this.on("eventCaptured",e=>Ie.info('send "'+(e==null?void 0:e.event)+'"',e))}init(e,n,i){if(i&&i!==Lu){var r,s=(r=$h[i])!==null&&r!==void 0?r:new t5;return s._init(e,n,i),$h[i]=s,$h[Lu][i]=s,s}return this._init(e,n,i)}_init(e,n,i){var r,s;if(n===void 0&&(n={}),Se(e)||Xw(e))return Ie.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return Ie.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},this.$s=n,this.ks=[],n.person_profiles&&(this.ws=n.person_profiles),this.set_config(An({},gN(n.defaults),vN(n),{name:i,token:e})),this.config.on_xhr_error&&Ie.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=n.disable_compression?void 0:ta.GZipJS,this.persistence=new K1(this.config),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new K1(Ae({},this.config,{persistence:"sessionStorage"}));var o=Ae({},this.persistence.props),a=Ae({},this.sessionPersistence.props);if(this.register({$initialization_time:new Date().toISOString()}),this.xs=new $H(v=>this.Es(v),this.config.request_queue_config),this.Is=new zH(this),this.__request_queue=[],this.config.__preview_experimental_cookieless_mode||(this.sessionManager=new WH(this),this.sessionPropsManager=new HH(this,this.sessionManager,this.persistence)),new oH(this).startIfEnabledOrStop(),this.siteApps=new XH(this),(r=this.siteApps)==null||r.init(),this.config.__preview_experimental_cookieless_mode||(this.sessionRecording=new eH(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new iV(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new cH(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new aH(this),this.exceptionObserver=new mV(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new dO(this,pV),this.deadClicksAutocapture.startIfEnabled(),this.historyAutocapture=new NV(this),this.historyAutocapture.startIfEnabled(),Uo.DEBUG=Uo.DEBUG||this.config.debug,Uo.DEBUG&&Ie.info("Starting in debug mode",{this:this,config:n,thisC:Ae({},this.config),p:o,s:a}),this.Ps(),((s=n.bootstrap)==null?void 0:s.distinctID)!==void 0){var l,c,u=this.config.get_device_id(nl()),d=(l=n.bootstrap)!=null&&l.isIdentifiedID?u:n.bootstrap.distinctID;this.persistence.set_property(Bo,(c=n.bootstrap)!=null&&c.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:n.bootstrap.distinctID,$device_id:d})}if(this.Rs()){var f,p,m=Object.keys(((f=n.bootstrap)==null?void 0:f.featureFlags)||{}).filter(v=>{var b;return!((b=n.bootstrap)==null||(b=b.featureFlags)==null||!b[v])}).reduce((v,b)=>{var w;return v[b]=((w=n.bootstrap)==null||(w=w.featureFlags)==null?void 0:w[b])||!1,v},{}),g=Object.keys(((p=n.bootstrap)==null?void 0:p.featureFlagPayloads)||{}).filter(v=>m[v]).reduce((v,b)=>{var w,k;return(w=n.bootstrap)!=null&&(w=w.featureFlagPayloads)!=null&&w[b]&&(v[b]=(k=n.bootstrap)==null||(k=k.featureFlagPayloads)==null?void 0:k[b]),v},{});this.featureFlags.receivedFeatureFlags({featureFlags:m,featureFlagPayloads:g})}if(this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:tg,$device_id:null},"");else if(!this.get_distinct_id()){var y=this.config.get_device_id(nl());this.register_once({distinct_id:y,$device_id:y},""),this.persistence.set_property(Bo,"anonymous")}return pn(J,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),n.segment?tH(this,()=>this.Ts()):this.Ts(),ts(this.config._onCapture)&&this.config._onCapture!==xS&&(Ie.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",v=>this.config._onCapture(v.event,v))),this.config.ip&&Ie.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}Ie(e){var n,i,r,s,o,a,l,c;if(!Me||!Me.body)return Ie.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(()=>{this.Ie(e)},500);this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=xt(e.supportedCompression,ta.GZipJS)?ta.GZipJS:xt(e.supportedCompression,ta.Base64)?ta.Base64:void 0),(n=e.analytics)!=null&&n.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.ws?this.ws:"identified_only"}),(i=this.siteApps)==null||i.onRemoteConfig(e),(r=this.sessionRecording)==null||r.onRemoteConfig(e),(s=this.autocapture)==null||s.onRemoteConfig(e),(o=this.heatmaps)==null||o.onRemoteConfig(e),this.surveys.onRemoteConfig(e),(a=this.webVitalsAutocapture)==null||a.onRemoteConfig(e),(l=this.exceptionObserver)==null||l.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(c=this.deadClicksAutocapture)==null||c.onRemoteConfig(e)}Ts(){try{this.config.loaded(this)}catch(e){Ie.critical("`loaded` function failed",e)}this.Ms(),this.config.capture_pageview&&setTimeout(()=>{this.consent.isOptedIn()&&this.Cs()},1),new BH(this).load(),this.featureFlags.flags()}Ms(){var e;this.has_opted_out_capturing()||this.config.request_batching&&((e=this.xs)==null||e.enable())}_dom_loaded(){this.has_opted_out_capturing()||pl(this.__request_queue,e=>this.Es(e)),this.__request_queue=[],this.Ms()}_handle_unload(){var e,n;this.config.request_batching?(this.Fs()&&this.capture("$pageleave"),(e=this.xs)==null||e.unload(),(n=this.Is)==null||n.unload()):this.Fs()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}Ee(e){this.__loaded&&(QO?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=Av(e.url,{ip:this.config.ip?1:0}),e.headers=Ae({},this.config.request_headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.fetchOptions=e.fetchOptions||this.config.fetch_options,(n=>{var i,r,s,o=Ae({},n);o.timeout=o.timeout||6e4,o.url=Av(o.url,{_:new Date().getTime().toString(),ver:Uo.LIB_VERSION,compression:o.compression});var a=(i=o.transport)!==null&&i!==void 0?i:"fetch",l=(r=(s=K4(Bh,c=>c.transport===a))==null?void 0:s.method)!==null&&r!==void 0?r:Bh[0].method;if(!l)throw new Error("No available transport method");l(o)})(Ae({},e,{callback:n=>{var i,r;this.rateLimiter.checkForLimiting(n),n.statusCode>=400&&((i=(r=this.config).on_request_error)==null||i.call(r,n)),e.callback==null||e.callback(n)}}))))}Es(e){this.Is?this.Is.retriableRequest(e):this.Ee(e)}_execute_array(e){var n,i=[],r=[],s=[];pl(e,a=>{a&&(n=a[0],ln(n)?s.push(a):ts(a)?a.call(this):ln(a)&&n==="alias"?i.push(a):ln(a)&&n.indexOf("capture")!==-1&&ts(this[n])?s.push(a):r.push(a))});var o=function(a,l){pl(a,function(c){if(ln(c[0])){var u=l;Ut(c,function(d){u=u[d[0]].apply(u,d.slice(1))})}else this[c[0]].apply(this,c.slice(1))},l)};o(i,this),o(r,this),o(s,this)}Rs(){var e,n;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((n=this.config.bootstrap)==null?void 0:n.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,n,i){var r;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.xs){if(!this.consent.isOptedOut())if(!Se(e)&&Sn(e)){if(this.config.opt_out_useragent_filter||!this._is_bot()){var s=i!=null&&i.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(s==null||!s.isRateLimited){n!=null&&n.$current_url&&!Sn(n==null?void 0:n.$current_url)&&(Ie.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),n==null||delete n.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var o=new Date,a=(i==null?void 0:i.timestamp)||o,l=nl(),c={uuid:l,event:e,properties:this.calculateEventProperties(e,n||{},a,l)};s&&(c.properties.$lib_rate_limit_remaining_tokens=s.remainingTokens),i!=null&&i.$set&&(c.$set=i==null?void 0:i.$set);var u,d,f=this.Os(i==null?void 0:i.$set_once);if(f&&(c.$set_once=f),(c=z7(c,i!=null&&i._noTruncate?null:this.config.properties_string_max_length)).timestamp=a,Se(i==null?void 0:i.timestamp)||(c.properties.$event_time_override_provided=!0,c.properties.$event_time_override_system_time=o),e===Y1.DISMISSED||e===Y1.SENT){var p=n==null?void 0:n[dN.SURVEY_ID],m=n==null?void 0:n[dN.SURVEY_ITERATION];localStorage.setItem((d=""+yS+(u={id:p,current_iteration:m}).id,u.current_iteration&&u.current_iteration>0&&(d=""+yS+u.id+"_"+u.current_iteration),d),"true"),c.$set=Ae({},c.$set,{[OH({id:p,current_iteration:m},e===Y1.SENT?"responded":"dismissed")]:!0})}var g=Ae({},c.properties.$set,c.$set);if(Hu(g)||this.setPersonPropertiesForFlags(g),!Dt(this.config.before_send)){var y=this.As(c);if(!y)return;c=y}this._s.emit("eventCaptured",c);var v={method:"POST",url:(r=i==null?void 0:i._url)!==null&&r!==void 0?r:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:c,compression:"best-available",batchKey:i==null?void 0:i._batchKey};return!this.config.request_batching||i&&(i==null||!i._batchKey)||i!=null&&i.send_instantly?this.Es(v):this.xs.enqueue(v),c}Ie.critical("This capture call is ignored due to client rate limiting.")}}else Ie.error("No event name provided to posthog.capture")}else Ie.uninitializedWarning("posthog.capture")}Ge(e){return this.on("eventCaptured",n=>e(n.event,n))}calculateEventProperties(e,n,i,r,s){if(i=i||new Date,!this.persistence||!this.sessionPersistence)return n;var o=s?void 0:this.persistence.remove_event_timer(e),a=Ae({},n);if(a.token=this.config.token,a.$config_defaults=this.config.defaults,this.config.__preview_experimental_cookieless_mode&&(a.$cookieless_mode=!0),e==="$snapshot"){var l=Ae({},this.persistence.properties(),this.sessionPersistence.properties());return a.distinct_id=l.distinct_id,(!Sn(a.distinct_id)&&!wi(a.distinct_id)||Xw(a.distinct_id))&&Ie.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),a}var c,u=NH(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:d,windowId:f}=this.sessionManager.checkAndGetSessionAndWindowId(s,i.getTime());a.$session_id=d,a.$window_id=f}this.sessionPropsManager&&An(a,this.sessionPropsManager.getSessionProps());try{var p;this.sessionRecording&&An(a,this.sessionRecording.sdkDebugProperties),a.$sdk_debug_retry_queue_size=(p=this.Is)==null?void 0:p.length}catch(v){a.$sdk_debug_error_capturing_properties=String(v)}if(this.requestRouter.region===gh.CUSTOM&&(a.$lib_custom_api_host=this.config.api_host),c=e!=="$pageview"||s?e!=="$pageleave"||s?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(i):this.pageViewManager.doPageView(i,r),a=An(a,c),e==="$pageview"&&Me&&(a.title=Me.title),!Se(o)){var m=i.getTime()-o;a.$duration=parseFloat((m/1e3).toFixed(3))}Qi&&this.config.opt_out_useragent_filter&&(a.$browser_type=this._is_bot()?"bot":"browser"),(a=An({},u,this.persistence.properties(),this.sessionPersistence.properties(),a)).$is_identified=this._isIdentified(),ln(this.config.property_denylist)?Ut(this.config.property_denylist,function(v){delete a[v]}):Ie.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var g=this.config.sanitize_properties;g&&(Ie.error("sanitize_properties is deprecated. Use before_send instead"),a=g(a,e));var y=this.Ds();return a.$process_person_profile=y,y&&!s&&this.Ls("_calculate_event_properties"),a}Os(e){var n;if(!this.persistence||!this.Ds()||this.gs)return e;var i=this.persistence.get_initial_props(),r=(n=this.sessionPropsManager)==null?void 0:n.getSetOnceProps(),s=An({},i,r||{},e||{}),o=this.config.sanitize_properties;return o&&(Ie.error("sanitize_properties is deprecated. Use before_send instead"),s=o(s,"$set_once")),this.gs=!0,Hu(s)?void 0:s}register(e,n){var i;(i=this.persistence)==null||i.register(e,n)}register_once(e,n,i){var r;(r=this.persistence)==null||r.register_once(e,n,i)}register_for_session(e){var n;(n=this.sessionPersistence)==null||n.register(e)}unregister(e){var n;(n=this.persistence)==null||n.unregister(e)}unregister_for_session(e){var n;(n=this.sessionPersistence)==null||n.unregister(e)}js(e,n){this.register({[e]:n})}getFeatureFlag(e,n){return this.featureFlags.getFeatureFlag(e,n)}getFeatureFlagPayload(e){var n=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(n)}catch{return n}}isFeatureEnabled(e,n){return this.featureFlags.isFeatureEnabled(e,n)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(e,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,n)}getEarlyAccessFeatures(e,n,i){return n===void 0&&(n=!1),this.featureFlags.getEarlyAccessFeatures(e,n,i)}on(e,n){return this._s.on(e,n)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var n,i;return(n=(i=this.sessionManager)==null?void 0:i.onSessionId(e))!==null&&n!==void 0?n:()=>{}}getSurveys(e,n){n===void 0&&(n=!1),this.surveys.getSurveys(e,n)}getActiveMatchingSurveys(e,n){n===void 0&&(n=!1),this.surveys.getActiveMatchingSurveys(e,n)}renderSurvey(e,n){this.surveys.renderSurvey(e,n)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,n){return n===void 0&&(n=!1),this.surveys.canRenderSurveyAsync(e,n)}identify(e,n,i){if(!this.__loaded||!this.persistence)return Ie.uninitializedWarning("posthog.identify");if(wi(e)&&(e=e.toString(),Ie.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))Ie.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==tg){if(this.Ls("posthog.identify")){var r=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var s=r;this.register_once({$had_persisted_distinct_id:!0,$device_id:s},"")}e!==r&&e!==this.get_property(ch)&&(this.unregister(ch),this.register({distinct_id:e}));var o=(this.persistence.get_property(Bo)||"anonymous")==="anonymous";e!==r&&o?(this.persistence.set_property(Bo,"identified"),this.setPersonPropertiesForFlags(Ae({},i||{},n||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:r},{$set:n||{},$set_once:i||{}}),this.Ss=nN(e,n,i),this.featureFlags.setAnonymousDistinctId(r)):(n||i)&&this.setPersonProperties(n,i),e!==r&&(this.reloadFeatureFlags(),this.unregister(yv))}}else Ie.critical('The string "'+tg+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else Ie.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,n){if((e||n)&&this.Ls("posthog.setPersonProperties")){var i=nN(this.get_distinct_id(),e,n);this.Ss!==i?(this.setPersonPropertiesForFlags(Ae({},n||{},e||{})),this.capture("$set",{$set:e||{},$set_once:n||{}}),this.Ss=i):Ie.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,n,i){if(e&&n){if(this.Ls("posthog.group")){var r=this.getGroups();r[e]!==n&&this.resetGroupPropertiesForFlags(e),this.register({$groups:Ae({},r,{[e]:n})}),i&&(this.capture("$groupidentify",{$group_type:e,$group_key:n,$group_set:i}),this.setGroupPropertiesForFlags({[e]:i})),r[e]===n||i||this.reloadFeatureFlags()}}else Ie.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,n){n===void 0&&(n=!0),this.featureFlags.setPersonPropertiesForFlags(e,n)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,n){n===void 0&&(n=!0),this.Ls("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,n)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var n,i,r,s;if(Ie.info("reset"),!this.__loaded)return Ie.uninitializedWarning("posthog.reset");var o=this.get_property("$device_id");if(this.consent.reset(),(n=this.persistence)==null||n.clear(),(i=this.sessionPersistence)==null||i.clear(),this.surveys.reset(),(r=this.persistence)==null||r.set_property(Bo,"anonymous"),(s=this.sessionManager)==null||s.resetSessionId(),this.Ss=null,this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:tg,$device_id:null},"");else{var a=this.config.get_device_id(nl());this.register_once({distinct_id:a,$device_id:e?a:o},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,n;return(e=(n=this.sessionManager)==null?void 0:n.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:n,sessionStartTimestamp:i}=this.sessionManager.checkAndGetSessionAndWindowId(!0),r=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+n);if(e!=null&&e.withTimestamp&&i){var s,o=(s=e.timestampLookBack)!==null&&s!==void 0?s:10;if(!i)return r;r+="?t="+Math.max(Math.floor((new Date().getTime()-i)/1e3)-o,0)}return r}alias(e,n){return e===this.get_property(Y4)?(Ie.critical("Attempting to create alias for existing People user - aborting."),-2):this.Ls("posthog.alias")?(Se(n)&&(n=this.get_distinct_id()),e!==n?(this.js(ch,e),this.capture("$create_alias",{alias:e,distinct_id:n})):(Ie.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var n,i,r,s,o,a=Ae({},this.config);wn(e)&&(An(this.config,vN(e)),(n=this.persistence)==null||n.update_config(this.config,a),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new K1(Ae({},this.config,{persistence:"sessionStorage"})),jn.O()&&jn.D("ph_debug")==="true"&&(this.config.debug=!0),this.config.debug&&(Uo.DEBUG=!0,Ie.info("set_config",{config:e,oldConfig:a,newConfig:Ae({},this.config)})),(i=this.sessionRecording)==null||i.startIfEnabledOrStop(),(r=this.autocapture)==null||r.startIfEnabled(),(s=this.heatmaps)==null||s.startIfEnabled(),this.surveys.loadIfEnabled(),this.Ps(),(o=this.externalIntegrations)==null||o.startIfEnabledOrStop())}startSessionRecording(e){var n=e===!0,i={sampling:n||!(e==null||!e.sampling),linked_flag:n||!(e==null||!e.linked_flag),url_trigger:n||!(e==null||!e.url_trigger),event_trigger:n||!(e==null||!e.event_trigger)};if(Object.values(i).some(Boolean)){var r,s,o,a,l;(r=this.sessionManager)==null||r.checkAndGetSessionAndWindowId(),i.sampling&&((s=this.sessionRecording)==null||s.overrideSampling()),i.linked_flag&&((o=this.sessionRecording)==null||o.overrideLinkedFlag()),i.url_trigger&&((a=this.sessionRecording)==null||a.overrideTrigger("url")),i.event_trigger&&((l=this.sessionRecording)==null||l.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,n){var i=new Error("PostHog syntheticException");this.exceptions.sendExceptionEvent(Ae({},PV((r=>r instanceof Error)(e)?{error:e,event:e.message}:{event:e},{syntheticException:i}),n))}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var n;return(n=this.persistence)==null?void 0:n.props[e]}getSessionProperty(e){var n;return(n=this.sessionPersistence)==null?void 0:n.props[e]}toString(){var e,n=(e=this.config.name)!==null&&e!==void 0?e:Lu;return n!==Lu&&(n=Lu+"."+n),n}_isIdentified(){var e,n;return((e=this.persistence)==null?void 0:e.get_property(Bo))==="identified"||((n=this.sessionPersistence)==null?void 0:n.get_property(Bo))==="identified"}Ds(){var e,n;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Hu(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[ch])&&((n=this.persistence)==null||(n=n.props)==null||!n[xv]))}Fs(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.Ds()||this.Ls("posthog.createPersonProfile")&&this.setPersonProperties({},{})}Ls(e){return this.config.person_profiles==="never"?(Ie.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.js(xv,!0),!0)}Ps(){var e,n,i,r,s=this.consent.isOptedOut(),o=this.config.opt_out_persistence_by_default,a=this.config.disable_persistence||s&&!!o;((e=this.persistence)==null?void 0:e.Fe)!==a&&((i=this.persistence)==null||i.set_disabled(a)),((n=this.sessionPersistence)==null?void 0:n.Fe)!==a&&((r=this.sessionPersistence)==null||r.set_disabled(a))}opt_in_capturing(e){var n;this.consent.optInOut(!0),this.Ps(),(Se(e==null?void 0:e.captureEventName)||e!=null&&e.captureEventName)&&this.capture((n=e==null?void 0:e.captureEventName)!==null&&n!==void 0?n:"$opt_in",e==null?void 0:e.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.Cs()}opt_out_capturing(){this.consent.optInOut(!1),this.Ps()}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}clear_opt_in_out_capturing(){this.consent.reset(),this.Ps()}_is_bot(){return Cr?ZO(Cr,this.config.custom_blocked_useragents):void 0}Cs(){Me&&(Me.visibilityState==="visible"?this.bs||(this.bs=!0,this.capture("$pageview",{title:Me.title},{send_instantly:!0}),this.ys&&(Me.removeEventListener("visibilitychange",this.ys),this.ys=null)):this.ys||(this.ys=this.Cs.bind(this),pn(Me,"visibilitychange",this.ys)))}debug(e){e===!1?(J==null||J.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(J==null||J.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}I(){var e,n,i,r,s,o,a,l=this.$s||{};return"advanced_disable_flags"in l?!!l.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(Ie.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(i="advanced_disable_decide",r=!1,s=Ie,o=(n="advanced_disable_flags")in(e=l)&&!Se(e[n]),a=i in e&&!Se(e[i]),o?e[n]:a?(s&&s.warn("Config field '"+i+"' is deprecated. Please use '"+n+"' instead. The old field will be removed in a future major version."),e[i]):r)}As(e){if(Dt(this.config.before_send))return e;var n=ln(this.config.before_send)?this.config.before_send:[this.config.before_send],i=e;for(var r of n){if(i=r(i),Dt(i)){var s="Event '"+e.event+"' was rejected in beforeSend function";return B7(e.event)?Ie.warn(s+". This can cause unexpected behavior."):Ie.info(s),null}i.properties&&!Hu(i.properties)||Ie.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return i}getPageViewId(){var e;return(e=this.pageViewManager.ce)==null?void 0:e.pageViewId}captureTraceFeedback(e,n){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:n})}captureTraceMetric(e,n,i){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:n,$ai_metric_value:String(i)})}};(function(t,e){for(var n=0;n<e.length;n++)t.prototype[e[n]]=F7(t.prototype[e[n]])})(e5,["identify"]);var yN,qa=(yN=$h[Lu]=new e5,function(){function t(){t.done||(t.done=!0,QO=!1,Ut($h,function(e){e._dom_loaded()}))}Me!=null&&Me.addEventListener?Me.readyState==="complete"?t():pn(Me,"DOMContentLoaded",t,{capture:!1}):J&&Ie.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),yN),n5=x.createContext({client:qa});function i5(t,e,n){if(n===void 0&&(n=new WeakMap),t===e)return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(n.has(t)&&n.get(t)===e)return!0;n.set(t,e);var i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(var s=0,o=i;s<o.length;s++){var a=o[s];if(!r.includes(a)||!i5(t[a],e[a],n))return!1}return!0}function nW(t){var e=t.children,n=t.client,i=t.apiKey,r=t.options,s=x.useRef(null),o=x.useMemo(function(){return n?(i&&console.warn("[PostHog.js] You have provided both `client` and `apiKey` to `PostHogProvider`. `apiKey` will be ignored in favour of `client`."),r&&console.warn("[PostHog.js] You have provided both `client` and `options` to `PostHogProvider`. `options` will be ignored in favour of `client`."),n):(i||console.warn("[PostHog.js] No `apiKey` or `client` were provided to `PostHogProvider`. Using default global `window.posthog` instance. You must initialize it manually. This is not recommended behavior."),qa)},[n,i,JSON.stringify(r)]);return x.useEffect(function(){if(!n){var a=s.current;a?(i!==a.apiKey&&console.warn("[PostHog.js] You have provided a different `apiKey` to `PostHogProvider` than the one that was already initialized. This is not supported by our provider and we'll keep using the previous key. If you need to toggle between API Keys you need to control the `client` yourself and pass it in as a prop rather than an `apiKey` prop."),r&&!i5(r,a.options)&&qa.set_config(r),s.current={apiKey:i,options:r??{}}):(qa.__loaded&&console.warn("[PostHog.js] `posthog` was already loaded elsewhere. This may cause issues."),qa.init(i,r),s.current={apiKey:i,options:r??{}})}},[n,i,JSON.stringify(r)]),en.createElement(n5.Provider,{value:{client:o}},e)}var wS=function(t,e){return wS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},wS(t,e)};function iW(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");wS(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var J1=function(t){return typeof t=="function"},rW={componentStack:null,error:null},sW={INVALID_FALLBACK:"[PostHog.js][PostHogErrorBoundary] Invalid fallback prop, provide a valid React element or a function that returns a valid React element."};(function(t){iW(e,t);function e(n){var i=t.call(this,n)||this;return i.state=rW,i}return e.prototype.componentDidCatch=function(n,i){var r=i.componentStack,s=this.props.additionalProperties;this.setState({error:n,componentStack:r});var o;J1(s)?o=s(n):typeof s=="object"&&(o=s);var a=this.context.client;a.captureException(n,o)},e.prototype.render=function(){var n=this.props,i=n.children,r=n.fallback,s=this.state;if(s.componentStack==null)return J1(i)?i():i;var o=J1(r)?en.createElement(r,{error:s.error,componentStack:s.componentStack}):r;return en.isValidElement(o)?o:(console.warn(sW.INVALID_FALLBACK),en.createElement(en.Fragment,null))},e.contextType=n5,e})(en.Component);var r5={exports:{}},jr={},s5={exports:{}},o5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,U){var se=V.length;V.push(U);e:for(;0<se;){var Ce=se-1>>>1,Q=V[Ce];if(0<r(Q,U))V[Ce]=U,V[se]=Q,se=Ce;else break e}}function n(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var U=V[0],se=V.pop();if(se!==U){V[0]=se;e:for(var Ce=0,Q=V.length,ae=Q>>>1;Ce<ae;){var z=2*(Ce+1)-1,$=V[z],W=z+1,S=V[W];if(0>r($,se))W<Q&&0>r(S,$)?(V[Ce]=S,V[W]=se,Ce=W):(V[Ce]=$,V[z]=se,Ce=z);else if(W<Q&&0>r(S,se))V[Ce]=S,V[W]=se,Ce=W;else break e}}return U}function r(V,U){var se=V.sortIndex-U.sortIndex;return se!==0?se:V.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,f=3,p=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(V){for(var U=n(c);U!==null;){if(U.callback===null)i(c);else if(U.startTime<=V)i(c),U.sortIndex=U.expirationTime,e(l,U);else break;U=n(c)}}function k(V){if(g=!1,w(V),!m)if(n(l)!==null)m=!0,Y(C);else{var U=n(c);U!==null&&ne(k,U.startTime-V)}}function C(V,U){m=!1,g&&(g=!1,v(M),M=-1),p=!0;var se=f;try{for(w(U),d=n(l);d!==null&&(!(d.expirationTime>U)||V&&!L());){var Ce=d.callback;if(typeof Ce=="function"){d.callback=null,f=d.priorityLevel;var Q=Ce(d.expirationTime<=U);U=t.unstable_now(),typeof Q=="function"?d.callback=Q:d===n(l)&&i(l),w(U)}else i(l);d=n(l)}if(d!==null)var ae=!0;else{var z=n(c);z!==null&&ne(k,z.startTime-U),ae=!1}return ae}finally{d=null,f=se,p=!1}}var E=!1,_=null,M=-1,R=5,T=-1;function L(){return!(t.unstable_now()-T<R)}function I(){if(_!==null){var V=t.unstable_now();T=V;var U=!0;try{U=_(!0,V)}finally{U?G():(E=!1,_=null)}}else E=!1}var G;if(typeof b=="function")G=function(){b(I)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,q=B.port2;B.port1.onmessage=I,G=function(){q.postMessage(null)}}else G=function(){y(I,0)};function Y(V){_=V,E||(E=!0,G())}function ne(V,U){M=y(function(){V(t.unstable_now())},U)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,Y(C))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(V){switch(f){case 1:case 2:case 3:var U=3;break;default:U=f}var se=f;f=U;try{return V()}finally{f=se}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,U){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var se=f;f=V;try{return U()}finally{f=se}},t.unstable_scheduleCallback=function(V,U,se){var Ce=t.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?Ce+se:Ce):se=Ce,V){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=se+Q,V={id:u++,callback:U,priorityLevel:V,startTime:se,expirationTime:Q,sortIndex:-1},se>Ce?(V.sortIndex=se,e(c,V),n(l)===null&&V===n(c)&&(g?(v(M),M=-1):g=!0,ne(k,se-Ce))):(V.sortIndex=Q,e(l,V),m||p||(m=!0,Y(C))),V},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(V){var U=f;return function(){var se=f;f=U;try{return V.apply(this,arguments)}finally{f=se}}}})(o5);s5.exports=o5;var oW=s5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aW=x,Tr=oW;function he(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a5=new Set,mp={};function fu(t,e){Hd(t,e),Hd(t+"Capture",e)}function Hd(t,e){for(mp[t]=e,t=0;t<e.length;t++)a5.add(e[t])}var ua=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),SS=Object.prototype.hasOwnProperty,lW=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bN={},xN={};function cW(t){return SS.call(xN,t)?!0:SS.call(bN,t)?!1:lW.test(t)?xN[t]=!0:(bN[t]=!0,!1)}function uW(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function dW(t,e,n,i){if(e===null||typeof e>"u"||uW(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fi(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var fi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){fi[t]=new Fi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];fi[e]=new Fi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){fi[t]=new Fi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){fi[t]=new Fi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){fi[t]=new Fi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){fi[t]=new Fi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){fi[t]=new Fi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){fi[t]=new Fi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){fi[t]=new Fi(t,5,!1,t.toLowerCase(),null,!1,!1)});var HC=/[\-:]([a-z])/g;function WC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(HC,WC);fi[e]=new Fi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(HC,WC);fi[e]=new Fi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(HC,WC);fi[e]=new Fi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){fi[t]=new Fi(t,1,!1,t.toLowerCase(),null,!1,!1)});fi.xlinkHref=new Fi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){fi[t]=new Fi(t,1,!1,t.toLowerCase(),null,!0,!0)});function GC(t,e,n,i){var r=fi.hasOwnProperty(e)?fi[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(dW(e,n,r,i)&&(n=null),i||r===null?cW(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var xa=aW.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dg=Symbol.for("react.element"),Xu=Symbol.for("react.portal"),qu=Symbol.for("react.fragment"),XC=Symbol.for("react.strict_mode"),kS=Symbol.for("react.profiler"),l5=Symbol.for("react.provider"),c5=Symbol.for("react.context"),qC=Symbol.for("react.forward_ref"),CS=Symbol.for("react.suspense"),_S=Symbol.for("react.suspense_list"),KC=Symbol.for("react.memo"),Ba=Symbol.for("react.lazy"),u5=Symbol.for("react.offscreen"),wN=Symbol.iterator;function zf(t){return t===null||typeof t!="object"?null:(t=wN&&t[wN]||t["@@iterator"],typeof t=="function"?t:null)}var yn=Object.assign,Z1;function vh(t){if(Z1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Z1=e&&e[1]||""}return`
`+Z1+t}var Q1=!1;function ex(t,e){if(!t||Q1)return"";Q1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Q1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?vh(t):""}function fW(t){switch(t.tag){case 5:return vh(t.type);case 16:return vh("Lazy");case 13:return vh("Suspense");case 19:return vh("SuspenseList");case 0:case 2:case 15:return t=ex(t.type,!1),t;case 11:return t=ex(t.type.render,!1),t;case 1:return t=ex(t.type,!0),t;default:return""}}function ES(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qu:return"Fragment";case Xu:return"Portal";case kS:return"Profiler";case XC:return"StrictMode";case CS:return"Suspense";case _S:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case c5:return(t.displayName||"Context")+".Consumer";case l5:return(t._context.displayName||"Context")+".Provider";case qC:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case KC:return e=t.displayName||null,e!==null?e:ES(t.type)||"Memo";case Ba:e=t._payload,t=t._init;try{return ES(t(e))}catch{}}return null}function hW(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ES(e);case 8:return e===XC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Nl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function d5(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function pW(t){var e=d5(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function fg(t){t._valueTracker||(t._valueTracker=pW(t))}function f5(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=d5(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Nv(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function AS(t,e){var n=e.checked;return yn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function SN(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=Nl(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function h5(t,e){e=e.checked,e!=null&&GC(t,"checked",e,!1)}function PS(t,e){h5(t,e);var n=Nl(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?NS(t,e.type,n):e.hasOwnProperty("defaultValue")&&NS(t,e.type,Nl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function kN(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function NS(t,e,n){(e!=="number"||Nv(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var yh=Array.isArray;function pd(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Nl(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function MS(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(he(91));return yn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function CN(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(he(92));if(yh(n)){if(1<n.length)throw Error(he(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Nl(n)}}function p5(t,e){var n=Nl(e.value),i=Nl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function _N(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function m5(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function RS(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?m5(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var hg,g5=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(hg=hg||document.createElement("div"),hg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=hg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function gp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Fh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mW=["Webkit","ms","Moz","O"];Object.keys(Fh).forEach(function(t){mW.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fh[e]=Fh[t]})});function v5(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Fh.hasOwnProperty(t)&&Fh[t]?(""+e).trim():e+"px"}function y5(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=v5(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var gW=yn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function IS(t,e){if(e){if(gW[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(he(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(he(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(he(61))}if(e.style!=null&&typeof e.style!="object")throw Error(he(62))}}function TS(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var OS=null;function YC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var LS=null,md=null,gd=null;function EN(t){if(t=Cm(t)){if(typeof LS!="function")throw Error(he(280));var e=t.stateNode;e&&(e=gb(e),LS(t.stateNode,t.type,e))}}function b5(t){md?gd?gd.push(t):gd=[t]:md=t}function x5(){if(md){var t=md,e=gd;if(gd=md=null,EN(t),e)for(t=0;t<e.length;t++)EN(e[t])}}function w5(t,e){return t(e)}function S5(){}var tx=!1;function k5(t,e,n){if(tx)return t(e,n);tx=!0;try{return w5(t,e,n)}finally{tx=!1,(md!==null||gd!==null)&&(S5(),x5())}}function vp(t,e){var n=t.stateNode;if(n===null)return null;var i=gb(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(he(231,e,typeof n));return n}var DS=!1;if(ua)try{var Uf={};Object.defineProperty(Uf,"passive",{get:function(){DS=!0}}),window.addEventListener("test",Uf,Uf),window.removeEventListener("test",Uf,Uf)}catch{DS=!1}function vW(t,e,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var zh=!1,Mv=null,Rv=!1,jS=null,yW={onError:function(t){zh=!0,Mv=t}};function bW(t,e,n,i,r,s,o,a,l){zh=!1,Mv=null,vW.apply(yW,arguments)}function xW(t,e,n,i,r,s,o,a,l){if(bW.apply(this,arguments),zh){if(zh){var c=Mv;zh=!1,Mv=null}else throw Error(he(198));Rv||(Rv=!0,jS=c)}}function hu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function C5(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function AN(t){if(hu(t)!==t)throw Error(he(188))}function wW(t){var e=t.alternate;if(!e){if(e=hu(t),e===null)throw Error(he(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return AN(r),t;if(s===i)return AN(r),e;s=s.sibling}throw Error(he(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(he(189))}}if(n.alternate!==i)throw Error(he(190))}if(n.tag!==3)throw Error(he(188));return n.stateNode.current===n?t:e}function _5(t){return t=wW(t),t!==null?E5(t):null}function E5(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=E5(t);if(e!==null)return e;t=t.sibling}return null}var A5=Tr.unstable_scheduleCallback,PN=Tr.unstable_cancelCallback,SW=Tr.unstable_shouldYield,kW=Tr.unstable_requestPaint,Pn=Tr.unstable_now,CW=Tr.unstable_getCurrentPriorityLevel,JC=Tr.unstable_ImmediatePriority,P5=Tr.unstable_UserBlockingPriority,Iv=Tr.unstable_NormalPriority,_W=Tr.unstable_LowPriority,N5=Tr.unstable_IdlePriority,fb=null,So=null;function EW(t){if(So&&typeof So.onCommitFiberRoot=="function")try{So.onCommitFiberRoot(fb,t,void 0,(t.current.flags&128)===128)}catch{}}var Ts=Math.clz32?Math.clz32:NW,AW=Math.log,PW=Math.LN2;function NW(t){return t>>>=0,t===0?32:31-(AW(t)/PW|0)|0}var pg=64,mg=4194304;function bh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Tv(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=bh(a):(s&=o,s!==0&&(i=bh(s)))}else o=n&~r,o!==0?i=bh(o):s!==0&&(i=bh(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Ts(e),r=1<<n,i|=t[n],e&=~r;return i}function MW(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RW(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Ts(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=MW(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function BS(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function M5(){var t=pg;return pg<<=1,!(pg&4194240)&&(pg=64),t}function nx(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Sm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ts(e),t[e]=n}function IW(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Ts(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function ZC(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Ts(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var Ft=0;function R5(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var I5,QC,T5,O5,L5,$S=!1,gg=[],gl=null,vl=null,yl=null,yp=new Map,bp=new Map,Ka=[],TW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function NN(t,e){switch(t){case"focusin":case"focusout":gl=null;break;case"dragenter":case"dragleave":vl=null;break;case"mouseover":case"mouseout":yl=null;break;case"pointerover":case"pointerout":yp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bp.delete(e.pointerId)}}function Vf(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Cm(e),e!==null&&QC(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function OW(t,e,n,i,r){switch(e){case"focusin":return gl=Vf(gl,t,e,n,i,r),!0;case"dragenter":return vl=Vf(vl,t,e,n,i,r),!0;case"mouseover":return yl=Vf(yl,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return yp.set(s,Vf(yp.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,bp.set(s,Vf(bp.get(s)||null,t,e,n,i,r)),!0}return!1}function D5(t){var e=Mc(t.target);if(e!==null){var n=hu(e);if(n!==null){if(e=n.tag,e===13){if(e=C5(n),e!==null){t.blockedOn=e,L5(t.priority,function(){T5(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function O0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=FS(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);OS=i,n.target.dispatchEvent(i),OS=null}else return e=Cm(n),e!==null&&QC(e),t.blockedOn=n,!1;e.shift()}return!0}function MN(t,e,n){O0(t)&&n.delete(e)}function LW(){$S=!1,gl!==null&&O0(gl)&&(gl=null),vl!==null&&O0(vl)&&(vl=null),yl!==null&&O0(yl)&&(yl=null),yp.forEach(MN),bp.forEach(MN)}function Hf(t,e){t.blockedOn===e&&(t.blockedOn=null,$S||($S=!0,Tr.unstable_scheduleCallback(Tr.unstable_NormalPriority,LW)))}function xp(t){function e(r){return Hf(r,t)}if(0<gg.length){Hf(gg[0],t);for(var n=1;n<gg.length;n++){var i=gg[n];i.blockedOn===t&&(i.blockedOn=null)}}for(gl!==null&&Hf(gl,t),vl!==null&&Hf(vl,t),yl!==null&&Hf(yl,t),yp.forEach(e),bp.forEach(e),n=0;n<Ka.length;n++)i=Ka[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Ka.length&&(n=Ka[0],n.blockedOn===null);)D5(n),n.blockedOn===null&&Ka.shift()}var vd=xa.ReactCurrentBatchConfig,Ov=!0;function DW(t,e,n,i){var r=Ft,s=vd.transition;vd.transition=null;try{Ft=1,e_(t,e,n,i)}finally{Ft=r,vd.transition=s}}function jW(t,e,n,i){var r=Ft,s=vd.transition;vd.transition=null;try{Ft=4,e_(t,e,n,i)}finally{Ft=r,vd.transition=s}}function e_(t,e,n,i){if(Ov){var r=FS(t,e,n,i);if(r===null)fx(t,e,i,Lv,n),NN(t,i);else if(OW(r,t,e,n,i))i.stopPropagation();else if(NN(t,i),e&4&&-1<TW.indexOf(t)){for(;r!==null;){var s=Cm(r);if(s!==null&&I5(s),s=FS(t,e,n,i),s===null&&fx(t,e,i,Lv,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else fx(t,e,i,null,n)}}var Lv=null;function FS(t,e,n,i){if(Lv=null,t=YC(i),t=Mc(t),t!==null)if(e=hu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=C5(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Lv=t,null}function j5(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(CW()){case JC:return 1;case P5:return 4;case Iv:case _W:return 16;case N5:return 536870912;default:return 16}default:return 16}}var il=null,t_=null,L0=null;function B5(){if(L0)return L0;var t,e=t_,n=e.length,i,r="value"in il?il.value:il.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return L0=r.slice(t,1<i?1-i:void 0)}function D0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function vg(){return!0}function RN(){return!1}function Br(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?vg:RN,this.isPropagationStopped=RN,this}return yn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=vg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=vg)},persist:function(){},isPersistent:vg}),e}var kf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},n_=Br(kf),km=yn({},kf,{view:0,detail:0}),BW=Br(km),ix,rx,Wf,hb=yn({},km,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:i_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Wf&&(Wf&&t.type==="mousemove"?(ix=t.screenX-Wf.screenX,rx=t.screenY-Wf.screenY):rx=ix=0,Wf=t),ix)},movementY:function(t){return"movementY"in t?t.movementY:rx}}),IN=Br(hb),$W=yn({},hb,{dataTransfer:0}),FW=Br($W),zW=yn({},km,{relatedTarget:0}),sx=Br(zW),UW=yn({},kf,{animationName:0,elapsedTime:0,pseudoElement:0}),VW=Br(UW),HW=yn({},kf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),WW=Br(HW),GW=yn({},kf,{data:0}),TN=Br(GW),XW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},KW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function YW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=KW[t])?!!e[t]:!1}function i_(){return YW}var JW=yn({},km,{key:function(t){if(t.key){var e=XW[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=D0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?qW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:i_,charCode:function(t){return t.type==="keypress"?D0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?D0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ZW=Br(JW),QW=yn({},hb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ON=Br(QW),eG=yn({},km,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:i_}),tG=Br(eG),nG=yn({},kf,{propertyName:0,elapsedTime:0,pseudoElement:0}),iG=Br(nG),rG=yn({},hb,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),sG=Br(rG),oG=[9,13,27,32],r_=ua&&"CompositionEvent"in window,Uh=null;ua&&"documentMode"in document&&(Uh=document.documentMode);var aG=ua&&"TextEvent"in window&&!Uh,$5=ua&&(!r_||Uh&&8<Uh&&11>=Uh),LN=" ",DN=!1;function F5(t,e){switch(t){case"keyup":return oG.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function z5(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ku=!1;function lG(t,e){switch(t){case"compositionend":return z5(e);case"keypress":return e.which!==32?null:(DN=!0,LN);case"textInput":return t=e.data,t===LN&&DN?null:t;default:return null}}function cG(t,e){if(Ku)return t==="compositionend"||!r_&&F5(t,e)?(t=B5(),L0=t_=il=null,Ku=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $5&&e.locale!=="ko"?null:e.data;default:return null}}var uG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jN(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!uG[t.type]:e==="textarea"}function U5(t,e,n,i){b5(i),e=Dv(e,"onChange"),0<e.length&&(n=new n_("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Vh=null,wp=null;function dG(t){Q5(t,0)}function pb(t){var e=Zu(t);if(f5(e))return t}function fG(t,e){if(t==="change")return e}var V5=!1;if(ua){var ox;if(ua){var ax="oninput"in document;if(!ax){var BN=document.createElement("div");BN.setAttribute("oninput","return;"),ax=typeof BN.oninput=="function"}ox=ax}else ox=!1;V5=ox&&(!document.documentMode||9<document.documentMode)}function $N(){Vh&&(Vh.detachEvent("onpropertychange",H5),wp=Vh=null)}function H5(t){if(t.propertyName==="value"&&pb(wp)){var e=[];U5(e,wp,t,YC(t)),k5(dG,e)}}function hG(t,e,n){t==="focusin"?($N(),Vh=e,wp=n,Vh.attachEvent("onpropertychange",H5)):t==="focusout"&&$N()}function pG(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return pb(wp)}function mG(t,e){if(t==="click")return pb(e)}function gG(t,e){if(t==="input"||t==="change")return pb(e)}function vG(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ls=typeof Object.is=="function"?Object.is:vG;function Sp(t,e){if(Ls(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!SS.call(e,r)||!Ls(t[r],e[r]))return!1}return!0}function FN(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zN(t,e){var n=FN(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=FN(n)}}function W5(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?W5(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function G5(){for(var t=window,e=Nv();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Nv(t.document)}return e}function s_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function yG(t){var e=G5(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&W5(n.ownerDocument.documentElement,n)){if(i!==null&&s_(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=zN(n,s);var o=zN(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var bG=ua&&"documentMode"in document&&11>=document.documentMode,Yu=null,zS=null,Hh=null,US=!1;function UN(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;US||Yu==null||Yu!==Nv(i)||(i=Yu,"selectionStart"in i&&s_(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Hh&&Sp(Hh,i)||(Hh=i,i=Dv(zS,"onSelect"),0<i.length&&(e=new n_("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Yu)))}function yg(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ju={animationend:yg("Animation","AnimationEnd"),animationiteration:yg("Animation","AnimationIteration"),animationstart:yg("Animation","AnimationStart"),transitionend:yg("Transition","TransitionEnd")},lx={},X5={};ua&&(X5=document.createElement("div").style,"AnimationEvent"in window||(delete Ju.animationend.animation,delete Ju.animationiteration.animation,delete Ju.animationstart.animation),"TransitionEvent"in window||delete Ju.transitionend.transition);function mb(t){if(lx[t])return lx[t];if(!Ju[t])return t;var e=Ju[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in X5)return lx[t]=e[n];return t}var q5=mb("animationend"),K5=mb("animationiteration"),Y5=mb("animationstart"),J5=mb("transitionend"),Z5=new Map,VN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ql(t,e){Z5.set(t,e),fu(e,[t])}for(var cx=0;cx<VN.length;cx++){var ux=VN[cx],xG=ux.toLowerCase(),wG=ux[0].toUpperCase()+ux.slice(1);ql(xG,"on"+wG)}ql(q5,"onAnimationEnd");ql(K5,"onAnimationIteration");ql(Y5,"onAnimationStart");ql("dblclick","onDoubleClick");ql("focusin","onFocus");ql("focusout","onBlur");ql(J5,"onTransitionEnd");Hd("onMouseEnter",["mouseout","mouseover"]);Hd("onMouseLeave",["mouseout","mouseover"]);Hd("onPointerEnter",["pointerout","pointerover"]);Hd("onPointerLeave",["pointerout","pointerover"]);fu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fu("onBeforeInput",["compositionend","keypress","textInput","paste"]);fu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),SG=new Set("cancel close invalid load scroll toggle".split(" ").concat(xh));function HN(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,xW(i,e,void 0,t),t.currentTarget=null}function Q5(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;HN(r,a,c),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;HN(r,a,c),s=l}}}if(Rv)throw t=jS,Rv=!1,jS=null,t}function Yt(t,e){var n=e[XS];n===void 0&&(n=e[XS]=new Set);var i=t+"__bubble";n.has(i)||(eL(e,t,2,!1),n.add(i))}function dx(t,e,n){var i=0;e&&(i|=4),eL(n,t,i,e)}var bg="_reactListening"+Math.random().toString(36).slice(2);function kp(t){if(!t[bg]){t[bg]=!0,a5.forEach(function(n){n!=="selectionchange"&&(SG.has(n)||dx(n,!1,t),dx(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[bg]||(e[bg]=!0,dx("selectionchange",!1,e))}}function eL(t,e,n,i){switch(j5(e)){case 1:var r=DW;break;case 4:r=jW;break;default:r=e_}n=r.bind(null,e,n,t),r=void 0,!DS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function fx(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Mc(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}k5(function(){var c=s,u=YC(n),d=[];e:{var f=Z5.get(t);if(f!==void 0){var p=n_,m=t;switch(t){case"keypress":if(D0(n)===0)break e;case"keydown":case"keyup":p=ZW;break;case"focusin":m="focus",p=sx;break;case"focusout":m="blur",p=sx;break;case"beforeblur":case"afterblur":p=sx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=IN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=FW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=tG;break;case q5:case K5:case Y5:p=VW;break;case J5:p=iG;break;case"scroll":p=BW;break;case"wheel":p=sG;break;case"copy":case"cut":case"paste":p=WW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=ON}var g=(e&4)!==0,y=!g&&t==="scroll",v=g?f!==null?f+"Capture":null:f;g=[];for(var b=c,w;b!==null;){w=b;var k=w.stateNode;if(w.tag===5&&k!==null&&(w=k,v!==null&&(k=vp(b,v),k!=null&&g.push(Cp(b,k,w)))),y)break;b=b.return}0<g.length&&(f=new p(f,m,null,n,u),d.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==OS&&(m=n.relatedTarget||n.fromElement)&&(Mc(m)||m[da]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=c,m=m?Mc(m):null,m!==null&&(y=hu(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=c),p!==m)){if(g=IN,k="onMouseLeave",v="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(g=ON,k="onPointerLeave",v="onPointerEnter",b="pointer"),y=p==null?f:Zu(p),w=m==null?f:Zu(m),f=new g(k,b+"leave",p,n,u),f.target=y,f.relatedTarget=w,k=null,Mc(u)===c&&(g=new g(v,b+"enter",m,n,u),g.target=w,g.relatedTarget=y,k=g),y=k,p&&m)t:{for(g=p,v=m,b=0,w=g;w;w=xu(w))b++;for(w=0,k=v;k;k=xu(k))w++;for(;0<b-w;)g=xu(g),b--;for(;0<w-b;)v=xu(v),w--;for(;b--;){if(g===v||v!==null&&g===v.alternate)break t;g=xu(g),v=xu(v)}g=null}else g=null;p!==null&&WN(d,f,p,g,!1),m!==null&&y!==null&&WN(d,y,m,g,!0)}}e:{if(f=c?Zu(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var C=fG;else if(jN(f))if(V5)C=gG;else{C=pG;var E=hG}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=mG);if(C&&(C=C(t,c))){U5(d,C,n,u);break e}E&&E(t,f,c),t==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&NS(f,"number",f.value)}switch(E=c?Zu(c):window,t){case"focusin":(jN(E)||E.contentEditable==="true")&&(Yu=E,zS=c,Hh=null);break;case"focusout":Hh=zS=Yu=null;break;case"mousedown":US=!0;break;case"contextmenu":case"mouseup":case"dragend":US=!1,UN(d,n,u);break;case"selectionchange":if(bG)break;case"keydown":case"keyup":UN(d,n,u)}var _;if(r_)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Ku?F5(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&($5&&n.locale!=="ko"&&(Ku||M!=="onCompositionStart"?M==="onCompositionEnd"&&Ku&&(_=B5()):(il=u,t_="value"in il?il.value:il.textContent,Ku=!0)),E=Dv(c,M),0<E.length&&(M=new TN(M,t,null,n,u),d.push({event:M,listeners:E}),_?M.data=_:(_=z5(n),_!==null&&(M.data=_)))),(_=aG?lG(t,n):cG(t,n))&&(c=Dv(c,"onBeforeInput"),0<c.length&&(u=new TN("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=_))}Q5(d,e)})}function Cp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Dv(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=vp(t,n),s!=null&&i.unshift(Cp(t,s,r)),s=vp(t,e),s!=null&&i.push(Cp(t,s,r))),t=t.return}return i}function xu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function WN(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&c!==null&&(a=c,r?(l=vp(n,s),l!=null&&o.unshift(Cp(n,l,a))):r||(l=vp(n,s),l!=null&&o.push(Cp(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var kG=/\r\n?/g,CG=/\u0000|\uFFFD/g;function GN(t){return(typeof t=="string"?t:""+t).replace(kG,`
`).replace(CG,"")}function xg(t,e,n){if(e=GN(e),GN(t)!==e&&n)throw Error(he(425))}function jv(){}var VS=null,HS=null;function WS(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var GS=typeof setTimeout=="function"?setTimeout:void 0,_G=typeof clearTimeout=="function"?clearTimeout:void 0,XN=typeof Promise=="function"?Promise:void 0,EG=typeof queueMicrotask=="function"?queueMicrotask:typeof XN<"u"?function(t){return XN.resolve(null).then(t).catch(AG)}:GS;function AG(t){setTimeout(function(){throw t})}function hx(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),xp(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);xp(e)}function bl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function qN(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Cf=Math.random().toString(36).slice(2),oo="__reactFiber$"+Cf,_p="__reactProps$"+Cf,da="__reactContainer$"+Cf,XS="__reactEvents$"+Cf,PG="__reactListeners$"+Cf,NG="__reactHandles$"+Cf;function Mc(t){var e=t[oo];if(e)return e;for(var n=t.parentNode;n;){if(e=n[da]||n[oo]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=qN(t);t!==null;){if(n=t[oo])return n;t=qN(t)}return e}t=n,n=t.parentNode}return null}function Cm(t){return t=t[oo]||t[da],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(he(33))}function gb(t){return t[_p]||null}var qS=[],Qu=-1;function Kl(t){return{current:t}}function nn(t){0>Qu||(t.current=qS[Qu],qS[Qu]=null,Qu--)}function Kt(t,e){Qu++,qS[Qu]=t.current,t.current=e}var Ml={},_i=Kl(Ml),cr=Kl(!1),Xc=Ml;function Wd(t,e){var n=t.type.contextTypes;if(!n)return Ml;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function ur(t){return t=t.childContextTypes,t!=null}function Bv(){nn(cr),nn(_i)}function KN(t,e,n){if(_i.current!==Ml)throw Error(he(168));Kt(_i,e),Kt(cr,n)}function tL(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(he(108,hW(t)||"Unknown",r));return yn({},n,i)}function $v(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ml,Xc=_i.current,Kt(_i,t),Kt(cr,cr.current),!0}function YN(t,e,n){var i=t.stateNode;if(!i)throw Error(he(169));n?(t=tL(t,e,Xc),i.__reactInternalMemoizedMergedChildContext=t,nn(cr),nn(_i),Kt(_i,t)):nn(cr),Kt(cr,n)}var Vo=null,vb=!1,px=!1;function nL(t){Vo===null?Vo=[t]:Vo.push(t)}function MG(t){vb=!0,nL(t)}function Yl(){if(!px&&Vo!==null){px=!0;var t=0,e=Ft;try{var n=Vo;for(Ft=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Vo=null,vb=!1}catch(r){throw Vo!==null&&(Vo=Vo.slice(t+1)),A5(JC,Yl),r}finally{Ft=e,px=!1}}return null}var ed=[],td=0,Fv=null,zv=0,Gr=[],Xr=0,qc=null,sa=1,oa="";function wc(t,e){ed[td++]=zv,ed[td++]=Fv,Fv=t,zv=e}function iL(t,e,n){Gr[Xr++]=sa,Gr[Xr++]=oa,Gr[Xr++]=qc,qc=t;var i=sa;t=oa;var r=32-Ts(i)-1;i&=~(1<<r),n+=1;var s=32-Ts(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,sa=1<<32-Ts(e)+r|n<<r|i,oa=s+t}else sa=1<<s|n<<r|i,oa=t}function o_(t){t.return!==null&&(wc(t,1),iL(t,1,0))}function a_(t){for(;t===Fv;)Fv=ed[--td],ed[td]=null,zv=ed[--td],ed[td]=null;for(;t===qc;)qc=Gr[--Xr],Gr[Xr]=null,oa=Gr[--Xr],Gr[Xr]=null,sa=Gr[--Xr],Gr[Xr]=null}var Rr=null,Er=null,cn=!1,Es=null;function rL(t,e){var n=Jr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function JN(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Rr=t,Er=bl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Rr=t,Er=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=qc!==null?{id:sa,overflow:oa}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Jr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Rr=t,Er=null,!0):!1;default:return!1}}function KS(t){return(t.mode&1)!==0&&(t.flags&128)===0}function YS(t){if(cn){var e=Er;if(e){var n=e;if(!JN(t,e)){if(KS(t))throw Error(he(418));e=bl(n.nextSibling);var i=Rr;e&&JN(t,e)?rL(i,n):(t.flags=t.flags&-4097|2,cn=!1,Rr=t)}}else{if(KS(t))throw Error(he(418));t.flags=t.flags&-4097|2,cn=!1,Rr=t}}}function ZN(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Rr=t}function wg(t){if(t!==Rr)return!1;if(!cn)return ZN(t),cn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!WS(t.type,t.memoizedProps)),e&&(e=Er)){if(KS(t))throw sL(),Error(he(418));for(;e;)rL(t,e),e=bl(e.nextSibling)}if(ZN(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(he(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Er=bl(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Er=null}}else Er=Rr?bl(t.stateNode.nextSibling):null;return!0}function sL(){for(var t=Er;t;)t=bl(t.nextSibling)}function Gd(){Er=Rr=null,cn=!1}function l_(t){Es===null?Es=[t]:Es.push(t)}var RG=xa.ReactCurrentBatchConfig;function Gf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(he(309));var i=n.stateNode}if(!i)throw Error(he(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(he(284));if(!n._owner)throw Error(he(290,t))}return t}function Sg(t,e){throw t=Object.prototype.toString.call(e),Error(he(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function QN(t){var e=t._init;return e(t._payload)}function oL(t){function e(v,b){if(t){var w=v.deletions;w===null?(v.deletions=[b],v.flags|=16):w.push(b)}}function n(v,b){if(!t)return null;for(;b!==null;)e(v,b),b=b.sibling;return null}function i(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function r(v,b){return v=kl(v,b),v.index=0,v.sibling=null,v}function s(v,b,w){return v.index=w,t?(w=v.alternate,w!==null?(w=w.index,w<b?(v.flags|=2,b):w):(v.flags|=2,b)):(v.flags|=1048576,b)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,b,w,k){return b===null||b.tag!==6?(b=wx(w,v.mode,k),b.return=v,b):(b=r(b,w),b.return=v,b)}function l(v,b,w,k){var C=w.type;return C===qu?u(v,b,w.props.children,k,w.key):b!==null&&(b.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ba&&QN(C)===b.type)?(k=r(b,w.props),k.ref=Gf(v,b,w),k.return=v,k):(k=V0(w.type,w.key,w.props,null,v.mode,k),k.ref=Gf(v,b,w),k.return=v,k)}function c(v,b,w,k){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=Sx(w,v.mode,k),b.return=v,b):(b=r(b,w.children||[]),b.return=v,b)}function u(v,b,w,k,C){return b===null||b.tag!==7?(b=$c(w,v.mode,k,C),b.return=v,b):(b=r(b,w),b.return=v,b)}function d(v,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=wx(""+b,v.mode,w),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case dg:return w=V0(b.type,b.key,b.props,null,v.mode,w),w.ref=Gf(v,null,b),w.return=v,w;case Xu:return b=Sx(b,v.mode,w),b.return=v,b;case Ba:var k=b._init;return d(v,k(b._payload),w)}if(yh(b)||zf(b))return b=$c(b,v.mode,w,null),b.return=v,b;Sg(v,b)}return null}function f(v,b,w,k){var C=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:a(v,b,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case dg:return w.key===C?l(v,b,w,k):null;case Xu:return w.key===C?c(v,b,w,k):null;case Ba:return C=w._init,f(v,b,C(w._payload),k)}if(yh(w)||zf(w))return C!==null?null:u(v,b,w,k,null);Sg(v,w)}return null}function p(v,b,w,k,C){if(typeof k=="string"&&k!==""||typeof k=="number")return v=v.get(w)||null,a(b,v,""+k,C);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case dg:return v=v.get(k.key===null?w:k.key)||null,l(b,v,k,C);case Xu:return v=v.get(k.key===null?w:k.key)||null,c(b,v,k,C);case Ba:var E=k._init;return p(v,b,w,E(k._payload),C)}if(yh(k)||zf(k))return v=v.get(w)||null,u(b,v,k,C,null);Sg(b,k)}return null}function m(v,b,w,k){for(var C=null,E=null,_=b,M=b=0,R=null;_!==null&&M<w.length;M++){_.index>M?(R=_,_=null):R=_.sibling;var T=f(v,_,w[M],k);if(T===null){_===null&&(_=R);break}t&&_&&T.alternate===null&&e(v,_),b=s(T,b,M),E===null?C=T:E.sibling=T,E=T,_=R}if(M===w.length)return n(v,_),cn&&wc(v,M),C;if(_===null){for(;M<w.length;M++)_=d(v,w[M],k),_!==null&&(b=s(_,b,M),E===null?C=_:E.sibling=_,E=_);return cn&&wc(v,M),C}for(_=i(v,_);M<w.length;M++)R=p(_,v,M,w[M],k),R!==null&&(t&&R.alternate!==null&&_.delete(R.key===null?M:R.key),b=s(R,b,M),E===null?C=R:E.sibling=R,E=R);return t&&_.forEach(function(L){return e(v,L)}),cn&&wc(v,M),C}function g(v,b,w,k){var C=zf(w);if(typeof C!="function")throw Error(he(150));if(w=C.call(w),w==null)throw Error(he(151));for(var E=C=null,_=b,M=b=0,R=null,T=w.next();_!==null&&!T.done;M++,T=w.next()){_.index>M?(R=_,_=null):R=_.sibling;var L=f(v,_,T.value,k);if(L===null){_===null&&(_=R);break}t&&_&&L.alternate===null&&e(v,_),b=s(L,b,M),E===null?C=L:E.sibling=L,E=L,_=R}if(T.done)return n(v,_),cn&&wc(v,M),C;if(_===null){for(;!T.done;M++,T=w.next())T=d(v,T.value,k),T!==null&&(b=s(T,b,M),E===null?C=T:E.sibling=T,E=T);return cn&&wc(v,M),C}for(_=i(v,_);!T.done;M++,T=w.next())T=p(_,v,M,T.value,k),T!==null&&(t&&T.alternate!==null&&_.delete(T.key===null?M:T.key),b=s(T,b,M),E===null?C=T:E.sibling=T,E=T);return t&&_.forEach(function(I){return e(v,I)}),cn&&wc(v,M),C}function y(v,b,w,k){if(typeof w=="object"&&w!==null&&w.type===qu&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case dg:e:{for(var C=w.key,E=b;E!==null;){if(E.key===C){if(C=w.type,C===qu){if(E.tag===7){n(v,E.sibling),b=r(E,w.props.children),b.return=v,v=b;break e}}else if(E.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ba&&QN(C)===E.type){n(v,E.sibling),b=r(E,w.props),b.ref=Gf(v,E,w),b.return=v,v=b;break e}n(v,E);break}else e(v,E);E=E.sibling}w.type===qu?(b=$c(w.props.children,v.mode,k,w.key),b.return=v,v=b):(k=V0(w.type,w.key,w.props,null,v.mode,k),k.ref=Gf(v,b,w),k.return=v,v=k)}return o(v);case Xu:e:{for(E=w.key;b!==null;){if(b.key===E)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){n(v,b.sibling),b=r(b,w.children||[]),b.return=v,v=b;break e}else{n(v,b);break}else e(v,b);b=b.sibling}b=Sx(w,v.mode,k),b.return=v,v=b}return o(v);case Ba:return E=w._init,y(v,b,E(w._payload),k)}if(yh(w))return m(v,b,w,k);if(zf(w))return g(v,b,w,k);Sg(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(n(v,b.sibling),b=r(b,w),b.return=v,v=b):(n(v,b),b=wx(w,v.mode,k),b.return=v,v=b),o(v)):n(v,b)}return y}var Xd=oL(!0),aL=oL(!1),Uv=Kl(null),Vv=null,nd=null,c_=null;function u_(){c_=nd=Vv=null}function d_(t){var e=Uv.current;nn(Uv),t._currentValue=e}function JS(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function yd(t,e){Vv=t,c_=nd=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ar=!0),t.firstContext=null)}function us(t){var e=t._currentValue;if(c_!==t)if(t={context:t,memoizedValue:e,next:null},nd===null){if(Vv===null)throw Error(he(308));nd=t,Vv.dependencies={lanes:0,firstContext:t}}else nd=nd.next=t;return e}var Rc=null;function f_(t){Rc===null?Rc=[t]:Rc.push(t)}function lL(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,f_(e)):(n.next=r.next,r.next=n),e.interleaved=n,fa(t,i)}function fa(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var $a=!1;function h_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cL(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function aa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function xl(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Mt&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,fa(t,n)}return r=i.interleaved,r===null?(e.next=e,f_(i)):(e.next=r.next,r.next=e),i.interleaved=e,fa(t,n)}function j0(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,ZC(t,n)}}function eM(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Hv(t,e,n,i){var r=t.updateQueue;$a=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=r.baseState;o=0,u=c=l=null,a=s;do{var f=a.lane,p=a.eventTime;if((i&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,g=a;switch(f=e,p=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){d=m.call(p,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,f=typeof m=="function"?m.call(p,d,f):m,f==null)break e;d=yn({},d,f);break e;case 2:$a=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Yc|=o,t.lanes=o,t.memoizedState=d}}function tM(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(he(191,r));r.call(i)}}}var _m={},ko=Kl(_m),Ep=Kl(_m),Ap=Kl(_m);function Ic(t){if(t===_m)throw Error(he(174));return t}function p_(t,e){switch(Kt(Ap,e),Kt(Ep,t),Kt(ko,_m),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:RS(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=RS(e,t)}nn(ko),Kt(ko,e)}function qd(){nn(ko),nn(Ep),nn(Ap)}function uL(t){Ic(Ap.current);var e=Ic(ko.current),n=RS(e,t.type);e!==n&&(Kt(Ep,t),Kt(ko,n))}function m_(t){Ep.current===t&&(nn(ko),nn(Ep))}var hn=Kl(0);function Wv(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var mx=[];function g_(){for(var t=0;t<mx.length;t++)mx[t]._workInProgressVersionPrimary=null;mx.length=0}var B0=xa.ReactCurrentDispatcher,gx=xa.ReactCurrentBatchConfig,Kc=0,vn=null,Dn=null,Gn=null,Gv=!1,Wh=!1,Pp=0,IG=0;function gi(){throw Error(he(321))}function v_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ls(t[n],e[n]))return!1;return!0}function y_(t,e,n,i,r,s){if(Kc=s,vn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,B0.current=t===null||t.memoizedState===null?DG:jG,t=n(i,r),Wh){s=0;do{if(Wh=!1,Pp=0,25<=s)throw Error(he(301));s+=1,Gn=Dn=null,e.updateQueue=null,B0.current=BG,t=n(i,r)}while(Wh)}if(B0.current=Xv,e=Dn!==null&&Dn.next!==null,Kc=0,Gn=Dn=vn=null,Gv=!1,e)throw Error(he(300));return t}function b_(){var t=Pp!==0;return Pp=0,t}function Js(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gn===null?vn.memoizedState=Gn=t:Gn=Gn.next=t,Gn}function ds(){if(Dn===null){var t=vn.alternate;t=t!==null?t.memoizedState:null}else t=Dn.next;var e=Gn===null?vn.memoizedState:Gn.next;if(e!==null)Gn=e,Dn=t;else{if(t===null)throw Error(he(310));Dn=t,t={memoizedState:Dn.memoizedState,baseState:Dn.baseState,baseQueue:Dn.baseQueue,queue:Dn.queue,next:null},Gn===null?vn.memoizedState=Gn=t:Gn=Gn.next=t}return Gn}function Np(t,e){return typeof e=="function"?e(t):e}function vx(t){var e=ds(),n=e.queue;if(n===null)throw Error(he(311));n.lastRenderedReducer=t;var i=Dn,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((Kc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:t(i,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=i):l=l.next=d,vn.lanes|=u,Yc|=u}c=c.next}while(c!==null&&c!==s);l===null?o=i:l.next=a,Ls(i,e.memoizedState)||(ar=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,vn.lanes|=s,Yc|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function yx(t){var e=ds(),n=e.queue;if(n===null)throw Error(he(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);Ls(s,e.memoizedState)||(ar=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function dL(){}function fL(t,e){var n=vn,i=ds(),r=e(),s=!Ls(i.memoizedState,r);if(s&&(i.memoizedState=r,ar=!0),i=i.queue,x_(mL.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||Gn!==null&&Gn.memoizedState.tag&1){if(n.flags|=2048,Mp(9,pL.bind(null,n,i,r,e),void 0,null),Xn===null)throw Error(he(349));Kc&30||hL(n,e,r)}return r}function hL(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=vn.updateQueue,e===null?(e={lastEffect:null,stores:null},vn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function pL(t,e,n,i){e.value=n,e.getSnapshot=i,gL(e)&&vL(t)}function mL(t,e,n){return n(function(){gL(e)&&vL(t)})}function gL(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ls(t,n)}catch{return!0}}function vL(t){var e=fa(t,1);e!==null&&Os(e,t,1,-1)}function nM(t){var e=Js();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Np,lastRenderedState:t},e.queue=t,t=t.dispatch=LG.bind(null,vn,t),[e.memoizedState,t]}function Mp(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=vn.updateQueue,e===null?(e={lastEffect:null,stores:null},vn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function yL(){return ds().memoizedState}function $0(t,e,n,i){var r=Js();vn.flags|=t,r.memoizedState=Mp(1|e,n,void 0,i===void 0?null:i)}function yb(t,e,n,i){var r=ds();i=i===void 0?null:i;var s=void 0;if(Dn!==null){var o=Dn.memoizedState;if(s=o.destroy,i!==null&&v_(i,o.deps)){r.memoizedState=Mp(e,n,s,i);return}}vn.flags|=t,r.memoizedState=Mp(1|e,n,s,i)}function iM(t,e){return $0(8390656,8,t,e)}function x_(t,e){return yb(2048,8,t,e)}function bL(t,e){return yb(4,2,t,e)}function xL(t,e){return yb(4,4,t,e)}function wL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function SL(t,e,n){return n=n!=null?n.concat([t]):null,yb(4,4,wL.bind(null,e,t),n)}function w_(){}function kL(t,e){var n=ds();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&v_(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function CL(t,e){var n=ds();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&v_(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function _L(t,e,n){return Kc&21?(Ls(n,e)||(n=M5(),vn.lanes|=n,Yc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ar=!0),t.memoizedState=n)}function TG(t,e){var n=Ft;Ft=n!==0&&4>n?n:4,t(!0);var i=gx.transition;gx.transition={};try{t(!1),e()}finally{Ft=n,gx.transition=i}}function EL(){return ds().memoizedState}function OG(t,e,n){var i=Sl(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},AL(t))PL(e,n);else if(n=lL(t,e,n,i),n!==null){var r=Oi();Os(n,t,i,r),NL(n,e,i)}}function LG(t,e,n){var i=Sl(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(AL(t))PL(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,Ls(a,o)){var l=e.interleaved;l===null?(r.next=r,f_(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=lL(t,e,r,i),n!==null&&(r=Oi(),Os(n,t,i,r),NL(n,e,i))}}function AL(t){var e=t.alternate;return t===vn||e!==null&&e===vn}function PL(t,e){Wh=Gv=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function NL(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,ZC(t,n)}}var Xv={readContext:us,useCallback:gi,useContext:gi,useEffect:gi,useImperativeHandle:gi,useInsertionEffect:gi,useLayoutEffect:gi,useMemo:gi,useReducer:gi,useRef:gi,useState:gi,useDebugValue:gi,useDeferredValue:gi,useTransition:gi,useMutableSource:gi,useSyncExternalStore:gi,useId:gi,unstable_isNewReconciler:!1},DG={readContext:us,useCallback:function(t,e){return Js().memoizedState=[t,e===void 0?null:e],t},useContext:us,useEffect:iM,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,$0(4194308,4,wL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return $0(4194308,4,t,e)},useInsertionEffect:function(t,e){return $0(4,2,t,e)},useMemo:function(t,e){var n=Js();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=Js();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=OG.bind(null,vn,t),[i.memoizedState,t]},useRef:function(t){var e=Js();return t={current:t},e.memoizedState=t},useState:nM,useDebugValue:w_,useDeferredValue:function(t){return Js().memoizedState=t},useTransition:function(){var t=nM(!1),e=t[0];return t=TG.bind(null,t[1]),Js().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=vn,r=Js();if(cn){if(n===void 0)throw Error(he(407));n=n()}else{if(n=e(),Xn===null)throw Error(he(349));Kc&30||hL(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,iM(mL.bind(null,i,s,t),[t]),i.flags|=2048,Mp(9,pL.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=Js(),e=Xn.identifierPrefix;if(cn){var n=oa,i=sa;n=(i&~(1<<32-Ts(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=Pp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=IG++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},jG={readContext:us,useCallback:kL,useContext:us,useEffect:x_,useImperativeHandle:SL,useInsertionEffect:bL,useLayoutEffect:xL,useMemo:CL,useReducer:vx,useRef:yL,useState:function(){return vx(Np)},useDebugValue:w_,useDeferredValue:function(t){var e=ds();return _L(e,Dn.memoizedState,t)},useTransition:function(){var t=vx(Np)[0],e=ds().memoizedState;return[t,e]},useMutableSource:dL,useSyncExternalStore:fL,useId:EL,unstable_isNewReconciler:!1},BG={readContext:us,useCallback:kL,useContext:us,useEffect:x_,useImperativeHandle:SL,useInsertionEffect:bL,useLayoutEffect:xL,useMemo:CL,useReducer:yx,useRef:yL,useState:function(){return yx(Np)},useDebugValue:w_,useDeferredValue:function(t){var e=ds();return Dn===null?e.memoizedState=t:_L(e,Dn.memoizedState,t)},useTransition:function(){var t=yx(Np)[0],e=ds().memoizedState;return[t,e]},useMutableSource:dL,useSyncExternalStore:fL,useId:EL,unstable_isNewReconciler:!1};function xs(t,e){if(t&&t.defaultProps){e=yn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ZS(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:yn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var bb={isMounted:function(t){return(t=t._reactInternals)?hu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Oi(),r=Sl(t),s=aa(i,r);s.payload=e,n!=null&&(s.callback=n),e=xl(t,s,r),e!==null&&(Os(e,t,r,i),j0(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Oi(),r=Sl(t),s=aa(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=xl(t,s,r),e!==null&&(Os(e,t,r,i),j0(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Oi(),i=Sl(t),r=aa(n,i);r.tag=2,e!=null&&(r.callback=e),e=xl(t,r,i),e!==null&&(Os(e,t,i,n),j0(e,t,i))}};function rM(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!Sp(n,i)||!Sp(r,s):!0}function ML(t,e,n){var i=!1,r=Ml,s=e.contextType;return typeof s=="object"&&s!==null?s=us(s):(r=ur(e)?Xc:_i.current,i=e.contextTypes,s=(i=i!=null)?Wd(t,r):Ml),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bb,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function sM(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&bb.enqueueReplaceState(e,e.state,null)}function QS(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},h_(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=us(s):(s=ur(e)?Xc:_i.current,r.context=Wd(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ZS(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&bb.enqueueReplaceState(r,r.state,null),Hv(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Kd(t,e){try{var n="",i=e;do n+=fW(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function bx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function e2(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var $G=typeof WeakMap=="function"?WeakMap:Map;function RL(t,e,n){n=aa(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Kv||(Kv=!0,u2=i),e2(t,e)},n}function IL(t,e,n){n=aa(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){e2(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){e2(t,e),typeof i!="function"&&(wl===null?wl=new Set([this]):wl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function oM(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new $G;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=QG.bind(null,t,e,n),e.then(t,t))}function aM(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function lM(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=aa(-1,1),e.tag=2,xl(n,e,1))),n.lanes|=1),t)}var FG=xa.ReactCurrentOwner,ar=!1;function Ii(t,e,n,i){e.child=t===null?aL(e,null,n,i):Xd(e,t.child,n,i)}function cM(t,e,n,i,r){n=n.render;var s=e.ref;return yd(e,r),i=y_(t,e,n,i,s,r),n=b_(),t!==null&&!ar?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,ha(t,e,r)):(cn&&n&&o_(e),e.flags|=1,Ii(t,e,i,r),e.child)}function uM(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!N_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,TL(t,e,s,i,r)):(t=V0(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Sp,n(o,i)&&t.ref===e.ref)return ha(t,e,r)}return e.flags|=1,t=kl(s,i),t.ref=e.ref,t.return=e,e.child=t}function TL(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(Sp(s,i)&&t.ref===e.ref)if(ar=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(ar=!0);else return e.lanes=t.lanes,ha(t,e,r)}return t2(t,e,n,i,r)}function OL(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Kt(rd,xr),xr|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Kt(rd,xr),xr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,Kt(rd,xr),xr|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,Kt(rd,xr),xr|=i;return Ii(t,e,r,n),e.child}function LL(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function t2(t,e,n,i,r){var s=ur(n)?Xc:_i.current;return s=Wd(e,s),yd(e,r),n=y_(t,e,n,i,s,r),i=b_(),t!==null&&!ar?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,ha(t,e,r)):(cn&&i&&o_(e),e.flags|=1,Ii(t,e,n,r),e.child)}function dM(t,e,n,i,r){if(ur(n)){var s=!0;$v(e)}else s=!1;if(yd(e,r),e.stateNode===null)F0(t,e),ML(e,n,i),QS(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=us(c):(c=ur(n)?Xc:_i.current,c=Wd(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==c)&&sM(e,o,i,c),$a=!1;var f=e.memoizedState;o.state=f,Hv(e,i,o,r),l=e.memoizedState,a!==i||f!==l||cr.current||$a?(typeof u=="function"&&(ZS(e,n,u,i),l=e.memoizedState),(a=$a||rM(e,n,a,i,f,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,cL(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:xs(e.type,a),o.props=c,d=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=us(l):(l=ur(n)?Xc:_i.current,l=Wd(e,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==l)&&sM(e,o,i,l),$a=!1,f=e.memoizedState,o.state=f,Hv(e,i,o,r);var m=e.memoizedState;a!==d||f!==m||cr.current||$a?(typeof p=="function"&&(ZS(e,n,p,i),m=e.memoizedState),(c=$a||rM(e,n,c,i,f,m,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=m),o.props=i,o.state=m,o.context=l,i=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),i=!1)}return n2(t,e,n,i,s,r)}function n2(t,e,n,i,r,s){LL(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&YN(e,n,!1),ha(t,e,s);i=e.stateNode,FG.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=Xd(e,t.child,null,s),e.child=Xd(e,null,a,s)):Ii(t,e,a,s),e.memoizedState=i.state,r&&YN(e,n,!0),e.child}function DL(t){var e=t.stateNode;e.pendingContext?KN(t,e.pendingContext,e.pendingContext!==e.context):e.context&&KN(t,e.context,!1),p_(t,e.containerInfo)}function fM(t,e,n,i,r){return Gd(),l_(r),e.flags|=256,Ii(t,e,n,i),e.child}var i2={dehydrated:null,treeContext:null,retryLane:0};function r2(t){return{baseLanes:t,cachePool:null,transitions:null}}function jL(t,e,n){var i=e.pendingProps,r=hn.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Kt(hn,r&1),t===null)return YS(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Sb(o,i,0,null),t=$c(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=r2(n),e.memoizedState=i2,t):S_(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return zG(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=kl(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=kl(a,s):(s=$c(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?r2(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=i2,i}return s=t.child,t=s.sibling,i=kl(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function S_(t,e){return e=Sb({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function kg(t,e,n,i){return i!==null&&l_(i),Xd(e,t.child,null,n),t=S_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function zG(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=bx(Error(he(422))),kg(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=Sb({mode:"visible",children:i.children},r,0,null),s=$c(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Xd(e,t.child,null,o),e.child.memoizedState=r2(o),e.memoizedState=i2,s);if(!(e.mode&1))return kg(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(he(419)),i=bx(s,i,void 0),kg(t,e,o,i)}if(a=(o&t.childLanes)!==0,ar||a){if(i=Xn,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,fa(t,r),Os(i,t,r,-1))}return P_(),i=bx(Error(he(421))),kg(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=eX.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,Er=bl(r.nextSibling),Rr=e,cn=!0,Es=null,t!==null&&(Gr[Xr++]=sa,Gr[Xr++]=oa,Gr[Xr++]=qc,sa=t.id,oa=t.overflow,qc=e),e=S_(e,i.children),e.flags|=4096,e)}function hM(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),JS(t.return,e,n)}function xx(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function BL(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Ii(t,e,i.children,n),i=hn.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&hM(t,n,e);else if(t.tag===19)hM(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Kt(hn,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Wv(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),xx(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Wv(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}xx(e,!0,n,null,s);break;case"together":xx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function F0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ha(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Yc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(he(153));if(e.child!==null){for(t=e.child,n=kl(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=kl(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function UG(t,e,n){switch(e.tag){case 3:DL(e),Gd();break;case 5:uL(e);break;case 1:ur(e.type)&&$v(e);break;case 4:p_(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Kt(Uv,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Kt(hn,hn.current&1),e.flags|=128,null):n&e.child.childLanes?jL(t,e,n):(Kt(hn,hn.current&1),t=ha(t,e,n),t!==null?t.sibling:null);Kt(hn,hn.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return BL(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Kt(hn,hn.current),i)break;return null;case 22:case 23:return e.lanes=0,OL(t,e,n)}return ha(t,e,n)}var $L,s2,FL,zL;$L=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};s2=function(){};FL=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Ic(ko.current);var s=null;switch(n){case"input":r=AS(t,r),i=AS(t,i),s=[];break;case"select":r=yn({},r,{value:void 0}),i=yn({},i,{value:void 0}),s=[];break;case"textarea":r=MS(t,r),i=MS(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=jv)}IS(n,i);var o;n=null;for(c in r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(mp.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(a=r!=null?r[c]:void 0,i.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(mp.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Yt("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};zL=function(t,e,n,i){n!==i&&(e.flags|=4)};function Xf(t,e){if(!cn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function vi(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function VG(t,e,n){var i=e.pendingProps;switch(a_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vi(e),null;case 1:return ur(e.type)&&Bv(),vi(e),null;case 3:return i=e.stateNode,qd(),nn(cr),nn(_i),g_(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(wg(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Es!==null&&(h2(Es),Es=null))),s2(t,e),vi(e),null;case 5:m_(e);var r=Ic(Ap.current);if(n=e.type,t!==null&&e.stateNode!=null)FL(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(he(166));return vi(e),null}if(t=Ic(ko.current),wg(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[oo]=e,i[_p]=s,t=(e.mode&1)!==0,n){case"dialog":Yt("cancel",i),Yt("close",i);break;case"iframe":case"object":case"embed":Yt("load",i);break;case"video":case"audio":for(r=0;r<xh.length;r++)Yt(xh[r],i);break;case"source":Yt("error",i);break;case"img":case"image":case"link":Yt("error",i),Yt("load",i);break;case"details":Yt("toggle",i);break;case"input":SN(i,s),Yt("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Yt("invalid",i);break;case"textarea":CN(i,s),Yt("invalid",i)}IS(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&xg(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&xg(i.textContent,a,t),r=["children",""+a]):mp.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Yt("scroll",i)}switch(n){case"input":fg(i),kN(i,s,!0);break;case"textarea":fg(i),_N(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=jv)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=m5(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[oo]=e,t[_p]=i,$L(t,e,!1,!1),e.stateNode=t;e:{switch(o=TS(n,i),n){case"dialog":Yt("cancel",t),Yt("close",t),r=i;break;case"iframe":case"object":case"embed":Yt("load",t),r=i;break;case"video":case"audio":for(r=0;r<xh.length;r++)Yt(xh[r],t);r=i;break;case"source":Yt("error",t),r=i;break;case"img":case"image":case"link":Yt("error",t),Yt("load",t),r=i;break;case"details":Yt("toggle",t),r=i;break;case"input":SN(t,i),r=AS(t,i),Yt("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=yn({},i,{value:void 0}),Yt("invalid",t);break;case"textarea":CN(t,i),r=MS(t,i),Yt("invalid",t);break;default:r=i}IS(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?y5(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&g5(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&gp(t,l):typeof l=="number"&&gp(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(mp.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Yt("scroll",t):l!=null&&GC(t,s,l,o))}switch(n){case"input":fg(t),kN(t,i,!1);break;case"textarea":fg(t),_N(t);break;case"option":i.value!=null&&t.setAttribute("value",""+Nl(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?pd(t,!!i.multiple,s,!1):i.defaultValue!=null&&pd(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=jv)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return vi(e),null;case 6:if(t&&e.stateNode!=null)zL(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(he(166));if(n=Ic(Ap.current),Ic(ko.current),wg(e)){if(i=e.stateNode,n=e.memoizedProps,i[oo]=e,(s=i.nodeValue!==n)&&(t=Rr,t!==null))switch(t.tag){case 3:xg(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&xg(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[oo]=e,e.stateNode=i}return vi(e),null;case 13:if(nn(hn),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(cn&&Er!==null&&e.mode&1&&!(e.flags&128))sL(),Gd(),e.flags|=98560,s=!1;else if(s=wg(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(he(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(he(317));s[oo]=e}else Gd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;vi(e),s=!1}else Es!==null&&(h2(Es),Es=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||hn.current&1?zn===0&&(zn=3):P_())),e.updateQueue!==null&&(e.flags|=4),vi(e),null);case 4:return qd(),s2(t,e),t===null&&kp(e.stateNode.containerInfo),vi(e),null;case 10:return d_(e.type._context),vi(e),null;case 17:return ur(e.type)&&Bv(),vi(e),null;case 19:if(nn(hn),s=e.memoizedState,s===null)return vi(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Xf(s,!1);else{if(zn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Wv(t),o!==null){for(e.flags|=128,Xf(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Kt(hn,hn.current&1|2),e.child}t=t.sibling}s.tail!==null&&Pn()>Yd&&(e.flags|=128,i=!0,Xf(s,!1),e.lanes=4194304)}else{if(!i)if(t=Wv(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Xf(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!cn)return vi(e),null}else 2*Pn()-s.renderingStartTime>Yd&&n!==1073741824&&(e.flags|=128,i=!0,Xf(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Pn(),e.sibling=null,n=hn.current,Kt(hn,i?n&1|2:n&1),e):(vi(e),null);case 22:case 23:return A_(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?xr&1073741824&&(vi(e),e.subtreeFlags&6&&(e.flags|=8192)):vi(e),null;case 24:return null;case 25:return null}throw Error(he(156,e.tag))}function HG(t,e){switch(a_(e),e.tag){case 1:return ur(e.type)&&Bv(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return qd(),nn(cr),nn(_i),g_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return m_(e),null;case 13:if(nn(hn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(he(340));Gd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return nn(hn),null;case 4:return qd(),null;case 10:return d_(e.type._context),null;case 22:case 23:return A_(),null;case 24:return null;default:return null}}var Cg=!1,Si=!1,WG=typeof WeakSet=="function"?WeakSet:Set,Te=null;function id(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){xn(t,e,i)}else n.current=null}function o2(t,e,n){try{n()}catch(i){xn(t,e,i)}}var pM=!1;function GG(t,e){if(VS=Ov,t=G5(),s_(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,f=null;t:for(;;){for(var p;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(l=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===t)break t;if(f===n&&++c===r&&(a=o),f===s&&++u===i&&(l=o),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(HS={focusedElem:t,selectionRange:n},Ov=!1,Te=e;Te!==null;)if(e=Te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Te=t;else for(;Te!==null;){e=Te;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:xs(e.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(k){xn(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,Te=t;break}Te=e.return}return m=pM,pM=!1,m}function Gh(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&o2(e,n,s)}r=r.next}while(r!==i)}}function xb(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function a2(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function UL(t){var e=t.alternate;e!==null&&(t.alternate=null,UL(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[oo],delete e[_p],delete e[XS],delete e[PG],delete e[NG])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function VL(t){return t.tag===5||t.tag===3||t.tag===4}function mM(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||VL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function l2(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=jv));else if(i!==4&&(t=t.child,t!==null))for(l2(t,e,n),t=t.sibling;t!==null;)l2(t,e,n),t=t.sibling}function c2(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(c2(t,e,n),t=t.sibling;t!==null;)c2(t,e,n),t=t.sibling}var ti=null,_s=!1;function Ma(t,e,n){for(n=n.child;n!==null;)HL(t,e,n),n=n.sibling}function HL(t,e,n){if(So&&typeof So.onCommitFiberUnmount=="function")try{So.onCommitFiberUnmount(fb,n)}catch{}switch(n.tag){case 5:Si||id(n,e);case 6:var i=ti,r=_s;ti=null,Ma(t,e,n),ti=i,_s=r,ti!==null&&(_s?(t=ti,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ti.removeChild(n.stateNode));break;case 18:ti!==null&&(_s?(t=ti,n=n.stateNode,t.nodeType===8?hx(t.parentNode,n):t.nodeType===1&&hx(t,n),xp(t)):hx(ti,n.stateNode));break;case 4:i=ti,r=_s,ti=n.stateNode.containerInfo,_s=!0,Ma(t,e,n),ti=i,_s=r;break;case 0:case 11:case 14:case 15:if(!Si&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&o2(n,e,o),r=r.next}while(r!==i)}Ma(t,e,n);break;case 1:if(!Si&&(id(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){xn(n,e,a)}Ma(t,e,n);break;case 21:Ma(t,e,n);break;case 22:n.mode&1?(Si=(i=Si)||n.memoizedState!==null,Ma(t,e,n),Si=i):Ma(t,e,n);break;default:Ma(t,e,n)}}function gM(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new WG),e.forEach(function(i){var r=tX.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function ms(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ti=a.stateNode,_s=!1;break e;case 3:ti=a.stateNode.containerInfo,_s=!0;break e;case 4:ti=a.stateNode.containerInfo,_s=!0;break e}a=a.return}if(ti===null)throw Error(he(160));HL(s,o,r),ti=null,_s=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){xn(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)WL(e,t),e=e.sibling}function WL(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ms(e,t),Hs(t),i&4){try{Gh(3,t,t.return),xb(3,t)}catch(g){xn(t,t.return,g)}try{Gh(5,t,t.return)}catch(g){xn(t,t.return,g)}}break;case 1:ms(e,t),Hs(t),i&512&&n!==null&&id(n,n.return);break;case 5:if(ms(e,t),Hs(t),i&512&&n!==null&&id(n,n.return),t.flags&32){var r=t.stateNode;try{gp(r,"")}catch(g){xn(t,t.return,g)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&h5(r,s),TS(a,o);var c=TS(a,s);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?y5(r,d):u==="dangerouslySetInnerHTML"?g5(r,d):u==="children"?gp(r,d):GC(r,u,d,c)}switch(a){case"input":PS(r,s);break;case"textarea":p5(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?pd(r,!!s.multiple,p,!1):f!==!!s.multiple&&(s.defaultValue!=null?pd(r,!!s.multiple,s.defaultValue,!0):pd(r,!!s.multiple,s.multiple?[]:"",!1))}r[_p]=s}catch(g){xn(t,t.return,g)}}break;case 6:if(ms(e,t),Hs(t),i&4){if(t.stateNode===null)throw Error(he(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(g){xn(t,t.return,g)}}break;case 3:if(ms(e,t),Hs(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{xp(e.containerInfo)}catch(g){xn(t,t.return,g)}break;case 4:ms(e,t),Hs(t);break;case 13:ms(e,t),Hs(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(__=Pn())),i&4&&gM(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Si=(c=Si)||u,ms(e,t),Si=c):ms(e,t),Hs(t),i&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Te=t,u=t.child;u!==null;){for(d=Te=u;Te!==null;){switch(f=Te,p=f.child,f.tag){case 0:case 11:case 14:case 15:Gh(4,f,f.return);break;case 1:id(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){i=f,n=f.return;try{e=i,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){xn(i,n,g)}}break;case 5:id(f,f.return);break;case 22:if(f.memoizedState!==null){yM(d);continue}}p!==null?(p.return=f,Te=p):yM(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=v5("display",o))}catch(g){xn(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){xn(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ms(e,t),Hs(t),i&4&&gM(t);break;case 21:break;default:ms(e,t),Hs(t)}}function Hs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(VL(n)){var i=n;break e}n=n.return}throw Error(he(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(gp(r,""),i.flags&=-33);var s=mM(t);c2(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=mM(t);l2(t,a,o);break;default:throw Error(he(161))}}catch(l){xn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function XG(t,e,n){Te=t,GL(t)}function GL(t,e,n){for(var i=(t.mode&1)!==0;Te!==null;){var r=Te,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||Cg;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Si;a=Cg;var c=Si;if(Cg=o,(Si=l)&&!c)for(Te=r;Te!==null;)o=Te,l=o.child,o.tag===22&&o.memoizedState!==null?bM(r):l!==null?(l.return=o,Te=l):bM(r);for(;s!==null;)Te=s,GL(s),s=s.sibling;Te=r,Cg=a,Si=c}vM(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Te=s):vM(t)}}function vM(t){for(;Te!==null;){var e=Te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Si||xb(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Si)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:xs(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&tM(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}tM(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&xp(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}Si||e.flags&512&&a2(e)}catch(f){xn(e,e.return,f)}}if(e===t){Te=null;break}if(n=e.sibling,n!==null){n.return=e.return,Te=n;break}Te=e.return}}function yM(t){for(;Te!==null;){var e=Te;if(e===t){Te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Te=n;break}Te=e.return}}function bM(t){for(;Te!==null;){var e=Te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{xb(4,e)}catch(l){xn(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){xn(e,r,l)}}var s=e.return;try{a2(e)}catch(l){xn(e,s,l)}break;case 5:var o=e.return;try{a2(e)}catch(l){xn(e,o,l)}}}catch(l){xn(e,e.return,l)}if(e===t){Te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Te=a;break}Te=e.return}}var qG=Math.ceil,qv=xa.ReactCurrentDispatcher,k_=xa.ReactCurrentOwner,rs=xa.ReactCurrentBatchConfig,Mt=0,Xn=null,In=null,di=0,xr=0,rd=Kl(0),zn=0,Rp=null,Yc=0,wb=0,C_=0,Xh=null,nr=null,__=0,Yd=1/0,Fo=null,Kv=!1,u2=null,wl=null,_g=!1,rl=null,Yv=0,qh=0,d2=null,z0=-1,U0=0;function Oi(){return Mt&6?Pn():z0!==-1?z0:z0=Pn()}function Sl(t){return t.mode&1?Mt&2&&di!==0?di&-di:RG.transition!==null?(U0===0&&(U0=M5()),U0):(t=Ft,t!==0||(t=window.event,t=t===void 0?16:j5(t.type)),t):1}function Os(t,e,n,i){if(50<qh)throw qh=0,d2=null,Error(he(185));Sm(t,n,i),(!(Mt&2)||t!==Xn)&&(t===Xn&&(!(Mt&2)&&(wb|=n),zn===4&&Ya(t,di)),dr(t,i),n===1&&Mt===0&&!(e.mode&1)&&(Yd=Pn()+500,vb&&Yl()))}function dr(t,e){var n=t.callbackNode;RW(t,e);var i=Tv(t,t===Xn?di:0);if(i===0)n!==null&&PN(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&PN(n),e===1)t.tag===0?MG(xM.bind(null,t)):nL(xM.bind(null,t)),EG(function(){!(Mt&6)&&Yl()}),n=null;else{switch(R5(i)){case 1:n=JC;break;case 4:n=P5;break;case 16:n=Iv;break;case 536870912:n=N5;break;default:n=Iv}n=eD(n,XL.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function XL(t,e){if(z0=-1,U0=0,Mt&6)throw Error(he(327));var n=t.callbackNode;if(bd()&&t.callbackNode!==n)return null;var i=Tv(t,t===Xn?di:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Jv(t,i);else{e=i;var r=Mt;Mt|=2;var s=KL();(Xn!==t||di!==e)&&(Fo=null,Yd=Pn()+500,Bc(t,e));do try{JG();break}catch(a){qL(t,a)}while(!0);u_(),qv.current=s,Mt=r,In!==null?e=0:(Xn=null,di=0,e=zn)}if(e!==0){if(e===2&&(r=BS(t),r!==0&&(i=r,e=f2(t,r))),e===1)throw n=Rp,Bc(t,0),Ya(t,i),dr(t,Pn()),n;if(e===6)Ya(t,i);else{if(r=t.current.alternate,!(i&30)&&!KG(r)&&(e=Jv(t,i),e===2&&(s=BS(t),s!==0&&(i=s,e=f2(t,s))),e===1))throw n=Rp,Bc(t,0),Ya(t,i),dr(t,Pn()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(he(345));case 2:Sc(t,nr,Fo);break;case 3:if(Ya(t,i),(i&130023424)===i&&(e=__+500-Pn(),10<e)){if(Tv(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){Oi(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=GS(Sc.bind(null,t,nr,Fo),e);break}Sc(t,nr,Fo);break;case 4:if(Ya(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Ts(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Pn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*qG(i/1960))-i,10<i){t.timeoutHandle=GS(Sc.bind(null,t,nr,Fo),i);break}Sc(t,nr,Fo);break;case 5:Sc(t,nr,Fo);break;default:throw Error(he(329))}}}return dr(t,Pn()),t.callbackNode===n?XL.bind(null,t):null}function f2(t,e){var n=Xh;return t.current.memoizedState.isDehydrated&&(Bc(t,e).flags|=256),t=Jv(t,e),t!==2&&(e=nr,nr=n,e!==null&&h2(e)),t}function h2(t){nr===null?nr=t:nr.push.apply(nr,t)}function KG(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Ls(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ya(t,e){for(e&=~C_,e&=~wb,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ts(e),i=1<<n;t[n]=-1,e&=~i}}function xM(t){if(Mt&6)throw Error(he(327));bd();var e=Tv(t,0);if(!(e&1))return dr(t,Pn()),null;var n=Jv(t,e);if(t.tag!==0&&n===2){var i=BS(t);i!==0&&(e=i,n=f2(t,i))}if(n===1)throw n=Rp,Bc(t,0),Ya(t,e),dr(t,Pn()),n;if(n===6)throw Error(he(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Sc(t,nr,Fo),dr(t,Pn()),null}function E_(t,e){var n=Mt;Mt|=1;try{return t(e)}finally{Mt=n,Mt===0&&(Yd=Pn()+500,vb&&Yl())}}function Jc(t){rl!==null&&rl.tag===0&&!(Mt&6)&&bd();var e=Mt;Mt|=1;var n=rs.transition,i=Ft;try{if(rs.transition=null,Ft=1,t)return t()}finally{Ft=i,rs.transition=n,Mt=e,!(Mt&6)&&Yl()}}function A_(){xr=rd.current,nn(rd)}function Bc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,_G(n)),In!==null)for(n=In.return;n!==null;){var i=n;switch(a_(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Bv();break;case 3:qd(),nn(cr),nn(_i),g_();break;case 5:m_(i);break;case 4:qd();break;case 13:nn(hn);break;case 19:nn(hn);break;case 10:d_(i.type._context);break;case 22:case 23:A_()}n=n.return}if(Xn=t,In=t=kl(t.current,null),di=xr=e,zn=0,Rp=null,C_=wb=Yc=0,nr=Xh=null,Rc!==null){for(e=0;e<Rc.length;e++)if(n=Rc[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}Rc=null}return t}function qL(t,e){do{var n=In;try{if(u_(),B0.current=Xv,Gv){for(var i=vn.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Gv=!1}if(Kc=0,Gn=Dn=vn=null,Wh=!1,Pp=0,k_.current=null,n===null||n.return===null){zn=1,Rp=e,In=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=di,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=aM(o);if(p!==null){p.flags&=-257,lM(p,o,a,s,e),p.mode&1&&oM(s,c,e),e=p,l=c;var m=e.updateQueue;if(m===null){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break e}else{if(!(e&1)){oM(s,c,e),P_();break e}l=Error(he(426))}}else if(cn&&a.mode&1){var y=aM(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),lM(y,o,a,s,e),l_(Kd(l,a));break e}}s=l=Kd(l,a),zn!==4&&(zn=2),Xh===null?Xh=[s]:Xh.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=RL(s,l,e);eM(s,v);break e;case 1:a=l;var b=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(wl===null||!wl.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var k=IL(s,a,e);eM(s,k);break e}}s=s.return}while(s!==null)}JL(n)}catch(C){e=C,In===n&&n!==null&&(In=n=n.return);continue}break}while(!0)}function KL(){var t=qv.current;return qv.current=Xv,t===null?Xv:t}function P_(){(zn===0||zn===3||zn===2)&&(zn=4),Xn===null||!(Yc&268435455)&&!(wb&268435455)||Ya(Xn,di)}function Jv(t,e){var n=Mt;Mt|=2;var i=KL();(Xn!==t||di!==e)&&(Fo=null,Bc(t,e));do try{YG();break}catch(r){qL(t,r)}while(!0);if(u_(),Mt=n,qv.current=i,In!==null)throw Error(he(261));return Xn=null,di=0,zn}function YG(){for(;In!==null;)YL(In)}function JG(){for(;In!==null&&!SW();)YL(In)}function YL(t){var e=QL(t.alternate,t,xr);t.memoizedProps=t.pendingProps,e===null?JL(t):In=e,k_.current=null}function JL(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=HG(n,e),n!==null){n.flags&=32767,In=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{zn=6,In=null;return}}else if(n=VG(n,e,xr),n!==null){In=n;return}if(e=e.sibling,e!==null){In=e;return}In=e=t}while(e!==null);zn===0&&(zn=5)}function Sc(t,e,n){var i=Ft,r=rs.transition;try{rs.transition=null,Ft=1,ZG(t,e,n,i)}finally{rs.transition=r,Ft=i}return null}function ZG(t,e,n,i){do bd();while(rl!==null);if(Mt&6)throw Error(he(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(he(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(IW(t,s),t===Xn&&(In=Xn=null,di=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_g||(_g=!0,eD(Iv,function(){return bd(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=rs.transition,rs.transition=null;var o=Ft;Ft=1;var a=Mt;Mt|=4,k_.current=null,GG(t,n),WL(n,t),yG(HS),Ov=!!VS,HS=VS=null,t.current=n,XG(n),kW(),Mt=a,Ft=o,rs.transition=s}else t.current=n;if(_g&&(_g=!1,rl=t,Yv=r),s=t.pendingLanes,s===0&&(wl=null),EW(n.stateNode),dr(t,Pn()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Kv)throw Kv=!1,t=u2,u2=null,t;return Yv&1&&t.tag!==0&&bd(),s=t.pendingLanes,s&1?t===d2?qh++:(qh=0,d2=t):qh=0,Yl(),null}function bd(){if(rl!==null){var t=R5(Yv),e=rs.transition,n=Ft;try{if(rs.transition=null,Ft=16>t?16:t,rl===null)var i=!1;else{if(t=rl,rl=null,Yv=0,Mt&6)throw Error(he(331));var r=Mt;for(Mt|=4,Te=t.current;Te!==null;){var s=Te,o=s.child;if(Te.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Te=c;Te!==null;){var u=Te;switch(u.tag){case 0:case 11:case 15:Gh(8,u,s)}var d=u.child;if(d!==null)d.return=u,Te=d;else for(;Te!==null;){u=Te;var f=u.sibling,p=u.return;if(UL(u),u===c){Te=null;break}if(f!==null){f.return=p,Te=f;break}Te=p}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Te=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Te=o;else e:for(;Te!==null;){if(s=Te,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Gh(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Te=v;break e}Te=s.return}}var b=t.current;for(Te=b;Te!==null;){o=Te;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Te=w;else e:for(o=b;Te!==null;){if(a=Te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:xb(9,a)}}catch(C){xn(a,a.return,C)}if(a===o){Te=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,Te=k;break e}Te=a.return}}if(Mt=r,Yl(),So&&typeof So.onPostCommitFiberRoot=="function")try{So.onPostCommitFiberRoot(fb,t)}catch{}i=!0}return i}finally{Ft=n,rs.transition=e}}return!1}function wM(t,e,n){e=Kd(n,e),e=RL(t,e,1),t=xl(t,e,1),e=Oi(),t!==null&&(Sm(t,1,e),dr(t,e))}function xn(t,e,n){if(t.tag===3)wM(t,t,n);else for(;e!==null;){if(e.tag===3){wM(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(wl===null||!wl.has(i))){t=Kd(n,t),t=IL(e,t,1),e=xl(e,t,1),t=Oi(),e!==null&&(Sm(e,1,t),dr(e,t));break}}e=e.return}}function QG(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=Oi(),t.pingedLanes|=t.suspendedLanes&n,Xn===t&&(di&n)===n&&(zn===4||zn===3&&(di&130023424)===di&&500>Pn()-__?Bc(t,0):C_|=n),dr(t,e)}function ZL(t,e){e===0&&(t.mode&1?(e=mg,mg<<=1,!(mg&130023424)&&(mg=4194304)):e=1);var n=Oi();t=fa(t,e),t!==null&&(Sm(t,e,n),dr(t,n))}function eX(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),ZL(t,n)}function tX(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(he(314))}i!==null&&i.delete(e),ZL(t,n)}var QL;QL=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||cr.current)ar=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ar=!1,UG(t,e,n);ar=!!(t.flags&131072)}else ar=!1,cn&&e.flags&1048576&&iL(e,zv,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;F0(t,e),t=e.pendingProps;var r=Wd(e,_i.current);yd(e,n),r=y_(null,e,i,t,r,n);var s=b_();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ur(i)?(s=!0,$v(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,h_(e),r.updater=bb,e.stateNode=r,r._reactInternals=e,QS(e,i,t,n),e=n2(null,e,i,!0,s,n)):(e.tag=0,cn&&s&&o_(e),Ii(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(F0(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=iX(i),t=xs(i,t),r){case 0:e=t2(null,e,i,t,n);break e;case 1:e=dM(null,e,i,t,n);break e;case 11:e=cM(null,e,i,t,n);break e;case 14:e=uM(null,e,i,xs(i.type,t),n);break e}throw Error(he(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xs(i,r),t2(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xs(i,r),dM(t,e,i,r,n);case 3:e:{if(DL(e),t===null)throw Error(he(387));i=e.pendingProps,s=e.memoizedState,r=s.element,cL(t,e),Hv(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Kd(Error(he(423)),e),e=fM(t,e,i,n,r);break e}else if(i!==r){r=Kd(Error(he(424)),e),e=fM(t,e,i,n,r);break e}else for(Er=bl(e.stateNode.containerInfo.firstChild),Rr=e,cn=!0,Es=null,n=aL(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gd(),i===r){e=ha(t,e,n);break e}Ii(t,e,i,n)}e=e.child}return e;case 5:return uL(e),t===null&&YS(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,WS(i,r)?o=null:s!==null&&WS(i,s)&&(e.flags|=32),LL(t,e),Ii(t,e,o,n),e.child;case 6:return t===null&&YS(e),null;case 13:return jL(t,e,n);case 4:return p_(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=Xd(e,null,i,n):Ii(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xs(i,r),cM(t,e,i,r,n);case 7:return Ii(t,e,e.pendingProps,n),e.child;case 8:return Ii(t,e,e.pendingProps.children,n),e.child;case 12:return Ii(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Kt(Uv,i._currentValue),i._currentValue=o,s!==null)if(Ls(s.value,o)){if(s.children===r.children&&!cr.current){e=ha(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=aa(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),JS(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(he(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),JS(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Ii(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,yd(e,n),r=us(r),i=i(r),e.flags|=1,Ii(t,e,i,n),e.child;case 14:return i=e.type,r=xs(i,e.pendingProps),r=xs(i.type,r),uM(t,e,i,r,n);case 15:return TL(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xs(i,r),F0(t,e),e.tag=1,ur(i)?(t=!0,$v(e)):t=!1,yd(e,n),ML(e,i,r),QS(e,i,r,n),n2(null,e,i,!0,t,n);case 19:return BL(t,e,n);case 22:return OL(t,e,n)}throw Error(he(156,e.tag))};function eD(t,e){return A5(t,e)}function nX(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jr(t,e,n,i){return new nX(t,e,n,i)}function N_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function iX(t){if(typeof t=="function")return N_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===qC)return 11;if(t===KC)return 14}return 2}function kl(t,e){var n=t.alternate;return n===null?(n=Jr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function V0(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")N_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case qu:return $c(n.children,r,s,e);case XC:o=8,r|=8;break;case kS:return t=Jr(12,n,e,r|2),t.elementType=kS,t.lanes=s,t;case CS:return t=Jr(13,n,e,r),t.elementType=CS,t.lanes=s,t;case _S:return t=Jr(19,n,e,r),t.elementType=_S,t.lanes=s,t;case u5:return Sb(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case l5:o=10;break e;case c5:o=9;break e;case qC:o=11;break e;case KC:o=14;break e;case Ba:o=16,i=null;break e}throw Error(he(130,t==null?t:typeof t,""))}return e=Jr(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function $c(t,e,n,i){return t=Jr(7,t,i,e),t.lanes=n,t}function Sb(t,e,n,i){return t=Jr(22,t,i,e),t.elementType=u5,t.lanes=n,t.stateNode={isHidden:!1},t}function wx(t,e,n){return t=Jr(6,t,null,e),t.lanes=n,t}function Sx(t,e,n){return e=Jr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function rX(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nx(0),this.expirationTimes=nx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nx(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function M_(t,e,n,i,r,s,o,a,l){return t=new rX(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Jr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},h_(s),t}function sX(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xu,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function tD(t){if(!t)return Ml;t=t._reactInternals;e:{if(hu(t)!==t||t.tag!==1)throw Error(he(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ur(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(he(171))}if(t.tag===1){var n=t.type;if(ur(n))return tL(t,n,e)}return e}function nD(t,e,n,i,r,s,o,a,l){return t=M_(n,i,!0,t,r,s,o,a,l),t.context=tD(null),n=t.current,i=Oi(),r=Sl(n),s=aa(i,r),s.callback=e??null,xl(n,s,r),t.current.lanes=r,Sm(t,r,i),dr(t,i),t}function kb(t,e,n,i){var r=e.current,s=Oi(),o=Sl(r);return n=tD(n),e.context===null?e.context=n:e.pendingContext=n,e=aa(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=xl(r,e,o),t!==null&&(Os(t,r,o,s),j0(t,r,o)),o}function Zv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function SM(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function R_(t,e){SM(t,e),(t=t.alternate)&&SM(t,e)}function oX(){return null}var iD=typeof reportError=="function"?reportError:function(t){console.error(t)};function I_(t){this._internalRoot=t}Cb.prototype.render=I_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(he(409));kb(t,e,null,null)};Cb.prototype.unmount=I_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Jc(function(){kb(null,t,null,null)}),e[da]=null}};function Cb(t){this._internalRoot=t}Cb.prototype.unstable_scheduleHydration=function(t){if(t){var e=O5();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ka.length&&e!==0&&e<Ka[n].priority;n++);Ka.splice(n,0,t),n===0&&D5(t)}};function T_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _b(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function kM(){}function aX(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var c=Zv(o);s.call(c)}}var o=nD(e,i,t,0,null,!1,!1,"",kM);return t._reactRootContainer=o,t[da]=o.current,kp(t.nodeType===8?t.parentNode:t),Jc(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var c=Zv(l);a.call(c)}}var l=M_(t,0,!1,null,null,!1,!1,"",kM);return t._reactRootContainer=l,t[da]=l.current,kp(t.nodeType===8?t.parentNode:t),Jc(function(){kb(e,l,n,i)}),l}function Eb(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=Zv(o);a.call(l)}}kb(e,o,t,r)}else o=aX(n,e,t,r,i);return Zv(o)}I5=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=bh(e.pendingLanes);n!==0&&(ZC(e,n|1),dr(e,Pn()),!(Mt&6)&&(Yd=Pn()+500,Yl()))}break;case 13:Jc(function(){var i=fa(t,1);if(i!==null){var r=Oi();Os(i,t,1,r)}}),R_(t,1)}};QC=function(t){if(t.tag===13){var e=fa(t,134217728);if(e!==null){var n=Oi();Os(e,t,134217728,n)}R_(t,134217728)}};T5=function(t){if(t.tag===13){var e=Sl(t),n=fa(t,e);if(n!==null){var i=Oi();Os(n,t,e,i)}R_(t,e)}};O5=function(){return Ft};L5=function(t,e){var n=Ft;try{return Ft=t,e()}finally{Ft=n}};LS=function(t,e,n){switch(e){case"input":if(PS(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=gb(i);if(!r)throw Error(he(90));f5(i),PS(i,r)}}}break;case"textarea":p5(t,n);break;case"select":e=n.value,e!=null&&pd(t,!!n.multiple,e,!1)}};w5=E_;S5=Jc;var lX={usingClientEntryPoint:!1,Events:[Cm,Zu,gb,b5,x5,E_]},qf={findFiberByHostInstance:Mc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},cX={bundleType:qf.bundleType,version:qf.version,rendererPackageName:qf.rendererPackageName,rendererConfig:qf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xa.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=_5(t),t===null?null:t.stateNode},findFiberByHostInstance:qf.findFiberByHostInstance||oX,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Eg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Eg.isDisabled&&Eg.supportsFiber)try{fb=Eg.inject(cX),So=Eg}catch{}}jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lX;jr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T_(e))throw Error(he(200));return sX(t,e,null,n)};jr.createRoot=function(t,e){if(!T_(t))throw Error(he(299));var n=!1,i="",r=iD;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=M_(t,1,!1,null,null,n,!1,i,r),t[da]=e.current,kp(t.nodeType===8?t.parentNode:t),new I_(e)};jr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(he(188)):(t=Object.keys(t).join(","),Error(he(268,t)));return t=_5(e),t=t===null?null:t.stateNode,t};jr.flushSync=function(t){return Jc(t)};jr.hydrate=function(t,e,n){if(!_b(e))throw Error(he(200));return Eb(null,t,e,!0,n)};jr.hydrateRoot=function(t,e,n){if(!T_(t))throw Error(he(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=iD;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=nD(e,null,t,1,n??null,r,!1,s,o),t[da]=e.current,kp(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Cb(e)};jr.render=function(t,e,n){if(!_b(e))throw Error(he(200));return Eb(null,t,e,!1,n)};jr.unmountComponentAtNode=function(t){if(!_b(t))throw Error(he(40));return t._reactRootContainer?(Jc(function(){Eb(null,null,t,!1,function(){t._reactRootContainer=null,t[da]=null})}),!0):!1};jr.unstable_batchedUpdates=E_;jr.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!_b(n))throw Error(he(200));if(t==null||t._reactInternals===void 0)throw Error(he(38));return Eb(t,e,n,!1,i)};jr.version="18.3.1-next-f1338f8080-20240426";function rD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rD)}catch(t){console.error(t)}}rD(),r5.exports=jr;var Jl=r5.exports;const uX=du(Jl);var sD,CM=Jl;sD=CM.createRoot,CM.hydrateRoot;function ke(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function zs(t,e=[]){let n=[];function i(s,o){const a=x.createContext(o),l=n.length;n=[...n,o];const c=d=>{var v;const{scope:f,children:p,...m}=d,g=((v=f==null?void 0:f[t])==null?void 0:v[l])||a,y=x.useMemo(()=>m,Object.values(m));return h.jsx(g.Provider,{value:y,children:p})};c.displayName=s+"Provider";function u(d,f){var g;const p=((g=f==null?void 0:f[t])==null?void 0:g[l])||a,m=x.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const r=()=>{const s=n.map(o=>x.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return x.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[i,dX(r,...e)]}function dX(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const i=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=i.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function _M(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Ab(...t){return e=>{let n=!1;const i=t.map(r=>{const s=_M(r,e);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():_M(t[r],null)}}}}function St(...t){return x.useCallback(Ab(...t),t)}function Jd(t){const e=fX(t),n=x.forwardRef((i,r)=>{const{children:s,...o}=i,a=x.Children.toArray(s),l=a.find(pX);if(l){const c=l.props.children,u=a.map(d=>d===l?x.Children.count(c)>1?x.Children.only(null):x.isValidElement(c)?c.props.children:null:d);return h.jsx(e,{...o,ref:r,children:x.isValidElement(c)?x.cloneElement(c,void 0,u):null})}return h.jsx(e,{...o,ref:r,children:s})});return n.displayName=`${t}.Slot`,n}function fX(t){const e=x.forwardRef((n,i)=>{const{children:r,...s}=n;if(x.isValidElement(r)){const o=gX(r),a=mX(s,r.props);return r.type!==x.Fragment&&(a.ref=i?Ab(i,o):o),x.cloneElement(r,a)}return x.Children.count(r)>1?x.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var hX=Symbol("radix.slottable");function pX(t){return x.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===hX}function mX(t,e){const n={...e};for(const i in e){const r=t[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?n[i]=(...a)=>{const l=s(...a);return r(...a),l}:r&&(n[i]=r):i==="style"?n[i]={...r,...s}:i==="className"&&(n[i]=[r,s].filter(Boolean).join(" "))}return{...t,...n}}function gX(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Em(t){const e=t+"CollectionProvider",[n,i]=zs(e),[r,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:y,children:v}=g,b=en.useRef(null),w=en.useRef(new Map).current;return h.jsx(r,{scope:y,itemMap:w,collectionRef:b,children:v})};o.displayName=e;const a=t+"CollectionSlot",l=Jd(a),c=en.forwardRef((g,y)=>{const{scope:v,children:b}=g,w=s(a,v),k=St(y,w.collectionRef);return h.jsx(l,{ref:k,children:b})});c.displayName=a;const u=t+"CollectionItemSlot",d="data-radix-collection-item",f=Jd(u),p=en.forwardRef((g,y)=>{const{scope:v,children:b,...w}=g,k=en.useRef(null),C=St(y,k),E=s(u,v);return en.useEffect(()=>(E.itemMap.set(k,{ref:k,...w}),()=>void E.itemMap.delete(k))),h.jsx(f,{[d]:"",ref:C,children:b})});p.displayName=u;function m(g){const y=s(t+"CollectionConsumer",g);return en.useCallback(()=>{const b=y.collectionRef.current;if(!b)return[];const w=Array.from(b.querySelectorAll(`[${d}]`));return Array.from(y.itemMap.values()).sort((E,_)=>w.indexOf(E.ref.current)-w.indexOf(_.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:o,Slot:c,ItemSlot:p},m,i]}var hi=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},vX=sb[" useId ".trim().toString()]||(()=>{}),yX=0;function _f(t){const[e,n]=x.useState(vX());return hi(()=>{n(i=>i??String(yX++))},[t]),e?`radix-${e}`:""}var bX=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],it=bX.reduce((t,e)=>{const n=Jd(`Primitive.${e}`),i=x.forwardRef((r,s)=>{const{asChild:o,...a}=r,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(l,{...a,ref:s})});return i.displayName=`Primitive.${e}`,{...t,[e]:i}},{});function O_(t,e){t&&Jl.flushSync(()=>t.dispatchEvent(e))}function Or(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>{var i;return(i=e.current)==null?void 0:i.call(e,...n)},[])}var xX=sb[" useInsertionEffect ".trim().toString()]||hi;function Rl({prop:t,defaultProp:e,onChange:n=()=>{},caller:i}){const[r,s,o]=wX({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:r;{const u=x.useRef(t!==void 0);x.useEffect(()=>{const d=u.current;d!==a&&console.warn(`${i} is changing from ${d?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,i])}const c=x.useCallback(u=>{var d;if(a){const f=SX(u)?u(t):u;f!==t&&((d=o.current)==null||d.call(o,f))}else s(u)},[a,t,s,o]);return[l,c]}function wX({defaultProp:t,onChange:e}){const[n,i]=x.useState(t),r=x.useRef(n),s=x.useRef(e);return xX(()=>{s.current=e},[e]),x.useEffect(()=>{var o;r.current!==n&&((o=s.current)==null||o.call(s,n),r.current=n)},[n,r]),[n,i,s]}function SX(t){return typeof t=="function"}var kX=x.createContext(void 0);function Pb(t){const e=x.useContext(kX);return t||e||"ltr"}var kx="rovingFocusGroup.onEntryFocus",CX={bubbles:!1,cancelable:!0},Am="RovingFocusGroup",[p2,oD,_X]=Em(Am),[EX,Nb]=zs(Am,[_X]),[AX,PX]=EX(Am),aD=x.forwardRef((t,e)=>h.jsx(p2.Provider,{scope:t.__scopeRovingFocusGroup,children:h.jsx(p2.Slot,{scope:t.__scopeRovingFocusGroup,children:h.jsx(NX,{...t,ref:e})})}));aD.displayName=Am;var NX=x.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:r=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=t,f=x.useRef(null),p=St(e,f),m=Pb(s),[g,y]=Rl({prop:o,defaultProp:a??null,onChange:l,caller:Am}),[v,b]=x.useState(!1),w=Or(c),k=oD(n),C=x.useRef(!1),[E,_]=x.useState(0);return x.useEffect(()=>{const M=f.current;if(M)return M.addEventListener(kx,w),()=>M.removeEventListener(kx,w)},[w]),h.jsx(AX,{scope:n,orientation:i,dir:m,loop:r,currentTabStopId:g,onItemFocus:x.useCallback(M=>y(M),[y]),onItemShiftTab:x.useCallback(()=>b(!0),[]),onFocusableItemAdd:x.useCallback(()=>_(M=>M+1),[]),onFocusableItemRemove:x.useCallback(()=>_(M=>M-1),[]),children:h.jsx(it.div,{tabIndex:v||E===0?-1:0,"data-orientation":i,...d,ref:p,style:{outline:"none",...t.style},onMouseDown:ke(t.onMouseDown,()=>{C.current=!0}),onFocus:ke(t.onFocus,M=>{const R=!C.current;if(M.target===M.currentTarget&&R&&!v){const T=new CustomEvent(kx,CX);if(M.currentTarget.dispatchEvent(T),!T.defaultPrevented){const L=k().filter(Y=>Y.focusable),I=L.find(Y=>Y.active),G=L.find(Y=>Y.id===g),q=[I,G,...L].filter(Boolean).map(Y=>Y.ref.current);uD(q,u)}}C.current=!1}),onBlur:ke(t.onBlur,()=>b(!1))})})}),lD="RovingFocusGroupItem",cD=x.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:r=!1,tabStopId:s,children:o,...a}=t,l=_f(),c=s||l,u=PX(lD,n),d=u.currentTabStopId===c,f=oD(n),{onFocusableItemAdd:p,onFocusableItemRemove:m,currentTabStopId:g}=u;return x.useEffect(()=>{if(i)return p(),()=>m()},[i,p,m]),h.jsx(p2.ItemSlot,{scope:n,id:c,focusable:i,active:r,children:h.jsx(it.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...a,ref:e,onMouseDown:ke(t.onMouseDown,y=>{i?u.onItemFocus(c):y.preventDefault()}),onFocus:ke(t.onFocus,()=>u.onItemFocus(c)),onKeyDown:ke(t.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const v=IX(y,u.orientation,u.dir);if(v!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let w=f().filter(k=>k.focusable).map(k=>k.ref.current);if(v==="last")w.reverse();else if(v==="prev"||v==="next"){v==="prev"&&w.reverse();const k=w.indexOf(y.currentTarget);w=u.loop?TX(w,k+1):w.slice(k+1)}setTimeout(()=>uD(w))}}),children:typeof o=="function"?o({isCurrentTabStop:d,hasTabStop:g!=null}):o})})});cD.displayName=lD;var MX={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function RX(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function IX(t,e,n){const i=RX(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return MX[i]}function uD(t,e=!1){const n=document.activeElement;for(const i of t)if(i===n||(i.focus({preventScroll:e}),document.activeElement!==n))return}function TX(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var dD=aD,fD=cD;function OX(t,e){return x.useReducer((n,i)=>e[n][i]??n,t)}var wa=t=>{const{present:e,children:n}=t,i=LX(e),r=typeof n=="function"?n({present:i.isPresent}):x.Children.only(n),s=St(i.ref,DX(r));return typeof n=="function"||i.isPresent?x.cloneElement(r,{ref:s}):null};wa.displayName="Presence";function LX(t){const[e,n]=x.useState(),i=x.useRef(null),r=x.useRef(t),s=x.useRef("none"),o=t?"mounted":"unmounted",[a,l]=OX(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const c=Ag(i.current);s.current=a==="mounted"?c:"none"},[a]),hi(()=>{const c=i.current,u=r.current;if(u!==t){const f=s.current,p=Ag(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),hi(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=p=>{const g=Ag(i.current).includes(p.animationName);if(p.target===e&&g&&(l("ANIMATION_END"),!r.current)){const y=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=y)})}},f=p=>{p.target===e&&(s.current=Ag(i.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:x.useCallback(c=>{i.current=c?getComputedStyle(c):null,n(c)},[])}}function Ag(t){return(t==null?void 0:t.animationName)||"none"}function DX(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Mb="Tabs",[jX,hve]=zs(Mb,[Nb]),hD=Nb(),[BX,L_]=jX(Mb),pD=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,onValueChange:r,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=t,u=Pb(a),[d,f]=Rl({prop:i,onChange:r,defaultProp:s??"",caller:Mb});return h.jsx(BX,{scope:n,baseId:_f(),value:d,onValueChange:f,orientation:o,dir:u,activationMode:l,children:h.jsx(it.div,{dir:u,"data-orientation":o,...c,ref:e})})});pD.displayName=Mb;var mD="TabsList",gD=x.forwardRef((t,e)=>{const{__scopeTabs:n,loop:i=!0,...r}=t,s=L_(mD,n),o=hD(n);return h.jsx(dD,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:i,children:h.jsx(it.div,{role:"tablist","aria-orientation":s.orientation,...r,ref:e})})});gD.displayName=mD;var vD="TabsTrigger",H0=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,disabled:r=!1,...s}=t,o=L_(vD,n),a=hD(n),l=bD(o.baseId,i),c=xD(o.baseId,i),u=i===o.value;return h.jsx(fD,{asChild:!0,...a,focusable:!r,active:u,children:h.jsx(it.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:l,...s,ref:e,onMouseDown:ke(t.onMouseDown,d=>{!r&&d.button===0&&d.ctrlKey===!1?o.onValueChange(i):d.preventDefault()}),onKeyDown:ke(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(i)}),onFocus:ke(t.onFocus,()=>{const d=o.activationMode!=="manual";!u&&!r&&d&&o.onValueChange(i)})})})});H0.displayName=vD;var yD="TabsContent",W0=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,forceMount:r,children:s,...o}=t,a=L_(yD,n),l=bD(a.baseId,i),c=xD(a.baseId,i),u=i===a.value,d=x.useRef(u);return x.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),h.jsx(wa,{present:r||u,children:({present:f})=>h.jsx(it.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!f,id:c,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:f&&s})})});W0.displayName=yD;function bD(t,e){return`${t}-trigger-${e}`}function xD(t,e){return`${t}-content-${e}`}const wh={},EM=(t,e)=>t.unstable_is?t.unstable_is(e):e===t,AM=t=>"init"in t,Cx=t=>!!t.write,PM=t=>"v"in t||"e"in t,Pg=t=>{if("e"in t)throw t.e;if((wh?"production":void 0)!=="production"&&!("v"in t))throw new Error("[Bug] atom state is not initialized");return t.v},Qv=new WeakMap,NM=t=>{var e;return ey(t)&&!!((e=Qv.get(t))!=null&&e[0])},$X=t=>{const e=Qv.get(t);e!=null&&e[0]&&(e[0]=!1,e[1].forEach(n=>n()))},wD=(t,e)=>{let n=Qv.get(t);if(!n){n=[!0,new Set],Qv.set(t,n);const i=()=>{n[0]=!1};t.then(i,i)}n[1].add(e)},ey=t=>typeof(t==null?void 0:t.then)=="function",SD=(t,e,n)=>{n.p.has(t)||(n.p.add(t),e.then(()=>{n.p.delete(t)},()=>{n.p.delete(t)}))},_x=(t,e,n)=>{const i=n(t),r="v"in i,s=i.v;if(ey(e))for(const o of i.d.keys())SD(t,e,n(o));i.v=e,delete i.e,(!r||!Object.is(s,i.v))&&(++i.n,ey(s)&&$X(s))},MM=(t,e,n)=>{var i;const r=new Set;for(const s of((i=n.get(t))==null?void 0:i.t)||[])n.has(s)&&r.add(s);for(const s of e.p)r.add(s);return r},FX=()=>{const t=new Set,e=()=>{t.forEach(n=>n())};return e.add=n=>(t.add(n),()=>{t.delete(n)}),e},Ex=()=>{const t={},e=new WeakMap,n=i=>{var r,s;(r=e.get(t))==null||r.forEach(o=>o(i)),(s=e.get(i))==null||s.forEach(o=>o())};return n.add=(i,r)=>{const s=i||t,o=(e.has(s)?e:e.set(s,new Set)).get(s);return o.add(r),()=>{o==null||o.delete(r),o.size||e.delete(s)}},n},zX=t=>(t.c||(t.c=Ex()),t.m||(t.m=Ex()),t.u||(t.u=Ex()),t.f||(t.f=FX()),t),UX=Symbol(),VX=(t=new WeakMap,e=new WeakMap,n=new WeakMap,i=new Set,r=new Set,s=new Set,o={},a=(f,...p)=>f.read(...p),l=(f,...p)=>f.write(...p),c=(f,p)=>{var m;return(m=f.unstable_onInit)==null?void 0:m.call(f,p)},u=(f,p)=>{var m;return(m=f.onMount)==null?void 0:m.call(f,p)},...d)=>{const f=d[0]||(_=>{if((wh?"production":void 0)!=="production"&&!_)throw new Error("Atom is undefined or null");let M=t.get(_);return M||(M={d:new Map,p:new Set,n:0},t.set(_,M),c==null||c(_,E)),M}),p=d[1]||(()=>{const _=[],M=R=>{try{R()}catch(T){_.push(T)}};do{o.f&&M(o.f);const R=new Set,T=R.add.bind(R);i.forEach(L=>{var I;return(I=e.get(L))==null?void 0:I.l.forEach(T)}),i.clear(),s.forEach(T),s.clear(),r.forEach(T),r.clear(),R.forEach(M),i.size&&m()}while(i.size||s.size||r.size);if(_.length)throw new AggregateError(_)}),m=d[2]||(()=>{const _=[],M=new WeakSet,R=new WeakSet,T=Array.from(i);for(;T.length;){const L=T[T.length-1],I=f(L);if(R.has(L)){T.pop();continue}if(M.has(L)){if(n.get(L)===I.n)_.push([L,I]);else if((wh?"production":void 0)!=="production"&&n.has(L))throw new Error("[Bug] invalidated atom exists");R.add(L),T.pop();continue}M.add(L);for(const G of MM(L,I,e))M.has(G)||T.push(G)}for(let L=_.length-1;L>=0;--L){const[I,G]=_[L];let B=!1;for(const q of G.d.keys())if(q!==I&&i.has(q)){B=!0;break}B&&(g(I),b(I)),n.delete(I)}}),g=d[3]||(_=>{var M;const R=f(_);if(PM(R)&&(e.has(_)&&n.get(_)!==R.n||Array.from(R.d).every(([ne,V])=>g(ne).n===V)))return R;R.d.clear();let T=!0;const L=()=>{e.has(_)&&(b(_),m(),p())},I=ne=>{var V;if(EM(_,ne)){const se=f(ne);if(!PM(se))if(AM(ne))_x(ne,ne.init,f);else throw new Error("no atom init");return Pg(se)}const U=g(ne);try{return Pg(U)}finally{R.d.set(ne,U.n),NM(R.v)&&SD(_,R.v,U),(V=e.get(ne))==null||V.t.add(_),T||L()}};let G,B;const q={get signal(){return G||(G=new AbortController),G.signal},get setSelf(){return(wh?"production":void 0)!=="production"&&!Cx(_)&&console.warn("setSelf function cannot be used with read-only atom"),!B&&Cx(_)&&(B=(...ne)=>{if((wh?"production":void 0)!=="production"&&T&&console.warn("setSelf function cannot be called in sync"),!T)try{return v(_,...ne)}finally{m(),p()}}),B}},Y=R.n;try{const ne=a(_,I,q);return _x(_,ne,f),ey(ne)&&(wD(ne,()=>G==null?void 0:G.abort()),ne.then(L,L)),R}catch(ne){return delete R.v,R.e=ne,++R.n,R}finally{T=!1,Y!==R.n&&n.get(_)===Y&&(n.set(_,R.n),i.add(_),(M=o.c)==null||M.call(o,_))}}),y=d[4]||(_=>{const M=[_];for(;M.length;){const R=M.pop(),T=f(R);for(const L of MM(R,T,e)){const I=f(L);n.set(L,I.n),M.push(L)}}}),v=d[5]||((_,...M)=>{let R=!0;const T=I=>Pg(g(I)),L=(I,...G)=>{var B;const q=f(I);try{if(EM(_,I)){if(!AM(I))throw new Error("atom not writable");const Y=q.n,ne=G[0];_x(I,ne,f),b(I),Y!==q.n&&(i.add(I),(B=o.c)==null||B.call(o,I),y(I));return}else return v(I,...G)}finally{R||(m(),p())}};try{return l(_,T,L,...M)}finally{R=!1}}),b=d[6]||(_=>{var M;const R=f(_),T=e.get(_);if(T&&!NM(R.v)){for(const[L,I]of R.d)if(!T.d.has(L)){const G=f(L);w(L).t.add(_),T.d.add(L),I!==G.n&&(i.add(L),(M=o.c)==null||M.call(o,L),y(L))}for(const L of T.d||[])if(!R.d.has(L)){T.d.delete(L);const I=k(L);I==null||I.t.delete(_)}}}),w=d[7]||(_=>{var M;const R=f(_);let T=e.get(_);if(!T){g(_);for(const L of R.d.keys())w(L).t.add(_);if(T={l:new Set,d:new Set(R.d.keys()),t:new Set},e.set(_,T),(M=o.m)==null||M.call(o,_),Cx(_)){const L=()=>{let I=!0;const G=(...B)=>{try{return v(_,...B)}finally{I||(m(),p())}};try{const B=u(_,G);B&&(T.u=()=>{I=!0;try{B()}finally{I=!1}})}finally{I=!1}};r.add(L)}}return T}),k=d[8]||(_=>{var M;const R=f(_);let T=e.get(_);if(T&&!T.l.size&&!Array.from(T.t).some(L=>{var I;return(I=e.get(L))==null?void 0:I.d.has(_)})){T.u&&s.add(T.u),T=void 0,e.delete(_),(M=o.u)==null||M.call(o,_);for(const L of R.d.keys()){const I=k(L);I==null||I.t.delete(_)}return}return T}),C=[t,e,n,i,r,s,o,a,l,c,u,f,p,m,g,y,v,b,w,k],E={get:_=>Pg(g(_)),set:(_,...M)=>{try{return v(_,...M)}finally{m(),p()}},sub:(_,M)=>{const T=w(_).l;return T.add(M),p(),()=>{T.delete(M),k(_),p()}}};return Object.defineProperty(E,UX,{value:C}),E},kD=VX,HX=zX,RM=wD,D_={};let WX=0;function me(t,e){const n=`atom${++WX}`,i={toString(){return(D_?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof t=="function"?i.read=t:(i.init=t,i.read=GX,i.write=XX),e&&(i.write=e),i}function GX(t){return t(this)}function XX(t,e,n){return e(this,typeof n=="function"?n(t(this)):n)}const qX=()=>{let t=0;const e=HX({}),n=new WeakMap,i=new WeakMap,r=kD(n,i,void 0,void 0,void 0,void 0,e,void 0,(a,l,c,...u)=>t?c(a,...u):a.write(l,c,...u)),s=new Set;return e.m.add(void 0,a=>{s.add(a);const l=n.get(a);l.m=i.get(a)}),e.u.add(void 0,a=>{s.delete(a);const l=n.get(a);delete l.m}),Object.assign(r,{dev4_get_internal_weak_map:()=>(console.log("Deprecated: Use devstore from the devtools library"),n),dev4_get_mounted_atoms:()=>s,dev4_restore_atoms:a=>{const l={read:()=>null,write:(c,u)=>{++t;try{for(const[d,f]of a)"init"in d&&u(d,f)}finally{--t}}};r.set(l)}})};function j_(){return(D_?"production":void 0)!=="production"?qX():kD()}let Kf;function KX(){return Kf||(Kf=j_(),(D_?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=Kf),globalThis.__JOTAI_DEFAULT_STORE__!==Kf&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),Kf}const YX={},CD=x.createContext(void 0);function _D(t){return x.useContext(CD)||KX()}function JX({children:t,store:e}){const n=x.useRef(void 0);return!e&&!n.current&&(n.current=j_()),x.createElement(CD.Provider,{value:e||n.current},t)}const m2=t=>typeof(t==null?void 0:t.then)=="function",g2=t=>{t.status||(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}))},ZX=en.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(g2(t),t)}),Ax=new WeakMap,IM=(t,e)=>{let n=Ax.get(t);return n||(n=new Promise((i,r)=>{let s=t;const o=c=>u=>{s===c&&i(u)},a=c=>u=>{s===c&&r(u)},l=()=>{try{const c=e();m2(c)?(Ax.set(c,n),s=c,c.then(o(c),a(c)),RM(c,l)):i(c)}catch(c){r(c)}};t.then(o(t),a(t)),RM(t,l)}),Ax.set(t,n)),n};function rt(t,e){const{delay:n,unstable_promiseStatus:i=!en.use}={},r=_D(),[[s,o,a],l]=x.useReducer(u=>{const d=r.get(t);return Object.is(u[0],d)&&u[1]===r&&u[2]===t?u:[d,r,t]},void 0,()=>[r.get(t),r,t]);let c=s;if((o!==r||a!==t)&&(l(),c=r.get(t)),x.useEffect(()=>{const u=r.sub(t,()=>{if(i)try{const d=r.get(t);m2(d)&&g2(IM(d,()=>r.get(t)))}catch{}if(typeof n=="number"){setTimeout(l,n);return}l()});return l(),u},[r,t,n,i]),x.useDebugValue(c),m2(c)){const u=IM(c,()=>r.get(t));return i&&g2(u),ZX(u)}return c}function Ip(t,e){const n=_D();return x.useCallback((...r)=>{if((YX?"production":void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return n.set(t,...r)},[n,t])}function Pm(t,e){return[rt(t),Ip(t)]}const{createElement:Zd,createContext:QX,forwardRef:ED,useCallback:qi,useContext:AD,useEffect:Fc,useImperativeHandle:PD,useLayoutEffect:eq,useMemo:tq,useRef:Sr,useState:ty}=sb,TM=sb.useId,Rb=QX(null);Rb.displayName="PanelGroupContext";const Tp=eq,nq=typeof TM=="function"?TM:()=>null;let iq=0;function B_(t=null){const e=nq(),n=Sr(t||e||null);return n.current===null&&(n.current=""+iq++),t??n.current}function ND({children:t,className:e="",collapsedSize:n,collapsible:i,defaultSize:r,forwardedRef:s,id:o,maxSize:a,minSize:l,onCollapse:c,onExpand:u,onResize:d,order:f,style:p,tagName:m="div",...g}){const y=AD(Rb);if(y===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:v,expandPanel:b,getPanelSize:w,getPanelStyle:k,groupId:C,isPanelCollapsed:E,reevaluatePanelConstraints:_,registerPanel:M,resizePanel:R,unregisterPanel:T}=y,L=B_(o),I=Sr({callbacks:{onCollapse:c,onExpand:u,onResize:d},constraints:{collapsedSize:n,collapsible:i,defaultSize:r,maxSize:a,minSize:l},id:L,idIsFromProps:o!==void 0,order:f});Sr({didLogMissingDefaultSizeWarning:!1}),Tp(()=>{const{callbacks:B,constraints:q}=I.current,Y={...q};I.current.id=L,I.current.idIsFromProps=o!==void 0,I.current.order=f,B.onCollapse=c,B.onExpand=u,B.onResize=d,q.collapsedSize=n,q.collapsible=i,q.defaultSize=r,q.maxSize=a,q.minSize=l,(Y.collapsedSize!==q.collapsedSize||Y.collapsible!==q.collapsible||Y.maxSize!==q.maxSize||Y.minSize!==q.minSize)&&_(I.current,Y)}),Tp(()=>{const B=I.current;return M(B),()=>{T(B)}},[f,L,M,T]),PD(s,()=>({collapse:()=>{v(I.current)},expand:()=>{b(I.current)},getId(){return L},getSize(){return w(I.current)},isCollapsed(){return E(I.current)},isExpanded(){return!E(I.current)},resize:B=>{R(I.current,B)}}),[v,b,w,E,L,R]);const G=k(I.current,r);return Zd(m,{...g,children:t,className:e,style:{...G,...p},"data-panel":"","data-panel-id":L,"data-panel-group-id":C,"data-panel-collapsible":void 0,"data-panel-size":void 0})}const G0=ED((t,e)=>Zd(ND,{...t,forwardedRef:e}));ND.displayName="Panel";G0.displayName="forwardRef(Panel)";function ht(t,e="Assertion failed!"){if(!t)throw console.error(e),Error(e)}const MD=10;function Op(t,e,n=MD){t=parseFloat(t.toFixed(n)),e=parseFloat(e.toFixed(n));const i=t-e;return i===0?0:i>0?1:-1}function br(t,e,n){return Op(t,e,n)===0}function sd({panelConstraints:t,panelIndex:e,size:n}){const i=t[e];ht(i!=null);let{collapsedSize:r=0,collapsible:s,maxSize:o=100,minSize:a=0}=i;if(Op(n,a)<0)if(s){const l=(r+a)/2;Op(n,l)<0?n=r:n=a}else n=a;return n=Math.min(o,n),n=parseFloat(n.toFixed(MD)),n}function Sh({delta:t,layout:e,panelConstraints:n,pivotIndices:i,trigger:r}){if(br(t,0))return e;const s=[...e],[o,a]=i;ht(o!=null),ht(a!=null);let l=0;if(r==="keyboard"){{const u=t<0?a:o,d=n[u];if(ht(d),d.collapsible){const f=e[u];ht(f!=null);const p=n[u];ht(p);const{collapsedSize:m=0,minSize:g=0}=p;if(br(f,m)){const y=g-f;Op(y,Math.abs(t))>0&&(t=t<0?0-y:y)}}}{const u=t<0?o:a,d=n[u];ht(d);const{collapsible:f}=d;if(f){const p=e[u];ht(p!=null);const m=n[u];ht(m);const{collapsedSize:g=0,minSize:y=0}=m;if(br(p,y)){const v=p-g;Op(v,Math.abs(t))>0&&(t=t<0?0-v:v)}}}}{const u=t<0?1:-1;let d=t<0?a:o,f=0;for(;;){const m=e[d];ht(m!=null);const y=sd({panelConstraints:n,panelIndex:d,size:100})-m;if(f+=y,d+=u,d<0||d>=n.length)break}const p=Math.min(Math.abs(t),Math.abs(f));t=t<0?0-p:p}{let d=t<0?o:a;for(;d>=0&&d<n.length;){const f=Math.abs(t)-Math.abs(l),p=e[d];ht(p!=null);const m=p-f,g=sd({panelConstraints:n,panelIndex:d,size:m});if(!br(p,g)&&(l+=p-g,s[d]=g,l.toPrecision(3).localeCompare(Math.abs(t).toPrecision(3),void 0,{numeric:!0})>=0))break;t<0?d--:d++}}if(br(l,0))return e;{const u=t<0?a:o,d=e[u];ht(d!=null);const f=d+l,p=sd({panelConstraints:n,panelIndex:u,size:f});if(s[u]=p,!br(p,f)){let m=f-p,y=t<0?a:o;for(;y>=0&&y<n.length;){const v=s[y];ht(v!=null);const b=v+m,w=sd({panelConstraints:n,panelIndex:y,size:b});if(br(v,w)||(m-=w-v,s[y]=w),br(m,0))break;t>0?y--:y++}}}const c=s.reduce((u,d)=>d+u,0);return br(c,100)?s:e}function rq({layout:t,panelsArray:e,pivotIndices:n}){let i=0,r=100,s=0,o=0;const a=n[0];ht(a!=null),e.forEach((d,f)=>{const{constraints:p}=d,{maxSize:m=100,minSize:g=0}=p;f===a?(i=g,r=m):(s+=g,o+=m)});const l=Math.min(r,100-s),c=Math.max(i,100-o),u=t[a];return{valueMax:l,valueMin:c,valueNow:u}}function Lp(t,e=document){return Array.from(e.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${t}"]`))}function RD(t,e,n=document){const r=Lp(t,n).findIndex(s=>s.getAttribute("data-panel-resize-handle-id")===e);return r??null}function ID(t,e,n){const i=RD(t,e,n);return i!=null?[i,i+1]:[-1,-1]}function TD(t,e=document){var n;if(e instanceof HTMLElement&&(e==null||(n=e.dataset)===null||n===void 0?void 0:n.panelGroupId)==t)return e;const i=e.querySelector(`[data-panel-group][data-panel-group-id="${t}"]`);return i||null}function Ib(t,e=document){const n=e.querySelector(`[data-panel-resize-handle-id="${t}"]`);return n||null}function sq(t,e,n,i=document){var r,s,o,a;const l=Ib(e,i),c=Lp(t,i),u=l?c.indexOf(l):-1,d=(r=(s=n[u])===null||s===void 0?void 0:s.id)!==null&&r!==void 0?r:null,f=(o=(a=n[u+1])===null||a===void 0?void 0:a.id)!==null&&o!==void 0?o:null;return[d,f]}function oq({committedValuesRef:t,eagerValuesRef:e,groupId:n,layout:i,panelDataArray:r,panelGroupElement:s,setLayout:o}){Sr({didWarnAboutMissingResizeHandle:!1}),Tp(()=>{if(!s)return;const a=Lp(n,s);for(let l=0;l<r.length-1;l++){const{valueMax:c,valueMin:u,valueNow:d}=rq({layout:i,panelsArray:r,pivotIndices:[l,l+1]}),f=a[l];if(f!=null){const p=r[l];ht(p),f.setAttribute("aria-controls",p.id),f.setAttribute("aria-valuemax",""+Math.round(c)),f.setAttribute("aria-valuemin",""+Math.round(u)),f.setAttribute("aria-valuenow",d!=null?""+Math.round(d):"")}}return()=>{a.forEach((l,c)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[n,i,r,s]),Fc(()=>{if(!s)return;const a=e.current;ht(a);const{panelDataArray:l}=a,c=TD(n,s);ht(c!=null,`No group found for id "${n}"`);const u=Lp(n,s);ht(u);const d=u.map(f=>{const p=f.getAttribute("data-panel-resize-handle-id");ht(p);const[m,g]=sq(n,p,l,s);if(m==null||g==null)return()=>{};const y=v=>{if(!v.defaultPrevented)switch(v.key){case"Enter":{v.preventDefault();const b=l.findIndex(w=>w.id===m);if(b>=0){const w=l[b];ht(w);const k=i[b],{collapsedSize:C=0,collapsible:E,minSize:_=0}=w.constraints;if(k!=null&&E){const M=Sh({delta:br(k,C)?_-C:C-k,layout:i,panelConstraints:l.map(R=>R.constraints),pivotIndices:ID(n,p,s),trigger:"keyboard"});i!==M&&o(M)}}break}}};return f.addEventListener("keydown",y),()=>{f.removeEventListener("keydown",y)}});return()=>{d.forEach(f=>f())}},[s,t,e,n,i,r,o])}function OM(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function OD(t){return t.type==="keydown"}function LD(t){return t.type.startsWith("mouse")}function DD(t){return t.type.startsWith("touch")}function jD(t,e){const n=t==="horizontal";if(LD(e))return n?e.clientX:e.clientY;if(DD(e)){const i=e.touches[0];return ht(i),n?i.screenX:i.screenY}else throw Error(`Unsupported event type "${e.type}"`)}function aq(t,e,n,i,r){const s=n==="horizontal",o=Ib(e,r);ht(o);const a=o.getAttribute("data-panel-group-id");ht(a);let{initialCursorPosition:l}=i;const c=jD(n,t),u=TD(a,r);ht(u);const d=u.getBoundingClientRect(),f=s?d.width:d.height;return(c-l)/f*100}function lq(t,e,n,i,r,s){if(OD(t)){const o=n==="horizontal";let a=0;t.shiftKey?a=100:r!=null?a=r:a=10;let l=0;switch(t.key){case"ArrowDown":l=o?0:a;break;case"ArrowLeft":l=o?-a:0;break;case"ArrowRight":l=o?a:0;break;case"ArrowUp":l=o?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return i==null?0:aq(t,e,n,i,s)}function cq({panelDataArray:t}){const e=Array(t.length),n=t.map(s=>s.constraints);let i=0,r=100;for(let s=0;s<t.length;s++){const o=n[s];ht(o);const{defaultSize:a}=o;a!=null&&(i++,e[s]=a,r-=a)}for(let s=0;s<t.length;s++){const o=n[s];ht(o);const{defaultSize:a}=o;if(a!=null)continue;const l=t.length-i,c=r/l;i++,e[s]=c,r-=c}return e}function wu(t,e,n){e.forEach((i,r)=>{const s=t[r];ht(s);const{callbacks:o,constraints:a,id:l}=s,{collapsedSize:c=0,collapsible:u}=a,d=n[l];if(d==null||i!==d){n[l]=i;const{onCollapse:f,onExpand:p,onResize:m}=o;m&&m(i,d),u&&(f||p)&&(p&&(d==null||d===c)&&i!==c&&p(),f&&(d==null||d!==c)&&i===c&&f())}})}function Ng(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n])return!1;return!0}function uq({defaultSize:t,dragState:e,layout:n,panelData:i,panelIndex:r,precision:s=3}){const o=n[r];let a;return o==null?a=t??"1":i.length===1?a="1":a=o.toPrecision(s),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}let v2=null,Tc=null;function BD(t){switch(t){case"horizontal":return"ew-resize";case"horizontal-max":return"w-resize";case"horizontal-min":return"e-resize";case"vertical":return"ns-resize";case"vertical-max":return"n-resize";case"vertical-min":return"s-resize"}}function dq(){Tc!==null&&(document.head.removeChild(Tc),v2=null,Tc=null)}function Px(t){if(v2===t)return;v2=t;const e=BD(t);Tc===null&&(Tc=document.createElement("style"),document.head.appendChild(Tc)),Tc.innerHTML=`*{cursor: ${e}!important;}`}function fq(t,e=10){let n=null;return(...r)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{t(...r)},e)}}function LM(t){try{if(typeof localStorage<"u")t.getItem=e=>localStorage.getItem(e),t.setItem=(e,n)=>{localStorage.setItem(e,n)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),t.getItem=()=>null,t.setItem=()=>{}}}function $D(t){return`react-resizable-panels:${t}`}function FD(t){return t.map(e=>{const{constraints:n,id:i,idIsFromProps:r,order:s}=e;return r?i:s?`${s}:${JSON.stringify(n)}`:JSON.stringify(n)}).sort((e,n)=>e.localeCompare(n)).join(",")}function zD(t,e){try{const n=$D(t),i=e.getItem(n);if(i){const r=JSON.parse(i);if(typeof r=="object"&&r!=null)return r}}catch{}return null}function hq(t,e,n){var i,r;const s=(i=zD(t,n))!==null&&i!==void 0?i:{},o=FD(e);return(r=s[o])!==null&&r!==void 0?r:null}function pq(t,e,n,i,r){var s;const o=$D(t),a=FD(e),l=(s=zD(t,r))!==null&&s!==void 0?s:{};l[a]={expandToSizes:Object.fromEntries(n.entries()),layout:i};try{r.setItem(o,JSON.stringify(l))}catch(c){console.error(c)}}function DM({layout:t,panelConstraints:e}){const n=[...t],i=n.reduce((s,o)=>s+o,0);if(n.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${n.map(s=>`${s}%`).join(", ")}`);if(!br(i,100))for(let s=0;s<e.length;s++){const o=n[s];ht(o!=null);const a=100/i*o;n[s]=a}let r=0;for(let s=0;s<e.length;s++){const o=n[s];ht(o!=null);const a=sd({panelConstraints:e,panelIndex:s,size:o});o!=a&&(r+=o-a,n[s]=a)}if(!br(r,0))for(let s=0;s<e.length;s++){const o=n[s];ht(o!=null);const a=o+r,l=sd({panelConstraints:e,panelIndex:s,size:a});if(o!==l&&(r-=l-o,n[s]=l,br(r,0)))break}return n}const mq=100,kh={getItem:t=>(LM(kh),kh.getItem(t)),setItem:(t,e)=>{LM(kh),kh.setItem(t,e)}},jM={};function UD({autoSaveId:t=null,children:e,className:n="",direction:i,forwardedRef:r,id:s=null,onLayout:o=null,keyboardResizeBy:a=null,storage:l=kh,style:c,tagName:u="div",...d}){const f=B_(s),p=Sr(null),[m,g]=ty(null),[y,v]=ty([]),b=Sr({}),w=Sr(new Map),k=Sr(0),C=Sr({autoSaveId:t,direction:i,dragState:m,id:f,keyboardResizeBy:a,onLayout:o,storage:l}),E=Sr({layout:y,panelDataArray:[],panelDataArrayChanged:!1});Sr({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),PD(r,()=>({getId:()=>C.current.id,getLayout:()=>{const{layout:Q}=E.current;return Q},setLayout:Q=>{const{onLayout:ae}=C.current,{layout:z,panelDataArray:$}=E.current,W=DM({layout:Q,panelConstraints:$.map(S=>S.constraints)});OM(z,W)||(v(W),E.current.layout=W,ae&&ae(W),wu($,W,b.current))}}),[]),Tp(()=>{C.current.autoSaveId=t,C.current.direction=i,C.current.dragState=m,C.current.id=f,C.current.onLayout=o,C.current.storage=l}),oq({committedValuesRef:C,eagerValuesRef:E,groupId:f,layout:y,panelDataArray:E.current.panelDataArray,setLayout:v,panelGroupElement:p.current}),Fc(()=>{const{panelDataArray:Q}=E.current;if(t){if(y.length===0||y.length!==Q.length)return;let ae=jM[t];ae==null&&(ae=fq(pq,mq),jM[t]=ae);const z=[...Q],$=new Map(w.current);ae(t,z,$,y,l)}},[t,y,l]),Fc(()=>{});const _=qi(Q=>{const{onLayout:ae}=C.current,{layout:z,panelDataArray:$}=E.current;if(Q.constraints.collapsible){const W=$.map(D=>D.constraints),{collapsedSize:S=0,panelSize:O,pivotIndices:j}=fc($,Q,z);if(ht(O!=null),O!==S){w.current.set(Q.id,O);const Z=Du($,Q)===$.length-1?O-S:S-O,K=Sh({delta:Z,layout:z,panelConstraints:W,pivotIndices:j,trigger:"imperative-api"});Ng(z,K)||(v(K),E.current.layout=K,ae&&ae(K),wu($,K,b.current))}}},[]),M=qi(Q=>{const{onLayout:ae}=C.current,{layout:z,panelDataArray:$}=E.current;if(Q.constraints.collapsible){const W=$.map(Z=>Z.constraints),{collapsedSize:S=0,panelSize:O,minSize:j=0,pivotIndices:D}=fc($,Q,z);if(O===S){const Z=w.current.get(Q.id),K=Z!=null&&Z>=j?Z:j,te=Du($,Q)===$.length-1?O-K:K-O,Oe=Sh({delta:te,layout:z,panelConstraints:W,pivotIndices:D,trigger:"imperative-api"});Ng(z,Oe)||(v(Oe),E.current.layout=Oe,ae&&ae(Oe),wu($,Oe,b.current))}}},[]),R=qi(Q=>{const{layout:ae,panelDataArray:z}=E.current,{panelSize:$}=fc(z,Q,ae);return ht($!=null),$},[]),T=qi((Q,ae)=>{const{panelDataArray:z}=E.current,$=Du(z,Q);return uq({defaultSize:ae,dragState:m,layout:y,panelData:z,panelIndex:$})},[m,y]),L=qi(Q=>{const{layout:ae,panelDataArray:z}=E.current,{collapsedSize:$=0,collapsible:W,panelSize:S}=fc(z,Q,ae);return W===!0&&S===$},[]),I=qi(Q=>{const{layout:ae,panelDataArray:z}=E.current,{collapsedSize:$=0,collapsible:W,panelSize:S}=fc(z,Q,ae);return ht(S!=null),!W||S>$},[]),G=qi(Q=>{const{panelDataArray:ae}=E.current;ae.push(Q),ae.sort((z,$)=>{const W=z.order,S=$.order;return W==null&&S==null?0:W==null?-1:S==null?1:W-S}),E.current.panelDataArrayChanged=!0},[]);Tp(()=>{if(E.current.panelDataArrayChanged){E.current.panelDataArrayChanged=!1;const{autoSaveId:Q,onLayout:ae,storage:z}=C.current,{layout:$,panelDataArray:W}=E.current;let S=null;if(Q){const j=hq(Q,W,z);j&&(w.current=new Map(Object.entries(j.expandToSizes)),S=j.layout)}S==null&&(S=cq({panelDataArray:W}));const O=DM({layout:S,panelConstraints:W.map(j=>j.constraints)});OM($,O)||(v(O),E.current.layout=O,ae&&ae(O),wu(W,O,b.current))}});const B=qi(Q=>function(z){z.preventDefault();const $=p.current;if(!$)return()=>null;const{direction:W,dragState:S,id:O,keyboardResizeBy:j,onLayout:D}=C.current,{layout:Z,panelDataArray:K}=E.current,{initialLayout:oe}=S??{},te=ID(O,Q,$);let Oe=lq(z,Q,W,S,j,$);if(Oe===0)return;const Xe=W==="horizontal";document.dir==="rtl"&&Xe&&(Oe=-Oe);const Je=K.map(we=>we.constraints),Ve=Sh({delta:Oe,layout:oe??Z,panelConstraints:Je,pivotIndices:te,trigger:OD(z)?"keyboard":"mouse-or-touch"}),ct=!Ng(Z,Ve);(LD(z)||DD(z))&&k.current!=Oe&&(k.current=Oe,Px(ct?Xe?"horizontal":"vertical":Xe?Oe<0?"horizontal-min":"horizontal-max":Oe<0?"vertical-min":"vertical-max")),ct&&(v(Ve),E.current.layout=Ve,D&&D(Ve),wu(K,Ve,b.current))},[]),q=qi((Q,ae)=>{const{onLayout:z}=C.current,{layout:$,panelDataArray:W}=E.current,S=W.map(oe=>oe.constraints),{panelSize:O,pivotIndices:j}=fc(W,Q,$);ht(O!=null);const Z=Du(W,Q)===W.length-1?O-ae:ae-O,K=Sh({delta:Z,layout:$,panelConstraints:S,pivotIndices:j,trigger:"imperative-api"});Ng($,K)||(v(K),E.current.layout=K,z&&z(K),wu(W,K,b.current))},[]),Y=qi((Q,ae)=>{const{layout:z,panelDataArray:$}=E.current,{collapsedSize:W=0,collapsible:S}=ae,{collapsedSize:O=0,collapsible:j,maxSize:D=100,minSize:Z=0}=Q.constraints,{panelSize:K}=fc($,Q,z);ht(K!=null),S&&j&&K===W?W!==O&&q(Q,O):K<Z?q(Q,Z):K>D&&q(Q,D)},[q]),ne=qi((Q,ae)=>{const{direction:z}=C.current,{layout:$}=E.current;if(!p.current)return;const W=Ib(Q,p.current);ht(W);const S=jD(z,ae);g({dragHandleId:Q,dragHandleRect:W.getBoundingClientRect(),initialCursorPosition:S,initialLayout:$})},[]),V=qi(()=>{dq(),g(null)},[]),U=qi(Q=>{const{panelDataArray:ae}=E.current,z=Du(ae,Q);z>=0&&(ae.splice(z,1),delete b.current[Q.id],E.current.panelDataArrayChanged=!0)},[]),se=tq(()=>({collapsePanel:_,direction:i,dragState:m,expandPanel:M,getPanelSize:R,getPanelStyle:T,groupId:f,isPanelCollapsed:L,isPanelExpanded:I,reevaluatePanelConstraints:Y,registerPanel:G,registerResizeHandle:B,resizePanel:q,startDragging:ne,stopDragging:V,unregisterPanel:U,panelGroupElement:p.current}),[_,m,i,M,R,T,f,L,I,Y,G,B,q,ne,V,U]),Ce={display:"flex",flexDirection:i==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return Zd(Rb.Provider,{value:se},Zd(u,{...d,children:e,className:n,style:{...Ce,...c},ref:p,"data-panel-group":"","data-panel-group-direction":i,"data-panel-group-id":f}))}const VD=ED((t,e)=>Zd(UD,{...t,forwardedRef:e}));UD.displayName="PanelGroup";VD.displayName="forwardRef(PanelGroup)";function Du(t,e){return t.findIndex(n=>n===e||n.id===e.id)}function fc(t,e,n){const i=Du(t,e),s=i===t.length-1?[i-1,i]:[i,i+1],o=n[i];return{...e.constraints,panelSize:o,pivotIndices:s}}function gq({disabled:t,handleId:e,resizeHandler:n,panelGroupElement:i}){Fc(()=>{if(t||n==null||i==null)return;const r=Ib(e,i);if(r==null)return;const s=o=>{if(!o.defaultPrevented)switch(o.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{o.preventDefault(),n(o);break}case"F6":{o.preventDefault();const a=r.getAttribute("data-panel-group-id");ht(a);const l=Lp(a,i),c=RD(a,e,i);ht(c!==null);const u=o.shiftKey?c>0?c-1:l.length-1:c+1<l.length?c+1:0;l[u].focus();break}}};return r.addEventListener("keydown",s),()=>{r.removeEventListener("keydown",s)}},[i,t,e,n])}function y2({children:t=null,className:e="",disabled:n=!1,id:i,onDragging:r,style:s={},tabIndex:o=0,tagName:a="div",...l}){const c=Sr(null),u=Sr({onDragging:r});Fc(()=>{u.current.onDragging=r});const d=AD(Rb);if(d===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:f,dragState:p,groupId:m,registerResizeHandle:g,startDragging:y,stopDragging:v,panelGroupElement:b}=d,w=B_(i),k=(p==null?void 0:p.dragHandleId)===w,[C,E]=ty(!1),[_,M]=ty(null),R=qi(()=>{const L=c.current;ht(L),L.blur(),v();const{onDragging:I}=u.current;I&&I(!1)},[v]);Fc(()=>{if(n)M(null);else{const L=g(w);M(()=>L)}},[n,w,g]),Fc(()=>{if(n||_==null||!k)return;const L=q=>{_(q)},I=q=>{_(q)},G=c.current;ht(G);const B=G.ownerDocument;return B.body.addEventListener("contextmenu",R),B.body.addEventListener("mousemove",L),B.body.addEventListener("touchmove",L),B.body.addEventListener("mouseleave",I),window.addEventListener("mouseup",R),window.addEventListener("touchend",R),()=>{B.body.removeEventListener("contextmenu",R),B.body.removeEventListener("mousemove",L),B.body.removeEventListener("touchmove",L),B.body.removeEventListener("mouseleave",I),window.removeEventListener("mouseup",R),window.removeEventListener("touchend",R)}},[f,n,k,_,R]),gq({disabled:n,handleId:w,resizeHandler:_,panelGroupElement:b});const T={cursor:BD(f),touchAction:"none",userSelect:"none"};return Zd(a,{...l,children:t,className:e,onBlur:()=>E(!1),onFocus:()=>E(!0),onMouseDown:L=>{y(w,L.nativeEvent);const I=u.current;ht(I);const{onDragging:G}=I;G&&G(!0)},onMouseUp:R,onTouchCancel:R,onTouchEnd:R,onTouchStart:L=>{y(w,L.nativeEvent);const I=u.current;ht(I);const{onDragging:G}=I;G&&G(!0)},ref:c,role:"separator",style:{...T,...s},tabIndex:o,"data-panel-group-direction":f,"data-panel-group-id":m,"data-resize-handle":"","data-resize-handle-active":k?"pointer":C?"keyboard":void 0,"data-panel-resize-handle-enabled":!n,"data-panel-resize-handle-id":w})}y2.displayName="PanelResizeHandle";var ao=function(){return ao=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ao.apply(this,arguments)};function HD(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function vq(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}var yq=function(){};function bq(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.addEventListener&&t.addEventListener.apply(t,e)}function xq(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.removeEventListener&&t.removeEventListener.apply(t,e)}var WD=typeof window<"u",wq=WD?window:null,BM=function(t){return!!t.addEventListener},$M=function(t){return!!t.on},Sq=function(t,e,n,i){n===void 0&&(n=wq),x.useEffect(function(){if(e&&n)return BM(n)?bq(n,t,e,i):$M(n)&&n.on(t,e,i),function(){BM(n)?xq(n,t,e,i):$M(n)&&n.off(t,e,i)}},[t,e,n,JSON.stringify(i)])},kq=function(t){return typeof t=="function"?t:typeof t=="string"?function(e){return e.key===t}:t?function(){return!0}:function(){return!1}},ju=function(t,e,n,i){e===void 0&&(e=yq),n===void 0&&(n={}),i===void 0&&(i=[t]);var r=n.event,s=r===void 0?"keydown":r,o=n.target,a=n.options,l=x.useMemo(function(){var c=kq(t),u=function(d){if(c(d))return e(d)};return u},i);Sq(s,l,o,a)},Cq=function(t,e){return WD?window.matchMedia(t).matches:!1},_q=function(t,e){var n=x.useState(Cq(t)),i=n[0],r=n[1];return x.useEffect(function(){var s=!0,o=window.matchMedia(t),a=function(){s&&r(!!o.matches)};return o.addEventListener("change",a),r(o.matches),function(){s=!1,o.removeEventListener("change",a)}},[t]),i};/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const Eq={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]};/*!
 * Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */function Aq(t,e,n){return(e=Nq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function fe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?FM(Object(n),!0).forEach(function(i){Aq(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):FM(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Pq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nq(t){var e=Pq(t,"string");return typeof e=="symbol"?e:e+""}const zM=()=>{};let $_={},GD={},XD=null,qD={mark:zM,measure:zM};try{typeof window<"u"&&($_=window),typeof document<"u"&&(GD=document),typeof MutationObserver<"u"&&(XD=MutationObserver),typeof performance<"u"&&(qD=performance)}catch{}const{userAgent:UM=""}=$_.navigator||{},Il=$_,rn=GD,VM=XD,Mg=qD;Il.document;const Sa=!!rn.documentElement&&!!rn.head&&typeof rn.addEventListener=="function"&&typeof rn.createElement=="function",KD=~UM.indexOf("MSIE")||~UM.indexOf("Trident/");var Mq=/fa(s|r|l|t|d|dr|dl|dt|b|k|kd|ss|sr|sl|st|sds|sdr|sdl|sdt)?[\-\ ]/,Rq=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,YD={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fab:"brands","fa-brands":"brands"},duotone:{fa:"solid",fad:"solid","fa-solid":"solid","fa-duotone":"solid",fadr:"regular","fa-regular":"regular",fadl:"light","fa-light":"light",fadt:"thin","fa-thin":"thin"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid",fasdr:"regular","fa-regular":"regular",fasdl:"light","fa-light":"light",fasdt:"thin","fa-thin":"thin"}},Iq={GROUP:"duotone-group",PRIMARY:"primary",SECONDARY:"secondary"},JD=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],Ei="classic",Tb="duotone",Tq="sharp",Oq="sharp-duotone",ZD=[Ei,Tb,Tq,Oq],Lq={classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},duotone:{900:"fad",400:"fadr",300:"fadl",100:"fadt"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds",400:"fasdr",300:"fasdl",100:"fasdt"}},Dq={"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad",400:"fadr",normal:"fadr",300:"fadl",100:"fadt"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds",400:"fasdr",normal:"fasdr",300:"fasdl",100:"fasdt"}},jq=new Map([["classic",{defaultShortPrefixId:"fas",defaultStyleId:"solid",styleIds:["solid","regular","light","thin","brands"],futureStyleIds:[],defaultFontWeight:900}],["sharp",{defaultShortPrefixId:"fass",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["duotone",{defaultShortPrefixId:"fad",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["sharp-duotone",{defaultShortPrefixId:"fasds",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}]]),Bq={classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",brands:"fab"},duotone:{solid:"fad",regular:"fadr",light:"fadl",thin:"fadt"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds",regular:"fasdr",light:"fasdl",thin:"fasdt"}},$q=["fak","fa-kit","fakd","fa-kit-duotone"],HM={kit:{fak:"kit","fa-kit":"kit"},"kit-duotone":{fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"}},Fq=["kit"],zq={kit:{"fa-kit":"fak"}},Uq=["fak","fakd"],Vq={kit:{fak:"fa-kit"}},WM={kit:{kit:"fak"},"kit-duotone":{"kit-duotone":"fakd"}},Rg={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},Hq=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],Wq=["fak","fa-kit","fakd","fa-kit-duotone"],Gq={"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}},Xq={classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},duotone:{"fa-regular":"fadr","fa-light":"fadl","fa-thin":"fadt"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds","fa-regular":"fasdr","fa-light":"fasdl","fa-thin":"fasdt"}},qq={classic:["fas","far","fal","fat","fad"],duotone:["fadr","fadl","fadt"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds","fasdr","fasdl","fasdt"]},b2={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},duotone:{fadr:"fa-regular",fadl:"fa-light",fadt:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid",fasdr:"fa-regular",fasdl:"fa-light",fasdt:"fa-thin"}},Kq=["fa-solid","fa-regular","fa-light","fa-thin","fa-duotone","fa-brands"],x2=["fa","fas","far","fal","fat","fad","fadr","fadl","fadt","fab","fass","fasr","fasl","fast","fasds","fasdr","fasdl","fasdt",...Hq,...Kq],Yq=["solid","regular","light","thin","duotone","brands"],QD=[1,2,3,4,5,6,7,8,9,10],Jq=QD.concat([11,12,13,14,15,16,17,18,19,20]),Zq=[...Object.keys(qq),...Yq,"2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",Rg.GROUP,Rg.SWAP_OPACITY,Rg.PRIMARY,Rg.SECONDARY].concat(QD.map(t=>"".concat(t,"x"))).concat(Jq.map(t=>"w-".concat(t))),Qq={"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"}};const pa="___FONT_AWESOME___",w2=16,ej="fa",tj="svg-inline--fa",Zc="data-fa-i2svg",S2="data-fa-pseudo-element",eK="data-fa-pseudo-element-pending",F_="data-prefix",z_="data-icon",GM="fontawesome-i2svg",tK="async",nK=["HTML","HEAD","STYLE","SCRIPT"],nj=(()=>{try{return!0}catch{return!1}})();function Nm(t){return new Proxy(t,{get(e,n){return n in e?e[n]:e[Ei]}})}const ij=fe({},YD);ij[Ei]=fe(fe(fe(fe({},{"fa-duotone":"duotone"}),YD[Ei]),HM.kit),HM["kit-duotone"]);const iK=Nm(ij),k2=fe({},Bq);k2[Ei]=fe(fe(fe(fe({},{duotone:"fad"}),k2[Ei]),WM.kit),WM["kit-duotone"]);const XM=Nm(k2),C2=fe({},b2);C2[Ei]=fe(fe({},C2[Ei]),Vq.kit);const U_=Nm(C2),_2=fe({},Xq);_2[Ei]=fe(fe({},_2[Ei]),zq.kit);Nm(_2);const rK=Mq,rj="fa-layers-text",sK=Rq,oK=fe({},Lq);Nm(oK);const aK=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],Nx=Iq,lK=[...Fq,...Zq],Kh=Il.FontAwesomeConfig||{};function cK(t){var e=rn.querySelector("script["+t+"]");if(e)return e.getAttribute(t)}function uK(t){return t===""?!0:t==="false"?!1:t==="true"?!0:t}rn&&typeof rn.querySelector=="function"&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(e=>{let[n,i]=e;const r=uK(cK(n));r!=null&&(Kh[i]=r)});const sj={styleDefault:"solid",familyDefault:Ei,cssPrefix:ej,replacementClass:tj,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};Kh.familyPrefix&&(Kh.cssPrefix=Kh.familyPrefix);const Qd=fe(fe({},sj),Kh);Qd.autoReplaceSvg||(Qd.observeMutations=!1);const ze={};Object.keys(sj).forEach(t=>{Object.defineProperty(ze,t,{enumerable:!0,set:function(e){Qd[t]=e,Yh.forEach(n=>n(ze))},get:function(){return Qd[t]}})});Object.defineProperty(ze,"familyPrefix",{enumerable:!0,set:function(t){Qd.cssPrefix=t,Yh.forEach(e=>e(ze))},get:function(){return Qd.cssPrefix}});Il.FontAwesomeConfig=ze;const Yh=[];function dK(t){return Yh.push(t),()=>{Yh.splice(Yh.indexOf(t),1)}}const Ra=w2,po={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function fK(t){if(!t||!Sa)return;const e=rn.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=t;const n=rn.head.childNodes;let i=null;for(let r=n.length-1;r>-1;r--){const s=n[r],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(i=s)}return rn.head.insertBefore(e,i),t}const hK="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Dp(){let t=12,e="";for(;t-- >0;)e+=hK[Math.random()*62|0];return e}function Ef(t){const e=[];for(let n=(t||[]).length>>>0;n--;)e[n]=t[n];return e}function V_(t){return t.classList?Ef(t.classList):(t.getAttribute("class")||"").split(" ").filter(e=>e)}function oj(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function pK(t){return Object.keys(t||{}).reduce((e,n)=>e+"".concat(n,'="').concat(oj(t[n]),'" '),"").trim()}function Ob(t){return Object.keys(t||{}).reduce((e,n)=>e+"".concat(n,": ").concat(t[n].trim(),";"),"")}function H_(t){return t.size!==po.size||t.x!==po.x||t.y!==po.y||t.rotate!==po.rotate||t.flipX||t.flipY}function mK(t){let{transform:e,containerWidth:n,iconWidth:i}=t;const r={transform:"translate(".concat(n/2," 256)")},s="translate(".concat(e.x*32,", ").concat(e.y*32,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)"),l={transform:"".concat(s," ").concat(o," ").concat(a)},c={transform:"translate(".concat(i/2*-1," -256)")};return{outer:r,inner:l,path:c}}function gK(t){let{transform:e,width:n=w2,height:i=w2,startCentered:r=!1}=t,s="";return r&&KD?s+="translate(".concat(e.x/Ra-n/2,"em, ").concat(e.y/Ra-i/2,"em) "):r?s+="translate(calc(-50% + ".concat(e.x/Ra,"em), calc(-50% + ").concat(e.y/Ra,"em)) "):s+="translate(".concat(e.x/Ra,"em, ").concat(e.y/Ra,"em) "),s+="scale(".concat(e.size/Ra*(e.flipX?-1:1),", ").concat(e.size/Ra*(e.flipY?-1:1),") "),s+="rotate(".concat(e.rotate,"deg) "),s}var vK=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-counter-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(-1 * var(--fa-li-width, 2em));
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  animation-name: fa-beat;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  animation-name: fa-bounce;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  animation-name: fa-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  animation-name: fa-beat-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  animation-name: fa-flip;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  animation-name: fa-shake;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  animation-name: fa-spin;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 2s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  animation-name: fa-spin;
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    animation-delay: -1ms;
    animation-duration: 1ms;
    animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@keyframes fa-beat {
  0%, 90% {
    transform: scale(1);
  }
  45% {
    transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-bounce {
  0% {
    transform: scale(1, 1) translateY(0);
  }
  10% {
    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    transform: scale(1, 1) translateY(0);
  }
  100% {
    transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-flip {
  50% {
    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-shake {
  0% {
    transform: rotate(-15deg);
  }
  4% {
    transform: rotate(15deg);
  }
  8%, 24% {
    transform: rotate(-18deg);
  }
  12%, 28% {
    transform: rotate(18deg);
  }
  16% {
    transform: rotate(-22deg);
  }
  20% {
    transform: rotate(22deg);
  }
  32% {
    transform: rotate(-12deg);
  }
  36% {
    transform: rotate(12deg);
  }
  40%, 100% {
    transform: rotate(0deg);
  }
}
@keyframes fa-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  transform: rotate(90deg);
}

.fa-rotate-180 {
  transform: rotate(180deg);
}

.fa-rotate-270 {
  transform: rotate(270deg);
}

.fa-flip-horizontal {
  transform: scale(-1, 1);
}

.fa-flip-vertical {
  transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  transform: scale(-1, -1);
}

.fa-rotate-by {
  transform: rotate(var(--fa-rotate-angle, 0));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}`;function aj(){const t=ej,e=tj,n=ze.cssPrefix,i=ze.replacementClass;let r=vK;if(n!==t||i!==e){const s=new RegExp("\\.".concat(t,"\\-"),"g"),o=new RegExp("\\--".concat(t,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");r=r.replace(s,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(a,".".concat(i))}return r}let qM=!1;function Mx(){ze.autoAddCss&&!qM&&(fK(aj()),qM=!0)}var yK={mixout(){return{dom:{css:aj,insertCss:Mx}}},hooks(){return{beforeDOMElementCreation(){Mx()},beforeI2svg(){Mx()}}}};const ma=Il||{};ma[pa]||(ma[pa]={});ma[pa].styles||(ma[pa].styles={});ma[pa].hooks||(ma[pa].hooks={});ma[pa].shims||(ma[pa].shims=[]);var mo=ma[pa];const lj=[],cj=function(){rn.removeEventListener("DOMContentLoaded",cj),ny=1,lj.map(t=>t())};let ny=!1;Sa&&(ny=(rn.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(rn.readyState),ny||rn.addEventListener("DOMContentLoaded",cj));function bK(t){Sa&&(ny?setTimeout(t,0):lj.push(t))}function Mm(t){const{tag:e,attributes:n={},children:i=[]}=t;return typeof t=="string"?oj(t):"<".concat(e," ").concat(pK(n),">").concat(i.map(Mm).join(""),"</").concat(e,">")}function KM(t,e,n){if(t&&t[e]&&t[e][n])return{prefix:e,iconName:n,icon:t[e][n]}}var Rx=function(e,n,i,r){var s=Object.keys(e),o=s.length,a=n,l,c,u;for(i===void 0?(l=1,u=e[s[0]]):(l=0,u=i);l<o;l++)c=s[l],u=a(u,e[c],c,e);return u};function xK(t){const e=[];let n=0;const i=t.length;for(;n<i;){const r=t.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){const s=t.charCodeAt(n++);(s&64512)==56320?e.push(((r&1023)<<10)+(s&1023)+65536):(e.push(r),n--)}else e.push(r)}return e}function E2(t){const e=xK(t);return e.length===1?e[0].toString(16):null}function wK(t,e){const n=t.length;let i=t.charCodeAt(e),r;return i>=55296&&i<=56319&&n>e+1&&(r=t.charCodeAt(e+1),r>=56320&&r<=57343)?(i-55296)*1024+r-56320+65536:i}function YM(t){return Object.keys(t).reduce((e,n)=>{const i=t[n];return!!i.icon?e[i.iconName]=i.icon:e[n]=i,e},{})}function A2(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{skipHooks:i=!1}=n,r=YM(e);typeof mo.hooks.addPack=="function"&&!i?mo.hooks.addPack(t,YM(e)):mo.styles[t]=fe(fe({},mo.styles[t]||{}),r),t==="fas"&&A2("fa",e)}const{styles:jp,shims:SK}=mo,uj=Object.keys(U_),kK=uj.reduce((t,e)=>(t[e]=Object.keys(U_[e]),t),{});let W_=null,dj={},fj={},hj={},pj={},mj={};function CK(t){return~lK.indexOf(t)}function _K(t,e){const n=e.split("-"),i=n[0],r=n.slice(1).join("-");return i===t&&r!==""&&!CK(r)?r:null}const gj=()=>{const t=i=>Rx(jp,(r,s,o)=>(r[o]=Rx(s,i,{}),r),{});dj=t((i,r,s)=>(r[3]&&(i[r[3]]=s),r[2]&&r[2].filter(a=>typeof a=="number").forEach(a=>{i[a.toString(16)]=s}),i)),fj=t((i,r,s)=>(i[s]=s,r[2]&&r[2].filter(a=>typeof a=="string").forEach(a=>{i[a]=s}),i)),mj=t((i,r,s)=>{const o=r[2];return i[s]=s,o.forEach(a=>{i[a]=s}),i});const e="far"in jp||ze.autoFetchSvg,n=Rx(SK,(i,r)=>{const s=r[0];let o=r[1];const a=r[2];return o==="far"&&!e&&(o="fas"),typeof s=="string"&&(i.names[s]={prefix:o,iconName:a}),typeof s=="number"&&(i.unicodes[s.toString(16)]={prefix:o,iconName:a}),i},{names:{},unicodes:{}});hj=n.names,pj=n.unicodes,W_=Lb(ze.styleDefault,{family:ze.familyDefault})};dK(t=>{W_=Lb(t.styleDefault,{family:ze.familyDefault})});gj();function G_(t,e){return(dj[t]||{})[e]}function EK(t,e){return(fj[t]||{})[e]}function Oc(t,e){return(mj[t]||{})[e]}function vj(t){return hj[t]||{prefix:null,iconName:null}}function AK(t){const e=pj[t],n=G_("fas",t);return e||(n?{prefix:"fas",iconName:n}:null)||{prefix:null,iconName:null}}function Tl(){return W_}const yj=()=>({prefix:null,iconName:null,rest:[]});function PK(t){let e=Ei;const n=uj.reduce((i,r)=>(i[r]="".concat(ze.cssPrefix,"-").concat(r),i),{});return ZD.forEach(i=>{(t.includes(n[i])||t.some(r=>kK[i].includes(r)))&&(e=i)}),e}function Lb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{family:n=Ei}=e,i=iK[n][t];if(n===Tb&&!t)return"fad";const r=XM[n][t]||XM[n][i],s=t in mo.styles?t:null;return r||s||null}function NK(t){let e=[],n=null;return t.forEach(i=>{const r=_K(ze.cssPrefix,i);r?n=r:i&&e.push(i)}),{iconName:n,rest:e}}function JM(t){return t.sort().filter((e,n,i)=>i.indexOf(e)===n)}function Db(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{skipLookups:n=!1}=e;let i=null;const r=x2.concat(Wq),s=JM(t.filter(d=>r.includes(d))),o=JM(t.filter(d=>!x2.includes(d))),a=s.filter(d=>(i=d,!JD.includes(d))),[l=null]=a,c=PK(s),u=fe(fe({},NK(o)),{},{prefix:Lb(l,{family:c})});return fe(fe(fe({},u),TK({values:t,family:c,styles:jp,config:ze,canonical:u,givenPrefix:i})),MK(n,i,u))}function MK(t,e,n){let{prefix:i,iconName:r}=n;if(t||!i||!r)return{prefix:i,iconName:r};const s=e==="fa"?vj(r):{},o=Oc(i,r);return r=s.iconName||o||r,i=s.prefix||i,i==="far"&&!jp.far&&jp.fas&&!ze.autoFetchSvg&&(i="fas"),{prefix:i,iconName:r}}const RK=ZD.filter(t=>t!==Ei||t!==Tb),IK=Object.keys(b2).filter(t=>t!==Ei).map(t=>Object.keys(b2[t])).flat();function TK(t){const{values:e,family:n,canonical:i,givenPrefix:r="",styles:s={},config:o={}}=t,a=n===Tb,l=e.includes("fa-duotone")||e.includes("fad"),c=o.familyDefault==="duotone",u=i.prefix==="fad"||i.prefix==="fa-duotone";if(!a&&(l||c||u)&&(i.prefix="fad"),(e.includes("fa-brands")||e.includes("fab"))&&(i.prefix="fab"),!i.prefix&&RK.includes(n)&&(Object.keys(s).find(f=>IK.includes(f))||o.autoFetchSvg)){const f=jq.get(n).defaultShortPrefixId;i.prefix=f,i.iconName=Oc(i.prefix,i.iconName)||i.iconName}return(i.prefix==="fa"||r==="fa")&&(i.prefix=Tl()||"fas"),i}class OK{constructor(){this.definitions={}}add(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];const r=n.reduce(this._pullDefinitions,{});Object.keys(r).forEach(s=>{this.definitions[s]=fe(fe({},this.definitions[s]||{}),r[s]),A2(s,r[s]);const o=U_[Ei][s];o&&A2(o,r[s]),gj()})}reset(){this.definitions={}}_pullDefinitions(e,n){const i=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(i).map(r=>{const{prefix:s,iconName:o,icon:a}=i[r],l=a[2];e[s]||(e[s]={}),l.length>0&&l.forEach(c=>{typeof c=="string"&&(e[s][c]=a)}),e[s][o]=a}),e}}let ZM=[],od={};const xd={},LK=Object.keys(xd);function DK(t,e){let{mixoutsTo:n}=e;return ZM=t,od={},Object.keys(xd).forEach(i=>{LK.indexOf(i)===-1&&delete xd[i]}),ZM.forEach(i=>{const r=i.mixout?i.mixout():{};if(Object.keys(r).forEach(s=>{typeof r[s]=="function"&&(n[s]=r[s]),typeof r[s]=="object"&&Object.keys(r[s]).forEach(o=>{n[s]||(n[s]={}),n[s][o]=r[s][o]})}),i.hooks){const s=i.hooks();Object.keys(s).forEach(o=>{od[o]||(od[o]=[]),od[o].push(s[o])})}i.provides&&i.provides(xd)}),n}function P2(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return(od[t]||[]).forEach(o=>{e=o.apply(null,[e,...i])}),e}function Qc(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];(od[t]||[]).forEach(s=>{s.apply(null,n)})}function Ol(){const t=arguments[0],e=Array.prototype.slice.call(arguments,1);return xd[t]?xd[t].apply(null,e):void 0}function N2(t){t.prefix==="fa"&&(t.prefix="fas");let{iconName:e}=t;const n=t.prefix||Tl();if(e)return e=Oc(n,e)||e,KM(bj.definitions,n,e)||KM(mo.styles,n,e)}const bj=new OK,jK=()=>{ze.autoReplaceSvg=!1,ze.observeMutations=!1,Qc("noAuto")},BK={i2svg:function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Sa?(Qc("beforeI2svg",t),Ol("pseudoElements2svg",t),Ol("i2svg",t)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e}=t;ze.autoReplaceSvg===!1&&(ze.autoReplaceSvg=!0),ze.observeMutations=!0,bK(()=>{FK({autoReplaceSvgRoot:e}),Qc("watch",t)})}},$K={icon:t=>{if(t===null)return null;if(typeof t=="object"&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:Oc(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&t.length===2){const e=t[1].indexOf("fa-")===0?t[1].slice(3):t[1],n=Lb(t[0]);return{prefix:n,iconName:Oc(n,e)||e}}if(typeof t=="string"&&(t.indexOf("".concat(ze.cssPrefix,"-"))>-1||t.match(rK))){const e=Db(t.split(" "),{skipLookups:!0});return{prefix:e.prefix||Tl(),iconName:Oc(e.prefix,e.iconName)||e.iconName}}if(typeof t=="string"){const e=Tl();return{prefix:e,iconName:Oc(e,t)||t}}}},$r={noAuto:jK,config:ze,dom:BK,parse:$K,library:bj,findIconDefinition:N2,toHtml:Mm},FK=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e=rn}=t;(Object.keys(mo.styles).length>0||ze.autoFetchSvg)&&Sa&&ze.autoReplaceSvg&&$r.dom.i2svg({node:e})};function jb(t,e){return Object.defineProperty(t,"abstract",{get:e}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(n=>Mm(n))}}),Object.defineProperty(t,"node",{get:function(){if(!Sa)return;const n=rn.createElement("div");return n.innerHTML=t.html,n.children}}),t}function zK(t){let{children:e,main:n,mask:i,attributes:r,styles:s,transform:o}=t;if(H_(o)&&n.found&&!i.found){const{width:a,height:l}=n,c={x:a/l/2,y:.5};r.style=Ob(fe(fe({},s),{},{"transform-origin":"".concat(c.x+o.x/16,"em ").concat(c.y+o.y/16,"em")}))}return[{tag:"svg",attributes:r,children:e}]}function UK(t){let{prefix:e,iconName:n,children:i,attributes:r,symbol:s}=t;const o=s===!0?"".concat(e,"-").concat(ze.cssPrefix,"-").concat(n):s;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:fe(fe({},r),{},{id:o}),children:i}]}]}function X_(t){const{icons:{main:e,mask:n},prefix:i,iconName:r,transform:s,symbol:o,title:a,maskId:l,titleId:c,extra:u,watchable:d=!1}=t,{width:f,height:p}=n.found?n:e,m=Uq.includes(i),g=[ze.replacementClass,r?"".concat(ze.cssPrefix,"-").concat(r):""].filter(C=>u.classes.indexOf(C)===-1).filter(C=>C!==""||!!C).concat(u.classes).join(" ");let y={children:[],attributes:fe(fe({},u.attributes),{},{"data-prefix":i,"data-icon":r,class:g,role:u.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(f," ").concat(p)})};const v=m&&!~u.classes.indexOf("fa-fw")?{width:"".concat(f/p*16*.0625,"em")}:{};d&&(y.attributes[Zc]=""),a&&(y.children.push({tag:"title",attributes:{id:y.attributes["aria-labelledby"]||"title-".concat(c||Dp())},children:[a]}),delete y.attributes.title);const b=fe(fe({},y),{},{prefix:i,iconName:r,main:e,mask:n,maskId:l,transform:s,symbol:o,styles:fe(fe({},v),u.styles)}),{children:w,attributes:k}=n.found&&e.found?Ol("generateAbstractMask",b)||{children:[],attributes:{}}:Ol("generateAbstractIcon",b)||{children:[],attributes:{}};return b.children=w,b.attributes=k,o?UK(b):zK(b)}function QM(t){const{content:e,width:n,height:i,transform:r,title:s,extra:o,watchable:a=!1}=t,l=fe(fe(fe({},o.attributes),s?{title:s}:{}),{},{class:o.classes.join(" ")});a&&(l[Zc]="");const c=fe({},o.styles);H_(r)&&(c.transform=gK({transform:r,startCentered:!0,width:n,height:i}),c["-webkit-transform"]=c.transform);const u=Ob(c);u.length>0&&(l.style=u);const d=[];return d.push({tag:"span",attributes:l,children:[e]}),s&&d.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),d}function VK(t){const{content:e,title:n,extra:i}=t,r=fe(fe(fe({},i.attributes),n?{title:n}:{}),{},{class:i.classes.join(" ")}),s=Ob(i.styles);s.length>0&&(r.style=s);const o=[];return o.push({tag:"span",attributes:r,children:[e]}),n&&o.push({tag:"span",attributes:{class:"sr-only"},children:[n]}),o}const{styles:Ix}=mo;function M2(t){const e=t[0],n=t[1],[i]=t.slice(4);let r=null;return Array.isArray(i)?r={tag:"g",attributes:{class:"".concat(ze.cssPrefix,"-").concat(Nx.GROUP)},children:[{tag:"path",attributes:{class:"".concat(ze.cssPrefix,"-").concat(Nx.SECONDARY),fill:"currentColor",d:i[0]}},{tag:"path",attributes:{class:"".concat(ze.cssPrefix,"-").concat(Nx.PRIMARY),fill:"currentColor",d:i[1]}}]}:r={tag:"path",attributes:{fill:"currentColor",d:i}},{found:!0,width:e,height:n,icon:r}}const HK={found:!1,width:512,height:512};function WK(t,e){!nj&&!ze.showMissingIcons&&t&&console.error('Icon with name "'.concat(t,'" and prefix "').concat(e,'" is missing.'))}function R2(t,e){let n=e;return e==="fa"&&ze.styleDefault!==null&&(e=Tl()),new Promise((i,r)=>{if(n==="fa"){const s=vj(t)||{};t=s.iconName||t,e=s.prefix||e}if(t&&e&&Ix[e]&&Ix[e][t]){const s=Ix[e][t];return i(M2(s))}WK(t,e),i(fe(fe({},HK),{},{icon:ze.showMissingIcons&&t?Ol("missingIconAbstract")||{}:{}}))})}const eR=()=>{},I2=ze.measurePerformance&&Mg&&Mg.mark&&Mg.measure?Mg:{mark:eR,measure:eR},Ch='FA "6.7.1"',GK=t=>(I2.mark("".concat(Ch," ").concat(t," begins")),()=>xj(t)),xj=t=>{I2.mark("".concat(Ch," ").concat(t," ends")),I2.measure("".concat(Ch," ").concat(t),"".concat(Ch," ").concat(t," begins"),"".concat(Ch," ").concat(t," ends"))};var q_={begin:GK,end:xj};const X0=()=>{};function tR(t){return typeof(t.getAttribute?t.getAttribute(Zc):null)=="string"}function XK(t){const e=t.getAttribute?t.getAttribute(F_):null,n=t.getAttribute?t.getAttribute(z_):null;return e&&n}function qK(t){return t&&t.classList&&t.classList.contains&&t.classList.contains(ze.replacementClass)}function KK(){return ze.autoReplaceSvg===!0?q0.replace:q0[ze.autoReplaceSvg]||q0.replace}function YK(t){return rn.createElementNS("http://www.w3.org/2000/svg",t)}function JK(t){return rn.createElement(t)}function wj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{ceFn:n=t.tag==="svg"?YK:JK}=e;if(typeof t=="string")return rn.createTextNode(t);const i=n(t.tag);return Object.keys(t.attributes||[]).forEach(function(s){i.setAttribute(s,t.attributes[s])}),(t.children||[]).forEach(function(s){i.appendChild(wj(s,{ceFn:n}))}),i}function ZK(t){let e=" ".concat(t.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}const q0={replace:function(t){const e=t[0];if(e.parentNode)if(t[1].forEach(n=>{e.parentNode.insertBefore(wj(n),e)}),e.getAttribute(Zc)===null&&ze.keepOriginalSource){let n=rn.createComment(ZK(e));e.parentNode.replaceChild(n,e)}else e.remove()},nest:function(t){const e=t[0],n=t[1];if(~V_(e).indexOf(ze.replacementClass))return q0.replace(t);const i=new RegExp("".concat(ze.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){const s=n[0].attributes.class.split(" ").reduce((o,a)=>(a===ze.replacementClass||a.match(i)?o.toSvg.push(a):o.toNode.push(a),o),{toNode:[],toSvg:[]});n[0].attributes.class=s.toSvg.join(" "),s.toNode.length===0?e.removeAttribute("class"):e.setAttribute("class",s.toNode.join(" "))}const r=n.map(s=>Mm(s)).join(`
`);e.setAttribute(Zc,""),e.innerHTML=r}};function nR(t){t()}function Sj(t,e){const n=typeof e=="function"?e:X0;if(t.length===0)n();else{let i=nR;ze.mutateApproach===tK&&(i=Il.requestAnimationFrame||nR),i(()=>{const r=KK(),s=q_.begin("mutate");t.map(r),s(),n()})}}let K_=!1;function kj(){K_=!0}function T2(){K_=!1}let iy=null;function iR(t){if(!VM||!ze.observeMutations)return;const{treeCallback:e=X0,nodeCallback:n=X0,pseudoElementsCallback:i=X0,observeMutationsRoot:r=rn}=t;iy=new VM(s=>{if(K_)return;const o=Tl();Ef(s).forEach(a=>{if(a.type==="childList"&&a.addedNodes.length>0&&!tR(a.addedNodes[0])&&(ze.searchPseudoElements&&i(a.target),e(a.target)),a.type==="attributes"&&a.target.parentNode&&ze.searchPseudoElements&&i(a.target.parentNode),a.type==="attributes"&&tR(a.target)&&~aK.indexOf(a.attributeName))if(a.attributeName==="class"&&XK(a.target)){const{prefix:l,iconName:c}=Db(V_(a.target));a.target.setAttribute(F_,l||o),c&&a.target.setAttribute(z_,c)}else qK(a.target)&&n(a.target)})}),Sa&&iy.observe(r,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function QK(){iy&&iy.disconnect()}function eY(t){const e=t.getAttribute("style");let n=[];return e&&(n=e.split(";").reduce((i,r)=>{const s=r.split(":"),o=s[0],a=s.slice(1);return o&&a.length>0&&(i[o]=a.join(":").trim()),i},{})),n}function tY(t){const e=t.getAttribute("data-prefix"),n=t.getAttribute("data-icon"),i=t.innerText!==void 0?t.innerText.trim():"";let r=Db(V_(t));return r.prefix||(r.prefix=Tl()),e&&n&&(r.prefix=e,r.iconName=n),r.iconName&&r.prefix||(r.prefix&&i.length>0&&(r.iconName=EK(r.prefix,t.innerText)||G_(r.prefix,E2(t.innerText))),!r.iconName&&ze.autoFetchSvg&&t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&(r.iconName=t.firstChild.data)),r}function nY(t){const e=Ef(t.attributes).reduce((r,s)=>(r.name!=="class"&&r.name!=="style"&&(r[s.name]=s.value),r),{}),n=t.getAttribute("title"),i=t.getAttribute("data-fa-title-id");return ze.autoA11y&&(n?e["aria-labelledby"]="".concat(ze.replacementClass,"-title-").concat(i||Dp()):(e["aria-hidden"]="true",e.focusable="false")),e}function iY(){return{iconName:null,title:null,titleId:null,prefix:null,transform:po,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function rR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0};const{iconName:n,prefix:i,rest:r}=tY(t),s=nY(t),o=P2("parseNodeAttributes",{},t);let a=e.styleParser?eY(t):[];return fe({iconName:n,title:t.getAttribute("title"),titleId:t.getAttribute("data-fa-title-id"),prefix:i,transform:po,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:r,styles:a,attributes:s}},o)}const{styles:rY}=mo;function Cj(t){const e=ze.autoReplaceSvg==="nest"?rR(t,{styleParser:!1}):rR(t);return~e.extra.classes.indexOf(rj)?Ol("generateLayersText",t,e):Ol("generateSvgReplacementMutation",t,e)}function sY(){return[...$q,...x2]}function sR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Sa)return Promise.resolve();const n=rn.documentElement.classList,i=u=>n.add("".concat(GM,"-").concat(u)),r=u=>n.remove("".concat(GM,"-").concat(u)),s=ze.autoFetchSvg?sY():JD.concat(Object.keys(rY));s.includes("fa")||s.push("fa");const o=[".".concat(rj,":not([").concat(Zc,"])")].concat(s.map(u=>".".concat(u,":not([").concat(Zc,"])"))).join(", ");if(o.length===0)return Promise.resolve();let a=[];try{a=Ef(t.querySelectorAll(o))}catch{}if(a.length>0)i("pending"),r("complete");else return Promise.resolve();const l=q_.begin("onTree"),c=a.reduce((u,d)=>{try{const f=Cj(d);f&&u.push(f)}catch(f){nj||f.name==="MissingIcon"&&console.error(f)}return u},[]);return new Promise((u,d)=>{Promise.all(c).then(f=>{Sj(f,()=>{i("active"),i("complete"),r("pending"),typeof e=="function"&&e(),l(),u()})}).catch(f=>{l(),d(f)})})}function oY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Cj(t).then(n=>{n&&Sj([n],e)})}function aY(t){return function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=(e||{}).icon?e:N2(e||{});let{mask:r}=n;return r&&(r=(r||{}).icon?r:N2(r||{})),t(i,fe(fe({},n),{},{mask:r}))}}const lY=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:n=po,symbol:i=!1,mask:r=null,maskId:s=null,title:o=null,titleId:a=null,classes:l=[],attributes:c={},styles:u={}}=e;if(!t)return;const{prefix:d,iconName:f,icon:p}=t;return jb(fe({type:"icon"},t),()=>(Qc("beforeDOMElementCreation",{iconDefinition:t,params:e}),ze.autoA11y&&(o?c["aria-labelledby"]="".concat(ze.replacementClass,"-title-").concat(a||Dp()):(c["aria-hidden"]="true",c.focusable="false")),X_({icons:{main:M2(p),mask:r?M2(r.icon):{found:!1,width:null,height:null,icon:{}}},prefix:d,iconName:f,transform:fe(fe({},po),n),symbol:i,title:o,maskId:s,titleId:a,extra:{attributes:c,styles:u,classes:l}})))};var cY={mixout(){return{icon:aY(lY)}},hooks(){return{mutationObserverCallbacks(t){return t.treeCallback=sR,t.nodeCallback=oY,t}}},provides(t){t.i2svg=function(e){const{node:n=rn,callback:i=()=>{}}=e;return sR(n,i)},t.generateSvgReplacementMutation=function(e,n){const{iconName:i,title:r,titleId:s,prefix:o,transform:a,symbol:l,mask:c,maskId:u,extra:d}=n;return new Promise((f,p)=>{Promise.all([R2(i,o),c.iconName?R2(c.iconName,c.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(m=>{let[g,y]=m;f([e,X_({icons:{main:g,mask:y},prefix:o,iconName:i,transform:a,symbol:l,maskId:u,title:r,titleId:s,extra:d,watchable:!0})])}).catch(p)})},t.generateAbstractIcon=function(e){let{children:n,attributes:i,main:r,transform:s,styles:o}=e;const a=Ob(o);a.length>0&&(i.style=a);let l;return H_(s)&&(l=Ol("generateAbstractTransformGrouping",{main:r,transform:s,containerWidth:r.width,iconWidth:r.width})),n.push(l||r.icon),{children:n,attributes:i}}}},uY={mixout(){return{layer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{classes:n=[]}=e;return jb({type:"layer"},()=>{Qc("beforeDOMElementCreation",{assembler:t,params:e});let i=[];return t(r=>{Array.isArray(r)?r.map(s=>{i=i.concat(s.abstract)}):i=i.concat(r.abstract)}),[{tag:"span",attributes:{class:["".concat(ze.cssPrefix,"-layers"),...n].join(" ")},children:i}]})}}}},dY={mixout(){return{counter(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{title:n=null,classes:i=[],attributes:r={},styles:s={}}=e;return jb({type:"counter",content:t},()=>(Qc("beforeDOMElementCreation",{content:t,params:e}),VK({content:t.toString(),title:n,extra:{attributes:r,styles:s,classes:["".concat(ze.cssPrefix,"-layers-counter"),...i]}})))}}}},fY={mixout(){return{text(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:n=po,title:i=null,classes:r=[],attributes:s={},styles:o={}}=e;return jb({type:"text",content:t},()=>(Qc("beforeDOMElementCreation",{content:t,params:e}),QM({content:t,transform:fe(fe({},po),n),title:i,extra:{attributes:s,styles:o,classes:["".concat(ze.cssPrefix,"-layers-text"),...r]}})))}}},provides(t){t.generateLayersText=function(e,n){const{title:i,transform:r,extra:s}=n;let o=null,a=null;if(KD){const l=parseInt(getComputedStyle(e).fontSize,10),c=e.getBoundingClientRect();o=c.width/l,a=c.height/l}return ze.autoA11y&&!i&&(s.attributes["aria-hidden"]="true"),Promise.resolve([e,QM({content:e.innerHTML,width:o,height:a,transform:r,title:i,extra:s,watchable:!0})])}}};const hY=new RegExp('"',"ug"),oR=[1105920,1112319],aR=fe(fe(fe(fe({},{FontAwesome:{normal:"fas",400:"fas"}}),Dq),Qq),Gq),O2=Object.keys(aR).reduce((t,e)=>(t[e.toLowerCase()]=aR[e],t),{}),pY=Object.keys(O2).reduce((t,e)=>{const n=O2[e];return t[e]=n[900]||[...Object.entries(n)][0][1],t},{});function mY(t){const e=t.replace(hY,""),n=wK(e,0),i=n>=oR[0]&&n<=oR[1],r=e.length===2?e[0]===e[1]:!1;return{value:E2(r?e[0]:e),isSecondary:i||r}}function gY(t,e){const n=t.replace(/^['"]|['"]$/g,"").toLowerCase(),i=parseInt(e),r=isNaN(i)?"normal":i;return(O2[n]||{})[r]||pY[n]}function lR(t,e){const n="".concat(eK).concat(e.replace(":","-"));return new Promise((i,r)=>{if(t.getAttribute(n)!==null)return i();const o=Ef(t.children).filter(f=>f.getAttribute(S2)===e)[0],a=Il.getComputedStyle(t,e),l=a.getPropertyValue("font-family"),c=l.match(sK),u=a.getPropertyValue("font-weight"),d=a.getPropertyValue("content");if(o&&!c)return t.removeChild(o),i();if(c&&d!=="none"&&d!==""){const f=a.getPropertyValue("content");let p=gY(l,u);const{value:m,isSecondary:g}=mY(f),y=c[0].startsWith("FontAwesome");let v=G_(p,m),b=v;if(y){const w=AK(m);w.iconName&&w.prefix&&(v=w.iconName,p=w.prefix)}if(v&&!g&&(!o||o.getAttribute(F_)!==p||o.getAttribute(z_)!==b)){t.setAttribute(n,b),o&&t.removeChild(o);const w=iY(),{extra:k}=w;k.attributes[S2]=e,R2(v,p).then(C=>{const E=X_(fe(fe({},w),{},{icons:{main:C,mask:yj()},prefix:p,iconName:b,extra:k,watchable:!0})),_=rn.createElementNS("http://www.w3.org/2000/svg","svg");e==="::before"?t.insertBefore(_,t.firstChild):t.appendChild(_),_.outerHTML=E.map(M=>Mm(M)).join(`
`),t.removeAttribute(n),i()}).catch(r)}else i()}else i()})}function vY(t){return Promise.all([lR(t,"::before"),lR(t,"::after")])}function yY(t){return t.parentNode!==document.head&&!~nK.indexOf(t.tagName.toUpperCase())&&!t.getAttribute(S2)&&(!t.parentNode||t.parentNode.tagName!=="svg")}function cR(t){if(Sa)return new Promise((e,n)=>{const i=Ef(t.querySelectorAll("*")).filter(yY).map(vY),r=q_.begin("searchPseudoElements");kj(),Promise.all(i).then(()=>{r(),T2(),e()}).catch(()=>{r(),T2(),n()})})}var bY={hooks(){return{mutationObserverCallbacks(t){return t.pseudoElementsCallback=cR,t}}},provides(t){t.pseudoElements2svg=function(e){const{node:n=rn}=e;ze.searchPseudoElements&&cR(n)}}};let uR=!1;var xY={mixout(){return{dom:{unwatch(){kj(),uR=!0}}}},hooks(){return{bootstrap(){iR(P2("mutationObserverCallbacks",{}))},noAuto(){QK()},watch(t){const{observeMutationsRoot:e}=t;uR?T2():iR(P2("mutationObserverCallbacks",{observeMutationsRoot:e}))}}}};const dR=t=>{let e={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return t.toLowerCase().split(" ").reduce((n,i)=>{const r=i.toLowerCase().split("-"),s=r[0];let o=r.slice(1).join("-");if(s&&o==="h")return n.flipX=!0,n;if(s&&o==="v")return n.flipY=!0,n;if(o=parseFloat(o),isNaN(o))return n;switch(s){case"grow":n.size=n.size+o;break;case"shrink":n.size=n.size-o;break;case"left":n.x=n.x-o;break;case"right":n.x=n.x+o;break;case"up":n.y=n.y-o;break;case"down":n.y=n.y+o;break;case"rotate":n.rotate=n.rotate+o;break}return n},e)};var wY={mixout(){return{parse:{transform:t=>dR(t)}}},hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-transform");return n&&(t.transform=dR(n)),t}}},provides(t){t.generateAbstractTransformGrouping=function(e){let{main:n,transform:i,containerWidth:r,iconWidth:s}=e;const o={transform:"translate(".concat(r/2," 256)")},a="translate(".concat(i.x*32,", ").concat(i.y*32,") "),l="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),c="rotate(".concat(i.rotate," 0 0)"),u={transform:"".concat(a," ").concat(l," ").concat(c)},d={transform:"translate(".concat(s/2*-1," -256)")},f={outer:o,inner:u,path:d};return{tag:"g",attributes:fe({},f.outer),children:[{tag:"g",attributes:fe({},f.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:fe(fe({},n.icon.attributes),f.path)}]}]}}}};const Tx={x:0,y:0,width:"100%",height:"100%"};function fR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.attributes&&(t.attributes.fill||e)&&(t.attributes.fill="black"),t}function SY(t){return t.tag==="g"?t.children:[t]}var kY={hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-mask"),i=n?Db(n.split(" ").map(r=>r.trim())):yj();return i.prefix||(i.prefix=Tl()),t.mask=i,t.maskId=e.getAttribute("data-fa-mask-id"),t}}},provides(t){t.generateAbstractMask=function(e){let{children:n,attributes:i,main:r,mask:s,maskId:o,transform:a}=e;const{width:l,icon:c}=r,{width:u,icon:d}=s,f=mK({transform:a,containerWidth:u,iconWidth:l}),p={tag:"rect",attributes:fe(fe({},Tx),{},{fill:"white"})},m=c.children?{children:c.children.map(fR)}:{},g={tag:"g",attributes:fe({},f.inner),children:[fR(fe({tag:c.tag,attributes:fe(fe({},c.attributes),f.path)},m))]},y={tag:"g",attributes:fe({},f.outer),children:[g]},v="mask-".concat(o||Dp()),b="clip-".concat(o||Dp()),w={tag:"mask",attributes:fe(fe({},Tx),{},{id:v,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[p,y]},k={tag:"defs",children:[{tag:"clipPath",attributes:{id:b},children:SY(d)},w]};return n.push(k,{tag:"rect",attributes:fe({fill:"currentColor","clip-path":"url(#".concat(b,")"),mask:"url(#".concat(v,")")},Tx)}),{children:n,attributes:i}}}},CY={provides(t){let e=!1;Il.matchMedia&&(e=Il.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){const n=[],i={fill:"currentColor"},r={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:fe(fe({},i),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});const s=fe(fe({},r),{},{attributeName:"opacity"}),o={tag:"circle",attributes:fe(fe({},i),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||o.children.push({tag:"animate",attributes:fe(fe({},r),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:fe(fe({},s),{},{values:"1;0;1;1;0;1;"})}),n.push(o),n.push({tag:"path",attributes:fe(fe({},i),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:fe(fe({},s),{},{values:"1;0;0;0;0;1;"})}]}),e||n.push({tag:"path",attributes:fe(fe({},i),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:fe(fe({},s),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},_Y={hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-symbol"),i=n===null?!1:n===""?!0:n;return t.symbol=i,t}}}},EY=[yK,cY,uY,dY,fY,bY,xY,wY,kY,CY,_Y];DK(EY,{mixoutsTo:$r});$r.noAuto;$r.config;$r.library;$r.dom;const L2=$r.parse;$r.findIconDefinition;$r.toHtml;const AY=$r.icon;$r.layer;$r.text;$r.counter;var _j={exports:{}},PY="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",NY=PY,MY=NY;function Ej(){}function Aj(){}Aj.resetWarningCache=Ej;var RY=function(){function t(i,r,s,o,a,l){if(l!==MY){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Aj,resetWarningCache:Ej};return n.PropTypes=n,n};_j.exports=RY();var IY=_j.exports;const yt=du(IY);function hR(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function so(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?hR(Object(n),!0).forEach(function(i){ad(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hR(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ry(t){"@babel/helpers - typeof";return ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ry(t)}function ad(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TY(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function OY(t,e){if(t==null)return{};var n=TY(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function D2(t){return LY(t)||DY(t)||jY(t)||BY()}function LY(t){if(Array.isArray(t))return j2(t)}function DY(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function jY(t,e){if(t){if(typeof t=="string")return j2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j2(t,e)}}function j2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function BY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Y(t){var e,n=t.beat,i=t.fade,r=t.beatFade,s=t.bounce,o=t.shake,a=t.flash,l=t.spin,c=t.spinPulse,u=t.spinReverse,d=t.pulse,f=t.fixedWidth,p=t.inverse,m=t.border,g=t.listItem,y=t.flip,v=t.size,b=t.rotation,w=t.pull,k=(e={"fa-beat":n,"fa-fade":i,"fa-beat-fade":r,"fa-bounce":s,"fa-shake":o,"fa-flash":a,"fa-spin":l,"fa-spin-reverse":u,"fa-spin-pulse":c,"fa-pulse":d,"fa-fw":f,"fa-inverse":p,"fa-border":m,"fa-li":g,"fa-flip":y===!0,"fa-flip-horizontal":y==="horizontal"||y==="both","fa-flip-vertical":y==="vertical"||y==="both"},ad(e,"fa-".concat(v),typeof v<"u"&&v!==null),ad(e,"fa-rotate-".concat(b),typeof b<"u"&&b!==null&&b!==0),ad(e,"fa-pull-".concat(w),typeof w<"u"&&w!==null),ad(e,"fa-swap-opacity",t.swapOpacity),e);return Object.keys(k).map(function(C){return k[C]?C:null}).filter(function(C){return C})}function FY(t){return t=t-0,t===t}function Pj(t){return FY(t)?t:(t=t.replace(/[\-_\s]+(.)?/g,function(e,n){return n?n.toUpperCase():""}),t.substr(0,1).toLowerCase()+t.substr(1))}var zY=["style"];function UY(t){return t.charAt(0).toUpperCase()+t.slice(1)}function VY(t){return t.split(";").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,n){var i=n.indexOf(":"),r=Pj(n.slice(0,i)),s=n.slice(i+1).trim();return r.startsWith("webkit")?e[UY(r)]=s:e[r]=s,e},{})}function Nj(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string")return e;var i=(e.children||[]).map(function(l){return Nj(t,l)}),r=Object.keys(e.attributes||{}).reduce(function(l,c){var u=e.attributes[c];switch(c){case"class":l.attrs.className=u,delete e.attributes.class;break;case"style":l.attrs.style=VY(u);break;default:c.indexOf("aria-")===0||c.indexOf("data-")===0?l.attrs[c.toLowerCase()]=u:l.attrs[Pj(c)]=u}return l},{attrs:{}}),s=n.style,o=s===void 0?{}:s,a=OY(n,zY);return r.attrs.style=so(so({},r.attrs.style),o),t.apply(void 0,[e.tag,so(so({},r.attrs),a)].concat(D2(i)))}var Mj=!1;try{Mj=!0}catch{}function HY(){if(!Mj&&console&&typeof console.error=="function"){var t;(t=console).error.apply(t,arguments)}}function pR(t){if(t&&ry(t)==="object"&&t.prefix&&t.iconName&&t.icon)return t;if(L2.icon)return L2.icon(t);if(t===null)return null;if(t&&ry(t)==="object"&&t.prefix&&t.iconName)return t;if(Array.isArray(t)&&t.length===2)return{prefix:t[0],iconName:t[1]};if(typeof t=="string")return{prefix:"fas",iconName:t}}function Ox(t,e){return Array.isArray(e)&&e.length>0||!Array.isArray(e)&&e?ad({},t,e):{}}var mR={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1},Qe=en.forwardRef(function(t,e){var n=so(so({},mR),t),i=n.icon,r=n.mask,s=n.symbol,o=n.className,a=n.title,l=n.titleId,c=n.maskId,u=pR(i),d=Ox("classes",[].concat(D2($Y(n)),D2((o||"").split(" ")))),f=Ox("transform",typeof n.transform=="string"?L2.transform(n.transform):n.transform),p=Ox("mask",pR(r)),m=AY(u,so(so(so(so({},d),f),p),{},{symbol:s,title:a,titleId:l,maskId:c}));if(!m)return HY("Could not find icon",u),null;var g=m.abstract,y={ref:e};return Object.keys(n).forEach(function(v){mR.hasOwnProperty(v)||(y[v]=n[v])}),WY(g[0],y)});Qe.displayName="FontAwesomeIcon";Qe.propTypes={beat:yt.bool,border:yt.bool,beatFade:yt.bool,bounce:yt.bool,className:yt.string,fade:yt.bool,flash:yt.bool,mask:yt.oneOfType([yt.object,yt.array,yt.string]),maskId:yt.string,fixedWidth:yt.bool,inverse:yt.bool,flip:yt.oneOf([!0,!1,"horizontal","vertical","both"]),icon:yt.oneOfType([yt.object,yt.array,yt.string]),listItem:yt.bool,pull:yt.oneOf(["right","left"]),pulse:yt.bool,rotation:yt.oneOf([0,90,180,270]),shake:yt.bool,size:yt.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:yt.bool,spinPulse:yt.bool,spinReverse:yt.bool,symbol:yt.oneOfType([yt.bool,yt.string]),title:yt.string,titleId:yt.string,transform:yt.oneOfType([yt.string,yt.object]),swapOpacity:yt.bool};var WY=Nj.bind(null,en.createElement);function Rj(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=Rj(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function re(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=Rj(t))&&(i&&(i+=" "),i+=e);return i}/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const GY={prefix:"fas",iconName:"forward-step",icon:[320,512,["step-forward"],"f051","M52.5 440.6c-9.5 7.9-22.8 9.7-34.1 4.4S0 428.4 0 416L0 96C0 83.6 7.2 72.3 18.4 67s24.5-3.6 34.1 4.4l192 160L256 241l0-145c0-17.7 14.3-32 32-32s32 14.3 32 32l0 320c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-145-11.5 9.6-192 160z"]},Y_=GY,wd={prefix:"fas",iconName:"lightbulb",icon:[384,512,[128161],"f0eb","M272 384c9.6-31.9 29.5-59.1 49.2-86.2c0 0 0 0 0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4c0 0 0 0 0 0c19.8 27.1 39.7 54.4 49.2 86.2l160 0zM192 512c44.2 0 80-35.8 80-80l0-16-160 0 0 16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"]},XY={prefix:"fas",iconName:"compress",icon:[448,512,[],"f066","M160 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96zM32 320c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM352 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 320c-17.7 0-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0z"]},qY={prefix:"fas",iconName:"user",icon:[448,512,[128100,62144],"f007","M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512l388.6 0c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304l-91.4 0z"]},KY={prefix:"fas",iconName:"star",icon:[576,512,[11088,61446],"f005","M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z"]},gR={prefix:"fas",iconName:"microchip",icon:[512,512,[],"f2db","M176 24c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40c-35.3 0-64 28.7-64 64l-40 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l40 0 0 56-40 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l40 0 0 56-40 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l40 0c0 35.3 28.7 64 64 64l0 40c0 13.3 10.7 24 24 24s24-10.7 24-24l0-40 56 0 0 40c0 13.3 10.7 24 24 24s24-10.7 24-24l0-40 56 0 0 40c0 13.3 10.7 24 24 24s24-10.7 24-24l0-40c35.3 0 64-28.7 64-64l40 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-40 0 0-56 40 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-40 0 0-56 40 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-40 0c0-35.3-28.7-64-64-64l0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40-56 0 0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40-56 0 0-40zM160 128l192 0c17.7 0 32 14.3 32 32l0 192c0 17.7-14.3 32-32 32l-192 0c-17.7 0-32-14.3-32-32l0-192c0-17.7 14.3-32 32-32zm192 32l-192 0 0 192 192 0 0-192z"]},YY={prefix:"fas",iconName:"rotate-left",icon:[512,512,["rotate-back","rotate-backward","undo-alt"],"f2ea","M48.5 224L40 224c-13.3 0-24-10.7-24-24L16 72c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2L98.6 96.6c87.6-86.5 228.7-86.2 315.8 1c87.5 87.5 87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3c-62.2-62.2-162.7-62.5-225.3-1L185 183c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8L48.5 224z"]},JY={prefix:"fas",iconName:"circle-check",icon:[512,512,[61533,"check-circle"],"f058","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"]},Ij=JY,Jh={prefix:"fas",iconName:"pause",icon:[320,512,[9208],"f04c","M48 64C21.5 64 0 85.5 0 112L0 400c0 26.5 21.5 48 48 48l32 0c26.5 0 48-21.5 48-48l0-288c0-26.5-21.5-48-48-48L48 64zm192 0c-26.5 0-48 21.5-48 48l0 288c0 26.5 21.5 48 48 48l32 0c26.5 0 48-21.5 48-48l0-288c0-26.5-21.5-48-48-48l-32 0z"]},ZY={prefix:"fas",iconName:"arrows-rotate",icon:[512,512,[128472,"refresh","sync"],"f021","M105.1 202.6c7.7-21.8 20.2-42.3 37.8-59.8c62.5-62.5 163.8-62.5 226.3 0L386.3 160 352 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l111.5 0c0 0 0 0 0 0l.4 0c17.7 0 32-14.3 32-32l0-112c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 35.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5zM39 289.3c-5 1.5-9.8 4.2-13.7 8.2c-4 4-6.7 8.8-8.1 14c-.3 1.2-.6 2.5-.8 3.8c-.3 1.7-.4 3.4-.4 5.1L16 432c0 17.7 14.3 32 32 32s32-14.3 32-32l0-35.1 17.6 17.5c0 0 0 0 0 0c87.5 87.4 229.3 87.4 316.7 0c24.4-24.4 42.1-53.1 52.9-83.8c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.5 62.5-163.8 62.5-226.3 0l-.1-.1L125.6 352l34.4 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L48.4 288c-1.6 0-3.2 .1-4.8 .3s-3.1 .5-4.6 1z"]},QY=ZY,eJ={prefix:"fas",iconName:"chart-line",icon:[512,512,["line-chart"],"f201","M64 64c0-17.7-14.3-32-32-32S0 46.3 0 64L0 400c0 44.2 35.8 80 80 80l400 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L80 416c-8.8 0-16-7.2-16-16L64 64zm406.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L320 210.7l-57.4-57.4c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L240 221.3l57.4 57.4c12.5 12.5 32.8 12.5 45.3 0l128-128z"]},tJ={prefix:"fas",iconName:"circle-question",icon:[512,512,[62108,"question-circle"],"f059","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM169.8 165.3c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"]},nJ=tJ,iJ={prefix:"fas",iconName:"arrow-rotate-right",icon:[512,512,[8635,"arrow-right-rotate","arrow-rotate-forward","redo"],"f01e","M386.3 160L336 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l128 0c17.7 0 32-14.3 32-32l0-128c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 51.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0s-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3s163.8-62.5 226.3 0L386.3 160z"]},Tj=iJ,rJ={prefix:"fas",iconName:"circle-info",icon:[512,512,["info-circle"],"f05a","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336l24 0 0-64-24 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l48 0c13.3 0 24 10.7 24 24l0 88 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-80 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"]},Oj=rJ,sJ={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29l0-320c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241 64 96c0-17.7-14.3-32-32-32S0 78.3 0 96L0 416c0 17.7 14.3 32 32 32s32-14.3 32-32l0-145 11.5 9.6 192 160z"]},Lj=sJ,oJ={prefix:"fas",iconName:"download",icon:[512,512,[],"f019","M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 242.7-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7 288 32zM64 352c-35.3 0-64 28.7-64 64l0 32c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-32c0-35.3-28.7-64-64-64l-101.5 0-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352 64 352zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"]},Bb={prefix:"fas",iconName:"play",icon:[384,512,[9654],"f04b","M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80L0 432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"]},aJ={prefix:"fas",iconName:"expand",icon:[448,512,[],"f065","M32 32C14.3 32 0 46.3 0 64l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L32 32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96z"]},lJ={prefix:"fas",iconName:"xmark",icon:[384,512,[128473,10005,10006,10060,215,"close","multiply","remove","times"],"f00d","M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"]},$b=lJ,J_={prefix:"fas",iconName:"rocket",icon:[512,512,[],"f135","M156.6 384.9L125.7 354c-8.5-8.5-11.5-20.8-7.7-32.2c3-8.9 7-20.5 11.8-33.8L24 288c-8.6 0-16.6-4.6-20.9-12.1s-4.2-16.7 .2-24.1l52.5-88.5c13-21.9 36.5-35.3 61.9-35.3l82.3 0c2.4-4 4.8-7.7 7.2-11.3C289.1-4.1 411.1-8.1 483.9 5.3c11.6 2.1 20.6 11.2 22.8 22.8c13.4 72.9 9.3 194.8-111.4 276.7c-3.5 2.4-7.3 4.8-11.3 7.2l0 82.3c0 25.4-13.4 49-35.3 61.9l-88.5 52.5c-7.4 4.4-16.6 4.5-24.1 .2s-12.1-12.2-12.1-20.9l0-107.2c-14.1 4.9-26.4 8.9-35.7 11.9c-11.2 3.6-23.4 .5-31.8-7.8zM384 168a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"]},cJ={prefix:"fas",iconName:"chevron-left",icon:[320,512,[9001],"f053","M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"]},uJ={prefix:"fas",iconName:"chevron-right",icon:[320,512,[9002],"f054","M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"]},Z_={prefix:"fas",iconName:"trophy",icon:[576,512,[127942],"f091","M400 0L176 0c-26.5 0-48.1 21.8-47.1 48.2c.2 5.3 .4 10.6 .7 15.8L24 64C10.7 64 0 74.7 0 88c0 92.6 33.5 157 78.5 200.7c44.3 43.1 98.3 64.8 138.1 75.8c23.4 6.5 39.4 26 39.4 45.6c0 20.9-17 37.9-37.9 37.9L192 448c-17.7 0-32 14.3-32 32s14.3 32 32 32l192 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-26.1 0C337 448 320 431 320 410.1c0-19.6 15.9-39.2 39.4-45.6c39.9-11 93.9-32.7 138.2-75.8C542.5 245 576 180.6 576 88c0-13.3-10.7-24-24-24L446.4 64c.3-5.2 .5-10.4 .7-15.8C448.1 21.8 426.5 0 400 0zM48.9 112l84.4 0c9.1 90.1 29.2 150.3 51.9 190.6c-24.9-11-50.8-26.5-73.2-48.3c-32-31.1-58-76-63-142.3zM464.1 254.3c-22.4 21.8-48.3 37.3-73.2 48.3c22.7-40.3 42.8-100.5 51.9-190.6l84.4 0c-5.1 66.3-31.1 111.2-63 142.3z"]},Dj={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},dJ={prefix:"fas",iconName:"gears",icon:[640,512,["cogs"],"f085","M308.5 135.3c7.1-6.3 9.9-16.2 6.2-25c-2.3-5.3-4.8-10.5-7.6-15.5L304 89.4c-3-5-6.3-9.9-9.8-14.6c-5.7-7.6-15.7-10.1-24.7-7.1l-28.2 9.3c-10.7-8.8-23-16-36.2-20.9L199 27.1c-1.9-9.3-9.1-16.7-18.5-17.8C173.9 8.4 167.2 8 160.4 8l-.7 0c-6.8 0-13.5 .4-20.1 1.2c-9.4 1.1-16.6 8.6-18.5 17.8L115 56.1c-13.3 5-25.5 12.1-36.2 20.9L50.5 67.8c-9-3-19-.5-24.7 7.1c-3.5 4.7-6.8 9.6-9.9 14.6l-3 5.3c-2.8 5-5.3 10.2-7.6 15.6c-3.7 8.7-.9 18.6 6.2 25l22.2 19.8C32.6 161.9 32 168.9 32 176s.6 14.1 1.7 20.9L11.5 216.7c-7.1 6.3-9.9 16.2-6.2 25c2.3 5.3 4.8 10.5 7.6 15.6l3 5.2c3 5.1 6.3 9.9 9.9 14.6c5.7 7.6 15.7 10.1 24.7 7.1l28.2-9.3c10.7 8.8 23 16 36.2 20.9l6.1 29.1c1.9 9.3 9.1 16.7 18.5 17.8c6.7 .8 13.5 1.2 20.4 1.2s13.7-.4 20.4-1.2c9.4-1.1 16.6-8.6 18.5-17.8l6.1-29.1c13.3-5 25.5-12.1 36.2-20.9l28.2 9.3c9 3 19 .5 24.7-7.1c3.5-4.7 6.8-9.5 9.8-14.6l3.1-5.4c2.8-5 5.3-10.2 7.6-15.5c3.7-8.7 .9-18.6-6.2-25l-22.2-19.8c1.1-6.8 1.7-13.8 1.7-20.9s-.6-14.1-1.7-20.9l22.2-19.8zM112 176a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zM504.7 500.5c6.3 7.1 16.2 9.9 25 6.2c5.3-2.3 10.5-4.8 15.5-7.6l5.4-3.1c5-3 9.9-6.3 14.6-9.8c7.6-5.7 10.1-15.7 7.1-24.7l-9.3-28.2c8.8-10.7 16-23 20.9-36.2l29.1-6.1c9.3-1.9 16.7-9.1 17.8-18.5c.8-6.7 1.2-13.5 1.2-20.4s-.4-13.7-1.2-20.4c-1.1-9.4-8.6-16.6-17.8-18.5L583.9 307c-5-13.3-12.1-25.5-20.9-36.2l9.3-28.2c3-9 .5-19-7.1-24.7c-4.7-3.5-9.6-6.8-14.6-9.9l-5.3-3c-5-2.8-10.2-5.3-15.6-7.6c-8.7-3.7-18.6-.9-25 6.2l-19.8 22.2c-6.8-1.1-13.8-1.7-20.9-1.7s-14.1 .6-20.9 1.7l-19.8-22.2c-6.3-7.1-16.2-9.9-25-6.2c-5.3 2.3-10.5 4.8-15.6 7.6l-5.2 3c-5.1 3-9.9 6.3-14.6 9.9c-7.6 5.7-10.1 15.7-7.1 24.7l9.3 28.2c-8.8 10.7-16 23-20.9 36.2L315.1 313c-9.3 1.9-16.7 9.1-17.8 18.5c-.8 6.7-1.2 13.5-1.2 20.4s.4 13.7 1.2 20.4c1.1 9.4 8.6 16.6 17.8 18.5l29.1 6.1c5 13.3 12.1 25.5 20.9 36.2l-9.3 28.2c-3 9-.5 19 7.1 24.7c4.7 3.5 9.5 6.8 14.6 9.8l5.4 3.1c5 2.8 10.2 5.3 15.5 7.6c8.7 3.7 18.6 .9 25-6.2l19.8-22.2c6.8 1.1 13.8 1.7 20.9 1.7s14.1-.6 20.9-1.7l19.8 22.2zM464 304a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"]},vR=dJ,fJ={prefix:"fas",iconName:"infinity",icon:[640,512,[8734,9854],"f534","M0 241.1C0 161 65 96 145.1 96c38.5 0 75.4 15.3 102.6 42.5L320 210.7l72.2-72.2C419.5 111.3 456.4 96 494.9 96C575 96 640 161 640 241.1l0 29.7C640 351 575 416 494.9 416c-38.5 0-75.4-15.3-102.6-42.5L320 301.3l-72.2 72.2C220.5 400.7 183.6 416 145.1 416C65 416 0 351 0 270.9l0-29.7zM274.7 256l-72.2-72.2c-15.2-15.2-35.9-23.8-57.4-23.8C100.3 160 64 196.3 64 241.1l0 29.7c0 44.8 36.3 81.1 81.1 81.1c21.5 0 42.2-8.5 57.4-23.8L274.7 256zm90.5 0l72.2 72.2c15.2 15.2 35.9 23.8 57.4 23.8c44.8 0 81.1-36.3 81.1-81.1l0-29.7c0-44.8-36.3-81.1-81.1-81.1c-21.5 0-42.2 8.5-57.4 23.8L365.3 256z"]},hJ={prefix:"fas",iconName:"book",icon:[448,512,[128212],"f02d","M96 0C43 0 0 43 0 96L0 416c0 53 43 96 96 96l288 0 32 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l0-64c17.7 0 32-14.3 32-32l0-320c0-17.7-14.3-32-32-32L384 0 96 0zm0 384l256 0 0 64L96 448c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16l192 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-192 0c-8.8 0-16-7.2-16-16zm16 48l192 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-192 0c-8.8 0-16-7.2-16-16s7.2-16 16-16z"]},pJ={prefix:"fas",iconName:"check",icon:[448,512,[10003,10004],"f00c","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"]},mJ={prefix:"fas",iconName:"triangle-exclamation",icon:[512,512,[9888,"exclamation-triangle","warning"],"f071","M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480L40 480c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24l0 112c0 13.3 10.7 24 24 24s24-10.7 24-24l0-112c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"]},gJ=mJ,vJ={prefix:"fas",iconName:"database",icon:[448,512,[],"f1c0","M448 80l0 48c0 44.2-100.3 80-224 80S0 172.2 0 128L0 80C0 35.8 100.3 0 224 0S448 35.8 448 80zM393.2 214.7c20.8-7.4 39.9-16.9 54.8-28.6L448 288c0 44.2-100.3 80-224 80S0 332.2 0 288L0 186.1c14.9 11.8 34 21.2 54.8 28.6C99.7 230.7 159.5 240 224 240s124.3-9.3 169.2-25.3zM0 346.1c14.9 11.8 34 21.2 54.8 28.6C99.7 390.7 159.5 400 224 400s124.3-9.3 169.2-25.3c20.8-7.4 39.9-16.9 54.8-28.6l0 85.9c0 44.2-100.3 80-224 80S0 476.2 0 432l0-85.9z"]},Rm={prefix:"fas",iconName:"graduation-cap",icon:[640,512,[127891,"mortar-board"],"f19d","M320 32c-8.1 0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9 0 149.9 0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9l0 28.1c0 28.4-10.8 57.7-22.3 80.8c-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3 .9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7 .3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7C90.3 344.3 86 329.8 80 316.5l0-24.6c0-30.2 10.2-58.7 27.9-81.5c12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5 .8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1L624.2 182.6c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32zM128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6 354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6L143.3 262.6 128 408z"]},jj={default:"bg-stone-800 text-white hover:bg-stone-700 focus:ring-stone-500",destructive:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"border border-stone-600 bg-transparent text-white hover:bg-stone-800 focus:ring-stone-500",secondary:"bg-stone-700 text-white hover:bg-stone-600 focus:ring-stone-500",ghost:"bg-transparent text-stone-300 hover:bg-stone-800 hover:text-white focus:ring-stone-500",link:"bg-transparent text-mantis-400 hover:text-mantis-300 hover:underline focus:ring-mantis-500",primary:"bg-mantis-600 text-white hover:bg-mantis-700 focus:ring-mantis-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500",warning:"bg-yellow-600 text-white hover:bg-yellow-700 focus:ring-yellow-500",error:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"},yJ={sm:"h-8 px-3 text-xs",md:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base",xl:"h-14 px-8 text-lg"},At=x.memo(x.forwardRef(({variant:t="default",size:e="md",isLoading:n=!1,loadingText:i,leftIcon:r,rightIcon:s,disabled:o=!1,fullWidth:a=!1,className:l,children:c,onClick:u,type:d="button","aria-label":f,title:p,...m},g)=>{const y=o||n;return h.jsxs("button",{ref:g,type:d,disabled:y,onClick:u,"aria-label":f,title:p,className:re("inline-flex items-center justify-center gap-2 rounded-lg font-medium transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-stone-900","disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50","hover:scale-105 active:scale-95",jj[t],yJ[e],a&&"w-full",l),...m,children:[n&&h.jsx(Qe,{icon:Dj,className:"animate-spin","aria-hidden":"true"}),!n&&r&&h.jsx("span",{className:"flex items-center","aria-hidden":"true",children:r}),h.jsx("span",{children:n&&i?i:c}),!n&&s&&h.jsx("span",{className:"flex items-center","aria-hidden":"true",children:s})]})}));At.displayName="Button";const K0=x.memo(x.forwardRef(({icon:t,variant:e="ghost",size:n="md",isLoading:i=!1,disabled:r=!1,className:s,onClick:o,"aria-label":a,title:l,...c},u)=>{const d=r||i,f={sm:"size-8",md:"size-10",lg:"size-12",xl:"size-14"};return h.jsx("button",{ref:u,disabled:d,onClick:o,"aria-label":a,title:l,className:re("inline-flex items-center justify-center rounded-lg transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-stone-900","disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50","hover:scale-105 active:scale-95",jj[e],f[n],s),...c,children:i?h.jsx(Qe,{icon:Dj,className:"animate-spin","aria-hidden":"true"}):h.jsx("span",{className:"flex items-center justify-center","aria-hidden":"true",children:t})})}));K0.displayName="IconButton";const bJ=x.memo(({children:t,orientation:e="horizontal",className:n})=>h.jsx("div",{className:re("inline-flex",e==="horizontal"?"flex-row":"flex-col",n),role:"group",children:t}));bJ.displayName="ButtonGroup";const Bj={top:"bottom-full left-1/2 transform -translate-x-1/2 mb-2",bottom:"top-full left-1/2 transform -translate-x-1/2 mt-2",left:"right-full top-1/2 transform -translate-y-1/2 mr-2",right:"left-full top-1/2 transform -translate-y-1/2 ml-2","top-start":"bottom-full left-0 mb-2","top-end":"bottom-full right-0 mb-2","bottom-start":"top-full left-0 mt-2","bottom-end":"top-full right-0 mt-2"},$j={top:"top-full left-1/2 transform -translate-x-1/2 border-t-stone-800",bottom:"bottom-full left-1/2 transform -translate-x-1/2 border-b-stone-800",left:"left-full top-1/2 transform -translate-y-1/2 border-l-stone-800",right:"right-full top-1/2 transform -translate-y-1/2 border-r-stone-800","top-start":"top-full left-4 border-t-stone-800","top-end":"top-full right-4 border-t-stone-800","bottom-start":"bottom-full left-4 border-b-stone-800","bottom-end":"bottom-full right-4 border-b-stone-800"},ss=x.memo(({content:t,children:e,position:n="top",delay:i=200,className:r,maxWidth:s=300,showArrow:o=!0,disabled:a=!1})=>{const[l,c]=x.useState(!1),[u,d]=x.useState(n),f=x.useRef(null),p=x.useRef(null),m=x.useRef(),g=x.useCallback(()=>{a||(document.body.classList.add("tooltip-open"),m.current=setTimeout(()=>{c(!0)},i))},[a,i]),y=x.useCallback(()=>{m.current&&clearTimeout(m.current),document.body.classList.remove("tooltip-open"),c(!1)},[]);return x.useEffect(()=>{if(!l||!p.current||!f.current)return;const v=p.current,w=f.current.getBoundingClientRect(),k=v.getBoundingClientRect();let C=n;w.left+k.width>window.innerWidth&&(n.includes("right")?C="left":n.includes("top")?C="top-end":n.includes("bottom")&&(C="bottom-end")),w.left-k.width<0&&(n.includes("left")?C="right":n.includes("top")?C="top-start":n.includes("bottom")&&(C="bottom-start")),w.top-k.height<0&&n.includes("top")&&(C="bottom"),w.bottom+k.height>window.innerHeight&&n.includes("bottom")&&(C="top"),d(C)},[l,n]),h.jsxs("div",{ref:f,className:re("relative inline-block",r),onMouseEnter:g,onMouseLeave:y,onFocus:g,onBlur:y,children:[e,l&&h.jsxs("div",{ref:p,className:re("absolute z-50 rounded-lg border border-stone-600 bg-stone-800 px-4 py-3 text-sm text-white shadow-lg","animate-fade-in",Bj[u]),style:{maxWidth:`${s}px`,minWidth:"200px"},role:"tooltip",children:[t,o&&h.jsx("div",{className:re("absolute size-0 border-4 border-transparent",$j[u])})]})]})});ss.displayName="Tooltip";const xJ=x.memo(({content:t,className:e,size:n="md"})=>{const i={sm:"size-3",md:"size-4",lg:"size-5"};return h.jsx(ss,{content:t,className:e,children:h.jsx(Qe,{icon:Oj,className:re("cursor-help text-stone-400 transition-colors hover:text-stone-300",i[n])})})});xJ.displayName="InfoTooltip";const wJ=x.memo(({content:t,trigger:e,position:n="top",delay:i=200,className:r,maxWidth:s=300,showArrow:o=!0,disabled:a=!1})=>{const[l,c]=x.useState(!1),u=x.useRef(null),d=x.useRef(null),f=x.useRef(),p=x.useCallback(()=>{a||(f.current=setTimeout(()=>{c(!0)},i))},[a,i]),m=x.useCallback(()=>{f.current&&clearTimeout(f.current),c(!1)},[]);return h.jsxs("div",{ref:u,className:re("relative inline-block",r),onMouseEnter:p,onMouseLeave:m,onFocus:p,onBlur:m,children:[e,l&&h.jsxs("div",{ref:d,className:re("absolute z-50 rounded-lg border border-stone-600 bg-stone-800 px-4 py-3 text-sm text-white shadow-lg","animate-fade-in",Bj[n]),style:{maxWidth:`${s}px`,minWidth:"200px"},role:"tooltip",children:[t,o&&h.jsx("div",{className:re("absolute size-0 border-4 border-transparent",$j[n])})]})]})});wJ.displayName="CustomTooltip";function Fj(t,e){const n=e.split(".");let i=t;for(const r of n)if(r in i)i=i[r];else throw new ReferenceError(`Couldn't find path "${e}".`);return i}const zj=["en","es"];function Q_(t){return function(n,i,...r){const s=Fj(t[n],i);if(typeof s=="function")return s(...r);if(typeof s=="string")return s;throw new Error(`Missing translation for key ${i}`)}}const eE={},SJ=Symbol((eE?"production":void 0)!=="production"?"RESET":""),Uj=t=>typeof(t==null?void 0:t.then)=="function";function kJ(t=()=>{try{return window.localStorage}catch(n){(eE?"production":void 0)!=="production"&&typeof window<"u"&&console.warn(n);return}},e){var n;let i,r;const s={getItem:(l,c)=>{var u,d;const f=m=>{if(m=m||"",i!==m){try{r=JSON.parse(m,e==null?void 0:e.reviver)}catch{return c}i=m}return r},p=(d=(u=t())==null?void 0:u.getItem(l))!=null?d:null;return Uj(p)?p.then(f):f(p)},setItem:(l,c)=>{var u;return(u=t())==null?void 0:u.setItem(l,JSON.stringify(c,void 0))},removeItem:l=>{var c;return(c=t())==null?void 0:c.removeItem(l)}},o=l=>(c,u,d)=>l(c,f=>{let p;try{p=JSON.parse(f||"")}catch{p=d}u(p)});let a;try{a=(n=t())==null?void 0:n.subscribe}catch{}return!a&&typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(a=(l,c)=>{if(!(t()instanceof window.Storage))return()=>{};const u=d=>{d.storageArea===t()&&d.key===l&&c(d.newValue)};return window.addEventListener("storage",u),()=>{window.removeEventListener("storage",u)}}),a&&(s.subscribe=o(a)),s}const CJ=kJ();function Vj(t,e,n=CJ,i){const r=i==null?void 0:i.getOnInit,s=me(r?n.getItem(t,e):e);return(eE?"production":void 0)!=="production"&&(s.debugPrivate=!0),s.onMount=a=>{a(n.getItem(t,e));let l;return n.subscribe&&(l=n.subscribe(t,a,e)),l},me(a=>a(s),(a,l,c)=>{const u=typeof c=="function"?c(a(s)):c;return u===SJ?(l(s,e),n.removeItem(t)):Uj(u)?u.then(d=>(l(s,d),n.setItem(t,d))):(l(s,u),n.setItem(t,u))})}const A=j_();function Hj(t){return h.jsx(JX,{store:A,children:t.children})}const _J=Object.freeze(Object.defineProperty({__proto__:null,JotaiProvider:Hj,store:A},Symbol.toStringTag,{value:"Module"}));var Tt;(function(t){t.assertEqual=r=>{};function e(r){}t.assertIs=e;function n(r){throw new Error}t.assertNever=n,t.arrayToEnum=r=>{const s={};for(const o of r)s[o]=o;return s},t.getValidEnumValues=r=>{const s=t.objectKeys(r).filter(a=>typeof r[r[a]]!="number"),o={};for(const a of s)o[a]=r[a];return t.objectValues(o)},t.objectValues=r=>t.objectKeys(r).map(function(s){return r[s]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const s=[];for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&s.push(o);return s},t.find=(r,s)=>{for(const o of r)if(s(o))return o},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function i(r,s=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}t.joinValues=i,t.jsonStringifyReplacer=(r,s)=>typeof s=="bigint"?s.toString():s})(Tt||(Tt={}));var yR;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(yR||(yR={}));const je=Tt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Fa=t=>{switch(typeof t){case"undefined":return je.undefined;case"string":return je.string;case"number":return Number.isNaN(t)?je.nan:je.number;case"boolean":return je.boolean;case"function":return je.function;case"bigint":return je.bigint;case"symbol":return je.symbol;case"object":return Array.isArray(t)?je.array:t===null?je.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?je.promise:typeof Map<"u"&&t instanceof Map?je.map:typeof Set<"u"&&t instanceof Set?je.set:typeof Date<"u"&&t instanceof Date?je.date:je.object;default:return je.unknown}},ge=Tt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ga extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(s){return s.message},i={_errors:[]},r=s=>{for(const o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)i._errors.push(n(o));else{let a=i,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(n(o))):a[c]=a[c]||{_errors:[]},a=a[c],l++}}};return r(this),i}static assert(e){if(!(e instanceof ga))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Tt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},i=[];for(const r of this.issues)if(r.path.length>0){const s=r.path[0];n[s]=n[s]||[],n[s].push(e(r))}else i.push(e(r));return{formErrors:i,fieldErrors:n}}get formErrors(){return this.flatten()}}ga.create=t=>new ga(t);const B2=(t,e)=>{let n;switch(t.code){case ge.invalid_type:t.received===je.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ge.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Tt.jsonStringifyReplacer)}`;break;case ge.unrecognized_keys:n=`Unrecognized key(s) in object: ${Tt.joinValues(t.keys,", ")}`;break;case ge.invalid_union:n="Invalid input";break;case ge.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Tt.joinValues(t.options)}`;break;case ge.invalid_enum_value:n=`Invalid enum value. Expected ${Tt.joinValues(t.options)}, received '${t.received}'`;break;case ge.invalid_arguments:n="Invalid function arguments";break;case ge.invalid_return_type:n="Invalid function return type";break;case ge.invalid_date:n="Invalid date";break;case ge.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Tt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ge.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ge.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ge.custom:n="Invalid input";break;case ge.invalid_intersection_types:n="Intersection results could not be merged";break;case ge.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ge.not_finite:n="Number must be finite";break;default:n=e.defaultError,Tt.assertNever(t)}return{message:n}};let EJ=B2;function AJ(){return EJ}const PJ=t=>{const{data:e,path:n,errorMaps:i,issueData:r}=t,s=[...n,...r.path||[]],o={...r,path:s};if(r.message!==void 0)return{...r,path:s,message:r.message};let a="";const l=i.filter(c=>!!c).slice().reverse();for(const c of l)a=c(o,{data:e,defaultError:a}).message;return{...r,path:s,message:a}};function Ee(t,e){const n=AJ(),i=PJ({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===B2?void 0:B2].filter(r=>!!r)});t.common.issues.push(i)}class Lr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const i=[];for(const r of n){if(r.status==="aborted")return at;r.status==="dirty"&&e.dirty(),i.push(r.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,n){const i=[];for(const r of n){const s=await r.key,o=await r.value;i.push({key:s,value:o})}return Lr.mergeObjectSync(e,i)}static mergeObjectSync(e,n){const i={};for(const r of n){const{key:s,value:o}=r;if(s.status==="aborted"||o.status==="aborted")return at;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(i[s.value]=o.value)}return{status:e.value,value:i}}}const at=Object.freeze({status:"aborted"}),_h=t=>({status:"dirty",value:t}),ps=t=>({status:"valid",value:t}),bR=t=>t.status==="aborted",xR=t=>t.status==="dirty",ef=t=>t.status==="valid",sy=t=>typeof Promise<"u"&&t instanceof Promise;var Fe;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Fe||(Fe={}));class Ll{constructor(e,n,i,r){this._cachedPath=[],this.parent=e,this.data=n,this._path=i,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const wR=(t,e)=>{if(ef(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new ga(t.common.issues);return this._error=n,this._error}}};function vt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:i,description:r}=t;if(e&&(n||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,a)=>{const{message:l}=t;return o.code==="invalid_enum_value"?{message:l??a.defaultError}:typeof a.data>"u"?{message:l??i??a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:l??n??a.defaultError}},description:r}}class Rt{get description(){return this._def.description}_getType(e){return Fa(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Fa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Lr,ctx:{common:e.parent.common,data:e.data,parsedType:Fa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(sy(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const i=this.safeParse(e,n);if(i.success)return i.data;throw i.error}safeParse(e,n){const i={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Fa(e)},r=this._parseSync({data:e,path:i.path,parent:i});return wR(i,r)}"~validate"(e){var i,r;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Fa(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:n});return ef(s)?{value:s.value}:{issues:n.common.issues}}catch(s){(r=(i=s==null?void 0:s.message)==null?void 0:i.toLowerCase())!=null&&r.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(s=>ef(s)?{value:s.value}:{issues:n.common.issues})}async parseAsync(e,n){const i=await this.safeParseAsync(e,n);if(i.success)return i.data;throw i.error}async safeParseAsync(e,n){const i={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Fa(e)},r=this._parse({data:e,path:i.path,parent:i}),s=await(sy(r)?r:Promise.resolve(r));return wR(i,s)}refine(e,n){const i=r=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(r):n;return this._refinement((r,s)=>{const o=e(r),a=()=>s.addIssue({code:ge.custom,...i(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((i,r)=>e(i)?!0:(r.addIssue(typeof n=="function"?n(i,r):n),!1))}_refinement(e){return new rf({schema:this,typeName:lt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Cl.create(this,this._def)}nullable(){return sf.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Co.create(this)}promise(){return cy.create(this,this._def)}or(e){return ay.create([this,e],this._def)}and(e){return ly.create(this,e,this._def)}transform(e){return new rf({...vt(this._def),schema:this,typeName:lt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new U2({...vt(this._def),innerType:this,defaultValue:n,typeName:lt.ZodDefault})}brand(){return new JJ({typeName:lt.ZodBranded,type:this,...vt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new V2({...vt(this._def),innerType:this,catchValue:n,typeName:lt.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return tE.create(this,e)}readonly(){return H2.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const NJ=/^c[^\s-]{8,}$/i,MJ=/^[0-9a-z]+$/,RJ=/^[0-9A-HJKMNP-TV-Z]{26}$/i,IJ=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,TJ=/^[a-z0-9_-]{21}$/i,OJ=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,LJ=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,DJ=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,jJ="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Lx;const BJ=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,$J=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,FJ=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,zJ=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,UJ=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,VJ=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Wj="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",HJ=new RegExp(`^${Wj}$`);function Gj(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function WJ(t){return new RegExp(`^${Gj(t)}$`)}function GJ(t){let e=`${Wj}T${Gj(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function XJ(t,e){return!!((e==="v4"||!e)&&BJ.test(t)||(e==="v6"||!e)&&FJ.test(t))}function qJ(t,e){if(!OJ.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const i=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),r=JSON.parse(atob(i));return!(typeof r!="object"||r===null||"typ"in r&&(r==null?void 0:r.typ)!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function KJ(t,e){return!!((e==="v4"||!e)&&$J.test(t)||(e==="v6"||!e)&&zJ.test(t))}class Lc extends Rt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==je.string){const s=this._getOrReturnCtx(e);return Ee(s,{code:ge.invalid_type,expected:je.string,received:s.parsedType}),at}const i=new Lr;let r;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(r=this._getOrReturnCtx(e,r),Ee(r,{code:ge.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="max")e.data.length>s.value&&(r=this._getOrReturnCtx(e,r),Ee(r,{code:ge.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="length"){const o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(r=this._getOrReturnCtx(e,r),o?Ee(r,{code:ge.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&Ee(r,{code:ge.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),i.dirty())}else if(s.kind==="email")DJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"email",code:ge.invalid_string,message:s.message}),i.dirty());else if(s.kind==="emoji")Lx||(Lx=new RegExp(jJ,"u")),Lx.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"emoji",code:ge.invalid_string,message:s.message}),i.dirty());else if(s.kind==="uuid")IJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"uuid",code:ge.invalid_string,message:s.message}),i.dirty());else if(s.kind==="nanoid")TJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"nanoid",code:ge.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid")NJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"cuid",code:ge.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid2")MJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"cuid2",code:ge.invalid_string,message:s.message}),i.dirty());else if(s.kind==="ulid")RJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"ulid",code:ge.invalid_string,message:s.message}),i.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),Ee(r,{validation:"url",code:ge.invalid_string,message:s.message}),i.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"regex",code:ge.invalid_string,message:s.message}),i.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:ge.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),i.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:ge.invalid_string,validation:{startsWith:s.value},message:s.message}),i.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:ge.invalid_string,validation:{endsWith:s.value},message:s.message}),i.dirty()):s.kind==="datetime"?GJ(s).test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:ge.invalid_string,validation:"datetime",message:s.message}),i.dirty()):s.kind==="date"?HJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:ge.invalid_string,validation:"date",message:s.message}),i.dirty()):s.kind==="time"?WJ(s).test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:ge.invalid_string,validation:"time",message:s.message}),i.dirty()):s.kind==="duration"?LJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"duration",code:ge.invalid_string,message:s.message}),i.dirty()):s.kind==="ip"?XJ(e.data,s.version)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"ip",code:ge.invalid_string,message:s.message}),i.dirty()):s.kind==="jwt"?qJ(e.data,s.alg)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"jwt",code:ge.invalid_string,message:s.message}),i.dirty()):s.kind==="cidr"?KJ(e.data,s.version)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"cidr",code:ge.invalid_string,message:s.message}),i.dirty()):s.kind==="base64"?UJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"base64",code:ge.invalid_string,message:s.message}),i.dirty()):s.kind==="base64url"?VJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"base64url",code:ge.invalid_string,message:s.message}),i.dirty()):Tt.assertNever(s);return{status:i.value,value:e.data}}_regex(e,n,i){return this.refinement(r=>e.test(r),{validation:n,code:ge.invalid_string,...Fe.errToObj(i)})}_addCheck(e){return new Lc({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Fe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Fe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Fe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Fe.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Fe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Fe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Fe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Fe.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Fe.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Fe.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Fe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Fe.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Fe.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...Fe.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Fe.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Fe.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Fe.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Fe.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Fe.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Fe.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Fe.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Fe.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Fe.errToObj(n)})}nonempty(e){return this.min(1,Fe.errToObj(e))}trim(){return new Lc({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Lc({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Lc({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Lc.create=t=>new Lc({checks:[],typeName:lt.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...vt(t)});function YJ(t,e){const n=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,r=n>i?n:i,s=Number.parseInt(t.toFixed(r).replace(".","")),o=Number.parseInt(e.toFixed(r).replace(".",""));return s%o/10**r}class tf extends Rt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==je.number){const s=this._getOrReturnCtx(e);return Ee(s,{code:ge.invalid_type,expected:je.number,received:s.parsedType}),at}let i;const r=new Lr;for(const s of this._def.checks)s.kind==="int"?Tt.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),Ee(i,{code:ge.invalid_type,expected:"integer",received:"float",message:s.message}),r.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:ge.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:ge.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):s.kind==="multipleOf"?YJ(e.data,s.value)!==0&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:ge.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),Ee(i,{code:ge.not_finite,message:s.message}),r.dirty()):Tt.assertNever(s);return{status:r.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Fe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Fe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Fe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Fe.toString(n))}setLimit(e,n,i,r){return new tf({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:Fe.toString(r)}]})}_addCheck(e){return new tf({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Fe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Fe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Fe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Fe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Fe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Fe.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Fe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Fe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Fe.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Tt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(n===null||i.value>n)&&(n=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(n)&&Number.isFinite(e)}}tf.create=t=>new tf({checks:[],typeName:lt.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...vt(t)});class Bp extends Rt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==je.bigint)return this._getInvalidInput(e);let i;const r=new Lr;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:ge.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:ge.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:ge.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):Tt.assertNever(s);return{status:r.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return Ee(n,{code:ge.invalid_type,expected:je.bigint,received:n.parsedType}),at}gte(e,n){return this.setLimit("min",e,!0,Fe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Fe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Fe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Fe.toString(n))}setLimit(e,n,i,r){return new Bp({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:Fe.toString(r)}]})}_addCheck(e){return new Bp({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Fe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Fe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Fe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Fe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Fe.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Bp.create=t=>new Bp({checks:[],typeName:lt.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...vt(t)});class $2 extends Rt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==je.boolean){const i=this._getOrReturnCtx(e);return Ee(i,{code:ge.invalid_type,expected:je.boolean,received:i.parsedType}),at}return ps(e.data)}}$2.create=t=>new $2({typeName:lt.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...vt(t)});class oy extends Rt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==je.date){const s=this._getOrReturnCtx(e);return Ee(s,{code:ge.invalid_type,expected:je.date,received:s.parsedType}),at}if(Number.isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return Ee(s,{code:ge.invalid_date}),at}const i=new Lr;let r;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(r=this._getOrReturnCtx(e,r),Ee(r,{code:ge.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),i.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(r=this._getOrReturnCtx(e,r),Ee(r,{code:ge.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),i.dirty()):Tt.assertNever(s);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new oy({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Fe.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Fe.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}oy.create=t=>new oy({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:lt.ZodDate,...vt(t)});class SR extends Rt{_parse(e){if(this._getType(e)!==je.symbol){const i=this._getOrReturnCtx(e);return Ee(i,{code:ge.invalid_type,expected:je.symbol,received:i.parsedType}),at}return ps(e.data)}}SR.create=t=>new SR({typeName:lt.ZodSymbol,...vt(t)});class kR extends Rt{_parse(e){if(this._getType(e)!==je.undefined){const i=this._getOrReturnCtx(e);return Ee(i,{code:ge.invalid_type,expected:je.undefined,received:i.parsedType}),at}return ps(e.data)}}kR.create=t=>new kR({typeName:lt.ZodUndefined,...vt(t)});class CR extends Rt{_parse(e){if(this._getType(e)!==je.null){const i=this._getOrReturnCtx(e);return Ee(i,{code:ge.invalid_type,expected:je.null,received:i.parsedType}),at}return ps(e.data)}}CR.create=t=>new CR({typeName:lt.ZodNull,...vt(t)});class _R extends Rt{constructor(){super(...arguments),this._any=!0}_parse(e){return ps(e.data)}}_R.create=t=>new _R({typeName:lt.ZodAny,...vt(t)});class ER extends Rt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ps(e.data)}}ER.create=t=>new ER({typeName:lt.ZodUnknown,...vt(t)});class Dl extends Rt{_parse(e){const n=this._getOrReturnCtx(e);return Ee(n,{code:ge.invalid_type,expected:je.never,received:n.parsedType}),at}}Dl.create=t=>new Dl({typeName:lt.ZodNever,...vt(t)});class AR extends Rt{_parse(e){if(this._getType(e)!==je.undefined){const i=this._getOrReturnCtx(e);return Ee(i,{code:ge.invalid_type,expected:je.void,received:i.parsedType}),at}return ps(e.data)}}AR.create=t=>new AR({typeName:lt.ZodVoid,...vt(t)});class Co extends Rt{_parse(e){const{ctx:n,status:i}=this._processInputParams(e),r=this._def;if(n.parsedType!==je.array)return Ee(n,{code:ge.invalid_type,expected:je.array,received:n.parsedType}),at;if(r.exactLength!==null){const o=n.data.length>r.exactLength.value,a=n.data.length<r.exactLength.value;(o||a)&&(Ee(n,{code:o?ge.too_big:ge.too_small,minimum:a?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),i.dirty())}if(r.minLength!==null&&n.data.length<r.minLength.value&&(Ee(n,{code:ge.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),i.dirty()),r.maxLength!==null&&n.data.length>r.maxLength.value&&(Ee(n,{code:ge.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),i.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>r.type._parseAsync(new Ll(n,o,n.path,a)))).then(o=>Lr.mergeArray(i,o));const s=[...n.data].map((o,a)=>r.type._parseSync(new Ll(n,o,n.path,a)));return Lr.mergeArray(i,s)}get element(){return this._def.type}min(e,n){return new Co({...this._def,minLength:{value:e,message:Fe.toString(n)}})}max(e,n){return new Co({...this._def,maxLength:{value:e,message:Fe.toString(n)}})}length(e,n){return new Co({...this._def,exactLength:{value:e,message:Fe.toString(n)}})}nonempty(e){return this.min(1,e)}}Co.create=(t,e)=>new Co({type:t,minLength:null,maxLength:null,exactLength:null,typeName:lt.ZodArray,...vt(e)});function Bu(t){if(t instanceof Mn){const e={};for(const n in t.shape){const i=t.shape[n];e[n]=Cl.create(Bu(i))}return new Mn({...t._def,shape:()=>e})}else return t instanceof Co?new Co({...t._def,type:Bu(t.element)}):t instanceof Cl?Cl.create(Bu(t.unwrap())):t instanceof sf?sf.create(Bu(t.unwrap())):t instanceof eu?eu.create(t.items.map(e=>Bu(e))):t}class Mn extends Rt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Tt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==je.object){const c=this._getOrReturnCtx(e);return Ee(c,{code:ge.invalid_type,expected:je.object,received:c.parsedType}),at}const{status:i,ctx:r}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Dl&&this._def.unknownKeys==="strip"))for(const c in r.data)o.includes(c)||a.push(c);const l=[];for(const c of o){const u=s[c],d=r.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Ll(r,d,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Dl){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of a)l.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")a.length>0&&(Ee(r,{code:ge.unrecognized_keys,keys:a}),i.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of a){const d=r.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Ll(r,d,r.path,u)),alwaysSet:u in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,f=await u.value;c.push({key:d,value:f,alwaysSet:u.alwaysSet})}return c}).then(c=>Lr.mergeObjectSync(i,c)):Lr.mergeObjectSync(i,l)}get shape(){return this._def.shape()}strict(e){return Fe.errToObj,new Mn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,i)=>{var s,o;const r=((o=(s=this._def).errorMap)==null?void 0:o.call(s,n,i).message)??i.defaultError;return n.code==="unrecognized_keys"?{message:Fe.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new Mn({...this._def,unknownKeys:"strip"})}passthrough(){return new Mn({...this._def,unknownKeys:"passthrough"})}extend(e){return new Mn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Mn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:lt.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Mn({...this._def,catchall:e})}pick(e){const n={};for(const i of Tt.objectKeys(e))e[i]&&this.shape[i]&&(n[i]=this.shape[i]);return new Mn({...this._def,shape:()=>n})}omit(e){const n={};for(const i of Tt.objectKeys(this.shape))e[i]||(n[i]=this.shape[i]);return new Mn({...this._def,shape:()=>n})}deepPartial(){return Bu(this)}partial(e){const n={};for(const i of Tt.objectKeys(this.shape)){const r=this.shape[i];e&&!e[i]?n[i]=r:n[i]=r.optional()}return new Mn({...this._def,shape:()=>n})}required(e){const n={};for(const i of Tt.objectKeys(this.shape))if(e&&!e[i])n[i]=this.shape[i];else{let s=this.shape[i];for(;s instanceof Cl;)s=s._def.innerType;n[i]=s}return new Mn({...this._def,shape:()=>n})}keyof(){return Xj(Tt.objectKeys(this.shape))}}Mn.create=(t,e)=>new Mn({shape:()=>t,unknownKeys:"strip",catchall:Dl.create(),typeName:lt.ZodObject,...vt(e)});Mn.strictCreate=(t,e)=>new Mn({shape:()=>t,unknownKeys:"strict",catchall:Dl.create(),typeName:lt.ZodObject,...vt(e)});Mn.lazycreate=(t,e)=>new Mn({shape:t,unknownKeys:"strip",catchall:Dl.create(),typeName:lt.ZodObject,...vt(e)});class ay extends Rt{_parse(e){const{ctx:n}=this._processInputParams(e),i=this._def.options;function r(s){for(const a of s)if(a.result.status==="valid")return a.result;for(const a of s)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(a=>new ga(a.ctx.common.issues));return Ee(n,{code:ge.invalid_union,unionErrors:o}),at}if(n.common.async)return Promise.all(i.map(async s=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(r);{let s;const o=[];for(const l of i){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const a=o.map(l=>new ga(l));return Ee(n,{code:ge.invalid_union,unionErrors:a}),at}}get options(){return this._def.options}}ay.create=(t,e)=>new ay({options:t,typeName:lt.ZodUnion,...vt(e)});function F2(t,e){const n=Fa(t),i=Fa(e);if(t===e)return{valid:!0,data:t};if(n===je.object&&i===je.object){const r=Tt.objectKeys(e),s=Tt.objectKeys(t).filter(a=>r.indexOf(a)!==-1),o={...t,...e};for(const a of s){const l=F2(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(n===je.array&&i===je.array){if(t.length!==e.length)return{valid:!1};const r=[];for(let s=0;s<t.length;s++){const o=t[s],a=e[s],l=F2(o,a);if(!l.valid)return{valid:!1};r.push(l.data)}return{valid:!0,data:r}}else return n===je.date&&i===je.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class ly extends Rt{_parse(e){const{status:n,ctx:i}=this._processInputParams(e),r=(s,o)=>{if(bR(s)||bR(o))return at;const a=F2(s.value,o.value);return a.valid?((xR(s)||xR(o))&&n.dirty(),{status:n.value,value:a.data}):(Ee(i,{code:ge.invalid_intersection_types}),at)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([s,o])=>r(s,o)):r(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}ly.create=(t,e,n)=>new ly({left:t,right:e,typeName:lt.ZodIntersection,...vt(n)});class eu extends Rt{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==je.array)return Ee(i,{code:ge.invalid_type,expected:je.array,received:i.parsedType}),at;if(i.data.length<this._def.items.length)return Ee(i,{code:ge.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),at;!this._def.rest&&i.data.length>this._def.items.length&&(Ee(i,{code:ge.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...i.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new Ll(i,o,i.path,a)):null}).filter(o=>!!o);return i.common.async?Promise.all(s).then(o=>Lr.mergeArray(n,o)):Lr.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new eu({...this._def,rest:e})}}eu.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new eu({items:t,typeName:lt.ZodTuple,rest:null,...vt(e)})};class PR extends Rt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==je.map)return Ee(i,{code:ge.invalid_type,expected:je.map,received:i.parsedType}),at;const r=this._def.keyType,s=this._def.valueType,o=[...i.data.entries()].map(([a,l],c)=>({key:r._parse(new Ll(i,a,i.path,[c,"key"])),value:s._parse(new Ll(i,l,i.path,[c,"value"]))}));if(i.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return at;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(c.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const l of o){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return at;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(c.value,u.value)}return{status:n.value,value:a}}}}PR.create=(t,e,n)=>new PR({valueType:e,keyType:t,typeName:lt.ZodMap,...vt(n)});class $p extends Rt{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==je.set)return Ee(i,{code:ge.invalid_type,expected:je.set,received:i.parsedType}),at;const r=this._def;r.minSize!==null&&i.data.size<r.minSize.value&&(Ee(i,{code:ge.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),n.dirty()),r.maxSize!==null&&i.data.size>r.maxSize.value&&(Ee(i,{code:ge.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),n.dirty());const s=this._def.valueType;function o(l){const c=new Set;for(const u of l){if(u.status==="aborted")return at;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const a=[...i.data.values()].map((l,c)=>s._parse(new Ll(i,l,i.path,c)));return i.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,n){return new $p({...this._def,minSize:{value:e,message:Fe.toString(n)}})}max(e,n){return new $p({...this._def,maxSize:{value:e,message:Fe.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}$p.create=(t,e)=>new $p({valueType:t,minSize:null,maxSize:null,typeName:lt.ZodSet,...vt(e)});class NR extends Rt{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}NR.create=(t,e)=>new NR({getter:t,typeName:lt.ZodLazy,...vt(e)});class z2 extends Rt{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Ee(n,{received:n.data,code:ge.invalid_literal,expected:this._def.value}),at}return{status:"valid",value:e.data}}get value(){return this._def.value}}z2.create=(t,e)=>new z2({value:t,typeName:lt.ZodLiteral,...vt(e)});function Xj(t,e){return new nf({values:t,typeName:lt.ZodEnum,...vt(e)})}class nf extends Rt{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),i=this._def.values;return Ee(n,{expected:Tt.joinValues(i),received:n.parsedType,code:ge.invalid_type}),at}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),i=this._def.values;return Ee(n,{received:n.data,code:ge.invalid_enum_value,options:i}),at}return ps(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return nf.create(e,{...this._def,...n})}exclude(e,n=this._def){return nf.create(this.options.filter(i=>!e.includes(i)),{...this._def,...n})}}nf.create=Xj;class MR extends Rt{_parse(e){const n=Tt.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==je.string&&i.parsedType!==je.number){const r=Tt.objectValues(n);return Ee(i,{expected:Tt.joinValues(r),received:i.parsedType,code:ge.invalid_type}),at}if(this._cache||(this._cache=new Set(Tt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=Tt.objectValues(n);return Ee(i,{received:i.data,code:ge.invalid_enum_value,options:r}),at}return ps(e.data)}get enum(){return this._def.values}}MR.create=(t,e)=>new MR({values:t,typeName:lt.ZodNativeEnum,...vt(e)});class cy extends Rt{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==je.promise&&n.common.async===!1)return Ee(n,{code:ge.invalid_type,expected:je.promise,received:n.parsedType}),at;const i=n.parsedType===je.promise?n.data:Promise.resolve(n.data);return ps(i.then(r=>this._def.type.parseAsync(r,{path:n.path,errorMap:n.common.contextualErrorMap})))}}cy.create=(t,e)=>new cy({type:t,typeName:lt.ZodPromise,...vt(e)});class rf extends Rt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===lt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:i}=this._processInputParams(e),r=this._def.effect||null,s={addIssue:o=>{Ee(i,o),o.fatal?n.abort():n.dirty()},get path(){return i.path}};if(s.addIssue=s.addIssue.bind(s),r.type==="preprocess"){const o=r.transform(i.data,s);if(i.common.async)return Promise.resolve(o).then(async a=>{if(n.value==="aborted")return at;const l=await this._def.schema._parseAsync({data:a,path:i.path,parent:i});return l.status==="aborted"?at:l.status==="dirty"||n.value==="dirty"?_h(l.value):l});{if(n.value==="aborted")return at;const a=this._def.schema._parseSync({data:o,path:i.path,parent:i});return a.status==="aborted"?at:a.status==="dirty"||n.value==="dirty"?_h(a.value):a}}if(r.type==="refinement"){const o=a=>{const l=r.refinement(a,s);if(i.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(i.common.async===!1){const a=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return a.status==="aborted"?at:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(a=>a.status==="aborted"?at:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(r.type==="transform")if(i.common.async===!1){const o=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!ef(o))return at;const a=r.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(o=>ef(o)?Promise.resolve(r.transform(o.value,s)).then(a=>({status:n.value,value:a})):at);Tt.assertNever(r)}}rf.create=(t,e,n)=>new rf({schema:t,typeName:lt.ZodEffects,effect:e,...vt(n)});rf.createWithPreprocess=(t,e,n)=>new rf({schema:e,effect:{type:"preprocess",transform:t},typeName:lt.ZodEffects,...vt(n)});class Cl extends Rt{_parse(e){return this._getType(e)===je.undefined?ps(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Cl.create=(t,e)=>new Cl({innerType:t,typeName:lt.ZodOptional,...vt(e)});class sf extends Rt{_parse(e){return this._getType(e)===je.null?ps(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}sf.create=(t,e)=>new sf({innerType:t,typeName:lt.ZodNullable,...vt(e)});class U2 extends Rt{_parse(e){const{ctx:n}=this._processInputParams(e);let i=n.data;return n.parsedType===je.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}U2.create=(t,e)=>new U2({innerType:t,typeName:lt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...vt(e)});class V2 extends Rt{_parse(e){const{ctx:n}=this._processInputParams(e),i={...n,common:{...n.common,issues:[]}},r=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return sy(r)?r.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ga(i.common.issues)},input:i.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new ga(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}V2.create=(t,e)=>new V2({innerType:t,typeName:lt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...vt(e)});class RR extends Rt{_parse(e){if(this._getType(e)!==je.nan){const i=this._getOrReturnCtx(e);return Ee(i,{code:ge.invalid_type,expected:je.nan,received:i.parsedType}),at}return{status:"valid",value:e.data}}}RR.create=t=>new RR({typeName:lt.ZodNaN,...vt(t)});class JJ extends Rt{_parse(e){const{ctx:n}=this._processInputParams(e),i=n.data;return this._def.type._parse({data:i,path:n.path,parent:n})}unwrap(){return this._def.type}}class tE extends Rt{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return s.status==="aborted"?at:s.status==="dirty"?(n.dirty(),_h(s.value)):this._def.out._parseAsync({data:s.value,path:i.path,parent:i})})();{const r=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return r.status==="aborted"?at:r.status==="dirty"?(n.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:i.path,parent:i})}}static create(e,n){return new tE({in:e,out:n,typeName:lt.ZodPipeline})}}class H2 extends Rt{_parse(e){const n=this._def.innerType._parse(e),i=r=>(ef(r)&&(r.value=Object.freeze(r.value)),r);return sy(n)?n.then(r=>i(r)):i(n)}unwrap(){return this._def.innerType}}H2.create=(t,e)=>new H2({innerType:t,typeName:lt.ZodReadonly,...vt(e)});var lt;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(lt||(lt={}));const hc=tf.create,Su=$2.create;Dl.create;Co.create;const IR=Mn.create,ZJ=ay.create;ly.create;eu.create;const Ig=z2.create,Yf=nf.create;cy.create;Cl.create;sf.create;const QJ=["randomize","clean","unchanged"],eZ=["switches-and-leds","printer","null"],tZ=["printer","null"],W2=IR({showInstructionCycle:Su().catch(!1),showStatsCPU:Su().catch(!1),language:Yf(zj).catch(nZ),editorFontSize:hc().int().min(8).max(64).catch(14),dataOnLoad:Yf(QJ).catch("clean"),devices:IR({keyboardAndScreen:Su(),pic:Su(),pio:Yf(["switches-and-leds","printer"]).nullable(),handshake:Yf(["printer"]).nullable()}).catch({keyboardAndScreen:!1,pic:!1,pio:null,handshake:null}),animations:Su().catch(!0),executionUnit:hc().min(1).max(250).catch(150),clockSpeed:hc().min(100).max(1e3).catch(1e3),cpuSpeed:ZJ([Ig(1),Ig(2),Ig(4),Ig(10)]).catch(1),printerSpeed:hc().min(500).max(2e4).catch(5e3),flagsVisibility:Yf(["CF_ZF","SF_OF_CF_ZF","IF_CF_ZF","IF_SF_OF_CF_ZF"]).catch("CF_ZF"),filterBightness:hc().min(0).catch(1),filterContrast:hc().min(0).catch(1),filterInvert:Su().catch(!1),filterSaturation:hc().min(0).catch(1)}),$u=W2.parse({animations:!1});function nZ(){const t=navigator.language.toLowerCase();for(const e of zj)if(t.startsWith(e))return e;return"en"}const Li=Vj("vonsim-settings",$u,{getItem(t,e){try{const n=localStorage.getItem(t);return W2.parse(JSON.parse(n??""))}catch{return e}},setItem(t,e){localStorage.setItem(t,JSON.stringify(e))},removeItem(t){localStorage.removeItem(t)},subscribe(t,e,n){const i=r=>{if(r.storageArea===localStorage&&r.key===t){let s;try{s=W2.parse(JSON.parse(r.newValue??""))}catch{s=n}e(s)}};return window==null||window.addEventListener("storage",i),()=>window==null?void 0:window.removeEventListener("storage",i)}},{getOnInit:!0}),Ge=()=>A.get(Li),Oo=()=>Pm(Li);me(t=>t(Li).showInstructionCycle);me(t=>t(Li).showStatsCPU);const iZ=me(t=>t(Li).language),nE=()=>rt(iZ);me(t=>t(Li).flagsVisibility);const rZ=me(t=>t(Li).editorFontSize),sZ=()=>rt(rZ);me(t=>t(Li).dataOnLoad);const oZ=me(t=>t(Li).devices),aZ=()=>rt(oZ);me(t=>{const e=t(Li);return{executionUnit:e.executionUnit,clock:e.clockSpeed,printer:e.printerSpeed}});me(t=>{const e=t(Li);return[`brightness(${e.filterBightness})`,`contrast(${e.filterContrast})`,`invert(${e.filterInvert?1:0})`,`saturate(${e.filterSaturation})`].filter(Boolean).join(" ")});function Fp(t){const e=t.charCodeAt(0);return H.fitsUnsigned(e,8)?e:null}function iE(t){return H.fitsUnsigned(t,8)?String.fromCharCode(t):null}function qj(t){return lZ.at(t)??null}const lZ=["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","BS","HT","LF","VT","FF","CR","SO","SI","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","EM","SUB","ESC","FS","GS","RS","US","SPACE","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","DEL","XXX","XXX","BPH","NBH","IND","NEL","SSA","ESA","HTS","HTJ","VTS","PLD","PLU","RI","SS2","SS3","DCS","PU1","PU2","STS","CCH","MW","SPA","EPA","SOS","XXX","SCI","CSI","ST","OSC","PM","APC","NBSP","¡","¢","£","¤","¥","¦","§","¨","©","ª","«","¬","SHY","®","¯","°","±","²","³","´","µ","¶","·","¸","¹","º","»","¼","½","¾","¿","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","×","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","÷","ø","ù","ú","û","ü","ý","þ","ÿ"];var on,fn;const Et=class Et{constructor(e,n){Ue(this,on);Ue(this,fn);ie(this,on,e|0),ie(this,fn,n)}get size(){return N(this,fn)}is8bits(){return N(this,fn)===8}is16bits(){return N(this,fn)===16}get unsigned(){return N(this,on)}get signed(){return N(this,on)<=Et.maxSignedValue(N(this,fn))?N(this,on):N(this,on)-(Et.maxValue(N(this,fn))+1)}get low(){return this.is8bits()?this:Et.fromUnsigned(N(this,on)&Et.maxValue(8),8)}get high(){return this.is8bits()?new Et(0,8):Et.fromUnsigned(N(this,on)>>8&Et.maxValue(8),8)}withLow(e){if(e.is16bits())throw new TypeError("Byte must be 8 bits");return Et.fromUnsigned(N(this,on)&~Et.maxValue(8)|e.unsigned,N(this,fn))}withHigh(e){if(e.is16bits())throw new TypeError("Byte must be 8 bits");return Et.fromUnsigned(N(this,on)&Et.maxValue(8)|e.unsigned<<8,16)}bit(e){if(!Number.isSafeInteger(e)||e<0||e>=N(this,fn))throw new RangeError(`Index ${e} out of bounds for byte of size ${N(this,fn)}`);return(N(this,on)&1<<e)!==0}withBit(e,n){if(!Number.isSafeInteger(e)||e<0||e>=N(this,fn))throw new RangeError(`Index ${e} out of bounds for byte of size ${N(this,fn)}`);return n?Et.fromUnsigned(N(this,on)|1<<e,N(this,fn)):Et.fromUnsigned(N(this,on)&~(1<<e),N(this,fn))}add(e){return e=Number(e),Et.fromUnsigned(N(this,on)+e,N(this,fn))}isZero(){return this.unsigned===0}equals(e){return typeof e=="number"?e<0?this.signed===e:this.unsigned===e:N(this,on)===N(e,on)}toUint8Array(){return this.is8bits()?new Uint8Array([this.unsigned]):new Uint8Array([this.low.unsigned,this.high.unsigned])}toArray(){const e=new Array(N(this,fn));for(let n=0;n<N(this,fn);n++)e[n]=this.bit(n);return e}toString(e="int"){switch(e){case"hex":return N(this,on).toString(16).padStart(N(this,fn)/4,"0").toUpperCase();case"bin":return N(this,on).toString(2).padStart(N(this,fn),"0");case"int":return this.signed.toString(10);case"uint":return this.unsigned.toString(10);case"ascii":return N(this,fn)===8?iE(N(this,on))??"---":this.low.toString("ascii")+this.high.toString("ascii");case"safe-ascii":return N(this,fn)===8?qj(N(this,on))??"---":this.low.toString("safe-ascii")+" "+this.high.toString("safe-ascii")}}toJSON(){return N(this,on)}valueOf(){return N(this,on)}static minValue(){return 0}static maxValue(e){return 2**e-1}static minSignedValue(e){return-(2**(e-1))}static maxSignedValue(e){return 2**(e-1)-1}static fits(e,n){return Number.isSafeInteger(e)&&e>=Et.minSignedValue(n)&&e<=Et.maxValue(n)}static fitsUnsigned(e,n){return Number.isSafeInteger(e)&&e>=Et.minValue()&&e<=Et.maxValue(n)}static fitsSigned(e,n){return Number.isSafeInteger(e)&&e>=Et.minSignedValue(n)&&e<=Et.maxSignedValue(n)}static fromUnsigned(e,n){if(!Et.fitsUnsigned(e,n))throw new RangeError(`Value ${e} does not fit in a ${n}-bit byte.`);return new Et(e,n)}static fromSigned(e,n){if(!Et.fitsSigned(e,n))throw new RangeError(`Value ${e} does not fit in a ${n}-bit byte.`);return e<0?new Et(e+Et.maxValue(n)+1,n):new Et(e,n)}static fromNumber(e,n){return e<0?Et.fromSigned(e,n):Et.fromUnsigned(e,n)}static fromChar(e){const n=Fp(e)??-1;return Et.fromUnsigned(n,8)}static random(e){const n=Math.round(Math.random()*Et.maxValue(e));return new Et(n,e)}static zero(e){return new Et(0,e)}};on=new WeakMap,fn=new WeakMap;let H=Et;var Ho;const Ga=class Ga{constructor(e){Ue(this,Ho);ie(this,Ho,e)}get value(){return N(this,Ho).unsigned}get byte(){return N(this,Ho)}toString(e=!1){let n=N(this,Ho).toString("hex");return e&&(n+="h"),n.slice(-2)}toJSON(){return N(this,Ho).toJSON()}valueOf(){return N(this,Ho).valueOf()}static inRange(e){return e=Number(e),Number.isSafeInteger(e)&&e>=Ga.MIN_ADDRESS&&e<=Ga.MAX_ADDRESS}static from(e){if(e=Number(e),!Ga.inRange(e))throw new RangeError(`Address ${e} is out of range.`);const n=H.fromUnsigned(e,16);return new Ga(n)}static format(e,n=!0){if(e=Number(e),!Number.isSafeInteger(e)||e<0)return"????";let i=e.toString(16).padStart(4,"0").toUpperCase();return n&&(i+="h"),i.slice(-3)}};Ho=new WeakMap,be(Ga,"MIN_ADDRESS",0),be(Ga,"MAX_ADDRESS",255);let Pe=Ga;var Wo;const Xa=class Xa{constructor(e){Ue(this,Wo);ie(this,Wo,e)}get value(){return N(this,Wo).unsigned}get byte(){return N(this,Wo)}toString(e=!0){let n=N(this,Wo).toString("hex");return e&&(n+="h"),n}toJSON(){return N(this,Wo).toJSON()}valueOf(){return N(this,Wo).valueOf()}static inRange(e){return e=Number(e),Number.isSafeInteger(e)&&e>=Xa.MIN_ADDRESS&&e<=Xa.MAX_ADDRESS}static from(e){if(e=Number(e),!Xa.inRange(e))throw new RangeError(`Address ${e} is out of range.`);const n=H.fromUnsigned(e,8);return new Xa(n)}static format(e,n=!0){if(e=Number(e),!Number.isSafeInteger(e)||e<0)return"??";let i=e.toString(16).padStart(2,"0").toUpperCase();return n&&(i+="h"),i}};Wo=new WeakMap,be(Xa,"MIN_ADDRESS",0),be(Xa,"MAX_ADDRESS",127);let Dr=Xa;function TR(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function OR(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?TR(Object(n),!0).forEach(function(i){cZ(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):TR(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function cZ(t,e,n){return e=uZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uZ(t){var e=dZ(t,"string");return typeof e=="symbol"?e:String(e)}function dZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uy=Kj({});function Kj(t){return e.withOptions=n=>Kj(OR(OR({},t),n)),e;function e(n,...i){const r=typeof n=="string"?[n]:n.raw,{escapeSpecialCharacters:s=Array.isArray(n),trimWhitespace:o=!0}=t;let a="";for(let u=0;u<r.length;u++){let d=r[u];s&&(d=d.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\\{/g,"{")),a+=d,u<i.length&&(a+=i[u])}const l=a.split(`
`);let c=null;for(const u of l){const d=u.match(/^(\s+)\S+/);if(d){const f=d[1].length;c?c=Math.min(c,f):c=f}}if(c!==null){const u=c;a=l.map(d=>d[0]===" "||d[0]==="	"?d.slice(u):d).join(`
`)}return o&&(a=a.trim()),s&&(a=a.replace(/\\n/g,`
`)),a}}const fZ=Pe.from(Pe.MAX_ADDRESS).toString(),hZ={generics:{clean:"Clean","io-register":(t,e)=>`${t} register (${Dr.format(e)})`,"byte-representation":{hex:"Hexadecimal",bin:"Binary",uint:"Unsigned integer",int:"Signed integer","safe-ascii":"ASCII"}},update:{"update-available":"There's a new version available!","new-version-available":"There's a new version available in the repository.","local-update":"A new local version has been detected.",reload:"Update"},messages:{"assemble-error":"Assemble error. Fix the errors and try again.","invalid-action":"Invalid action.","keyboard-input-required":"Enter a character from keyboard","keyboard-input-description":"The program is waiting for you to enter a character. Use the virtual keyboard or your physical keyboard."},editor:{lintSummary:t=>t===0?"Ready to compile":t===1?"There's an error":`There're ${t} errors`,files:{unsupported:"Your browser doesn't support the FileSystem API","no-file":"No file open",open:"Open file",unsaved:"There are unsaved changes, do you want to discard them?","open-error":"Error opening file",save:"Save file","save-as":"Save file as","save-error":"Error saving file"},example:uy`
      ; Welcome to VonSim!
      ; This is an example program that calculates the first
      ; n numbers of the Fibonacci sequence, and stores them
      ; starting at memory position 1000h.
      
           n  equ 10    ; Calculate the first 10 numbers
      
              org 1000h
      start   db 1
      
              org 2000h
              mov bx, offset start + 1
              mov al, 0
              mov ah, start
      
      loop:   cmp bx, offset start + n
              jns finish
              mov cl, ah
              add cl, al
              mov al, ah
              mov ah, cl
              mov [bx], cl
              inc bx
              jmp loop
      finish: hlt
              end
    `},control:{action:{start:"Start",continue:"Continue",running:"Running...",run:{"cycle-change":"Cycle","end-of-instruction":"Instruction",infinity:"End"},stop:"Stop",reset:"Reset",pause:"Pause"},tabs:{editor:"Editor",computer:"Computer"},zoom:{in:"Zoom in",out:"Zoom out"}},computer:{cpu:{name:"CPU",register:t=>`${t} register`,"control-unit":"Control unit",decoder:"Decoder",stats:"stats CPU","instruction-cycle":"Ciclo de instrucción",status:{fetching:"Fetching instruction...","fetching-operands":"Fetching operands...","fetching-operands-completed":"Operands fetched",executing:"Executing...",writeback:"Saving results...",interrupt:"Handling interrupt...",stopped:"Stopped","stopped-error":"Error","waiting-for-input":"Waiting for input...",int6:"Running INT 6...",int7:"Running INT 7..."},"total-cycles":"Total cycles","instruction-count":"Instruction count",cpi:"Cycles per instruction (CPI)","cpi-help":"Average clock cycles per executed instruction (CPI = total cycles / total instructions)","cpu-time":"CPU time","cpu-time-help":"Total CPU time = total cycles × cycle time (current: {cycleTime} ms)"},memory:{name:"Memory",cell:t=>`Cell ${Pe.format(t)}`,"fix-address":"Fix address","unfix-address":"Unfix address","address-must-be-integer":"Start address must be an hexadecimal integer.","address-out-of-range":`Start address must be less or equal to ${fZ}.`,"address-increment":"Increment address (Page Up)","address-decrement":"Decrement address (Page Down)"},"chip-select":{name:"Chip select",mem:"mem",pic:"pic",timer:"timer",pio:"pio",handshake:"handshake"},bus:{"read-memory":"READ MEMORY","write-memory":"WRITE MEMORY"},f10:"F10 key",keyboard:"Keyboard",leds:"LEDs",printer:{name:"Printer",buffer:"Buffer"},screen:"Screen",switches:"Switches",handshake:{name:"Handshake",data:"Data",state:"State"},pic:"PIC",pio:{name:"PIO",port:t=>`Port ${t}`},timer:"Timer"},settings:{title:"Settings",instructionCycle:{label:"Instruction Cycle"},statsCPU:{label:"CPU Statistics"},flags:{label:"Flags",description:"Select which flags to display in the ALU."},language:{label:"Language"},editorFontSize:{label:"Editor font size",increase:"Increase font size",decrease:"Decrease font size"},dataOnLoad:{label:"Data on load",description:"What to do with the memory when loading a new program.",randomize:"Randomize",clean:"Empty",unchanged:"Unchanged"},devices:{label:"Devices",description:"Which devices should be enabled.","keyboard-and-screen":"Keyboard and screen",pic:{label:"PIC",description:"Also adds a timer and the F10 key."},pio:{label:"PIO","switches-and-leds":"Switches and LEDs",printer:"Printer",null:"Disconnected"},handshake:{label:"Handshake",printer:"Printer",null:"Disconnected"}},animations:{label:"Animations",description:["Enabling animations."].join(" ")},speeds:{executionUnit:"Simulation speed",clockSpeed:"Clock speed",printerSpeed:"Printer speed"},filters:{label:"Filters",description:"Filters applied to the page. Useful when you're using a projector.",revert:"Revert to default filters",brightness:"Brightness",contrast:"Contrast",invert:"Invert",saturation:"Saturation"},reset:"Reset settings"},footer:{documentation:"Documentation",copyright:"III-LIDI, FI, UNLP",issue:{report:"Report an issue",body:(t,e)=>uy`
        <!-- Please describe the problem you are having in as much detail as possible. -->
        <!-- Most importantly, add the steps to reproduce the problem. -->

        <details>
          <summary>Debug info (PLEASE, DO NOT DELETE)</summary>

          **Version**: [${"ac78f34"}](https://github.com/ruiz-jose/VonSim8/commit/${"ac78f34"})

          #### Program

          \`\`\`asm
          ${e.split(`
`).map(n=>n.trim()).join(`
`)}
          \`\`\`

          #### Settings

          \`\`\`json
          ${JSON.stringify(t,null,2)}
          \`\`\`
          
        </details>
      `}}},pZ=Pe.from(Pe.MAX_ADDRESS).toString(),mZ={generics:{clean:"Limpiar","io-register":(t,e)=>`Registro ${t} (${Dr.format(e)})`,"byte-representation":{hex:"Hexadecimal",bin:"Binario",uint:"Entero sin signo",int:"Entero con signo","safe-ascii":"ASCII"}},update:{"update-available":"¡Hay una nueva versión disponible!","new-version-available":"Hay una nueva versión disponible en el repositorio.","local-update":"Se ha detectado una nueva versión local.",reload:"Actualizar"},messages:{"assemble-error":"Error de ensamblado. Solucione los errores y vuelva a intentar.","invalid-action":"Acción inválida.","keyboard-input-required":"Ingrese un carácter por teclado","keyboard-input-description":"El programa está esperando que ingrese un carácter. Use el teclado virtual o su teclado físico."},editor:{lintSummary:t=>t===0?"Listo para compilar":t===1?"Hay un error":`Hay ${t} errores`,files:{unsupported:"Tu navegador no soporta la “FileSystem API”","no-file":"No hay ningún archivo abierto",open:"Abrir",unsaved:"Hay cambios sin guardar, ¿desea descartarlos?","open-error":"Error al abrir el archivo",save:"Guardar","save-as":"Guardar como","save-error":"Error al guardar el archivo"},example:uy`
      ; ¡Bienvenido a VonSim 8!
      ; Este es un ejemplo de código que suma dos variables z = x + y      
        x  db 3
        y  db 2
        z  db 0
        mov al, x
        add al, y
        mov z, al
        hlt
    `},control:{action:{start:"Iniciar",continue:"Continuar",running:"Ejecutando...",run:{"cycle-change":"Ciclo","end-of-instruction":"Instrucción",infinity:"Final"},stop:"Detener",reset:"Reiniciar",pause:"Pausar"},tabs:{editor:"Editor",computer:"Computadora"},zoom:{in:"Acercar",out:"Alejar"}},computer:{cpu:{name:"CPU",register:t=>`Registro ${t}`,"control-unit":"Unidad de control",decoder:"Decodificador",stats:"Estadísticas CPU","instruction-cycle":"Ciclo de instrucción",status:{fetching:"Captación instrucción...","fetching-operands":"Leyendo operandos...","fetching-operands-completed":"Operandos obtenidos",executing:"Ejecutando...",writeback:"Escribiendo resultados...",interrupt:"Manejando interrupción...",stopped:"Detenido","stopped-error":"Error","waiting-for-input":"Esperando tecla...",int6:"Ejecutando INT 6...",int7:"Ejecutando INT 7..."},"total-cycles":"Total de ciclos","instruction-count":"Recuento de instrucciones",cpi:"Ciclos por instrucción (CPI)","cpi-help":"Promedio de ciclos de reloj por instrucción ejecutada (CPI = ciclos totales / instrucciones totales)","cpu-time":"Tiempo de CPU","cpu-time-help":"Tiempo total de CPU = ciclos totales × tiempo de ciclo (actual: {cycleTime} ms)"},memory:{name:"Memoria",cell:t=>`Celda ${Pe.format(t)}`,"fix-address":"Fijar dirección","unfix-address":"Desfijar dirección","address-must-be-integer":"El valor de inicio debe ser un número entero hexadecimal.","address-out-of-range":`El valor de inicio debe ser menor o igual a ${pZ}.`,"address-increment":"Incrementar dirección (Page Up)","address-decrement":"Decrementar dirección (Page Down)"},"chip-select":{name:"Chip select",mem:"mem",pic:"pic",timer:"timer",pio:"pio",handshake:"handshake"},bus:{"read-memory":"LEER MEMORIA","write-memory":"ESCRIBIR MEMORIA"},f10:"Tecla F10",keyboard:"Teclado",leds:"Leds",printer:{name:"Impresora",buffer:"Buffer"},screen:"Pantalla",switches:"Llaves",handshake:{name:"Handshake",data:"Dato",state:"Estado"},pic:"PIC",pio:{name:"PIO",port:t=>`Puerto ${t}`},timer:"Timer"},settings:{title:"Configuración",instructionCycle:{label:"Ciclo de Instrucción"},statsCPU:{label:"Estadísticas CPU"},flags:{label:"Banderas",description:"Selecciona qué banderas mostrar en la ALU."},language:{label:"Idioma"},editorFontSize:{label:"Tamaño de fuente del editor",increase:"Aumentar",decrease:"Disminuir"},dataOnLoad:{label:"Memoria al cargar",description:"Qué hacer con la memoria al cargar un nuevo programa.",randomize:"Aleatoria",clean:"Vaciar",unchanged:"Reusar"},devices:{label:"Dispositivos",description:"Qué dispositivos deben estar habilitados.","keyboard-and-screen":"Teclado y pantalla",pic:{label:"PIC",description:"También agrega un timer y la tecla F10."},pio:{label:"PIO","switches-and-leds":"Llaves y Leds",printer:"Impresora",null:"Desconectado"},handshake:{label:"Handshake",printer:"Impresora",null:"Desconectado"}},animations:{label:"Animaciones",description:["Habilitación de animaciones."].join(" ")},speeds:{executionUnit:"Velocidad de simulación",clockSpeed:"Velocidad del reloj",printerSpeed:"Velocidad de impresión"},filters:{label:"Filtros",description:"Filtros aplicados a la página. Útil cuando se usa un proyector.",revert:"Revertir a los valores por defecto",brightness:"Brillo",contrast:"Contraste",invert:"Invertir",saturation:"Saturación"},reset:"Restablecer configuración"},footer:{documentation:"Documentación",copyright:"III-LIDI, FI, UNLP, UNER",issue:{report:"Reportar un error",body:(t,e)=>uy`
        <!-- Por favor, describa el problema que está teniendo en la mayor cantidad de detalle posible. -->
        <!-- Por sobre todo, agregue los pasos para reproducir el problema. -->

        <details>
          <summary>Información extra (POR FAVOR, NO BORRAR)</summary>

          **Versión**: [${"ac78f34"}](https://github.com/ruiz-jose/VonSim8/commit/${"ac78f34"})

          #### Programa

          \`\`\`asm
          ${e.split(`
`).map(n=>n.trim()).join(`
`)}
          \`\`\`

          #### Configuración

          \`\`\`json
          ${JSON.stringify(t,null,2)}
          \`\`\`
          
        </details>
      `}}},of=Q_({en:hZ,es:mZ});function un(){const t=nE();return x.useCallback((e,...n)=>of(t,e,...n),[t])}const gZ=[{name:"Documentación",url:"https://ruiz-jose.github.io/VonSim8/docs/",icon:"icon-[lucide--book-open]"},{name:"GitHub",url:"https://github.com/ruiz-jose/VonSim8",icon:Eq}],Yj=x.memo(({name:t,url:e,icon:n})=>h.jsx(ss,{content:t,position:"top",children:h.jsx(At,{variant:"ghost",size:"sm",onClick:()=>window.open(e,"_blank"),className:"hover-lift","aria-label":t,children:typeof n=="string"?h.jsx("span",{className:re(n,"size-4")}):h.jsx(Qe,{icon:n,className:"size-4"})})}));Yj.displayName="SocialLink";const Jj=x.memo(()=>{const t=un(),[e]=Oo(),n=x.useMemo(()=>{var s;const i=((s=window.codemirror)==null?void 0:s.state.doc.toString())||"",r=t("footer.issue.body",e,i);return`https://github.com/ruiz-jose/VonSim8/issues/new?body=${encodeURIComponent(r)}`},[t,e]);return h.jsx("footer",{className:"bg-black px-3 py-1.5 text-xs text-white","data-testid":"footer",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("span",{className:"text-xs text-stone-400 sm:text-sm",children:["© 2025 — UNLP, UNER — v","ac78f34"]}),h.jsxs("div",{className:"flex items-center gap-1","data-testid":"footer-links",children:[gZ.map(i=>h.jsx(Yj,{name:i.name,url:i.url,icon:i.icon},i.name)),h.jsx(ss,{content:t("footer.issue.report"),position:"top",children:h.jsx(At,{variant:"ghost",size:"sm",onClick:()=>window.open(n,"_blank"),className:"hover-lift","aria-label":t("footer.issue.report"),children:h.jsx("span",{className:"icon-[lucide--bug] size-4"})})})]})]})})});Jj.displayName="Footer";const vZ="modulepreload",yZ=function(t){return"/VonSim8/"+t},LR={},zp=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(l=>{if(l=yZ(l),l in LR)return;LR[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":vZ,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function Up(t,e,n){const i=[];for(let r=0;r<t.length;r++)try{const s=e(t[r],r,t);s&&(Array.isArray(s)?s.forEach(o=>o&&i.push(n(o,r,t))):i.push(n(s,r,t)))}catch(s){i.push(n(s,r,t))}return i}class En{constructor(e,n){be(this,"start");be(this,"end");this.start=e|0,this.end=(n??e)|0}get range(){return[this.start,this.end]}toString(){let e=`${this.start}`;return this.end!==this.start&&(e+=`:${this.end}`),e}static merge(...e){const n=e.filter(Boolean);if(n.length===0)throw new Error("Cannot merge 0 positions");let i=n[0].start,r=n[0].end;for(const s of n)s.start<i&&(i=s.start),s.end>r&&(r=s.end);return new En(i,r)}toJSON(){return this.range}}const DR=Pe.from(Pe.MAX_ADDRESS).toString(),bZ=Dr.from(Dr.MAX_ADDRESS).toString(),xZ={"address-has-code":t=>`Memory address ${t} has instructions. It cannot be used as a data address.`,"address-out-of-range":t=>`Memory address ${Pe.format(t)} is out of range (max memory address: ${DR}).`,"cannot-accept-strings":t=>`${t} can't accept strings.`,"cannot-be-indirect":"This operand can't be an indirect memory address.","cannot-be-unassinged":t=>`${t} can't be unassigned.`,"cannot-be-word":"This operand can't be of 16 bits.","circular-reference":"Circular reference detected.","constant-must-have-a-label":"Constant must have a label.","constant-must-have-one-value":"Constant must have exactly one value.","destination-cannot-be-immediate":"The destination can't be an immediate value.","double-memory-access":"Can't access to a memory location twice in the same instruction.","duplicated-label":t=>`Duplicated label "${t}".`,"empty-program":`The program is empty or does not contain executable instructions.

Remember: a valid program must have at least one instruction and end with the END directive.

For example:

    org 1000h
    mov al, 3
    hlt
    end

See the documentation or examples for more help.`,"end-must-be-the-last-statement":"END must be the last statement.","equ-not-found":t=>`EQU "${t}" not found.`,"expects-ax":"This operand should be AL.","expects-dx":"The only valid register is DL.","expects-immediate":"This operand should be immediate.","expects-label":"This operand should be a label.","expects-no-operands":"This instruction doesn't expect any operands.","expects-one-operand":"This instruction expects one operand.","expects-two-operands":"This instruction expects two operands.","expects-word-register":"This instruction expects a 8-bits register as its operand.","parser.data-block-no-parameters":"La directiva .DATA no debe tener parámetros. Solo se permiten comentarios en la misma línea.","parser.code-block-no-parameters":"La directiva .CODE no debe tener parámetros. Solo se permiten comentarios en la misma línea.","instruction-out-of-range":t=>`This instruction would be placed in address ${Pe.format(t)}, which is outside the memory range (max memory address: ${DR}).`,"invalid-interrupt":t=>`Invalid interrupt number ${t}.`,"io-address-out-of-range":t=>`I/O address ${t} is out of range (max I/O address: ${bZ}).`,"label-not-found":t=>`Label "${t}" has not been defined.`,"label-should-be-a-number":t=>`Label ${t} should point to a EQU declaration or to a instruction. Maybe you ment to write OFFSET ${t}.`,"label-should-be-an-instruction":t=>`Label ${t} should point to a instruction.`,"missing-org":"No ORG before this instruction — cannot determine its location in memory.","must-have-one-or-more-values":t=>`${t} must have at least one value.`,"occupied-address":t=>`This instruction would be placed in address ${t}, which is already occupied.`,"offset-only-with-data-directive":"OFFSET can only be use with data directives.","reserved-address":t=>`This instruction would be placed in address ${t}, which is reserved by the system.`,"size-mismatch":(t,e)=>`The source (${t}-bit) and destination (${e}-bit) must be the same size.`,"unexpected-error":t=>`Unexpected error: ${String(t)}`,"unknown-size":"Addressing an unknown memory address with an immediate operand requires specifying the type of pointer with WORD PTR or BYTE PTR before the address.","value-out-of-range":(t,e)=>`The number ${t} cannot be represented with ${e} bits.`,lexer:{"character-too-long":"Character literals can only have one character.","empty-character":"Character literals can't be empty.","invalid-binary":"Invalid binary number. It should only contain 0s and 1s.","invalid-decimal":"Invalid decimal number. It should only contain digits.","only-ascii":"Only ASCII character are supported for characters literals and strings.","unexpected-character":t=>`Unexpected character "${t}".`,"unterminated-character":"Unterminated character.","unterminated-string":"Unterminated string."},parser:{"ambiguous-unary":"Ambiguous unary expression detected. Use parentheses to disambiguate.","expected-address-after-org":"Expected address after ORG.","expected-argument":"Expected argument.","expected-eos":"Expected end of statement.","expected-instruction":t=>`Expected instruction, got ${t.type}.`,"expected-label-after-offset":"Expected label after OFFSET.","expected-instruction-after-label":t=>`Expected instruction after label, got ${t.type}.`,"expected-literal-after-expression":t=>`Expected "${t}" after expression.`,"expected-literal-after-literal":(t,e)=>`Expected "${t}" after "${e}".`,"expected-type":(t,e)=>`Expected ${t}, got ${e}.`,"indirect-addressing-must-be-bx":"The only register supported for indirect addressing is BX.","unclosed-parenthesis":"Unclosed parenthesis.","unexpected-identifier":"Unexpected identifier. You may have forgotten a colon (:) to make it a label.","parser.data-block-no-parameters":"La directiva .DATA no debe tener parámetros. Solo se permiten comentarios en la misma línea."}},jR=Pe.from(Pe.MAX_ADDRESS).toString(),wZ=Dr.from(Dr.MAX_ADDRESS).toString(),SZ={"address-has-code":t=>`La dirección de memoria ${Pe.format(t)} tiene instrucciones. No se puede usar como dirección de datos.`,"address-out-of-range":t=>`La dirección de memoria ${Pe.format(t)} está fuera de rango (dirección máxima de memoria: ${jR}).`,"cannot-accept-strings":t=>`${t} no puede aceptar cadenas de texto.`,"cannot-be-indirect":"Este operando no puede ser una dirección de memoria indirecta.","cannot-be-unassinged":t=>`${t} no puede estar sin asignar.`,"cannot-be-word":"Este operando no puede ser de 16 bits.","circular-reference":"Se detectó una referencia circular.","constant-must-have-a-label":"La constante debe tener una etiqueta.","constant-must-have-one-value":"La constante debe tener una exactamente un valor.","destination-cannot-be-immediate":"El destino no puede ser un valor inmediato.","double-memory-access":"No se puede acceder a una memoria dos veces en la misma instrucción.","duplicated-label":t=>`Etiqueta duplicada "${t}".`,"empty-program":`El programa está vacío o no contiene instrucciones ejecutables.

Recuerda que un programa válido debe tener al menos una instrucción y finalizar con la directiva END.

Por ejemplo:

    org 1000h
    mov al, 3
    hlt
    end

Consulta la documentación o los ejemplos para más ayuda.`,"end-must-be-the-last-statement":"END debe ser la última instrucción.","equ-not-found":t=>`EQU "${t}" no encontrado.`,"expects-ax":"Este operando debe ser AL.","expects-dx":"El único registro válido es DL.","expects-immediate":"Este operando debe ser inmediato.","expects-label":"Este operando debe ser una etiqueta.","expects-no-operands":"Esta instrucción no espera ningún operando.","expects-one-operand":"Esta instrucción espera un operando.","expects-two-operands":"Esta instrucción espera dos operandos.","expects-word-register":"Esta instrucción espera un registro de 8 bits como su operando.","parser.data-block-no-parameters":"La directiva .DATA no debe tener parámetros. Solo se permiten comentarios en la misma línea.","parser.code-block-no-parameters":"La directiva .CODE no debe tener parámetros. Solo se permiten comentarios en la misma línea.","instruction-out-of-range":t=>`Esta instrucción se colocaría en la dirección ${Pe.format(t)}, la cual se encuentra fuera del rango de memoria (dirección máxima de memoria: ${jR}).`,"invalid-interrupt":t=>`${t} no es un número de interrupción válido.`,"io-address-out-of-range":t=>`La dirección de E/S ${t} está fuera de rango (dirección máxima de memoria E/S: ${wZ}).`,"label-not-found":t=>`La etiqueta "${t}" no ha sido definida.`,"label-should-be-a-number":t=>`La etiqueta ${t} debería apuntar a una constante EQU o a una instrucción. Quizás quiso escribir OFFSET ${t}.`,"label-should-be-an-instruction":t=>`La etiqueta ${t} debería apuntar a una instrucción.`,"missing-org":"No hay ningún ORG antes de esta instrucción, por lo que no se puede determinar su ubicación en memoria.","must-have-one-or-more-values":t=>`${t} debe tener al menos un valor.`,"occupied-address":t=>`Esta instrucción sería colocada en la dirección ${Pe.format(t)}, la cual ya está ocupada.`,"offset-only-with-data-directive":"OFFSET solo puede ser usado con variables.","reserved-address":t=>`Esta instrucción sería colocada en la dirección ${Pe.format(t)}, la cual ya está reservada por el sistema.`,"size-mismatch":(t,e)=>`La fuente (${t} bits) y el destino (${e} bits) deben ser del mismo tamaño.`,"unexpected-error":t=>`Error inesperado: ${String(t)}`,"unknown-size":"Acceder a una dirección de memoria desconocida con un operando inmediato requiere especificar el tipo de puntero con WORD PTR o BYTE PTR antes de la dirección.","value-out-of-range":(t,e)=>`El número ${t} no puede ser representado con ${e} bits.`,lexer:{"character-too-long":"El carácter solo puede contener un carácter.","empty-character":"Los carácter no puede estar vacío.","invalid-binary":"Número binario inválido. Solo puede contener ceros y unos.","invalid-decimal":"Número decimal inválido. Solo puede contener dígitos.","only-ascii":"Solo se soportan caracteres ASCII para caracteres y cadenas de texto.","unexpected-character":t=>`Carácter inesperado "${t}".`,"unterminated-character":"Carácter sin terminar.","unterminated-string":"Cadena sin terminar."},parser:{"ambiguous-unary":"Se detectó una expresión unaria ambigua. Use paréntesis para evitar ambigüedades.","expected-address-after-org":"Se esperaba una dirección después de ORG.","expected-argument":"Se esperaba un argumento.","expected-eos":"Se esperaba que la instrucción termine.","expected-instruction":t=>`Se esperaba una instrucción, se obtuvo ${t.type}.`,"expected-label-after-offset":"Se esperaba una etiqueta después de OFFSET.","expected-instruction-after-label":t=>`Se esperaba una instrucción después de la etiqueta, se obtuvo ${t.type}.`,"expected-literal-after-expression":t=>`Se esperaba "${t}" después de la expresión.`,"expected-literal-after-literal":(t,e)=>`Se esperaba "${t}" después de "${e}".`,"expected-type":(t,e)=>`Se esperaba ${t}, se obtuvo ${e}.`,"indirect-addressing-must-be-bx":"El único registro válido para el direccionamiento indirecto es BL.","unclosed-parenthesis":"Paréntesis sin cerrar.","unexpected-identifier":"Identificador inesperado. Tal vez te olvidaste agregar dos puntos (:) para hacerlo una etiqueta.","parser.data-block-no-parameters":"La directiva .DATA no debe tener parámetros. Solo se permiten comentarios en la misma línea."}},kZ=Q_({en:xZ,es:SZ});class de extends Error{constructor(n,...i){super();be(this,"code");be(this,"context");be(this,"position");this.code=n,this.context=i,this.position=null,n==="unexpected-error"&&console.error("[Unexpected Assembler Error]",...i)}at(n){return n&&(n instanceof En?this.position=n:"position"in n?this.position=n.position:"meta"in n&&(this.position=n.meta.position)),this}translate(n){return kZ(n,this.code,...this.context)}get message(){let n=this.translate("en");return this.position&&(n+=` (${this.position})`),n}toString(){return this.message}static from(n){return n instanceof de?n:new de("unexpected-error",n)}}const rE=[[0,H.fromUnsigned(160,8)],[3,H.fromUnsigned(176,8)],[6,H.fromUnsigned(192,8)],[7,H.fromUnsigned(208,8)]],BR=new Set(...rE.map(([t])=>[t]));var Za,Id;class CZ{constructor(){be(this,"codeMemory",new Set);be(this,"labels",new Map);be(this,"hasORG",!1);be(this,"_hasORG20hAtStart",!1);be(this,"_mayUsePIC",!1);Ue(this,Za,!1);Ue(this,Id,!1)}loadStatements(e){if(N(this,Za))throw new Error("Tried to load statements twice");ie(this,Za,!0),this.labels.clear();const n=[];for(const i of e)if("label"in i&&i.label){if(this.labels.has(i.label)){n.push(new de("duplicated-label",i.label).at(i.position));continue}i.isInstruction()?this.labels.set(i.label,{type:"instruction",address:Pe.from(0)}):i.directive==="EQU"?this.labels.set(i.label,{type:"EQU",constant:i}):this.labels.set(i.label,{type:i.directive,address:Pe.from(0)})}return n}computeAddresses(e){var v,b,w;if(N(this,Id))throw new Error("Tried to compute addresses twice");ie(this,Id,!0),this.codeMemory.clear();const n=new Set,i=e.some(k=>k.isInstruction()&&k.instruction==="INT");this.hasORG=e.some(k=>k.isOriginChange());const r=e.some((k,C)=>k.isOriginChange()&&C>0),s=((v=e[0])==null?void 0:v.isOriginChange())&&e[0].newAddress===32;if(this._hasORG20hAtStart=s,console.log("DEBUG ASSEMBLER:",{hasORG:this.hasORG,hasORG20hAtStart:s,firstStatement:(b=e[0])!=null&&b.isOriginChange()?e[0].newAddress:"no ORG"}),this.hasORG&&!r&&!e[0].isOriginChange())throw new de("missing-org").at(e[0].position);const o=e.some(k=>k.isInstruction()&&k.instruction==="INT");console.log("🔍 ASSEMBLER: Iniciando detección de PIC. Labels disponibles:",Array.from(this.labels.keys()));const a=Array.from(this.labels.entries()).some(([k,C])=>{if(C.type==="EQU")try{const E=C.constant.evaluate(this);if(console.log(`🔍 ASSEMBLER: Evaluando constante EQU ${k} = ${E} (tipo: ${typeof E})`),typeof E=="number"&&E>=32&&E<=43)return console.log(`🎯 ASSEMBLER: ¡DETECTADA! Constante EQU en rango PIC: ${k} = 0x${E.toString(16)}`),!0}catch(E){console.log(`⚠️ ASSEMBLER: Error evaluando constante EQU ${k}:`,E)}return!1});console.log(`🔍 ASSEMBLER: hasPICConstants = ${a}`);const l=a||e.some(k=>!k.isInstruction()||k.instruction!=="IN"&&k.instruction!=="OUT"?!1:(console.log(`🔍 ASSEMBLER: Analizando instrucción ${k.instruction} con operandos:`,k.operands),k.operands.some(E=>{var _;if(console.log(`🔍 ASSEMBLER: Operando tipo ${E.type}, valor:`,E.value),E.type==="number-expression"&&typeof((_=E.value)==null?void 0:_.value)=="number"){const M=E.value.value,R=M>=32&&M<=43;return R&&console.log(`🎯 ASSEMBLER: Detectado uso de PIC (directo) - ${k.instruction} ${M.toString(16)}h`),R}if(E.type==="identifier"){const M=E.value;console.log(`🔍 ASSEMBLER: Verificando identificador ${M}`);const R={IMR:33,EOI:32,INT0:36,INT1:37,INT2:38,INT3:39,INT4:40,INT5:41,INT6:42,INT7:43};if(Object.hasOwnProperty.call(R,M)){const L=R[M];return console.log(`🎯 ASSEMBLER: Detectado uso de PIC (constante conocida ${M}) - ${k.instruction} ${M}(${L.toString(16)}h)`),!0}const T=this.labels.get(M);if(console.log(`🔍 ASSEMBLER: Datos de etiqueta para ${M}:`,T),T&&T.type==="EQU")try{const L=T.constant.evaluate(this);if(console.log(`🔍 ASSEMBLER: Valor evaluado de ${M}: ${L}`),typeof L=="number"&&L>=32&&L<=43)return console.log(`🎯 ASSEMBLER: Detectado uso de PIC (constante EQU usuario ${M}=${L.toString(16)}h) - ${k.instruction} ${M}`),!0}catch(L){console.log(`⚠️ ASSEMBLER: No se pudo evaluar constante ${M} para detección PIC:`,L)}}return!1})));console.log(`🔍 ASSEMBLER: Resultado detección PIC: ${l}`),this._mayUsePIC=l;let c;s?c=32:o||l?c=8:c=0,console.log("DEBUG ASSEMBLER mainCodePointer:",{hasORG20hAtStart:s,hasINTInstruction:o,mayUsePIC:l,mainCodePointer:"0x"+c.toString(16).padStart(2,"0"),strategy:s?"ORG 20h":o||l?"reserve interrupt space (INT/PIC)":"start at 00h"});let u=c,d=null,f=c,p=c;const m=[],g=[],y=[];for(const k of e)k.isInstruction()?m.push(k):k.isOriginChange()?g.push(k):k.isDataDirective()&&y.push(k);if(r||this.hasORG){const k=[],C=[];(w=e[0])!=null&&w.isOriginChange()||(u=c);const E=[],_=[],M=[];let R=!0,T=!1;for(const I of e)I.isOriginChange()?!T&&I.newAddress===32?(T=!0,R=!0,M.push(I)):(R=!1,M.push(I)):I.isInstruction()?R?E.push(I):M.push(I):I.isDataDirective()?_.push(I):I.isEnd()&&M.push(I);const L=[];return L.push(...E,..._,...M),Up(L,I=>{if(I.isEnd()||I.isDataDirective()&&I.directive==="EQU")return;if(I.isOriginChange()){u=I.newAddress;return}const G=u;if(G===null)throw new de("missing-org").at(I);const B=I.length,q=G,Y=G+B-1;for(const V of C)if(Math.max(q,V.start)<=Math.min(Y,V.end)){k.push(new de("occupied-address",Pe.from(q)).at(I));return}C.push({start:q,end:Y,statement:I});for(let V=0;V<B;V++){if(!Pe.inRange(G+V))throw new de("instruction-out-of-range",G+V).at(I);const U=Pe.from(G+V);if(n.has(U.value))throw new de("occupied-address",U).at(I);if(i&&BR.has(U.value))throw new de("reserved-address",U).at(I);n.add(U.value),I.isInstruction()&&this.codeMemory.add(U.value)}const ne=Pe.from(G);I.setStart(ne),I.label&&this.labels.set(I.label,{type:I.isInstruction()?"instruction":I.directive,address:ne}),(I.isDataDirective()||I.isInstruction())&&(I.isInstruction()&&E.includes(I)&&(p=u+B),I.isDataDirective()&&d===null&&(d=p,u=d),u+=B,f=Math.max(f,u))},de.from),k}else return Up([...m,...g,...y],C=>{if(C.isDataDirective()&&C.directive==="EQU")return;if(C.isOriginChange()){const R=C.newAddress;R<32?d=R:u=R;return}let E;if(C.isDataDirective())d===null&&(d=f),E=d;else if(C.isInstruction())E=u;else throw new de("missing-org").at(C);const _=C.length;for(let R=0;R<_;R++){if(!Pe.inRange(E+R))throw new de("instruction-out-of-range",E+R).at(C);const T=Pe.from(E+R);if(n.has(T.value))throw new de("occupied-address",T).at(C);if(i&&BR.has(T.value))throw new de("reserved-address",T).at(C);n.add(T.value),C.isInstruction()&&this.codeMemory.add(T.value)}const M=Pe.from(E);if(C.setStart(M),C.label&&this.labels.set(C.label,{type:C.isInstruction()?"instruction":C.directive,address:M}),C.isDataDirective()){if(d===null)throw new Error("Data pointer is null");d+=_}else C.isInstruction()&&(u+=_,f=Math.max(f,u))},de.from)}labelExists(e){if(!N(this,Za))throw new Error("Tried to check if label exists before loading statements");return this.labels.has(e)}getLabelType(e){var n;if(!N(this,Za))throw new Error("Tried to get type of label before loading statements");return(n=this.labels.get(e))==null?void 0:n.type}getLabelValue(e){if(!N(this,Za))throw new Error("Tried to get type of label before loading statements");const n=this.labels.get(e);if(n){if(n.type==="EQU")return n.constant.evaluate(this);if(!N(this,Id))throw new Error("Tried to get address of label before computing addresses");return n.address.value}}addressIsReserved(e){return e instanceof Pe&&(e=e.value),this.codeMemory.has(e)}hasOriginDirective(){return this.hasORG}hasORG20hAtStart(){return this._hasORG20hAtStart}mayUsePIC(){return this._mayUsePIC}}Za=new WeakMap,Id=new WeakMap;const _Z=["AL","BL","CL","DL","AH","BH","CH","DH"],Zj=["AX","BX","CX","DX","SP"],dy=[..._Z,...Zj],sE=["DB","DW","EQU"],oE=["MOV","PUSH","POP","IN","OUT","PUSHF","POPF","ADD","ADC","INC","SUB","SBB","DEC","NEG","CMP","NOT","AND","OR","XOR","CALL","JMP","RET","JZ","JO","JS","JC","JNZ","JNO","JNS","JNC","INT","IRET","CLI","STI","NOP","HLT"],EZ=["OFFSET","ORG","BYTE","WORD","PTR","END",".DATA",".CODE",...dy,...oE,...sE];class AZ{constructor(e,n,i){be(this,"type");be(this,"lexeme");be(this,"position");this.type=e,this.lexeme=n,this.position=i}toJSON(){return{type:this.type,lexeme:this.lexeme,position:this.position.toJSON()}}}class PZ{constructor(e){be(this,"scanned",!1);be(this,"tokens",[]);be(this,"position",new En(0));this.source=e}scanTokens(){if(this.scanned)throw new Error("Scanner has already been used.");for(this.scanned=!0;!this.isAtEnd();){this.position=new En(this.position.end);const e=this.advance();switch(e){case"(":this.addToken("LEFT_PAREN");continue;case")":this.addToken("RIGHT_PAREN");continue;case"[":this.addToken("LEFT_BRACKET");continue;case"]":this.addToken("RIGHT_BRACKET");continue;case",":this.addToken("COMMA");continue;case"?":this.addToken("QUESTION_MARK");continue;case"+":this.addToken("PLUS");continue;case"-":this.addToken("MINUS");continue;case"*":this.addToken("ASTERISK");continue;case"'":{let n=0;for(;this.peek()!=="'";){if(this.isAtEnd()||this.peek()===`
`)throw new de("lexer.unterminated-character").at(this.position);if(Fp(this.peek())===null)throw new de("lexer.only-ascii").at(new En(this.position.end,this.position.end+1));this.advance(),n++}if(this.advance(),n===0)throw new de("lexer.empty-character").at(this.position);if(n>=2)throw new de("lexer.character-too-long").at(this.position);this.addToken("CHARACTER");continue}case'"':for(;this.peek()!=='"';){if(this.isAtEnd()||this.peek()===`
`)throw new de("lexer.unterminated-string").at(this.position);if(Fp(this.peek())===null)throw new de("lexer.only-ascii").at(new En(this.position.end,this.position.end+1));this.advance()}this.advance(),this.addToken("STRING");continue;case";":for(;this.peek()!==`
`&&!this.isAtEnd();)this.advance();continue;case" ":case"\r":case"	":continue;case`
`:this.addToken("EOL");continue}if(this.isDigit(e)){for(;this.isDigit(this.peek())||this.peek()>="a"&&this.peek()<="f"||this.peek()>="A"&&this.peek()<="F";)this.advance();if(this.peek()===".")throw new de("lexer.unexpected-character",".").at(new En(this.position.end,this.position.end+1));if(this.peek()==="H"||this.peek()==="h")this.advance();else{const n=this.source.slice(this.position.start,this.position.end);if(n.at(-1)==="b"||n.at(-1)==="B"){if(!/^[01]+b$/i.test(n))throw new de("lexer.invalid-binary").at(this.position)}else if(!/^\d+$/.test(n))throw new de("lexer.invalid-decimal").at(this.position)}this.addToken("NUMBER");continue}if(this.isAlpha(e)||e==="."){if(e==="."&&this.isDigit(this.peek()))throw new de("lexer.unexpected-character",".").at(new En(this.position.start,this.position.start+1));for(;this.isAlphaNumeric(this.peek())||this.peek()===".";)this.advance();const n=this.source.slice(this.position.start,this.position.end).toUpperCase();EZ.includes(n)?this.addToken(n):this.peek()===":"?(this.advance(),this.addToken("LABEL")):this.addToken("IDENTIFIER");continue}throw new de("lexer.unexpected-character",e).at(this.position)}return this.position=new En(this.position.end),this.addToken("EOF"),this.tokens}addToken(e){this.tokens.push(new AZ(e,this.source.slice(this.position.start,this.position.end),this.position))}advance(){const e=this.source.charAt(this.position.end);return this.position=new En(this.position.start,this.position.end+1),e}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}isAtEnd(){return this.position.end>=this.source.length}isDigit(e){return e>="0"&&e<="9"}peek(){return this.isAtEnd()?"\0":this.source.charAt(this.position.end)}}class ri{constructor(e){this.position=e}isNumberLiteral(){return this.type==="number-literal"}isLabel(){return this.type==="label"}isUnaryOperation(){return this.type==="unary-operation"}isBinaryOperation(){return this.type==="binary-operation"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}be(ri,"numberLiteral",(...e)=>new NZ(...e)),be(ri,"label",(...e)=>new MZ(...e)),be(ri,"unaryOperation",(...e)=>new RZ(...e)),be(ri,"binaryOperation",(...e)=>new IZ(...e));class NZ extends ri{constructor(n,i){super(i);be(this,"type","number-literal");this.value=n}evaluate(){return this.value}toJSON(){return{...super.toJSON(),value:this.value}}}let MZ=class extends ri{constructor(n,i,r){super(r);be(this,"type","label");this.value=n,this.offset=i}evaluate(n){if(!n.labelExists(this.value))throw new de("label-not-found",this.value).at(this.position);const i=n.getLabelType(this.value);if((i==="DB"||i==="DW")&&!this.offset)throw new de("label-should-be-a-number",this.value).at(this.position);if((i==="EQU"||i==="instruction")&&this.offset)throw new de("offset-only-with-data-directive").at(this.position);return n.getLabelValue(this.value)}toJSON(){return{...super.toJSON(),value:this.value,offset:this.offset}}};class RZ extends ri{constructor(n,i,r){super(r);be(this,"type","unary-operation");this.operator=n,this.right=i}evaluate(n){return this.operator==="+"?this.right.evaluate(n):-this.right.evaluate(n)}toJSON(){return{...super.toJSON(),operator:this.operator,right:this.right.toJSON()}}}class IZ extends ri{constructor(n,i,r,s){super(s);be(this,"type","binary-operation");this.left=n,this.operator=i,this.right=r}evaluate(n){return this.operator==="+"?this.left.evaluate(n)+this.right.evaluate(n):this.operator==="-"?this.left.evaluate(n)-this.right.evaluate(n):this.left.evaluate(n)*this.right.evaluate(n)}toJSON(){return{...super.toJSON(),operator:this.operator,left:this.left.toJSON(),right:this.right.toJSON()}}}class Fb{constructor(e){this.position=e}isOriginChange(){return this.type==="origin-change"}isEnd(){return this.type==="end"}isDataDirective(){return this.type==="data-directive"}isInstruction(){return this.type==="instruction"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}var Go;class Qj extends Fb{constructor(n,i,r){super(r);be(this,"type","data-directive");be(this,"label");be(this,"values");Ue(this,Go,null);this.values=n,this.label=i}get start(){if(N(this,Go)===null)throw new Error("Start not set");return N(this,Go)}setStart(n){if(N(this,Go)!==null)throw new Error("Start already set");ie(this,Go,n)}toJSON(){return{...super.toJSON(),...N(this,Go)?{start:N(this,Go).toJSON()}:{},directive:this.directive,label:this.label}}}Go=new WeakMap;var jc,Qa,Td;class TZ extends Qj{constructor(n,i,r){super(n,i,r);be(this,"directive","EQU");Ue(this,jc,"not-processed");Ue(this,Qa,null);Ue(this,Td,null)}toJSON(){var n;return{...super.toJSON(),value:N(this,Td)??((n=N(this,Qa))==null?void 0:n.toJSON())??this.values.map(i=>i.toJSON())}}validate(){if(N(this,Qa))throw new Error("Constant already validated");if(!this.label)throw new de("constant-must-have-a-label").at(this);if(this.values.length!==1)throw new de("constant-must-have-one-value").at(this);const n=this.values[0];if(n.type==="string")throw new de("cannot-accept-strings","EQU").at(n);if(n.type==="unassigned")throw new de("cannot-be-unassinged","EQU").at(n);ie(this,Qa,n.value)}evaluateExpressions(n){if(!N(this,Qa))throw new Error("Constant not validated");if(N(this,jc)==="processed")return N(this,Td);if(N(this,jc)==="processing")throw new de("circular-reference").at(this.position);ie(this,jc,"processed");const i=N(this,Qa).evaluate(n);return ie(this,jc,"processed"),ie(this,Td,i),i}evaluate(n){return this.evaluateExpressions(n)}}jc=new WeakMap,Qa=new WeakMap,Td=new WeakMap;const Eh=Symbol("unassigned");var Yi,Ss;class OZ extends Qj{constructor(n,i,r,s){super(i,r,s);be(this,"size");Ue(this,Yi,null);Ue(this,Ss,null);this.directive=n,this.size=n==="DB"?8:16}get length(){if(!N(this,Yi))throw new Error("Data directive not validated");return N(this,Yi).length*(this.size/8)}getValues(){if(!N(this,Ss))throw new Error("Data directive not evaluated");return N(this,Ss)}toJSON(){return{...super.toJSON(),values:(N(this,Ss)??N(this,Yi)??this.values).map(n=>n===Eh?"?":n.toJSON())}}validate(){if(N(this,Yi))throw new Error("Data directive already validated");ie(this,Yi,[]);for(const n of this.values)if(n.isUnassigned())N(this,Yi).push(Eh);else if(n.isString()){if(this.directive!=="DB")throw new de("cannot-accept-strings",this.directive).at(n);const i=n.value;for(let r=0;r<i.length;r++){const s=Fp(i[r]);if(s===null)throw new Error("Invalid character, should not happen");const o=new En(n.position.start+r,n.position.start+r+1),a=ri.numberLiteral(s,o);N(this,Yi).push(a)}}else N(this,Yi).push(n.value);if(N(this,Yi).length===0)throw new de("must-have-one-or-more-values",this.directive).at(this)}evaluateExpressions(n){if(!N(this,Yi))throw new Error("Data directive not validated");if(N(this,Ss))throw new Error("Data directive already evaluated");ie(this,Ss,[]);const i=Up(N(this,Yi),r=>{if(r===Eh)N(this,Ss).push(Eh);else{const s=r.evaluate(n);if(!H.fits(s,this.size))throw new de("value-out-of-range",s,this.size).at(this);const o=H.fromNumber(s,this.size);N(this,Ss).push(o)}},de.from);return i.length>0&&ie(this,Ss,null),i}}Yi=new WeakMap,Ss=new WeakMap;class aE{constructor(e){this.position=e}isString(){return this.type==="string"}isUnassigned(){return this.type==="unassigned"}isNumberExpression(){return this.type==="number-expression"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}class LZ extends aE{constructor(n,i){super(i);be(this,"type","string");this.value=n}toJSON(){return{...super.toJSON(),value:this.value}}}class DZ extends aE{constructor(n){super(n);be(this,"type","unassigned")}}class jZ extends aE{constructor(n){super(n.position);be(this,"type","number-expression");this.value=n}toJSON(){return{...super.toJSON(),value:this.value.toJSON()}}}function BZ(t,e,n){const i=En.merge(t.position,...e.map(r=>r.position));switch(t.type){case"DB":case"DW":return new OZ(t.type,e,n,i);case"EQU":return new TZ(e,n,i)}}class Dx extends Fb{constructor(n){super(n);be(this,"type","end")}}function za(t){switch(t){case"AL":case"AX":return 0;case"BL":case"BX":return 1;case"CL":case"CX":return 2;case"DL":case"DX":return 3;case"AH":case"SP":return 4;case"CH":return 5;case"DH":return 6;case"BH":return 7;default:throw new Error(`Registro no soportado: ${t}`)}}var Xo;class pu extends Fb{constructor(n,i,r){super(r);be(this,"type","instruction");be(this,"label");be(this,"operands");Ue(this,Xo,null);this.operands=n,this.label=i}getOperands(){return this.operands}get start(){if(N(this,Xo)===null)throw new Error("Start not set");return N(this,Xo)}setStart(n){if(N(this,Xo)!==null)throw new Error("Start already set");ie(this,Xo,n)}toJSON(){return{...super.toJSON(),...N(this,Xo)?{start:N(this,Xo).toJSON()}:{},instruction:this.instruction,label:this.label}}}Xo=new WeakMap;var yi,Vr;class $Z extends pu{constructor(n,i,r,s){super(i,r,s);Ue(this,yi,null);Ue(this,Vr,null);this.instruction=n}get length(){if(!N(this,yi))throw new Error("Instruction not validated");const{mode:n,size:i,out:r,src:s}=N(this,yi);let o=1;return(n==="reg<-mem"&&s.mode==="direct"||(n==="mem<-reg"||n==="mem<-imd")&&r.mode==="direct")&&(o+=1),(n==="reg<-imd"||n==="mem<-imd")&&(o+=i/8),o}get operation(){if(!N(this,Vr))throw new Error("Instruction not evaluated");return N(this,Vr)}toBytes(){const{mode:n,size:i,out:r,src:s}=this.operation,o=[],a={MOV:0,AND:240,OR:240,XOR:240,ADD:48,ADC:48,SUB:96,SBB:64,CMP:144};if(o[0]=a[this.instruction],i===16&&(o[0]|=1),!(this.instruction==="AND"||this.instruction==="OR"||this.instruction==="XOR"))switch(n){case"reg<-reg":break;case"reg<-mem":case"reg<-imd":o[0]+=16;break;case"mem<-reg":case"mem<-imd":o[0]+=32;break}switch(n){case"reg<-reg":{o[0]|=(za(r)&3)<<2,o[0]|=(za(s)&3)<<0;break}case"reg<-mem":{s.mode==="direct"?(o[0]=o[0]&252|0,o.push(s.address.byte.low.unsigned)):o[0]=o[0]&252|1,o[0]|=(za(r)&3)<<2;break}case"reg<-imd":{o[0]=o[0]&252|2,o.push(s.low.unsigned),o[0]|=(za(r)&3)<<2,i===16&&o.push(s.high.unsigned);break}case"mem<-reg":{r.mode==="direct"?(o[0]=o[0]&240|0,o[0]|=(za(s)&3)<<0,o.push(r.address.byte.low.unsigned)):(o[0]=o[0]&240|4,o[0]|=(za(s)&3)<<0);break}case"mem<-imd":{r.mode==="direct"?(o[0]=o[0]&240|12,o.push(r.address.byte.low.unsigned)):o[0]=o[0]&240|13,o.push(s.low.unsigned),i===16&&o.push(s.high.unsigned);break}default:return n}return new Uint8Array(o)}toJSON(){return{...super.toJSON(),...N(this,Vr)??N(this,yi)??{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(N(this,yi))throw new Error("Instruction already validated");if(this.operands.length!==2)throw new de("expects-two-operands").at(this);const[i,r]=this.operands;if(i.isRegister()){if(r.isRegister()){if(i.size!==r.size)throw new de("size-mismatch",r.size,i.size).at(this);ie(this,yi,{mode:"reg<-reg",size:i.size,out:i.value,src:r.value});return}if(r.isDirectAddress()){if(r.size!=="auto"&&r.size!==i.size)throw new de("size-mismatch",r.size,i.size).at(this);ie(this,yi,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"direct",address:r.value}});return}if(r.isIndirectAddress()){if(r.size!=="auto"&&r.size!==i.size)throw new de("size-mismatch",r.size,i.size).at(this);ie(this,yi,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"indirect"}});return}const s=r.getAsDirectAddress(n);if(s){if(s.size!==i.size)throw new de("size-mismatch",s.size,i.size).at(this);ie(this,yi,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"direct",address:s.expression}});return}ie(this,yi,{mode:"reg<-imd",size:i.size,out:i.value,src:r.value});return}else{let s,o;if(i.isIndirectAddress())s=i.size,o={mode:"indirect"};else if(i.isDirectAddress())s=i.size,o={mode:"direct",address:i.value};else{const a=i.getAsDirectAddress(n);if(a)s=a.size,o={mode:"direct",address:a.expression};else throw new de("destination-cannot-be-immediate").at(i)}if(r.isRegister()){if(s!=="auto"&&s!==r.size)throw new de("size-mismatch",s,r.size).at(this);ie(this,yi,{mode:"mem<-reg",size:r.size,out:o,src:r.value});return}if(r.isNumberExpression()){if(r.getAsDirectAddress(n))throw new de("double-memory-access").at(this);s==="auto"&&(s=8),ie(this,yi,{mode:"mem<-imd",size:s,out:o,src:r.value});return}throw new de("double-memory-access").at(this)}}evaluateExpressions(n){if(!N(this,yi))throw new Error("Instruction not validated");if(N(this,Vr))throw new Error("Instruction aready evaluated");const{mode:i,size:r,out:s,src:o}=N(this,yi),a=l=>{const c=l.evaluate(n);if(!Pe.inRange(c))throw new de("address-out-of-range",c).at(l);const u=Pe.from(c);if(n.addressIsReserved(u))throw new de("address-has-code",u).at(l);return u};switch(i){case"reg<-reg":{ie(this,Vr,{mode:i,size:r,out:s,src:o});return}case"reg<-mem":{ie(this,Vr,{mode:i,size:r,out:s,src:o.mode==="direct"?{mode:"direct",address:a(o.address)}:{mode:"indirect"}});return}case"reg<-imd":{const l=o.evaluate(n);if(!H.fits(l,r))throw new de("value-out-of-range",l,r).at(o);const c=H.fromNumber(l,r);ie(this,Vr,{mode:i,size:r,out:s,src:c});return}case"mem<-reg":{ie(this,Vr,{mode:i,size:r,out:s.mode==="direct"?{mode:"direct",address:a(s.address)}:{mode:"indirect"},src:o});return}case"mem<-imd":{const l=o.evaluate(n);if(!H.fits(l,r))throw new de("value-out-of-range",l,r).at(o);const c=H.fromNumber(l,r);ie(this,Vr,{mode:i,size:r,out:s.mode==="direct"?{mode:"direct",address:a(s.address)}:{mode:"indirect"},src:c});return}default:return i}}}yi=new WeakMap,Vr=new WeakMap;var eo,qo;class FZ extends pu{constructor(n,i,r,s){super(i,r,s);Ue(this,eo,null);Ue(this,qo,null);be(this,"length",2);this.instruction=n}toBytes(){return new Uint8Array([26,this.value.unsigned])}get value(){if(!N(this,qo))throw new Error("Instruction not evaluated");return N(this,qo)}toJSON(){return{...super.toJSON(),...N(this,qo)?{value:N(this,qo).toJSON()}:N(this,eo)?{initialValue:N(this,eo).toJSON()}:{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(N(this,eo))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new de("expects-one-operand").at(this);const n=this.operands[0];if(!n.isNumberExpression())throw new de("expects-immediate").at(n);ie(this,eo,n.value)}evaluateExpressions(n){if(!N(this,eo))throw new Error("Instruction not validated");if(N(this,qo))throw new Error("Instruction aready evaluated");const i=N(this,eo).evaluate(n);if(!H.fitsUnsigned(i,8))throw new de("invalid-interrupt",i).at(N(this,eo));ie(this,qo,H.fromUnsigned(i,8))}}eo=new WeakMap,qo=new WeakMap;var ks,Ko,k4;let zZ=(k4=class extends pu{constructor(n,i,r,s){super(i,r,s);Ue(this,ks,null);Ue(this,Ko,null);this.instruction=n}get length(){if(!N(this,ks))throw new Error("Instruction not validated");return N(this,ks).port==="fixed"?2:1}toBytes(){const n=[],i={IN:216,OUT:220};return n[0]=i[this.instruction],this.operation.size===16&&(n[0]|=1),this.operation.port==="fixed"?n[1]=this.operation.address.value:n[0]|=2,new Uint8Array(n)}get operation(){if(N(this,Ko)===null)throw new Error("Operation not set");return N(this,Ko)}toJSON(){return{...super.toJSON(),...N(this,Ko)??N(this,ks)??{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(N(this,ks))throw new Error("Instruction already validated");if(this.operands.length!==2)throw new de("expects-two-operands").at(this);const n=this.operands[this.instruction==="IN"?0:1],i=this.operands[this.instruction==="IN"?1:0];if(!n.isRegister()||n.value!=="AL"&&n.value!=="AX")throw new de("expects-ax").at(n);const r=n.value==="AX"?16:8;if(i.isRegister()){if(i.value!=="DL"&&i.value!=="DX")throw new de("expects-dx").at(i);const s=i.value==="DX"?16:8;ie(this,ks,{port:"variable",size:r,portSize:s});return}if(i.isNumberExpression()){ie(this,ks,{port:"fixed",size:r,address:i.value});return}throw new de("expects-immediate").at(i)}evaluateExpressions(n){if(!N(this,ks))throw new Error("Instruction not validated");if(N(this,Ko))throw new Error("Instruction aready evaluated");const i=N(this,ks);if(i.port==="fixed"){const r=i.address.evaluate(n);if(!Dr.inRange(r))throw new de("io-address-out-of-range",r).at(this);const s=Dr.from(r);ie(this,Ko,{port:"fixed",size:i.size,address:s})}else ie(this,Ko,{port:"variable",size:i.size,portSize:i.portSize})}},ks=new WeakMap,Ko=new WeakMap,k4);var Yo,to,C4;let UZ=(C4=class extends pu{constructor(n,i,r,s){super(i,r,s);Ue(this,Yo,null);Ue(this,to,null);be(this,"length",2);this.instruction=n}toBytes(){const n=[],i={JC:195,JNC:196,JZ:193,JNZ:34,JS:197,JNS:198,JO:199,JNO:200,JMP:192,CALL:201};return n.push(i[this.instruction]),n.push(this.address.byte.low.unsigned),new Uint8Array(n)}get address(){if(N(this,to)===null)throw new Error("Instruction not evaluated");return N(this,to)}toJSON(){return{...super.toJSON(),...N(this,to)?{address:N(this,to).toJSON()}:N(this,Yo)?{jumpTo:N(this,Yo)}:{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(N(this,Yo))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new de("expects-one-operand").at(this);const i=this.operands[0];if(!i.isNumberExpression()||!i.value.isLabel()&&!i.value.isNumberLiteral())throw new de("expects-label").at(i);if(i.value.isLabel()){const r=i.value.value,s=n.getLabelType(r);if(!s)throw new de("label-not-found",r).at(i);if(s!=="instruction")throw new de("label-should-be-an-instruction",r).at(i);ie(this,Yo,r)}else if(i.value.isNumberLiteral()){const r=i.value.value;if(!Pe.inRange(r))throw new de("address-out-of-range",r).at(i);ie(this,to,Pe.from(r))}}evaluateExpressions(n){if(!N(this,to)&&N(this,Yo)){const i=n.getLabelValue(N(this,Yo));if(!Pe.inRange(i))throw new de("address-out-of-range",i).at(this);ie(this,to,Pe.from(i))}}},Yo=new WeakMap,to=new WeakMap,C4);var no,_4;let VZ=(_4=class extends pu{constructor(n,i,r,s){super(i,r,s);Ue(this,no,null);be(this,"length",1);this.instruction=n}toBytes(){let i={PUSH:208,POP:212}[this.instruction];return i|=za(this.register),new Uint8Array([i])}get register(){if(!N(this,no))throw new Error("Instruction not evaluated");return N(this,no)}toJSON(){return{...super.toJSON(),...N(this,no)?{register:N(this,no)}:{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(N(this,no))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new de("expects-one-operand").at(this);const n=this.operands[0];if(!n.isRegister()||n.size!==8)throw new de("expects-word-register").at(n);ie(this,no,n.value)}evaluateExpressions(){if(!N(this,no))throw new Error("Instruction not validated")}},no=new WeakMap,_4);var gr,io;class HZ extends pu{constructor(n,i,r,s){super(i,r,s);Ue(this,gr,null);Ue(this,io,null);this.instruction=n}get length(){if(!N(this,gr))throw new Error("Instruction not validated");const{mode:n}=N(this,gr);let i=1;return n==="mem-direct"&&(i+=1),i}toBytes(){const n=[],i={NOT:64,NEG:66,INC:68,DEC:70};switch(n[0]=i[this.instruction],this.operation.size===16&&(n[0]|=1),this.operation.mode){case"reg":{n[0]|=za(this.operation.reg);break}case"mem-direct":{const r=this.operation.address.byte;n.push(r.low.unsigned);break}case"mem-indirect":break;default:return this.operation}return new Uint8Array(n)}get operation(){if(!N(this,io))throw new Error("Instruction not evaluated");return N(this,io)}toJSON(){return{...super.toJSON(),...N(this,io)??N(this,gr)??{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(N(this,gr))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new de("expects-one-operand").at(this);const i=this.operands[0];if(i.isRegister()){ie(this,gr,{mode:"reg",size:i.size,reg:i.value});return}if(i.isDirectAddress()){if(i.size==="auto")throw new de("unknown-size").at(i);ie(this,gr,{mode:"mem-direct",size:i.size,address:i.value});return}if(i.isIndirectAddress()){if(i.size==="auto")throw new de("unknown-size").at(i);ie(this,gr,{mode:"mem-indirect",size:i.size});return}const r=i.getAsDirectAddress(n);if(r){ie(this,gr,{mode:"mem-direct",size:r.size,address:r.expression});return}throw new de("destination-cannot-be-immediate").at(i)}evaluateExpressions(n){if(!N(this,gr))throw new Error("Instruction not validated");if(N(this,io))throw new Error("Instruction aready evaluated");const i=N(this,gr);switch(i.mode){case"reg":{ie(this,io,{mode:"reg",size:i.size,reg:i.reg});return}case"mem-direct":{const r=i.address.evaluate(n);if(!Pe.inRange(r))throw new de("address-out-of-range",r).at(i.address);const s=Pe.from(r);if(n.addressIsReserved(s))throw new de("address-has-code",s).at(i.address);ie(this,io,{mode:"mem-direct",size:i.size,address:s});return}case"mem-indirect":{ie(this,io,{mode:"mem-indirect",size:i.size});return}default:return i}}}gr=new WeakMap,io=new WeakMap;var Od;class WZ extends pu{constructor(n,i,r,s){super(i,r,s);Ue(this,Od,!1);be(this,"length",1);this.instruction=n}toBytes(){const n={PUSHF:112,POPF:120,RET:51,CLI:226,STI:227,IRET:225,NOP:240,HLT:241};return new Uint8Array([n[this.instruction]])}validate(){if(N(this,Od))throw new Error("Instruction already validated");if(this.operands.length>0)throw new de("expects-no-operands").at(this);ie(this,Od,!0)}evaluateExpressions(){if(!N(this,Od))throw new Error("Instruction not validated")}}Od=new WeakMap;class zb{constructor(e){this.position=e}isRegister(){return this.type==="register"}isIndirectAddress(){return this.type==="indirect-address"}isDirectAddress(){return this.type==="direct-address"}isNumberExpression(){return this.type==="number-expression"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}class GZ extends zb{constructor(n){super(n.position);be(this,"type","register");be(this,"value");this.value=n.type}get size(){return Zj.includes(this.value)?16:8}toJSON(){return{...super.toJSON(),value:this.value}}}class XZ extends zb{constructor(n,i){super(i);be(this,"type","indirect-address");be(this,"size");n?this.size=n==="BYTE"?8:16:this.size="auto"}toJSON(){return{...super.toJSON(),size:this.size}}}class qZ extends zb{constructor(n,i,r){super(r);be(this,"type","direct-address");be(this,"size");this.value=n,i?this.size=i==="BYTE"?8:16:this.size=8}toJSON(){return{...super.toJSON(),size:this.size,value:this.value.toJSON()}}}class fy extends zb{constructor(n){super(n.position);be(this,"type","number-expression");this.value=n}getAsDirectAddress(n){return fy.recursiveGetAsDirectAddress(this.value,n)}static recursiveGetAsDirectAddress(n,i){if(n.isLabel()){const r=n;if(r.offset)return!1;if(!i.labelExists(r.value))throw new de("label-not-found",r.value).at(n.position);const s=i.getLabelType(r.value),o=s==="DB"?8:s==="DW"?16:!1;return o?{size:o,expression:ri.label(r.value,!0,n.position)}:!1}else if(n.isBinaryOperation()){if(n.operator!=="+"&&n.operator!=="-")return!1;const r=fy.recursiveGetAsDirectAddress(n.left,i);return r?{size:r.size,expression:ri.binaryOperation(r.expression,n.operator,n.right,n.position)}:!1}return!1}toJSON(){return{...super.toJSON(),value:this.value.toJSON()}}}function $R(t,e,n){const i=En.merge(t.position,...e.map(r=>r.position));switch(t.type){case"PUSHF":case"POPF":case"RET":case"IRET":case"CLI":case"STI":case"NOP":case"HLT":return new WZ(t.type,e,n,i);case"MOV":case"ADD":case"ADC":case"SUB":case"SBB":case"CMP":case"AND":case"OR":case"XOR":return new $Z(t.type,e,n,i);case"NEG":case"INC":case"DEC":case"NOT":return new HZ(t.type,e,n,i);case"PUSH":case"POP":return new VZ(t.type,e,n,i);case"CALL":case"JZ":case"JNZ":case"JS":case"JNS":case"JC":case"JNC":case"JO":case"JNO":case"JMP":return new UZ(t.type,e,n,i);case"IN":case"OUT":return new zZ(t.type,e,n,i);case"INT":return new FZ(t.type,e,n,i)}}class KZ extends Fb{constructor(n,i){super(i);be(this,"type","origin-change");this.newAddress=n}toJSON(){return{...super.toJSON(),newAddress:this.newAddress}}}let YZ=class{constructor(e){be(this,"tokens");be(this,"current",0);this.tokens=e}parse(){this.current=0;const e=[];for(;!this.isAtEnd();)this.match("EOL")||e.push(this.statement());return e}statement(){const e=this.originChangeStatement()??this.endStatement()??this.dataBlockStatement()??this.codeBlockStatement()??this.dataDirectiveStatement()??this.instructionStatement();if(!e){const n=this.peek();throw new de("parser.expected-instruction",n).at(n)}return e}originChangeStatement(){const e=this.match("ORG");if(!e)return null;const n=this.consume("NUMBER",new de("parser.expected-address-after-org")),i=this.parseNumber(n);return this.endOfStatement(),new KZ(i,En.merge(e.position,n.position))}endStatement(){const e=this.match("END");if(!e)return null;for(;!this.isAtEnd();)if(!this.match("EOL"))throw new de("end-must-be-the-last-statement").at(e);return new Dx(e.position)}dataBlockStatement(){const e=this.match(".DATA");return e?new Dx(e.position):null}codeBlockStatement(){const e=this.match(".CODE");return e?new Dx(e.position):null}dataDirectiveStatement(){const e=this.match("IDENTIFIER"),n=this.match(...sE);if(e&&!n)throw new de("parser.unexpected-identifier").at(e);if(!n)return null;const i=(e==null?void 0:e.lexeme.toUpperCase())||null,r=[this.dataDirectiveValue()];for(;this.match("COMMA");)r.push(this.dataDirectiveValue());return this.endOfStatement(),BZ(n,r,i)}dataDirectiveValue(){if(this.match("STRING")){const e=this.previous();return new LZ(this.parseString(e),e.position)}if(this.match("QUESTION_MARK")){const e=this.previous();return new DZ(e.position)}return new jZ(this.numberExpression())}instructionStatement(){const e=this.match("LABEL");for(;this.match("EOL"););const n=this.match(...oE);if(e&&!n){const s=this.peek();throw new de("parser.expected-instruction-after-label",s).at(s)}if(!n)return null;const i=(e==null?void 0:e.lexeme.toUpperCase().slice(0,-1))||null;if(this.isAtEndOfStatement())return $R(n,[],i);const r=[this.instructionOperand()];for(;this.match("COMMA");)r.push(this.instructionOperand());return this.endOfStatement(),$R(n,r,i)}instructionOperand(){if(this.match(...dy)){const n=this.previous();return new GZ(n)}const e=this.match("BYTE","WORD");if(e&&this.consume("PTR",new de("parser.expected-literal-after-literal","PTR",this.previous().type)),this.match("LEFT_BRACKET")){const n=this.previous();if(this.check(...dy)){if(!this.check("BX","BL"))throw new de("parser.indirect-addressing-must-be-bx");const i=this.advance(),r=this.consume("RIGHT_BRACKET",new de("parser.expected-literal-after-literal","]",i.lexeme));return new XZ(e==null?void 0:e.type,En.merge(e==null?void 0:e.position,n.position,r.position))}else{const i=this.numberExpression(),r=this.consume("RIGHT_BRACKET",new de("parser.expected-literal-after-expression","]"));return new qZ(i,e==null?void 0:e.type,En.merge(e==null?void 0:e.position,n.position,r.position))}}else if(e)throw new de("parser.expected-literal-after-literal","[","PTR");return new fy(this.numberExpression())}advance(){return this.tokens[this.current++]}check(...e){if(this.isAtEnd())return!1;for(const n of e)if(this.peek().type===n)return!0;return!1}consume(e,n){Array.isArray(e)||(e=[e]);const i=this.match(...e);if(i)return i;throw n||(n=new de("parser.expected-type",e.join(","),this.peek().type)),n.at(this.peek())}endOfStatement(){if(!this.isAtEnd()){if(this.check("EOL"))return this.advance();throw new de("parser.expected-eos").at(this.peek())}}isAtEnd(){return this.peek().type==="EOF"}isAtEndOfStatement(){return this.check("EOL")||this.isAtEnd()}match(...e){return this.check(...e)?this.advance():null}parseNumber(e){return e.lexeme.at(-1)==="h"||e.lexeme.at(-1)==="H"?parseInt(e.lexeme.slice(0,-1),16):e.lexeme.at(-1)==="b"||e.lexeme.at(-1)==="B"?parseInt(e.lexeme.slice(0,-1),2):parseInt(e.lexeme,10)}parseString(e){return e.lexeme.slice(1,-1)}peek(){return this.tokens[this.current]}previous(){return this.tokens[this.current-1]}primaryNE(){if(this.match("NUMBER")){const i=this.previous(),r=this.parseNumber(i);return ri.numberLiteral(r,i.position)}if(this.match("CHARACTER")){const i=this.previous(),r=Fp(i.lexeme.slice(1,-1));return ri.numberLiteral(r,i.position)}if(this.match("LEFT_PAREN")){const i=this.numberExpression();return this.consume("RIGHT_PAREN",new de("parser.unclosed-parenthesis")),i}const e=this.match("OFFSET"),n=this.match("IDENTIFIER");if(e&&!n)throw new de("parser.expected-label-after-offset").at(this.peek());if(!n)throw new de("parser.expected-argument").at(this.peek());return ri.label(n.lexeme.toUpperCase(),e!==null,En.merge(e==null?void 0:e.position,n.position))}unaryNE(){if(this.match("PLUS","MINUS")){const e=this.previous();if(this.check("PLUS","MINUS"))throw new de("parser.ambiguous-unary").at(this.peek());const n=this.unaryNE();return ri.unaryOperation(e.type==="PLUS"?"+":"-",n,En.merge(e.position,n.position))}return this.primaryNE()}factorNE(){let e=this.unaryNE();for(;this.match("ASTERISK");){const n=this.unaryNE();e=ri.binaryOperation(e,"*",n,En.merge(e.position,n.position))}return e}termNE(){let e=this.factorNE();for(;this.match("PLUS","MINUS");){const n=this.previous(),i=this.factorNE();e=ri.binaryOperation(e,n.type==="PLUS"?"+":"-",i,En.merge(e.position,i.position))}return e}numberExpression(){return this.termNE()}};function e8(t){try{const n=new PZ(t).scanTokens(),r=new YZ(n).parse();if(!r.at(-1))throw new de("empty-program");let o=[];const a=new CZ;if(o=a.loadStatements(r),o.length>0)return{success:!1,errors:o};if(o=Up(r,u=>{u.isOriginChange()||u.isEnd()||u.validate(a)},de.from),o.length>0)return{success:!1,errors:o};if(o=a.computeAddresses(r),o.length>0)return{success:!1,errors:o};const l=[],c=[];return o=Up(r,u=>{if(u.isDataDirective())if(u.directive==="EQU")u.evaluateExpressions(a);else{const d=u.evaluateExpressions(a);return l.push(u),d}else u.isInstruction()&&(u.evaluateExpressions(a),c.push(u))},de.from),o.length>0?{success:!1,errors:o}:{success:!0,data:l,instructions:c,hasORG:a.hasOriginDirective(),hasORG20hAtStart:a.hasORG20hAtStart(),mayUsePIC:a.mayUsePIC()}}catch(e){return{success:!1,errors:[de.from(e)]}}}class Us{constructor(e){be(this,"computer");this.computer=e.computer}}const JZ=t=>Pe.format(t).slice(-2),ZZ=JZ(Pe.MAX_ADDRESS),QZ={"address-has-instruction":t=>`Memory address ${Pe.format(t)} has an instruction, and cannot be written.`,"address-is-reserved":t=>`Memory address ${Pe.format(t)} is reserved, and cannot be written.`,"address-out-of-range":t=>`Memory address ${Pe.format(t)} is out of range (max memory address: ${ZZ}).`,"device-not-connected":t=>`"${t}" is not connected to the computer.`,"io-memory-not-connected":t=>`Didn't found a module connected to I/O memory address ${Dr.format(t)}.`,"io-printer-conflict":()=>"Printer must be connected to either the PIO or the Handshake, but not both.","no-instruction":t=>`Expected instruction at memory address ${Pe.format(t)} but none was found.`,"no-program":"No program loaded. Assemble before running.","stack-overflow":"Stack overflow","stack-underflow":"Stack underflow","unexpected-error":t=>`Unexpected error: ${String(t)}`},eQ=Pe.from(Pe.MAX_ADDRESS).toString(),tQ={"address-has-instruction":t=>`La dirección de memoria ${Pe.format(t)} tiene una instrucción, y no se puede escribir.`,"address-is-reserved":t=>`La dirección de memoria ${Pe.format(t)} está reservada, y no se puede escribir.`,"address-out-of-range":t=>`La dirección de memoria ${Pe.format(t)} está fuera de rango (dirección máxima de memoria: ${eQ}).`,"device-not-connected":t=>`"${t}" no está conectado a la computadora.`,"io-memory-not-connected":t=>`No se encontró ningún módulo conectado a la dirección de memoria E/S ${Dr.format(t)}.`,"io-printer-conflict":()=>"La impresora debe estar conectada a la PIO o al Handshake, pero no a ambos.","no-instruction":t=>`Se esperaba una instrucción en la dirección de memoria ${Pe.format(t)} pero no se encontró ninguna.`,"no-program":"No hay ningún programa cargado. Ensamblá antes de ejecutar.","stack-overflow":"Stack overflow","stack-underflow":"Stack underflow","unexpected-error":t=>`Error inesperado: ${String(t)}`},nQ=Q_({en:QZ,es:tQ});class mn extends Error{constructor(n,...i){super();be(this,"code");be(this,"context");this.code=n,this.context=i,n==="unexpected-error"&&console.error("[Unexpected Simulator Error]",...i)}translate(n){return nQ(n,this.code,...this.context)}get message(){return this.translate("en")}toString(){return this.message}static from(n){return n instanceof mn?n:new mn("unexpected-error",n)}}class ka{constructor(e){this.statement=e}get name(){return this.statement.instruction}get start(){return this.statement.start}get position(){return this.statement.position}*consumeInstruction(e,n,i){if(yield*e.cpu.setMAR("IP"),!(yield*e.cpu.useBus("mem-read"))){const s=e.cpu.getRegister("IP").toString("hex");throw new mn("unexpected-error",`Could not read instruction byte at address ${s}h`)}yield*e.cpu.updateWordRegister("IP",s=>s.add(1)),i||(yield*e.cpu.getMBR(n))}}var eb,t8;class iQ extends ka{constructor(){super(...arguments);Ue(this,eb)}get operation(){return this.statement.operation}*execute(n){const{mode:i,size:r,out:s,src:o}=this.operation;if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:zt(this,eb,t8).call(this),willUse:{id:this.operation.mode==="mem<-imd"&&(this.operation.out.mode==="direct"||this.operation.out.mode==="indirect"),ri:this.operation.mode==="mem<-imd"&&this.operation.out.mode==="direct"&&this.name!=="CMP"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},i==="mem<-imd"&&s.mode==="direct"){if(yield*this.consumeInstruction(n,"ri.l"),yield*this.consumeInstruction(n,"id.l"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.l"),yield*n.cpu.copyByteRegister("id.l","right.l"),yield{type:"cpu:cycle.update",phase:"execute"};const d=n.cpu.getRegister("left.l"),f=n.cpu.getRegister("right.l");let p;const m={};switch(this.name){case"AND":case"OR":case"XOR":{const g=this.name==="AND"?d.signed&f.signed:this.name==="OR"?d.signed|f.signed:d.signed^f.signed;p=H.fromSigned(g,r),m.CF=!1,m.OF=!1;break}case"ADD":case"ADC":{const g=this.name==="ADC"&&n.cpu.getFlag("CF")?1:0,y=d.unsigned+f.unsigned+g;y>H.maxValue(r)?(m.CF=!0,p=H.fromUnsigned(y-H.maxValue(r)-1,r)):(m.CF=!1,p=H.fromUnsigned(y,r)),m.OF=d.signed>=0&&f.signed>=0&&p.signed<0||d.signed<0&&f.signed<0&&p.signed>=0;break}case"SUB":case"SBB":case"CMP":{const g=this.name==="SBB"&&n.cpu.getFlag("CF")?1:0,y=d.unsigned-f.unsigned-g;y<0?(m.CF=!0,p=H.fromUnsigned(y+H.maxValue(r)+1,r)):(m.CF=!1,p=H.fromUnsigned(y,r)),m.OF=d.signed>=0&&f.signed<0&&p.signed<0||d.signed<0&&f.signed>=0&&p.signed>=0;break}}return m.ZF=p.isZero(),m.SF=p.signed<0,yield*n.cpu.aluExecute(this.name==="CMP"?"SUB":this.name,p,m),this.name==="CMP"?!0:(yield{type:"cpu:cycle.update",phase:"writeback"},yield*n.cpu.setMBR("result.l"),!!(yield*n.cpu.useBus("mem-write")))}if(i==="mem<-imd"&&s.mode==="indirect"&&(yield*this.consumeInstruction(n,"ri.l",!0)),i==="reg<-reg"||i==="reg<-mem"||i==="reg<-imd")i!=="reg<-mem"?r===8?yield*n.cpu.copyByteRegister(s,"left.l"):yield*n.cpu.copyWordRegister(s,"left"):(typeof window<"u"&&window.setShowPath2&&i==="reg<-mem"&&o.mode==="direct"&&window.setShowPath2(!0),typeof window<"u"&&window.setShowPath2&&i==="reg<-mem"&&o.mode==="direct"&&window.setShowPath2(!1));else{if(s.mode==="direct"?yield*this.consumeInstruction(n,"ri.l"):this.operation.mode==="mem<-imd"&&s.mode==="indirect"||(yield*n.cpu.copyByteRegister("BL","ri.l")),this.operation.mode==="mem<-imd"&&s.mode==="indirect"&&(yield*n.cpu.copyByteRegister("BL","ri.l"),yield*n.cpu.getMBR("id.l")),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(this.operation.mode==="mem<-imd"?yield*n.cpu.getMBR("left.l"):yield*n.cpu.getMBR("left.l"),r===16){if(yield*n.cpu.updateWordRegister("ri",d=>d.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.h")}}if(i==="reg<-reg"||i==="mem<-reg")r===8?yield*n.cpu.copyByteRegister(o,"right.l"):yield*n.cpu.copyWordRegister(o,"right");else if(i==="reg<-imd"||i==="mem<-imd")i==="mem<-imd"&&s.mode==="indirect"?yield*n.cpu.copyByteRegister("id.l","right.l"):yield*this.consumeInstruction(n,"right.l"),r===16&&(yield*this.consumeInstruction(n,"right.h"));else{if(o.mode==="direct"?yield*this.consumeInstruction(n,"ri.l"):yield*n.cpu.copyByteRegister("BL","ri.l"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("right.l"),r===16){if(yield*n.cpu.updateWordRegister("ri",d=>d.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("right.h")}i==="reg<-mem"&&(r===8?yield*n.cpu.copyByteRegister(s,"left.l"):yield*n.cpu.copyWordRegister(s,"left"))}yield{type:"cpu:cycle.update",phase:"execute"};const a=r===8?n.cpu.getRegister("left.l"):n.cpu.getRegister("left"),l=r===8?n.cpu.getRegister("right.l"):n.cpu.getRegister("right");let c;const u={};switch(this.name){case"AND":case"OR":case"XOR":{const d=this.name==="AND"?a.signed&l.signed:this.name==="OR"?a.signed|l.signed:a.signed^l.signed;c=H.fromSigned(d,r),u.CF=!1,u.OF=!1;break}case"ADD":case"ADC":{const d=this.name==="ADC"&&n.cpu.getFlag("CF")?1:0,f=a.unsigned+l.unsigned+d;f>H.maxValue(r)?(u.CF=!0,c=H.fromUnsigned(f-H.maxValue(r)-1,r)):(u.CF=!1,c=H.fromUnsigned(f,r)),u.OF=a.signed>=0&&l.signed>=0&&c.signed<0||a.signed<0&&l.signed<0&&c.signed>=0;break}case"SUB":case"SBB":case"CMP":{const d=this.name==="SBB"&&n.cpu.getFlag("CF")?1:0,f=a.unsigned-l.unsigned-d;f<0?(u.CF=!0,c=H.fromUnsigned(f+H.maxValue(r)+1,r)):(u.CF=!1,c=H.fromUnsigned(f,r)),u.OF=a.signed>=0&&l.signed<0&&c.signed<0||a.signed<0&&l.signed>=0&&c.signed>=0;break}}if(u.ZF=c.isZero(),u.SF=c.signed<0,yield*n.cpu.aluExecute(this.name==="CMP"?"SUB":this.name,c,u),this.name==="CMP")return!0;if(yield{type:"cpu:cycle.update",phase:"writeback"},i==="reg<-reg"||i==="reg<-mem"||i==="reg<-imd")r===8?yield*n.cpu.copyByteRegister("result.l",s):yield*n.cpu.copyWordRegister("result",s);else{if(r===16){if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.h"),!(yield*n.cpu.useBus("mem-write")))return!1;yield*n.cpu.updateWordRegister("ri",d=>d.add(-1))}if(yield*n.cpu.setMBR("result.l"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-write")))return!1}return!0}}eb=new WeakSet,t8=function(){const{mode:n,out:i,src:r}=this.operation;switch(n){case"reg<-reg":return[i,r];case"reg<-mem":{const s=r.mode==="direct"?r.address.toString():"BL";return[i,`[${s}]`]}case"reg<-imd":return[i,`${r.toString("hex")}h`];case"mem<-reg":return[`[${i.mode==="direct"?i.address.toString():"BL"}]`,r];case"mem<-imd":return[`[${i.mode==="direct"?i.address.toString():"BL"}]`,`${r.toString("hex")}h`];default:return n}};var tb,n8;class rQ extends ka{constructor(){super(...arguments);Ue(this,tb)}get operation(){return this.statement.operation}*execute(n){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:zt(this,tb,n8).call(this),willUse:{ri:!1}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},this.operation.mode==="reg")this.operation.size===8?yield*n.cpu.copyByteRegister(this.operation.reg,"left.l"):yield*n.cpu.copyWordRegister(this.operation.reg,"left");else{if(this.operation.mode==="mem-direct"?yield*this.consumeInstruction(n,"ri.l"):yield*n.cpu.copyByteRegister("BL","ri.l"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("left.l"),this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",o=>o.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.h")}}yield{type:"cpu:cycle.update",phase:"execute"};const i=this.operation.size===8?n.cpu.getRegister("left.l"):n.cpu.getRegister("left");let r;const s={};switch(this.name){case"NOT":{r=H.fromSigned(~i.signed,this.operation.size),s.CF=!1,s.OF=!1;break}case"NEG":{r=H.fromSigned(-i.signed,this.operation.size),s.CF=!i.isZero(),s.OF=i.signed===H.minSignedValue(this.operation.size);break}case"INC":{yield*n.cpu.updateWordRegister("right",H.fromSigned(1,16));const o=i.unsigned+1;o>H.maxValue(this.operation.size)?(s.CF=!0,r=H.fromUnsigned(o-H.maxValue(this.operation.size)-1,this.operation.size)):(s.CF=!1,r=H.fromUnsigned(o,this.operation.size)),s.OF=i.signed>=0&&r.signed<0;break}case"DEC":{yield*n.cpu.updateWordRegister("right",H.fromSigned(1,16));const o=i.unsigned-1;o<0?(s.CF=!0,r=H.fromUnsigned(o+H.maxValue(this.operation.size)+1,this.operation.size)):(s.CF=!1,r=H.fromUnsigned(o,this.operation.size)),s.OF=i.signed<0&&r.signed>=0;break}}if(s.ZF=r.isZero(),s.SF=r.signed<0,yield*n.cpu.aluExecute(this.name==="INC"?"ADD":this.name==="DEC"?"SUB":this.name,r,s),yield{type:"cpu:cycle.update",phase:"writeback"},this.operation.mode==="reg")this.operation.size===8?yield*n.cpu.copyByteRegister("result.l",this.operation.reg):yield*n.cpu.copyWordRegister("result",this.operation.reg);else{if(this.operation.size===16){if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.h"),!(yield*n.cpu.useBus("mem-write")))return!1;yield*n.cpu.updateWordRegister("ri",o=>o.add(-1))}if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.l"),!(yield*n.cpu.useBus("mem-write")))return!1}return!0}}tb=new WeakSet,n8=function(){switch(this.operation.mode){case"reg":return[this.operation.reg];case"mem-direct":return[`[${this.operation.address.toString()}]`];case"mem-indirect":return["[BL]"];default:return this.operation}};class sQ extends ka{get number(){return this.statement.value}*execute(e){return yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[this.number.toString("uint")],willUse:{ri:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},yield*super.consumeInstruction(e,"ri.l"),yield{type:"cpu:cycle.update",phase:"execute"},yield*e.cpu.startInterrupt(this.number)}}var nb,i8;class oQ extends ka{constructor(){super(...arguments);Ue(this,nb)}get operation(){return this.statement.operation}*execute(n){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:zt(this,nb,i8).call(this),willUse:{ri:!1}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},this.operation.port==="fixed")yield*super.consumeInstruction(n,"ri.l");else if(yield*n.cpu.copyByteRegister("DL","ri.l"),!n.cpu.getRegister("DX").high.isZero())return yield{type:"cpu:error",error:new mn("io-memory-not-connected",n.cpu.getRegister("DX"))},!1;if(yield{type:"cpu:cycle.update",phase:"writeback"},this.name==="IN"){if(yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("io-read")))return!1;if(yield*n.cpu.getMBR("AL"),this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",i=>i.add(1)),yield*n.cpu.setMAR("ri"),!n.cpu.getRegister("ri.h").isZero())return yield{type:"cpu:error",error:new mn("io-memory-not-connected",n.cpu.getRegister("ri"))},!1;if(!(yield*n.cpu.useBus("io-read")))return!1;yield*n.cpu.getMBR("AH")}}else{if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("AL"),!(yield*n.cpu.useBus("io-write")))return!1;if(this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",i=>i.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("AH"),!n.cpu.getRegister("ri.h").isZero())return yield{type:"cpu:error",error:new mn("io-memory-not-connected",n.cpu.getRegister("ri"))},!1;if(!(yield*n.cpu.useBus("io-write")))return!1}}return!0}}nb=new WeakSet,i8=function(){const n=[];return this.operation.port==="variable"?n.push(this.operation.portSize===8?"DL":"DX"):n.push(this.operation.address.toString()),this.operation.size===8?n.push("AL"):n.push("AX"),this.name==="IN"?n.reverse():n};class aQ extends ka{get jumpTo(){return this.statement.address}*execute(e){yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[this.jumpTo.toString(!1)],willUse:{id:!1,ri:this.name==="CALL"}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},yield*super.consumeInstruction(e,"ri.l",!1),yield{type:"cpu:cycle.update",phase:"execute"};let n;switch(this.name){case"JC":n=e.cpu.getFlag("CF");break;case"JNC":n=!e.cpu.getFlag("CF");break;case"JZ":n=e.cpu.getFlag("ZF");break;case"JNZ":n=!e.cpu.getFlag("ZF");break;case"JS":n=e.cpu.getFlag("SF");break;case"JNS":n=!e.cpu.getFlag("SF");break;case"JO":n=e.cpu.getFlag("OF");break;case"JNO":n=!e.cpu.getFlag("OF");break;case"CALL":case"JMP":n=!0;break;default:return this.name}if(n)if(this.name==="CALL"){if(!(yield*e.cpu.pushToStack("IP.l")))return!1;yield*e.cpu.copyByteRegister("ri.l","IP.l")}else yield*e.cpu.getMBR("ri.l"),yield*e.cpu.copyByteRegister("ri.l","IP.l");return!0}}class lQ extends ka{*execute(e){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[],willUse:{}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},this.name==="CLI")yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield*e.cpu.updateFLAGS({IF:!1});else if(this.name==="STI")yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield*e.cpu.updateFLAGS({IF:!0});else if(this.name==="HLT")return yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield{type:"cpu:halt"},yield{type:"cpu:cycle.end"},!1;return!0}}function G2(t){switch(t){case"AL":return["AX","low"];case"AH":return["AX","high"];case"BL":return["BX","low"];case"BH":return["BX","high"];case"CL":return["CX","low"];case"CH":return["CX","high"];case"DL":return["DX","low"];case"DH":return["DX","high"];default:{const[e,n]=t.split(".");return e==="MBR"?[e,null]:[e,n==="l"?"low":n==="h"?"high":null]}}}function jx(t){switch(t){case"AX":return["AL","AH"];case"BX":return["BL","BH"];case"CX":return["CL","CH"];case"DX":return["DL","DH"];case"SP":return["SP.l","SP.h"];case"IP":return["IP.l","IP.h"];case"ri":return["ri.l","ri.h"];case"id":return["id.l","id.h"];case"left":return["left.l","left.h"];case"right":return["right.l","right.h"];case"result":return["result.l","result.h"];case"FLAGS":return["FLAGS.l","FLAGS.h"];default:return[t,null]}}var ib,r8;class cQ extends ka{constructor(){super(...arguments);Ue(this,ib)}get operation(){return this.statement.operation}*execute(n){const{mode:i,size:r,out:s,src:o}=this.operation;switch(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:zt(this,ib,r8).call(this),willUse:{id:!1,ri:this.operation.mode==="mem<-imd"&&this.operation.out.mode==="direct"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},(this.operation.mode==="reg<-mem"||this.operation.mode==="mem<-reg"||this.operation.mode==="mem<-imd")&&((this.operation.mode==="reg<-mem"?this.operation.src.mode:this.operation.out.mode)==="direct"?yield*super.consumeInstruction(n,"ri.l"):(this.operation.mode==="mem<-reg"||this.operation.mode==="reg<-mem")&&(yield*n.cpu.copyByteRegister("BL","ri.l"))),this.operation.mode==="reg<-imd"&&(yield{type:"cpu:cycle.update",phase:"writeback"},r===8&&typeof s=="string"&&(yield*super.consumeInstruction(n,s)),this.operation.size===16&&(yield*super.consumeInstruction(n,"id.h"))),this.operation.mode==="mem<-imd"&&(yield*super.consumeInstruction(n,"ri.l",!0),this.operation.size===16&&(yield*super.consumeInstruction(n,"id.h"))),i){case"reg<-reg":{if(yield{type:"cpu:cycle.update",phase:"writeback"},r===8)yield{type:"cpu:register.buscopy",src:o,dest:s,size:8};else{const[a,l]=jx(o),[c,u]=jx(s);yield{type:"cpu:register.buscopy",src:a,dest:c,size:8},l&&u&&(yield{type:"cpu:register.buscopy",src:l,dest:u,size:8})}return!0}case"reg<-mem":return yield*n.cpu.setMAR("ri"),(yield*n.cpu.useBus("mem-read"))?(yield{type:"cpu:cycle.update",phase:"writeback"},r===8&&(yield*n.cpu.getMBR(s)),!0):!1;case"reg<-imd":return r===16&&(yield*n.cpu.setMBR("id.h")),!0;case"mem<-reg":{const[a]=jx(o);return yield*n.cpu.setMAR("ri"),yield{type:"cpu:cycle.update",phase:"writeback"},yield*n.cpu.setMBR(a),!!(yield*n.cpu.useBus("mem-write"))}case"mem<-imd":return s.mode==="direct"||(yield*n.cpu.copyByteRegister("BL","ri.l")),yield*n.cpu.setMAR("ri"),yield{type:"cpu:cycle.update",phase:"writeback"},!(!(yield*n.cpu.useBus("mem-write"))||r===16&&(yield*n.cpu.updateWordRegister("ri",a=>a.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("id.h"),!(yield*n.cpu.useBus("mem-write"))));default:return i}}}ib=new WeakSet,r8=function(){const{mode:n,out:i,src:r}=this.operation;switch(n){case"reg<-reg":return[i,r];case"reg<-mem":{const s=r.mode==="direct"?r.address.toString():"BL";return[i,`[${s}]`]}case"reg<-imd":return[i,`${r.toString("hex")}h`];case"mem<-reg":return[`[${i.mode==="direct"?i.address.toString():"BL"}]`,r];case"mem<-imd":return[`[${i.mode==="direct"?i.address.toString():"BL"}]`,`${r.toString("hex")}h`];default:return n}};class uQ extends ka{*execute(e){return yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[],willUse:{id:!1}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},!(!(yield*e.cpu.popFromStack("IP.l"))||this.name==="IRET"&&!(yield*e.cpu.popFromStack("FLAGS.l")))}}class dQ extends ka{*execute(e){const n=this.statement.instruction==="PUSH"||this.statement.instruction==="POP"?this.statement.register:"FLAGS";if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:n!=="FLAGS"?[n]:[],willUse:{id:!1}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},this.name==="PUSH"||this.name==="PUSHF"){const i=n==="FLAGS"?"FLAGS.l":`${n[0]}L`;return yield*e.cpu.pushToStack(i,!0)}else{const i=n==="FLAGS"?"FLAGS.l":`${n[0]}L`;return!!(yield*e.cpu.popFromStack(i))}}}function fQ(t){switch(t.instruction){case"MOV":return new cQ(t);case"AND":case"OR":case"XOR":case"ADD":case"ADC":case"SUB":case"SBB":case"CMP":return new iQ(t);case"NOT":case"NEG":case"INC":case"DEC":return new rQ(t);case"IN":case"OUT":return new oQ(t);case"PUSH":case"POP":case"PUSHF":case"POPF":return new dQ(t);case"JC":case"JNC":case"JZ":case"JNZ":case"JS":case"JNS":case"JO":case"JNO":case"JMP":case"CALL":return new aQ(t);case"RET":case"IRET":return new uQ(t);case"INT":return new sQ(t);case"CLI":case"STI":case"NOP":case"HLT":return new lQ(t)}}function hQ(t){for(const[e,n]of rE)if(n.unsigned===t.unsigned)return e;return null}function*pQ(t,e){switch(e){case 0:return yield{type:"cpu:int.0"},!1;case 6:{if(yield{type:"cpu:int.6"},!("keyboard"in t.io))return yield{type:"cpu:error",error:new mn("device-not-connected","keyboard")},!1;if(yield*t.cpu.setMAR("IP"),!(yield*t.cpu.useBus("mem-read"))||(yield*t.cpu.updateWordRegister("IP",r=>r.add(1)),yield*t.cpu.getMBR("IR"),!(yield*t.cpu.pushToStack("AL"))))return!1;const n=t.io.keyboard;if(!n)return yield{type:"cpu:error",error:new mn("device-not-connected","keyboard")},!1;const i=yield*n.readChar();if(yield*t.cpu.updateByteRegister("AL",i),yield*t.cpu.copyByteRegister("BL","ri.l"),yield*t.cpu.setMAR("ri"),yield*t.cpu.setMBR("AL"),!(yield*t.cpu.useBus("mem-write"))||!(yield*t.cpu.popFromStack("AL")))return!1;break}case 7:{if(yield{type:"cpu:int.7"},!("screen"in t.io))return yield{type:"cpu:error",error:new mn("device-not-connected","screen")},!1;if(!(yield*t.cpu.pushToStack("DL")))return!1;let n=216;for(;!t.cpu.getRegister("AL").isZero();){if(yield*t.cpu.copyByteRegister("BL","ri.l"),yield*t.cpu.setMAR("ri"),!(yield*t.cpu.useBus("mem-read"))||(yield*t.cpu.getMBR("DL"),yield*t.cpu.updateByteRegister("ri.l",H.fromUnsigned(n,8)),yield*t.cpu.setMAR("ri"),yield*t.cpu.setMBR("DL"),!(yield*t.cpu.useBus("mem-write"))))return!1;const i=t.cpu.getRegister("DL");if(t.io.screen)yield*t.io.screen.sendChar(i);else return yield{type:"cpu:error",error:new mn("device-not-connected","screen")},!1;n++,yield*t.cpu.copyByteRegister("BL","left.l"),yield*t.cpu.updateWordRegister("right",H.fromUnsigned(1,16));const r=t.cpu.getRegister("BX").add(1);yield*t.cpu.aluExecute("ADD",r,{CF:!1,OF:r.signed<0,SF:r.signed<0,ZF:!1}),yield*t.cpu.copyByteRegister("result.l","BL"),yield*t.cpu.copyByteRegister("AL","left.l"),yield*t.cpu.updateByteRegister("right.l",H.fromUnsigned(1,8));const s=t.cpu.getRegister("AL").add(-1);yield*t.cpu.aluExecute("SUB",s,{CF:!1,OF:s.signed===H.maxSignedValue(8),SF:s.signed<0,ZF:s.isZero()}),yield*t.cpu.copyByteRegister("result.l","AL")}if(!(yield*t.cpu.popFromStack("DL")))return!1;break}default:throw new Error("Invalid interrupt number")}return!(!(yield*t.cpu.popFromStack("IP.l"))||!(yield*t.cpu.popFromStack("FLAGS.l")))}var Ld,ft,Hr,Ji,Cn,kc,zr,E4;let mQ=(E4=class extends Us{constructor(n){super(n);Ue(this,Cn);Ue(this,Ld);Ue(this,ft);Ue(this,Hr);Ue(this,Ji);n.data==="unchanged"?(ie(this,ft,N(n.previous.cpu,ft)),ie(this,Hr,N(n.previous.cpu,Hr)),ie(this,Ji,N(n.previous.cpu,Ji))):(ie(this,ft,{AX:H.zero(16),BX:H.zero(16),CX:H.zero(16),DX:H.zero(16),SP:H.zero(16),IP:H.zero(16),IR:H.zero(8),ri:H.zero(16),id:H.zero(16),left:H.zero(16),right:H.zero(16),result:H.zero(16),FLAGS:H.zero(16)}),ie(this,Hr,H.zero(16)),ie(this,Ji,H.zero(8))),N(this,ft).SP=H.fromUnsigned(Pe.MAX_ADDRESS,16);const i=n.program.instructions.some(u=>u.isInstruction()&&u.instruction==="INT"),r=n.hasORG20hAtStart??!1,s=n.hasINTOrInterruptDevices??i,o=n.devices.pic,a=n.program.instructions.length>0?n.program.instructions[0]:null,l=a?typeof a.start=="number"?a.start:a.start.value:0;console.log("DEBUG CPU:",{hasINT:i,hasORG20hAtStart:r,hasORG:n.hasORG,hasINTOrInterruptDevices:s,hasPICConfig:o,firstInstructionAddress:"0x"+l.toString(16).padStart(2,"0"),devices:n.devices,instructionsCount:n.program.instructions.length,firstFewInstructions:n.program.instructions.slice(0,3).map(u=>({type:u.type,instruction:u.isInstruction()?u.instruction:"not-instruction",start:"0x"+(typeof u.start=="number"?u.start:u.start.value).toString(16).padStart(2,"0")}))});let c;r?(c=32,console.log("IP set to 0x20 (hasORG20hAtStart)")):(s||o)&&l>=8?(c=8,console.log("IP set to 0x08 (INT/PIC + code at 08h+)")):(c=l,console.log(`IP set to 0x${c.toString(16).padStart(2,"0")} (first instruction address)`)),N(this,ft).IP=H.fromUnsigned(c,16),N(this,ft).ri=H.fromUnsigned(0,16),N(this,ft).id=H.fromUnsigned(0,16),zt(this,Cn,zr).call(this,"IF",!0),ie(this,Ld,new Map);for(const u of n.program.instructions){const d=fQ(u);N(this,Ld).set(d.start.value,d)}}*run(){var n;for(;;){const i=N(this,ft).IP,r=hQ(i);if(r!==null){if(!(yield*pQ(this.computer,r)))return}else{const s=N(this,Ld).get(i.unsigned);if(!s){yield{type:"cpu:error",error:new mn("no-instruction",N(this,ft).IP)};return}if(!(yield*s.execute(this.computer)))return}if(this.getFlag("IF")&&((n=this.computer.io.pic)!=null&&n.isINTRActive())){yield{type:"cpu:cycle.interrupt"};const s=yield*this.computer.io.pic.handleINTR();yield*this.getMBR("ri.l"),yield*this.updateByteRegister("ri.h",H.zero(8)),yield*this.startInterrupt(s)}yield{type:"cpu:cycle.end"}}}*startInterrupt(n){if(!(yield*this.pushToStack("FLAGS.l"))||(yield*this.updateFLAGS({IF:!1}),!(yield*this.pushToStack("IP.l"))))return!1;const i=H.fromUnsigned(n.unsigned,8);return zt(this,Cn,kc).call(this,"ri.l",i),yield*this.setMAR("ri"),(yield*this.useBus("mem-read"))?(yield*this.getMBR("IP.l"),!0):!1}toJSON(){return{...Object.entries(N(this,ft)).reduce((i,[r,s])=>({...i,[r]:s.toJSON()}),{}),MAR:N(this,Hr).toJSON(),MBR:N(this,Ji).toJSON()}}getRegister(n){const[i,r]=G2(n);return r==="low"?N(this,ft)[i].low:r==="high"?N(this,ft)[i].high:N(this,ft)[i]}*copyByteRegister(n,i){const r=this.getRegister(n);zt(this,Cn,kc).call(this,i,r),yield{type:"cpu:register.copy",size:8,src:n,dest:i}}*copyWordRegister(n,i){const r=this.getRegister(n);zt(this,Cn,kc).call(this,i,r.withHigh(H.zero(8))),yield{type:"cpu:register.copy",size:16,src:n,dest:i}}*updateByteRegister(n,i){i=typeof i=="function"?i(this.getRegister(n)):i,zt(this,Cn,kc).call(this,n,i),yield{type:"cpu:register.update",size:8,register:n,value:i}}*updateWordRegister(n,i){i=typeof i=="function"?i(this.getRegister(n)):i,zt(this,Cn,kc).call(this,n,i),yield{type:"cpu:register.update",size:16,register:n,value:i}}getFlag(n){switch(n){case"CF":return N(this,ft).FLAGS.bit(1);case"ZF":return N(this,ft).FLAGS.bit(0);case"SF":return N(this,ft).FLAGS.bit(3);case"IF":return N(this,ft).FLAGS.bit(4);case"OF":return N(this,ft).FLAGS.bit(2);default:throw new TypeError(`Invalid flag ${n}`)}}*updateFLAGS(n){typeof n.CF=="boolean"&&zt(this,Cn,zr).call(this,"CF",n.CF),typeof n.ZF=="boolean"&&zt(this,Cn,zr).call(this,"ZF",n.ZF),typeof n.SF=="boolean"&&zt(this,Cn,zr).call(this,"SF",n.SF),typeof n.IF=="boolean"&&zt(this,Cn,zr).call(this,"IF",n.IF),typeof n.OF=="boolean"&&zt(this,Cn,zr).call(this,"OF",n.OF),yield{type:"cpu:register.update",size:16,register:"FLAGS",value:N(this,ft).FLAGS}}*aluExecute(n,i,r){N(this,ft).result=i.is8bits()?N(this,ft).result.withLow(i):i,typeof r.CF=="boolean"&&zt(this,Cn,zr).call(this,"CF",r.CF),typeof r.ZF=="boolean"&&zt(this,Cn,zr).call(this,"ZF",r.ZF),typeof r.SF=="boolean"&&zt(this,Cn,zr).call(this,"SF",r.SF),typeof r.IF=="boolean"&&zt(this,Cn,zr).call(this,"IF",r.IF),typeof r.OF=="boolean"&&zt(this,Cn,zr).call(this,"OF",r.OF),yield{type:"cpu:alu.execute",operation:n,size:i.size,result:N(this,ft).result,flags:N(this,ft).FLAGS}}*setMAR(n){const i=this.getRegister(n);ie(this,Hr,i.withHigh(H.zero(8))),yield{type:"cpu:mar.set",register:n}}*getMBR(n){zt(this,Cn,kc).call(this,n,N(this,Ji)),yield{type:"cpu:mbr.get",register:n}}*setMBR(n){const i=this.getRegister(n);ie(this,Ji,i),yield{type:"cpu:mbr.set",register:n}}*useBus(n){switch(n){case"mem-read":{yield{type:"cpu:rd.on"};const i=yield*this.computer.memory.read(N(this,Hr));return i?(ie(this,Ji,i),yield{type:"bus:reset"},!0):!1}case"mem-write":return yield{type:"cpu:wr.on"},(yield*this.computer.memory.write(N(this,Hr),N(this,Ji)))?(yield{type:"bus:reset"},!0):!1;case"io-read":{yield{type:"cpu:iom.on"};const i=yield*this.computer.io.chipSelect(N(this,Hr).low);if(!i)return!1;yield{type:"cpu:rd.on"};const r=yield*this.computer.io.read(i);return r?(ie(this,Ji,r),yield{type:"bus:reset"},!0):!1}case"io-write":{yield{type:"cpu:iom.on"};const i=yield*this.computer.io.chipSelect(N(this,Hr).low);return!i||(yield{type:"cpu:wr.on"},!(yield*this.computer.io.write(i,N(this,Ji))))?!1:(yield{type:"bus:reset"},!0)}case"intr-read":{if(!this.computer.io.pic)return!1;const i=yield*this.computer.io.pic.handleINTR();return ie(this,Ji,i),yield{type:"bus:reset"},!0}default:return n}}*pushToStack(n,i=!1){let r=this.getRegister("SP");if(!Pe.inRange(r.unsigned-1))return yield{type:"cpu:error",error:new mn("stack-overflow")},!1;if(i){if(yield*this.setMAR("SP"),yield*this.setMBR(n),r=r.add(-1),yield*this.updateWordRegister("SP",r),!(yield*this.useBus("mem-write")))return!1}else if(r=r.add(-1),yield*this.updateWordRegister("SP",r),yield*this.setMBR(n),yield*this.setMAR("SP"),!(yield*this.useBus("mem-write")))return!1;return Pe.inRange(r.unsigned-1)?!0:(yield{type:"cpu:error",error:new mn("stack-overflow")},!1)}*popFromStack(n){let i=this.getRegister("SP");return Pe.inRange(i)?(yield*this.setMAR("SP"),(yield*this.useBus("mem-read"))?(yield*this.getMBR(n),i=i.add(1),yield*this.updateWordRegister("SP",i),!0):!1):(yield{type:"cpu:error",error:new mn("stack-underflow")},!1)}},Ld=new WeakMap,ft=new WeakMap,Hr=new WeakMap,Ji=new WeakMap,Cn=new WeakSet,kc=function(n,i){const[r,s]=G2(n);if(s===null){if(N(this,ft)[r].size!==i.size)throw new TypeError(`Cannot set register ${n} with value ${i} of different size`);N(this,ft)[r]=i}else{if(!i.is8bits())throw new TypeError(`Cannot set register ${n} with value ${i} of different size`);s==="low"?N(this,ft)[r]=N(this,ft)[r].withLow(i):N(this,ft)[r]=N(this,ft)[r].withHigh(i)}},zr=function(n,i){switch(n){case"CF":N(this,ft).FLAGS=N(this,ft).FLAGS.withBit(1,i);return;case"ZF":N(this,ft).FLAGS=N(this,ft).FLAGS.withBit(0,i);return;case"SF":N(this,ft).FLAGS=N(this,ft).FLAGS.withBit(3,i);return;case"IF":N(this,ft).FLAGS=N(this,ft).FLAGS.withBit(4,i);return;case"OF":N(this,ft).FLAGS=N(this,ft).FLAGS.withBit(2,i);return;default:throw new TypeError(`Invalid flag ${n}`)}},E4);var fl,vr,Jo,el;let s8=(fl=class extends Us{constructor(n){super(n);Ue(this,vr);Ue(this,Jo);Ue(this,el,!1);n.data==="unchanged"&&n.previous.io.printer?(ie(this,vr,N(n.previous.io.printer,vr)),ie(this,Jo,N(n.previous.io.printer,Jo)),ie(this,el,N(n.previous.io.printer,el))):(ie(this,vr,[]),ie(this,Jo,""),ie(this,el,!1))}get busy(){return N(this,vr).length>=fl.BUFFER_SIZE}*setStrobe(n){const i=N(this,el);if(i===n)return;if(ie(this,el,n),n?yield{type:"printer:strobe.on"}:yield{type:"printer:strobe.off"},n&&!i&&!this.busy){const s=yield*this.readData();N(this,vr).push(s),yield{type:"printer:buffer.add",char:s},yield*this.updateBusy(!0),this.busy||(yield*this.updateBusy(!1))}}*clear(){ie(this,Jo,""),yield{type:"printer:paper.replace"}}*print(){if(N(this,vr).length===0)return;const[n,...i]=N(this,vr);if(ie(this,vr,i),yield{type:"printer:buffer.pop",char:n},i.length===fl.BUFFER_SIZE-1&&(yield*this.updateBusy(!1)),n.unsigned===12)yield*this.clear();else{const r=iE(n.unsigned);ie(this,Jo,N(this,Jo)+r),yield{type:"printer:paper.print",char:r}}}get hasPending(){return N(this,vr).length>0}toJSON(){return{paper:N(this,Jo),buffer:[...N(this,vr).map(n=>n.unsigned)]}}},vr=new WeakMap,Jo=new WeakMap,el=new WeakMap,be(fl,"BUFFER_SIZE",5),fl);class Ub extends Us{}let o8=class extends Ub{constructor(n){super(n);be(this,"PA");be(this,"PB");be(this,"CA");be(this,"CB");be(this,"leds",null);be(this,"printer",null);be(this,"switches",null);n.data==="unchanged"&&n.previous.io.pio?(this.PA=n.previous.io.pio.PA,this.PB=n.previous.io.pio.PB,this.CA=n.previous.io.pio.CA,this.CB=n.previous.io.pio.CB):n.data==="randomize"?(this.PA=H.random(8),this.PB=H.random(8),this.CA=H.random(8),this.CB=H.random(8)):(this.PA=H.zero(8),this.PB=H.zero(8),this.CA=H.zero(8),this.CB=H.zero(8))}chipSelect(n){return n=Number(n),n===48?"PA":n===49?"PB":n===50?"CA":n===51?"CB":null}*read(n){yield{type:"pio:read",register:n};let i;if(n==="PA")i=this.PA;else if(n==="PB")i=this.PB;else if(n==="CA")i=this.CA;else if(n==="CB")i=this.CB;else return n;return yield{type:"pio:read.ok",value:i},i}*write(n,i){if(yield{type:"pio:write",register:n,value:i},n==="PA")this.PA=i;else if(n==="PB")this.PB=i;else if(n==="CA")this.CA=i;else if(n==="CB")this.CB=i;else return n;yield{type:"pio:register.update",register:n,value:i},n==="PA"||n==="CA"?yield*this.updatePort("A"):yield*this.updatePort("B"),yield{type:"pio:write.ok"}}line(n,i){return n==="A"?this.CA.bit(i)?"input":"output":this.CB.bit(i)?"input":"output"}toJSON(){return{PA:this.PA.toJSON(),PB:this.PB.toJSON(),CA:this.CA.toJSON(),CB:this.CB.toJSON()}}};class FR extends o8{constructor(e){super(e),this.PA=this.PA.withBit(1,!1);const n=this;this.printer=new class extends s8{*readData(){const i=n.readData();return yield{type:"printer:data.read",char:i},i}*updateBusy(i){i?yield{type:"printer:busy.on"}:yield{type:"printer:busy.off"},yield*n.updatePort("A")}}(e)}readData(){const e=this.PB.unsigned&~this.CB.unsigned;return H.fromUnsigned(e,8)}*updatePort(e){if(e==="B")return;let n=this.PA.unsigned;const i=this.CA.unsigned,r=this.printer.busy;n=n&~i,this.line("A",0)==="input"&&r&&(n|=1),n!==this.PA.unsigned&&(this.PA=H.fromUnsigned(n,8),yield{type:"pio:register.update",register:"PA",value:this.PA}),this.line("A",1)==="output"&&(yield*this.printer.setStrobe(this.PA.bit(1)))}}var Zo,A4;let gQ=(A4=class extends Us{constructor(n){super(n);Ue(this,Zo);n.data==="unchanged"&&n.previous.io.leds?ie(this,Zo,N(n.previous.io.leds,Zo)):n.data==="randomize"?ie(this,Zo,H.random(8)):ie(this,Zo,H.zero(8))}get state(){return N(this,Zo)}*update(n){yield{type:"leds:update",state:n}}toJSON(){return N(this,Zo).toJSON()}},Zo=new WeakMap,A4);var Wr,P4;let vQ=(P4=class extends Us{constructor(n){super(n);Ue(this,Wr);n.data==="unchanged"&&n.previous.io.switches?ie(this,Wr,N(n.previous.io.switches,Wr)):n.data==="randomize"?ie(this,Wr,H.random(8)):ie(this,Wr,H.zero(8))}get state(){return N(this,Wr)}*toggle(n){ie(this,Wr,N(this,Wr).withBit(n,!N(this,Wr).bit(n))),yield{type:"switches:toggle",index:n}}toJSON(){return N(this,Wr).toJSON()}},Wr=new WeakMap,P4);class yQ extends o8{constructor(e){super(e);const n=this;this.leds=new class extends gQ{}(e),this.switches=new class extends vQ{*toggle(i){yield*super.toggle(i),yield*n.updatePort("A")}}(e)}*updatePort(e){if(e==="A"){const n=this.switches.state.unsigned;let i=this.PA.unsigned;const r=this.CA.unsigned;i=n&r|i&~r,i!==this.PA.unsigned&&(this.PA=H.fromUnsigned(i,8),yield{type:"pio:register.update",register:"PA",value:this.PA})}else{let n=this.PB.unsigned;const i=this.CB.unsigned;n=n&~i,yield*this.leds.update(H.fromUnsigned(n,8))}}}let bQ=class extends Us{*tick(){yield{type:"clock:tick"},this.computer.io.timer&&(yield*this.computer.io.timer.tick())}toJSON(){return null}},xQ=class extends Us{*press(){yield{type:"f10:press"},this.computer.io.pic&&(yield*this.computer.io.pic.interrupt(0))}toJSON(){return null}};var Dd,N4;let wQ=(N4=class extends Us{constructor(){super(...arguments);Ue(this,Dd,null)}*readChar(){yield{type:"keyboard:listen-key"};const n=N(this,Dd);if(!n)throw new Error("INT 6 was not given a valid 8-bit character!");return yield{type:"keyboard:read",char:n},ie(this,Dd,null),n}setLastCharRead(n){ie(this,Dd,n)}toJSON(){return null}},Dd=new WeakMap,N4);var yr,M4;let SQ=(M4=class extends Us{constructor(n){super(n);Ue(this,yr);n.data==="unchanged"&&n.previous.io.screen?ie(this,yr,N(n.previous.io.screen,yr)):ie(this,yr,"")}clear(){return this.sendChar(H.fromUnsigned(12,8))}*sendChar(n){switch(n.unsigned){case 8:ie(this,yr,N(this,yr).slice(0,-1));break;case 10:ie(this,yr,N(this,yr)+`
`);break;case 12:ie(this,yr,"");break;default:ie(this,yr,N(this,yr)+iE(n.unsigned));break}yield{type:"screen:send-char",char:n,output:N(this,yr)}}toJSON(){return N(this,yr)}},yr=new WeakMap,M4);var Qo,Ni,R4;let kQ=(R4=class extends Ub{constructor(n){super(n);Ue(this,Qo);Ue(this,Ni);be(this,"printer");n.data==="randomize"?ie(this,Qo,H.random(8)):ie(this,Qo,H.zero(8)),ie(this,Ni,H.zero(8));const i=this;this.printer=new class extends s8{*readData(){const r=N(i,Qo);return yield{type:"printer:data.read",char:r},r}*updateBusy(r){r?yield{type:"printer:busy.on"}:yield{type:"printer:busy.off"},yield*i.updateBusy(r)}}(n)}get interrupts(){return N(this,Ni).bit(7)}chipSelect(n){return n=Number(n),n===64?"DATA":n===65?"STATE":null}*read(n){yield{type:"handshake:read",register:n};let i;if(n==="DATA")i=N(this,Qo);else if(n==="STATE")i=N(this,Ni);else return n;return yield{type:"handshake:read.ok",value:i},i}*write(n,i){if(yield{type:"handshake:write",register:n,value:i},n==="DATA")ie(this,Qo,i),yield{type:"handshake:register.update",register:n,value:i},yield*this.printer.setStrobe(!0),yield*this.printer.setStrobe(!1);else if(n==="STATE")i=i.withBit(0,this.printer.busy),ie(this,Ni,i),yield{type:"handshake:register.update",register:n,value:i},N(this,Ni).bit(1)?(yield*this.printer.setStrobe(!0),yield*this.printer.setStrobe(!1),ie(this,Ni,N(this,Ni).withBit(1,!1)),yield{type:"handshake:register.update",register:n,value:N(this,Ni)}):this.interrupts&&!this.printer.busy?(yield{type:"handshake:int.on"},this.computer.io.pic&&(yield*this.computer.io.pic.interrupt(2))):yield{type:"handshake:int.off"};else return n;yield{type:"handshake:write.ok"}}*updateBusy(n){ie(this,Ni,N(this,Ni).withBit(0,n)),yield{type:"handshake:register.update",register:"STATE",value:N(this,Ni)},this.interrupts&&!n?(yield{type:"handshake:int.on"},this.computer.io.pic&&(yield*this.computer.io.pic.interrupt(2))):yield{type:"handshake:int.off"}}toJSON(){return{DATA:N(this,Qo).toJSON(),STATE:N(this,Ni).toJSON()}}},Qo=new WeakMap,Ni=new WeakMap,R4);var Ns,ea,Zi,Mi,Cs,Ao,Y0,J0;let CQ=(Ns=class extends Ub{constructor(n){super(n);Ue(this,Ao);Ue(this,ea);Ue(this,Zi);Ue(this,Mi);Ue(this,Cs);ie(this,ea,H.fromUnsigned(255,8)),ie(this,Zi,H.fromUnsigned(0,8)),ie(this,Mi,H.fromUnsigned(0,8)),n.data==="unchanged"&&n.previous.io.pic?ie(this,Cs,N(n.previous.io.pic,Cs)):n.data==="randomize"?ie(this,Cs,new Array(Ns.LINES).fill(H.zero(8)).map(()=>H.random(8))):ie(this,Cs,new Array(Ns.LINES).fill(H.zero(8)))}chipSelect(n){const r=4+Ns.LINES;return n=Number(n)-32,n<0||n>=r?null:n===0?"EOI":n===1?"IMR":n===2?"IRR":n===3?"ISR":`INT${n-4}`}*read(n){yield{type:"pic:read",register:n};let i;if(n==="EOI")i=H.zero(8);else if(n==="IMR")i=N(this,ea);else if(n==="IRR")i=N(this,Zi);else if(n==="ISR")i=N(this,Mi);else{const r=Number(n.slice(3));i=N(this,Cs)[r]}return yield{type:"pic:read.ok",value:i},i}*write(n,i){if(yield{type:"pic:write",register:n,value:i},n==="EOI")N(this,Mi).isZero()||(yield{type:"pic:intr.off"},ie(this,Mi,H.zero(8)),yield{type:"pic:register.update",register:"ISR",value:N(this,Mi)},yield*zt(this,Ao,J0).call(this));else if(n==="IMR")ie(this,ea,i),yield{type:"pic:register.update",register:"IMR",value:N(this,ea)},yield*zt(this,Ao,J0).call(this);else if(!(n==="IRR"||n==="ISR")){const r=Number(n.slice(3));N(this,Cs)[r]=i,yield{type:"pic:register.update",register:n,value:i}}yield{type:"pic:write.ok"}}*interrupt(n){if(n<0||n>=Ns.LINES)throw new RangeError(`Invalid interrupt line ${n}`);N(this,Zi).bit(n)||(ie(this,Zi,N(this,Zi).withBit(n,!0)),yield{type:"pic:register.update",register:"IRR",value:N(this,Zi)},yield*zt(this,Ao,J0).call(this))}isINTRActive(){return N(this,Mi).isZero()&&zt(this,Ao,Y0).call(this)!==null}*handleINTR(){if(yield{type:"cpu:inta.on"},!N(this,Mi).isZero())throw new Error("INTR line is active but ISR is not zero");const n=zt(this,Ao,Y0).call(this);if(n===null)throw new Error("INTR line is active but no interrupt is pending");ie(this,Mi,N(this,Mi).withBit(n,!0)),yield{type:"pic:register.update",register:"ISR",value:N(this,Mi)},ie(this,Zi,N(this,Zi).withBit(n,!1)),yield{type:"pic:register.update",register:"IRR",value:N(this,Zi)},yield{type:"cpu:inta.off"},yield{type:"cpu:inta.on"};const i=N(this,Cs)[n];return yield{type:"pic:int.send",number:i},yield{type:"cpu:inta.off"},yield{type:"pic:intr.off"},i}toJSON(){return{IMR:N(this,ea).toJSON(),IRR:N(this,Zi).toJSON(),ISR:N(this,Mi).toJSON(),lines:N(this,Cs).map(n=>n.toJSON())}}},ea=new WeakMap,Zi=new WeakMap,Mi=new WeakMap,Cs=new WeakMap,Ao=new WeakSet,Y0=function(){for(let n=0;n<Ns.LINES;n++)if(N(this,Zi).bit(n)&&!N(this,ea).bit(n))return n;return null},J0=function*(){N(this,Mi).isZero()&&zt(this,Ao,Y0).call(this)!==null&&(yield{type:"pic:intr.on"})},be(Ns,"LINES",8),Ns);var ro,tl,I4;let _Q=(I4=class extends Ub{constructor(n){super(n);Ue(this,ro);Ue(this,tl);ie(this,ro,H.zero(8)),ie(this,tl,H.zero(8))}chipSelect(n){return n=Number(n),n===16?"CONT":n===17?"COMP":null}*read(n){yield{type:"timer:read",register:n};let i;if(n==="CONT")i=N(this,ro);else if(n==="COMP")i=N(this,tl);else return n;return yield{type:"timer:read.ok",value:i},i}*write(n,i){if(yield{type:"timer:write",register:n,value:i},n==="CONT")ie(this,ro,i);else if(n==="COMP")ie(this,tl,i);else return n;yield{type:"timer:register.update",register:n,value:i},yield{type:"timer:write.ok"}}*tick(){const n=N(this,ro).unsigned===H.maxValue(8)?H.zero(8):N(this,ro).add(1);ie(this,ro,n),yield{type:"timer:register.update",register:"CONT",value:n},N(this,tl).equals(n)?(yield{type:"timer:int.on"},this.computer.io.pic&&(yield*this.computer.io.pic.interrupt(1))):yield{type:"timer:int.off"}}toJSON(){return{CONT:N(this,ro).toJSON(),COMP:N(this,tl).toJSON()}}},ro=new WeakMap,tl=new WeakMap,I4);class EQ extends Us{constructor(n){super(n);be(this,"clock",null);be(this,"f10",null);be(this,"keyboard",null);be(this,"screen",null);be(this,"handshake",null);be(this,"pic",null);be(this,"pio",null);be(this,"timer",null);if(n.devices.keyboardAndScreen&&(this.keyboard=new wQ(n),this.screen=new SQ(n)),n.devices.pic&&(this.clock=new bQ(n),this.f10=new xQ(n),this.timer=new _Q(n),this.pic=new CQ(n)),this.pio=n.devices.pio==="switches-and-leds"?new yQ(n):n.devices.pio==="printer"?new FR(n):null,n.devices.handshake){if(this.pio instanceof FR)throw new mn("io-printer-conflict");this.handshake=new kQ(n)}}get leds(){var n;return((n=this.pio)==null?void 0:n.leds)??null}get printer(){var n,i;return((n=this.pio)==null?void 0:n.printer)??((i=this.handshake)==null?void 0:i.printer)??null}get switches(){var n;return((n=this.pio)==null?void 0:n.switches)??null}*chipSelect(n){var a,l,c,u;const i=(a=this.handshake)==null?void 0:a.chipSelect(n);if(i)return yield{type:"bus:io.selected",chip:"handshake"},{chip:"handshake",register:i};const r=(l=this.pic)==null?void 0:l.chipSelect(n);if(r)return yield{type:"bus:io.selected",chip:"pic"},{chip:"pic",register:r};const s=(c=this.pio)==null?void 0:c.chipSelect(n);if(s)return yield{type:"bus:io.selected",chip:"pio"},{chip:"pio",register:s};const o=(u=this.timer)==null?void 0:u.chipSelect(n);return o?(yield{type:"bus:io.selected",chip:"timer"},{chip:"timer",register:o}):(yield{type:"bus:io.error",error:new mn("io-memory-not-connected",n)},null)}*read(n){const{chip:i,register:r}=n;return this[i]?yield*this[i].read(r):(yield{type:"bus:io.error",error:new mn("device-not-connected",i)},null)}*write(n,i){const{chip:r,register:s}=n;return this[r]?(yield*this[r].write(s,i),!0):(yield{type:"bus:io.error",error:new mn("device-not-connected",r)},!1)}toJSON(){var n,i,r,s,o,a,l,c,u,d,f;return{clock:((n=this.clock)==null?void 0:n.toJSON())??null,f10:((i=this.f10)==null?void 0:i.toJSON())??null,keyboard:((r=this.keyboard)==null?void 0:r.toJSON())??null,leds:((s=this.leds)==null?void 0:s.toJSON())??null,printer:((o=this.printer)==null?void 0:o.toJSON())??null,screen:((a=this.screen)==null?void 0:a.toJSON())??null,switches:((l=this.switches)==null?void 0:l.toJSON())??null,handshake:((c=this.handshake)==null?void 0:c.toJSON())??null,pic:((u=this.pic)==null?void 0:u.toJSON())??null,pio:((d=this.pio)==null?void 0:d.toJSON())??null,timer:((f=this.timer)==null?void 0:f.toJSON())??null}}}var hl,Ri,jd,Bd;let AQ=(hl=class extends Us{constructor(n){super(n);Ue(this,Ri);Ue(this,jd);Ue(this,Bd);n.data==="unchanged"?ie(this,Ri,N(n.previous.memory,Ri)):n.data==="randomize"?ie(this,Ri,new Uint8Array(hl.SIZE).map(()=>H.random(8).unsigned)):ie(this,Ri,new Uint8Array(hl.SIZE).fill(0)),N(this,Ri)[255]=1;const i=n.program.instructions.some(r=>r.instruction==="INT");if(ie(this,Bd,new Set),i)for(const[r,s]of rE){const o=r;if(N(this,Ri)[o]=s.unsigned,N(this,Bd).add(o),r===6){const a=[208,216,48,18,1,193,193,216,49,212,65,225],l=s.unsigned;for(let c=0;c<a.length;c++)N(this,Ri)[l+c]=a[c],N(this,Bd).add(l+c)}}for(const r of n.program.data){let s=r.start.value;for(const o of r.getValues())o!==Eh&&N(this,Ri).set(o.toUint8Array(),s),s+=r.size/8}ie(this,jd,new Set);for(const r of n.program.instructions){N(this,Ri).set(r.toBytes(),r.start.value);for(let s=0;s<r.length;s++)N(this,jd).add(r.start.value+s)}}*read(n){if(n=Number(n),yield{type:"memory:read",address:n},!Pe.inRange(n))return yield{type:"memory:read.error",error:new mn("address-out-of-range",n)},null;const i=H.fromUnsigned(N(this,Ri).at(n),8);return yield{type:"memory:read.ok",address:Pe.from(n),value:i},i}*write(n,i){return n=Number(n),yield{type:"memory:write",address:n,value:i},Pe.inRange(n)?(N(this,jd).has(n)&&(yield{type:"memory:write.warning",warning:`Sobrescribiendo instrucción en la dirección ${Pe.format(n)}`},console.warn(`Advertencia: Sobrescribiendo instrucción en la dirección ${Pe.format(n)}`)),N(this,Ri).set([i.unsigned],n),yield{type:"memory:write.ok",address:Pe.from(n),value:i},!0):(yield{type:"memory:write.error",error:new mn("address-out-of-range",n)},!1)}toJSON(){return[...N(this,Ri)]}},Ri=new WeakMap,jd=new WeakMap,Bd=new WeakMap,be(hl,"SIZE",Pe.MAX_ADDRESS+1),hl);class zR{constructor(e){be(this,"cpu");be(this,"memory");be(this,"io");const n={computer:this,...e};this.cpu=new mQ(n),this.memory=new AQ(n),this.io=new EQ(n)}toJSON(){return{cpu:this.cpu.toJSON(),memory:this.memory.toJSON(),io:this.io.toJSON()}}}var Lt;class PQ{constructor(){Ue(this,Lt,new zR({program:{data:[],instructions:[]},devices:{keyboardAndScreen:!1,pic:!1,pio:null,handshake:null},data:"clean"}))}loadProgram(e){ie(this,Lt,new zR({...e,previous:N(this,Lt)}))}getComputerState(){var e;return((e=N(this,Lt))==null?void 0:e.toJSON())||null}startCPU(){if(!N(this,Lt))throw new mn("no-program");return N(this,Lt).cpu.run()}get devices(){if(!N(this,Lt))throw new Error("No computer loaded!");return{clock:{connected:()=>N(this,Lt).io.clock!==null,tick:()=>{if(N(this,Lt).io.clock)return N(this,Lt).io.clock.tick();console.warn("Called clock.tick() when no clock was connected to the computer")}},f10:{connected:()=>"f10"in N(this,Lt).io,press:()=>{if(N(this,Lt).io.f10)return N(this,Lt).io.f10.press();console.warn("Called f10.press() when no f10 was connected to the computer")}},keyboard:{connected:()=>"keyboard"in N(this,Lt).io,readChar:e=>{if(N(this,Lt).io.keyboard)return N(this,Lt).io.keyboard.setLastCharRead(e);console.warn("Called keyboard.press() when no keyboard was connected to the computer")}},leds:{connected:()=>"leds"in N(this,Lt).io},printer:{connected:()=>N(this,Lt).io.printer!==null,clear:()=>{if(N(this,Lt).io.printer)return N(this,Lt).io.printer.clear();console.warn("No printer connected to the computer!")},print:()=>{if(N(this,Lt).io.printer)return N(this,Lt).io.printer.print();console.warn("No printer connected to the computer!")},hasPending:()=>{var e;return((e=N(this,Lt).io.printer)==null?void 0:e.hasPending)??!1}},screen:{connected:()=>"screen"in N(this,Lt).io,clear:()=>{if(N(this,Lt).io.screen)return N(this,Lt).io.screen.clear();console.warn("Called screen.clear() when no screen was connected to the computer")}},switches:{connected:()=>"switches"in N(this,Lt).io,toggle:e=>{if(N(this,Lt).io.switches)return N(this,Lt).io.switches.toggle(e);console.warn("Called switches.toggle() when no switches were connected to the computer")}}}}}Lt=new WeakMap;const Bx=me(H.zero(16)),$x=me(H.zero(16)),NQ=me(H.zero(8)),Fx=me(H.zero(16)),zx=me(H.zero(16)),Ux=me(H.zero(16)),Vx=me(H.zero(16)),Hx=me(H.zero(16)),Wx=me(H.zero(16)),Qn=me(H.zero(16)),ei=me(H.zero(8)),We=me(""),af=me(0),Vp=me(0),It=me(0),Vb=me(!1),a8=me(!1),jl=me(0),ws=me([]),lE=me(!1);me(!0);me(!0);const cE=me(!1),Hb=me(!1),Fu=me({canAnimate:!0,pendingMessage:null}),Ia=t=>me(e=>e(t).low,(e,n,i)=>{const r=e(t),s=typeof i=="function"?i(r.low):i;n(t,r.withLow(s))}),Ta=t=>me(e=>e(t).high,(e,n,i)=>{const r=e(t),s=typeof i=="function"?i(r.high):i;n(t,r.withHigh(s))}),le={AL:me(H.zero(8)),BL:me(H.zero(8)),CL:me(H.zero(8)),DL:me(H.zero(8)),SP:Bx,"SP.l":Ia(Bx),"SP.h":Ta(Bx),IP:$x,"IP.l":Ia($x),"IP.h":Ta($x),IR:NQ,ri:Fx,"ri.l":Ia(Fx),"ri.h":Ta(Fx),id:zx,"id.l":Ia(zx),"id.h":Ta(zx),left:Ux,"left.l":Ia(Ux),"left.h":Ta(Ux),right:Vx,"right.l":Ia(Vx),"right.h":Ta(Vx),result:Hx,"result.l":Ia(Hx),"result.h":Ta(Hx),FLAGS:Wx,"FLAGS.l":Ia(Wx),"FLAGS.h":Ta(Wx),MAR:Qn,MBR:ei},Wn=me({phase:"stopped"}),uE=me("ADD");function l8(t,e=!1){e?(A.set(le.AL,H.zero(8)),A.set(le.BL,H.zero(8)),A.set(le.CL,H.zero(8)),A.set(le.DL,H.zero(8)),A.set(le.SP,H.fromUnsigned(255,16)),A.set(le.IP,H.zero(16)),A.set(le.IR,H.zero(8)),A.set(le.ri,H.zero(16)),A.set(le.id,H.zero(16)),A.set(le.left,H.zero(16)),A.set(le.right,H.zero(16)),A.set(le.result,H.zero(16)),A.set(le.FLAGS,H.zero(16)),A.set(le.MAR,H.zero(16)),A.set(le.MBR,H.zero(8))):(A.set(le.AL,H.fromUnsigned(t.cpu.AX&255,8)),A.set(le.BL,H.fromUnsigned(t.cpu.BX&255,8)),A.set(le.CL,H.fromUnsigned(t.cpu.CX&255,8)),A.set(le.DL,H.fromUnsigned(t.cpu.DX&255,8)),A.set(le.SP,H.fromUnsigned(t.cpu.SP,16)),A.set(le.IP,H.fromUnsigned(t.cpu.IP,16)),A.set(le.IR,H.fromUnsigned(t.cpu.IR,8)),A.set(le.ri,H.fromUnsigned(t.cpu.ri,16)),A.set(le.id,H.fromUnsigned(t.cpu.id,16)),A.set(le.left,H.fromUnsigned(t.cpu.left,16)),A.set(le.right,H.fromUnsigned(t.cpu.right,16)),A.set(le.result,H.fromUnsigned(t.cpu.result,16)),t.cpu.FLAGS=16,A.set(le.FLAGS,H.fromUnsigned(t.cpu.FLAGS,16)),A.set(le.MAR,H.fromUnsigned(t.cpu.MAR,16)),A.set(le.MBR,H.fromUnsigned(t.cpu.MBR,8))),A.set(Wn,{phase:"stopped"})}const MQ=Object.freeze(Object.defineProperty({__proto__:null,MARAtom:Qn,MBRAtom:ei,aluOperationAtom:uE,animationSyncAtom:Fu,connectScreenAndKeyboardAtom:lE,currentInstructionCycleCountAtom:It,cycleAtom:Wn,cycleCountAtom:af,hasINTInstructionAtom:cE,instructionCountAtom:jl,mayUsePICAtom:Hb,messageAtom:We,messageHistoryAtom:ws,registerAtoms:le,resetCPUState:l8,showSPAtom:Vb,showriAtom:a8,totalCycleCountAtom:Vp},Symbol.toStringTag,{value:"Module"})),c8=me([]),u8=me([]),hy=me(new Array(Pe.MAX_ADDRESS+1).fill(H.zero(8))),Hp=me(Pe.from(32)),RQ=me(null),py=me(new Set),Tg=256,IQ=me(t=>{const e=t(RQ)??t(Hp);let n=e.value-e.value%Tg,i=n+Tg-1;i>Pe.MAX_ADDRESS&&(i=Pe.MAX_ADDRESS,n=i-Tg+1);const r=t(hy),s=[];for(let o=0;o<Tg;o++)s.push({address:Pe.from(n+o),value:r[n+o]});return s});function TQ(t,e=!1){e?A.set(hy,new Array(Pe.MAX_ADDRESS+1).fill(H.zero(8))):A.set(hy,t.memory.map(n=>H.fromUnsigned(n,8))),A.set(Hp,Pe.from(32)),A.set(py,new Set)}let X2=[],d8=[];(()=>{let t="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,n=0;e<t.length;e++)(e%2?d8:X2).push(n=n+t[e])})();function OQ(t){if(t<768)return!1;for(let e=0,n=X2.length;;){let i=e+n>>1;if(t<X2[i])n=i;else if(t>=d8[i])e=i+1;else return!0;if(e==n)return!1}}function UR(t){return t>=127462&&t<=127487}const VR=8205;function LQ(t,e,n=!0,i=!0){return(n?f8:DQ)(t,e,i)}function f8(t,e,n){if(e==t.length)return e;e&&h8(t.charCodeAt(e))&&p8(t.charCodeAt(e-1))&&e--;let i=Gx(t,e);for(e+=HR(i);e<t.length;){let r=Gx(t,e);if(i==VR||r==VR||n&&OQ(r))e+=HR(r),i=r;else if(UR(r)){let s=0,o=e-2;for(;o>=0&&UR(Gx(t,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function DQ(t,e,n){for(;e>0;){let i=f8(t,e-2,n);if(i<e)return i;e--}return 0}function Gx(t,e){let n=t.charCodeAt(e);if(!p8(n)||e+1==t.length)return n;let i=t.charCodeAt(e+1);return h8(i)?(n-55296<<10)+(i-56320)+65536:n}function h8(t){return t>=56320&&t<57344}function p8(t){return t>=55296&&t<56320}function HR(t){return t<65536?1:2}class Nt{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,n,i){[e,n]=lf(this,e,n);let r=[];return this.decompose(0,e,r,2),i.length&&i.decompose(0,i.length,r,3),this.decompose(n,this.length,r,1),lo.from(r,this.length-(n-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,n=this.length){[e,n]=lf(this,e,n);let i=[];return this.decompose(e,n,i,0),lo.from(i,n-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let n=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),r=new Zh(this),s=new Zh(e);for(let o=n,a=n;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(a+=r.value.length,r.done||a>=i)return!0}}iter(e=1){return new Zh(this,e)}iterRange(e,n=this.length){return new m8(this,e,n)}iterLines(e,n){let i;if(e==null)i=this.iter();else{n==null&&(n=this.lines+1);let r=this.line(e).from;i=this.iterRange(r,Math.max(r,n==this.lines+1?this.length:n<=1?0:this.line(n-1).to))}return new g8(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Nt.empty:e.length<=32?new _n(e):lo.from(_n.split(e,[]))}}class _n extends Nt{constructor(e,n=jQ(e)){super(),this.text=e,this.length=n}get lines(){return this.text.length}get children(){return null}lineInner(e,n,i,r){for(let s=0;;s++){let o=this.text[s],a=r+o.length;if((n?i:a)>=e)return new BQ(r,a,i,o);r=a+1,i++}}decompose(e,n,i,r){let s=e<=0&&n>=this.length?this:new _n(WR(this.text,e,n),Math.min(n,this.length)-Math.max(0,e));if(r&1){let o=i.pop(),a=Z0(s.text,o.text.slice(),0,s.length);if(a.length<=32)i.push(new _n(a,o.length+s.length));else{let l=a.length>>1;i.push(new _n(a.slice(0,l)),new _n(a.slice(l)))}}else i.push(s)}replace(e,n,i){if(!(i instanceof _n))return super.replace(e,n,i);[e,n]=lf(this,e,n);let r=Z0(this.text,Z0(i.text,WR(this.text,0,e)),n),s=this.length+i.length-(n-e);return r.length<=32?new _n(r,s):lo.from(_n.split(r,[]),s)}sliceString(e,n=this.length,i=`
`){[e,n]=lf(this,e,n);let r="";for(let s=0,o=0;s<=n&&o<this.text.length;o++){let a=this.text[o],l=s+a.length;s>e&&o&&(r+=i),e<l&&n>s&&(r+=a.slice(Math.max(0,e-s),n-s)),s=l+1}return r}flatten(e){for(let n of this.text)e.push(n)}scanIdentical(){return 0}static split(e,n){let i=[],r=-1;for(let s of e)i.push(s),r+=s.length+1,i.length==32&&(n.push(new _n(i,r)),i=[],r=-1);return r>-1&&n.push(new _n(i,r)),n}}class lo extends Nt{constructor(e,n){super(),this.children=e,this.length=n,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,n,i,r){for(let s=0;;s++){let o=this.children[s],a=r+o.length,l=i+o.lines-1;if((n?l:a)>=e)return o.lineInner(e,n,i,r);r=a+1,i=l+1}}decompose(e,n,i,r){for(let s=0,o=0;o<=n&&s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e<=l&&n>=o){let c=r&((o<=e?1:0)|(l>=n?2:0));o>=e&&l<=n&&!c?i.push(a):a.decompose(e-o,n-o,i,c)}o=l+1}}replace(e,n,i){if([e,n]=lf(this,e,n),i.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.length;if(e>=s&&n<=a){let l=o.replace(e-s,n-s,i),c=this.lines-o.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let u=this.children.slice();return u[r]=l,new lo(u,this.length-(n-e)+i.length)}return super.replace(s,a,l)}s=a+1}return super.replace(e,n,i)}sliceString(e,n=this.length,i=`
`){[e,n]=lf(this,e,n);let r="";for(let s=0,o=0;s<this.children.length&&o<=n;s++){let a=this.children[s],l=o+a.length;o>e&&s&&(r+=i),e<l&&n>o&&(r+=a.sliceString(e-o,n-o,i)),o=l+1}return r}flatten(e){for(let n of this.children)n.flatten(e)}scanIdentical(e,n){if(!(e instanceof lo))return 0;let i=0,[r,s,o,a]=n>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=n,s+=n){if(r==o||s==a)return i;let l=this.children[r],c=e.children[s];if(l!=c)return i+l.scanIdentical(c,n);i+=l.length+1}}static from(e,n=e.reduce((i,r)=>i+r.length+1,-1)){let i=0;for(let p of e)i+=p.lines;if(i<32){let p=[];for(let m of e)m.flatten(p);return new _n(p,n)}let r=Math.max(32,i>>5),s=r<<1,o=r>>1,a=[],l=0,c=-1,u=[];function d(p){let m;if(p.lines>s&&p instanceof lo)for(let g of p.children)d(g);else p.lines>o&&(l>o||!l)?(f(),a.push(p)):p instanceof _n&&l&&(m=u[u.length-1])instanceof _n&&p.lines+m.lines<=32?(l+=p.lines,c+=p.length+1,u[u.length-1]=new _n(m.text.concat(p.text),m.length+1+p.length)):(l+p.lines>r&&f(),l+=p.lines,c+=p.length+1,u.push(p))}function f(){l!=0&&(a.push(u.length==1?u[0]:lo.from(u,c)),c=-1,l=u.length=0)}for(let p of e)d(p);return f(),a.length==1?a[0]:new lo(a,n)}}Nt.empty=new _n([""],0);function jQ(t){let e=-1;for(let n of t)e+=n.length+1;return e}function Z0(t,e,n=0,i=1e9){for(let r=0,s=0,o=!0;s<t.length&&r<=i;s++){let a=t[s],l=r+a.length;l>=n&&(l>i&&(a=a.slice(0,i-r)),r<n&&(a=a.slice(n-r)),o?(e[e.length-1]+=a,o=!1):e.push(a)),r=l+1}return e}function WR(t,e,n){return Z0(t,[""],e,n)}class Zh{constructor(e,n=1){this.dir=n,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[n>0?1:(e instanceof _n?e.text.length:e.children.length)<<1]}nextInner(e,n){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,r=this.nodes[i],s=this.offsets[i],o=s>>1,a=r instanceof _n?r.text.length:r.children.length;if(o==(n>0?a:0)){if(i==0)return this.done=!0,this.value="",this;n>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(n>0?0:1)){if(this.offsets[i]+=n,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof _n){let l=r.text[o+(n<0?-1:0)];if(this.offsets[i]+=n,l.length>Math.max(0,e))return this.value=e==0?l:n>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=r.children[o+(n<0?-1:0)];e>l.length?(e-=l.length,this.offsets[i]+=n):(n<0&&this.offsets[i]--,this.nodes.push(l),this.offsets.push(n>0?1:(l instanceof _n?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class m8{constructor(e,n,i){this.value="",this.done=!1,this.cursor=new Zh(e,n>i?-1:1),this.pos=n>i?e.length:0,this.from=Math.min(n,i),this.to=Math.max(n,i)}nextInner(e,n){if(n<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,n<0?this.pos-this.to:this.from-this.pos);let i=n<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*n,this.value=r.length<=i?r:n<0?r.slice(r.length-i):r.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class g8{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:n,lineBreak:i,value:r}=this.inner.next(e);return n&&this.afterBreak?(this.value="",this.afterBreak=!1):n?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Nt.prototype[Symbol.iterator]=function(){return this.iter()},Zh.prototype[Symbol.iterator]=m8.prototype[Symbol.iterator]=g8.prototype[Symbol.iterator]=function(){return this});class BQ{constructor(e,n,i,r){this.from=e,this.to=n,this.number=i,this.text=r}get length(){return this.to-this.from}}function lf(t,e,n){return e=Math.max(0,Math.min(t.length,e)),[e,Math.max(e,Math.min(t.length,n))]}function ci(t,e,n=!0,i=!0){return LQ(t,e,n,i)}function $Q(t){return t>=56320&&t<57344}function FQ(t){return t>=55296&&t<56320}function qr(t,e){let n=t.charCodeAt(e);if(!FQ(n)||e+1==t.length)return n;let i=t.charCodeAt(e+1);return $Q(i)?(n-55296<<10)+(i-56320)+65536:n}function dE(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}function na(t){return t<65536?1:2}const q2=/\r\n?|\n/;var rr=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(rr||(rr={}));class _o{constructor(e){this.sections=e}get length(){let e=0;for(let n=0;n<this.sections.length;n+=2)e+=this.sections[n];return e}get newLength(){let e=0;for(let n=0;n<this.sections.length;n+=2){let i=this.sections[n+1];e+=i<0?this.sections[n]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let n=0,i=0,r=0;n<this.sections.length;){let s=this.sections[n++],o=this.sections[n++];o<0?(e(i,r,s),r+=s):r+=o,i+=s}}iterChangedRanges(e,n=!1){K2(this,e,n)}get invertedDesc(){let e=[];for(let n=0;n<this.sections.length;){let i=this.sections[n++],r=this.sections[n++];r<0?e.push(i,r):e.push(r,i)}return new _o(e)}composeDesc(e){return this.empty?e:e.empty?this:v8(this,e)}mapDesc(e,n=!1){return e.empty?this:Y2(this,e,n)}mapPos(e,n=-1,i=rr.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],c=r+a;if(l<0){if(c>e)return s+(e-r);s+=a}else{if(i!=rr.Simple&&c>=e&&(i==rr.TrackDel&&r<e&&c>e||i==rr.TrackBefore&&r<e||i==rr.TrackAfter&&c>e))return null;if(c>e||c==e&&n<0&&!a)return e==r||n<0?s:s+l;s+=l}r=c}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,n=e){for(let i=0,r=0;i<this.sections.length&&r<=n;){let s=this.sections[i++],o=this.sections[i++],a=r+s;if(o>=0&&r<=n&&a>=e)return r<e&&a>n?"cover":!0;r=a}return!1}toString(){let e="";for(let n=0;n<this.sections.length;){let i=this.sections[n++],r=this.sections[n++];e+=(e?" ":"")+i+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(n=>typeof n!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new _o(e)}static create(e){return new _o(e)}}class Bn extends _o{constructor(e,n){super(e),this.inserted=n}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return K2(this,(n,i,r,s,o)=>e=e.replace(r,r+(i-n),o),!1),e}mapDesc(e,n=!1){return Y2(this,e,n,!0)}invert(e){let n=this.sections.slice(),i=[];for(let r=0,s=0;r<n.length;r+=2){let o=n[r],a=n[r+1];if(a>=0){n[r]=a,n[r+1]=o;let l=r>>1;for(;i.length<l;)i.push(Nt.empty);i.push(o?e.slice(s,s+o):Nt.empty)}s+=o}return new Bn(n,i)}compose(e){return this.empty?e:e.empty?this:v8(this,e,!0)}map(e,n=!1){return e.empty?this:Y2(this,e,n,!0)}iterChanges(e,n=!1){K2(this,e,n)}get desc(){return _o.create(this.sections)}filter(e){let n=[],i=[],r=[],s=new Wp(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&s.len==0;){if(s.done)break e;let u=Math.min(s.len,l-a);xi(r,u,-1);let d=s.ins==-1?-1:s.off==0?s.ins:0;xi(n,u,d),d>0&&sl(i,n,s.text),s.forward(u),a+=u}let c=e[o++];for(;a<c;){if(s.done)break e;let u=Math.min(s.len,c-a);xi(n,u,-1),xi(r,u,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(u),a+=u}}return{changes:new Bn(n,i),filtered:_o.create(r)}}toJSON(){let e=[];for(let n=0;n<this.sections.length;n+=2){let i=this.sections[n],r=this.sections[n+1];r<0?e.push(i):r==0?e.push([i]):e.push([i].concat(this.inserted[n>>1].toJSON()))}return e}static of(e,n,i){let r=[],s=[],o=0,a=null;function l(u=!1){if(!u&&!r.length)return;o<n&&xi(r,n-o,-1);let d=new Bn(r,s);a=a?a.compose(d.map(a)):d,r=[],s=[],o=0}function c(u){if(Array.isArray(u))for(let d of u)c(d);else if(u instanceof Bn){if(u.length!=n)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${n})`);l(),a=a?a.compose(u.map(a)):u}else{let{from:d,to:f=d,insert:p}=u;if(d>f||d<0||f>n)throw new RangeError(`Invalid change range ${d} to ${f} (in doc of length ${n})`);let m=p?typeof p=="string"?Nt.of(p.split(i||q2)):p:Nt.empty,g=m.length;if(d==f&&g==0)return;d<o&&l(),d>o&&xi(r,d-o,-1),xi(r,f-d,g),sl(s,r,m),o=f}}return c(e),l(!a),a}static empty(e){return new Bn(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let n=[],i=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")n.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)n.push(s[0],0);else{for(;i.length<r;)i.push(Nt.empty);i[r]=Nt.of(s.slice(1)),n.push(s[0],i[r].length)}}}return new Bn(n,i)}static createSet(e,n){return new Bn(e,n)}}function xi(t,e,n,i=!1){if(e==0&&n<=0)return;let r=t.length-2;r>=0&&n<=0&&n==t[r+1]?t[r]+=e:r>=0&&e==0&&t[r]==0?t[r+1]+=n:i?(t[r]+=e,t[r+1]+=n):t.push(e,n)}function sl(t,e,n){if(n.length==0)return;let i=e.length-2>>1;if(i<t.length)t[t.length-1]=t[t.length-1].append(n);else{for(;t.length<i;)t.push(Nt.empty);t.push(n)}}function K2(t,e,n){let i=t.inserted;for(let r=0,s=0,o=0;o<t.sections.length;){let a=t.sections[o++],l=t.sections[o++];if(l<0)r+=a,s+=a;else{let c=r,u=s,d=Nt.empty;for(;c+=a,u+=l,l&&i&&(d=d.append(i[o-2>>1])),!(n||o==t.sections.length||t.sections[o+1]<0);)a=t.sections[o++],l=t.sections[o++];e(r,c,s,u,d),r=c,s=u}}}function Y2(t,e,n,i=!1){let r=[],s=i?[]:null,o=new Wp(t),a=new Wp(e);for(let l=-1;;){if(o.done&&a.len||a.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&a.ins==-1){let c=Math.min(o.len,a.len);xi(r,c,-1),o.forward(c),a.forward(c)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!n))){let c=a.len;for(xi(r,a.ins,-1);c;){let u=Math.min(o.len,c);o.ins>=0&&l<o.i&&o.len<=u&&(xi(r,0,o.ins),s&&sl(s,r,o.text),l=o.i),o.forward(u),c-=u}a.next()}else if(o.ins>=0){let c=0,u=o.len;for(;u;)if(a.ins==-1){let d=Math.min(u,a.len);c+=d,u-=d,a.forward(d)}else if(a.ins==0&&a.len<u)u-=a.len,a.next();else break;xi(r,c,l<o.i?o.ins:0),s&&l<o.i&&sl(s,r,o.text),l=o.i,o.forward(o.len-u)}else{if(o.done&&a.done)return s?Bn.createSet(r,s):_o.create(r);throw new Error("Mismatched change set lengths")}}}function v8(t,e,n=!1){let i=[],r=n?[]:null,s=new Wp(t),o=new Wp(e);for(let a=!1;;){if(s.done&&o.done)return r?Bn.createSet(i,r):_o.create(i);if(s.ins==0)xi(i,s.len,0,a),s.next();else if(o.len==0&&!o.done)xi(i,0,o.ins,a),r&&sl(r,i,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,o.len),c=i.length;if(s.ins==-1){let u=o.ins==-1?-1:o.off?0:o.ins;xi(i,l,u,a),r&&u&&sl(r,i,o.text)}else o.ins==-1?(xi(i,s.off?0:s.len,l,a),r&&sl(r,i,s.textBit(l))):(xi(i,s.off?0:s.len,o.off?0:o.ins,a),r&&!o.off&&sl(r,i,o.text));a=(s.ins>l||o.ins>=0&&o.len>l)&&(a||i.length>c),s.forward2(l),o.forward(l)}}}}class Wp{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,n=this.i-2>>1;return n>=e.length?Nt.empty:e[n]}textBit(e){let{inserted:n}=this.set,i=this.i-2>>1;return i>=n.length&&!e?Nt.empty:n[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Dc{constructor(e,n,i){this.from=e,this.to=n,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,n=-1){let i,r;return this.empty?i=r=e.mapPos(this.from,n):(i=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),i==this.from&&r==this.to?this:new Dc(i,r,this.flags)}extend(e,n=e){if(e<=this.anchor&&n>=this.anchor)return ue.range(e,n);let i=Math.abs(e-this.anchor)>Math.abs(n-this.anchor)?e:n;return ue.range(this.anchor,i)}eq(e,n=!1){return this.anchor==e.anchor&&this.head==e.head&&(!n||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return ue.range(e.anchor,e.head)}static create(e,n,i){return new Dc(e,n,i)}}class ue{constructor(e,n){this.ranges=e,this.mainIndex=n}map(e,n=-1){return e.empty?this:ue.create(this.ranges.map(i=>i.map(e,n)),this.mainIndex)}eq(e,n=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],n))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new ue([this.main],0)}addRange(e,n=!0){return ue.create([e].concat(this.ranges),n?0:this.mainIndex+1)}replaceRange(e,n=this.mainIndex){let i=this.ranges.slice();return i[n]=e,ue.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new ue(e.ranges.map(n=>Dc.fromJSON(n)),e.main)}static single(e,n=e){return new ue([ue.range(e,n)],0)}static create(e,n=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=i:s.from<i)return ue.normalized(e.slice(),n);i=s.to}return new ue(e,n)}static cursor(e,n=0,i,r){return Dc.create(e,e,(n==0?0:n<0?8:16)|(i==null?7:Math.min(6,i))|(r??16777215)<<6)}static range(e,n,i,r){let s=(i??16777215)<<6|(r==null?7:Math.min(6,r));return n<e?Dc.create(n,e,48|s):Dc.create(e,n,(n>e?8:0)|s)}static normalized(e,n=0){let i=e[n];e.sort((r,s)=>r.from-s.from),n=e.indexOf(i);for(let r=1;r<e.length;r++){let s=e[r],o=e[r-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,l=Math.max(s.to,o.to);r<=n&&n--,e.splice(--r,2,s.anchor>s.head?ue.range(l,a):ue.range(a,l))}}return new ue(e,n)}}function y8(t,e){for(let n of t.ranges)if(n.to>e)throw new RangeError("Selection points outside of document")}let fE=0;class Re{constructor(e,n,i,r,s){this.combine=e,this.compareInput=n,this.compare=i,this.isStatic=r,this.id=fE++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new Re(e.combine||(n=>n),e.compareInput||((n,i)=>n===i),e.compare||(e.combine?(n,i)=>n===i:hE),!!e.static,e.enables)}of(e){return new Q0([],this,0,e)}compute(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new Q0(e,this,1,n)}computeN(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new Q0(e,this,2,n)}from(e,n){return n||(n=i=>i),this.compute([e],i=>n(i.field(e)))}}function hE(t,e){return t==e||t.length==e.length&&t.every((n,i)=>n===e[i])}class Q0{constructor(e,n,i,r){this.dependencies=e,this.facet=n,this.type=i,this.value=r,this.id=fE++}dynamicSlot(e){var n;let i=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,a=this.type==2,l=!1,c=!1,u=[];for(let d of this.dependencies)d=="doc"?l=!0:d=="selection"?c=!0:((n=e[d.id])!==null&&n!==void 0?n:1)&1||u.push(e[d.id]);return{create(d){return d.values[o]=i(d),1},update(d,f){if(l&&f.docChanged||c&&(f.docChanged||f.selection)||J2(d,u)){let p=i(d);if(a?!GR(p,d.values[o],r):!r(p,d.values[o]))return d.values[o]=p,1}return 0},reconfigure:(d,f)=>{let p,m=f.config.address[s];if(m!=null){let g=gy(f,m);if(this.dependencies.every(y=>y instanceof Re?f.facet(y)===d.facet(y):y instanceof zi?f.field(y,!1)==d.field(y,!1):!0)||(a?GR(p=i(d),g,r):r(p=i(d),g)))return d.values[o]=g,0}else p=i(d);return d.values[o]=p,1}}}}function GR(t,e,n){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!n(t[i],e[i]))return!1;return!0}function J2(t,e){let n=!1;for(let i of e)Qh(t,i)&1&&(n=!0);return n}function zQ(t,e,n){let i=n.map(l=>t[l.id]),r=n.map(l=>l.type),s=i.filter(l=>!(l&1)),o=t[e.id]>>1;function a(l){let c=[];for(let u=0;u<i.length;u++){let d=gy(l,i[u]);if(r[u]==2)for(let f of d)c.push(f);else c.push(d)}return e.combine(c)}return{create(l){for(let c of i)Qh(l,c);return l.values[o]=a(l),1},update(l,c){if(!J2(l,s))return 0;let u=a(l);return e.compare(u,l.values[o])?0:(l.values[o]=u,1)},reconfigure(l,c){let u=J2(l,i),d=c.config.facets[e.id],f=c.facet(e);if(d&&!u&&hE(n,d))return l.values[o]=f,0;let p=a(l);return e.compare(p,f)?(l.values[o]=f,0):(l.values[o]=p,1)}}}const Og=Re.define({static:!0});class zi{constructor(e,n,i,r,s){this.id=e,this.createF=n,this.updateF=i,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let n=new zi(fE++,e.create,e.update,e.compare||((i,r)=>i===r),e);return e.provide&&(n.provides=e.provide(n)),n}create(e){let n=e.facet(Og).find(i=>i.field==this);return((n==null?void 0:n.create)||this.createF)(e)}slot(e){let n=e[this.id]>>1;return{create:i=>(i.values[n]=this.create(i),1),update:(i,r)=>{let s=i.values[n],o=this.updateF(s,r);return this.compareF(s,o)?0:(i.values[n]=o,1)},reconfigure:(i,r)=>{let s=i.facet(Og),o=r.facet(Og),a;return(a=s.find(l=>l.field==this))&&a!=o.find(l=>l.field==this)?(i.values[n]=a.create(i),1):r.config.address[this.id]!=null?(i.values[n]=r.field(this),0):(i.values[n]=this.create(i),1)}}}init(e){return[this,Og.of({field:this,create:e})]}get extension(){return this}}const Ac={lowest:4,low:3,default:2,high:1,highest:0};function Jf(t){return e=>new b8(e,t)}const Im={highest:Jf(Ac.highest),high:Jf(Ac.high),default:Jf(Ac.default),low:Jf(Ac.low),lowest:Jf(Ac.lowest)};class b8{constructor(e,n){this.inner=e,this.prec=n}}class Tm{of(e){return new Z2(this,e)}reconfigure(e){return Tm.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Z2{constructor(e,n){this.compartment=e,this.inner=n}}class my{constructor(e,n,i,r,s,o){for(this.base=e,this.compartments=n,this.dynamicSlots=i,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let n=this.address[e.id];return n==null?e.default:this.staticValues[n>>1]}static resolve(e,n,i){let r=[],s=Object.create(null),o=new Map;for(let f of UQ(e,n,o))f instanceof zi?r.push(f):(s[f.facet.id]||(s[f.facet.id]=[])).push(f);let a=Object.create(null),l=[],c=[];for(let f of r)a[f.id]=c.length<<1,c.push(p=>f.slot(p));let u=i==null?void 0:i.config.facets;for(let f in s){let p=s[f],m=p[0].facet,g=u&&u[f]||[];if(p.every(y=>y.type==0))if(a[m.id]=l.length<<1|1,hE(g,p))l.push(i.facet(m));else{let y=m.combine(p.map(v=>v.value));l.push(i&&m.compare(y,i.facet(m))?i.facet(m):y)}else{for(let y of p)y.type==0?(a[y.id]=l.length<<1|1,l.push(y.value)):(a[y.id]=c.length<<1,c.push(v=>y.dynamicSlot(v)));a[m.id]=c.length<<1,c.push(y=>zQ(y,m,p))}}let d=c.map(f=>f(a));return new my(e,o,d,a,l,s)}}function UQ(t,e,n){let i=[[],[],[],[],[]],r=new Map;function s(o,a){let l=r.get(o);if(l!=null){if(l<=a)return;let c=i[l].indexOf(o);c>-1&&i[l].splice(c,1),o instanceof Z2&&n.delete(o.compartment)}if(r.set(o,a),Array.isArray(o))for(let c of o)s(c,a);else if(o instanceof Z2){if(n.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;n.set(o.compartment,c),s(c,a)}else if(o instanceof b8)s(o.inner,o.prec);else if(o instanceof zi)i[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof Q0)i[a].push(o),o.facet.extensions&&s(o.facet.extensions,Ac.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(c,a)}}return s(t,Ac.default),i.reduce((o,a)=>o.concat(a))}function Qh(t,e){if(e&1)return 2;let n=e>>1,i=t.status[n];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;t.status[n]=4;let r=t.computeSlot(t,t.config.dynamicSlots[n]);return t.status[n]=2|r}function gy(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}const x8=Re.define(),Q2=Re.define({combine:t=>t.some(e=>e),static:!0}),w8=Re.define({combine:t=>t.length?t[0]:void 0,static:!0}),S8=Re.define(),k8=Re.define(),C8=Re.define(),_8=Re.define({combine:t=>t.length?t[0]:!1});class Ca{constructor(e,n){this.type=e,this.value=n}static define(){return new VQ}}class VQ{of(e){return new Ca(this,e)}}class HQ{constructor(e){this.map=e}of(e){return new pt(this,e)}}class pt{constructor(e,n){this.type=e,this.value=n}map(e){let n=this.type.map(this.value,e);return n===void 0?void 0:n==this.value?this:new pt(this.type,n)}is(e){return this.type==e}static define(e={}){return new HQ(e.map||(n=>n))}static mapEffects(e,n){if(!e.length)return e;let i=[];for(let r of e){let s=r.map(n);s&&i.push(s)}return i}}pt.reconfigure=pt.define();pt.appendConfig=pt.define();class Un{constructor(e,n,i,r,s,o){this.startState=e,this.changes=n,this.selection=i,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&y8(i,n.newLength),s.some(a=>a.type==Un.time)||(this.annotations=s.concat(Un.time.of(Date.now())))}static create(e,n,i,r,s,o){return new Un(e,n,i,r,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let n of this.annotations)if(n.type==e)return n.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let n=this.annotation(Un.userEvent);return!!(n&&(n==e||n.length>e.length&&n.slice(0,e.length)==e&&n[e.length]=="."))}}Un.time=Ca.define();Un.userEvent=Ca.define();Un.addToHistory=Ca.define();Un.remote=Ca.define();function WQ(t,e){let n=[];for(let i=0,r=0;;){let s,o;if(i<t.length&&(r==e.length||e[r]>=t[i]))s=t[i++],o=t[i++];else if(r<e.length)s=e[r++],o=e[r++];else return n;!n.length||n[n.length-1]<s?n.push(s,o):n[n.length-1]<o&&(n[n.length-1]=o)}}function E8(t,e,n){var i;let r,s,o;return n?(r=e.changes,s=Bn.empty(e.changes.length),o=t.changes.compose(e.changes)):(r=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(i=t.selection)===null||i===void 0?void 0:i.map(r),effects:pt.mapEffects(t.effects,r).concat(pt.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function ek(t,e,n){let i=e.selection,r=Sd(e.annotations);return e.userEvent&&(r=r.concat(Un.userEvent.of(e.userEvent))),{changes:e.changes instanceof Bn?e.changes:Bn.of(e.changes||[],n,t.facet(w8)),selection:i&&(i instanceof ue?i:ue.single(i.anchor,i.head)),effects:Sd(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function A8(t,e,n){let i=ek(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(n=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(n=!1);let o=!!e[s].sequential;i=E8(i,ek(t,e[s],o?i.changes.newLength:t.doc.length),o)}let r=Un.create(t,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return XQ(n?GQ(r):r)}function GQ(t){let e=t.startState,n=!0;for(let r of e.facet(S8)){let s=r(t);if(s===!1){n=!1;break}Array.isArray(s)&&(n=n===!0?s:WQ(n,s))}if(n!==!0){let r,s;if(n===!1)s=t.changes.invertedDesc,r=Bn.empty(e.doc.length);else{let o=t.changes.filter(n);r=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}t=Un.create(e,r,t.selection&&t.selection.map(s),pt.mapEffects(t.effects,s),t.annotations,t.scrollIntoView)}let i=e.facet(k8);for(let r=i.length-1;r>=0;r--){let s=i[r](t);s instanceof Un?t=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Un?t=s[0]:t=A8(e,Sd(s),!1)}return t}function XQ(t){let e=t.startState,n=e.facet(C8),i=t;for(let r=n.length-1;r>=0;r--){let s=n[r](t);s&&Object.keys(s).length&&(i=E8(i,ek(e,s,t.changes.newLength),!0))}return i==t?t:Un.create(e,t.changes,t.selection,i.effects,i.annotations,i.scrollIntoView)}const qQ=[];function Sd(t){return t==null?qQ:Array.isArray(t)?t:[t]}var ui=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(ui||(ui={}));const KQ=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let tk;try{tk=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function YQ(t){if(tk)return tk.test(t);for(let e=0;e<t.length;e++){let n=t[e];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||KQ.test(n)))return!0}return!1}function JQ(t){return e=>{if(!/\S/.test(e))return ui.Space;if(YQ(e))return ui.Word;for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return ui.Word;return ui.Other}}class kt{constructor(e,n,i,r,s,o){this.config=e,this.doc=n,this.selection=i,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)Qh(this,a<<1);this.computeSlot=null}field(e,n=!0){let i=this.config.address[e.id];if(i==null){if(n)throw new RangeError("Field is not present in this state");return}return Qh(this,i),gy(this,i)}update(...e){return A8(this,e,!0)}applyTransaction(e){let n=this.config,{base:i,compartments:r}=n;for(let a of e.effects)a.is(Tm.reconfigure)?(n&&(r=new Map,n.compartments.forEach((l,c)=>r.set(c,l)),n=null),r.set(a.value.compartment,a.value.extension)):a.is(pt.reconfigure)?(n=null,i=a.value):a.is(pt.appendConfig)&&(n=null,i=Sd(i).concat(a.value));let s;n?s=e.startState.values.slice():(n=my.resolve(i,r,this),s=new kt(n,this.doc,this.selection,n.dynamicSlots.map(()=>null),(l,c)=>c.reconfigure(l,this),null).values);let o=e.startState.facet(Q2)?e.newSelection:e.newSelection.asSingle();new kt(n,e.newDoc,o,s,(a,l)=>l.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:e},range:ue.cursor(n.from+e.length)}))}changeByRange(e){let n=this.selection,i=e(n.ranges[0]),r=this.changes(i.changes),s=[i.range],o=Sd(i.effects);for(let a=1;a<n.ranges.length;a++){let l=e(n.ranges[a]),c=this.changes(l.changes),u=c.map(r);for(let f=0;f<a;f++)s[f]=s[f].map(u);let d=r.mapDesc(c,!0);s.push(l.range.map(d)),r=r.compose(u),o=pt.mapEffects(o,u).concat(pt.mapEffects(Sd(l.effects),d))}return{changes:r,selection:ue.create(s,n.mainIndex),effects:o}}changes(e=[]){return e instanceof Bn?e:Bn.of(e,this.doc.length,this.facet(kt.lineSeparator))}toText(e){return Nt.of(e.split(this.facet(kt.lineSeparator)||q2))}sliceDoc(e=0,n=this.doc.length){return this.doc.sliceString(e,n,this.lineBreak)}facet(e){let n=this.config.address[e.id];return n==null?e.default:(Qh(this,n),gy(this,n))}toJSON(e){let n={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let r=e[i];r instanceof zi&&this.config.address[r.id]!=null&&(n[i]=r.spec.toJSON(this.field(e[i]),this))}return n}static fromJSON(e,n={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(i){for(let s in i)if(Object.prototype.hasOwnProperty.call(e,s)){let o=i[s],a=e[s];r.push(o.init(l=>o.spec.fromJSON(a,l)))}}return kt.create({doc:e.doc,selection:ue.fromJSON(e.selection),extensions:n.extensions?r.concat([n.extensions]):r})}static create(e={}){let n=my.resolve(e.extensions||[],new Map),i=e.doc instanceof Nt?e.doc:Nt.of((e.doc||"").split(n.staticFacet(kt.lineSeparator)||q2)),r=e.selection?e.selection instanceof ue?e.selection:ue.single(e.selection.anchor,e.selection.head):ue.single(0);return y8(r,i.length),n.staticFacet(Q2)||(r=r.asSingle()),new kt(n,i,r,n.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(kt.tabSize)}get lineBreak(){return this.facet(kt.lineSeparator)||`
`}get readOnly(){return this.facet(_8)}phrase(e,...n){for(let i of this.facet(kt.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return n.length&&(e=e.replace(/\$(\$|\d*)/g,(i,r)=>{if(r=="$")return"$";let s=+(r||1);return!s||s>n.length?i:n[s-1]})),e}languageDataAt(e,n,i=-1){let r=[];for(let s of this.facet(x8))for(let o of s(this,n,i))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return JQ(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:n,from:i,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-i,a=e-i;for(;o>0;){let l=ci(n,o,!1);if(s(n.slice(l,o))!=ui.Word)break;o=l}for(;a<r;){let l=ci(n,a);if(s(n.slice(a,l))!=ui.Word)break;a=l}return o==a?null:ue.range(o+i,a+i)}}kt.allowMultipleSelections=Q2;kt.tabSize=Re.define({combine:t=>t.length?t[0]:4});kt.lineSeparator=w8;kt.readOnly=_8;kt.phrases=Re.define({compare(t,e){let n=Object.keys(t),i=Object.keys(e);return n.length==i.length&&n.every(r=>t[r]==e[r])}});kt.languageData=x8;kt.changeFilter=S8;kt.transactionFilter=k8;kt.transactionExtender=C8;Tm.reconfigure=pt.define();function Zl(t,e,n={}){let i={};for(let r of t)for(let s of Object.keys(r)){let o=r[s],a=i[s];if(a===void 0)i[s]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(n,s))i[s]=n[s](a,o);else throw new Error("Config merge conflict for field "+s)}for(let r in e)i[r]===void 0&&(i[r]=e[r]);return i}class tu{eq(e){return this==e}range(e,n=e){return nk.create(e,n,this)}}tu.prototype.startSide=tu.prototype.endSide=0;tu.prototype.point=!1;tu.prototype.mapMode=rr.TrackDel;let nk=class P8{constructor(e,n,i){this.from=e,this.to=n,this.value=i}static create(e,n,i){return new P8(e,n,i)}};function ik(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class pE{constructor(e,n,i,r){this.from=e,this.to=n,this.value=i,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,n,i,r=0){let s=i?this.to:this.from;for(let o=r,a=s.length;;){if(o==a)return o;let l=o+a>>1,c=s[l]-e||(i?this.value[l].endSide:this.value[l].startSide)-n;if(l==o)return c>=0?o:a;c>=0?a=l:o=l+1}}between(e,n,i,r){for(let s=this.findIndex(n,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,n){let i=[],r=[],s=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],u=this.from[l]+e,d=this.to[l]+e,f,p;if(u==d){let m=n.mapPos(u,c.startSide,c.mapMode);if(m==null||(f=p=m,c.startSide!=c.endSide&&(p=n.mapPos(u,c.endSide),p<f)))continue}else if(f=n.mapPos(u,c.startSide),p=n.mapPos(d,c.endSide),f>p||f==p&&c.startSide>0&&c.endSide<=0)continue;(p-f||c.endSide-c.startSide)<0||(o<0&&(o=f),c.point&&(a=Math.max(a,p-f)),i.push(c),r.push(f-o),s.push(p-o))}return{mapped:i.length?new pE(r,s,i,a):null,pos:o}}}class Bt{constructor(e,n,i,r){this.chunkPos=e,this.chunk=n,this.nextLayer=i,this.maxPoint=r}static create(e,n,i,r){return new Bt(e,n,i,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let n of this.chunk)e+=n.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:n=[],sort:i=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(n.length==0&&!o)return this;if(i&&(n=n.slice().sort(ik)),this.isEmpty)return n.length?Bt.of(n):this;let a=new N8(this,null,-1).goto(0),l=0,c=[],u=new Bl;for(;a.value||l<n.length;)if(l<n.length&&(a.from-n[l].from||a.startSide-n[l].value.startSide)>=0){let d=n[l++];u.addInner(d.from,d.to,d.value)||c.push(d)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==n.length||this.chunkEnd(a.chunkIndex)<n[l].from)&&(!o||r>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&u.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||r>a.to||s<a.from||o(a.from,a.to,a.value))&&(u.addInner(a.from,a.to,a.value)||c.push(nk.create(a.from,a.to,a.value))),a.next());return u.finishInner(this.nextLayer.isEmpty&&!c.length?Bt.empty:this.nextLayer.update({add:c,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let n=[],i=[],r=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],c=e.touchesRange(a,a+l.length);if(c===!1)r=Math.max(r,l.maxPoint),n.push(l),i.push(e.mapPos(a));else if(c===!0){let{mapped:u,pos:d}=l.map(a,e);u&&(r=Math.max(r,u.maxPoint),n.push(u),i.push(d))}}let s=this.nextLayer.map(e);return n.length==0?s:new Bt(i,n,s||Bt.empty,r)}between(e,n,i){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(n>=s&&e<=s+o.length&&o.between(s,e-s,n-s,i)===!1)return}this.nextLayer.between(e,n,i)}}iter(e=0){return Gp.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,n=0){return Gp.from(e).goto(n)}static compare(e,n,i,r,s=-1){let o=e.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),a=n.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),l=XR(o,a,i),c=new Zf(o,l,s),u=new Zf(a,l,s);i.iterGaps((d,f,p)=>qR(c,d,u,f,p,r)),i.empty&&i.length==0&&qR(c,0,u,0,0,r)}static eq(e,n,i=0,r){r==null&&(r=999999999);let s=e.filter(u=>!u.isEmpty&&n.indexOf(u)<0),o=n.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let a=XR(s,o),l=new Zf(s,a,0).goto(i),c=new Zf(o,a,0).goto(i);for(;;){if(l.to!=c.to||!rk(l.active,c.active)||l.point&&(!c.point||!l.point.eq(c.point)))return!1;if(l.to>r)return!0;l.next(),c.next()}}static spans(e,n,i,r,s=-1){let o=new Zf(e,null,s).goto(n),a=n,l=o.openStart;for(;;){let c=Math.min(o.to,i);if(o.point){let u=o.activeForPoint(o.to),d=o.pointFrom<n?u.length+1:o.point.startSide<0?u.length:Math.min(u.length,l);r.point(a,c,o.point,u,d,o.pointRank),l=Math.min(o.openEnd(c),u.length)}else c>a&&(r.span(a,c,o.active,l),l=o.openEnd(c));if(o.to>i)return l+(o.point&&o.to>i?1:0);a=o.to,o.next()}}static of(e,n=!1){let i=new Bl;for(let r of e instanceof nk?[e]:n?ZQ(e):e)i.add(r.from,r.to,r.value);return i.finish()}static join(e){if(!e.length)return Bt.empty;let n=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let r=e[i];r!=Bt.empty;r=r.nextLayer)n=new Bt(r.chunkPos,r.chunk,n,Math.max(r.maxPoint,n.maxPoint));return n}}Bt.empty=new Bt([],[],null,-1);function ZQ(t){if(t.length>1)for(let e=t[0],n=1;n<t.length;n++){let i=t[n];if(ik(e,i)>0)return t.slice().sort(ik);e=i}return t}Bt.empty.nextLayer=Bt.empty;class Bl{finishChunk(e){this.chunks.push(new pE(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,n,i){this.addInner(e,n,i)||(this.nextLayer||(this.nextLayer=new Bl)).add(e,n,i)}addInner(e,n,i){let r=e-this.lastTo||i.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(n-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=n,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,n-e)),!0)}addChunk(e,n){if((e-this.lastTo||n.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,n.maxPoint),this.chunks.push(n),this.chunkPos.push(e);let i=n.value.length-1;return this.last=n.value[i],this.lastFrom=n.from[i]+e,this.lastTo=n.to[i]+e,!0}finish(){return this.finishInner(Bt.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let n=Bt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,n}}function XR(t,e,n){let i=new Map;for(let s of t)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&i.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=i.get(s.chunk[o]);a!=null&&(n?n.mapPos(a):a)==s.chunkPos[o]&&!(n!=null&&n.touchesRange(a,a+s.chunk[o].length))&&r.add(s.chunk[o])}return r}class N8{constructor(e,n,i,r=0){this.layer=e,this.skip=n,this.minPoint=i,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,n=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,n,!1),this}gotoInner(e,n,i){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],n,!0);(!i||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,n){(this.to-e||this.endSide-n)<0&&this.gotoInner(e,n,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],n=this.layer.chunk[this.chunkIndex],i=e+n.from[this.rangeIndex];if(this.from=i,this.to=e+n.to[this.rangeIndex],this.value=n.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Gp{constructor(e){this.heap=e}static from(e,n=null,i=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&r.push(new N8(o,n,i,s));return r.length==1?r[0]:new Gp(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,n=-1e9){for(let i of this.heap)i.goto(e,n);for(let i=this.heap.length>>1;i>=0;i--)Xx(this.heap,i);return this.next(),this}forward(e,n){for(let i of this.heap)i.forward(e,n);for(let i=this.heap.length>>1;i>=0;i--)Xx(this.heap,i);(this.to-e||this.value.endSide-n)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Xx(this.heap,0)}}}function Xx(t,e){for(let n=t[e];;){let i=(e<<1)+1;if(i>=t.length)break;let r=t[i];if(i+1<t.length&&r.compare(t[i+1])>=0&&(r=t[i+1],i++),n.compare(r)<0)break;t[i]=n,t[e]=r,e=i}}class Zf{constructor(e,n,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Gp.from(e,n,i)}goto(e,n=-1e9){return this.cursor.goto(e,n),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=n,this.openStart=-1,this.next(),this}forward(e,n){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-n)<0;)this.removeActive(this.minActive);this.cursor.forward(e,n)}removeActive(e){Lg(this.active,e),Lg(this.activeTo,e),Lg(this.activeRank,e),this.minActive=KR(this.active,this.activeTo)}addActive(e){let n=0,{value:i,to:r,rank:s}=this.cursor;for(;n<this.activeRank.length&&(s-this.activeRank[n]||r-this.activeTo[n])>0;)n++;Dg(this.active,n,i),Dg(this.activeTo,n,r),Dg(this.activeRank,n,s),e&&Dg(e,n,this.cursor.from),this.minActive=KR(this.active,this.activeTo)}next(){let e=this.to,n=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&Lg(i,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(i),this.cursor.next();else if(n&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let r=i.length-1;r>=0&&i[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let n=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&n.push(this.active[i]);return n.reverse()}openEnd(e){let n=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)n++;return n}}function qR(t,e,n,i,r,s){t.goto(e),n.goto(i);let o=i+r,a=i,l=i-e;for(;;){let c=t.to+l-n.to,u=c||t.endSide-n.endSide,d=u<0?t.to+l:n.to,f=Math.min(d,o);if(t.point||n.point?t.point&&n.point&&(t.point==n.point||t.point.eq(n.point))&&rk(t.activeForPoint(t.to),n.activeForPoint(n.to))||s.comparePoint(a,f,t.point,n.point):f>a&&!rk(t.active,n.active)&&s.compareRange(a,f,t.active,n.active),d>o)break;(c||t.openEnd!=n.openEnd)&&s.boundChange&&s.boundChange(d),a=d,u<=0&&t.next(),u>=0&&n.next()}}function rk(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n]&&!t[n].eq(e[n]))return!1;return!0}function Lg(t,e){for(let n=e,i=t.length-1;n<i;n++)t[n]=t[n+1];t.pop()}function Dg(t,e,n){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=n}function KR(t,e){let n=-1,i=1e9;for(let r=0;r<e.length;r++)(e[r]-i||t[r].endSide-t[n].endSide)<0&&(n=r,i=e[r]);return n}function Om(t,e,n=t.length){let i=0;for(let r=0;r<n&&r<t.length;)t.charCodeAt(r)==9?(i+=e-i%e,r++):(i++,r=ci(t,r));return i}function QQ(t,e,n,i){for(let r=0,s=0;;){if(s>=e)return r;if(r==t.length)break;s+=t.charCodeAt(r)==9?n-s%n:1,r=ci(t,r)}return t.length}const sk="ͼ",YR=typeof Symbol>"u"?"__"+sk:Symbol.for(sk),ok=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),JR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class $l{constructor(e,n){this.rules=[];let{finish:i}=n||{};function r(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,l,c){let u=[],d=/^@(\w+)\b/.exec(o[0]),f=d&&d[1]=="keyframes";if(d&&a==null)return l.push(o[0]+";");for(let p in a){let m=a[p];if(/&/.test(p))s(p.split(/,\s*/).map(g=>o.map(y=>g.replace(/&/,y))).reduce((g,y)=>g.concat(y)),m,l);else if(m&&typeof m=="object"){if(!d)throw new RangeError("The value of a property ("+p+") should be a primitive value.");s(r(p),m,u,f)}else m!=null&&u.push(p.replace(/_.*/,"").replace(/[A-Z]/g,g=>"-"+g.toLowerCase())+": "+m+";")}(u.length||f)&&l.push((i&&!d&&!c?o.map(i):o).join(", ")+" {"+u.join(" ")+"}")}for(let o in e)s(r(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=JR[YR]||1;return JR[YR]=e+1,sk+e.toString(36)}static mount(e,n,i){let r=e[ok],s=i&&i.nonce;r?s&&r.setNonce(s):r=new eee(e,s),r.mount(Array.isArray(n)?n:[n],e)}}let ZR=new Map;class eee{constructor(e,n){let i=e.ownerDocument||e,r=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let s=ZR.get(i);if(s)return e[ok]=s;this.sheet=new r.CSSStyleSheet,ZR.set(i,this)}else this.styleTag=i.createElement("style"),n&&this.styleTag.setAttribute("nonce",n);this.modules=[],e[ok]=this}mount(e,n){let i=this.sheet,r=0,s=0;for(let o=0;o<e.length;o++){let a=e[o],l=this.modules.indexOf(a);if(l<s&&l>-1&&(this.modules.splice(l,1),s--,l=-1),l==-1){if(this.modules.splice(s++,0,a),i)for(let c=0;c<a.rules.length;c++)i.insertRule(a.rules[c],r++)}else{for(;s<l;)r+=this.modules[s++].rules.length;r+=a.rules.length,s++}}if(i)n.adoptedStyleSheets.indexOf(this.sheet)<0&&(n.adoptedStyleSheets=[this.sheet,...n.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=n.head||n;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Fl={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Xp={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},tee=typeof navigator<"u"&&/Mac/.test(navigator.platform),nee=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var si=0;si<10;si++)Fl[48+si]=Fl[96+si]=String(si);for(var si=1;si<=24;si++)Fl[si+111]="F"+si;for(var si=65;si<=90;si++)Fl[si]=String.fromCharCode(si+32),Xp[si]=String.fromCharCode(si);for(var qx in Fl)Xp.hasOwnProperty(qx)||(Xp[qx]=Fl[qx]);function iee(t){var e=tee&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||nee&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Xp:Fl)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}function Ht(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var r=n[i];typeof r=="string"?t.setAttribute(i,r):r!=null&&(t[i]=r)}e++}for(;e<arguments.length;e++)M8(t,arguments[e]);return t}function M8(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)M8(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}function qp(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function ak(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function ev(t,e){if(!e.anchorNode)return!1;try{return ak(t,e.anchorNode)}catch{return!1}}function Kp(t){return t.nodeType==3?iu(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function ep(t,e,n,i){return n?QR(t,e,n,i,-1)||QR(t,e,n,i,1):!1}function nu(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function vy(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function QR(t,e,n,i,r){for(;;){if(t==n&&e==i)return!0;if(e==(r<0?0:No(t))){if(t.nodeName=="DIV")return!1;let s=t.parentNode;if(!s||s.nodeType!=1)return!1;e=nu(t)+(r<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(r<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=r<0?No(t):0}else return!1}}function No(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Wb(t,e){let n=e?t.left:t.right;return{left:n,right:n,top:t.top,bottom:t.bottom}}function ree(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function R8(t,e){let n=e.width/t.offsetWidth,i=e.height/t.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.width-t.offsetWidth)<1)&&(n=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-t.offsetHeight)<1)&&(i=1),{scaleX:n,scaleY:i}}function see(t,e,n,i,r,s,o,a){let l=t.ownerDocument,c=l.defaultView||window;for(let u=t,d=!1;u&&!d;)if(u.nodeType==1){let f,p=u==l.body,m=1,g=1;if(p)f=ree(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(d=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let b=u.getBoundingClientRect();({scaleX:m,scaleY:g}=R8(u,b)),f={left:b.left,right:b.left+u.clientWidth*m,top:b.top,bottom:b.top+u.clientHeight*g}}let y=0,v=0;if(r=="nearest")e.top<f.top?(v=e.top-(f.top+o),n>0&&e.bottom>f.bottom+v&&(v=e.bottom-f.bottom+o)):e.bottom>f.bottom&&(v=e.bottom-f.bottom+o,n<0&&e.top-v<f.top&&(v=e.top-(f.top+o)));else{let b=e.bottom-e.top,w=f.bottom-f.top;v=(r=="center"&&b<=w?e.top+b/2-w/2:r=="start"||r=="center"&&n<0?e.top-o:e.bottom-w+o)-f.top}if(i=="nearest"?e.left<f.left?(y=e.left-(f.left+s),n>0&&e.right>f.right+y&&(y=e.right-f.right+s)):e.right>f.right&&(y=e.right-f.right+s,n<0&&e.left<f.left+y&&(y=e.left-(f.left+s))):y=(i=="center"?e.left+(e.right-e.left)/2-(f.right-f.left)/2:i=="start"==a?e.left-s:e.right-(f.right-f.left)+s)-f.left,y||v)if(p)c.scrollBy(y,v);else{let b=0,w=0;if(v){let k=u.scrollTop;u.scrollTop+=v/g,w=(u.scrollTop-k)*g}if(y){let k=u.scrollLeft;u.scrollLeft+=y/m,b=(u.scrollLeft-k)*m}e={left:e.left-b,top:e.top-w,right:e.right-b,bottom:e.bottom-w},b&&Math.abs(b-y)<1&&(i="nearest"),w&&Math.abs(w-v)<1&&(r="nearest")}if(p)break;(e.top<f.top||e.bottom>f.bottom||e.left<f.left||e.right>f.right)&&(e={left:Math.max(e.left,f.left),right:Math.min(e.right,f.right),top:Math.max(e.top,f.top),bottom:Math.min(e.bottom,f.bottom)}),u=u.assignedSlot||u.parentNode}else if(u.nodeType==11)u=u.host;else break}function oee(t){let e=t.ownerDocument,n,i;for(let r=t.parentNode;r&&!(r==e.body||n&&i);)if(r.nodeType==1)!i&&r.scrollHeight>r.clientHeight&&(i=r),!n&&r.scrollWidth>r.clientWidth&&(n=r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;return{x:n,y:i}}class aee{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:n,focusNode:i}=e;this.set(n,Math.min(e.anchorOffset,n?No(n):0),i,Math.min(e.focusOffset,i?No(i):0))}set(e,n,i,r){this.anchorNode=e,this.anchorOffset=n,this.focusNode=i,this.focusOffset=r}}let ku=null;function I8(t){if(t.setActive)return t.setActive();if(ku)return t.focus(ku);let e=[];for(let n=t;n&&(e.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(t.focus(ku==null?{get preventScroll(){return ku={preventScroll:!0},!0}}:void 0),!ku){ku=!1;for(let n=0;n<e.length;){let i=e[n++],r=e[n++],s=e[n++];i.scrollTop!=r&&(i.scrollTop=r),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let eI;function iu(t,e,n=e){let i=eI||(eI=document.createRange());return i.setEnd(t,n),i.setStart(t,e),i}function kd(t,e,n,i){let r={key:e,code:e,keyCode:n,which:n,cancelable:!0};i&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=i);let s=new KeyboardEvent("keydown",r);s.synthetic=!0,t.dispatchEvent(s);let o=new KeyboardEvent("keyup",r);return o.synthetic=!0,t.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function lee(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function T8(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function cee(t,e){let n=e.focusNode,i=e.focusOffset;if(!n||e.anchorNode!=n||e.anchorOffset!=i)return!1;for(i=Math.min(i,No(n));;)if(i){if(n.nodeType!=1)return!1;let r=n.childNodes[i-1];r.contentEditable=="false"?i--:(n=r,i=No(n))}else{if(n==t)return!0;i=nu(n),n=n.parentNode}}function O8(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function L8(t,e){for(let n=t,i=e;;){if(n.nodeType==3&&i>0)return{node:n,offset:i};if(n.nodeType==1&&i>0){if(n.contentEditable=="false")return null;n=n.childNodes[i-1],i=No(n)}else if(n.parentNode&&!vy(n))i=nu(n),n=n.parentNode;else return null}}function D8(t,e){for(let n=t,i=e;;){if(n.nodeType==3&&i<n.nodeValue.length)return{node:n,offset:i};if(n.nodeType==1&&i<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[i],i=0}else if(n.parentNode&&!vy(n))i=nu(n)+1,n=n.parentNode;else return null}}class ki{constructor(e,n,i=!0){this.node=e,this.offset=n,this.precise=i}static before(e,n){return new ki(e.parentNode,nu(e),n)}static after(e,n){return new ki(e.parentNode,nu(e)+1,n)}}const mE=[];class Gt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let n=this.posAtStart;for(let i of this.children){if(i==e)return n;n+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,n){if(this.flags&2){let i=this.dom,r=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=r?r.nextSibling:i.firstChild)){let a=Gt.get(s);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,n),o.flags&=-8}if(s=r?r.nextSibling:i.firstChild,n&&!n.written&&n.node==i&&s!=o.dom&&(n.written=!0),o.dom.parentNode==i)for(;s&&s!=o.dom;)s=tI(s);else i.insertBefore(o.dom,s);r=o.dom}for(s=r?r.nextSibling:i.firstChild,s&&n&&n.node==i&&(n.written=!0);s;)s=tI(s)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,n),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,n){let i;if(e==this.dom)i=this.dom.childNodes[n];else{let r=No(e)==0?0:n==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!Gt.get(i);)i=i.nextSibling;if(!i)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==i)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,n,i=0){let r=-1,s=-1,o=-1,a=-1;for(let l=0,c=i,u=i;l<this.children.length;l++){let d=this.children[l],f=c+d.length;if(c<e&&f>n)return d.domBoundsAround(e,n,c);if(f>=e&&r==-1&&(r=l,s=c),c>n&&d.dom.parentNode==this.dom){o=l,a=u;break}u=f,c=f+d.breakAfter}return{from:s,to:a<0?i+this.length:a,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let n=this.parent;n;n=n.parent){if(e&&(n.flags|=2),n.flags&1)return;n.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let n=e.parent;if(!n)return e;e=n}}replaceChildren(e,n,i=mE){this.markDirty();for(let r=e;r<n;r++){let s=this.children[r];s.parent==this&&i.indexOf(s)<0&&s.destroy()}i.length<250?this.children.splice(e,n-e,...i):this.children=[].concat(this.children.slice(0,e),i,this.children.slice(n));for(let r=0;r<i.length;r++)i[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new j8(this.children,e,this.children.length)}childPos(e,n=1){return this.childCursor().findPos(e,n)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,n,i,r,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}Gt.prototype.breakAfter=0;function tI(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class j8{constructor(e,n,i){this.children=e,this.pos=n,this.i=i,this.off=0}findPos(e,n=1){for(;;){if(e>this.pos||e==this.pos&&(n>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function B8(t,e,n,i,r,s,o,a,l){let{children:c}=t,u=c.length?c[e]:null,d=s.length?s[s.length-1]:null,f=d?d.breakAfter:o;if(!(e==i&&u&&!o&&!f&&s.length<2&&u.merge(n,r,s.length?d:null,n==0,a,l))){if(i<c.length){let p=c[i];p&&(r<p.length||p.breakAfter&&(d!=null&&d.breakAfter))?(e==i&&(p=p.split(r),r=0),!f&&d&&p.merge(0,r,d,!0,0,l)?s[s.length-1]=p:((r||p.children.length&&!p.children[0].length)&&p.merge(0,r,null,!1,0,l),s.push(p))):p!=null&&p.breakAfter&&(d?d.breakAfter=1:o=1),i++}for(u&&(u.breakAfter=o,n>0&&(!o&&s.length&&u.merge(n,u.length,s[0],!1,a,0)?u.breakAfter=s.shift().breakAfter:(n<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(n,u.length,null,!1,a,0),e++));e<i&&s.length;)if(c[i-1].become(s[s.length-1]))i--,s.pop(),l=s.length?0:a;else if(c[e].become(s[0]))e++,s.shift(),a=s.length?0:l;else break;!s.length&&e&&i<c.length&&!c[e-1].breakAfter&&c[i].merge(0,0,c[e-1],!1,a,l)&&e--,(e<i||s.length)&&t.replaceChildren(e,i,s)}}function $8(t,e,n,i,r,s){let o=t.childCursor(),{i:a,off:l}=o.findPos(n,1),{i:c,off:u}=o.findPos(e,-1),d=e-n;for(let f of i)d+=f.length;t.length+=d,B8(t,c,u,a,l,i,0,r,s)}let ir=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},lk=typeof document<"u"?document:{documentElement:{style:{}}};const ck=/Edge\/(\d+)/.exec(ir.userAgent),F8=/MSIE \d/.test(ir.userAgent),uk=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ir.userAgent),Gb=!!(F8||uk||ck),nI=!Gb&&/gecko\/(\d+)/i.test(ir.userAgent),Kx=!Gb&&/Chrome\/(\d+)/.exec(ir.userAgent),uee="webkitFontSmoothing"in lk.documentElement.style,z8=!Gb&&/Apple Computer/.test(ir.vendor),iI=z8&&(/Mobile\/\w+/.test(ir.userAgent)||ir.maxTouchPoints>2);var Ne={mac:iI||/Mac/.test(ir.platform),windows:/Win/.test(ir.platform),linux:/Linux|X11/.test(ir.platform),ie:Gb,ie_version:F8?lk.documentMode||6:uk?+uk[1]:ck?+ck[1]:0,gecko:nI,gecko_version:nI?+(/Firefox\/(\d+)/.exec(ir.userAgent)||[0,0])[1]:0,chrome:!!Kx,chrome_version:Kx?+Kx[1]:0,ios:iI,android:/Android\b/.test(ir.userAgent),safari:z8,webkit_version:uee?+(/\bAppleWebKit\/(\d+)/.exec(ir.userAgent)||[0,0])[1]:0,tabSize:lk.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const dee=256;class Ds extends Gt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,n){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(n&&n.node==this.dom&&(n.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,n,i){return this.flags&8||i&&(!(i instanceof Ds)||this.length-(n-e)+i.length>dee||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(n),this.markDirty(),!0)}split(e){let n=new Ds(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),n.flags|=this.flags&8,n}localPosFromDOM(e,n){return e==this.dom?n:n?this.text.length:0}domAtPos(e){return new ki(this.dom,e)}domBoundsAround(e,n,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,n){return fee(this.dom,e,n)}}class va extends Gt{constructor(e,n=[],i=0){super(),this.mark=e,this.children=n,this.length=i;for(let r of n)r.setParent(this)}setAttrs(e){if(T8(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let n in this.mark.attrs)e.setAttribute(n,this.mark.attrs[n]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,n){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,n)}merge(e,n,i,r,s,o){return i&&(!(i instanceof va&&i.mark.eq(this.mark))||e&&s<=0||n<this.length&&o<=0)?!1:($8(this,e,n,i?i.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let n=[],i=0,r=-1,s=0;for(let a of this.children){let l=i+a.length;l>e&&n.push(i<e?a.split(e-i):a),r<0&&i>=e&&(r=s),i=l,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new va(this.mark,n,o)}domAtPos(e){return U8(this,e)}coordsAt(e,n){return H8(this,e,n)}}function fee(t,e,n){let i=t.nodeValue.length;e>i&&(e=i);let r=e,s=e,o=0;e==0&&n<0||e==i&&n>=0?Ne.chrome||Ne.gecko||(e?(r--,o=1):s<i&&(s++,o=-1)):n<0?r--:s<i&&s++;let a=iu(t,r,s).getClientRects();if(!a.length)return null;let l=a[(o?o<0:n>=0)?0:a.length-1];return Ne.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,c=>c.width)||l),o?Wb(l,o<0):l||null}class ol extends Gt{static create(e,n,i){return new ol(e,n,i)}constructor(e,n,i){super(),this.widget=e,this.length=n,this.side=i,this.prevWidget=null}split(e){let n=ol.create(this.widget,this.length-e,this.side);return this.length-=e,n}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,n,i,r,s,o){return i&&(!(i instanceof ol)||!this.widget.compare(i.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-n),!0)}become(e){return e instanceof ol&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Nt.empty;let e=this;for(;e.parent;)e=e.parent;let{view:n}=e,i=n&&n.state.doc,r=this.posAtStart;return i?i.slice(r,r+this.length):Nt.empty}domAtPos(e){return(this.length?e==0:this.side>0)?ki.before(this.dom):ki.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,n){let i=this.widget.coordsAt(this.dom,e,n);if(i)return i;let r=this.dom.getClientRects(),s=null;if(!r.length)return null;let o=this.side?this.side<0:e>0;for(let a=o?r.length-1:0;s=r[a],!(e>0?a==0:a==r.length-1||s.top<s.bottom);a+=o?-1:1);return Wb(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class cf extends Gt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof cf&&e.side==this.side}split(){return new cf(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?ki.before(this.dom):ki.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Nt.empty}get isHidden(){return!0}}Ds.prototype.children=ol.prototype.children=cf.prototype.children=mE;function U8(t,e){let n=t.dom,{children:i}=t,r=0;for(let s=0;r<i.length;r++){let o=i[r],a=s+o.length;if(!(a==s&&o.getSide()<=0)){if(e>s&&e<a&&o.dom.parentNode==n)return o.domAtPos(e-s);if(e<=s)break;s=a}}for(let s=r;s>0;s--){let o=i[s-1];if(o.dom.parentNode==n)return o.domAtPos(o.length)}for(let s=r;s<i.length;s++){let o=i[s];if(o.dom.parentNode==n)return o.domAtPos(0)}return new ki(n,0)}function V8(t,e,n){let i,{children:r}=t;n>0&&e instanceof va&&r.length&&(i=r[r.length-1])instanceof va&&i.mark.eq(e.mark)?V8(i,e.children[0],n-1):(r.push(e),e.setParent(t)),t.length+=e.length}function H8(t,e,n){let i=null,r=-1,s=null,o=-1;function a(c,u){for(let d=0,f=0;d<c.children.length&&f<=u;d++){let p=c.children[d],m=f+p.length;m>=u&&(p.children.length?a(p,u-f):(!s||s.isHidden&&(n>0||pee(s,p)))&&(m>u||f==m&&p.getSide()>0)?(s=p,o=u-f):(f<u||f==m&&p.getSide()<0&&!p.isHidden)&&(i=p,r=u-f)),f=m}}a(t,e);let l=(n<0?i:s)||i||s;return l?l.coordsAt(Math.max(0,l==i?r:o),n):hee(t)}function hee(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let n=Kp(e);return n[n.length-1]||null}function pee(t,e){let n=t.coordsAt(0,1),i=e.coordsAt(0,1);return n&&i&&i.top<n.bottom}function dk(t,e){for(let n in t)n=="class"&&e.class?e.class+=" "+t.class:n=="style"&&e.style?e.style+=";"+t.style:e[n]=t[n];return e}const rI=Object.create(null);function yy(t,e,n){if(t==e)return!0;t||(t=rI),e||(e=rI);let i=Object.keys(t),r=Object.keys(e);if(i.length-(n&&i.indexOf(n)>-1?1:0)!=r.length-(n&&r.indexOf(n)>-1?1:0))return!1;for(let s of i)if(s!=n&&(r.indexOf(s)==-1||t[s]!==e[s]))return!1;return!0}function fk(t,e,n){let i=!1;if(e)for(let r in e)n&&r in n||(i=!0,r=="style"?t.style.cssText="":t.removeAttribute(r));if(n)for(let r in n)e&&e[r]==n[r]||(i=!0,r=="style"?t.style.cssText=n[r]:t.setAttribute(r,n[r]));return i}function mee(t){let e=Object.create(null);for(let n=0;n<t.attributes.length;n++){let i=t.attributes[n];e[i.name]=i.value}return e}class Ql{eq(e){return!1}updateDOM(e,n){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,n,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Di=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(Di||(Di={}));class gt extends tu{constructor(e,n,i,r){super(),this.startSide=e,this.endSide=n,this.widget=i,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Lm(e)}static widget(e){let n=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return n+=i&&!e.inlineOrder?n>0?3e8:-4e8:n>0?1e8:-1e8,new zl(e,n,n,i,e.widget||null,!1)}static replace(e){let n=!!e.block,i,r;if(e.isBlockGap)i=-5e8,r=4e8;else{let{start:s,end:o}=W8(e,n);i=(s?n?-3e8:-1:5e8)-1,r=(o?n?2e8:1:-6e8)+1}return new zl(e,i,r,n,e.widget||null,!0)}static line(e){return new Dm(e)}static set(e,n=!1){return Bt.of(e,n)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}gt.none=Bt.empty;class Lm extends gt{constructor(e){let{start:n,end:i}=W8(e);super(n?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var n,i;return this==e||e instanceof Lm&&this.tagName==e.tagName&&(this.class||((n=this.attrs)===null||n===void 0?void 0:n.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&yy(this.attrs,e.attrs,"class")}range(e,n=e){if(e>=n)throw new RangeError("Mark decorations may not be empty");return super.range(e,n)}}Lm.prototype.point=!1;class Dm extends gt{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Dm&&this.spec.class==e.spec.class&&yy(this.spec.attributes,e.spec.attributes)}range(e,n=e){if(n!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,n)}}Dm.prototype.mapMode=rr.TrackBefore;Dm.prototype.point=!0;class zl extends gt{constructor(e,n,i,r,s,o){super(n,i,s,e),this.block=r,this.isReplace=o,this.mapMode=r?n<=0?rr.TrackBefore:rr.TrackAfter:rr.TrackDel}get type(){return this.startSide!=this.endSide?Di.WidgetRange:this.startSide<=0?Di.WidgetBefore:Di.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof zl&&gee(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,n=e){if(this.isReplace&&(e>n||e==n&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&n!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,n)}}zl.prototype.point=!0;function W8(t,e=!1){let{inclusiveStart:n,inclusiveEnd:i}=t;return n==null&&(n=t.inclusive),i==null&&(i=t.inclusive),{start:n??e,end:i??e}}function gee(t,e){return t==e||!!(t&&e&&t.compare(e))}function tv(t,e,n,i=0){let r=n.length-1;r>=0&&n[r]+i>=t?n[r]=Math.max(n[r],e):n.push(t,e)}class Rn extends Gt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,n,i,r,s,o){if(i){if(!(i instanceof Rn))return!1;this.dom||i.transferDOM(this)}return r&&this.setDeco(i?i.attrs:null),$8(this,e,n,i?i.children.slice():[],s,o),!0}split(e){let n=new Rn;if(n.breakAfter=this.breakAfter,this.length==0)return n;let{i,off:r}=this.childPos(e);r&&(n.append(this.children[i].split(r),0),this.children[i].merge(r,this.children[i].length,null,!1,0,0),i++);for(let s=i;s<this.children.length;s++)n.append(this.children[s],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,n}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){yy(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,n){V8(this,e,n)}addLineDeco(e){let n=e.spec.attributes,i=e.spec.class;n&&(this.attrs=dk(n,this.attrs||{})),i&&(this.attrs=dk({class:i},this.attrs||{}))}domAtPos(e){return U8(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,n){var i;this.dom?this.flags&4&&(T8(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(fk(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,n);let r=this.dom.lastChild;for(;r&&Gt.get(r)instanceof va;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((i=Gt.get(r))===null||i===void 0?void 0:i.isEditable)==!1&&(!Ne.ios||!this.children.some(s=>s instanceof Ds))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,n;for(let i of this.children){if(!(i instanceof Ds)||/[^ -~]/.test(i.text))return null;let r=Kp(i.dom);if(r.length!=1)return null;e+=r[0].width,n=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:n}:null}coordsAt(e,n){let i=H8(this,e,n);if(!this.children.length&&i&&this.parent){let{heightOracle:r}=this.parent.view.viewState,s=i.bottom-i.top;if(Math.abs(s-r.lineHeight)<2&&r.textHeight<s){let o=(s-r.textHeight)/2;return{top:i.top+o,bottom:i.bottom-o,left:i.left,right:i.left}}}return i}become(e){return e instanceof Rn&&this.children.length==0&&e.children.length==0&&yy(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,n){for(let i=0,r=0;i<e.children.length;i++){let s=e.children[i],o=r+s.length;if(o>=n){if(s instanceof Rn)return s;if(o>n)break}r=o+s.breakAfter}return null}}class la extends Gt{constructor(e,n,i){super(),this.widget=e,this.length=n,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,n,i,r,s,o){return i&&(!(i instanceof la)||!this.widget.compare(i.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-n),!0)}domAtPos(e){return e==0?ki.before(this.dom):ki.after(this.dom,e==this.length)}split(e){let n=this.length-e;this.length=e;let i=new la(this.widget,n,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return mE}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Nt.empty}domBoundsAround(){return null}become(e){return e instanceof la&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,n){let i=this.widget.coordsAt(this.dom,e,n);return i||(this.widget instanceof hk?null:Wb(this.dom.getBoundingClientRect(),this.length?e==0:n<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:n,endSide:i}=this.deco;return n==i?!1:e<0?n<0:i>0}}class hk extends Ql{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class tp{constructor(e,n,i,r){this.doc=e,this.pos=n,this.end=i,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=n}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof la&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Rn),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(jg(new cf(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof la)&&this.getLine()}buildText(e,n,i){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(n.slice(n.length-i)),this.getLine().append(jg(new Ds(this.text.slice(this.textOff,this.textOff+r)),n),i),this.atCursorPos=!0,this.textOff+=r,e-=r,i=0}}span(e,n,i,r){this.buildText(n-e,i,r),this.pos=n,this.openStart<0&&(this.openStart=r)}point(e,n,i,r,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof zl){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(n>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=n-e;if(i instanceof zl)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new la(i.widget||uf.block,a,i));else{let l=ol.create(i.widget||uf.inline,a,a?0:i.startSide),c=this.atCursorPos&&!l.isEditable&&s<=r.length&&(e<n||i.startSide>0),u=!l.isEditable&&(e<n||s>r.length||i.startSide<=0),d=this.getLine();this.pendingBuffer==2&&!c&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),c&&(d.append(jg(new cf(1),r),s),s=r.length+Math.max(0,s-r.length)),d.append(jg(l,r),s),this.atCursorPos=u,this.pendingBuffer=u?e<n||s>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=n),this.openStart<0&&(this.openStart=s)}static build(e,n,i,r,s){let o=new tp(e,n,i,s);return o.openEnd=Bt.spans(r,n,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function jg(t,e){for(let n of e)t=new va(n,[t],t.length);return t}class uf extends Ql{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}uf.inline=new uf("span");uf.block=new uf("div");var sn=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(sn||(sn={}));const ru=sn.LTR,gE=sn.RTL;function G8(t){let e=[];for(let n=0;n<t.length;n++)e.push(1<<+t[n]);return e}const vee=G8("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),yee=G8("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),pk=Object.create(null),Ws=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),n=t.charCodeAt(1);pk[e]=n,pk[n]=-e}function X8(t){return t<=247?vee[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?yee[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const bee=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class al{get dir(){return this.level%2?gE:ru}constructor(e,n,i){this.from=e,this.to=n,this.level=i}side(e,n){return this.dir==n==e?this.to:this.from}forward(e,n){return e==(this.dir==n)}static find(e,n,i,r){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=n&&a.to>=n){if(a.level==i)return o;(s<0||(r!=0?r<0?a.from<n:a.to>n:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function q8(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++){let i=t[n],r=e[n];if(i.from!=r.from||i.to!=r.to||i.direction!=r.direction||!q8(i.inner,r.inner))return!1}return!0}const Wt=[];function xee(t,e,n,i,r){for(let s=0;s<=i.length;s++){let o=s?i[s-1].to:e,a=s<i.length?i[s].from:n,l=s?256:r;for(let c=o,u=l,d=l;c<a;c++){let f=X8(t.charCodeAt(c));f==512?f=u:f==8&&d==4&&(f=16),Wt[c]=f==4?2:f,f&7&&(d=f),u=f}for(let c=o,u=l,d=l;c<a;c++){let f=Wt[c];if(f==128)c<a-1&&u==Wt[c+1]&&u&24?f=Wt[c]=u:Wt[c]=256;else if(f==64){let p=c+1;for(;p<a&&Wt[p]==64;)p++;let m=c&&u==8||p<n&&Wt[p]==8?d==1?1:8:256;for(let g=c;g<p;g++)Wt[g]=m;c=p-1}else f==8&&d==1&&(Wt[c]=1);u=f,f&7&&(d=f)}}}function wee(t,e,n,i,r){let s=r==1?2:1;for(let o=0,a=0,l=0;o<=i.length;o++){let c=o?i[o-1].to:e,u=o<i.length?i[o].from:n;for(let d=c,f,p,m;d<u;d++)if(p=pk[f=t.charCodeAt(d)])if(p<0){for(let g=a-3;g>=0;g-=3)if(Ws[g+1]==-p){let y=Ws[g+2],v=y&2?r:y&4?y&1?s:r:0;v&&(Wt[d]=Wt[Ws[g]]=v),a=g;break}}else{if(Ws.length==189)break;Ws[a++]=d,Ws[a++]=f,Ws[a++]=l}else if((m=Wt[d])==2||m==1){let g=m==r;l=g?0:1;for(let y=a-3;y>=0;y-=3){let v=Ws[y+2];if(v&2)break;if(g)Ws[y+2]|=2;else{if(v&4)break;Ws[y+2]|=4}}}}}function See(t,e,n,i){for(let r=0,s=i;r<=n.length;r++){let o=r?n[r-1].to:t,a=r<n.length?n[r].from:e;for(let l=o;l<a;){let c=Wt[l];if(c==256){let u=l+1;for(;;)if(u==a){if(r==n.length)break;u=n[r++].to,a=r<n.length?n[r].from:e}else if(Wt[u]==256)u++;else break;let d=s==1,f=(u<e?Wt[u]:i)==1,p=d==f?d?1:2:i;for(let m=u,g=r,y=g?n[g-1].to:t;m>l;)m==y&&(m=n[--g].from,y=g?n[g-1].to:t),Wt[--m]=p;l=u}else s=c,l++}}}function mk(t,e,n,i,r,s,o){let a=i%2?2:1;if(i%2==r%2)for(let l=e,c=0;l<n;){let u=!0,d=!1;if(c==s.length||l<s[c].from){let g=Wt[l];g!=a&&(u=!1,d=g==16)}let f=!u&&a==1?[]:null,p=u?i:i+1,m=l;e:for(;;)if(c<s.length&&m==s[c].from){if(d)break e;let g=s[c];if(!u)for(let y=g.to,v=c+1;;){if(y==n)break e;if(v<s.length&&s[v].from==y)y=s[v++].to;else{if(Wt[y]==a)break e;break}}if(c++,f)f.push(g);else{g.from>l&&o.push(new al(l,g.from,p));let y=g.direction==ru!=!(p%2);gk(t,y?i+1:i,r,g.inner,g.from,g.to,o),l=g.to}m=g.to}else{if(m==n||(u?Wt[m]!=a:Wt[m]==a))break;m++}f?mk(t,l,m,i+1,r,f,o):l<m&&o.push(new al(l,m,p)),l=m}else for(let l=n,c=s.length;l>e;){let u=!0,d=!1;if(!c||l>s[c-1].to){let g=Wt[l-1];g!=a&&(u=!1,d=g==16)}let f=!u&&a==1?[]:null,p=u?i:i+1,m=l;e:for(;;)if(c&&m==s[c-1].to){if(d)break e;let g=s[--c];if(!u)for(let y=g.from,v=c;;){if(y==e)break e;if(v&&s[v-1].to==y)y=s[--v].from;else{if(Wt[y-1]==a)break e;break}}if(f)f.push(g);else{g.to<l&&o.push(new al(g.to,l,p));let y=g.direction==ru!=!(p%2);gk(t,y?i+1:i,r,g.inner,g.from,g.to,o),l=g.from}m=g.from}else{if(m==e||(u?Wt[m-1]!=a:Wt[m-1]==a))break;m--}f?mk(t,m,l,i+1,r,f,o):m<l&&o.push(new al(m,l,p)),l=m}}function gk(t,e,n,i,r,s,o){let a=e%2?2:1;xee(t,r,s,i,a),wee(t,r,s,i,a),See(r,s,i,a),mk(t,r,s,e,n,i,o)}function kee(t,e,n){if(!t)return[new al(0,0,e==gE?1:0)];if(e==ru&&!n.length&&!bee.test(t))return K8(t.length);if(n.length)for(;t.length>Wt.length;)Wt[Wt.length]=256;let i=[],r=e==ru?0:1;return gk(t,r,r,n,0,t.length,i),i}function K8(t){return[new al(0,t,0)]}let Y8="";function Cee(t,e,n,i,r){var s;let o=i.head-t.from,a=al.find(e,o,(s=i.bidiLevel)!==null&&s!==void 0?s:-1,i.assoc),l=e[a],c=l.side(r,n);if(o==c){let f=a+=r?1:-1;if(f<0||f>=e.length)return null;l=e[a=f],o=l.side(!r,n),c=l.side(r,n)}let u=ci(t.text,o,l.forward(r,n));(u<l.from||u>l.to)&&(u=c),Y8=t.text.slice(Math.min(o,u),Math.max(o,u));let d=a==(r?e.length-1:0)?null:e[a+(r?1:-1)];return d&&u==c&&d.level+(r?0:1)<l.level?ue.cursor(d.side(!r,n)+t.from,d.forward(r,n)?1:-1,d.level):ue.cursor(u+t.from,l.forward(r,n)?-1:1,l.level)}function _ee(t,e,n){for(let i=e;i<n;i++){let r=X8(t.charCodeAt(i));if(r==1)return ru;if(r==2||r==4)return gE}return ru}const J8=Re.define(),Z8=Re.define(),Q8=Re.define(),e6=Re.define(),vk=Re.define(),t6=Re.define(),n6=Re.define(),vE=Re.define(),yE=Re.define(),i6=Re.define({combine:t=>t.some(e=>e)}),r6=Re.define({combine:t=>t.some(e=>e)}),s6=Re.define();class Cd{constructor(e,n="nearest",i="nearest",r=5,s=5,o=!1){this.range=e,this.y=n,this.x=i,this.yMargin=r,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new Cd(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Cd(ue.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Bg=pt.define({map:(t,e)=>t.map(e)}),o6=pt.define();function Ar(t,e,n){let i=t.facet(e6);i.length?i[0](e):window.onerror&&window.onerror(String(e),n,void 0,void 0,e)||(n?console.error(n+":",e):console.error(e))}const ia=Re.define({combine:t=>t.length?t[0]:!0});let Eee=0;const ld=Re.define({combine(t){return t.filter((e,n)=>{for(let i=0;i<n;i++)if(t[i].plugin==e.plugin)return!1;return!0})}});class pi{constructor(e,n,i,r,s){this.id=e,this.create=n,this.domEventHandlers=i,this.domEventObservers=r,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(ld.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(ld.of({plugin:this,arg:e}))}static define(e,n){const{eventHandlers:i,eventObservers:r,provide:s,decorations:o}=n||{};return new pi(Eee++,e,i,r,a=>{let l=[];return o&&l.push(Yp.of(c=>{let u=c.plugin(a);return u?o(u):gt.none})),s&&l.push(s(a)),l})}static fromClass(e,n){return pi.define((i,r)=>new e(i,r),n)}}class Yx{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let n=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(n)}catch(i){if(Ar(n.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(n){Ar(e.state,n,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var n;if(!((n=this.value)===null||n===void 0)&&n.destroy)try{this.value.destroy()}catch(i){Ar(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const a6=Re.define(),bE=Re.define(),Yp=Re.define(),l6=Re.define(),xE=Re.define(),c6=Re.define();function sI(t,e){let n=t.state.facet(c6);if(!n.length)return n;let i=n.map(s=>s instanceof Function?s(t):s),r=[];return Bt.spans(i,e.from,e.to,{point(){},span(s,o,a,l){let c=s-e.from,u=o-e.from,d=r;for(let f=a.length-1;f>=0;f--,l--){let p=a[f].spec.bidiIsolate,m;if(p==null&&(p=_ee(e.text,c,u)),l>0&&d.length&&(m=d[d.length-1]).to==c&&m.direction==p)m.to=u,d=m.inner;else{let g={from:c,to:u,direction:p,inner:[]};d.push(g),d=g.inner}}}}),r}const u6=Re.define();function wE(t){let e=0,n=0,i=0,r=0;for(let s of t.state.facet(u6)){let o=s(t);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(n=Math.max(n,o.right)),o.top!=null&&(i=Math.max(i,o.top)),o.bottom!=null&&(r=Math.max(r,o.bottom)))}return{left:e,right:n,top:i,bottom:r}}const Ah=Re.define();class os{constructor(e,n,i,r){this.fromA=e,this.toA=n,this.fromB=i,this.toB=r}join(e){return new os(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let n=e.length,i=this;for(;n>0;n--){let r=e[n-1];if(!(r.fromA>i.toA)){if(r.toA<i.fromA)break;i=i.join(r),e.splice(n-1,1)}}return e.splice(n,0,i),e}static extendWithRanges(e,n){if(n.length==0)return e;let i=[];for(let r=0,s=0,o=0,a=0;;r++){let l=r==e.length?null:e[r],c=o-a,u=l?l.fromB:1e9;for(;s<n.length&&n[s]<u;){let d=n[s],f=n[s+1],p=Math.max(a,d),m=Math.min(u,f);if(p<=m&&new os(p+c,m+c,p,m).addToSet(i),f>u)break;s+=2}if(!l)return i;new os(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,a=l.toB}}}class by{constructor(e,n,i){this.view=e,this.state=n,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=Bn.empty(this.startState.doc.length);for(let s of i)this.changes=this.changes.compose(s.changes);let r=[];this.changes.iterChangedRanges((s,o,a,l)=>r.push(new os(s,o,a,l))),this.changedRanges=r}static create(e,n,i){return new by(e,n,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class oI extends Gt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=gt.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Rn],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new os(0,0,0,e.state.doc.length)],0,null)}update(e){var n;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:c,toA:u})=>u<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let r=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((n=this.domChanged)===null||n===void 0)&&n.newSel?r=this.domChanged.newSel.head:!Tee(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let s=r>-1?Pee(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:u}=this.hasComposition;i=new os(c,u,e.changes.mapPos(c,-1),e.changes.mapPos(u,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Ne.ie||Ne.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.updateDeco(),l=Ree(o,a,e.changes);return i=os.extendWithRanges(i,l),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,n,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,n,i);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=Ne.chrome||Ne.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||r.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof la&&o.widget instanceof hk&&s.push(o.dom);r.updateGaps(s)}updateChildren(e,n,i){let r=i?i.range.addToSet(e.slice()):e,s=this.childCursor(n);for(let o=r.length-1;;o--){let a=o>=0?r[o]:null;if(!a)break;let{fromA:l,toA:c,fromB:u,toB:d}=a,f,p,m,g;if(i&&i.range.fromB<d&&i.range.toB>u){let k=tp.build(this.view.state.doc,u,i.range.fromB,this.decorations,this.dynamicDecorationMap),C=tp.build(this.view.state.doc,i.range.toB,d,this.decorations,this.dynamicDecorationMap);p=k.breakAtStart,m=k.openStart,g=C.openEnd;let E=this.compositionView(i);C.breakAtStart?E.breakAfter=1:C.content.length&&E.merge(E.length,E.length,C.content[0],!1,C.openStart,0)&&(E.breakAfter=C.content[0].breakAfter,C.content.shift()),k.content.length&&E.merge(0,0,k.content[k.content.length-1],!0,0,k.openEnd)&&k.content.pop(),f=k.content.concat(E).concat(C.content)}else({content:f,breakAtStart:p,openStart:m,openEnd:g}=tp.build(this.view.state.doc,u,d,this.decorations,this.dynamicDecorationMap));let{i:y,off:v}=s.findPos(c,1),{i:b,off:w}=s.findPos(l,-1);B8(this,b,w,y,v,f,p,m,g)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let n of e.transactions)for(let i of n.effects)i.is(o6)&&(this.editContextFormatting=i.value)}compositionView(e){let n=new Ds(e.text.nodeValue);n.flags|=8;for(let{deco:r}of e.marks)n=new va(r,[n],n.length);let i=new Rn;return i.append(n,0),i}fixCompositionDOM(e){let n=(s,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let a=Gt.get(s);a&&a!=o&&(a.dom=null),o.setDOM(s)},i=this.childPos(e.range.fromB,1),r=this.children[i.i];n(e.line,r);for(let s=e.marks.length-1;s>=-1;s--)i=r.childPos(i.off,1),r=r.children[i.i],n(s>=0?e.marks[s].node:e.text,r)}updateSelection(e=!1,n=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,r=i==this.dom,s=!r&&!(this.view.state.facet(ia)||this.dom.tabIndex>-1)&&ev(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(r||n||s))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),c=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(Ne.gecko&&a.empty&&!this.hasComposition&&Aee(l)){let d=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(d,l.node.childNodes[l.offset]||null)),l=c=new ki(d,0),o=!0}let u=this.view.observer.selectionRange;(o||!u.focusNode||(!ep(l.node,l.offset,u.anchorNode,u.anchorOffset)||!ep(c.node,c.offset,u.focusNode,u.focusOffset))&&!this.suppressWidgetCursorChange(u,a))&&(this.view.observer.ignore(()=>{Ne.android&&Ne.chrome&&this.dom.contains(u.focusNode)&&Iee(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let d=qp(this.view.root);if(d)if(a.empty){if(Ne.gecko){let f=Nee(l.node,l.offset);if(f&&f!=3){let p=(f==1?L8:D8)(l.node,l.offset);p&&(l=new ki(p.node,p.offset))}}d.collapse(l.node,l.offset),a.bidiLevel!=null&&d.caretBidiLevel!==void 0&&(d.caretBidiLevel=a.bidiLevel)}else if(d.extend){d.collapse(l.node,l.offset);try{d.extend(c.node,c.offset)}catch{}}else{let f=document.createRange();a.anchor>a.head&&([l,c]=[c,l]),f.setEnd(c.node,c.offset),f.setStart(l.node,l.offset),d.removeAllRanges(),d.addRange(f)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new ki(u.anchorNode,u.anchorOffset),this.impreciseHead=c.precise?null:new ki(u.focusNode,u.focusOffset)}suppressWidgetCursorChange(e,n){return this.hasComposition&&n.empty&&ep(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==n.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,n=e.state.selection.main,i=qp(e.root),{anchorNode:r,anchorOffset:s}=e.observer.selectionRange;if(!i||!n.empty||!n.assoc||!i.modify)return;let o=Rn.find(this,n.head);if(!o)return;let a=o.posAtStart;if(n.head==a||n.head==a+o.length)return;let l=this.coordsAt(n.head,-1),c=this.coordsAt(n.head,1);if(!l||!c||l.bottom>c.top)return;let u=this.domAtPos(n.head+n.assoc);i.collapse(u.node,u.offset),i.modify("move",n.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let d=e.observer.selectionRange;e.docView.posFromDOM(d.anchorNode,d.anchorOffset)!=n.from&&i.collapse(r,s)}moveToLine(e){let n=this.dom,i;if(e.node!=n)return e;for(let r=e.offset;!i&&r<n.childNodes.length;r++){let s=Gt.get(n.childNodes[r]);s instanceof Rn&&(i=s.domAtPos(0))}for(let r=e.offset-1;!i&&r>=0;r--){let s=Gt.get(n.childNodes[r]);s instanceof Rn&&(i=s.domAtPos(s.length))}return i?new ki(i.node,i.offset,!0):e}nearest(e){for(let n=e;n;){let i=Gt.get(n);if(i&&i.rootView==this)return i;n=n.parentNode}return null}posFromDOM(e,n){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,n)+i.posAtStart}domAtPos(e){let{i:n,off:i}=this.childCursor().findPos(e,-1);for(;n<this.children.length-1;){let r=this.children[n];if(i<r.length||r instanceof Rn)break;n++,i=0}return this.children[n].domAtPos(i)}coordsAt(e,n){let i=null,r=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=s-a.breakAfter,c=l-a.length;if(l<e)break;if(c<=e&&(c<e||a.covers(-1))&&(l>e||a.covers(1))&&(!i||a instanceof Rn&&!(i instanceof Rn&&n>=0)))i=a,r=c;else if(i&&c==e&&l==e&&a instanceof la&&Math.abs(n)<2){if(a.deco.startSide<0)break;o&&(i=null)}s=c}return i?i.coordsAt(e-r,n):null}coordsForChar(e){let{i:n,off:i}=this.childPos(e,1),r=this.children[n];if(!(r instanceof Rn))return null;for(;r.children.length;){let{i:a,off:l}=r.childPos(i,1);for(;;a++){if(a==r.children.length)return null;if((r=r.children[a]).length)break}i=l}if(!(r instanceof Ds))return null;let s=ci(r.text,i);if(s==i)return null;let o=iu(r.dom,i,s).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let n=[],{from:i,to:r}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==sn.LTR;for(let c=0,u=0;u<this.children.length;u++){let d=this.children[u],f=c+d.length;if(f>r)break;if(c>=i){let p=d.dom.getBoundingClientRect();if(n.push(p.height),o){let m=d.dom.lastChild,g=m?Kp(m):[];if(g.length){let y=g[g.length-1],v=l?y.right-p.left:p.right-y.left;v>a&&(a=v,this.minWidth=s,this.minWidthFrom=c,this.minWidthTo=f)}}}c=f+d.breakAfter}return n}textDirectionAt(e){let{i:n}=this.childPos(e,1);return getComputedStyle(this.children[n].dom).direction=="rtl"?sn.RTL:sn.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Rn){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),n,i,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=Kp(e.firstChild)[0];n=e.getBoundingClientRect().height,i=s?s.width/27:7,r=s?s.height:n,e.remove()}),{lineHeight:n,charWidth:i,textHeight:r}}childCursor(e=this.length){let n=this.children.length;return n&&(e-=this.children[--n].length),new j8(this.children,e,n)}computeBlockGapDeco(){let e=[],n=this.view.viewState;for(let i=0,r=0;;r++){let s=r==n.viewports.length?null:n.viewports[r],o=s?s.from-1:this.length;if(o>i){let a=(n.lineBlockAt(o).bottom-n.lineBlockAt(i).top)/this.view.scaleY;e.push(gt.replace({widget:new hk(a),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return gt.set(e)}updateDeco(){let e=1,n=this.view.state.facet(Yp).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),i=!1,r=this.view.state.facet(l6).map((s,o)=>{let a=typeof s=="function";return a&&(i=!0),a?s(this.view):s});for(r.length&&(this.dynamicDecorationMap[e++]=i,n.push(Bt.join(r))),this.decorations=[this.editContextFormatting,...n,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(s6))try{if(c(this.view,e.range,e))return!0}catch(u){Ar(this.view.state,u,"scroll handler")}let{range:n}=e,i=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1),r;if(!i)return;!n.empty&&(r=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(i={left:Math.min(i.left,r.left),top:Math.min(i.top,r.top),right:Math.max(i.right,r.right),bottom:Math.max(i.bottom,r.bottom)});let s=wE(this.view),o={left:i.left-s.left,top:i.top-s.top,right:i.right+s.right,bottom:i.bottom+s.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;see(this.view.scrollDOM,o,n.head<n.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==sn.LTR)}}function Aee(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}function d6(t,e){let n=t.observer.selectionRange;if(!n.focusNode)return null;let i=L8(n.focusNode,n.focusOffset),r=D8(n.focusNode,n.focusOffset),s=i||r;if(r&&i&&r.node!=i.node){let a=Gt.get(r.node);if(!a||a instanceof Ds&&a.text!=r.node.nodeValue)s=r;else if(t.docView.lastCompositionAfterCursor){let l=Gt.get(i.node);!l||l instanceof Ds&&l.text!=i.node.nodeValue||(s=r)}}if(t.docView.lastCompositionAfterCursor=s!=i,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function Pee(t,e,n){let i=d6(t,n);if(!i)return null;let{node:r,from:s,to:o}=i,a=r.nodeValue;if(/[\n\r]/.test(a)||t.state.doc.sliceString(i.from,i.to)!=a)return null;let l=e.invertedDesc,c=new os(l.mapPos(s),l.mapPos(o),s,o),u=[];for(let d=r.parentNode;;d=d.parentNode){let f=Gt.get(d);if(f instanceof va)u.push({node:d,deco:f.mark});else{if(f instanceof Rn||d.nodeName=="DIV"&&d.parentNode==t.contentDOM)return{range:c,text:r,marks:u,line:d};if(d!=t.contentDOM)u.push({node:d,deco:new Lm({inclusive:!0,attributes:mee(d),tagName:d.tagName.toLowerCase()})});else return null}}}function Nee(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}let Mee=class{constructor(){this.changes=[]}compareRange(e,n){tv(e,n,this.changes)}comparePoint(e,n){tv(e,n,this.changes)}boundChange(e){tv(e,e,this.changes)}};function Ree(t,e,n){let i=new Mee;return Bt.compare(t,e,n,i),i.changes}function Iee(t,e){for(let n=t;n&&n!=e;n=n.assignedSlot||n.parentNode)if(n.nodeType==1&&n.contentEditable=="false")return!0;return!1}function Tee(t,e){let n=!1;return e&&t.iterChangedRanges((i,r)=>{i<e.to&&r>e.from&&(n=!0)}),n}function Oee(t,e,n=1){let i=t.charCategorizer(e),r=t.doc.lineAt(e),s=e-r.from;if(r.length==0)return ue.cursor(e);s==0?n=1:s==r.length&&(n=-1);let o=s,a=s;n<0?o=ci(r.text,s,!1):a=ci(r.text,s);let l=i(r.text.slice(o,a));for(;o>0;){let c=ci(r.text,o,!1);if(i(r.text.slice(c,o))!=l)break;o=c}for(;a<r.length;){let c=ci(r.text,a);if(i(r.text.slice(a,c))!=l)break;a=c}return ue.range(o+r.from,a+r.from)}function Lee(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function Dee(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Jx(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function aI(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function lI(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function yk(t,e,n){let i,r,s,o,a=!1,l,c,u,d;for(let m=t.firstChild;m;m=m.nextSibling){let g=Kp(m);for(let y=0;y<g.length;y++){let v=g[y];r&&Jx(r,v)&&(v=aI(lI(v,r.bottom),r.top));let b=Lee(e,v),w=Dee(n,v);if(b==0&&w==0)return m.nodeType==3?cI(m,e,n):yk(m,e,n);(!i||o>w||o==w&&s>b)&&(i=m,r=v,s=b,o=w,a=b?e<v.left?y>0:y<g.length-1:!0),b==0?n>v.bottom&&(!u||u.bottom<v.bottom)?(l=m,u=v):n<v.top&&(!d||d.top>v.top)&&(c=m,d=v):u&&Jx(u,v)?u=lI(u,v.bottom):d&&Jx(d,v)&&(d=aI(d,v.top))}}if(u&&u.bottom>=n?(i=l,r=u):d&&d.top<=n&&(i=c,r=d),!i)return{node:t,offset:0};let f=Math.max(r.left,Math.min(r.right,e));if(i.nodeType==3)return cI(i,f,n);if(a&&i.contentEditable!="false")return yk(i,f,n);let p=Array.prototype.indexOf.call(t.childNodes,i)+(e>=(r.left+r.right)/2?1:0);return{node:t,offset:p}}function cI(t,e,n){let i=t.nodeValue.length,r=-1,s=1e9,o=0;for(let a=0;a<i;a++){let l=iu(t,a,a+1).getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(u.top==u.bottom)continue;o||(o=e-u.left);let d=(u.top>n?u.top-n:n-u.bottom)-1;if(u.left-1<=e&&u.right+1>=e&&d<s){let f=e>=(u.left+u.right)/2,p=f;if((Ne.chrome||Ne.gecko)&&iu(t,a).getBoundingClientRect().left==u.right&&(p=!f),d<=0)return{node:t,offset:a+(p?1:0)};r=a+(p?1:0),s=d}}}return{node:t,offset:r>-1?r:o>0?t.nodeValue.length:0}}function f6(t,e,n,i=-1){var r,s;let o=t.contentDOM.getBoundingClientRect(),a=o.top+t.viewState.paddingTop,l,{docHeight:c}=t.viewState,{x:u,y:d}=e,f=d-a;if(f<0)return 0;if(f>c)return t.state.doc.length;for(let k=t.viewState.heightOracle.textHeight/2,C=!1;l=t.elementAtHeight(f),l.type!=Di.Text;)for(;f=i>0?l.bottom+k:l.top-k,!(f>=0&&f<=c);){if(C)return n?null:0;C=!0,i=-i}d=a+f;let p=l.from;if(p<t.viewport.from)return t.viewport.from==0?0:n?null:uI(t,o,l,u,d);if(p>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:uI(t,o,l,u,d);let m=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:m,y=g.elementFromPoint(u,d);y&&!t.contentDOM.contains(y)&&(y=null),y||(u=Math.max(o.left+1,Math.min(o.right-1,u)),y=g.elementFromPoint(u,d),y&&!t.contentDOM.contains(y)&&(y=null));let v,b=-1;if(y&&((r=t.docView.nearest(y))===null||r===void 0?void 0:r.isEditable)!=!1){if(m.caretPositionFromPoint){let k=m.caretPositionFromPoint(u,d);k&&({offsetNode:v,offset:b}=k)}else if(m.caretRangeFromPoint){let k=m.caretRangeFromPoint(u,d);k&&({startContainer:v,startOffset:b}=k,(!t.contentDOM.contains(v)||Ne.safari&&jee(v,b,u)||Ne.chrome&&Bee(v,b,u))&&(v=void 0))}v&&(b=Math.min(No(v),b))}if(!v||!t.docView.dom.contains(v)){let k=Rn.find(t.docView,p);if(!k)return f>l.top+l.height/2?l.to:l.from;({node:v,offset:b}=yk(k.dom,u,d))}let w=t.docView.nearest(v);if(!w)return null;if(w.isWidget&&((s=w.dom)===null||s===void 0?void 0:s.nodeType)==1){let k=w.dom.getBoundingClientRect();return e.y<k.top||e.y<=k.bottom&&e.x<=(k.left+k.right)/2?w.posAtStart:w.posAtEnd}else return w.localPosFromDOM(v,b)+w.posAtStart}function uI(t,e,n,i,r){let s=Math.round((i-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&n.height>t.defaultLineHeight*1.5){let a=t.viewState.heightOracle.textHeight,l=Math.floor((r-n.top-(t.defaultLineHeight-a)*.5)/a);s+=l*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(n.from,n.to);return n.from+QQ(o,s,t.state.tabSize)}function jee(t,e,n){let i,r=t;if(t.nodeType!=3||e!=(i=t.nodeValue.length))return!1;for(;;){let s=r.nextSibling;if(s){if(s.nodeName=="BR")break;return!1}else{let o=r.parentNode;if(!o||o.nodeName=="DIV")break;r=o}}return iu(t,i-1,i).getBoundingClientRect().right>n}function Bee(t,e,n){if(e!=0)return!1;for(let r=t;;){let s=r.parentNode;if(!s||s.nodeType!=1||s.firstChild!=r)return!1;if(s.classList.contains("cm-line"))break;r=s}let i=t.nodeType==1?t.getBoundingClientRect():iu(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return n-i.left>5}function bk(t,e,n){let i=t.lineBlockAt(e);if(Array.isArray(i.type)){let r;for(let s of i.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!r||s.type==Di.Text&&(r.type!=s.type||(n<0?s.from<e:s.to>e)))&&(r=s)}}return r||i}return i}function $ee(t,e,n,i){let r=bk(t,e.head,e.assoc||-1),s=!i||r.type!=Di.Text||!(t.lineWrapping||r.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(s){let o=t.dom.getBoundingClientRect(),a=t.textDirectionAt(r.from),l=t.posAtCoords({x:n==(a==sn.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(l!=null)return ue.cursor(l,n?-1:1)}return ue.cursor(n?r.to:r.from,n?-1:1)}function dI(t,e,n,i){let r=t.state.doc.lineAt(e.head),s=t.bidiSpans(r),o=t.textDirectionAt(r.from);for(let a=e,l=null;;){let c=Cee(r,s,o,a,n),u=Y8;if(!c){if(r.number==(n?t.state.doc.lines:1))return a;u=`
`,r=t.state.doc.line(r.number+(n?1:-1)),s=t.bidiSpans(r),c=t.visualLineSide(r,!n)}if(l){if(!l(u))return a}else{if(!i)return c;l=i(u)}a=c}}function Fee(t,e,n){let i=t.state.charCategorizer(e),r=i(n);return s=>{let o=i(s);return r==ui.Space&&(r=o),r==o}}function zee(t,e,n,i){let r=e.head,s=n?1:-1;if(r==(n?t.state.doc.length:0))return ue.cursor(r,e.assoc);let o=e.goalColumn,a,l=t.contentDOM.getBoundingClientRect(),c=t.coordsAtPos(r,e.assoc||-1),u=t.documentTop;if(c)o==null&&(o=c.left-l.left),a=s<0?c.top:c.bottom;else{let p=t.viewState.lineBlockAt(r);o==null&&(o=Math.min(l.right-l.left,t.defaultCharacterWidth*(r-p.from))),a=(s<0?p.top:p.bottom)+u}let d=l.left+o,f=i??t.viewState.heightOracle.textHeight>>1;for(let p=0;;p+=10){let m=a+(f+p)*s,g=f6(t,{x:d,y:m},!1,s);if(m<l.top||m>l.bottom||(s<0?g<r:g>r)){let y=t.docView.coordsForChar(g),v=!y||m<y.top?-1:1;return ue.cursor(g,v,void 0,o)}}}function nv(t,e,n){for(;;){let i=0;for(let r of t)r.between(e-1,e+1,(s,o,a)=>{if(e>s&&e<o){let l=i||n||(e-s<o-e?-1:1);e=l<0?s:o,i=l}});if(!i)return e}}function Zx(t,e,n){let i=nv(t.state.facet(xE).map(r=>r(t)),n.from,e.head>n.from?-1:1);return i==n.from?n:ue.cursor(i,i<n.from?1:-1)}const Ph="￿";class Uee{constructor(e,n){this.points=e,this.text="",this.lineSeparator=n.facet(kt.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Ph}readRange(e,n){if(!e)return this;let i=e.parentNode;for(let r=e;;){this.findPointBefore(i,r);let s=this.text.length;this.readNode(r);let o=r.nextSibling;if(o==n)break;let a=Gt.get(r),l=Gt.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:vy(r))||vy(o)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>s)&&this.lineBreak(),r=o}return this.findPointBefore(i,n),this}readTextNode(e){let n=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,n.length));for(let i=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,a;if(this.lineSeparator?(s=n.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(a=r.exec(n))&&(s=a.index,o=a[0].length),this.append(n.slice(i,s<0?n.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);i=s+o}}readNode(e){if(e.cmIgnore)return;let n=Gt.get(e),i=n&&n.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let r=i.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,n){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==n&&(i.pos=this.text.length)}findPointInside(e,n){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(Vee(e,i.node,i.offset)?n:0))}}function Vee(t,e,n){for(;;){if(!e||n<No(e))return!1;if(e==t)return!0;n=nu(e)+1,e=e.parentNode}}class fI{constructor(e,n){this.node=e,this.offset=n,this.pos=-1}}class Hee{constructor(e,n,i,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=n>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&n>-1)this.newSel=null;else if(n>-1&&(this.bounds=e.docView.domBoundsAround(n,i,0))){let a=s||o?[]:Xee(e),l=new Uee(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=qee(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=s&&s.node==a.focusNode&&s.offset==a.focusOffset||!ak(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),c=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!ak(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),u=e.viewport;if((Ne.ios||Ne.chrome)&&e.state.selection.main.empty&&l!=c&&(u.from>0||u.to<e.state.doc.length)){let d=Math.min(l,c),f=Math.max(l,c),p=u.from-d,m=u.to-f;(p==0||p==1||d==0)&&(m==0||m==-1||f==e.state.doc.length)&&(l=0,c=e.state.doc.length)}this.newSel=ue.single(c,l)}}}function h6(t,e){let n,{newSel:i}=e,r=t.state.selection.main,s=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=r.from,c=null;(s===8||Ne.android&&e.text.length<a-o)&&(l=r.to,c="end");let u=Gee(t.state.doc.sliceString(o,a,Ph),e.text,l-o,c);u&&(Ne.chrome&&s==13&&u.toB==u.from+2&&e.text.slice(u.from,u.toB)==Ph+Ph&&u.toB--,n={from:o+u.from,to:o+u.toA,insert:Nt.of(e.text.slice(u.from,u.toB).split(Ph))})}else i&&(!t.hasFocus&&t.state.facet(ia)||i.main.eq(r))&&(i=null);if(!n&&!i)return!1;if(!n&&e.typeOver&&!r.empty&&i&&i.main.empty?n={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,r.to)}:(Ne.mac||Ne.android)&&n&&n.from==n.to&&n.from==r.head-1&&/^\. ?$/.test(n.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(i&&n.insert.length==2&&(i=ue.single(i.main.anchor-1,i.main.head-1)),n={from:n.from,to:n.to,insert:Nt.of([n.insert.toString().replace("."," ")])}):n&&n.from>=r.from&&n.to<=r.to&&(n.from!=r.from||n.to!=r.to)&&r.to-r.from-(n.to-n.from)<=4?n={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,n.from).append(n.insert).append(t.state.doc.slice(n.to,r.to))}:Ne.chrome&&n&&n.from==n.to&&n.from==r.head&&n.insert.toString()==`
 `&&t.lineWrapping&&(i&&(i=ue.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:Nt.of([" "])}),n)return SE(t,n,i,s);if(i&&!i.main.eq(r)){let o=!1,a="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(o=!0),a=t.inputState.lastSelectionOrigin),t.dispatch({selection:i,scrollIntoView:o,userEvent:a}),!0}else return!1}function SE(t,e,n,i=-1){if(Ne.ios&&t.inputState.flushIOSKey(e))return!0;let r=t.state.selection.main;if(Ne.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&t.state.sliceDoc(e.from,r.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&kd(t.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>r.head)&&kd(t.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&e.insert.length==0&&kd(t.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let o,a=()=>o||(o=Wee(t,e,n));return t.state.facet(t6).some(l=>l(t,e.from,e.to,s,a))||t.dispatch(a()),!0}function Wee(t,e,n){let i,r=t.state,s=r.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!n||n.main.empty&&n.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let a=s.from<e.from?r.sliceDoc(s.from,e.from):"",l=s.to>e.to?r.sliceDoc(e.to,s.to):"";i=r.replaceSelection(t.state.toText(a+e.insert.sliceString(0,void 0,t.state.lineBreak)+l))}else{let a=r.changes(e),l=n&&n.main.to<=a.newLength?n.main:void 0;if(r.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let c=t.state.sliceDoc(e.from,e.to),u,d=n&&d6(t,n.main.head);if(d){let m=e.insert.length-(e.to-e.from);u={from:d.from,to:d.to-m}}else u=t.state.doc.lineAt(s.head);let f=s.to-e.to,p=s.to-s.from;i=r.changeByRange(m=>{if(m.from==s.from&&m.to==s.to)return{changes:a,range:l||m.map(a)};let g=m.to-f,y=g-c.length;if(m.to-m.from!=p||t.state.sliceDoc(y,g)!=c||m.to>=u.from&&m.from<=u.to)return{range:m};let v=r.changes({from:y,to:g,insert:e.insert}),b=m.to-s.to;return{changes:v,range:l?ue.range(Math.max(0,l.anchor+b),Math.max(0,l.head+b)):m.map(v)}})}else i={changes:a,selection:l&&r.selection.replaceRange(l)}}let o="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,o+=".compose",t.inputState.compositionFirstChange&&(o+=".start",t.inputState.compositionFirstChange=!1)),r.update(i,{userEvent:o,scrollIntoView:!0})}function Gee(t,e,n,i){let r=Math.min(t.length,e.length),s=0;for(;s<r&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&t.length==e.length)return null;let o=t.length,a=e.length;for(;o>0&&a>0&&t.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(i=="end"){let l=Math.max(0,s-Math.min(o,a));n-=o+l-s}if(o<s&&t.length<e.length){let l=n<=s&&n>=o?s-n:0;s-=l,a=s+(a-o),o=s}else if(a<s){let l=n<=s&&n>=a?s-n:0;s-=l,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}function Xee(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}=t.observer.selectionRange;return n&&(e.push(new fI(n,i)),(r!=n||s!=i)&&e.push(new fI(r,s))),e}function qee(t,e){if(t.length==0)return null;let n=t[0].pos,i=t.length==2?t[1].pos:n;return n>-1&&i>-1?ue.single(n+e,i+e):null}class Kee{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Ne.safari&&e.contentDOM.addEventListener("input",()=>null),Ne.gecko&&dte(e.contentDOM.ownerDocument)}handleEvent(e){!ite(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,n){let i=this.handlers[e];if(i){for(let r of i.observers)r(this.view,n);for(let r of i.handlers){if(n.defaultPrevented)break;if(r(this.view,n)){n.preventDefault();break}}}}ensureHandlers(e){let n=Yee(e),i=this.handlers,r=this.view.contentDOM;for(let s in n)if(s!="scroll"){let o=!n[s].handlers.length,a=i[s];a&&o!=!a.handlers.length&&(r.removeEventListener(s,this.handleEvent),a=null),a||r.addEventListener(s,this.handleEvent,{passive:o})}for(let s in i)s!="scroll"&&!n[s]&&r.removeEventListener(s,this.handleEvent);this.handlers=n}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&m6.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Ne.android&&Ne.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let n;return Ne.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((n=p6.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||Jee.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=n||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let n=this.pendingIOSKey;return!n||n.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,kd(this.view.contentDOM,n.key,n.keyCode,n instanceof KeyboardEvent?n:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Ne.safari&&!Ne.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function hI(t,e){return(n,i)=>{try{return e.call(t,i,n)}catch(r){Ar(n.state,r)}}}function Yee(t){let e=Object.create(null);function n(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of t){let r=i.spec,s=r&&r.plugin.domEventHandlers,o=r&&r.plugin.domEventObservers;if(s)for(let a in s){let l=s[a];l&&n(a).handlers.push(hI(i.value,l))}if(o)for(let a in o){let l=o[a];l&&n(a).observers.push(hI(i.value,l))}}for(let i in js)n(i).handlers.push(js[i]);for(let i in fs)n(i).observers.push(fs[i]);return e}const p6=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Jee="dthko",m6=[16,17,18,20,91,92,224,225],$g=6;function Fg(t){return Math.max(0,t)*.7+8}function Zee(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}class Qee{constructor(e,n,i,r){this.view=e,this.startEvent=n,this.style=i,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=n,this.scrollParents=oee(e.contentDOM),this.atoms=e.state.facet(xE).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=n.shiftKey,this.multiple=e.state.facet(kt.allowMultipleSelections)&&ete(e,n),this.dragging=nte(e,n)&&y6(n)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Zee(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,i=0,r=0,s=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=wE(this.view);e.clientX-l.left<=r+$g?n=-Fg(r-e.clientX):e.clientX+l.right>=o-$g&&(n=Fg(e.clientX-o)),e.clientY-l.top<=s+$g?i=-Fg(s-e.clientY):e.clientY+l.bottom>=a-$g&&(i=Fg(e.clientY-a)),this.setScrollSpeed(n,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,n){this.scrollSpeed={x:e,y:n},e||n?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:n}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),n&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=n,n=0),(e||n)&&this.view.win.scrollBy(e,n),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let n=null;for(let i=0;i<e.ranges.length;i++){let r=e.ranges[i],s=null;if(r.empty){let o=nv(this.atoms,r.from,0);o!=r.from&&(s=ue.cursor(o,-1))}else{let o=nv(this.atoms,r.from,-1),a=nv(this.atoms,r.to,1);(o!=r.from||a!=r.to)&&(s=ue.range(r.from==r.anchor?o:a,r.from==r.head?o:a))}s&&(n||(n=e.ranges.slice()),n[i]=s)}return n?ue.create(n,e.mainIndex):e}select(e){let{view:n}=this,i=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(n.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(n=>n.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function ete(t,e){let n=t.state.facet(J8);return n.length?n[0](e):Ne.mac?e.metaKey:e.ctrlKey}function tte(t,e){let n=t.state.facet(Z8);return n.length?n[0](e):Ne.mac?!e.altKey:!e.ctrlKey}function nte(t,e){let{main:n}=t.state.selection;if(n.empty)return!1;let i=qp(t.root);if(!i||i.rangeCount==0)return!0;let r=i.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function ite(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target,i;n!=t.contentDOM;n=n.parentNode)if(!n||n.nodeType==11||(i=Gt.get(n))&&i.ignoreEvent(e))return!1;return!0}const js=Object.create(null),fs=Object.create(null),g6=Ne.ie&&Ne.ie_version<15||Ne.ios&&Ne.webkit_version<604;function rte(t){let e=t.dom.parentNode;if(!e)return;let n=e.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{t.focus(),n.remove(),v6(t,n.value)},50)}function Xb(t,e,n){for(let i of t.facet(e))n=i(n,t);return n}function v6(t,e){e=Xb(t.state,vE,e);let{state:n}=t,i,r=1,s=n.toText(e),o=s.lines==n.selection.ranges.length;if(xk!=null&&n.selection.ranges.every(l=>l.empty)&&xk==s.toString()){let l=-1;i=n.changeByRange(c=>{let u=n.doc.lineAt(c.from);if(u.from==l)return{range:c};l=u.from;let d=n.toText((o?s.line(r++).text:e)+n.lineBreak);return{changes:{from:u.from,insert:d},range:ue.cursor(c.from+d.length)}})}else o?i=n.changeByRange(l=>{let c=s.line(r++);return{changes:{from:l.from,to:l.to,insert:c.text},range:ue.cursor(l.from+c.length)}}):i=n.replaceSelection(s);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}fs.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft};js.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),e.keyCode==27&&t.inputState.tabFocusMode!=0&&(t.inputState.tabFocusMode=Date.now()+2e3),!1);fs.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};fs.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};js.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let i of t.state.facet(Q8))if(n=i(t,e),n)break;if(!n&&e.button==0&&(n=ate(t,e)),n){let i=!t.hasFocus;t.inputState.startMouseSelection(new Qee(t,e,n,i)),i&&t.observer.ignore(()=>{I8(t.contentDOM);let s=t.root.activeElement;s&&!s.contains(t.contentDOM)&&s.blur()});let r=t.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function pI(t,e,n,i){if(i==1)return ue.cursor(e,n);if(i==2)return Oee(t.state,e,n);{let r=Rn.find(t.docView,e),s=t.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,a=r?r.posAtEnd:s.to;return a<t.state.doc.length&&a==s.to&&a++,ue.range(o,a)}}let mI=(t,e,n)=>e>=n.top&&e<=n.bottom&&t>=n.left&&t<=n.right;function ste(t,e,n,i){let r=Rn.find(t.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&mI(n,i,o))return-1;let a=r.coordsAt(s,1);return a&&mI(n,i,a)?1:o&&o.bottom>=i?-1:1}function gI(t,e){let n=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:n,bias:ste(t,n,e.clientX,e.clientY)}}const ote=Ne.ie&&Ne.ie_version<=11;let vI=null,yI=0,bI=0;function y6(t){if(!ote)return t.detail;let e=vI,n=bI;return vI=t,bI=Date.now(),yI=!e||n>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(yI+1)%3:1}function ate(t,e){let n=gI(t,e),i=y6(e),r=t.state.selection;return{update(s){s.docChanged&&(n.pos=s.changes.mapPos(n.pos),r=r.map(s.changes))},get(s,o,a){let l=gI(t,s),c,u=pI(t,l.pos,l.bias,i);if(n.pos!=l.pos&&!o){let d=pI(t,n.pos,n.bias,i),f=Math.min(d.from,u.from),p=Math.max(d.to,u.to);u=f<u.from?ue.range(f,p):ue.range(p,f)}return o?r.replaceRange(r.main.extend(u.from,u.to)):a&&i==1&&r.ranges.length>1&&(c=lte(r,l.pos))?c:a?r.addRange(u):ue.create([u])}}}function lte(t,e){for(let n=0;n<t.ranges.length;n++){let{from:i,to:r}=t.ranges[n];if(i<=e&&r>=e)return ue.create(t.ranges.slice(0,n).concat(t.ranges.slice(n+1)),t.mainIndex==n?0:t.mainIndex-(t.mainIndex>n?1:0))}return null}js.dragstart=(t,e)=>{let{selection:{main:n}}=t.state;if(e.target.draggable){let r=t.docView.nearest(e.target);if(r&&r.isWidget){let s=r.posAtStart,o=s+r.length;(s>=n.to||o<=n.from)&&(n=ue.range(s,o))}}let{inputState:i}=t;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=n,e.dataTransfer&&(e.dataTransfer.setData("Text",Xb(t.state,yE,t.state.sliceDoc(n.from,n.to))),e.dataTransfer.effectAllowed="copyMove"),!1};js.dragend=t=>(t.inputState.draggedContent=null,!1);function xI(t,e,n,i){if(n=Xb(t.state,vE,n),!n)return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=t.inputState,o=i&&s&&tte(t,e)?{from:s.from,to:s.to}:null,a={from:r,insert:n},l=t.state.changes(o?[o,a]:a);t.focus(),t.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"}),t.inputState.draggedContent=null}js.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let n=e.dataTransfer.files;if(n&&n.length){let i=Array(n.length),r=0,s=()=>{++r==n.length&&xI(t,e,i.filter(o=>o!=null).join(t.state.lineBreak),!1)};for(let o=0;o<n.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(i[o]=a.result),s()},a.readAsText(n[o])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return xI(t,e,i,!0),!0}return!1};js.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let n=g6?null:e.clipboardData;return n?(v6(t,n.getData("text/plain")||n.getData("text/uri-list")),!0):(rte(t),!1)};function cte(t,e){let n=t.dom.parentNode;if(!n)return;let i=n.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),t.focus()},50)}function ute(t){let e=[],n=[],i=!1;for(let r of t.selection.ranges)r.empty||(e.push(t.sliceDoc(r.from,r.to)),n.push(r));if(!e.length){let r=-1;for(let{from:s}of t.selection.ranges){let o=t.doc.lineAt(s);o.number>r&&(e.push(o.text),n.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),r=o.number}i=!0}return{text:Xb(t,yE,e.join(t.lineBreak)),ranges:n,linewise:i}}let xk=null;js.copy=js.cut=(t,e)=>{let{text:n,ranges:i,linewise:r}=ute(t.state);if(!n&&!r)return!1;xk=r?n:null,e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let s=g6?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",n),!0):(cte(t,n),!1)};const b6=Ca.define();function x6(t,e){let n=[];for(let i of t.facet(n6)){let r=i(t,e);r&&n.push(r)}return n.length?t.update({effects:n,annotations:b6.of(!0)}):null}function w6(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let n=x6(t.state,e);n?t.dispatch(n):t.update([])}},10)}fs.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),w6(t)};fs.blur=t=>{t.observer.clearSelectionRange(),w6(t)};fs.compositionstart=fs.compositionupdate=t=>{t.observer.editContext||(t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))};fs.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,Ne.chrome&&Ne.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))};fs.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};js.beforeinput=(t,e)=>{var n,i;if(e.inputType=="insertReplacementText"&&t.observer.editContext){let s=(n=e.dataTransfer)===null||n===void 0?void 0:n.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let a=o[0],l=t.posAtDOM(a.startContainer,a.startOffset),c=t.posAtDOM(a.endContainer,a.endOffset);return SE(t,{from:l,to:c,insert:t.state.toText(s)},null),!0}}let r;if(Ne.chrome&&Ne.android&&(r=p6.find(s=>s.inputType==e.inputType))&&(t.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let s=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return Ne.ios&&e.inputType=="deleteContentForward"&&t.observer.flushSoon(),Ne.safari&&e.inputType=="insertText"&&t.inputState.composing>=0&&setTimeout(()=>fs.compositionend(t,e),20),!1};const wI=new Set;function dte(t){wI.has(t)||(wI.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}const SI=["pre-wrap","normal","pre-line","break-spaces"];let df=!1;function kI(){df=!1}class fte{constructor(e){this.lineWrapping=e,this.doc=Nt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,n){let i=this.doc.lineAt(n).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((n-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return SI.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let n=!1;for(let i=0;i<e.length;i++){let r=e[i];r<0?i++:this.heightSamples[Math.floor(r*10)]||(n=!0,this.heightSamples[Math.floor(r*10)]=!0)}return n}refresh(e,n,i,r,s,o){let a=SI.indexOf(e)>-1,l=Math.round(n)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=n,this.charWidth=i,this.textHeight=r,this.lineLength=s,l){this.heightSamples={};for(let c=0;c<o.length;c++){let u=o[c];u<0?c++:this.heightSamples[Math.floor(u*10)]=!0}}return l}}class hte{constructor(e,n){this.from=e,this.heights=n,this.index=0}get more(){return this.index<this.heights.length}}class co{constructor(e,n,i,r,s){this.from=e,this.length=n,this.top=i,this.height=r,this._content=s}get type(){return typeof this._content=="number"?Di.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof zl?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let n=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new co(this.from,this.length+e.length,this.top,this.height+e.height,n)}}var Qt=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(Qt||(Qt={}));const iv=.001;class ji{constructor(e,n,i=2){this.length=e,this.height=n,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>iv&&(df=!0),this.height=e)}replace(e,n,i){return ji.of(i)}decomposeLeft(e,n){n.push(this)}decomposeRight(e,n){n.push(this)}applyChanges(e,n,i,r){let s=this,o=i.doc;for(let a=r.length-1;a>=0;a--){let{fromA:l,toA:c,fromB:u,toB:d}=r[a],f=s.lineAt(l,Qt.ByPosNoHeight,i.setDoc(n),0,0),p=f.to>=c?f:s.lineAt(c,Qt.ByPosNoHeight,i,0,0);for(d+=p.to-c,c=p.to;a>0&&f.from<=r[a-1].toA;)l=r[a-1].fromA,u=r[a-1].fromB,a--,l<f.from&&(f=s.lineAt(l,Qt.ByPosNoHeight,i,0,0));u+=f.from-l,l=f.from;let m=kE.build(i.setDoc(o),e,u,d);s=xy(s,s.replace(l,c,m))}return s.updateHeight(i,0)}static empty(){return new wr(0,0)}static of(e){if(e.length==1)return e[0];let n=0,i=e.length,r=0,s=0;for(;;)if(n==i)if(r>s*2){let a=e[n-1];a.break?e.splice(--n,1,a.left,null,a.right):e.splice(--n,1,a.left,a.right),i+=1+a.break,r-=a.size}else if(s>r*2){let a=e[i];a.break?e.splice(i,1,a.left,null,a.right):e.splice(i,1,a.left,a.right),i+=2+a.break,s-=a.size}else break;else if(r<s){let a=e[n++];a&&(r+=a.size)}else{let a=e[--i];a&&(s+=a.size)}let o=0;return e[n-1]==null?(o=1,n--):e[n]==null&&(o=1,i++),new pte(ji.of(e.slice(0,n)),o,ji.of(e.slice(i)))}}function xy(t,e){return t==e?t:(t.constructor!=e.constructor&&(df=!0),e)}ji.prototype.size=1;class S6 extends ji{constructor(e,n,i){super(e,n),this.deco=i}blockAt(e,n,i,r){return new co(r,this.length,i,this.height,this.deco||0)}lineAt(e,n,i,r,s){return this.blockAt(0,i,r,s)}forEachLine(e,n,i,r,s,o){e<=s+this.length&&n>=s&&o(this.blockAt(0,i,r,s))}updateHeight(e,n=0,i=!1,r){return r&&r.from<=n&&r.more&&this.setHeight(r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class wr extends S6{constructor(e,n){super(e,n,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,n,i,r){return new co(r,this.length,i,this.height,this.breaks)}replace(e,n,i){let r=i[0];return i.length==1&&(r instanceof wr||r instanceof ni&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof ni?r=new wr(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):ji.of(i)}updateHeight(e,n=0,i=!1,r){return r&&r.from<=n&&r.more?this.setHeight(r.heights[r.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class ni extends ji{constructor(e){super(e,0)}heightMetrics(e,n){let i=e.doc.lineAt(n).number,r=e.doc.lineAt(n+this.length).number,s=r-i+1,o,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);o=l/s,this.length>s+1&&(a=(this.height-l)/(this.length-s-1))}else o=this.height/s;return{firstLine:i,lastLine:r,perLine:o,perChar:a}}blockAt(e,n,i,r){let{firstLine:s,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(n,r);if(n.lineWrapping){let c=r+(e<n.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),u=n.doc.lineAt(c),d=a+u.length*l,f=Math.max(i,e-d/2);return new co(u.from,u.length,f,d,0)}else{let c=Math.max(0,Math.min(o-s,Math.floor((e-i)/a))),{from:u,length:d}=n.doc.line(s+c);return new co(u,d,i+a*c,a,0)}}lineAt(e,n,i,r,s){if(n==Qt.ByHeight)return this.blockAt(e,i,r,s);if(n==Qt.ByPosNoHeight){let{from:p,to:m}=i.doc.lineAt(e);return new co(p,m-p,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(i,s),c=i.doc.lineAt(e),u=a+c.length*l,d=c.number-o,f=r+a*d+l*(c.from-s-d);return new co(c.from,c.length,Math.max(r,Math.min(f,r+this.height-u)),u,0)}forEachLine(e,n,i,r,s,o){e=Math.max(e,s),n=Math.min(n,s+this.length);let{firstLine:a,perLine:l,perChar:c}=this.heightMetrics(i,s);for(let u=e,d=r;u<=n;){let f=i.doc.lineAt(u);if(u==e){let m=f.number-a;d+=l*m+c*(e-s-m)}let p=l+c*f.length;o(new co(f.from,f.length,d,p,0)),d+=p,u=f.to+1}}replace(e,n,i){let r=this.length-n;if(r>0){let s=i[i.length-1];s instanceof ni?i[i.length-1]=new ni(s.length+r):i.push(null,new ni(r-1))}if(e>0){let s=i[0];s instanceof ni?i[0]=new ni(e+s.length):i.unshift(new ni(e-1),null)}return ji.of(i)}decomposeLeft(e,n){n.push(new ni(e-1),null)}decomposeRight(e,n){n.push(null,new ni(this.length-e-1))}updateHeight(e,n=0,i=!1,r){let s=n+this.length;if(r&&r.from<=n+this.length&&r.more){let o=[],a=Math.max(n,r.from),l=-1;for(r.from>n&&o.push(new ni(r.from-n-1).updateHeight(e,n));a<=s&&r.more;){let u=e.doc.lineAt(a).length;o.length&&o.push(null);let d=r.heights[r.index++];l==-1?l=d:Math.abs(d-l)>=iv&&(l=-2);let f=new wr(u,d);f.outdated=!1,o.push(f),a+=u+1}a<=s&&o.push(null,new ni(s-a).updateHeight(e,a));let c=ji.of(o);return(l<0||Math.abs(c.height-this.height)>=iv||Math.abs(l-this.heightMetrics(e,n).perLine)>=iv)&&(df=!0),xy(this,c)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(n,n+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class pte extends ji{constructor(e,n,i){super(e.length+n+i.length,e.height+i.height,n|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,n,i,r){let s=i+this.left.height;return e<s?this.left.blockAt(e,n,i,r):this.right.blockAt(e,n,s,r+this.left.length+this.break)}lineAt(e,n,i,r,s){let o=r+this.left.height,a=s+this.left.length+this.break,l=n==Qt.ByHeight?e<o:e<a,c=l?this.left.lineAt(e,n,i,r,s):this.right.lineAt(e,n,i,o,a);if(this.break||(l?c.to<a:c.from>a))return c;let u=n==Qt.ByPosNoHeight?Qt.ByPosNoHeight:Qt.ByPos;return l?c.join(this.right.lineAt(a,u,i,o,a)):this.left.lineAt(a,u,i,r,s).join(c)}forEachLine(e,n,i,r,s,o){let a=r+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,n,i,r,s,o),n>=l&&this.right.forEachLine(e,n,i,a,l,o);else{let c=this.lineAt(l,Qt.ByPos,i,r,s);e<c.from&&this.left.forEachLine(e,c.from-1,i,r,s,o),c.to>=e&&c.from<=n&&o(c),n>c.to&&this.right.forEachLine(c.to+1,n,i,a,l,o)}}replace(e,n,i){let r=this.left.length+this.break;if(n<r)return this.balanced(this.left.replace(e,n,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,n-r,i));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of i)s.push(a);if(e>0&&CI(s,o-1),n<this.length){let a=s.length;this.decomposeRight(n,s),CI(s,a)}return ji.of(s)}decomposeLeft(e,n){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,n);n.push(this.left),this.break&&(i++,e>=i&&n.push(null)),e>i&&this.right.decomposeLeft(e-i,n)}decomposeRight(e,n){let i=this.left.length,r=i+this.break;if(e>=r)return this.right.decomposeRight(e-r,n);e<i&&this.left.decomposeRight(e,n),this.break&&e<r&&n.push(null),n.push(this.right)}balanced(e,n){return e.size>2*n.size||n.size>2*e.size?ji.of(this.break?[e,null,n]:[e,n]):(this.left=xy(this.left,e),this.right=xy(this.right,n),this.setHeight(e.height+n.height),this.outdated=e.outdated||n.outdated,this.size=e.size+n.size,this.length=e.length+this.break+n.length,this)}updateHeight(e,n=0,i=!1,r){let{left:s,right:o}=this,a=n+s.length+this.break,l=null;return r&&r.from<=n+s.length&&r.more?l=s=s.updateHeight(e,n,i,r):s.updateHeight(e,n,i),r&&r.from<=a+o.length&&r.more?l=o=o.updateHeight(e,a,i,r):o.updateHeight(e,a,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function CI(t,e){let n,i;t[e]==null&&(n=t[e-1])instanceof ni&&(i=t[e+1])instanceof ni&&t.splice(e-1,3,new ni(n.length+1+i.length))}const mte=5;class kE{constructor(e,n){this.pos=e,this.oracle=n,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,n){if(this.lineStart>-1){let i=Math.min(n,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof wr?r.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new wr(i-this.pos,-1)),this.writtenTo=i,n>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=n}point(e,n,i){if(e<n||i.heightRelevant){let r=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let o=n-e;i.block?this.addBlock(new S6(o,r,i)):(o||s||r>=mte)&&this.addLineDeco(r,s,o)}else n>e&&this.span(e,n);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:n}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=n,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new wr(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,n){let i=new ni(n-e);return this.oracle.doc.lineAt(e).to==n&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof wr)return e;let n=new wr(0,-1);return this.nodes.push(n),n}addBlock(e){this.enterLine();let n=e.deco;n&&n.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,n&&n.endSide>0&&(this.covering=e)}addLineDeco(e,n,i){let r=this.ensureLine();r.length+=i,r.collapsed+=i,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=n,this.writtenTo=this.pos=this.pos+i}finish(e){let n=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(n instanceof wr)&&!this.isCovered?this.nodes.push(new wr(0,-1)):(this.writtenTo<this.pos||n==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let r of this.nodes)r instanceof wr&&r.updateHeight(this.oracle,i),i+=r?r.length:1;return this.nodes}static build(e,n,i,r){let s=new kE(i,e);return Bt.spans(n,i,r,s,0),s.finish(i)}}function gte(t,e,n){let i=new vte;return Bt.compare(t,e,n,i,0),i.changes}class vte{constructor(){this.changes=[]}compareRange(){}comparePoint(e,n,i,r){(e<n||i&&i.heightRelevant||r&&r.heightRelevant)&&tv(e,n,this.changes,5)}}function yte(t,e){let n=t.getBoundingClientRect(),i=t.ownerDocument,r=i.defaultView||window,s=Math.max(0,n.left),o=Math.min(r.innerWidth,n.right),a=Math.max(0,n.top),l=Math.min(r.innerHeight,n.bottom);for(let c=t.parentNode;c&&c!=i.body;)if(c.nodeType==1){let u=c,d=window.getComputedStyle(u);if((u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&d.overflow!="visible"){let f=u.getBoundingClientRect();s=Math.max(s,f.left),o=Math.min(o,f.right),a=Math.max(a,f.top),l=Math.min(c==t.parentNode?r.innerHeight:l,f.bottom)}c=d.position=="absolute"||d.position=="fixed"?u.offsetParent:u.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:s-n.left,right:Math.max(s,o)-n.left,top:a-(n.top+e),bottom:Math.max(a,l)-(n.top+e)}}function bte(t){let e=t.getBoundingClientRect(),n=t.ownerDocument.defaultView||window;return e.left<n.innerWidth&&e.right>0&&e.top<n.innerHeight&&e.bottom>0}function xte(t,e){let n=t.getBoundingClientRect();return{left:0,right:n.right-n.left,top:e,bottom:n.bottom-(n.top+e)}}class Qx{constructor(e,n,i,r){this.from=e,this.to=n,this.size=i,this.displaySize=r}static same(e,n){if(e.length!=n.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=n[i];if(r.from!=s.from||r.to!=s.to||r.size!=s.size)return!1}return!0}draw(e,n){return gt.replace({widget:new wte(this.displaySize*(n?e.scaleY:e.scaleX),n)}).range(this.from,this.to)}}class wte extends Ql{constructor(e,n){super(),this.size=e,this.vertical=n}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class _I{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=EI,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=sn.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let n=e.facet(bE).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new fte(n),this.stateDeco=e.facet(Yp).filter(i=>typeof i!="function"),this.heightMap=ji.empty().applyChanges(this.stateDeco,Nt.empty,this.heightOracle.setDoc(e.doc),[new os(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=gt.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:n}=this.state.selection;for(let i=0;i<=1;i++){let r=i?n.head:n.anchor;if(!e.some(({from:s,to:o})=>r>=s&&r<=o)){let{from:s,to:o}=this.lineBlockAt(r);e.push(new zg(s,o))}}return this.viewports=e.sort((i,r)=>i.from-r.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?EI:new CE(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Nh(e,this.scaler))})}update(e,n=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Yp).filter(u=>typeof u!="function");let r=e.changedRanges,s=os.extendWithRanges(r,gte(i,this.stateDeco,e?e.changes:Bn.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);kI(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||df)&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(n&&(n.range.head<l.from||n.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,n));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),n&&(this.scrollTarget=n),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(r6)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let n=e.contentDOM,i=window.getComputedStyle(n),r=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?sn.RTL:sn.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),a=n.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let c=0,u=0;if(a.width&&a.height){let{scaleX:k,scaleY:C}=R8(n,a);(k>.005&&Math.abs(this.scaleX-k)>.005||C>.005&&Math.abs(this.scaleY-C)>.005)&&(this.scaleX=k,this.scaleY=C,c|=16,o=l=!0)}let d=(parseInt(i.paddingTop)||0)*this.scaleY,f=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=d||this.paddingBottom!=f)&&(this.paddingTop=d,this.paddingBottom=f,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let p=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=p&&(this.scrollAnchorHeight=-1,this.scrollTop=p),this.scrolledToBottom=O8(e.scrollDOM);let m=(this.printing?xte:yte)(n,this.paddingTop),g=m.top-this.pixelViewport.top,y=m.bottom-this.pixelViewport.bottom;this.pixelViewport=m;let v=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(v!=this.inView&&(this.inView=v,v&&(l=!0)),!this.inView&&!this.scrollTarget&&!bte(e.dom))return 0;let b=a.width;if((this.contentDOMWidth!=b||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),l){let k=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(k)&&(o=!0),o||r.lineWrapping&&Math.abs(b-this.contentDOMWidth)>r.charWidth){let{lineHeight:C,charWidth:E,textHeight:_}=e.docView.measureTextSize();o=C>0&&r.refresh(s,C,E,_,b/E,k),o&&(e.docView.minWidth=0,c|=16)}g>0&&y>0?u=Math.max(g,y):g<0&&y<0&&(u=Math.min(g,y)),kI();for(let C of this.viewports){let E=C.from==this.viewport.from?k:e.docView.measureVisibleLineHeights(C);this.heightMap=(o?ji.empty().applyChanges(this.stateDeco,Nt.empty,this.heightOracle,[new os(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,o,new hte(C.from,E))}df&&(c|=2)}let w=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return w&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(u,this.scrollTarget),c|=this.updateForViewport()),(c&2||w)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,n){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new zg(r.lineAt(o-i*1e3,Qt.ByHeight,s,0,0).from,r.lineAt(a+(1-i)*1e3,Qt.ByHeight,s,0,0).to);if(n){let{head:c}=n.range;if(c<l.from||c>l.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),d=r.lineAt(c,Qt.ByPos,s,0,0),f;n.y=="center"?f=(d.top+d.bottom)/2-u/2:n.y=="start"||n.y=="nearest"&&c<l.from?f=d.top:f=d.bottom-u,l=new zg(r.lineAt(f-1e3/2,Qt.ByHeight,s,0,0).from,r.lineAt(f+u+1e3/2,Qt.ByHeight,s,0,0).to)}}return l}mapViewport(e,n){let i=n.mapPos(e.from,-1),r=n.mapPos(e.to,1);return new zg(this.heightMap.lineAt(i,Qt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,Qt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:n},i=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,Qt.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(n,Qt.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||r<=o-Math.max(10,Math.min(-i,250)))&&(n==this.state.doc.length||s>=a+Math.max(10,Math.min(i,250)))&&r>o-2*1e3&&s<a+2*1e3}mapLineGaps(e,n){if(!e.length||n.empty)return e;let i=[];for(let r of e)n.touchesRange(r.from,r.to)||i.push(new Qx(n.mapPos(r.from),n.mapPos(r.to),r.size,r.displaySize));return i}ensureLineGaps(e,n){let i=this.heightOracle.lineWrapping,r=i?1e4:2e3,s=r>>1,o=r<<1;if(this.defaultTextDirection!=sn.LTR&&!i)return[];let a=[],l=(u,d,f,p)=>{if(d-u<s)return;let m=this.state.selection.main,g=[m.from];m.empty||g.push(m.to);for(let v of g)if(v>u&&v<d){l(u,v-10,f,p),l(v+10,d,f,p);return}let y=kte(e,v=>v.from>=f.from&&v.to<=f.to&&Math.abs(v.from-u)<s&&Math.abs(v.to-d)<s&&!g.some(b=>v.from<b&&v.to>b));if(!y){if(d<f.to&&n&&i&&n.visibleRanges.some(w=>w.from<=d&&w.to>=d)){let w=n.moveToLineBoundary(ue.cursor(d),!1,!0).head;w>u&&(d=w)}let v=this.gapSize(f,u,d,p),b=i||v<2e6?v:2e6;y=new Qx(u,d,v,b)}a.push(y)},c=u=>{if(u.length<o||u.type!=Di.Text)return;let d=Ste(u.from,u.to,this.stateDeco);if(d.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,p,m;if(i){let g=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,y,v;if(f!=null){let b=Vg(d,f),w=((this.visibleBottom-this.visibleTop)/2+g)/u.height;y=b-w,v=b+w}else y=(this.visibleTop-u.top-g)/u.height,v=(this.visibleBottom-u.top+g)/u.height;p=Ug(d,y),m=Ug(d,v)}else{let g=d.total*this.heightOracle.charWidth,y=r*this.heightOracle.charWidth,v=0;if(g>2e6)for(let E of e)E.from>=u.from&&E.from<u.to&&E.size!=E.displaySize&&E.from*this.heightOracle.charWidth+v<this.pixelViewport.left&&(v=E.size-E.displaySize);let b=this.pixelViewport.left+v,w=this.pixelViewport.right+v,k,C;if(f!=null){let E=Vg(d,f),_=((w-b)/2+y)/g;k=E-_,C=E+_}else k=(b-y)/g,C=(w+y)/g;p=Ug(d,k),m=Ug(d,C)}p>u.from&&l(u.from,p,u,d),m<u.to&&l(m,u.to,u,d)};for(let u of this.viewportLines)Array.isArray(u.type)?u.type.forEach(c):c(u);return a}gapSize(e,n,i,r){let s=Vg(r,i)-Vg(r,n);return this.heightOracle.lineWrapping?e.height*s:r.total*this.heightOracle.charWidth*s}updateLineGaps(e){Qx.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=gt.set(e.map(n=>n.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let n=this.stateDeco;this.lineGaps.length&&(n=n.concat(this.lineGapDeco));let i=[];Bt.spans(n,this.viewport.from,this.viewport.to,{span(s,o){i.push({from:s,to:o})},point(){}},20);let r=0;if(i.length!=this.visibleRanges.length)r=12;else for(let s=0;s<i.length&&!(r&8);s++){let o=this.visibleRanges[s],a=i[s];(o.from!=a.from||o.to!=a.to)&&(r|=4,e&&e.mapPos(o.from,-1)==a.from&&e.mapPos(o.to,1)==a.to||(r|=8))}return this.visibleRanges=i,r}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(n=>n.from<=e&&n.to>=e)||Nh(this.heightMap.lineAt(e,Qt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(n=>n.top<=e&&n.bottom>=e)||Nh(this.heightMap.lineAt(this.scaler.fromDOM(e),Qt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let n=this.lineBlockAtHeight(e+8);return n.from>=this.viewport.from||this.viewportLines[0].top-e>200?n:this.viewportLines[0]}elementAtHeight(e){return Nh(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}let zg=class{constructor(e,n){this.from=e,this.to=n}};function Ste(t,e,n){let i=[],r=t,s=0;return Bt.spans(n,t,e,{span(){},point(o,a){o>r&&(i.push({from:r,to:o}),s+=o-r),r=a}},20),r<e&&(i.push({from:r,to:e}),s+=e-r),{total:s,ranges:i}}function Ug({total:t,ranges:e},n){if(n<=0)return e[0].from;if(n>=1)return e[e.length-1].to;let i=Math.floor(t*n);for(let r=0;;r++){let{from:s,to:o}=e[r],a=o-s;if(i<=a)return s+i;i-=a}}function Vg(t,e){let n=0;for(let{from:i,to:r}of t.ranges){if(e<=r){n+=e-i;break}n+=r-i}return n/t.total}function kte(t,e){for(let n of t)if(e(n))return n}const EI={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class CE{constructor(e,n,i){let r=0,s=0,o=0;this.viewports=i.map(({from:a,to:l})=>{let c=n.lineAt(a,Qt.ByPos,e,0,0).top,u=n.lineAt(l,Qt.ByPos,e,0,0).bottom;return r+=u-c,{from:a,to:l,top:c,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(n.height-r);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let n=0,i=0,r=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.top)return r+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom,r=s.domBottom}}fromDOM(e){for(let n=0,i=0,r=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.domTop)return i+(e-r)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom,r=s.domBottom}}eq(e){return e instanceof CE?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((n,i)=>n.from==e.viewports[i].from&&n.to==e.viewports[i].to):!1}}function Nh(t,e){if(e.scale==1)return t;let n=e.toDOM(t.top),i=e.toDOM(t.bottom);return new co(t.from,t.length,n,i-n,Array.isArray(t._content)?t._content.map(r=>Nh(r,e)):t._content)}const Hg=Re.define({combine:t=>t.join(" ")}),wk=Re.define({combine:t=>t.indexOf(!0)>-1}),Sk=$l.newName(),k6=$l.newName(),C6=$l.newName(),_6={"&light":"."+k6,"&dark":"."+C6};function kk(t,e,n){return new $l(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,r=>{if(r=="&")return t;if(!n||!n[r])throw new RangeError(`Unsupported selector: ${r}`);return n[r]}):t+" "+i}})}const Cte=kk("."+Sk,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},_6),_te={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},ew=Ne.ie&&Ne.ie_version<=11;class Ete{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new aee,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(n=>{for(let i of n)this.queue.push(i);(Ne.ie&&Ne.ie_version<=11||Ne.ios&&e.composing)&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&Ne.android&&e.constructor.EDIT_CONTEXT!==!1&&!(Ne.chrome&&Ne.chrome_version<126)&&(this.editContext=new Pte(e),e.state.facet(ia)&&(e.contentDOM.editContext=this.editContext.editContext)),ew&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var n;((n=this.view.docView)===null||n===void 0?void 0:n.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(n=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),n.length>0&&n[n.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(n=>{n.length>0&&n[n.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((n,i)=>n!=e[i]))){this.gapIntersection.disconnect();for(let n of e)this.gapIntersection.observe(n);this.gaps=e}}onSelectionChange(e){let n=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,r=this.selectionRange;if(i.state.facet(ia)?i.root.activeElement!=this.dom:!ev(this.dom,r))return;let s=r.anchorNode&&i.docView.nearest(r.anchorNode);if(s&&s.ignoreEvent(e)){n||(this.selectionChanged=!1);return}(Ne.ie&&Ne.ie_version<=11||Ne.android&&Ne.chrome)&&!i.state.selection.main.empty&&r.focusNode&&ep(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,n=qp(e.root);if(!n)return!1;let i=Ne.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&Ate(this.view,n)||n;if(!i||this.selectionRange.eq(i))return!1;let r=ev(this.dom,i);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&cee(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,n){this.selectionRange.set(e.node,e.offset,n.node,n.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,n=null;for(let i=this.dom;i;)if(i.nodeType==1)!n&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:n||(n=this.scrollTargets.slice(0,e)),n&&n.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!n&&(n=this.scrollTargets.slice(0,e)),n){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=n)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,_te),ew&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),ew&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,n){var i;if(!this.delayedAndroidKey){let r=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&kd(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:n,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let n=-1,i=-1,r=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(r=!0),n==-1?{from:n,to:i}=o:(n=Math.min(o.from,n),i=Math.max(o.to,i)))}return{from:n,to:i,typeOver:r}}readChange(){let{from:e,to:n,typeOver:i}=this.processRecords(),r=this.selectionChanged&&ev(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new Hee(this.view,e,n,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let n=this.readChange();if(!n)return this.view.requestMeasure(),!1;let i=this.view.state,r=h6(this.view,n);return this.view.state==i&&(n.domChanged||n.newSel&&!n.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),r}readMutation(e){let n=this.view.docView.nearest(e.target);if(!n||n.ignoreMutation(e))return null;if(n.markDirty(e.type=="attributes"),e.type=="attributes"&&(n.flags|=4),e.type=="childList"){let i=AI(n,e.previousSibling||e.target.previousSibling,-1),r=AI(n,e.nextSibling||e.target.nextSibling,1);return{from:i?n.posAfter(i):n.posAtStart,to:r?n.posBefore(r):n.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(ia)!=e.state.facet(ia)&&(e.view.contentDOM.editContext=e.state.facet(ia)?this.editContext.editContext:null))}destroy(){var e,n,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(n=this.gapIntersection)===null||n===void 0||n.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function AI(t,e,n){for(;e;){let i=Gt.get(e);if(i&&i.parent==t)return i;let r=e.parentNode;e=r!=t.dom?r:n>0?e.nextSibling:e.previousSibling}return null}function PI(t,e){let n=e.startContainer,i=e.startOffset,r=e.endContainer,s=e.endOffset,o=t.docView.domAtPos(t.state.selection.main.anchor);return ep(o.node,o.offset,r,s)&&([n,i,r,s]=[r,s,n,i]),{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}}function Ate(t,e){if(e.getComposedRanges){let r=e.getComposedRanges(t.root)[0];if(r)return PI(t,r)}let n=null;function i(r){r.preventDefault(),r.stopImmediatePropagation(),n=r.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",i,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",i,!0),n?PI(t,n):null}class Pte{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let n=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let r=e.state.selection.main,{anchor:s,head:o}=r,a=this.toEditorPos(i.updateRangeStart),l=this.toEditorPos(i.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:a,drifted:!1});let c={from:a,to:l,insert:Nt.of(i.text.split(`
`))};if(c.from==this.from&&s<this.from?c.from=s:c.to==this.to&&s>this.to&&(c.to=s),c.from==c.to&&!c.insert.length){let u=ue.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));u.main.eq(r)||e.dispatch({selection:u,userEvent:"select"});return}if((Ne.mac||Ne.android)&&c.from==o-1&&/^\. ?$/.test(i.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:a,to:l,insert:Nt.of([i.text.replace("."," ")])}),this.pendingContextChange=c,!e.state.readOnly){let u=this.to-this.from+(c.to-c.from+c.insert.length);SE(e,c,ue.single(this.toEditorPos(i.selectionStart,u),this.toEditorPos(i.selectionEnd,u)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=i=>{let r=[],s=null;for(let o=this.toEditorPos(i.rangeStart),a=this.toEditorPos(i.rangeEnd);o<a;o++){let l=e.coordsForChar(o);s=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||s||new DOMRect,r.push(s)}n.updateCharacterBounds(i.rangeStart,r)},this.handlers.textformatupdate=i=>{let r=[];for(let s of i.getTextFormats()){let o=s.underlineStyle,a=s.underlineThickness;if(o!="None"&&a!="None"){let l=this.toEditorPos(s.rangeStart),c=this.toEditorPos(s.rangeEnd);if(l<c){let u=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${a=="Thin"?1:2}px`;r.push(gt.mark({attributes:{style:u}}).range(l,c))}}}e.dispatch({effects:o6.of(gt.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(e.state)}};for(let i in this.handlers)n.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let r=qp(i.root);r&&r.rangeCount&&this.editContext.updateSelectionBounds(r.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let n=0,i=!1,r=this.pendingContextChange;return e.changes.iterChanges((s,o,a,l,c)=>{if(i)return;let u=c.length-(o-s);if(r&&o>=r.to)if(r.from==s&&r.to==o&&r.insert.eq(c)){r=this.pendingContextChange=null,n+=u,this.to+=u;return}else r=null,this.revertPending(e.state);if(s+=n,o+=n,o<=this.from)this.from+=u,this.to+=u;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+c.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),c.toString()),this.to+=u}n+=u}),r&&!i&&this.revertPending(e.state),!i}update(e){let n=this.pendingContextChange,i=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(i.from,i.to)&&e.transactions.some(r=>!r.isUserEvent("input.type")&&r.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||n)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:n}=e.selection.main;this.from=Math.max(0,n-1e4),this.to=Math.min(e.doc.length,n+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let n=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(n.from),this.toContextPos(n.from+n.insert.length),e.doc.sliceString(n.from,n.to))}setSelection(e){let{main:n}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,n.anchor))),r=this.toContextPos(n.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(i,r)}rangeIsValid(e){let{head:n}=e.selection.main;return!(this.from>0&&n-this.from<500||this.to<e.doc.length&&this.to-n<500||this.to-this.from>1e4*3)}toEditorPos(e,n=this.to-this.from){e=Math.min(e,n);let i=this.composing;return i&&i.drifted?i.editorBase+(e-i.contextBase):e+this.from}toContextPos(e){let n=this.composing;return n&&n.drifted?n.contextBase+(e-n.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class Be{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var n;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(r=>r.forEach(s=>i(s,this)))||(r=>this.update(r)),this.dispatch=this.dispatch.bind(this),this._root=e.root||lee(e.parent)||document,this.viewState=new _I(e.state||kt.create(e)),e.scrollTo&&e.scrollTo.is(Bg)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(ld).map(r=>new Yx(r));for(let r of this.plugins)r.update(this);this.observer=new Ete(this),this.inputState=new Kee(this),this.inputState.ensureHandlers(this.plugins),this.docView=new oI(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((n=document.fonts)===null||n===void 0)&&n.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let n=e.length==1&&e[0]instanceof Un?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(n,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let n=!1,i=!1,r,s=this.state;for(let f of e){if(f.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=f.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,a=0,l=null;e.some(f=>f.annotation(b6))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=x6(s,o),l||(a=1));let c=this.observer.delayedAndroidKey,u=null;if(c?(this.observer.clearDelayedAndroidKey(),u=this.observer.readChange(),(u&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(u=null)):this.observer.clear(),s.facet(kt.phrases)!=this.state.facet(kt.phrases))return this.setState(s);r=by.create(this,s,e),r.flags|=a;let d=this.viewState.scrollTarget;try{this.updateState=2;for(let f of e){if(d&&(d=d.map(f.changes)),f.scrollIntoView){let{main:p}=f.state.selection;d=new Cd(p.empty?p:ue.cursor(p.head,p.head>p.anchor?-1:1))}for(let p of f.effects)p.is(Bg)&&(d=p.value.clip(this.state))}this.viewState.update(r,d),this.bidiCache=wy.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),n=this.docView.update(r),this.state.facet(Ah)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(Hg)!=r.state.facet(Hg)&&(this.viewState.mustMeasureContent=!0),(n||i||d||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),n&&this.docViewUpdate(),!r.empty)for(let f of this.state.facet(vk))try{f(r)}catch(p){Ar(this.state,p,"update listener")}(l||u)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),u&&!h6(this,u)&&c.force&&kd(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let n=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new _I(e),this.plugins=e.facet(ld).map(i=>new Yx(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new oI(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}n&&this.focus(),this.requestMeasure()}updatePlugins(e){let n=e.startState.facet(ld),i=e.state.facet(ld);if(n!=i){let r=[];for(let s of i){let o=n.indexOf(s);if(o<0)r.push(new Yx(s));else{let a=this.plugins[o];a.mustUpdate=e,r.push(a)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);n!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let n=e.value;if(n&&n.docViewUpdate)try{n.docViewUpdate(this)}catch(i){Ar(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let n=null,i=this.scrollDOM,r=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(O8(i))s=-1,o=this.viewState.heightMap.height;else{let p=this.viewState.scrollAnchorAt(r);s=p.from,o=p.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let u=c.map(p=>{try{return p.read(this)}catch(m){return Ar(this.state,m),NI}}),d=by.create(this,this.state,[]),f=!1;d.flags|=l,n?n.flags|=l:n=d,this.updateState=2,d.empty||(this.updatePlugins(d),this.inputState.update(d),this.updateAttrs(),f=this.docView.update(d),f&&this.docViewUpdate());for(let p=0;p<c.length;p++)if(u[p]!=NI)try{let m=c[p];m.write&&m.write(u[p],this)}catch(m){Ar(this.state,m)}if(f&&this.docView.updateSelection(!0),!d.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let m=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(m>1||m<-1){r=r+m,i.scrollTop=r/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(n&&!n.empty)for(let a of this.state.facet(vk))a(n)}get themeClasses(){return Sk+" "+(this.state.facet(wk)?C6:k6)+" "+this.state.facet(Hg)}updateAttrs(){let e=MI(this,a6,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),n={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(ia)?"true":"false",class:"cm-content",style:`${Ne.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(n["aria-readonly"]="true"),MI(this,bE,n);let i=this.observer.ignore(()=>{let r=fk(this.contentDOM,this.contentAttrs,n),s=fk(this.dom,this.editorAttrs,e);return r||s});return this.editorAttrs=e,this.contentAttrs=n,i}showAnnouncements(e){let n=!0;for(let i of e)for(let r of i.effects)if(r.is(Be.announce)){n&&(this.announceDOM.textContent=""),n=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(Ah);let e=this.state.facet(Be.cspNonce);$l.mount(this.root,this.styleModules.concat(Cte).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let n=0;n<this.measureRequests.length;n++)if(this.measureRequests[n].key===e.key){this.measureRequests[n]=e;return}}this.measureRequests.push(e)}}plugin(e){let n=this.pluginMap.get(e);return(n===void 0||n&&n.plugin!=e)&&this.pluginMap.set(e,n=this.plugins.find(i=>i.plugin==e)||null),n&&n.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,n,i){return Zx(this,e,dI(this,e,n,i))}moveByGroup(e,n){return Zx(this,e,dI(this,e,n,i=>Fee(this,e.head,i)))}visualLineSide(e,n){let i=this.bidiSpans(e),r=this.textDirectionAt(e.from),s=i[n?i.length-1:0];return ue.cursor(s.side(n,r)+e.from,s.forward(!n,r)?1:-1)}moveToLineBoundary(e,n,i=!0){return $ee(this,e,n,i)}moveVertically(e,n,i){return Zx(this,e,zee(this,e,n,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,n=0){return this.docView.posFromDOM(e,n)}posAtCoords(e,n=!0){return this.readMeasured(),f6(this,e,n)}coordsAtPos(e,n=1){this.readMeasured();let i=this.docView.coordsAt(e,n);if(!i||i.left==i.right)return i;let r=this.state.doc.lineAt(e),s=this.bidiSpans(r),o=s[al.find(s,e-r.from,-1,n)];return Wb(i,o.dir==sn.LTR==n>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(i6)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Nte)return K8(e.length);let n=this.textDirectionAt(e.from),i;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==n&&(s.fresh||q8(s.isolates,i=sI(this,e))))return s.order;i||(i=sI(this,e));let r=kee(e.text,n,i);return this.bidiCache.push(new wy(e.from,e.to,n,i,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Ne.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{I8(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,n={}){return Bg.of(new Cd(typeof e=="number"?ue.cursor(e):e,n.y,n.x,n.yMargin,n.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:n}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return Bg.of(new Cd(ue.cursor(i.from),"start","start",i.top-e,n,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return pi.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return pi.define(()=>({}),{eventObservers:e})}static theme(e,n){let i=$l.newName(),r=[Hg.of(i),Ah.of(kk(`.${i}`,e))];return n&&n.dark&&r.push(wk.of(!0)),r}static baseTheme(e){return Im.lowest(Ah.of(kk("."+Sk,e,_6)))}static findFromDOM(e){var n;let i=e.querySelector(".cm-content"),r=i&&Gt.get(i)||Gt.get(e);return((n=r==null?void 0:r.rootView)===null||n===void 0?void 0:n.view)||null}}Be.styleModule=Ah;Be.inputHandler=t6;Be.clipboardInputFilter=vE;Be.clipboardOutputFilter=yE;Be.scrollHandler=s6;Be.focusChangeEffect=n6;Be.perLineTextDirection=i6;Be.exceptionSink=e6;Be.updateListener=vk;Be.editable=ia;Be.mouseSelectionStyle=Q8;Be.dragMovesSelection=Z8;Be.clickAddsSelectionRange=J8;Be.decorations=Yp;Be.outerDecorations=l6;Be.atomicRanges=xE;Be.bidiIsolatedRanges=c6;Be.scrollMargins=u6;Be.darkTheme=wk;Be.cspNonce=Re.define({combine:t=>t.length?t[0]:""});Be.contentAttributes=bE;Be.editorAttributes=a6;Be.lineWrapping=Be.contentAttributes.of({class:"cm-lineWrapping"});Be.announce=pt.define();const Nte=4096,NI={};class wy{constructor(e,n,i,r,s,o){this.from=e,this.to=n,this.dir=i,this.isolates=r,this.fresh=s,this.order=o}static update(e,n){if(n.empty&&!e.some(s=>s.fresh))return e;let i=[],r=e.length?e[e.length-1].dir:sn.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==r&&!n.touchesRange(o.from,o.to)&&i.push(new wy(n.mapPos(o.from,1),n.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function MI(t,e,n){for(let i=t.state.facet(e),r=i.length-1;r>=0;r--){let s=i[r],o=typeof s=="function"?s(t):s;o&&dk(o,n)}return n}const Mte=Ne.mac?"mac":Ne.windows?"win":Ne.linux?"linux":"key";function Rte(t,e){const n=t.split(/-(?!$)/);let i=n[n.length-1];i=="Space"&&(i=" ");let r,s,o,a;for(let l=0;l<n.length-1;++l){const c=n[l];if(/^(cmd|meta|m)$/i.test(c))a=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(i="Alt-"+i),s&&(i="Ctrl-"+i),a&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function Wg(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n!==!1&&e.shiftKey&&(t="Shift-"+t),t}const Ite=Im.default(Be.domEventHandlers({keydown(t,e){return P6(A6(e.state),t,e,"editor")}})),E6=Re.define({enables:Ite}),RI=new WeakMap;function A6(t){let e=t.facet(E6),n=RI.get(e);return n||RI.set(e,n=Lte(e.reduce((i,r)=>i.concat(r),[]))),n}function Tte(t,e,n){return P6(A6(t.state),e,t,n)}let Ja=null;const Ote=4e3;function Lte(t,e=Mte){let n=Object.create(null),i=Object.create(null),r=(o,a)=>{let l=i[o];if(l==null)i[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,l,c,u)=>{var d,f;let p=n[o]||(n[o]=Object.create(null)),m=a.split(/ (?!$)/).map(v=>Rte(v,e));for(let v=1;v<m.length;v++){let b=m.slice(0,v).join(" ");r(b,!0),p[b]||(p[b]={preventDefault:!0,stopPropagation:!1,run:[w=>{let k=Ja={view:w,prefix:b,scope:o};return setTimeout(()=>{Ja==k&&(Ja=null)},Ote),!0}]})}let g=m.join(" ");r(g,!1);let y=p[g]||(p[g]={preventDefault:!1,stopPropagation:!1,run:((f=(d=p._any)===null||d===void 0?void 0:d.run)===null||f===void 0?void 0:f.slice())||[]});l&&y.run.push(l),c&&(y.preventDefault=!0),u&&(y.stopPropagation=!0)};for(let o of t){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of a){let u=n[c]||(n[c]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:d}=o;for(let f in u)u[f].run.push(p=>d(p,Ck))}let l=o[e]||o.key;if(l)for(let c of a)s(c,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(c,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return n}let Ck=null;function P6(t,e,n,i){Ck=e;let r=iee(e),s=qr(r,0),o=na(s)==r.length&&r!=" ",a="",l=!1,c=!1,u=!1;Ja&&Ja.view==n&&Ja.scope==i&&(a=Ja.prefix+" ",m6.indexOf(e.keyCode)<0&&(c=!0,Ja=null));let d=new Set,f=y=>{if(y){for(let v of y.run)if(!d.has(v)&&(d.add(v),v(n)))return y.stopPropagation&&(u=!0),!0;y.preventDefault&&(y.stopPropagation&&(u=!0),c=!0)}return!1},p=t[i],m,g;return p&&(f(p[a+Wg(r,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Ne.windows&&e.ctrlKey&&e.altKey)&&(m=Fl[e.keyCode])&&m!=r?(f(p[a+Wg(m,e,!0)])||e.shiftKey&&(g=Xp[e.keyCode])!=r&&g!=m&&f(p[a+Wg(g,e,!1)]))&&(l=!0):o&&e.shiftKey&&f(p[a+Wg(r,e,!0)])&&(l=!0),!l&&f(p._any)&&(l=!0)),c&&(l=!0),l&&u&&e.stopPropagation(),Ck=null,l}class jm{constructor(e,n,i,r,s){this.className=e,this.left=n,this.top=i,this.width=r,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,n){return n.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,n,i){if(i.empty){let r=e.coordsAtPos(i.head,i.assoc||1);if(!r)return[];let s=N6(e);return[new jm(n,r.left-s.left,r.top-s.top,null,r.bottom-r.top)]}else return Dte(e,n,i)}}function N6(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==sn.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function II(t,e,n,i){let r=t.coordsAtPos(e,n*2);if(!r)return i;let s=t.dom.getBoundingClientRect(),o=(r.top+r.bottom)/2,a=t.posAtCoords({x:s.left+1,y:o}),l=t.posAtCoords({x:s.right-1,y:o});return a==null||l==null?i:{from:Math.max(i.from,Math.min(a,l)),to:Math.min(i.to,Math.max(a,l))}}function Dte(t,e,n){if(n.to<=t.viewport.from||n.from>=t.viewport.to)return[];let i=Math.max(n.from,t.viewport.from),r=Math.min(n.to,t.viewport.to),s=t.textDirection==sn.LTR,o=t.contentDOM,a=o.getBoundingClientRect(),l=N6(t),c=o.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),d=a.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),f=a.right-(u?parseInt(u.paddingRight):0),p=bk(t,i,1),m=bk(t,r,-1),g=p.type==Di.Text?p:null,y=m.type==Di.Text?m:null;if(g&&(t.lineWrapping||p.widgetLineBreaks)&&(g=II(t,i,1,g)),y&&(t.lineWrapping||m.widgetLineBreaks)&&(y=II(t,r,-1,y)),g&&y&&g.from==y.from&&g.to==y.to)return b(w(n.from,n.to,g));{let C=g?w(n.from,null,g):k(p,!1),E=y?w(null,n.to,y):k(m,!0),_=[];return(g||p).to<(y||m).from-(g&&y?1:0)||p.widgetLineBreaks>1&&C.bottom+t.defaultLineHeight/2<E.top?_.push(v(d,C.bottom,f,E.top)):C.bottom<E.top&&t.elementAtHeight((C.bottom+E.top)/2).type==Di.Text&&(C.bottom=E.top=(C.bottom+E.top)/2),b(C).concat(_).concat(b(E))}function v(C,E,_,M){return new jm(e,C-l.left,E-l.top,_-C,M-E)}function b({top:C,bottom:E,horizontal:_}){let M=[];for(let R=0;R<_.length;R+=2)M.push(v(_[R],C,_[R+1],E));return M}function w(C,E,_){let M=1e9,R=-1e9,T=[];function L(B,q,Y,ne,V){let U=t.coordsAtPos(B,B==_.to?-2:2),se=t.coordsAtPos(Y,Y==_.from?2:-2);!U||!se||(M=Math.min(U.top,se.top,M),R=Math.max(U.bottom,se.bottom,R),V==sn.LTR?T.push(s&&q?d:U.left,s&&ne?f:se.right):T.push(!s&&ne?d:se.left,!s&&q?f:U.right))}let I=C??_.from,G=E??_.to;for(let B of t.visibleRanges)if(B.to>I&&B.from<G)for(let q=Math.max(B.from,I),Y=Math.min(B.to,G);;){let ne=t.state.doc.lineAt(q);for(let V of t.bidiSpans(ne)){let U=V.from+ne.from,se=V.to+ne.from;if(U>=Y)break;se>q&&L(Math.max(U,q),C==null&&U<=I,Math.min(se,Y),E==null&&se>=G,V.dir)}if(q=ne.to+1,q>=Y)break}return T.length==0&&L(I,C==null,G,E==null,t.textDirection),{top:M,bottom:R,horizontal:T}}function k(C,E){let _=a.top+(E?C.top:C.bottom);return{top:_,bottom:_,horizontal:[]}}}function jte(t,e){return t.constructor==e.constructor&&t.eq(e)}class Bte{constructor(e,n){this.view=e,this.layer=n,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),n.above&&this.dom.classList.add("cm-layer-above"),n.class&&this.dom.classList.add(n.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),n.mount&&n.mount(this.dom,e)}update(e){e.startState.facet(rv)!=e.state.facet(rv)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let n=0,i=e.facet(rv);for(;n<i.length&&i[n]!=this.layer;)n++;this.dom.style.zIndex=String((this.layer.above?150:-1)-n)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:n}=this.view;(e!=this.scaleX||n!=this.scaleY)&&(this.scaleX=e,this.scaleY=n,this.dom.style.transform=`scale(${1/e}, ${1/n})`)}draw(e){if(e.length!=this.drawn.length||e.some((n,i)=>!jte(n,this.drawn[i]))){let n=this.dom.firstChild,i=0;for(let r of e)r.update&&n&&r.constructor&&this.drawn[i].constructor&&r.update(n,this.drawn[i])?(n=n.nextSibling,i++):this.dom.insertBefore(r.draw(),n);for(;n;){let r=n.nextSibling;n.remove(),n=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const rv=Re.define();function M6(t){return[pi.define(e=>new Bte(e,t)),rv.of(t)]}const Jp=Re.define({combine(t){return Zl(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,n)=>Math.min(e,n),drawRangeCursor:(e,n)=>e||n})}});function $te(t={}){return[Jp.of(t),Fte,zte,Ute,r6.of(!0)]}function R6(t){return t.startState.facet(Jp)!=t.state.facet(Jp)}const Fte=M6({above:!0,markers(t){let{state:e}=t,n=e.facet(Jp),i=[];for(let r of e.selection.ranges){let s=r==e.selection.main;if(r.empty||n.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=r.empty?r:ue.cursor(r.head,r.head>r.anchor?-1:1);for(let l of jm.forRange(t,o,a))i.push(l)}}return i},update(t,e){t.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let n=R6(t);return n&&TI(t.state,e),t.docChanged||t.selectionSet||n},mount(t,e){TI(e.state,t)},class:"cm-cursorLayer"});function TI(t,e){e.style.animationDuration=t.facet(Jp).cursorBlinkRate+"ms"}const zte=M6({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:jm.forRange(t,"cm-selectionBackground",e)).reduce((e,n)=>e.concat(n))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||R6(t)},class:"cm-selectionLayer"}),Ute=Im.highest(Be.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}}));function OI(t,e,n,i,r){e.lastIndex=0;for(let s=t.iterRange(n,i),o=n,a;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;a=e.exec(s.value);)r(o+a.index,a)}function Vte(t,e){let n=t.visibleRanges;if(n.length==1&&n[0].from==t.viewport.from&&n[0].to==t.viewport.to)return n;let i=[];for(let{from:r,to:s}of n)r=Math.max(t.state.doc.lineAt(r).from,r-e),s=Math.min(t.state.doc.lineAt(s).to,s+e),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}class Hte{constructor(e){const{regexp:n,decoration:i,decorate:r,boundary:s,maxLength:o=1e3}=e;if(!n.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=n,r)this.addMatch=(a,l,c,u)=>r(u,c,c+a[0].length,a,l);else if(typeof i=="function")this.addMatch=(a,l,c,u)=>{let d=i(a,l,c);d&&u(c,c+a[0].length,d)};else if(i)this.addMatch=(a,l,c,u)=>u(c,c+a[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let n=new Bl,i=n.add.bind(n);for(let{from:r,to:s}of Vte(e,this.maxLength))OI(e.state.doc,this.regexp,r,s,(o,a)=>this.addMatch(a,e,o,i));return n.finish()}updateDeco(e,n){let i=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((s,o,a,l)=>{l>=e.view.viewport.from&&a<=e.view.viewport.to&&(i=Math.min(a,i),r=Math.max(l,r))}),e.viewportMoved||r-i>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,n.map(e.changes),i,r):n}updateRange(e,n,i,r){for(let s of e.visibleRanges){let o=Math.max(s.from,i),a=Math.min(s.to,r);if(a>=o){let l=e.state.doc.lineAt(o),c=l.to<a?e.state.doc.lineAt(a):l,u=Math.max(s.from,l.from),d=Math.min(s.to,c.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){u=o;break}for(;a<c.to;a++)if(this.boundary.test(c.text[a-c.from])){d=a;break}}let f=[],p,m=(g,y,v)=>f.push(v.range(g,y));if(l==c)for(this.regexp.lastIndex=u-l.from;(p=this.regexp.exec(l.text))&&p.index<d-l.from;)this.addMatch(p,e,p.index+l.from,m);else OI(e.state.doc,this.regexp,u,d,(g,y)=>this.addMatch(y,e,g,m));n=n.update({filterFrom:u,filterTo:d,filter:(g,y)=>g<u||y>d,add:f})}}return n}}const _k=/x/.unicode!=null?"gu":"g",Wte=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,_k),Gte={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let tw=null;function Xte(){var t;if(tw==null&&typeof document<"u"&&document.body){let e=document.body.style;tw=((t=e.tabSize)!==null&&t!==void 0?t:e.MozTabSize)!=null}return tw||!1}const sv=Re.define({combine(t){let e=Zl(t,{render:null,specialChars:Wte,addSpecialChars:null});return(e.replaceTabs=!Xte())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,_k)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,_k)),e}});function qte(t={}){return[sv.of(t),Kte()]}let LI=null;function Kte(){return LI||(LI=pi.fromClass(class{constructor(t){this.view=t,this.decorations=gt.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(sv)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new Hte({regexp:t.specialChars,decoration:(e,n,i)=>{let{doc:r}=n.state,s=qr(e[0],0);if(s==9){let o=r.lineAt(i),a=n.state.tabSize,l=Om(o.text,a,i-o.from);return gt.replace({widget:new Qte((a-l%a)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=gt.replace({widget:new Zte(t,s)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(sv);t.startState.facet(sv)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))}const Yte="•";function Jte(t){return t>=32?Yte:t==10?"␤":String.fromCharCode(9216+t)}class Zte extends Ql{constructor(e,n){super(),this.options=e,this.code=n}eq(e){return e.code==this.code}toDOM(e){let n=Jte(this.code),i=e.state.phrase("Control character")+" "+(Gte[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,i,n);if(r)return r;let s=document.createElement("span");return s.textContent=n,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class Qte extends Ql{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function ene(){return nne}const tne=gt.line({class:"cm-activeLine"}),nne=pi.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,n=[];for(let i of t.state.selection.ranges){let r=t.lineBlockAt(i.head);r.from>e&&(n.push(tne.range(r.from)),e=r.from)}return gt.set(n)}},{decorations:t=>t.decorations}),Qf="-10000px";class I6{constructor(e,n,i,r){this.facet=n,this.createTooltipView=i,this.removeTooltipView=r,this.input=e.state.facet(n),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=i(o,s))}update(e,n){var i;let r=e.state.facet(this.facet),s=r.filter(l=>l);if(r===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let o=[],a=n?[]:null;for(let l=0;l<s.length;l++){let c=s[l],u=-1;if(c){for(let d=0;d<this.tooltips.length;d++){let f=this.tooltips[d];f&&f.create==c.create&&(u=d)}if(u<0)o[l]=this.createTooltipView(c,l?o[l-1]:null),a&&(a[l]=!!c.above);else{let d=o[l]=this.tooltipViews[u];a&&(a[l]=n[u]),d.update&&d.update(e)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(i=l.destroy)===null||i===void 0||i.call(l));return n&&(a.forEach((l,c)=>n[c]=l),n.length=a.length),this.input=r,this.tooltips=s,this.tooltipViews=o,!0}}function ine(t){let e=t.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const nw=Re.define({combine:t=>{var e,n,i;return{position:Ne.ios?"absolute":((e=t.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((n=t.find(r=>r.parent))===null||n===void 0?void 0:n.parent)||null,tooltipSpace:((i=t.find(r=>r.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||ine}}}),DI=new WeakMap,_E=pi.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(nw);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new I6(t,EE,(n,i)=>this.createTooltip(n,i),n=>{this.resizeObserver&&this.resizeObserver.unobserve(n.dom),n.dom.remove()}),this.above=this.manager.tooltips.map(n=>!!n.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(n=>{Date.now()>this.lastTransaction-50&&n.length>0&&n[n.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let n=e||t.geometryChanged,i=t.state.facet(nw);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;n=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(t,e){let n=t.create(this.view),i=e?e.dom:null;if(n.dom.classList.add("cm-tooltip"),t.arrow&&!n.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",n.dom.appendChild(r)}return n.dom.style.position=this.position,n.dom.style.top=Qf,n.dom.style.left="0px",this.container.insertBefore(n.dom,i),n.mount&&n.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(n.dom),n}destroy(){var t,e,n;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(t=i.destroy)===null||t===void 0||t.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(n=this.intersectionObserver)===null||n===void 0||n.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=1,e=1,n=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(Ne.gecko)n=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==Qf&&s.style.left=="0px"){let o=s.getBoundingClientRect();n=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(n||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(t=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),r=wE(this.view);return{visible:{left:i.left+r.left,top:i.top+r.top,right:i.right-r.right,bottom:i.bottom-r.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,o)=>{let a=this.manager.tooltipViews[o];return a.getCoords?a.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(nw).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:n}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{visible:n,space:i,scaleX:r,scaleY:s}=t,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:u}=c,d=t.pos[a],f=t.size[a];if(!d||l.clip!==!1&&(d.bottom<=Math.max(n.top,i.top)||d.top>=Math.min(n.bottom,i.bottom)||d.right<Math.max(n.left,i.left)-.1||d.left>Math.min(n.right,i.right)+.1)){u.style.top=Qf;continue}let p=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,m=p?7:0,g=f.right-f.left,y=(e=DI.get(c))!==null&&e!==void 0?e:f.bottom-f.top,v=c.offset||sne,b=this.view.textDirection==sn.LTR,w=f.width>i.right-i.left?b?i.left:i.right-f.width:b?Math.max(i.left,Math.min(d.left-(p?14:0)+v.x,i.right-g)):Math.min(Math.max(i.left,d.left-g+(p?14:0)-v.x),i.right-g),k=this.above[a];!l.strictSide&&(k?d.top-y-m-v.y<i.top:d.bottom+y+m+v.y>i.bottom)&&k==i.bottom-d.bottom>d.top-i.top&&(k=this.above[a]=!k);let C=(k?d.top-i.top:i.bottom-d.bottom)-m;if(C<y&&c.resize!==!1){if(C<this.view.defaultLineHeight){u.style.top=Qf;continue}DI.set(c,y),u.style.height=(y=C)/s+"px"}else u.style.height&&(u.style.height="");let E=k?d.top-y-m-v.y:d.bottom+m+v.y,_=w+g;if(c.overlap!==!0)for(let M of o)M.left<_&&M.right>w&&M.top<E+y&&M.bottom>E&&(E=k?M.top-y-2-m:M.bottom+m+2);if(this.position=="absolute"?(u.style.top=(E-t.parent.top)/s+"px",jI(u,(w-t.parent.left)/r)):(u.style.top=E/s+"px",jI(u,w/r)),p){let M=d.left+(b?v.x:-v.x)-(w+14-7);p.style.left=M/r+"px"}c.overlap!==!0&&o.push({left:w,top:E,right:_,bottom:E+y}),u.classList.toggle("cm-tooltip-above",k),u.classList.toggle("cm-tooltip-below",!k),c.positioned&&c.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=Qf}},{eventObservers:{scroll(){this.maybeMeasure()}}});function jI(t,e){let n=parseInt(t.style.left,10);(isNaN(n)||Math.abs(e-n)>1)&&(t.style.left=e+"px")}const rne=Be.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),sne={x:0,y:0},EE=Re.define({enables:[_E,rne]}),Sy=Re.define({combine:t=>t.reduce((e,n)=>e.concat(n),[])});class qb{static create(e){return new qb(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new I6(e,Sy,(n,i)=>this.createHostedView(n,i),n=>n.dom.remove())}createHostedView(e,n){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,n?n.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let n of this.manager.tooltipViews)n.mount&&n.mount(e);this.mounted=!0}positioned(e){for(let n of this.manager.tooltipViews)n.positioned&&n.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let n of this.manager.tooltipViews)(e=n.destroy)===null||e===void 0||e.call(n)}passProp(e){let n;for(let i of this.manager.tooltipViews){let r=i[e];if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}}return n}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const one=EE.compute([Sy],t=>{let e=t.facet(Sy);return e.length===0?null:{pos:Math.min(...e.map(n=>n.pos)),end:Math.max(...e.map(n=>{var i;return(i=n.end)!==null&&i!==void 0?i:n.pos})),create:qb.create,above:e[0].above,arrow:e.some(n=>n.arrow)}});class ane{constructor(e,n,i,r,s){this.view=e,this.source=n,this.field=i,this.setHover=r,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:n}=this,i=e.docView.nearest(n.target);if(!i)return;let r,s=1;if(i instanceof ol)r=i.posAtStart;else{if(r=e.posAtCoords(n),r==null)return;let a=e.coordsAtPos(r);if(!a||n.y<a.top||n.y>a.bottom||n.x<a.left-e.defaultCharacterWidth||n.x>a.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(r)).find(u=>u.from<=r&&u.to>=r),c=l&&l.dir==sn.RTL?-1:1;s=n.x<a.left?-c:c}let o=this.source(e,r,s);if(o!=null&&o.then){let a=this.pending={pos:r};o.then(l=>{this.pending==a&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>Ar(e.state,l,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(_E),n=e?e.manager.tooltips.findIndex(i=>i.create==qb.create):-1;return n>-1?e.manager.tooltipViews[n]:null}mousemove(e){var n,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:r,tooltip:s}=this;if(r.length&&s&&!lne(s.dom,e)||this.pending){let{pos:o}=r[0]||this.pending,a=(i=(n=r[0])===null||n===void 0?void 0:n.end)!==null&&i!==void 0?i:o;(o==a?this.view.posAtCoords(this.lastMove)!=o:!cne(this.view,o,a,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:n}=this;if(n.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let n=i=>{e.removeEventListener("mouseleave",n),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",n)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Gg=4;function lne(t,e){let{left:n,right:i,top:r,bottom:s}=t.getBoundingClientRect(),o;if(o=t.querySelector(".cm-tooltip-arrow")){let a=o.getBoundingClientRect();r=Math.min(a.top,r),s=Math.max(a.bottom,s)}return e.clientX>=n-Gg&&e.clientX<=i+Gg&&e.clientY>=r-Gg&&e.clientY<=s+Gg}function cne(t,e,n,i,r,s){let o=t.scrollDOM.getBoundingClientRect(),a=t.documentTop+t.documentPadding.top+t.contentHeight;if(o.left>i||o.right<i||o.top>r||Math.min(o.bottom,a)<r)return!1;let l=t.posAtCoords({x:i,y:r},!1);return l>=e&&l<=n}function une(t,e={}){let n=pt.define(),i=zi.define({create(){return[]},update(r,s){if(r.length&&(e.hideOnChange&&(s.docChanged||s.selection)?r=[]:e.hideOn&&(r=r.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let a of r){let l=s.changes.mapPos(a.pos,-1,rr.TrackDel);if(l!=null){let c=Object.assign(Object.create(null),a);c.pos=l,c.end!=null&&(c.end=s.changes.mapPos(c.end)),o.push(c)}}r=o}for(let o of s.effects)o.is(n)&&(r=o.value),o.is(fne)&&(r=[]);return r},provide:r=>Sy.from(r)});return{active:i,extension:[i,pi.define(r=>new ane(r,t,i,n,e.hoverTime||300)),one]}}function dne(t,e){let n=t.plugin(_E);if(!n)return null;let i=n.manager.tooltips.indexOf(e);return i<0?null:n.manager.tooltipViews[i]}const fne=pt.define(),BI=Re.define({combine(t){let e,n;for(let i of t)e=e||i.topContainer,n=n||i.bottomContainer;return{topContainer:e,bottomContainer:n}}});function Zp(t,e){let n=t.plugin(T6),i=n?n.specs.indexOf(e):-1;return i>-1?n.panels[i]:null}const T6=pi.fromClass(class{constructor(t){this.input=t.state.facet(Qp),this.specs=this.input.filter(n=>n),this.panels=this.specs.map(n=>n(t));let e=t.state.facet(BI);this.top=new Xg(t,!0,e.topContainer),this.bottom=new Xg(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(n=>n.top)),this.bottom.sync(this.panels.filter(n=>!n.top));for(let n of this.panels)n.dom.classList.add("cm-panel"),n.mount&&n.mount()}update(t){let e=t.state.facet(BI);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Xg(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Xg(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=t.state.facet(Qp);if(n!=this.input){let i=n.filter(l=>l),r=[],s=[],o=[],a=[];for(let l of i){let c=this.specs.indexOf(l),u;c<0?(u=l(t.view),a.push(u)):(u=this.panels[c],u.update&&u.update(t)),r.push(u),(u.top?s:o).push(u)}this.specs=i,this.panels=r,this.top.sync(s),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let i of this.panels)i.update&&i.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Be.scrollMargins.of(e=>{let n=e.plugin(t);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}})});class Xg{constructor(e,n,i){this.view=e,this.top=n,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let n of this.panels)n.destroy&&e.indexOf(n)<0&&n.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let n=this.container||this.view.dom;n.insertBefore(this.dom,this.top?n.firstChild:null)}let e=this.dom.firstChild;for(let n of this.panels)if(n.dom.parentNode==this.dom){for(;e!=n.dom;)e=$I(e);e=e.nextSibling}else this.dom.insertBefore(n.dom,e);for(;e;)e=$I(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function $I(t){let e=t.nextSibling;return t.remove(),e}const Qp=Re.define({enables:T6});class Ul extends tu{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ul.prototype.elementClass="";Ul.prototype.toDOM=void 0;Ul.prototype.mapMode=rr.TrackBefore;Ul.prototype.startSide=Ul.prototype.endSide=-1;Ul.prototype.point=!0;const ov=Re.define(),hne=Re.define(),av=Re.define(),FI=Re.define({combine:t=>t.some(e=>e)});function pne(t){return[mne]}const mne=pi.fromClass(class{constructor(t){this.view=t,this.domAfter=null,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(av).map(e=>new UI(t,e)),this.fixed=!t.state.facet(FI);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(t){if(this.updateGutters(t)){let e=this.prevViewport,n=t.view.viewport,i=Math.min(e.to,n.to)-Math.max(e.from,n.from);this.syncGutters(i<(n.to-n.from)*.8)}if(t.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(FI)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let n=Bt.iter(this.view.state.facet(ov),this.view.viewport.from),i=[],r=this.gutters.map(s=>new gne(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(s.type)){let o=!0;for(let a of s.type)if(a.type==Di.Text&&o){Ek(n,i,a.from);for(let l of r)l.line(this.view,a,i);o=!1}else if(a.widget)for(let l of r)l.widget(this.view,a)}else if(s.type==Di.Text){Ek(n,i,s.from);for(let o of r)o.line(this.view,s,i)}else if(s.widget)for(let o of r)o.widget(this.view,s);for(let s of r)s.finish();t&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(t){let e=t.startState.facet(av),n=t.state.facet(av),i=t.docChanged||t.heightChanged||t.viewportChanged||!Bt.eq(t.startState.facet(ov),t.state.facet(ov),t.view.viewport.from,t.view.viewport.to);if(e==n)for(let r of this.gutters)r.update(t)&&(i=!0);else{i=!0;let r=[];for(let s of n){let o=e.indexOf(s);o<0?r.push(new UI(this.view,s)):(this.gutters[o].update(t),r.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),r.indexOf(s)<0&&s.destroy();for(let s of r)s.config.side=="after"?this.getDOMAfter().appendChild(s.dom):this.dom.appendChild(s.dom);this.gutters=r}return i}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:t=>Be.scrollMargins.of(e=>{let n=e.plugin(t);if(!n||n.gutters.length==0||!n.fixed)return null;let i=n.dom.offsetWidth*e.scaleX,r=n.domAfter?n.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==sn.LTR?{left:i,right:r}:{right:i,left:r}})});function zI(t){return Array.isArray(t)?t:[t]}function Ek(t,e,n){for(;t.value&&t.from<=n;)t.from==n&&e.push(t.value),t.next()}class gne{constructor(e,n,i){this.gutter=e,this.height=i,this.i=0,this.cursor=Bt.iter(e.markers,n.from)}addElement(e,n,i){let{gutter:r}=this,s=(n.top-this.height)/e.scaleY,o=n.height/e.scaleY;if(this.i==r.elements.length){let a=new O6(e,o,s,i);r.elements.push(a),r.dom.appendChild(a.dom)}else r.elements[this.i].update(e,o,s,i);this.height=n.bottom,this.i++}line(e,n,i){let r=[];Ek(this.cursor,r,n.from),i.length&&(r=r.concat(i));let s=this.gutter.config.lineMarker(e,n,r);s&&r.unshift(s);let o=this.gutter;r.length==0&&!o.config.renderEmptyElements||this.addElement(e,n,r)}widget(e,n){let i=this.gutter.config.widgetMarker(e,n.widget,n),r=i?[i]:null;for(let s of e.state.facet(hne)){let o=s(e,n.widget,n);o&&(r||(r=[])).push(o)}r&&this.addElement(e,n,r)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let n=e.elements.pop();e.dom.removeChild(n.dom),n.destroy()}}}class UI{constructor(e,n){this.view=e,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in n.domEventHandlers)this.dom.addEventListener(i,r=>{let s=r.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let l=s.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=r.clientY;let a=e.lineBlockAtHeight(o-e.documentTop);n.domEventHandlers[i](e,a,r)&&r.preventDefault()});this.markers=zI(n.markers(e)),n.initialSpacer&&(this.spacer=new O6(e,0,0,[n.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let n=this.markers;if(this.markers=zI(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let i=e.view.viewport;return!Bt.eq(this.markers,n,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class O6{constructor(e,n,i,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,n,i,r)}update(e,n,i,r){this.height!=n&&(this.height=n,this.dom.style.height=n+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),vne(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,n){let i="cm-gutterElement",r=this.dom.firstChild;for(let s=0,o=0;;){let a=o,l=s<n.length?n[s++]:null,c=!1;if(l){let u=l.elementClass;u&&(i+=" "+u);for(let d=o;d<this.markers.length;d++)if(this.markers[d].compare(l)){a=d,c=!0;break}}else a=this.markers.length;for(;o<a;){let u=this.markers[o++];if(u.toDOM){u.destroy(r);let d=r.nextSibling;r.remove(),r=d}}if(!l)break;l.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(l.toDOM(e),r)),c&&o++}this.dom.className=i,this.markers=n}destroy(){this.setMarkers(null,[])}}function vne(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].compare(e[n]))return!1;return!0}const yne=Re.define(),bne=Re.define(),cd=Re.define({combine(t){return Zl(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,n){let i=Object.assign({},e);for(let r in n){let s=i[r],o=n[r];i[r]=s?(a,l,c)=>s(a,l,c)||o(a,l,c):o}return i}})}});class iw extends Ul{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function rw(t,e){return t.state.facet(cd).formatNumber(e,t.state)}const xne=av.compute([cd],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(yne)},lineMarker(e,n,i){return i.some(r=>r.toDOM)?null:new iw(rw(e,e.state.doc.lineAt(n.from).number))},widgetMarker:(e,n,i)=>{for(let r of e.state.facet(bne)){let s=r(e,n,i);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(cd)!=e.state.facet(cd),initialSpacer(e){return new iw(rw(e,VI(e.state.doc.lines)))},updateSpacer(e,n){let i=rw(n.view,VI(n.view.state.doc.lines));return i==e.number?e:new iw(i)},domEventHandlers:t.facet(cd).domEventHandlers,side:"before"}));function wne(t={}){return[cd.of(t),pne(),xne]}function VI(t){let e=9;for(;e<t;)e=e*10+9;return e}const Sne=new class extends Ul{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},kne=ov.compute(["selection"],t=>{let e=[],n=-1;for(let i of t.selection.ranges){let r=t.doc.lineAt(i.head).from;r>n&&(n=r,e.push(Sne.range(r)))}return Bt.of(e)});function Cne(){return kne}const L6=new Tm;function _ne(t){window.codemirror&&window.codemirror.dispatch({effects:L6.reconfigure(kt.readOnly.of(t))})}const D6=pt.define(),Ak=pt.define(),Ene=zi.define({create(){return gt.none},update(t,e){let n=t.map(e.changes);for(const i of e.effects)i.is(D6)&&(n=gt.none,i.value!==null&&(n=n.update({add:[Ane.range(i.value)]}))),i.is(Ak)&&(n=gt.none,i.value!==null&&(n=n.update({add:[Pne.range(i.value)]})));return n},provide:t=>Be.decorations.from(t)}),Ane=gt.line({class:"!bg-gradient-to-r !from-mantis-500/8 !via-mantis-500/5 !to-transparent !border-l-2 !border-mantis-400/40 !shadow-sm"}),Pne=gt.line({class:"cm-current-instruction"});function Nne(t){window.codemirror&&window.codemirror.dispatch({effects:D6.of(null)})}function j6(t){if(window.codemirror)if(t===null)window.codemirror.dispatch({effects:Ak.of(null)});else{const e=window.codemirror.state.doc.lineAt(t).from;window.codemirror.dispatch({effects:Ak.of(e)})}}const em=me(!1),B6=qa.init("phc_Iq0zy6d8IRJY2ts0uHNWlSbectCsUgQK77MLj3ypSdM",{api_host:"https://us.posthog.com",autocapture:!1,capture_pageview:!0,persistence:"memory"})||qa,Mne=1,HI=5e3,Zs=new Map,np=[];function Rne(){let t=0;for(const e of Zs.keys())e>t&&(t=e);return t+1}function Ine(){let t=1/0;for(const e of Zs.keys())e<t&&(t=e);return t}function ll(t,e=!0){switch(t.type){case"ADD_TOAST":{const{toastId:n,toast:i}=t,r=i.duration??HI,s=Number.isFinite(r)?setTimeout(()=>ll({type:"DISMISS_TOAST",toastId:n}),r):null;Zs.set(n,{...i,timeout:s,otherProps:{open:!0,onOpenChange:o=>{o||ll({type:"DISMISS_TOAST",toastId:n})}}}),Zs.size>Mne&&ll({type:"DISMISS_TOAST",toastId:Ine()},!1);break}case"UPDATE_TOAST":{const{toastId:n,toast:i}=t,r=Zs.get(n);if(!r)return;if(typeof i.duration=="number"){r.timeout!==null&&clearTimeout(r.timeout);const s=i.duration??HI,o=Number.isFinite(s)?setTimeout(()=>ll({type:"DISMISS_TOAST",toastId:n}),s):null;Zs.set(n,{...r,...i,timeout:o})}else Zs.set(n,{...r,...i});break}case"DISMISS_TOAST":{const{toastId:n}=t,i=Zs.get(n);if(!i)return;i.timeout!==null&&clearTimeout(i.timeout),Zs.delete(n);break}default:{const n=t;throw new Error(`Unhandled action: ${n}`)}}if(e&&np.length>0){const n=Array.from(Zs.entries()).map(([i,r])=>({...r,id:i})).sort((i,r)=>r.id-i.id);for(const i of np)i(n)}}function bi(t){const e=Rne(),n=r=>ll({type:"UPDATE_TOAST",toastId:e,toast:{...r}}),i=()=>ll({type:"DISMISS_TOAST",toastId:e});return ll({type:"ADD_TOAST",toastId:e,toast:t}),{id:e,dismiss:i,update:n}}function Tne(){const[t,e]=x.useState([]);return x.useEffect(()=>(np.push(e),()=>{const n=np.indexOf(e);n>-1&&np.splice(n,1)}),[]),{toastList:t,toast:bi,dismiss:n=>ll({type:"DISMISS_TOAST",toastId:n})}}var AE={exports:{}},_d=typeof Reflect=="object"?Reflect:null,WI=_d&&typeof _d.apply=="function"?_d.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},lv;_d&&typeof _d.ownKeys=="function"?lv=_d.ownKeys:Object.getOwnPropertySymbols?lv=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:lv=function(e){return Object.getOwnPropertyNames(e)};function One(t){console&&console.warn&&console.warn(t)}var $6=Number.isNaN||function(e){return e!==e};function Vt(){Vt.init.call(this)}AE.exports=Vt;AE.exports.once=Bne;Vt.EventEmitter=Vt;Vt.prototype._events=void 0;Vt.prototype._eventsCount=0;Vt.prototype._maxListeners=void 0;var GI=10;function Kb(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Vt,"defaultMaxListeners",{enumerable:!0,get:function(){return GI},set:function(t){if(typeof t!="number"||t<0||$6(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");GI=t}});Vt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Vt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||$6(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function F6(t){return t._maxListeners===void 0?Vt.defaultMaxListeners:t._maxListeners}Vt.prototype.getMaxListeners=function(){return F6(this)};Vt.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")WI(l,this,n);else for(var c=l.length,u=W6(l,c),i=0;i<c;++i)WI(u[i],this,n);return!0};function z6(t,e,n,i){var r,s,o;if(Kb(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),r=F6(t),r>0&&o.length>r&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,One(a)}return t}Vt.prototype.addListener=function(e,n){return z6(this,e,n,!1)};Vt.prototype.on=Vt.prototype.addListener;Vt.prototype.prependListener=function(e,n){return z6(this,e,n,!0)};function Lne(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function U6(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=Lne.bind(i);return r.listener=n,i.wrapFn=r,r}Vt.prototype.once=function(e,n){return Kb(n),this.on(e,U6(this,e,n)),this};Vt.prototype.prependOnceListener=function(e,n){return Kb(n),this.prependListener(e,U6(this,e,n)),this};Vt.prototype.removeListener=function(e,n){var i,r,s,o,a;if(Kb(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===n||i[o].listener===n){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():Dne(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};Vt.prototype.off=Vt.prototype.removeListener;Vt.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(r=0;r<s.length;++r)o=s[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function V6(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?jne(r):W6(r,r.length)}Vt.prototype.listeners=function(e){return V6(this,e,!0)};Vt.prototype.rawListeners=function(e){return V6(this,e,!1)};Vt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):H6.call(t,e)};Vt.prototype.listenerCount=H6;function H6(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Vt.prototype.eventNames=function(){return this._eventsCount>0?lv(this._events):[]};function W6(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function Dne(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function jne(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function Bne(t,e){return new Promise(function(n,i){function r(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}G6(t,e,s,{once:!0}),e!=="error"&&$ne(t,r,{once:!0})})}function $ne(t,e,n){typeof t.on=="function"&&G6(t,"error",e,n)}function G6(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Fne=AE.exports;function Mo(t){if(typeof t!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=t}typeof Symbol<"u"&&(Mo.prototype[Symbol.iterator]=function(){return this});Mo.of=function(){var t=arguments,e=t.length,n=0;return new Mo(function(){return n>=e?{done:!0}:{done:!1,value:t[n++]}})};Mo.empty=function(){var t=new Mo(function(){return{done:!0}});return t};Mo.fromSequence=function(t){var e=0,n=t.length;return new Mo(function(){return e>=n?{done:!0}:{done:!1,value:t[e++]}})};Mo.is=function(t){return t instanceof Mo?!0:typeof t=="object"&&t!==null&&typeof t.next=="function"};var Yb=Mo;const hs=du(Yb);var Jb={};Jb.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";Jb.SYMBOL_SUPPORT=typeof Symbol<"u";var zne=Yb,X6=Jb,Une=X6.ARRAY_BUFFER_SUPPORT,Vne=X6.SYMBOL_SUPPORT;function Hne(t){return typeof t=="string"||Array.isArray(t)||Une&&ArrayBuffer.isView(t)?zne.fromSequence(t):typeof t!="object"||t===null?null:Vne&&typeof t[Symbol.iterator]=="function"?t[Symbol.iterator]():typeof t.next=="function"?t:null}var q6=function(e){var n=Hne(e);if(!n)throw new Error("obliterator: target is not iterable nor a valid iterator.");return n},Wne=q6,Gne=function(e,n){for(var i=arguments.length>1?n:1/0,r=i!==1/0?new Array(i):[],s,o=0,a=Wne(e);;){if(o===i)return r;if(s=a.next(),s.done)return o!==n&&(r.length=o),r;r[o++]=s.value}};const K6=du(Gne);var Xne=Yb,qne=q6,Kne=function(){var e=arguments,n=null,i=-1;return new Xne(function(){var s=null;do{if(n===null){if(i++,i>=e.length)return{done:!0};n=qne(e[i])}if(s=n.next(),s.done===!0){n=null;continue}break}while(!0);return s})};const ca=du(Kne);function Yne(){const t=arguments[0];for(let e=1,n=arguments.length;e<n;e++)if(arguments[e])for(const i in arguments[e])t[i]=arguments[e][i];return t}let $n=Yne;typeof Object.assign=="function"&&($n=Object.assign);function as(t,e,n,i){const r=t._nodes.get(e);let s=null;return r&&(i==="mixed"?s=r.out&&r.out[n]||r.undirected&&r.undirected[n]:i==="directed"?s=r.out&&r.out[n]:s=r.undirected&&r.undirected[n]),s}function ai(t){return typeof t=="object"&&t!==null}function Y6(t){let e;for(e in t)return!1;return!0}function Fr(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,writable:!0,value:n})}function gs(t,e,n){const i={enumerable:!0,configurable:!0};typeof n=="function"?i.get=n:(i.value=n,i.writable=!1),Object.defineProperty(t,e,i)}function XI(t){return!(!ai(t)||t.attributes&&!Array.isArray(t.attributes))}function Jne(){let t=Math.floor(Math.random()*256)&255;return()=>t++}class PE extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class _e extends PE{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,_e.prototype.constructor)}}class ye extends PE{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ye.prototype.constructor)}}class Ke extends PE{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ke.prototype.constructor)}}function J6(t,e){this.key=t,this.attributes=e,this.clear()}J6.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function Z6(t,e){this.key=t,this.attributes=e,this.clear()}Z6.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function Q6(t,e){this.key=t,this.attributes=e,this.clear()}Q6.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Af(t,e,n,i,r){this.key=e,this.attributes=r,this.undirected=t,this.source=n,this.target=i}Af.prototype.attach=function(){let t="out",e="in";this.undirected&&(t=e="undirected");const n=this.source.key,i=this.target.key;this.source[t][i]=this,!(this.undirected&&n===i)&&(this.target[e][n]=this)};Af.prototype.attachMulti=function(){let t="out",e="in";const n=this.source.key,i=this.target.key;this.undirected&&(t=e="undirected");const r=this.source[t],s=r[i];if(typeof s>"u"){r[i]=this,this.undirected&&n===i||(this.target[e][n]=this);return}s.previous=this,this.next=s,r[i]=this,this.target[e][n]=this};Af.prototype.detach=function(){const t=this.source.key,e=this.target.key;let n="out",i="in";this.undirected&&(n=i="undirected"),delete this.source[n][e],delete this.target[i][t]};Af.prototype.detachMulti=function(){const t=this.source.key,e=this.target.key;let n="out",i="in";this.undirected&&(n=i="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[n][e],delete this.target[i][t]):(this.next.previous=void 0,this.source[n][e]=this.next,this.target[i][t]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const eB=0,tB=1,Zne=2,nB=3;function _a(t,e,n,i,r,s,o){let a,l,c,u;if(i=""+i,n===eB){if(a=t._nodes.get(i),!a)throw new ye(`Graph.${e}: could not find the "${i}" node in the graph.`);c=r,u=s}else if(n===nB){if(r=""+r,l=t._edges.get(r),!l)throw new ye(`Graph.${e}: could not find the "${r}" edge in the graph.`);const d=l.source.key,f=l.target.key;if(i===d)a=l.target;else if(i===f)a=l.source;else throw new ye(`Graph.${e}: the "${i}" node is not attached to the "${r}" edge (${d}, ${f}).`);c=s,u=o}else{if(l=t._edges.get(i),!l)throw new ye(`Graph.${e}: could not find the "${i}" edge in the graph.`);n===tB?a=l.source:a=l.target,c=r,u=s}return[a,c,u]}function Qne(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=_a(this,e,n,i,r,s);return o.attributes[a]}}function eie(t,e,n){t.prototype[e]=function(i,r){const[s]=_a(this,e,n,i,r);return s.attributes}}function tie(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=_a(this,e,n,i,r,s);return o.attributes.hasOwnProperty(a)}}function nie(t,e,n){t.prototype[e]=function(i,r,s,o){const[a,l,c]=_a(this,e,n,i,r,s,o);return a.attributes[l]=c,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:l}),this}}function iie(t,e,n){t.prototype[e]=function(i,r,s,o){const[a,l,c]=_a(this,e,n,i,r,s,o);if(typeof c!="function")throw new _e(`Graph.${e}: updater should be a function.`);const u=a.attributes,d=c(u[l]);return u[l]=d,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:l}),this}}function rie(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=_a(this,e,n,i,r,s);return delete o.attributes[a],this.emit("nodeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:a}),this}}function sie(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=_a(this,e,n,i,r,s);if(!ai(a))throw new _e(`Graph.${e}: provided attributes are not a plain object.`);return o.attributes=a,this.emit("nodeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function oie(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=_a(this,e,n,i,r,s);if(!ai(a))throw new _e(`Graph.${e}: provided attributes are not a plain object.`);return $n(o.attributes,a),this.emit("nodeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:a}),this}}function aie(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=_a(this,e,n,i,r,s);if(typeof a!="function")throw new _e(`Graph.${e}: provided updater is not a function.`);return o.attributes=a(o.attributes),this.emit("nodeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const lie=[{name:t=>`get${t}Attribute`,attacher:Qne},{name:t=>`get${t}Attributes`,attacher:eie},{name:t=>`has${t}Attribute`,attacher:tie},{name:t=>`set${t}Attribute`,attacher:nie},{name:t=>`update${t}Attribute`,attacher:iie},{name:t=>`remove${t}Attribute`,attacher:rie},{name:t=>`replace${t}Attributes`,attacher:sie},{name:t=>`merge${t}Attributes`,attacher:oie},{name:t=>`update${t}Attributes`,attacher:aie}];function cie(t){lie.forEach(function({name:e,attacher:n}){n(t,e("Node"),eB),n(t,e("Source"),tB),n(t,e("Target"),Zne),n(t,e("Opposite"),nB)})}function uie(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ke(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ke(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=as(this,o,a,n),!s)throw new ye(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ke(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ye(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return s.attributes[r]}}function die(t,e,n){t.prototype[e]=function(i){let r;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ke(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new Ke(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+i,o=""+arguments[1];if(r=as(this,s,o,n),!r)throw new ye(`Graph.${e}: could not find an edge for the given path ("${s}" - "${o}").`)}else{if(n!=="mixed")throw new Ke(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,r=this._edges.get(i),!r)throw new ye(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return r.attributes}}function fie(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ke(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ke(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=as(this,o,a,n),!s)throw new ye(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ke(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ye(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return s.attributes.hasOwnProperty(r)}}function hie(t,e,n){t.prototype[e]=function(i,r,s){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ke(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Ke(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,l=""+r;if(r=arguments[2],s=arguments[3],o=as(this,a,l,n),!o)throw new ye(`Graph.${e}: could not find an edge for the given path ("${a}" - "${l}").`)}else{if(n!=="mixed")throw new Ke(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new ye(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return o.attributes[r]=s,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}function pie(t,e,n){t.prototype[e]=function(i,r,s){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ke(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Ke(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,l=""+r;if(r=arguments[2],s=arguments[3],o=as(this,a,l,n),!o)throw new ye(`Graph.${e}: could not find an edge for the given path ("${a}" - "${l}").`)}else{if(n!=="mixed")throw new Ke(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new ye(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(typeof s!="function")throw new _e(`Graph.${e}: updater should be a function.`);return o.attributes[r]=s(o.attributes[r]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}function mie(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ke(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ke(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=as(this,o,a,n),!s)throw new ye(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ke(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ye(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return delete s.attributes[r],this.emit("edgeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:r}),this}}function gie(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ke(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ke(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=as(this,o,a,n),!s)throw new ye(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ke(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ye(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(!ai(r))throw new _e(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=r,this.emit("edgeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function vie(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ke(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ke(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=as(this,o,a,n),!s)throw new ye(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ke(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ye(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(!ai(r))throw new _e(`Graph.${e}: provided attributes are not a plain object.`);return $n(s.attributes,r),this.emit("edgeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:r}),this}}function yie(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ke(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ke(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=as(this,o,a,n),!s)throw new ye(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ke(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ye(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(typeof r!="function")throw new _e(`Graph.${e}: provided updater is not a function.`);return s.attributes=r(s.attributes),this.emit("edgeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}const bie=[{name:t=>`get${t}Attribute`,attacher:uie},{name:t=>`get${t}Attributes`,attacher:die},{name:t=>`has${t}Attribute`,attacher:fie},{name:t=>`set${t}Attribute`,attacher:hie},{name:t=>`update${t}Attribute`,attacher:pie},{name:t=>`remove${t}Attribute`,attacher:mie},{name:t=>`replace${t}Attributes`,attacher:gie},{name:t=>`merge${t}Attributes`,attacher:vie},{name:t=>`update${t}Attributes`,attacher:yie}];function xie(t){bie.forEach(function({name:e,attacher:n}){n(t,e("Edge"),"mixed"),n(t,e("DirectedEdge"),"directed"),n(t,e("UndirectedEdge"),"undirected")})}const wie=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Sie(t,e,n,i){let r=!1;for(const s in e){if(s===i)continue;const o=e[s];if(r=n(o.key,o.attributes,o.source.key,o.target.key,o.source.attributes,o.target.attributes,o.undirected),t&&r)return o.key}}function kie(t,e,n,i){let r,s,o,a=!1;for(const l in e)if(l!==i){r=e[l];do{if(s=r.source,o=r.target,a=n(r.key,r.attributes,s.key,o.key,s.attributes,o.attributes,r.undirected),t&&a)return r.key;r=r.next}while(r!==void 0)}}function sw(t,e){const n=Object.keys(t),i=n.length;let r,s=0;return new hs(function(){do if(r)r=r.next;else{if(s>=i)return{done:!0};const a=n[s++];if(a===e){r=void 0;continue}r=t[a]}while(!r);return{done:!1,value:{edge:r.key,attributes:r.attributes,source:r.source.key,target:r.target.key,sourceAttributes:r.source.attributes,targetAttributes:r.target.attributes,undirected:r.undirected}}})}function Cie(t,e,n,i){const r=e[n];if(!r)return;const s=r.source,o=r.target;if(i(r.key,r.attributes,s.key,o.key,s.attributes,o.attributes,r.undirected)&&t)return r.key}function _ie(t,e,n,i){let r=e[n];if(!r)return;let s=!1;do{if(s=i(r.key,r.attributes,r.source.key,r.target.key,r.source.attributes,r.target.attributes,r.undirected),t&&s)return r.key;r=r.next}while(r!==void 0)}function ow(t,e){let n=t[e];return n.next!==void 0?new hs(function(){if(!n)return{done:!0};const i={edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected};return n=n.next,{done:!1,value:i}}):hs.of({edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected})}function Eie(t,e){if(t.size===0)return[];if(e==="mixed"||e===t.type)return typeof Array.from=="function"?Array.from(t._edges.keys()):K6(t._edges.keys(),t._edges.size);const n=e==="undirected"?t.undirectedSize:t.directedSize,i=new Array(n),r=e==="undirected",s=t._edges.values();let o=0,a,l;for(;a=s.next(),a.done!==!0;)l=a.value,l.undirected===r&&(i[o++]=l.key);return i}function iB(t,e,n,i){if(e.size===0)return;const r=n!=="mixed"&&n!==e.type,s=n==="undirected";let o,a,l=!1;const c=e._edges.values();for(;o=c.next(),o.done!==!0;){if(a=o.value,r&&a.undirected!==s)continue;const{key:u,attributes:d,source:f,target:p}=a;if(l=i(u,d,f.key,p.key,f.attributes,p.attributes,a.undirected),t&&l)return u}}function Aie(t,e){if(t.size===0)return hs.empty();const n=e!=="mixed"&&e!==t.type,i=e==="undirected",r=t._edges.values();return new hs(function(){let o,a;for(;;){if(o=r.next(),o.done)return o;if(a=o.value,!(n&&a.undirected!==i))break}return{value:{edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected},done:!1}})}function NE(t,e,n,i,r,s){const o=e?kie:Sie;let a;if(n!=="undirected"&&(i!=="out"&&(a=o(t,r.in,s),t&&a)||i!=="in"&&(a=o(t,r.out,s,i?void 0:r.key),t&&a))||n!=="directed"&&(a=o(t,r.undirected,s),t&&a))return a}function Pie(t,e,n,i){const r=[];return NE(!1,t,e,n,i,function(s){r.push(s)}),r}function Nie(t,e,n){let i=hs.empty();return t!=="undirected"&&(e!=="out"&&typeof n.in<"u"&&(i=ca(i,sw(n.in))),e!=="in"&&typeof n.out<"u"&&(i=ca(i,sw(n.out,e?void 0:n.key)))),t!=="directed"&&typeof n.undirected<"u"&&(i=ca(i,sw(n.undirected))),i}function ME(t,e,n,i,r,s,o){const a=n?_ie:Cie;let l;if(e!=="undirected"&&(typeof r.in<"u"&&i!=="out"&&(l=a(t,r.in,s,o),t&&l)||typeof r.out<"u"&&i!=="in"&&(i||r.key!==s)&&(l=a(t,r.out,s,o),t&&l))||e!=="directed"&&typeof r.undirected<"u"&&(l=a(t,r.undirected,s,o),t&&l))return l}function Mie(t,e,n,i,r){const s=[];return ME(!1,t,e,n,i,r,function(o){s.push(o)}),s}function Rie(t,e,n,i){let r=hs.empty();return t!=="undirected"&&(typeof n.in<"u"&&e!=="out"&&i in n.in&&(r=ca(r,ow(n.in,i))),typeof n.out<"u"&&e!=="in"&&i in n.out&&(e||n.key!==i)&&(r=ca(r,ow(n.out,i)))),t!=="directed"&&typeof n.undirected<"u"&&i in n.undirected&&(r=ca(r,ow(n.undirected,i))),r}function Iie(t,e){const{name:n,type:i,direction:r}=e;t.prototype[n]=function(s,o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];if(!arguments.length)return Eie(this,i);if(arguments.length===1){s=""+s;const a=this._nodes.get(s);if(typeof a>"u")throw new ye(`Graph.${n}: could not find the "${s}" node in the graph.`);return Pie(this.multi,i==="mixed"?this.type:i,r,a)}if(arguments.length===2){s=""+s,o=""+o;const a=this._nodes.get(s);if(!a)throw new ye(`Graph.${n}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(o))throw new ye(`Graph.${n}:  could not find the "${o}" target node in the graph.`);return Mie(i,this.multi,r,a,o)}throw new _e(`Graph.${n}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Tie(t,e){const{name:n,type:i,direction:r}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(c,u,d){if(!(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)){if(arguments.length===1)return d=c,iB(!1,this,i,d);if(arguments.length===2){c=""+c,d=u;const f=this._nodes.get(c);if(typeof f>"u")throw new ye(`Graph.${s}: could not find the "${c}" node in the graph.`);return NE(!1,this.multi,i==="mixed"?this.type:i,r,f,d)}if(arguments.length===3){c=""+c,u=""+u;const f=this._nodes.get(c);if(!f)throw new ye(`Graph.${s}:  could not find the "${c}" source node in the graph.`);if(!this._nodes.has(u))throw new ye(`Graph.${s}:  could not find the "${u}" target node in the graph.`);return ME(!1,i,this.multi,r,f,u,d)}throw new _e(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(){const c=Array.prototype.slice.call(arguments),u=c.pop();let d;if(c.length===0){let f=0;i!=="directed"&&(f+=this.undirectedSize),i!=="undirected"&&(f+=this.directedSize),d=new Array(f);let p=0;c.push((m,g,y,v,b,w,k)=>{d[p++]=u(m,g,y,v,b,w,k)})}else d=[],c.push((f,p,m,g,y,v,b)=>{d.push(u(f,p,m,g,y,v,b))});return this[s].apply(this,c),d};const a="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(){const c=Array.prototype.slice.call(arguments),u=c.pop(),d=[];return c.push((f,p,m,g,y,v,b)=>{u(f,p,m,g,y,v,b)&&d.push(f)}),this[s].apply(this,c),d};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(){let c=Array.prototype.slice.call(arguments);if(c.length<2||c.length>4)throw new _e(`Graph.${l}: invalid number of arguments (expecting 2, 3 or 4 and got ${c.length}).`);if(typeof c[c.length-1]=="function"&&typeof c[c.length-2]!="function")throw new _e(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let u,d;c.length===2?(u=c[0],d=c[1],c=[]):c.length===3?(u=c[1],d=c[2],c=[c[0]]):c.length===4&&(u=c[2],d=c[3],c=[c[0],c[1]]);let f=d;return c.push((p,m,g,y,v,b,w)=>{f=u(f,p,m,g,y,v,b,w)}),this[s].apply(this,c),f}}function Oie(t,e){const{name:n,type:i,direction:r}=e,s="find"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(l,c,u){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return!1;if(arguments.length===1)return u=l,iB(!0,this,i,u);if(arguments.length===2){l=""+l,u=c;const d=this._nodes.get(l);if(typeof d>"u")throw new ye(`Graph.${s}: could not find the "${l}" node in the graph.`);return NE(!0,this.multi,i==="mixed"?this.type:i,r,d,u)}if(arguments.length===3){l=""+l,c=""+c;const d=this._nodes.get(l);if(!d)throw new ye(`Graph.${s}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(c))throw new ye(`Graph.${s}:  could not find the "${c}" target node in the graph.`);return ME(!0,i,this.multi,r,d,c,u)}throw new _e(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const o="some"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[o]=function(){const l=Array.prototype.slice.call(arguments),c=l.pop();return l.push((d,f,p,m,g,y,v)=>c(d,f,p,m,g,y,v)),!!this[s].apply(this,l)};const a="every"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[a]=function(){const l=Array.prototype.slice.call(arguments),c=l.pop();return l.push((d,f,p,m,g,y,v)=>!c(d,f,p,m,g,y,v)),!this[s].apply(this,l)}}function Lie(t,e){const{name:n,type:i,direction:r}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(o,a){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return hs.empty();if(!arguments.length)return Aie(this,i);if(arguments.length===1){o=""+o;const l=this._nodes.get(o);if(!l)throw new ye(`Graph.${s}: could not find the "${o}" node in the graph.`);return Nie(i,r,l)}if(arguments.length===2){o=""+o,a=""+a;const l=this._nodes.get(o);if(!l)throw new ye(`Graph.${s}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new ye(`Graph.${s}:  could not find the "${a}" target node in the graph.`);return Rie(i,r,l,a)}throw new _e(`Graph.${s}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Die(t){wie.forEach(e=>{Iie(t,e),Tie(t,e),Oie(t,e),Lie(t,e)})}const jie=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Zb(){this.A=null,this.B=null}Zb.prototype.wrap=function(t){this.A===null?this.A=t:this.B===null&&(this.B=t)};Zb.prototype.has=function(t){return this.A!==null&&t in this.A||this.B!==null&&t in this.B};function eh(t,e,n,i,r){for(const s in i){const o=i[s],a=o.source,l=o.target,c=a===n?l:a;if(e&&e.has(c.key))continue;const u=r(c.key,c.attributes);if(t&&u)return c.key}}function RE(t,e,n,i,r){if(e!=="mixed"){if(e==="undirected")return eh(t,null,i,i.undirected,r);if(typeof n=="string")return eh(t,null,i,i[n],r)}const s=new Zb;let o;if(e!=="undirected"){if(n!=="out"){if(o=eh(t,null,i,i.in,r),t&&o)return o;s.wrap(i.in)}if(n!=="in"){if(o=eh(t,s,i,i.out,r),t&&o)return o;s.wrap(i.out)}}if(e!=="directed"&&(o=eh(t,s,i,i.undirected,r),t&&o))return o}function Bie(t,e,n){if(t!=="mixed"){if(t==="undirected")return Object.keys(n.undirected);if(typeof e=="string")return Object.keys(n[e])}const i=[];return RE(!1,t,e,n,function(r){i.push(r)}),i}function th(t,e,n){const i=Object.keys(n),r=i.length;let s=0;return new hs(function(){let a=null;do{if(s>=r)return t&&t.wrap(n),{done:!0};const l=n[i[s++]],c=l.source,u=l.target;if(a=c===e?u:c,t&&t.has(a.key)){a=null;continue}}while(a===null);return{done:!1,value:{neighbor:a.key,attributes:a.attributes}}})}function $ie(t,e,n){if(t!=="mixed"){if(t==="undirected")return th(null,n,n.undirected);if(typeof e=="string")return th(null,n,n[e])}let i=hs.empty();const r=new Zb;return t!=="undirected"&&(e!=="out"&&(i=ca(i,th(r,n,n.in))),e!=="in"&&(i=ca(i,th(r,n,n.out)))),t!=="directed"&&(i=ca(i,th(r,n,n.undirected))),i}function Fie(t,e){const{name:n,type:i,direction:r}=e;t.prototype[n]=function(s){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];s=""+s;const o=this._nodes.get(s);if(typeof o>"u")throw new ye(`Graph.${n}: could not find the "${s}" node in the graph.`);return Bie(i==="mixed"?this.type:i,r,o)}}function zie(t,e){const{name:n,type:i,direction:r}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(c,u){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;c=""+c;const d=this._nodes.get(c);if(typeof d>"u")throw new ye(`Graph.${s}: could not find the "${c}" node in the graph.`);RE(!1,i==="mixed"?this.type:i,r,d,u)};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(c,u){const d=[];return this[s](c,(f,p)=>{d.push(u(f,p))}),d};const a="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(c,u){const d=[];return this[s](c,(f,p)=>{u(f,p)&&d.push(f)}),d};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(c,u,d){if(arguments.length<3)throw new _e(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let f=d;return this[s](c,(p,m)=>{f=u(f,p,m)}),f}}function Uie(t,e){const{name:n,type:i,direction:r}=e,s=n[0].toUpperCase()+n.slice(1,-1),o="find"+s;t.prototype[o]=function(c,u){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;c=""+c;const d=this._nodes.get(c);if(typeof d>"u")throw new ye(`Graph.${o}: could not find the "${c}" node in the graph.`);return RE(!0,i==="mixed"?this.type:i,r,d,u)};const a="some"+s;t.prototype[a]=function(c,u){return!!this[o](c,u)};const l="every"+s;t.prototype[l]=function(c,u){return!this[o](c,(f,p)=>!u(f,p))}}function Vie(t,e){const{name:n,type:i,direction:r}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return hs.empty();o=""+o;const a=this._nodes.get(o);if(typeof a>"u")throw new ye(`Graph.${s}: could not find the "${o}" node in the graph.`);return $ie(i==="mixed"?this.type:i,r,a)}}function Hie(t){jie.forEach(e=>{Fie(t,e),zie(t,e),Uie(t,e),Vie(t,e)})}function qg(t,e,n,i,r){const s=i._nodes.values(),o=i.type;let a,l,c,u,d,f;for(;a=s.next(),a.done!==!0;){let p=!1;if(l=a.value,o!=="undirected"){u=l.out;for(c in u){d=u[c];do f=d.target,p=!0,r(l.key,f.key,l.attributes,f.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}if(o!=="directed"){u=l.undirected;for(c in u)if(!(e&&l.key>c)){d=u[c];do f=d.target,f.key!==c&&(f=d.source),p=!0,r(l.key,f.key,l.attributes,f.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}n&&!p&&r(l.key,null,l.attributes,null,null,null,null)}}function Wie(t,e){const n={key:t};return Y6(e.attributes)||(n.attributes=$n({},e.attributes)),n}function Gie(t,e,n){const i={key:e,source:n.source.key,target:n.target.key};return Y6(n.attributes)||(i.attributes=$n({},n.attributes)),t==="mixed"&&n.undirected&&(i.undirected=!0),i}function Xie(t){if(!ai(t))throw new _e('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in t))throw new _e("Graph.import: serialized node is missing its key.");if("attributes"in t&&(!ai(t.attributes)||t.attributes===null))throw new _e("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function qie(t){if(!ai(t))throw new _e('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in t))throw new _e("Graph.import: serialized edge is missing its source.");if(!("target"in t))throw new _e("Graph.import: serialized edge is missing its target.");if("attributes"in t&&(!ai(t.attributes)||t.attributes===null))throw new _e("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in t&&typeof t.undirected!="boolean")throw new _e("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const Kie=Jne(),Yie=new Set(["directed","undirected","mixed"]),qI=new Set(["domain","_events","_eventsCount","_maxListeners"]),Jie=[{name:t=>`${t}Edge`,generateKey:!0},{name:t=>`${t}DirectedEdge`,generateKey:!0,type:"directed"},{name:t=>`${t}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:t=>`${t}EdgeWithKey`},{name:t=>`${t}DirectedEdgeWithKey`,type:"directed"},{name:t=>`${t}UndirectedEdgeWithKey`,type:"undirected"}],Zie={allowSelfLoops:!0,multi:!1,type:"mixed"};function Qie(t,e,n){if(n&&!ai(n))throw new _e(`Graph.addNode: invalid attributes. Expecting an object but got "${n}"`);if(e=""+e,n=n||{},t._nodes.has(e))throw new Ke(`Graph.addNode: the "${e}" node already exist in the graph.`);const i=new t.NodeDataClass(e,n);return t._nodes.set(e,i),t.emit("nodeAdded",{key:e,attributes:n}),i}function KI(t,e,n){const i=new t.NodeDataClass(e,n);return t._nodes.set(e,i),t.emit("nodeAdded",{key:e,attributes:n}),i}function rB(t,e,n,i,r,s,o,a){if(!i&&t.type==="undirected")throw new Ke(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(i&&t.type==="directed")throw new Ke(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(a&&!ai(a))throw new _e(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`);if(s=""+s,o=""+o,a=a||{},!t.allowSelfLoops&&s===o)throw new Ke(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const l=t._nodes.get(s),c=t._nodes.get(o);if(!l)throw new ye(`Graph.${e}: source node "${s}" not found.`);if(!c)throw new ye(`Graph.${e}: target node "${o}" not found.`);const u={key:null,undirected:i,source:s,target:o,attributes:a};if(n)r=t._edgeKeyGenerator();else if(r=""+r,t._edges.has(r))throw new Ke(`Graph.${e}: the "${r}" edge already exists in the graph.`);if(!t.multi&&(i?typeof l.undirected[o]<"u":typeof l.out[o]<"u"))throw new Ke(`Graph.${e}: an edge linking "${s}" to "${o}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const d=new Af(i,r,l,c,a);t._edges.set(r,d);const f=s===o;return i?(l.undirectedDegree++,c.undirectedDegree++,f&&(l.undirectedLoops++,t._undirectedSelfLoopCount++)):(l.outDegree++,c.inDegree++,f&&(l.directedLoops++,t._directedSelfLoopCount++)),t.multi?d.attachMulti():d.attach(),i?t._undirectedSize++:t._directedSize++,u.key=r,t.emit("edgeAdded",u),r}function ere(t,e,n,i,r,s,o,a,l){if(!i&&t.type==="undirected")throw new Ke(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(i&&t.type==="directed")throw new Ke(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(a){if(l){if(typeof a!="function")throw new _e(`Graph.${e}: invalid updater function. Expecting a function but got "${a}"`)}else if(!ai(a))throw new _e(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`)}s=""+s,o=""+o;let c;if(l&&(c=a,a=void 0),!t.allowSelfLoops&&s===o)throw new Ke(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let u=t._nodes.get(s),d=t._nodes.get(o),f,p;if(!n&&(f=t._edges.get(r),f)){if((f.source.key!==s||f.target.key!==o)&&(!i||f.source.key!==o||f.target.key!==s))throw new Ke(`Graph.${e}: inconsistency detected when attempting to merge the "${r}" edge with "${s}" source & "${o}" target vs. ("${f.source.key}", "${f.target.key}").`);p=f}if(!p&&!t.multi&&u&&(p=i?u.undirected[o]:u.out[o]),p){const b=[p.key,!1,!1,!1];if(l?!c:!a)return b;if(l){const w=p.attributes;p.attributes=c(w),t.emit("edgeAttributesUpdated",{type:"replace",key:p.key,attributes:p.attributes})}else $n(p.attributes,a),t.emit("edgeAttributesUpdated",{type:"merge",key:p.key,attributes:p.attributes,data:a});return b}a=a||{},l&&c&&(a=c(a));const m={key:null,undirected:i,source:s,target:o,attributes:a};if(n)r=t._edgeKeyGenerator();else if(r=""+r,t._edges.has(r))throw new Ke(`Graph.${e}: the "${r}" edge already exists in the graph.`);let g=!1,y=!1;u||(u=KI(t,s,{}),g=!0,s===o&&(d=u,y=!0)),d||(d=KI(t,o,{}),y=!0),f=new Af(i,r,u,d,a),t._edges.set(r,f);const v=s===o;return i?(u.undirectedDegree++,d.undirectedDegree++,v&&(u.undirectedLoops++,t._undirectedSelfLoopCount++)):(u.outDegree++,d.inDegree++,v&&(u.directedLoops++,t._directedSelfLoopCount++)),t.multi?f.attachMulti():f.attach(),i?t._undirectedSize++:t._directedSize++,m.key=r,t.emit("edgeAdded",m),[r,!0,g,y]}function Cu(t,e){t._edges.delete(e.key);const{source:n,target:i,attributes:r}=e,s=e.undirected,o=n===i;s?(n.undirectedDegree--,i.undirectedDegree--,o&&(n.undirectedLoops--,t._undirectedSelfLoopCount--)):(n.outDegree--,i.inDegree--,o&&(n.directedLoops--,t._directedSelfLoopCount--)),t.multi?e.detachMulti():e.detach(),s?t._undirectedSize--:t._directedSize--,t.emit("edgeDropped",{key:e.key,attributes:r,source:n.key,target:i.key,undirected:s})}class Xt extends Fne.EventEmitter{constructor(e){if(super(),e=$n({},Zie,e),typeof e.multi!="boolean")throw new _e(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!Yie.has(e.type))throw new _e(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new _e(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const n=e.type==="mixed"?J6:e.type==="directed"?Z6:Q6;Fr(this,"NodeDataClass",n);const i="geid_"+Kie()+"_";let r=0;const s=()=>{let o;do o=i+r++;while(this._edges.has(o));return o};Fr(this,"_attributes",{}),Fr(this,"_nodes",new Map),Fr(this,"_edges",new Map),Fr(this,"_directedSize",0),Fr(this,"_undirectedSize",0),Fr(this,"_directedSelfLoopCount",0),Fr(this,"_undirectedSelfLoopCount",0),Fr(this,"_edgeKeyGenerator",s),Fr(this,"_options",e),qI.forEach(o=>Fr(this,o,this[o])),gs(this,"order",()=>this._nodes.size),gs(this,"size",()=>this._edges.size),gs(this,"directedSize",()=>this._directedSize),gs(this,"undirectedSize",()=>this._undirectedSize),gs(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),gs(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),gs(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),gs(this,"multi",this._options.multi),gs(this,"type",this._options.type),gs(this,"allowSelfLoops",this._options.allowSelfLoops),gs(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,n){if(this.type==="undirected")return!1;if(arguments.length===1){const i=""+e,r=this._edges.get(i);return!!r&&!r.undirected}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?i.out.hasOwnProperty(n):!1}throw new _e(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,n){if(this.type==="directed")return!1;if(arguments.length===1){const i=""+e,r=this._edges.get(i);return!!r&&r.undirected}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?i.undirected.hasOwnProperty(n):!1}throw new _e(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,n){if(arguments.length===1){const i=""+e;return this._edges.has(i)}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?typeof i.out<"u"&&i.out.hasOwnProperty(n)||typeof i.undirected<"u"&&i.undirected.hasOwnProperty(n):!1}throw new _e(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,n){if(this.type==="undirected")return;if(e=""+e,n=""+n,this.multi)throw new Ke("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const i=this._nodes.get(e);if(!i)throw new ye(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ye(`Graph.directedEdge: could not find the "${n}" target node in the graph.`);const r=i.out&&i.out[n]||void 0;if(r)return r.key}undirectedEdge(e,n){if(this.type==="directed")return;if(e=""+e,n=""+n,this.multi)throw new Ke("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const i=this._nodes.get(e);if(!i)throw new ye(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ye(`Graph.undirectedEdge: could not find the "${n}" target node in the graph.`);const r=i.undirected&&i.undirected[n]||void 0;if(r)return r.key}edge(e,n){if(this.multi)throw new Ke("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ye(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ye(`Graph.edge: could not find the "${n}" target node in the graph.`);const r=i.out&&i.out[n]||i.undirected&&i.undirected[n]||void 0;if(r)return r.key}areDirectedNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ye(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.in||n in i.out}areOutNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ye(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.out}areInNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ye(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.in}areUndirectedNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ye(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:n in i.undirected}areNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ye(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(n in i.in||n in i.out)||this.type!=="directed"&&n in i.undirected}areInboundNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ye(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in i.in||this.type!=="directed"&&n in i.undirected}areOutboundNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ye(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in i.out||this.type!=="directed"&&n in i.undirected}inDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree}outDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree}directedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree}undirectedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree}inboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.inDegree),i}outboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.outDegree),i}degree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.degree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.inDegree+n.outDegree),i}inDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree-n.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree-n.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree-n.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree-n.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.inDegree,r+=n.directedLoops),i-r}outboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.outDegree,r+=n.directedLoops),i-r}degreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.inDegree+n.outDegree,r+=n.directedLoops*2),i-r}source(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ye(`Graph.source: could not find the "${e}" edge in the graph.`);return n.source.key}target(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ye(`Graph.target: could not find the "${e}" edge in the graph.`);return n.target.key}extremities(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ye(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[n.source.key,n.target.key]}opposite(e,n){e=""+e,n=""+n;const i=this._edges.get(n);if(!i)throw new ye(`Graph.opposite: could not find the "${n}" edge in the graph.`);const r=i.source.key,s=i.target.key;if(e===r)return s;if(e===s)return r;throw new ye(`Graph.opposite: the "${e}" node is not attached to the "${n}" edge (${r}, ${s}).`)}hasExtremity(e,n){e=""+e,n=""+n;const i=this._edges.get(e);if(!i)throw new ye(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return i.source.key===n||i.target.key===n}isUndirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ye(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return n.undirected}isDirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ye(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!n.undirected}isSelfLoop(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ye(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return n.source===n.target}addNode(e,n){return Qie(this,e,n).key}mergeNode(e,n){if(n&&!ai(n))throw new _e(`Graph.mergeNode: invalid attributes. Expecting an object but got "${n}"`);e=""+e,n=n||{};let i=this._nodes.get(e);return i?(n&&($n(i.attributes,n),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:i.attributes,data:n})),[e,!1]):(i=new this.NodeDataClass(e,n),this._nodes.set(e,i),this.emit("nodeAdded",{key:e,attributes:n}),[e,!0])}updateNode(e,n){if(n&&typeof n!="function")throw new _e(`Graph.updateNode: invalid updater function. Expecting a function but got "${n}"`);e=""+e;let i=this._nodes.get(e);if(i){if(n){const s=i.attributes;i.attributes=n(s),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:i.attributes})}return[e,!1]}const r=n?n({}):{};return i=new this.NodeDataClass(e,r),this._nodes.set(e,i),this.emit("nodeAdded",{key:e,attributes:r}),[e,!0]}dropNode(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ye(`Graph.dropNode: could not find the "${e}" node in the graph.`);let i;if(this.type!=="undirected"){for(const r in n.out){i=n.out[r];do Cu(this,i),i=i.next;while(i)}for(const r in n.in){i=n.in[r];do Cu(this,i),i=i.next;while(i)}}if(this.type!=="directed")for(const r in n.undirected){i=n.undirected[r];do Cu(this,i),i=i.next;while(i)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:n.attributes})}dropEdge(e){let n;if(arguments.length>1){const i=""+arguments[0],r=""+arguments[1];if(n=as(this,i,r,this.type),!n)throw new ye(`Graph.dropEdge: could not find the "${i}" -> "${r}" edge in the graph.`)}else if(e=""+e,n=this._edges.get(e),!n)throw new ye(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return Cu(this,n),this}dropDirectedEdge(e,n){if(arguments.length<2)throw new Ke("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Ke("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,n=""+n;const i=as(this,e,n,"directed");if(!i)throw new ye(`Graph.dropDirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return Cu(this,i),this}dropUndirectedEdge(e,n){if(arguments.length<2)throw new Ke("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Ke("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const i=as(this,e,n,"undirected");if(!i)throw new ye(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return Cu(this,i),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let n;for(;n=e.next(),n.done!==!0;)n.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,n){return this._attributes[e]=n,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,n){if(typeof n!="function")throw new _e("Graph.updateAttribute: updater should be a function.");const i=this._attributes[e];return this._attributes[e]=n(i),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!ai(e))throw new _e("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!ai(e))throw new _e("Graph.mergeAttributes: provided attributes are not a plain object.");return $n(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new _e("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,n){if(typeof e!="function")throw new _e("Graph.updateEachNodeAttributes: expecting an updater function.");if(n&&!XI(n))throw new _e("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._nodes.values();let r,s;for(;r=i.next(),r.done!==!0;)s=r.value,s.attributes=e(s.key,s.attributes);this.emit("eachNodeAttributesUpdated",{hints:n||null})}updateEachEdgeAttributes(e,n){if(typeof e!="function")throw new _e("Graph.updateEachEdgeAttributes: expecting an updater function.");if(n&&!XI(n))throw new _e("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._edges.values();let r,s,o,a;for(;r=i.next(),r.done!==!0;)s=r.value,o=s.source,a=s.target,s.attributes=e(s.key,s.attributes,o.key,a.key,o.attributes,a.attributes,s.undirected);this.emit("eachEdgeAttributesUpdated",{hints:n||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new _e("Graph.forEachAdjacencyEntry: expecting a callback.");qg(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new _e("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");qg(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new _e("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");qg(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new _e("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");qg(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):K6(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new _e("Graph.forEachNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)r=i.value,e(r.key,r.attributes)}findNode(e){if(typeof e!="function")throw new _e("Graph.findNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,e(r.key,r.attributes))return r.key}mapNodes(e){if(typeof e!="function")throw new _e("Graph.mapNode: expecting a callback.");const n=this._nodes.values();let i,r;const s=new Array(this.order);let o=0;for(;i=n.next(),i.done!==!0;)r=i.value,s[o++]=e(r.key,r.attributes);return s}someNode(e){if(typeof e!="function")throw new _e("Graph.someNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,e(r.key,r.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new _e("Graph.everyNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,!e(r.key,r.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new _e("Graph.filterNodes: expecting a callback.");const n=this._nodes.values();let i,r;const s=[];for(;i=n.next(),i.done!==!0;)r=i.value,e(r.key,r.attributes)&&s.push(r.key);return s}reduceNodes(e,n){if(typeof e!="function")throw new _e("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new _e("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let i=n;const r=this._nodes.values();let s,o;for(;s=r.next(),s.done!==!0;)o=s.value,i=e(i,o.key,o.attributes);return i}nodeEntries(){const e=this._nodes.values();return new hs(()=>{const n=e.next();if(n.done)return n;const i=n.value;return{value:{node:i.key,attributes:i.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let n=0;this._nodes.forEach((r,s)=>{e[n++]=Wie(s,r)});const i=new Array(this._edges.size);return n=0,this._edges.forEach((r,s)=>{i[n++]=Gie(this.type,s,r)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:i}}import(e,n=!1){if(e instanceof Xt)return e.forEachNode((l,c)=>{n?this.mergeNode(l,c):this.addNode(l,c)}),e.forEachEdge((l,c,u,d,f,p,m)=>{n?m?this.mergeUndirectedEdgeWithKey(l,u,d,c):this.mergeDirectedEdgeWithKey(l,u,d,c):m?this.addUndirectedEdgeWithKey(l,u,d,c):this.addDirectedEdgeWithKey(l,u,d,c)}),this;if(!ai(e))throw new _e("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!ai(e.attributes))throw new _e("Graph.import: invalid attributes. Expecting a plain object.");n?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let i,r,s,o,a;if(e.nodes){if(s=e.nodes,!Array.isArray(s))throw new _e("Graph.import: invalid nodes. Expecting an array.");for(i=0,r=s.length;i<r;i++){o=s[i],Xie(o);const{key:l,attributes:c}=o;n?this.mergeNode(l,c):this.addNode(l,c)}}if(e.edges){let l=!1;if(this.type==="undirected"&&(l=!0),s=e.edges,!Array.isArray(s))throw new _e("Graph.import: invalid edges. Expecting an array.");for(i=0,r=s.length;i<r;i++){a=s[i],qie(a);const{source:c,target:u,attributes:d,undirected:f=l}=a;let p;"key"in a?(p=n?f?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:f?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,p.call(this,a.key,c,u,d)):(p=n?f?this.mergeUndirectedEdge:this.mergeDirectedEdge:f?this.addUndirectedEdge:this.addDirectedEdge,p.call(this,c,u,d))}}return this}nullCopy(e){const n=new Xt($n({},this._options,e));return n.replaceAttributes($n({},this.getAttributes())),n}emptyCopy(e){const n=this.nullCopy(e);return this._nodes.forEach((i,r)=>{const s=$n({},i.attributes);i=new n.NodeDataClass(r,s),n._nodes.set(r,i)}),n}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new Ke(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new Ke("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new Ke("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const n=this.emptyCopy(e),i=this._edges.values();let r,s;for(;r=i.next(),r.done!==!0;)s=r.value,rB(n,"copy",!1,s.undirected,s.key,s.source.key,s.target.key,$n({},s.attributes));return n}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((s,o)=>{e[o]=s.attributes});const n={},i={};this._edges.forEach((s,o)=>{const a=s.undirected?"--":"->";let l="",c=s.source.key,u=s.target.key,d;s.undirected&&c>u&&(d=c,c=u,u=d);const f=`(${c})${a}(${u})`;o.startsWith("geid_")?this.multi&&(typeof i[f]>"u"?i[f]=0:i[f]++,l+=`${i[f]}. `):l+=`[${o}]: `,l+=f,n[l]=s.attributes});const r={};for(const s in this)this.hasOwnProperty(s)&&!qI.has(s)&&typeof this[s]!="function"&&typeof s!="symbol"&&(r[s]=this[s]);return r.attributes=this._attributes,r.nodes=e,r.edges=n,Fr(r,"constructor",this.constructor),r}}typeof Symbol<"u"&&(Xt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Xt.prototype.inspect);Jie.forEach(t=>{["add","merge","update"].forEach(e=>{const n=t.name(e),i=e==="add"?rB:ere;t.generateKey?Xt.prototype[n]=function(r,s,o){return i(this,n,!0,(t.type||this.type)==="undirected",null,r,s,o,e==="update")}:Xt.prototype[n]=function(r,s,o,a){return i(this,n,!1,(t.type||this.type)==="undirected",r,s,o,a,e==="update")}})});cie(Xt);xie(Xt);Die(Xt);Hie(Xt);class sB extends Xt{constructor(e){const n=$n({type:"directed"},e);if("multi"in n&&n.multi!==!1)throw new _e("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="directed")throw new _e('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class IE extends Xt{constructor(e){const n=$n({type:"undirected"},e);if("multi"in n&&n.multi!==!1)throw new _e("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="undirected")throw new _e('UndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class oB extends Xt{constructor(e){const n=$n({multi:!0},e);if("multi"in n&&n.multi!==!0)throw new _e("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(n)}}class aB extends Xt{constructor(e){const n=$n({type:"directed",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new _e("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="directed")throw new _e('MultiDirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class lB extends Xt{constructor(e){const n=$n({type:"undirected",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new _e("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="undirected")throw new _e('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}function Pf(t){t.from=function(e,n){const i=$n({},e.options,n),r=new t(i);return r.import(e),r}}Pf(Xt);Pf(sB);Pf(IE);Pf(oB);Pf(aB);Pf(lB);Xt.Graph=Xt;Xt.DirectedGraph=sB;Xt.UndirectedGraph=IE;Xt.MultiGraph=oB;Xt.MultiDirectedGraph=aB;Xt.MultiUndirectedGraph=lB;Xt.InvalidArgumentsGraphError=_e;Xt.NotFoundGraphError=ye;Xt.UsageGraphError=Ke;var tre=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"},cB=Jb,nre=cB.ARRAY_BUFFER_SUPPORT,ire=cB.SYMBOL_SUPPORT,rre=function(e,n){var i,r,s,o,a;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if(typeof n!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||nre&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(s=0,o=e.length;s<o;s++)n(e[s],s);return}if(typeof e.forEach=="function"){e.forEach(n);return}if(ire&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(i=e,s=0;a=i.next(),a.done!==!0;)n(a.value,s),s++;return}for(r in e)e.hasOwnProperty(r)&&n(e[r],r)},uB=Yb,sre=rre;function Tn(){this.clear()}Tn.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};Tn.prototype.enqueue=function(t){return this.items.push(t),++this.size};Tn.prototype.dequeue=function(){if(this.size){var t=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,t}};Tn.prototype.peek=function(){if(this.size)return this.items[this.offset]};Tn.prototype.forEach=function(t,e){e=arguments.length>1?e:this;for(var n=this.offset,i=0,r=this.items.length;n<r;n++,i++)t.call(e,this.items[n],i,this)};Tn.prototype.toArray=function(){return this.items.slice(this.offset)};Tn.prototype.values=function(){var t=this.items,e=this.offset;return new uB(function(){if(e>=t.length)return{done:!0};var n=t[e];return e++,{value:n,done:!1}})};Tn.prototype.entries=function(){var t=this.items,e=this.offset,n=0;return new uB(function(){if(e>=t.length)return{done:!0};var i=t[e];return e++,{value:[n++,i],done:!1}})};typeof Symbol<"u"&&(Tn.prototype[Symbol.iterator]=Tn.prototype.values);Tn.prototype.toString=function(){return this.toArray().join(",")};Tn.prototype.toJSON=function(){return this.toArray()};Tn.prototype.inspect=function(){var t=this.toArray();return Object.defineProperty(t,"constructor",{value:Tn,enumerable:!1}),t};typeof Symbol<"u"&&(Tn.prototype[Symbol.for("nodejs.util.inspect.custom")]=Tn.prototype.inspect);Tn.from=function(t){var e=new Tn;return sre(t,function(n){e.enqueue(n)}),e};Tn.of=function(){return Tn.from(arguments)};var ore=function(e,n){var i=n.length;if(i!==0){var r=e.length;e.length+=i;for(var s=0;s<i;s++)e[r+s]=n[s]}},dB=tre,are=ore;function lre(t,e,n){if(!dB(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');if(!t.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" target node does not exist in the given graph.');if(e=""+e,n=""+n,e===n)return[e];var i=t.inboundNeighbors.bind(t),r=t.outboundNeighbors.bind(t),s={},o={};s[e]=null,o[n]=null;var a=[e],l=[n],c,u,d,f,p,m,g,y,v=!1;e:for(;a.length&&l.length;)if(a.length<=l.length){for(c=a,a=[],p=0,g=c.length;p<g;p++)for(u=c[p],d=r(u),m=0,y=d.length;m<y;m++)if(f=d[m],f in s||(a.push(f),s[f]=u),f in o){v=!0;break e}}else for(c=l,l=[],p=0,g=c.length;p<g;p++)for(u=c[p],d=i(u),m=0,y=d.length;m<y;m++)if(f=d[m],f in o||(l.push(f),o[f]=u),f in s){v=!0;break e}if(!v)return null;for(var b=[];f;)b.unshift(f),f=s[f];for(f=o[b[b.length-1]];f;)b.push(f),f=o[f];return b.length?b:null}function fB(t,e,n){if(!dB(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!e.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" source node does not exist in the given graph.');n=""+n;var i=new Set,r={},s=0;r[n]=0;for(var o=[n],a,l,c;o.length!==0;){var u=[];for(a=0,l=o.length;a<l;a++)c=o[a],!i.has(c)&&(i.add(c),are(u,e[t](c)),r[c]=s);s++,o=u}return r}fB.bind(null,"outboundNeighbors");fB.bind(null,"neighbors");var cre=lre,TE=$m(),dt=t=>Bm(t,TE),OE=$m();dt.write=t=>Bm(t,OE);var Qb=$m();dt.onStart=t=>Bm(t,Qb);var LE=$m();dt.onFrame=t=>Bm(t,LE);var DE=$m();dt.onFinish=t=>Bm(t,DE);var Ed=[];dt.setTimeout=(t,e)=>{const n=dt.now()+e,i=()=>{const s=Ed.findIndex(o=>o.cancel==i);~s&&Ed.splice(s,1),ul-=~s?1:0},r={time:n,handler:t,cancel:i};return Ed.splice(hB(n),0,r),ul+=1,pB(),r};var hB=t=>~(~Ed.findIndex(e=>e.time>t)||~Ed.length);dt.cancel=t=>{Qb.delete(t),LE.delete(t),DE.delete(t),TE.delete(t),OE.delete(t)};dt.sync=t=>{Pk=!0,dt.batchedUpdates(t),Pk=!1};dt.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function i(...r){e=r,dt.onStart(n)}return i.handler=t,i.cancel=()=>{Qb.delete(n),e=null},i};var jE=typeof window<"u"?window.requestAnimationFrame:()=>{};dt.use=t=>jE=t;dt.now=typeof performance<"u"?()=>performance.now():Date.now;dt.batchedUpdates=t=>t();dt.catch=console.error;dt.frameLoop="always";dt.advance=()=>{dt.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):gB()};var cl=-1,ul=0,Pk=!1;function Bm(t,e){Pk?(e.delete(t),t(0)):(e.add(t),pB())}function pB(){cl<0&&(cl=0,dt.frameLoop!=="demand"&&jE(mB))}function ure(){cl=-1}function mB(){~cl&&(jE(mB),dt.batchedUpdates(gB))}function gB(){const t=cl;cl=dt.now();const e=hB(cl);if(e&&(vB(Ed.splice(0,e),n=>n.handler()),ul-=e),!ul){ure();return}Qb.flush(),TE.flush(t?Math.min(64,cl-t):16.667),LE.flush(),OE.flush(),DE.flush()}function $m(){let t=new Set,e=t;return{add(n){ul+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return ul-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,ul-=e.size,vB(e,i=>i(n)&&t.add(i)),ul+=t.size,e=t)}}}function vB(t,e){t.forEach(n=>{try{e(n)}catch(i){dt.catch(i)}})}var dre=Object.defineProperty,fre=(t,e)=>{for(var n in e)dre(t,n,{get:e[n],enumerable:!0})},Bs={};fre(Bs,{assign:()=>pre,colors:()=>_l,createStringInterpolator:()=>$E,skipAnimation:()=>bB,to:()=>yB,willAdvance:()=>FE});function Nk(){}var hre=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),ve={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function zo(t,e){if(ve.arr(t)){if(!ve.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}var _t=(t,e)=>t.forEach(e);function Ro(t,e,n){if(ve.arr(t)){for(let i=0;i<t.length;i++)e.call(n,t[i],`${i}`);return}for(const i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i)}var Pr=t=>ve.und(t)?[]:ve.arr(t)?t:[t];function ip(t,e){if(t.size){const n=Array.from(t);t.clear(),_t(n,e)}}var Mh=(t,...e)=>ip(t,n=>n(...e)),BE=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),$E,yB,_l=null,bB=!1,FE=Nk,pre=t=>{t.to&&(yB=t.to),t.now&&(dt.now=t.now),t.colors!==void 0&&(_l=t.colors),t.skipAnimation!=null&&(bB=t.skipAnimation),t.createStringInterpolator&&($E=t.createStringInterpolator),t.requestAnimationFrame&&dt.use(t.requestAnimationFrame),t.batchedUpdates&&(dt.batchedUpdates=t.batchedUpdates),t.willAdvance&&(FE=t.willAdvance),t.frameLoop&&(dt.frameLoop=t.frameLoop)},rp=new Set,Yr=[],aw=[],ky=0,e1={get idle(){return!rp.size&&!Yr.length},start(t){ky>t.priority?(rp.add(t),dt.onStart(mre)):(xB(t),dt(Mk))},advance:Mk,sort(t){if(ky)dt.onFrame(()=>e1.sort(t));else{const e=Yr.indexOf(t);~e&&(Yr.splice(e,1),wB(t))}},clear(){Yr=[],rp.clear()}};function mre(){rp.forEach(xB),rp.clear(),dt(Mk)}function xB(t){Yr.includes(t)||wB(t)}function wB(t){Yr.splice(gre(Yr,e=>e.priority>t.priority),0,t)}function Mk(t){const e=aw;for(let n=0;n<Yr.length;n++){const i=Yr[n];ky=i.priority,i.idle||(FE(i),i.advance(t),i.idle||e.push(i))}return ky=0,aw=Yr,aw.length=0,Yr=e,Yr.length>0}function gre(t,e){const n=t.findIndex(e);return n<0?t.length:n}var vre=(t,e,n)=>Math.min(Math.max(n,t),e),yre={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},Ms="[-+]?\\d*\\.?\\d+",Cy=Ms+"%";function t1(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var bre=new RegExp("rgb"+t1(Ms,Ms,Ms)),xre=new RegExp("rgba"+t1(Ms,Ms,Ms,Ms)),wre=new RegExp("hsl"+t1(Ms,Cy,Cy)),Sre=new RegExp("hsla"+t1(Ms,Cy,Cy,Ms)),kre=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Cre=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,_re=/^#([0-9a-fA-F]{6})$/,Ere=/^#([0-9a-fA-F]{8})$/;function Are(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=_re.exec(t))?parseInt(e[1]+"ff",16)>>>0:_l&&_l[t]!==void 0?_l[t]:(e=bre.exec(t))?(_u(e[1])<<24|_u(e[2])<<16|_u(e[3])<<8|255)>>>0:(e=xre.exec(t))?(_u(e[1])<<24|_u(e[2])<<16|_u(e[3])<<8|ZI(e[4]))>>>0:(e=kre.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=Ere.exec(t))?parseInt(e[1],16)>>>0:(e=Cre.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=wre.exec(t))?(YI(JI(e[1]),Kg(e[2]),Kg(e[3]))|255)>>>0:(e=Sre.exec(t))?(YI(JI(e[1]),Kg(e[2]),Kg(e[3]))|ZI(e[4]))>>>0:null}function lw(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function YI(t,e,n){const i=n<.5?n*(1+e):n+e-n*e,r=2*n-i,s=lw(r,i,t+1/3),o=lw(r,i,t),a=lw(r,i,t-1/3);return Math.round(s*255)<<24|Math.round(o*255)<<16|Math.round(a*255)<<8}function _u(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function JI(t){return(parseFloat(t)%360+360)%360/360}function ZI(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function Kg(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function QI(t){let e=Are(t);if(e===null)return t;e=e||0;const n=(e&4278190080)>>>24,i=(e&16711680)>>>16,r=(e&65280)>>>8,s=(e&255)/255;return`rgba(${n}, ${i}, ${r}, ${s})`}var tm=(t,e,n)=>{if(ve.fun(t))return t;if(ve.arr(t))return tm({range:t,output:e,extrapolate:n});if(ve.str(t.output[0]))return $E(t);const i=t,r=i.output,s=i.range||[0,1],o=i.extrapolateLeft||i.extrapolate||"extend",a=i.extrapolateRight||i.extrapolate||"extend",l=i.easing||(c=>c);return c=>{const u=Nre(c,s);return Pre(c,s[u],s[u+1],r[u],r[u+1],l,o,a,i.map)}};function Pre(t,e,n,i,r,s,o,a,l){let c=l?l(t):t;if(c<e){if(o==="identity")return c;o==="clamp"&&(c=e)}if(c>n){if(a==="identity")return c;a==="clamp"&&(c=n)}return i===r?i:e===n?t<=e?i:r:(e===-1/0?c=-c:n===1/0?c=c-e:c=(c-e)/(n-e),c=s(c),i===-1/0?c=-c:r===1/0?c=c+i:c=c*(r-i)+i,c)}function Nre(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}var Mre=(t,e="end")=>n=>{n=e==="end"?Math.min(n,.999):Math.max(n,.001);const i=n*t,r=e==="end"?Math.floor(i):Math.ceil(i);return vre(0,1,r/t)},_y=1.70158,Yg=_y*1.525,eT=_y+1,tT=2*Math.PI/3,nT=2*Math.PI/4.5,Jg=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,SB={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>eT*t*t*t-_y*t*t,easeOutBack:t=>1+eT*Math.pow(t-1,3)+_y*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((Yg+1)*2*t-Yg)/2:(Math.pow(2*t-2,2)*((Yg+1)*(t*2-2)+Yg)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*tT),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*tT)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*nT))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*nT)/2+1,easeInBounce:t=>1-Jg(1-t),easeOutBounce:Jg,easeInOutBounce:t=>t<.5?(1-Jg(1-2*t))/2:(1+Jg(2*t-1))/2,steps:Mre},nm=Symbol.for("FluidValue.get"),ff=Symbol.for("FluidValue.observers"),Kr=t=>!!(t&&t[nm]),er=t=>t&&t[nm]?t[nm]():t,iT=t=>t[ff]||null;function Rre(t,e){t.eventObserved?t.eventObserved(e):t(e)}function im(t,e){const n=t[ff];n&&n.forEach(i=>{Rre(i,e)})}var kB=class{constructor(t){if(!t&&!(t=this.get))throw Error("Unknown getter");Ire(this,t)}},Ire=(t,e)=>CB(t,nm,e);function Nf(t,e){if(t[nm]){let n=t[ff];n||CB(t,ff,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function rm(t,e){const n=t[ff];if(n&&n.has(e)){const i=n.size-1;i?n.delete(e):t[ff]=null,t.observerRemoved&&t.observerRemoved(i,e)}}var CB=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),cv=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Tre=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,rT=new RegExp(`(${cv.source})(%|[a-z]+)`,"i"),Ore=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,n1=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,_B=t=>{const[e,n]=Lre(t);if(!e||BE())return t;const i=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(i)return i.trim();if(n&&n.startsWith("--")){const r=window.getComputedStyle(document.documentElement).getPropertyValue(n);return r||t}else{if(n&&n1.test(n))return _B(n);if(n)return n}return t},Lre=t=>{const e=n1.exec(t);if(!e)return[,];const[,n,i]=e;return[n,i]},cw,Dre=(t,e,n,i,r)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(i)}, ${r})`,EB=t=>{cw||(cw=_l?new RegExp(`(${Object.keys(_l).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(s=>er(s).replace(n1,_B).replace(Tre,QI).replace(cw,QI)),n=e.map(s=>s.match(cv).map(Number)),r=n[0].map((s,o)=>n.map(a=>{if(!(o in a))throw Error('The arity of each "output" value must be equal');return a[o]})).map(s=>tm({...t,output:s}));return s=>{var l;const o=!rT.test(e[0])&&((l=e.find(c=>rT.test(c)))==null?void 0:l.replace(cv,""));let a=0;return e[0].replace(cv,()=>`${r[a++](s)}${o||""}`).replace(Ore,Dre)}},zE="react-spring: ",AB=t=>{const e=t;let n=!1;if(typeof e!="function")throw new TypeError(`${zE}once requires a function parameter`);return(...i)=>{n||(e(...i),n=!0)}},jre=AB(console.warn);function Bre(){jre(`${zE}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var $re=AB(console.warn);function Fre(){$re(`${zE}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function i1(t){return ve.str(t)&&(t[0]=="#"||/\d/.test(t)||!BE()&&n1.test(t)||t in(_l||{}))}var UE=BE()?x.useEffect:x.useLayoutEffect,zre=()=>{const t=x.useRef(!1);return UE(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function PB(){const t=x.useState()[1],e=zre();return()=>{e.current&&t(Math.random())}}function Ure(t,e){const[n]=x.useState(()=>({inputs:e,result:t()})),i=x.useRef(),r=i.current;let s=r;return s?e&&s.inputs&&Vre(e,s.inputs)||(s={inputs:e,result:t()}):s=n,x.useEffect(()=>{i.current=s,r==n&&(n.inputs=n.result=void 0)},[s]),s.result}function Vre(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var NB=t=>x.useEffect(t,Hre),Hre=[];function sT(t){const e=x.useRef();return x.useEffect(()=>{e.current=t}),e.current}var sm=Symbol.for("Animated:node"),Wre=t=>!!t&&t[sm]===t,Qs=t=>t&&t[sm],VE=(t,e)=>hre(t,sm,e),r1=t=>t&&t[sm]&&t[sm].getPayload(),MB=class{constructor(){VE(this,this)}getPayload(){return this.payload||[]}},Fm=class extends MB{constructor(t){super(),this._value=t,this.done=!0,this.durationProgress=0,ve.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new Fm(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,e){return ve.num(t)&&(this.lastPosition=t,e&&(t=Math.round(t/e)*e,this.done&&(this.lastPosition=t))),this._value===t?!1:(this._value=t,!0)}reset(){const{done:t}=this;this.done=!1,ve.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}},om=class extends Fm{constructor(t){super(0),this._string=null,this._toString=tm({output:[t,t]})}static create(t){return new om(t)}getValue(){const t=this._string;return t??(this._string=this._toString(this._value))}setValue(t){if(ve.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else if(super.setValue(t))this._string=null;else return!1;return!0}reset(t){t&&(this._toString=tm({output:[this.getValue(),t]})),this._value=0,super.reset()}},Ey={dependencies:null},s1=class extends MB{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const e={};return Ro(this.source,(n,i)=>{Wre(n)?e[i]=n.getValue(t):Kr(n)?e[i]=er(n):t||(e[i]=n)}),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&_t(this.payload,t=>t.reset())}_makePayload(t){if(t){const e=new Set;return Ro(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){Ey.dependencies&&Kr(t)&&Ey.dependencies.add(t);const e=r1(t);e&&_t(e,n=>this.add(n))}},RB=class extends s1{constructor(t){super(t)}static create(t){return new RB(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){const e=this.getPayload();return t.length==e.length?e.map((n,i)=>n.setValue(t[i])).some(Boolean):(super.setValue(t.map(Gre)),!0)}};function Gre(t){return(i1(t)?om:Fm).create(t)}function Rk(t){const e=Qs(t);return e?e.constructor:ve.arr(t)?RB:i1(t)?om:Fm}var oT=(t,e)=>{const n=!ve.fun(t)||t.prototype&&t.prototype.isReactComponent;return x.forwardRef((i,r)=>{const s=x.useRef(null),o=n&&x.useCallback(m=>{s.current=Kre(r,m)},[r]),[a,l]=qre(i,e),c=PB(),u=()=>{const m=s.current;if(n&&!m)return;(m?e.applyAnimatedValues(m,a.getValue(!0)):!1)===!1&&c()},d=new Xre(u,l),f=x.useRef();UE(()=>(f.current=d,_t(l,m=>Nf(m,d)),()=>{f.current&&(_t(f.current.deps,m=>rm(m,f.current)),dt.cancel(f.current.update))})),x.useEffect(u,[]),NB(()=>()=>{const m=f.current;_t(m.deps,g=>rm(g,m))});const p=e.getComponentProps(a.getValue());return x.createElement(t,{...p,ref:o})})},Xre=class{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){t.type=="change"&&dt.write(this.update)}};function qre(t,e){const n=new Set;return Ey.dependencies=n,t.style&&(t={...t,style:e.createAnimatedStyle(t.style)}),t=new s1(t),Ey.dependencies=null,[t,n]}function Kre(t,e){return t&&(ve.fun(t)?t(e):t.current=e),e}var aT=Symbol.for("AnimatedComponent"),Yre=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=r=>new s1(r),getComponentProps:i=r=>r}={})=>{const r={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:i},s=o=>{const a=lT(o)||"Anonymous";return ve.str(o)?o=s[o]||(s[o]=oT(o,r)):o=o[aT]||(o[aT]=oT(o,r)),o.displayName=`Animated(${a})`,o};return Ro(t,(o,a)=>{ve.arr(t)&&(a=lT(o)),s[a]=s(o)}),{animated:s}},lT=t=>ve.str(t)?t:t&&ve.str(t.displayName)?t.displayName:ve.fun(t)&&t.name||null;function Pc(t,...e){return ve.fun(t)?t(...e):t}var sp=(t,e)=>t===!0||!!(e&&t&&(ve.fun(t)?t(e):Pr(t).includes(e))),IB=(t,e)=>ve.obj(t)?e&&t[e]:t,TB=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,Jre=t=>t,HE=(t,e=Jre)=>{let n=Zre;t.default&&t.default!==!0&&(t=t.default,n=Object.keys(t));const i={};for(const r of n){const s=e(t[r],r);ve.und(s)||(i[r]=s)}return i},Zre=["config","onProps","onStart","onChange","onPause","onResume","onRest"],Qre={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function ese(t){const e={};let n=0;if(Ro(t,(i,r)=>{Qre[r]||(e[r]=i,n++)}),n)return e}function OB(t){const e=ese(t);if(e){const n={to:e};return Ro(t,(i,r)=>r in e||(n[r]=i)),n}return{...t}}function am(t){return t=er(t),ve.arr(t)?t.map(am):i1(t)?Bs.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function tse(t){for(const e in t)return!0;return!1}function Ik(t){return ve.fun(t)||ve.arr(t)&&ve.obj(t[0])}function nse(t,e){var n;(n=t.ref)==null||n.delete(t),e==null||e.delete(t)}function ise(t,e){var n;e&&t.ref!==e&&((n=t.ref)==null||n.delete(t),e.add(t),t.ref=e)}var rse={default:{tension:170,friction:26}},Tk={...rse.default,mass:1,damping:1,easing:SB.linear,clamp:!1},sse=class{constructor(){this.velocity=0,Object.assign(this,Tk)}};function ose(t,e,n){n&&(n={...n},cT(n,e),e={...n,...e}),cT(t,e),Object.assign(t,e);for(const o in Tk)t[o]==null&&(t[o]=Tk[o]);let{frequency:i,damping:r}=t;const{mass:s}=t;return ve.und(i)||(i<.01&&(i=.01),r<0&&(r=0),t.tension=Math.pow(2*Math.PI/i,2)*s,t.friction=4*Math.PI*r*s/i),t}function cT(t,e){if(!ve.und(e.decay))t.duration=void 0;else{const n=!ve.und(e.tension)||!ve.und(e.friction);(n||!ve.und(e.frequency)||!ve.und(e.damping)||!ve.und(e.mass))&&(t.duration=void 0,t.decay=void 0),n&&(t.frequency=void 0)}}var uT=[],ase=class{constructor(){this.changed=!1,this.values=uT,this.toValues=null,this.fromValues=uT,this.config=new sse,this.immediate=!1}};function LB(t,{key:e,props:n,defaultProps:i,state:r,actions:s}){return new Promise((o,a)=>{let l,c,u=sp(n.cancel??(i==null?void 0:i.cancel),e);if(u)p();else{ve.und(n.pause)||(r.paused=sp(n.pause,e));let m=i==null?void 0:i.pause;m!==!0&&(m=r.paused||sp(m,e)),l=Pc(n.delay||0,e),m?(r.resumeQueue.add(f),s.pause()):(s.resume(),f())}function d(){r.resumeQueue.add(f),r.timeouts.delete(c),c.cancel(),l=c.time-dt.now()}function f(){l>0&&!Bs.skipAnimation?(r.delayed=!0,c=dt.setTimeout(p,l),r.pauseQueue.add(d),r.timeouts.add(c)):p()}function p(){r.delayed&&(r.delayed=!1),r.pauseQueue.delete(d),r.timeouts.delete(c),t<=(r.cancelId||0)&&(u=!0);try{s.start({...n,callId:t,cancel:u},o)}catch(m){a(m)}}})}var WE=(t,e)=>e.length==1?e[0]:e.some(n=>n.cancelled)?Ad(t.get()):e.every(n=>n.noop)?DB(t.get()):As(t.get(),e.every(n=>n.finished)),DB=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),As=(t,e,n=!1)=>({value:t,finished:e,cancelled:n}),Ad=t=>({value:t,cancelled:!0,finished:!1});function jB(t,e,n,i){const{callId:r,parentId:s,onRest:o}=e,{asyncTo:a,promise:l}=n;return!s&&t===a&&!e.reset?l:n.promise=(async()=>{n.asyncId=r,n.asyncTo=t;const c=HE(e,(y,v)=>v==="onRest"?void 0:y);let u,d;const f=new Promise((y,v)=>(u=y,d=v)),p=y=>{const v=r<=(n.cancelId||0)&&Ad(i)||r!==n.asyncId&&As(i,!1);if(v)throw y.result=v,d(y),y},m=(y,v)=>{const b=new dT,w=new fT;return(async()=>{if(Bs.skipAnimation)throw lm(n),w.result=As(i,!1),d(w),w;p(b);const k=ve.obj(y)?{...y}:{...v,to:y};k.parentId=r,Ro(c,(E,_)=>{ve.und(k[_])&&(k[_]=E)});const C=await i.start(k);return p(b),n.paused&&await new Promise(E=>{n.resumeQueue.add(E)}),C})()};let g;if(Bs.skipAnimation)return lm(n),As(i,!1);try{let y;ve.arr(t)?y=(async v=>{for(const b of v)await m(b)})(t):y=Promise.resolve(t(m,i.stop.bind(i))),await Promise.all([y.then(u),f]),g=As(i.get(),!0,!1)}catch(y){if(y instanceof dT)g=y.result;else if(y instanceof fT)g=y.result;else throw y}finally{r==n.asyncId&&(n.asyncId=s,n.asyncTo=s?a:void 0,n.promise=s?l:void 0)}return ve.fun(o)&&dt.batchedUpdates(()=>{o(g,i,i.item)}),g})()}function lm(t,e){ip(t.timeouts,n=>n.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}var dT=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},fT=class extends Error{constructor(){super("SkipAnimationSignal")}},Ok=t=>t instanceof GE,lse=1,GE=class extends kB{constructor(){super(...arguments),this.id=lse++,this._priority=0}get priority(){return this._priority}set priority(t){this._priority!=t&&(this._priority=t,this._onPriorityChange(t))}get(){const t=Qs(this);return t&&t.getValue()}to(...t){return Bs.to(this,t)}interpolate(...t){return Bre(),Bs.to(this,t)}toJSON(){return this.get()}observerAdded(t){t==1&&this._attach()}observerRemoved(t){t==0&&this._detach()}_attach(){}_detach(){}_onChange(t,e=!1){im(this,{type:"change",parent:this,value:t,idle:e})}_onPriorityChange(t){this.idle||e1.sort(this),im(this,{type:"priority",parent:this,priority:t})}},su=Symbol.for("SpringPhase"),BB=1,Lk=2,Dk=4,uw=t=>(t[su]&BB)>0,Oa=t=>(t[su]&Lk)>0,nh=t=>(t[su]&Dk)>0,hT=(t,e)=>e?t[su]|=Lk|BB:t[su]&=~Lk,pT=(t,e)=>e?t[su]|=Dk:t[su]&=~Dk,qe=class extends GE{constructor(t,e){if(super(),this.animation=new ase,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!ve.und(t)||!ve.und(e)){const n=ve.obj(t)?{...t}:{...e,from:t};ve.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(Oa(this)||this._state.asyncTo)||nh(this)}get goal(){return er(this.animation.to)}get velocity(){const t=Qs(this);return t instanceof Fm?t.lastVelocity||0:t.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return uw(this)}get isAnimating(){return Oa(this)}get isPaused(){return nh(this)}get isDelayed(){return this._state.delayed}advance(t){let e=!0,n=!1;const i=this.animation;let{toValues:r}=i;const{config:s}=i,o=r1(i.to);!o&&Kr(i.to)&&(r=Pr(er(i.to))),i.values.forEach((c,u)=>{if(c.done)return;const d=c.constructor==om?1:o?o[u].lastPosition:r[u];let f=i.immediate,p=d;if(!f){if(p=c.lastPosition,s.tension<=0){c.done=!0;return}let m=c.elapsedTime+=t;const g=i.fromValues[u],y=c.v0!=null?c.v0:c.v0=ve.arr(s.velocity)?s.velocity[u]:s.velocity;let v;const b=s.precision||(g==d?.005:Math.min(1,Math.abs(d-g)*.001));if(ve.und(s.duration))if(s.decay){const w=s.decay===!0?.998:s.decay,k=Math.exp(-(1-w)*m);p=g+y/(1-w)*(1-k),f=Math.abs(c.lastPosition-p)<=b,v=y*k}else{v=c.lastVelocity==null?y:c.lastVelocity;const w=s.restVelocity||b/10,k=s.clamp?0:s.bounce,C=!ve.und(k),E=g==d?c.v0>0:g<d;let _,M=!1;const R=1,T=Math.ceil(t/R);for(let L=0;L<T&&(_=Math.abs(v)>w,!(!_&&(f=Math.abs(d-p)<=b,f)));++L){C&&(M=p==d||p>d==E,M&&(v=-v*k,p=d));const I=-s.tension*1e-6*(p-d),G=-s.friction*.001*v,B=(I+G)/s.mass;v=v+B*R,p=p+v*R}}else{let w=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,c.durationProgress>0&&(c.elapsedTime=s.duration*c.durationProgress,m=c.elapsedTime+=t)),w=(s.progress||0)+m/this._memoizedDuration,w=w>1?1:w<0?0:w,c.durationProgress=w),p=g+s.easing(w)*(d-g),v=(p-c.lastPosition)/t,f=w==1}c.lastVelocity=v,Number.isNaN(p)&&(console.warn("Got NaN while animating:",this),f=!0)}o&&!o[u].done&&(f=!1),f?c.done=!0:e=!1,c.setValue(p,s.round)&&(n=!0)});const a=Qs(this),l=a.getValue();if(e){const c=er(i.to);(l!==c||n)&&!s.decay?(a.setValue(c),this._onChange(c)):n&&s.decay&&this._onChange(l),this._stop()}else n&&this._onChange(l)}set(t){return dt.batchedUpdates(()=>{this._stop(),this._focus(t),this._set(t)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Oa(this)){const{to:t,config:e}=this.animation;dt.batchedUpdates(()=>{this._onStart(),e.decay||this._set(t,!1),this._stop()})}return this}update(t){return(this.queue||(this.queue=[])).push(t),this}start(t,e){let n;return ve.und(t)?(n=this.queue||[],this.queue=[]):n=[ve.obj(t)?t:{...e,to:t}],Promise.all(n.map(i=>this._update(i))).then(i=>WE(this,i))}stop(t){const{to:e}=this.animation;return this._focus(this.get()),lm(this._state,t&&this._lastCallId),dt.batchedUpdates(()=>this._stop(e,t)),this}reset(){this._update({reset:!0})}eventObserved(t){t.type=="change"?this._start():t.type=="priority"&&(this.priority=t.priority+1)}_prepareNode(t){const e=this.key||"";let{to:n,from:i}=t;n=ve.obj(n)?n[e]:n,(n==null||Ik(n))&&(n=void 0),i=ve.obj(i)?i[e]:i,i==null&&(i=void 0);const r={to:n,from:i};return uw(this)||(t.reverse&&([n,i]=[i,n]),i=er(i),ve.und(i)?Qs(this)||this._set(n):this._set(i)),r}_update({...t},e){const{key:n,defaultProps:i}=this;t.default&&Object.assign(i,HE(t,(o,a)=>/^on/.test(a)?IB(o,n):o)),gT(this,t,"onProps"),rh(this,"onProps",t,this);const r=this._prepareNode(t);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return LB(++this._lastCallId,{key:n,props:t,defaultProps:i,state:s,actions:{pause:()=>{nh(this)||(pT(this,!0),Mh(s.pauseQueue),rh(this,"onPause",As(this,ih(this,this.animation.to)),this))},resume:()=>{nh(this)&&(pT(this,!1),Oa(this)&&this._resume(),Mh(s.resumeQueue),rh(this,"onResume",As(this,ih(this,this.animation.to)),this))},start:this._merge.bind(this,r)}}).then(o=>{if(t.loop&&o.finished&&!(e&&o.noop)){const a=$B(t);if(a)return this._update(a,!0)}return o})}_merge(t,e,n){if(e.cancel)return this.stop(!0),n(Ad(this));const i=!ve.und(t.to),r=!ve.und(t.from);if(i||r)if(e.callId>this._lastToId)this._lastToId=e.callId;else return n(Ad(this));const{key:s,defaultProps:o,animation:a}=this,{to:l,from:c}=a;let{to:u=l,from:d=c}=t;r&&!i&&(!e.default||ve.und(u))&&(u=d),e.reverse&&([u,d]=[d,u]);const f=!zo(d,c);f&&(a.from=d),d=er(d);const p=!zo(u,l);p&&this._focus(u);const m=Ik(e.to),{config:g}=a,{decay:y,velocity:v}=g;(i||r)&&(g.velocity=0),e.config&&!m&&ose(g,Pc(e.config,s),e.config!==o.config?Pc(o.config,s):void 0);let b=Qs(this);if(!b||ve.und(u))return n(As(this,!0));const w=ve.und(e.reset)?r&&!e.default:!ve.und(d)&&sp(e.reset,s),k=w?d:this.get(),C=am(u),E=ve.num(C)||ve.arr(C)||i1(C),_=!m&&(!E||sp(o.immediate||e.immediate,s));if(p){const L=Rk(u);if(L!==b.constructor)if(_)b=this._set(C);else throw Error(`Cannot animate between ${b.constructor.name} and ${L.name}, as the "to" prop suggests`)}const M=b.constructor;let R=Kr(u),T=!1;if(!R){const L=w||!uw(this)&&f;(p||L)&&(T=zo(am(k),C),R=!T),(!zo(a.immediate,_)&&!_||!zo(g.decay,y)||!zo(g.velocity,v))&&(R=!0)}if(T&&Oa(this)&&(a.changed&&!w?R=!0:R||this._stop(l)),!m&&((R||Kr(l))&&(a.values=b.getPayload(),a.toValues=Kr(u)?null:M==om?[1]:Pr(C)),a.immediate!=_&&(a.immediate=_,!_&&!w&&this._set(l)),R)){const{onRest:L}=a;_t(use,G=>gT(this,e,G));const I=As(this,ih(this,l));Mh(this._pendingCalls,I),this._pendingCalls.add(n),a.changed&&dt.batchedUpdates(()=>{var G;a.changed=!w,L==null||L(I,this),w?Pc(o.onRest,I):(G=a.onStart)==null||G.call(a,I,this)})}w&&this._set(k),m?n(jB(e.to,e,this._state,this)):R?this._start():Oa(this)&&!p?this._pendingCalls.add(n):n(DB(k))}_focus(t){const e=this.animation;t!==e.to&&(iT(this)&&this._detach(),e.to=t,iT(this)&&this._attach())}_attach(){let t=0;const{to:e}=this.animation;Kr(e)&&(Nf(e,this),Ok(e)&&(t=e.priority+1)),this.priority=t}_detach(){const{to:t}=this.animation;Kr(t)&&rm(t,this)}_set(t,e=!0){const n=er(t);if(!ve.und(n)){const i=Qs(this);if(!i||!zo(n,i.getValue())){const r=Rk(n);!i||i.constructor!=r?VE(this,r.create(n)):i.setValue(n),i&&dt.batchedUpdates(()=>{this._onChange(n,e)})}}return Qs(this)}_onStart(){const t=this.animation;t.changed||(t.changed=!0,rh(this,"onStart",As(this,ih(this,t.to)),this))}_onChange(t,e){e||(this._onStart(),Pc(this.animation.onChange,t,this)),Pc(this.defaultProps.onChange,t,this),super._onChange(t,e)}_start(){const t=this.animation;Qs(this).reset(er(t.to)),t.immediate||(t.fromValues=t.values.map(e=>e.lastPosition)),Oa(this)||(hT(this,!0),nh(this)||this._resume())}_resume(){Bs.skipAnimation?this.finish():e1.start(this)}_stop(t,e){if(Oa(this)){hT(this,!1);const n=this.animation;_t(n.values,r=>{r.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),im(this,{type:"idle",parent:this});const i=e?Ad(this.get()):As(this.get(),ih(this,t??n.to));Mh(this._pendingCalls,i),n.changed&&(n.changed=!1,rh(this,"onRest",i,this))}}};function ih(t,e){const n=am(e),i=am(t.get());return zo(i,n)}function $B(t,e=t.loop,n=t.to){const i=Pc(e);if(i){const r=i!==!0&&OB(i),s=(r||t).reverse,o=!r||r.reset;return cm({...t,loop:e,default:!1,pause:void 0,to:!s||Ik(n)?n:void 0,from:o?t.from:void 0,reset:o,...r})}}function cm(t){const{to:e,from:n}=t=OB(t),i=new Set;return ve.obj(e)&&mT(e,i),ve.obj(n)&&mT(n,i),t.keys=i.size?Array.from(i):null,t}function cse(t){const e=cm(t);return ve.und(e.default)&&(e.default=HE(e)),e}function mT(t,e){Ro(t,(n,i)=>n!=null&&e.add(i))}var use=["onStart","onRest","onChange","onPause","onResume"];function gT(t,e,n){t.animation[n]=e[n]!==TB(e,n)?IB(e[n],t.key):void 0}function rh(t,e,...n){var i,r,s,o;(r=(i=t.animation)[e])==null||r.call(i,...n),(o=(s=t.defaultProps)[e])==null||o.call(s,...n)}var dse=["onStart","onChange","onRest"],fse=1,hse=class{constructor(t,e){this.id=fse++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),e&&(this._flush=e),t&&this.start({default:!0,...t})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(t=>t.idle&&!t.isDelayed&&!t.isPaused)}get item(){return this._item}set item(t){this._item=t}get(){const t={};return this.each((e,n)=>t[n]=e.get()),t}set(t){for(const e in t){const n=t[e];ve.und(n)||this.springs[e].set(n)}}update(t){return t&&this.queue.push(cm(t)),this}start(t){let{queue:e}=this;return t?e=Pr(t).map(cm):this.queue=[],this._flush?this._flush(this,e):(HB(this,e),jk(this,e))}stop(t,e){if(t!==!!t&&(e=t),e){const n=this.springs;_t(Pr(e),i=>n[i].stop(!!t))}else lm(this._state,this._lastAsyncId),this.each(n=>n.stop(!!t));return this}pause(t){if(ve.und(t))this.start({pause:!0});else{const e=this.springs;_t(Pr(t),n=>e[n].pause())}return this}resume(t){if(ve.und(t))this.start({pause:!1});else{const e=this.springs;_t(Pr(t),n=>e[n].resume())}return this}each(t){Ro(this.springs,t)}_onFrame(){const{onStart:t,onChange:e,onRest:n}=this._events,i=this._active.size>0,r=this._changed.size>0;(i&&!this._started||r&&!this._started)&&(this._started=!0,ip(t,([a,l])=>{l.value=this.get(),a(l,this,this._item)}));const s=!i&&this._started,o=r||s&&n.size?this.get():null;r&&e.size&&ip(e,([a,l])=>{l.value=o,a(l,this,this._item)}),s&&(this._started=!1,ip(n,([a,l])=>{l.value=o,a(l,this,this._item)}))}eventObserved(t){if(t.type=="change")this._changed.add(t.parent),t.idle||this._active.add(t.parent);else if(t.type=="idle")this._active.delete(t.parent);else return;dt.onFrame(this._onFrame)}};function jk(t,e){return Promise.all(e.map(n=>FB(t,n))).then(n=>WE(t,n))}async function FB(t,e,n){const{keys:i,to:r,from:s,loop:o,onRest:a,onResolve:l}=e,c=ve.obj(e.default)&&e.default;o&&(e.loop=!1),r===!1&&(e.to=null),s===!1&&(e.from=null);const u=ve.arr(r)||ve.fun(r)?r:void 0;u?(e.to=void 0,e.onRest=void 0,c&&(c.onRest=void 0)):_t(dse,g=>{const y=e[g];if(ve.fun(y)){const v=t._events[g];e[g]=({finished:b,cancelled:w})=>{const k=v.get(y);k?(b||(k.finished=!1),w&&(k.cancelled=!0)):v.set(y,{value:null,finished:b||!1,cancelled:w||!1})},c&&(c[g]=e[g])}});const d=t._state;e.pause===!d.paused?(d.paused=e.pause,Mh(e.pause?d.pauseQueue:d.resumeQueue)):d.paused&&(e.pause=!0);const f=(i||Object.keys(t.springs)).map(g=>t.springs[g].start(e)),p=e.cancel===!0||TB(e,"cancel")===!0;(u||p&&d.asyncId)&&f.push(LB(++t._lastAsyncId,{props:e,state:d,actions:{pause:Nk,resume:Nk,start(g,y){p?(lm(d,t._lastAsyncId),y(Ad(t))):(g.onRest=a,y(jB(u,g,d,t)))}}})),d.paused&&await new Promise(g=>{d.resumeQueue.add(g)});const m=WE(t,await Promise.all(f));if(o&&m.finished&&!(n&&m.noop)){const g=$B(e,o,r);if(g)return HB(t,[g]),FB(t,g,!0)}return l&&dt.batchedUpdates(()=>l(m,t,t.item)),m}function vT(t,e){const n={...t.springs};return e&&_t(Pr(e),i=>{ve.und(i.keys)&&(i=cm(i)),ve.obj(i.to)||(i={...i,to:void 0}),VB(n,i,r=>UB(r))}),zB(t,n),n}function zB(t,e){Ro(e,(n,i)=>{t.springs[i]||(t.springs[i]=n,Nf(n,t))})}function UB(t,e){const n=new qe;return n.key=t,e&&Nf(n,e),n}function VB(t,e,n){e.keys&&_t(e.keys,i=>{(t[i]||(t[i]=n(i)))._prepareNode(e)})}function HB(t,e){_t(e,n=>{VB(t.springs,n,i=>UB(i,t))})}var o1=({children:t,...e})=>{const n=x.useContext(Ay),i=e.pause||!!n.pause,r=e.immediate||!!n.immediate;e=Ure(()=>({pause:i,immediate:r}),[i,r]);const{Provider:s}=Ay;return x.createElement(s,{value:e},t)},Ay=pse(o1,{});o1.Provider=Ay.Provider;o1.Consumer=Ay.Consumer;function pse(t,e){return Object.assign(t,x.createContext(e)),t.Provider._context=t,t.Consumer._context=t,t}var mse=()=>{const t=[],e=function(i){Fre();const r=[];return _t(t,(s,o)=>{if(ve.und(i))r.push(s.start());else{const a=n(i,s,o);a&&r.push(s.start(a))}}),r};e.current=t,e.add=function(i){t.includes(i)||t.push(i)},e.delete=function(i){const r=t.indexOf(i);~r&&t.splice(r,1)},e.pause=function(){return _t(t,i=>i.pause(...arguments)),this},e.resume=function(){return _t(t,i=>i.resume(...arguments)),this},e.set=function(i){_t(t,(r,s)=>{const o=ve.fun(i)?i(s,r):i;o&&r.set(o)})},e.start=function(i){const r=[];return _t(t,(s,o)=>{if(ve.und(i))r.push(s.start());else{const a=this._getProps(i,s,o);a&&r.push(s.start(a))}}),r},e.stop=function(){return _t(t,i=>i.stop(...arguments)),this},e.update=function(i){return _t(t,(r,s)=>r.update(this._getProps(i,r,s))),this};const n=function(i,r,s){return ve.fun(i)?i(s,r):i};return e._getProps=n,e};function gse(t,e,n){const i=ve.fun(e)&&e;i&&!n&&(n=[]);const r=x.useMemo(()=>i||arguments.length==3?mse():void 0,[]),s=x.useRef(0),o=PB(),a=x.useMemo(()=>({ctrls:[],queue:[],flush(v,b){const w=vT(v,b);return s.current>0&&!a.queue.length&&!Object.keys(w).some(C=>!v.springs[C])?jk(v,b):new Promise(C=>{zB(v,w),a.queue.push(()=>{C(jk(v,b))}),o()})}}),[]),l=x.useRef([...a.ctrls]),c=[],u=sT(t)||0;x.useMemo(()=>{_t(l.current.slice(t,u),v=>{nse(v,r),v.stop(!0)}),l.current.length=t,d(u,t)},[t]),x.useMemo(()=>{d(0,Math.min(u,t))},n);function d(v,b){for(let w=v;w<b;w++){const k=l.current[w]||(l.current[w]=new hse(null,a.flush)),C=i?i(w,k):e[w];C&&(c[w]=cse(C))}}const f=l.current.map((v,b)=>vT(v,c[b])),p=x.useContext(o1),m=sT(p),g=p!==m&&tse(p);UE(()=>{s.current++,a.ctrls=l.current;const{queue:v}=a;v.length&&(a.queue=[],_t(v,b=>b())),_t(l.current,(b,w)=>{r==null||r.add(b),g&&b.start({default:p});const k=c[w];k&&(ise(b,k.ref),b.ref?b.queue.push(k):b.start(k))})}),NB(()=>()=>{_t(a.ctrls,v=>v.stop(!0))});const y=f.map(v=>({...v}));return r?[y,r]:y}function a1(t,e){const n=ve.fun(t),[[i],r]=gse(1,n?t:[t],n?[]:e);return n||arguments.length==2?[i,r]:i}var vse=class extends GE{constructor(t,e){super(),this.source=t,this.idle=!0,this._active=new Set,this.calc=tm(...e);const n=this._get(),i=Rk(n);VE(this,i.create(n))}advance(t){const e=this._get(),n=this.get();zo(e,n)||(Qs(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&yT(this._active)&&dw(this)}_get(){const t=ve.arr(this.source)?this.source.map(er):Pr(er(this.source));return this.calc(...t)}_start(){this.idle&&!yT(this._active)&&(this.idle=!1,_t(r1(this),t=>{t.done=!1}),Bs.skipAnimation?(dt.batchedUpdates(()=>this.advance()),dw(this)):e1.start(this))}_attach(){let t=1;_t(Pr(this.source),e=>{Kr(e)&&Nf(e,this),Ok(e)&&(e.idle||this._active.add(e),t=Math.max(t,e.priority+1))}),this.priority=t,this._start()}_detach(){_t(Pr(this.source),t=>{Kr(t)&&rm(t,this)}),this._active.clear(),dw(this)}eventObserved(t){t.type=="change"?t.idle?this.advance():(this._active.add(t.parent),this._start()):t.type=="idle"?this._active.delete(t.parent):t.type=="priority"&&(this.priority=Pr(this.source).reduce((e,n)=>Math.max(e,(Ok(n)?n.priority:0)+1),0))}};function yse(t){return t.idle!==!1}function yT(t){return!t.size||Array.from(t).every(yse)}function dw(t){t.idle||(t.idle=!0,_t(r1(t),e=>{e.done=!0}),im(t,{type:"idle",parent:t}))}Bs.assign({createStringInterpolator:EB,to:(t,e)=>new vse(t,e)});var WB=/^--/;function bse(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!WB.test(t)&&!(op.hasOwnProperty(t)&&op[t])?e+"px":(""+e).trim()}var bT={};function xse(t,e){if(!t.nodeType||!t.setAttribute)return!1;const n=t.nodeName==="filter"||t.parentNode&&t.parentNode.nodeName==="filter",{className:i,style:r,children:s,scrollTop:o,scrollLeft:a,viewBox:l,...c}=e,u=Object.values(c),d=Object.keys(c).map(f=>n||t.hasAttribute(f)?f:bT[f]||(bT[f]=f.replace(/([A-Z])/g,p=>"-"+p.toLowerCase())));s!==void 0&&(t.textContent=s);for(const f in r)if(r.hasOwnProperty(f)){const p=bse(f,r[f]);WB.test(f)?t.style.setProperty(f,p):t.style[f]=p}d.forEach((f,p)=>{t.setAttribute(f,u[p])}),i!==void 0&&(t.className=i),o!==void 0&&(t.scrollTop=o),a!==void 0&&(t.scrollLeft=a),l!==void 0&&t.setAttribute("viewBox",l)}var op={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wse=(t,e)=>t+e.charAt(0).toUpperCase()+e.substring(1),Sse=["Webkit","Ms","Moz","O"];op=Object.keys(op).reduce((t,e)=>(Sse.forEach(n=>t[wse(n,e)]=t[e]),t),op);var kse=/^(matrix|translate|scale|rotate|skew)/,Cse=/^(translate)/,_se=/^(rotate|skew)/,fw=(t,e)=>ve.num(t)&&t!==0?t+e:t,uv=(t,e)=>ve.arr(t)?t.every(n=>uv(n,e)):ve.num(t)?t===e:parseFloat(t)===e,Ese=class extends s1{constructor({x:t,y:e,z:n,...i}){const r=[],s=[];(t||e||n)&&(r.push([t||0,e||0,n||0]),s.push(o=>[`translate3d(${o.map(a=>fw(a,"px")).join(",")})`,uv(o,0)])),Ro(i,(o,a)=>{if(a==="transform")r.push([o||""]),s.push(l=>[l,l===""]);else if(kse.test(a)){if(delete i[a],ve.und(o))return;const l=Cse.test(a)?"px":_se.test(a)?"deg":"";r.push(Pr(o)),s.push(a==="rotate3d"?([c,u,d,f])=>[`rotate3d(${c},${u},${d},${fw(f,l)})`,uv(f,0)]:c=>[`${a}(${c.map(u=>fw(u,l)).join(",")})`,uv(c,a.startsWith("scale")?1:0)])}}),r.length&&(i.transform=new Ase(r,s)),super(i)}},Ase=class extends kB{constructor(t,e){super(),this.inputs=t,this.transforms=e,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let t="",e=!0;return _t(this.inputs,(n,i)=>{const r=er(n[0]),[s,o]=this.transforms[i](ve.arr(r)?r:n.map(er));t+=" "+s,e=e&&o}),e?"none":t}observerAdded(t){t==1&&_t(this.inputs,e=>_t(e,n=>Kr(n)&&Nf(n,this)))}observerRemoved(t){t==0&&_t(this.inputs,e=>_t(e,n=>Kr(n)&&rm(n,this)))}eventObserved(t){t.type=="change"&&(this._value=null),im(this,t)}},Pse=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];Bs.assign({batchedUpdates:Jl.unstable_batchedUpdates,createStringInterpolator:EB,colors:yre});var Nse=Yre(Pse,{applyAnimatedValues:xse,createAnimatedStyle:t=>new Ese(t),getComponentProps:({scrollTop:t,scrollLeft:e,...n})=>n}),nt=Nse.animated;const Ct={blue:{500:"#3b82f6"},mantis:{400:"#82bd69"},red:{500:"#ef4444"},stone:{600:"#57534e",700:"#44403c",800:"#292524"},white:"#ffffff"},He=(t=Ct.stone[800])=>({backgroundColor:new qe(t),opacity:new qe(1)}),Vn=()=>({strokeDashoffset:new qe(1),opacity:new qe(1)}),Zg=()=>({strokeDashoffset:new qe(1),opacity:new qe(1),path:new qe("")}),Py={bus:{address:Zg(),data:Zg(),rd:Zg(),wr:Zg(),iom:Vn(),mem:{stroke:new qe(Ct.red[500])},handshake:Vn(),pic:Vn(),pio:Vn(),timer:Vn(),intr:Vn(),inta:Vn(),int0:Vn(),int1:Vn(),int2:Vn(),"switches->pio":Vn(),"pio->leds":Vn(),printer:{data:Vn(),strobe:Vn(),busy:Vn()}},clock:{angle:new qe(0)},controlMemory:{overlay:{opacity:new qe(0)},container:{opacity:new qe(0),scale:new qe(.8)},currentInstruction:{glow:new qe(0)},microop:{0:{opacity:new qe(0),translateX:new qe(-20)},1:{opacity:new qe(0),translateX:new qe(-20)},2:{opacity:new qe(0),translateX:new qe(-20)},3:{opacity:new qe(0),translateX:new qe(-20)},4:{opacity:new qe(0),translateX:new qe(-20)}}},sequencer:{overlay:{opacity:new qe(0)},container:{opacity:new qe(0),scale:new qe(.8)},progress:{progress:new qe(0),opacity:new qe(1)}},cpu:{internalBus:{address:{strokeDashoffset:new qe(1),opacity:new qe(1),path:new qe("")},data:{strokeDashoffset:new qe(1),opacity:new qe(1),path:new qe("")}},alu:{operands:Vn(),results:Vn(),cog:{rot:new qe(0)},operation:{backgroundColor:new qe(Ct.stone[800])},resultText:{opacity:new qe(0)},leftText:{opacity:new qe(0)},rightText:{opacity:new qe(0)}},decoder:{path:Vn(),progress:{progress:new qe(0),opacity:new qe(1)}},AX:He(),BX:He(),CX:He(),DX:He(),AL:He(),BL:He(),CL:He(),DL:He(),SP:He(),"SP.l":He(),"SP.h":He(),IP:He(),"IP.l":He(),"IP.h":He(),IR:He(),ri:{...He(),opacity:new qe(0)},"ri.l":He(),"ri.h":He(),id:{...He(),opacity:new qe(0)},"id.l":He(),"id.h":He(),left:He(),"left.l":He(),"left.h":He(),right:He(),"right.l":He(),"right.h":He(),result:He(),"result.l":He(),"result.h":He(),FLAGS:He(),"FLAGS.l":He(),"FLAGS.h":He(),MAR:He(),MBR:He()},handshake:{DATA:He(),STATE:He()},memory:{"operating-cell":{color:new qe(Ct.white)}},pic:{IMR:He(),IRR:He(),ISR:He(),INT0:He(),INT1:He(),INT2:He(),INT3:He(),INT4:He(),INT5:He(),INT6:He(),INT7:He()},pio:{PA:He(),PB:He(),CA:He(),CB:He()},printer:{printing:{progress:new qe(0),opacity:new qe(1)}},timer:{CONT:He(),COMP:He()}};function $e(t){try{return Fj(Py,t)}catch{const n=t.split(".");let i=Py;for(const r of n)if(r in i)i=i[r];else return console.warn(`Path not found: ${t}`),{backgroundColor:new qe(Ct.stone[800]),opacity:new qe(1),stop(){},pause(){},resume(){},start:()=>Promise.resolve(),set(){},get:()=>Ct.stone[800],isPaused:!1};return i}}function GB(t){const e={};for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];i instanceof qe?e[n]=i.get():e[n]=GB(i)}return e}const Mse=GB(Py);function XB(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];i instanceof qe?i.set(e[n]):XB(t[n],e[n])}}const Rse=()=>XB(Py,Mse),F=new IE({allowSelfLoops:!1});F.addNode("MBR",{position:[615,249]});F.addNode("MBR bottom",{position:[615,274]});F.addNode("MBR reg input",{position:[595,249]});F.addNode("AL",{position:[455,45]});F.addNode("BL",{position:[455,85]});F.addNode("CL",{position:[455,125]});F.addNode("DL",{position:[455,165]});F.addNode("id",{position:[455,205]});F.addNode("SP",{position:[455,309]});F.addNode("IP",{position:[455,349]});F.addNode("ri",{position:[455,388]});F.addNode("ri out",{position:[480,388]});F.addNode("MAR",{position:[630,349]});F.addNode("result",{position:[272,115]});F.addNode("NodoRegIn",{position:[390,115]});F.addNode("NodoRegOut",{position:[550,115]});F.addNode("FLAGS",{position:[250,225]});F.addNode("IR",{position:[250,275]});F.addNode("IR mbr join",{position:[250,250]});F.addNode("left",{position:[130,85]});F.addNode("right",{position:[125,145]});F.addNode("left end",{position:[220,85]});F.addNode("right end",{position:[220,145]});F.addNode("result start",{position:[280,115]});F.addNode("rmbr",{position:[250,390]});F.addNode("bleft1",{position:[550,16]});F.addNode("bleft2",{position:[90,16]});F.addNode("bleft3",{position:[90,85]});F.addNode("CL join",{position:[425,125]});F.addNode("AL join",{position:[425,45]});F.addNode("BL join",{position:[425,85]});F.addNode("MBR top",{position:[615,215]});F.addNode("DL join",{position:[425,165]});F.addNode("id join",{position:[425,205]});F.addNode("data mbr join",{position:[390,250]});F.addNode("mbr approach horizontal",{position:[580,250]});F.addNode("mbr approach vertical",{position:[580,215]});F.addNode("mbr top approach",{position:[600,215]});F.addNode("mbr top entry",{position:[615,215]});F.addNode("mbr bottom exit",{position:[615,285]});F.addNode("mbr to bus horizontal",{position:[585,285]});F.addNode("mbr to bus join",{position:[585,250]});F.addNode("mbr to cpu center",{position:[390,250]});F.addNode("mbr to ir horizontal",{position:[250,250]});F.addNode("mbr to ir vertical end",{position:[250,272]});F.addNode("mbr to ir approach",{position:[250,275]});F.addNode("mbr to ri vertical",{position:[425,388]});F.addNode("SP join",{position:[425,309]});F.addNode("IP join",{position:[390,349]});F.addNode("ri join",{position:[425,388]});F.addNode("MAR join1",{position:[550,388]});F.addNode("MAR join2",{position:[550,349]});F.addNode("result mbr join",{position:[370,250]});F.addNode("FLAGS mbr join",{position:[250,250]});F.addNode("left join",{position:[30,85]});F.addNode("right join",{position:[90,145]});F.addNode("operands mbr join",{position:[90,250]});F.addNode("outr mbr join",{position:[550,250]});F.addNode("mbr reg join",{position:[390,250]});F.addNode("MBR join",{position:[390,250]});F.addNode("AL out",{position:[483,45]});F.addNode("BL out",{position:[483,85]});F.addNode("CL out",{position:[483,125]});F.addNode("DL out",{position:[483,165]});F.addNode("id out",{position:[483,205]});F.addNode("MBR out",{position:[626,249]});F.addNode("MBR out join",{position:[550,250]});F.addNode("SP out",{position:[510,309]});F.addNode("IP out",{position:[510,349]});F.addNode("IP out join",{position:[550,349]});F.addNode("ri out join",{position:[525,388]});F.addNode("SP out join",{position:[525,309]});F.addNode("AL out join",{position:[525,45]});F.addNode("BL out join",{position:[525,85]});F.addNode("CL out join",{position:[525,125]});F.addNode("DL out join",{position:[525,165]});F.addNode("id out join",{position:[521,205]});F.addUndirectedEdge("AL","AL out");F.addUndirectedEdge("BL","BL out");F.addUndirectedEdge("CL","CL out");F.addUndirectedEdge("DL","DL out");F.addUndirectedEdge("id","id out");F.addUndirectedEdge("IP","IP out");F.addUndirectedEdge("SP","SP out");F.addUndirectedEdge("AL out","AL out join");F.addUndirectedEdge("BL out","BL out join");F.addUndirectedEdge("BL out","mbr approach horizontal");F.addUndirectedEdge("CL out","CL out join");F.addUndirectedEdge("DL out","DL out join");F.addUndirectedEdge("id out","id out join");F.addUndirectedEdge("AL out join","NodoRegOut");F.addUndirectedEdge("BL out join","NodoRegOut");F.addUndirectedEdge("CL out join","NodoRegOut");F.addUndirectedEdge("DL out join","NodoRegOut");F.addUndirectedEdge("id out join","NodoRegOut");F.addUndirectedEdge("NodoRegOut","outr mbr join");F.addUndirectedEdge("NodoRegOut","bleft1");F.addUndirectedEdge("bleft1","bleft2");F.addUndirectedEdge("bleft2","bleft3");F.addUndirectedEdge("bleft3","left");F.addUndirectedEdge("left","left end");F.addUndirectedEdge("IP out join","outr mbr join");F.addUndirectedEdge("ri out join","outr mbr join");F.addUndirectedEdge("SP out join","outr mbr join");F.addUndirectedEdge("SP out join","MAR join2");F.addUndirectedEdge("outr mbr join","MAR join2");F.addUndirectedEdge("outr mbr join","data mbr join");F.addUndirectedEdge("MBR","outr mbr join");F.addUndirectedEdge("MBR","MBR out");F.addUndirectedEdge("MBR out","MBR out join");F.addUndirectedEdge("MBR out join","NodoRegOut");F.addUndirectedEdge("MBR out","outr mbr join");F.addUndirectedEdge("mbr reg join","NodoRegIn");F.addUndirectedEdge("outr mbr join","MBR join");F.addUndirectedEdge("MBR join","NodoRegIn");F.addUndirectedEdge("NodoRegIn","AL join");F.addUndirectedEdge("NodoRegIn","BL join");F.addUndirectedEdge("NodoRegIn","CL join");F.addUndirectedEdge("NodoRegIn","DL join");F.addUndirectedEdge("NodoRegIn","id join");F.addUndirectedEdge("outr mbr join","operands mbr join");F.addUndirectedEdge("AL join","AL");F.addUndirectedEdge("BL join","BL");F.addUndirectedEdge("CL join","CL");F.addUndirectedEdge("DL join","DL");F.addUndirectedEdge("id join","id");F.addUndirectedEdge("id join","data mbr join");F.addUndirectedEdge("MBR","data mbr join");F.addUndirectedEdge("MBR","MBR top");F.addUndirectedEdge("MBR","MBR bottom");F.addUndirectedEdge("MBR","MBR reg input");F.addUndirectedEdge("NodoRegOut","MBR reg input");F.addUndirectedEdge("outr mbr join","mbr approach horizontal");F.addUndirectedEdge("mbr approach horizontal","mbr approach vertical");F.addUndirectedEdge("mbr approach vertical","mbr top approach");F.addUndirectedEdge("mbr top approach","mbr top entry");F.addUndirectedEdge("mbr top entry","MBR top");F.addUndirectedEdge("MBR bottom","mbr bottom exit");F.addUndirectedEdge("mbr bottom exit","mbr to bus horizontal");F.addUndirectedEdge("mbr to bus horizontal","mbr to bus join");F.addUndirectedEdge("mbr to bus join","mbr to cpu center");F.addUndirectedEdge("mbr to cpu center","mbr to ir horizontal");F.addUndirectedEdge("mbr to ir horizontal","mbr to ir vertical end");F.addUndirectedEdge("mbr to ir vertical end","mbr to ir approach");F.addUndirectedEdge("mbr to ir approach","IR");F.addUndirectedEdge("mbr to cpu center","mbr to ri vertical");F.addUndirectedEdge("mbr to ri vertical","ri");F.addUndirectedEdge("data mbr join","NodoRegIn");F.addUndirectedEdge("IP","IP join");F.addUndirectedEdge("SP","SP join");F.addUndirectedEdge("ri","ri join");F.addUndirectedEdge("ri","ri out");F.addUndirectedEdge("ri out","ri out join");F.addUndirectedEdge("MAR join1","ri");F.addUndirectedEdge("MAR join2","MAR join1");F.addUndirectedEdge("MAR","MAR join2");F.addUndirectedEdge("IP join","SP join");F.addUndirectedEdge("SP join","ri join");F.addUndirectedEdge("result start","result");F.addUndirectedEdge("result","NodoRegIn");F.addUndirectedEdge("FLAGS","FLAGS mbr join");F.addUndirectedEdge("FLAGS mbr join","data mbr join");F.addUndirectedEdge("IR","IR mbr join");F.addUndirectedEdge("IR mbr join","FLAGS mbr join");F.addUndirectedEdge("left","left join");F.addUndirectedEdge("right","right join");F.addUndirectedEdge("left join","right join");F.addUndirectedEdge("right join","operands mbr join");F.addUndirectedEdge("right","right end");F.addNode("NodoRegOutLeft",{position:[550,90]});F.addUndirectedEdge("MBR out join","NodoRegOutLeft");F.addUndirectedEdge("NodoRegOutLeft","bleft1");F.addNode("NodoRegOutRight",{position:[550,140]});F.addUndirectedEdge("MBR out join","NodoRegOutRight");F.addUndirectedEdge("NodoRegOutRight","outr mbr join");F.addNode("NodoRegOutToRight",{position:[540,115]});F.addUndirectedEdge("NodoRegOut","NodoRegOutToRight");F.addUndirectedEdge("NodoRegOutToRight","outr mbr join");F.addNode("outr mbr join left",{position:[560,250]});F.addNode("NodoRegOutToLeft",{position:[560,115]});F.addUndirectedEdge("outr mbr join left","NodoRegOutToLeft");F.addUndirectedEdge("NodoRegOutToLeft","NodoRegOut");function Ise(t,e,n){const r=(a=>a.replace(/\.(l|h)$/,""))(t);if(!F.hasNode(r))return console.warn(`Nodo origen '${r}' no existe en el grafo`),"";const s=Ti(t,"left end",e,n,{separateMBRPaths:!0,direction:"left"}),o=Ti(t,"right end",e,n,{separateMBRPaths:!0,direction:"right"});return s&&o?`${s} ${o}`:s||o||""}function Ti(t,e,n,i,r){console.log("🔍 generateDataPath llamado con:",{from:t,to:e,instruction:n,mode:i,options:r});const s=f=>{let p=f.replace(/\.(l|h)$/,"");return["MBR","AL","BL","CL","DL","SP","IP","MAR","FLAGS","IR","RESULT"].includes(p.toUpperCase())&&(p=p.toUpperCase()),p},o=s(t),a=s(e),l=["AL","BL","CL","DL","id","SP","IP","ri","MAR","MBR","left","right","left end","right end"];console.log("🔍 Debug inicial:",{normalizedFrom:o,normalizedTo:a,instruction:n,mode:i,isFromRegister:l.includes(o),isToMBR:a==="MBR",condition:l.includes(o)&&a==="MBR"});let c=[];if(console.log("🔍 Evaluando condición ri → MAR:",{normalizedFrom:o,normalizedTo:a,mode:i,condition:o==="ri"&&a==="MAR"&&i==="mem<-imd"}),o==="ri"&&a==="MAR"&&i==="mem<-imd")return console.log("🎯 Usando ruta especial ri → MAR:","M 455 388 H 550 V 348 H 580"),"M 455 388  H 480 H 525 L 550 V 348 H 580";if(o==="ri"&&a==="left end")return console.log("🎯 Usando ruta especial ri → left end"),"M 455 388 H 480 H 550 H 590 V 250 H 30 V 85 H 125 H 220";if(o==="ri"&&a==="right end")return console.log("🎯 Usando ruta especial ri → right end"),"M 455 388 H 480 H 550 V 250 H 390 H 250 H 90 V 145 H 125 H 220";if(!F.hasNode(o))return console.warn(`Nodo origen '${o}' no existe en el grafo`),"";if(!F.hasNode(a))return console.warn(`Nodo destino '${a}' no existe en el grafo`),"";if(o==="FLAGS"&&a==="MBR")return console.log("🎯 Usando ruta FLAGS → MBR pasando por secuencia completa de nodos"),"M 250 225 L 250 250 L 390 250 L 550 250 L 580 250 L 580 215 L 600 215 L 615 215 L 615 215 L 615 249";if(o==="MBR"&&a==="IR"){const f=["MBR bottom","mbr bottom exit","mbr to bus horizontal","mbr to bus join","mbr to cpu center","mbr to ir horizontal","mbr to ir vertical end","mbr to ir approach","IR"],p=F.getNodeAttribute(f[0],"position");let m=`M ${p[0]} ${p[1]}`;for(let g=1;g<f.length;g++){const[y,v]=F.getNodeAttribute(f[g],"position");m+=` L ${y} ${v}`}return m}if(r!=null&&r.separateMBRPaths&&t==="MBR"&&(e==="left"||e==="right"))e==="left"?c=[o,`${o} out`,`${o} out join`,"outr mbr join left","NodoRegOutToLeft","NodoRegOut","bleft1","bleft2","bleft3","left","left end"]:e==="right"&&(c=[o,`${o} out`,`${o} out join`,"outr mbr join","mbr reg join","IR mbr join","operands mbr join","right join","right","right end"]);else if(a==="left")c=[o,`${o} out`,`${o} out join`,"NodoRegOut","bleft1","bleft2","bleft3","left","left end"];else if(a==="right")if(o==="MBR"){const f="MBR_down300";F.hasNode(f)||(F.addNode(f,{position:[620,300]}),F.addUndirectedEdge("MBR",f));const p="MBR_right125_300";F.hasNode(p)||(F.addNode(p,{position:[125,300]}),F.addUndirectedEdge(f,p)),c=["MBR bottom","MBR",f,p,"right","right end"]}else c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr reg join","IR mbr join","operands mbr join","right join","right","right end"];else if(o==="BL"&&a==="ri")c=["BL","BL out","BL out join","NodoRegOut","outr mbr join","MAR join2","MAR"];else if(o==="SP"&&a==="MAR")console.log("🎯 Usando ruta especial SP → MAR"),c=["SP","SP out","SP out join","MAR join2","MAR"];else if(["DL","AL","BL","CL"].includes(o)&&a==="ri"&&(n==null?void 0:n.toUpperCase())==="OUT")console.log(`🎯 Usando ruta especial ${o} → MAR para OUT (evitando nodos de entrada)`),c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","MAR join2","MAR"];else if(o==="MBR"&&a==="id"&&i==="mem<-imd"){console.log("🎯 Caso específico MBR → id detectado");const f=["MBR bottom","MBR","mbr reg join","NodoRegIn","id join","id"],p=F.getNodeAttribute(f[0],"position");let m=`M ${p[0]} ${p[1]}`;for(let g=1;g<f.length;g++){const[y,v]=F.getNodeAttribute(f[g],"position");m+=` L ${y} ${v}`}return console.log("🎯 Path definido para MBR → id:",m),m}else if(o==="MBR"&&a==="BL")c=["MBR bottom","mbr bottom exit","mbr to bus horizontal","mbr to bus join","outr mbr join","mbr reg join","NodoRegIn","BL join","BL"],console.log("🎯 Path definido para MBR → BL (animación desde MBR bottom, ingresando por mbr reg join, NodoRegIn, BL join):",c);else if(o==="MBR"&&["AL","BL","CL","DL","id"].includes(a))c=["MBR bottom","mbr bottom exit","mbr to bus horizontal","mbr to bus join","outr mbr join","mbr reg join","NodoRegIn",`${a} join`,a],console.log(`🎯 Path definido para MBR → ${a} (animación desde MBR bottom, pasando por bus gris y nodos de entrada):`,c);else if(o==="BL"&&a==="MBR")console.log("🎯 Caso específico BL → MBR detectado - evitando NodoRegIn y mbr reg join"),c=["BL","BL out","mbr approach horizontal","mbr approach vertical","mbr top approach","mbr top entry","MBR top","MBR"],console.log("🎯 Path definido para BL → MBR:",c);else if(l.includes(o)&&a==="MBR"&&(n==null?void 0:n.toUpperCase())==="OUT")console.log("🎯 Usando ruta prioritaria para OUT registro→MBR (evitando NodoRegIn y mbr reg join)"),c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr approach horizontal","mbr approach vertical","mbr top approach","mbr top entry","MBR top","MBR"];else if(l.includes(o)&&a==="MBR"&&(n==null?void 0:n.toUpperCase())==="PUSH")console.log("🎯 Usando ruta prioritaria para PUSH registro→MBR (evitando NodoRegIn y operands mbr join)"),c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr approach horizontal","mbr approach vertical","mbr top approach","mbr top entry","MBR top","MBR"];else if(l.includes(o)&&a==="MBR"&&(n==null?void 0:n.toUpperCase())==="MOV")console.log("🎯 Usando ruta prioritaria para MOV registro→MBR (evitando NodoRegOut y NodoRegIn)"),c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr approach horizontal","mbr approach vertical","mbr top approach","mbr top entry","MBR top","MBR"];else if(l.includes(o)&&l.includes(a))["SP","IP","ri"].includes(a)?c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr reg join","NodoRegIn",`${a} join`,a]:c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr reg join","NodoRegIn",`${a} join`,a];else if(l.includes(o)&&a==="MBR")c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr approach horizontal","mbr approach vertical","mbr top approach","mbr top entry","MBR top","MBR"];else if(o==="MBR"&&a==="ri"){console.log("🎯 Usando ruta directa MBR → ri (evitando NodoRegIn/NodoRegOut)"),c=["MBR bottom","mbr bottom exit","mbr to bus horizontal","mbr to bus join","mbr to cpu center","mbr to ri vertical","ri"];const f=F.getNodeAttribute(c[0],"position");let p=`M ${f[0]} ${f[1]}`;for(let m=1;m<c.length;m++){const[g,y]=F.getNodeAttribute(c[m],"position");p+=` L ${g} ${y}`}return console.log("🎯 Path SVG directo MBR → ri:",p),p}else try{c=cre(F,o,a)||[]}catch(f){return console.warn(`Error calculando ruta de ${o} a ${a}:`,f),""}if(o==="MBR"&&a==="IP"){const f=F.getNodeAttribute("MBR bottom","position"),p=F.getNodeAttribute("mbr bottom exit","position"),m=F.getNodeAttribute("mbr to bus horizontal","position"),g=F.getNodeAttribute("mbr to bus join","position"),y=F.getNodeAttribute("mbr to cpu center","position"),v=F.getNodeAttribute("IP","position");return console.log("🎯 Usando ruta especial MBR → IP desde MBR bottom (similar a MBR → IR)"),`M ${f[0]} ${f[1]} L ${p[0]} ${p[1]} L ${m[0]} ${m[1]} L ${g[0]} ${g[1]} L ${y[0]} ${y[1]} L ${y[0]} ${v[1]} L ${v[0]} ${v[1]}`}if(o==="ri"&&a==="IP")return console.log("🎯 Usando ruta especial ri → IP pasando por bus central a altura MBR"),"M 455 388 H 480 H 525 L 550 349 V 250 H 390 V 349 H 455";if(o==="MBR"&&a==="ri"&&["JMP","JZ","JC"].includes(n??""))return"";if(o==="MBR"&&a==="ri"&&(n==="CALL"||n==="INT")&&(c=["MBR bottom","mbr bottom exit","mbr to bus horizontal","mbr to bus join","mbr to cpu center","IP join","mbr to ri vertical","ri"]),o==="IP"&&a==="MBR"&&(n==="INT"||n==="CALL"))return"M 455 349 H 550 V 233 H 615 V 249";if(c.length===0)return console.warn(`No se encontró ruta de ${o} a ${a}`),"";for(const f of c)if(!F.hasNode(f))return console.error(`❌ Nodo "${f}" no existe en el grafo. Path completo:`,c),"";const u=F.getNodeAttribute(c[0],"position");let d=`M ${u[0]} ${u[1]}`;for(let f=1;f<c.length;f++){const[p,m]=F.getNodeAttribute(c[f],"position");d+=` L ${p} ${m}`}return console.log("🎯 generateDataPath retornando:",d),console.log("🎯 Path completo:",c),o==="MBR"&&a==="id"&&console.log("🎯 Path SVG generado para MBR → id:",d),d}function Qg(){const t=[615,274],e=[615,285],n=[580,285],i=[580,250],r=[550,250],s=[550,349],o=[630,349];return`M ${t[0]} ${t[1]} L ${e[0]} ${e[1]} L ${n[0]} ${n[1]} L ${i[0]} ${i[1]} L ${r[0]} ${r[1]} L ${s[0]} ${s[1]} L ${o[0]} ${o[1]}`}function Tse({showSP:t,showid:e,showri:n}){const{path:i,...r}=$e("cpu.internalBus.data"),{path:s,...o}=$e("cpu.internalBus.address"),a=rt(Wn),l=(a==null?void 0:a.phase)==="writeback",c=()=>l?"stroke-purple-400 drop-shadow-[0_0_8px_rgba(168,85,247,0.6)]":"stroke-mantis-400 drop-shadow-[0_0_8px_rgba(34,197,94,0.6)]",u=()=>l?"stroke-purple-300":"stroke-mantis-300";return h.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0 z-30",children:[h.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:["M 220 145 H 90","V 250 H 580","M 90 145 H 90","M 272 115 H 390","M 250 225 V 250","M 580 250 H 390","M 390 250 H 250","M 250 145 v 46","M 250 250 V 272","M 250 300 V 320","M 451 349 H 390 V 250",t?"M 390 349 L 425 309 L 455 309":"",n?"M 390 349 L 425 388 L 455 388":"","M 455 45 H 425","M 455 85 H 425","M 455 125 H 425","M 455 165 H 425",e?"M 455 205 H 425":"","M 550 40 V 250","M 550 45 V 16 H 90 V 84 H 220","M 390 250 V 115","M 390 115 L 425 45 L 455 45","M 390 115 L 425 85 L 455 85","M 390 115 L 425 125 L 455 125","M 390 115 L 425 165 L 455 165",e?"M 390 115 L 425 205 L 451 205":"","M 550 115 L 525 45 L 445 45","M 550 115 L 525 85 L 445 85","M 550 115 L 525 125 L 445 125","M 550 115 L 525 165 L 445 165",e?"M 550 115 L 521 205 L 441 205":"","M 550 250 H 585 V 222 H 615","M 550 250 H 585 V 285 H 700","M 645 249 V 222 H 615 V 233","M 615 274 V 285 H 645 V 249"].join(" ")}),h.jsx("circle",{cx:390,cy:115,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:550,cy:115,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:250,cy:250,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:390,cy:250,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:550,cy:250,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:550,cy:348,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:615,cy:222,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2})," ",h.jsx("circle",{cx:615,cy:287,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2})," ",(n||t)&&h.jsx("circle",{cx:390,cy:349,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx(nt.path,{d:i,className:`fill-none stroke-[3px] ${c()}`,strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:r}),h.jsx(nt.path,{d:i,className:`fill-none stroke-1 opacity-50 ${u()}`,strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:r}),h.jsx(nt.path,{d:s,className:"fill-none stroke-[#3B82F6] stroke-[3px] drop-shadow-[0_0_8px_rgba(59,130,246,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:o}),h.jsx(nt.path,{d:s,className:"fill-none stroke-[#60A5FA] stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:o})]})}const um=new Set;async function ce(t,e){const n=A.get(jt);if(!Ge().animations)return Promise.resolve();if(n.type==="stopped")return null;if(n.type==="paused")return await new Promise(a=>{const l=A.sub(jt,()=>{A.get(jt).type!=="paused"&&(l(),a())})}),await ce(t,e);const i=Ge();if(!i.animations&&!e.forceMs)return null;const s=Math.min(i.executionUnit,250),o={duration:e.forceMs?e.duration:i.animations?e.duration*s:1,easing:SB[e.easing]};return Array.isArray(t)||(t=[t]),await Promise.all(t.map(async({key:a,from:l,to:c})=>{if(c===void 0&&l===void 0)return null;try{const u=$e(a);if(c===void 0)return u.set(l);{um.add(a);const d=await $e(a).start({from:l,to:c,config:o});return um.delete(a),d}}catch(u){return console.warn(`Error animando la clave ${a}:`,u),null}}))}const qB=()=>um.forEach(t=>{try{const e=$e(t);e&&typeof e.pause=="function"&&e.pause()}catch(e){console.warn(`Error pausing animation for key ${t}:`,e)}}),KB=()=>um.forEach(t=>{try{const e=$e(t);e&&typeof e.resume=="function"&&e.resume()}catch(e){console.warn(`Error resuming animation for key ${t}:`,e)}});function XE(){um.forEach(t=>{try{const e=$e(t);e&&typeof e.stop=="function"&&(e.stop(!0),e.isPaused&&typeof e.resume=="function"&&e.resume())}catch(e){console.warn(`Error stopping animation for key ${t}:`,e)}}),setTimeout(()=>Rse(),10)}const Ose={AX:Ct.blue[500],BX:"#4F46E5",CX:"#3B82F6",DX:"#1E40AF",IP:Ct.red[500],SP:"#FACC15",MAR:Ct.blue[500],MBR:Ct.blue[500],IR:Ct.blue[500],FLAGS:"#F59E0B",result:"#10B981",id:"#06B6D4",ri:"#06B6D4",left:"#22C55E",right:"#16A34A"};function YB(t){const e=t.replace("cpu.","").split(".")[0];return Ose[e]||Ct.stone[600]}async function tt(t,e){try{if(t==="cpu.MBR"&&window.__nextTransferMBRtoIP||t==="cpu.right.l"||t==="cpu.left.l")return;const n=e||YB(t);await ce({key:`${t}.backgroundColor`,to:n},{duration:2,easing:"easeOutCubic"}),await ce({key:`${t}.backgroundColor`,to:Ct.stone[750]},{duration:3,easing:"easeInCubic"});return}catch(n){return console.warn(`No se pudo animar el registro ${t}:`,n),null}}async function Ze(t){try{return t==="cpu.right.l"||t==="cpu.left.l"?void 0:await ce({key:`${t}.backgroundColor`,to:Ct.stone[800]},{duration:2,easing:"easeInOutQuart"})}catch(e){return console.warn(`No se pudo desactivar el registro ${t}:`,e),null}}async function Pd(t){try{if(t==="cpu.MBR"&&window.__nextTransferMBRtoIP)return;const e=Ge(),n=YB(t);await ce({key:`${t}.backgroundColor`,to:n},{duration:2,easing:"easeOutQuart"});const i=e.animations?1e3:1;await new Promise(r=>setTimeout(r,i)),await ce({key:`${t}.backgroundColor`,to:Ct.stone[800]},{duration:2,easing:"easeInQuart"});return}catch(e){return console.warn(`No se pudo actualizar el registro ${t}:`,e),null}}async function hf(t){await tt("cpu.MBR"),A.set(ei,t),await Ze("cpu.MBR")}function Bk(){setTimeout(()=>{try{const t=$e("bus.rd.opacity");t&&t.set(0)}catch{}try{const t=$e("bus.wr.opacity");t&&t.set(0)}catch{}},0)}function Ny(){try{const t=$e("bus.rd.opacity");t&&t.start({to:1})}catch{}}function My(){try{const t=$e("bus.rd.opacity");t&&t.start({to:0})}catch{}}function qE(){try{const t=$e("bus.wr.opacity");t&&t.start({to:1})}catch{}}function KE(){try{const t=$e("bus.wr.opacity");t&&t.start({to:0})}catch{}}function JB(){try{const t=$e("cpu.alu.resultText.opacity");t&&t.start({to:1})}catch{}}function ZB(){try{const t=$e("cpu.alu.resultText.opacity");t&&t.start({to:0})}catch{}}function $k(){setTimeout(()=>{try{const t=$e("cpu.alu.resultText.opacity");t&&t.set(0)}catch{}},0)}function QB(){try{const t=$e("cpu.alu.leftText.opacity");t&&t.start({to:1})}catch{}}function e$(){try{const t=$e("cpu.alu.leftText.opacity");t&&t.start({to:0})}catch{}}function Fk(){setTimeout(()=>{try{const t=$e("cpu.alu.leftText.opacity");t&&t.set(0)}catch{}},0)}function t$(){try{const t=$e("cpu.alu.rightText.opacity");t&&t.start({to:1})}catch{}}function n$(){try{const t=$e("cpu.alu.rightText.opacity");t&&t.start({to:0})}catch{}}function zk(){setTimeout(()=>{try{const t=$e("cpu.alu.rightText.opacity");t&&t.set(0)}catch{}},0)}async function Bi(t,e){return await ce([{key:`${t}.strokeDashoffset`,from:1,to:0},{key:`${t}.opacity`,from:1}],{duration:e,easing:"easeInOutSine"})}async function li(t){return await ce({key:`${t}.opacity`,to:0},{duration:1,easing:"easeInSine"})}const Lse=Object.freeze(Object.defineProperty({__proto__:null,activateRegister:tt,anim:ce,deactivateRegister:Ze,getSettings:Ge,hideALULeftText:e$,hideALULeftTextOnInit:Fk,hideALUResultText:ZB,hideALUResultTextOnInit:$k,hideALURightText:n$,hideALURightTextOnInit:zk,hideControlBusTextsOnInit:Bk,hideReadControlText:My,hideWriteControlText:KE,pauseAllAnimations:qB,populateDataBus:hf,resumeAllAnimations:KB,showALULeftText:QB,showALUResultText:JB,showALURightText:t$,showReadControlText:Ny,showWriteControlText:qE,stopAllAnimations:XE,turnLineOff:li,turnLineOn:Bi,updateRegisterWithGlow:Pd},Symbol.toStringTag,{value:"Module"}));async function xT(t){switch(t.type){case"bus:io.selected":{await Promise.all([ce({key:"bus.mem.stroke",to:Ct.stone[700]},{duration:1,easing:"easeInSine"}),Bi(`bus.${t.chip}`,15)]);return}case"bus:io.error":{const e=t.error;if(e.code==="io-memory-not-connected"){let n;try{const i=e.context;if(i&&i[0]){const r=i[0];typeof r=="number"?n=r:r&&typeof r.valueOf=="function"&&(n=Number(r.valueOf()))}}catch{const s=e.message.match(/0x([0-9A-Fa-f]+)/);s&&(n=parseInt(s[1],16))}if(typeof n=="number"&&n>=48&&n<=51&&!Ge().devices.pio){console.log(`🔧 Detectada operación I/O en dirección PIO ${n.toString(16).toUpperCase()}h. Activando PIO automáticamente.`);const s={48:"PA",49:"PB",50:"CA",51:"CB"}[n]||"Unknown";zc("PIO activado automáticamente",`Se detectó una operación I/O en la dirección ${n.toString(16).toUpperCase()}h (${s}). El PIO se ha activado automáticamente.`),A.set(Li,a=>({...a,devices:{...a.devices,pio:"switches-and-leds","switches-and-leds":!0}}));const o=new CustomEvent("pioActivated",{detail:{address:n,registerName:s,shouldReload:!0}});window.dispatchEvent(o);return}if(typeof n=="number"&&n>=64&&n<=65&&!Ge().devices.handshake){console.log(`🔧 Detectada operación I/O en dirección Handshake ${n.toString(16).toUpperCase()}h. Activando impresora con Handshake automáticamente.`);const s={64:"HS_DATA",65:"HS_STATUS"}[n]||"Unknown";zc("Impresora (Handshake) activada automáticamente",`Se detectó una operación I/O en la dirección ${n.toString(16).toUpperCase()}h (${s}). La impresora con Handshake se ha activado automáticamente.`),A.set(Li,a=>({...a,devices:{...a.devices,handshake:"printer"}}));const o=new CustomEvent("handshakeActivated",{detail:{address:n,registerName:s,shouldReload:!0}});window.dispatchEvent(o);return}if(typeof n=="number"&&n>=32&&n<=43&&!Ge().devices.pic){console.log(`🔧 Detectada operación I/O en dirección PIC ${n.toString(16).toUpperCase()}h. Activando PIC automáticamente.`);const s={32:"EOI",33:"IMR",34:"IRR",35:"ISR",36:"INT0",37:"INT1",38:"INT2",39:"INT3",40:"INT4",41:"INT5",42:"INT6",43:"INT7"}[n]||`PIC_REG_${n.toString(16).toUpperCase()}h`;zc("PIC activado automáticamente",`Se detectó una operación I/O en la dirección ${n.toString(16).toUpperCase()}h (${s}). El PIC se ha activado automáticamente.`),A.set(Li,a=>({...a,devices:{...a.devices,pic:!0}}));const o=new CustomEvent("picActivated",{detail:{address:n,registerName:s,shouldReload:!0}});window.dispatchEvent(o);return}}Zr(t.error);return}case"bus:reset":{await Promise.all([ce([{key:"bus.address.strokeDashoffset",to:1},{key:"bus.data.strokeDashoffset",to:1},{key:"bus.rd.strokeDashoffset",to:1},{key:"bus.wr.strokeDashoffset",to:1}],{duration:1,easing:"easeInSine"}),ce({key:"bus.mem.stroke",to:Ct.red[500]},{duration:1,easing:"easeOutSine"}),li("bus.iom"),li("bus.handshake"),li("bus.pio"),li("bus.pic"),li("bus.timer")]);return}default:return t}}async function Dse(t){switch(console.log("🕐 [DEBUG] handleClockEvent llamado con evento:",t),t.type){case"clock:tick":{console.log("🕐 [DEBUG] Evento clock:tick recibido - iniciando animación");try{const e=$e("clock.angle");console.log("🕐 [DEBUG] Spring clock.angle obtenido:",e);const n=Ge(),i=n.clockSpeed;console.log("🕐 [DEBUG] Configuración del reloj:",{duration:i,clockSpeed:n.clockSpeed,animations:n.animations}),console.log("🕐 [DEBUG] Iniciando animación del spring clock.angle"),await ce({key:"clock.angle",from:0,to:360},{duration:i,forceMs:!0,easing:"linear"}),console.log("🕐 [DEBUG] Animación del reloj completada exitosamente")}catch(e){console.error("🕐 [ERROR] Error en la animación del reloj:",e)}return}default:return t.type}}function vs(t,e,n){let i="";switch(e&&(i="M 455 388 L 525 388 L 550 348 H 610"),n&&(i="M 594 249 H 550 V 348 H 610"),t){case"SP":return"M 455 309 L 525 309 L 550 348 H 610";case"IP":return"M 460 349 H 610";case"ri":return e||n?i:"M 455 388 L 525 388 L 550 348 H 610";default:throw new Error(`Invalid register ${t}`)}}function jse({showSP:t,showri:e}){const{path:n,...i}=$e("cpu.internalBus.address"),r=[t?"M 455 309 L 525 309 L 550 348":"","M 400 349 H 550 V 255",e?"M 455 388 L 525 388 L 550 348":"","M 400 349 H 610","M 610 349 H 650","M 390 115 H 250 V 205"];return h.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0 z-30",children:[r.map((s,o)=>h.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:s},o)),h.jsx(nt.path,{d:n,className:"fill-none stroke-[#3B82F6] stroke-[3px] drop-shadow-[0_0_8px_rgba(59,130,246,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:i}),h.jsx(nt.path,{d:n,className:"fill-none stroke-[#60A5FA] stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:i})]})}console.log("🔧 generateDataPath importado:",typeof Ti);let Cc=null,_c=null,e0=null,Jt=0,bt="";function Bse(){return Jt}function $se(){return bt}function Fse(t,e){Jt=t,bt=e,console.log(`🎯 updateInstructionContext: executeStageCounter=${t}, instructionName=${e}`)}let Zt="fetching";const Ui=async(t=.1)=>{console.log("📊 Animando solo secuenciador - progreso del paso:",t,"fase actual:",Zt);let e=t;Zt==="fetching"?(e=.15,console.log("📥 Fase de captación - incremento grande:",e)):Zt==="fetching-operands"?(e=.12,console.log("📥 Fase de captación de operandos - incremento mediano:",e)):(e=Math.min(t,.08),console.log("⚙️ Fase de ejecución/writeback - incremento menor:",e));const n=$e("sequencer.progress.progress").get(),i=Math.min(n+e,1);console.log(`📊 Progreso: ${(n*100).toFixed(1)}% → ${(i*100).toFixed(1)}%`),await ce({key:"sequencer.progress.progress",to:i},{duration:150,easing:"easeInOutSine",forceMs:!0})},zse=async(t=.1)=>{console.log("🧠 Animando memoria de control + secuenciador - progreso del paso:",t,"fase actual:",Zt);let e=t;Zt==="fetching"?(e=.15,console.log("📥 Fase de captación - incremento grande:",e)):Zt==="fetching-operands"?(e=.12,console.log("📥 Fase de captación de operandos - incremento mediano:",e)):(e=Math.min(t,.08),console.log("⚙️ Fase de ejecución/writeback - incremento menor:",e)),await ce([{key:"cpu.decoder.path.opacity",from:1},{key:"cpu.decoder.path.strokeDashoffset",from:1,to:0}],{duration:200,easing:"easeInOutSine",forceMs:!0});const i=$e("sequencer.progress.progress").get(),r=Math.min(i+e,1);console.log(`📊 Progreso: ${(i*100).toFixed(1)}% → ${(r*100).toFixed(1)}%`),await ce({key:"sequencer.progress.progress",to:r},{duration:150,easing:"easeInOutSine",forceMs:!0}),await ce({key:"cpu.decoder.path.opacity",to:0},{duration:100,easing:"easeInSine",forceMs:!0}),console.log(`✅ Unidades de control animadas - nuevo progreso: ${r}`)},dn=(t,e,n,i)=>{console.log("🎨 drawDataPath llamado con:",{from:t,to:e,instruction:n,mode:i});try{console.log("🔧 Antes de llamar generateDataPath"),console.log("🔧 generateDataPath es:",typeof Ti);const r=Ti(t,e,n,i);if(console.log("🔧 Después de llamar generateDataPath"),console.log("🎯 Ruta generada en drawDataPath:",r),!r)return console.log("❌ No hay ruta, retornando Promise.resolve()"),Promise.resolve();const s=Ge(),o=s.animations?s.executionUnit:1;return console.log("🔧 settings.animations:",s.animations),console.log("🔧 settings.executionUnit:",s.executionUnit),console.log("🔧 Duración de la animación:",o),ce([{key:"cpu.internalBus.data.path",from:r},{key:"cpu.internalBus.data.opacity",from:1},{key:"cpu.internalBus.data.strokeDashoffset",from:1,to:0}],{duration:o,easing:"easeInOutSine",forceMs:!0})}catch(r){return console.error("❌ Error en drawDataPath:",r),console.error("❌ Stack trace:",r instanceof Error?r.stack:"No stack trace"),Promise.resolve()}},Use=(t,e,n)=>{try{const i=Ise(t,e,n);if(!i)return Promise.resolve();const r=Ge(),s=r.animations?r.executionUnit:1;return ce([{key:"cpu.internalBus.data.path",from:i},{key:"cpu.internalBus.data.opacity",from:1},{key:"cpu.internalBus.data.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0})}catch(i){return console.warn("Error en drawSimultaneousLeftRightPath:",i),Promise.resolve()}},Zn=()=>ce({key:"cpu.internalBus.data.opacity",to:0},{duration:1,easing:"easeInSine"}),Vse=(t,e)=>{console.log("🎨 drawAddressPath llamado con:",{from:t,to:e});try{const n=vs(t);if(console.log("🎯 Ruta generada en drawAddressPath:",n),!n)return console.log("❌ No hay ruta para bus de direcciones, retornando Promise.resolve()"),Promise.resolve();const i=Ge(),r=i.animations?i.executionUnit:1;return console.log("🔧 Duración de la animación (bus de direcciones):",r),ce([{key:"cpu.internalBus.address.path",from:n},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:r,easing:"easeInOutSine",forceMs:!0})}catch(n){return console.error("❌ Error en drawAddressPath:",n),Promise.resolve()}},Hse=()=>ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),Wse=async(t,e,n)=>{console.log("🎯 Animación simultánea detectada: left y right desde",t),Zt!=="fetching-operands"&&(console.log("⏳ Esperando fase fetching-operands para animación simultánea..."),await new Promise(i=>{const r=()=>{Zt==="fetching-operands"?i():setTimeout(r,50)};r()}),console.log("✅ Fase fetching-operands alcanzada, procediendo con animación simultánea")),await Use(t,e,n),await Promise.all([tt("cpu.left"),tt("cpu.right")]),A.set(le.left,A.get(le[t])),A.set(le.right,A.get(le[t])),await Promise.all([Ze("cpu.left"),Ze("cpu.right")]),Cc=null,_c=null,await Zn()};let ee="",Le="",kn=null,jo=null,Vi=null,pc=null,mc=null;const La=t=>t.replace(/\.(l|h)$/,"");async function wT(){await Promise.all([Pd("cpu.MBR"),Pd("cpu.IP"),new Promise(t=>{window.dispatchEvent(new CustomEvent("ip-register-update")),t()})])}async function Uk(t){switch(console.log("🔍 CPU Event:",t.type,t),window.VONSIM_PARALLEL_ANIMATIONS&&t.type==="cpu:mar.set"&&window.dispatchEvent(new CustomEvent("vonsim:parallel-memory-read-visual")),t.type){case"cpu:alu.execute":{console.log("🚀 Evento cpu:alu.execute recibido, fase actual:",Zt),await Ui(.12);const e=Ge(),r={duration:e.animations?Math.min(e.executionUnit,250):1,easing:"easeInOutSine",forceMs:!0},s=bt==="INT"&&Zt==="fetching";e.animations&&!s?Zt!=="executing"?(console.log("⏳ Esperando fase executing para animación de la ALU..."),await new Promise(o=>{let a=0;const l=40;let c=0;const u=()=>{a++,(a%10===0||a!==c+1)&&(console.log(`🔍 Verificando fase actual: ${Zt} (intento ${a}/${l})`),c=a),Zt==="executing"?(console.log("✅ Fase executing alcanzada"),o()):a>=l?(console.warn("⚠️ Timeout esperando fase executing después de 2s, procediendo de todas formas"),console.warn(`🔍 Fase final: ${Zt}, se esperaba: executing`),o()):setTimeout(u,50)};u()}),console.log("✅ Fase executing alcanzada, procediendo con animación de la ALU")):console.log("✅ Ya estamos en fase executing, procediendo directamente"):s&&console.log("🔧 Operación interna detectada durante INT, saltando espera de fase"),await Promise.all([(async()=>{QB(),t$(),await ce([{key:"cpu.alu.operands.opacity",from:1},{key:"cpu.alu.operands.strokeDashoffset",from:1,to:0}],r),e$(),n$()})()]),A.set(uE,t.operation),await ce({key:"cpu.alu.operation.backgroundColor",to:Ct.mantis[400]},{duration:1,easing:"easeOutQuart"}),await ce({key:"cpu.alu.operation.backgroundColor",to:Ct.stone[800]},{duration:1,easing:"easeOutQuart"}),console.log("� Iniciando animación del bus de resultado..."),await ce([{key:"cpu.alu.results.opacity",from:1},{key:"cpu.alu.results.strokeDashoffset",from:1,to:0}],r),await Promise.all([tt("cpu.result"),tt("cpu.FLAGS")]),A.set(le.FLAGS,t.flags),A.set(le.result,t.result),await Promise.all([Ze("cpu.result"),Ze("cpu.FLAGS")]),console.log("💜 Mostrando texto del resultado después de actualizar FLAGS..."),e.animations&&(JB(),await new Promise(o=>setTimeout(o,1e3))),await Promise.all([ce({key:"cpu.alu.results.opacity",to:0},{duration:1,easing:"easeInSine"}),(async()=>{ZB()})()]),await ce({key:"cpu.alu.operands.opacity",to:0},{duration:1,easing:"easeInSine"});return}case"cpu:cycle.end":{Cc=null,_c=null,kn=null,jo=null,Vi=null,pc=null,mc=null,Zt="fetching";const{store:e}=await zp(async()=>{const{store:c}=await Promise.resolve().then(()=>_J);return{store:c}},void 0),{messageAtom:n,totalCycleCountAtom:i,currentInstructionCycleCountAtom:r,cycleCountAtom:s}=await zp(async()=>{const{messageAtom:c,totalCycleCountAtom:u,currentInstructionCycleCountAtom:d,cycleCountAtom:f}=await Promise.resolve().then(()=>MQ);return{messageAtom:c,totalCycleCountAtom:u,currentInstructionCycleCountAtom:d,cycleCountAtom:f}},void 0);if(bt==="CALL"){const c="Ejecución: write(Memoria[MAR]) ← MBR | IP ← ri";e.set(n,c);const u=e.get(s),d=e.get(r);e.set(s,u+1),e.set(r,d+1),console.log("✅ CALL cpu:cycle.end - Mensaje final establecido:",c),console.log("✅ CALL cpu:cycle.end - Ciclo 8 registrado:",{cycleCount:u+1,currentInstructionCycleCount:d+1})}const o=e.get(r);e.set(i,c=>c+o);const a=e.get(jt);a.type==="running"&&a.until==="cycle-change"?(console.log("🎯 Modo paso a paso: completando barra de progreso al 100%"),await ce({key:"sequencer.progress.progress",to:1},{duration:300,easing:"easeInOutSine",forceMs:!0}),console.log("✅ Instrucción completada - barra al 100% (se reiniciará al comenzar la siguiente)")):(console.log("🔄 Modo continuo: reiniciando barra de progreso a cero"),ce({key:"sequencer.progress.progress",to:0},{duration:200,easing:"easeInOutSine",forceMs:!0}));return}case"cpu:cycle.interrupt":{A.set(Wn,e=>"metadata"in e?{...e,phase:"interrupt"}:e),await ce([{key:"cpu.id.opacity",to:0},{key:"cpu.ri.opacity",to:0}],{duration:150,easing:"easeInOutQuad",forceMs:!0});return}case"cpu:cycle.start":{Ui(.05),ee=t.instruction.name,Le=t.instruction.willUse.ri?"mem<-imd":"",console.log("[cpu:cycle.start] instructionName:",ee,"willUse.ri:",t.instruction.willUse.ri,"mode:",Le,"position:",t.instruction.position),t.instruction.willUse.ri,t.instruction.willUse.ri,Cc=null,_c=null,kn=null,jo=null,Vi=null,pc=null,mc=null,Zt="fetching",j6(t.instruction.position.start),A.set(Wn,{phase:"fetching",metadata:t.instruction});const e=A.get(jt);e.type==="running"&&e.until==="cycle-change"&&(console.log("Modo paso a paso: reiniciando barra de progreso a cero para nueva instrucción"),await ce({key:"sequencer.progress.progress",to:0},{duration:250,easing:"easeInOutSine",forceMs:!0})),console.log("🔄 Asegurando que la barra de progreso del decodificador esté en cero"),await ce({key:"sequencer.progress.progress",to:0},{duration:200,easing:"easeInOutSine",forceMs:!0}),console.log("� Iniciando nueva instrucción - la barra comenzará a incrementarse durante la captación"),await ce([{key:"cpu.id.opacity",to:t.instruction.willUse.id?1:0},{key:"cpu.ri.opacity",to:t.instruction.willUse.ri?1:0}],{duration:150,easing:"easeInOutQuad",forceMs:!0});return}case"cpu:cycle.update":{const e=t.phase==="execute"?"executing":t.phase==="writeback"?"writeback":t.next==="fetch-operands"?"fetching-operands":t.next==="execute"?"executing":t.next==="writeback"?"writeback":t.next==="halting"?"halting":"fetching";Zt=e,console.log("🔄 Fase del ciclo actualizada:",Zt);let n=0;switch(e){case"fetching":n=0;break;case"fetching-operands":n=.25;break;case"executing":n=.5;break;case"writeback":n=.75;break;case"halting":n=1;break;default:n=0}ce({key:"sequencer.progress.progress",to:n},{duration:300,easing:"easeInOutSine",forceMs:!0}),A.set(Wn,i=>"metadata"in i?{...i,phase:e}:i);return}case"cpu:decode":{zse(.1),ce([{key:"cpu.decoder.progress.opacity",from:1},{key:"cpu.decoder.progress.progress",from:0,to:1}],{duration:150,easing:"easeInOutSine",forceMs:!0}),ce({key:"cpu.decoder.progress.opacity",to:0},{duration:80,easing:"easeInSine",forceMs:!0});return}case"cpu:error":{A.set(Wn,{phase:"stopped",error:t.error}),Zr(t.error);return}case"cpu:halt":case"cpu:int.0":{if(t.type==="cpu:halt"){A.set(go,!0),console.log("🛑 events.ts: isHaltExecutionAtom set to true before finishSimulation");const e=A.get(Wn);"metadata"in e&&(A.set(Wn,{phase:"halting",metadata:e.metadata}),await new Promise(n=>setTimeout(n,1e3)))}A.set(Wn,{phase:"stopped"}),Zr();return}case"cpu:int.6":{A.set(Wn,{phase:"int6"});return}case"cpu:int.7":{A.set(Wn,{phase:"int7"});return}case"cpu:inta.off":{await li("bus.inta");return}case"cpu:inta.on":{await Bi("bus.inta",10);return}case"cpu:rd.on":case"cpu:wr.on":{Ui(.05);const e=t.type.slice(4,6);window.dispatchEvent(new CustomEvent("vonsim:parallel-memory-write-visual")),await Bi(`bus.${e}`,10);return}case"cpu:iom.on":{await Bi("bus.iom",15);return}case"cpu:mar.set":{Ui(.05);const e=La(t.register),n=e==="MBR"||e==="ri"&&bt==="IN"&&Jt===4;if(e==="IP")if(console.log("🔄 Detectando transferencia IP→MAR para animación simultánea"),Vi={instruction:ee,mode:Le},console.log(`📝 Guardando pendingIPtoMARFromRegCopy desde cpu:mar.set: ${ee}, ${Le}`),kn&&kn.instruction===ee||jo&&jo.instruction===ee){if(kn&&kn.instruction===ee)console.log("🎯 Ejecutando animaciones simultáneas para MBR→ID + IP→MAR desde cpu:mar.set"),await Promise.all([dn("MBR","id",kn.instruction,kn.mode),(async()=>{const l=Ge(),u=l.animations?Math.min(l.executionUnit,250):1;return ce([{key:"cpu.internalBus.address.path",from:vs("IP")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:u,easing:"easeInOutSine",forceMs:!0})})()]),A.set(le.id,A.get(ei)),A.set(Qn,A.get(le.IP)),await Promise.all([tt("cpu.id"),tt("cpu.MAR")]),await Promise.all([Ze("cpu.id"),Ze("cpu.MAR")]),await Promise.all([Zn(),ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]),kn=null,Vi=null;else if(jo&&jo.instruction===ee){console.log("🎯 Ejecutando animación simultánea de buses para MBR→RI + IP→MAR (directo-inmediato)"),await Promise.all([(async()=>{const l=Ge(),u=l.animations?Math.min(l.executionUnit,250):1;return ce([{key:"cpu.internalBus.address.path",from:vs("IP")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:u,easing:"easeInOutSine",forceMs:!0})})(),dn("MBR","ri",ee,jo.mode)]),A.set(le.ri,A.get(ei)),A.set(Qn,A.get(le.IP)),await Promise.all([tt("cpu.ri"),tt("cpu.MAR")]),await Promise.all([Ze("cpu.ri"),Ze("cpu.MAR")]),await Promise.all([Zn(),ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]),jo=null,Vi=null;return}return}else{console.log("🎯 Ejecutando animación IP→MAR normal (sin transferencia simultánea)");{const l=Ge(),u=l.animations?Math.min(l.executionUnit,250):1;await ce([{key:"cpu.internalBus.address.path",from:vs("IP")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:u,easing:"easeInOutSine",forceMs:!0})}await tt("cpu.MAR",Ct.blue[500]),A.set(Qn,A.get(le.IP)),await Promise.all([Ze("cpu.MAR"),ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]),Vi=null;return}const i=e==="ri"&&(bt==="ADD"||bt==="SUB"||bt==="CMP")&&Jt>=5,r=e==="ri"&&(bt==="ADD"||bt==="SUB"||bt==="CMP"||bt==="AND"||bt==="OR"||bt==="XOR")&&!i&&(Jt>=5||Jt===4&&ee===bt)||e==="SP"&&bt==="INT"&&(Jt===4||Jt===5)||e==="ri"&&bt==="IN"&&Jt===2||e==="ri"&&bt==="IN"&&Jt===4;if(console.log("🔍 isRiToMARSimultaneous Debug:",{regNorm:e,currentInstructionName:bt,currentExecuteStageCounter:Jt,isRiToMARSimultaneous:i,isRiToMARSkipAnimation:r,mode:Le,instructionName:ee}),i&&!r)if(console.log(`🔄 Detectando transferencia ri→MAR para animación simultánea (paso 8) - ${bt}`),pc={instruction:ee,mode:Le},mc&&mc.instruction===ee){console.log("🎯 Ejecutando animaciones simultáneas para ri→MAR + MBR→id (paso 8)"),await Promise.all([ce([{key:"cpu.internalBus.address.path",from:vs("ri",!0,!1)},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),dn("MBR","id",ee,Le)]),A.set(Qn,A.get(le.ri)),A.set(le.id,A.get(ei)),await Promise.all([tt("cpu.MAR"),tt("cpu.id")]),await Promise.all([Ze("cpu.MAR"),Ze("cpu.id")]),await Promise.all([ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),Zn()]),pc=null,mc=null;return}else{A.set(Qn,A.get(le.ri));return}if(e==="ri"&&(bt==="ADD"||bt==="SUB"||bt==="CMP"||bt==="AND"||bt==="OR"||bt==="XOR")&&Jt===4&&Le==="mem<-imd"){console.log(`🎯 Caso especial detectado: ${bt} [BL], n - paso 6`),console.log("🎬 Ejecutando animaciones simultáneas: BL → MAR + MBR → ID");const l=Ge(),u=l.animations?Math.min(l.executionUnit,250):1;console.log("🚌 Iniciando animación del bus de direcciones BL → MAR"),console.log("📊 Iniciando animación del bus de datos MBR → ID"),await Promise.all([(async()=>{console.log("🚌 Generando path para BL → MAR usando ri");const d=vs("ri");return console.log("🚌 Path generado para BL → MAR:",d),ce([{key:"cpu.internalBus.address.path",from:d},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:u,easing:"easeInOutSine"})})(),(async()=>(console.log("📊 Ejecutando animación MBR → ID"),dn("MBR","id",ee,Le)))()]),console.log("✅ Ambas animaciones completadas, actualizando registros"),A.set(Qn,A.get(le.ri)),A.set(le.id,A.get(ei)),await Promise.all([tt("cpu.MAR"),tt("cpu.id")]),await Promise.all([Ze("cpu.MAR"),Ze("cpu.id")]),console.log("🧹 Reseteando animaciones de bus"),await Promise.all([ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),Zn()]),console.log("✅ Animaciones simultáneas completadas para paso 6");return}const o=n?Qg():vs(e);if(console.log("[cpu:mar.set] event.register:",t.register,"| Animación especial:",n,"| regNorm:",e,"| mode:",Le,"| instructionName:",ee,"| isRiToMARSkipAnimation:",r),!(e==="IP"&&Le==="mem<-imd")&&e!=="ri"&&!(e==="ri"&&(ee==="MOV"||ee==="ADD"||ee==="SUB"||ee==="CMP")&&Le!=="mem<-imd")&&(await ce([{key:"cpu.internalBus.address.path",from:o},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),await tt("cpu.MAR",Ct.blue[500]),A.set(Qn,A.get(le[e]))),e==="ri"&&!r&&!i){if(console.log("[cpu:mar.set] ri detectado, mode:",Le,"instructionName:",ee),(ee==="MOV"||ee==="ADD"||ee==="SUB"||ee==="CMP")&&Le!=="mem<-imd"){A.set(Qn,A.get(le.ri)),await tt("cpu.MAR",Ct.blue[500]),await Ze("cpu.MAR");return}if(ee==="OUT"&&Jt===2&&e0){console.log("✅ OUT paso 4 - actualizando MAR (animación ya mostrada en register.copy)",{instructionName:ee,mode:Le,executeStageCounter:Jt,sourceRegister:e0}),await tt("cpu.MAR",Ct.blue[500]),A.set(Qn,A.get(le.ri)),await Ze("cpu.MAR"),await ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),e0=null;return}console.log("✅ Animando bus de direcciones: ri → MAR",{instructionName:ee,mode:Le}),await Vse("ri","MAR"),await tt("cpu.MAR",Ct.blue[500]),A.set(Qn,A.get(le.ri)),await Ze("cpu.MAR"),await Hse();return}else e==="IP"&&Le==="mem<-imd"?(Vi={instruction:ee,mode:Le},console.log("📝 Marcando animación IP → MAR como pendiente desde cpu:mar.set")):r?(console.log("⏭️ Omitiendo animación para",e,"→ MAR (isRiToMARSkipAnimation)"),A.set(Qn,A.get(le[e])),await Ze("cpu.MAR"),console.log("✅ MAR actualizado desde",e,"sin animación y destello limpiado")):n||(await dn(e,"MAR",ee,Le),await Zn());!(e==="IP"&&Le==="mem<-imd")&&e!=="ri"&&!r&&await Promise.all([Ze("cpu.MAR"),ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]);return}case"cpu:mbr.get":{Zt==="fetching-operands"?await Ui(.07):await Ui(.05);const e=La(t.register);if(console.log("🎯 cpu:mbr.get - evento recibido:",{register:t.register,normalizedRegister:e,instructionName:ee,mode:Le}),(ee==="CALL"||ee==="INT")&&e==="ri"){const s=A.get(ei),o=A.get(le["ri.l"]);console.log(`🔍 ${ee} Debug - MBR → ri:`),console.log("  📍 Registro:",e,"| Modo:",Le),console.log("  📊 MBR Value:",s.unsigned,`(0x${s.unsigned.toString(16).padStart(2,"0").toUpperCase()})`),console.log("  📋 Ri Value (antes):",o.unsigned,`(0x${o.unsigned.toString(16).padStart(2,"0").toUpperCase()})`),console.log("  🎬 willSkipAnimation:",Le!=="mem<-imd"),console.log("  ✏️ willUpdateRegister:",e==="ri"&&Le==="mem<-imd"),console.log("  🎯 willDoActivation:",e==="ri"&&Le==="mem<-imd")}e==="IP"&&(window.__nextTransferMBRtoIP=!0,(ee==="RET"||ee==="IRET")&&(console.log(`🎯 ${ee} detectado: ejecutando animación MBR → IP inmediatamente`),await dn("MBR","IP",ee,Le)));const i=["ADD","SUB","AND","OR","XOR","CMP"].some(s=>ee.startsWith(s));let r=!1;if((e==="MAR"||e.startsWith("MAR."))&&!["ADD","SUB","CMP"].some(a=>ee.startsWith(a))){const a=A.get(le.IP),l=A.get(ei);a===l&&(r=!0)}if(e==="IR")await dn("MBR","IR",ee,Le);else if((e==="MAR"||e.startsWith("MAR."))&&!r){console.log("Animando bus de direcciones (azul): MBR → MAR en mbr.get",{instructionName:ee,mode:Le});const s=Ge(),o=s.animations?s.executionUnit:1;await ce([{key:"cpu.internalBus.address.path",from:Qg()},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:o,easing:"easeInOutSine",forceMs:!0})}else if(["AL","BL","CL","DL","ri","id"].includes(e)){const o=["ADD","SUB","CMP"].some(a=>ee.startsWith(a));if(e==="ri"&&Le==="mem<-imd")ee.startsWith("CALL")||ee.startsWith("INT")?(console.log(`🎯 ${ee} detectado: ejecutando animación MBR → ri inmediatamente en paso 6`),await dn("MBR","ri",ee,Le)):ee.startsWith("MOV")||ee.startsWith("ADD")||ee.startsWith("SUB")||ee.startsWith("CMP")||ee.startsWith("AND")||ee.startsWith("OR")||ee.startsWith("XOR")?(jo={instruction:ee,mode:Le,destination:"ri"},console.log("📝 Marcando animación MBR → ri como pendiente para animación simultánea")):(kn={instruction:ee,mode:Le,destination:"ri"},console.log("📝 Marcando animación MBR → ri como pendiente para animación simultánea (sistema existente)"));else if(e==="id"){const a=(bt==="ADD"||bt==="SUB"||bt==="CMP")&&Jt>=5;if(console.log("🔍 isStep8Simultaneous Debug:",{normalizedRegister:e,currentInstructionName:bt,currentExecuteStageCounter:Jt,isStep8Simultaneous:a,mode:Le,instructionName:ee}),a)if(console.log(`🔄 Detectando transferencia MBR→id para animación simultánea (paso 8) - ${bt}`),mc={instruction:ee,mode:Le},pc&&pc.instruction===ee){console.log("🎯 Ejecutando animaciones simultáneas para ri→MAR + MBR→id (paso 8)"),await Promise.all([ce([{key:"cpu.internalBus.address.path",from:vs("ri",!0,!1)},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),dn("MBR","id",ee,Le)]),A.set(Qn,A.get(le.ri)),A.set(le.id,A.get(ei)),await Promise.all([tt("cpu.MAR"),tt("cpu.id")]),await Promise.all([Ze("cpu.MAR"),Ze("cpu.id")]),await Promise.all([ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),Zn()]),pc=null,mc=null;return}else{A.set(le.id,A.get(ei));return}else if(console.log("🔄 Detectando transferencia MBR→ID para animación simultánea"),kn={instruction:ee,mode:Le,destination:"id"},console.log(`📝 Guardando pendingMBRtoID desde cpu:mbr.get: ${ee}, ${Le}`),Vi&&Vi.instruction===ee){console.log("🎯 Ejecutando animaciones simultáneas para MBR→ID + IP→MAR desde cpu:mbr.get"),await Promise.all([dn("MBR","id",kn.instruction,kn.mode),(async()=>{const l=Ge(),u=l.animations?Math.min(l.executionUnit,250):1;return ce([{key:"cpu.internalBus.address.path",from:vs("IP")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:u,easing:"easeInOutSine",forceMs:!0})})()]),A.set(le.id,A.get(ei)),A.set(Qn,A.get(le.IP)),await Promise.all([tt("cpu.id"),tt("cpu.MAR")]),await Promise.all([Ze("cpu.id"),Ze("cpu.MAR")]),await Promise.all([Zn(),ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]),kn=null,Vi=null;return}else{A.set(le.id,A.get(ei));return}}else(!i||o)&&(e==="ri"&&Le!=="mem<-imd"&&(ee==="MOV"||ee==="ADD"||ee==="SUB"||ee==="CMP")?(console.log("📘 Animación de direcciones (mbr.get directo): MBR → MAR (bus azul)"),await ce([{key:"cpu.internalBus.address.path",from:Qg()},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),await ce({key:"cpu.internalBus.address.opacity",to:0},{duration:100,easing:"easeInSine",forceMs:!0}),console.log("⏭️ Omitiendo animación de datos MBR → ri en direccionamiento directo (mbr.get)")):e==="ri"&&Le!=="mem<-imd"&&ee!=="IN"?console.log("⏭️ Omitiendo animación MBR → ri para direccionamiento directo"):e==="ri"&&ee==="IN"?(console.log("🎯 IN ciclo 6 detectado: mostrando animación MBR → MAR (bus de direcciones)"),await ce([{key:"cpu.internalBus.address.path",from:Qg()},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),await ce({key:"cpu.internalBus.address.opacity",to:0},{duration:100,easing:"easeInSine",forceMs:!0})):await dn("MBR",e,ee,Le))}if((!(e==="ri"&&Le==="mem<-imd")||ee==="CALL"||ee==="INT")&&(A.set(le[t.register],A.get(ei)),(ee==="CALL"||ee==="INT")&&e==="ri")){const s=A.get(le[t.register]);console.log(`🔥 ${ee} - Registro ri actualizado:`,s.unsigned,`(0x${s.unsigned.toString(16).padStart(2,"0").toUpperCase()})`)}if(e==="IR")await Pd(`cpu.${e}`);else if(e==="IP"){if(ee==="RET"||ee==="INT"){console.log(`🎯 ${ee} detectado: mostrando animación MBR → IP`);try{await dn("MBR","IP",ee,Le),await tt("cpu.IP"),await Ze("cpu.IP")}catch(s){console.error(`❌ Error en animación MBR → IP para ${ee}:`,s)}}}else e==="ri"?(console.log(`🔍 Evaluando activación para ri - instructionName: ${ee}, mode: ${Le}`),ee==="CALL"?(console.log(`✅ Activando registro ri para ${ee}`),await tt(`cpu.${e}`),await Ze(`cpu.${e}`)):ee==="INT"?console.log("⏭️ Omitiendo activación de ri para INT (se activará en register.update con el mensaje combinado)"):Le!=="mem<-imd"?(console.log("✅ Activando registro ri (modo no es mem<-imd)"),await tt(`cpu.${e}`),await Ze(`cpu.${e}`)):console.log("⏭️ Omitiendo activación de ri (animación simultánea posterior)")):!(e==="ri"&&Le==="mem<-imd")||ee==="CALL"||ee==="INT"?(console.log(`✅ Activando registro ${e}`),await tt(`cpu.${e}`),await Ze(`cpu.${e}`)):console.log(`⏭️ Omitiendo activación de ${e}`);if((!(e==="ri"&&Le==="mem<-imd")||ee==="CALL"||ee==="INT"||ee==="RET")&&await Zn(),Zt==="fetching-operands"&&e!=="IR"){const s=ee&&(ee==="MOV"||ee==="ADD"||ee==="SUB"||ee==="CMP"||ee==="AND"||ee==="OR"||ee==="XOR");(s&&e==="MBR"||!s&&e!=="MBR")&&(Zt="fetching-operands-completed",console.log("✅ Fase 'fetch-operands' completada al escribir en",e),A.set(Wn,a=>"metadata"in a?{...a,phase:"fetching-operands-completed"}:a))}return}case"cpu:mbr.set":{Ui(.05),Zt==="writeback"&&ce({key:"sequencer.progress.progress",to:.9},{duration:200,easing:"easeInOutSine",forceMs:!0}),bt==="INT"&&Jt===5&&(console.log("🧹 INT paso 7: Limpiando bus de direcciones antes de FLAGS → MBR"),await ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}));const e=La(t.register);if(ee==="MOV"&&["AL","BL","CL","DL","AH","BH","CH","DH"].includes(e)&&Jt===5){console.log(`🎯 cpu:mbr.set: Registrando paso 7 para ${ee} [memoria], ${e}`),console.log(`📊 Estado antes: executeStageCounter=${Jt}, register=${t.register}`),Jt++,console.log(`📊 Execute Stage Counter incrementado a: ${Jt} (Paso 7)`);const i=A.get(jt);console.log("🔍 Estado de simulación:",i),i.type==="running"&&i.until==="cycle-change"&&(console.log("⏸️ Pausando simulación después del paso 7 (cpu:mbr.set) - ejecución por ciclo"),setTimeout(()=>{Ot()},100))}else console.log(`ℹ️ No se activó contabilización paso 7: instructionName=${ee}, register=${e}, executeStageCounter=${Jt}`);if((ee==="CALL"||ee==="INT")&&e==="IP")console.log(`🎯 ${ee} detectado: ejecutando animación IP → MBR inmediatamente`),await dn("IP","MBR",ee,Le),A.set(ei,A.get(le[t.register])),await Zn();else if(e==="IP")await wT();else{const i=t.register.replace(/\.(l|h)$/,"");console.log(`🔍 Animación MBR.set: ${i} → MBR para ${ee}`),console.log(`🔍 Event.register original: ${t.register}`),console.log(`🔍 Normalized source: ${i}`),await dn(i,"MBR",ee,Le),A.set(ei,A.get(le[t.register])),await Zn()}return}case"cpu:register.copy":{const e=La(t.src),n=La(t.dest);if(console.log(`🔄 cpu:register.copy: ${t.src} → ${t.dest} (normalizado: ${e} → ${n})`),bt==="IN"&&(e==="DL"||e==="DX")&&n==="ri"&&Jt===2){console.log(`📝 IN detectado - mostrando animación especial del bus de direcciones: ${e} → MAR`),await Ui(.05);let r="";e==="DL"?r="M 455 165 L 483 165 L 525 165 L 550 115 L 550 348 H 610":e==="DX"&&(r="M 455 125 L 483 125 L 525 125 L 550 115 L 550 348 H 610"),console.log(`🎯 Path del bus de direcciones (${e} → MAR): ${r}`),await Promise.all([ce([{key:"cpu.internalBus.address.path",from:r},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),tt(`cpu.${e}`,Ct.blue[500])]),await tt("cpu.MAR",Ct.blue[500]),A.set(le[n],A.get(le[e])),await Promise.all([Ze("cpu.MAR"),Ze(`cpu.${e}`)]),await ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"});return}if(bt==="OUT"&&(e==="DL"||e==="DX")&&n==="ri"&&Jt===2){console.log(`📝 OUT detectado - mostrando animación del bus de datos: ${e} → MAR (evitando nodos de entrada)`),e0=e,await Ui(.05),await dn(e,"ri",ee,Le),await tt("cpu.MAR",Ct.blue[500]),A.set(le[n],A.get(le[e])),await Ze("cpu.MAR"),await Zn();return}if((n==="left"||n==="right")&&Zt==="executing"?await Ui(.1):n==="result"&&Zt==="writeback"?await Ui(.15):(e==="MBR"||e==="ri")&&Zt==="fetching-operands"?await Ui(.08):await Ui(.05),(n==="left"||n==="right")&&(ee==="ADD"&&Le==="mem<-imd")){if(console.log(`🎯 Detectando preparación de operando ALU: ${e} → ${n} para ${ee}`),e==="ri"&&n==="right"){console.log("📋 Animación ALU: Valor inmediato (ri) → operando derecho ALU"),await Promise.all([dn("ri","right",ee,Le),ce([{key:"cpu.internalBus.address.path",from:vs("ri")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0})]),A.set(le.right,A.get(le[e])),await Promise.all([tt("cpu.right"),tt("cpu.MAR")]),await Promise.all([Ze("cpu.right"),Ze("cpu.MAR")]),await Promise.all([Zn(),ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]);return}else if(e==="id"&&n==="left"){console.log("📋 Animación ALU: Valor de memoria (id) → operando izquierdo ALU"),await Promise.all([dn("id","left",ee,Le),dn("MBR","id",ee,Le)]),A.set(le.left,A.get(le[e])),await Promise.all([tt("cpu.left"),tt("cpu.id")]),await Promise.all([Ze("cpu.left"),Ze("cpu.id")]),await Zn();return}}if(n==="left"||n==="right"){const r={from:e,instruction:ee,mode:Le};if(n==="left"?Cc=r:n==="right"&&(_c=r),Cc&&_c&&Cc.from===_c.from&&Cc.instruction===_c.instruction){await Wse(e,ee,Le);return}n==="left"?A.set(le.left,A.get(le[e])):A.set(le.right,A.get(le[e]));return}if(e==="MBR"&&(n==="id"||n==="ri")||e==="IP"&&n==="MAR"){if(console.log(`🔄 Detectando transferencia para animación simultánea: ${e} → ${n}`),e==="MBR"&&(n==="id"||n==="ri")?(kn={instruction:ee,mode:Le,destination:n},console.log(`📝 Guardando pendingMBRtoID: ${ee}, ${Le}, destino: ${n}`)):e==="IP"&&n==="MAR"&&(Vi={instruction:ee,mode:Le},console.log(`📝 Guardando pendingIPtoMARFromRegCopy: ${ee}, ${Le}`)),kn&&Vi&&kn.instruction===Vi.instruction){const r=kn.destination;console.log(`🎯 Ejecutando animaciones simultáneas para MBR→${r} + IP→MAR`),await Promise.all([dn("MBR",r,kn.instruction,kn.mode),(async()=>{const o=Ge(),l=o.animations?Math.min(o.executionUnit,250):1;return ce([{key:"cpu.internalBus.address.path",from:vs("IP")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:l,easing:"easeInOutSine",forceMs:!0})})(),ce({key:"cpu.alu.cog.rot",to:6},{duration:3,easing:"easeInOutCubic"})]),r==="id"?A.set(le.id,A.get(le.MBR)):r==="ri"&&A.set(le.ri,A.get(le.MBR)),A.set(Qn,A.get(le.IP));const s=r==="id"?"cpu.id":"cpu.ri";await Promise.all([tt(s),tt("cpu.MAR")]),await Promise.all([Ze(s),Ze("cpu.MAR")]),await Promise.all([Zn(),ce({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),ce({key:"cpu.alu.cog.rot",to:0},{duration:1,easing:"easeInOutSine"})]),kn=null,Vi=null;return}e==="MBR"&&n==="id"?A.set(le.id,A.get(le.MBR)):e==="MBR"&&n==="ri"?A.set(le.ri,A.get(le.MBR)):e==="IP"&&n==="MAR"&&A.set(Qn,A.get(le.IP));return}e==="ri"&&n==="IP"?ee==="CALL"?(console.log("🎯 Animando ri → IP para instrucción CALL"),await dn("ri","IP",ee,Le)):["JMP","JZ","JNZ","JC","JNC","JS","JNS","JO","JNO"].includes(ee)?(console.log(`🎯 Animando MBR → IP para instrucción de salto: ${ee}`),await dn("MBR","IP",ee,Le)):console.log("⚠️  Saltando animación para transferencia ri → IP"):(console.log(`🎯 Ejecutando drawDataPath para transferencia normal: ${e} → ${n}`),await dn(e,n,ee,Le)),await tt(`cpu.${n}`),A.set(le[n],A.get(le[e])),await Ze(`cpu.${n}`),await Zn();return}case"cpu:register.update":{Ui(.05);const[e]=G2(t.register),n=La(e);if(bt==="INT"&&Jt===4&&n==="SP"&&(console.log("🎯 INT paso 6 en register.update - Activando ri con destello ANTES de SP"),await tt("cpu.ri"),await Ze("cpu.ri")),n==="IP"||n==="MBR")await wT();else if(n==="SP"){await Pd("cpu.SP");let i="+1";switch(bt){case"PUSH":case"CALL":case"INT":i="-1";break;case"RET":case"IRET":case"POP":i="+1";break;default:i="+1";break}window.dispatchEvent(new CustomEvent("sp-register-update",{detail:{type:i}}))}else await Pd(n==="ri"?"cpu.ri":`cpu.${n}`);A.set(le[t.register],t.value);return}case"cpu:register.buscopy":{const e=La(t.src),n=La(t.dest);e==="ri"&&n.toLowerCase()==="mar"||e==="ri"&&n==="IP"||(await dn(e,n,ee,Le),await new Promise(i=>setTimeout(i,150))),A.set(le[n],A.get(le[e])),await tt(`cpu.${n}`),await Ze(`cpu.${n}`),n!=="ri"&&await Zn();return}default:return t}}const Gse=Object.freeze(Object.defineProperty({__proto__:null,getCurrentExecuteStageCounter:Bse,getCurrentInstructionName:$se,handleCPUEvent:Uk,updateInstructionContext:Fse},Symbol.toStringTag,{value:"Module"}));async function Xse(t){switch(t.type){case"f10:press":await Bi("bus.int0",2),await li("bus.int0");return;default:return t.type}}const YE=me(H.zero(8)),JE=me(H.zero(8));function qse(t){t.io.handshake&&(A.set(YE,H.fromUnsigned(t.io.handshake.DATA,8)),A.set(JE,H.fromUnsigned(t.io.handshake.STATE,8)))}async function Kse(t){switch(t.type){case"handshake:read":return;case"handshake:read.ok":{await hf(t.value);return}case"handshake:write":case"handshake:register.update":{switch(await tt(`handshake.${t.register}`),t.register){case"DATA":{A.set(YE,t.value);break}case"STATE":{A.set(JE,t.value);break}default:return t.register}await Ze(`handshake.${t.register}`);return}case"handshake:write.ok":return;case"handshake:int.off":{await li("bus.int2");return}case"handshake:int.on":{await Bi("bus.int2",10);return}default:return t}}async function Yse(t){switch(t.type){case"keyboard:listen-key":{const e=Ge().language,n=of(e,"messages.keyboard-input-required"),i=of(e,"messages.keyboard-input-description");bi({title:n,description:i,variant:"info",duration:5e3}),A.set(jt,r=>r.type!=="running"||r.waitingForInput?r:{...r,waitingForInput:!0}),await new Promise(r=>{A.sub(jt,()=>{const s=A.get(jt);(s.type!=="running"||!s.waitingForInput)&&r()})});return}case"keyboard:read":return;default:return t}}const ZE=me(H.zero(8));function Jse(t){t.io.leds!==null&&A.set(ZE,H.fromUnsigned(t.io.leds,8))}async function Zse(t){switch(t.type){case"leds:update":{await Bi("bus.pio->leds",2),A.set(ZE,t.state),await li("bus.pio->leds");return}default:return t.type}}const pf=me(!1),mf=me(!1);function Qse(t){return t==="memory-to-mbr"?"M 800 249 L 645 249 L 645 222 L 615 222 L 615 233":"M 615 274 L 615 285 L 645 285 L 645 249 L 800 249"}const ST=(t,e)=>{try{const n=Qse(t);if(!n)return console.warn("❌ No se generó path para drawExternalDataPath"),Promise.resolve();const i=Ge(),s=Math.min(i.executionUnit,250),o=e??(i.animations?s:1);return ce([{key:"bus.data.path",from:n},{key:"bus.data.opacity",from:1},{key:"bus.data.strokeDashoffset",from:1,to:0}],{duration:o,easing:"easeInOutSine",forceMs:!0})}catch(n){return console.warn("Error en drawExternalDataPath:",n),Promise.resolve()}},Ry=()=>ce({key:"bus.data.opacity",to:0},{duration:1,easing:"easeInSine"});function eoe(){return"M 615 274 L 615 285 L 645 285 L 645 249 L 765 249 L 765 790 L 900 790"}function toe(){return"M 900 790 L 765 790 L 765 249 L 645 249 L 645 285 L 615 285 L 615 274"}const noe=t=>{try{const e=eoe();if(!e)return console.warn("❌ No se generó path para drawDataPathToPIO"),Promise.resolve();const n=Ge(),r=Math.min(n.executionUnit,250),s=t??(n.animations?r:1);return ce([{key:"bus.data.path",from:e},{key:"bus.data.opacity",from:1},{key:"bus.data.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0}).then(()=>Ry())}catch(e){return console.warn("Error en drawDataPathToPIO:",e),Promise.resolve()}},ioe=t=>{try{const e=toe();if(!e)return console.warn("❌ No se generó path para drawDataPathFromPIO"),Promise.resolve();const n=Ge(),r=Math.min(n.executionUnit,250),s=t??(n.animations?r:1);return console.log("🎯 Animando bus de datos desde PIO → MBR"),ce([{key:"bus.data.path",from:e},{key:"bus.data.opacity",from:1},{key:"bus.data.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0}).then(()=>Ry())}catch(e){return console.warn("Error en drawDataPathFromPIO:",e),Promise.resolve()}};function roe(){return"M 725 349 V 770 H 900"}const kT=t=>{try{const e=roe(),n=Ge(),r=Math.min(n.executionUnit,250),s=t??(n.animations?r:1);return ce([{key:"bus.address.path",from:e},{key:"bus.address.opacity",from:1},{key:"bus.address.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0}).then(()=>dv())}catch(e){return console.warn("Error en drawAddressPathToPIO:",e),Promise.resolve()}};function soe(){return"M 635 349 H 800"}const hw=t=>{try{const e=soe(),n=Ge(),r=Math.min(n.executionUnit,250),s=t??(n.animations?r:1);return ce([{key:"bus.address.path",from:e},{key:"bus.address.opacity",from:1},{key:"bus.address.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0})}catch(e){return console.warn("Error en drawExternalAddressPath:",e),Promise.resolve()}},dv=()=>ce({key:"bus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),CT=t=>{try{const e="M 380 420 H 800",n=Ge(),r=Math.min(n.executionUnit,250),s=t??(n.animations?r:1);return ce([{key:"bus.rd.path",from:e},{key:"bus.rd.opacity",from:1},{key:"bus.rd.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0})}catch(e){return console.warn("Error en drawRDControlPath:",e),Promise.resolve()}},ooe=t=>{try{const e="M 380 440 H 800",n=Ge(),r=Math.min(n.executionUnit,250),s=t??(n.animations?r:1);return ce([{key:"bus.wr.path",from:e},{key:"bus.wr.opacity",from:1},{key:"bus.wr.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0})}catch(e){return console.warn("Error en drawWRControlPath:",e),Promise.resolve()}};function aoe(){return"M 380 440 H 790 V 815 H 900"}const loe=t=>{try{const e=aoe(),n=Ge(),r=Math.min(n.executionUnit,250),s=t??(n.animations?r:1);return ce([{key:"bus.wr.path",from:e},{key:"bus.wr.opacity",from:1},{key:"bus.wr.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0})}catch(e){return console.warn("Error en drawWRControlPathToPIO:",e),Promise.resolve()}};function coe(){return"M 380 420 H 780 V 805 H 900"}const uoe=t=>{try{const e=coe(),n=Ge(),r=Math.min(n.executionUnit,250),s=t??(n.animations?r:1);return ce([{key:"bus.rd.path",from:e},{key:"bus.rd.opacity",from:1},{key:"bus.rd.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0})}catch(e){return console.warn("Error en drawRDControlPathToPIO:",e),Promise.resolve()}},_T=t=>{try{const e=Ge(),i=Math.min(e.executionUnit,250),r=t??(e.animations?i:1);return ce([{key:"bus.pio.opacity",from:1},{key:"bus.pio.strokeDashoffset",from:1,to:0}],{duration:r,easing:"easeInOutSine",forceMs:!0}).then(()=>ce({key:"bus.pio.opacity",to:0},{duration:1,easing:"easeInSine"}))}catch(e){return console.warn("Error en drawPIOControlLine:",e),Promise.resolve()}},ET=()=>ce({key:"bus.rd.opacity",to:0},{duration:1,easing:"easeInSine"}),AT=()=>ce({key:"bus.wr.opacity",to:0},{duration:1,easing:"easeInSine"});async function PT(t){switch(typeof window<"u"&&window.VONSIM_PARALLEL_ANIMATIONS&&window.addEventListener("vonsim:parallel-memory-read-visual",()=>{A.set(pf,!0),ce([{key:"bus.address.opacity",to:.7},{key:"bus.rd.opacity",to:.7}],{duration:.15,easing:"easeOutQuad"}).then(()=>{ce([{key:"bus.address.opacity",to:1},{key:"bus.rd.opacity",to:1}],{duration:.15,easing:"easeInQuad"})}),Promise.all([hw(),(async()=>{Ny(),await CT(),My()})()])}),t.type){case"memory:read":{window.VONSIM_PARALLEL_ANIMATIONS||(A.set(pf,!0),ce([{key:"bus.address.opacity",to:.7},{key:"bus.rd.opacity",to:.7}],{duration:.15,easing:"easeOutQuad"}).then(()=>{ce([{key:"bus.address.opacity",to:1},{key:"bus.rd.opacity",to:1}],{duration:.15,easing:"easeInQuad"})}),await Promise.all([hw(),(async()=>{Ny(),await CT(),My()})()]),await dv());return}case"memory:read.ok":{A.set(Hp,Pe.from(t.address)),await ce({key:"memory.operating-cell.color",to:Ct.mantis[400]},{duration:1,easing:"easeOutQuart"}),await ST("memory-to-mbr"),A.set(ei,t.value),await Promise.all([ce({key:"memory.operating-cell.color",to:Ct.white},{duration:1,easing:"easeOutQuart"}),Ry(),dv(),ET(),AT()]);return}case"memory:write":{A.set(mf,!0),qE(),await Promise.all([hw(),ooe()]),KE(),A.set(mf,!1);return}case"memory:write.ok":{A.set(Hp,Pe.from(t.address)),await tt("cpu.MBR"),await ST("mbr-to-memory"),await ce({key:"memory.operating-cell.color",to:Ct.mantis[400]},{duration:1,easing:"easeOutQuart"}),A.set(hy,e=>[...e.slice(0,t.address.value),t.value,...e.slice(t.address.value+1)]),A.set(py,e=>{const n=new Set(e);return n.add(t.address.value),n}),setTimeout(()=>{A.set(py,e=>{const n=new Set(e);return n.delete(t.address.value),n})},3e3),await Promise.all([Ze("cpu.MBR"),ce({key:"memory.operating-cell.color",to:Ct.white},{duration:1,easing:"easeOutQuart"}),Ry(),dv(),ET(),AT()]);return}case"memory:read.error":case"memory:write.error":{Zr(t.error);return}case"memory:write.warning":{zc("Advertencia de Memoria",`${t.warning}`);return}default:return t}}const QE=me(H.fromUnsigned(255,8)),eA=me(H.fromUnsigned(0,8)),tA=me(H.fromUnsigned(0,8)),Iy=[me(H.zero(8)),me(H.zero(8)),me(H.zero(8)),me(H.zero(8)),me(H.zero(8)),me(H.zero(8)),me(H.zero(8)),me(H.zero(8))];function doe(t){if(t.io.pic){A.set(QE,H.fromUnsigned(t.io.pic.IMR,8)),A.set(eA,H.fromUnsigned(t.io.pic.IRR,8)),A.set(tA,H.fromUnsigned(t.io.pic.ISR,8));for(let e=0;e<Iy.length;e++)A.set(Iy[e],H.fromUnsigned(t.io.pic.lines[e],8))}}async function foe(t){switch(t.type){case"pic:read":return;case"pic:read.ok":{await hf(t.value);return}case"pic:write":return;case"pic:register.update":{switch(await tt(`pic.${t.register}`),t.register){case"IMR":{A.set(QE,t.value);break}case"IRR":{A.set(eA,t.value);break}case"ISR":{A.set(tA,t.value);break}case"INT0":case"INT1":case"INT2":case"INT3":case"INT4":case"INT5":case"INT6":case"INT7":{const e=Number(t.register.slice(3));A.set(Iy[e],t.value);break}default:return t}await Ze(`pic.${t.register}`);return}case"pic:write.ok":return;case"pic:intr.off":{await li("bus.intr");return}case"pic:intr.on":{await Bi("bus.intr",10);return}case"pic:int.send":{await hf(t.number);return}default:return t}}const nA=me(H.zero(8)),iA=me(H.zero(8)),rA=me(H.zero(8)),sA=me(H.zero(8));function hoe(t){t.io.pio&&(A.set(nA,H.fromUnsigned(t.io.pio.PA,8)),A.set(iA,H.fromUnsigned(t.io.pio.PB,8)),A.set(rA,H.fromUnsigned(t.io.pio.CA,8)),A.set(sA,H.fromUnsigned(t.io.pio.CB,8)))}async function poe(t){switch(t.type){case"pio:read":{console.log("🎯 pio:read: Iniciando animaciones de bus de direcciones y control RD hacia PIO"),A.set(pf,!0),Ny(),await tt("cpu.MAR",Ct.blue[500]),console.log("🎯 pio:read: Animando buses de direcciones (MAR → PIO) y control RD hacia PIO"),await Promise.all([kT(),uoe(),_T()]),My(),A.set(pf,!1),await Ze("cpu.MAR");return}case"pio:read.ok":{console.log("🎯 pio:read.ok: Iniciando animación de bus de datos desde PIO"),await tt("cpu.MBR",Ct.mantis[400]),console.log("🎯 pio:read.ok: Animando bus de datos PIO → MBR"),await ioe(),await hf(t.value),await Ze("cpu.MBR");return}case"pio:write":{A.set(mf,!0),qE(),await Promise.all([tt("cpu.MAR",Ct.blue[500]),tt("cpu.MBR",Ct.mantis[400])]),await Promise.all([kT(),noe(),loe(),_T()]),KE(),A.set(mf,!1),await Promise.all([Ze("cpu.MAR"),Ze("cpu.MBR")]);return}case"pio:register.update":{switch(await tt(`pio.${t.register}`),t.register){case"PA":{A.set(nA,t.value);break}case"PB":{A.set(iA,t.value);break}case"CA":{A.set(rA,t.value);break}case"CB":{A.set(sA,t.value);break}default:return t.register}await Ze(`pio.${t.register}`);return}case"pio:write.ok":return;default:return t}}const Ty=me([]),Oy=me("");function moe(t){t.io.printer&&(A.set(Ty,t.io.printer.buffer.map(e=>H.fromUnsigned(e,8))),A.set(Oy,t.io.printer.paper))}async function goe(t){switch(t.type){case"printer:buffer.add":{A.set(Ty,e=>[...e,t.char]);return}case"printer:buffer.pop":{A.set(Ty,e=>e.slice(1));return}case"printer:busy.off":{await li("bus.printer.busy");return}case"printer:busy.on":{await Bi("bus.printer.busy",15);return}case"printer:data.read":{await Bi("bus.printer.data",15),await li("bus.printer.data");return}case"printer:paper.print":{A.set(Oy,e=>e+t.char);return}case"printer:paper.replace":{A.set(Oy,"");return}case"printer:strobe.off":{await li("bus.printer.strobe");return}case"printer:strobe.on":{await Bi("bus.printer.strobe",15);return}default:return t}}const oA=me("");function voe(t){"screen"in t.io&&t.io.screen!==null&&A.set(oA,t.io.screen)}async function yoe(t){switch(t.type){case"screen:send-char":{A.set(oA,t.output);return}default:return t.type}}const l1=me(H.zero(8));function boe(t){t.io.switches!==null&&A.set(l1,H.fromUnsigned(t.io.switches,8))}async function xoe(t){switch(t.type){case"switches:toggle":{A.set(l1,e=>e.withBit(t.index,!e.bit(t.index))),await Bi("bus.switches->pio",2),await li("bus.switches->pio");return}default:return t}}const Ly=me(H.zero(8)),aA=me(H.zero(8));function woe(t){t.io.timer&&(A.set(Ly,H.fromUnsigned(t.io.timer.CONT,8)),A.set(aA,H.fromUnsigned(t.io.timer.COMP,8)))}async function Soe(t){switch(t.type){case"timer:read":return;case"timer:read.ok":{await hf(t.value);return}case"timer:write":return;case"timer:register.update":{switch(await tt(`timer.${t.register}`),t.register){case"CONT":{A.set(Ly,t.value);break}case"COMP":{A.set(aA,t.value);break}default:return t.register}await Ze(`timer.${t.register}`);return}case"timer:write.ok":return;case"timer:int.off":{await li("bus.int1");return}case"timer:int.on":{await Bi("bus.int1",10);return}case"timer:tick":{A.set(Ly,t.cont),await Bi("bus.int1",2),await li("bus.int1");return}default:return t}}const Vk=new Set;async function pw(t){await t()}async function i$(t){Coe(t);const[e]=t.type.split(":",2);Vk.add(t.type);const i=["cpu:mar.set","cpu:register.update","cpu:mbr.get","cpu:mbr.set","cpu:register.buscopy","cpu:register.copy","memory:read","memory:write"].includes(t.type);try{switch(e){case"bus":{i?await pw(()=>xT(t)):await xT(t);break}case"clock":{await Dse(t);break}case"cpu":{i?await pw(()=>Uk(t)):await Uk(t);break}case"f10":{await Xse(t);break}case"handshake":{await Kse(t);break}case"keyboard":{await Yse(t);break}case"leds":{await Zse(t);break}case"memory":{i?await pw(()=>PT(t)):await PT(t);break}case"pic":{await foe(t);break}case"pio":{await poe(t);break}case"printer":{await goe(t);break}case"screen":{await yoe(t);break}case"switches":{await xoe(t);break}case"timer":{await Soe(t);break}default:return e}}finally{Vk.delete(t.type)}}function NT(...t){for(const e of t)if(Vk.has(e))return!0;return!1}const koe={bus:"#2563eb",clock:"#65a30d",cpu:"#dc2626",f10:"#65a30d",handshake:"#2563eb",keyboard:"#65a30d",leds:"#65a30d",memory:"#f59e0b",pic:"#2563eb",pio:"#2563eb",printer:"#65a30d",screen:"#65a30d",switches:"#65a30d",timer:"#2563eb"};function Coe(t){const[e,n]=t.type.split(":",2);console.group(`%c ${e} %c ${n}`,`background: ${koe[e]}; color: #fff; font-weight: bold;`,"background: unset; color: unset; font-weight: normal;");for(const i in t)if(i!=="type"&&Object.prototype.hasOwnProperty.call(t,i)){const r=t[i];r instanceof H?console.log(`${i}: %c${r.toString("hex")}h %c(Byte)`,"color: #8b5cf6;","color: #737373;"):r instanceof Pe?console.log(`${i}: %c${r.toString()} %c(MemoryAddress)`,"color: #8b5cf6;","color: #737373;"):r instanceof Dr?console.log(`${i}: %c${r.toString()} %c(IOAddress)`,"color: #8b5cf6;","color: #737373;"):typeof r=="number"?console.log(`${i}: %c${r.toString(16)}h %c(number)`,"color: #8b5cf6;","color: #737373;"):typeof r=="string"?console.log(`${i}: %c"${r}" %c(string)`,"color: #f97316;","color: #737373;"):typeof r=="boolean"?console.log(`${i}: %c${r}`,"color: #06b6d4;"):r===null?console.log(`${i}: %cnull`,"color: #b91c1c;"):console.log(`${i}:`,r)}console.groupEnd()}const Nn=new PQ;typeof window<"u"&&(window.addEventListener("pioActivated",t=>{const{address:e,registerName:n,shouldReload:i}=t.detail;i&&(console.log(`🔄 Recargando programa debido a activación automática del PIO (${n} - ${e.toString(16).toUpperCase()}h)`),A.get(jt).type==="running"&&Zr(),setTimeout(()=>{Ih("cpu.run","infinity")},100))}),window.addEventListener("handshakeActivated",t=>{const{address:e,registerName:n,shouldReload:i}=t.detail;i&&(console.log(`🔄 Recargando programa debido a activación automática de la impresora con Handshake (${n} - ${e.toString(16).toUpperCase()}h)`),A.get(jt).type==="running"&&Zr(),setTimeout(()=>{Ih("cpu.run","infinity")},100))}),window.addEventListener("picActivated",t=>{const{address:e,registerName:n,shouldReload:i}=t.detail;i&&(console.log(`🔄 Recargando programa debido a activación automática del PIC (${n} - ${e.toString(16).toUpperCase()}h)`),A.get(jt).type==="running"&&Zr(),setTimeout(()=>{Ih("cpu.run","infinity")},100))}),window.addEventListener("programModified",t=>{const{shouldReload:e,until:n}=t.detail;e&&(console.log("🔄 Recargando programa debido a modificación del código"),A.set(go,!1),A.get(jt).type==="running"&&Zr(),setTimeout(()=>{Ih("cpu.run",n)},100))}));const jt=me({type:"stopped"}),go=me(!1);let ou=null;try{window.VonSimAddNotification&&(ou=window.VonSimAddNotification)}catch{}function lA(t,e=10){window.VonSimAddNotification?window.VonSimAddNotification(t):e>0&&setTimeout(()=>lA(t,e-1),100)}function _oe(t){const e=t.translate(Ge().language);bi({title:e,variant:"error"}),ou?ou({type:"error",title:"Error de simulación",message:e}):lA({type:"error",title:"Error de simulación",message:e})}function zc(t,e){bi({title:t,description:e,variant:"info"}),ou&&ou({type:"warning",title:t,message:e})}function Zr(t){if(Rh=!1,Hk.clear(),console.log("🧹 [DEBUG] Hilos activos limpiados"),t&&(_oe(t),t.code==="no-instruction")){A.set(jt,{type:"paused"});return}Nne(),j6(null),_ne(!1),A.set(jt,{type:"stopped",error:t}),A.set(Wn,{phase:"stopped",error:t}),XE(),A.set(go,!1),console.log("✅ [DEBUG] Simulación finalizada - todos los hilos y procesos limpiados")}function Ot(){A.set(jt,{type:"paused"}),qB()}function Eoe(){const t=of(Ge().language,"messages.assemble-error");bi({title:t,variant:"error"}),ou?ou({type:"error",title:"Error de ensamblado",message:t}):lA({type:"error",title:"Error de ensamblado",message:t})}function Eu(){bi({title:of(Ge().language,"messages.invalid-action"),variant:"error"})}function MT(t,e=!1){l8(t,e),TQ(t,e),qse(t),doe(t),hoe(t),woe(t),Jse(t),moe(t),voe(t),boe(t),ot=0,ra=0,Ur=0,X=0,A.set(af,ot),A.set(jl,ra),A.set(We,""),e&&(A.set(ws,[]),A.set(go,!1)),A.set(Vp,0)}let P=null,Ur=0,X=0,mt="",Au=!0,ut=!1,Ye=!1,pe=[],ot=0,De=0,ra=0,Pu="",RT="",IT="",Jn=!1,t0=!1,n0="",r$="",gc=!1,vc="",i0=!1,Nu=!1,r0=!1,mw=!1;function Aoe(t){return t.modeId&&t.modeRi?"directo-inmediato":t.modeId?"inmediato":t.modeRi?"directo":"registro"}function s0(t){if(t.length!==2)return!1;const[e,n]=t,i=/^[A-D][LH]$/.test(e)||/^[A-D]X$/.test(e),r=n.startsWith("[")&&n.endsWith("]");return i&&r}function Poe(t,e){const{name:n,modeId:i,modeRi:r,executeStage:s}=e;return n==="MOV"&&i&&r?Noe(t,s):n==="MOV"&&r&&!i?Moe(t,s):n==="MOV"&&i&&!r?Roe(t):n==="INT"?Toe(t,s,r):n==="CALL"?Ooe(t):n==="OUT"&&t==="ri"&&s===2?{message:"",shouldDisplay:!1,shouldPause:!0}:n==="OUT"&&s===5?{message:`Ejecución: MBR ← ${t}`,shouldDisplay:!0,shouldPause:!0}:["ADD","SUB","CMP","AND","OR","XOR"].includes(n)&&r&&!i?Ioe(t,s):["ADD","SUB","CMP","AND","OR","XOR"].includes(n)&&t==="ri"?s===5?{message:"",shouldDisplay:!1,shouldPause:!1}:{message:"Ejecución: MAR ← MBR",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function Noe(t,e){switch(e){case 2:return{message:"Ejecución: MAR ← IP",shouldDisplay:!0,shouldPause:!0};case 4:return{message:"Ejecución: ri ← MBR; MAR ← IP",shouldDisplay:!0,shouldPause:!0};case 5:return{message:"Ejecución: MAR ← IP | ri ← MBR",shouldDisplay:!0,shouldPause:!0};default:return{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}}function Moe(t,e){return e===2?{message:"Ejecución: MAR ← IP",shouldDisplay:!0,shouldPause:!0}:e===4&&t==="ri"?{message:"Ejecución: MAR ← MBR",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function Roe(t){return t==="ri"?{message:"Ejecución: MAR ← MBR",shouldDisplay:!0,shouldPause:!0}:t==="IP"?{message:"Ejecución: MAR ← IP",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function Ioe(t,e){return e===2?{message:"Ejecución: MAR ← IP",shouldDisplay:!0,shouldPause:!0}:e===4&&t==="ri"?{message:"Ejecución: MAR ← MBR",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function Toe(t,e,n){return e===2&&t==="IP"?{message:"Ejecución: MAR ← IP",shouldDisplay:!0,shouldPause:!1}:e===2&&n?{message:"Ejecución: ri ← MBR; MAR ← SP",shouldDisplay:!0,shouldPause:!1}:e===7&&t==="SP"?{message:"",shouldDisplay:!1,shouldPause:!1}:{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!1}}function Ooe(t){return{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function Loe(t,e){const{name:n,modeId:i,modeRi:r,executeStage:s}=e;return t==="SP"?Doe(n,s):t==="FLAGS"?joe(n,s,r):n==="INT"?Boe(t):n==="MOV"&&i&&r&&pe&&pe.length===2&&/^\[[A-Z]{2}\]$/i.test(pe[0])&&/^[0-9A-F]+h?$/i.test(pe[1])&&(s===4||s===5)?{message:"",shouldDisplay:!1,shouldPause:!1}:n==="MOV"&&i&&r?$oe():n==="MOV"&&r&&!i?Foe():["ADD","SUB","CMP","AND","OR","XOR"].includes(n)&&r&&!i?zoe():n==="CALL"?Uoe(t):n==="OUT"&&t==="IP"&&s===3?{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0}:t==="IP"&&r&&!i&&s===3?{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MBR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function Doe(t,e){if(e===4&&t==="INT")return{message:"Ejecución: ri ← MBR | SP ← SP - 1",shouldDisplay:!0,shouldPause:!0};if(e===7&&t==="INT")return{message:"",shouldDisplay:!1,shouldPause:!1};switch(t){case"PUSH":return{message:"Ejecución: SP = SP - 1",shouldDisplay:!0,shouldPause:!0};case"RET":return e===3?{message:"Ejecución: IP ← MBR | SP ← SP + 1",shouldDisplay:!0,shouldPause:!1}:{message:"Ejecución: SP = SP + 1",shouldDisplay:!0,shouldPause:!1};case"IRET":return e===3?{message:"Ejecución: IP ← MBR | SP ← SP + 1",shouldDisplay:!0,shouldPause:!1}:e===5?{message:"Ejecución: Flags ← MBR | SP ← SP + 1",shouldDisplay:!0,shouldPause:!1}:{message:"Ejecución: SP = SP + 1",shouldDisplay:!0,shouldPause:!1};case"POP":if(e===3)return{message:`${r$} | SP = SP + 1`,shouldDisplay:!0,shouldPause:!0};break}return{message:"",shouldDisplay:!1,shouldPause:!1}}function joe(t,e,n){return t==="INT"&&e===6?{message:"Ejecución: write(Memoria[MAR]) ← MBR | update(Flags I=0)",shouldDisplay:!0,shouldPause:!0}:n&&e===5&&t==="INT"?{message:"Ejecución: write(Memoria[MAR]) ← MBR; SP ← SP - 1; update(Flags I=0)",shouldDisplay:!0,shouldPause:!1}:t==="CLI"?{message:"Ejecución: update(Flags I=0)",shouldDisplay:!0,shouldPause:!1}:t==="STI"?{message:"Ejecución: update(Flags I=1)",shouldDisplay:!0,shouldPause:!1}:t==="INT"?{message:"Ejecución: update(Flags I=0)",shouldDisplay:!0,shouldPause:!1}:{message:"Ejecución: update(Flags I=0)",shouldDisplay:!0,shouldPause:!0}}function Boe(t){switch(t){case"IP":if(X===3)return{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0};break;case"DL":return{message:"Interrupción: AL ← ASCII",shouldDisplay:!0,shouldPause:!0};case"right.l":return{message:"Interrupción: SUB AL, 1",shouldDisplay:!0,shouldPause:!0};case"right":return{message:"Interrupción: ADD BL, 1",shouldDisplay:!0,shouldPause:!0}}return{message:`Ejecución: MBR ← ${t}`,shouldDisplay:!0,shouldPause:!1}}function $oe(){return P==="MOV"&&pe&&pe.length===2&&/^\[[A-Z]{2}\]$/i.test(pe[0])&&/^[0-9A-F]+h?$/i.test(pe[1])&&(X===4||X===5)?{message:"",shouldDisplay:!1,shouldPause:!1}:{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0}}function Foe(){return{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0}}function zoe(){return{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0}}function Uoe(t){return X===3&&t==="IP"?{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MBR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function TT(){return{name:P||"",modeId:ut,modeRi:Ye,executeStage:X,cycleCount:De}}function OT(t,e,n,i){const r=Aoe(n);console.log(`🔍 [${t}] Registro: ${e}`),console.log(`   Instrucción: ${n.name}`),console.log(`   Modo de direccionamiento: ${r}`),console.log(`   Etapa de ejecución: ${n.executeStage}`),console.log(`   Ciclo: ${n.cycleCount}`),console.log(`   Mensaje: ${i.message}`),console.log(`   Mostrar: ${i.shouldDisplay}`),console.log(`   Pausar: ${i.shouldPause}`),console.log("---")}function LT(t){return t.name?t.executeStage<0?(console.warn("⚠️ Etapa de ejecución inválida:",t.executeStage),!1):!0:(console.warn("⚠️ Contexto de instrucción sin nombre"),!1)}const Hk=new Set;let Rh=!1;async function zu(t,e=!1){if(Rh&&t!==Nn.startCPU()&&!e){console.log("🔒 [DEBUG] Hilo secundario bloqueado - CPU principal activo");return}const n=!Rh&&t===Nn.startCPU();n?(Rh=!0,console.log("🎯 [DEBUG] Iniciando hilo principal del CPU")):e&&console.log("🕐 [DEBUG] Iniciando hilo concurrente del reloj");const i=Voe(t);Hk.add(i);try{await i}finally{Hk.delete(i),n&&(Rh=!1,console.log("✅ [DEBUG] Hilo principal del CPU terminado"))}}async function Voe(t){try{let e=0;const n=1e4;for(;;){if(e++,e>n){console.error("❌ [DEBUG] Bucle infinito detectado - demasiadas iteraciones:",e),Zr();return}const i=A.get(jt),r=A.get(em);if(console.log(`🔄 [DEBUG] Iteración ${e} - Estado:`,{status:i.type,programModified:r,executeStageCounter:X,currentInstructionName:P}),r){if(console.log("🔄 Programa modificado - disparando evento de recarga automática"),typeof window<"u"){const a=new CustomEvent("programModified",{detail:{shouldReload:!0,until:i.type==="running"?i.until:"infinity"}});window.dispatchEvent(a)}Ur=0,X=0,Zr();return}if(i.type==="stopped"){Ur=0,X=0,mt="",console.log("✅ [DEBUG] Simulación detenida, saliendo de startThread");return}if(i.type==="paused"){await new Promise(a=>{const l=A.sub(jt,()=>{l(),a()})});continue}console.log("🔄 [DEBUG] Obteniendo siguiente evento del generador...");const s=t.next();if(console.log("📋 [DEBUG] Evento obtenido:",{done:s.done,type:s.value?s.value.type:void 0,hasValue:!!s.value}),s.done){console.log("✅ [DEBUG] Generador terminado, saliendo del bucle");return}if(s.value&&typeof s.value<"u"){const a=s.value.type;console.log("🎯 [DEBUG] Procesando evento:",{type:a,executeStageCounter:X,currentInstructionName:P,isTraceEvent:a==null?void 0:a.includes("trace"),isPrinterEvent:a==null?void 0:a.includes("printer"),isPioEvent:a==null?void 0:a.includes("pio")});try{console.log("📥 [DEBUG] Importando funciones de events.ts...");const l=await zp(()=>Promise.resolve().then(()=>Gse),void 0);console.log("✅ [DEBUG] Módulo events.ts importado correctamente");const{updateInstructionContext:c,getCurrentExecuteStageCounter:u}=l;if(typeof c!="function")throw new Error("updateInstructionContext no es una función");if(typeof u!="function")throw new Error("getCurrentExecuteStageCounter no es una función");if(console.log("🔄 [DEBUG] Actualizando contexto de instrucción..."),c(X,P||""),console.log("✅ [DEBUG] Contexto actualizado correctamente"),a==="cpu:register.update"&&P==="INT"&&X===11&&s.value.register==="ri.l"){console.log("⏭️ [DEBUG] Omitiendo evento cpu:register.update (ri.l) en INT paso 11 - registro ya actualizado");continue}if(a==="cpu:register.copy"&&P==="INT"&&X===11&&s.value.src==="ri.l"&&s.value.dest==="IP.l"){console.log("⏭️ [DEBUG] Omitiendo evento cpu:register.copy (ri → IP) en INT paso 11 - el valor va directamente a MAR");continue}console.log("🎯 [DEBUG] Llamando a handleEvent...");const d=performance.now();s.value.type.startsWith("clock:")&&console.log("🕐 [DEBUG] Procesando evento del reloj:",s.value);const f=i$(s.value),p=new Promise((g,y)=>{setTimeout(()=>y(new Error(`Timeout procesando evento: ${a}`)),1e4)});await Promise.race([f,p]);const m=performance.now();console.log(`✅ [DEBUG] handleEvent completado en ${(m-d).toFixed(2)}ms`),console.log("🔄 [DEBUG] Sincronizando executeStageCounter..."),X=u(),console.log("✅ [DEBUG] executeStageCounter sincronizado:",X)}catch(l){throw console.error("❌ [DEBUG] Error procesando evento:",{eventType:a,error:l.message,stack:l.stack,executeStageCounter:X,currentInstructionName:P}),l}}else{console.log("⏭️ [DEBUG] Evento vacío o indefinido, continuando...");continue}if(s.value.type==="cpu:cycle.start"){P=s.value.instruction.name,ut=!!s.value.instruction.willUse.id,Ye=!!s.value.instruction.willUse.ri,pe=s.value.instruction.operands;const a=Ye||P==="INT"||P==="CALL";A.set(a8,a),De=0,A.set(It,De),r0=!1,ot=0,console.log("🔄 Nueva instrucción iniciada:",P,"- Contador reiniciado a 0"),console.log("🔍 Detalles de la instrucción:","willUse.id:",s.value.instruction.willUse.id,"willUse.ri:",s.value.instruction.willUse.ri,"modeId:",ut,"modeRi:",Ye),console.log("🔍 Instrucción completa:",JSON.stringify(s.value.instruction,null,2)),Jn=!1,t0=!1,n0="",gc=!1,vc="",i0=!1}if(i.until==="cycle-change"||i.until==="end-of-instruction"||i.until==="infinity"){if(s.value.type==="cpu:cycle.end"){Ur=0,X=0,Au=!0,mt="",ra++,console.log(`Instrucciones: ${ra}`),A.set(jl,ra),(i.until==="cycle-change"||i.until==="end-of-instruction")&&Ot();continue}else if(s.value.type==="cpu:halt"){console.log("🛑 HLT detected - setting isHaltExecutionAtom to true BEFORE any other operations"),A.set(go,!0),ra++,A.set(jl,ra),console.log("🛑 HLT - after setting instruction count, isHaltExecutionAtom:",A.get(go)),console.log("🔄 fetchStageCounter",Ur),ot++,A.set(af,ot);const a=A.get(Vp);A.set(Vp,a+ot),A.set(We,"Ejecución: Detenido"),De++,A.set(It,De),console.log("🛑 HLT ejecutado - executeStageCounter establecido a 4, cycleCount:",ot)}else s.value.type==="cpu:int.6"?A.set(We,"INT 6: Lectura de carácter del teclado"):s.value.type==="cpu:int.7"&&(A.set(We,"Interrupción: Rutina mostrar por pantalla"),i.until==="cycle-change"&&Ot());if(Ur<3)s.value.type==="cpu:mar.set"?(s.value.register==="SP"?(Ur=3,X=3,P!=="CALL"&&A.set(We,"Ejecución: MAR ← SP")):(A.set(We,"Captación: MAR ← IP"),ot++,De++,A.set(It,De),X++),i.until==="cycle-change"&&Ot(),Ur++):s.value.type==="cpu:register.update"?(console.log("🔍 Debug: Captación register.update - fetchStageCounter:",Ur,"executeStageCounter:",X),A.set(We,"Captación: MBR ← read(Memoria[MAR]) | IP ← IP + 1"),ot++,De++,A.set(It,De),i.until==="cycle-change"&&Ot(),X++,Ur++):s.value.type==="cpu:mbr.get"&&(A.set(We,"Captación: IR ← MBR"),ot++,De++,A.set(It,De),i.until==="cycle-change"&&Ot(),Ur++);else if(s.value.type==="cpu:rd.on"&&X>1?(mt="Ejecución: MBR ← read(Memoria[MAR])",Nu=!1):s.value.type==="cpu:wr.on"?(P==="CALL"&&X>=8?console.log("✅ CALL paso",X,"- cpu:wr.on mensaje omitido para mensaje combinado"):mt="Ejecución: write(Memoria[MAR]) ← MBR",Nu=!0,P==="MOV"&&!s0(pe)&&(console.log("🔍 MOV Debug - Escritura en memoria detectada"),console.log("🔍 MOV Debug - Operandos:",pe),console.log("🔍 MOV Debug - Es lectura:",s0(pe)))):s.value.type==="pio:write.ok"&&(A.set(We,"Ejecución: write(PIO[MAR]) ← MBR"),ot++,De++,A.set(It,De),X++),s.value.type==="cpu:mar.set"){const a=s.value.register;P==="MOV"&&X===2&&pe&&pe.length>=2&&pe[0]==="CL"&&pe[1]==="[BL]"&&a==="ri"&&i.until==="cycle-change"&&(console.log("🛑 Marcando pausa especial: MOV CL, [BL] en paso 4 (executeStageCounter=2) - se pausará al final del evento"),r0=!0),i.until==="cycle-change"&&!(P==="CALL"&&a==="SP")&&!(P==="INT"&&X===4&&a==="SP")&&!(P==="INT"&&X===5&&a==="SP")&&!(P==="INT"&&X===7&&a==="SP")&&Ot(),console.log("executeStageCounter:",X),console.log("mbridirmar:",Jn),console.log("resultmbrimar:",t0),console.log("displayMessageresultmbr:",n0),console.log("shouldDisplayMessage:",Au),console.log("🔍 BL/BX Debug - blBxToRiProcessed:",gc),console.log("🔍 BL/BX Debug - blBxRegisterName:",vc);let l=!1;const c=(P==="MOV"||P==="ADD"||P==="SUB")&&a==="ri"&&(X===3||gc)&&(!ut&&!Ye||ut&&!Ye),u=a==="ri"&&((P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&(X>=5&&(mt==="Ejecución: write(Memoria[MAR]) ← MBR"||X>=7)||X===5&&!Ye&&ut)||P==="IN"&&X===2),d=["ADD","SUB","CMP","AND","OR","XOR"].includes(P)&&X===5,f=TT();if(LT(f)){const m=Poe(a,f);if(OT("MAR.set",a,f,m),a==="IP"&&P==="MOV"&&X===4&&(console.log("🔍 Debug MOV IP - Verificando condiciones:"),console.log("   sourceRegister === 'IP':",a==="IP"),console.log("   currentInstructionName === 'MOV':",P==="MOV"),console.log("   currentInstructionModeri:",Ye),console.log("   !currentInstructionModeid:",!ut),console.log("   executeStageCounter === 4:",X===4),console.log("   currentInstructionOperands:",pe),console.log("   currentInstructionOperands.length === 2:",pe.length===2),pe.length>=2&&(console.log("   Segundo operando:",pe[1]),console.log("   !startsWith('['):",!pe[1].startsWith("[")),console.log("   !endsWith(']'):",!pe[1].endsWith("]")),console.log("   /^\\d+$/.test():",/^\d+$/.test(pe[1])),console.log("   /^\\d+h$/i.test():",/^\d+h$/i.test(pe[1])),console.log("   Es valor inmediato (decimal o hex):",/^\d+$/.test(pe[1])||/^\d+h$/i.test(pe[1])))),P==="INT"&&X===4&&a==="SP")console.log("🎯 INT paso 6 detectado en cpu:mar.set"),console.log("   currentInstructionName:",P),console.log("   executeStageCounter:",X),console.log("   sourceRegister:",a),console.log("   Estableciendo mensaje: MAR ← SP"),A.set(We,"Ejecución: MAR ← SP"),Jn=!1;else if(P==="INT"&&X===6&&a==="SP")console.log("🎯 INT paso 7 (ciclo 7) detectado en cpu:mar.set - SP → MAR"),console.log("   currentInstructionName:",P),console.log("   executeStageCounter:",X),console.log("   sourceRegister:",a),console.log("   Estableciendo mensaje combinado: MBR ← FLAGS | MAR ← SP"),A.set(We,"Ejecución: MBR ← FLAGS | MAR ← SP"),Jn=!1;else if(P==="INT"&&X===5&&a==="SP")console.log("⚠️ INT paso 7 (preparación) detectado en cpu:mar.set - NO ESPERADO"),console.log("   Este caso no debería ocurrir - verificar orden de eventos"),Jn=!1;else if(P==="INT"&&X===7&&a==="SP")console.log("⚠️ INT después de paso 7 detectado en cpu:mar.set - NO ESPERADO"),console.log("   Este caso no debería ocurrir - verificar lógica"),Jn=!1;else if(P==="INT"&&X===8&&a==="SP")console.log("🎯 INT paso 10 (ciclo 10) detectado en cpu:mar.set"),console.log("   currentInstructionName:",P),console.log("   executeStageCounter:",X),console.log("   sourceRegister:",a),console.log("   Estableciendo mensaje: MAR ← SP"),A.set(We,"Ejecución: MAR ← SP"),Jn=!1;else if(a==="IP"&&Ye&&ot===5&&pe.length===2)A.set(We,"Ejecución: MAR ← IP | ri ← MBR"),l=!1;else if(t0)A.set(We,n0);else if(Jn&&!u&&!(P==="INT"&&X===6&&a==="SP")&&!(P==="INT"&&X===11&&a==="ri"))if(P==="MOV"&&Ye&&ut)A.set(We,"Ejecución: MAR ← IP; MBR→MBR");else if(a==="ri"&&P==="MOV"&&!Ye&&!ut)ot++,De++,A.set(We,`Ejecución: MAR ← ${vc}`),A.set(It,De),console.log("🔢 Ciclo incrementado ANTES de mostrar MAR ← BL/BX - cycleCount:",ot,"currentInstructionCycleCount:",De),l=!0,Jn=!1,gc=!1,vc="";else if(a==="ri"&&(P==="ADD"||P==="SUB")&&!Ye&&!ut)ot++,De++,A.set(It,De),console.log("🔢 Ciclo incrementado ANTES de mostrar MAR ← BL/BX - cycleCount:",ot,"currentInstructionCycleCount:",De),l=!0,A.set(We,`Ejecución: MAR ← ${vc}`),Jn=!1,gc=!1,vc="";else{if(["ADD","SUB","CMP","AND","OR","XOR"].includes(P)&&Ye&&!ut&&a==="ri"){d||A.set(We,"Ejecución: MAR ← MBR");return}i0?(A.set(We,"Ejecución: MAR ← ri | id ← MBR"),i0=!1):P!=="INT"&&P!=="CALL"&&(ot++,De++,A.set(We,"Ejecución: MAR ← BL | id ← MBR"),P&&["ADD","SUB","CMP","AND","OR","XOR"].includes(P)&&ut&&!Ye&&typeof ce=="function"&&typeof Ti=="function"&&await Promise.all([ce([{key:"cpu.internalBus.address.path",from:Ti("BL","MAR",P)},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),ce([{key:"cpu.internalBus.data.path",from:Ti("MBR","id",P,"mem<-imd")},{key:"cpu.internalBus.data.opacity",from:1},{key:"cpu.internalBus.data.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0})]))}else a==="ri"&&P==="MOV"&&X===4?A.set(We,"Ejecución: MAR ← MBR"):a==="ri"&&P==="IN"&&X===4?(console.log("🎯 IN ciclo 6 detectado - MAR ← MBR (animación especial MBR → MAR)"),A.set(We,"Ejecución: MAR ← MBR")):a==="ri"&&(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&!Ye&&ut&&(X===4||X===5)&&!u?(A.set(We,"Ejecución: MAR ← BL | id ← MBR"),console.log("🎯 Paso 6 de ADD [BL], 6 - Mensaje simultáneo: MAR ← BL | id ← MBR")):u&&a==="ri"?console.log("⏭️ ri → MAR omitido completamente - no mostrar mensaje ni contabilizar ciclo"):P==="INT"&&X===8&&a==="ri"?(console.log("🎯 INT paso 12 (ciclo 12) detectado en cpu:mar.set - Mostrando MAR ← ri"),A.set(We,"Ejecución: MAR ← ri"),Jn=!1):(P==="INT"&&a==="SP"||Au||a==="SP"&&P!=="CALL"&&P!=="INT"||ut&&a==="IP"||m.shouldDisplay)&&(!c&&!u&&!(P==="CALL"&&a==="SP")?P==="INT"&&a==="SP"?A.set(We,"Ejecución: MAR ← SP | MBR ← FLAGS"):A.set(We,m.message):u?console.log("⏭️ Mensaje NO mostrado para ri → MAR en etapa avanzada (dirección ya en MAR)"):P==="CALL"&&a==="SP"&&console.log("⏭️ Mensaje NO mostrado para CALL MAR ← SP (se mostrará en cpu:mbr.set)"))}Jn&&u&&a==="ri"&&(Jn=!1,console.log("🧹 mbridirmar limpiado para ri → MAR omitido en etapa avanzada"));const p=c||u||l||d||P==="CALL"&&a==="SP"||P==="INT"&&X===4&&a==="SP"||P==="INT"&&X===5&&a==="SP"||P==="INT"&&X===7&&a==="SP"||P==="OUT"&&a==="ri"&&X===2;p?console.log("⏭️ Ciclo NO contabilizado en cpu:mar.set - skipCycleCount:",p,"isIndirectInstruction:",c,"isRiToMARSkipCycle:",u,"isArithmeticRegToDirectStep5:",d,"CALL con SP:",P==="CALL"&&a==="SP","(dirección ya almacenada en MAR o será manejado en mbr.set)"):(ot++,De++,d||A.set(It,De),console.log("🔢 Ciclo contabilizado en cpu:mar.set - cycleCount:",ot,"currentInstructionCycleCount:",De)),i.until==="cycle-change"&&(P==="MOV"&&a==="ri"&&X===4&&!Ye&&!ut&&pe.length===2&&pe[1].startsWith("[")&&pe[1].endsWith("]")?(console.log("🔍 MOV CL, [BL] paso 4 detectado - pausando en mar.set"),Ot()):P==="INT"&&a==="SP"&&X===4?console.log("⏭️ INT paso 6 detectado - NO pausando en cpu:mar.set (pausará en register.update)"):P==="INT"&&a==="SP"&&X===5?console.log("⚠️ INT paso 7 (executeStageCounter === 5) detectado - NO ESPERADO - NO pausando"):P==="INT"&&a==="SP"&&X===6?(console.log("🛑 INT paso 7 (ciclo 7) detectado - pausando en cpu:mar.set (SP → MAR)"),Ot()):P==="CALL"&&a==="SP"&&X===6?(console.log("🛑 CALL paso 7 detectado - pausando en cpu:mar.set (SP → MAR)"),Ot()):!u&&!(c&&!gc)&&Ot()),!u&&!(P==="INT"&&X===4&&a==="SP")&&!(P==="INT"&&X===5&&a==="SP")&&!(P==="INT"&&X===6&&a==="SP")&&!(P==="INT"&&X===7&&a==="SP")?(X++,console.log("🔍 cpu:mar.set - executeStageCounter después del incremento:",X)):console.log("⏭️ executeStageCounter NO incrementado para ri → MAR omitido o INT paso 6/7")}else if(s.value.type==="cpu:register.update"){const a=s.value.register;console.log("🔍 Debug register.update - fetchStageCounter:",Ur,"executeStageCounter:",X),console.log("🔍 Debug register.update - currentInstructionModeri:",Ye,"currentInstructionModeid:",ut);const l=TT();if(LT(l)){const c=Loe(a,l);OT("register.update",a,l,c);let u=c.message;Au=c.shouldDisplay;let d=c.shouldPause;Ye&&X===8&&P==="INT"&&(u="Ejecución: write(Memoria[MAR]) ← MBR; SP ← SP - 1"),X===4&&P==="CALL"&&(u="Ejecución: ri ← MBR | SP ← SP - 1",d=!0),X===4&&P==="INT"&&(console.log("🎯 INT paso 6 detectado en cpu:register.update"),console.log("   sourceRegister:",a),console.log("   executeStageCounter:",X),u="Ejecución: ri ← MBR | SP ← SP - 1",d=!0,console.log("   displayMessage establecido a:",u),console.log("   pause establecido a:",d)),X===3&&P==="CALL"&&a==="IP"&&(u="Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",d=!0),X===6&&P==="CALL"&&(u="Ejecución: write(Memoria[MAR]) ← MBR; SP ← SP - 1",d=!0),X===3&&a==="IP"&&(P==="MOV"||P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&(u="Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1"),X===3&&a==="IP"&&["JMP","JZ","JNZ","JC","JNC","JO","JNO","JS","JNS"].includes((P||"").toUpperCase())&&(u="Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1"),X===3&&P==="IN"&&a==="IP"&&(u="Ejecución: MBR ← read(PIO[MAR]) | IP ← IP + 1",d=!0,console.log("🎯 IN ciclo 5 detectado - mensaje combinado establecido")),X===5&&a==="IP"&&Ye&&ut&&(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&(u="Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1"),console.log("displayMessage:",u),console.log("currentInstructionName:",P),console.log("currentInstructionModeri:",Ye),console.log("executeStageCounter:",X),console.log("pause:",d),P==="PUSH"&&a==="SP"&&X===4?console.log("⏭️ PUSH paso 5 (SP update) - omitiendo ciclo y mensaje (ya mostrado en mbr.set)"):P==="INT"&&a==="SP"&&X===7?console.log("⏭️ INT paso 7 (SP update) - omitiendo ciclo y mensaje (ya mostrado en mar.set)"):P==="INT"&&a==="SP"&&X===8?console.log("⏭️ INT paso 9 (SP update) - omitiendo ciclo y mensaje (ya mostrado en mbr.set)"):P!=="DEC"&&P!=="INC"&&P!=="NOT"&&P!=="NEG"&&!(P==="INT"&&X===8)&&(A.set(We,u),ot++,De++,A.set(It,De),console.log("🔢 Ciclo contabilizado en cpu:register.update - cycleCount:",ot)),!(P==="PUSH"&&a==="SP"&&X===4)&&!(P==="INT"&&a==="SP"&&X===7)&&!(P==="INT"&&a==="SP"&&X===8)&&X++,u!=="Interrupción: MAR ← (video)"&&i.until==="cycle-change"&&(P!=="DEC"&&P!=="INC"&&P!=="NOT"&&P!=="NEG"&&!(P==="INT"&&X===12)&&!(P==="PUSH"&&a==="SP"&&X===4)&&!(P==="INT"&&a==="SP"&&X===7)&&!(P==="INT"&&a==="SP"&&X===8)?d&&Ot():P==="PUSH"&&a==="SP"&&X===4?(console.log("🛑 PUSH paso 5 (SP update) - pausando sin mensaje ni ciclo"),Ot()):P==="INT"&&X===6&&a==="FLAGS"&&(console.log("🛑 INT ciclo 8 (FLAGS update) - pausando después de actualización"),Ot()))}}else if(s.value.type==="cpu:alu.execute")P==="CMP"&&(A.set(We,`Ejecución: ${RT} ${P} ${Pu} ; update(FLAGS)`),ot++,De++,A.set(It,De),i.until==="cycle-change"&&Ot());else if(s.value.type==="cpu:mbr.get"){const a=s.value.register,l=s.value.register==="id.l"?"id":s.value.register==="IP.l"?"IP":s.value.register==="FLAGS.l"?"FLAGS":s.value.register==="ri.l"?"MBR":s.value.register;(String(l)==="right.l"||String(l)==="left.l")&&(Pu="MBR"),(Ye&&X===3&&(P==="ADD"||P==="SUB"||P==="CMP")||X===3&&(P==="ADD"||P==="SUB"||P==="CMP")&&Ye&&pe.length>=2&&(pe[0].startsWith("[")&&pe[0].endsWith("]")&&/^\[[0-9A-F]+h?\]$/i.test(pe[0])||pe[1].startsWith("[")&&pe[1].endsWith("]")&&/^\[[0-9A-F]+h?\]$/i.test(pe[1]))||X===3&&P==="POP"||Ye&&ut&&X===4&&P==="MOV"||a==="id.l"&&Ye&&ut&&(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")||a==="ri.l"&&Ye&&ut&&X===4&&(P==="MOV"||P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")||a==="ri.l"&&X===4&&(P==="INT"||P==="CALL"))&&(a==="id.l"&&Ye&&ut&&(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&(i0=!0),Jn=!0),P==="POP"&&X===3&&(r$=`Ejecución: ${l} ← MBR`);const c=a==="id.l"&&(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&!Ye&&ut&&X===4,u=P==="RET"&&X===3&&l==="IP",d=P==="IRET"&&X===3&&l==="IP",f=P==="IRET"&&X===5&&l==="FLAGS";if(c&&(console.log("🎯 Caso especial detectado: MBR → ID sin contabilizar ciclo ni mostrar mensaje"),console.log("   Instrucción:",P),console.log("   executeStageCounter:",X),console.log("   originalRegister:",a)),u&&(console.log("🎯 Caso especial RET paso 6 detectado: IP ← MBR sin contabilizar ciclo ni mostrar mensaje"),console.log("   Se mostrará mensaje combinado en cpu:register.update")),d&&(console.log("🎯 Caso especial IRET paso 6 detectado: IP ← MBR sin contabilizar ciclo ni mostrar mensaje"),console.log("   Se mostrará mensaje combinado en cpu:register.update")),f&&(console.log("🎯 Caso especial IRET paso 9 detectado: FLAGS ← MBR sin contabilizar ciclo ni mostrar mensaje"),console.log("   Se mostrará mensaje combinado en cpu:register.update: Flags ← MBR | SP ← SP + 1")),a==="ri.l"&&X===4&&(P==="INT"||P==="CALL")&&(console.log(`🎯 ${P} paso 6 detectado: MBR → ri con mbridirmar=${Jn}`),console.log(`🎯 showriAtom debería estar habilitado para ${P}`)),P==="INT"&&X===10&&a==="IP.l")console.log("🎯 INT paso 13 (ciclo 14) detectado: IP ← MBR - NO pausar aquí (pausará en cycle.end)"),A.set(We,"Ejecución: IP ← MBR"),ot++,De++,A.set(It,De),console.log("⏭️ INT paso 13: Omitiendo pausa - se pausará en cpu:cycle.end");else if(!Jn&&!c&&!u&&!d&&!f&&String(l)!=="MBR"&&String(l)!=="right.l"&&String(l)!=="left.l"){A.set(We,`Ejecución: ${l} ← MBR`),ot++,De++,A.set(It,De);const g=P==="MOV"&&(l==="AL"||l==="AH"||l==="BL"||l==="BH"||l==="CL"||l==="CH"||l==="DL"||l==="DH");i.until==="cycle-change"&&!g&&Ot()}}else if(s.value.type==="cpu:register.buscopy"){console.log("📋 Evento cpu:register.buscopy detectado");const a=s.value.src.replace(/\.l$/,""),l=s.value.dest.replace(/\.l$/,"");if(P==="MOV"){const c=`Ejecución: ${l} ← ${a}`;A.set(We,c),ot++,De++,A.set(It,De),console.log("✅ Ciclo contabilizado para MOV register.buscopy - cycleCount:",ot,"currentInstructionCycleCount:",De)}}else if(s.value.type==="cpu:register.copy"){console.log("📋 Evento cpu:register.copy detectado");const a=s.value.src.replace(/\.l$/,""),l=s.value.dest.replace(/\.l$/,"");P==="CALL"&&(console.log("🔍 CALL Debug en register.copy:"),console.log("   sourceRegister:",a,"(original:",s.value.src,")"),console.log("   destRegister:",l,"(original:",s.value.dest,")"),console.log("   executeStageCounter:",X),console.log("   currentInstructionName:",P),console.log("   ¿Es ri → IP?:",a==="ri"&&l==="IP"),console.log("   ¿Destino contiene IP?:",l.includes("IP")||s.value.dest.includes("IP")));let c="";P==="DEC"||P==="INC"||P==="NOT"||P==="NEG"?c=a==="result"?`${P} ${Pu}`:a:(c=a==="result"?`${l} ${P} ${Pu}`:a==="ri"?"MBR":a,IT=`MBR ${P} ${pe[1]}; update(FLAGS)`),P==="CMP"&&String(l)==="right"&&(Pu=a),P==="CMP"&&String(l)==="left"&&(RT=a);let u=`Ejecución: ${l==="ri"?"MAR":l} ← ${c}`;if((P==="ADD"||P==="SUB"||P==="CMP")&&l!=="left"&&l!=="right"&&(u+="; update(FLAGS)"),a==="ri"&&l==="IP")u="Ejecución: IP ← MBR",P==="CALL"?(console.log("🔍 CALL Debug - CONDICIÓN ri→IP CUMPLIDA"),console.log("🔍 CALL Debug - sourceRegister === 'ri':",a==="ri"),console.log("🔍 CALL Debug - destRegister === 'IP':",l==="IP"),console.log("🔍 CALL Debug - executeStageCounter:",X),console.log("🔍 CALL Debug - currentInstructionName:",P),console.log("🔄 CALL ri→IP: Delegando contabilización y mensaje a cpu:cycle.end"),console.log("🔄 CALL ri→IP: NO pausando, esperando cpu:cycle.end")):A.set(We,u),i.until==="cycle-change"&&P!=="CALL"&&Ot();else if(P==="CALL"&&X>=8&&(l==="IP"||s.value.dest.includes("IP")))console.log("🔍 CALL Debug - CONDICIÓN AMPLIADA PARA IP"),console.log("🔍 CALL Debug - sourceRegister:",a),console.log("🔍 CALL Debug - destRegister:",l),console.log("🔍 CALL Debug - executeStageCounter:",X),console.log("🔄 CALL transferencia ampliada: Delegando contabilización y mensaje a cpu:cycle.end"),console.log("🔄 CALL transferencia a IP (ampliada): NO pausando, esperando cpu:cycle.end");else if(l==="left"&&P==="INT")u="ADD BL, 1";else if(a==="result"&&P==="INT")i.until==="cycle-change"&&Ot();else if(a==="IP"&&l==="id")u="Ejecución: id ← IP",A.set(We,u),i.until==="cycle-change"&&Ot();else if(a==="id"&&l==="ri")u="Ejecución: MAR ← id",Au=!1,A.set(We,u);else if(a==="MBR"&&l==="ri")u="Ejecución: MAR ← MBR",A.set(We,u);else if(a==="id"&&l==="IP")u="Ejecución: IP ← MBR",A.set(We,u),i.until==="cycle-change"&&Ot();else if(a==="BL"&&l==="ri"||a==="BX"&&l==="ri"){const f=a==="BL"?"BL":"BX";vc=f,u=`Ejecución: MAR ← ${f}`,Au=!1,Jn=!0,gc=!0}else String(a)==="right.l"&&(Pu=a);if(console.log("cpu:register.copy - sourceRegister:",a,"destRegister:",l,"currentInstructionName:",P,"executeStageCounter:",X),(P==="MOV"||P==="ADD"||P==="SUB")&&l!=="left"&&l!=="right"){const f=(a==="BL"||a==="BX")&&l==="ri",p=P==="MOV"&&l==="ri"&&pe&&pe.length===2&&/^\[[A-Z]{2}\]$/i.test(pe[0])&&/^[0-9A-F]+h?$/i.test(pe[1]);!f&&!p?(A.set(We,u),ot++,De++,A.set(It,De),console.log(`✅ Ciclo contabilizado para ${P} register.copy - cycleCount:`,ot,"currentInstructionCycleCount:",De)):console.log(`⏭️ Ciclo NO contabilizado para ${P} register.copy (BL/BX→ri o indirecto-inmediato) - se contabilizará en cpu:mar.set`)}else(l!=="result"&&a!=="result"||a==="result"&&l!=="MBR")&&!((a==="BL"||a==="BX")&&l==="ri")&&!(l==="left"||l==="right")&&!(P==="CALL"&&a==="ri"&&l==="IP")&&P!=="INT"?(l==="left"||l==="right"||A.set(We,u),ot++,De++,A.set(It,De),console.log("✅ Ciclo contabilizado para register.copy - cycleCount:",ot,"currentInstructionCycleCount:",De,"destRegister:",l,"sourceRegister:",a)):console.log("❌ Ciclo NO contabilizado para register.copy - condición no cumplida:","destRegister:",l,"sourceRegister:",a)}else if(s.value.type==="bus:reset"&&X>1&&(P==="MOV"||P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR"||P==="CALL"||P==="INT"||P==="PUSH"||P==="POP"||P==="IN"||P==="RET"||P==="IRET")){(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&(!Ye&&!ut&&X===6&&pe.length===2&&pe[0].startsWith("[")&&pe[0].endsWith("]")&&/^[0-9A-F]+h?$/i.test(pe[0].replace(/\[|\]/g,""))&&/^[A-Z]+$/i.test(pe[1])?mt="Ejecución: write(Memoria[MAR]) ← MBR":mt="Ejecución: MBR ← read(Memoria[MAR])"),P==="RET"&&(mt="Ejecución: MBR ← read(Memoria[MAR])"),P==="IRET"&&(mt="Ejecución: MBR ← read(Memoria[MAR])"),P==="IN"&&(mt="Ejecución: MBR ← read(PIO[MAR])"),P==="INT"&&(X===11?(mt="Ejecución: write(Memoria[MAR]) ← MBR",console.log("🎯 INT paso 11 detectado - estableciendo mensaje de escritura:",mt)):X===6?(mt="Ejecución: write(Memoria[MAR]) ← MBR",console.log("🎯 INT ciclo 8 detectado en bus:reset - executeStageCounter:",X)):Nu?mt="Ejecución: write(Memoria[MAR]) ← MBR":mt="Ejecución: MBR ← read(Memoria[MAR])"),P==="MOV"&&X===5&&(console.log("🔍 MOV Debug - Operandos:",pe),console.log("🔍 MOV Debug - Es lectura:",s0(pe)),s0(pe)?mt="Ejecución: MBR ← read(Memoria[MAR])":mt="Ejecución: write(Memoria[MAR]) ← MBR"),(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&ut&&!Ye&&X===5?Nu?mt="Ejecución: write(Memoria[MAR]) ← MBR":mt="Ejecución: MBR ← read(Memoria[MAR])":(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&ut&&!Ye&&X===9?(mt="Ejecución: write(Memoria[MAR]) ← MBR",console.log("🎯 Paso 9 ADD [BL], 2 - Estableciendo mensaje de escritura:",mt)):(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&ut&&Ye&&X===8?Nu?(mt="Ejecución: write(Memoria[MAR]) ← MBR",console.log("🎯 Paso 8 ADD [04], 02h - Estableciendo mensaje de escritura:",mt)):(mt="Ejecución: MBR ← read(Memoria[MAR])",console.log("🎯 Paso 8 ADD [04], 02h - Estableciendo mensaje de lectura:",mt)):(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&!ut&&!Ye&&(Nu?mt="Ejecución: write(Memoria[MAR]) ← MBR":mt="Ejecución: MBR ← read(Memoria[MAR])");let a=!1,l=!1;(P==="MOV"||P==="ADD"||P==="SUB")&&mt==="Ejecución: write(Memoria[MAR]) ← MBR"&&(Ye&&!ut&&X===6||!ut&&X===5||Ye&&ut&&X===8)&&(l=!0),Ye&&(X===4||X===8)&&P==="INT"||X===3&&(P==="MOV"||P==="ADD"||P==="SUB")&&Ye||X===3&&(P==="MOV"||P==="ADD"||P==="SUB")&&!Ye&&!ut&&pe.length>=2&&(!pe[0].startsWith("[")&&!pe[0].endsWith("]")&&!pe[1].startsWith("[")&&!pe[1].endsWith("]")&&(/^\d+$/.test(pe[1])||/^\d+h$/i.test(pe[1])||/^[0-9A-F]+h?$/i.test(pe[1])||/^\d+$/.test(pe[0])||/^\d+h$/i.test(pe[0])||/^[0-9A-F]+h?$/i.test(pe[0]))||pe[0].startsWith("[")&&pe[0].endsWith("]")&&/^\[[0-9A-F]+h?\]$/i.test(pe[0])||pe[1].startsWith("[")&&pe[1].endsWith("]")&&/^\[[0-9A-F]+h?\]$/i.test(pe[1]))||X===3&&(P==="MOV"||P==="ADD"||P==="SUB")&&!Ye&&!ut&&pe.length>=2&&(pe[0].startsWith("[")&&pe[0].endsWith("]")&&/^\[[A-Z]+\]$/i.test(pe[0])&&(/^\d+$/.test(pe[1])||/^\d+h$/i.test(pe[1]))||pe[1].startsWith("[")&&pe[1].endsWith("]")&&/^\[[A-Z]+\]$/i.test(pe[1])&&(/^\d+$/.test(pe[0])||/^\d+h$/i.test(pe[0])))||X===5&&(P==="MOV"||P==="ADD"||P==="SUB")&&Ye||ut&&X===4&&(P==="ADD"||P==="SUB"||P==="CMP")||X===3&&(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&mt!=="Ejecución: MBR ← read(Memoria[MAR])"||X===3&&(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")&&ut&&!Ye&&mt==="Ejecución: MBR ← read(Memoria[MAR])"||X===3&&P==="CALL"&&mt==="Ejecución: MBR ← read(Memoria[MAR])"||X===7&&P==="CALL"&&mt==="Ejecución: write(Memoria[MAR]) ← MBR"||X>=8&&P==="CALL"||X===3&&P==="INT"&&mt==="Ejecución: MBR ← read(Memoria[MAR])"||X===3&&P==="IN"&&mt==="Ejecución: MBR ← read(PIO[MAR])"?(a=!0,console.log("🔄 ContinuarSinGuardar establecido a true - condición cumplida"),P==="CALL"&&X>=8&&console.log("✅ CALL paso",X,"- bus:reset omitido correctamente"),P==="IN"&&X===3&&console.log("✅ IN paso",X,"(ciclo 5) - bus:reset omitido correctamente")):(console.log("🔄 ContinuarSinGuardar mantenido como false - ninguna condición cumplida"),X===3&&(P==="MOV"||P==="ADD"||P==="SUB")&&!Ye&&!ut&&(console.log(`🔍 Debug ${P} step 3:`),console.log("   Operandos length >= 2:",pe.length>=2),console.log("   Operando[0] no tiene []:",!pe[0].startsWith("[")&&!pe[0].endsWith("]")),console.log("   Operando[1] no tiene []:",!pe[1].startsWith("[")&&!pe[1].endsWith("]")),console.log("   Test operando[0] es dirección:",/^\d+$/.test(pe[0])||/^\d+h$/i.test(pe[0])||/^[0-9A-F]+h?$/i.test(pe[0])),console.log("   Test operando[1] es inmediato:",/^\d+$/.test(pe[1])||/^\d+h$/i.test(pe[1])||/^[0-9A-F]+h?$/i.test(pe[1])))),console.log("ContinuarSinGuarda:",a),console.log("executeStageCounter:",X),console.log("isLastStepBeforeCycleEnd:",l),console.log("🔍 bus:reset Debug - messageReadWrite:",mt),console.log("🔍 bus:reset Debug - currentInstructionModeri:",Ye),console.log("🔍 bus:reset Debug - currentInstructionModeid:",ut),console.log("🔍 bus:reset Debug - currentInstructionOperands:",pe),console.log("🔍 bus:reset Debug - Operando[0]:",pe[0]),console.log("🔍 bus:reset Debug - Operando[1]:",pe[1]),console.log("🔍 bus:reset Debug - Condición MOV/ADD/SUB directo step 3:",X===3&&(P==="MOV"||P==="ADD"||P==="SUB")&&!Ye&&!ut),console.log("🔍 bus:reset Debug - Es lectura de memoria:",mt==="Ejecución: MBR ← read(Memoria[MAR])"),console.log("🔍 bus:reset Debug - MOV/ADD/SUB indirecto debe mostrar:",(P==="MOV"||P==="ADD"||P==="SUB")&&!Ye&&!ut&&X===5&&mt==="Ejecución: MBR ← read(Memoria[MAR])"),P==="INT"&&X===6&&mt==="Ejecución: write(Memoria[MAR]) ← MBR"?(console.log("🎯 INT ciclo 8 detectado en bus:reset (executeStageCounter=6)"),console.log("⏭️ Omitiendo mensaje, ciclo y pausa - se manejará en cpu:register.update")):a?l&&(A.set(We,mt),ot++,De++,A.set(It,De)):(A.set(We,mt),ot++,De++,A.set(It,De),i.until==="cycle-change"&&Ot())}else if(s.value.type==="cpu:mbr.set"){const a=s.value.register==="id.l"?"id":s.value.register==="FLAGS.l"?"FLAGS":s.value.register==="IP.l"?"IP":s.value.register==="result.l"?IT:s.value.register;if(Ye&&X===5&&(P==="ADD"||P==="SUB"))t0=!0,n0=`Ejecución: MBR ← ${a} ; MAR ← MBR`;else if(P==="PUSH"&&X===3&&["AL","BL","CL","DL","AH","BH","CH","DH","AX","BX","CX","DX"].includes(a))console.log(`🎯 PUSH paso 5 detectado: ${a} → MBR | SP ← SP - 1`),A.set(We,`Ejecución: MBR ← ${a} | SP ← SP - 1`),ot++,De++,A.set(It,De),X++,console.log("⏭️ PUSH paso 5 (MBR ← registro) - NO pausando, pausará en cpu:register.update");else if(Ye&&ut&&X===5&&(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR"))A.set(We,"Ejecución: id ← MBR"),i.until==="cycle-change"&&Ot(),X++,ot++,De++,A.set(It,De);else if(Ye&&ut&&X===6&&(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR"))console.log("🎯 Ciclo 6 detectado - delegando a events.ts para animación simultánea MBR → ri + IP → MAR");else if(Ye&&ut&&X===7&&s.value.register==="result.l"&&(P==="ADD"||P==="SUB"||P==="CMP"||P==="AND"||P==="OR"||P==="XOR")){const l=a.replace("; write(FLAGS)","; update(FLAGS)");A.set(We,`Ejecución: MBR ← ${l}`),i.until==="cycle-change"&&Ot(),X++,ot++,De++,A.set(It,De)}else if(P==="MOV"&&(X===5||X===6||X===3)&&["AL","BL","CL","DL","AH","BH","CH","DH"].includes(a)&&!Ye&&!ut)console.log(`🎯 MOV paso 5/3 detectado: ${a} → MBR`),A.set(We,`Ejecución: MBR ← ${a}`),ot++,De++,A.set(It,De),X++,i.until==="cycle-change"&&Ot();else if(P==="CALL"&&a==="IP")A.set(We,"Ejecución: MAR ← SP | MBR ← IP"),ot++,De++,A.set(It,De),X++,console.log("⏭️ CALL IP → MBR: NO pausando, pausará en siguiente cpu:mar.set con SP");else if(P==="INT"&&a==="FLAGS"&&X===5)console.log("🎯 INT paso 7 (ciclo 7) detectado: FLAGS → MBR (sin mensaje, sin ciclo, sin pausa)"),X++;else if(P==="INT"&&a==="IP"&&X===7)console.log("🎯 INT paso 9 (ciclo 9) detectado: IP → MBR | SP ← SP - 1"),A.set(We,"Ejecución: MBR ← IP | SP ← SP - 1"),ot++,De++,A.set(It,De),X++,i.until==="cycle-change"&&(console.log("🛑 INT paso 9 - pausando en cpu:mbr.set (IP → MBR | SP ← SP - 1)"),Ot());else if(s.value.register==="result.l"){const l=`Ejecución: MBR ← ${a.replace("; write(FLAGS)"," ; update(FLAGS)")}`;A.set(We,l),ot++,De++,A.set(It,De),i.until==="cycle-change"&&Ot()}else P==="OUT"&&X===3&&["AL","BL","CL","DL","AH","BH","CH","DH"].includes(a)?(console.log(`🎯 OUT paso 5 (ciclo 5) detectado: ${a} → MBR`),A.set(We,`Ejecución: MBR ← ${a}`),ot++,De++,A.set(It,De),X++,i.until==="cycle-change"&&(console.log("🛑 OUT paso 5 - pausando en cpu:mbr.set (registro → MBR)"),Ot())):P==="OUT"&&X===5&&["AL","BL","CL","DL","AH","BH","CH","DH"].includes(a)?(console.log(`🎯 OUT paso 7 (ciclo 7) detectado: ${a} → MBR`),A.set(We,`Ejecución: MBR ← ${a}`),ot++,De++,A.set(It,De),X++,i.until==="cycle-change"&&(console.log("🛑 OUT paso 7 - pausando en cpu:mbr.set (registro → MBR)"),Ot())):console.log("🎬 Permitiendo que events.ts maneje cpu:mbr.set para animaciones normales")}}else A.set(We,"");if(console.log(`Ciclos ejecutados: ${ot}`),A.set(af,ot),r0&&i.until==="cycle-change"){console.log("🛑 Ejecutando pausa especial después del evento"),r0=!1,Ot();continue}const o=new CustomEvent("instructionChange",{detail:{instruction:P,modeid:ut,moderi:Ye}});window.dispatchEvent(o),s.value.type==="cpu:cycle.update"||s.value.type==="cpu:cycle.interrupt"?i.until:s.value.type==="cpu:cycle.end"&&(i.until==="end-of-instruction"||i.until==="cycle-change")&&Ot()}t.return()}catch(e){const n=mn.from(e);Zr(n)}}async function Ih(...t){const e=t[0],n=A.get(jt);switch(e){case"cpu.run":{if(n.type==="running")return Eu();const i=t[1];if(n.type==="stopped"){if(!window.codemirror)return;ot=0,ra=0,A.set(af,ot),A.set(jl,ra),A.set(ws,[]);const r=window.codemirror.state.doc.toString(),s=e8(r);if(!s.success)return Eoe();const o=s.instructions.map(R=>R.instruction),a=o.some(R=>["CALL","RET","INT","IRET","POP","PUSH"].includes(R));A.set(Vb,a);const l=o.includes("INT"),c=o.some(R=>["INT","CLI","STI","IRET"].includes(R)),u=s.instructions.some(R=>R.instruction==="INT"?R.operands.some(T=>T.type==="number-expression"&&typeof T.value.value=="number"?T.value.value===6||T.value.value===7:!1):!1),d=s.instructions.some(R=>R.instruction==="IN"||R.instruction==="OUT"?R.operands.some(T=>T.type==="number-expression"&&typeof T.value.value=="number"?T.value.value>=48&&T.value.value<=51:!1):!1),f=s.instructions.some(R=>R.instruction==="IN"||R.instruction==="OUT"?R.operands.some(T=>{if(T.type==="number-expression"){if(typeof T.value.value=="number"){const L=T.value.value>=32&&T.value.value<=43;return L&&console.log(`🎯 PIC detectado: ${R.instruction} con operando ${T.value.value.toString(16)}h`),L}try{if(T.value&&typeof T.value.resolve=="function"){const L=T.value.resolve();if(typeof L=="number"){const I=L>=32&&L<=43;return I&&console.log(`🎯 PIC detectado: ${R.instruction} con operando resuelto ${L.toString(16)}h`),I}}}catch(L){console.warn("No se pudo resolver operando PIC:",L)}}return!1}):!1);console.log("🔍 Análisis de instrucciones para PIC:",{totalInstructions:s.instructions.length,inOutInstructions:s.instructions.filter(R=>R.instruction==="IN"||R.instruction==="OUT").length,usesPIC:f,mayUsePICFromAssembler:s.mayUsePIC,firstFewInstructions:s.instructions.slice(0,5).map(R=>{var T;return{instruction:R.instruction,operands:(T=R.operands)==null?void 0:T.map(L=>({type:L.type,value:L.type==="number-expression"?L.value.value:L.value}))}})});const p=s.instructions.some(R=>R.instruction==="IN"||R.instruction==="OUT"?R.operands.some(T=>{if(T.type==="number-expression"){if(typeof T.value.value=="number")return T.value.value===64||T.value.value===65;try{if(T.value&&typeof T.value.resolve=="function"){const L=T.value.resolve();if(typeof L=="number")return L===64||L===65}}catch(L){console.warn("No se pudo resolver operando Handshake:",L)}}return!1}):!1),m=s.instructions.some(R=>R.instruction==="IN"||R.instruction==="OUT"?R.operands.some(T=>{if(T.type==="number-expression"){if(typeof T.value.value=="number")return T.value.value===16||T.value.value===17;try{if(T.value&&typeof T.value.resolve=="function"){const L=T.value.resolve();if(typeof L=="number")return L===16||L===17}}catch(L){console.warn("No se pudo resolver operando Timer:",L)}}return!1}):!1),g=Ge(),y=A.get(em);console.log("🔍 Verificando si programa fue modificado:",y);const v=f||(s.mayUsePIC??!1);v&&!g.devices.pic&&(zc("PIC activado automáticamente","Se detectó que el programa utiliza el PIC (direcciones 20h-2Bh). El módulo PIC se ha activado automáticamente, se ha reservado espacio para el vector de interrupciones y se ha configurado la visualización del flag I (interrupt flag)."),console.log("🔧 PIC activado automáticamente debido a detección de uso en el código"),console.log("🔧 Flag I configurado para mostrarse automáticamente")),c&&!v&&!g.devices.pic&&!mw?(zc("Flag I activado automáticamente","Se detectó que el programa utiliza instrucciones de interrupción (INT, CLI, STI o IRET). El flag I se ha configurado para mostrarse automáticamente."),console.log("🔧 Flag I configurado para mostrarse debido a instrucciones de interrupción en el código"),mw=!0):c||(mw=!1),m&&!g.devices.pic&&(zc("Timer y Reloj activados automáticamente","Se detectó que el programa utiliza el Timer (direcciones 10h-11h). El módulo PIC se ha activado automáticamente ya que el Timer requiere el PIC para funcionar."),console.log("🔧 PIC y Timer activados automáticamente debido a detección de uso del Timer en el código"));const b=(v||m)&&!g.devices.pic||c;A.set(Li,R=>({...R,devices:{...R.devices,keyboardAndScreen:u,pio:d?"switches-and-leds":p?"printer":R.devices.pio,handshake:p?"printer":R.devices.handshake,pic:v||m||R.devices.pic,"switches-and-leds":d},flagsVisibility:b?R.flagsVisibility==="SF_OF_CF_ZF"?"IF_SF_OF_CF_ZF":R.flagsVisibility==="CF_ZF"?"IF_CF_ZF":R.flagsVisibility:R.flagsVisibility})),A.set(lE,u);const w=l||v;A.set(cE,w),A.set(Hb,s.mayUsePIC??!1),console.log("🔍 DEBUG Vector de Interrupciones:",{hasINT:l,usesPIC:f,shouldActivatePIC:v,usesHandshake:p,usesTimer:m,connectScreenAndKeyboard:u,hasINTOrInterruptDevices:w,hasInterruptFlagInstructions:c,shouldShowInterruptFlag:b,currentHandshakeConfig:Ge().devices.handshake,currentPICConfig:Ge().devices.pic}),console.log("Detectado - PIC:",f,"shouldActivatePIC:",v,"Handshake:",p,"Timer:",m,"INT:",l,"PIC Config:",Ge().devices.pic),console.log("Habilitando vector de interrupciones:",w),console.log("Timer se activará automáticamente:",m,"- PIC se activará para soportar Timer:",m||v);const k=Ge(),C=y?"clean":g.dataOnLoad;console.log("🔧 Configuración de carga de datos:",C,"(programa modificado:",y,")"),y&&A.set(em,!1),Nn.loadProgram({program:s,data:C,devices:{keyboardAndScreen:k.devices.keyboardAndScreen??!1,pic:k.devices.pic??!1,pio:k.devices.pio??null,handshake:k.devices.handshake??null},hasORG:s.hasORG,hasORG20hAtStart:s.hasORG20hAtStart,hasINTOrInterruptDevices:w,mayUsePIC:s.mayUsePIC}),console.log("result:",s);const E=s.instructions.filter(R=>R.type==="instruction").flatMap(R=>{const T=R.operands.map(G=>{if(G.type==="register")return G.value;if(G.type==="number-expression"){const B=G.value;if(B.isNumberLiteral())return B.value.toString(16)+"h";if(B.isLabel())return B.value}else{if(G.type==="indirect-address")return"[BL]";if(G.type==="direct-address"){const B=G.value;if(B.isNumberLiteral())return B.value.toString(16)+"h"}}return""}).join(", "),L=`${R.instruction} ${T}`.trim(),I=[{address:R.start.value,name:L,length:R.length.toString().trim()}];if(R.operands.some(G=>G.type==="number-expression"||G.type==="direct-address")){const G=R.start.value+1,B=R.operands.filter((q,Y)=>R.length===3?Y===0&&q.type==="number-expression":q.type==="number-expression").map(q=>{if(q.type==="number-expression"){const Y=q.value;if(Y.isNumberLiteral())return Y.value.toString(16)+"h";if(Y.isLabel())return Y.value}else if(q.type==="direct-address"){const Y=q.value;if(Y.isNumberLiteral())return Y.value.toString(16)+"h"}return""}).join(", ");I.push({address:G,name:B,length:""})}if(R.length===3){const G=R.start.value+2,B=R.operands.filter(q=>q.type==="number-expression").map(q=>{if(q.type==="number-expression"){const Y=q.value;if(Y.isNumberLiteral())return Y.value.toString(16)+"h"}return""}).join(" ");I.push({address:G,name:B,length:""})}return I}),_=s.data.filter(R=>R.type==="data-directive").flatMap(R=>{const T=R.start.value;return R.getValues().map(I=>typeof I=="object"&&I!==null&&"toNumber"in I&&typeof I.toNumber=="function"?I.toNumber():typeof I=="number"?I:0).map((I,G)=>({address:T+G,label:G===0&&R.label||null,value:I}))});console.log("Direcciones de las instrucciones:",E),console.log("Direcciones de los datos:",_),A.set(c8,E),A.set(u8,_.map(R=>({...R,length:""}))),MT(Nn.getComputerState());const M=["Start CPU",{until:i,devices:Ge().devices,language:Ge().language,animations:Ge().animations?"yes":"no"}];B6.capture(...M),A.set(jt,{type:"running",until:i,waitingForInput:!1}),zu(Nn.startCPU()),console.log("🕐 [DEBUG] Iniciando reloj..."),Hoe(),console.log("🖨️ [DEBUG] Iniciando impresora..."),Woe()}else A.set(jt,{type:"running",until:i,waitingForInput:!1}),KB();return}case"cpu.stop":{const i=t[1];if(i){Zr(),MT(Nn.getComputerState(),i);const{anim:r}=await zp(async()=>{const{anim:o}=await Promise.resolve().then(()=>Lse);return{anim:o}},void 0);await Promise.all([r({key:"cpu.internalBus.data.opacity",to:0},{duration:.1,easing:"easeInSine"}),r({key:"cpu.internalBus.address.opacity",to:0},{duration:.1,easing:"easeInSine"})]);const s=new CustomEvent("instructionChange",{detail:{instruction:"",modeid:!1,moderi:!1}});window.dispatchEvent(s)}else Ot();return}case"f10.press":{if(!Nn.devices.f10.connected()||n.type!=="running")return Eu();if(NT("f10:press"))return;zu(Nn.devices.f10.press());return}case"switch.toggle":{if(!Nn.devices.switches.connected())return Eu();if(NT("switches:toggle"))return;const i=t[1];n.type==="running"?zu(Nn.devices.switches.toggle(i)):A.set(l1,r=>r.withBit(i,!r.bit(i)));return}case"keyboard.sendChar":{if(n.type!=="running"||!n.waitingForInput)return Eu();Nn.devices.keyboard.readChar(H.fromChar(t[1])),A.set(jt,{...n,waitingForInput:!1});return}case"screen.clean":{if(!Nn.devices.screen.connected())return Eu();zu(Nn.devices.screen.clear());return}case"printer.clean":{if(!Nn.devices.printer.connected())return Eu();zu(Nn.devices.printer.clear());return}default:return e}}async function Hoe(){if(console.log("🕐 [DEBUG] startClock llamado, verificando conexión..."),!Nn.devices.clock.connected()){console.log("🕐 [DEBUG] Reloj NO conectado, saliendo");return}for(console.log("🕐 [DEBUG] Reloj conectado, iniciando bucle de ticks");A.get(jt).type!=="stopped";){const t=Ge().clockSpeed;if(console.log("🕐 [DEBUG] Esperando",t,"ms antes del próximo tick"),await new Promise(e=>setTimeout(e,t)),A.get(jt).type!=="stopped"){console.log("🕐 [DEBUG] Disparando tick del reloj");const e=Nn.devices.clock.tick();console.log("🕐 [DEBUG] Generador del reloj creado:",e),zu(e,!0)}else{console.log("🕐 [DEBUG] Simulación detenida, saliendo del bucle de reloj");break}}console.log("🕐 [DEBUG] Bucle de reloj terminado")}async function Woe(){if(!Nn.devices.printer.connected())return;console.log("🖨️ [DEBUG] startPrinter: Impresora conectada, iniciando procesamiento de buffer");const t=async()=>{if(A.get(jt).type!=="stopped"){if(Nn.devices.printer.hasPending()){console.log("🖨️ [DEBUG] Procesando caracteres pendientes en buffer de impresora");const e=Ge().printerSpeed;await ce([{key:"printer.printing.opacity",from:1},{key:"printer.printing.progress",from:0,to:1}],{duration:e,forceMs:!0,easing:"easeInOutSine"}),await ce({key:"printer.printing.opacity",to:0},{duration:1,easing:"easeInSine"});const n=Nn.devices.printer.print();if(n){let i=n.next();for(;!i.done;)i.value&&typeof i.value<"u"&&await i$(i.value),i=n.next()}}A.get(jt).type!=="stopped"&&setTimeout(t,Ge().printerSpeed)}};t()}function Kn(){const t=rt(jt),e=aZ(),n=x.useMemo(()=>({hasIOBus:e.pic||e.pio!==null||e.handshake!==null,clock:e.pic,f10:e.pic,keyboard:e.keyboardAndScreen,handshake:e.handshake,leds:e.pio==="switches-and-leds",pic:e.pic,pio:e.pio,printer:e.pio==="printer"||e.handshake==="printer",screen:e.keyboardAndScreen,switches:e.pio==="switches-and-leds",timer:e.pic}),[e]);return{status:t,dispatch:Ih,devices:n}}function Goe({className:t}){const e=un(),{status:n,dispatch:i}=Kn(),[r,s]=x.useState(null),[o,a]=x.useState("desktop");x.useEffect(()=>{const g=()=>{const y=window.innerWidth;y<=480?a("mobile"):y<=768?a("compact"):y<=1024?a("tablet"):a("desktop")};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),x.useEffect(()=>{n.type!=="running"&&s(null)},[n.type]);const l=x.useCallback(()=>{n.type!=="running"&&(s("cycle-change"),i("cpu.run","cycle-change"))},[n.type,i]);ju("F7",g=>{g.preventDefault(),l()},void 0,[l]);const c=x.useCallback(()=>{n.type!=="running"&&(s("end-of-instruction"),i("cpu.run","end-of-instruction"))},[n.type,i]);ju("F8",g=>{g.preventDefault(),c()},void 0,[c]);const u=x.useCallback(()=>{n.type!=="running"&&(s("infinity"),i("cpu.run","infinity"))},[n.type,i]);ju("F4",g=>{g.preventDefault(),u()},void 0,[u]);const d=x.useCallback(()=>{n.type==="running"&&i("cpu.stop",!1)},[n.type,i]),f=x.useCallback(()=>{n.type!=="running"&&i("cpu.stop",!0)},[n.type,i]);ju("F9",g=>{g.preventDefault(),f()},void 0,[f]),ju(" ",g=>{const y=g.target;y.tagName==="INPUT"||y.tagName==="TEXTAREA"||y.contentEditable==="true"||(g.preventDefault(),n.type==="running"&&d())},{event:"keydown"},[n.type,d]);const p=o==="desktop"||o==="tablet",m=o==="desktop";return h.jsxs("div",{"data-testid":"controls",className:re("flex items-center justify-center gap-4 rounded-xl border border-stone-700 bg-stone-900/80 shadow-lg",o==="mobile"?"gap-2 px-2 py-0.5":o==="compact"?"gap-3 px-2 py-1":"gap-4 px-3 py-1",t),children:[n.type==="running"&&r==="cycle-change"?h.jsxs("button",{"data-testid":"cycle-button",onClick:d,title:e("control.action.pause"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-orange-600/20 focus-visible:ring-2 focus-visible:ring-orange-400",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Qe,{icon:Jh,size:"lg",className:"text-orange-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"Space"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.pause")})]}):h.jsxs("button",{"data-testid":"cycle-button",disabled:n.type==="running",onClick:l,title:e("control.action.run.cycle-change"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-mantis-600/20 focus-visible:ring-2 focus-visible:ring-mantis-400 disabled:opacity-50",n.type==="running"&&n.until==="cycle-change"&&"animate-pulse-glow-mantis",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Qe,{icon:Bb,size:"lg",className:"text-mantis-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"F7"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.run.cycle-change")})]}),n.type==="running"&&r==="end-of-instruction"?h.jsxs("button",{"data-testid":"new-button",onClick:d,title:e("control.action.pause"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-orange-600/20 focus-visible:ring-2 focus-visible:ring-orange-400",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Qe,{icon:Jh,size:"lg",className:"text-orange-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"Space"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.pause")})]}):h.jsxs("button",{"data-testid":"new-button",disabled:n.type==="running",onClick:c,title:e("control.action.run.end-of-instruction"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-mantis-600/20 focus-visible:ring-2 focus-visible:ring-mantis-400 disabled:opacity-50",n.type==="running"&&n.until==="end-of-instruction"&&"animate-pulse-glow-mantis",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Qe,{icon:Y_,size:"lg",className:"text-mantis-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"F8"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.run.end-of-instruction")})]}),n.type==="running"&&r==="infinity"?h.jsxs("button",{"data-testid":"open-button",onClick:d,title:e("control.action.pause"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-orange-600/20 focus-visible:ring-2 focus-visible:ring-orange-400",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Qe,{icon:Jh,size:"lg",className:"text-orange-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"Space"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.pause")})]}):h.jsxs("button",{"data-testid":"open-button",disabled:n.type==="running",onClick:u,title:e("control.action.run.infinity"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-mantis-600/20 focus-visible:ring-2 focus-visible:ring-mantis-400 disabled:opacity-50",n.type==="running"&&n.until==="infinity"&&"animate-pulse-glow-mantis",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Qe,{icon:fJ,size:"lg",className:"text-mantis-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"F4"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.run.infinity")})]}),h.jsxs("button",{"data-testid":"assemble-button",onClick:f,disabled:n.type==="stopped"||n.type==="running",title:e("control.action.reset"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-red-600/20 focus-visible:ring-2 focus-visible:ring-red-400 disabled:opacity-50",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Qe,{icon:Tj,size:"lg",className:"text-red-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"F9"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.reset")})]})]})}const s$=x.memo(({currentPhase:t="idle",className:e})=>{const[n,i]=x.useState("idle"),[r,s]=x.useState(!1);x.useEffect(()=>{if(t!=="idle"){i(t);const a=setTimeout(()=>i("idle"),1e3);return()=>clearTimeout(a)}},[t]);const o=[{id:"captacion",label:"Captación",color:"text-blue-400",icon:"📥",descripcion:"Captando instrucción desde memoria",pasos:["IP apunta a la dirección de memoria, el MAR recibe la dirección del IP","Se lee el contenido de memoria y se almacena en el MBR, IP se incrementa automáticamente","La instrucción se transfiere al IR"]},{id:"ejecucion",label:"Ejecución",color:"text-green-400",icon:"⚡",descripcion:"Ejecutando instrucción",subfases:[{id:"operandos",label:"Obtención de operandos",color:"text-yellow-400",icon:"🔍",descripcion:"Obteniendo operandos de la instrucción",pasos:["Se identifican y preparan los operandos necesarios para la operación."]},{id:"alu",label:"Procesar en ALU",color:"text-green-400",icon:"⚡",descripcion:"Procesando en la ALU",pasos:["La ALU ejecuta la operación aritmética o lógica con los operandos."]},{id:"escritura",label:"Escribir resultado",color:"text-purple-400",icon:"💾",descripcion:"Escribiendo resultado en registros",pasos:["El resultado de la operación se almacena en el registro destino."]}]}];return h.jsxs("div",{className:re("flex flex-col gap-2 rounded-lg border-2 border-stone-400 bg-gradient-to-br from-stone-700 via-stone-600 to-stone-800 p-3 shadow-lg ring-1 ring-stone-300","min-w-[280px] max-w-[320px]",e),children:[h.jsx("div",{className:"mb-2 flex items-center justify-between",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[6px] font-bold text-stone-300",children:"CICLO CPU"}),h.jsx("button",{onClick:()=>s(!r),className:re("rounded border px-2 py-1 text-[10px] font-bold transition-all duration-200",r?"border-stone-300 bg-stone-300 text-stone-950 shadow-[0_0_4px_rgba(120,113,108,0.6)]":"border-stone-600 bg-stone-800 text-stone-300 hover:border-stone-400 hover:bg-stone-700"),children:r?"−":"+"})]})}),h.jsx("div",{className:"mt-2 flex items-center justify-center gap-2",children:o.map((a,l)=>h.jsxs("div",{className:"flex items-center",children:[h.jsxs("div",{className:re("flex cursor-pointer flex-col items-center gap-1 rounded border-2 px-2 py-1 transition-all duration-200","hover:border-stone-300 hover:bg-stone-700",t===a.id?"border-stone-300 bg-stone-300 text-stone-950 shadow-[0_0_4px_rgba(120,113,108,0.6)]":"border-stone-600 bg-stone-800 text-stone-300",n===a.id&&"animate-pulse"),onClick:()=>{var c;if(r)if(a.subfases){let u="";a.subfases.forEach(d=>{u+=`${d.label}
${d.descripcion}
Pasos:
${d.pasos.map((f,p)=>`${p+1}. ${f}`).join(`
`)}`,u+=`

`}),alert(u)}else alert(`${a.label}

${a.descripcion}

Pasos:
${(c=a.pasos)==null?void 0:c.map((u,d)=>`${d+1}. ${u}`).join(`
`)}`)},children:[h.jsx("div",{className:re("text-lg transition-transform duration-300",t===a.id&&"scale-110"),children:a.icon}),h.jsx("span",{className:re("text-[10px] font-bold uppercase tracking-wide transition-colors",t===a.id?"text-stone-950":"text-stone-300"),children:a.label}),h.jsx("span",{className:"max-w-16 text-center text-[9px] leading-tight text-stone-500",children:a.descripcion})]}),l<o.length-1&&h.jsx("div",{className:"mx-1 font-bold text-stone-400",children:"→"})]},a.id))}),r&&h.jsx("div",{className:"mt-2 rounded border-2 border-stone-600 bg-stone-800/80 p-2",children:h.jsxs("div",{className:"text-xs text-stone-300",children:[h.jsx("div",{className:"mb-1 font-bold text-stone-200",children:"Estado actual:"}),t==="fetch"&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 animate-pulse rounded-full bg-stone-300"}),h.jsx("span",{children:"Leyendo instrucción desde memoria"})]}),t==="decode"&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 animate-pulse rounded-full bg-stone-300"}),h.jsx("span",{children:"Interpretando código de operación"})]}),t==="execute"&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 animate-pulse rounded-full bg-stone-300"}),h.jsx("span",{children:"Ejecutando operación en ALU"})]}),t==="idle"&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 rounded-full bg-stone-400"}),h.jsx("span",{children:"CPU en espera de instrucciones"})]})]})}),h.jsx("div",{className:"text-center text-[8px] text-stone-500",children:"Haz clic en las fases para ver detalles"})]})});s$.displayName="ExecutionPhases";const Xoe=x.memo(({steps:t,onStepChange:e,onComplete:n,className:i})=>{const[r,s]=x.useState(0),[o,a]=x.useState(!1),[l,c]=x.useState(2e3),u=t[r],d=r===0,f=r===t.length-1,p=x.useCallback(b=>{const w=Math.max(0,Math.min(b,t.length-1));s(w),e==null||e(w)},[t.length,e]),m=x.useCallback(()=>{f?(a(!1),n==null||n()):p(r+1)},[r,f,p,n]),g=x.useCallback(()=>{d||p(r-1)},[r,d,p]),y=x.useCallback(()=>{p(0),a(!1)},[p]),v=x.useCallback(()=>{a(!o)},[o]);return o&&!f&&setTimeout(m,l),h.jsxs("div",{className:re("rounded-lg border border-stone-600 bg-stone-900 p-4",i),children:[h.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[h.jsx("h3",{className:"text-lg font-semibold text-mantis-400",children:"Modo Paso a Paso"}),h.jsx("div",{className:"flex items-center gap-2",children:h.jsxs("span",{className:"text-sm text-stone-400",children:["Paso ",r+1," de ",t.length]})})]}),h.jsx(s$,{currentPhase:u==null?void 0:u.phase,className:"mb-4"}),h.jsxs("div",{className:"mb-4 rounded-lg bg-stone-800 p-4",children:[h.jsx("div",{className:"mb-2 flex items-center gap-2",children:h.jsx("span",{className:"text-sm font-medium text-mantis-400",children:u==null?void 0:u.title})}),h.jsx("p",{className:"mb-3 text-sm text-stone-300",children:u==null?void 0:u.description}),(u==null?void 0:u.instruction)&&h.jsxs("div",{className:"mb-3 rounded bg-stone-700 p-2",children:[h.jsx("span",{className:"text-xs text-stone-400",children:"Instrucción:"}),h.jsx("div",{className:"font-mono text-sm text-mantis-400",children:u.instruction})]}),(u==null?void 0:u.registers)&&h.jsx("div",{className:"mb-3 grid grid-cols-2 gap-4",children:h.jsxs("div",{children:[h.jsx("span",{className:"text-xs text-stone-400",children:"Registros:"}),h.jsx("div",{className:"mt-1 space-y-1",children:Object.entries(u.registers).map(([b,w])=>h.jsxs("div",{className:"flex justify-between text-xs",children:[h.jsxs("span",{className:"text-stone-300",children:[b,":"]}),h.jsx("span",{className:"font-mono text-mantis-400",children:w})]},b))})]})}),(u==null?void 0:u.memory)&&h.jsxs("div",{children:[h.jsx("span",{className:"text-xs text-stone-400",children:"Memoria:"}),h.jsx("div",{className:"mt-1 grid grid-cols-4 gap-1",children:Object.entries(u.memory).map(([b,w])=>h.jsxs("div",{className:"text-center text-xs",children:[h.jsx("div",{className:"text-stone-500",children:b}),h.jsx("div",{className:"font-mono text-mantis-400",children:w})]},b))})]})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("div",{className:"flex items-center gap-2",children:h.jsxs(At,{variant:"outline",size:"sm",onClick:y,disabled:d&&!o,className:"flex items-center gap-1",children:[h.jsx(Qe,{icon:Tj}),"Reiniciar"]})}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(At,{variant:"outline",size:"sm",onClick:g,disabled:d,className:"flex items-center gap-1",children:[h.jsx(Qe,{icon:Lj}),"Anterior"]}),h.jsxs(At,{variant:o?"secondary":"default",size:"sm",onClick:v,className:"flex items-center gap-1",children:[h.jsx(Qe,{icon:o?Jh:Bb}),o?"Pausar":"Reproducir"]}),h.jsxs(At,{variant:"outline",size:"sm",onClick:m,disabled:f,className:"flex items-center gap-1",children:["Siguiente",h.jsx(Qe,{icon:Y_})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-stone-400",children:"Velocidad:"}),h.jsxs("select",{value:l,onChange:b=>c(Number(b.target.value)),className:"rounded border border-stone-600 bg-stone-800 px-2 py-1 text-xs",children:[h.jsx("option",{value:1e3,children:"Rápida"}),h.jsx("option",{value:2e3,children:"Normal"}),h.jsx("option",{value:4e3,children:"Lenta"})]})]})]}),h.jsx("div",{className:"mt-4",children:h.jsx("div",{className:"h-2 w-full rounded-full bg-stone-700",children:h.jsx("div",{className:"h-2 rounded-full bg-mantis-500 transition-all duration-300",style:{width:`${(r+1)/t.length*100}%`}})})})]})});Xoe.displayName="StepByStepMode";const qoe=x.memo(({from:t,to:e,data:n,duration:i,className:r,onComplete:s})=>{const[o,a]=x.useState(!1),[l,c]=x.useState(0),[u]=Oo(),f=Math.min(u.executionUnit,250),p=i??(u.animations?f*2:1e3);return x.useEffect(()=>{a(!0),c(0);const m=Date.now(),g=()=>{const y=Date.now()-m,v=Math.min(y/p,1);c(v),v<1?requestAnimationFrame(g):setTimeout(()=>{a(!1),s==null||s()},500)};requestAnimationFrame(g)},[t,e,n,p,s]),o?h.jsxs("div",{className:re("pointer-events-none absolute inset-0",r),children:[h.jsxs("svg",{className:"absolute inset-0 size-full",children:[h.jsx("defs",{children:h.jsxs("linearGradient",{id:"dataFlowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[h.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:"0.8"}),h.jsx("stop",{offset:"50%",stopColor:"#10b981",stopOpacity:"1"}),h.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:"0.8"})]})}),h.jsx("path",{d:`M ${t} L ${e}`,stroke:"url(#dataFlowGradient)",strokeWidth:"3",strokeDasharray:"10,5",strokeDashoffset:20-l*20,fill:"none",className:"animate-pulse"})]}),["Read","Write"].includes(n)?(()=>{const[m,g]=t.split(" ").map(Number),[y,v]=e.split(" ").map(Number),b=m+(y-m)*l,w=g+(v-g)*l;return h.jsx("div",{className:`absolute z-[100] select-none text-lg font-extrabold ${n==="Read"?"text-red-500":"text-orange-400"}`,style:{left:b,top:w-32,textShadow:"0 0 4px #000, 0 0 2px #000",background:"rgba(0,0,0,0.2)",padding:"2px 8px",borderRadius:"6px",transition:"left 0.1s linear, top 0.1s linear",opacity:o?1:0,pointerEvents:"none"},children:n})})():h.jsxs("div",{className:re("absolute rounded bg-mantis-500 px-2 py-1 font-mono text-xs text-white","border border-mantis-400 shadow-lg","transition-all duration-300 ease-out"),style:{left:`${l*100}%`,transform:"translateX(-50%)",top:"50%",marginTop:"-12px"},children:[n,h.jsx("div",{className:"absolute -top-1 left-1/2 size-0 -translate-x-1/2 border-x-4 border-b-4 border-transparent border-b-mantis-500"})]})]}):null});qoe.displayName="DataFlowAnimation";const Koe={"cpu-components":{title:"Componentes de la CPU",description:"Visualiza los componentes principales de la CPU: ALU, Unidad de Control y registros",steps:[{id:"overview",title:"Vista General de la CPU",description:"Estructura general de la CPU VonSim8",duration:3e3,animation:{type:"highlight",targets:["CPU-container"],data:{title:"CPU",description:"Se basa en el procesador Intel 8086 de 16 bits, pero por simplicidad usamos registros de 8 bits."}}},{id:"alu",title:"ALU (Unidad Aritmético-Lógica)",description:"Ejecuta operaciones aritméticas y lógicas",duration:2500,animation:{type:"highlight",targets:["ALU"],data:{description:"Ejecuta operaciones aritméticas (como ADD + y SUB —) y lógicas.",icon:"⚙️"}}},{id:"control-unit",title:"Unidad de Control",description:"Coordina el funcionamiento de todos los componentes",duration:2500,animation:{type:"highlight",targets:["control-unit"],data:{description:"Coordina el funcionamiento de todos los componentes internos de la CPU.",components:["Decodificador","INSTRUCCIÓN"]}}},{id:"flags",title:"Registro de Flags",description:"Indicadores del estado de las operaciones",duration:2e3,animation:{type:"highlight",targets:["FLAGS"],data:{description:"Contiene indicadores del estado: C (Carry) y Z (Zero)",flags:["C","Z"]}}}]},"registers-overview":{title:"Registros de la CPU",description:"Visualiza los diferentes tipos de registros y sus funciones",steps:[{id:"general-purpose",title:"Registros de Propósito General",description:"AL, BL, CL, DL - registros para datos",duration:2500,animation:{type:"highlight",targets:["AL","BL","CL","DL"],data:{description:"Las instrucciones utilizan estos registros como operandos: AL, BL, CL, DL.",registers:["AL","BL","CL","DL"]}}},{id:"instruction-pointer",title:"Puntero de Instrucción (IP)",description:"Contiene la dirección de la próxima instrucción",duration:2e3,animation:{type:"highlight",targets:["IP"],data:{description:"Contiene la dirección de la próxima instrucción que se ejecutará.",color:"red"}}},{id:"instruction-register",title:"Registro de Instrucción (IR)",description:"Contiene la instrucción en curso",duration:2e3,animation:{type:"highlight",targets:["IR"],data:{description:"Contiene la instrucción en curso para su decodificación y ejecución.",color:"purple"}}},{id:"memory-registers",title:"Registros de Memoria",description:"MAR y MBR - para comunicación con memoria",duration:2500,animation:{type:"highlight",targets:["MAR","MBR"],data:{description:"MAR: dirección de memoria. MBR: datos transferidos.",registers:["MAR","MBR"]}}}]},"memory-structure":{title:"Estructura de Memoria",description:"Visualiza la organización de la memoria RAM y los buses",steps:[{id:"memory-grid",title:"Matriz de Memoria",description:"256 celdas organizadas en 16x16",duration:3e3,animation:{type:"highlight",targets:["memory-grid"],data:{description:"Compuesta por 256 celdas, cada una de 1 byte. Las direcciones y contenidos están representados en hexadecimal.",size:"16x16",cells:256}}},{id:"addressing",title:"Dirección de Memoria",description:"Formación de direcciones hexadecimales",duration:2500,animation:{type:"highlight",targets:["address-example"],data:{description:"La dirección 12h se obtiene de la intersección de la fila 1 y la columna 2.",example:"12h = fila 1, columna 2"}}},{id:"data-bus",title:"Bus de Datos",description:"Transferencia bidireccional de datos",duration:2e3,animation:{type:"flow",targets:["data-bus"],data:{description:"Transfiere entre CPU y memoria en ambos sentidos. Es bidireccional.",direction:"bidirectional"}}},{id:"address-bus",title:"Bus de Direcciones",description:"Envío de direcciones a memoria",duration:2e3,animation:{type:"flow",targets:["address-bus"],data:{description:"Envía desde la CPU a la memoria la dirección de la celda a leer o escribir. Es unidireccional.",direction:"unidirectional"}}},{id:"control-bus",title:"Buses de Control",description:"Señales de control para memoria",duration:2e3,animation:{type:"highlight",targets:["control-bus"],data:{description:"Transmiten las órdenes de lectura o escritura hacia la memoria.",signals:["rd","wr"]}}}]},"fetch-decode-execute":{title:"Ciclo Fetch-Decode-Execute",description:"Visualiza las tres fases del ciclo de instrucción",steps:[{id:"fetch",title:"Fase Fetch",description:"La CPU lee la instrucción desde memoria",duration:2e3,animation:{type:"flow",targets:["IP","MAR","MBR"],data:{from:"IP",to:"MBR",value:"A1"}}},{id:"decode",title:"Fase Decode",description:"La CPU interpreta la instrucción",duration:2e3,animation:{type:"highlight",targets:["IR"],data:{instruction:"MOV AL, 5"}}},{id:"execute",title:"Fase Execute",description:"La CPU ejecuta la operación",duration:2e3,animation:{type:"transform",targets:["AL"],data:{newValue:"05"}}}]},"memory-access":{title:"Acceso a Memoria",description:"Cómo la CPU lee y escribe en memoria RAM",steps:[{id:"address-setup",title:"Configurar Dirección",description:"La CPU coloca la dirección en el MAR",duration:1500,animation:{type:"highlight",targets:["MAR"],data:{address:"A0"}}},{id:"memory-read",title:"Lectura de Memoria",description:"El contenido se transfiere al MBR",duration:1500,animation:{type:"flow",targets:["memory-cell-A0","MBR"],data:{from:"memory",to:"MBR",value:"42"}}},{id:"data-transfer",title:"Transferencia de Datos",description:"Los datos se mueven al registro destino",duration:1500,animation:{type:"flow",targets:["MBR","AL"],data:{from:"MBR",to:"AL",value:"42"}}}]},"register-transfer":{title:"Transferencia entre Registros",description:"Movimiento de datos entre registros de la CPU",steps:[{id:"source-read",title:"Leer Registro Origen",description:"El valor se lee del registro origen",duration:1e3,animation:{type:"highlight",targets:["AL"],data:{value:"25"}}},{id:"bus-transfer",title:"Transferencia por Bus",description:"Los datos viajan por el bus interno",duration:1500,animation:{type:"flow",targets:["AL","BL"],data:{from:"AL",to:"BL",value:"25"}}},{id:"destination-write",title:"Escribir Registro Destino",description:"El valor se almacena en el registro destino",duration:1e3,animation:{type:"transform",targets:["BL"],data:{newValue:"25"}}}]},"alu-operation":{title:"Operación ALU",description:"Proceso de operación aritmética o lógica",steps:[{id:"operand-load",title:"Cargar Operandos",description:"Los operandos se cargan en la ALU",duration:1500,animation:{type:"highlight",targets:["AL","BL"],data:{operand1:"10",operand2:"05"}}},{id:"operation-execute",title:"Ejecutar Operación",description:"La ALU realiza la operación",duration:2e3,animation:{type:"sequence",targets:["ALU"],data:{operation:"ADD",result:"15"}}},{id:"result-store",title:"Almacenar Resultado",description:"El resultado se guarda en el registro destino",duration:1500,animation:{type:"transform",targets:["AL"],data:{newValue:"15"}}}]},"bus-communication":{title:"Comunicación por Bus",description:"Cómo los componentes se comunican a través del bus",steps:[{id:"bus-request",title:"Solicitud de Bus",description:"Un componente solicita acceso al bus",duration:1e3,animation:{type:"highlight",targets:["CPU"],data:{requesting:!0}}},{id:"bus-grant",title:"Concesión de Bus",description:"El bus se concede al componente solicitante",duration:1e3,animation:{type:"highlight",targets:["data-bus"],data:{granted:!0}}},{id:"data-transfer",title:"Transferencia de Datos",description:"Los datos se transfieren por el bus",duration:2e3,animation:{type:"flow",targets:["data-bus"],data:{data:"A1B2",direction:"CPU-to-Memory"}}},{id:"bus-release",title:"Liberación de Bus",description:"El bus se libera para otros componentes",duration:1e3,animation:{type:"highlight",targets:["data-bus"],data:{released:!0}}}]}},Yoe=x.memo(({concept:t,onClose:e,className:n})=>{const[i,r]=x.useState(0),[s,o]=x.useState(!1),[a,l]=x.useState(!1),[c,u]=x.useState(!1),d=Koe[t],f=d.steps[i],p=i===0,m=i===d.steps.length-1;x.useEffect(()=>{if(s){const C=setTimeout(()=>{m?o(!1):r(E=>E+1)},f.duration);return()=>clearTimeout(C)}},[s,i,m,f.duration]);const g=x.useCallback(()=>{m||r(C=>C+1)},[m]),y=x.useCallback(()=>{p||r(C=>C-1)},[p]),v=x.useCallback(()=>{r(0),o(!1)},[]),b=x.useCallback(()=>{o(!s)},[s]),w=x.useCallback(()=>{l(!a)},[a]),k=()=>{const{type:C,targets:E,data:_}=f.animation;switch(C){case"highlight":return h.jsxs("div",{className:"relative",children:[E.map((M,R)=>h.jsx("div",{className:"absolute inset-0 animate-pulse rounded border-2 border-mantis-400 bg-mantis-400/20",style:{animationDelay:`${R*200}ms`}},R)),_&&h.jsx("div",{className:"absolute right-2 top-2 rounded bg-mantis-500 px-2 py-1 text-xs text-white",children:Object.entries(_).map(([M,R])=>h.jsxs("div",{children:[M,": ",String(R)]},M))})]});case"flow":return h.jsxs("div",{className:"relative",children:[h.jsxs("svg",{className:"absolute inset-0 size-full",children:[h.jsx("defs",{children:h.jsxs("linearGradient",{id:"flowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[h.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:"0.8"}),h.jsx("stop",{offset:"50%",stopColor:"#10b981",stopOpacity:"1"}),h.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:"0.8"})]})}),h.jsx("path",{d:`M ${"from"in _&&_.from||"0,0"} L ${"to"in _&&_.to||"100,100"}`,stroke:"url(#flowGradient)",strokeWidth:"3",strokeDasharray:"10,5",className:"animate-pulse"})]}),"value"in _&&_.value&&h.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:h.jsx("div",{className:"rounded bg-mantis-500 px-2 py-1 font-mono text-xs text-white",children:_.value})})]});case"transform":return h.jsxs("div",{className:"relative",children:[E.map((M,R)=>h.jsx("div",{className:"absolute inset-0 animate-ping rounded bg-mantis-400/30",style:{animationDelay:`${R*300}ms`}},R)),"newValue"in _&&_.newValue&&h.jsxs("div",{className:"absolute left-2 top-2 rounded bg-mantis-500 px-2 py-1 font-mono text-xs text-white",children:["Nuevo: ",_.newValue]})]});case"sequence":return h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:h.jsx("div",{className:"rounded-lg bg-mantis-500 px-4 py-2 font-mono text-sm text-white",children:"operation"in _&&_.operation?_.operation:"Operación"})}),"result"in _&&_.result&&h.jsxs("div",{className:"absolute bottom-2 right-2 rounded bg-green-500 px-2 py-1 font-mono text-xs text-white",children:["= ",_.result]})]});default:return null}};return h.jsx("div",{className:re("fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",a&&"p-0",n),children:h.jsxs("div",{className:re("rounded-lg border border-stone-600 bg-stone-900 shadow-xl",a?"size-full":"max-h-[90vh] w-full max-w-4xl"),children:[h.jsxs("div",{className:"border-b border-stone-600 p-4",children:[h.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[h.jsx("h2",{className:"text-lg font-semibold text-mantis-400",children:d.title}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(At,{variant:"ghost",size:"sm",onClick:()=>u(!c),className:"text-stone-400 hover:text-mantis-400",children:h.jsx(Qe,{icon:Oj})}),h.jsx(At,{variant:"ghost",size:"sm",onClick:w,className:"text-stone-400 hover:text-mantis-400",children:h.jsx(Qe,{icon:a?XY:aJ})}),h.jsx(At,{variant:"ghost",size:"sm",onClick:e,className:"text-stone-400 hover:text-white",children:"×"})]})]}),h.jsxs("div",{className:"flex items-center gap-4 text-sm text-stone-400",children:[h.jsxs("span",{children:["Paso ",i+1," de ",d.steps.length]}),h.jsx("span",{children:"•"}),h.jsxs("span",{children:[f.duration/1e3,"s"]})]}),h.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-stone-700",children:h.jsx("div",{className:"h-2 rounded-full bg-mantis-500 transition-all duration-300",style:{width:`${(i+1)/d.steps.length*100}%`}})})]}),h.jsxs("div",{className:"flex-1 p-4",children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("h3",{className:"mb-2 text-base font-medium text-white",children:f.title}),h.jsx("p",{className:"text-sm text-stone-300",children:f.description})]}),h.jsxs("div",{className:"relative h-64 overflow-hidden rounded-lg border border-stone-600 bg-stone-800",children:[k(),c&&h.jsxs("div",{className:"absolute left-2 top-2 max-w-xs rounded border border-stone-600 bg-stone-900/90 p-3",children:[h.jsx("h4",{className:"mb-2 font-medium text-mantis-400",children:"Información"}),h.jsx("p",{className:"text-xs text-stone-300",children:d.description}),h.jsxs("div",{className:"mt-2 text-xs text-stone-400",children:[h.jsxs("div",{children:["Tipo de animación: ",f.animation.type]}),h.jsxs("div",{children:["Elementos: ",f.animation.targets.join(", ")]})]})]})]})]}),h.jsx("div",{className:"border-t border-stone-600 p-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(At,{variant:"outline",size:"sm",onClick:v,className:"flex items-center gap-1",children:[h.jsx(Qe,{icon:YY}),"Reiniciar"]}),h.jsx(At,{variant:"outline",size:"sm",onClick:y,disabled:p,className:"flex items-center gap-1",children:"Anterior"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(At,{variant:"outline",size:"sm",onClick:b,className:"flex items-center gap-1",children:[h.jsx(Qe,{icon:s?Jh:Bb}),s?"Pausar":"Reproducir"]}),h.jsx(At,{variant:"outline",size:"sm",onClick:g,disabled:m,className:"flex items-center gap-1",children:"Siguiente"})]})]})})]})})});Yoe.displayName="ConceptVisualizer";const Joe=[{id:"cpu-components",title:"Componentes de la CPU",description:"Aprende sobre los componentes principales de la CPU: ALU, Unidad de Control y registros",difficulty:"beginner",estimatedTime:12,steps:[{id:"intro",title:"Introducción a la CPU",description:"¿Qué es una CPU y para qué sirve?",content:"La CPU (Unidad Central de Procesamiento) es el cerebro de la computadora. Se encarga de ejecutar instrucciones y procesar datos. En VonSim8, se basa en el procesador Intel 8086 de 16 bits, pero por simplicidad usamos registros de 8 bits.",type:"explanation",completed:!1},{id:"alu",title:"ALU (Unidad Aritmético-Lógica)",description:"El componente que ejecuta operaciones matemáticas y lógicas",content:"La ALU ejecuta operaciones aritméticas (como ADD + y SUB —) y lógicas. Es el componente que realiza los cálculos dentro de la CPU. En el diagrama, puedes ver la ALU representada como un bloque azul con un ícono de engranaje.",type:"explanation",completed:!1},{id:"control-unit",title:"Unidad de Control (UC)",description:"Coordina el funcionamiento de todos los componentes",content:"La Unidad de Control coordina el funcionamiento de todos los componentes internos de la CPU. Contiene el decodificador que interpreta las instrucciones y genera las señales de control necesarias para ejecutar cada operación.",type:"explanation",completed:!1},{id:"flags",title:"Registro de Flags",description:"Indicadores del estado de las operaciones",content:"El registro FLAGS contiene indicadores del estado de las operaciones. Los flags más importantes son C (Carry) y Z (Zero). El flag Carry indica si hubo acarreo en una operación, y el flag Zero indica si el resultado fue cero.",type:"explanation",completed:!1},{id:"cpu-quiz",title:"Evaluación: Componentes de la CPU",description:"Pon a prueba tu conocimiento sobre los componentes de la CPU",type:"quiz",content:"",exercise:{question:"¿Cuál de estos componentes ejecuta las operaciones aritméticas y lógicas en la CPU?",options:["Unidad de Control","ALU","Registros","Memoria"],correctAnswer:1,explanation:"La ALU (Unidad Aritmético-Lógica) es específicamente la responsable de ejecutar operaciones matemáticas y lógicas dentro de la CPU."},completed:!1}]},{id:"registers",title:"Registros de la CPU",description:"Comprende los diferentes tipos de registros y sus funciones",difficulty:"beginner",estimatedTime:15,steps:[{id:"registers-intro",title:"¿Qué son los Registros?",description:"Memoria rápida dentro de la CPU",content:"Los registros son espacios de almacenamiento (memoria) dentro de la CPU. Son más rápidos que la RAM pero tienen menos capacidad. Se utilizan para almacenar datos temporalmente durante la ejecución de instrucciones.",type:"explanation",completed:!1},{id:"general-purpose",title:"Registros de Propósito General",description:"AL, BL, CL, DL - registros para datos",content:"Los registros de propósito general (AL, BL, CL, DL) son utilizados por las instrucciones como operandos. Pueden almacenar datos, direcciones o resultados de operaciones. En VonSim8, cada uno puede almacenar 8 bits (1 byte).",type:"explanation",completed:!1},{id:"instruction-pointer",title:"Puntero de Instrucción (IP)",description:"Contiene la dirección de la próxima instrucción",content:"El Puntero de Instrucción (IP) contiene la dirección de la próxima instrucción que se ejecutará. Se incrementa automáticamente después de cada instrucción para apuntar a la siguiente en memoria.",type:"explanation",completed:!1},{id:"instruction-register",title:"Registro de Instrucción (IR)",description:"Contiene la instrucción en curso",content:"El Registro de Instrucción (IR) contiene la instrucción en curso para su decodificación y ejecución. Es donde la CPU almacena temporalmente la instrucción que está procesando.",type:"explanation",completed:!1},{id:"memory-registers",title:"Registros de Memoria",description:"MAR y MBR - para comunicación con memoria",content:"MAR (Memory Address Register) contiene la dirección de memoria donde se desea leer o escribir. MBR (Memory Buffer Register) contiene datos que se transfieren hacia o desde la memoria. Estos registros facilitan la comunicación entre la CPU y la memoria RAM.",type:"explanation",completed:!1},{id:"registers-quiz",title:"Evaluación: Registros",description:"Pon a prueba tu conocimiento sobre los registros",type:"quiz",content:"Responde correctamente para continuar con el tutorial.",exercise:{question:"¿Cuál de estos registros contiene la dirección de la próxima instrucción a ejecutar?",options:["IR","IP","MAR","MBR"],correctAnswer:1,explanation:"El Puntero de Instrucción (IP) es el registro que contiene la dirección de la próxima instrucción que se ejecutará."},completed:!1}]},{id:"memory",title:"Memoria RAM",description:"Comprende cómo funciona la memoria principal y su acceso",difficulty:"beginner",estimatedTime:10,steps:[{id:"memory-intro",title:"¿Qué es la Memoria RAM?",description:"La memoria de acceso aleatorio",content:"La memoria RAM (Random Access Memory) está compuesta por 256 celdas, cada una de 1 byte. Las direcciones y contenidos están representados en hexadecimal. Es donde se almacenan programas y datos temporalmente durante la ejecución.",type:"explanation",completed:!1},{id:"memory-addressing",title:"Dirección de Memoria",description:"Cómo se forman las direcciones",content:"La dirección de memoria se expresa en hexadecimal y se forma combinando el número de fila y columna. Por ejemplo: la dirección 12h se obtiene de la intersección de la fila 1 y la columna 2 en la matriz de memoria.",type:"explanation",completed:!1},{id:"data-bus",title:"Bus de Datos",description:"Transferencia bidireccional de datos",content:"El bus de datos transfiere información entre la CPU y memoria en ambos sentidos. Es bidireccional, permitiendo tanto la lectura como la escritura de datos en memoria.",type:"explanation",completed:!1},{id:"address-bus",title:"Bus de Direcciones",description:"Envío de direcciones a memoria",content:"El bus de direcciones envía desde la CPU a la memoria la dirección de la celda a leer o escribir. Es unidireccional, ya que solo la CPU puede especificar direcciones de memoria.",type:"explanation",completed:!1},{id:"control-bus",title:"Buses de Control",description:"Señales de control para memoria",content:"Los buses de control transmiten las órdenes de lectura o escritura hacia la memoria. Estas señales indican a la memoria qué operación realizar (leer o escribir) en la dirección especificada.",type:"explanation",completed:!1},{id:"memory-quiz",title:"Evaluación: Memoria",description:"Pon a prueba tu conocimiento sobre memoria",type:"quiz",content:"Responde correctamente para continuar con el tutorial.",exercise:{question:"¿Cuántas celdas de memoria tiene VonSim8 y cuánto almacena cada una?",options:["128 celdas de 2 bytes","256 celdas de 1 byte","512 celdas de 1 byte","256 celdas de 2 bytes"],correctAnswer:1,explanation:"VonSim8 tiene 256 celdas de memoria, cada una capaz de almacenar 1 byte (8 bits) de información."},completed:!1}]},{id:"cpu-basics",title:"Fundamentos de la CPU",description:"Aprende cómo funciona una CPU y sus componentes principales",difficulty:"beginner",estimatedTime:10,steps:[{id:"intro",title:"Introducción a la CPU",description:"¿Qué es una CPU y para qué sirve?",content:"La CPU (Unidad Central de Procesamiento) es el cerebro de la computadora. Se encarga de ejecutar instrucciones y procesar datos.",type:"explanation",completed:!1},{id:"registers",title:"Registros de la CPU",description:"Los registros son memoria rápida dentro de la CPU",content:"Los registros almacenan datos temporalmente durante la ejecución. Son más rápidos que la RAM pero tienen menos capacidad.",type:"explanation",completed:!1},{id:"program-counter",title:"Puntero de Instrucción",description:"El IP indica la siguiente instrucción a ejecutar",content:"El Puntero de Instrucción (IP) se incrementa automáticamente después de cada instrucción.",type:"explanation",completed:!1}]}],o$=x.memo(({tutorial:t,onComplete:e,onClose:n,className:i})=>{var I,G;const[r,s]=x.useState(0),[o,a]=x.useState(t.steps),[l,c]=x.useState(!1),[u,d]=x.useState(!1),[f,p]=x.useState(""),[m,g]=x.useState(null),y=o[r],v=r===0,b=r===o.length-1,k=o.filter(B=>B.completed).length/o.length*100,C=x.useCallback(()=>{e==null||e(t.id)},[t.id,e]),E=x.useCallback(()=>{b?C():(s(B=>B+1),g(null),p(""))},[b,C]),_=x.useCallback(()=>{v||(s(B=>B-1),g(null),p(""))},[v]),M=x.useCallback(()=>{a(B=>B.map((q,Y)=>Y===r?{...q,completed:!0}:q))},[r]),R=x.useCallback(()=>{if(!y.exercise)return;const B=f===y.exercise.correctAnswer.toString();g({correct:B,message:B?"¡Correcto!":`Incorrecto. ${y.exercise.explanation}`}),B&&(M(),setTimeout(()=>{E()},2e3))},[y,f,M,E]);x.useEffect(()=>{if(l&&y.type==="explanation"){const B=setTimeout(()=>{b?c(!1):E()},5e3);return()=>clearTimeout(B)}},[l,r,b,y.type,E]);const T=B=>{switch(B){case"beginner":return"text-blue-400";case"intermediate":return"text-yellow-400";case"advanced":return"text-purple-400";default:return"text-stone-400"}},L=B=>{switch(B){case"beginner":return wd;case"intermediate":return Rm;case"advanced":return J_;default:return wd}};return h.jsx("div",{className:re("fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",i),children:h.jsxs("div",{className:"max-h-[90vh] w-full max-w-2xl overflow-hidden rounded-lg border border-stone-600 bg-stone-900 shadow-xl",children:[h.jsxs("div",{className:"border-b border-stone-600 p-4",children:[h.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[h.jsx("h2",{className:"text-lg font-semibold text-mantis-400",children:t.title}),h.jsx(At,{variant:"ghost",size:"sm",onClick:n,className:"text-stone-400 hover:text-white",children:"×"})]}),h.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Qe,{icon:L(t.difficulty),className:T(t.difficulty)}),h.jsx("span",{className:T(t.difficulty),children:t.difficulty==="beginner"?"Básico":t.difficulty==="intermediate"?"Intermedio":"Avanzado"})]}),h.jsx("span",{className:"text-stone-400",children:"•"}),h.jsxs("span",{className:"text-stone-400",children:[t.estimatedTime," min"]}),h.jsx("span",{className:"text-stone-400",children:"•"}),h.jsxs("span",{className:"text-stone-400",children:["Paso ",r+1," de ",o.length]})]}),h.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-stone-700",children:h.jsx("div",{className:"h-2 rounded-full bg-mantis-500 transition-all duration-300",style:{width:`${k}%`}})})]}),h.jsxs("div",{className:"max-h-96 overflow-y-auto p-4",children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("h3",{className:"mb-2 text-base font-medium text-white",children:y.title}),h.jsx("p",{className:"mb-3 text-sm text-stone-300",children:y.description}),h.jsx("div",{className:"text-sm leading-relaxed text-stone-400",children:y.content})]}),y.type==="exercise"||y.type==="quiz"?h.jsxs("div",{className:"rounded-lg border border-stone-600 bg-stone-800 p-4",children:[h.jsx("h4",{className:"mb-3 font-medium text-white",children:(I=y.exercise)==null?void 0:I.question}),(G=y.exercise)!=null&&G.options?h.jsx("div",{className:"space-y-2",children:y.exercise.options.map((B,q)=>h.jsxs("label",{className:re("flex cursor-pointer items-center gap-3 rounded border p-3 transition-colors",f===q.toString()?"border-mantis-400 bg-mantis-400/20":"border-stone-600 bg-stone-700 hover:bg-stone-600"),children:[h.jsx("input",{type:"radio",name:"answer",value:q.toString(),checked:f===q.toString(),onChange:Y=>p(Y.target.value),className:"text-mantis-400"}),h.jsx("span",{className:"text-stone-300",children:B})]},q))}):h.jsx("input",{type:"text",value:f,onChange:B=>p(B.target.value),placeholder:"Escribe tu respuesta...",className:"w-full rounded border border-stone-600 bg-stone-700 p-2 text-white"}),m&&h.jsx("div",{className:re("mt-3 rounded border p-3",m.correct?"border-green-400 bg-green-400/20 text-green-400":"border-red-400 bg-red-400/20 text-red-400"),children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Qe,{icon:m.correct?pJ:$b}),m.message]})}),y.hints&&y.hints.length>0&&h.jsxs("div",{className:"mt-3",children:[h.jsxs(At,{variant:"ghost",size:"sm",onClick:()=>d(!u),className:"text-mantis-400 hover:text-mantis-300",children:[h.jsx(Qe,{icon:wd,className:"mr-2"}),u?"Ocultar":"Mostrar"," Pistas"]}),u&&h.jsx("div",{className:"mt-2 rounded border border-stone-600 bg-stone-700 p-3",children:h.jsx("ul",{className:"space-y-1 text-sm text-stone-300",children:y.hints.map((B,q)=>h.jsxs("li",{children:["• ",B]},q))})})]})]}):null]}),h.jsx("div",{className:"border-t border-stone-600 p-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("div",{className:"flex items-center gap-2",children:h.jsxs(At,{variant:"outline",size:"sm",onClick:_,disabled:v,className:"flex items-center gap-1",children:[h.jsx(Qe,{icon:Lj}),"Anterior"]})}),h.jsx("div",{className:"flex items-center gap-2",children:y.type==="exercise"||y.type==="quiz"?h.jsx(At,{size:"sm",onClick:R,disabled:!f,className:"bg-mantis-600 hover:bg-mantis-700",children:"Verificar Respuesta"}):h.jsxs(At,{size:"sm",onClick:E,className:"flex items-center gap-1 bg-mantis-600 hover:bg-mantis-700",children:[b?"Completar Tutorial":"Siguiente",!b&&h.jsx(Qe,{icon:Y_})]})})]})})]})})});o$.displayName="InteractiveTutorial";const a$=x.memo(({isOpen:t=!1,onShowProgress:e})=>{const[n,i]=x.useState(!1),[r,s]=x.useState(!1),[o,a]=x.useState(null),l=f=>{console.log("Tutorial seleccionado:",f),a(f),s(!0)},c=()=>{s(!1),a(null)},u=[{id:"progress",title:"Progreso Educativo",description:"Ver logros y estadísticas de aprendizaje",icon:Z_,color:"text-yellow-400",action:()=>e==null?void 0:e()},{id:"tutorials",title:"Tutoriales Interactivos",description:"Aprende paso a paso con ejercicios",icon:hJ,color:"text-blue-400",action:()=>i(!n)}],d=[{id:"cpu-components",title:"Componentes de la CPU",description:"ALU, Unidad de Control y registros",difficulty:"Básico",duration:"12 min"},{id:"registers",title:"Registros de la CPU",description:"Tipos y funciones de registros",difficulty:"Básico",duration:"15 min"},{id:"memory",title:"Memoria RAM",description:"Funcionamiento de la memoria principal",difficulty:"Básico",duration:"10 min"}];return h.jsxs(h.Fragment,{children:[t&&h.jsx("div",{className:"fixed bottom-12 left-1/2 z-50 -translate-x-1/2",children:h.jsxs("div",{className:"min-w-80 rounded-lg border border-stone-600 bg-stone-900 p-4 shadow-xl",children:[h.jsxs("div",{className:"mb-4 text-center",children:[h.jsx("h3",{className:"mb-1 text-lg font-semibold text-mantis-400",children:"Centro de Aprendizaje"}),h.jsx("p",{className:"text-sm text-stone-400",children:"Explora herramientas educativas interactivas"})]}),h.jsx("div",{className:"space-y-2",children:u.map(f=>h.jsx("div",{children:f.id==="tutorials"?h.jsxs("div",{children:[h.jsxs("button",{onClick:f.action,className:re("w-full rounded-lg border border-stone-600 p-3 text-left hover:bg-stone-800","flex items-center gap-3 transition-all duration-200"),children:[h.jsx(Qe,{icon:f.icon,className:re("text-lg",f.color)}),h.jsxs("div",{className:"flex-1",children:[h.jsx("div",{className:"font-medium text-white",children:f.title}),h.jsx("div",{className:"text-sm text-stone-400",children:f.description})]}),h.jsx(Qe,{icon:Bb,className:re("text-sm text-stone-400",n&&"text-blue-400")})]}),n&&h.jsx("div",{className:"ml-8 mt-2 space-y-1",children:d.map(p=>h.jsx("button",{onClick:()=>l(p.id),className:"w-full rounded border border-stone-700 p-2 text-left transition-colors hover:bg-stone-800",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-medium text-white",children:p.title}),h.jsx("div",{className:"text-xs text-stone-400",children:p.description})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("div",{className:"text-xs text-blue-400",children:p.difficulty}),h.jsx("div",{className:"text-xs text-stone-500",children:p.duration})]})]})},p.id))})]}):h.jsxs("button",{onClick:f.action,className:re("w-full rounded-lg border border-stone-600 p-3 text-left hover:bg-stone-800","flex items-center gap-3 transition-all duration-200"),children:[h.jsx(Qe,{icon:f.icon,className:re("text-lg",f.color)}),h.jsxs("div",{className:"flex-1",children:[h.jsx("div",{className:"font-medium text-white",children:f.title}),h.jsx("div",{className:"text-sm text-stone-400",children:f.description})]})]})},f.id))}),h.jsx("div",{className:"mt-4 border-t border-stone-600 pt-3",children:h.jsxs("div",{className:"flex items-center justify-between text-xs text-stone-400",children:[h.jsx("span",{children:"Herramientas educativas"}),h.jsx("span",{children:"VonSim8"})]})})]})}),r&&o&&(()=>{const f=Joe.find(p=>p.id===o);return console.log("Tutorial encontrado:",f),f?h.jsx(o$,{tutorial:f,onComplete:c,onClose:()=>{console.log("Cerrando tutorial"),s(!1),a(null)}}):(console.error("Tutorial no encontrado:",o),null)})()]})});a$.displayName="EducationalMenu";const DT=[{id:"first_program",type:"programs_written",title:"Primer Programa",description:"Escribe tu primer programa en ensamblador",icon:wd,requirement:1,current:0,unlocked:!1,points:10},{id:"instruction_master",type:"instructions_executed",title:"Maestro de Instrucciones",description:"Ejecuta 100 instrucciones",icon:gR,requirement:100,current:0,unlocked:!1,points:25},{id:"cpu_components_master",type:"concept_mastered",title:"Conocedor de Componentes",description:"Comprende los componentes principales de la CPU",icon:vR,requirement:1,current:0,unlocked:!1,points:20},{id:"registers_expert",type:"concept_mastered",title:"Experto en Registros",description:"Domina los diferentes tipos de registros",icon:gR,requirement:1,current:0,unlocked:!1,points:25},{id:"memory_explorer",type:"concept_mastered",title:"Explorador de Memoria",description:"Comprende el funcionamiento de la memoria RAM",icon:vJ,requirement:1,current:0,unlocked:!1,points:15},{id:"cpu_architect",type:"concept_mastered",title:"Arquitecto de CPU",description:"Domina los conceptos de arquitectura de CPU",icon:vR,requirement:1,current:0,unlocked:!1,points:30},{id:"persistent_learner",type:"time_spent",title:"Estudiante Persistente",description:"Pasa 30 minutos aprendiendo",icon:Rm,requirement:30,current:0,unlocked:!1,points:20},{id:"tutorial_master",type:"tutorials_completed",title:"Maestro de Tutoriales",description:"Completa un tutorial interactivo educativo",icon:Z_,requirement:1,current:0,unlocked:!1,points:40}],jT=[{id:"beginner",name:"Principiante",description:"Conceptos básicos: CPU, registros y memoria",concepts:["cpu-components","registers","memory"],requiredPoints:0,unlocked:!0,completed:!1},{id:"intermediate",name:"Intermedio",description:"Operaciones aritméticas y ciclo de instrucción",concepts:["alu","bus"],requiredPoints:50,unlocked:!1,completed:!1},{id:"advanced",name:"Avanzado",description:"Interrupciones y programación compleja",concepts:["flags","stack","interrupts"],requiredPoints:100,unlocked:!1,completed:!1}],l$=x.memo(({className:t,isVisible:e=!1,onClose:n})=>{const[i,r]=x.useState(DT),[s,o]=x.useState(jT),[a,l]=x.useState(0),[c,u]=x.useState(0);x.useEffect(()=>{const y=localStorage.getItem("vonsim8-educational-progress");if(y)try{const v=JSON.parse(y);r(v.achievements||DT),o(v.levels||jT),l(v.totalPoints||0),u(v.sessionTime||0)}catch{}},[]);const d=x.useCallback(()=>{const y={achievements:i,levels:s,totalPoints:a,sessionTime:c,lastSaved:Date.now()};localStorage.setItem("vonsim8-educational-progress",JSON.stringify(y))},[i,s,a,c]),f=x.useCallback((y,v)=>{r(b=>{const w=b.map(C=>{if(C.type===y){const E=Math.min(C.current+v,C.requirement),_=C.unlocked,M=E>=C.requirement;return!_&&M&&p(C),{...C,current:E,unlocked:M}}return C}),k=w.filter(C=>C.unlocked).reduce((C,E)=>C+E.points,0);return l(k),o(C=>C.map(E=>({...E,unlocked:k>=E.requiredPoints}))),w})},[]),p=y=>{const v=document.createElement("div");v.className=re("fixed right-4 top-4 z-50 rounded-lg border-2 p-4 shadow-lg","animate-slide-in-right bg-mantis-500 text-white"),v.innerHTML=`
      <div class="flex items-center gap-3">
        <FontAwesomeIcon icon="${y.icon}" class="text-2xl" />
        <div>
          <div class="font-bold">¡Logro Desbloqueado!</div>
          <div class="text-sm">${y.title}</div>
        </div>
      </div>
    `,document.body.appendChild(v),setTimeout(()=>{v.remove()},3e3)};if(x.useEffect(()=>{const y=v=>{const{type:b,value:w=1}=v.detail;f(b,w)};return window.addEventListener("educational-progress",y),()=>window.removeEventListener("educational-progress",y)},[f]),x.useEffect(()=>{const y=setInterval(()=>{u(v=>{const b=v+1;return b%60===0&&f("time_spent",1),b})},1e3);return()=>clearInterval(y)},[f]),x.useEffect(()=>{const y=setInterval(d,3e4);return()=>clearInterval(y)},[d]),!e)return null;const m=i.filter(y=>y.unlocked),g=s.filter(y=>y.unlocked);return h.jsxs("div",{className:re("fixed bottom-20 right-4 z-50 h-80 w-96 rounded-lg border border-stone-600 bg-stone-900 shadow-xl",t),children:[h.jsxs("div",{className:"flex items-center justify-between border-b border-stone-600 p-3",children:[h.jsxs("h3",{className:"flex items-center gap-2 text-sm font-semibold text-mantis-400",children:[h.jsx(Qe,{icon:Z_}),"Progreso Educativo"]}),h.jsx(At,{variant:"ghost",size:"sm",onClick:n,className:"text-xs text-stone-400 hover:text-white",children:"×"})]}),h.jsxs("div",{className:"h-64 space-y-3 overflow-y-auto p-3",children:[h.jsxs("div",{className:"rounded-lg bg-stone-800 p-3 text-center",children:[h.jsx("div",{className:"text-2xl font-bold text-mantis-400",children:a}),h.jsx("div",{className:"text-xs text-stone-400",children:"Puntos Totales"})]}),h.jsxs("div",{children:[h.jsxs("h4",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-stone-300",children:[h.jsx(Qe,{icon:Rm}),"Niveles de Aprendizaje"]}),h.jsx("div",{className:"space-y-1",children:s.map(y=>h.jsxs("div",{className:re("rounded border p-2 text-xs",y.unlocked?"border-mantis-400 bg-mantis-400/10 text-mantis-400":"border-stone-600 bg-stone-800 text-stone-500"),children:[h.jsx("div",{className:"font-medium",children:y.name}),h.jsx("div",{className:"text-stone-400",children:y.description}),!y.unlocked&&h.jsxs("div",{className:"mt-1 text-stone-500",children:["Requiere ",y.requiredPoints," puntos"]})]},y.id))})]}),h.jsxs("div",{children:[h.jsxs("h4",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-stone-300",children:[h.jsx(Qe,{icon:KY}),"Logros (",m.length,"/",i.length,")"]}),h.jsx("div",{className:"space-y-1",children:i.map(y=>h.jsx("div",{className:re("rounded border p-2 text-xs",y.unlocked?"border-mantis-400 bg-mantis-400/10":"border-stone-600 bg-stone-800"),children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Qe,{icon:y.icon,className:y.unlocked?"text-mantis-400":"text-stone-500"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("div",{className:re("font-medium",y.unlocked?"text-mantis-400":"text-stone-400"),children:y.title}),h.jsx("div",{className:"text-stone-500",children:y.description}),h.jsxs("div",{className:"mt-1",children:[h.jsx("div",{className:"h-1 w-full rounded-full bg-stone-700",children:h.jsx("div",{className:"h-1 rounded-full bg-mantis-400 transition-all duration-300",style:{width:`${y.current/y.requirement*100}%`}})}),h.jsxs("div",{className:"mt-1 text-stone-500",children:[y.current,"/",y.requirement]})]})]})]})},y.id))})]}),h.jsxs("div",{children:[h.jsxs("h4",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-stone-300",children:[h.jsx(Qe,{icon:eJ}),"Estadísticas"]}),h.jsxs("div",{className:"text-xs text-stone-400",children:[h.jsxs("div",{children:["Tiempo de sesión: ",Math.floor(c/60),"m ",c%60,"s"]}),h.jsxs("div",{children:["Niveles completados: ",g.length,"/",s.length]})]})]})]})]})});l$.displayName="EducationalProgress";function Dy(t,[e,n]){return Math.min(n,Math.max(e,t))}function Zoe(t,e=globalThis==null?void 0:globalThis.document){const n=Or(t);x.useEffect(()=>{const i=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",i,{capture:!0}),()=>e.removeEventListener("keydown",i,{capture:!0})},[n,e])}var Qoe="DismissableLayer",Wk="dismissableLayer.update",eae="dismissableLayer.pointerDownOutside",tae="dismissableLayer.focusOutside",BT,c$=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),zm=x.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:r,onFocusOutside:s,onInteractOutside:o,onDismiss:a,...l}=t,c=x.useContext(c$),[u,d]=x.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=x.useState({}),m=St(e,_=>d(_)),g=Array.from(c.layers),[y]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=g.indexOf(y),b=u?g.indexOf(u):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,k=b>=v,C=iae(_=>{const M=_.target,R=[...c.branches].some(T=>T.contains(M));!k||R||(r==null||r(_),o==null||o(_),_.defaultPrevented||a==null||a())},f),E=rae(_=>{const M=_.target;[...c.branches].some(T=>T.contains(M))||(s==null||s(_),o==null||o(_),_.defaultPrevented||a==null||a())},f);return Zoe(_=>{b===c.layers.size-1&&(i==null||i(_),!_.defaultPrevented&&a&&(_.preventDefault(),a()))},f),x.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(BT=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),$T(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=BT)}},[u,f,n,c]),x.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),$T())},[u,c]),x.useEffect(()=>{const _=()=>p({});return document.addEventListener(Wk,_),()=>document.removeEventListener(Wk,_)},[]),h.jsx(it.div,{...l,ref:m,style:{pointerEvents:w?k?"auto":"none":void 0,...t.style},onFocusCapture:ke(t.onFocusCapture,E.onFocusCapture),onBlurCapture:ke(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:ke(t.onPointerDownCapture,C.onPointerDownCapture)})});zm.displayName=Qoe;var nae="DismissableLayerBranch",u$=x.forwardRef((t,e)=>{const n=x.useContext(c$),i=x.useRef(null),r=St(e,i);return x.useEffect(()=>{const s=i.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),h.jsx(it.div,{...t,ref:r})});u$.displayName=nae;function iae(t,e=globalThis==null?void 0:globalThis.document){const n=Or(t),i=x.useRef(!1),r=x.useRef(()=>{});return x.useEffect(()=>{const s=a=>{if(a.target&&!i.current){let l=function(){d$(eae,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);i.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>i.current=!0}}function rae(t,e=globalThis==null?void 0:globalThis.document){const n=Or(t),i=x.useRef(!1);return x.useEffect(()=>{const r=s=>{s.target&&!i.current&&d$(tae,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function $T(){const t=new CustomEvent(Wk);document.dispatchEvent(t)}function d$(t,e,n,{discrete:i}){const r=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),i?O_(r,s):r.dispatchEvent(s)}var sae=zm,oae=u$,gw=0;function cA(){x.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??FT()),document.body.insertAdjacentElement("beforeend",t[1]??FT()),gw++,()=>{gw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),gw--}},[])}function FT(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var vw="focusScope.autoFocusOnMount",yw="focusScope.autoFocusOnUnmount",zT={bubbles:!1,cancelable:!0},aae="FocusScope",c1=x.forwardRef((t,e)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:r,onUnmountAutoFocus:s,...o}=t,[a,l]=x.useState(null),c=Or(r),u=Or(s),d=x.useRef(null),f=St(e,g=>l(g)),p=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(i){let g=function(w){if(p.paused||!a)return;const k=w.target;a.contains(k)?d.current=k:ja(d.current,{select:!0})},y=function(w){if(p.paused||!a)return;const k=w.relatedTarget;k!==null&&(a.contains(k)||ja(d.current,{select:!0}))},v=function(w){if(document.activeElement===document.body)for(const C of w)C.removedNodes.length>0&&ja(a)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const b=new MutationObserver(v);return a&&b.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),b.disconnect()}}},[i,a,p.paused]),x.useEffect(()=>{if(a){VT.add(p);const g=document.activeElement;if(!a.contains(g)){const v=new CustomEvent(vw,zT);a.addEventListener(vw,c),a.dispatchEvent(v),v.defaultPrevented||(lae(hae(f$(a)),{select:!0}),document.activeElement===g&&ja(a))}return()=>{a.removeEventListener(vw,c),setTimeout(()=>{const v=new CustomEvent(yw,zT);a.addEventListener(yw,u),a.dispatchEvent(v),v.defaultPrevented||ja(g??document.body,{select:!0}),a.removeEventListener(yw,u),VT.remove(p)},0)}}},[a,c,u,p]);const m=x.useCallback(g=>{if(!n&&!i||p.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,v=document.activeElement;if(y&&v){const b=g.currentTarget,[w,k]=cae(b);w&&k?!g.shiftKey&&v===k?(g.preventDefault(),n&&ja(w,{select:!0})):g.shiftKey&&v===w&&(g.preventDefault(),n&&ja(k,{select:!0})):v===b&&g.preventDefault()}},[n,i,p.paused]);return h.jsx(it.div,{tabIndex:-1,...o,ref:f,onKeyDown:m})});c1.displayName=aae;function lae(t,{select:e=!1}={}){const n=document.activeElement;for(const i of t)if(ja(i,{select:e}),document.activeElement!==n)return}function cae(t){const e=f$(t),n=UT(e,t),i=UT(e.reverse(),t);return[n,i]}function f$(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function UT(t,e){for(const n of t)if(!uae(n,{upTo:e}))return n}function uae(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function dae(t){return t instanceof HTMLInputElement&&"select"in t}function ja(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&dae(t)&&e&&t.select()}}var VT=fae();function fae(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=HT(t,e),t.unshift(e)},remove(e){var n;t=HT(t,e),(n=t[0])==null||n.resume()}}}function HT(t,e){const n=[...t],i=n.indexOf(e);return i!==-1&&n.splice(i,1),n}function hae(t){return t.filter(e=>e.tagName!=="A")}const pae=["top","right","bottom","left"],Vl=Math.min,kr=Math.max,jy=Math.round,o0=Math.floor,Eo=t=>({x:t,y:t}),mae={left:"right",right:"left",bottom:"top",top:"bottom"},gae={start:"end",end:"start"};function Gk(t,e,n){return kr(t,Vl(e,n))}function ya(t,e){return typeof t=="function"?t(e):t}function ba(t){return t.split("-")[0]}function Mf(t){return t.split("-")[1]}function uA(t){return t==="x"?"y":"x"}function dA(t){return t==="y"?"height":"width"}const vae=new Set(["top","bottom"]);function vo(t){return vae.has(ba(t))?"y":"x"}function fA(t){return uA(vo(t))}function yae(t,e,n){n===void 0&&(n=!1);const i=Mf(t),r=fA(t),s=dA(r);let o=r==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=By(o)),[o,By(o)]}function bae(t){const e=By(t);return[Xk(t),e,Xk(e)]}function Xk(t){return t.replace(/start|end/g,e=>gae[e])}const WT=["left","right"],GT=["right","left"],xae=["top","bottom"],wae=["bottom","top"];function Sae(t,e,n){switch(t){case"top":case"bottom":return n?e?GT:WT:e?WT:GT;case"left":case"right":return e?xae:wae;default:return[]}}function kae(t,e,n,i){const r=Mf(t);let s=Sae(ba(t),n==="start",i);return r&&(s=s.map(o=>o+"-"+r),e&&(s=s.concat(s.map(Xk)))),s}function By(t){return t.replace(/left|right|bottom|top/g,e=>mae[e])}function Cae(t){return{top:0,right:0,bottom:0,left:0,...t}}function h$(t){return typeof t!="number"?Cae(t):{top:t,right:t,bottom:t,left:t}}function $y(t){const{x:e,y:n,width:i,height:r}=t;return{width:i,height:r,top:n,left:e,right:e+i,bottom:n+r,x:e,y:n}}function XT(t,e,n){let{reference:i,floating:r}=t;const s=vo(e),o=fA(e),a=dA(o),l=ba(e),c=s==="y",u=i.x+i.width/2-r.width/2,d=i.y+i.height/2-r.height/2,f=i[a]/2-r[a]/2;let p;switch(l){case"top":p={x:u,y:i.y-r.height};break;case"bottom":p={x:u,y:i.y+i.height};break;case"right":p={x:i.x+i.width,y:d};break;case"left":p={x:i.x-r.width,y:d};break;default:p={x:i.x,y:i.y}}switch(Mf(e)){case"start":p[o]-=f*(n&&c?-1:1);break;case"end":p[o]+=f*(n&&c?-1:1);break}return p}const _ae=async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:d}=XT(c,i,l),f=i,p={},m=0;for(let g=0;g<a.length;g++){const{name:y,fn:v}=a[g],{x:b,y:w,data:k,reset:C}=await v({x:u,y:d,initialPlacement:i,placement:f,strategy:r,middlewareData:p,rects:c,platform:o,elements:{reference:t,floating:e}});u=b??u,d=w??d,p={...p,[y]:{...p[y],...k}},C&&m<=50&&(m++,typeof C=="object"&&(C.placement&&(f=C.placement),C.rects&&(c=C.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):C.rects),{x:u,y:d}=XT(c,f,l)),g=-1)}return{x:u,y:d,placement:f,strategy:r,middlewareData:p}};async function dm(t,e){var n;e===void 0&&(e={});const{x:i,y:r,platform:s,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=ya(e,t),m=h$(p),y=a[f?d==="floating"?"reference":"floating":d],v=$y(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(y)))==null||n?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),b=d==="floating"?{x:i,y:r,width:o.floating.width,height:o.floating.height}:o.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),k=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},C=$y(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:w,strategy:l}):b);return{top:(v.top-C.top+m.top)/k.y,bottom:(C.bottom-v.bottom+m.bottom)/k.y,left:(v.left-C.left+m.left)/k.x,right:(C.right-v.right+m.right)/k.x}}const Eae=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:r,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=ya(t,e)||{};if(c==null)return{};const d=h$(u),f={x:n,y:i},p=fA(r),m=dA(p),g=await o.getDimensions(c),y=p==="y",v=y?"top":"left",b=y?"bottom":"right",w=y?"clientHeight":"clientWidth",k=s.reference[m]+s.reference[p]-f[p]-s.floating[m],C=f[p]-s.reference[p],E=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let _=E?E[w]:0;(!_||!await(o.isElement==null?void 0:o.isElement(E)))&&(_=a.floating[w]||s.floating[m]);const M=k/2-C/2,R=_/2-g[m]/2-1,T=Vl(d[v],R),L=Vl(d[b],R),I=T,G=_-g[m]-L,B=_/2-g[m]/2+M,q=Gk(I,B,G),Y=!l.arrow&&Mf(r)!=null&&B!==q&&s.reference[m]/2-(B<I?T:L)-g[m]/2<0,ne=Y?B<I?B-I:B-G:0;return{[p]:f[p]+ne,data:{[p]:q,centerOffset:B-q-ne,...Y&&{alignmentOffset:ne}},reset:Y}}}),Aae=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:r,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:g=!0,...y}=ya(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const v=ba(r),b=vo(a),w=ba(a)===a,k=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=f||(w||!g?[By(a)]:bae(a)),E=m!=="none";!f&&E&&C.push(...kae(a,g,m,k));const _=[a,...C],M=await dm(e,y),R=[];let T=((i=s.flip)==null?void 0:i.overflows)||[];if(u&&R.push(M[v]),d){const B=yae(r,o,k);R.push(M[B[0]],M[B[1]])}if(T=[...T,{placement:r,overflows:R}],!R.every(B=>B<=0)){var L,I;const B=(((L=s.flip)==null?void 0:L.index)||0)+1,q=_[B];if(q&&(!(d==="alignment"?b!==vo(q):!1)||T.every(V=>V.overflows[0]>0&&vo(V.placement)===b)))return{data:{index:B,overflows:T},reset:{placement:q}};let Y=(I=T.filter(ne=>ne.overflows[0]<=0).sort((ne,V)=>ne.overflows[1]-V.overflows[1])[0])==null?void 0:I.placement;if(!Y)switch(p){case"bestFit":{var G;const ne=(G=T.filter(V=>{if(E){const U=vo(V.placement);return U===b||U==="y"}return!0}).map(V=>[V.placement,V.overflows.filter(U=>U>0).reduce((U,se)=>U+se,0)]).sort((V,U)=>V[1]-U[1])[0])==null?void 0:G[0];ne&&(Y=ne);break}case"initialPlacement":Y=a;break}if(r!==Y)return{reset:{placement:Y}}}return{}}}};function qT(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function KT(t){return pae.some(e=>t[e]>=0)}const Pae=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:i="referenceHidden",...r}=ya(t,e);switch(i){case"referenceHidden":{const s=await dm(e,{...r,elementContext:"reference"}),o=qT(s,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:KT(o)}}}case"escaped":{const s=await dm(e,{...r,altBoundary:!0}),o=qT(s,n.floating);return{data:{escapedOffsets:o,escaped:KT(o)}}}default:return{}}}}},p$=new Set(["left","top"]);async function Nae(t,e){const{placement:n,platform:i,elements:r}=t,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),o=ba(n),a=Mf(n),l=vo(n)==="y",c=p$.has(o)?-1:1,u=s&&l?-1:1,d=ya(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof m=="number"&&(p=a==="end"?m*-1:m),l?{x:p*u,y:f*c}:{x:f*c,y:p*u}}const Mae=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:r,y:s,placement:o,middlewareData:a}=e,l=await Nae(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:{...l,placement:o}}}}},Rae=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:r}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:y=>{let{x:v,y:b}=y;return{x:v,y:b}}},...l}=ya(t,e),c={x:n,y:i},u=await dm(e,l),d=vo(ba(r)),f=uA(d);let p=c[f],m=c[d];if(s){const y=f==="y"?"top":"left",v=f==="y"?"bottom":"right",b=p+u[y],w=p-u[v];p=Gk(b,p,w)}if(o){const y=d==="y"?"top":"left",v=d==="y"?"bottom":"right",b=m+u[y],w=m-u[v];m=Gk(b,m,w)}const g=a.fn({...e,[f]:p,[d]:m});return{...g,data:{x:g.x-n,y:g.y-i,enabled:{[f]:s,[d]:o}}}}}},Iae=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:i,placement:r,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=ya(t,e),u={x:n,y:i},d=vo(r),f=uA(d);let p=u[f],m=u[d];const g=ya(a,e),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const w=f==="y"?"height":"width",k=s.reference[f]-s.floating[w]+y.mainAxis,C=s.reference[f]+s.reference[w]-y.mainAxis;p<k?p=k:p>C&&(p=C)}if(c){var v,b;const w=f==="y"?"width":"height",k=p$.has(ba(r)),C=s.reference[d]-s.floating[w]+(k&&((v=o.offset)==null?void 0:v[d])||0)+(k?0:y.crossAxis),E=s.reference[d]+s.reference[w]+(k?0:((b=o.offset)==null?void 0:b[d])||0)-(k?y.crossAxis:0);m<C?m=C:m>E&&(m=E)}return{[f]:p,[d]:m}}}},Tae=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,i;const{placement:r,rects:s,platform:o,elements:a}=e,{apply:l=()=>{},...c}=ya(t,e),u=await dm(e,c),d=ba(r),f=Mf(r),p=vo(r)==="y",{width:m,height:g}=s.floating;let y,v;d==="top"||d==="bottom"?(y=d,v=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(v=d,y=f==="end"?"top":"bottom");const b=g-u.top-u.bottom,w=m-u.left-u.right,k=Vl(g-u[y],b),C=Vl(m-u[v],w),E=!e.middlewareData.shift;let _=k,M=C;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(M=w),(i=e.middlewareData.shift)!=null&&i.enabled.y&&(_=b),E&&!f){const T=kr(u.left,0),L=kr(u.right,0),I=kr(u.top,0),G=kr(u.bottom,0);p?M=m-2*(T!==0||L!==0?T+L:kr(u.left,u.right)):_=g-2*(I!==0||G!==0?I+G:kr(u.top,u.bottom))}await l({...e,availableWidth:M,availableHeight:_});const R=await o.getDimensions(a.floating);return m!==R.width||g!==R.height?{reset:{rects:!0}}:{}}}};function u1(){return typeof window<"u"}function Rf(t){return m$(t)?(t.nodeName||"").toLowerCase():"#document"}function Ir(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Lo(t){var e;return(e=(m$(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function m$(t){return u1()?t instanceof Node||t instanceof Ir(t).Node:!1}function $s(t){return u1()?t instanceof Element||t instanceof Ir(t).Element:!1}function Io(t){return u1()?t instanceof HTMLElement||t instanceof Ir(t).HTMLElement:!1}function YT(t){return!u1()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ir(t).ShadowRoot}const Oae=new Set(["inline","contents"]);function Um(t){const{overflow:e,overflowX:n,overflowY:i,display:r}=Fs(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!Oae.has(r)}const Lae=new Set(["table","td","th"]);function Dae(t){return Lae.has(Rf(t))}const jae=[":popover-open",":modal"];function d1(t){return jae.some(e=>{try{return t.matches(e)}catch{return!1}})}const Bae=["transform","translate","scale","rotate","perspective"],$ae=["transform","translate","scale","rotate","perspective","filter"],Fae=["paint","layout","strict","content"];function hA(t){const e=pA(),n=$s(t)?Fs(t):t;return Bae.some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||$ae.some(i=>(n.willChange||"").includes(i))||Fae.some(i=>(n.contain||"").includes(i))}function zae(t){let e=Hl(t);for(;Io(e)&&!gf(e);){if(hA(e))return e;if(d1(e))return null;e=Hl(e)}return null}function pA(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Uae=new Set(["html","body","#document"]);function gf(t){return Uae.has(Rf(t))}function Fs(t){return Ir(t).getComputedStyle(t)}function f1(t){return $s(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Hl(t){if(Rf(t)==="html")return t;const e=t.assignedSlot||t.parentNode||YT(t)&&t.host||Lo(t);return YT(e)?e.host:e}function g$(t){const e=Hl(t);return gf(e)?t.ownerDocument?t.ownerDocument.body:t.body:Io(e)&&Um(e)?e:g$(e)}function fm(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=g$(t),s=r===((i=t.ownerDocument)==null?void 0:i.body),o=Ir(r);if(s){const a=qk(o);return e.concat(o,o.visualViewport||[],Um(r)?r:[],a&&n?fm(a):[])}return e.concat(r,fm(r,[],n))}function qk(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function v$(t){const e=Fs(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=Io(t),s=r?t.offsetWidth:n,o=r?t.offsetHeight:i,a=jy(n)!==s||jy(i)!==o;return a&&(n=s,i=o),{width:n,height:i,$:a}}function mA(t){return $s(t)?t:t.contextElement}function Nd(t){const e=mA(t);if(!Io(e))return Eo(1);const n=e.getBoundingClientRect(),{width:i,height:r,$:s}=v$(e);let o=(s?jy(n.width):n.width)/i,a=(s?jy(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Vae=Eo(0);function y$(t){const e=Ir(t);return!pA()||!e.visualViewport?Vae:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Hae(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ir(t)?!1:e}function au(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=mA(t);let o=Eo(1);e&&(i?$s(i)&&(o=Nd(i)):o=Nd(t));const a=Hae(s,n,i)?y$(s):Eo(0);let l=(r.left+a.x)/o.x,c=(r.top+a.y)/o.y,u=r.width/o.x,d=r.height/o.y;if(s){const f=Ir(s),p=i&&$s(i)?Ir(i):i;let m=f,g=qk(m);for(;g&&i&&p!==m;){const y=Nd(g),v=g.getBoundingClientRect(),b=Fs(g),w=v.left+(g.clientLeft+parseFloat(b.paddingLeft))*y.x,k=v.top+(g.clientTop+parseFloat(b.paddingTop))*y.y;l*=y.x,c*=y.y,u*=y.x,d*=y.y,l+=w,c+=k,m=Ir(g),g=qk(m)}}return $y({width:u,height:d,x:l,y:c})}function gA(t,e){const n=f1(t).scrollLeft;return e?e.left+n:au(Lo(t)).left+n}function b$(t,e,n){n===void 0&&(n=!1);const i=t.getBoundingClientRect(),r=i.left+e.scrollLeft-(n?0:gA(t,i)),s=i.top+e.scrollTop;return{x:r,y:s}}function Wae(t){let{elements:e,rect:n,offsetParent:i,strategy:r}=t;const s=r==="fixed",o=Lo(i),a=e?d1(e.floating):!1;if(i===o||a&&s)return n;let l={scrollLeft:0,scrollTop:0},c=Eo(1);const u=Eo(0),d=Io(i);if((d||!d&&!s)&&((Rf(i)!=="body"||Um(o))&&(l=f1(i)),Io(i))){const p=au(i);c=Nd(i),u.x=p.x+i.clientLeft,u.y=p.y+i.clientTop}const f=o&&!d&&!s?b$(o,l,!0):Eo(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:n.y*c.y-l.scrollTop*c.y+u.y+f.y}}function Gae(t){return Array.from(t.getClientRects())}function Xae(t){const e=Lo(t),n=f1(t),i=t.ownerDocument.body,r=kr(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=kr(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let o=-n.scrollLeft+gA(t);const a=-n.scrollTop;return Fs(i).direction==="rtl"&&(o+=kr(e.clientWidth,i.clientWidth)-r),{width:r,height:s,x:o,y:a}}function qae(t,e){const n=Ir(t),i=Lo(t),r=n.visualViewport;let s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;const c=pA();(!c||c&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a,y:l}}const Kae=new Set(["absolute","fixed"]);function Yae(t,e){const n=au(t,!0,e==="fixed"),i=n.top+t.clientTop,r=n.left+t.clientLeft,s=Io(t)?Nd(t):Eo(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,l=r*s.x,c=i*s.y;return{width:o,height:a,x:l,y:c}}function JT(t,e,n){let i;if(e==="viewport")i=qae(t,n);else if(e==="document")i=Xae(Lo(t));else if($s(e))i=Yae(e,n);else{const r=y$(t);i={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return $y(i)}function x$(t,e){const n=Hl(t);return n===e||!$s(n)||gf(n)?!1:Fs(n).position==="fixed"||x$(n,e)}function Jae(t,e){const n=e.get(t);if(n)return n;let i=fm(t,[],!1).filter(a=>$s(a)&&Rf(a)!=="body"),r=null;const s=Fs(t).position==="fixed";let o=s?Hl(t):t;for(;$s(o)&&!gf(o);){const a=Fs(o),l=hA(o);!l&&a.position==="fixed"&&(r=null),(s?!l&&!r:!l&&a.position==="static"&&!!r&&Kae.has(r.position)||Um(o)&&!l&&x$(t,o))?i=i.filter(u=>u!==o):r=a,o=Hl(o)}return e.set(t,i),i}function Zae(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const o=[...n==="clippingAncestors"?d1(e)?[]:Jae(e,this._c):[].concat(n),i],a=o[0],l=o.reduce((c,u)=>{const d=JT(e,u,r);return c.top=kr(d.top,c.top),c.right=Vl(d.right,c.right),c.bottom=Vl(d.bottom,c.bottom),c.left=kr(d.left,c.left),c},JT(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Qae(t){const{width:e,height:n}=v$(t);return{width:e,height:n}}function ele(t,e,n){const i=Io(e),r=Lo(e),s=n==="fixed",o=au(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=Eo(0);function c(){l.x=gA(r)}if(i||!i&&!s)if((Rf(e)!=="body"||Um(r))&&(a=f1(e)),i){const p=au(e,!0,s,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else r&&c();s&&!i&&r&&c();const u=r&&!i&&!s?b$(r,a):Eo(0),d=o.left+a.scrollLeft-l.x-u.x,f=o.top+a.scrollTop-l.y-u.y;return{x:d,y:f,width:o.width,height:o.height}}function bw(t){return Fs(t).position==="static"}function ZT(t,e){if(!Io(t)||Fs(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Lo(t)===n&&(n=n.ownerDocument.body),n}function w$(t,e){const n=Ir(t);if(d1(t))return n;if(!Io(t)){let r=Hl(t);for(;r&&!gf(r);){if($s(r)&&!bw(r))return r;r=Hl(r)}return n}let i=ZT(t,e);for(;i&&Dae(i)&&bw(i);)i=ZT(i,e);return i&&gf(i)&&bw(i)&&!hA(i)?n:i||zae(t)||n}const tle=async function(t){const e=this.getOffsetParent||w$,n=this.getDimensions,i=await n(t.floating);return{reference:ele(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function nle(t){return Fs(t).direction==="rtl"}const ile={convertOffsetParentRelativeRectToViewportRelativeRect:Wae,getDocumentElement:Lo,getClippingRect:Zae,getOffsetParent:w$,getElementRects:tle,getClientRects:Gae,getDimensions:Qae,getScale:Nd,isElement:$s,isRTL:nle};function S$(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function rle(t,e){let n=null,i;const r=Lo(t);function s(){var a;clearTimeout(i),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const c=t.getBoundingClientRect(),{left:u,top:d,width:f,height:p}=c;if(a||e(),!f||!p)return;const m=o0(d),g=o0(r.clientWidth-(u+f)),y=o0(r.clientHeight-(d+p)),v=o0(u),w={rootMargin:-m+"px "+-g+"px "+-y+"px "+-v+"px",threshold:kr(0,Vl(1,l))||1};let k=!0;function C(E){const _=E[0].intersectionRatio;if(_!==l){if(!k)return o();_?o(!1,_):i=setTimeout(()=>{o(!1,1e-7)},1e3)}_===1&&!S$(c,t.getBoundingClientRect())&&o(),k=!1}try{n=new IntersectionObserver(C,{...w,root:r.ownerDocument})}catch{n=new IntersectionObserver(C,w)}n.observe(t)}return o(!0),s}function sle(t,e,n,i){i===void 0&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,c=mA(t),u=r||s?[...c?fm(c):[],...fm(e)]:[];u.forEach(v=>{r&&v.addEventListener("scroll",n,{passive:!0}),s&&v.addEventListener("resize",n)});const d=c&&a?rle(c,n):null;let f=-1,p=null;o&&(p=new ResizeObserver(v=>{let[b]=v;b&&b.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var w;(w=p)==null||w.observe(e)})),n()}),c&&!l&&p.observe(c),p.observe(e));let m,g=l?au(t):null;l&&y();function y(){const v=au(t);g&&!S$(g,v)&&n(),g=v,m=requestAnimationFrame(y)}return n(),()=>{var v;u.forEach(b=>{r&&b.removeEventListener("scroll",n),s&&b.removeEventListener("resize",n)}),d==null||d(),(v=p)==null||v.disconnect(),p=null,l&&cancelAnimationFrame(m)}}const ole=Mae,ale=Rae,lle=Aae,cle=Tae,ule=Pae,QT=Eae,dle=Iae,fle=(t,e,n)=>{const i=new Map,r={platform:ile,...n},s={...r.platform,_c:i};return _ae(t,e,{...r,platform:s})};var hle=typeof document<"u",ple=function(){},fv=hle?x.useLayoutEffect:ple;function Fy(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,i,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(i=n;i--!==0;)if(!Fy(t[i],e[i]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(e,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!(s==="_owner"&&t.$$typeof)&&!Fy(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function k$(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function e3(t,e){const n=k$(t);return Math.round(e*n)/n}function xw(t){const e=x.useRef(t);return fv(()=>{e.current=t}),e}function mle(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:i=[],platform:r,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=x.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=x.useState(i);Fy(f,i)||p(i);const[m,g]=x.useState(null),[y,v]=x.useState(null),b=x.useCallback(V=>{V!==E.current&&(E.current=V,g(V))},[]),w=x.useCallback(V=>{V!==_.current&&(_.current=V,v(V))},[]),k=s||m,C=o||y,E=x.useRef(null),_=x.useRef(null),M=x.useRef(u),R=l!=null,T=xw(l),L=xw(r),I=xw(c),G=x.useCallback(()=>{if(!E.current||!_.current)return;const V={placement:e,strategy:n,middleware:f};L.current&&(V.platform=L.current),fle(E.current,_.current,V).then(U=>{const se={...U,isPositioned:I.current!==!1};B.current&&!Fy(M.current,se)&&(M.current=se,Jl.flushSync(()=>{d(se)}))})},[f,e,n,L,I]);fv(()=>{c===!1&&M.current.isPositioned&&(M.current.isPositioned=!1,d(V=>({...V,isPositioned:!1})))},[c]);const B=x.useRef(!1);fv(()=>(B.current=!0,()=>{B.current=!1}),[]),fv(()=>{if(k&&(E.current=k),C&&(_.current=C),k&&C){if(T.current)return T.current(k,C,G);G()}},[k,C,G,T,R]);const q=x.useMemo(()=>({reference:E,floating:_,setReference:b,setFloating:w}),[b,w]),Y=x.useMemo(()=>({reference:k,floating:C}),[k,C]),ne=x.useMemo(()=>{const V={position:n,left:0,top:0};if(!Y.floating)return V;const U=e3(Y.floating,u.x),se=e3(Y.floating,u.y);return a?{...V,transform:"translate("+U+"px, "+se+"px)",...k$(Y.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:U,top:se}},[n,a,Y.floating,u.x,u.y]);return x.useMemo(()=>({...u,update:G,refs:q,elements:Y,floatingStyles:ne}),[u,G,q,Y,ne])}const gle=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:i,padding:r}=typeof t=="function"?t(n):t;return i&&e(i)?i.current!=null?QT({element:i.current,padding:r}).fn(n):{}:i?QT({element:i,padding:r}).fn(n):{}}}},vle=(t,e)=>({...ole(t),options:[t,e]}),yle=(t,e)=>({...ale(t),options:[t,e]}),ble=(t,e)=>({...dle(t),options:[t,e]}),xle=(t,e)=>({...lle(t),options:[t,e]}),wle=(t,e)=>({...cle(t),options:[t,e]}),Sle=(t,e)=>({...ule(t),options:[t,e]}),kle=(t,e)=>({...gle(t),options:[t,e]});var Cle="Arrow",C$=x.forwardRef((t,e)=>{const{children:n,width:i=10,height:r=5,...s}=t;return h.jsx(it.svg,{...s,ref:e,width:i,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});C$.displayName=Cle;var _le=C$;function vA(t){const[e,n]=x.useState(void 0);return hi(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const i=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const s=r[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return i.observe(t,{box:"border-box"}),()=>i.unobserve(t)}else n(void 0)},[t]),e}var yA="Popper",[_$,If]=zs(yA),[Ele,E$]=_$(yA),A$=t=>{const{__scopePopper:e,children:n}=t,[i,r]=x.useState(null);return h.jsx(Ele,{scope:e,anchor:i,onAnchorChange:r,children:n})};A$.displayName=yA;var P$="PopperAnchor",N$=x.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:i,...r}=t,s=E$(P$,n),o=x.useRef(null),a=St(e,o);return x.useEffect(()=>{s.onAnchorChange((i==null?void 0:i.current)||o.current)}),i?null:h.jsx(it.div,{...r,ref:a})});N$.displayName=P$;var bA="PopperContent",[Ale,Ple]=_$(bA),M$=x.forwardRef((t,e)=>{var S,O,j,D,Z,K;const{__scopePopper:n,side:i="bottom",sideOffset:r=0,align:s="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:m,...g}=t,y=E$(bA,n),[v,b]=x.useState(null),w=St(e,oe=>b(oe)),[k,C]=x.useState(null),E=vA(k),_=(E==null?void 0:E.width)??0,M=(E==null?void 0:E.height)??0,R=i+(s!=="center"?"-"+s:""),T=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(c)?c:[c],I=L.length>0,G={padding:T,boundary:L.filter(Mle),altBoundary:I},{refs:B,floatingStyles:q,placement:Y,isPositioned:ne,middlewareData:V}=mle({strategy:"fixed",placement:R,whileElementsMounted:(...oe)=>sle(...oe,{animationFrame:p==="always"}),elements:{reference:y.anchor},middleware:[vle({mainAxis:r+M,alignmentAxis:o}),l&&yle({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?ble():void 0,...G}),l&&xle({...G}),wle({...G,apply:({elements:oe,rects:te,availableWidth:Oe,availableHeight:Xe})=>{const{width:Je,height:Ve}=te.reference,ct=oe.floating.style;ct.setProperty("--radix-popper-available-width",`${Oe}px`),ct.setProperty("--radix-popper-available-height",`${Xe}px`),ct.setProperty("--radix-popper-anchor-width",`${Je}px`),ct.setProperty("--radix-popper-anchor-height",`${Ve}px`)}}),k&&kle({element:k,padding:a}),Rle({arrowWidth:_,arrowHeight:M}),f&&Sle({strategy:"referenceHidden",...G})]}),[U,se]=T$(Y),Ce=Or(m);hi(()=>{ne&&(Ce==null||Ce())},[ne,Ce]);const Q=(S=V.arrow)==null?void 0:S.x,ae=(O=V.arrow)==null?void 0:O.y,z=((j=V.arrow)==null?void 0:j.centerOffset)!==0,[$,W]=x.useState();return hi(()=>{v&&W(window.getComputedStyle(v).zIndex)},[v]),h.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:{...q,transform:ne?q.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:$,"--radix-popper-transform-origin":[(D=V.transformOrigin)==null?void 0:D.x,(Z=V.transformOrigin)==null?void 0:Z.y].join(" "),...((K=V.hide)==null?void 0:K.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:h.jsx(Ale,{scope:n,placedSide:U,onArrowChange:C,arrowX:Q,arrowY:ae,shouldHideArrow:z,children:h.jsx(it.div,{"data-side":U,"data-align":se,...g,ref:w,style:{...g.style,animation:ne?void 0:"none"}})})})});M$.displayName=bA;var R$="PopperArrow",Nle={top:"bottom",right:"left",bottom:"top",left:"right"},I$=x.forwardRef(function(e,n){const{__scopePopper:i,...r}=e,s=Ple(R$,i),o=Nle[s.placedSide];return h.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:h.jsx(_le,{...r,ref:n,style:{...r.style,display:"block"}})})});I$.displayName=R$;function Mle(t){return t!==null}var Rle=t=>({name:"transformOrigin",options:t,fn(e){var y,v,b;const{placement:n,rects:i,middlewareData:r}=e,o=((y=r.arrow)==null?void 0:y.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=T$(n),d={start:"0%",center:"50%",end:"100%"}[u],f=(((v=r.arrow)==null?void 0:v.x)??0)+a/2,p=(((b=r.arrow)==null?void 0:b.y)??0)+l/2;let m="",g="";return c==="bottom"?(m=o?d:`${f}px`,g=`${-l}px`):c==="top"?(m=o?d:`${f}px`,g=`${i.floating.height+l}px`):c==="right"?(m=`${-l}px`,g=o?d:`${p}px`):c==="left"&&(m=`${i.floating.width+l}px`,g=o?d:`${p}px`),{data:{x:m,y:g}}}});function T$(t){const[e,n="center"]=t.split("-");return[e,n]}var O$=A$,h1=N$,xA=M$,wA=I$,Ile="Portal",Vm=x.forwardRef((t,e)=>{var a;const{container:n,...i}=t,[r,s]=x.useState(!1);hi(()=>s(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?uX.createPortal(h.jsx(it.div,{...i,ref:e}),o):null});Vm.displayName=Ile;function SA(t){const e=x.useRef({value:t,previous:t});return x.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var L$=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Tle="VisuallyHidden",kA=x.forwardRef((t,e)=>h.jsx(it.span,{...t,ref:e,style:{...L$,...t.style}}));kA.displayName=Tle;var Ole=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Mu=new WeakMap,a0=new WeakMap,l0={},ww=0,D$=function(t){return t&&(t.host||D$(t.parentNode))},Lle=function(t,e){return e.map(function(n){if(t.contains(n))return n;var i=D$(n);return i&&t.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},Dle=function(t,e,n,i){var r=Lle(e,Array.isArray(t)?t:[t]);l0[n]||(l0[n]=new WeakMap);var s=l0[n],o=[],a=new Set,l=new Set(r),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};r.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(a.has(f))u(f);else try{var p=f.getAttribute(i),m=p!==null&&p!=="false",g=(Mu.get(f)||0)+1,y=(s.get(f)||0)+1;Mu.set(f,g),s.set(f,y),o.push(f),g===1&&m&&a0.set(f,!0),y===1&&f.setAttribute(n,"true"),m||f.setAttribute(i,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return u(e),a.clear(),ww++,function(){o.forEach(function(d){var f=Mu.get(d)-1,p=s.get(d)-1;Mu.set(d,f),s.set(d,p),f||(a0.has(d)||d.removeAttribute(i),a0.delete(d)),p||d.removeAttribute(n)}),ww--,ww||(Mu=new WeakMap,Mu=new WeakMap,a0=new WeakMap,l0={})}},j$=function(t,e,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(t)?t:[t]),r=Ole(t);return r?(i.push.apply(i,Array.from(r.querySelectorAll("[aria-live]"))),Dle(i,r,n,"aria-hidden")):function(){return null}},hv="right-scroll-bar-position",pv="width-before-scroll-bar",jle="with-scroll-bars-hidden",Ble="--removed-body-scroll-bar-size";function Sw(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function $le(t,e){var n=x.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(i){var r=n.value;r!==i&&(n.value=i,n.callback(i,r))}}}})[0];return n.callback=e,n.facade}var Fle=typeof window<"u"?x.useLayoutEffect:x.useEffect,t3=new WeakMap;function zle(t,e){var n=$le(null,function(i){return t.forEach(function(r){return Sw(r,i)})});return Fle(function(){var i=t3.get(n);if(i){var r=new Set(i),s=new Set(t),o=n.current;r.forEach(function(a){s.has(a)||Sw(a,null)}),s.forEach(function(a){r.has(a)||Sw(a,o)})}t3.set(n,t)},[t]),n}function Ule(t){return t}function Vle(t,e){e===void 0&&(e=Ule);var n=[],i=!1,r={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,i);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(i=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){i=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var l=function(){var u=o;o=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return r}function Hle(t){t===void 0&&(t={});var e=Vle(null);return e.options=ao({async:!0,ssr:!1},t),e}var B$=function(t){var e=t.sideCar,n=HD(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=e.read();if(!i)throw new Error("Sidecar medium not found");return x.createElement(i,ao({},n))};B$.isSideCarExport=!0;function Wle(t,e){return t.useMedium(e),B$}var $$=Hle(),kw=function(){},p1=x.forwardRef(function(t,e){var n=x.useRef(null),i=x.useState({onScrollCapture:kw,onWheelCapture:kw,onTouchMoveCapture:kw}),r=i[0],s=i[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,f=t.sideCar,p=t.noRelative,m=t.noIsolation,g=t.inert,y=t.allowPinchZoom,v=t.as,b=v===void 0?"div":v,w=t.gapMode,k=HD(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=f,E=zle([n,e]),_=ao(ao({},k),r);return x.createElement(x.Fragment,null,u&&x.createElement(C,{sideCar:$$,removeScrollBar:c,shards:d,noRelative:p,noIsolation:m,inert:g,setCallbacks:s,allowPinchZoom:!!y,lockRef:n,gapMode:w}),o?x.cloneElement(x.Children.only(a),ao(ao({},_),{ref:E})):x.createElement(b,ao({},_,{className:l,ref:E}),a))});p1.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};p1.classNames={fullWidth:pv,zeroRight:hv};var Gle=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Xle(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Gle();return e&&t.setAttribute("nonce",e),t}function qle(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Kle(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Yle=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Xle())&&(qle(e,n),Kle(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Jle=function(){var t=Yle();return function(e,n){x.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},F$=function(){var t=Jle(),e=function(n){var i=n.styles,r=n.dynamic;return t(i,r),null};return e},Zle={left:0,top:0,right:0,gap:0},Cw=function(t){return parseInt(t||"",10)||0},Qle=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],i=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[Cw(n),Cw(i),Cw(r)]},ece=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Zle;var e=Qle(t),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,i-n+e[2]-e[0])}},tce=F$(),Md="data-scroll-locked",nce=function(t,e,n,i){var r=t.left,s=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(jle,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(a,"px ").concat(i,`;
  }
  body[`).concat(Md,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(hv,` {
    right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(pv,` {
    margin-right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(hv," .").concat(hv,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(pv," .").concat(pv,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(Md,`] {
    `).concat(Ble,": ").concat(a,`px;
  }
`)},n3=function(){var t=parseInt(document.body.getAttribute(Md)||"0",10);return isFinite(t)?t:0},ice=function(){x.useEffect(function(){return document.body.setAttribute(Md,(n3()+1).toString()),function(){var t=n3()-1;t<=0?document.body.removeAttribute(Md):document.body.setAttribute(Md,t.toString())}},[])},rce=function(t){var e=t.noRelative,n=t.noImportant,i=t.gapMode,r=i===void 0?"margin":i;ice();var s=x.useMemo(function(){return ece(r)},[r]);return x.createElement(tce,{styles:nce(s,!e,r,n?"":"!important")})},Kk=!1;if(typeof window<"u")try{var c0=Object.defineProperty({},"passive",{get:function(){return Kk=!0,!0}});window.addEventListener("test",c0,c0),window.removeEventListener("test",c0,c0)}catch{Kk=!1}var Ru=Kk?{passive:!1}:!1,sce=function(t){return t.tagName==="TEXTAREA"},z$=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!sce(t)&&n[e]==="visible")},oce=function(t){return z$(t,"overflowY")},ace=function(t){return z$(t,"overflowX")},i3=function(t,e){var n=e.ownerDocument,i=e;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var r=U$(t,i);if(r){var s=V$(t,i),o=s[1],a=s[2];if(o>a)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},lce=function(t){var e=t.scrollTop,n=t.scrollHeight,i=t.clientHeight;return[e,n,i]},cce=function(t){var e=t.scrollLeft,n=t.scrollWidth,i=t.clientWidth;return[e,n,i]},U$=function(t,e){return t==="v"?oce(e):ace(e)},V$=function(t,e){return t==="v"?lce(e):cce(e)},uce=function(t,e){return t==="h"&&e==="rtl"?-1:1},dce=function(t,e,n,i,r){var s=uce(t,window.getComputedStyle(e).direction),o=s*i,a=n.target,l=e.contains(a),c=!1,u=o>0,d=0,f=0;do{if(!a)break;var p=V$(t,a),m=p[0],g=p[1],y=p[2],v=g-y-s*m;(m||v)&&U$(t,a)&&(d+=v,f+=m);var b=a.parentNode;a=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&Math.abs(d)<1||!u&&Math.abs(f)<1)&&(c=!0),c},u0=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},r3=function(t){return[t.deltaX,t.deltaY]},s3=function(t){return t&&"current"in t?t.current:t},fce=function(t,e){return t[0]===e[0]&&t[1]===e[1]},hce=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},pce=0,Iu=[];function mce(t){var e=x.useRef([]),n=x.useRef([0,0]),i=x.useRef(),r=x.useState(pce++)[0],s=x.useState(F$)[0],o=x.useRef(t);x.useEffect(function(){o.current=t},[t]),x.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var g=vq([t.lockRef.current],(t.shards||[]).map(s3),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var a=x.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var v=u0(g),b=n.current,w="deltaX"in g?g.deltaX:b[0]-v[0],k="deltaY"in g?g.deltaY:b[1]-v[1],C,E=g.target,_=Math.abs(w)>Math.abs(k)?"h":"v";if("touches"in g&&_==="h"&&E.type==="range")return!1;var M=i3(_,E);if(!M)return!0;if(M?C=_:(C=_==="v"?"h":"v",M=i3(_,E)),!M)return!1;if(!i.current&&"changedTouches"in g&&(w||k)&&(i.current=C),!C)return!0;var R=i.current||C;return dce(R,y,g,R==="h"?w:k)},[]),l=x.useCallback(function(g){var y=g;if(!(!Iu.length||Iu[Iu.length-1]!==s)){var v="deltaY"in y?r3(y):u0(y),b=e.current.filter(function(C){return C.name===y.type&&(C.target===y.target||y.target===C.shadowParent)&&fce(C.delta,v)})[0];if(b&&b.should){y.cancelable&&y.preventDefault();return}if(!b){var w=(o.current.shards||[]).map(s3).filter(Boolean).filter(function(C){return C.contains(y.target)}),k=w.length>0?a(y,w[0]):!o.current.noIsolation;k&&y.cancelable&&y.preventDefault()}}},[]),c=x.useCallback(function(g,y,v,b){var w={name:g,delta:y,target:v,should:b,shadowParent:gce(v)};e.current.push(w),setTimeout(function(){e.current=e.current.filter(function(k){return k!==w})},1)},[]),u=x.useCallback(function(g){n.current=u0(g),i.current=void 0},[]),d=x.useCallback(function(g){c(g.type,r3(g),g.target,a(g,t.lockRef.current))},[]),f=x.useCallback(function(g){c(g.type,u0(g),g.target,a(g,t.lockRef.current))},[]);x.useEffect(function(){return Iu.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Ru),document.addEventListener("touchmove",l,Ru),document.addEventListener("touchstart",u,Ru),function(){Iu=Iu.filter(function(g){return g!==s}),document.removeEventListener("wheel",l,Ru),document.removeEventListener("touchmove",l,Ru),document.removeEventListener("touchstart",u,Ru)}},[]);var p=t.removeScrollBar,m=t.inert;return x.createElement(x.Fragment,null,m?x.createElement(s,{styles:hce(r)}):null,p?x.createElement(rce,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function gce(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const vce=Wle($$,mce);var m1=x.forwardRef(function(t,e){return x.createElement(p1,ao({},t,{ref:e,sideCar:vce}))});m1.classNames=p1.classNames;var yce=[" ","Enter","ArrowUp","ArrowDown"],bce=[" ","Enter"],lu="Select",[g1,v1,xce]=Em(lu),[Tf,Rve]=zs(lu,[xce,If]),y1=If(),[wce,ec]=Tf(lu),[Sce,kce]=Tf(lu),H$=t=>{const{__scopeSelect:e,children:n,open:i,defaultOpen:r,onOpenChange:s,value:o,defaultValue:a,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:f,required:p,form:m}=t,g=y1(e),[y,v]=x.useState(null),[b,w]=x.useState(null),[k,C]=x.useState(!1),E=Pb(c),[_,M]=Rl({prop:i,defaultProp:r??!1,onChange:s,caller:lu}),[R,T]=Rl({prop:o,defaultProp:a,onChange:l,caller:lu}),L=x.useRef(null),I=y?m||!!y.closest("form"):!0,[G,B]=x.useState(new Set),q=Array.from(G).map(Y=>Y.props.value).join(";");return h.jsx(O$,{...g,children:h.jsxs(wce,{required:p,scope:e,trigger:y,onTriggerChange:v,valueNode:b,onValueNodeChange:w,valueNodeHasChildren:k,onValueNodeHasChildrenChange:C,contentId:_f(),value:R,onValueChange:T,open:_,onOpenChange:M,dir:E,triggerPointerDownPosRef:L,disabled:f,children:[h.jsx(g1.Provider,{scope:e,children:h.jsx(Sce,{scope:t.__scopeSelect,onNativeOptionAdd:x.useCallback(Y=>{B(ne=>new Set(ne).add(Y))},[]),onNativeOptionRemove:x.useCallback(Y=>{B(ne=>{const V=new Set(ne);return V.delete(Y),V})},[]),children:n})}),I?h.jsxs(cF,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:d,value:R,onChange:Y=>T(Y.target.value),disabled:f,form:m,children:[R===void 0?h.jsx("option",{value:""}):null,Array.from(G)]},q):null]})})};H$.displayName=lu;var W$="SelectTrigger",G$=x.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:i=!1,...r}=t,s=y1(n),o=ec(W$,n),a=o.disabled||i,l=St(e,o.onTriggerChange),c=v1(n),u=x.useRef("touch"),[d,f,p]=dF(g=>{const y=c().filter(w=>!w.disabled),v=y.find(w=>w.value===o.value),b=fF(y,g,v);b!==void 0&&o.onValueChange(b.value)}),m=g=>{a||(o.onOpenChange(!0),p()),g&&(o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return h.jsx(h1,{asChild:!0,...s,children:h.jsx(it.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":uF(o.value)?"":void 0,...r,ref:l,onClick:ke(r.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&m(g)}),onPointerDown:ke(r.onPointerDown,g=>{u.current=g.pointerType;const y=g.target;y.hasPointerCapture(g.pointerId)&&y.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(m(g),g.preventDefault())}),onKeyDown:ke(r.onKeyDown,g=>{const y=d.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&f(g.key),!(y&&g.key===" ")&&yce.includes(g.key)&&(m(),g.preventDefault())})})})});G$.displayName=W$;var X$="SelectValue",q$=x.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,children:s,placeholder:o="",...a}=t,l=ec(X$,n),{onValueNodeHasChildrenChange:c}=l,u=s!==void 0,d=St(e,l.onValueNodeChange);return hi(()=>{c(u)},[c,u]),h.jsx(it.span,{...a,ref:d,style:{pointerEvents:"none"},children:uF(l.value)?h.jsx(h.Fragment,{children:o}):s})});q$.displayName=X$;var Cce="SelectIcon",K$=x.forwardRef((t,e)=>{const{__scopeSelect:n,children:i,...r}=t;return h.jsx(it.span,{"aria-hidden":!0,...r,ref:e,children:i||"▼"})});K$.displayName=Cce;var _ce="SelectPortal",Y$=t=>h.jsx(Vm,{asChild:!0,...t});Y$.displayName=_ce;var cu="SelectContent",J$=x.forwardRef((t,e)=>{const n=ec(cu,t.__scopeSelect),[i,r]=x.useState();if(hi(()=>{r(new DocumentFragment)},[]),!n.open){const s=i;return s?Jl.createPortal(h.jsx(Z$,{scope:t.__scopeSelect,children:h.jsx(g1.Slot,{scope:t.__scopeSelect,children:h.jsx("div",{children:t.children})})}),s):null}return h.jsx(Q$,{...t,ref:e})});J$.displayName=cu;var ys=10,[Z$,tc]=Tf(cu),Ece="SelectContentImpl",Ace=Jd("SelectContent.RemoveScroll"),Q$=x.forwardRef((t,e)=>{const{__scopeSelect:n,position:i="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:s,onPointerDownOutside:o,side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:g,avoidCollisions:y,...v}=t,b=ec(cu,n),[w,k]=x.useState(null),[C,E]=x.useState(null),_=St(e,S=>k(S)),[M,R]=x.useState(null),[T,L]=x.useState(null),I=v1(n),[G,B]=x.useState(!1),q=x.useRef(!1);x.useEffect(()=>{if(w)return j$(w)},[w]),cA();const Y=x.useCallback(S=>{const[O,...j]=I().map(K=>K.ref.current),[D]=j.slice(-1),Z=document.activeElement;for(const K of S)if(K===Z||(K==null||K.scrollIntoView({block:"nearest"}),K===O&&C&&(C.scrollTop=0),K===D&&C&&(C.scrollTop=C.scrollHeight),K==null||K.focus(),document.activeElement!==Z))return},[I,C]),ne=x.useCallback(()=>Y([M,w]),[Y,M,w]);x.useEffect(()=>{G&&ne()},[G,ne]);const{onOpenChange:V,triggerPointerDownPosRef:U}=b;x.useEffect(()=>{if(w){let S={x:0,y:0};const O=D=>{var Z,K;S={x:Math.abs(Math.round(D.pageX)-(((Z=U.current)==null?void 0:Z.x)??0)),y:Math.abs(Math.round(D.pageY)-(((K=U.current)==null?void 0:K.y)??0))}},j=D=>{S.x<=10&&S.y<=10?D.preventDefault():w.contains(D.target)||V(!1),document.removeEventListener("pointermove",O),U.current=null};return U.current!==null&&(document.addEventListener("pointermove",O),document.addEventListener("pointerup",j,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",O),document.removeEventListener("pointerup",j,{capture:!0})}}},[w,V,U]),x.useEffect(()=>{const S=()=>V(!1);return window.addEventListener("blur",S),window.addEventListener("resize",S),()=>{window.removeEventListener("blur",S),window.removeEventListener("resize",S)}},[V]);const[se,Ce]=dF(S=>{const O=I().filter(Z=>!Z.disabled),j=O.find(Z=>Z.ref.current===document.activeElement),D=fF(O,S,j);D&&setTimeout(()=>D.ref.current.focus())}),Q=x.useCallback((S,O,j)=>{const D=!q.current&&!j;(b.value!==void 0&&b.value===O||D)&&(R(S),D&&(q.current=!0))},[b.value]),ae=x.useCallback(()=>w==null?void 0:w.focus(),[w]),z=x.useCallback((S,O,j)=>{const D=!q.current&&!j;(b.value!==void 0&&b.value===O||D)&&L(S)},[b.value]),$=i==="popper"?Yk:eF,W=$===Yk?{side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:g,avoidCollisions:y}:{};return h.jsx(Z$,{scope:n,content:w,viewport:C,onViewportChange:E,itemRefCallback:Q,selectedItem:M,onItemLeave:ae,itemTextRefCallback:z,focusSelectedItem:ne,selectedItemText:T,position:i,isPositioned:G,searchRef:se,children:h.jsx(m1,{as:Ace,allowPinchZoom:!0,children:h.jsx(c1,{asChild:!0,trapped:b.open,onMountAutoFocus:S=>{S.preventDefault()},onUnmountAutoFocus:ke(r,S=>{var O;(O=b.trigger)==null||O.focus({preventScroll:!0}),S.preventDefault()}),children:h.jsx(zm,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:S=>S.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:h.jsx($,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:S=>S.preventDefault(),...v,...W,onPlaced:()=>B(!0),ref:_,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:ke(v.onKeyDown,S=>{const O=S.ctrlKey||S.altKey||S.metaKey;if(S.key==="Tab"&&S.preventDefault(),!O&&S.key.length===1&&Ce(S.key),["ArrowUp","ArrowDown","Home","End"].includes(S.key)){let D=I().filter(Z=>!Z.disabled).map(Z=>Z.ref.current);if(["ArrowUp","End"].includes(S.key)&&(D=D.slice().reverse()),["ArrowUp","ArrowDown"].includes(S.key)){const Z=S.target,K=D.indexOf(Z);D=D.slice(K+1)}setTimeout(()=>Y(D)),S.preventDefault()}})})})})})})});Q$.displayName=Ece;var Pce="SelectItemAlignedPosition",eF=x.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:i,...r}=t,s=ec(cu,n),o=tc(cu,n),[a,l]=x.useState(null),[c,u]=x.useState(null),d=St(e,_=>u(_)),f=v1(n),p=x.useRef(!1),m=x.useRef(!0),{viewport:g,selectedItem:y,selectedItemText:v,focusSelectedItem:b}=o,w=x.useCallback(()=>{if(s.trigger&&s.valueNode&&a&&c&&g&&y&&v){const _=s.trigger.getBoundingClientRect(),M=c.getBoundingClientRect(),R=s.valueNode.getBoundingClientRect(),T=v.getBoundingClientRect();if(s.dir!=="rtl"){const Z=T.left-M.left,K=R.left-Z,oe=_.left-K,te=_.width+oe,Oe=Math.max(te,M.width),Xe=window.innerWidth-ys,Je=Dy(K,[ys,Math.max(ys,Xe-Oe)]);a.style.minWidth=te+"px",a.style.left=Je+"px"}else{const Z=M.right-T.right,K=window.innerWidth-R.right-Z,oe=window.innerWidth-_.right-K,te=_.width+oe,Oe=Math.max(te,M.width),Xe=window.innerWidth-ys,Je=Dy(K,[ys,Math.max(ys,Xe-Oe)]);a.style.minWidth=te+"px",a.style.right=Je+"px"}const L=f(),I=window.innerHeight-ys*2,G=g.scrollHeight,B=window.getComputedStyle(c),q=parseInt(B.borderTopWidth,10),Y=parseInt(B.paddingTop,10),ne=parseInt(B.borderBottomWidth,10),V=parseInt(B.paddingBottom,10),U=q+Y+G+V+ne,se=Math.min(y.offsetHeight*5,U),Ce=window.getComputedStyle(g),Q=parseInt(Ce.paddingTop,10),ae=parseInt(Ce.paddingBottom,10),z=_.top+_.height/2-ys,$=I-z,W=y.offsetHeight/2,S=y.offsetTop+W,O=q+Y+S,j=U-O;if(O<=z){const Z=L.length>0&&y===L[L.length-1].ref.current;a.style.bottom="0px";const K=c.clientHeight-g.offsetTop-g.offsetHeight,oe=Math.max($,W+(Z?ae:0)+K+ne),te=O+oe;a.style.height=te+"px"}else{const Z=L.length>0&&y===L[0].ref.current;a.style.top="0px";const oe=Math.max(z,q+g.offsetTop+(Z?Q:0)+W)+j;a.style.height=oe+"px",g.scrollTop=O-z+g.offsetTop}a.style.margin=`${ys}px 0`,a.style.minHeight=se+"px",a.style.maxHeight=I+"px",i==null||i(),requestAnimationFrame(()=>p.current=!0)}},[f,s.trigger,s.valueNode,a,c,g,y,v,s.dir,i]);hi(()=>w(),[w]);const[k,C]=x.useState();hi(()=>{c&&C(window.getComputedStyle(c).zIndex)},[c]);const E=x.useCallback(_=>{_&&m.current===!0&&(w(),b==null||b(),m.current=!1)},[w,b]);return h.jsx(Mce,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:p,onScrollButtonChange:E,children:h.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:k},children:h.jsx(it.div,{...r,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});eF.displayName=Pce;var Nce="SelectPopperPosition",Yk=x.forwardRef((t,e)=>{const{__scopeSelect:n,align:i="start",collisionPadding:r=ys,...s}=t,o=y1(n);return h.jsx(xA,{...o,...s,ref:e,align:i,collisionPadding:r,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Yk.displayName=Nce;var[Mce,CA]=Tf(cu,{}),Jk="SelectViewport",tF=x.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:i,...r}=t,s=tc(Jk,n),o=CA(Jk,n),a=St(e,s.onViewportChange),l=x.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),h.jsx(g1.Slot,{scope:n,children:h.jsx(it.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...r.style},onScroll:ke(r.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=o;if(f!=null&&f.current&&d){const p=Math.abs(l.current-u.scrollTop);if(p>0){const m=window.innerHeight-ys*2,g=parseFloat(d.style.minHeight),y=parseFloat(d.style.height),v=Math.max(g,y);if(v<m){const b=v+p,w=Math.min(m,b),k=b-w;d.style.height=w+"px",d.style.bottom==="0px"&&(u.scrollTop=k>0?k:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});tF.displayName=Jk;var nF="SelectGroup",[Rce,Ice]=Tf(nF),Tce=x.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=_f();return h.jsx(Rce,{scope:n,id:r,children:h.jsx(it.div,{role:"group","aria-labelledby":r,...i,ref:e})})});Tce.displayName=nF;var iF="SelectLabel",Oce=x.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=Ice(iF,n);return h.jsx(it.div,{id:r.id,...i,ref:e})});Oce.displayName=iF;var zy="SelectItem",[Lce,rF]=Tf(zy),sF=x.forwardRef((t,e)=>{const{__scopeSelect:n,value:i,disabled:r=!1,textValue:s,...o}=t,a=ec(zy,n),l=tc(zy,n),c=a.value===i,[u,d]=x.useState(s??""),[f,p]=x.useState(!1),m=St(e,b=>{var w;return(w=l.itemRefCallback)==null?void 0:w.call(l,b,i,r)}),g=_f(),y=x.useRef("touch"),v=()=>{r||(a.onValueChange(i),a.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(Lce,{scope:n,value:i,disabled:r,textId:g,isSelected:c,onItemTextChange:x.useCallback(b=>{d(w=>w||((b==null?void 0:b.textContent)??"").trim())},[]),children:h.jsx(g1.ItemSlot,{scope:n,value:i,disabled:r,textValue:u,children:h.jsx(it.div,{role:"option","aria-labelledby":g,"data-highlighted":f?"":void 0,"aria-selected":c&&f,"data-state":c?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...o,ref:m,onFocus:ke(o.onFocus,()=>p(!0)),onBlur:ke(o.onBlur,()=>p(!1)),onClick:ke(o.onClick,()=>{y.current!=="mouse"&&v()}),onPointerUp:ke(o.onPointerUp,()=>{y.current==="mouse"&&v()}),onPointerDown:ke(o.onPointerDown,b=>{y.current=b.pointerType}),onPointerMove:ke(o.onPointerMove,b=>{var w;y.current=b.pointerType,r?(w=l.onItemLeave)==null||w.call(l):y.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ke(o.onPointerLeave,b=>{var w;b.currentTarget===document.activeElement&&((w=l.onItemLeave)==null||w.call(l))}),onKeyDown:ke(o.onKeyDown,b=>{var k;((k=l.searchRef)==null?void 0:k.current)!==""&&b.key===" "||(bce.includes(b.key)&&v(),b.key===" "&&b.preventDefault())})})})})});sF.displayName=zy;var Th="SelectItemText",oF=x.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,...s}=t,o=ec(Th,n),a=tc(Th,n),l=rF(Th,n),c=kce(Th,n),[u,d]=x.useState(null),f=St(e,v=>d(v),l.onItemTextChange,v=>{var b;return(b=a.itemTextRefCallback)==null?void 0:b.call(a,v,l.value,l.disabled)}),p=u==null?void 0:u.textContent,m=x.useMemo(()=>h.jsx("option",{value:l.value,disabled:l.disabled,children:p},l.value),[l.disabled,l.value,p]),{onNativeOptionAdd:g,onNativeOptionRemove:y}=c;return hi(()=>(g(m),()=>y(m)),[g,y,m]),h.jsxs(h.Fragment,{children:[h.jsx(it.span,{id:l.textId,...s,ref:f}),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Jl.createPortal(s.children,o.valueNode):null]})});oF.displayName=Th;var aF="SelectItemIndicator",Dce=x.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return rF(aF,n).isSelected?h.jsx(it.span,{"aria-hidden":!0,...i,ref:e}):null});Dce.displayName=aF;var Zk="SelectScrollUpButton",jce=x.forwardRef((t,e)=>{const n=tc(Zk,t.__scopeSelect),i=CA(Zk,t.__scopeSelect),[r,s]=x.useState(!1),o=St(e,i.onScrollButtonChange);return hi(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollTop>0;s(c)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?h.jsx(lF,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});jce.displayName=Zk;var Qk="SelectScrollDownButton",Bce=x.forwardRef((t,e)=>{const n=tc(Qk,t.__scopeSelect),i=CA(Qk,t.__scopeSelect),[r,s]=x.useState(!1),o=St(e,i.onScrollButtonChange);return hi(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;s(u)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?h.jsx(lF,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});Bce.displayName=Qk;var lF=x.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:i,...r}=t,s=tc("SelectScrollButton",n),o=x.useRef(null),a=v1(n),l=x.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return x.useEffect(()=>()=>l(),[l]),hi(()=>{var u;const c=a().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[a]),h.jsx(it.div,{"aria-hidden":!0,...r,ref:e,style:{flexShrink:0,...r.style},onPointerDown:ke(r.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(i,50))}),onPointerMove:ke(r.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),o.current===null&&(o.current=window.setInterval(i,50))}),onPointerLeave:ke(r.onPointerLeave,()=>{l()})})}),$ce="SelectSeparator",Fce=x.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return h.jsx(it.div,{"aria-hidden":!0,...i,ref:e})});Fce.displayName=$ce;var eC="SelectArrow",zce=x.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=y1(n),s=ec(eC,n),o=tc(eC,n);return s.open&&o.position==="popper"?h.jsx(wA,{...r,...i,ref:e}):null});zce.displayName=eC;var Uce="SelectBubbleInput",cF=x.forwardRef(({__scopeSelect:t,value:e,...n},i)=>{const r=x.useRef(null),s=St(i,r),o=SA(e);return x.useEffect(()=>{const a=r.current;if(!a)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==e&&u){const d=new Event("change",{bubbles:!0});u.call(a,e),a.dispatchEvent(d)}},[o,e]),h.jsx(it.select,{...n,style:{...L$,...n.style},ref:s,defaultValue:e})});cF.displayName=Uce;function uF(t){return t===""||t===void 0}function dF(t){const e=Or(t),n=x.useRef(""),i=x.useRef(0),r=x.useCallback(o=>{const a=n.current+o;e(a),function l(c){n.current=c,window.clearTimeout(i.current),c!==""&&(i.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),s=x.useCallback(()=>{n.current="",window.clearTimeout(i.current)},[]);return x.useEffect(()=>()=>window.clearTimeout(i.current),[]),[n,r,s]}function fF(t,e,n){const r=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=Vce(t,Math.max(s,0));r.length===1&&(o=o.filter(c=>c!==n));const l=o.find(c=>c.textValue.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function Vce(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var Hce=H$,hF=G$,Wce=q$,Gce=K$,Xce=Y$,pF=J$,qce=tF,mF=sF,Kce=oF;const d0=Hce,f0=Wce,Oh=x.forwardRef(({className:t,children:e,...n},i)=>h.jsxs(hF,{ref:i,className:re("flex h-10 items-center justify-between rounded-md border border-stone-600 bg-stone-900 px-3 py-2 text-sm ring-offset-stone-800 placeholder:text-stone-500 focus:outline-none focus:ring-2 focus:ring-stone-600 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:[e,h.jsx(Gce,{asChild:!0,children:h.jsx("span",{className:"icon-[lucide--chevron-down] size-4 opacity-50"})})]}));Oh.displayName=hF.displayName;const Lh=x.forwardRef(({className:t,children:e,position:n="popper",...i},r)=>h.jsx(Xce,{children:h.jsx(pF,{ref:r,className:re("relative z-50 min-w-32 overflow-hidden rounded-md border border-stone-600 bg-stone-900 text-white shadow-md",t),position:n,...i,children:h.jsx(qce,{className:"p-1",children:e})})}));Lh.displayName=pF.displayName;const Ks=x.forwardRef(({className:t,children:e,...n},i)=>h.jsx(mF,{ref:i,className:re("w-full cursor-default select-none rounded-sm px-2 py-1.5 text-sm outline-none transition-colors duration-75 focus:bg-stone-800 focus:text-mantis-400 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:h.jsx(Kce,{children:e})}));Ks.displayName=mF.displayName;var gF=["PageUp","PageDown"],vF=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],yF={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Of="Slider",[tC,Yce,Jce]=Em(Of),[bF,Ive]=zs(Of,[Jce]),[Zce,b1]=bF(Of),xF=x.forwardRef((t,e)=>{const{name:n,min:i=0,max:r=100,step:s=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[i],value:u,onValueChange:d=()=>{},onValueCommit:f=()=>{},inverted:p=!1,form:m,...g}=t,y=x.useRef(new Set),v=x.useRef(0),w=o==="horizontal"?Qce:eue,[k=[],C]=Rl({prop:u,defaultProp:c,onChange:L=>{var G;(G=[...y.current][v.current])==null||G.focus(),d(L)}}),E=x.useRef(k);function _(L){const I=sue(k,L);T(L,I)}function M(L){T(L,v.current)}function R(){const L=E.current[v.current];k[v.current]!==L&&f(k)}function T(L,I,{commit:G}={commit:!1}){const B=cue(s),q=uue(Math.round((L-i)/s)*s+i,B),Y=Dy(q,[i,r]);C((ne=[])=>{const V=iue(ne,Y,I);if(lue(V,l*s)){v.current=V.indexOf(Y);const U=String(V)!==String(ne);return U&&G&&f(V),U?V:ne}else return ne})}return h.jsx(Zce,{scope:t.__scopeSlider,name:n,disabled:a,min:i,max:r,valueIndexToChangeRef:v,thumbs:y.current,values:k,orientation:o,form:m,children:h.jsx(tC.Provider,{scope:t.__scopeSlider,children:h.jsx(tC.Slot,{scope:t.__scopeSlider,children:h.jsx(w,{"aria-disabled":a,"data-disabled":a?"":void 0,...g,ref:e,onPointerDown:ke(g.onPointerDown,()=>{a||(E.current=k)}),min:i,max:r,inverted:p,onSlideStart:a?void 0:_,onSlideMove:a?void 0:M,onSlideEnd:a?void 0:R,onHomeKeyDown:()=>!a&&T(i,0,{commit:!0}),onEndKeyDown:()=>!a&&T(r,k.length-1,{commit:!0}),onStepKeyDown:({event:L,direction:I})=>{if(!a){const q=gF.includes(L.key)||L.shiftKey&&vF.includes(L.key)?10:1,Y=v.current,ne=k[Y],V=s*q*I;T(ne+V,Y,{commit:!0})}}})})})})});xF.displayName=Of;var[wF,SF]=bF(Of,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Qce=x.forwardRef((t,e)=>{const{min:n,max:i,dir:r,inverted:s,onSlideStart:o,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=t,[d,f]=x.useState(null),p=St(e,w=>f(w)),m=x.useRef(void 0),g=Pb(r),y=g==="ltr",v=y&&!s||!y&&s;function b(w){const k=m.current||d.getBoundingClientRect(),C=[0,k.width],_=_A(C,v?[n,i]:[i,n]);return m.current=k,_(w-k.left)}return h.jsx(wF,{scope:t.__scopeSlider,startEdge:v?"left":"right",endEdge:v?"right":"left",direction:v?1:-1,size:"width",children:h.jsx(kF,{dir:g,"data-orientation":"horizontal",...u,ref:p,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:w=>{const k=b(w.clientX);o==null||o(k)},onSlideMove:w=>{const k=b(w.clientX);a==null||a(k)},onSlideEnd:()=>{m.current=void 0,l==null||l()},onStepKeyDown:w=>{const C=yF[v?"from-left":"from-right"].includes(w.key);c==null||c({event:w,direction:C?-1:1})}})})}),eue=x.forwardRef((t,e)=>{const{min:n,max:i,inverted:r,onSlideStart:s,onSlideMove:o,onSlideEnd:a,onStepKeyDown:l,...c}=t,u=x.useRef(null),d=St(e,u),f=x.useRef(void 0),p=!r;function m(g){const y=f.current||u.current.getBoundingClientRect(),v=[0,y.height],w=_A(v,p?[i,n]:[n,i]);return f.current=y,w(g-y.top)}return h.jsx(wF,{scope:t.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:h.jsx(kF,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:g=>{const y=m(g.clientY);s==null||s(y)},onSlideMove:g=>{const y=m(g.clientY);o==null||o(y)},onSlideEnd:()=>{f.current=void 0,a==null||a()},onStepKeyDown:g=>{const v=yF[p?"from-bottom":"from-top"].includes(g.key);l==null||l({event:g,direction:v?-1:1})}})})}),kF=x.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:i,onSlideMove:r,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:l,...c}=t,u=b1(Of,n);return h.jsx(it.span,{...c,ref:e,onKeyDown:ke(t.onKeyDown,d=>{d.key==="Home"?(o(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):gF.concat(vF).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:ke(t.onPointerDown,d=>{const f=d.target;f.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(f)?f.focus():i(d)}),onPointerMove:ke(t.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&r(d)}),onPointerUp:ke(t.onPointerUp,d=>{const f=d.target;f.hasPointerCapture(d.pointerId)&&(f.releasePointerCapture(d.pointerId),s(d))})})}),CF="SliderTrack",_F=x.forwardRef((t,e)=>{const{__scopeSlider:n,...i}=t,r=b1(CF,n);return h.jsx(it.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...i,ref:e})});_F.displayName=CF;var nC="SliderRange",EF=x.forwardRef((t,e)=>{const{__scopeSlider:n,...i}=t,r=b1(nC,n),s=SF(nC,n),o=x.useRef(null),a=St(e,o),l=r.values.length,c=r.values.map(f=>NF(f,r.min,r.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return h.jsx(it.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...i,ref:a,style:{...t.style,[s.startEdge]:u+"%",[s.endEdge]:d+"%"}})});EF.displayName=nC;var iC="SliderThumb",AF=x.forwardRef((t,e)=>{const n=Yce(t.__scopeSlider),[i,r]=x.useState(null),s=St(e,a=>r(a)),o=x.useMemo(()=>i?n().findIndex(a=>a.ref.current===i):-1,[n,i]);return h.jsx(tue,{...t,ref:s,index:o})}),tue=x.forwardRef((t,e)=>{const{__scopeSlider:n,index:i,name:r,...s}=t,o=b1(iC,n),a=SF(iC,n),[l,c]=x.useState(null),u=St(e,b=>c(b)),d=l?o.form||!!l.closest("form"):!0,f=vA(l),p=o.values[i],m=p===void 0?0:NF(p,o.min,o.max),g=rue(i,o.values.length),y=f==null?void 0:f[a.size],v=y?oue(y,m,a.direction):0;return x.useEffect(()=>{if(l)return o.thumbs.add(l),()=>{o.thumbs.delete(l)}},[l,o.thumbs]),h.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${m}% + ${v}px)`},children:[h.jsx(tC.ItemSlot,{scope:t.__scopeSlider,children:h.jsx(it.span,{role:"slider","aria-label":t["aria-label"]||g,"aria-valuemin":o.min,"aria-valuenow":p,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...s,ref:u,style:p===void 0?{display:"none"}:t.style,onFocus:ke(t.onFocus,()=>{o.valueIndexToChangeRef.current=i})})}),d&&h.jsx(PF,{name:r??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:p},i)]})});AF.displayName=iC;var nue="RadioBubbleInput",PF=x.forwardRef(({__scopeSlider:t,value:e,...n},i)=>{const r=x.useRef(null),s=St(r,i),o=SA(e);return x.useEffect(()=>{const a=r.current;if(!a)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==e&&u){const d=new Event("input",{bubbles:!0});u.call(a,e),a.dispatchEvent(d)}},[o,e]),h.jsx(it.input,{style:{display:"none"},...n,ref:s,defaultValue:e})});PF.displayName=nue;function iue(t=[],e,n){const i=[...t];return i[n]=e,i.sort((r,s)=>r-s)}function NF(t,e,n){const s=100/(n-e)*(t-e);return Dy(s,[0,100])}function rue(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function sue(t,e){if(t.length===1)return 0;const n=t.map(r=>Math.abs(r-e)),i=Math.min(...n);return n.indexOf(i)}function oue(t,e,n){const i=t/2,s=_A([0,50],[0,i]);return(i-s(e)*n)*n}function aue(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function lue(t,e){if(e>0){const n=aue(t);return Math.min(...n)>=e}return!0}function _A(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const i=(e[1]-e[0])/(t[1]-t[0]);return e[0]+i*(n-t[0])}}function cue(t){return(String(t).split(".")[1]||"").length}function uue(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}var MF=xF,due=_F,fue=EF,hue=AF;const Ua=x.forwardRef(({className:t,...e},n)=>h.jsxs(MF,{ref:n,className:re("relative flex touch-none select-none items-center",t),...e,children:[h.jsx(due,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-stone-900",children:h.jsx(fue,{className:"absolute h-full bg-mantis-400"})}),h.jsx(hue,{className:"block size-5 rounded-full border-2 border-stone-900 bg-mantis-400 ring-offset-stone-800 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Ua.displayName=MF.displayName;var x1="Switch",[pue,Tve]=zs(x1),[mue,gue]=pue(x1),RF=x.forwardRef((t,e)=>{const{__scopeSwitch:n,name:i,checked:r,defaultChecked:s,required:o,disabled:a,value:l="on",onCheckedChange:c,form:u,...d}=t,[f,p]=x.useState(null),m=St(e,w=>p(w)),g=x.useRef(!1),y=f?u||!!f.closest("form"):!0,[v,b]=Rl({prop:r,defaultProp:s??!1,onChange:c,caller:x1});return h.jsxs(mue,{scope:n,checked:v,disabled:a,children:[h.jsx(it.button,{type:"button",role:"switch","aria-checked":v,"aria-required":o,"data-state":LF(v),"data-disabled":a?"":void 0,disabled:a,value:l,...d,ref:m,onClick:ke(t.onClick,w=>{b(k=>!k),y&&(g.current=w.isPropagationStopped(),g.current||w.stopPropagation())})}),y&&h.jsx(OF,{control:f,bubbles:!g.current,name:i,value:l,checked:v,required:o,disabled:a,form:u,style:{transform:"translateX(-100%)"}})]})});RF.displayName=x1;var IF="SwitchThumb",TF=x.forwardRef((t,e)=>{const{__scopeSwitch:n,...i}=t,r=gue(IF,n);return h.jsx(it.span,{"data-state":LF(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:e})});TF.displayName=IF;var vue="SwitchBubbleInput",OF=x.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:i=!0,...r},s)=>{const o=x.useRef(null),a=St(o,s),l=SA(n),c=vA(e);return x.useEffect(()=>{const u=o.current;if(!u)return;const d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&p){const m=new Event("click",{bubbles:i});p.call(u,n),u.dispatchEvent(m)}},[l,n,i]),h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...r,tabIndex:-1,ref:a,style:{...r.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});OF.displayName=vue;function LF(t){return t?"checked":"unchecked"}var DF=RF,yue=TF;const Va=x.forwardRef(({className:t,...e},n)=>h.jsx(DF,{className:re("peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-mantis-400 data-[state=unchecked]:bg-stone-900",t),...e,ref:n,children:h.jsx(yue,{className:re("pointer-events-none block size-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Va.displayName=DF.displayName;const w1=me(!1);function bue(t){return(1e3/t).toFixed(1)}function jF({className:t}){const e=un(),[n,i]=Oo();return h.jsxs("div",{className:re("overflow-auto scrollbar-stone-700",t),children:[h.jsxs("h3",{className:"flex items-center gap-2 border-b border-stone-600 py-2 pl-4 text-xl font-semibold",children:[h.jsx("span",{className:"icon-[lucide--settings] size-6"})," ",e("settings.title")]}),h.jsxs(Hi,{children:[h.jsxs(Wi,{children:[h.jsxs(Gi,{children:[h.jsx("span",{className:"icon-[lucide--rotate-3d] size-6"}),e("settings.animations.label")]}),h.jsx(Tu,{children:e("settings.animations.description")})]}),h.jsx(Va,{className:"ml-8",checked:n.animations,onCheckedChange:r=>{i(s=>({...s,animations:r})),r===!1&&XE()}})]}),h.jsxs(Hi,{children:[h.jsx(Wi,{children:h.jsxs(Gi,{children:[h.jsx("span",{className:"icon-[lucide--gauge] size-6"}),e("settings.speeds.executionUnit")]})}),h.jsx(Ua,{className:"w-44",...o3({value:Math.min(n.executionUnit,250),onValueChange:r=>i(s=>({...s,executionUnit:Math.min(r,250)})),min:250,max:1})})]}),h.jsx("hr",{className:"border-stone-600"}),h.jsxs(Hi,{children:[h.jsx(Wi,{children:h.jsx(Gi,{children:e("settings.instructionCycle.label")})}),h.jsx(Va,{className:"ml-8",checked:n.showInstructionCycle,onCheckedChange:r=>i(s=>({...s,showInstructionCycle:r}))})]}),h.jsxs(Hi,{children:[h.jsx(Wi,{children:h.jsx(Gi,{children:e("settings.statsCPU.label")})}),h.jsx(Va,{className:"ml-8",checked:n.showStatsCPU,onCheckedChange:r=>i(s=>({...s,showStatsCPU:r}))})]}),h.jsxs(Hi,{children:[h.jsxs(Wi,{children:[h.jsxs(Gi,{children:[h.jsx("span",{className:"icon-[lucide--cpu] size-6"}),"Velocidad CPU (Hz)"]}),h.jsxs(Tu,{children:[h.jsxs("span",{className:"font-medium text-stone-300",children:[n.cpuSpeed," Hz"]})," (",(1/n.cpuSpeed).toFixed(2),"s por ciclo)",n.cpuSpeed===1&&" - Muy lenta",n.cpuSpeed===2&&" - Lenta",n.cpuSpeed===4&&" - Normal",n.cpuSpeed===10&&" - Rápida"]})]}),h.jsxs("div",{className:"flex flex-col items-end gap-2",children:[h.jsx(Ua,{className:"w-44",value:[n.cpuSpeed===1?0:n.cpuSpeed===2?1:n.cpuSpeed===4?2:3],onValueChange:([r])=>{const s=[1,2,4,10];i(o=>({...o,cpuSpeed:s[r]}))},min:0,max:3,step:1}),h.jsxs("div",{className:"flex w-44 justify-between text-xs text-stone-500",children:[h.jsx("span",{children:"1 Hz"}),h.jsx("span",{children:"2 Hz"}),h.jsx("span",{children:"4 Hz"}),h.jsx("span",{children:"10 Hz"})]})]})]}),h.jsxs(Hi,{children:[h.jsxs(Wi,{children:[h.jsxs(Gi,{children:[h.jsx("span",{className:"icon-[lucide--flag] size-6"}),e("settings.flags.label")]}),h.jsx(Tu,{children:e("settings.flags.description")})]}),h.jsxs(d0,{value:n.flagsVisibility,onValueChange:r=>i(s=>({...s,flagsVisibility:r})),children:[h.jsx(Oh,{className:"w-32",children:h.jsx(f0,{})}),h.jsxs(Lh,{children:[h.jsx(Ks,{value:"CF_ZF",children:"C Z"}),h.jsx(Ks,{value:"SF_OF_CF_ZF",children:"S O C Z"})]})]})]}),h.jsx("hr",{className:"border-stone-600"}),h.jsx(Hi,{children:h.jsxs(Wi,{children:[h.jsxs(Gi,{children:[h.jsx("span",{className:"icon-[lucide--monitor-smartphone] size-6"}),e("settings.devices.label")]}),h.jsx(Tu,{children:e("settings.devices.description")})]})}),h.jsxs(Hi,{children:[h.jsx(Wi,{children:h.jsx(Gi,{children:e("settings.devices.keyboard-and-screen")})}),h.jsx(Va,{className:"ml-8",checked:n.devices.keyboardAndScreen,onCheckedChange:r=>i(s=>({...s,devices:{...s.devices,keyboardAndScreen:r}}))})]}),h.jsxs(Hi,{children:[h.jsxs(Wi,{children:[h.jsx(Gi,{children:e("settings.devices.pic.label")}),h.jsx(Tu,{children:e("settings.devices.pic.description")})]}),h.jsx(Va,{className:"ml-8",checked:n.devices.pic,onCheckedChange:r=>i(s=>({...s,devices:{...s.devices,pic:r}}))})]}),h.jsxs(Hi,{children:[h.jsx(Wi,{children:h.jsx(Gi,{children:e("settings.devices.pio.label")})}),h.jsxs(d0,{value:n.devices.pio??"null",onValueChange:r=>i(s=>({...s,devices:{...s.devices,pio:r==="null"?null:r,handshake:s.devices.handshake===r?null:s.devices.handshake}})),children:[h.jsx(Oh,{className:"w-52 min-w-[theme(width.52)]",children:h.jsx(f0,{})}),h.jsx(Lh,{children:eZ.filter(r=>r!=="printer").map(r=>h.jsx(Ks,{value:r,children:e(`settings.devices.pio.${r}`)},r))})]})]}),h.jsxs(Hi,{children:[h.jsx(Wi,{children:h.jsx(Gi,{children:e("settings.devices.handshake.label")})}),h.jsxs(d0,{value:n.devices.handshake??"null",onValueChange:r=>i(s=>({...s,devices:{...s.devices,handshake:r==="null"?null:r,pio:s.devices.pio===r?null:s.devices.pio}})),children:[h.jsx(Oh,{className:"w-52 min-w-[theme(width.52)]",children:h.jsx(f0,{})}),h.jsx(Lh,{children:tZ.map(r=>h.jsx(Ks,{value:r,children:e(`settings.devices.handshake.${r}`)},r))})]})]}),n.devices.handshake==="printer"&&h.jsxs(Hi,{children:[h.jsx(Wi,{children:h.jsxs(Gi,{children:[h.jsx("span",{className:"icon-[lucide--printer] size-6"}),e("settings.speeds.printerSpeed")]})}),h.jsx(Ua,{className:"w-44",...o3({value:n.printerSpeed,onValueChange:r=>i(s=>({...s,printerSpeed:r})),min:2e4,max:500})})]}),n.devices.pic&&h.jsxs(Hi,{children:[h.jsx(Wi,{children:h.jsxs(Gi,{children:[h.jsx("span",{className:"icon-[lucide--timer] size-6"}),"Frecuencia del Timer"]})}),h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsxs(d0,{value:n.clockSpeed.toString(),onValueChange:r=>i(s=>({...s,clockSpeed:parseInt(r)})),children:[h.jsx(Oh,{className:"w-40",children:h.jsx(f0,{})}),h.jsxs(Lh,{children:[h.jsx(Ks,{value:"100",title:"Timer muy frecuente - Interrupciones cada 0.1 segundos",children:h.jsxs("div",{className:"flex w-full items-center justify-between",children:[h.jsx("span",{children:"Muy Frecuente"}),h.jsx("span",{className:"text-xs text-stone-400",children:"0.1s"})]})}),h.jsx(Ks,{value:"400",title:"Timer frecuente - Interrupciones cada 0.4 segundos",children:h.jsxs("div",{className:"flex w-full items-center justify-between",children:[h.jsx("span",{children:"Frecuente"}),h.jsx("span",{className:"text-xs text-stone-400",children:"0.4s"})]})}),h.jsx(Ks,{value:"600",title:"Timer normal - Interrupciones cada 0.6 segundos",children:h.jsxs("div",{className:"flex w-full items-center justify-between",children:[h.jsx("span",{children:"Normal"}),h.jsx("span",{className:"text-xs text-stone-400",children:"0.6s"})]})}),h.jsx(Ks,{value:"800",title:"Timer lento - Interrupciones cada 0.8 segundos",children:h.jsxs("div",{className:"flex w-full items-center justify-between",children:[h.jsx("span",{children:"Lento"}),h.jsx("span",{className:"text-xs text-stone-400",children:"0.8s"})]})}),h.jsx(Ks,{value:"1000",title:"Timer muy lento - Interrupciones cada 1 segundo",children:h.jsxs("div",{className:"flex w-full items-center justify-between",children:[h.jsx("span",{children:"Muy Lento"}),h.jsx("span",{className:"text-xs text-stone-400",children:"1.0s"})]})})]})]}),h.jsxs("div",{className:"flex items-center gap-1 text-xs text-stone-400",children:[h.jsx("span",{className:"icon-[lucide--info] size-4"}),h.jsxs("span",{children:["Frecuencia: ",bue(n.clockSpeed)," Hz"]})]})]})]}),h.jsx("hr",{className:"border-stone-600"}),h.jsxs(Hi,{children:[h.jsxs(Wi,{children:[h.jsxs(Gi,{children:[h.jsx("span",{className:"icon-[lucide--contrast] size-6"}),e("settings.filters.label")]}),h.jsxs(Tu,{children:[e("settings.filters.description"),h.jsx("button",{className:"mt-1 block text-mantis-400 transition-colors hover:text-mantis-300",onClick:()=>i(r=>({...r,filterBightness:$u.filterBightness,filterContrast:$u.filterContrast,filterInvert:$u.filterInvert,filterSaturation:$u.filterSaturation})),children:e("settings.filters.revert")})]})]}),h.jsxs("div",{className:"ml-8 grid w-64 grid-cols-[min-content,auto] items-center gap-2",children:[h.jsx("span",{className:"text-xs",children:e("settings.filters.brightness")}),h.jsx(Ua,{value:[n.filterBightness],onValueChange:([r])=>i(s=>({...s,filterBightness:r})),min:0,max:5,step:.05}),h.jsx("span",{className:"text-xs",children:e("settings.filters.contrast")}),h.jsx(Ua,{value:[n.filterContrast],onValueChange:([r])=>i(s=>({...s,filterContrast:r})),min:0,max:5,step:.05}),h.jsx("span",{className:"text-xs",children:e("settings.filters.invert")}),h.jsx(Va,{checked:n.filterInvert,onCheckedChange:r=>i(s=>({...s,filterInvert:r}))}),h.jsx("span",{className:"text-xs",children:e("settings.filters.saturation")}),h.jsx(Ua,{value:[n.filterSaturation],onValueChange:([r])=>i(s=>({...s,filterSaturation:r})),min:0,max:5,step:.05})]})]}),h.jsx("hr",{className:"border-stone-600"}),h.jsx("div",{className:"flex justify-end p-4",children:h.jsxs("button",{className:"inline-flex items-center gap-1 text-sm text-red-500 transition-colors hover:text-red-400",onClick:()=>i(r=>({...$u,language:r.language,devices:r.devices})),children:[h.jsx("span",{className:"icon-[lucide--trash-2] size-4"}),e("settings.reset")]})})]})}function Hi({children:t}){return h.jsx("div",{className:"m-4 flex items-center justify-between gap-4",children:t})}function Wi({children:t}){return h.jsx("div",{className:"grow",children:t})}function Gi({children:t}){return h.jsx("p",{className:"flex items-center gap-2 font-medium",children:t})}function Tu({children:t}){return h.jsx("p",{className:"mt-1 text-xs text-stone-400",children:t})}function o3({value:t,onValueChange:e,min:n,max:i}){const r=Math.log(n),o=(Math.log(i)-r)/100;return{value:[(Math.log(t)-r)/o],onValueChange:a=>e(Math.exp(r+o*a[0])),min:0,max:100}}const xue=()=>({handleShowTour:x.useCallback(()=>{window.startWelcomeTour?window.startWelcomeTour():(localStorage.removeItem("vonsim8-tour-completed"),window.location.reload())},[])}),rC=x.memo(({status:t,isMobile:e,isCompact:n})=>{const i=rt(Wn),[r]=Oo(),[s,o]=x.useState(null),[a,l]=x.useState(!1),c=x.useMemo(()=>{switch(t.type){case"running":return"Ejecutando";case"paused":return"Pausado";default:return"Detenido"}},[t.type]),u=x.useMemo(()=>{switch(t.type){case"running":return"bg-green-600";case"paused":return"bg-yellow-600";default:return"bg-stone-600"}},[t.type]);x.useEffect(()=>{if(i&&i.phase&&i.phase!==s){o(i.phase),l(!0);const m=setTimeout(()=>{l(!1)},800);return()=>clearTimeout(m)}},[i,s]);const d=x.useMemo(()=>{if(!i||t.type!=="running"&&i.phase!=="halting"||!r.animations)return"";switch(i.phase){case"fetching":return"Captación";case"fetching-operands":return"Obtención de operandos";case"fetching-operands-completed":return"Operandos obtenidos";case"executing":return"Ejecución";case"writeback":return"Escritura";case"interrupt":return"Interrupción";case"int6":case"int7":return"Interrupción";case"halting":return"Detener CPU";default:return""}},[i,t.type,r.animations]),f=x.useMemo(()=>{if(!i||t.type!=="running"&&i.phase!=="halting")return"";switch(i.phase){case"fetching":return"bg-slate-800/70 text-blue-300 border-l-blue-400";case"fetching-operands":return"bg-slate-800/70 text-yellow-300 border-l-yellow-400";case"fetching-operands-completed":return"bg-slate-800/70 text-yellow-300 border-l-yellow-400";case"executing":return"bg-slate-800/70 text-green-300 border-l-green-400";case"writeback":return"bg-slate-800/70 text-purple-300 border-l-purple-400";case"interrupt":return"bg-slate-800/70 text-red-300 border-l-red-400";case"int6":case"int7":return"bg-slate-800/70 text-orange-300 border-l-orange-400";case"halting":return"bg-slate-800/70 text-red-300 border-l-red-400";default:return"bg-slate-800/70 text-stone-300 border-l-stone-400"}},[i,t.type]),p=x.useMemo(()=>{if(!a||!i)return"";switch(i.phase){case"fetching":return"animate-phase-pulse-blue";case"fetching-operands":return"animate-phase-pulse-yellow";case"fetching-operands-completed":return"animate-phase-pulse-yellow";case"executing":return"animate-phase-pulse-green";case"writeback":return"animate-phase-pulse-purple";case"interrupt":return"animate-phase-pulse-red";case"int6":case"int7":return"animate-phase-pulse-orange";case"halting":return"animate-phase-pulse-red";default:return"animate-phase-pulse-stone"}},[a,i]);return h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("div",{className:re("flex items-center gap-1.5 rounded-full px-2 py-1 font-medium text-white",u,t.type==="running"&&"animate-pulse-glow",e&&"px-1.5 py-0.5",n&&"px-1 py-0.5"),children:[h.jsx("div",{className:re("size-2 rounded-full",t.type==="running"?"bg-green-300":t.type==="paused"?"bg-yellow-300":"bg-stone-300")}),!e&&!n&&c]}),(t.type==="running"||i&&i.phase==="halting")&&d&&h.jsxs("div",{className:re("rounded-lg border-l-4 text-[10px] font-bold lowercase tracking-wide shadow-sm backdrop-blur-sm transition-all duration-300 ease-in-out",f,p,e?"flex min-h-[24px] items-center justify-center whitespace-nowrap px-3 py-1 text-[9px]":n?"flex min-h-[22px] items-center justify-center whitespace-nowrap px-2.5 py-1 text-[9px]":"px-3 py-1.5"),children:[d," "]})]})});rC.displayName="SimulationStatus";const BF=x.memo(({onShowTour:t,onToggleSettings:e,settingsOpen:n,onToggleEducational:i,educationalOpen:r})=>{const s=un();return h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(ss,{content:"Centro de aprendizaje",position:"bottom",children:h.jsx(K0,{icon:h.jsx(Qe,{icon:Rm,className:"size-4"}),onClick:i,variant:r?"secondary":"ghost",size:"md","aria-label":"Centro de aprendizaje",className:re("hover-lift",r&&"animate-pulse-glow"),"data-testid":"educational-button"})}),h.jsx(ss,{content:"Mostrar tour de bienvenida",position:"bottom",children:h.jsx(K0,{icon:h.jsx(Qe,{icon:nJ,className:"size-4"}),onClick:t,variant:"ghost",size:"md","aria-label":"Mostrar tour de bienvenida",className:"hover-lift"})}),h.jsx(ss,{content:s("settings.title"),position:"bottom",children:h.jsx(K0,{icon:h.jsx("span",{className:"icon-[lucide--settings] block size-5"}),onClick:e,variant:n?"secondary":"ghost",size:"md","aria-label":s("settings.title"),className:re("hover-lift",n&&"animate-pulse-glow"),"data-testid":"settings-button"})})]})});BF.displayName="ActionButtons";const $F=x.memo(()=>{const[t,e]=Pm(w1),[n,i]=x.useState(!1),[r,s]=x.useState(!1),{status:o}=Kn(),{handleShowTour:a}=xue(),[l,c]=x.useState("desktop");x.useEffect(()=>{const y=()=>{const v=window.innerWidth;v<=480?c("mobile"):v<=768?c("compact"):v<=1024?c("tablet"):c("desktop")};return y(),window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[]);const u=x.useCallback(()=>{e(y=>!y)},[e]),d=x.useCallback(()=>{i(y=>!y)},[]),f=x.useCallback(()=>{s(y=>!y)},[]),p=x.useMemo(()=>h.jsxs("div",{className:"hover-scale flex select-none items-center justify-center",children:[h.jsxs("div",{className:"group relative flex size-10 items-center justify-center overflow-hidden rounded-xl bg-gradient-to-br from-mantis-500 to-mantis-600 shadow-lg hover:scale-105",children:[h.jsx("div",{className:"absolute inset-0 opacity-10",children:h.jsx("div",{className:"size-full bg-[radial-gradient(circle_at_30%_30%,rgba(255,255,255,0.1)_1px,transparent_1px),radial-gradient(circle_at_70%_70%,rgba(255,255,255,0.1)_1px,transparent_1px)] bg-[length:8px_8px]"})}),h.jsx("div",{className:"relative z-10 flex items-center justify-center",children:h.jsx("span",{className:"text-lg font-bold tracking-tight text-white",children:"V8"})}),h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-white/10 to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),h.jsx("div",{className:"absolute -right-0.5 -top-0.5 size-2 animate-pulse rounded-full bg-mantis-300"})]}),h.jsxs("div",{className:"ml-3 flex flex-col",children:[h.jsxs("h1",{className:"text-lg font-bold max-sm:hidden",children:["Von",h.jsx("span",{className:"text-mantis-400",children:"Sim"}),"8"]}),h.jsx("span",{className:"text-xs text-stone-400 max-sm:hidden",children:"Simulador CPU 8-bit"})]})]}),[]),g=(()=>{switch(l){case"mobile":return{gridCols:"grid-cols-2",showStatusLeft:!0,showStatusCenter:!1,showActionButtons:!1,isCompact:!0,isMobile:!0};case"compact":return{gridCols:"grid-cols-3",showStatusLeft:!1,showStatusCenter:!0,showActionButtons:!1,isCompact:!0,isMobile:!1};case"tablet":return{gridCols:"grid-cols-3",showStatusLeft:!1,showStatusCenter:!0,showActionButtons:!0,isCompact:!1,isMobile:!1};case"desktop":return{gridCols:"grid-cols-3",showStatusLeft:!1,showStatusCenter:!0,showActionButtons:!0,isCompact:!1,isMobile:!1}}})();return h.jsxs(h.Fragment,{children:[h.jsx("header",{className:re("relative bg-black text-sm text-white",l==="mobile"?"header-mobile p-2":l==="compact"?"header-compact p-2":l==="tablet"?"header-tablet p-2":"p-2"),"data-testid":"header",children:h.jsxs("div",{className:re("grid items-center",g.gridCols),children:[h.jsxs("div",{className:"flex items-center gap-3",children:[p,g.showStatusLeft&&h.jsx(rC,{status:o,isMobile:g.isMobile,isCompact:g.isCompact})]}),g.showStatusCenter&&h.jsx("div",{className:"flex justify-center",children:h.jsx(rC,{status:o,isMobile:g.isMobile,isCompact:g.isCompact})}),h.jsxs("div",{className:"flex items-center justify-end gap-6",children:[h.jsx("div",{className:"flex justify-end",children:h.jsx(Goe,{})}),g.showActionButtons&&h.jsx(BF,{onShowTour:a,onToggleSettings:u,settingsOpen:t,onToggleEducational:d,educationalOpen:n})]})]})}),!g.isMobile&&n&&h.jsx(a$,{isOpen:n,onClose:()=>i(!1),onShowProgress:f}),!g.isMobile&&r&&h.jsx(l$,{isVisible:r,onClose:()=>s(!1)})]})});$F.displayName="Header";const wue=[{key:"F7",description:"Ejecutar un ciclo",category:"Simulación"},{key:"F8",description:"Ejecutar una instrucción completa",category:"Simulación"},{key:"F4",description:"Ejecución infinita",category:"Simulación"},{key:"F9",description:"Resetear simulación",category:"Simulación"},{key:"Espacio",description:"Pausar/Reanudar (cuando está ejecutando)",category:"Simulación"},{key:"Ctrl+S",description:"Guardar archivo",category:"Editor"},{key:"Ctrl+O",description:"Abrir archivo",category:"Editor"},{key:"Ctrl+N",description:"Nuevo archivo",category:"Editor"},{key:"Ctrl+Z",description:"Deshacer",category:"Editor"},{key:"Ctrl+Y",description:"Rehacer",category:"Editor"},{key:"Ctrl+F",description:"Buscar",category:"Editor"},{key:"Ctrl+H",description:"Reemplazar",category:"Editor"},{key:"Tab",description:"Indentar",category:"Editor"},{key:"Shift+Tab",description:"Desindentar",category:"Editor"},{key:"F1",description:"Mostrar atajos de teclado",category:"Navegación"},{key:"F2",description:"Abrir configuración",category:"Navegación"},{key:"F3",description:"Buscar en el código",category:"Navegación"},{key:"F5",description:"Actualizar página",category:"Navegación"},{key:"F6",description:"Cambiar foco al editor",category:"Navegación"},{key:"Escape",description:"Cerrar diálogos",category:"Interfaz"},{key:"Ctrl+Shift+P",description:"Paleta de comandos",category:"Interfaz"},{key:"Ctrl+B",description:"Mostrar/ocultar barra lateral",category:"Interfaz"},{key:"Ctrl+J",description:"Mostrar/ocultar terminal",category:"Interfaz"},{key:"Ctrl++",description:"Zoom in",category:"Vista"},{key:"Ctrl+-",description:"Zoom out",category:"Vista"},{key:"Ctrl+0",description:"Resetear zoom",category:"Vista"},{key:"Ctrl+Shift+Z",description:"Zoom a la selección",category:"Vista"},{key:"F12",description:"Herramientas de desarrollador",category:"Desarrollo"},{key:"Ctrl+Shift+I",description:"Inspeccionar elemento",category:"Desarrollo"},{key:"Ctrl+Shift+C",description:"Seleccionar elemento",category:"Desarrollo"},{key:"Ctrl+Shift+J",description:"Consola",category:"Desarrollo"},{key:"Ctrl+Shift+M",description:"Vista móvil",category:"Desarrollo"}],Sue=()=>{const[t,e]=x.useState(!1),n=x.useCallback(()=>{e(!0)},[]),i=x.useCallback(()=>{e(!1)},[]);return x.useEffect(()=>{const r=s=>{s.key==="F1"&&(s.preventDefault(),n())};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[n]),{isOpen:t,openModal:n,closeModal:i}},kue=()=>x.useMemo(()=>{const t=wue.reduce((e,n)=>(e[n.category]||(e[n.category]=[]),e[n.category].push(n),e),{});return Object.entries(t).sort(([e],[n])=>e.localeCompare(n))},[]),FF=x.memo(({shortcut:t})=>h.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-stone-800 p-3 transition-colors hover:bg-stone-700",children:[h.jsx("span",{className:"text-sm text-stone-300",children:t.description}),h.jsx("kbd",{className:"rounded border border-stone-600 bg-stone-700 px-2 py-1 font-mono text-xs text-white",children:t.key})]}));FF.displayName="ShortcutItem";const zF=x.memo(({category:t,shortcuts:e})=>h.jsxs("div",{className:"space-y-2",children:[h.jsx("h3",{className:"border-b border-stone-600 pb-2 text-lg font-semibold text-mantis-400",children:t}),h.jsx("div",{className:"space-y-2",children:e.map((n,i)=>h.jsx(FF,{shortcut:n},`${t}-${i}`))})]}));zF.displayName="ShortcutCategory";const UF=x.memo(()=>{const{isOpen:t,closeModal:e}=Sue(),n=kue(),i=x.useCallback(s=>{s.target===s.currentTarget&&e()},[e]),r=x.useCallback(s=>{s.key==="Escape"&&e()},[e]);return x.useEffect(()=>{if(t)return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[t,r]),t?h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:i,children:h.jsxs("div",{className:"max-h-[80vh] w-full max-w-4xl overflow-hidden rounded-lg border border-stone-600 bg-stone-900 shadow-xl",children:[h.jsxs("div",{className:"flex items-center justify-between border-b border-stone-600 p-4",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"icon-[lucide--keyboard] size-6 text-mantis-400"}),h.jsx("h2",{className:"text-xl font-semibold text-white",children:"Atajos de Teclado"})]}),h.jsx("button",{onClick:e,className:"rounded p-2 text-stone-400 transition-colors hover:text-white",children:h.jsx(Qe,{icon:$b,size:"lg"})})]}),h.jsx("div",{className:"max-h-[calc(80vh-80px)] overflow-y-auto p-4",children:h.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:n.map(([s,o])=>h.jsx(zF,{category:s,shortcuts:o},s))})}),h.jsx("div",{className:"border-t border-stone-600 bg-stone-800 p-4",children:h.jsxs("div",{className:"flex items-center justify-between text-sm text-stone-400",children:[h.jsxs("span",{children:["Presiona"," ",h.jsx("kbd",{className:"rounded border border-stone-600 bg-stone-700 px-1 py-0.5 font-mono text-xs",children:"F1"})," ","para abrir este diálogo"]}),h.jsx(At,{variant:"ghost",size:"sm",onClick:e,className:"text-stone-400 hover:text-white",children:"Cerrar"})]})})]})}):null});UF.displayName="KeyboardShortcuts";function Cue(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:s,onRegisterError:o}=t;let a,l;const c=async(d=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(a=await zp(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:d}},[]).then(({Workbox:d})=>new d("/VonSim8/sw.js",{scope:"/VonSim8/",type:"classic"})).catch(d=>{o==null||o(d)}),!a)return;a.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),a.addEventListener("installed",d=>{d.isUpdate||i==null||i()}),a.register({immediate:e}).then(d=>{s?s("/VonSim8/sw.js",d):r==null||r(d)}).catch(d=>{o==null||o(d)})}}return l=u(),c}const VF=()=>{const[t,e]=x.useState({available:!1,updating:!1,lastUpdate:null}),n=x.useRef(null);return x.useEffect(()=>{const i=Cue({onNeedRefresh(){e(a=>({...a,available:!0})),typeof window<"u"&&window.VonSimAddNotification&&window.VonSimAddNotification({type:"info",title:"Actualización disponible",message:"Una nueva versión está lista para instalar."})},onOfflineReady(){},onRegistered(a){console.log("Service Worker registrado:",a),a.waiting&&e(l=>({...l,available:!0}))},onRegisterError(a){console.error("Error al registrar Service Worker:",a)}});n.current=i;const r=async()=>{if(n.current){e(a=>({...a,updating:!0}));try{n.current(),e(a=>({...a,available:!1,updating:!1,lastUpdate:new Date}))}catch(a){console.error("Error al actualizar:",a),e(l=>({...l,updating:!1}))}}};window.updateVonSim8=r;const s=()=>{n.current&&n.current()};window.checkVonSim8Updates=s;const o=setInterval(s,5*60*1e3);return()=>{delete window.updateVonSim8,delete window.checkVonSim8Updates,clearInterval(o)}},[]),{updateInfo:t,updateApp:()=>{n.current&&n.current()},checkForUpdates:()=>{n.current&&n.current()}}},a3="vonsim8-commit-hash",_ue=5*60*1e3,HF=()=>{const[t,e]=x.useState({currentHash:"ac78f34",lastKnownHash:null,hasUpdate:!1,lastCheck:null}),n=x.useCallback(()=>{try{const s=localStorage.getItem(a3),o="ac78f34";return e(a=>({...a,currentHash:o,lastKnownHash:s,lastCheck:new Date})),s&&s!==o?(e(a=>({...a,hasUpdate:!0})),!0):!1}catch(s){return console.warn("Error checking version update:",s),!1}},[]),i=x.useCallback(()=>{try{localStorage.setItem(a3,"ac78f34")}catch(s){console.warn("Error saving version hash before reload:",s)}window.location.reload()},[]),r=x.useCallback(()=>{e(s=>({...s,hasUpdate:!1}))},[]);return x.useEffect(()=>{n()},[n]),x.useEffect(()=>{const s=setInterval(n,_ue);return()=>clearInterval(s)},[n]),x.useEffect(()=>{const s=()=>{document.hidden||n()};return document.addEventListener("visibilitychange",s),()=>{document.removeEventListener("visibilitychange",s)}},[n]),x.useEffect(()=>{const s=()=>{n()};return window.addEventListener("online",s),()=>{window.removeEventListener("online",s)}},[n]),{versionInfo:t,checkForVersionUpdate:n,updateToNewVersion:i,dismissUpdate:r}},WF=x.memo(()=>{const{updateInfo:t,updateApp:e}=VF(),{versionInfo:n,updateToNewVersion:i}=HF(),[r,s]=x.useState(!0),[o,a]=x.useState(!1),[l,c]=x.useState(!1),u=t.available||n.hasUpdate,d=x.useCallback(async()=>{a(!0);try{t.available?await e():n.hasUpdate&&i(),s(!1)}catch(p){console.error("Error al actualizar:",p)}finally{a(!1)}},[e,t.available,i,n.hasUpdate]),f=x.useCallback(()=>{c(!0),setTimeout(()=>{s(!1)},300)},[]);return!u||!r?null:h.jsxs("div",{className:re("fixed inset-x-0 top-0 z-50 transition-all duration-300 ease-out",l?"-translate-y-full opacity-0":"translate-y-0 opacity-100"),children:[h.jsx("div",{className:"border-b border-stone-700/50 bg-gradient-to-r from-stone-900/95 via-stone-800/95 to-stone-900/95 shadow-2xl backdrop-blur-md",children:h.jsx("div",{className:"mx-auto max-w-7xl p-4",children:h.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between sm:space-y-0",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs("div",{className:"relative shrink-0",children:[h.jsx("div",{className:"absolute inset-0 animate-ping rounded-full bg-mantis-500/20"}),h.jsx("div",{className:"relative rounded-full bg-gradient-to-br from-mantis-500 to-mantis-600 p-2 shadow-lg sm:p-3",children:h.jsx(Qe,{icon:J_,className:"size-4 animate-bounce text-white sm:size-5"})})]}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsxs("div",{className:"mb-1 flex flex-col space-y-1 sm:flex-row sm:items-center sm:space-x-2 sm:space-y-0",children:[h.jsx("h3",{className:"text-base font-bold text-white sm:text-lg",children:"Nueva versión disponible"}),h.jsxs("div",{className:"flex w-fit items-center space-x-1 rounded-full bg-mantis-500/20 px-2 py-1",children:[h.jsx(Qe,{icon:Ij,className:"size-3 text-mantis-400"}),h.jsx("span",{className:"text-xs font-medium text-mantis-300",children:"Actualización"})]})]}),h.jsx("p",{className:"text-xs leading-relaxed text-stone-300 sm:text-sm",children:"Hay una nueva versión de VonSim8 con mejoras y correcciones. Te recomendamos actualizar para obtener la mejor experiencia."})]})]}),h.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[h.jsx(At,{onClick:d,disabled:o,variant:"primary",size:"sm",className:re("relative overflow-hidden transition-all duration-300","bg-gradient-to-r from-mantis-600 to-mantis-700","hover:from-mantis-700 hover:to-mantis-800","shadow-lg hover:shadow-xl","border border-mantis-500/30","text-xs sm:text-sm",o&&"animate-pulse"),leftIcon:h.jsx(Qe,{icon:o?QY:oJ,className:re("size-3 transition-transform duration-200 sm:size-4",o&&"animate-spin")}),children:o?"Actualizando...":"Actualizar ahora"}),h.jsx(At,{onClick:f,variant:"ghost",size:"sm",className:"shrink-0 text-stone-400 transition-all duration-200 hover:bg-stone-700/50 hover:text-white","aria-label":"Cerrar banner de actualización",children:h.jsx(Qe,{icon:$b,className:"size-3 sm:size-4"})})]})]})})}),o&&h.jsx("div",{className:"h-1 animate-pulse bg-gradient-to-r from-mantis-500 to-mantis-600",children:h.jsx("div",{className:"animate-shimmer h-full bg-white/30"})})]})});WF.displayName="UpdateBanner";me(!1);const ap=[{id:"welcome",target:"app-container",title:"¡Bienvenido a VonSim8!",content:"Te acompañaré en un recorrido por las funciones principales de la plataforma. VonSim8 es un simulador de computadora de 8 bits que te permite programar en lenguaje ensamblador y ver cómo funciona internamente una computadora.",icon:qY,position:"top"},{id:"header",target:"header",title:"Barra de Navegación",content:"Aquí encontrarás el logo, el estado de la simulación, los controles principales y acceso a notificaciones, tour de ayuda y configuración.",icon:"icon-[lucide--navigation]",position:"bottom"},{id:"controls",target:"controls",title:"Controles de Simulación",content:"Controla la simulación: F7 (ejecutar ciclo), F8 (ejecutar instrucción), F4 (ejecución infinita), F9 (resetear). También puedes usar los botones visuales.",icon:"icon-[lucide--cpu]",position:"bottom"},{id:"editor-buttons",target:"panel-editor",title:"Editor de Código",content:"Aquí es donde escribirás tu código ensamblador. El editor tiene resaltado de sintaxis, autocompletado y validación en tiempo real. Usa los botones de arriba para crear, abrir, guardar y ensamblar tu programa.",icon:"icon-[lucide--file-terminal]",position:"right"},{id:"computer-view",target:"panel-computer",title:"Simulador de Computadora",content:"Aquí verás la computadora virtual con CPU, memoria RAM, registros, ALU, buses de datos y control, y todos los periféricos como pantalla, teclado, LEDs y switches.",icon:"icon-[lucide--monitor]",position:"left"},{id:"cpu-architecture",target:"cpu-component",title:"Arquitectura CPU",content:"Observa cómo la CPU ejecuta instrucciones paso a paso: fetch, decode, execute. Ve los valores en los registros, el contador de programa y el estado de las banderas.",icon:"icon-[lucide--microchip]",position:"left"},{id:"memory-ram",target:"memory-component",title:"Memoria RAM",content:"Explora la memoria RAM de 256 bytes. Ve cómo se almacenan datos e instrucciones, y cómo la CPU accede a diferentes direcciones de memoria. Cada celda muestra su dirección y valor en hexadecimal.",icon:"icon-[lucide--database]",position:"left"},{id:"settings-button",target:"settings-button",title:"Botón de Configuración",content:"Haz clic en este engranaje para acceder a las configuraciones avanzadas. Aquí podrás ajustar la velocidad de simulación, cambiar el tema visual, seleccionar el idioma y personalizar atajos de teclado.",icon:"icon-[lucide--settings]",position:"bottom"},{id:"settings-panel",target:"panel-settings",title:"Panel de Configuración",content:"En este panel encontrarás todas las opciones de configuración organizadas por categorías: simulación, interfaz, idioma y atajos de teclado. Los cambios se aplican automáticamente.",icon:"icon-[lucide--settings]",position:"left"},{id:"footer",target:"footer-links",title:"Recursos y Soporte",content:"Encuentra documentación completa, código fuente en GitHub, reporta bugs y accede a recursos de aprendizaje para dominar la programación en ensamblador.",icon:"icon-[lucide--help-circle]",position:"top"},{id:"final",target:"cycle-button",title:"¡Listo para Programar!",content:"Ya conoces las funciones principales de VonSim8. Comienza escribiendo código en el editor, ejecuta la simulación paso a paso con el botón 'Por Ciclo' y observa cómo funciona tu programa en la computadora virtual. ¡Disfruta programando!",icon:"icon-[lucide--rocket]",position:"bottom"}],Eue=()=>{const[t,e]=x.useState(0),[n,i]=x.useState(!1),[r,s]=x.useState(!0),[,o]=Pm(w1),a=x.useMemo(()=>t===ap.length-1,[t]),l=x.useMemo(()=>t===0,[t]),c=x.useCallback(()=>{i(!1),localStorage.setItem("vonsim8-tour-completed","true")},[]),u=x.useCallback(()=>{e(m=>Math.min(m+1,ap.length-1))},[]),d=x.useCallback(()=>{e(m=>Math.max(m-1,0))},[]),f=x.useCallback(()=>{c()},[c]),p=x.useCallback(()=>{i(!0),e(0)},[]);return x.useEffect(()=>{},[]),x.useEffect(()=>{const m=ap[t],g=()=>{const v=document.querySelector(`[data-testid="${m.target}"]`);s(!!v)};g();const y=setTimeout(g,100);return m.id==="settings-button"?o(!0):m.id!=="settings-panel"&&m.id!=="settings-button"&&o(!1),()=>clearTimeout(y)},[t,o]),{currentStep:t,isVisible:n,isLastStep:a,isFirstStep:l,handleNext:u,handlePrev:d,handleSkip:f,completeTour:c,startTour:p,targetFound:r}},Aue=t=>x.useMemo(()=>{const e=document.querySelector(`[data-testid="${t.target}"]`);if(!e)return null;const n=e.getBoundingClientRect(),i=window.innerWidth,r=window.innerHeight;if(t.id==="welcome"&&t.position==="top")return{positionStyles:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},highlightStyles:{top:0,left:0,width:"100vw",height:"100vh"}};if(t.id==="footer"){let m=n.top-200-60,g=n.right+20;const y="translateX(0)";m<40&&(m=40),m+200>r-100&&(m=Math.max(40,r/2-200/2)),g+320>i&&(g=i-320-20);const v={top:m,left:g,transform:y},b={top:n.top-2,left:n.left-2,width:n.width+4,height:n.height+4};return{positionStyles:v,highlightStyles:b}}let s,o,a;switch(t.position){case"top":s=n.top-20,o=n.left+n.width/2,a="translateX(-50%)";break;case"bottom":s=n.bottom+20,o=n.left+n.width/2,a="translateX(-50%)";break;case"left":s=n.top+n.height/2,o=n.left-20,a="translateY(-50%)";break;case"right":s=n.top+n.height/2,o=n.right+20,a="translateY(-50%)";break}const l=320,c=200;o+l/2>i?o=i-l/2-20:o-l/2<0&&(o=l/2+20),s+c>r?s=r-c-20:s<0&&(s=20);const u={top:s,left:o,transform:a},d={top:n.top-8,left:n.left-8,width:n.width+16,height:n.height+16};return{positionStyles:u,highlightStyles:d}},[t]),GF=x.memo(({current:t,total:e})=>h.jsx("div",{className:"mb-2 h-2 w-full overflow-hidden rounded-full bg-stone-700",children:h.jsx("div",{className:"h-full bg-mantis-500 transition-all duration-300",style:{width:`${(t+1)/e*100}%`}})}));GF.displayName="ProgressBar";const XF=x.memo(({step:t,currentStep:e,isLastStep:n,isFirstStep:i,onNext:r,onPrev:s,onSkip:o,onFinish:a,totalSteps:l,targetFound:c})=>{const u=Aue(t),d=x.useRef(null);x.useEffect(()=>{var g;(g=d.current)==null||g.focus()},[e]);const f="animate-fade-in";if(!c||!u)return h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:h.jsxs("div",{className:"max-w-sm rounded-lg border-2 border-mantis-400 bg-stone-900 p-8 text-center shadow-2xl",children:[h.jsx(Qe,{icon:gJ,className:"mb-4 text-4xl text-yellow-400"}),h.jsx("h3",{className:"mb-2 text-lg font-semibold text-mantis-400",children:"Elemento no encontrado"}),h.jsxs("p",{className:"mb-2 text-stone-300",children:["No se pudo encontrar el elemento:"," ",h.jsx("code",{className:"text-mantis-400",children:t.target})]}),h.jsxs("p",{className:"mb-4 text-xs text-stone-400",children:["Paso ",e+1," de ",l,": ",t.title]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(At,{onClick:s,disabled:i,variant:"outline",size:"sm",children:"Anterior"}),h.jsx(At,{onClick:o,className:"bg-mantis-600 hover:bg-mantis-700",children:"Saltar tour"})]})]})});const{positionStyles:p,highlightStyles:m}=u;return h.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",children:h.jsxs("div",{className:"relative size-full",children:[h.jsx("div",{className:"absolute rounded-lg border-2 border-mantis-400 bg-transparent shadow-2xl transition-all duration-300",style:m}),h.jsxs("div",{ref:d,tabIndex:-1,role:"dialog","aria-modal":"true",className:`absolute max-w-sm rounded-lg border border-mantis-400 bg-stone-900 p-6 text-white shadow-xl focus:outline-none ${f}`,style:p,children:[h.jsx(GF,{current:e,total:l}),h.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[t.icon&&(typeof t.icon=="string"?h.jsx("span",{className:`${t.icon} text-2xl text-mantis-400`}):h.jsx(Qe,{icon:t.icon,className:"text-2xl text-mantis-400"})),h.jsx("h3",{className:"text-lg font-semibold text-mantis-400",children:t.title})]}),h.jsx("p",{className:"mb-4 text-sm text-stone-300",children:t.content}),h.jsxs("div",{className:"mt-4 flex items-center justify-between gap-2",children:[h.jsx(At,{variant:"ghost",size:"sm",onClick:o,className:"text-stone-400 hover:text-white","aria-label":"Saltar tour",children:"Saltar"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs(At,{variant:"outline",size:"sm",onClick:s,disabled:i,className:"flex items-center gap-1","aria-label":"Anterior",children:[h.jsx(Qe,{icon:cJ}),"Anterior"]}),n?h.jsxs(At,{size:"sm",onClick:a,className:"flex items-center gap-1 bg-mantis-600 hover:bg-mantis-700","aria-label":"Finalizar",children:["Finalizar",h.jsx(Qe,{icon:Ij})]}):h.jsxs(At,{size:"sm",onClick:r,className:"flex items-center gap-1 bg-mantis-600 hover:bg-mantis-700","aria-label":"Siguiente",children:["Siguiente",h.jsx(Qe,{icon:uJ})]})]})]}),h.jsxs("div",{className:"mt-2 text-right text-xs text-stone-500",children:["Paso ",e+1," de ",l]}),h.jsx("button",{onClick:o,className:"absolute right-2 top-2 rounded p-1 text-stone-400 hover:text-white focus:outline-none","aria-label":"Cerrar",children:h.jsx(Qe,{icon:$b,size:"sm"})})]})]})})});XF.displayName="TourTooltip";const qF=x.memo(()=>{const{currentStep:t,isVisible:e,isLastStep:n,isFirstStep:i,handleNext:r,handlePrev:s,handleSkip:o,completeTour:a,startTour:l,targetFound:c}=Eue();x.useEffect(()=>(window.startWelcomeTour=l,()=>{delete window.startWelcomeTour}),[l]);const u=x.useMemo(()=>ap[t],[t]);return x.useEffect(()=>{if(!e)return;const d=f=>{f.key==="Escape"&&o(),f.key==="ArrowRight"&&r(),f.key==="ArrowLeft"&&s()};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[e,o,r,s]),!e||!u?null:h.jsx(XF,{step:u,currentStep:t,isLastStep:n,isFirstStep:i,onNext:r,onPrev:s,onSkip:o,onFinish:a,totalSteps:ap.length,targetFound:c})});qF.displayName="WelcomeTour";var Qr=function(t,e){return Number(t.toFixed(e))},Pue=function(t,e){return e},an=function(t,e,n){n&&typeof n=="function"&&n(t,e)},Nue=function(t){return-Math.cos(t*Math.PI)/2+.5},Mue=function(t){return t},Rue=function(t){return t*t},Iue=function(t){return t*(2-t)},Tue=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},Oue=function(t){return t*t*t},Lue=function(t){return--t*t*t+1},Due=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},jue=function(t){return t*t*t*t},Bue=function(t){return 1- --t*t*t*t},$ue=function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},Fue=function(t){return t*t*t*t*t},zue=function(t){return 1+--t*t*t*t*t},Uue=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},KF={easeOut:Nue,linear:Mue,easeInQuad:Rue,easeOutQuad:Iue,easeInOutQuad:Tue,easeInCubic:Oue,easeOutCubic:Lue,easeInOutCubic:Due,easeInQuart:jue,easeOutQuart:Bue,easeInOutQuart:$ue,easeInQuint:Fue,easeOutQuint:zue,easeInOutQuint:Uue},YF=function(t){typeof t=="number"&&cancelAnimationFrame(t)},Ps=function(t){t.mounted&&(YF(t.animation),t.animate=!1,t.animation=null,t.velocity=null)};function JF(t,e,n,i){if(t.mounted){var r=new Date().getTime(),s=1;Ps(t),t.animation=function(){if(!t.mounted)return YF(t.animation);var o=new Date().getTime()-r,a=o/n,l=KF[e],c=l(a);o>=n?(i(s),t.animation=null):t.animation&&(i(c),requestAnimationFrame(t.animation))},requestAnimationFrame(t.animation)}}function Vue(t){var e=t.scale,n=t.positionX,i=t.positionY;return!(Number.isNaN(e)||Number.isNaN(n)||Number.isNaN(i))}function nc(t,e,n,i){var r=Vue(e);if(!(!t.mounted||!r)){var s=t.setTransformState,o=t.transformState,a=o.scale,l=o.positionX,c=o.positionY,u=e.scale-a,d=e.positionX-l,f=e.positionY-c;n===0?s(e.scale,e.positionX,e.positionY):JF(t,i,n,function(p){var m=a+u*p,g=l+d*p,y=c+f*p;s(m,g,y)})}}function Hue(t,e,n){var i=t.offsetWidth,r=t.offsetHeight,s=e.offsetWidth,o=e.offsetHeight,a=s*n,l=o*n,c=i-a,u=r-l;return{wrapperWidth:i,wrapperHeight:r,newContentWidth:a,newDiffWidth:c,newContentHeight:l,newDiffHeight:u}}var Wue=function(t,e,n,i,r,s,o){var a=t>e?n*(o?1:.5):0,l=i>r?s*(o?1:.5):0,c=t-e-a,u=a,d=i-r-l,f=l;return{minPositionX:c,maxPositionX:u,minPositionY:d,maxPositionY:f}},EA=function(t,e){var n=t.wrapperComponent,i=t.contentComponent,r=t.setup.centerZoomedOut;if(!n||!i)throw new Error("Components are not mounted");var s=Hue(n,i,e),o=s.wrapperWidth,a=s.wrapperHeight,l=s.newContentWidth,c=s.newDiffWidth,u=s.newContentHeight,d=s.newDiffHeight,f=Wue(o,l,c,a,u,d,!!r);return f},sC=function(t,e,n,i){return i?t<e?Qr(e,2):t>n?Qr(n,2):Qr(t,2):Qr(t,2)},Uc=function(t,e){var n=EA(t,e);return t.bounds=n,n};function Hm(t,e,n,i,r,s,o){var a=n.minPositionX,l=n.minPositionY,c=n.maxPositionX,u=n.maxPositionY,d=0,f=0;o&&(d=r,f=s);var p=sC(t,a-d,c+d,i),m=sC(e,l-f,u+f,i);return{x:p,y:m}}function S1(t,e,n,i,r,s){var o=t.transformState,a=o.scale,l=o.positionX,c=o.positionY,u=i-a;if(typeof e!="number"||typeof n!="number")return console.error("Mouse X and Y position were not provided!"),{x:l,y:c};var d=l-e*u,f=c-n*u,p=Hm(d,f,r,s,0,0,null);return p}function Wm(t,e,n,i,r){var s=r?i:0,o=e-s;return!Number.isNaN(n)&&t>=n?n:!Number.isNaN(e)&&t<=o?o:t}var l3=function(t,e){var n=t.setup.panning.excluded,i=t.isInitialized,r=t.wrapperComponent,s=e.target,o="shadowRoot"in s&&"composedPath"in e,a=o?e.composedPath().some(function(u){return u instanceof Element?r==null?void 0:r.contains(u):!1}):r==null?void 0:r.contains(s),l=i&&s&&a;if(!l)return!1;var c=k1(s,n);return!c},c3=function(t){var e=t.isInitialized,n=t.isPanning,i=t.setup,r=i.panning.disabled,s=e&&n&&!r;return!!s},Gue=function(t,e){var n=t.transformState,i=n.positionX,r=n.positionY;t.isPanning=!0;var s=e.clientX,o=e.clientY;t.startCoords={x:s-i,y:o-r}},Xue=function(t,e){var n=e.touches,i=t.transformState,r=i.positionX,s=i.positionY;t.isPanning=!0;var o=n.length===1;if(o){var a=n[0].clientX,l=n[0].clientY;t.startCoords={x:a-r,y:l-s}}};function que(t){var e=t.transformState,n=e.positionX,i=e.positionY,r=e.scale,s=t.setup,o=s.disabled,a=s.limitToBounds,l=s.centerZoomedOut,c=t.wrapperComponent;if(!(o||!c||!t.bounds)){var u=t.bounds,d=u.maxPositionX,f=u.minPositionX,p=u.maxPositionY,m=u.minPositionY,g=n>d||n<f,y=i>p||i<m,v=n>d?c.offsetWidth:t.setup.minPositionX||0,b=i>p?c.offsetHeight:t.setup.minPositionY||0,w=S1(t,v,b,r,t.bounds,a||l),k=w.x,C=w.y;return{scale:r,positionX:g?k:n,positionY:y?C:i}}}function ZF(t,e,n,i,r){var s=t.setup.limitToBounds,o=t.wrapperComponent,a=t.bounds,l=t.transformState,c=l.scale,u=l.positionX,d=l.positionY;if(!(o===null||a===null||e===u&&n===d)){var f=Hm(e,n,a,s,i,r,o),p=f.x,m=f.y;t.setTransformState(c,p,m)}}var Kue=function(t,e,n){var i=t.startCoords,r=t.transformState,s=t.setup.panning,o=s.lockAxisX,a=s.lockAxisY,l=r.positionX,c=r.positionY;if(!i)return{x:l,y:c};var u=e-i.x,d=n-i.y,f=o?l:u,p=a?c:d;return{x:f,y:p}},Wl=function(t,e){var n=t.setup,i=t.transformState,r=i.scale,s=n.minScale,o=n.disablePadding;return e>0&&r>=s&&!o?e:0},Yue=function(t){var e=t.mounted,n=t.setup,i=n.disabled,r=n.velocityAnimation,s=t.transformState.scale,o=r.disabled,a=!o||s>1||!i||e;return!!a},Jue=function(t){var e=t.mounted,n=t.velocity,i=t.bounds,r=t.setup,s=r.disabled,o=r.velocityAnimation,a=t.transformState.scale,l=o.disabled,c=!l||a>1||!s||e;return!(!c||!n||!i)};function Zue(t,e){var n=t.setup.velocityAnimation,i=n.equalToMove,r=n.animationTime,s=n.sensitivity;return i?r*e*s:r}function u3(t,e,n,i,r,s,o,a,l,c){if(r){if(e>o&&n>o){var u=o+(t-o)*c;return u>l?l:u<o?o:u}if(e<s&&n<s){var u=s+(t-s)*c;return u<a?a:u>s?s:u}}return i?e:sC(t,s,o,r)}function Que(t,e){var n=1;return e?Math.min(n,t.offsetWidth/window.innerWidth):n}function ede(t,e){var n=Yue(t);if(n){var i=t.lastMousePosition,r=t.velocityTime,s=t.setup,o=t.wrapperComponent,a=s.velocityAnimation.equalToMove,l=Date.now();if(i&&r&&o){var c=Que(o,a),u=e.x-i.x,d=e.y-i.y,f=u/c,p=d/c,m=l-r,g=u*u+d*d,y=Math.sqrt(g)/m;t.velocity={velocityX:f,velocityY:p,total:y}}t.lastMousePosition=e,t.velocityTime=l}}function tde(t){var e=t.velocity,n=t.bounds,i=t.setup,r=t.wrapperComponent,s=Jue(t);if(!(!s||!e||!n||!r)){var o=e.velocityX,a=e.velocityY,l=e.total,c=n.maxPositionX,u=n.minPositionX,d=n.maxPositionY,f=n.minPositionY,p=i.limitToBounds,m=i.alignmentAnimation,g=i.zoomAnimation,y=i.panning,v=y.lockAxisY,b=y.lockAxisX,w=g.animationType,k=m.sizeX,C=m.sizeY,E=m.velocityAlignmentTime,_=E,M=Zue(t,l),R=Math.max(M,_),T=Wl(t,k),L=Wl(t,C),I=T*r.offsetWidth/100,G=L*r.offsetHeight/100,B=c+I,q=u-I,Y=d+G,ne=f-G,V=t.transformState,U=new Date().getTime();JF(t,w,R,function(se){var Ce=t.transformState,Q=Ce.scale,ae=Ce.positionX,z=Ce.positionY,$=new Date().getTime()-U,W=$/_,S=KF[m.animationType],O=1-S(Math.min(1,W)),j=1-se,D=ae+o*j,Z=z+a*j,K=u3(D,V.positionX,ae,b,p,u,c,q,B,O),oe=u3(Z,V.positionY,z,v,p,f,d,ne,Y,O);(ae!==D||z!==Z)&&t.setTransformState(Q,K,oe)})}}function d3(t,e){var n=t.transformState.scale;Ps(t),Uc(t,n),window.TouchEvent!==void 0&&e instanceof TouchEvent?Xue(t,e):Gue(t,e)}function AA(t,e){var n=t.transformState.scale,i=t.setup,r=i.minScale,s=i.alignmentAnimation,o=s.disabled,a=s.sizeX,l=s.sizeY,c=s.animationTime,u=s.animationType,d=o||n<r||!a&&!l;if(!d){var f=que(t);f&&nc(t,f,e??c,u)}}function f3(t,e,n){var i=t.startCoords,r=t.setup,s=r.alignmentAnimation,o=s.sizeX,a=s.sizeY;if(i){var l=Kue(t,e,n),c=l.x,u=l.y,d=Wl(t,o),f=Wl(t,a);ede(t,{x:c,y:u}),ZF(t,c,u,d,f)}}function nde(t){if(t.isPanning){var e=t.setup.panning.velocityDisabled,n=t.velocity,i=t.wrapperComponent,r=t.contentComponent;t.isPanning=!1,t.animate=!1,t.animation=null;var s=i==null?void 0:i.getBoundingClientRect(),o=r==null?void 0:r.getBoundingClientRect(),a=(s==null?void 0:s.width)||0,l=(s==null?void 0:s.height)||0,c=(o==null?void 0:o.width)||0,u=(o==null?void 0:o.height)||0,d=a<c||l<u,f=!e&&n&&(n==null?void 0:n.total)>.1&&d;f?tde(t):AA(t)}}function PA(t,e,n,i){var r=t.setup,s=r.minScale,o=r.maxScale,a=r.limitToBounds,l=Wm(Qr(e,2),s,o,0,!1),c=Uc(t,l),u=S1(t,n,i,l,c,a),d=u.x,f=u.y;return{scale:l,positionX:d,positionY:f}}function QF(t,e,n){var i=t.transformState.scale,r=t.wrapperComponent,s=t.setup,o=s.minScale,a=s.limitToBounds,l=s.zoomAnimation,c=l.disabled,u=l.animationTime,d=l.animationType,f=c||i>=o;if((i>=1||a)&&AA(t),!(f||!r||!t.mounted)){var p=e||r.offsetWidth/2,m=n||r.offsetHeight/2,g=PA(t,o,p,m);g&&nc(t,g,u,d)}}var El=function(){return El=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},El.apply(this,arguments)};function h3(t,e,n){for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}var h0={scale:1,positionX:0,positionY:0},sh={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},oC={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},ez=function(t){var e,n,i,r;return{previousScale:(e=t.initialScale)!==null&&e!==void 0?e:h0.scale,scale:(n=t.initialScale)!==null&&n!==void 0?n:h0.scale,positionX:(i=t.initialPositionX)!==null&&i!==void 0?i:h0.positionX,positionY:(r=t.initialPositionY)!==null&&r!==void 0?r:h0.positionY}},p3=function(t){var e=El({},sh);return Object.keys(t).forEach(function(n){var i=typeof t[n]<"u",r=typeof sh[n]<"u";if(r&&i){var s=Object.prototype.toString.call(sh[n]),o=s==="[object Object]",a=s==="[object Array]";o?e[n]=El(El({},sh[n]),t[n]):a?e[n]=h3(h3([],sh[n],!0),t[n]):e[n]=t[n]}}),e},tz=function(t,e,n){var i=t.transformState.scale,r=t.wrapperComponent,s=t.setup,o=s.maxScale,a=s.minScale,l=s.zoomAnimation,c=s.smooth,u=l.size;if(!r)throw new Error("Wrapper is not mounted");var d=c?i*Math.exp(e*n):i+e*n,f=Wm(Qr(d,3),a,o,u,!1);return f};function nz(t,e,n,i,r){var s=t.wrapperComponent,o=t.transformState,a=o.scale,l=o.positionX,c=o.positionY;if(!s)return console.error("No WrapperComponent found");var u=s.offsetWidth,d=s.offsetHeight,f=(u/2-l)/a,p=(d/2-c)/a,m=tz(t,e,n),g=PA(t,m,f,p);if(!g)return console.error("Error during zoom event. New transformation state was not calculated.");nc(t,g,i,r)}function iz(t,e,n,i){var r=t.setup,s=t.wrapperComponent,o=r.limitToBounds,a=ez(t.props),l=t.transformState,c=l.scale,u=l.positionX,d=l.positionY;if(s){var f=EA(t,a.scale),p=Hm(a.positionX,a.positionY,f,o,0,0,s),m={scale:a.scale,positionX:p.x,positionY:p.y};c===a.scale&&u===a.positionX&&d===a.positionY||(i==null||i(),nc(t,m,e,n))}}function ide(t,e,n,i){var r=t.getBoundingClientRect(),s=e.getBoundingClientRect(),o=n.getBoundingClientRect(),a=s.x*i.scale,l=s.y*i.scale;return{x:(r.x-o.x+a)/i.scale,y:(r.y-o.y+l)/i.scale}}function rde(t,e,n){var i=t.wrapperComponent,r=t.contentComponent,s=t.transformState,o=t.setup,a=o.limitToBounds,l=o.minScale,c=o.maxScale;if(!i||!r)return s;var u=i.getBoundingClientRect(),d=e.getBoundingClientRect(),f=ide(e,i,r,s),p=f.x,m=f.y,g=d.width/s.scale,y=d.height/s.scale,v=i.offsetWidth/g,b=i.offsetHeight/y,w=Wm(n||Math.min(v,b),l,c,0,!1),k=(u.width-g*w)/2,C=(u.height-y*w)/2,E=(u.left-p)*w+k,_=(u.top-m)*w+C,M=EA(t,w),R=Hm(E,_,M,a,0,0,i),T=R.x,L=R.y;return{positionX:T,positionY:L,scale:w}}var sde=function(t){return function(e,n,i){e===void 0&&(e=.5),n===void 0&&(n=300),i===void 0&&(i="easeOut"),nz(t,1,e,n,i)}},ode=function(t){return function(e,n,i){e===void 0&&(e=.5),n===void 0&&(n=300),i===void 0&&(i="easeOut"),nz(t,-1,e,n,i)}},ade=function(t){return function(e,n,i,r,s){r===void 0&&(r=300),s===void 0&&(s="easeOut");var o=t.transformState,a=o.positionX,l=o.positionY,c=o.scale,u=t.wrapperComponent,d=t.contentComponent,f=t.setup.disabled;if(!(f||!u||!d)){var p={positionX:Number.isNaN(e)?a:e,positionY:Number.isNaN(n)?l:n,scale:Number.isNaN(i)?c:i};nc(t,p,r,s)}}},lde=function(t){return function(e,n){e===void 0&&(e=200),n===void 0&&(n="easeOut"),iz(t,e,n)}},cde=function(t){return function(e,n,i){n===void 0&&(n=200),i===void 0&&(i="easeOut");var r=t.transformState,s=t.wrapperComponent,o=t.contentComponent;if(s&&o){var a=rz(e||r.scale,s,o);nc(t,a,n,i)}}},ude=function(t){return function(e,n,i,r){i===void 0&&(i=600),r===void 0&&(r="easeOut"),Ps(t);var s=t.wrapperComponent,o=typeof e=="string"?document.getElementById(e):e;if(s&&o&&s.contains(o)){var a=rde(t,o,n);nc(t,a,i,r)}}},aC=function(t){return{instance:t,zoomIn:sde(t),zoomOut:ode(t),setTransform:ade(t),resetTransform:lde(t),centerView:cde(t),zoomToElement:ude(t)}},dde=function(t){return{instance:t,state:t.transformState}},qt=function(t){var e={};return Object.assign(e,dde(t)),Object.assign(e,aC(t)),e},_w=!1;function Ew(){try{var t={get passive(){return _w=!0,!1}};return t}catch{return _w=!1,_w}}var p0=".".concat(oC.wrapperClass),k1=function(t,e){return e.some(function(n){return t.matches("".concat(p0," ").concat(n,", ").concat(p0," .").concat(n,", ").concat(p0," ").concat(n," *, ").concat(p0," .").concat(n," *"))})},lC=function(t){t&&clearTimeout(t)},fde=function(t,e,n){return"translate(".concat(t,"px, ").concat(e,"px) scale(").concat(n,")")},rz=function(t,e,n){var i=n.offsetWidth*t,r=n.offsetHeight*t,s=(e.offsetWidth-i)/2,o=(e.offsetHeight-r)/2;return{scale:t,positionX:s,positionY:o}};function hde(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var pde=function(t,e){var n=t.setup.wheel,i=n.disabled,r=n.wheelDisabled,s=n.touchPadDisabled,o=n.excluded,a=t.isInitialized,l=t.isPanning,c=e.target,u=a&&!l&&!i&&c;if(!u||r&&!e.ctrlKey||s&&e.ctrlKey)return!1;var d=k1(c,o);return!d},mde=function(t){return t?t.deltaY<0?1:-1:0};function gde(t,e){var n=mde(t),i=Pue(e,n);return i}function sz(t,e,n){var i=e.getBoundingClientRect(),r=0,s=0;if("clientX"in t)r=(t.clientX-i.left)/n,s=(t.clientY-i.top)/n;else{var o=t.touches[0];r=(o.clientX-i.left)/n,s=(o.clientY-i.top)/n}return(Number.isNaN(r)||Number.isNaN(s))&&console.error("No mouse or touch offset found"),{x:r,y:s}}var vde=function(t,e,n,i,r){var s=t.transformState.scale,o=t.wrapperComponent,a=t.setup,l=a.maxScale,c=a.minScale,u=a.zoomAnimation,d=a.disablePadding,f=u.size,p=u.disabled;if(!o)throw new Error("Wrapper is not mounted");var m=s+e*n,g=i?!1:!p,y=Wm(Qr(m,3),c,l,f,g&&!d);return y},yde=function(t,e){var n=t.previousWheelEvent,i=t.transformState.scale,r=t.setup,s=r.maxScale,o=r.minScale;return n?i<s||i>o||Math.sign(n.deltaY)!==Math.sign(e.deltaY)||n.deltaY>0&&n.deltaY<e.deltaY||n.deltaY<0&&n.deltaY>e.deltaY||Math.sign(n.deltaY)!==Math.sign(e.deltaY):!1},bde=function(t,e){var n=t.setup.pinch,i=n.disabled,r=n.excluded,s=t.isInitialized,o=e.target,a=s&&!i&&o;if(!a)return!1;var l=k1(o,r);return!l},xde=function(t){var e=t.setup.pinch.disabled,n=t.isInitialized,i=t.pinchStartDistance,r=n&&!e&&i;return!!r},wde=function(t,e,n){var i=n.getBoundingClientRect(),r=t.touches,s=Qr(r[0].clientX-i.left,5),o=Qr(r[0].clientY-i.top,5),a=Qr(r[1].clientX-i.left,5),l=Qr(r[1].clientY-i.top,5);return{x:(s+a)/2/e,y:(o+l)/2/e}},oz=function(t){return Math.sqrt(Math.pow(t.touches[0].pageX-t.touches[1].pageX,2)+Math.pow(t.touches[0].pageY-t.touches[1].pageY,2))},Sde=function(t,e){var n=t.pinchStartScale,i=t.pinchStartDistance,r=t.setup,s=r.maxScale,o=r.minScale,a=r.zoomAnimation,l=r.disablePadding,c=a.size,u=a.disabled;if(!n||i===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return t.transformState.scale;var d=e/i,f=d*n;return Wm(Qr(f,2),o,s,c,!u&&!l)},kde=160,Cde=100,_de=function(t,e){var n=t.props,i=n.onWheelStart,r=n.onZoomStart;t.wheelStopEventTimer||(Ps(t),an(qt(t),e,i),an(qt(t),e,r))},Ede=function(t,e){var n=t.props,i=n.onWheel,r=n.onZoom,s=t.contentComponent,o=t.setup,a=t.transformState,l=a.scale,c=o.limitToBounds,u=o.centerZoomedOut,d=o.zoomAnimation,f=o.wheel,p=o.disablePadding,m=o.smooth,g=d.size,y=d.disabled,v=f.step,b=f.smoothStep;if(!s)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var w=gde(e,null),k=m?b*Math.abs(e.deltaY):v,C=vde(t,w,k,!e.ctrlKey);if(l!==C){var E=Uc(t,C),_=sz(e,s,l),M=y||g===0||u||p,R=c&&M,T=S1(t,_.x,_.y,C,E,R),L=T.x,I=T.y;t.previousWheelEvent=e,t.setTransformState(C,L,I),an(qt(t),e,i),an(qt(t),e,r)}},Ade=function(t,e){var n=t.props,i=n.onWheelStop,r=n.onZoomStop;lC(t.wheelAnimationTimer),t.wheelAnimationTimer=setTimeout(function(){t.mounted&&(QF(t,e.x,e.y),t.wheelAnimationTimer=null)},Cde);var s=yde(t,e);s&&(lC(t.wheelStopEventTimer),t.wheelStopEventTimer=setTimeout(function(){t.mounted&&(t.wheelStopEventTimer=null,an(qt(t),e,i),an(qt(t),e,r))},kde))},az=function(t){for(var e=0,n=0,i=0;i<2;i+=1)e+=t.touches[i].clientX,n+=t.touches[i].clientY;var r=e/2,s=n/2;return{x:r,y:s}},Pde=function(t,e){var n=oz(e);t.pinchStartDistance=n,t.lastDistance=n,t.pinchStartScale=t.transformState.scale,t.isPanning=!1;var i=az(e);t.pinchLastCenterX=i.x,t.pinchLastCenterY=i.y,Ps(t)},Nde=function(t,e){var n=t.contentComponent,i=t.pinchStartDistance,r=t.wrapperComponent,s=t.transformState.scale,o=t.setup,a=o.limitToBounds,l=o.centerZoomedOut,c=o.zoomAnimation,u=o.alignmentAnimation,d=c.disabled,f=c.size;if(!(i===null||!n)){var p=wde(e,s,n);if(!(!Number.isFinite(p.x)||!Number.isFinite(p.y))){var m=oz(e),g=Sde(t,m),y=az(e),v=y.x-(t.pinchLastCenterX||0),b=y.y-(t.pinchLastCenterY||0);if(!(g===s&&v===0&&b===0)){t.pinchLastCenterX=y.x,t.pinchLastCenterY=y.y;var w=Uc(t,g),k=d||f===0||l,C=a&&k,E=S1(t,p.x,p.y,g,w,C),_=E.x,M=E.y;t.pinchMidpoint=p,t.lastDistance=m;var R=u.sizeX,T=u.sizeY,L=Wl(t,R),I=Wl(t,T),G=_+v,B=M+b,q=Hm(G,B,w,a,L,I,r),Y=q.x,ne=q.y;t.setTransformState(g,Y,ne)}}}},Mde=function(t){var e=t.pinchMidpoint;t.velocity=null,t.lastDistance=null,t.pinchMidpoint=null,t.pinchStartScale=null,t.pinchStartDistance=null,QF(t,e==null?void 0:e.x,e==null?void 0:e.y)},lz=function(t,e){var n=t.props.onZoomStop,i=t.setup.doubleClick.animationTime;lC(t.doubleClickStopEventTimer),t.doubleClickStopEventTimer=setTimeout(function(){t.doubleClickStopEventTimer=null,an(qt(t),e,n)},i)},Rde=function(t,e){var n=t.props,i=n.onZoomStart,r=n.onZoom,s=t.setup.doubleClick,o=s.animationTime,a=s.animationType;an(qt(t),e,i),iz(t,o,a,function(){return an(qt(t),e,r)}),lz(t,e)};function Ide(t,e){return t==="toggle"?e===1?1:-1:t==="zoomOut"?-1:1}function Tde(t,e){var n=t.setup,i=t.doubleClickStopEventTimer,r=t.transformState,s=t.contentComponent,o=r.scale,a=t.props,l=a.onZoomStart,c=a.onZoom,u=n.doubleClick,d=u.disabled,f=u.mode,p=u.step,m=u.animationTime,g=u.animationType;if(!d&&!i){if(f==="reset")return Rde(t,e);if(!s)return console.error("No ContentComponent found");var y=Ide(f,t.transformState.scale),v=tz(t,y,p);if(o!==v){an(qt(t),e,l);var b=sz(e,s,o),w=PA(t,v,b.x,b.y);if(!w)return console.error("Error during zoom event. New transformation state was not calculated.");an(qt(t),e,c),nc(t,w,m,g),lz(t,e)}}}var Ode=function(t,e){var n=t.isInitialized,i=t.setup,r=t.wrapperComponent,s=i.doubleClick,o=s.disabled,a=s.excluded,l=e.target,c=r==null?void 0:r.contains(l),u=n&&l&&c&&!o;if(!u)return!1;var d=k1(l,a);return!d},Lde=function(){function t(e){var n=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){n.initializeWindowEvents()},this.unmount=function(){n.cleanupWindowEvents()},this.update=function(i){n.props=i,Uc(n,n.transformState.scale),n.setup=p3(i)},this.initializeWindowEvents=function(){var i,r,s=Ew(),o=(i=n.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,a=o==null?void 0:o.defaultView;(r=n.wrapperComponent)===null||r===void 0||r.addEventListener("wheel",n.onWheelPanning,s),a==null||a.addEventListener("mousedown",n.onPanningStart,s),a==null||a.addEventListener("mousemove",n.onPanning,s),a==null||a.addEventListener("mouseup",n.onPanningStop,s),o==null||o.addEventListener("mouseleave",n.clearPanning,s),a==null||a.addEventListener("keyup",n.setKeyUnPressed,s),a==null||a.addEventListener("keydown",n.setKeyPressed,s)},this.cleanupWindowEvents=function(){var i,r,s=Ew(),o=(i=n.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,a=o==null?void 0:o.defaultView;a==null||a.removeEventListener("mousedown",n.onPanningStart,s),a==null||a.removeEventListener("mousemove",n.onPanning,s),a==null||a.removeEventListener("mouseup",n.onPanningStop,s),o==null||o.removeEventListener("mouseleave",n.clearPanning,s),a==null||a.removeEventListener("keyup",n.setKeyUnPressed,s),a==null||a.removeEventListener("keydown",n.setKeyPressed,s),document.removeEventListener("mouseleave",n.clearPanning,s),Ps(n),(r=n.observer)===null||r===void 0||r.disconnect()},this.handleInitializeWrapperEvents=function(i){var r=Ew();i.addEventListener("wheel",n.onWheelZoom,r),i.addEventListener("dblclick",n.onDoubleClick,r),i.addEventListener("touchstart",n.onTouchPanningStart,r),i.addEventListener("touchmove",n.onTouchPanning,r),i.addEventListener("touchend",n.onTouchPanningStop,r)},this.handleInitialize=function(i,r){var s=!1,o=n.setup.centerOnInit,a=function(l,c){for(var u=0,d=l;u<d.length;u++){var f=d[u];if(f.target===c)return!0}return!1};n.applyTransformation(),n.onInitCallbacks.forEach(function(l){l(qt(n))}),n.observer=new ResizeObserver(function(l){if(a(l,i)||a(l,r))if(o&&!s){var c=r.offsetWidth,u=r.offsetHeight;(c>0||u>0)&&(s=!0,n.setCenter())}else Ps(n),Uc(n,n.transformState.scale),AA(n,0)}),n.observer.observe(i),n.observer.observe(r)},this.onWheelZoom=function(i){var r=n.setup.disabled;if(!r){var s=pde(n,i);if(s){var o=n.isPressingKeys(n.setup.wheel.activationKeys);o&&(_de(n,i),Ede(n,i),Ade(n,i))}}},this.onWheelPanning=function(i){var r=n.setup,s=r.disabled,o=r.wheel,a=r.panning;if(!(!n.wrapperComponent||!n.contentComponent||s||!o.wheelDisabled||a.disabled||!a.wheelPanning||i.ctrlKey)){i.preventDefault(),i.stopPropagation();var l=n.transformState,c=l.positionX,u=l.positionY,d=c-i.deltaX,f=u-i.deltaY,p=a.lockAxisX?c:d,m=a.lockAxisY?u:f,g=n.setup.alignmentAnimation,y=g.sizeX,v=g.sizeY,b=Wl(n,y),w=Wl(n,v);p===c&&m===u||ZF(n,p,m,b,w)}},this.onPanningStart=function(i){var r=n.setup.disabled,s=n.props.onPanningStart;if(!r){var o=l3(n,i);if(o){var a=n.isPressingKeys(n.setup.panning.activationKeys);a&&(i.button===0&&!n.setup.panning.allowLeftClickPan||i.button===1&&!n.setup.panning.allowMiddleClickPan||i.button===2&&!n.setup.panning.allowRightClickPan||(i.preventDefault(),i.stopPropagation(),Ps(n),d3(n,i),an(qt(n),i,s)))}}},this.onPanning=function(i){var r=n.setup.disabled,s=n.props.onPanning;if(!r){var o=c3(n);if(o){var a=n.isPressingKeys(n.setup.panning.activationKeys);a&&(i.preventDefault(),i.stopPropagation(),f3(n,i.clientX,i.clientY),an(qt(n),i,s))}}},this.onPanningStop=function(i){var r=n.props.onPanningStop;n.isPanning&&(nde(n),an(qt(n),i,r))},this.onPinchStart=function(i){var r=n.setup.disabled,s=n.props,o=s.onPinchingStart,a=s.onZoomStart;if(!r){var l=bde(n,i);l&&(Pde(n,i),Ps(n),an(qt(n),i,o),an(qt(n),i,a))}},this.onPinch=function(i){var r=n.setup.disabled,s=n.props,o=s.onPinching,a=s.onZoom;if(!r){var l=xde(n);l&&(i.preventDefault(),i.stopPropagation(),Nde(n,i),an(qt(n),i,o),an(qt(n),i,a))}},this.onPinchStop=function(i){var r=n.props,s=r.onPinchingStop,o=r.onZoomStop;n.pinchStartScale&&(Mde(n),an(qt(n),i,s),an(qt(n),i,o))},this.onTouchPanningStart=function(i){var r=n.setup.disabled,s=n.props.onPanningStart;if(!r){var o=l3(n,i);if(o){var a=n.lastTouch&&+new Date-n.lastTouch<200&&i.touches.length===1;if(!a){n.lastTouch=+new Date,Ps(n);var l=i.touches,c=l.length===1,u=l.length===2;c&&(Ps(n),d3(n,i),an(qt(n),i,s)),u&&n.onPinchStart(i)}}}},this.onTouchPanning=function(i){var r=n.setup.disabled,s=n.props.onPanning;if(n.isPanning&&i.touches.length===1){if(r)return;var o=c3(n);if(!o)return;i.preventDefault(),i.stopPropagation();var a=i.touches[0];f3(n,a.clientX,a.clientY),an(qt(n),i,s)}else i.touches.length>1&&n.onPinch(i)},this.onTouchPanningStop=function(i){n.onPanningStop(i),n.onPinchStop(i)},this.onDoubleClick=function(i){var r=n.setup.disabled;if(!r){var s=Ode(n,i);s&&Tde(n,i)}},this.clearPanning=function(i){n.isPanning&&n.onPanningStop(i)},this.setKeyPressed=function(i){n.pressedKeys[i.key]=!0},this.setKeyUnPressed=function(i){n.pressedKeys[i.key]=!1},this.isPressingKeys=function(i){return i.length?!!i.find(function(r){return n.pressedKeys[r]}):!0},this.setTransformState=function(i,r,s){var o=n.props.onTransformed;if(!Number.isNaN(i)&&!Number.isNaN(r)&&!Number.isNaN(s)){i!==n.transformState.scale&&(n.transformState.previousScale=n.transformState.scale,n.transformState.scale=i),n.transformState.positionX=r,n.transformState.positionY=s,n.applyTransformation();var a=qt(n);n.onChangeCallbacks.forEach(function(l){return l(a)}),an(a,{scale:i,positionX:r,positionY:s},o)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(n.wrapperComponent&&n.contentComponent){var i=rz(n.transformState.scale,n.wrapperComponent,n.contentComponent);n.setTransformState(i.scale,i.positionX,i.positionY)}},this.handleTransformStyles=function(i,r,s){return n.props.customTransform?n.props.customTransform(i,r,s):fde(i,r,s)},this.applyTransformation=function(){if(!(!n.mounted||!n.contentComponent)){var i=n.transformState,r=i.scale,s=i.positionX,o=i.positionY,a=n.handleTransformStyles(s,o,r);n.contentComponent.style.transform=a}},this.getContext=function(){return qt(n)},this.onChange=function(i){return n.onChangeCallbacks.has(i)||n.onChangeCallbacks.add(i),function(){n.onChangeCallbacks.delete(i)}},this.onInit=function(i){return n.onInitCallbacks.has(i)||n.onInitCallbacks.add(i),function(){n.onInitCallbacks.delete(i)}},this.init=function(i,r){n.cleanupWindowEvents(),n.wrapperComponent=i,n.contentComponent=r,Uc(n,n.transformState.scale),n.handleInitializeWrapperEvents(i),n.handleInitialize(i,r),n.initializeWindowEvents(),n.isInitialized=!0;var s=qt(n);an(s,void 0,n.props.onInit)},this.props=e,this.setup=p3(this.props),this.transformState=ez(this.props)}return t}(),NA=en.createContext(null),Dde=function(t,e){return typeof t=="function"?t(e):t},jde=en.forwardRef(function(t,e){var n=x.useRef(new Lde(t)).current,i=Dde(t.children,aC(n));return x.useImperativeHandle(e,function(){return aC(n)},[n]),x.useEffect(function(){n.update(t)},[n,t]),en.createElement(NA.Provider,{value:n},i)});en.forwardRef(function(t,e){var n=x.useRef(null),i=x.useContext(NA);return x.useEffect(function(){return i.onChange(function(r){if(n.current){var s=0,o=0;n.current.style.transform=i.handleTransformStyles(s,o,1/r.instance.transformState.scale)}})},[i]),en.createElement("div",El({},t,{ref:hde([n,e])}))});function Bde(t,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n==="top"&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}var $de=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,m3={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};Bde($de);var Fde=function(t){var e=t.children,n=t.wrapperClass,i=n===void 0?"":n,r=t.contentClass,s=r===void 0?"":r,o=t.wrapperStyle,a=t.contentStyle,l=t.wrapperProps,c=l===void 0?{}:l,u=t.contentProps,d=u===void 0?{}:u,f=x.useContext(NA),p=f.init,m=f.cleanupWindowEvents,g=x.useRef(null),y=x.useRef(null);return x.useEffect(function(){var v=g.current,b=y.current;return v!==null&&b!==null&&p&&(p==null||p(v,b)),function(){m==null||m()}},[]),en.createElement("div",El({},c,{ref:g,className:"".concat(oC.wrapperClass," ").concat(m3.wrapper," ").concat(i),style:o}),en.createElement("div",El({},d,{ref:y,className:"".concat(oC.contentClass," ").concat(m3.content," ").concat(s),style:a}),e))};function zde({wrapperRef:t}){const e=un();return h.jsxs("div",{className:"absolute right-2 top-2 flex flex-col rounded-lg border border-stone-600 bg-stone-900 shadow",children:[h.jsx("button",{className:"m-0.5 flex size-8 items-center justify-center rounded-t-lg text-white transition-colors hover:enabled:bg-stone-800",onClick:()=>{var n;return(n=t.current)==null?void 0:n.zoomIn()},title:e("control.zoom.in"),children:h.jsx("span",{className:"size-4",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),h.jsx("hr",{className:"border-stone-600"}),h.jsx("button",{className:"m-0.5 flex size-8 items-center justify-center rounded-b-lg text-white transition-colors hover:enabled:bg-stone-800",onClick:()=>{var n;return(n=t.current)==null?void 0:n.zoomOut()},title:e("control.zoom.out"),children:h.jsx("span",{className:"size-4",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})})})})]})}function g3(t){switch(t){case"Captación":return"text-blue-300 bg-gradient-to-r from-blue-500/10 to-cyan-500/10";case"Obtención de operandos":return"text-yellow-300 bg-gradient-to-r from-yellow-500/10 to-orange-500/10";case"Ejecución":return"text-green-300 bg-gradient-to-r from-green-500/10 to-emerald-500/10";case"Escritura":return"text-purple-300 bg-gradient-to-r from-purple-500/10 to-violet-500/10";default:return"text-stone-300 bg-gradient-to-r from-stone-500/10 to-gray-500/10"}}function Ude(t,e){if(t==="Ejecución")return/obten/i.test(e)||/operando/i.test(e)||/leer/i.test(e)||/cargar/i.test(e)?"text-yellow-300 bg-yellow-500/5 border-yellow-400/30 shadow-yellow-400/20":/escrib/i.test(e)||/guardar/i.test(e)||/almacenar/i.test(e)||/resultado/i.test(e)?"text-purple-300 bg-purple-500/5 border-purple-400/30 shadow-purple-400/20":(/procesar/i.test(e)||/alu/i.test(e)||/calcular/i.test(e)||/operar/i.test(e)||/ejecut/i.test(e),"text-green-300 bg-green-500/5 border-green-400/30 shadow-green-400/20");switch(t){case"Captación":return"text-blue-300 bg-blue-500/5 border-blue-400/30 shadow-blue-400/20";case"Obtención de operandos":return"text-yellow-300 bg-yellow-500/5 border-yellow-400/30 shadow-yellow-400/20";case"Escritura":return"text-purple-300 bg-purple-500/5 border-purple-400/30 shadow-purple-400/20";default:return"text-stone-300 bg-stone-500/5 border-stone-400/30 shadow-stone-400/20"}}function Vde(t,e=!1){const n=(()=>{switch(t){case"Captación":return"📥";case"Obtención de operandos":return"🔍";case"Ejecución":return"⚡";case"Escritura":return"💾";case"Interrupción":return"🚨";default:return"⚙️"}})();return e?h.jsx("span",{className:"inline-block animate-bounce",children:n}):n}function Hde(t,e){if(!t)return"";switch(e){case"Captación":return"ring-2 ring-blue-400/50 ring-offset-2 ring-offset-stone-800";case"Obtención de operandos":return"ring-2 ring-yellow-400/50 ring-offset-2 ring-offset-stone-800";case"Ejecución":return"ring-2 ring-green-400/50 ring-offset-2 ring-offset-stone-800";case"Escritura":return"ring-2 ring-purple-400/50 ring-offset-2 ring-offset-stone-800";default:return"ring-2 ring-stone-400/50 ring-offset-2 ring-offset-stone-800"}}function Wde(t,e){return t==="Captación"?"text-blue-400":t==="Ejecución"?/obten/i.test(e)||/operando/i.test(e)||/leer/i.test(e)||/cargar/i.test(e)?"text-yellow-400":/escrib/i.test(e)||/guardar/i.test(e)||/almacenar/i.test(e)||/resultado/i.test(e)?"text-purple-400":(/procesar/i.test(e)||/alu/i.test(e)||/calcular/i.test(e)||/operar/i.test(e)||/ejecut/i.test(e),"text-green-400"):t==="Escritura"?"text-purple-400":t==="Obtención de operandos"?"text-yellow-400":"text-stone-400"}function Gde(){const t=rt(We),e=rt(ws),n=rt(jt),i=rt(em),{devices:r}=Kn(),[s]=Oo(),o=x.useRef(null),a=(l,c)=>{const[u,...d]=l.split(":"),f=d.join(":").trim();return{cycle:c,stage:u.trim(),action:f}};return x.useEffect(()=>{if(t){const l=A.get(It),c=a(t,l);A.set(ws,u=>{const d=u[u.length-1];return d&&d.cycle===l&&d.action===c.action?u:[...u,c]})}},[t]),x.useEffect(()=>{const l=A.sub(It,()=>{const c=A.get(It),u=A.get(We);if(u&&c>0){const d=a(u,c);A.set(Fu,{canAnimate:!1,pendingMessage:u}),A.set(ws,f=>{const p=f[f.length-1];return p&&p.cycle===c&&p.action===d.action?f:[...f,d]}),setTimeout(()=>{A.set(Fu,{canAnimate:!0,pendingMessage:null})},100)}if(c===0){const d=A.get(go);console.log("🔄 Cycle count reset to 0, isHaltExecution:",d,"current history length:",A.get(ws).length),d?console.log("⚠️ NOT clearing message history (HLT execution detected)"):(console.log("✅ Clearing message history (not HLT execution)"),A.set(ws,[]),A.set(Fu,{canAnimate:!0,pendingMessage:null}))}});return()=>{l()}},[]),x.useEffect(()=>{const l=A.sub(jt,()=>{A.get(jt).type==="stopped"&&(A.get(go)?console.log("⚠️ Simulation stopped, preserving message history (HLT execution detected)"):(console.log("✅ Simulation stopped, clearing message history (not HLT execution)"),A.set(ws,[]),A.set(Fu,{canAnimate:!0,pendingMessage:null})))});return()=>{l()}},[]),x.useEffect(()=>{n.type==="running"&&i&&bi({title:"El programa ha sido modificado",description:"La ejecución se reiniciará desde el principio para aplicar los cambios.",variant:"info"})},[n,i]),x.useEffect(()=>{const l=A.sub(jl,()=>{const c=A.get(jl),u=A.get(jt);if(c===0&&u.type==="running"){const d=A.get(go);console.log("🔄 Instruction count reset to 0 with running simulation, isHaltExecution:",d,"current history length:",A.get(ws).length),d?console.log("⚠️ NOT clearing message history (HLT execution detected during instruction count reset)"):(console.log("✅ Clearing message history (instruction count reset, not HLT)"),A.set(ws,[]),A.set(Fu,{canAnimate:!0,pendingMessage:null}),A.set(go,!1))}});return()=>{l()}},[]),x.useEffect(()=>{const l=o.current;l&&(l.scrollTop=l.scrollHeight)},[e]),!s.showInstructionCycle||r.pic?null:h.jsx("div",{className:"absolute left-[20px] top-[520px] z-10 h-min w-[420px]",children:h.jsxs("div",{className:"rounded-xl border-2 border-stone-400/50 bg-gradient-to-br from-stone-800 to-stone-900 shadow-2xl backdrop-blur-sm",children:[h.jsx("div",{className:"rounded-t-xl border-b-2 border-stone-600/50 bg-gradient-to-r from-stone-700 to-stone-800 px-4 py-3",children:h.jsx("div",{className:"flex items-center justify-between",children:h.jsx("div",{className:"flex items-center gap-3",children:h.jsx("div",{children:h.jsx("span",{className:"text-sm font-bold uppercase tracking-wide text-mantis-400",children:"Ciclo de instrucción"})})})})}),h.jsxs("div",{ref:o,className:"scrollbar-thin max-h-80 overflow-y-auto p-4",children:[e.map((l,c)=>{const u=c===0||e[c-1].stage!==l.stage,d=c===e.length-1;return h.jsxs("div",{className:`transition-all duration-300 ease-in-out ${l.stage==="Captación"||l.stage==="Ejecución"?"mb-1":"mb-3"}`,children:[u&&h.jsx("div",{className:"animate-fade-in mb-2",children:h.jsxs("div",{className:`flex items-center gap-3 rounded-lg border border-stone-600/30 bg-gradient-to-r from-stone-800/60 to-stone-900/60 px-4 py-2.5 shadow-md backdrop-blur-sm ${g3(l.stage)}`,children:[h.jsxs("div",{className:"relative",children:[h.jsx("span",{className:"text-lg",children:Vde(l.stage,d)}),d&&h.jsx("div",{className:"absolute -right-0.5 -top-0.5 size-2.5 rounded-full bg-green-400 shadow-sm ring-1 ring-green-300/50"})]}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsx("h4",{className:`truncate text-sm font-bold tracking-wide ${g3(l.stage).split(" ")[0]}`,children:l.stage}),h.jsxs("p",{className:"mt-0.5 text-xs leading-tight text-stone-400",children:[l.stage==="Captación"&&"Leer instrucción desde memoria",l.stage==="Obtención de operandos"&&"Preparar datos necesarios",l.stage==="Ejecución"&&"Procesar instrucción",l.stage==="Escritura"&&"Guardar resultado final",l.stage==="Interrupción"&&"Manejar interrupción"]})]})]})}),l.stage==="Interrupción"?h.jsx("div",{className:`rounded-xl border-l-4 border-red-400 bg-gradient-to-r from-red-900/30 to-red-800/20 p-4 shadow-lg transition-all duration-300 ${d?"ring-2 ring-red-400/50 ring-offset-2 ring-offset-stone-800":""}`,children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"text-lg",children:"🚨"}),h.jsx("span",{className:"text-sm font-medium text-red-300",children:l.action})]})}):l.stage==="Captación"?h.jsxs("div",{className:`ml-8 flex items-center gap-3 rounded-lg border-l-2 border-blue-400/30 bg-gradient-to-r from-blue-900/20 to-blue-800/10 py-2 pl-4 pr-3 transition-all duration-200 hover:bg-blue-800/20 ${d?"ring-1 ring-blue-400/50":""}`,children:[h.jsx("div",{className:`flex size-6 items-center justify-center rounded-full text-xs font-bold transition-all duration-300 ${d?"bg-blue-600 shadow-md shadow-blue-400/30 ring-1 ring-blue-400/50":"bg-blue-700/80"} text-white`,children:l.cycle}),h.jsx("div",{className:"flex-1",children:h.jsx("span",{className:"text-xs font-medium text-blue-200/90",children:l.action})}),d&&h.jsx("div",{className:"size-1.5 rounded-full bg-blue-300 shadow-sm shadow-blue-400/30"})]}):l.stage==="Ejecución"?h.jsxs("div",{className:`ml-8 flex items-center gap-3 rounded-lg border-l-2 border-green-400/30 bg-gradient-to-r from-green-900/20 to-green-800/10 py-2 pl-4 pr-3 transition-all duration-200 hover:bg-green-800/20 ${d?"ring-1 ring-green-400/50":""}`,children:[h.jsx("div",{className:`flex size-6 items-center justify-center rounded-full text-xs font-bold transition-all duration-300 ${d?"bg-green-600 shadow-md shadow-green-400/30 ring-1 ring-green-400/50":"bg-green-700/80"} text-white`,children:l.cycle}),h.jsx("div",{className:"flex-1",children:h.jsx("span",{className:"text-xs font-medium text-green-200/90",children:l.action})}),d&&h.jsx("div",{className:"size-1.5 rounded-full bg-green-300 shadow-sm shadow-green-400/30"})]}):h.jsxs("div",{className:`flex items-center gap-3 rounded-xl border border-stone-600/50 bg-gradient-to-r from-stone-800/80 to-stone-900/80 p-4 transition-all duration-300 hover:scale-[1.02] ${d?"bg-stone-700/80 "+Hde(d,l.stage):""}`,children:[h.jsx("div",{className:`flex size-8 items-center justify-center rounded-full text-sm font-bold transition-all duration-300 ${d?"scale-110 bg-gradient-to-r from-green-600 to-emerald-700 shadow-lg shadow-green-400/30 ring-2 ring-green-400/50":"bg-stone-700"} ${d?"text-white":Wde(l.stage,l.action)}`,children:l.cycle}),h.jsx("div",{className:"flex-1",children:h.jsx("span",{className:`text-sm font-medium transition-all duration-200 ${Ude(l.stage,l.action).split(" ")[0]}`,children:l.action})}),d&&h.jsx("div",{className:"flex items-center gap-1",children:h.jsx("div",{className:"size-2 rounded-full bg-green-400 shadow-lg shadow-green-400/50"})})]})]},c)}),e.length===0&&h.jsx("div",{className:"animate-fade-in flex items-center justify-center py-12",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"mb-4 text-5xl",children:"⏳"}),h.jsx("h4",{className:"mb-2 bg-gradient-to-r from-stone-300 to-stone-400 bg-clip-text text-sm font-bold text-transparent",children:"Esperando instrucciones"}),h.jsx("p",{className:"text-xs text-stone-500",children:"Ejecuta un programa para ver el ciclo"})]})})]}),h.jsx("div",{className:"rounded-b-xl border-t border-stone-600/50 bg-gradient-to-r from-stone-800/80 to-stone-900/80 px-4 py-3",children:h.jsxs("div",{className:"flex items-center justify-between text-xs text-stone-400",children:[h.jsxs("span",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 rounded-full bg-blue-400"}),"Ciclos: ",A.get(It)]}),h.jsxs("span",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 rounded-full bg-green-400 shadow-lg shadow-green-400/50"}),h.jsx("span",{className:"text-xs font-medium text-green-300",children:"Activo"})]})]})})]})})}function Xde(){const t=un(),{devices:e}=Kn();return e.hasIOBus?h.jsx("div",{className:"absolute left-[500px] top-[525px] z-40 h-[70px] w-[250px] rounded-lg border border-stone-600 bg-stone-900",children:h.jsx("span",{className:"block w-min whitespace-nowrap rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-lg text-white",children:t("computer.chip-select.name")})}):null}function qde(){const{devices:t}=Kn(),e=rt(pf),n=rt(mf),i=x.useRef(null),r=x.useRef(null),s=x.useRef(null),o=["M 380 420 H 800",t.pic&&"M 780 420 V 805 H 450",t.pio&&"M 780 420 V 805 H 900",t.timer&&"M 780 420 V 805 H 583 V 875",t.handshake&&"M 780 420 V 1015 H 900"].filter(Boolean).join(" "),a=["M 380 440 H 800",t.pic&&"M 790 440 V 815 H 450",t.pio&&"M 790 440 V 815 H 900",t.timer&&"M 790 440 V 815 H 573 V 875",t.handshake&&"M 790 440 V 1025 H 900"].filter(Boolean).join(" "),{path:l,strokeDashoffset:c,opacity:u}=$e("bus.rd"),{path:d,strokeDashoffset:f,opacity:p}=$e("bus.wr");return h.jsxs(h.Fragment,{children:[e&&h.jsx(Yde,{pathRef:r}),n&&h.jsx(Jde,{pathRef:s}),h.jsxs("svg",{className:"pointer-events-none absolute inset-0 z-[15] size-full",children:[h.jsx("path",{ref:i,className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:o}),h.jsx("path",{className:"fill-none stroke-stone-700 stroke-[4px]",strokeLinejoin:"round",d:o}),e&&h.jsx(nt.path,{ref:r,d:l||o,className:"fill-none stroke-red-500 stroke-[3px] drop-shadow-[0_0_8px_rgba(239,68,68,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:c,opacity:u}}),e&&h.jsx(nt.path,{d:l||o,className:"fill-none stroke-red-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:c,opacity:u}}),h.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:a}),h.jsx("path",{className:"fill-none stroke-stone-700 stroke-[4px]",strokeLinejoin:"round",d:a}),n&&h.jsx(nt.path,{ref:s,d:d||a,className:"fill-none stroke-orange-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(251,146,60,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:f,opacity:p}}),n&&h.jsx(nt.path,{d:d||a,className:"fill-none stroke-orange-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:f,opacity:p}}),t.hasIOBus&&h.jsx(Ln,{springs:"bus.iom",d:"M 380 460 H 675 V 525"}),t.pic&&h.jsx(Ln,{springs:"bus.pic",d:"M 521 595 V 730 H 450"}),t.timer&&h.jsx(Ln,{springs:"bus.timer",d:"M 563 595 V 875"}),t.handshake&&h.jsx(Ln,{springs:"bus.handshake",d:"M 710 595 V 950 H 900"}),t.pic&&h.jsxs(h.Fragment,{children:[h.jsx(Ln,{springs:"bus.intr",d:"M 110 700 V 482"}),h.jsx(Ln,{springs:"bus.inta",d:"M 160 482 V 700"})]}),t.pic&&t.f10&&h.jsx(Ln,{springs:"bus.int0",d:"M 70 950 V 900"}),t.pic&&t.timer&&h.jsx(Ln,{springs:"bus.int1",d:"M 475 955 H 180 V 900"}),t.pic&&t.handshake&&h.jsx(Ln,{springs:"bus.int2",d:"M 900 1075 H 300 V 900"}),t.pio&&h.jsx(Ln,{springs:"bus.pio",d:"M 612 595 V 730 H 900"}),t.handshake&&h.jsx(Ln,{springs:"bus.int0",d:"M 900 1015 H 900"}),t.pio==="printer"&&h.jsxs(h.Fragment,{children:[h.jsx(Ln,{springs:"bus.printer.strobe",d:"M 1120 767 H 1225 V 992 H 1300"}),h.jsx(Ln,{springs:"bus.printer.busy",d:"M 1300 1007 H 1210 V 782 H 1120"}),h.jsx(Ln,{springs:"bus.printer.data",d:"M 1120 837 H 1175 V 1062 H 1300"})]}),t.handshake==="printer"&&h.jsxs(h.Fragment,{children:[h.jsx(Ln,{springs:"bus.printer.strobe",d:"M 1120 992 H 1300"}),h.jsx(Ln,{springs:"bus.printer.busy",d:"M 1300 1007 H 1120"}),h.jsx(Ln,{springs:"bus.printer.data",d:"M 1120 1062 H 1300"})]}),t.pio&&t.switches&&h.jsx(Ln,{springs:"bus.switches->pio",d:"M 1300 768 H 1120"}),t.pio&&t.leds&&h.jsx(Ln,{springs:"bus.pio->leds",d:"M 1120 848 H 1300"})]})]})}function Ln({d:t,springs:e}){return h.jsxs(h.Fragment,{children:[h.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:t}),h.jsx("path",{className:"fill-none stroke-stone-700 stroke-[3px]",strokeLinejoin:"round",d:t}),h.jsx(nt.path,{d:t,className:"fill-none stroke-red-500 stroke-[3px] drop-shadow-[0_0_8px_rgba(239,68,68,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:$e(e)}),h.jsx(nt.path,{d:t,className:"fill-none stroke-red-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:$e(e)})]})}function Kde(){const t=un(),{devices:e}=Kn();return h.jsxs(h.Fragment,{children:[h.jsx(pr,{style:{left:385,top:405},children:"rd"}),h.jsx(pr,{style:{left:385,top:425},children:"wr"}),e.hasIOBus&&h.jsxs(h.Fragment,{children:[h.jsx(pr,{style:{left:384,top:443},children:"io/m"}),h.jsx(pr,{style:{left:715,top:538},children:t("computer.chip-select.mem")})]}),e.pic&&h.jsx(h.Fragment,{children:h.jsx(pr,{className:"left-[510px] top-[573px]",children:t("computer.chip-select.pic")})}),e.timer&&h.jsx(h.Fragment,{children:h.jsx(pr,{className:"left-[545px] top-[573px]",children:t("computer.chip-select.timer")})}),e.pio&&h.jsx(h.Fragment,{children:h.jsx(pr,{className:"left-[600px] top-[573px]",children:t("computer.chip-select.pio")})}),e.handshake&&h.jsx(h.Fragment,{children:h.jsx(pr,{className:"left-[675px] top-[573px]",children:t("computer.chip-select.handshake")})}),e.pic&&h.jsxs(h.Fragment,{children:[h.jsx(pr,{className:"left-[75px] top-[482px]",children:"intr"}),h.jsx(pr,{className:"left-[125px] top-[482px]",children:"inta"})]}),e.printer&&h.jsxs(h.Fragment,{children:[h.jsx(pr,{className:"left-[1310px] top-[983px]",children:"strobe"}),h.jsx(pr,{className:"left-[1310px] top-[998px]",children:"busy"}),h.jsx(pr,{className:"left-[1310px] top-[1053px]",children:"data"})]})]})}function pr({children:t,style:e,className:n}){return h.jsx("span",{className:`pointer-events-none absolute z-50 block font-mono text-xs font-bold tracking-wider text-stone-400${n?" "+n:""}`,style:e,children:t})}function Yde({pathRef:t}){const[e,n]=x.useState(!0),i=Ip(pf),[r,s]=x.useState(!1),[o,a]=x.useState(0),[l]=Oo();if(x.useEffect(()=>{if(e&&r){const p=Date.now(),g=l.animations?Math.min(l.executionUnit,250):1,y=()=>{const v=Date.now()-p,b=Math.min(v/g,1);a(b),b<1?requestAnimationFrame(y):(n(!1),setTimeout(()=>i(!1),100))};y()}},[e,r,i,l.animations,l.executionUnit]),x.useEffect(()=>{let p=0;const m=50,g=()=>{if(t.current){s(!0);return}p++,p<m?setTimeout(g,10):s(!1)};g()},[t]),!e||!r||!l.animations)return null;const c=380,u=800,d=420,f=c+(u-c)*o;return h.jsx("div",{className:"pointer-events-none absolute z-[100] select-none text-xs font-extrabold",style:{left:f,top:d-32,color:"#ef4444",textShadow:"0 0 4px #000, 0 0 2px #000",background:"rgba(0,0,0,0.2)",padding:"2px 8px",borderRadius:"6px",transition:"left 0.1s linear, top 0.1s linear",opacity:e?1:0},children:"Read"})}function Jde({pathRef:t}){const[e,n]=x.useState(!0),i=Ip(mf),[r,s]=x.useState(!1),[o,a]=x.useState(0),[l]=Oo();if(x.useEffect(()=>{if(e&&r){const p=Date.now(),g=l.animations?Math.min(l.executionUnit,250):1,y=()=>{const v=Date.now()-p,b=Math.min(v/g,1);a(b),b<1?requestAnimationFrame(y):(n(!1),setTimeout(()=>i(!1),100))};y()}},[e,r,i,l.animations,l.executionUnit]),x.useEffect(()=>{let p=0;const m=50,g=()=>{if(t.current){s(!0);return}p++,p<m?setTimeout(g,10):s(!1)};g()},[t]),!e||!r)return null;const c=380,u=800,d=440,f=c+(u-c)*o;return h.jsx("div",{className:"pointer-events-none absolute z-[100] select-none text-xs font-extrabold",style:{left:f,top:d+12,color:"#f59e42",textShadow:"0 0 4px #000, 0 0 2px #000",background:"rgba(0,0,0,0.2)",padding:"2px 8px",borderRadius:"6px",transition:"left 0.1s linear, top 0.1s linear",opacity:e?1:0},children:"Write"})}function Zde(){const{devices:t}=Kn(),e="M 750 545 H 800",n=["M 645 349 H 800",t.pic&&"M 725 349 V 770 H 450",t.pio&&"M 725 349 V 770 H 900",t.timer&&"M 725 349 V 770 H 618 V 875",t.handshake&&"M 725 349 V 980 H 900"].filter(Boolean).join(" "),i=["M 645 250 H 645 V 249 H 800",t.pic&&"M 765 249 V 790 H 450",t.pio&&"M 765 249 V 790 H 900",t.timer&&"M 765 249 V 790 H 598 V 875",t.handshake&&"M 765 249 V 1000 H 900"].filter(Boolean).join(" "),{path:r,strokeDashoffset:s,opacity:o}=$e("bus.data"),{path:a,strokeDashoffset:l,opacity:c}=$e("bus.address"),u=$e("bus.mem");return h.jsxs("svg",{className:"pointer-events-none absolute inset-0 z-[25] size-full",children:[h.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:i}),h.jsx(nt.path,{d:r,className:"fill-none stroke-mantis-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(34,197,94,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:s,opacity:o}}),h.jsx(nt.path,{d:r,className:"fill-none stroke-mantis-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:s,opacity:o}}),h.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:n}),h.jsx(nt.path,{d:a,className:"fill-none stroke-blue-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(59,130,246,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:l,opacity:c}}),h.jsx(nt.path,{d:a,className:"fill-none stroke-blue-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:l,opacity:c}}),t.hasIOBus&&h.jsxs(h.Fragment,{children:[h.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:e}),h.jsx(nt.path,{className:"fill-none stroke-[4px]",strokeLinejoin:"round",d:e,style:u})]})]})}function Qde(){return h.jsxs(h.Fragment,{children:[h.jsx(Zde,{}),h.jsx(qde,{}),h.jsx(Kde,{}),h.jsx(Xde,{})]})}function efe(){const{devices:t}=Kn();if(!t.clock)return null;const e=$e("clock.angle");return h.jsx("div",{className:"absolute left-[520px] top-[930px] z-10 size-12 rounded-full border border-stone-600 bg-stone-800 p-1 [&_*]:z-20",children:h.jsxs("svg",{viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"size-full fill-none stroke-white stroke-2",children:[h.jsx("circle",{cx:"12",cy:"12",r:"10"}),h.jsx(nt.line,{x1:e.to(n=>12+6*Math.sin(n*Math.PI/180)),y1:e.to(n=>12-6*Math.cos(n*Math.PI/180)),x2:12,y2:12})]})})}const tfe={register:{beginner:"Un registro es como una caja pequeña donde la CPU guarda datos temporalmente. Es muy rápido de acceder.",intermediate:"Los registros son memoria de acceso rápido dentro de la CPU. Son más rápidos que la RAM pero tienen menos capacidad.",advanced:"Registros de propósito general (AL, BL, CL, DL) para operaciones aritméticas. Cada uno puede almacenar 8 bits."},memory:{beginner:"La memoria RAM es como un gran almacén donde se guardan programas y datos. Cada ubicación tiene una dirección única.",intermediate:"Memoria de acceso aleatorio (RAM) de 256 bytes. La CPU puede leer y escribir en cualquier dirección.",advanced:"Memoria principal de 256 bytes con direccionamiento de 8 bits (00-FF). Organizada en celdas de 8 bits cada una."},alu:{beginner:'La ALU (Unidad Aritmético-Lógica) es el "cerebro matemático" de la CPU. Realiza sumas, restas y comparaciones.',intermediate:"Arithmetic Logic Unit procesa operaciones matemáticas y lógicas. Recibe operandos y devuelve resultados.",advanced:"ALU de 8 bits que ejecuta operaciones: ADD, SUB, AND, OR, XOR, NOT, CMP. Incluye flags de estado (Z, N, C)."},bus:{beginner:'Los buses son como "carreteras" por donde viajan los datos entre los componentes de la computadora.',intermediate:"Buses de datos y control conectan CPU, memoria y periféricos. El bus de datos transporta información.",advanced:"Bus de datos de 8 bits bidireccional, bus de direcciones de 8 bits, y líneas de control para sincronización."},instruction:{beginner:"Una instrucción es un comando que le dice a la CPU qué operación realizar, como sumar dos números.",intermediate:"Cada instrucción tiene un código de operación (opcode) y operandos. La CPU las ejecuta secuencialmente.",advanced:"Formato de instrucción: opcode (1 byte) + operandos. Ejemplos: MOV, ADD, JMP, CALL. Ciclo fetch-decode-execute."},"program-counter":{beginner:"El contador de programa (IP) indica qué instrucción ejecutar a continuación. Se incrementa automáticamente.",intermediate:"Program Counter (IP) contiene la dirección de la siguiente instrucción. Se actualiza en cada ciclo.",advanced:"Instruction Pointer (IP) de 8 bits. Incrementa en 1-2 bytes según el tamaño de la instrucción actual."},flags:{beginner:"Las banderas son indicadores que muestran el resultado de operaciones, como si el resultado fue cero.",intermediate:"Flags de estado: Zero (Z), Negative (N), Carry (C). Se actualizan automáticamente en operaciones.",advanced:"Flags de 1 bit: Z (resultado cero), N (resultado negativo), C (acarreo/overflow). Controlan saltos condicionales."},stack:{beginner:"La pila es como una pila de platos. Solo puedes agregar o quitar del tope. Útil para guardar direcciones de retorno.",intermediate:"Stack Pointer (SP) apunta al tope de la pila. PUSH agrega datos, POP los retira. LIFO (Last In, First Out).",advanced:"Pila de 256 bytes con SP de 8 bits. PUSH decrementa SP, POP lo incrementa. Usada para CALL/RET y variables locales."},interrupt:{beginner:"Una interrupción es como un timbre que interrumpe lo que está haciendo la CPU para atender algo urgente.",intermediate:"Las interrupciones permiten que dispositivos externos notifiquen a la CPU eventos importantes.",advanced:"Sistema de interrupciones con PIC (Programmable Interrupt Controller). IRET retorna de la rutina de interrupción."},peripheral:{beginner:"Los periféricos son dispositivos externos como teclado, pantalla y LEDs que se conectan a la computadora.",intermediate:"Periféricos se comunican con la CPU a través de puertos de entrada/salida (I/O).",advanced:"Sistema de I/O con PIO (Programmable I/O) y módulos específicos para cada periférico."},assembly:{beginner:"El lenguaje ensamblador es un lenguaje de programación que usa palabras en lugar de números para las instrucciones.",intermediate:"Cada instrucción de ensamblador se traduce a código de máquina. El ensamblador hace esta traducción.",advanced:"Sintaxis: etiqueta, mnemónico, operandos, comentarios. Directivas como ORG, DB, DW para datos."},addressing:{beginner:"El direccionamiento es cómo la CPU encuentra los datos que necesita en la memoria.",intermediate:"Modos de direccionamiento: inmediato, directo, indirecto. Cada uno accede a datos de forma diferente.",advanced:"Direccionamiento inmediato (valor en instrucción), directo (dirección en instrucción), indirecto (dirección en registro)."}},nfe={beginner:wd,intermediate:Rm,advanced:J_},v3={beginner:"text-blue-400",intermediate:"text-yellow-400",advanced:"text-purple-400"},cz=x.memo(({concept:t,level:e="beginner",children:n,className:i})=>{const[r,s]=x.useState(e),o=tfe[t];if(!o)return console.warn(`No educational content found for concept: ${t}`),h.jsx(h.Fragment,{children:n});const a=o[r],l=nfe[r],c=h.jsxs("div",{className:"max-w-xs p-3",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[h.jsx(Qe,{icon:l,className:re("text-sm",v3[r])}),h.jsxs("span",{className:re("text-sm font-medium",v3[r]),children:["Nivel"," ",r==="beginner"?"Básico":r==="intermediate"?"Intermedio":"Avanzado"]})]}),h.jsx("p",{className:"mb-3 text-sm text-stone-300",children:a}),h.jsx("div",{className:"flex gap-1",children:["beginner","intermediate","advanced"].map(u=>h.jsx("button",{onClick:d=>{d.stopPropagation(),s(u)},className:re("rounded px-2 py-1 text-xs transition-colors",r===u?"bg-mantis-600 text-white":"bg-stone-700 text-stone-400 hover:bg-stone-600"),children:u==="beginner"?"B":u==="intermediate"?"I":"A"},u))})]});return h.jsx(ss,{content:c,position:"top",children:h.jsxs("span",{className:re("inline-flex cursor-help items-center gap-1",i),children:[n,h.jsx(Qe,{icon:wd,className:"text-xs text-mantis-400 opacity-70 transition-opacity hover:opacity-100"})]})})});cz.displayName="EducationalTooltip";var C1="Popover",[uz,Ove]=zs(C1,[If]),Gm=If(),[ife,ic]=uz(C1),dz=t=>{const{__scopePopover:e,children:n,open:i,defaultOpen:r,onOpenChange:s,modal:o=!1}=t,a=Gm(e),l=x.useRef(null),[c,u]=x.useState(!1),[d,f]=Rl({prop:i,defaultProp:r??!1,onChange:s,caller:C1});return h.jsx(O$,{...a,children:h.jsx(ife,{scope:e,contentId:_f(),triggerRef:l,open:d,onOpenChange:f,onOpenToggle:x.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:c,onCustomAnchorAdd:x.useCallback(()=>u(!0),[]),onCustomAnchorRemove:x.useCallback(()=>u(!1),[]),modal:o,children:n})})};dz.displayName=C1;var fz="PopoverAnchor",rfe=x.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=ic(fz,n),s=Gm(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=r;return x.useEffect(()=>(o(),()=>a()),[o,a]),h.jsx(h1,{...s,...i,ref:e})});rfe.displayName=fz;var hz="PopoverTrigger",pz=x.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=ic(hz,n),s=Gm(n),o=St(e,r.triggerRef),a=h.jsx(it.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":bz(r.open),...i,ref:o,onClick:ke(t.onClick,r.onOpenToggle)});return r.hasCustomAnchor?a:h.jsx(h1,{asChild:!0,...s,children:a})});pz.displayName=hz;var MA="PopoverPortal",[sfe,ofe]=uz(MA,{forceMount:void 0}),mz=t=>{const{__scopePopover:e,forceMount:n,children:i,container:r}=t,s=ic(MA,e);return h.jsx(sfe,{scope:e,forceMount:n,children:h.jsx(wa,{present:n||s.open,children:h.jsx(Vm,{asChild:!0,container:r,children:i})})})};mz.displayName=MA;var vf="PopoverContent",gz=x.forwardRef((t,e)=>{const n=ofe(vf,t.__scopePopover),{forceMount:i=n.forceMount,...r}=t,s=ic(vf,t.__scopePopover);return h.jsx(wa,{present:i||s.open,children:s.modal?h.jsx(lfe,{...r,ref:e}):h.jsx(cfe,{...r,ref:e})})});gz.displayName=vf;var afe=Jd("PopoverContent.RemoveScroll"),lfe=x.forwardRef((t,e)=>{const n=ic(vf,t.__scopePopover),i=x.useRef(null),r=St(e,i),s=x.useRef(!1);return x.useEffect(()=>{const o=i.current;if(o)return j$(o)},[]),h.jsx(m1,{as:afe,allowPinchZoom:!0,children:h.jsx(vz,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ke(t.onCloseAutoFocus,o=>{var a;o.preventDefault(),s.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:ke(t.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:ke(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),cfe=x.forwardRef((t,e)=>{const n=ic(vf,t.__scopePopover),i=x.useRef(!1),r=x.useRef(!1);return h.jsx(vz,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,s),s.defaultPrevented||(i.current||(a=n.triggerRef.current)==null||a.focus(),s.preventDefault()),i.current=!1,r.current=!1},onInteractOutside:s=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,s),s.defaultPrevented||(i.current=!0,s.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&r.current&&s.preventDefault()}})}),vz=x.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:r,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=t,f=ic(vf,n),p=Gm(n);return cA(),h.jsx(c1,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:r,onUnmountAutoFocus:s,children:h.jsx(zm,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:h.jsx(xA,{"data-state":bz(f.open),role:"dialog",id:f.contentId,...p,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),yz="PopoverClose",ufe=x.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=ic(yz,n);return h.jsx(it.button,{type:"button",...i,ref:e,onClick:ke(t.onClick,()=>r.onOpenChange(!1))})});ufe.displayName=yz;var dfe="PopoverArrow",ffe=x.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=Gm(n);return h.jsx(wA,{...r,...i,ref:e})});ffe.displayName=dfe;function bz(t){return t?"open":"closed"}var hfe=dz,pfe=pz,mfe=mz,xz=gz;const Uy=hfe,Vy=pfe,hm=x.forwardRef(({className:t,align:e="center",sideOffset:n=4,...i},r)=>h.jsx(mfe,{children:h.jsx(xz,{ref:r,align:e,sideOffset:n,className:re("z-50 w-72 rounded-md border border-stone-600 bg-stone-900 text-white shadow-md outline-none transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...i})}));hm.displayName=xz.displayName;function Nr({name:t,valueAtom:e,springs:n,emphasis:i=!1,className:r}){const s=un(),o=rt(e),a=o.low,c={AX:"AL",BX:"BL",CX:"CL",DX:"DL"}[t]||t,u=["AL","BL","CL","DL"].includes(t),d=t==="IP",f=t==="SP",p=t==="MBR",m=t==="MAR",g=t==="IR",y=["id","ri"].includes(t),v=c==="FLAGS";return h.jsxs(Uy,{children:[h.jsx(Vy,{asChild:!0,children:h.jsxs(nt.button,{title:c!=="left"&&c!=="right"&&c!=="result"?`Registro ${c}`:c,className:re("flex cursor-pointer items-center font-mono leading-none transition-opacity",u||d||f||p||m||g||y?"size-10 justify-center rounded border-2 text-lg font-bold shadow-[0_2px_8px_0_rgba(60,180,120,0.10)] transition-all duration-200 hover:scale-110 hover:shadow-xl":v?"min-h-[32px] min-w-[90px] gap-2 rounded border-2 border-yellow-400 bg-gradient-to-br from-yellow-900 via-yellow-800 to-stone-900 px-2.5 py-0.5 font-bold text-yellow-200 shadow-[0_2px_8px_0_rgba(250,204,21,0.10)]":"rounded-md border bg-stone-800 px-2 py-1",u?"border-mantis-500 bg-stone-800 text-mantis-300":d?"border-red-500 bg-stone-800 text-red-300":f?"border-yellow-400 bg-stone-800 text-yellow-300":p||m||g?"border-indigo-400 bg-stone-800 text-indigo-300":y?"border-cyan-400 bg-stone-800 text-cyan-300":v?"":i?"border-mantis-400 text-lg":"border-stone-600 text-base",r),style:c==="left"||c==="right"||c==="result"?{backgroundColor:"transparent"}:$e(n),children:[u||f||p||m||g||y?h.jsx(h.Fragment,{children:h.jsx("span",{className:re(u||y||g||m||p?"mt-4":"mt-2","font-mono text-base font-bold"),children:a.toString("hex")})}):d?h.jsx(h.Fragment,{children:h.jsx("span",{className:re("mt-4 font-mono text-base font-bold text-red-300"),children:a.toString("hex")})}):c==="left"?h.jsx("span",{className:"opacity-0"}):c==="right"?h.jsx("span",{className:"opacity-0"}):c==="result"?h.jsx("span",{className:"opacity-0"}):h.jsxs(h.Fragment,{children:[h.jsx("span",{className:re("mr-2 font-extrabold tracking-wide",u&&"text-mantis-300 drop-shadow",v&&"text-yellow-200",y&&"text-cyan-300",(c==="left"||c==="right")&&"text-xs"),children:c}),h.jsx("span",{className:re("rounded px-1 py-0.5 font-light",u?"border border-mantis-400 bg-stone-950 text-mantis-300":v?"border border-yellow-400 bg-yellow-950 text-yellow-200":y?"border border-cyan-400 bg-cyan-950 text-cyan-200":"border border-stone-600 bg-stone-900 text-white"),children:a.toString("hex")})]}),v&&h.jsxs("span",{className:"ml-2 flex gap-1",children:[h.jsx("span",{className:re("rounded border px-1 text-xs font-bold",Number(a)&2?"border-yellow-300 bg-yellow-400 text-yellow-950":"border-yellow-700 bg-stone-800 text-yellow-300"),children:"Z"}),h.jsx("span",{className:re("rounded border px-1 text-xs font-bold",Number(a)&1?"border-yellow-300 bg-yellow-400 text-yellow-950":"border-yellow-700 bg-stone-800 text-yellow-300"),children:"C"})]})]})}),h.jsxs(hm,{className:"w-60",children:[h.jsx("div",{className:"px-4 py-2",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("p",{className:"font-medium text-white",children:c!=="left"&&c!=="right"&&c!=="result"?`Registro ${c}`:c}),c!=="left"&&c!=="right"&&c!=="result"&&h.jsx(cz,{concept:"register",level:"beginner",children:h.jsx("span",{className:"text-xs text-mantis-400",children:"💡"})})]})}),h.jsx("hr",{className:"border-stone-600"}),h.jsx("ul",{className:"px-4 py-2 text-sm",children:["hex","bin","uint","int","safe-ascii"].map(b=>h.jsxs("li",{children:[h.jsx("b",{className:"font-medium",children:s(`generics.byte-representation.${b}`)}),":"," ",h.jsx("span",{className:"font-mono text-mantis-400",children:o.low.toString(b)})]},b))})]})]})}function gfe(){const t=rt(le.FLAGS),e=rt(le.result),n=rt(le.left),i=rt(le.right),r=rt(uE),s=rt(Wn),[o,a]=x.useState(!1),[l,c]=x.useState(""),[u,d]=x.useState(""),[f,p]=x.useState(""),[m,g]=x.useState(""),[y,v]=x.useState(""),[b,w]=x.useState(""),k=rt(lE),C=rt(Hb),[E]=Oo(),_=x.useCallback(()=>s&&"metadata"in s&&s.metadata?`${s.metadata.name}${s.metadata.operands.length?" "+s.metadata.operands.join(", "):""}`:"",[s]),M=q=>["ADD","SUB","CMP","AND","OR","XOR"].some(ne=>q.startsWith(ne)),R=q=>{let Y="AL",ne="BL",V="AL";const U=[/ADD\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/,/SUB\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/,/CMP\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/,/AND\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/,/OR\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/,/XOR\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/],se=/^(ADD|SUB|CMP|AND|OR|XOR)\s+(\[[^\]]+\]|[0-9A-F]+h?)\s*,\s*([0-9A-F]+h?|0x[0-9A-F]+)$/i;if(q.match(se))return{left:"mbr",right:"id",destination:"mbr"};for(const ae of U){const z=q.match(ae);if(z){Y=z[1],ne=z[2],/\[.*\]/.test(Y)&&(Y="MBR"),/\[.*\]/.test(ne)&&(ne="MBR"),V=z[1];break}}const Q=["AL","BL","CL","DL","MBR"];return Q.includes(Y)||(Y="AL"),Q.includes(ne)||(ne="BL"),Q.includes(V)||(V="AL"),{left:Y,right:ne,destination:V}};x.useEffect(()=>{const q=V=>{console.log("🎯 handleInstruction llamado con:",V);const se=_()||V;if(console.log("🎯 Instrucción completa a usar:",se),V)if(M(se)){a(!0);const{left:Q,right:ae,destination:z}=R(se);console.log("🎯 Registros detectados:",{left:Q,right:ae,destination:z}),g(Q),v(ae),w(z);let $,W;Q==="MBR"&&ae!=="MBR"?($=Ti(Q,"left",V,void 0,{separateMBRPaths:!0,direction:"left"}),W=Ti(ae,"right",V)):ae==="MBR"&&Q!=="MBR"?($=Ti(Q,"left",V),W=Ti(ae,"right",V,void 0,{separateMBRPaths:!0,direction:"right"})):($=Ti(Q,"left",V),W=Ti(ae,"right",V));const S=Ti("result start",z,V),O="M 455 45 L 465 45 L 550 45 L 550 16 L 90 16 L 90 85 L 130 85 L 220 85",j="M 455 85 L 465 85 L 550 85 L 550 250 L 90 250 L 90 145 L 125 145 L 220 145",D="M 280 115 L 370 115 L 390 115 L 425 115 L 425 45 L 455 45";c($||O),d(W||j),p(S||D)}else a(!1),c(""),d(""),p(""),g(""),v(""),w("");else a(!1),c(""),d(""),p(""),g(""),v(""),w("")},Y=V=>{const U=V,se=_();q(se||U.detail.instruction)},ne=V=>{const U=V;if(U.detail&&U.detail.instruction){const se=_();q(se||U.detail.instruction)}};return window.addEventListener("instructionChange",Y),window.addEventListener("cpu:alu.execute",ne),()=>{window.removeEventListener("instructionChange",Y),window.removeEventListener("cpu:alu.execute",ne)}},[s,_]);const T=t.bit(1),L=t.bit(0),I=t.bit(3),G=t.bit(4),B=t.bit(2);return h.jsxs(h.Fragment,{children:[h.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[l&&h.jsx(nt.path,{className:"fill-none stroke-green-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(34,197,94,0.6)]",strokeLinejoin:"round",d:l,pathLength:1,strokeDasharray:1,style:$e("cpu.alu.operands")}),u&&h.jsx(nt.path,{className:"fill-none stroke-blue-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(59,130,246,0.6)]",strokeLinejoin:"round",d:u,pathLength:1,strokeDasharray:1,style:$e("cpu.alu.operands")}),f&&h.jsx(nt.path,{className:"fill-none stroke-violet-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(139,92,246,0.6)]",strokeLinejoin:"round",d:f,pathLength:1,strokeDasharray:1,style:$e("cpu.alu.results")}),l&&h.jsx(nt.path,{className:"fill-none stroke-green-300 stroke-1 opacity-50",strokeLinejoin:"round",d:l,pathLength:1,strokeDasharray:1,style:$e("cpu.alu.operands")}),u&&h.jsx(nt.path,{className:"fill-none stroke-blue-300 stroke-1 opacity-50",strokeLinejoin:"round",d:u,pathLength:1,strokeDasharray:1,style:$e("cpu.alu.operands")}),f&&h.jsx(nt.path,{className:"fill-none stroke-violet-300 stroke-1 opacity-50",strokeLinejoin:"round",d:f,pathLength:1,strokeDasharray:1,style:$e("cpu.alu.results")}),m&&y&&o&&l&&u&&h.jsxs(nt.text,{x:"125",y:"65",fill:"#34D399",fontSize:"12",fontWeight:"bold",style:{opacity:$e("cpu.alu.leftText").opacity},children:[m," = ",n.low.toString("hex")]}),m&&y&&o&&l&&u&&h.jsxs(nt.text,{x:"125",y:"168",fill:"#60A5FA",fontSize:"12",fontWeight:"bold",style:{opacity:$e("cpu.alu.rightText").opacity},children:[y," = ",i.low.toString("hex")]}),b&&o&&h.jsxs(nt.text,{x:"310",y:"95",fill:"#A855F7",fontSize:"12",fontWeight:"bold",style:{...$e("cpu.alu.cog"),opacity:$e("cpu.alu.resultText").opacity},children:[b," = ",e.low.toString("hex")]}),h.jsxs("defs",{children:[h.jsxs("linearGradient",{id:"aluGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[h.jsx("stop",{offset:"0%",stopColor:"#374151"}),h.jsx("stop",{offset:"50%",stopColor:"#4B5563"}),h.jsx("stop",{offset:"100%",stopColor:"#1F2937"})]}),h.jsx("filter",{id:"aluShadow",children:h.jsx("feDropShadow",{dx:"2",dy:"2",stdDeviation:"3",floodColor:"rgba(0,0,0,0.3)"})})]}),h.jsx("path",{d:"M 220 60 v 50 l 20 12 l -20 12 v 50 l 60 -36 v -52 Z",fill:"url(#aluGradient)",stroke:"#6B7280",strokeWidth:"2",strokeLinejoin:"round",filter:"url(#aluShadow)"}),h.jsx("text",{x:"250",y:"105",fill:"#E5E7EB",fontSize:"12",fontWeight:"bold",textAnchor:"middle",children:"ALU"})]}),h.jsx(nt.span,{className:"icon-[lucide--settings] absolute left-[244px] top-[120px] block size-5 text-stone-300",style:{transform:$e("cpu.alu.cog").rot.to(q=>`rotate(${q*60}deg)`)}}),o&&h.jsx(nt.span,{className:"absolute left-[244px] top-[40px] z-30 flex w-min items-center rounded-md border border-stone-600 px-2 py-1 font-mono leading-none",style:$e("cpu.alu.operation"),children:r}),h.jsxs(nt.div,{className:re("absolute flex items-center justify-center gap-0.5 rounded border-2 border-amber-400 bg-transparent font-bold text-stone-200 shadow-lg ring-1 ring-amber-300",E.flagsVisibility==="SF_OF_CF_ZF"?"left-[210px] top-[190px] min-h-[40px] min-w-[60px] px-2":"left-[230px] top-[190px] min-h-[40px] min-w-[40px] px-1"),style:$e("cpu.FLAGS"),children:[h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[7px] font-bold text-stone-300",children:"FLAGS"}),h.jsxs("div",{className:"mt-3 flex items-center gap-0.5",children:[(k||C||E.flagsVisibility==="IF_CF_ZF"||E.flagsVisibility==="IF_SF_OF_CF_ZF")&&h.jsx("span",{className:re("rounded border px-0.5 py-0 text-[10px] font-bold transition-all duration-200",G?"border-amber-400 bg-amber-400 text-stone-950 shadow-[0_0_4px_rgba(251,191,36,0.6)]":"border-stone-600 bg-stone-800 text-stone-300"),children:"I"}),(E.flagsVisibility==="SF_OF_CF_ZF"||E.flagsVisibility==="IF_SF_OF_CF_ZF")&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:re("rounded border px-0.5 py-0 text-[10px] font-bold transition-all duration-200",I?"border-amber-400 bg-amber-400 text-stone-950 shadow-[0_0_4px_rgba(251,191,36,0.6)]":"border-stone-600 bg-stone-800 text-stone-300"),children:"S"}),h.jsx("span",{className:re("rounded border px-0.5 py-0 text-[10px] font-bold transition-all duration-200",B?"border-amber-400 bg-amber-400 text-stone-950 shadow-[0_0_4px_rgba(251,191,36,0.6)]":"border-stone-600 bg-stone-800 text-stone-300"),children:"O"})]}),h.jsx("span",{className:re("rounded border px-0.5 py-0 text-[10px] font-bold transition-all duration-200",T?"border-amber-400 bg-amber-400 text-stone-950 shadow-[0_0_4px_rgba(251,191,36,0.6)]":"border-stone-600 bg-stone-800 text-stone-300"),children:"C"}),h.jsx("span",{className:re("rounded border px-0.5 py-0 text-[10px] font-bold transition-all duration-200",L?"border-yellow-400 bg-yellow-400 text-stone-950 shadow-[0_0_4px_rgba(250,204,21,0.6)]":"border-stone-600 bg-stone-800 text-stone-300"),children:"Z"})]})]})]})}function vfe({progress:t,resetAnimations:e,returnToOriginal:n}){const{opacity:r,filterIntensity:s}=a1({opacity:t.to(o=>n||e||o===0?.4:o>0&&o<1?1:(o>=1,.4)),filterIntensity:t.to(o=>n||e||o===0?.25:o>0&&o<1?.6:(o>=1,.25)),config:{tension:280,friction:60,duration:300}});return h.jsx(nt.div,{style:{opacity:r,filter:s.to(o=>`drop-shadow(0 0 ${8*o}px rgba(56,189,248,${o}))`),transition:"opacity 0.3s ease-out, filter 0.3s ease-out"},children:h.jsxs("svg",{width:"90",height:"42",viewBox:"0 0 90 42",children:[h.jsx("rect",{x:"10",y:"8",width:"50",height:"26",rx:"8",fill:"#0369a1",stroke:"#38bdf8",strokeWidth:"2.5"}),Array.from({length:4}).map((o,a)=>h.jsx("rect",{x:2,y:10+a*5,width:8,height:2.5,rx:1.2,fill:"#38bdf8"},a)),Array.from({length:8}).map((o,a)=>h.jsx(nt.rect,{x:60,y:8+a*3.2,width:24,height:2.5,rx:1.2,fill:t.to(l=>{if(n||e)return"#0ea5e9";const c=a/7;return l>=c?"#7dd3fc":"#0ea5e9"}),style:{filter:t.to(l=>{if(n||e)return"none";const c=a/7;return l>=c?"drop-shadow(0 0 8px #38bdf8)":"none"})}},a)),Array.from({length:5}).map((o,a)=>h.jsx(nt.rect,{x:15,y:t.to(()=>12+a*3.5),width:40,height:2.8,rx:1.4,fill:t.to(l=>{if(n||e||l===0)return"#0c4a6e";const c=a/4;return l>=c?"#7dd3fc":"#0c4a6e"}),style:{filter:t.to(l=>{if(n||e||l===0)return"none";const c=a/4;return l>=c?"drop-shadow(0 0 6px #38bdf8)":"none"}),transition:"fill 0.7s, filter 0.7s"}},a)),h.jsx(nt.rect,{x:"10",y:"8",width:"50",height:"26",rx:"8",fill:"none",stroke:"#7dd3fc",strokeWidth:"2.5",strokeDasharray:"160",strokeDashoffset:t.to(o=>n||e||o>0&&o<1?160:o===1?0:160),style:{opacity:t.to(o=>n||e||o>0&&o<1?0:o===1?.8:0),transition:"stroke-dashoffset 1.2s cubic-bezier(0.4, 0, 0.2, 1)"}})]})})}function yfe({progress:t,phase:e,resetAnimations:n,returnToOriginal:i}){return h.jsxs(h.Fragment,{children:[Array.from({length:5}).map((s,o)=>h.jsx(nt.rect,{x:16,y:t.to(()=>10+o*4),width:38,height:3,rx:1,fill:t.to(a=>i||n||e==="fetching"&&a===0||a===0?"#581c87":a>=(o+1)/5?"#f0abfc":Math.floor(a*5)===o&&a>0&&a<1?"#fff1fb":"#581c87"),style:{filter:t.to(a=>i||n||e==="fetching"&&a===0||a===0?"none":a>=(o+1)/5?"drop-shadow(0 0 6px #e879f9)":Math.floor(a*5)===o&&a>0&&a<1?"drop-shadow(0 0 12px #e879f9)":"none"),transition:"fill 0.7s, filter 0.7s"}},o)),h.jsx(nt.rect,{x:15,y:t.to(s=>10+Math.floor(s*5)*4-.5),width:40,height:3.5,rx:1.5,fill:"#e879f9",style:{opacity:t.to(s=>i||n?0:s>0&&s<1?.25+.25*Math.sin(s*Math.PI):0),transition:"y 0.3s, opacity 0.2s"}}),h.jsx(nt.rect,{x:"8",y:"6",width:"54",height:"26",rx:"4",fill:"none",stroke:"#f0abfc",strokeWidth:"2",strokeDasharray:"160",strokeDashoffset:t.to(s=>i||n||e==="fetching"&&s===0||s===0?160:160-160*s),style:{opacity:t.to(s=>i||n?0:s>0&&s<1&&e==="fetching-operands"?.7:0),transition:"stroke-dashoffset 1.2s cubic-bezier(0.4, 0, 0.2, 1)"}})]})}function bfe({progress:t,showControlMem:e,returnToOriginal:n}){const{opacity:i,pulseActive:r}=a1({opacity:t.to(s=>n||s===0?.4:s>0&&s<1?1:.4),pulseActive:t.to(s=>n?!1:e&&s>0&&s<1),config:{tension:280,friction:60,duration:300}});return h.jsx(nt.span,{className:"flex size-4 items-center justify-center rounded-full bg-fuchsia-400 text-[10px] font-extrabold text-white shadow-[0_0_4px_rgba(232,121,249,0.6)]",style:{opacity:i,fontVariantNumeric:"tabular-nums",fontFamily:"monospace",transition:"opacity 0.3s ease-out"},title:"Lectura de microinstrucciones",children:h.jsx(nt.span,{style:{animation:r.to(s=>s?"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite":"none")},children:"1"})})}function xfe({progress:t,showControlMem:e,returnToOriginal:n}){const{opacity:i,pulseActive:r}=a1({opacity:t.to(s=>n||s===0?.4:s>0&&s<1?1:(s>=1,.4)),pulseActive:t.to(s=>n?!1:e&&s>0&&s<1),config:{tension:280,friction:60,duration:300}});return h.jsx(nt.span,{className:"flex size-4 items-center justify-center rounded-full bg-sky-400 text-[10px] font-extrabold text-white shadow-[0_0_4px_rgba(56,189,248,0.6)]",style:{opacity:i,fontVariantNumeric:"tabular-nums",fontFamily:"monospace",transition:"opacity 0.3s ease-out"},title:"Envío de señales de control",children:h.jsx(nt.span,{style:{animation:r.to(s=>s?"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite":"none")},children:"2"})})}function wfe({progress:t,phase:e,memAnimKey:n,resetAnimations:i,returnToOriginal:r}){const{opacity:s,filterIntensity:o}=a1({opacity:t.to(a=>r||a===0?.4:a>0&&a<1?1:.4),filterIntensity:t.to(a=>r||a===0?.25:a>0&&a<1?.6:.25),config:{tension:280,friction:60,duration:300}});return h.jsx(nt.div,{style:{opacity:s,filter:o.to(a=>`drop-shadow(0 0 ${8*a}px rgba(232,121,249,${a}))`),transition:"opacity 0.3s ease-out, filter 0.3s ease-out"},children:h.jsxs("svg",{width:"70",height:"38",viewBox:"0 0 70 38",className:"mb-0.5",children:[h.jsx("rect",{x:"8",y:"6",width:"54",height:"26",rx:"4",fill:"#a21caf",stroke:"#e879f9",strokeWidth:"2"}),Array.from({length:4}).map((a,l)=>h.jsx("rect",{x:2,y:9+l*6,width:6,height:2,rx:1,fill:"#e879f9"},l)),Array.from({length:4}).map((a,l)=>h.jsx("rect",{x:62,y:9+l*6,width:6,height:2,rx:1,fill:"#e879f9"},l)),h.jsx(yfe,{progress:t,phase:e,resetAnimations:i,returnToOriginal:r},n)]})})}function Sfe(){const[t,e]=x.useState(0),[n,i]=x.useState(!1),[r,s]=x.useState(!1);x.useEffect(()=>{let d=0;const f=$e("sequencer.progress.progress").to(p=>{d===0&&p>0&&(e(m=>m+1),i(!1),s(!1)),d>0&&p===0&&(e(m=>m+1),i(!0),setTimeout(()=>{s(!0)},100),setTimeout(()=>i(!1),100)),d=p});return()=>{typeof f=="function"&&f()}},[]);const o=un(),a=rt(Wn),[l,c]=x.useState(!1),[,u]=x.useState(!1);return x.useEffect(()=>{let d=null;u(!1);let f;return l?f=$e("sequencer.progress.progress").to(p=>{p>=.5?d=setTimeout(()=>{u(!0)},500):(d&&clearTimeout(d),u(!1))}):u(!1),()=>{d&&clearTimeout(d),typeof f=="function"&&f()}},[l]),h.jsxs(h.Fragment,{children:[h.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[h.jsx(nt.path,{d:"M 250 310 V 320",className:"fill-none stroke-mantis-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(34,197,94,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:$e("cpu.decoder.path")}),h.jsx(nt.path,{d:"M 250 310 V 320",className:"fill-none stroke-mantis-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:$e("cpu.decoder.path")})]}),h.jsx("div",{className:"absolute bottom-[172px] left-[30px] flex w-full items-start",children:h.jsx("span",{className:"block w-min whitespace-nowrap rounded-t-lg border border-b-0 border-stone-600 bg-mantis-500 px-2 pb-3 pt-1 text-xs tracking-wide text-white",children:o("computer.cpu.control-unit")})}),h.jsxs("div",{className:"absolute bottom-[17px] left-[30px] flex h-[160px] w-[350px] flex-col items-center rounded-lg border border-stone-600 bg-stone-800",children:[h.jsx("div",{className:"min-w-[180px] overflow-hidden rounded-b-lg border border-t-0 border-stone-600 bg-stone-900 px-3 py-1",children:h.jsxs("div",{style:{position:"relative",left:0},children:[h.jsx("div",{className:"flex items-center justify-between",children:h.jsxs("div",{style:{position:"relative",left:0,display:"flex",alignItems:"center"},children:[h.jsx("span",{className:"text-sm leading-none",children:o("computer.cpu.decoder")}),h.jsx("button",{type:"button","aria-label":l?"Ocultar memoria de control":"Mostrar memoria de control",className:"ml-2 flex size-6 items-center justify-center rounded-lg bg-gradient-to-r from-mantis-600 to-mantis-500 text-white shadow-lg transition-all duration-300 hover:from-mantis-500 hover:to-mantis-400 focus:outline-none focus:ring-2 focus:ring-mantis-400",style:{fontSize:"1.2em",lineHeight:1,padding:0,minWidth:0,minHeight:0,transform:l?"rotate(180deg)":"rotate(0deg)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:l?"0 4px 12px rgba(34,197,94,0.4)":"0 2px 8px rgba(34,197,94,0.2)"},onClick:()=>c(d=>!d),children:h.jsx("span",{style:{fontWeight:"bold",transform:l?"scale(0.8)":"scale(1)",transition:"transform 0.2s ease-out"},children:l?"−":"+"})})]})}),h.jsx("div",{className:"my-1 h-1 w-full overflow-hidden rounded-full bg-stone-600",children:h.jsx(nt.div,{className:"h-full bg-sky-400",style:{width:$e("sequencer.progress.progress").to(d=>`${d*100}%`),opacity:$e("sequencer.progress.opacity")}})}),h.jsx("div",{className:"flex w-full justify-center",children:l&&h.jsx("div",{className:"flex min-w-[120px] flex-col items-center",children:h.jsxs("div",{className:"flex flex-row items-start gap-4",children:[h.jsxs("div",{className:"flex min-w-[90px] flex-col items-center",children:[h.jsxs("span",{className:"mb-0.5 flex items-center gap-1 text-center text-[10px] font-bold tracking-wide text-fuchsia-100 drop-shadow-[0_0_6px_rgba(232,121,249,0.6)]",style:{minHeight:"18px"},children:[h.jsx(bfe,{progress:$e("sequencer.progress.progress"),showControlMem:l,returnToOriginal:r}),"Memoria de control"]}),h.jsx(wfe,{progress:$e("sequencer.progress.progress"),phase:a==null?void 0:a.phase,memAnimKey:t,resetAnimations:n,returnToOriginal:r})]}),h.jsxs("div",{className:"flex min-w-[90px] flex-col items-center",children:[h.jsxs("span",{className:"mb-0.5 flex items-center gap-1 text-center text-[10px] font-bold tracking-wide text-sky-100 drop-shadow-[0_0_6px_rgba(56,189,248,0.6)]",style:{minHeight:"18px"},children:[h.jsx(xfe,{progress:$e("sequencer.progress.progress"),showControlMem:l,returnToOriginal:r}),"Secuenciador"]}),h.jsx(vfe,{progress:$e("sequencer.progress.progress"),phase:a==null?void 0:a.phase,memAnimKey:t,resetAnimations:n,returnToOriginal:r})]})]})})}),h.jsx("div",{className:"flex w-full justify-center",style:{maxHeight:l?90:0,opacity:l?1:0,transform:l?"translateY(0)":"translateY(-10px)",transition:"max-height 0.6s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s ease-out, transform 0.5s ease-out",overflow:"hidden"}})]})}),h.jsx("div",{className:"flex w-full flex-1 items-start justify-center p-0.5",children:h.jsx("div",{className:"w-[220px] max-w-[220px]",children:h.jsx("div",{className:"mb-0 p-0.5",children:h.jsx("div",{className:"min-w-0 flex-1 text-center",children:a&&"metadata"in a&&a.metadata?h.jsxs("div",{className:"text-xs text-stone-300",children:[h.jsx("div",{className:"mb-1 flex justify-center",children:h.jsx("div",{className:`
                          flex min-h-[20px] items-center justify-center whitespace-nowrap rounded-md border
                          border-stone-600 px-3 py-1 text-[11px] font-bold uppercase tracking-wide
                          transition-all duration-300 ease-in-out
                          ${(()=>{switch(a.phase){case"fetching":return"bg-gradient-to-r from-blue-600/80 to-blue-500/80 text-blue-100 shadow-[0_0_8px_rgba(59,130,246,0.3)]";case"fetching-operands":return"bg-gradient-to-r from-yellow-600/80 to-yellow-500/80 text-yellow-100 shadow-[0_0_8px_rgba(234,179,8,0.3)]";case"fetching-operands-completed":return"bg-gradient-to-r from-yellow-600/80 to-yellow-500/80 text-yellow-100 shadow-[0_0_8px_rgba(234,179,8,0.3)]";case"executing":return"bg-gradient-to-r from-mantis-600/80 to-mantis-500/80 text-mantis-100 shadow-[0_0_8px_rgba(34,197,94,0.3)]";case"writeback":return"bg-gradient-to-r from-purple-600/80 to-purple-500/80 text-purple-100 shadow-[0_0_8px_rgba(147,51,234,0.3)]";case"interrupt":return"bg-gradient-to-r from-red-600/80 to-red-500/80 text-red-100 shadow-[0_0_8px_rgba(239,68,68,0.3)]";case"halting":return"bg-gradient-to-r from-red-600/80 to-red-500/80 text-red-100 shadow-[0_0_8px_rgba(239,68,68,0.3)]";default:return"bg-gradient-to-r from-stone-600/80 to-stone-500/80 text-stone-100 shadow-[0_0_8px_rgba(120,113,108,0.3)]"}})()}
                        `,children:(()=>{switch(a.phase){case"fetching":return"Captación";case"fetching-operands":return"Obtención de operandos";case"fetching-operands-completed":return"Operandos obtenidos";case"executing":return"Ejecución";case"writeback":return"Escritura";case"interrupt":return"Interrupción";case"halting":return"Detener CPU";default:return"Procesando"}})()})}),h.jsxs("div",{className:"truncate text-center",children:[h.jsx("span",{className:"font-mono text-mantis-300",children:a.metadata.name}),a.metadata.operands.length>0&&h.jsxs("span",{className:"text-white",children:[" ",a.metadata.operands.join(", ")]})]})]}):h.jsx("div",{className:"text-xs text-stone-500",children:(a==null?void 0:a.phase)==="stopped"?"CPU detenida":"Esperando..."})})})})})]})]})}function kfe(){const[t,e]=x.useState(!1),[n,i]=x.useState(0);return x.useEffect(()=>{const r=()=>{e(!0),i(a=>a+1);const o=Ge().executionUnit*10;setTimeout(()=>{e(!1)},o)};return window.addEventListener("ip-register-update",r),()=>{window.removeEventListener("ip-register-update",r)}},[]),t?h.jsxs(h.Fragment,{children:[h.jsx("style",{children:`
        @keyframes slideUpAndFade {
          0% {
            opacity: 1;
            transform: translateY(0px);
          }
          30% {
            opacity: 1;
            transform: translateY(-20px);
          }
          70% {
            opacity: 1;
            transform: translateY(-20px);
          }
          100% {
            opacity: 0;
            transform: translateY(-40px);
          }
        }
      `}),Ge().animations&&h.jsx("div",{className:re("pointer-events-none absolute left-[435px] top-[332px]","font-mono text-xs font-bold"),style:{color:"#ff6347",animation:`slideUpAndFade ${Ge().executionUnit*10}ms ease-out forwards`},children:"+1"},n)]}):null}function Cfe(){const[t,e]=x.useState(!1),[n,i]=x.useState(0),[r,s]=x.useState("+1");return x.useEffect(()=>{const o=a=>{s(a.detail.type),e(!0),i(u=>u+1);const c=Ge().executionUnit*10;setTimeout(()=>{e(!1)},c)};return window.addEventListener("sp-register-update",o),()=>{window.removeEventListener("sp-register-update",o)}},[]),t?h.jsx(h.Fragment,{children:Ge().animations&&h.jsx("div",{className:re("pointer-events-none absolute left-[435px] top-[292px]","font-mono text-xs font-bold"),style:{color:"#facc15",animation:`slideUpAndFade ${Ge().executionUnit*10}ms ease-out forwards`},children:r},n)}):null}function _fe(){const t=un(),e=rt(Vb),[n,i]=x.useState(!1),[r,s]=x.useState(!1),[o,a]=x.useState(!1);return x.useEffect(()=>{const l=(u,d,f)=>{a(u==="ADD"||u==="SUB"||u==="CMP"||u==="AND"||u==="OR"||u==="XOR"||u==="NOT"||u==="NEG"||u==="DEC"||u==="INC"),i(!!d),s(!!f)},c=u=>{const d=u;l(d.detail.instruction,d.detail.modeid,d.detail.moderi)};return window.addEventListener("instructionChange",c),()=>{window.removeEventListener("instructionChange",c)}},[]),h.jsxs("div",{"data-testid":"cpu-component",className:"absolute left-0 top-0 z-10 h-[500px] w-[650px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-3xl text-white",children:t("computer.cpu.name")}),h.jsx(jse,{showSP:e,showri:r}),h.jsx(Tse,{showSP:e,showid:n,showri:r}),o&&h.jsxs(h.Fragment,{children:[h.jsx(Xi,{name:"left",className:re("left-[96px] top-[49px]","border-transparent","bg-transparent")}),h.jsx(Xi,{name:"right",className:re("left-[96px] top-[150px]","border-transparent","bg-transparent")}),h.jsx(Xi,{name:"result",className:re("left-[280px] top-[79px]","border-transparent","bg-transparent")})]}),h.jsx(gfe,{}),h.jsxs("div",{className:"absolute left-[450px] top-[30px] z-10",children:[h.jsx(Xi,{name:"AL",emphasis:!0,className:""}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-emerald-400 bg-emerald-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-emerald-400",children:"AL"})]}),h.jsxs("div",{className:"absolute left-[450px] top-[70px] z-10",children:[h.jsx(Xi,{name:"BL",emphasis:!0,className:""}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-emerald-400 bg-emerald-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-emerald-400",children:"BL"})]}),h.jsxs("div",{className:"absolute left-[450px] top-[110px] z-10",children:[h.jsx(Xi,{name:"CL",emphasis:!0,className:""}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-emerald-400 bg-emerald-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-emerald-400",children:"CL"})]}),h.jsxs("div",{className:"absolute left-[450px] top-[150px] z-10",children:[h.jsx(Xi,{name:"DL",emphasis:!0,className:""}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-emerald-400 bg-emerald-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-emerald-400",children:"DL"})]}),n&&h.jsxs("div",{className:"absolute left-[450px] top-[190px] z-10",children:[h.jsx(Xi,{name:"id",className:"border-cyan-400 pt-1"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-cyan-400 bg-cyan-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-cyan-400",children:"id"})]}),h.jsxs("div",{className:"absolute left-[450px] top-[332px] z-10",children:[h.jsx(Xi,{name:"IP",emphasis:!0,className:"border-red-500"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-red-500 bg-red-800 px-1 py-0 font-mono text-[10px] font-bold tracking-widest text-red-200",style:{textShadow:"0 1px 4px #000, 0 0px 2px #fff4"},children:"IP"})]}),h.jsxs("div",{className:"absolute left-[594px] top-[332px] z-10",children:[h.jsx(Xi,{name:"MAR",className:"border-indigo-400"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-indigo-400 bg-indigo-800 px-1 py-0 font-mono text-[10px] font-bold tracking-widest text-indigo-200",style:{textShadow:"0 1px 4px #000, 0 0px 2px #fff4"},children:"MAR"})]}),h.jsxs("div",{className:"absolute left-[594px] top-[233px] z-10",children:[h.jsx(Xi,{name:"MBR",className:"border-indigo-400"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-indigo-400 bg-indigo-800 px-1 py-0 font-mono text-[10px] font-bold tracking-widest text-indigo-200",style:{textShadow:"0 1px 4px #000, 0 0px 2px #fff4"},children:"MBR"})]}),h.jsxs("div",{className:"absolute left-[230px] top-[270px] z-10",children:[h.jsx(Xi,{name:"IR",className:"border-indigo-400"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-indigo-400 bg-indigo-800 px-1 py-0 font-mono text-[10px] font-bold tracking-widest text-indigo-200",style:{textShadow:"0 1px 4px #000, 0 0px 2px #fff4"},children:"IR"})]}),h.jsx(Sfe,{}),e&&h.jsxs("div",{className:"absolute left-[450px] top-[292px] z-10",children:[h.jsx(Xi,{name:"SP",emphasis:!0,className:"border-yellow-400 pt-2"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-yellow-400 bg-yellow-800 px-1 py-0 font-mono text-[10px] font-bold tracking-widest text-yellow-200",style:{textShadow:"0 1px 4px #000, 0 0px 2px #fff4"},children:"SP"})]}),r&&h.jsxs("div",{className:"absolute left-[450px] top-[372px] z-10",children:[h.jsx(Xi,{name:"ri",emphasis:!0,className:"border-cyan-400"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-cyan-400 bg-cyan-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-cyan-400",children:"ri"})]}),h.jsx(kfe,{}),h.jsx(Cfe,{})]})}function Xi({name:t,emphasis:e,className:n}){const i=r=>`cpu.${r}`;return h.jsx(Nr,{name:t,valueAtom:le[t],springs:i(t),emphasis:e,className:re("absolute",n)})}const wz=x.memo(({className:t})=>{const e=un(),n=rt(af),i=rt(Vp),r=rt(jl),[s]=Oo(),[o,a]=x.useState(!1),c=1e3/s.cpuSpeed;if(!s.showStatsCPU)return null;const u=r>0?(i/r).toFixed(2):"-",d=i*c,f=c/1e3,p=()=>n===0?"📊":r===0?"⏸️":"⚡",m=()=>n===0?"text-stone-400":r===0?"text-yellow-400":"text-mantis-400",g=h.jsxs("div",{className:"space-y-3 text-xs",children:[h.jsxs("div",{children:[h.jsx("strong",{className:"text-mantis-300",children:"CPI (Ciclos por Instrucción):"}),h.jsx("br",{}),h.jsx("span",{className:"text-stone-300",children:"Métrica fundamental que indica la eficiencia del procesador. Calculada como el cociente entre ciclos totales e instrucciones ejecutadas. Un CPI más bajo significa mejor rendimiento."})]}),h.jsxs("div",{children:[h.jsx("strong",{className:"text-mantis-300",children:"Tiempo de CPU:"}),h.jsx("br",{}),h.jsx("span",{className:"text-stone-300",children:"Tiempo real transcurrido durante la ejecución del programa. Se calcula multiplicando los ciclos totales por el tiempo de cada ciclo según la velocidad configurada."})]})]}),y=h.jsxs("div",{className:"space-y-3 text-xs",children:[h.jsxs("div",{children:[h.jsx("strong",{className:"text-mantis-300",children:"Velocidad CPU (Hz):"}),h.jsx("br",{}),h.jsx("span",{className:"text-stone-300",children:"Frecuencia del reloj del procesador que determina la velocidad de ejecución. Cada ciclo de reloj ejecuta una microoperación del procesador."})]}),h.jsxs("div",{children:[h.jsx("strong",{className:"text-mantis-300",children:"Tiempo por Ciclo:"}),h.jsx("br",{}),h.jsx("span",{className:"text-stone-300",children:"Duración de cada ciclo calculada como 1/velocidad. Por ejemplo, 1 MHz = 1 microsegundo por ciclo."})]})]});return h.jsxs("div",{className:re("flex flex-col gap-2 rounded-lg border border-stone-600 bg-stone-900/95 p-3 shadow-lg","min-w-[300px] max-w-[350px]",t),children:[h.jsx("div",{className:"flex items-center justify-between",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-sm font-bold uppercase tracking-wide text-mantis-400",children:e("computer.cpu.stats")}),h.jsx("button",{onClick:()=>a(!o),className:re("rounded px-2 py-1 text-xs transition-colors",o?"bg-mantis-400/20 text-mantis-400":"text-stone-400 hover:bg-mantis-400/10 hover:text-mantis-400"),children:o?"−":"+"})]})}),h.jsxs("div",{className:"flex items-center gap-3 rounded border border-stone-600 bg-stone-800/80 p-2",children:[h.jsx("div",{className:re("text-2xl",m()),children:p()}),h.jsxs("div",{className:"flex-1",children:[h.jsx("div",{className:re("text-sm font-semibold",m()),children:n>0?"Ejecutando":"En espera"}),h.jsx("div",{className:"mt-1 text-xs text-stone-400",children:r>0?`${r} instrucciones ejecutadas`:"Sin instrucciones ejecutadas"})]})]}),o&&h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"rounded border border-stone-600 bg-stone-800/80 p-2",children:[h.jsx("div",{className:"mb-2 text-xs font-bold text-mantis-400",children:"Métricas principales:"}),h.jsx("div",{className:"mb-2 text-xs text-stone-400",children:"Estadísticas acumuladas del programa completo"}),h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-xs text-stone-300",children:"Ciclos totales del programa"}),h.jsx("div",{className:"font-mono text-lg text-white",children:i})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-xs text-stone-300",children:e("computer.cpu.instruction-count")}),h.jsx("div",{className:"font-mono text-lg text-white",children:r})]})]})]}),h.jsxs("div",{className:"rounded border border-stone-600 bg-stone-800/80 p-2",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[h.jsx("span",{className:"text-xs font-bold text-mantis-400",children:"Métricas de Rendimiento:"}),h.jsx(ss,{content:g,position:"top",maxWidth:400,className:"text-stone-400 transition-colors hover:text-mantis-400",children:h.jsx("button",{className:"text-xs transition-transform hover:scale-110",children:"💡"})})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("span",{className:"text-xs text-stone-300",title:e("computer.cpu.cpi-help"),children:[e("computer.cpu.cpi"),":"]}),h.jsx("span",{className:"font-mono text-sm text-mantis-300",children:u})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-xs text-stone-300",title:`${e("computer.cpu.cpu-time-help")} (${f.toFixed(1)} s)`,children:e("computer.cpu.cpu-time")}),h.jsxs("span",{className:"font-mono text-sm text-mantis-300",children:[(d/1e3).toFixed(1)," s"]})]})]})]}),h.jsxs("div",{className:"rounded border border-stone-600 bg-stone-800/80 p-2",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[h.jsx("span",{className:"text-xs font-bold text-mantis-400",children:"Configuración Actual:"}),h.jsx(ss,{content:y,position:"top",maxWidth:400,className:"text-stone-400 transition-colors hover:text-mantis-400",children:h.jsx("button",{className:"text-xs transition-transform hover:scale-110",children:"⚙️"})})]}),h.jsx("div",{className:"space-y-1 text-xs text-stone-300",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-stone-300",children:h.jsx("strong",{children:"Velocidad CPU:"})}),h.jsxs("span",{className:"font-mono text-mantis-300",children:[s.cpuSpeed," Hz (",f.toFixed(1)," s/ciclo)"]})]})})]})]})]})});wz.displayName="CPUStats";const Efe="_pushable_1qx3l_2",Afe="_front_1qx3l_15",Pfe="_shadow_1qx3l_20",Nfe="_edge_1qx3l_52",m0={pushable:Efe,front:Afe,shadow:Pfe,edge:Nfe};function Mfe(){const t=un(),{status:e,dispatch:n,devices:i}=Kn();return ju("F10",r=>{r.preventDefault(),i.f10&&n("f10.press")},void 0,[n,i.f10]),i.f10?h.jsx("div",{className:"absolute left-[10px] top-[950px] z-10 flex h-min w-28 flex-col rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:h.jsxs("button",{className:m0.pushable,disabled:e.type!=="running",onClick:()=>n("f10.press"),children:[h.jsx("div",{className:m0.shadow}),h.jsx("div",{className:m0.edge}),h.jsx("span",{className:m0.front,children:t("computer.f10")})]})}):null}function Rfe(){const t=un(),{devices:e}=Kn();return e.handshake?h.jsxs("div",{className:"absolute left-[900px] top-[925px] z-10 h-min w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block size-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.handshake.name")}),h.jsx(Nr,{name:t("computer.handshake.state"),title:t("generics.io-register","STATE",65),valueAtom:JE,springs:"handshake.STATE",className:"mx-auto my-4"}),h.jsx("hr",{className:"border-stone-600"}),h.jsx(Nr,{name:t("computer.handshake.data"),title:t("generics.io-register","DATA",64),valueAtom:YE,springs:"handshake.DATA",className:"mx-auto my-4"})]}):null}var Sz={exports:{}};/*!
 * 
 *   react-simple-keyboard v3.8.89 (index.modern.js - Modern Browsers bundle)
 *   https://github.com/hodgef/react-simple-keyboard
 *
 *   NOTE: This modern browsers bundle (index.modern.js) removes all polyfills
 *   included in the standard version. Use this if you are supporting
 *   modern browsers only. Otherwise, use the standard version (index.js).
 *
 *   Copyright (c) Francisco Hodge (https://github.com/hodgef) and project contributors.
 *
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */(function(t,e){(function(n,i){t.exports=i(x)})(f7,function(n){return function(){var i={442:function(a){a.exports=n},651:function(a){a.exports=function(){var l={d:function(z,$){for(var W in $)l.o($,W)&&!l.o(z,W)&&Object.defineProperty(z,W,{enumerable:!0,get:$[W]})},o:function(z,$){return Object.prototype.hasOwnProperty.call(z,$)},r:function(z){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(z,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(z,"__esModule",{value:!0})}},c={};function u(z){return function($){if(Array.isArray($))return f($)}(z)||function($){if(typeof Symbol<"u"&&$[Symbol.iterator]!=null||$["@@iterator"]!=null)return Array.from($)}(z)||d(z)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function d(z,$){if(z){if(typeof z=="string")return f(z,$);var W={}.toString.call(z).slice(8,-1);return W==="Object"&&z.constructor&&(W=z.constructor.name),W==="Map"||W==="Set"?Array.from(z):W==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(W)?f(z,$):void 0}}function f(z,$){($==null||$>z.length)&&($=z.length);for(var W=0,S=Array($);W<$;W++)S[W]=z[W];return S}function p(z){return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},p(z)}function m(z,$){for(var W=0;W<$.length;W++){var S=$[W];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(z,y(S.key),S)}}function g(z,$,W){return($=y($))in z?Object.defineProperty(z,$,{value:W,enumerable:!0,configurable:!0,writable:!0}):z[$]=W,z}function y(z){var $=function(W,S){if(p(W)!="object"||!W)return W;var O=W[Symbol.toPrimitive];if(O!==void 0){var j=O.call(W,S);if(p(j)!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(W)}(z,"string");return p($)=="symbol"?$:$+""}l.r(c),l.d(c,{SimpleKeyboard:function(){return Q},default:function(){return ae}});var v=function(){return z=function S(O){var j=O.getOptions,D=O.getCaretPosition,Z=O.getCaretPositionEnd,K=O.dispatch;(function(oe,te){if(!(oe instanceof te))throw new TypeError("Cannot call a class as a function")})(this,S),g(this,"getOptions",void 0),g(this,"getCaretPosition",void 0),g(this,"getCaretPositionEnd",void 0),g(this,"dispatch",void 0),g(this,"maxLengthReached",void 0),g(this,"isStandardButton",function(oe){return oe&&!(oe[0]==="{"&&oe[oe.length-1]==="}")}),this.getOptions=j,this.getCaretPosition=D,this.getCaretPositionEnd=Z,this.dispatch=K,S.bindMethods(S,this)},$=[{key:"getButtonType",value:function(S){return S.includes("{")&&S.includes("}")&&S!=="{//}"?"functionBtn":"standardBtn"}},{key:"getButtonClass",value:function(S){var O=this.getButtonType(S),j=S.replace("{","").replace("}",""),D="";return O!=="standardBtn"&&(D=" hg-button-".concat(j)),"hg-".concat(O).concat(D)}},{key:"getDefaultDiplay",value:function(){return{"{bksp}":"backspace","{backspace}":"backspace","{enter}":"< enter","{shift}":"shift","{shiftleft}":"shift","{shiftright}":"shift","{alt}":"alt","{s}":"shift","{tab}":"tab","{lock}":"caps","{capslock}":"caps","{accept}":"Submit","{space}":" ","{//}":" ","{esc}":"esc","{escape}":"esc","{f1}":"f1","{f2}":"f2","{f3}":"f3","{f4}":"f4","{f5}":"f5","{f6}":"f6","{f7}":"f7","{f8}":"f8","{f9}":"f9","{f10}":"f10","{f11}":"f11","{f12}":"f12","{numpaddivide}":"/","{numlock}":"lock","{arrowup}":"↑","{arrowleft}":"←","{arrowdown}":"↓","{arrowright}":"→","{prtscr}":"print","{scrolllock}":"scroll","{pause}":"pause","{insert}":"ins","{home}":"home","{pageup}":"up","{delete}":"del","{forwarddelete}":"del","{end}":"end","{pagedown}":"down","{numpadmultiply}":"*","{numpadsubtract}":"-","{numpadadd}":"+","{numpadenter}":"enter","{period}":".","{numpaddecimal}":".","{numpad0}":"0","{numpad1}":"1","{numpad2}":"2","{numpad3}":"3","{numpad4}":"4","{numpad5}":"5","{numpad6}":"6","{numpad7}":"7","{numpad8}":"8","{numpad9}":"9"}}},{key:"getButtonDisplayName",value:function(S,O){return(O=arguments.length>2&&arguments[2]!==void 0&&arguments[2]?Object.assign({},this.getDefaultDiplay(),O):O||this.getDefaultDiplay())[S]||S}},{key:"getUpdatedInput",value:function(S,O,j){var D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:j,Z=arguments.length>4&&arguments[4]!==void 0&&arguments[4],K=this.getOptions(),oe=[j,D,Z],te=O;return(S==="{bksp}"||S==="{backspace}")&&te.length>0?te=this.removeAt.apply(this,[te].concat(oe)):(S==="{delete}"||S==="{forwarddelete}")&&te.length>0?te=this.removeForwardsAt.apply(this,[te].concat(oe)):S==="{space}"?te=this.addStringAt.apply(this,[te," "].concat(oe)):S!=="{tab}"||typeof K.tabCharOnTab=="boolean"&&K.tabCharOnTab===!1?S!=="{enter}"&&S!=="{numpadenter}"||!K.newLineOnEnter?S.includes("numpad")&&Number.isInteger(Number(S[S.length-2]))?te=this.addStringAt.apply(this,[te,S[S.length-2]].concat(oe)):S==="{numpaddivide}"?te=this.addStringAt.apply(this,[te,"/"].concat(oe)):S==="{numpadmultiply}"?te=this.addStringAt.apply(this,[te,"*"].concat(oe)):S==="{numpadsubtract}"?te=this.addStringAt.apply(this,[te,"-"].concat(oe)):S==="{numpadadd}"?te=this.addStringAt.apply(this,[te,"+"].concat(oe)):S==="{numpaddecimal}"?te=this.addStringAt.apply(this,[te,"."].concat(oe)):S==="{"||S==="}"?te=this.addStringAt.apply(this,[te,S].concat(oe)):S.includes("{")||S.includes("}")||(te=this.addStringAt.apply(this,[te,S].concat(oe))):te=this.addStringAt.apply(this,[te,`
`].concat(oe)):te=this.addStringAt.apply(this,[te,"	"].concat(oe)),K.debug&&console.log("Input will be: "+te),te}},{key:"updateCaretPos",value:function(S){var O=arguments.length>1&&arguments[1]!==void 0&&arguments[1],j=this.updateCaretPosAction(S,O);this.dispatch(function(D){D.setCaretPosition(j)})}},{key:"updateCaretPosAction",value:function(S){var O=arguments.length>1&&arguments[1]!==void 0&&arguments[1],j=this.getOptions(),D=this.getCaretPosition();return D!=null&&(O?D>0&&(D-=S):D+=S),j.debug&&console.log("Caret at:",D),D}},{key:"addStringAt",value:function(S,O){var j,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:S.length,Z=arguments.length>3&&arguments[3]!==void 0?arguments[3]:S.length,K=arguments.length>4&&arguments[4]!==void 0&&arguments[4];return D||D===0?(j=[S.slice(0,D),O,S.slice(Z)].join(""),this.isMaxLengthReached()||K&&this.updateCaretPos(O.length)):j=S+O,j}},{key:"removeAt",value:function(S){var O,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S.length,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:S.length,Z=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(j===0&&D===0)return S;if(j===D){var K=/([\uD800-\uDBFF][\uDC00-\uDFFF])/g;j&&j>=0?S.substring(j-2,j).match(K)?(O=S.substr(0,j-2)+S.substr(j),Z&&this.updateCaretPos(2,!0)):(O=S.substr(0,j-1)+S.substr(j),Z&&this.updateCaretPos(1,!0)):S.slice(-2).match(K)?(O=S.slice(0,-2),Z&&this.updateCaretPos(2,!0)):(O=S.slice(0,-1),Z&&this.updateCaretPos(1,!0))}else O=S.slice(0,j)+S.slice(D),Z&&this.dispatch(function(oe){oe.setCaretPosition(j)});return O}},{key:"removeForwardsAt",value:function(S){var O,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S.length,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:S.length,Z=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return S!=null&&S.length&&j!==null?(j===D?O=S.substring(j,j+2).match(/([\uD800-\uDBFF][\uDC00-\uDFFF])/g)?S.substr(0,j)+S.substr(j+2):S.substr(0,j)+S.substr(j+1):(O=S.slice(0,j)+S.slice(D),Z&&this.dispatch(function(K){K.setCaretPosition(j)})),O):S}},{key:"handleMaxLength",value:function(S,O){var j=this.getOptions(),D=j.maxLength,Z=S[j.inputName||"default"],K=O.length-1>=D;if(O.length<=Z.length)return!1;if(Number.isInteger(D))return j.debug&&console.log("maxLength (num) reached:",K),K?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1);if(p(D)==="object"){var oe=O.length-1>=D[j.inputName||"default"];return j.debug&&console.log("maxLength (obj) reached:",oe),oe?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1)}}},{key:"isMaxLengthReached",value:function(){return!!this.maxLengthReached}},{key:"isTouchDevice",value:function(){return"ontouchstart"in window||navigator.maxTouchPoints}},{key:"pointerEventsSupported",value:function(){return!!window.PointerEvent}},{key:"camelCase",value:function(S){return S?S.toLowerCase().trim().split(/[.\-_\s]/g).reduce(function(O,j){return j.length?O+j[0].toUpperCase()+j.slice(1):O}):""}},{key:"chunkArray",value:function(S,O){return u(Array(Math.ceil(S.length/O))).map(function(j,D){return S.slice(O*D,O+O*D)})}},{key:"escapeRegex",value:function(S){return S.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},{key:"getRtlOffset",value:function(S,O){var j=S,D=O.indexOf("‫");return D<S&&D!=-1&&j--,O.indexOf("‬")<S&&D!=-1&&j--,j<0?0:j}},{key:"isConstructor",value:function(S){try{Reflect.construct(String,[],S)}catch{return!1}return!0}}],W=[{key:"bindMethods",value:function(S,O){var j,D=function(K,oe){var te=typeof Symbol<"u"&&K[Symbol.iterator]||K["@@iterator"];if(!te){if(Array.isArray(K)||(te=d(K))||oe){te&&(K=te);var Oe=0,Xe=function(){};return{s:Xe,n:function(){return Oe>=K.length?{done:!0}:{done:!1,value:K[Oe++]}},e:function(we){throw we},f:Xe}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Je,Ve=!0,ct=!1;return{s:function(){te=te.call(K)},n:function(){var we=te.next();return Ve=we.done,we},e:function(we){ct=!0,Je=we},f:function(){try{Ve||te.return==null||te.return()}finally{if(ct)throw Je}}}}(Object.getOwnPropertyNames(S.prototype));try{for(D.s();!(j=D.n()).done;){var Z=j.value;Z==="constructor"||Z==="bindMethods"||(O[Z]=O[Z].bind(O))}}catch(K){D.e(K)}finally{D.f()}}}],$&&m(z.prototype,$),W&&m(z,W),Object.defineProperty(z,"prototype",{writable:!1}),z;var z,$,W}();g(v,"noop",function(){});var b=v;function w(z){return w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},w(z)}function k(z,$){for(var W=0;W<$.length;W++){var S=$[W];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(z,E(S.key),S)}}function C(z,$,W){return($=E($))in z?Object.defineProperty(z,$,{value:W,enumerable:!0,configurable:!0,writable:!0}):z[$]=W,z}function E(z){var $=function(W,S){if(w(W)!="object"||!W)return W;var O=W[Symbol.toPrimitive];if(O!==void 0){var j=O.call(W,S);if(w(j)!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(W)}(z,"string");return w($)=="symbol"?$:$+""}var _=function(){return z=function S(O){var j=this,D=O.dispatch,Z=O.getOptions;(function(K,oe){if(!(K instanceof oe))throw new TypeError("Cannot call a class as a function")})(this,S),C(this,"getOptions",void 0),C(this,"dispatch",void 0),C(this,"isModifierKey",function(K){return K.altKey||K.ctrlKey||K.shiftKey||["Tab","CapsLock","Esc","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(K.code||K.key||j.keyCodeToKey(K==null?void 0:K.keyCode))}),this.dispatch=D,this.getOptions=Z,b.bindMethods(S,this)},$=[{key:"handleHighlightKeyDown",value:function(S){var O=this.getOptions();O.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(S)&&(S.preventDefault(),S.stopImmediatePropagation());var j=this.getSimpleKeyboardLayoutKey(S);this.dispatch(function(D){var Z,K,oe=D.getButtonElement(j),te=D.getButtonElement("{".concat(j,"}"));if(oe)Z=oe,K=j;else{if(!te)return;Z=te,K="{".concat(j,"}")}var Oe,Xe,Je,Ve,ct=function($t){$t.style.background=O.physicalKeyboardHighlightBgColor||"#dadce4",$t.style.color=O.physicalKeyboardHighlightTextColor||"black"};if(Z)if(Array.isArray(Z)){if(Z.forEach(function($t){return ct($t)}),O.physicalKeyboardHighlightPress)if(O.physicalKeyboardHighlightPressUsePointerEvents)(Oe=Z[0])===null||Oe===void 0||(Xe=Oe.onpointerdown)===null||Xe===void 0||Xe.call(Oe,S);else if(O.physicalKeyboardHighlightPressUseClick){var we;(we=Z[0])===null||we===void 0||we.click()}else D.handleButtonClicked(K,S)}else ct(Z),O.physicalKeyboardHighlightPress&&(O.physicalKeyboardHighlightPressUsePointerEvents?(Je=Z)===null||Je===void 0||(Ve=Je.onpointerdown)===null||Ve===void 0||Ve.call(Je,S):O.physicalKeyboardHighlightPressUseClick?Z.click():D.handleButtonClicked(K,S))})}},{key:"handleHighlightKeyUp",value:function(S){var O=this.getOptions();O.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(S)&&(S.preventDefault(),S.stopImmediatePropagation());var j=this.getSimpleKeyboardLayoutKey(S);this.dispatch(function(D){var Z,K,oe,te=D.getButtonElement(j)||D.getButtonElement("{".concat(j,"}")),Oe=function(Xe){Xe.removeAttribute&&Xe.removeAttribute("style")};te&&(Array.isArray(te)?(te.forEach(function(Xe){return Oe(Xe)}),O.physicalKeyboardHighlightPressUsePointerEvents&&((Z=te[0])===null||Z===void 0||(K=Z.onpointerup)===null||K===void 0||K.call(Z,S))):(Oe(te),O.physicalKeyboardHighlightPressUsePointerEvents&&(te==null||(oe=te.onpointerup)===null||oe===void 0||oe.call(te,S))))})}},{key:"getSimpleKeyboardLayoutKey",value:function(S){var O,j="",D=S.code||S.key||this.keyCodeToKey(S==null?void 0:S.keyCode);return(j=D!=null&&D.includes("Numpad")||D!=null&&D.includes("Shift")||D!=null&&D.includes("Space")||D!=null&&D.includes("Backspace")||D!=null&&D.includes("Control")||D!=null&&D.includes("Alt")||D!=null&&D.includes("Meta")?S.code||"":S.key||this.keyCodeToKey(S==null?void 0:S.keyCode)||"").length>1?(O=j)===null||O===void 0?void 0:O.toLowerCase():j}},{key:"keyCodeToKey",value:function(S){return{8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Meta",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"NumpadMultiply",107:"NumpadAdd",109:"NumpadSubtract",110:"NumpadDecimal",111:"NumpadDivide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[S]||""}}],$&&k(z.prototype,$),W&&k(z,W),Object.defineProperty(z,"prototype",{writable:!1}),z;var z,$,W}();function M(z){return M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},M(z)}function R(z,$){for(var W=0;W<$.length;W++){var S=$[W];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(z,L(S.key),S)}}function T(z,$,W){return($=L($))in z?Object.defineProperty(z,$,{value:W,enumerable:!0,configurable:!0,writable:!0}):z[$]=W,z}function L(z){var $=function(W,S){if(M(W)!="object"||!W)return W;var O=W[Symbol.toPrimitive];if(O!==void 0){var j=O.call(W,S);if(M(j)!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(W)}(z,"string");return M($)=="symbol"?$:$+""}var I=function(){return z=function S(O){var j=O.utilities,D=O.options;(function(Z,K){if(!(Z instanceof K))throw new TypeError("Cannot call a class as a function")})(this,S),T(this,"utilities",void 0),T(this,"options",void 0),T(this,"candidateBoxElement",void 0),T(this,"pageIndex",0),T(this,"pageSize",void 0),this.utilities=j,this.options=D,b.bindMethods(S,this),this.pageSize=this.utilities.getOptions().layoutCandidatesPageSize||5},$=[{key:"destroy",value:function(){this.candidateBoxElement&&(this.candidateBoxElement.remove(),this.pageIndex=0)}},{key:"show",value:function(S){var O=this,j=S.candidateValue,D=S.targetElement,Z=S.onSelect;if(j&&j.length){var K=this.utilities.chunkArray(j.split(" "),this.pageSize);this.renderPage({candidateListPages:K,targetElement:D,pageIndex:this.pageIndex,nbPages:K.length,onItemSelected:function(oe,te){Z(oe,te),O.destroy()}})}}},{key:"renderPage",value:function(S){var O,j=this,D=S.candidateListPages,Z=S.targetElement,K=S.pageIndex,oe=S.nbPages,te=S.onItemSelected;(O=this.candidateBoxElement)===null||O===void 0||O.remove(),this.candidateBoxElement=document.createElement("div"),this.candidateBoxElement.className="hg-candidate-box";var Oe=document.createElement("ul");Oe.className="hg-candidate-box-list",D[K].forEach(function(On){var ac,Vs=document.createElement("li"),Ea=function(){var Aa=new(j.options.useTouchEvents?TouchEvent:MouseEvent)("click");return Object.defineProperty(Aa,"target",{value:Vs}),Aa};Vs.className="hg-candidate-box-list-item",Vs.innerHTML=((ac=j.options.display)===null||ac===void 0?void 0:ac[On])||On,j.options.useTouchEvents?Vs.ontouchstart=function(Aa){return te(On,Aa||Ea())}:Vs.onclick=function(){var Aa=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ea();return te(On,Aa)},Oe.appendChild(Vs)});var Xe=K>0,Je=document.createElement("div");Je.classList.add("hg-candidate-box-prev"),Xe&&Je.classList.add("hg-candidate-box-btn-active");var Ve=function(){Xe&&j.renderPage({candidateListPages:D,targetElement:Z,pageIndex:K-1,nbPages:oe,onItemSelected:te})};this.options.useTouchEvents?Je.ontouchstart=Ve:Je.onclick=Ve,this.candidateBoxElement.appendChild(Je),this.candidateBoxElement.appendChild(Oe);var ct=K<oe-1,we=document.createElement("div");we.classList.add("hg-candidate-box-next"),ct&&we.classList.add("hg-candidate-box-btn-active");var $t=function(){ct&&j.renderPage({candidateListPages:D,targetElement:Z,pageIndex:K+1,nbPages:oe,onItemSelected:te})};this.options.useTouchEvents?we.ontouchstart=$t:we.onclick=$t,this.candidateBoxElement.appendChild(we),Z.prepend(this.candidateBoxElement)}}],$&&R(z.prototype,$),W&&R(z,W),Object.defineProperty(z,"prototype",{writable:!1}),z;var z,$,W}(),G=I;function B(z){return function($){if(Array.isArray($))return q($)}(z)||function($){if(typeof Symbol<"u"&&$[Symbol.iterator]!=null||$["@@iterator"]!=null)return Array.from($)}(z)||function($,W){if($){if(typeof $=="string")return q($,W);var S={}.toString.call($).slice(8,-1);return S==="Object"&&$.constructor&&(S=$.constructor.name),S==="Map"||S==="Set"?Array.from($):S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S)?q($,W):void 0}}(z)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function q(z,$){($==null||$>z.length)&&($=z.length);for(var W=0,S=Array($);W<$;W++)S[W]=z[W];return S}function Y(z){return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},Y(z)}function ne(z,$){var W=Object.keys(z);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(z);$&&(S=S.filter(function(O){return Object.getOwnPropertyDescriptor(z,O).enumerable})),W.push.apply(W,S)}return W}function V(z,$){for(var W=0;W<$.length;W++){var S=$[W];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(z,se(S.key),S)}}function U(z,$,W){return($=se($))in z?Object.defineProperty(z,$,{value:W,enumerable:!0,configurable:!0,writable:!0}):z[$]=W,z}function se(z){var $=function(W,S){if(Y(W)!="object"||!W)return W;var O=W[Symbol.toPrimitive];if(O!==void 0){var j=O.call(W,S);if(Y(j)!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(W)}(z,"string");return Y($)=="symbol"?$:$+""}var Ce=function(){return z=function S(O,j){var D=this;if(function(Ve,ct){if(!(Ve instanceof ct))throw new TypeError("Cannot call a class as a function")}(this,S),U(this,"input",void 0),U(this,"options",void 0),U(this,"utilities",void 0),U(this,"caretPosition",void 0),U(this,"caretPositionEnd",void 0),U(this,"keyboardDOM",void 0),U(this,"keyboardPluginClasses",void 0),U(this,"keyboardDOMClass",void 0),U(this,"buttonElements",void 0),U(this,"currentInstanceName",void 0),U(this,"allKeyboardInstances",void 0),U(this,"keyboardInstanceNames",void 0),U(this,"isFirstKeyboardInstance",void 0),U(this,"physicalKeyboard",void 0),U(this,"modules",void 0),U(this,"activeButtonClass",void 0),U(this,"holdInteractionTimeout",void 0),U(this,"holdTimeout",void 0),U(this,"isMouseHold",void 0),U(this,"initialized",void 0),U(this,"candidateBox",void 0),U(this,"keyboardRowsDOM",void 0),U(this,"defaultName","default"),U(this,"activeInputElement",null),U(this,"handleParams",function(Ve,ct){var we,$t,On;if(typeof Ve=="string")we=Ve.split(".").join(""),$t=document.querySelector(".".concat(we)),On=ct;else if(Ve instanceof HTMLDivElement){if(!Ve.className)throw console.warn("Any DOM element passed as parameter must have a class."),new Error("KEYBOARD_DOM_CLASS_ERROR");we=Ve.className.split(" ")[0],$t=Ve,On=ct}else we="simple-keyboard",$t=document.querySelector(".".concat(we)),On=Ve;return{keyboardDOMClass:we,keyboardDOM:$t,options:On}}),U(this,"getOptions",function(){return D.options}),U(this,"getCaretPosition",function(){return D.caretPosition}),U(this,"getCaretPositionEnd",function(){return D.caretPositionEnd}),U(this,"registerModule",function(Ve,ct){D.modules[Ve]||(D.modules[Ve]={}),ct(D.modules[Ve])}),U(this,"getKeyboardClassString",function(){for(var Ve=arguments.length,ct=new Array(Ve),we=0;we<Ve;we++)ct[we]=arguments[we];return[D.keyboardDOMClass].concat(ct).filter(function($t){return!!$t}).join(" ")}),typeof window<"u"){var Z=this.handleParams(O,j),K=Z.keyboardDOMClass,oe=Z.keyboardDOM,te=Z.options,Oe=te===void 0?{}:te;this.utilities=new b({getOptions:this.getOptions,getCaretPosition:this.getCaretPosition,getCaretPositionEnd:this.getCaretPositionEnd,dispatch:this.dispatch}),this.caretPosition=null,this.caretPositionEnd=null,this.keyboardDOM=oe,this.options=function(Ve){for(var ct=1;ct<arguments.length;ct++){var we=arguments[ct]!=null?arguments[ct]:{};ct%2?ne(Object(we),!0).forEach(function($t){U(Ve,$t,we[$t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ve,Object.getOwnPropertyDescriptors(we)):ne(Object(we)).forEach(function($t){Object.defineProperty(Ve,$t,Object.getOwnPropertyDescriptor(we,$t))})}return Ve}({layoutName:"default",theme:"hg-theme-default",inputName:"default",preventMouseDownDefault:!1,enableLayoutCandidates:!0,excludeFromLayout:{}},Oe),this.keyboardPluginClasses="",b.bindMethods(S,this);var Xe=this.options.inputName,Je=Xe===void 0?this.defaultName:Xe;if(this.input={},this.input[Je]="",this.keyboardDOMClass=K,this.buttonElements={},window.SimpleKeyboardInstances||(window.SimpleKeyboardInstances={}),this.currentInstanceName=this.utilities.camelCase(this.keyboardDOMClass),window.SimpleKeyboardInstances[this.currentInstanceName]=this,this.allKeyboardInstances=window.SimpleKeyboardInstances,this.keyboardInstanceNames=Object.keys(window.SimpleKeyboardInstances),this.isFirstKeyboardInstance=this.keyboardInstanceNames[0]===this.currentInstanceName,this.physicalKeyboard=new _({dispatch:this.dispatch,getOptions:this.getOptions}),this.candidateBox=this.options.enableLayoutCandidates?new G({utilities:this.utilities,options:this.options}):null,!this.keyboardDOM)throw console.warn('".'.concat(K,'" was not found in the DOM.')),new Error("KEYBOARD_DOM_ERROR");this.render(),this.modules={},this.loadModules()}},$=[{key:"setCaretPosition",value:function(S){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S;this.caretPosition=S,this.caretPositionEnd=O}},{key:"getInputCandidates",value:function(S){var O=this,j=this.options,D=j.layoutCandidates,Z=j.layoutCandidatesCaseSensitiveMatch;if(!D||Y(D)!=="object")return{};var K=Object.keys(D).filter(function(Oe){var Xe=S.substring(0,O.getCaretPositionEnd()||0)||S,Je=new RegExp("".concat(O.utilities.escapeRegex(Oe),"$"),Z?"g":"gi");return!!B(Xe.matchAll(Je)).length});if(K.length>1){var oe=K.sort(function(Oe,Xe){return Xe.length-Oe.length})[0];return{candidateKey:oe,candidateValue:D[oe]}}if(K.length){var te=K[0];return{candidateKey:te,candidateValue:D[te]}}return{}}},{key:"showCandidatesBox",value:function(S,O,j){var D=this;this.candidateBox&&this.candidateBox.show({candidateValue:O,targetElement:j,onSelect:function(Z,K){var oe=D.options,te=oe.layoutCandidatesCaseSensitiveMatch,Oe=oe.disableCandidateNormalization,Xe=oe.enableLayoutCandidatesKeyPress,Je=Z;Oe||(Je=Z.normalize("NFD")),typeof D.options.beforeInputUpdate=="function"&&D.options.beforeInputUpdate(D);var Ve=D.getInput(D.options.inputName,!0),ct=D.getCaretPositionEnd()||0,we=Ve.substring(0,ct||0)||Ve,$t=new RegExp("".concat(D.utilities.escapeRegex(S),"$"),te?"g":"gi"),On=we.replace($t,Je),ac=Ve.replace(we,On),Vs=On.length-we.length,Ea=(ct||Ve.length)+Vs;Ea<0&&(Ea=0),D.setInput(ac,D.options.inputName,!0),D.setCaretPosition(Ea),Xe&&typeof D.options.onKeyPress=="function"&&D.options.onKeyPress(Z,K),typeof D.options.onChange=="function"&&D.options.onChange(D.getInput(D.options.inputName,!0),K),typeof D.options.onChangeAll=="function"&&D.options.onChangeAll(D.getAllInputs(),K)}})}},{key:"handleButtonClicked",value:function(S,O){var j=this.options,D=j.inputName,Z=D===void 0?this.defaultName:D,K=j.debug;if(S!=="{//}"){this.input[Z]||(this.input[Z]=""),typeof this.options.beforeInputUpdate=="function"&&this.options.beforeInputUpdate(this);var oe=this.utilities.getUpdatedInput(S,this.input[Z],this.caretPosition,this.caretPositionEnd);if(this.utilities.isStandardButton(S)&&this.activeInputElement&&this.input[Z]&&this.input[Z]===oe&&this.caretPosition===0&&this.caretPositionEnd===oe.length)return this.setInput("",this.options.inputName,!0),this.setCaretPosition(0),this.activeInputElement.value="",this.activeInputElement.setSelectionRange(0,0),void this.handleButtonClicked(S,O);if(typeof this.options.onKeyPress=="function"&&this.options.onKeyPress(S,O),this.input[Z]!==oe&&(!this.options.inputPattern||this.options.inputPattern&&this.inputPatternIsValid(oe))){if(this.options.maxLength&&this.utilities.handleMaxLength(this.input,oe))return;var te=this.utilities.getUpdatedInput(S,this.input[Z],this.caretPosition,this.caretPositionEnd,!0);if(this.setInput(te,this.options.inputName,!0),K&&console.log("Input changed:",this.getAllInputs()),this.options.debug&&console.log("Caret at: ",this.getCaretPosition(),this.getCaretPositionEnd(),"(".concat(this.keyboardDOMClass,")"),O==null?void 0:O.type),this.options.syncInstanceInputs&&this.syncInstanceInputs(),typeof this.options.onChange=="function"&&this.options.onChange(this.getInput(this.options.inputName,!0),O),typeof this.options.onChangeAll=="function"&&this.options.onChangeAll(this.getAllInputs(),O),O!=null&&O.target&&this.options.enableLayoutCandidates){var Oe,Xe=this.getInputCandidates(oe),Je=Xe.candidateKey,Ve=Xe.candidateValue;Je&&Ve?this.showCandidatesBox(Je,Ve,this.keyboardDOM):(Oe=this.candidateBox)===null||Oe===void 0||Oe.destroy()}}this.caretPositionEnd&&this.caretPosition!==this.caretPositionEnd&&(this.setCaretPosition(this.caretPositionEnd,this.caretPositionEnd),this.activeInputElement&&this.activeInputElement.setSelectionRange(this.caretPositionEnd,this.caretPositionEnd),this.options.debug&&console.log("Caret position aligned",this.caretPosition)),K&&console.log("Key pressed:",S)}}},{key:"getMouseHold",value:function(){return this.isMouseHold}},{key:"setMouseHold",value:function(S){this.options.syncInstanceInputs?this.dispatch(function(O){O.isMouseHold=S}):this.isMouseHold=S}},{key:"handleButtonMouseDown",value:function(S,O){var j=this;O&&(this.options.preventMouseDownDefault&&O.preventDefault(),this.options.stopMouseDownPropagation&&O.stopPropagation(),O.target.classList.add(this.activeButtonClass)),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdTimeout&&clearTimeout(this.holdTimeout),this.setMouseHold(!0),this.options.disableButtonHold||(this.holdTimeout=window.setTimeout(function(){(j.getMouseHold()&&(!S.includes("{")&&!S.includes("}")||S==="{delete}"||S==="{backspace}"||S==="{bksp}"||S==="{space}"||S==="{tab}")||S==="{arrowright}"||S==="{arrowleft}"||S==="{arrowup}"||S==="{arrowdown}")&&(j.options.debug&&console.log("Button held:",S),j.handleButtonHold(S)),clearTimeout(j.holdTimeout)},500))}},{key:"handleButtonMouseUp",value:function(S,O){var j=this;O&&(this.options.preventMouseUpDefault&&O.preventDefault&&O.preventDefault(),this.options.stopMouseUpPropagation&&O.stopPropagation&&O.stopPropagation(),!(O.target===this.keyboardDOM||O.target&&this.keyboardDOM.contains(O.target)||this.candidateBox&&this.candidateBox.candidateBoxElement&&(O.target===this.candidateBox.candidateBoxElement||O.target&&this.candidateBox.candidateBoxElement.contains(O.target)))&&this.candidateBox&&this.candidateBox.destroy()),this.recurseButtons(function(D){D.classList.remove(j.activeButtonClass)}),this.setMouseHold(!1),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),S&&typeof this.options.onKeyReleased=="function"&&this.options.onKeyReleased(S,O)}},{key:"handleKeyboardContainerMouseDown",value:function(S){this.options.preventMouseDownDefault&&S.preventDefault()}},{key:"handleButtonHold",value:function(S){var O=this;this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdInteractionTimeout=window.setTimeout(function(){O.getMouseHold()?(O.handleButtonClicked(S),O.handleButtonHold(S)):clearTimeout(O.holdInteractionTimeout)},100)}},{key:"syncInstanceInputs",value:function(){var S=this;this.dispatch(function(O){O.replaceInput(S.input),O.setCaretPosition(S.caretPosition,S.caretPositionEnd)})}},{key:"clearInput",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName;this.input[S]="",this.setCaretPosition(0),this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"getInput",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName,O=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.options.syncInstanceInputs&&!O&&this.syncInstanceInputs(),this.options.rtl?"‫"+this.input[S].replace("‫","").replace("‬","")+"‬":this.input[S]}},{key:"getAllInputs",value:function(){var S=this,O={};return Object.keys(this.input).forEach(function(j){O[j]=S.getInput(j,!0)}),O}},{key:"setInput",value:function(S){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.inputName||this.defaultName,j=arguments.length>2?arguments[2]:void 0;this.input[O]=S,!j&&this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"replaceInput",value:function(S){this.input=S}},{key:"setOptions",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},O=this.changedOptions(S);this.options=Object.assign(this.options,S),O.length&&(this.options.debug&&console.log("changedOptions",O),this.onSetOptions(O),this.render())}},{key:"changedOptions",value:function(S){var O=this;return Object.keys(S).filter(function(j){return JSON.stringify(S[j])!==JSON.stringify(O.options[j])})}},{key:"onSetOptions",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];S.includes("layoutName")&&this.candidateBox&&this.candidateBox.destroy(),(S.includes("layoutCandidatesPageSize")||S.includes("layoutCandidates"))&&this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=new G({utilities:this.utilities,options:this.options}))}},{key:"resetRows",value:function(){this.keyboardRowsDOM&&this.keyboardRowsDOM.remove(),this.keyboardDOM.className=this.keyboardDOMClass,this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.buttonElements={}}},{key:"dispatch",value:function(S){if(!window.SimpleKeyboardInstances)throw console.warn("SimpleKeyboardInstances is not defined. Dispatch cannot be called."),new Error("INSTANCES_VAR_ERROR");return Object.keys(window.SimpleKeyboardInstances).forEach(function(O){S(window.SimpleKeyboardInstances[O],O)})}},{key:"addButtonTheme",value:function(S,O){var j=this;O&&S&&(S.split(" ").forEach(function(D){O.split(" ").forEach(function(Z){j.options.buttonTheme||(j.options.buttonTheme=[]);var K=!1;j.options.buttonTheme.map(function(oe){if(oe!=null&&oe.class.split(" ").includes(Z)){K=!0;var te=oe.buttons.split(" ");te.includes(D)||(K=!0,te.push(D),oe.buttons=te.join(" "))}return oe}),K||j.options.buttonTheme.push({class:Z,buttons:S})})}),this.render())}},{key:"removeButtonTheme",value:function(S,O){var j=this;if(!S&&!O)return this.options.buttonTheme=[],void this.render();S&&Array.isArray(this.options.buttonTheme)&&this.options.buttonTheme.length&&(S.split(" ").forEach(function(D){var Z;(Z=j.options)===null||Z===void 0||(Z=Z.buttonTheme)===null||Z===void 0||Z.map(function(K,oe){if(K&&O&&O.includes(K.class)||!O){var te,Oe,Xe=(te=K)===null||te===void 0?void 0:te.buttons.split(" ").filter(function(Je){return Je!==D});K&&Xe!=null&&Xe.length?K.buttons=Xe.join(" "):((Oe=j.options.buttonTheme)===null||Oe===void 0||Oe.splice(oe,1),K=null)}return K})}),this.render())}},{key:"getButtonElement",value:function(S){var O,j=this.buttonElements[S];return j&&(O=j.length>1?j:j[0]),O}},{key:"inputPatternIsValid",value:function(S){var O,j=this.options.inputPattern;if((O=j instanceof RegExp?j:j[this.options.inputName||this.defaultName])&&S){var D=O.test(S);return this.options.debug&&console.log('inputPattern ("'.concat(O,'"): ').concat(D?"passed":"did not pass!")),D}return!0}},{key:"setEventListeners",value:function(){if(this.isFirstKeyboardInstance||!this.allKeyboardInstances){this.options.debug&&console.log("Caret handling started (".concat(this.keyboardDOMClass,")"));var S=this.options.physicalKeyboardHighlightPreventDefault,O=S!==void 0&&S;document.addEventListener("keyup",this.handleKeyUp,O),document.addEventListener("keydown",this.handleKeyDown,O),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchend",this.handleTouchEnd),this.options.updateCaretOnSelectionChange&&document.addEventListener("selectionchange",this.handleSelectionChange),document.addEventListener("select",this.handleSelect)}}},{key:"handleKeyUp",value:function(S){this.caretEventHandler(S),this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyUp(S)}},{key:"handleKeyDown",value:function(S){this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyDown(S)}},{key:"handleMouseUp",value:function(S){this.caretEventHandler(S)}},{key:"handleTouchEnd",value:function(S){this.caretEventHandler(S)}},{key:"handleSelect",value:function(S){this.caretEventHandler(S)}},{key:"handleSelectionChange",value:function(S){navigator.userAgent.includes("Firefox")||this.caretEventHandler(S)}},{key:"caretEventHandler",value:function(S){var O,j=this;S.target.tagName&&(O=S.target.tagName.toLowerCase()),this.dispatch(function(D){var Z=S.target===D.keyboardDOM||S.target&&D.keyboardDOM.contains(S.target);if(j.options.syncInstanceInputs&&Array.isArray(S.path)&&(Z=S.path.some(function(te){var Oe;return te==null||(Oe=te.hasAttribute)===null||Oe===void 0?void 0:Oe.call(te,"data-skInstance")})),(O==="textarea"||O==="input"&&["text","search","url","tel","password"].includes(S.target.type))&&!D.options.disableCaretPositioning){var K=S.target.selectionStart,oe=S.target.selectionEnd;D.options.rtl&&(K=D.utilities.getRtlOffset(K,D.getInput()),oe=D.utilities.getRtlOffset(oe,D.getInput())),D.setCaretPosition(K,oe),D.activeInputElement=S.target,D.options.debug&&console.log("Caret at: ",D.getCaretPosition(),D.getCaretPositionEnd(),S&&S.target.tagName.toLowerCase(),"(".concat(D.keyboardDOMClass,")"),S==null?void 0:S.type)}else!D.options.disableCaretPositioning&&Z||(S==null?void 0:S.type)==="selectionchange"||(D.setCaretPosition(null),D.activeInputElement=null,D.options.debug&&console.log('Caret position reset due to "'.concat(S==null?void 0:S.type,'" event'),S))})}},{key:"recurseButtons",value:function(S){var O=this;S&&Object.keys(this.buttonElements).forEach(function(j){return O.buttonElements[j].forEach(S)})}},{key:"destroy",value:function(){this.options.debug&&console.log("Destroying simple-keyboard instance: ".concat(this.currentInstanceName));var S=this.options.physicalKeyboardHighlightPreventDefault,O=S!==void 0&&S;document.removeEventListener("keyup",this.handleKeyUp,O),document.removeEventListener("keydown",this.handleKeyDown,O),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchend",this.handleTouchEnd),document.removeEventListener("select",this.handleSelect),this.options.updateCaretOnSelectionChange&&document.removeEventListener("selectionchange",this.handleSelectionChange),document.onpointerup=null,document.ontouchend=null,document.ontouchcancel=null,document.onmouseup=null,this.recurseButtons(function(j){j&&(j.onpointerdown=null,j.onpointerup=null,j.onpointercancel=null,j.ontouchstart=null,j.ontouchend=null,j.ontouchcancel=null,j.onclick=null,j.onmousedown=null,j.onmouseup=null,j.remove(),j=null)}),this.keyboardDOM.onpointerdown=null,this.keyboardDOM.ontouchstart=null,this.keyboardDOM.onmousedown=null,this.resetRows(),this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=null),this.activeInputElement=null,this.keyboardDOM.removeAttribute("data-skInstance"),this.keyboardDOM.innerHTML="",window.SimpleKeyboardInstances[this.currentInstanceName]=null,delete window.SimpleKeyboardInstances[this.currentInstanceName],this.initialized=!1}},{key:"getButtonThemeClasses",value:function(S){var O=this.options.buttonTheme,j=[];return Array.isArray(O)&&O.forEach(function(D){if(D&&D.class&&typeof D.class=="string"&&D.buttons&&typeof D.buttons=="string"){var Z=D.class.split(" ");D.buttons.split(" ").includes(S)&&(j=[].concat(B(j),B(Z)))}else console.warn('Incorrect "buttonTheme". Please check the documentation.',D)}),j}},{key:"setDOMButtonAttributes",value:function(S,O){var j=this.options.buttonAttributes;Array.isArray(j)&&j.forEach(function(D){D.attribute&&typeof D.attribute=="string"&&D.value&&typeof D.value=="string"&&D.buttons&&typeof D.buttons=="string"?D.buttons.split(" ").includes(S)&&O(D.attribute,D.value):console.warn('Incorrect "buttonAttributes". Please check the documentation.',D)})}},{key:"onTouchDeviceDetected",value:function(){this.processAutoTouchEvents(),this.disableContextualWindow()}},{key:"disableContextualWindow",value:function(){window.oncontextmenu=function(S){var O;if((O=S.target.classList)!==null&&O!==void 0&&O.contains("hg-button"))return S.preventDefault(),S.stopPropagation(),!1}}},{key:"processAutoTouchEvents",value:function(){this.options.autoUseTouchEvents&&(this.options.useTouchEvents=!0,this.options.debug&&console.log("autoUseTouchEvents: Touch device detected, useTouchEvents enabled."))}},{key:"onInit",value:function(){this.options.debug&&console.log("".concat(this.keyboardDOMClass," Initialized")),this.setEventListeners(),typeof this.options.onInit=="function"&&this.options.onInit(this)}},{key:"beforeFirstRender",value:function(){this.utilities.isTouchDevice()&&this.onTouchDeviceDetected(),typeof this.options.beforeFirstRender=="function"&&this.options.beforeFirstRender(this),this.isFirstKeyboardInstance&&this.utilities.pointerEventsSupported()&&!this.options.useTouchEvents&&!this.options.useMouseEvents&&this.options.debug&&console.log("Using PointerEvents as it is supported by this browser"),this.options.useTouchEvents&&this.options.debug&&console.log("useTouchEvents has been enabled. Only touch events will be used.")}},{key:"beforeRender",value:function(){typeof this.options.beforeRender=="function"&&this.options.beforeRender(this)}},{key:"onRender",value:function(){typeof this.options.onRender=="function"&&this.options.onRender(this)}},{key:"onModulesLoaded",value:function(){typeof this.options.onModulesLoaded=="function"&&this.options.onModulesLoaded(this)}},{key:"loadModules",value:function(){var S=this;Array.isArray(this.options.modules)&&(this.options.modules.forEach(function(O){var j=S.utilities.isConstructor(O)?new O(S):O(S);j.init&&j.init(S)}),this.keyboardPluginClasses="modules-loaded",this.render(),this.onModulesLoaded())}},{key:"getModuleProp",value:function(S,O){return!!this.modules[S]&&this.modules[S][O]}},{key:"getModulesList",value:function(){return Object.keys(this.modules)}},{key:"parseRowDOMContainers",value:function(S,O,j,D){var Z=this,K=Array.from(S.children),oe=0;return K.length&&j.forEach(function(te,Oe){var Xe=D[Oe];if(!(Xe&&Xe>te))return!1;var Je=te-oe,Ve=Xe-oe,ct=document.createElement("div");ct.className+="hg-button-container";var we="".concat(Z.options.layoutName,"-r").concat(O,"c").concat(Oe);ct.setAttribute("data-skUID",we);var $t=K.splice(Je,Ve-Je+1);oe+=Ve-Je,$t.forEach(function(On){return ct.appendChild(On)}),K.splice(Je,0,ct),S.innerHTML="",K.forEach(function(On){return S.appendChild(On)}),Z.options.debug&&console.log("rowDOMContainer",$t,Je,Ve,oe+1)}),S}},{key:"render",value:function(){var S=this;this.resetRows(),this.initialized||this.beforeFirstRender(),this.beforeRender();var O="hg-layout-".concat(this.options.layoutName),j=this.options.layout||{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]},D=this.options.useTouchEvents||!1,Z=D?"hg-touch-events":"",K=this.options.useMouseEvents||!1,oe=this.options.disableRowButtonContainers;this.keyboardDOM.className=this.getKeyboardClassString(this.options.theme,O,this.keyboardPluginClasses,Z),this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.keyboardRowsDOM=document.createElement("div"),this.keyboardRowsDOM.className="hg-rows",j[this.options.layoutName||this.defaultName].forEach(function(te,Oe){var Xe=te.split(" ");S.options.excludeFromLayout&&S.options.excludeFromLayout[S.options.layoutName||S.defaultName]&&(Xe=Xe.filter(function(we){return S.options.excludeFromLayout&&!S.options.excludeFromLayout[S.options.layoutName||S.defaultName].includes(we)}));var Je=document.createElement("div");Je.className+="hg-row";var Ve=[],ct=[];Xe.forEach(function(we,$t){var On,ac=!oe&&typeof we=="string"&&we.length>1&&we.indexOf("[")===0,Vs=!oe&&typeof we=="string"&&we.length>1&&we.indexOf("]")===we.length-1;ac&&(Ve.push($t),we=we.replace(/\[/g,"")),Vs&&(ct.push($t),we=we.replace(/\]/g,""));var Ea=S.utilities.getButtonClass(we),Aa=S.utilities.getButtonDisplayName(we,S.options.display,S.options.mergeDisplay),o7=S.options.useButtonTag?"button":"div",Yn=document.createElement(o7);Yn.className+="hg-button ".concat(Ea),(On=Yn.classList).add.apply(On,B(S.getButtonThemeClasses(we))),S.setDOMButtonAttributes(we,function(bn,l7){Yn.setAttribute(bn,l7)}),S.activeButtonClass="hg-activeButton",!S.utilities.pointerEventsSupported()||D||K?D?(Yn.ontouchstart=function(bn){S.handleButtonClicked(we,bn),S.handleButtonMouseDown(we,bn)},Yn.ontouchend=function(bn){S.handleButtonMouseUp(we,bn)},Yn.ontouchcancel=function(bn){S.handleButtonMouseUp(we,bn)}):(Yn.onclick=function(bn){S.setMouseHold(!1),typeof S.options.onKeyReleased=="function"||S.options.useMouseEvents&&S.options.clickOnMouseDown||S.handleButtonClicked(we,bn)},Yn.onmousedown=function(bn){(typeof S.options.onKeyReleased=="function"||S.options.useMouseEvents&&S.options.clickOnMouseDown)&&!S.isMouseHold&&S.handleButtonClicked(we,bn),S.handleButtonMouseDown(we,bn)},Yn.onmouseup=function(bn){S.handleButtonMouseUp(we,bn)}):(Yn.onpointerdown=function(bn){S.handleButtonClicked(we,bn),S.handleButtonMouseDown(we,bn)},Yn.onpointerup=function(bn){S.handleButtonMouseUp(we,bn)},Yn.onpointercancel=function(bn){S.handleButtonMouseUp(we,bn)}),Yn.setAttribute("data-skBtn",we);var a7="".concat(S.options.layoutName,"-r").concat(Oe,"b").concat($t);Yn.setAttribute("data-skBtnUID",a7);var uP=document.createElement("span");uP.innerHTML=Aa,Yn.appendChild(uP),S.buttonElements[we]||(S.buttonElements[we]=[]),S.buttonElements[we].push(Yn),Je.appendChild(Yn)}),Je=S.parseRowDOMContainers(Je,Oe,Ve,ct),S.keyboardRowsDOM.appendChild(Je)}),this.keyboardDOM.appendChild(this.keyboardRowsDOM),this.onRender(),this.initialized||(this.initialized=!0,!this.utilities.pointerEventsSupported()||D||K?D?(document.ontouchend=function(te){return S.handleButtonMouseUp(void 0,te)},document.ontouchcancel=function(te){return S.handleButtonMouseUp(void 0,te)},this.keyboardDOM.ontouchstart=function(te){return S.handleKeyboardContainerMouseDown(te)}):D||(document.onmouseup=function(te){return S.handleButtonMouseUp(void 0,te)},this.keyboardDOM.onmousedown=function(te){return S.handleKeyboardContainerMouseDown(te)}):(document.onpointerup=function(te){return S.handleButtonMouseUp(void 0,te)},this.keyboardDOM.onpointerdown=function(te){return S.handleKeyboardContainerMouseDown(te)}),this.onInit())}}],$&&V(z.prototype,$),W&&V(z,W),Object.defineProperty(z,"prototype",{writable:!1}),z;var z,$,W}(),Q=Ce,ae=Q;return c}()}},r={};function s(a){var l=r[a];if(l!==void 0)return l.exports;var c=r[a]={exports:{}};return i[a].call(c.exports,c,c.exports,s),c.exports}s.n=function(a){var l=a&&a.__esModule?function(){return a.default}:function(){return a};return s.d(l,{a:l}),l},s.d=function(a,l){for(var c in l)s.o(l,c)&&!s.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:l[c]})},s.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)},s.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var o={};return function(){s.r(o),s.d(o,{KeyboardReact:function(){return g},default:function(){return y}});var a=s(442);function l(v){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},l(v)}function c(v,b){var w=Object.keys(v);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(v);b&&(k=k.filter(function(C){return Object.getOwnPropertyDescriptor(v,C).enumerable})),w.push.apply(w,k)}return w}function u(v){for(var b=1;b<arguments.length;b++){var w=arguments[b]!=null?arguments[b]:{};b%2?c(Object(w),!0).forEach(function(k){d(v,k,w[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(w)):c(Object(w)).forEach(function(k){Object.defineProperty(v,k,Object.getOwnPropertyDescriptor(w,k))})}return v}function d(v,b,w){return(b=function(k){var C=function(E,_){if(l(E)!="object"||!E)return E;var M=E[Symbol.toPrimitive];if(M!==void 0){var R=M.call(E,_);if(l(R)!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(E)}(k,"string");return l(C)=="symbol"?C:C+""}(b))in v?Object.defineProperty(v,b,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[b]=w,v}var f=function(v){return u(u({},v),{},{keyboardRef:null})},p=s(651),m=s.n(p),g=function(v){var b=v.baseClass||"react-simple-keyboard",w=a.useRef(null),k=a.useRef(null),C=a.useRef(null),E=a.useRef(v);return a.useEffect(function(){return function(){C.current&&C.current.destroy(),w.current=!1}},[]),a.useEffect(function(){var _=function(I){return u(u({},I),{},{theme:"simple-keyboard ".concat(I.theme||"hg-theme-default")})}(v);if(!w.current){w.current=!0,_.debug&&console.log("ReactSimpleKeyboard: Init");var M=k.current,R=".".concat(b);C.current=new(m())(M||R,_),_.keyboardRef&&_.keyboardRef(C.current)}var T=function(I,G){var B=f(G),q=f(I);return Object.keys(B).filter(function(Y){return B[Y]!==q[Y]})}(E.current,_);if(T.length){var L=C.current;E.current=_,L==null||L.setOptions(_),_.debug&&console.log("ReactSimpleKeyboard - setOptions called due to updated props:",T)}},[w,b,E,v]),a.createElement("div",{className:b,ref:k})},y=g}(),o}()})})(Sz);var Ife=Sz.exports;const Tfe=du(Ife),Ofe={en:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shiftleft} z x c v b n m , . / {shiftright}","{space}"],"en-shift":["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shiftleft} Z X C V B N M < > ? {shiftright}","{space}"],es:["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w e r t y u i o p ́ +","{lock} a s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W E R T Y U I O P ̈ *","{lock} A S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"],"es-accent":["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w é r t y ú í ó p ́ +","{lock} á s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-accent-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W É R T Y Ú Í Ó P ̈ *","{lock} Á S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"],"es-diaeresis-default":["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w e r t y ü i o p ́ +","{lock} a s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-diaeresis-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W E R T Y Ü I O P ̈ *","{lock} A S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"]},Lfe={en:{"{bksp}":"Backspace ⌫","{enter}":"Enter ↵","{shiftleft}":"Shift ⇧","{shiftright}":"Shift ⇧","{tab}":"Tab ⇥","{lock}":"Caps Lock ⇪","{space}":"Space"},es:{"{bksp}":"⌫","{enter}":"Intro ↵","{shiftleft}":"Shift ⇧","{shiftright}":"Shift ⇧","{tab}":"Tab ⇥","{lock}":"Bloq Mayús ⇪","{space}":"Espacio"}},y3="Á É Í Ó Ú á é í ó ú ́",b3="Ü ü ̈";function Dfe(){const t=nE(),e=un(),{status:n,dispatch:i,devices:r}=Kn(),[s,o]=x.useState("none"),[a,l]=x.useState(!1),[c,u]=x.useState(!1),d=x.useMemo(()=>[t,t==="es"&&(a&&"accent"||c&&"diaeresis"),s!=="none"&&"shift"].filter(Boolean).join("-"),[t,s,a,c]),f=x.useCallback(p=>{r.keyboard&&n.type==="running"&&n.waitingForInput&&i("keyboard.sendChar",p)},[n,i,r.keyboard]);return r.keyboard?h.jsxs("div",{className:"absolute left-[1600px] top-[300px] z-10 h-min w-[500px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-xl text-white",children:e("computer.keyboard")}),h.jsx(Tfe,{theme:re("hg-theme-vonsim",`hg-shift-${s}`,a&&"hg-accentDeadKey",c&&"hg-diaeresisDeadKey"),layoutName:d,layout:Ofe,display:Lfe[t],buttonTheme:[{class:"hg-accentDeadKeyButton",buttons:y3},{class:"hg-diaeresisDeadKeyButton",buttons:b3}],disableButtonHold:!0,onKeyPress:p=>{if(p==="{shiftleft}"||p==="{shiftright}"){o(m=>m==="none"?"once":"none");return}if(p==="{lock}"){o(m=>m==="none"?"lock":"none");return}if(t==="es"){if(a){y3.includes(p)&&(l(!1),s==="once"&&o("none"),f(p));return}else if(p==="́"){l(!0);return}if(c){b3.includes(p)&&(u(!1),s==="once"&&o("none"),f(p));return}else if(p==="̈"){u(!0);return}}s==="once"&&o("none"),f(p==="{bksp}"?"\b":p==="{enter}"?`
`:p==="{tab}"?"	":p==="{space}"?" ":p)}})]}):null}function jfe(){const t=un(),{devices:e}=Kn(),n=rt(ZE).toArray();return e.leds?h.jsxs("div",{className:"absolute left-[1300px] top-[810px] z-10 size-min rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block size-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.leds")}),h.jsx("div",{className:"flex flex-row-reverse gap-2 p-4",children:n.map((i,r)=>h.jsxs("div",{className:"flex w-7 flex-col items-center",children:[h.jsx("span",{className:"mb-1 w-full text-center text-xs text-white",children:r}),h.jsx("div",{className:re("relative size-7 rounded-full transition",i?"bg-mantis-400":"bg-stone-700 shadow-inner shadow-stone-900"),children:h.jsx("div",{className:re("absolute inset-0 rounded-full bg-mantis-400 blur-sm transition",i?"opacity-100":"opacity-0")})})]},r))})]}):null}function Bfe(){const t=un(),e=rt(IQ),n=rt(le.IP),i=rt(c8),r=rt(u8),s=rt(le.SP),o=rt(Vb),a=rt(cE),l=rt(Hb),c=rt(py),u=a||l;if(e.length===0)return null;const f=()=>{const y=[];for(let v=0;v<256;v+=16){const b=e.slice(v,v+16);y.push(b)}return y},p=16,m=Math.floor(Number(n.valueOf())/p),g=Number(n.valueOf())%p;return h.jsxs("div",{className:"absolute left-[800px] top-[-160px] z-10 size-auto rounded-lg border border-stone-600 bg-stone-900 shadow-2xl [&_*]:z-20","data-testid":"memory-component",children:[h.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-3xl text-white shadow",children:t("computer.memory.name")}),h.jsx("div",{className:"m-4 overflow-x-auto",children:h.jsxs("table",{className:"mx-auto w-auto min-w-[600px] border-separate text-center font-mono text-base",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{}),Array.from({length:16}).map((y,v)=>h.jsx("th",{className:re("relative size-10 border border-gray-500 bg-mantis-500",v%4===0&&v!==0?"border-l-4 border-mantis-600":""),children:h.jsxs("span",{className:"inline-flex items-center",children:[v.toString(16).toUpperCase(),v===g&&h.jsx("span",{className:"ml-0.5 align-middle text-xs text-red-500",children:"↓"})]})},v))]})}),h.jsx("tbody",{children:f().map((y,v)=>h.jsxs("tr",{className:v%4===0&&v!==0?"border-t-4 border-mantis-600":"",children:[h.jsx("th",{className:"relative size-10 border border-gray-500 bg-mantis-500",children:h.jsxs("span",{className:"inline-flex items-center",children:[v.toString(16).toUpperCase(),v===m&&h.jsx("span",{className:"ml-0.5 align-middle text-xs text-red-500",children:"→"})]})}),y.map((b,w)=>{var k,C,E;return h.jsx("td",{className:re("size-10 border border-gray-500 p-0 transition-shadow duration-200",w%4===0&&w!==0?"border-l-4 border-mantis-600":""),children:h.jsx($fe,{address:b.address,value:b.value,isIP:b.address.valueOf()===n.valueOf(),isSP:o&&b.address.valueOf()===s.valueOf(),isStackData:o&&b.address.valueOf()>s.valueOf(),isProgramAddress:!!i.find(_=>_.address===b.address.value),isDataAddress:!!r.find(_=>_.address===b.address.value),isInterruptVector:u&&b.address.valueOf()>=0&&b.address.valueOf()<=7,isWritten:c.has(b.address.valueOf()),label:((k=i.find(_=>_.address===b.address.value))==null?void 0:k.name)||((C=r.find(_=>_.address===b.address.value))==null?void 0:C.label)||null,length:((E=i.find(_=>_.address===b.address.value))==null?void 0:E.length)??null})},w)})]},v))})]})})]})}function $fe({address:t,value:e,isIP:n,isSP:i,isStackData:r,isProgramAddress:s,isDataAddress:o,isInterruptVector:a,isWritten:l,label:c,length:u}){const d=un(),f=rt(Hp),[p,m]=x.useState(!1),g=x.useRef(e);x.useEffect(()=>{g.current!==e&&(m(!0),setTimeout(()=>m(!1),300),g.current=e)},[e]);const y=d("computer.memory.cell",t);return h.jsxs(Uy,{children:[h.jsx(Vy,{asChild:!0,children:h.jsxs(nt.div,{title:y,className:re("relative flex size-10 cursor-pointer select-none items-center justify-center border font-mono text-base transition-all duration-200",n?"z-10 shadow-lg shadow-red-500/50 outline outline-2 outline-red-500 ring-2 ring-red-500 ring-offset-2":i?"z-10 shadow-lg shadow-yellow-400/50 outline outline-2 outline-yellow-400 ring-2 ring-yellow-400 ring-offset-2":"","bg-stone-800",l?"underline decoration-red-400 decoration-2 underline-offset-1":"",a&&!i&&!r?"border-l-4 border-orange-500":"",s&&!i&&!r&&!a?"border-l-4 border-blue-500":"",o&&!i&&!r&&!s&&!a?"border-l-4 border-green-500":"",r&&!i?"border-l-4 border-yellow-500":"",i?"border-l-4 border-yellow-400":"","text-stone-100","hover:z-20 hover:scale-110 hover:shadow-xl",p&&"animate-pulse"),style:t.value===f.value?$e("memory.operating-cell"):void 0,children:[a&&!i&&!r&&h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[10px] text-orange-400",title:"Vector de interrupción",style:{lineHeight:1},children:"⚡"}),s&&!i&&!r&&!a&&h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[10px] text-blue-400",title:"Instrucción",style:{lineHeight:1},children:"📘"}),o&&!i&&!r&&!s&&!a&&h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[10px] text-green-400",title:"Dato",style:{lineHeight:1},children:"📦"}),r&&!i&&h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[10px] text-yellow-400",title:"Dato de la pila",style:{lineHeight:1},children:"📚"}),i&&h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[10px] text-yellow-300",title:"Stack Pointer",style:{lineHeight:1},children:"📍"}),h.jsx("span",{className:"z-10 mt-3 block font-mono text-lg font-bold",children:e.toString("hex")}),n&&h.jsx("span",{className:"absolute right-0 top-0 text-xs text-red-500",title:"IP",style:{lineHeight:1},children:"▲"}),i&&h.jsx("span",{className:"absolute right-0 top-0 text-xs text-yellow-500",title:"SP",style:{lineHeight:1},children:"▲"})]})}),h.jsxs(hm,{className:"w-60",children:[h.jsxs("p",{className:"px-4 py-2 font-medium text-white",children:[y," ",c?h.jsxs("span",{className:"font-bold text-mantis-400",children:["(",c,")",u!==null&&u!==""&&h.jsxs("span",{className:"text-xs font-normal text-white",children:[" Bytes: ",u]})]}):""]}),h.jsx("hr",{className:"border-stone-600"}),h.jsx("ul",{className:"px-4 py-2 text-sm",children:["hex","bin","uint","int","safe-ascii"].map(v=>h.jsxs("li",{children:[h.jsx("b",{className:"font-medium",children:d(`generics.byte-representation.${v}`)}),":"," ",h.jsx("span",{className:"font-mono text-mantis-400",children:e.toString(v)})]},v))})]})]})}function Ffe(){const t=un(),{devices:e}=Kn();return e.pic?h.jsxs("div",{className:"absolute left-0 top-[700px] z-10 flex h-[200px] w-[450px] flex-col rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsxs("div",{className:"flex items-start",children:[h.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.pic")}),h.jsxs("div",{className:"flex h-16 grow items-center justify-evenly",children:[h.jsx(Nr,{name:"IMR",title:t("generics.io-register","IMR",33),valueAtom:QE,springs:"pic.IMR",emphasis:!0}),h.jsx(Nr,{name:"IRR",title:t("generics.io-register","IRR",34),valueAtom:eA,springs:"pic.IRR",emphasis:!0}),h.jsx(Nr,{name:"ISR",title:t("generics.io-register","ISR",35),valueAtom:tA,springs:"pic.ISR",emphasis:!0})]})]}),h.jsx("hr",{className:"mb-2 border-stone-600"}),h.jsx("div",{className:"grid size-full grid-cols-4 items-center",children:Iy.slice(0,4).map((n,i)=>h.jsx(Nr,{name:`INT${i}`,title:t("generics.io-register",`INT${i}`,36+i),valueAtom:n,springs:`pic.INT${i}`,className:"mx-auto"},i))})]}):null}function zfe(){const t=un(),{devices:e}=Kn();return e.pio?h.jsxs("div",{className:"absolute left-[900px] top-[700px] z-10 h-min w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"mb-2 block size-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.pio.name")}),h.jsx("hr",{className:"border-stone-600"}),h.jsxs("div",{className:"flex w-full items-center justify-evenly py-4",children:[h.jsx(Nr,{name:"PA",title:t("generics.io-register","PA",48),valueAtom:nA,springs:"pio.PA"}),h.jsx(Nr,{name:"CA",title:t("generics.io-register","CA",50),valueAtom:rA,springs:"pio.CA"})]}),h.jsx("hr",{className:"border-stone-600"}),h.jsxs("div",{className:"flex w-full items-center justify-evenly py-4",children:[h.jsx(Nr,{name:"PB",title:t("generics.io-register","PB",49),valueAtom:iA,springs:"pio.PB"}),h.jsx(Nr,{name:"CB",title:t("generics.io-register","CB",51),valueAtom:sA,springs:"pio.CB"})]})]}):null}const Ufe="_printer_p8ve7_2",Vfe="_shadow_p8ve7_7",Hfe="_sides_p8ve7_15",Wfe="_front_p8ve7_22",Gfe="_trailContainer_p8ve7_31",Xfe="_trail_p8ve7_31",qfe="_paper_p8ve7_48",yc={printer:Ufe,shadow:Vfe,sides:Hfe,front:Wfe,trailContainer:Gfe,trail:Xfe,paper:qfe},Kfe=Array.from({length:5},(t,e)=>e);function Yfe(){const t=un(),{devices:e}=Kn(),n=rt(Ty),i=rt(Oy);return e.printer?h.jsx("div",{className:"absolute left-[1300px] top-[975px] z-10 flex h-min w-80 flex-col rounded-lg border border-stone-600 bg-stone-900 pl-16 [&_*]:z-20",children:h.jsxs("div",{className:yc.printer,title:t("computer.printer.name"),children:[h.jsx("div",{className:yc.shadow}),h.jsx("div",{className:yc.sides}),h.jsxs("div",{className:yc.front,children:[h.jsx("div",{className:yc.trailContainer,children:h.jsx("div",{className:yc.trail,children:h.jsx("pre",{className:yc.paper,children:i})})}),h.jsx("div",{className:"mt-8 grid grid-cols-5 items-center justify-center",children:Kfe.map(r=>{const s=n[r]?qj(n[r].unsigned):null;return h.jsx("span",{className:re("flex h-6 w-full items-center justify-center border-r border-zinc-300 text-center font-mono text-base font-medium leading-none text-white first-of-type:rounded-l-xl last-of-type:rounded-r-xl last-of-type:border-r-0",s===null?"bg-zinc-400":"bg-mantis-500"),children:s},r)})}),h.jsx("div",{className:"mx-auto mt-3 h-1 w-[70%] overflow-hidden rounded-full bg-zinc-600",children:h.jsx(nt.div,{className:"h-full bg-mantis-400",style:{width:$e("printer.printing.progress").to(r=>`${r*100}%`),opacity:$e("printer.printing.opacity")}})})]})]})}):null}const Jfe="_container_6nvz7_2",Zfe="_text_6nvz7_22",x3={container:Jfe,text:Zfe};function Qfe(){const t=un(),{devices:e}=Kn(),n=rt(oA);return e.screen?h.jsxs("div",{className:"absolute left-[1600px] top-0 z-10 h-min w-[500px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-xl text-white",children:t("computer.screen")}),h.jsx("div",{className:x3.container,children:h.jsx("pre",{className:x3.text,children:n})})]}):null}function ehe(){const t=un(),{dispatch:e,devices:n}=Kn(),i=rt(l1).toArray();return n.switches?h.jsxs("div",{className:"absolute left-[1300px] top-[680px] z-10 size-min rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block size-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.switches")}),h.jsx("div",{className:"flex flex-row-reverse gap-3 p-4",children:i.map((r,s)=>h.jsxs("div",{className:"flex w-8 flex-col items-center",children:[h.jsx("span",{className:"mb-1 w-full text-center text-xs text-white",children:s}),h.jsx(Va,{checked:r,onCheckedChange:()=>e("switch.toggle",s),className:"-translate-x-3 -rotate-90 data-[state=unchecked]:!bg-stone-800"})]},s))})]}):null}function the(){const t=un(),{devices:e}=Kn();return e.timer?h.jsxs("div",{className:"absolute left-[475px] top-[875px] z-10 flex h-[120px] w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block size-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.timer")}),h.jsxs("div",{className:"flex size-full flex-col items-center justify-evenly",children:[h.jsx(Nr,{name:"CONT",title:t("generics.io-register","CONT",16),valueAtom:Ly,springs:"timer.CONT"}),h.jsx(Nr,{name:"COMP",title:t("generics.io-register","COMP",17),valueAtom:aA,springs:"timer.COMP"})]})]}):null}function kz(){const t=x.useRef(null);return x.useEffect(()=>{Bk(),$k(),Fk(),zk();const e=setTimeout(()=>{Bk(),$k(),Fk(),zk()},100);return()=>clearTimeout(e)},[]),h.jsx("div",{className:"relative size-full",children:h.jsxs(jde,{minScale:.3,initialScale:.75,ref:t,doubleClick:{disabled:!0},panning:{excluded:["input"]},children:[h.jsx(Fde,{wrapperClass:"!w-full !h-full",contentClass:"!p-[200px]",children:h.jsxs("div",{className:"relative h-[1300px] w-[1900px]",children:[h.jsx(Qde,{}),h.jsx("div",{className:"absolute left-[120px] top-[-120px] z-20",children:h.jsx(wz,{})}),h.jsx(_fe,{}),h.jsx(Gde,{}),h.jsx(Bfe,{}),h.jsx(Rfe,{}),h.jsx(Ffe,{}),h.jsx(zfe,{}),h.jsx(the,{}),h.jsx(efe,{}),h.jsx(Mfe,{}),h.jsx(Dfe,{}),h.jsx(jfe,{}),h.jsx(Yfe,{}),h.jsx(ehe,{}),h.jsx(Qfe,{})]})}),h.jsx(zde,{wrapperRef:t})]})})}const nhe=1024;let ihe=0;class Aw{constructor(e,n){this.from=e,this.to=n}}class Pt{constructor(e={}){this.id=ihe++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=fr.match(e)),n=>{let i=e(n);return i===void 0?null:[this,i]}}}Pt.closedBy=new Pt({deserialize:t=>t.split(" ")});Pt.openedBy=new Pt({deserialize:t=>t.split(" ")});Pt.group=new Pt({deserialize:t=>t.split(" ")});Pt.isolate=new Pt({deserialize:t=>{if(t&&t!="rtl"&&t!="ltr"&&t!="auto")throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}});Pt.contextHash=new Pt({perNode:!0});Pt.lookAhead=new Pt({perNode:!0});Pt.mounted=new Pt({perNode:!0});class Hy{constructor(e,n,i){this.tree=e,this.overlay=n,this.parser=i}static get(e){return e&&e.props&&e.props[Pt.mounted.id]}}const rhe=Object.create(null);class fr{constructor(e,n,i,r=0){this.name=e,this.props=n,this.id=i,this.flags=r}static define(e){let n=e.props&&e.props.length?Object.create(null):rhe,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new fr(e.name||"",n,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let n=this.prop(Pt.group);return n?n.indexOf(e)>-1:!1}return this.id==e}static match(e){let n=Object.create(null);for(let i in e)for(let r of i.split(" "))n[r]=e[i];return i=>{for(let r=i.prop(Pt.group),s=-1;s<(r?r.length:0);s++){let o=n[s<0?i.name:r[s]];if(o)return o}}}}fr.none=new fr("",Object.create(null),0,8);class RA{constructor(e){this.types=e;for(let n=0;n<e.length;n++)if(e[n].id!=n)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let n=[];for(let i of this.types){let r=null;for(let s of e){let o=s(i);o&&(r||(r=Object.assign({},i.props)),r[o[0].id]=o[1])}n.push(r?new fr(i.name,r,i.id,i.flags):i)}return new RA(n)}}const g0=new WeakMap,w3=new WeakMap;var oi;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"})(oi||(oi={}));class gn{constructor(e,n,i,r,s){if(this.type=e,this.children=n,this.positions=i,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=Hy.get(this);if(e&&!e.overlay)return e.tree.toString();let n="";for(let i of this.children){let r=i.toString();r&&(n&&(n+=","),n+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}cursor(e=0){return new uC(this.topNode,e)}cursorAt(e,n=0,i=0){let r=g0.get(this)||this.topNode,s=new uC(r);return s.moveTo(e,n),g0.set(this,s._tree),s}get topNode(){return new ls(this,0,0,null)}resolve(e,n=0){let i=pm(g0.get(this)||this.topNode,e,n,!1);return g0.set(this,i),i}resolveInner(e,n=0){let i=pm(w3.get(this)||this.topNode,e,n,!0);return w3.set(this,i),i}resolveStack(e,n=0){return ahe(this,e,n)}iterate(e){let{enter:n,leave:i,from:r=0,to:s=this.length}=e,o=e.mode||0,a=(o&oi.IncludeAnonymous)>0;for(let l=this.cursor(o|oi.IncludeAnonymous);;){let c=!1;if(l.from<=s&&l.to>=r&&(!a&&l.type.isAnonymous||n(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&i&&(a||!l.type.isAnonymous)&&i(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let n in this.props)e.push([+n,this.props[n]]);return e}balance(e={}){return this.children.length<=8?this:OA(fr.none,this.children,this.positions,0,this.children.length,0,this.length,(n,i,r)=>new gn(this.type,n,i,r,this.propValues),e.makeTree||((n,i,r)=>new gn(fr.none,n,i,r)))}static build(e){return lhe(e)}}gn.empty=new gn(fr.none,[],[],0);class IA{constructor(e,n){this.buffer=e,this.index=n}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new IA(this.buffer,this.index)}}class Gl{constructor(e,n,i){this.buffer=e,this.length=n,this.set=i}get type(){return fr.none}toString(){let e=[];for(let n=0;n<this.buffer.length;)e.push(this.childString(n)),n=this.buffer[n+3];return e.join(",")}childString(e){let n=this.buffer[e],i=this.buffer[e+3],r=this.set.types[n],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,n,i,r,s){let{buffer:o}=this,a=-1;for(let l=e;l!=n&&!(Cz(s,r,o[l+1],o[l+2])&&(a=l,i>0));l=o[l+3]);return a}slice(e,n,i){let r=this.buffer,s=new Uint16Array(n-e),o=0;for(let a=e,l=0;a<n;){s[l++]=r[a++],s[l++]=r[a++]-i;let c=s[l++]=r[a++]-i;s[l++]=r[a++]-e,o=Math.max(o,c)}return new Gl(s,o,this.set)}}function Cz(t,e,n,i){switch(t){case-2:return n<e;case-1:return i>=e&&n<e;case 0:return n<e&&i>e;case 1:return n<=e&&i>e;case 2:return i>e;case 4:return!0}}function pm(t,e,n,i){for(var r;t.from==t.to||(n<1?t.from>=e:t.from>e)||(n>-1?t.to<=e:t.to<e);){let o=!i&&t instanceof ls&&t.index<0?null:t.parent;if(!o)return t;t=o}let s=i?0:oi.IgnoreOverlays;if(i)for(let o=t,a=o.parent;a;o=a,a=o.parent)o instanceof ls&&o.index<0&&((r=a.enter(e,n,s))===null||r===void 0?void 0:r.from)!=o.from&&(t=a);for(;;){let o=t.enter(e,n,s);if(!o)return t;t=o}}class _z{cursor(e=0){return new uC(this,e)}getChild(e,n=null,i=null){let r=S3(this,e,n,i);return r.length?r[0]:null}getChildren(e,n=null,i=null){return S3(this,e,n,i)}resolve(e,n=0){return pm(this,e,n,!1)}resolveInner(e,n=0){return pm(this,e,n,!0)}matchContext(e){return cC(this.parent,e)}enterUnfinishedNodesBefore(e){let n=this.childBefore(e),i=this;for(;n;){let r=n.lastChild;if(!r||r.to!=n.to)break;r.type.isError&&r.from==r.to?(i=n,n=r.prevSibling):n=r}return i}get node(){return this}get next(){return this.parent}}class ls extends _z{constructor(e,n,i,r){super(),this._tree=e,this.from=n,this.index=i,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,n,i,r,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,c=n>0?a.length:-1;e!=c;e+=n){let u=a[e],d=l[e]+o.from;if(Cz(r,i,d,d+u.length)){if(u instanceof Gl){if(s&oi.ExcludeBuffers)continue;let f=u.findChild(0,u.buffer.length,n,i-d,r);if(f>-1)return new dl(new she(o,u,e,d),null,f)}else if(s&oi.IncludeAnonymous||!u.type.isAnonymous||TA(u)){let f;if(!(s&oi.IgnoreMounts)&&(f=Hy.get(u))&&!f.overlay)return new ls(f.tree,d,e,o);let p=new ls(u,d,e,o);return s&oi.IncludeAnonymous||!p.type.isAnonymous?p:p.nextChild(n<0?u.children.length-1:0,n,i,r)}}}if(s&oi.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+n:e=n<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,n,i=0){let r;if(!(i&oi.IgnoreOverlays)&&(r=Hy.get(this._tree))&&r.overlay){let s=e-this.from;for(let{from:o,to:a}of r.overlay)if((n>0?o<=s:o<s)&&(n<0?a>=s:a>s))return new ls(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,n,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function S3(t,e,n,i){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(n!=null){for(let o=!1;!o;)if(o=r.type.is(n),!r.nextSibling())return s}for(;;){if(i!=null&&r.type.is(i))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return i==null?s:[]}}function cC(t,e,n=e.length-1){for(let i=t;n>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[n]&&e[n]!=i.name)return!1;n--}}return!0}class she{constructor(e,n,i,r){this.parent=e,this.buffer=n,this.index=i,this.start=r}}class dl extends _z{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,n,i){super(),this.context=e,this._parent=n,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,n,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,n-this.context.start,i);return s<0?null:new dl(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,n,i=0){if(i&oi.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],n>0?1:-1,e-this.context.start,n);return s<0?null:new dl(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,n=e.buffer[this.index+3];return n<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new dl(this.context,this._parent,n):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new dl(this.context,this._parent,e.findChild(n,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],n=[],{buffer:i}=this.context,r=this.index+4,s=i.buffer[this.index+3];if(s>r){let o=i.buffer[this.index+1];e.push(i.slice(r,s,o)),n.push(0)}return new gn(this.type,e,n,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Ez(t){if(!t.length)return null;let e=0,n=t[0];for(let s=1;s<t.length;s++){let o=t[s];(o.from>n.from||o.to<n.to)&&(n=o,e=s)}let i=n instanceof ls&&n.index<0?null:n.parent,r=t.slice();return i?r[e]=i:r.splice(e,1),new ohe(r,n)}class ohe{constructor(e,n){this.heads=e,this.node=n}get next(){return Ez(this.heads)}}function ahe(t,e,n){let i=t.resolveInner(e,n),r=null;for(let s=i instanceof ls?i:i.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(r||(r=[i])).push(o.resolve(e,n)),s=o}else{let o=Hy.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new ls(o.tree,o.overlay[0].from+s.from,-1,s);(r||(r=[i])).push(pm(a,e,n,!1))}}return r?Ez(r):i}class uC{get name(){return this.type.name}constructor(e,n=0){if(this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof ls)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,n){this.index=e;let{start:i,buffer:r}=this.buffer;return this.type=n||r.set.types[r.buffer[e]],this.from=i+r.buffer[e+1],this.to=i+r.buffer[e+2],!0}yield(e){return e?e instanceof ls?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,n,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,n,i,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,n-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,n,i=this.mode){return this.buffer?i&oi.ExcludeBuffers?!1:this.enterChild(1,e,n):this.yield(this._tree.enter(e,n,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&oi.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&oi.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:n}=this.buffer,i=this.stack.length-1;if(e<0){let r=i<0?0:this.stack[i]+4;if(this.index!=r)return this.yieldBuf(n.findChild(r,this.index,-1,0,4))}else{let r=n.buffer[this.index+3];if(r<(i<0?n.buffer.length:n.buffer[this.stack[i]+3]))return this.yieldBuf(r)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let n,i,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:n,parent:i}=r)}else({index:n,_parent:i}=this._tree);for(;i;{index:n,_parent:i}=i)if(n>-1)for(let s=n+e,o=e<0?-1:i._tree.children.length;s!=o;s+=e){let a=i._tree.children[s];if(this.mode&oi.IncludeAnonymous||a instanceof Gl||!a.type.isAnonymous||TA(a))return!1}return!0}move(e,n){if(n&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,n=0){for(;(this.from==this.to||(n<1?this.from>=e:this.from>e)||(n>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,n););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,n=null,i=0;if(e&&e.context==this.buffer)e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;n=o,i=s+1;break e}r=this.stack[--s]}for(let r=i;r<this.stack.length;r++)n=new dl(this.buffer,n,this.stack[r]);return this.bufferNode=new dl(this.buffer,n,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,n){for(let i=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(r=!0)}for(;;){if(r&&n&&n(this),r=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,r=!0}}}matchContext(e){if(!this.buffer)return cC(this.node.parent,e);let{buffer:n}=this.buffer,{types:i}=n.set;for(let r=e.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return cC(this._tree,e,r);let o=i[n.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}}function TA(t){return t.children.some(e=>e instanceof Gl||!e.type.isAnonymous||TA(e))}function lhe(t){var e;let{buffer:n,nodeSet:i,maxBufferLength:r=nhe,reused:s=[],minRepeatType:o=i.types.length}=t,a=Array.isArray(n)?new IA(n,n.length):n,l=i.types,c=0,u=0;function d(C,E,_,M,R,T){let{id:L,start:I,end:G,size:B}=a,q=u,Y=c;for(;B<0;)if(a.next(),B==-1){let Ce=s[L];_.push(Ce),M.push(I-C);return}else if(B==-3){c=L;return}else if(B==-4){u=L;return}else throw new RangeError(`Unrecognized record size: ${B}`);let ne=l[L],V,U,se=I-C;if(G-I<=r&&(U=y(a.pos-E,R))){let Ce=new Uint16Array(U.size-U.skip),Q=a.pos-U.size,ae=Ce.length;for(;a.pos>Q;)ae=v(U.start,Ce,ae);V=new Gl(Ce,G-U.start,i),se=U.start-C}else{let Ce=a.pos-B;a.next();let Q=[],ae=[],z=L>=o?L:-1,$=0,W=G;for(;a.pos>Ce;)z>=0&&a.id==z&&a.size>=0?(a.end<=W-r&&(m(Q,ae,I,$,a.end,W,z,q,Y),$=Q.length,W=a.end),a.next()):T>2500?f(I,Ce,Q,ae):d(I,Ce,Q,ae,z,T+1);if(z>=0&&$>0&&$<Q.length&&m(Q,ae,I,$,I,W,z,q,Y),Q.reverse(),ae.reverse(),z>-1&&$>0){let S=p(ne,Y);V=OA(ne,Q,ae,0,Q.length,0,G-I,S,S)}else V=g(ne,Q,ae,G-I,q-G,Y)}_.push(V),M.push(se)}function f(C,E,_,M){let R=[],T=0,L=-1;for(;a.pos>E;){let{id:I,start:G,end:B,size:q}=a;if(q>4)a.next();else{if(L>-1&&G<L)break;L<0&&(L=B-r),R.push(I,G,B),T++,a.next()}}if(T){let I=new Uint16Array(T*4),G=R[R.length-2];for(let B=R.length-3,q=0;B>=0;B-=3)I[q++]=R[B],I[q++]=R[B+1]-G,I[q++]=R[B+2]-G,I[q++]=q;_.push(new Gl(I,R[2]-G,i)),M.push(G-C)}}function p(C,E){return(_,M,R)=>{let T=0,L=_.length-1,I,G;if(L>=0&&(I=_[L])instanceof gn){if(!L&&I.type==C&&I.length==R)return I;(G=I.prop(Pt.lookAhead))&&(T=M[L]+I.length+G)}return g(C,_,M,R,T,E)}}function m(C,E,_,M,R,T,L,I,G){let B=[],q=[];for(;C.length>M;)B.push(C.pop()),q.push(E.pop()+_-R);C.push(g(i.types[L],B,q,T-R,I-T,G)),E.push(R-_)}function g(C,E,_,M,R,T,L){if(T){let I=[Pt.contextHash,T];L=L?[I].concat(L):[I]}if(R>25){let I=[Pt.lookAhead,R];L=L?[I].concat(L):[I]}return new gn(C,E,_,M,L)}function y(C,E){let _=a.fork(),M=0,R=0,T=0,L=_.end-r,I={size:0,start:0,skip:0};e:for(let G=_.pos-C;_.pos>G;){let B=_.size;if(_.id==E&&B>=0){I.size=M,I.start=R,I.skip=T,T+=4,M+=4,_.next();continue}let q=_.pos-B;if(B<0||q<G||_.start<L)break;let Y=_.id>=o?4:0,ne=_.start;for(_.next();_.pos>q;){if(_.size<0)if(_.size==-3)Y+=4;else break e;else _.id>=o&&(Y+=4);_.next()}R=ne,M+=B,T+=Y}return(E<0||M==C)&&(I.size=M,I.start=R,I.skip=T),I.size>4?I:void 0}function v(C,E,_){let{id:M,start:R,end:T,size:L}=a;if(a.next(),L>=0&&M<o){let I=_;if(L>4){let G=a.pos-(L-4);for(;a.pos>G;)_=v(C,E,_)}E[--_]=I,E[--_]=T-C,E[--_]=R-C,E[--_]=M}else L==-3?c=M:L==-4&&(u=M);return _}let b=[],w=[];for(;a.pos>0;)d(t.start||0,t.bufferStart||0,b,w,-1,0);let k=(e=t.length)!==null&&e!==void 0?e:b.length?w[0]+b[0].length:0;return new gn(l[t.topID],b.reverse(),w.reverse(),k)}const k3=new WeakMap;function mv(t,e){if(!t.isAnonymous||e instanceof Gl||e.type!=t)return 1;let n=k3.get(e);if(n==null){n=1;for(let i of e.children){if(i.type!=t||!(i instanceof gn)){n=1;break}n+=mv(t,i)}k3.set(e,n)}return n}function OA(t,e,n,i,r,s,o,a,l){let c=0;for(let m=i;m<r;m++)c+=mv(t,e[m]);let u=Math.ceil(c*1.5/8),d=[],f=[];function p(m,g,y,v,b){for(let w=y;w<v;){let k=w,C=g[w],E=mv(t,m[w]);for(w++;w<v;w++){let _=mv(t,m[w]);if(E+_>=u)break;E+=_}if(w==k+1){if(E>u){let _=m[k];p(_.children,_.positions,0,_.children.length,g[k]+b);continue}d.push(m[k])}else{let _=g[w-1]+m[w-1].length-C;d.push(OA(t,m,g,k,w,C,_,null,l))}f.push(C+b-s)}}return p(e,n,i,r,0),(a||l)(d,f,o)}class Vc{constructor(e,n,i,r,s=!1,o=!1){this.from=e,this.to=n,this.tree=i,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,n=[],i=!1){let r=[new Vc(0,e.length,e,0,!1,i)];for(let s of n)s.to>e.length&&r.push(s);return r}static applyChanges(e,n,i=128){if(!n.length)return e;let r=[],s=1,o=e.length?e[0]:null;for(let a=0,l=0,c=0;;a++){let u=a<n.length?n[a]:null,d=u?u.fromA:1e9;if(d-l>=i)for(;o&&o.from<d;){let f=o;if(l>=f.from||d<=f.to||c){let p=Math.max(f.from,l)-c,m=Math.min(f.to,d)-c;f=p>=m?null:new Vc(p,m,f.tree,f.offset+c,a>0,!!u)}if(f&&r.push(f),o.to>d)break;o=s<e.length?e[s++]:null}if(!u)break;l=u.toA,c=u.toA-u.toB}return r}}class Az{startParse(e,n,i){return typeof e=="string"&&(e=new che(e)),i=i?i.length?i.map(r=>new Aw(r.from,r.to)):[new Aw(0,0)]:[new Aw(0,e.length)],this.createParse(e,n||[],i)}parse(e,n,i){let r=this.startParse(e,n,i);for(;;){let s=r.advance();if(s)return s}}}class che{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,n){return this.string.slice(e,n)}}new Pt({perNode:!0});let uhe=0;class Fn{constructor(e,n,i,r){this.name=e,this.set=n,this.base=i,this.modified=r,this.id=uhe++}toString(){let{name:e}=this;for(let n of this.modified)n.name&&(e=`${n.name}(${e})`);return e}static define(e,n){let i=typeof e=="string"?e:"?";if(e instanceof Fn&&(n=e),n!=null&&n.base)throw new Error("Can not derive from a modified tag");let r=new Fn(i,[],null,[]);if(r.set.push(r),n)for(let s of n.set)r.set.push(s);return r}static defineModifier(e){let n=new Wy(e);return i=>i.modified.indexOf(n)>-1?i:Wy.get(i.base||i,i.modified.concat(n).sort((r,s)=>r.id-s.id))}}let dhe=0;class Wy{constructor(e){this.name=e,this.instances=[],this.id=dhe++}static get(e,n){if(!n.length)return e;let i=n[0].instances.find(a=>a.base==e&&fhe(n,a.modified));if(i)return i;let r=[],s=new Fn(e.name,r,e,n);for(let a of n)a.instances.push(s);let o=hhe(n);for(let a of e.set)if(!a.modified.length)for(let l of o)r.push(Wy.get(a,l));return s}}function fhe(t,e){return t.length==e.length&&t.every((n,i)=>n==e[i])}function hhe(t){let e=[[]];for(let n=0;n<t.length;n++)for(let i=0,r=e.length;i<r;i++)e.push(e[i].concat(t[n]));return e.sort((n,i)=>i.length-n.length)}function phe(t){let e=Object.create(null);for(let n in t){let i=t[n];Array.isArray(i)||(i=[i]);for(let r of n.split(" "))if(r){let s=[],o=2,a=r;for(let d=0;;){if(a=="..."&&d>0&&d+3==r.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!f)throw new RangeError("Invalid path: "+r);if(s.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),d+=f[0].length,d==r.length)break;let p=r[d++];if(d==r.length&&p=="!"){o=0;break}if(p!="/")throw new RangeError("Invalid path: "+r);a=r.slice(d)}let l=s.length-1,c=s[l];if(!c)throw new RangeError("Invalid path: "+r);let u=new Gy(i,o,l>0?s.slice(0,l):null);e[c]=u.sort(e[c])}}return Pz.add(e)}const Pz=new Pt;class Gy{constructor(e,n,i,r){this.tags=e,this.mode=n,this.context=i,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Gy.empty=new Gy([],2,null);function Nz(t,e){let n=Object.create(null);for(let s of t)if(!Array.isArray(s.tag))n[s.tag.id]=s.class;else for(let o of s.tag)n[o.id]=s.class;let{scope:i,all:r=null}=e||{};return{style:s=>{let o=r;for(let a of s)for(let l of a.set){let c=n[l.id];if(c){o=o?o+" "+c:c;break}}return o},scope:i}}function mhe(t,e){let n=null;for(let i of t){let r=i.style(e);r&&(n=n?n+" "+r:r)}return n}function ghe(t,e,n,i=0,r=t.length){let s=new vhe(i,Array.isArray(e)?e:[e],n);s.highlightRange(t.cursor(),i,r,"",s.highlighters),s.flush(r)}class vhe{constructor(e,n,i){this.at=e,this.highlighters=n,this.span=i,this.class=""}startSpan(e,n){n!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=n)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,n,i,r,s){let{type:o,from:a,to:l}=e;if(a>=i||l<=n)return;o.isTop&&(s=this.highlighters.filter(p=>!p.scope||p.scope(o)));let c=r,u=yhe(e)||Gy.empty,d=mhe(s,u.tags);if(d&&(c&&(c+=" "),c+=d,u.mode==1&&(r+=(r?" ":"")+d)),this.startSpan(Math.max(n,a),c),u.opaque)return;let f=e.tree&&e.tree.prop(Pt.mounted);if(f&&f.overlay){let p=e.node.enter(f.overlay[0].from+a,1),m=this.highlighters.filter(y=>!y.scope||y.scope(f.tree.type)),g=e.firstChild();for(let y=0,v=a;;y++){let b=y<f.overlay.length?f.overlay[y]:null,w=b?b.from+a:l,k=Math.max(n,v),C=Math.min(i,w);if(k<C&&g)for(;e.from<C&&(this.highlightRange(e,k,C,r,s),this.startSpan(Math.min(C,e.to),c),!(e.to>=w||!e.nextSibling())););if(!b||w>i)break;v=b.to+a,v>n&&(this.highlightRange(p.cursor(),Math.max(n,b.from+a),Math.min(i,v),"",m),this.startSpan(Math.min(i,v),c))}g&&e.parent()}else if(e.firstChild()){f&&(r="");do if(!(e.to<=n)){if(e.from>=i)break;this.highlightRange(e,n,i,r,s),this.startSpan(Math.min(i,e.to),c)}while(e.nextSibling());e.parent()}}}function yhe(t){let e=t.type.prop(Pz);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}const xe=Fn.define,v0=xe(),Ha=xe(),C3=xe(Ha),_3=xe(Ha),Wa=xe(),y0=xe(Wa),Pw=xe(Wa),Ys=xe(),bc=xe(Ys),Gs=xe(),Xs=xe(),dC=xe(),oh=xe(dC),b0=xe(),et={comment:v0,lineComment:xe(v0),blockComment:xe(v0),docComment:xe(v0),name:Ha,variableName:xe(Ha),typeName:C3,tagName:xe(C3),propertyName:_3,attributeName:xe(_3),className:xe(Ha),labelName:xe(Ha),namespace:xe(Ha),macroName:xe(Ha),literal:Wa,string:y0,docString:xe(y0),character:xe(y0),attributeValue:xe(y0),number:Pw,integer:xe(Pw),float:xe(Pw),bool:xe(Wa),regexp:xe(Wa),escape:xe(Wa),color:xe(Wa),url:xe(Wa),keyword:Gs,self:xe(Gs),null:xe(Gs),atom:xe(Gs),unit:xe(Gs),modifier:xe(Gs),operatorKeyword:xe(Gs),controlKeyword:xe(Gs),definitionKeyword:xe(Gs),moduleKeyword:xe(Gs),operator:Xs,derefOperator:xe(Xs),arithmeticOperator:xe(Xs),logicOperator:xe(Xs),bitwiseOperator:xe(Xs),compareOperator:xe(Xs),updateOperator:xe(Xs),definitionOperator:xe(Xs),typeOperator:xe(Xs),controlOperator:xe(Xs),punctuation:dC,separator:xe(dC),bracket:oh,angleBracket:xe(oh),squareBracket:xe(oh),paren:xe(oh),brace:xe(oh),content:Ys,heading:bc,heading1:xe(bc),heading2:xe(bc),heading3:xe(bc),heading4:xe(bc),heading5:xe(bc),heading6:xe(bc),contentSeparator:xe(Ys),list:xe(Ys),quote:xe(Ys),emphasis:xe(Ys),strong:xe(Ys),link:xe(Ys),monospace:xe(Ys),strikethrough:xe(Ys),inserted:xe(),deleted:xe(),changed:xe(),invalid:xe(),meta:b0,documentMeta:xe(b0),annotation:xe(b0),processingInstruction:xe(b0),definition:Fn.defineModifier("definition"),constant:Fn.defineModifier("constant"),function:Fn.defineModifier("function"),standard:Fn.defineModifier("standard"),local:Fn.defineModifier("local"),special:Fn.defineModifier("special")};for(let t in et){let e=et[t];e instanceof Fn&&(e.name=t)}Nz([{tag:et.link,class:"tok-link"},{tag:et.heading,class:"tok-heading"},{tag:et.emphasis,class:"tok-emphasis"},{tag:et.strong,class:"tok-strong"},{tag:et.keyword,class:"tok-keyword"},{tag:et.atom,class:"tok-atom"},{tag:et.bool,class:"tok-bool"},{tag:et.url,class:"tok-url"},{tag:et.labelName,class:"tok-labelName"},{tag:et.inserted,class:"tok-inserted"},{tag:et.deleted,class:"tok-deleted"},{tag:et.literal,class:"tok-literal"},{tag:et.string,class:"tok-string"},{tag:et.number,class:"tok-number"},{tag:[et.regexp,et.escape,et.special(et.string)],class:"tok-string2"},{tag:et.variableName,class:"tok-variableName"},{tag:et.local(et.variableName),class:"tok-variableName tok-local"},{tag:et.definition(et.variableName),class:"tok-variableName tok-definition"},{tag:et.special(et.variableName),class:"tok-variableName2"},{tag:et.definition(et.propertyName),class:"tok-propertyName tok-definition"},{tag:et.typeName,class:"tok-typeName"},{tag:et.namespace,class:"tok-namespace"},{tag:et.className,class:"tok-className"},{tag:et.macroName,class:"tok-macroName"},{tag:et.propertyName,class:"tok-propertyName"},{tag:et.operator,class:"tok-operator"},{tag:et.comment,class:"tok-comment"},{tag:et.meta,class:"tok-meta"},{tag:et.invalid,class:"tok-invalid"},{tag:et.punctuation,class:"tok-punctuation"}]);var Nw;const ud=new Pt;function bhe(t){return Re.define({combine:t?e=>e.concat(t):void 0})}const xhe=new Pt;class Rs{constructor(e,n,i=[],r=""){this.data=e,this.name=r,kt.prototype.hasOwnProperty("tree")||Object.defineProperty(kt.prototype,"tree",{get(){return To(this)}}),this.parser=n,this.extension=[xf.of(this),kt.languageData.of((s,o,a)=>{let l=E3(s,o,a),c=l.type.prop(ud);if(!c)return[];let u=s.facet(c),d=l.type.prop(xhe);if(d){let f=l.resolve(o-l.from,a);for(let p of d)if(p.test(f,s)){let m=s.facet(p.facet);return p.type=="replace"?m:m.concat(u)}}return u})].concat(i)}isActiveAt(e,n,i=-1){return E3(e,n,i).type.prop(ud)==this.data}findRegions(e){let n=e.facet(xf);if((n==null?void 0:n.data)==this.data)return[{from:0,to:e.doc.length}];if(!n||!n.allowsNesting)return[];let i=[],r=(s,o)=>{if(s.prop(ud)==this.data){i.push({from:o,to:o+s.length});return}let a=s.prop(Pt.mounted);if(a){if(a.tree.prop(ud)==this.data){if(a.overlay)for(let l of a.overlay)i.push({from:l.from+o,to:l.to+o});else i.push({from:o,to:o+s.length});return}else if(a.overlay){let l=i.length;if(r(a.tree,a.overlay[0].from+o),i.length>l)return}}for(let l=0;l<s.children.length;l++){let c=s.children[l];c instanceof gn&&r(c,s.positions[l]+o)}};return r(To(e),0),i}get allowsNesting(){return!0}}Rs.setState=pt.define();function E3(t,e,n){let i=t.facet(xf),r=To(t).topNode;if(!i||i.allowsNesting)for(let s=r;s;s=s.enter(e,n,oi.ExcludeBuffers))s.type.isTop&&(r=s);return r}function To(t){let e=t.field(Rs.state,!1);return e?e.tree:gn.empty}class whe{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,n){let i=this.cursorPos-this.string.length;return e<i||n>=this.cursorPos?this.doc.sliceString(e,n):this.string.slice(e-i,n-i)}}let ah=null;class yf{constructor(e,n,i=[],r,s,o,a,l){this.parser=e,this.state=n,this.fragments=i,this.tree=r,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,n,i){return new yf(e,n,[],gn.empty,0,i,[],null)}startParse(){return this.parser.startParse(new whe(this.state.doc),this.fragments)}work(e,n){return n!=null&&n>=this.state.doc.length&&(n=void 0),this.tree!=gn.empty&&this.isDone(n??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),n!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>n)&&n<this.state.doc.length&&this.parse.stopAt(n);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(Vc.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(n??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,n;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(n=this.parse.advance()););}),this.treeLen=e,this.tree=n,this.fragments=this.withoutTempSkipped(Vc.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let n=ah;ah=this;try{return e()}finally{ah=n}}withoutTempSkipped(e){for(let n;n=this.tempSkipped.pop();)e=A3(e,n.from,n.to);return e}changes(e,n){let{fragments:i,tree:r,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((c,u,d,f)=>l.push({fromA:c,toA:u,fromB:d,toB:f})),i=Vc.applyChanges(i,l),r=gn.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let c of this.skipped){let u=e.mapPos(c.from,1),d=e.mapPos(c.to,-1);u<d&&a.push({from:u,to:d})}}}return new yf(this.parser,n,i,r,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let n=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:r,to:s}=this.skipped[i];r<e.to&&s>e.from&&(this.fragments=A3(this.fragments,r,s),this.skipped.splice(i--,1))}return this.skipped.length>=n?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,n){this.skipped.push({from:e,to:n})}static getSkippingParser(e){return new class extends Az{createParse(n,i,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let l=ah;if(l){for(let c of r)l.tempSkipped.push(c);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new gn(fr.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let n=this.fragments;return this.treeLen>=e&&n.length&&n[0].from==0&&n[0].to>=e}static get(){return ah}}function A3(t,e,n){return Vc.applyChanges(t,[{fromA:e,toA:n,fromB:e,toB:n}])}class bf{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let n=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,i)||n.takeTree(),new bf(n)}static init(e){let n=Math.min(3e3,e.doc.length),i=yf.create(e.facet(xf).parser,e,{from:0,to:n});return i.work(20,n)||i.takeTree(),new bf(i)}}Rs.state=zi.define({create:bf.init,update(t,e){for(let n of e.effects)if(n.is(Rs.setState))return n.value;return e.startState.facet(xf)!=e.state.facet(xf)?bf.init(e.state):t.apply(e)}});let Mz=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(Mz=t=>{let e=-1,n=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(n):cancelIdleCallback(e)});const Mw=typeof navigator<"u"&&(!((Nw=navigator.scheduling)===null||Nw===void 0)&&Nw.isInputPending)?()=>navigator.scheduling.isInputPending():null,She=pi.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let n=this.view.state.field(Rs.state).context;(n.updateViewport(e.view.viewport)||this.view.viewport.to>n.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(n)}scheduleWork(){if(this.working)return;let{state:e}=this.view,n=e.field(Rs.state);(n.tree!=n.context.tree||!n.context.isDone(e.doc.length))&&(this.working=Mz(this.work))}work(e){this.working=null;let n=Date.now();if(this.chunkEnd<n&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=n+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:r}}=this.view,s=i.field(Rs.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Mw?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<r&&i.doc.length>r+1e3,l=s.context.work(()=>Mw&&Mw()||Date.now()>o,r+(a?0:1e5));this.chunkBudget-=Date.now()-n,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Rs.setState.of(new bf(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(n=>Ar(this.view.state,n)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),xf=Re.define({combine(t){return t.length?t[0]:null},enables:t=>[Rs.state,She,Be.contentAttributes.compute([t],e=>{let n=e.facet(t);return n&&n.name?{"data-language":n.name}:{}})]});class khe{constructor(e,n=[]){this.language=e,this.support=n,this.extension=[e,n]}}const Che=Re.define(),LA=Re.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(n=>n!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function uu(t){let e=t.facet(LA);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function fC(t,e){let n="",i=t.tabSize,r=t.facet(LA)[0];if(r=="	"){for(;e>=i;)n+="	",e-=i;r=" "}for(let s=0;s<e;s++)n+=r;return n}function _he(t,e){t instanceof kt&&(t=new DA(t));for(let i of t.state.facet(Che)){let r=i(t,e);if(r!==void 0)return r}let n=To(t.state);return n.length>=e?Ehe(t,n,e):null}class DA{constructor(e,n={}){this.state=e,this.options=n,this.unit=uu(e)}lineAt(e,n=1){let i=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=i.from&&r<=i.to?s&&r==e?{text:"",from:e}:(n<0?r<e:r<=e)?{text:i.text.slice(r-i.from),from:r}:{text:i.text.slice(0,r-i.from),from:i.from}:i}textAfterPos(e,n=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:r}=this.lineAt(e,n);return i.slice(e-r,Math.min(i.length,e+100-r))}column(e,n=1){let{text:i,from:r}=this.lineAt(e,n),s=this.countColumn(i,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(s+=o-this.countColumn(i,i.search(/\S|$/))),s}countColumn(e,n=e.length){return Om(e,this.state.tabSize,n)}lineIndent(e,n=1){let{text:i,from:r}=this.lineAt(e,n),s=this.options.overrideIndentation;if(s){let o=s(r);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Rz=new Pt;function Ehe(t,e,n){let i=e.resolveStack(n),r=e.resolveInner(n,-1).resolve(n,0).enterUnfinishedNodesBefore(n);if(r!=i.node){let s=[];for(let o=r;o&&!(o.from<i.node.from||o.to>i.node.to||o.from==i.node.from&&o.type==i.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)i={node:s[o],next:i}}return Iz(i,t,n)}function Iz(t,e,n){for(let i=t;i;i=i.next){let r=Phe(i.node);if(r)return r(jA.create(e,n,i))}return 0}function Ahe(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function Phe(t){let e=t.type.prop(Rz);if(e)return e;let n=t.firstChild,i;if(n&&(i=n.type.prop(Pt.closedBy))){let r=t.lastChild,s=r&&i.indexOf(r.name)>-1;return o=>Ihe(o,!0,1,void 0,s&&!Ahe(o)?r.from:void 0)}return t.parent==null?Nhe:null}function Nhe(){return 0}class jA extends DA{constructor(e,n,i){super(e.state,e.options),this.base=e,this.pos=n,this.context=i}get node(){return this.context.node}static create(e,n,i){return new jA(e,n,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let n=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(n.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(Mhe(i,e))break;n=this.state.doc.lineAt(i.from)}return this.lineIndent(n.from)}continue(){return Iz(this.context.next,this.base,this.pos)}}function Mhe(t,e){for(let n=e;n;n=n.parent)if(t==n)return!0;return!1}function Rhe(t){let e=t.node,n=e.childAfter(e.from),i=e.lastChild;if(!n)return null;let r=t.options.simulateBreak,s=t.state.doc.lineAt(n.from),o=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let a=n.to;;){let l=e.childAfter(a);if(!l||l==i)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let c=/^ */.exec(s.text.slice(n.to-s.from))[0].length;return{from:n.from,to:n.to+c}}a=l.to}}function Ihe(t,e,n,i,r){let s=t.textAfter,o=s.match(/^\s*/)[0].length,a=i&&s.slice(o,o+i.length)==i||r==t.pos+o,l=Rhe(t);return l?a?t.column(l.from):t.column(l.to):t.baseIndent+(a?0:t.unit*n)}const The=Re.define(),Ohe=new Pt;function Lhe(t,e,n){let i=To(t);if(i.length<n)return null;let r=i.resolveStack(n,1),s=null;for(let o=r;o;o=o.next){let a=o.node;if(a.to<=n||a.from>n)continue;if(s&&a.from<e)break;let l=a.type.prop(Ohe);if(l&&(a.to<i.length-50||i.length==t.doc.length||!Dhe(a))){let c=l(a,t);c&&c.from<=n&&c.from>=e&&c.to>n&&(s=c)}}return s}function Dhe(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function Tz(t,e,n){for(let i of t.facet(The)){let r=i(t,e,n);if(r)return r}return Lhe(t,e,n)}function Oz(t,e){let n=e.mapPos(t.from,1),i=e.mapPos(t.to,-1);return n>=i?void 0:{from:n,to:i}}const BA=pt.define({map:Oz}),_1=pt.define({map:Oz});function Lz(t){let e=[];for(let{head:n}of t.state.selection.ranges)e.some(i=>i.from<=n&&i.to>=n)||e.push(t.lineBlockAt(n));return e}const Xm=zi.define({create(){return gt.none},update(t,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((n,i)=>t=P3(t,n,i)),t=t.map(e.changes);for(let n of e.effects)if(n.is(BA)&&!jhe(t,n.value.from,n.value.to)){let{preparePlaceholder:i}=e.state.facet($z),r=i?gt.replace({widget:new Hhe(i(e.state,n.value))}):N3;t=t.update({add:[r.range(n.value.from,n.value.to)]})}else n.is(_1)&&(t=t.update({filter:(i,r)=>n.value.from!=i||n.value.to!=r,filterFrom:n.value.from,filterTo:n.value.to}));return e.selection&&(t=P3(t,e.selection.main.head)),t},provide:t=>Be.decorations.from(t),toJSON(t,e){let n=[];return t.between(0,e.doc.length,(i,r)=>{n.push(i,r)}),n},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let n=0;n<t.length;){let i=t[n++],r=t[n++];if(typeof i!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(N3.range(i,r))}return gt.set(e,!0)}});function P3(t,e,n=e){let i=!1;return t.between(e,n,(r,s)=>{r<n&&s>e&&(i=!0)}),i?t.update({filterFrom:e,filterTo:n,filter:(r,s)=>r>=n||s<=e}):t}function Dz(t,e,n){var i;let r=null;return(i=t.field(Xm,!1))===null||i===void 0||i.between(e,n,(s,o)=>{(!r||r.from>s)&&(r={from:s,to:o})}),r}function jhe(t,e,n){let i=!1;return t.between(e,e,(r,s)=>{r==e&&s==n&&(i=!0)}),i}function jz(t,e){return t.field(Xm,!1)?e:e.concat(pt.appendConfig.of(Vhe()))}const Bhe=t=>{for(let e of Lz(t)){let n=Tz(t.state,e.from,e.to);if(n)return t.dispatch({effects:jz(t.state,[BA.of(n),Bz(t,n)])}),!0}return!1},$he=t=>{if(!t.state.field(Xm,!1))return!1;let e=[];for(let n of Lz(t)){let i=Dz(t.state,n.from,n.to);i&&e.push(_1.of(i),Bz(t,i,!1))}return e.length&&t.dispatch({effects:e}),e.length>0};function Bz(t,e,n=!0){let i=t.state.doc.lineAt(e.from).number,r=t.state.doc.lineAt(e.to).number;return Be.announce.of(`${t.state.phrase(n?"Folded lines":"Unfolded lines")} ${i} ${t.state.phrase("to")} ${r}.`)}const Fhe=t=>{let{state:e}=t,n=[];for(let i=0;i<e.doc.length;){let r=t.lineBlockAt(i),s=Tz(e,r.from,r.to);s&&n.push(BA.of(s)),i=(s?t.lineBlockAt(s.to):r).to+1}return n.length&&t.dispatch({effects:jz(t.state,n)}),!!n.length},zhe=t=>{let e=t.state.field(Xm,!1);if(!e||!e.size)return!1;let n=[];return e.between(0,t.state.doc.length,(i,r)=>{n.push(_1.of({from:i,to:r}))}),t.dispatch({effects:n}),!0},Uhe={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},$z=Re.define({combine(t){return Zl(t,Uhe)}});function Vhe(t){return[Xm,Whe]}function Fz(t,e){let{state:n}=t,i=n.facet($z),r=o=>{let a=t.lineBlockAt(t.posAtDOM(o.target)),l=Dz(t.state,a.from,a.to);l&&t.dispatch({effects:_1.of(l)}),o.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(t,r,e);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",n.phrase("folded code")),s.title=n.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}const N3=gt.replace({widget:new class extends Ql{toDOM(t){return Fz(t,null)}}});class Hhe extends Ql{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return Fz(e,this.value)}}const Whe=Be.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class E1{constructor(e,n){this.specs=e;let i;function r(a){let l=$l.newName();return(i||(i=Object.create(null)))["."+l]=a,l}const s=typeof n.all=="string"?n.all:n.all?r(n.all):void 0,o=n.scope;this.scope=o instanceof Rs?a=>a.prop(ud)==o.data:o?a=>a==o:void 0,this.style=Nz(e.map(a=>({tag:a.tag,class:a.class||r(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=i?new $l(i):null,this.themeType=n.themeType}static define(e,n){return new E1(e,n||{})}}const hC=Re.define(),Ghe=Re.define({combine(t){return t.length?[t[0]]:null}});function Rw(t){let e=t.facet(hC);return e.length?e:t.facet(Ghe)}function Xhe(t,e){let n=[Khe],i;return t instanceof E1&&(t.module&&n.push(Be.styleModule.of(t.module)),i=t.themeType),i?n.push(hC.computeN([Be.darkTheme],r=>r.facet(Be.darkTheme)==(i=="dark")?[t]:[])):n.push(hC.of(t)),n}class qhe{constructor(e){this.markCache=Object.create(null),this.tree=To(e.state),this.decorations=this.buildDeco(e,Rw(e.state)),this.decoratedTo=e.viewport.to}update(e){let n=To(e.state),i=Rw(e.state),r=i!=Rw(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);n.length<s.to&&!r&&n.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(n!=this.tree||e.viewportChanged||r)&&(this.tree=n,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=s.to)}buildDeco(e,n){if(!n||!this.tree.length)return gt.none;let i=new Bl;for(let{from:r,to:s}of e.visibleRanges)ghe(this.tree,n,(o,a,l)=>{i.add(o,a,this.markCache[l]||(this.markCache[l]=gt.mark({class:l})))},r,s);return i.finish()}}const Khe=Im.high(pi.fromClass(qhe,{decorations:t=>t.decorations})),Yhe=1e4,Jhe="()[]{}",Zhe=new Pt;function pC(t,e,n){let i=t.prop(e<0?Pt.openedBy:Pt.closedBy);if(i)return i;if(t.name.length==1){let r=n.indexOf(t.name);if(r>-1&&r%2==(e<0?1:0))return[n[r+e]]}return null}function mC(t){let e=t.type.prop(Zhe);return e?e(t.node):t}function x0(t,e,n,i={}){let r=i.maxScanDistance||Yhe,s=i.brackets||Jhe,o=To(t),a=o.resolveInner(e,n);for(let l=a;l;l=l.parent){let c=pC(l.type,n,s);if(c&&l.from<l.to){let u=mC(l);if(u&&(n>0?e>=u.from&&e<u.to:e>u.from&&e<=u.to))return Qhe(t,e,n,l,u,c,s)}}return epe(t,e,n,o,a.type,r,s)}function Qhe(t,e,n,i,r,s,o){let a=i.parent,l={from:r.from,to:r.to},c=0,u=a==null?void 0:a.cursor();if(u&&(n<0?u.childBefore(i.from):u.childAfter(i.to)))do if(n<0?u.to<=i.from:u.from>=i.to){if(c==0&&s.indexOf(u.type.name)>-1&&u.from<u.to){let d=mC(u);return{start:l,end:d?{from:d.from,to:d.to}:void 0,matched:!0}}else if(pC(u.type,n,o))c++;else if(pC(u.type,-n,o)){if(c==0){let d=mC(u);return{start:l,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1}}c--}}while(n<0?u.prevSibling():u.nextSibling());return{start:l,matched:!1}}function epe(t,e,n,i,r,s,o){let a=n<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=n>0)return null;let c={from:n<0?e-1:e,to:n>0?e+1:e},u=t.doc.iterRange(e,n>0?t.doc.length:0),d=0;for(let f=0;!u.next().done&&f<=s;){let p=u.value;n<0&&(f+=p.length);let m=e+f*n;for(let g=n>0?0:p.length-1,y=n>0?p.length:-1;g!=y;g+=n){let v=o.indexOf(p[g]);if(!(v<0||i.resolveInner(m+g,1).type!=r))if(v%2==0==n>0)d++;else{if(d==1)return{start:c,end:{from:m+g,to:m+g+1},matched:v>>1==l>>1};d--}}n>0&&(f+=p.length)}return u.done?{start:c,matched:!1}:null}function M3(t,e,n,i=0,r=0){e==null&&(e=t.search(/[^\s\u00a0]/),e==-1&&(e=t.length));let s=r;for(let o=i;o<e;o++)t.charCodeAt(o)==9?s+=n-s%n:s++;return s}class zz{constructor(e,n,i,r){this.string=e,this.tabSize=n,this.indentUnit=i,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let n=this.string.charAt(this.pos),i;if(typeof e=="string"?i=n==e:i=n&&(e instanceof RegExp?e.test(n):e(n)),i)return++this.pos,n}eatWhile(e){let n=this.pos;for(;this.eat(e););return this.pos>n}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let n=this.string.indexOf(e,this.pos);if(n>-1)return this.pos=n,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=M3(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:M3(this.string,null,this.tabSize)}match(e,n,i){if(typeof e=="string"){let r=o=>i?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return r(s)==r(e)?(n!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&n!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function tpe(t){return{name:t.name||"",token:t.token,blankLine:t.blankLine||(()=>{}),startState:t.startState||(()=>!0),copyState:t.copyState||npe,indent:t.indent||(()=>null),languageData:t.languageData||{},tokenTable:t.tokenTable||zA,mergeTokens:t.mergeTokens!==!1}}function npe(t){if(typeof t!="object")return t;let e={};for(let n in t){let i=t[n];e[n]=i instanceof Array?i.slice():i}return e}const R3=new WeakMap;class $A extends Rs{constructor(e){let n=bhe(e.languageData),i=tpe(e),r,s=new class extends Az{createParse(o,a,l){return new rpe(r,o,a,l)}};super(n,s,[],e.name),this.topNode=ape(n,this),r=this,this.streamParser=i,this.stateAfter=new Pt({perNode:!0}),this.tokenTable=e.tokenTable?new Wz(i.tokenTable):ope}static define(e){return new $A(e)}getIndent(e){let n,{overrideIndentation:i}=e.options;i&&(n=R3.get(e.state),n!=null&&n<e.pos-1e4&&(n=void 0));let r=FA(this,e.node.tree,e.node.from,e.node.from,n??e.pos),s,o;if(r?(o=r.state,s=r.pos+1):(o=this.streamParser.startState(e.unit),s=e.node.from),e.pos-s>1e4)return null;for(;s<e.pos;){let l=e.state.doc.lineAt(s),c=Math.min(e.pos,l.to);if(l.length){let u=i?i(l.from):-1,d=new zz(l.text,e.state.tabSize,e.unit,u<0?void 0:u);for(;d.pos<c-l.from;)Vz(this.streamParser.token,d,o)}else this.streamParser.blankLine(o,e.unit);if(c==e.pos)break;s=l.to+1}let a=e.lineAt(e.pos);return i&&n==null&&R3.set(e.state,a.from),this.streamParser.indent(o,/^\s*(.*)/.exec(a.text)[1],e)}get allowsNesting(){return!1}}function FA(t,e,n,i,r){let s=n>=i&&n+e.length<=r&&e.prop(t.stateAfter);if(s)return{state:t.streamParser.copyState(s),pos:n+e.length};for(let o=e.children.length-1;o>=0;o--){let a=e.children[o],l=n+e.positions[o],c=a instanceof gn&&l<r&&FA(t,a,l,i,r);if(c)return c}return null}function Uz(t,e,n,i,r){if(r&&n<=0&&i>=e.length)return e;!r&&n==0&&e.type==t.topNode&&(r=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],a=e.children[s],l;if(o<i&&a instanceof gn){if(!(l=Uz(t,a,n-o,i-o,r)))break;return r?new gn(e.type,e.children.slice(0,s).concat(l),e.positions.slice(0,s+1),o+l.length):l}}return null}function ipe(t,e,n,i,r){for(let s of e){let o=s.from+(s.openStart?25:0),a=s.to-(s.openEnd?25:0),l=o<=n&&a>n&&FA(t,s.tree,0-s.offset,n,a),c;if(l&&l.pos<=i&&(c=Uz(t,s.tree,n+s.offset,l.pos+s.offset,!1)))return{state:l.state,tree:c}}return{state:t.streamParser.startState(r?uu(r):4),tree:gn.empty}}class rpe{constructor(e,n,i,r){this.lang=e,this.input=n,this.fragments=i,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let s=yf.get(),o=r[0].from,{state:a,tree:l}=ipe(e,i,o,this.to,s==null?void 0:s.state);this.state=a,this.parsedPos=this.chunkStart=o+l.length;for(let c=0;c<l.children.length;c++)this.chunks.push(l.children[c]),this.chunkPos.push(l.positions[c]);s&&this.parsedPos<s.viewport.from-1e5&&r.some(c=>c.from<=s.viewport.from&&c.to>=s.viewport.from)&&(this.state=this.lang.streamParser.startState(uu(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=yf.get(),n=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),i=Math.min(n,this.chunkStart+2048);for(e&&(i=Math.min(i,e.viewport.to));this.parsedPos<i;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=n?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,n),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let n=this.input.chunk(e);if(this.input.lineChunks)n==`
`&&(n="");else{let i=n.indexOf(`
`);i>-1&&(n=n.slice(0,i))}return e+n.length<=this.to?n:n.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,n=this.lineAfter(e),i=e+n.length;for(let r=this.rangeIndex;;){let s=this.ranges[r].to;if(s>=i||(n=n.slice(0,s-(i-n.length)),r++,r==this.ranges.length))break;let o=this.ranges[r].from,a=this.lineAfter(o);n+=a,i=o+a.length}return{line:n,end:i}}skipGapsTo(e,n,i){for(;;){let r=this.ranges[this.rangeIndex].to,s=e+n;if(i>0?r>s:r>=s)break;let o=this.ranges[++this.rangeIndex].from;n+=o-r}return n}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,n,i,r){let s=4;if(this.ranges.length>1){r=this.skipGapsTo(n,r,1),n+=r;let a=this.chunk.length;r=this.skipGapsTo(i,r,-1),i+=r,s+=this.chunk.length-a}let o=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&s==4&&o>=0&&this.chunk[o]==e&&this.chunk[o+2]==n?this.chunk[o+2]=i:this.chunk.push(e,n,i,s),r}parseLine(e){let{line:n,end:i}=this.nextLine(),r=0,{streamParser:s}=this.lang,o=new zz(n,e?e.state.tabSize:4,e?uu(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let a=Vz(s.token,o,this.state);if(a&&(r=this.emitToken(this.lang.tokenTable.resolve(a),this.parsedPos+o.start,this.parsedPos+o.pos,r)),o.start>1e4)break}this.parsedPos=i,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=gn.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:spe,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new gn(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new gn(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function Vz(t,e,n){e.start=e.pos;for(let i=0;i<10;i++){let r=t(e,n);if(e.pos>e.start)return r}throw new Error("Stream parser failed to advance stream.")}const zA=Object.create(null),mm=[fr.none],spe=new RA(mm),I3=[],T3=Object.create(null),Hz=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Hz[t]=Gz(zA,e);class Wz{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),Hz)}resolve(e){return e?this.table[e]||(this.table[e]=Gz(this.extra,e)):0}}const ope=new Wz(zA);function Iw(t,e){I3.indexOf(t)>-1||(I3.push(t),console.warn(e))}function Gz(t,e){let n=[];for(let a of e.split(" ")){let l=[];for(let c of a.split(".")){let u=t[c]||et[c];u?typeof u=="function"?l.length?l=l.map(u):Iw(c,`Modifier ${c} used at start of tag`):l.length?Iw(c,`Tag ${c} used as modifier`):l=Array.isArray(u)?u:[u]:Iw(c,`Unknown highlighting tag ${c}`)}for(let c of l)n.push(c)}if(!n.length)return 0;let i=e.replace(/ /g,"_"),r=i+" "+n.map(a=>a.id),s=T3[r];if(s)return s.id;let o=T3[r]=fr.define({id:mm.length,name:i,props:[phe({[i]:n})]});return mm.push(o),o.id}function ape(t,e){let n=fr.define({id:mm.length,name:"Document",props:[ud.add(()=>t),Rz.add(()=>i=>e.getIndent(i))],top:!0});return mm.push(n),n}sn.RTL,sn.LTR;const lpe=t=>{let{state:e}=t,n=e.doc.lineAt(e.selection.main.from),i=UA(t.state,n.from);return i.line?cpe(t):i.block?hpe(t):!1};function qm(t,e){return({state:n,dispatch:i})=>{if(n.readOnly)return!1;let r=t(e,n);return r?(i(n.update(r)),!0):!1}}const cpe=qm(VA,0),upe=qm(VA,1),dpe=qm(VA,2),fpe=qm(Xz,0),hpe=qm((t,e)=>Xz(t,e,mpe(e)),0);function UA(t,e){let n=t.languageDataAt("commentTokens",e,1);return n.length?n[0]:{}}const lh=50;function ppe(t,{open:e,close:n},i,r){let s=t.sliceDoc(i-lh,i),o=t.sliceDoc(r,r+lh),a=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(o)[0].length,c=s.length-a;if(s.slice(c-e.length,c)==e&&o.slice(l,l+n.length)==n)return{open:{pos:i-a,margin:a&&1},close:{pos:r+l,margin:l&&1}};let u,d;r-i<=2*lh?u=d=t.sliceDoc(i,r):(u=t.sliceDoc(i,i+lh),d=t.sliceDoc(r-lh,r));let f=/^\s*/.exec(u)[0].length,p=/\s*$/.exec(d)[0].length,m=d.length-p-n.length;return u.slice(f,f+e.length)==e&&d.slice(m,m+n.length)==n?{open:{pos:i+f+e.length,margin:/\s/.test(u.charAt(f+e.length))?1:0},close:{pos:r-p-n.length,margin:/\s/.test(d.charAt(m-1))?1:0}}:null}function mpe(t){let e=[];for(let n of t.selection.ranges){let i=t.doc.lineAt(n.from),r=n.to<=i.to?i:t.doc.lineAt(n.to);r.from>i.from&&r.from==n.to&&(r=n.to==i.to+1?i:t.doc.lineAt(n.to-1));let s=e.length-1;s>=0&&e[s].to>i.from?e[s].to=r.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:r.to})}return e}function Xz(t,e,n=e.selection.ranges){let i=n.map(s=>UA(e,s.from).block);if(!i.every(s=>s))return null;let r=n.map((s,o)=>ppe(e,i[o],s.from,s.to));if(t!=2&&!r.every(s=>s))return{changes:e.changes(n.map((s,o)=>r[o]?[]:[{from:s.from,insert:i[o].open+" "},{from:s.to,insert:" "+i[o].close}]))};if(t!=1&&r.some(s=>s)){let s=[];for(let o=0,a;o<r.length;o++)if(a=r[o]){let l=i[o],{open:c,close:u}=a;s.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+l.close.length})}return{changes:s}}return null}function VA(t,e,n=e.selection.ranges){let i=[],r=-1;for(let{from:s,to:o}of n){let a=i.length,l=1e9,c=UA(e,s).line;if(c){for(let u=s;u<=o;){let d=e.doc.lineAt(u);if(d.from>r&&(s==o||o>d.from)){r=d.from;let f=/^\s*/.exec(d.text)[0].length,p=f==d.length,m=d.text.slice(f,f+c.length)==c?f:-1;f<d.text.length&&f<l&&(l=f),i.push({line:d,comment:m,token:c,indent:f,empty:p,single:!1})}u=d.to+1}if(l<1e9)for(let u=a;u<i.length;u++)i[u].indent<i[u].line.text.length&&(i[u].indent=l);i.length==a+1&&(i[a].single=!0)}}if(t!=2&&i.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:a,token:l,indent:c,empty:u,single:d}of i)(d||!u)&&s.push({from:a.from+c,insert:l+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(t!=1&&i.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:a,token:l}of i)if(a>=0){let c=o.from+a,u=c+l.length;o.text[u-o.from]==" "&&u++,s.push({from:c,to:u})}return{changes:s}}return null}const gC=Ca.define(),gpe=Ca.define(),vpe=Re.define(),qz=Re.define({combine(t){return Zl(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(i,r)=>e(i,r)||n(i,r)})}}),Kz=zi.define({create(){return yo.empty},update(t,e){let n=e.state.facet(qz),i=e.annotation(gC);if(i){let l=lr.fromTransaction(e,i.selection),c=i.side,u=c==0?t.undone:t.done;return l?u=Xy(u,u.length,n.minDepth,l):u=Zz(u,e.startState.selection),new yo(c==0?i.rest:u,c==0?u:i.rest)}let r=e.annotation(gpe);if((r=="full"||r=="before")&&(t=t.isolate()),e.annotation(Un.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let s=lr.fromTransaction(e),o=e.annotation(Un.time),a=e.annotation(Un.userEvent);return s?t=t.addChanges(s,o,a,n,e):e.selection&&(t=t.addSelection(e.startState.selection,o,a,n.newGroupDelay)),(r=="full"||r=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new yo(t.done.map(lr.fromJSON),t.undone.map(lr.fromJSON))}});function ype(t={}){return[Kz,qz.of(t),Be.domEventHandlers({beforeinput(e,n){let i=e.inputType=="historyUndo"?Yz:e.inputType=="historyRedo"?vC:null;return i?(e.preventDefault(),i(n)):!1}})]}function HA(t,e){return function({state:n,dispatch:i}){if(!e&&n.readOnly)return!1;let r=n.field(Kz,!1);if(!r)return!1;let s=r.pop(t,n,e);return s?(i(s),!0):!1}}const Yz=HA(0,!1),vC=HA(1,!1),bpe=HA(0,!0);class lr{constructor(e,n,i,r,s){this.changes=e,this.effects=n,this.mapped=i,this.startSelection=r,this.selectionsAfter=s}setSelAfter(e){return new lr(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new lr(e.changes&&Bn.fromJSON(e.changes),[],e.mapped&&_o.fromJSON(e.mapped),e.startSelection&&ue.fromJSON(e.startSelection),e.selectionsAfter.map(ue.fromJSON))}static fromTransaction(e,n){let i=es;for(let r of e.startState.facet(vpe)){let s=r(e);s.length&&(i=i.concat(s))}return!i.length&&e.changes.empty?null:new lr(e.changes.invert(e.startState.doc),i,void 0,n||e.startState.selection,es)}static selection(e){return new lr(void 0,es,void 0,void 0,e)}}function Xy(t,e,n,i){let r=e+1>n+20?e-n-1:0,s=t.slice(r,e);return s.push(i),s}function xpe(t,e){let n=[],i=!1;return t.iterChangedRanges((r,s)=>n.push(r,s)),e.iterChangedRanges((r,s,o,a)=>{for(let l=0;l<n.length;){let c=n[l++],u=n[l++];a>=c&&o<=u&&(i=!0)}}),i}function wpe(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((n,i)=>n.empty!=e.ranges[i].empty).length===0}function Jz(t,e){return t.length?e.length?t.concat(e):t:e}const es=[],Spe=200;function Zz(t,e){if(t.length){let n=t[t.length-1],i=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-Spe));return i.length&&i[i.length-1].eq(e)?t:(i.push(e),Xy(t,t.length-1,1e9,n.setSelAfter(i)))}else return[lr.selection([e])]}function kpe(t){let e=t[t.length-1],n=t.slice();return n[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function Tw(t,e){if(!t.length)return t;let n=t.length,i=es;for(;n;){let r=Cpe(t[n-1],e,i);if(r.changes&&!r.changes.empty||r.effects.length){let s=t.slice(0,n);return s[n-1]=r,s}else e=r.mapped,n--,i=r.selectionsAfter}return i.length?[lr.selection(i)]:es}function Cpe(t,e,n){let i=Jz(t.selectionsAfter.length?t.selectionsAfter.map(a=>a.map(e)):es,n);if(!t.changes)return lr.selection(i);let r=t.changes.map(e),s=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(s):s;return new lr(r,pt.mapEffects(t.effects,e),o,t.startSelection.map(s),i)}const _pe=/^(input\.type|delete)($|\.)/;class yo{constructor(e,n,i=0,r=void 0){this.done=e,this.undone=n,this.prevTime=i,this.prevUserEvent=r}isolate(){return this.prevTime?new yo(this.done,this.undone):this}addChanges(e,n,i,r,s){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!i||_pe.test(i))&&(!a.selectionsAfter.length&&n-this.prevTime<r.newGroupDelay&&r.joinToEvent(s,xpe(a.changes,e.changes))||i=="input.type.compose")?o=Xy(o,o.length-1,r.minDepth,new lr(e.changes.compose(a.changes),Jz(pt.mapEffects(e.effects,a.changes),a.effects),a.mapped,a.startSelection,es)):o=Xy(o,o.length,r.minDepth,e),new yo(o,es,n,i)}addSelection(e,n,i,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:es;return s.length>0&&n-this.prevTime<r&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&wpe(s[s.length-1],e)?this:new yo(Zz(this.done,e),this.undone,n,i)}addMapping(e){return new yo(Tw(this.done,e),Tw(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,i){let r=e==0?this.done:this.undone;if(r.length==0)return null;let s=r[r.length-1],o=s.selectionsAfter[0]||n.selection;if(i&&s.selectionsAfter.length)return n.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:gC.of({side:e,rest:kpe(r),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let a=r.length==1?es:r.slice(0,r.length-1);return s.mapped&&(a=Tw(a,s.mapped)),n.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:gC.of({side:e,rest:a,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}yo.empty=new yo(es,es);function Km(t,e){return ue.create(t.ranges.map(e),t.mainIndex)}function rc(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function mu({state:t,dispatch:e},n){let i=Km(t.selection,n);return i.eq(t.selection,!0)?!1:(e(rc(t,i)),!0)}function A1(t,e){return ue.cursor(e?t.to:t.from)}function Qz(t,e){return mu(t,n=>n.empty?t.moveByChar(n,e):A1(n,e))}function sc(t){return t.textDirectionAt(t.state.selection.main.head)==sn.LTR}const O3=t=>Qz(t,!sc(t)),L3=t=>Qz(t,sc(t));function e9(t,e){return mu(t,n=>n.empty?t.moveByGroup(n,e):A1(n,e))}const Epe=t=>e9(t,!sc(t)),Ape=t=>e9(t,sc(t));function t9(t,e){return mu(t,n=>{if(!n.empty)return A1(n,e);let i=t.moveVertically(n,e);return i.head!=n.head?i:t.moveToLineBoundary(n,e)})}const D3=t=>t9(t,!1),j3=t=>t9(t,!0);function n9(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,i=0,r;if(e){for(let s of t.state.facet(Be.scrollMargins)){let o=s(t);o!=null&&o.top&&(n=Math.max(o==null?void 0:o.top,n)),o!=null&&o.bottom&&(i=Math.max(o==null?void 0:o.bottom,i))}r=t.scrollDOM.clientHeight-n-i}else r=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:i,selfScroll:e,height:Math.max(t.defaultLineHeight,r-5)}}function i9(t,e){let n=n9(t),{state:i}=t,r=Km(i.selection,o=>o.empty?t.moveVertically(o,e,n.height):A1(o,e));if(r.eq(i.selection))return!1;let s;if(n.selfScroll){let o=t.coordsAtPos(i.selection.main.head),a=t.scrollDOM.getBoundingClientRect(),l=a.top+n.marginTop,c=a.bottom-n.marginBottom;o&&o.top>l&&o.bottom<c&&(s=Be.scrollIntoView(r.main.head,{y:"start",yMargin:o.top-l}))}return t.dispatch(rc(i,r),{effects:s}),!0}const Ow=t=>i9(t,!1),Lw=t=>i9(t,!0);function P1(t,e,n){let i=t.lineBlockAt(e.head),r=t.moveToLineBoundary(e,n);if(r.head==e.head&&r.head!=(n?i.to:i.from)&&(r=t.moveToLineBoundary(e,n,!1)),!n&&r.head==i.from&&i.length){let s=/^\s*/.exec(t.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&e.head!=i.from+s&&(r=ue.cursor(i.from+s))}return r}const B3=t=>mu(t,e=>P1(t,e,!0)),$3=t=>mu(t,e=>P1(t,e,!1)),Ppe=t=>mu(t,e=>ue.cursor(t.lineBlockAt(e.head).from,1)),Npe=t=>mu(t,e=>ue.cursor(t.lineBlockAt(e.head).to,-1));function Mpe(t,e,n){let i=!1,r=Km(t.selection,s=>{let o=x0(t,s.head,-1)||x0(t,s.head,1)||s.head>0&&x0(t,s.head-1,1)||s.head<t.doc.length&&x0(t,s.head+1,-1);if(!o||!o.end)return s;i=!0;let a=o.start.from==s.head?o.end.to:o.end.from;return ue.cursor(a)});return i?(e(rc(t,r)),!0):!1}const Rpe=({state:t,dispatch:e})=>Mpe(t,e);function oc(t,e){let n=Km(t.state.selection,i=>{let r=e(i);return ue.range(i.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return n.eq(t.state.selection)?!1:(t.dispatch(rc(t.state,n)),!0)}function r9(t,e){return oc(t,n=>t.moveByChar(n,e))}const F3=t=>r9(t,!sc(t)),z3=t=>r9(t,sc(t));function s9(t,e){return oc(t,n=>t.moveByGroup(n,e))}const Ipe=t=>s9(t,!sc(t)),Tpe=t=>s9(t,sc(t));function o9(t,e){return oc(t,n=>t.moveVertically(n,e))}const U3=t=>o9(t,!1),V3=t=>o9(t,!0);function a9(t,e){return oc(t,n=>t.moveVertically(n,e,n9(t).height))}const H3=t=>a9(t,!1),W3=t=>a9(t,!0),G3=t=>oc(t,e=>P1(t,e,!0)),X3=t=>oc(t,e=>P1(t,e,!1)),Ope=t=>oc(t,e=>ue.cursor(t.lineBlockAt(e.head).from)),Lpe=t=>oc(t,e=>ue.cursor(t.lineBlockAt(e.head).to)),q3=({state:t,dispatch:e})=>(e(rc(t,{anchor:0})),!0),K3=({state:t,dispatch:e})=>(e(rc(t,{anchor:t.doc.length})),!0),Y3=({state:t,dispatch:e})=>(e(rc(t,{anchor:t.selection.main.anchor,head:0})),!0),J3=({state:t,dispatch:e})=>(e(rc(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),Dpe=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),jpe=({state:t,dispatch:e})=>{let n=M1(t).map(({from:i,to:r})=>ue.range(i,Math.min(r+1,t.doc.length)));return e(t.update({selection:ue.create(n),userEvent:"select"})),!0};function N1(t,e){if(t.state.readOnly)return!1;let n="delete.selection",{state:i}=t,r=i.changeByRange(s=>{let{from:o,to:a}=s;if(o==a){let l=e(s);l<o?(n="delete.backward",l=w0(t,l,!1)):l>o&&(n="delete.forward",l=w0(t,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=w0(t,o,!1),a=w0(t,a,!0);return o==a?{range:s}:{changes:{from:o,to:a},range:ue.cursor(o,o<s.head?-1:1)}});return r.changes.empty?!1:(t.dispatch(i.update(r,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?Be.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function w0(t,e,n){if(t instanceof Be)for(let i of t.state.facet(Be.atomicRanges).map(r=>r(t)))i.between(e,e,(r,s)=>{r<e&&s>e&&(e=n?s:r)});return e}const l9=(t,e,n)=>N1(t,i=>{let r=i.from,{state:s}=t,o=s.doc.lineAt(r),a,l;if(n&&!e&&r>o.from&&r<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,r-o.from))){if(a[a.length-1]=="	")return r-1;let c=Om(a,s.tabSize),u=c%uu(s)||uu(s);for(let d=0;d<u&&a[a.length-1-d]==" ";d++)r--;l=r}else l=ci(o.text,r-o.from,e,e)+o.from,l==r&&o.number!=(e?s.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,r-o.from))&&(l=ci(o.text,l-o.from,!1,!1)+o.from);return l}),Dw=t=>l9(t,!1,!0),Z3=t=>l9(t,!0,!1),c9=(t,e)=>N1(t,n=>{let i=n.head,{state:r}=t,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let a=null;;){if(i==(e?s.to:s.from)){i==n.head&&s.number!=(e?r.doc.lines:1)&&(i+=e?1:-1);break}let l=ci(s.text,i-s.from,e)+s.from,c=s.text.slice(Math.min(i,l)-s.from,Math.max(i,l)-s.from),u=o(c);if(a!=null&&u!=a)break;(c!=" "||i!=n.head)&&(a=u),i=l}return i}),Q3=t=>c9(t,!1),Bpe=t=>c9(t,!0),e4=t=>N1(t,e=>{let n=t.lineBlockAt(e.head).to;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),$pe=t=>N1(t,e=>{let n=t.lineBlockAt(e.head).from;return e.head>n?n:Math.max(0,e.head-1)}),Fpe=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:Nt.of(["",""])},range:ue.cursor(i.from)}));return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},zpe=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(i=>{if(!i.empty||i.from==0||i.from==t.doc.length)return{range:i};let r=i.from,s=t.doc.lineAt(r),o=r==s.from?r-1:ci(s.text,r-s.from,!1)+s.from,a=r==s.to?r+1:ci(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:a,insert:t.doc.slice(r,a).append(t.doc.slice(o,r))},range:ue.cursor(a)}});return n.changes.empty?!1:(e(t.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function M1(t){let e=[],n=-1;for(let i of t.selection.ranges){let r=t.doc.lineAt(i.from),s=t.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=t.doc.lineAt(i.to-1)),n>=r.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(i)}else e.push({from:r.from,to:s.to,ranges:[i]});n=s.number+1}return e}function u9(t,e,n){if(t.readOnly)return!1;let i=[],r=[];for(let s of M1(t)){if(n?s.to==t.doc.length:s.from==0)continue;let o=t.doc.lineAt(n?s.to+1:s.from-1),a=o.length+1;if(n){i.push({from:s.to,to:o.to},{from:s.from,insert:o.text+t.lineBreak});for(let l of s.ranges)r.push(ue.range(Math.min(t.doc.length,l.anchor+a),Math.min(t.doc.length,l.head+a)))}else{i.push({from:o.from,to:s.from},{from:s.to,insert:t.lineBreak+o.text});for(let l of s.ranges)r.push(ue.range(l.anchor-a,l.head-a))}}return i.length?(e(t.update({changes:i,scrollIntoView:!0,selection:ue.create(r,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Upe=({state:t,dispatch:e})=>u9(t,e,!1),Vpe=({state:t,dispatch:e})=>u9(t,e,!0);function d9(t,e,n){if(t.readOnly)return!1;let i=[];for(let r of M1(t))n?i.push({from:r.from,insert:t.doc.slice(r.from,r.to)+t.lineBreak}):i.push({from:r.to,insert:t.lineBreak+t.doc.slice(r.from,r.to)});return e(t.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Hpe=({state:t,dispatch:e})=>d9(t,e,!1),Wpe=({state:t,dispatch:e})=>d9(t,e,!0),Gpe=t=>{if(t.state.readOnly)return!1;let{state:e}=t,n=e.changes(M1(e).map(({from:r,to:s})=>(r>0?r--:s<e.doc.length&&s++,{from:r,to:s}))),i=Km(e.selection,r=>{let s;if(t.lineWrapping){let o=t.lineBlockAt(r.head),a=t.coordsAtPos(r.head,r.assoc||1);a&&(s=o.bottom+t.documentTop-a.bottom+t.defaultLineHeight/2)}return t.moveVertically(r,!0,s)}).map(n);return t.dispatch({changes:n,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Xpe(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=To(t).resolveInner(e),i=n.childBefore(e),r=n.childAfter(e),s;return i&&r&&i.to<=e&&r.from>=e&&(s=i.type.prop(Pt.closedBy))&&s.indexOf(r.name)>-1&&t.doc.lineAt(i.to).from==t.doc.lineAt(r.from).from&&!/\S/.test(t.sliceDoc(i.to,r.from))?{from:i.to,to:r.from}:null}const t4=qpe(!1);function qpe(t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let i=e.changeByRange(r=>{let{from:s,to:o}=r,a=e.doc.lineAt(s),l=!t&&s==o&&Xpe(e,s);t&&(s=o=(o<=a.to?a:e.doc.lineAt(o)).to);let c=new DA(e,{simulateBreak:s,simulateDoubleBreak:!!l}),u=_he(c,s);for(u==null&&(u=Om(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:s,to:o}=l:s>a.from&&s<a.from+100&&!/\S/.test(a.text.slice(0,s))&&(s=a.from);let d=["",fC(e,u)];return l&&d.push(fC(e,c.lineIndent(a.from,-1))),{changes:{from:s,to:o,insert:Nt.of(d)},range:ue.cursor(s+1+d[1].length)}});return n(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function f9(t,e){let n=-1;return t.changeByRange(i=>{let r=[];for(let o=i.from;o<=i.to;){let a=t.doc.lineAt(o);a.number>n&&(i.empty||i.to>a.from)&&(e(a,r,i),n=a.number),o=a.to+1}let s=t.changes(r);return{changes:r,range:ue.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const yC=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(f9(t,(n,i)=>{i.push({from:n.from,insert:t.facet(LA)})}),{userEvent:"input.indent"})),!0),n4=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(f9(t,(n,i)=>{let r=/^\s*/.exec(n.text)[0];if(!r)return;let s=Om(r,t.tabSize),o=0,a=fC(t,Math.max(0,s-uu(t)));for(;o<r.length&&o<a.length&&r.charCodeAt(o)==a.charCodeAt(o);)o++;i.push({from:n.from+o,to:n.from+r.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),i4=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class gm{constructor(e,n,i=0,r=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,r),this.bufferStart=i,this.normalize=s?a=>s(i4(a)):i4,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return qr(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=dE(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=na(e);let r=this.normalize(n);if(r.length)for(let s=0,o=i;;s++){let a=r.charCodeAt(s),l=this.match(a,o,this.bufferPos+this.bufferStart);if(s==r.length-1){if(l)return this.value=l,this;break}o==i&&s<n.length&&n.charCodeAt(s)==a&&o++}}}match(e,n,i){let r=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],a=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?r={from:this.matches[s+1],to:i}:(this.matches[s]++,a=!0)),a||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:n,to:i}:this.matches.push(1,n)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(gm.prototype[Symbol.iterator]=function(){return this});const h9={from:-1,to:-1,match:/.*/.exec("")},WA="gm"+(/x/.unicode==null?"":"u");class p9{constructor(e,n,i,r=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=h9,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new m9(e,n,i,r,s);this.re=new RegExp(n,WA+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=qy(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let i=this.curLineStart+n.index,r=i+n[0].length;if(this.matchPos=qy(this.text,r+(i==r?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<r||i>this.value.to)&&(!this.test||this.test(i,r,n)))return this.value={from:i,to:r,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const jw=new WeakMap;class Rd{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,i){let r=jw.get(e);if(!r||r.from>=i||r.to<=n){let a=new Rd(n,e.sliceString(n,i));return jw.set(e,a),a}if(r.from==n&&r.to==i)return r;let{text:s,from:o}=r;return o>n&&(s=e.sliceString(n,o)+s,o=n),r.to<i&&(s+=e.sliceString(r.to,i)),jw.set(e,new Rd(o,s)),new Rd(n,s.slice(n-o,i-o))}}class m9{constructor(e,n,i,r,s){this.text=e,this.to=s,this.done=!1,this.value=h9,this.matchPos=qy(e,r),this.re=new RegExp(n,WA+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=Rd.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let i=this.flat.from+n.index,r=i+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,r,n)))return this.value={from:i,to:r,match:n},this.matchPos=qy(this.text,r+(i==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Rd.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(p9.prototype[Symbol.iterator]=m9.prototype[Symbol.iterator]=function(){return this});function Kpe(t){try{return new RegExp(t,WA),!0}catch{return!1}}function qy(t,e){if(e>=t.length)return e;let n=t.lineAt(e),i;for(;e<n.to&&(i=n.text.charCodeAt(e-n.from))>=56320&&i<57344;)e++;return e}function bC(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),n=Ht("input",{class:"cm-textfield",name:"line",value:e}),i=Ht("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),t.dispatch({effects:lp.of(!1)}),t.focus()):s.keyCode==13&&(s.preventDefault(),r())},onsubmit:s=>{s.preventDefault(),r()}},Ht("label",t.state.phrase("Go to line"),": ",n)," ",Ht("button",{class:"cm-button",type:"submit"},t.state.phrase("go")),Ht("button",{name:"close",onclick:()=>{t.dispatch({effects:lp.of(!1)}),t.focus()},"aria-label":t.state.phrase("close"),type:"button"},["×"]));function r(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!s)return;let{state:o}=t,a=o.doc.lineAt(o.selection.main.head),[,l,c,u,d]=s,f=u?+u.slice(1):0,p=c?+c:a.number;if(c&&d){let y=p/100;l&&(y=y*(l=="-"?-1:1)+a.number/o.doc.lines),p=Math.round(o.doc.lines*y)}else c&&l&&(p=p*(l=="-"?-1:1)+a.number);let m=o.doc.line(Math.max(1,Math.min(o.doc.lines,p))),g=ue.cursor(m.from+Math.max(0,Math.min(f,m.length)));t.dispatch({effects:[lp.of(!1),Be.scrollIntoView(g.from,{y:"center"})],selection:g}),t.focus()}return{dom:i}}const lp=pt.define(),r4=zi.define({create(){return!0},update(t,e){for(let n of e.effects)n.is(lp)&&(t=n.value);return t},provide:t=>Qp.from(t,e=>e?bC:null)}),Ype=t=>{let e=Zp(t,bC);if(!e){let n=[lp.of(!0)];t.state.field(r4,!1)==null&&n.push(pt.appendConfig.of([r4,Jpe])),t.dispatch({effects:n}),e=Zp(t,bC)}return e&&e.dom.querySelector("input").select(),!0},Jpe=Be.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),Zpe=({state:t,dispatch:e})=>{let{selection:n}=t,i=ue.create(n.ranges.map(r=>t.wordAt(r.head)||ue.cursor(r.head)),n.mainIndex);return i.eq(n)?!1:(e(t.update({selection:i})),!0)};function Qpe(t,e){let{main:n,ranges:i}=t.selection,r=t.wordAt(n.head),s=r&&r.from==n.from&&r.to==n.to;for(let o=!1,a=new gm(t.doc,e,i[i.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new gm(t.doc,e,0,Math.max(0,i[i.length-1].from-1)),o=!0}else{if(o&&i.some(l=>l.from==a.value.from))continue;if(s){let l=t.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const eme=({state:t,dispatch:e})=>{let{ranges:n}=t.selection;if(n.some(s=>s.from===s.to))return Zpe({state:t,dispatch:e});let i=t.sliceDoc(n[0].from,n[0].to);if(t.selection.ranges.some(s=>t.sliceDoc(s.from,s.to)!=i))return!1;let r=Qpe(t,i);return r?(e(t.update({selection:t.selection.addRange(ue.range(r.from,r.to),!1),effects:Be.scrollIntoView(r.to)})),!0):!1},Lf=Re.define({combine(t){return Zl(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new cme(e),scrollToMatch:e=>Be.scrollIntoView(e)})}});class g9{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||Kpe(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new rme(this):new nme(this)}getCursor(e,n=0,i){let r=e.doc?e:kt.create({doc:e});return i==null&&(i=r.doc.length),this.regexp?Vu(this,r,n,i):Uu(this,r,n,i)}}class v9{constructor(e){this.spec=e}}function Uu(t,e,n,i){return new gm(e.doc,t.unquoted,n,i,t.caseSensitive?void 0:r=>r.toLowerCase(),t.wholeWord?tme(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function tme(t,e){return(n,i,r,s)=>((s>n||s+r.length<i)&&(s=Math.max(0,n-2),r=t.sliceString(s,Math.min(t.length,i+2))),(e(Ky(r,n-s))!=ui.Word||e(Yy(r,n-s))!=ui.Word)&&(e(Yy(r,i-s))!=ui.Word||e(Ky(r,i-s))!=ui.Word))}class nme extends v9{constructor(e){super(e)}nextMatch(e,n,i){let r=Uu(this.spec,e,i,e.doc.length).nextOverlapping();if(r.done){let s=Math.min(e.doc.length,n+this.spec.unquoted.length);r=Uu(this.spec,e,0,s).nextOverlapping()}return r.done||r.value.from==n&&r.value.to==i?null:r.value}prevMatchInRange(e,n,i){for(let r=i;;){let s=Math.max(n,r-1e4-this.spec.unquoted.length),o=Uu(this.spec,e,s,r),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(s==n)return null;r-=1e4}}prevMatch(e,n,i){let r=this.prevMatchInRange(e,0,n);return r||(r=this.prevMatchInRange(e,Math.max(0,i-this.spec.unquoted.length),e.doc.length)),r&&(r.from!=n||r.to!=i)?r:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let i=Uu(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=n)return null;r.push(i.value)}return r}highlight(e,n,i,r){let s=Uu(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}function Vu(t,e,n,i){return new p9(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?ime(e.charCategorizer(e.selection.main.head)):void 0},n,i)}function Ky(t,e){return t.slice(ci(t,e,!1),e)}function Yy(t,e){return t.slice(e,ci(t,e))}function ime(t){return(e,n,i)=>!i[0].length||(t(Ky(i.input,i.index))!=ui.Word||t(Yy(i.input,i.index))!=ui.Word)&&(t(Yy(i.input,i.index+i[0].length))!=ui.Word||t(Ky(i.input,i.index+i[0].length))!=ui.Word)}class rme extends v9{nextMatch(e,n,i){let r=Vu(this.spec,e,i,e.doc.length).next();return r.done&&(r=Vu(this.spec,e,0,n).next()),r.done?null:r.value}prevMatchInRange(e,n,i){for(let r=1;;r++){let s=Math.max(n,i-r*1e4),o=Vu(this.spec,e,s,i),a=null;for(;!o.next().done;)a=o.value;if(a&&(s==n||a.from>s+10))return a;if(s==n)return null}}prevMatch(e,n,i){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(n,i)=>{if(i=="&")return e.match[0];if(i=="$")return"$";for(let r=i.length;r>0;r--){let s=+i.slice(0,r);if(s>0&&s<e.match.length)return e.match[s]+i.slice(r)}return n})}matchAll(e,n){let i=Vu(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=n)return null;r.push(i.value)}return r}highlight(e,n,i,r){let s=Vu(this.spec,e,Math.max(0,n-250),Math.min(i+250,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}const vm=pt.define(),GA=pt.define(),Al=zi.define({create(t){return new Bw(xC(t).create(),null)},update(t,e){for(let n of e.effects)n.is(vm)?t=new Bw(n.value.create(),t.panel):n.is(GA)&&(t=new Bw(t.query,n.value?XA:null));return t},provide:t=>Qp.from(t,e=>e.panel)});class Bw{constructor(e,n){this.query=e,this.panel=n}}const sme=gt.mark({class:"cm-searchMatch"}),ome=gt.mark({class:"cm-searchMatch cm-searchMatch-selected"}),ame=pi.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(Al))}update(t){let e=t.state.field(Al);(e!=t.startState.field(Al)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return gt.none;let{view:n}=this,i=new Bl;for(let r=0,s=n.visibleRanges,o=s.length;r<o;r++){let{from:a,to:l}=s[r];for(;r<o-1&&l>s[r+1].from-2*250;)l=s[++r].to;t.highlight(n.state,a,l,(c,u)=>{let d=n.state.selection.ranges.some(f=>f.from==c&&f.to==u);i.add(c,u,d?ome:sme)})}return i.finish()}},{decorations:t=>t.decorations});function Ym(t){return e=>{let n=e.state.field(Al,!1);return n&&n.query.spec.valid?t(e,n):S9(e)}}const s4=Ym((t,{query:e})=>{let{to:n}=t.state.selection.main,i=e.nextMatch(t.state,n,n);if(!i)return!1;let r=ue.single(i.from,i.to),s=t.state.facet(Lf);return t.dispatch({selection:r,effects:[qA(t,i),s.scrollToMatch(r.main,t)],userEvent:"select.search"}),w9(t),!0}),o4=Ym((t,{query:e})=>{let{state:n}=t,{from:i}=n.selection.main,r=e.prevMatch(n,i,i);if(!r)return!1;let s=ue.single(r.from,r.to),o=t.state.facet(Lf);return t.dispatch({selection:s,effects:[qA(t,r),o.scrollToMatch(s.main,t)],userEvent:"select.search"}),w9(t),!0}),y9=Ym((t,{query:e})=>{let n=e.matchAll(t.state,1e3);return!n||!n.length?!1:(t.dispatch({selection:ue.create(n.map(i=>ue.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),lme=({state:t,dispatch:e})=>{let n=t.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:i,to:r}=n.main,s=[],o=0;for(let a=new gm(t.doc,t.sliceDoc(i,r));!a.next().done;){if(s.length>1e3)return!1;a.value.from==i&&(o=s.length),s.push(ue.range(a.value.from,a.value.to))}return e(t.update({selection:ue.create(s,o),userEvent:"select.search.matches"})),!0},a4=Ym((t,{query:e})=>{let{state:n}=t,{from:i,to:r}=n.selection.main;if(n.readOnly)return!1;let s=e.nextMatch(n,i,i);if(!s)return!1;let o=s,a=[],l,c,u=[];o.from==i&&o.to==r&&(c=n.toText(e.getReplacement(o)),a.push({from:o.from,to:o.to,insert:c}),o=e.nextMatch(n,o.from,o.to),u.push(Be.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(i).number)+".")));let d=t.state.changes(a);return o&&(l=ue.single(o.from,o.to).map(d),u.push(qA(t,o)),u.push(n.facet(Lf).scrollToMatch(l.main,t))),t.dispatch({changes:d,selection:l,effects:u,userEvent:"input.replace"}),!0}),b9=Ym((t,{query:e})=>{if(t.state.readOnly)return!1;let n=e.matchAll(t.state,1e9).map(r=>{let{from:s,to:o}=r;return{from:s,to:o,insert:e.getReplacement(r)}});if(!n.length)return!1;let i=t.state.phrase("replaced $ matches",n.length)+".";return t.dispatch({changes:n,effects:Be.announce.of(i),userEvent:"input.replace.all"}),!0});function XA(t){return t.state.facet(Lf).createPanel(t)}function xC(t,e){var n,i,r,s,o;let a=t.selection.main,l=a.empty||a.to>a.from+100?"":t.sliceDoc(a.from,a.to);if(e&&!l)return e;let c=t.facet(Lf);return new g9({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(i=e==null?void 0:e.caseSensitive)!==null&&i!==void 0?i:c.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:c.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:c.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function x9(t){let e=Zp(t,XA);return e&&e.dom.querySelector("[main-field]")}function w9(t){let e=x9(t);e&&e==t.root.activeElement&&e.select()}const S9=t=>{let e=t.state.field(Al,!1);if(e&&e.panel){let n=x9(t);if(n&&n!=t.root.activeElement){let i=xC(t.state,e.query.spec);i.valid&&t.dispatch({effects:vm.of(i)}),n.focus(),n.select()}}else t.dispatch({effects:[GA.of(!0),e?vm.of(xC(t.state,e.query.spec)):pt.appendConfig.of(dme)]});return!0},k9=t=>{let e=t.state.field(Al,!1);if(!e||!e.panel)return!1;let n=Zp(t,XA);return n&&n.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:GA.of(!1)}),!0};class cme{constructor(e){this.view=e;let n=this.query=e.state.field(Al).query.spec;this.commit=this.commit.bind(this),this.searchField=Ht("input",{value:n.search,placeholder:mr(e,"Find"),"aria-label":mr(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Ht("input",{value:n.replace,placeholder:mr(e,"Replace"),"aria-label":mr(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Ht("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=Ht("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=Ht("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function i(r,s,o){return Ht("button",{class:"cm-button",name:r,onclick:s,type:"button"},o)}this.dom=Ht("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,i("next",()=>s4(e),[mr(e,"next")]),i("prev",()=>o4(e),[mr(e,"previous")]),i("select",()=>y9(e),[mr(e,"all")]),Ht("label",null,[this.caseField,mr(e,"match case")]),Ht("label",null,[this.reField,mr(e,"regexp")]),Ht("label",null,[this.wordField,mr(e,"by word")]),...e.state.readOnly?[]:[Ht("br"),this.replaceField,i("replace",()=>a4(e),[mr(e,"replace")]),i("replaceAll",()=>b9(e),[mr(e,"replace all")])],Ht("button",{name:"close",onclick:()=>k9(e),"aria-label":mr(e,"close"),type:"button"},["×"])])}commit(){let e=new g9({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:vm.of(e)}))}keydown(e){Tte(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?o4:s4)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),a4(this.view))}update(e){for(let n of e.transactions)for(let i of n.effects)i.is(vm)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Lf).top}}function mr(t,e){return t.state.phrase(e)}const S0=30,k0=/[\s\.,:;?!]/;function qA(t,{from:e,to:n}){let i=t.state.doc.lineAt(e),r=t.state.doc.lineAt(n).to,s=Math.max(i.from,e-S0),o=Math.min(r,n+S0),a=t.state.sliceDoc(s,o);if(s!=i.from){for(let l=0;l<S0;l++)if(!k0.test(a[l+1])&&k0.test(a[l])){a=a.slice(l);break}}if(o!=r){for(let l=a.length-1;l>a.length-S0;l--)if(!k0.test(a[l-1])&&k0.test(a[l])){a=a.slice(0,l);break}}return Be.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${i.number}.`)}const ume=Be.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),dme=[Al,Im.low(ame),ume];class fme{constructor(e,n,i,r){this.state=e,this.pos=n,this.explicit=i,this.view=r,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let n=To(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),i=Math.max(n.from,this.pos-250),r=n.text.slice(i-n.from,this.pos-n.from),s=r.search(C9(e,!1));return s<0?null:{from:i+s,to:this.pos,text:r.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,n,i){e=="abort"&&this.abortListeners&&(this.abortListeners.push(n),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function l4(t){let e=Object.keys(t).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function hme(t){let e=Object.create(null),n=Object.create(null);for(let{label:r}of t){e[r[0]]=!0;for(let s=1;s<r.length;s++)n[r[s]]=!0}let i=l4(e)+l4(n)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function pme(t){let e=t.map(r=>typeof r=="string"?{label:r}:r),[n,i]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:hme(e);return r=>{let s=r.matchBefore(i);return s||r.explicit?{from:s?s.from:r.pos,options:e,validFor:n}:null}}class c4{constructor(e,n,i,r){this.completion=e,this.source=n,this.match=i,this.score=r}}function cp(t){return t.selection.main.from}function C9(t,e){var n;let{source:i}=t,r=e&&i[0]!="^",s=i[i.length-1]!="$";return!r&&!s?t:new RegExp(`${r?"^":""}(?:${i})${s?"$":""}`,(n=t.flags)!==null&&n!==void 0?n:t.ignoreCase?"i":"")}const _9=Ca.define();function mme(t,e,n,i){let{main:r}=t.selection,s=n-r.from,o=i-r.from;return Object.assign(Object.assign({},t.changeByRange(a=>{if(a!=r&&n!=i&&t.sliceDoc(a.from+s,a.from+o)!=t.sliceDoc(n,i))return{range:a};let l=t.toText(e);return{changes:{from:a.from+s,to:i==r.from?a.to:a.from+o,insert:l},range:ue.cursor(a.from+s+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const u4=new WeakMap;function gme(t){if(!Array.isArray(t))return t;let e=u4.get(t);return e||u4.set(t,e=pme(t)),e}const E9=pt.define(),KA=pt.define();class vme{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let i=qr(e,n),r=na(i);this.chars.push(i);let s=e.slice(n,n+r),o=s.toUpperCase();this.folded.push(qr(o==s?s.toLowerCase():o,0)),n+=r}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:n,folded:i,any:r,precise:s,byWord:o}=this;if(n.length==1){let b=qr(e,0),w=na(b),k=w==e.length?0:-100;if(b!=n[0])if(b==i[0])k+=-200;else return null;return this.ret(k,[0,w])}let a=e.indexOf(this.pattern);if(a==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=n.length,c=0;if(a<0){for(let b=0,w=Math.min(e.length,200);b<w&&c<l;){let k=qr(e,b);(k==n[c]||k==i[c])&&(r[c++]=b),b+=na(k)}if(c<l)return null}let u=0,d=0,f=!1,p=0,m=-1,g=-1,y=/[a-z]/.test(e),v=!0;for(let b=0,w=Math.min(e.length,200),k=0;b<w&&d<l;){let C=qr(e,b);a<0&&(u<l&&C==n[u]&&(s[u++]=b),p<l&&(C==n[p]||C==i[p]?(p==0&&(m=b),g=b+1,p++):p=0));let E,_=C<255?C>=48&&C<=57||C>=97&&C<=122?2:C>=65&&C<=90?1:0:(E=dE(C))!=E.toLowerCase()?1:E!=E.toUpperCase()?2:0;(!b||_==1&&y||k==0&&_!=0)&&(n[d]==C||i[d]==C&&(f=!0)?o[d++]=b:o.length&&(v=!1)),k=_,b+=na(C)}return d==l&&o[0]==0&&v?this.result(-100+(f?-200:0),o,e):p==l&&m==0?this.ret(-200-e.length+(g==e.length?0:-100),[0,g]):a>-1?this.ret(-700-e.length,[a,a+this.pattern.length]):p==l?this.ret(-900-e.length,[m,g]):d==l?this.result(-100+(f?-200:0)+-700+(v?0:-1100),o,e):n.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,n,i){let r=[],s=0;for(let o of n){let a=o+(this.astral?na(qr(i,o)):1);s&&r[s-1]==o?r[s-1]=a:(r[s++]=o,r[s++]=a)}return this.ret(e-i.length,r)}}class yme{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let n=e.slice(0,this.pattern.length),i=n==this.pattern?0:n.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,n.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const uo=Re.define({combine(t){return Zl(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:bme,filterStrict:!1,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>i=>d4(e(i),n(i)),optionClass:(e,n)=>i=>d4(e(i),n(i)),addToOptions:(e,n)=>e.concat(n),filterStrict:(e,n)=>e||n})}});function d4(t,e){return t?e?t+" "+e:t:e}function bme(t,e,n,i,r,s){let o=t.textDirection==sn.RTL,a=o,l=!1,c="top",u,d,f=e.left-r.left,p=r.right-e.right,m=i.right-i.left,g=i.bottom-i.top;if(a&&f<Math.min(m,p)?a=!1:!a&&p<Math.min(m,f)&&(a=!0),m<=(a?f:p))u=Math.max(r.top,Math.min(n.top,r.bottom-g))-e.top,d=Math.min(400,a?f:p);else{l=!0,d=Math.min(400,(o?e.right:r.right-e.left)-30);let b=r.bottom-e.bottom;b>=g||b>e.top?u=n.bottom-e.top:(c="bottom",u=e.bottom-n.top)}let y=(e.bottom-e.top)/s.offsetHeight,v=(e.right-e.left)/s.offsetWidth;return{style:`${c}: ${u/y}px; max-width: ${d/v}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":a?"left":"right")}}function xme(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(n){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),n.type&&i.classList.add(...n.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(n,i,r,s){let o=document.createElement("span");o.className="cm-completionLabel";let a=n.displayLabel||n.label,l=0;for(let c=0;c<s.length;){let u=s[c++],d=s[c++];u>l&&o.appendChild(document.createTextNode(a.slice(l,u)));let f=o.appendChild(document.createElement("span"));f.appendChild(document.createTextNode(a.slice(u,d))),f.className="cm-completionMatchedText",l=d}return l<a.length&&o.appendChild(document.createTextNode(a.slice(l))),o},position:50},{render(n){if(!n.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=n.detail,i},position:80}),e.sort((n,i)=>n.position-i.position).map(n=>n.render)}function $w(t,e,n){if(t<=n)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let r=Math.floor(e/n);return{from:r*n,to:(r+1)*n}}let i=Math.floor((t-e)/n);return{from:t-(i+1)*n,to:t-i*n}}class wme{constructor(e,n,i){this.view=e,this.stateField=n,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let r=e.state.field(n),{options:s,selected:o}=r.open,a=e.state.facet(uo);this.optionContent=xme(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=$w(s.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=e.state.field(n).open;for(let u=l.target,d;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(d=/-(\d+)$/.exec(u.id))&&+d[1]<c.length){this.applyCompletion(e,c[+d[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(uo).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:KA.of(null)})}),this.showOptions(s,r.id)}mount(){this.updateSel()}showOptions(e,n){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,n,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var n;let i=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=r){let{options:s,selected:o,disabled:a}=i.open;(!r.open||r.open.options!=s)&&(this.range=$w(s.length,o,e.state.facet(uo).maxRenderedOptions),this.showOptions(s,i.id)),this.updateSel(),a!=((n=r.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of n.split(" "))i&&this.dom.classList.add(i);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;if((n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=$w(n.options.length,n.selected,this.view.state.facet(uo).maxRenderedOptions),this.showOptions(n.options,e.id)),this.updateSelectedOption(n.selected)){this.destroyInfo();let{completion:i}=n.options[n.selected],{info:r}=i;if(!r)return;let s=typeof r=="string"?document.createTextNode(r):r(i);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,i)}).catch(o=>Ar(this.view.state,o,"completion info")):this.addInfoPane(s,i)}}addInfoPane(e,n){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:s}=e;i.appendChild(r),this.infoDestroy=s||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let i=this.list.firstChild,r=this.range.from;i;i=i.nextSibling,r++)i.nodeName!="LI"||!i.id?r--:r==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),n=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return n&&kme(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return r.top>Math.min(s.bottom,n.bottom)-10||r.bottom<Math.max(s.top,n.top)+10?null:this.view.state.facet(uo).positionInfo(this.view,n,r,i,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,i){const r=document.createElement("ul");r.id=n,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions")),r.addEventListener("mousedown",o=>{o.target==r&&o.preventDefault()});let s=null;for(let o=i.from;o<i.to;o++){let{completion:a,match:l}=e[o],{section:c}=a;if(c){let f=typeof c=="string"?c:c.name;if(f!=s&&(o>i.from||i.from==0))if(s=f,typeof c!="string"&&c.header)r.appendChild(c.header(c));else{let p=r.appendChild(document.createElement("completion-section"));p.textContent=f}}const u=r.appendChild(document.createElement("li"));u.id=n+"-"+o,u.setAttribute("role","option");let d=this.optionClass(a);d&&(u.className=d);for(let f of this.optionContent){let p=f(a,this.view.state,this.view,l);p&&u.appendChild(p)}}return i.from&&r.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function Sme(t,e){return n=>new wme(n,t,e)}function kme(t,e){let n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),r=n.height/t.offsetHeight;i.top<n.top?t.scrollTop-=(n.top-i.top)/r:i.bottom>n.bottom&&(t.scrollTop+=(i.bottom-n.bottom)/r)}function f4(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function Cme(t,e){let n=[],i=null,r=c=>{n.push(c);let{section:u}=c.completion;if(u){i||(i=[]);let d=typeof u=="string"?u:u.name;i.some(f=>f.name==d)||i.push(typeof u=="string"?{name:d}:u)}},s=e.facet(uo);for(let c of t)if(c.hasResult()){let u=c.result.getMatch;if(c.result.filter===!1)for(let d of c.result.options)r(new c4(d,c.source,u?u(d):[],1e9-n.length));else{let d=e.sliceDoc(c.from,c.to),f,p=s.filterStrict?new yme(d):new vme(d);for(let m of c.result.options)if(f=p.match(m.label)){let g=m.displayLabel?u?u(m,f.matched):[]:f.matched;r(new c4(m,c.source,g,f.score+(m.boost||0)))}}}if(i){let c=Object.create(null),u=0,d=(f,p)=>{var m,g;return((m=f.rank)!==null&&m!==void 0?m:1e9)-((g=p.rank)!==null&&g!==void 0?g:1e9)||(f.name<p.name?-1:1)};for(let f of i.sort(d))u-=1e5,c[f.name]=u;for(let f of n){let{section:p}=f.completion;p&&(f.score+=c[typeof p=="string"?p:p.name])}}let o=[],a=null,l=s.compareCompletions;for(let c of n.sort((u,d)=>d.score-u.score||l(u.completion,d.completion))){let u=c.completion;!a||a.label!=u.label||a.detail!=u.detail||a.type!=null&&u.type!=null&&a.type!=u.type||a.apply!=u.apply||a.boost!=u.boost?o.push(c):f4(c.completion)>f4(a)&&(o[o.length-1]=c),a=c.completion}return o}class dd{constructor(e,n,i,r,s,o){this.options=e,this.attrs=n,this.tooltip=i,this.timestamp=r,this.selected=s,this.disabled=o}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new dd(this.options,h4(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,i,r,s,o){if(r&&!o&&e.some(c=>c.isPending))return r.setDisabled();let a=Cme(e,n);if(!a.length)return r&&e.some(c=>c.isPending)?r.setDisabled():null;let l=n.facet(uo).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let c=r.options[r.selected].completion;for(let u=0;u<a.length;u++)if(a[u].completion==c){l=u;break}}return new dd(a,h4(i,l),{pos:e.reduce((c,u)=>u.hasResult()?Math.min(c,u.from):c,1e8),create:Rme,above:s.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new dd(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new dd(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Jy{constructor(e,n,i){this.active=e,this.id=n,this.open=i}static start(){return new Jy(Pme,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,i=n.facet(uo),s=(i.override||n.languageDataAt("autocomplete",cp(n)).map(gme)).map(l=>(this.active.find(u=>u.source==l)||new Is(l,this.active.some(u=>u.state!=0)?1:0)).update(e,i));s.length==this.active.length&&s.every((l,c)=>l==this.active[c])&&(s=this.active);let o=this.open,a=e.effects.some(l=>l.is(A9));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!_me(s,this.active)||a?o=dd.build(s,n,this.id,o,i,a):o&&o.disabled&&!s.some(l=>l.isPending)&&(o=null),!o&&s.every(l=>!l.isPending)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new Is(l.source,0):l));for(let l of e.effects)l.is(P9)&&(o=o&&o.setSelected(l.value,this.id));return s==this.active&&o==this.open?this:new Jy(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?Eme:Ame}}function _me(t,e){if(t==e)return!0;for(let n=0,i=0;;){for(;n<t.length&&!t[n].hasResult();)n++;for(;i<e.length&&!e[i].hasResult();)i++;let r=n==t.length,s=i==e.length;if(r||s)return r==s;if(t[n++].result!=e[i++].result)return!1}}const Eme={"aria-autocomplete":"list"},Ame={};function h4(t,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(n["aria-activedescendant"]=t+"-"+e),n}const Pme=[];function Nme(t,e){if(t.isUserEvent("input.complete")){let i=t.annotation(_9);if(i&&e.activateOnCompletion(i))return 12}let n=t.isUserEvent("input.type");return n&&e.activateOnTyping?5:n?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class Is{constructor(e,n,i=!1){this.source=e,this.state=n,this.explicit=i}hasResult(){return!1}get isPending(){return this.state==1}update(e,n){let i=Nme(e,n),r=this;(i&8||i&16&&this.touches(e))&&(r=new Is(r.source,0)),i&4&&r.state==0&&(r=new Is(this.source,1)),r=r.updateFor(e,i);for(let s of e.effects)if(s.is(E9))r=new Is(r.source,1,s.value);else if(s.is(KA))r=new Is(r.source,0);else if(s.is(A9))for(let o of s.value)o.source==r.source&&(r=o);return r}updateFor(e,n){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(cp(e.state))}}class up extends Is{constructor(e,n,i,r,s,o){super(e,3,n),this.limit=i,this.result=r,this.from=s,this.to=o}hasResult(){return!0}updateFor(e,n){var i;if(!(n&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=cp(e.state);if(a>o||!r||n&2&&(cp(e.startState)==this.from||a<this.limit))return new Is(this.source,n&4?1:0);let l=e.changes.mapPos(this.limit);return Mme(r.validFor,e.state,s,o)?new up(this.source,this.explicit,l,r,s,o):r.update&&(r=r.update(r,s,o,new fme(e.state,a,!1)))?new up(this.source,this.explicit,l,r,r.from,(i=r.to)!==null&&i!==void 0?i:cp(e.state)):new Is(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new up(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new Is(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function Mme(t,e,n,i){if(!t)return!1;let r=e.sliceDoc(n,i);return typeof t=="function"?t(r,n,i,e):C9(t,!0).test(r)}const A9=pt.define({map(t,e){return t.map(n=>n.map(e))}}),P9=pt.define(),Df=zi.define({create(){return Jy.start()},update(t,e){return t.update(e)},provide:t=>[EE.from(t,e=>e.tooltip),Be.contentAttributes.from(t,e=>e.attrs)]});function N9(t,e){const n=e.completion.apply||e.completion.label;let i=t.state.field(Df).active.find(r=>r.source==e.source);return i instanceof up?(typeof n=="string"?t.dispatch(Object.assign(Object.assign({},mme(t.state,n,i.from,i.to)),{annotations:_9.of(e.completion)})):n(t,e.completion,i.from,i.to),!0):!1}const Rme=Sme(Df,N9);function C0(t,e="option"){return n=>{let i=n.state.field(Df,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<n.state.facet(uo).interactionDelay)return!1;let r=1,s;e=="page"&&(s=dne(n,i.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=i.open.options,a=i.open.selected>-1?i.open.selected+r*(t?1:-1):t?0:o-1;return a<0?a=e=="page"?0:o-1:a>=o&&(a=e=="page"?o-1:0),n.dispatch({effects:P9.of(a)}),!0}}const p4=t=>{let e=t.state.field(Df,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(uo).interactionDelay?!1:N9(t,e.open.options[e.open.selected])},Ime=t=>t.state.field(Df,!1)?(t.dispatch({effects:E9.of(!0)}),!0):!1,Tme=t=>{let e=t.state.field(Df,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(t.dispatch({effects:KA.of(null)}),!0)},M9={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},R9=new class extends tu{};R9.startSide=1;R9.endSide=-1;const Fw="()[]{}<>«»»«［］｛｝";function Ome(t){for(let e=0;e<Fw.length;e+=2)if(Fw.charCodeAt(e)==t)return Fw.charAt(e+1);return dE(t<128?t:t+1)}function Lme(t,e){return t.languageDataAt("closeBrackets",e)[0]||M9}const Dme=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=Lme(t,t.selection.main.head).brackets||M9.brackets,r=null,s=t.changeByRange(o=>{if(o.empty){let a=Bme(t.doc,o.head);for(let l of i)if(l==a&&jme(t.doc,o.head)==Ome(qr(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:ue.cursor(o.head-l.length)}}return{range:r=o}});return r||e(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!r};function jme(t,e){let n=t.sliceString(e,e+2);return n.slice(0,na(qr(n,0)))}function Bme(t,e){let n=t.sliceString(e-2,e);return na(qr(n,0))==n.length?n:n.slice(1)}class m4{constructor(e,n,i){this.from=e,this.to=n,this.diagnostic=i}}class Nc{constructor(e,n,i){this.diagnostics=e,this.panel=n,this.selected=i}static init(e,n,i){let r=i.facet(bo).markerFilter;r&&(e=r(e,i));let s=e.slice().sort((u,d)=>u.from-d.from||u.to-d.to),o=new Bl,a=[],l=0;for(let u=0;;){let d=u==s.length?null:s[u];if(!d&&!a.length)break;let f,p;for(a.length?(f=l,p=a.reduce((g,y)=>Math.min(g,y.to),d&&d.from>f?d.from:1e8)):(f=d.from,p=d.to,a.push(d),u++);u<s.length;){let g=s[u];if(g.from==f&&(g.to>g.from||g.to==f))a.push(g),u++,p=Math.min(g.to,p);else{p=Math.min(g.from,p);break}}let m=Qme(a);if(a.some(g=>g.from==g.to||g.from==g.to-1&&i.doc.lineAt(g.from).to==g.from))o.add(f,f,gt.widget({widget:new Kme(m),diagnostics:a.slice()}));else{let g=a.reduce((y,v)=>v.markClass?y+" "+v.markClass:y,"");o.add(f,p,gt.mark({class:"cm-lintRange cm-lintRange-"+m+g,diagnostics:a.slice(),inclusiveEnd:a.some(y=>y.to>p)}))}l=p;for(let g=0;g<a.length;g++)a[g].to<=l&&a.splice(g--,1)}let c=o.finish();return new Nc(c,n,wf(c))}}function wf(t,e=null,n=0){let i=null;return t.between(n,1e9,(r,s,{spec:o})=>{if(!(e&&o.diagnostics.indexOf(e)<0))if(!i)i=new m4(r,s,e||o.diagnostics[0]);else{if(o.diagnostics.indexOf(i.diagnostic)<0)return!1;i=new m4(i.from,s,i.diagnostic)}}),i}function $me(t,e){let n=e.pos,i=e.end||n,r=t.state.facet(bo).hideOn(t,n,i);if(r!=null)return r;let s=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(o=>o.is(YA))||t.changes.touchesRange(s.from,Math.max(s.to,i)))}function I9(t,e){return t.field(Mr,!1)?e:e.concat(pt.appendConfig.of(D9))}function Fme(t,e){return{effects:I9(t,[YA.of(e)])}}const YA=pt.define(),JA=pt.define(),T9=pt.define(),Mr=zi.define({create(){return new Nc(gt.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let n=t.diagnostics.map(e.changes),i=null,r=t.panel;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);i=wf(n,t.selected.diagnostic,s)||wf(n,null,s)}!n.size&&r&&e.state.facet(bo).autoPanel&&(r=null),t=new Nc(n,r,i)}for(let n of e.effects)if(n.is(YA)){let i=e.state.facet(bo).autoPanel?n.value.length?ym.open:null:t.panel;t=Nc.init(n.value,i,e.state)}else n.is(JA)?t=new Nc(t.diagnostics,n.value?ym.open:null,t.selected):n.is(T9)&&(t=new Nc(t.diagnostics,t.panel,n.value));return t},provide:t=>[Qp.from(t,e=>e.panel),Be.decorations.from(t,e=>e.diagnostics)]}),zme=gt.mark({class:"cm-lintRange cm-lintRange-active"});function Ume(t,e,n){let{diagnostics:i}=t.state.field(Mr),r,s=-1,o=-1;i.between(e-(n<0?1:0),e+(n>0?1:0),(l,c,{spec:u})=>{if(e>=l&&e<=c&&(l==c||(e>l||n>0)&&(e<c||n<0)))return r=u.diagnostics,s=l,o=c,!1});let a=t.state.facet(bo).tooltipFilter;return r&&a&&(r=a(r,t.state)),r?{pos:s,end:o,above:t.state.doc.lineAt(s).to<o,create(){return{dom:Vme(t,r)}}}:null}function Vme(t,e){return Ht("ul",{class:"cm-tooltip-lint"},e.map(n=>L9(t,n,!1)))}const Hme=t=>{let e=t.state.field(Mr,!1);(!e||!e.panel)&&t.dispatch({effects:I9(t.state,[JA.of(!0)])});let n=Zp(t,ym.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},g4=t=>{let e=t.state.field(Mr,!1);return!e||!e.panel?!1:(t.dispatch({effects:JA.of(!1)}),!0)},Wme=t=>{let e=t.state.field(Mr,!1);if(!e)return!1;let n=t.state.selection.main,i=e.diagnostics.iter(n.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==n.from&&i.to==n.to)?!1:(t.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},Gme=pi.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(bo);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);let t=Date.now();if(t<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:e}=this.view,{sources:n}=e.facet(bo);n.length&&Xme(n.map(i=>Promise.resolve(i(this.view))),i=>{this.view.state.doc==e.doc&&this.view.dispatch(Fme(this.view.state,i.reduce((r,s)=>r.concat(s))))},i=>{Ar(this.view.state,i)})}}update(t){let e=t.state.facet(bo);(t.docChanged||e!=t.startState.facet(bo)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}});function Xme(t,e,n){let i=[],r=-1;for(let s of t)s.then(o=>{i.push(o),clearTimeout(r),i.length==t.length?e(i):r=setTimeout(()=>e(i),200)},n)}const bo=Re.define({combine(t){return Object.assign({sources:t.map(e=>e.source).filter(e=>e!=null)},Zl(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,n)=>e?n?i=>e(i)||n(i):e:n}))}});function qme(t,e={}){return[bo.of({source:t,config:e}),Gme,D9]}function O9(t){let e=[];if(t)e:for(let{name:n}of t){for(let i=0;i<n.length;i++){let r=n[i];if(/[a-zA-Z]/.test(r)&&!e.some(s=>s.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function L9(t,e,n){var i;let r=n?O9(e.actions):[];return Ht("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Ht("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((s,o)=>{let a=!1,l=f=>{if(f.preventDefault(),a)return;a=!0;let p=wf(t.state.field(Mr).diagnostics,e);p&&s.apply(t,p.from,p.to)},{name:c}=s,u=r[o]?c.indexOf(r[o]):-1,d=u<0?c:[c.slice(0,u),Ht("u",c.slice(u,u+1)),c.slice(u+1)];return Ht("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${c}${u<0?"":` (access key "${r[o]})"`}.`},d)}),e.source&&Ht("div",{class:"cm-diagnosticSource"},e.source))}class Kme extends Ql{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Ht("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class v4{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=L9(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class ym{constructor(e){this.view=e,this.items=[];let n=r=>{if(r.keyCode==27)g4(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=O9(s.actions);for(let a=0;a<o.length;a++)if(o[a].toUpperCase().charCodeAt(0)==r.keyCode){let l=wf(this.view.state.field(Mr).diagnostics,s);l&&s.actions[a].apply(e,l.from,l.to)}}else return;r.preventDefault()},i=r=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(r.target)&&this.moveSelection(s)};this.list=Ht("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:i}),this.dom=Ht("div",{class:"cm-panel-lint"},this.list,Ht("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>g4(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(Mr).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(Mr),i=0,r=!1,s=null,o=new Set;for(e.between(0,this.view.state.doc.length,(a,l,{spec:c})=>{for(let u of c.diagnostics){if(o.has(u))continue;o.add(u);let d=-1,f;for(let p=i;p<this.items.length;p++)if(this.items[p].diagnostic==u){d=p;break}d<0?(f=new v4(this.view,u),this.items.splice(i,0,f),r=!0):(f=this.items[d],d>i&&(this.items.splice(i,d-i),r=!0)),n&&f.diagnostic==n.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),s=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),i++}});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new v4(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:a,panel:l})=>{let c=l.height/this.list.offsetHeight;a.top<l.top?this.list.scrollTop-=(l.top-a.top)/c:a.bottom>l.bottom&&(this.list.scrollTop+=(a.bottom-l.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function n(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)n();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(Mr),i=wf(n.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:T9.of(i)})}static open(e){return new ym(e)}}function Yme(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function _0(t){return Yme(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const Jme=Be.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:_0("#d11")},".cm-lintRange-warning":{backgroundImage:_0("orange")},".cm-lintRange-info":{backgroundImage:_0("#999")},".cm-lintRange-hint":{backgroundImage:_0("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function Zme(t){return t=="error"?4:t=="warning"?3:t=="info"?2:1}function Qme(t){let e="hint",n=1;for(let i of t){let r=Zme(i.severity);r>n&&(n=r,e=i.severity)}return e}const D9=[Mr,Be.decorations.compute([Mr],t=>{let{selected:e,panel:n}=t.field(Mr);return!e||!n||e.from==e.to?gt.none:gt.set([zme.range(e.from,e.to)])}),une(Ume,{hideOn:$me}),Jme],j9=t=>e=>{const n=t==="down";let i=e.state.selection;for(const r of i.ranges)i=i.addRange(e.moveVertically(r,n));return e.dispatch({selection:i}),!0},ege=j9("up"),tge=j9("down"),nge=t=>{let e=null;for(const n of t.state.selection.ranges)if(!n.empty)for(let i=n.from;i<=n.to;){const r=t.state.doc.lineAt(i),s=Math.min(r.to,n.to);e?e=e.addRange(ue.range(s,s)):e=ue.single(s),i=r.to+1}return e?(t.dispatch({selection:e}),!0):!1},ige=[{key:"Ctrl-Space",run:Ime},{key:"Escape",run:Tme},{key:"ArrowDown",run:C0(!0)},{key:"ArrowUp",run:C0(!1)},{key:"PageDown",run:C0(!0,"page")},{key:"PageUp",run:C0(!1,"page")},{key:"Enter",run:p4},{key:"Tab",run:p4},{key:"Mod-f",run:S9,scope:"editor search-panel"},{key:"Escape",run:k9,scope:"editor search-panel"},{key:"Alt-Enter",run:y9,scope:"editor search-panel"},{key:"Mod-Alt-Enter",run:b9,scope:"editor search-panel"},{key:"Ctrl-g",run:Ype},{key:"Mod-d",run:eme,preventDefault:!0},{key:"Shift-Mod-l",run:lme},{key:"Enter",run:t4,shift:t4},{key:"ArrowLeft",run:O3,shift:F3,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Epe,shift:Ipe},{key:"ArrowRight",run:L3,shift:z3,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Ape,shift:Tpe},{key:"ArrowUp",run:D3,shift:U3,preventDefault:!0},{key:"ArrowDown",run:j3,shift:V3,preventDefault:!0},{key:"Home",run:$3,shift:X3},{mac:"Cmd-ArrowLeft",run:$3,shift:X3},{key:"Mod-Home",run:q3,shift:Y3},{mac:"Cmd-ArrowUp",run:q3,shift:Y3},{key:"PageUp",run:Ow,shift:H3},{mac:"Ctrl-ArrowUp",run:Ow,shift:H3},{key:"PageDown",run:Lw,shift:W3},{mac:"Ctrl-ArrowDown",run:Lw,shift:W3},{key:"End",run:B3,shift:G3},{mac:"Cmd-ArrowRight",run:B3,shift:G3},{key:"Mod-Alt-ArrowUp",linux:"Shift-Alt-ArrowUp",run:ege,preventDefault:!0},{key:"Mod-Alt-ArrowDown",linux:"Shift-Alt-ArrowDown",run:tge,preventDefault:!0},{key:"Shift-Alt-i",run:nge},{key:"Mod-End",run:K3,shift:J3},{mac:"Cmd-ArrowDown",run:K3,shift:J3},{key:"Mod-a",run:Dpe},{key:"Backspace",run:Dme},{key:"Backspace",run:Dw,shift:Dw},{key:"Delete",run:Z3},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Q3},{key:"Mod-Delete",mac:"Alt-Delete",run:Bpe},{mac:"Mod-Backspace",run:$pe},{mac:"Mod-Delete",run:e4},{mac:"Ctrl-b",run:O3,shift:F3,preventDefault:!0},{mac:"Ctrl-f",run:L3,shift:z3},{mac:"Ctrl-p",run:D3,shift:U3},{mac:"Ctrl-n",run:j3,shift:V3},{mac:"Ctrl-a",run:Ppe,shift:Ope},{mac:"Ctrl-e",run:Npe,shift:Lpe},{mac:"Ctrl-d",run:Z3},{mac:"Ctrl-h",run:Dw},{mac:"Ctrl-k",run:e4},{mac:"Ctrl-Alt-h",run:Q3},{mac:"Ctrl-o",run:Fpe},{mac:"Ctrl-t",run:zpe},{mac:"Ctrl-v",run:Lw},{mac:"Alt-v",run:Ow},{key:"Shift-Mod-k",run:Gpe},{key:"Alt-ArrowDown",run:Vpe},{key:"Alt-ArrowUp",run:Upe},{win:"Shift-Alt-ArrowDown",mac:"Shift-Alt-ArrowDown",run:Wpe},{win:"Shift-Alt-ArrowUp",mac:"Shift-Alt-ArrowUp",run:Hpe},{key:"Mod-l",run:jpe,preventDefault:!0},{key:"Shift-Mod-\\",run:Rpe},{key:"Tab",run:yC,shift:n4,preventDefault:!0},{key:"Mod-[",run:n4},{key:"Mod-]",run:yC},{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Bhe},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:$he},{key:"Mod-k Mod-0",run:Fhe},{key:"Mod-k Mod-j",run:zhe},{key:"Mod-k Mod-c",run:upe},{key:"Mod-k Mod-u",run:dpe},{key:"Mod-/",run:lpe},{key:"Shift-Alt-a",run:fpe},{key:"Mod-z",run:Yz,preventDefault:!0},{key:"Mod-y",run:vC,preventDefault:!0},{key:"Mod-Shift-z",run:vC,preventDefault:!0},{key:"Mod-u",run:bpe,preventDefault:!0},{key:"Mod-Shift-m",run:Hme},{key:"F8",run:Wme}];var rge=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Ou=new WeakMap,E0=new WeakMap,A0={},zw=0,B9=function(t){return t&&(t.host||B9(t.parentNode))},sge=function(t,e){return e.map(function(n){if(t.contains(n))return n;var i=B9(n);return i&&t.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},oge=function(t,e,n,i){var r=sge(e,Array.isArray(t)?t:[t]);A0[n]||(A0[n]=new WeakMap);var s=A0[n],o=[],a=new Set,l=new Set(r),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};r.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(a.has(f))u(f);else try{var p=f.getAttribute(i),m=p!==null&&p!=="false",g=(Ou.get(f)||0)+1,y=(s.get(f)||0)+1;Ou.set(f,g),s.set(f,y),o.push(f),g===1&&m&&E0.set(f,!0),y===1&&f.setAttribute(n,"true"),m||f.setAttribute(i,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return u(e),a.clear(),zw++,function(){o.forEach(function(d){var f=Ou.get(d)-1,p=s.get(d)-1;Ou.set(d,f),s.set(d,p),f||(E0.has(d)||d.removeAttribute(i),E0.delete(d)),p||d.removeAttribute(n)}),zw--,zw||(Ou=new WeakMap,Ou=new WeakMap,E0=new WeakMap,A0={})}},age=function(t,e,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(t)?t:[t]),r=rge(t);return r?(i.push.apply(i,Array.from(r.querySelectorAll("[aria-live], script"))),oge(i,r,n,"aria-hidden")):function(){return null}},wC=["Enter"," "],lge=["ArrowDown","PageUp","Home"],$9=["ArrowUp","PageDown","End"],cge=[...lge,...$9],uge={ltr:[...wC,"ArrowRight"],rtl:[...wC,"ArrowLeft"]},dge={ltr:["ArrowLeft"],rtl:["ArrowRight"]},R1="Menu",[bm,fge,hge]=Em(R1),[gu,F9]=zs(R1,[hge,If,Nb]),ZA=If(),z9=Nb(),[Dve,vu]=gu(R1),[jve,Jm]=gu(R1),pge="MenuAnchor",QA=x.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t,r=ZA(n);return h.jsx(h1,{...r,...i,ref:e})});QA.displayName=pge;var eP="MenuPortal",[mge,U9]=gu(eP,{forceMount:void 0}),V9=t=>{const{__scopeMenu:e,forceMount:n,children:i,container:r}=t,s=vu(eP,e);return h.jsx(mge,{scope:e,forceMount:n,children:h.jsx(wa,{present:n||s.open,children:h.jsx(Vm,{asChild:!0,container:r,children:i})})})};V9.displayName=eP;var cs="MenuContent",[gge,tP]=gu(cs),H9=x.forwardRef((t,e)=>{const n=U9(cs,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,s=vu(cs,t.__scopeMenu),o=Jm(cs,t.__scopeMenu);return h.jsx(bm.Provider,{scope:t.__scopeMenu,children:h.jsx(wa,{present:i||s.open,children:h.jsx(bm.Slot,{scope:t.__scopeMenu,children:o.modal?h.jsx(vge,{...r,ref:e}):h.jsx(yge,{...r,ref:e})})})})}),vge=x.forwardRef((t,e)=>{const n=vu(cs,t.__scopeMenu),i=x.useRef(null),r=St(e,i);return x.useEffect(()=>{const s=i.current;if(s)return age(s)},[]),h.jsx(nP,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ke(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),yge=x.forwardRef((t,e)=>{const n=vu(cs,t.__scopeMenu);return h.jsx(nP,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),bge=Jd("MenuContent.ScrollLock"),nP=x.forwardRef((t,e)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,disableOutsideScroll:m,...g}=t,y=vu(cs,n),v=Jm(cs,n),b=ZA(n),w=z9(n),k=fge(n),[C,E]=x.useState(null),_=x.useRef(null),M=St(e,_,y.onContentChange),R=x.useRef(0),T=x.useRef(""),L=x.useRef(0),I=x.useRef(null),G=x.useRef("right"),B=x.useRef(0),q=m?m1:x.Fragment,Y=m?{as:bge,allowPinchZoom:!0}:void 0,ne=U=>{var S,O;const se=T.current+U,Ce=k().filter(j=>!j.disabled),Q=document.activeElement,ae=(S=Ce.find(j=>j.ref.current===Q))==null?void 0:S.textValue,z=Ce.map(j=>j.textValue),$=Rge(z,se,ae),W=(O=Ce.find(j=>j.textValue===$))==null?void 0:O.ref.current;(function j(D){T.current=D,window.clearTimeout(R.current),D!==""&&(R.current=window.setTimeout(()=>j(""),1e3))})(se),W&&setTimeout(()=>W.focus())};x.useEffect(()=>()=>window.clearTimeout(R.current),[]),cA();const V=x.useCallback(U=>{var Ce,Q;return G.current===((Ce=I.current)==null?void 0:Ce.side)&&Tge(U,(Q=I.current)==null?void 0:Q.area)},[]);return h.jsx(gge,{scope:n,searchRef:T,onItemEnter:x.useCallback(U=>{V(U)&&U.preventDefault()},[V]),onItemLeave:x.useCallback(U=>{var se;V(U)||((se=_.current)==null||se.focus(),E(null))},[V]),onTriggerLeave:x.useCallback(U=>{V(U)&&U.preventDefault()},[V]),pointerGraceTimerRef:L,onPointerGraceIntentChange:x.useCallback(U=>{I.current=U},[]),children:h.jsx(q,{...Y,children:h.jsx(c1,{asChild:!0,trapped:r,onMountAutoFocus:ke(s,U=>{var se;U.preventDefault(),(se=_.current)==null||se.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:h.jsx(zm,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,children:h.jsx(dD,{asChild:!0,...w,dir:v.dir,orientation:"vertical",loop:i,currentTabStopId:C,onCurrentTabStopIdChange:E,onEntryFocus:ke(l,U=>{v.isUsingKeyboardRef.current||U.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(xA,{role:"menu","aria-orientation":"vertical","data-state":oU(y.open),"data-radix-menu-content":"",dir:v.dir,...b,...g,ref:M,style:{outline:"none",...g.style},onKeyDown:ke(g.onKeyDown,U=>{const Ce=U.target.closest("[data-radix-menu-content]")===U.currentTarget,Q=U.ctrlKey||U.altKey||U.metaKey,ae=U.key.length===1;Ce&&(U.key==="Tab"&&U.preventDefault(),!Q&&ae&&ne(U.key));const z=_.current;if(U.target!==z||!cge.includes(U.key))return;U.preventDefault();const W=k().filter(S=>!S.disabled).map(S=>S.ref.current);$9.includes(U.key)&&W.reverse(),Nge(W)}),onBlur:ke(t.onBlur,U=>{U.currentTarget.contains(U.target)||(window.clearTimeout(R.current),T.current="")}),onPointerMove:ke(t.onPointerMove,xm(U=>{const se=U.target,Ce=B.current!==U.clientX;if(U.currentTarget.contains(se)&&Ce){const Q=U.clientX>B.current?"right":"left";G.current=Q,B.current=U.clientX}}))})})})})})})});H9.displayName=cs;var xge="MenuGroup",iP=x.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return h.jsx(it.div,{role:"group",...i,ref:e})});iP.displayName=xge;var wge="MenuLabel",W9=x.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return h.jsx(it.div,{...i,ref:e})});W9.displayName=wge;var Zy="MenuItem",y4="menu.itemSelect",I1=x.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:i,...r}=t,s=x.useRef(null),o=Jm(Zy,t.__scopeMenu),a=tP(Zy,t.__scopeMenu),l=St(e,s),c=x.useRef(!1),u=()=>{const d=s.current;if(!n&&d){const f=new CustomEvent(y4,{bubbles:!0,cancelable:!0});d.addEventListener(y4,p=>i==null?void 0:i(p),{once:!0}),O_(d,f),f.defaultPrevented?c.current=!1:o.onClose()}};return h.jsx(G9,{...r,ref:l,disabled:n,onClick:ke(t.onClick,u),onPointerDown:d=>{var f;(f=t.onPointerDown)==null||f.call(t,d),c.current=!0},onPointerUp:ke(t.onPointerUp,d=>{var f;c.current||(f=d.currentTarget)==null||f.click()}),onKeyDown:ke(t.onKeyDown,d=>{const f=a.searchRef.current!=="";n||f&&d.key===" "||wC.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});I1.displayName=Zy;var G9=x.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:i=!1,textValue:r,...s}=t,o=tP(Zy,n),a=z9(n),l=x.useRef(null),c=St(e,l),[u,d]=x.useState(!1),[f,p]=x.useState("");return x.useEffect(()=>{const m=l.current;m&&p((m.textContent??"").trim())},[s.children]),h.jsx(bm.ItemSlot,{scope:n,disabled:i,textValue:r??f,children:h.jsx(fD,{asChild:!0,...a,focusable:!i,children:h.jsx(it.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...s,ref:c,onPointerMove:ke(t.onPointerMove,xm(m=>{i?o.onItemLeave(m):(o.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ke(t.onPointerLeave,xm(m=>o.onItemLeave(m))),onFocus:ke(t.onFocus,()=>d(!0)),onBlur:ke(t.onBlur,()=>d(!1))})})})}),Sge="MenuCheckboxItem",X9=x.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:i,...r}=t;return h.jsx(Z9,{scope:t.__scopeMenu,checked:n,children:h.jsx(I1,{role:"menuitemcheckbox","aria-checked":Qy(n)?"mixed":n,...r,ref:e,"data-state":sP(n),onSelect:ke(r.onSelect,()=>i==null?void 0:i(Qy(n)?!0:!n),{checkForDefaultPrevented:!1})})})});X9.displayName=Sge;var q9="MenuRadioGroup",[kge,Cge]=gu(q9,{value:void 0,onValueChange:()=>{}}),K9=x.forwardRef((t,e)=>{const{value:n,onValueChange:i,...r}=t,s=Or(i);return h.jsx(kge,{scope:t.__scopeMenu,value:n,onValueChange:s,children:h.jsx(iP,{...r,ref:e})})});K9.displayName=q9;var Y9="MenuRadioItem",J9=x.forwardRef((t,e)=>{const{value:n,...i}=t,r=Cge(Y9,t.__scopeMenu),s=n===r.value;return h.jsx(Z9,{scope:t.__scopeMenu,checked:s,children:h.jsx(I1,{role:"menuitemradio","aria-checked":s,...i,ref:e,"data-state":sP(s),onSelect:ke(i.onSelect,()=>{var o;return(o=r.onValueChange)==null?void 0:o.call(r,n)},{checkForDefaultPrevented:!1})})})});J9.displayName=Y9;var rP="MenuItemIndicator",[Z9,_ge]=gu(rP,{checked:!1}),Q9=x.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:i,...r}=t,s=_ge(rP,n);return h.jsx(wa,{present:i||Qy(s.checked)||s.checked===!0,children:h.jsx(it.span,{...r,ref:e,"data-state":sP(s.checked)})})});Q9.displayName=rP;var Ege="MenuSeparator",eU=x.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return h.jsx(it.div,{role:"separator","aria-orientation":"horizontal",...i,ref:e})});eU.displayName=Ege;var Age="MenuArrow",tU=x.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t,r=ZA(n);return h.jsx(wA,{...r,...i,ref:e})});tU.displayName=Age;var Pge="MenuSub",[Bve,nU]=gu(Pge),Dh="MenuSubTrigger",iU=x.forwardRef((t,e)=>{const n=vu(Dh,t.__scopeMenu),i=Jm(Dh,t.__scopeMenu),r=nU(Dh,t.__scopeMenu),s=tP(Dh,t.__scopeMenu),o=x.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=s,c={__scopeMenu:t.__scopeMenu},u=x.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return x.useEffect(()=>u,[u]),x.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),h.jsx(QA,{asChild:!0,...c,children:h.jsx(G9,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":oU(n.open),...t,ref:Ab(e,r.onTriggerChange),onClick:d=>{var f;(f=t.onClick)==null||f.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ke(t.onPointerMove,xm(d=>{s.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(s.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ke(t.onPointerLeave,xm(d=>{var p,m;u();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const g=(m=n.content)==null?void 0:m.dataset.side,y=g==="right",v=y?-5:5,b=f[y?"left":"right"],w=f[y?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+v,y:d.clientY},{x:b,y:f.top},{x:w,y:f.top},{x:w,y:f.bottom},{x:b,y:f.bottom}],side:g}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:ke(t.onKeyDown,d=>{var p;const f=s.searchRef.current!=="";t.disabled||f&&d.key===" "||uge[i.dir].includes(d.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),d.preventDefault())})})})});iU.displayName=Dh;var rU="MenuSubContent",sU=x.forwardRef((t,e)=>{const n=U9(cs,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,s=vu(cs,t.__scopeMenu),o=Jm(cs,t.__scopeMenu),a=nU(rU,t.__scopeMenu),l=x.useRef(null),c=St(e,l);return h.jsx(bm.Provider,{scope:t.__scopeMenu,children:h.jsx(wa,{present:i||s.open,children:h.jsx(bm.Slot,{scope:t.__scopeMenu,children:h.jsx(nP,{id:a.contentId,"aria-labelledby":a.triggerId,...r,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;o.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ke(t.onFocusOutside,u=>{u.target!==a.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:ke(t.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:ke(t.onKeyDown,u=>{var p;const d=u.currentTarget.contains(u.target),f=dge[o.dir].includes(u.key);d&&f&&(s.onOpenChange(!1),(p=a.trigger)==null||p.focus(),u.preventDefault())})})})})})});sU.displayName=rU;function oU(t){return t?"open":"closed"}function Qy(t){return t==="indeterminate"}function sP(t){return Qy(t)?"indeterminate":t?"checked":"unchecked"}function Nge(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function Mge(t,e){return t.map((n,i)=>t[(e+i)%t.length])}function Rge(t,e,n){const r=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=Mge(t,Math.max(s,0));r.length===1&&(o=o.filter(c=>c!==n));const l=o.find(c=>c.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function Ige(t,e){const{x:n,y:i}=t;let r=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s],l=e[o],c=a.x,u=a.y,d=l.x,f=l.y;u>i!=f>i&&n<(d-c)*(i-u)/(f-u)+c&&(r=!r)}return r}function Tge(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return Ige(n,e)}function xm(t){return e=>e.pointerType==="mouse"?t(e):void 0}var Oge=QA,Lge=V9,Dge=H9,jge=iP,Bge=W9,$ge=I1,Fge=X9,zge=K9,Uge=J9,Vge=Q9,Hge=eU,Wge=tU,Gge=iU,Xge=sU,aU="DropdownMenu",[qge,$ve]=zs(aU,[F9]),hr=F9(),[Fve,lU]=qge(aU),cU="DropdownMenuTrigger",Kge=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...r}=t,s=lU(cU,n),o=hr(n);return h.jsx(Oge,{asChild:!0,...o,children:h.jsx(it.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...r,ref:Ab(e,s.triggerRef),onPointerDown:ke(t.onPointerDown,a=>{!i&&a.button===0&&a.ctrlKey===!1&&(s.onOpenToggle(),s.open||a.preventDefault())}),onKeyDown:ke(t.onKeyDown,a=>{i||(["Enter"," "].includes(a.key)&&s.onOpenToggle(),a.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});Kge.displayName=cU;var Yge="DropdownMenuPortal",uU=t=>{const{__scopeDropdownMenu:e,...n}=t,i=hr(e);return h.jsx(Lge,{...i,...n})};uU.displayName=Yge;var dU="DropdownMenuContent",fU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=lU(dU,n),s=hr(n),o=x.useRef(!1);return h.jsx(Dge,{id:r.contentId,"aria-labelledby":r.triggerId,...s,...i,ref:e,onCloseAutoFocus:ke(t.onCloseAutoFocus,a=>{var l;o.current||(l=r.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:ke(t.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!r.modal||u)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});fU.displayName=dU;var Jge="DropdownMenuGroup",Zge=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=hr(n);return h.jsx(jge,{...r,...i,ref:e})});Zge.displayName=Jge;var Qge="DropdownMenuLabel",hU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=hr(n);return h.jsx(Bge,{...r,...i,ref:e})});hU.displayName=Qge;var e0e="DropdownMenuItem",pU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=hr(n);return h.jsx($ge,{...r,...i,ref:e})});pU.displayName=e0e;var t0e="DropdownMenuCheckboxItem",mU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=hr(n);return h.jsx(Fge,{...r,...i,ref:e})});mU.displayName=t0e;var n0e="DropdownMenuRadioGroup",i0e=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=hr(n);return h.jsx(zge,{...r,...i,ref:e})});i0e.displayName=n0e;var r0e="DropdownMenuRadioItem",gU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=hr(n);return h.jsx(Uge,{...r,...i,ref:e})});gU.displayName=r0e;var s0e="DropdownMenuItemIndicator",vU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=hr(n);return h.jsx(Vge,{...r,...i,ref:e})});vU.displayName=s0e;var o0e="DropdownMenuSeparator",yU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=hr(n);return h.jsx(Hge,{...r,...i,ref:e})});yU.displayName=o0e;var a0e="DropdownMenuArrow",l0e=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=hr(n);return h.jsx(Wge,{...r,...i,ref:e})});l0e.displayName=a0e;var c0e="DropdownMenuSubTrigger",bU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=hr(n);return h.jsx(Gge,{...r,...i,ref:e})});bU.displayName=c0e;var u0e="DropdownMenuSubContent",xU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=hr(n);return h.jsx(Xge,{...r,...i,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});xU.displayName=u0e;var d0e=uU,wU=fU,SU=hU,kU=pU,CU=mU,_U=gU,EU=vU,AU=yU,PU=bU,NU=xU;const f0e=x.forwardRef(({className:t,inset:e,children:n,...i},r)=>h.jsxs(PU,{ref:r,className:re("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-mantis-500 data-[state=open]:bg-mantis-500",e&&"pl-8",t),...i,children:[n,h.jsx("span",{className:"icon-[lucide--chevron-right] ml-auto block size-4"})]}));f0e.displayName=PU.displayName;const h0e=x.forwardRef(({className:t,...e},n)=>h.jsx(NU,{ref:n,className:re("z-50 min-w-32 overflow-hidden rounded-md border bg-stone-900 p-1 text-white shadow-lg transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...e}));h0e.displayName=NU.displayName;const p0e=x.forwardRef(({className:t,sideOffset:e=4,...n},i)=>h.jsx(d0e,{children:h.jsx(wU,{ref:i,sideOffset:e,className:re("z-50 min-w-32 overflow-hidden rounded-md border border-stone-600 bg-stone-900 p-1 text-white shadow-md transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...n})}));p0e.displayName=wU.displayName;const m0e=x.forwardRef(({className:t,inset:e,...n},i)=>h.jsx(kU,{ref:i,className:re("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",t),...n}));m0e.displayName=kU.displayName;const g0e=x.forwardRef(({className:t,children:e,checked:n,...i},r)=>h.jsxs(CU,{ref:r,className:re("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...i,children:[h.jsx("span",{className:"absolute left-2 flex size-3.5 items-center justify-center",children:h.jsx(EU,{children:h.jsx("span",{className:"icon-[lucide--check] size-4"})})}),e]}));g0e.displayName=CU.displayName;const v0e=x.forwardRef(({className:t,children:e,...n},i)=>h.jsxs(_U,{ref:i,className:re("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[h.jsx("span",{className:"absolute left-2 flex size-3.5 items-center justify-center",children:h.jsx(EU,{children:h.jsx("span",{className:"icon-[lucide--circle-dot] block size-4"})})}),e]}));v0e.displayName=_U.displayName;const y0e=x.forwardRef(({className:t,inset:e,...n},i)=>h.jsx(SU,{ref:i,className:re("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));y0e.displayName=SU.displayName;const b0e=x.forwardRef(({className:t,...e},n)=>h.jsx(AU,{ref:n,className:re("-mx-1 my-1 h-px bg-stone-600",t),...e}));b0e.displayName=AU.displayName;const oP=Vj("vonsim-program",of(Ge().language,"editor.example"),void 0,{getOnInit:!0}),MU=()=>{const t=A.get(oP);return typeof t=="string"?t:""},x0e=pi.fromClass(class{constructor(t){this.view=t}update(t){t.docChanged&&(A.set(oP,this.view.state.doc.toString()),A.set(em,!0))}}),b4=me(null);me(t=>t(b4),(t,e,n)=>{e(b4,n)});const w0e=me("");me(t=>t(w0e)!==t(oP));const S0e=[{nombre:"Sumador simple",filename:"sumador.asm",contenido:`; Ejemplo: Sumador simple z = x + y
x DB 3
y DB 2
z DB 0
MOV AL, x
ADD AL, y
MOV z, AL
HLT`},{nombre:"Sumar Si Iguales",filename:"sumarsiiguales.asm",contenido:`; Ejemplo: Sumar Si Iguales x = y
x DB 1
y DB 2
z DB 0
         MOV AL, x
         SUB AL, y
         JZ EsIgual
         JMP Fin
EsIgual: MOV DL, x
         ADD y, DL
Fin:     HLT`},{nombre:"Sumar Si Menor",filename:"sumarsimenor.asm",contenido:`; Ejemplo: Sumar Si Menor
x DB 2
y DB 3
z DB 0
          MOV AL, x
          CMP AL, y
          JC EsMenor
          JMP Fin
EsMenor:  ADD AL, y
          MOV z, AL
Fin:      HLT`},{nombre:"Bucle con Condición",filename:"bucle_condicion.asm",contenido:`; Ejemplo: Bucle que suma números del 1 al 9
x     db 1
suma  DB 0
Condicion:  CMP x, 10
            JC Bucle
            JMP FinBucle
Bucle:      MOV BL, x
            ADD suma, BL
            ADD x, 1
            JMP Condicion
FinBucle:   hlt`},{nombre:"Máximo en Vector",filename:"maximo_vector.asm",contenido:`; Ejemplo: Encontrar el máximo en un vector
max     DB 0
vector  DB 5, 2, 10, 4, 5, 0, 4, 8, 1, 9
            MOV CL, 0
            MOV BL, OFFSET vector
Condicion:  CMP CL, 10
            JC Bucle
            JMP FinBucle
Bucle:      MOV AL, [BL]
            CMP AL, max
            JC Proximo
            MOV max, AL
Proximo:    ADD BL, 1
            ADD CL, 1
            JMP Condicion
FinBucle:   HLT`},{nombre:"Hola Mundo",filename:"holamundo.asm",contenido:`; Ejemplo: Hola Mundo
cadena DB "Hola!"
MOV BL, OFFSET cadena
MOV AL, 5
INT 7
HLT`},{nombre:"Ingresar Carácter",filename:"ingresar_caracter.asm",contenido:`; Ejemplo: Ingresar un carácter por teclado
car DB 0
MOV BL, OFFSET car
INT 6
HLT`},{nombre:"Control de LEDs",filename:"control_leds.asm",contenido:`; Enciende las luces (una sí, una no): 1010 1010b
; 31h = PB --> puerto de datos para las luces (LEDs)
; 33h = CB --> puerto de control para las luces

; Configura todos los bits de PB como salida para controlar las luces
MOV AL, 0                ; 0000 0000b: todos los bits de PB en modo salida
OUT 33h, AL              ; Escribe en CB para configurar PB como salida

; Enciende las luces alternadas: 1010 1010b (170 decimal)
MOV AL, 170              ; 1010 1010b: enciende LEDs pares, apaga impares
OUT 31h, AL              ; Escribe el valor en PB para actualizar las luces

HLT`},{nombre:"Leer Contraseña",filename:"leer_contrasena.asm",contenido:`; Leer el valor de interruptores como una contraseña hasta que el usuario la adivine
clave DB 15               ; Contraseña esperada: 00001111 (en decimal 15)
mensaje_ok DB "Bienvenido!" ; Mensaje a mostrar si la contraseña es correcta

; Configurar PA (Puerto A) como entrada
MOV AL, 15                ; 00001111b: configura los primeros 4 bits de PA como entrada
OUT 32h, AL               ; Escribe en CA para configurar PA

bucle:
    IN AL, 30h            ; Lee el valor actual de las llaves desde PA
    CMP AL, clave         ; Compara el valor leído con la contraseña
    JZ Mostrar_Mensaje    ; Si coincide, salta a Mostrar_Mensaje
    JMP bucle             ; Si no coincide, vuelve a intentar

Mostrar_Mensaje:
    MOV BL, OFFSET mensaje_ok ; BL apunta al mensaje de éxito
    MOV AL, 11                ; Longitud del mensaje (Bienvenido! tiene 11 caracteres)
    INT 7
    HLT`},{nombre:"Impresora con sondeo",filename:"impresora_sondeo.asm",contenido:`; Imprime el string "Hola" en la impresora usando sondeo

dato DB "Hola", 0         ; String a imprimir, terminado en 0 (carácter nulo)

HS_DATA   EQU 40h         ; Dirección del registro de datos del Handshake
HS_STATUS EQU 41h         ; Dirección del registro de estado del Handshake

; --- Deshabilita las interrupciones del Handshake (bit 7 en 0) ---
IN  AL, HS_STATUS
AND AL, 01111111b         ; Fuerza el bit 7 a 0 (sin interrupciones)
OUT HS_STATUS, AL

; --- Inicializa el puntero al string ---
MOV BL, OFFSET dato       ; BL apunta al primer carácter del string

; --- Bucle principal: espera espacio en el buffer e imprime ---
Sondeo:
    IN  AL, HS_STATUS
    AND AL, 00000001b     ; Lee el flag busy (bit 0): 1=lleno, 0=libre
    JZ  ImprimirCadena   ; Si busy=0, hay espacio y puede imprimir
    JMP Sondeo            ; Si busy=1, espera hasta que haya espacio

ImprimirCadena:
    MOV AL, [BL]          ; Carga el siguiente carácter del string
    CMP AL, 0             ; ¿Es el final del string? (carácter nulo)
    JZ fin                ; Si sí, termina el programa

    OUT HS_DATA, AL       ; Envía el carácter al registro de datos del Handshake

    INC BL                ; Avanza al siguiente carácter del string
    JMP Sondeo            ; Repite el proceso para el próximo carácter

fin:
    HLT                   ; Detiene la ejecución`},{nombre:"Impresora por interrupción",filename:"impresora_interrupcion.asm",contenido:`; ===============================================================================
; PROGRAMA: Impresión de string usando Handshake con interrupciones
; DESCRIPCIÓN: Imprime el string "hola" en la impresora utilizando el módulo
;              Handshake con interrupciones por hardware (INT2)
; ===============================================================================

; --- SECCIÓN DE DATOS ---
mensaje     db "Hola", 0    ; String a imprimir, terminado en carácter nulo
restantes   db 4           ; Contador de caracteres restantes por imprimir
puntero     db 0           ; Puntero al siguiente carácter (8 bits)

; --- CONSTANTES DE HANDSHAKE ---
HS_DATA     EQU 40h        ; Registro de datos del Handshake (puerto E/S)
HS_STATUS   EQU 41h        ; Registro de estado del Handshake (puerto E/S)

; --- CONSTANTES DE INTERRUPCIONES ---
ID          EQU 2          ; ID de la interrupción para Handshake (0-7)
IMR         EQU 21h        ; Registro de máscara de interrupciones del PIC
EOI         EQU 20h        ; Puerto para enviar End Of Interrupt al PIC
INT2        EQU 26h        ; Puerto para configurar la línea INT2
; ===============================================================================
; PROGRAMA PRINCIPAL
; ===============================================================================


; --- 1) CONFIGURACIÓN INICIAL ---
cli                        ; Deshabilitar interrupciones globales

; --- 2) CONFIGURACIÓN DEL HANDSHAKE ---
; Habilitar interrupciones del Handshake (bit 7 = 1)
in  al, HS_STATUS         ; Leer estado actual del Handshake
or  al, 10000000b         ; Activar bit 7 (habilitar interrupciones)
out HS_STATUS, al         ; Escribir configuración al Handshake

; --- 3) CONFIGURACIÓN DEL PIC (Controlador de Interrupciones) ---

; 3.1) Configurar máscara de interrupciones - Solo habilitar INT2
mov al, 11111011b         ; Máscara: habilita solo INT2 (bit 2=0), resto deshabilitado
out IMR, al               ; Aplicar máscara al PIC

; 3.2) Asignar ID de interrupción a la línea INT2
mov al, ID                ; Cargar ID de interrupción (2)
out INT2, al              ; Configurar línea INT2 con este ID

; 3.3) Configurar vector de interrupción en memoria
mov bl, ID                ; BL = posición en tabla de vectores (ID=2)
mov [bl], int2_handler    ; Almacenar dirección de rutina en vector[2]

; --- 4) INICIALIZACIÓN DE VARIABLES ---
mov al, offset mensaje    ; AL = dirección del primer carácter del string
mov puntero, al           ; Guardar en variable puntero

; --- 5) ENVIAR PRIMER CARÁCTER PARA INICIAR EL PROCESO ---
; Esperar que la impresora esté lista
esperar_listo:
    in al, HS_STATUS
    and al, 00000001b     ; Verificar bit busy
    jnz esperar_listo     ; Si busy=1, esperar

; Enviar primer carácter
mov bl, puntero           ; Cargar puntero
mov al, [bl]              ; Obtener primer carácter
cmp al, 0                 ; ¿Es string vacío?
jz fin                    ; Si está vacío, terminar

out HS_DATA, al           ; Enviar primer carácter
inc bl                    ; Avanzar puntero
mov puntero, bl           ; Guardar puntero actualizado
dec restantes             ; Decrementar contador

; --- 6) HABILITAR INTERRUPCIONES Y ESPERAR ---
sti                       ; Habilitar interrupciones globales

; --- 7) BUCLE DE ESPERA ---
; El programa principal espera hasta que se impriman todos los caracteres
bucle_espera:
    cmp restantes, 0      ; ¿Quedan caracteres por imprimir?
    jnz bucle_espera      ; Si quedan, seguir esperando

; --- 8) FINALIZACIÓN ---
fin:
hlt                       ; Detener ejecución del programa

; ===============================================================================
; RUTINA DE INTERRUPCIÓN INT2 - HANDSHAKE
; ===============================================================================
; DESCRIPCIÓN: Se ejecuta automáticamente cuando la impresora está lista
;              para recibir un nuevo carácter (busy = 0)
; ENTRADA: Variable puntero = dirección del siguiente carácter a imprimir
; SALIDA: Carácter enviado a la impresora, puntero actualizado
; ===============================================================================
org 80h
int2_handler:
    ; --- PRESERVAR CONTEXTO ---
    push al               ; Guardar registros que se van a modificar
    push bl

    ; --- VERIFICAR SI HAY MÁS CARACTERES ---
    cmp restantes, 0      ; ¿Quedan caracteres por imprimir?
    jz fin_interrupcion   ; Si no quedan, terminar

    ; --- OBTENER SIGUIENTE CARÁCTER ---
    mov bl, puntero       ; BL = puntero al siguiente carácter
    mov al, [bl]          ; AL = carácter apuntado por BL
    cmp al, 0             ; ¿Es el carácter nulo (fin de string)?
    jz fin_interrupcion   ; Si es 0, terminar

    ; --- ENVIAR CARÁCTER A LA IMPRESORA ---
    out HS_DATA, al       ; Escribir carácter al registro de datos del Handshake

    ; --- ACTUALIZAR PUNTEROS Y CONTADORES ---
    inc bl                ; Avanzar al siguiente carácter
    mov puntero, bl       ; Guardar puntero actualizado
    dec restantes         ; Decrementar contador de caracteres restantes

fin_interrupcion:
    ; --- ENVIAR EOI AL PIC ---
    mov al, 20h           ; Señal de fin de interrupción
    out EOI, al           ; Notificar al PIC

    ; --- RESTAURAR CONTEXTO ---
    pop bl                ; Restaurar registros preservados
    pop al

    ; --- RETORNO DE INTERRUPCIÓN ---
    iret                  ; Retorno de interrupción`},{nombre:"Contador F10",filename:"contador_f10.asm",contenido:`; Programa: Contador de pulsaciones de la tecla F10 usando interrupciones

;-----------------------------------------------
; 1) Definiciones y variables
;-----------------------------------------------

cantidad db 0          ; Variable: almacena la cantidad de veces que se presionó F10

ID   EQU 1             ; ID de la interrupción para F10 (puede ser 0-7)
IMR  EQU 21h           ; Dirección del registro IMR (máscara de interrupciones)
EOI  EQU 20h           ; Dirección para enviar End Of Interrupt al PIC
INT0 EQU 24h           ; Dirección para configurar la línea INT0 (F10)

;-----------------------------------------------
; 2) Inicialización del PIC y vector de interrupción
;-----------------------------------------------

; 2.1) Habilitar solo la interrupción de F10 (INT0)
mov al, 11111110b      ; Habilita solo INT0 (bit 0 en 0), el resto deshabilitado
out IMR, al

; 2.2) Configurar el ID de la interrupción para INT0
mov al, ID             ; Cargar el ID elegido para F10
out INT0, al

; 2.3) Asociar el vector de interrupción con la subrutina atenderf10
mov bl, ID             ; BL = ID de la interrupción
mov [bl], atenderf10   ; Vector de interrupción: dirección de la rutina

;-----------------------------------------------
; 3) Bucle principal (espera activa)
;-----------------------------------------------

loop: jmp loop         ; Espera indefinida (el programa queda esperando interrupciones)

hlt                    ; (Opcional) Detiene la CPU si sale del bucle

;-----------------------------------------------
; 4) Rutina de atención de la interrupción F10
;-----------------------------------------------

org 50h                ; Dirección de la subrutina de atención

atenderf10:
    inc cantidad       ; Incrementa el contador cada vez que se presiona F10
    mov al, 20h        ; Código de End Of Interrupt (EOI)
    out EOI, al        ; Notifica al PIC que terminó la atención
    iret               ; Retorna de la interrupción`},{nombre:"Timer con mensaje",filename:"timer_mensaje.asm",contenido:`; Programa: Imprime "Hola" a los 10 segundos de iniciado y luego termina.
; Utiliza la interrupción del TIMER (ID = 5).

mensaje db "hola"        ; Mensaje a imprimir
imprimio db 0            ; Flag para saber si ya imprimió

; Definición de direcciones de registros de dispositivos
CONT equ 10h             ; Registro de conteo del timer
COMP equ 11h             ; Registro de comparación del timer

EOI  equ 20h             ; End Of Interrupt (para PIC)
IMR  equ 21h             ; Interrupt Mask Register (PIC)
INT1 equ 25h             ; Registro de vector de interrupción 1

; --- Habilitar interrupciones del timer ---
; IMR = 1111 1101b (solo habilita interrupciones del timer y teclado)
mov al, 11111101b        ; Habilita interrupciones del timer (bit 1 en 0)
out IMR, al

; --- Configurar vector de interrupción del timer ---
mov al, 5                ; ID de interrupción del timer
out INT1, al             ; Asigna rutina de atención a la posición 5

; --- Instalar rutina de interrupción en el vector ---
mov bl, 5                ; Vector de interrupción 5
mov [bl], imp_msj        ; Apunta a la rutina imp_msj

; --- Configurar timer para 3 segundos ---
mov al, 10                ; Valor de comparación (10 segundos)
out COMP, al

mov al, 0                ; Reinicia el contador del timer
out CONT, al

; --- Esperar a que se imprima el mensaje ---
loopinf: cmp imprimio, 0 ; ¿Ya imprimió?
         jz loopinf      ; Si no, sigue esperando

hlt                      ; Termina el programa

; --- Rutina de interrupción del timer ---
org 50h
imp_msj:
         mov bl, offset mensaje ; Dirección del mensaje
         mov al, 4             ; Servicio de impresión
         int 7                 ; Llama a la interrupción de impresión
         mov imprimio, 1       ; Marca que ya imprimió
         mov al, 20h           ; Señal de fin de interrupción
         out EOI, al           ; Notifica al PIC
         iret                  ; Retorna de la interrupción`}],SC=me(0),x4=me(null),w4=me(t=>t(x4),(t,e,n)=>{e(x4,n)}),RU=me(""),k0e=me(()=>typeof window<"u"&&window.codemirror?window.codemirror.state.doc.toString():MU()||""),C0e=me(t=>t(RU)!==t(k0e)),Uw="showSaveFilePicker"in window;function _0e(){const[t,e]=Oo(),n=rt(SC),i=rt(w4),r=Ip(w4),s=Ip(RU),o=rt(C0e),a=i&&o;x.useEffect(()=>{if(window.codemirror){const f=()=>{};return window.codemirror.dom.addEventListener("input",f),()=>{window.codemirror.dom.removeEventListener("input",f)}}},[]);const l=x.useCallback(async()=>{if(!Uw){bi({title:"editor.files.unsupported",variant:"error"});return}if(!(a&&!confirm("editor.files.unsaved")))try{const[f]=await window.showOpenFilePicker({multiple:!1,excludeAcceptAllOption:!0,types:[{accept:{"text/plain":[".txt",".asm",".vonsim"]}}]});if(await f.requestPermission({mode:"readwrite"})==="granted"){r(f);const g=await(await f.getFile()).text();s(g),window.codemirror.dispatch({changes:{from:0,to:window.codemirror.state.doc.length,insert:g}})}}catch(f){console.error(f),bi({title:"editor.files.open-error",variant:"error"})}},[a,r,s]),c=x.useCallback(f=>{a&&!confirm("editor.files.unsaved")||(r(null),s(f.contenido),window.codemirror.dispatch({changes:{from:0,to:window.codemirror.state.doc.length,insert:f.contenido}}),bi({title:`Ejemplo cargado: ${f.nombre}`,variant:"info"}))},[a,r,s]),u=x.useCallback(async()=>{if(!Uw){bi({title:"editor.files.unsupported",variant:"error"});return}if(!i){bi({title:"No hay archivo abierto para guardar",variant:"error"});return}if(a)try{const f=window.codemirror.state.doc.toString(),p=await i.createWritable({keepExistingData:!1});await p.write(f),await p.close(),s(f),bi({title:"Archivo guardado",variant:"info"})}catch(f){console.error(f),bi({title:"editor.files.save-error",variant:"error"})}},[i,a,s]),d=x.useCallback(async()=>{const f=window.codemirror.state.doc.toString(),p=(i==null?void 0:i.name)||`vonsim-${new Date().toISOString().slice(0,10)}.asm`;if(Uw)try{const m=await window.showSaveFilePicker({suggestedName:p,excludeAcceptAllOption:!0,types:[{accept:{"text/plain":[".txt",".asm",".vonsim"]}}]});if(await m.requestPermission({mode:"readwrite"})==="granted"){r(m);const y=await m.createWritable({keepExistingData:!1});await y.write(f),await y.close(),s(f),bi({title:"Archivo guardado",variant:"info"})}}catch(m){console.error(m),bi({title:"editor.files.save-error",variant:"error"})}else{const m=new Blob([f],{type:"text/plain"}),g=URL.createObjectURL(m),y=document.createElement("a");y.style.display="none",y.href=g,y.download=p,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(g)}},[i,r,s]);return h.jsxs("div",{"data-testid":"status-bar",className:"flex items-center justify-between border-t border-stone-700 bg-gradient-to-r from-stone-800 to-stone-900 px-4 py-0.5 font-sans text-xs text-stone-300 shadow-inner",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[i&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"font-medium text-white transition-colors",children:i.name}),a&&h.jsx("span",{className:"size-2 rounded-full bg-orange-400"})]}),i&&h.jsx("div",{className:"h-4 w-px bg-stone-600"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(Uy,{children:[h.jsx(Vy,{asChild:!0,children:h.jsx(At,{variant:"ghost",size:"sm",className:"hover-lift","aria-label":"editor.files.open",children:h.jsx("span",{className:"icon-[lucide--folder-open] size-4"})})}),h.jsx(hm,{align:"start",className:"w-80 border-stone-600/50 bg-stone-900/95 p-0 backdrop-blur-md",children:h.jsxs("div",{className:"flex flex-col",children:[h.jsxs("div",{className:"border-b border-stone-700/50 bg-gradient-to-r from-stone-800 to-stone-900 px-4 py-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"icon-[lucide--folder-open] size-5 text-mantis-400"}),h.jsx("span",{className:"font-semibold text-white",children:"Abrir Archivo"})]}),h.jsx("p",{className:"mt-1 text-xs text-stone-400",children:"Selecciona un archivo de tu PC o un ejemplo"})]}),h.jsxs("div",{className:"space-y-3 p-3",children:[h.jsx(At,{variant:"default",size:"sm",onClick:l,className:"h-auto w-full justify-start border-0 bg-gradient-to-r from-mantis-600 to-mantis-700 px-4 py-3 text-white shadow-sm transition-all duration-200 hover:from-mantis-500 hover:to-mantis-600",children:h.jsxs("div",{className:"flex w-full items-center gap-3",children:[h.jsx("div",{className:"rounded-lg bg-white/10 p-1.5",children:h.jsx("span",{className:"icon-[lucide--laptop] size-5"})}),h.jsxs("div",{className:"flex-1 text-left",children:[h.jsx("div",{className:"font-medium",children:"Abrir desde mi PC"}),h.jsx("div",{className:"text-xs text-mantis-100/80",children:"Archivos .asm, .txt, .vonsim"})]}),h.jsx("span",{className:"icon-[lucide--arrow-right] size-4 text-mantis-200"})]})}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 flex items-center",children:h.jsx("div",{className:"w-full border-t border-stone-700/60"})}),h.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:h.jsx("span",{className:"bg-stone-900 px-2 font-medium tracking-wider text-stone-500",children:"o selecciona un ejemplo"})})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-2 px-1",children:[h.jsx("span",{className:"icon-[lucide--lightbulb] size-4 text-amber-400"}),h.jsx("span",{className:"text-sm font-medium text-amber-200",children:"Ejemplos de Programas"})]}),h.jsx("div",{className:"custom-scrollbar grid max-h-64 gap-1 overflow-y-auto pr-1",children:S0e.map((f,p)=>h.jsx(At,{variant:"ghost",size:"sm",className:"group h-auto w-full justify-start rounded-lg border border-transparent px-2 py-2.5 text-left transition-all duration-200 hover:border-stone-600/30 hover:bg-stone-800/60",onClick:()=>c(f),children:h.jsxs("div",{className:"flex w-full items-center gap-3",children:[h.jsx("div",{className:"flex size-6 shrink-0 items-center justify-center rounded-full border border-amber-500/30 bg-gradient-to-br from-amber-400/20 to-orange-500/20",children:h.jsx("span",{className:"text-xs font-bold text-amber-300",children:p+1})}),h.jsx("div",{className:"min-w-0 flex-1 text-left",children:h.jsx("div",{className:"text-left font-medium text-stone-200 transition-colors group-hover:text-white",children:f.nombre})}),h.jsx("span",{className:"icon-[lucide--chevron-right] size-4 shrink-0 text-stone-500 transition-colors group-hover:text-amber-400"})]})},f.filename))})]})]}),h.jsx("div",{className:"border-t border-stone-700/50 bg-stone-800/30 px-4 py-2",children:h.jsx("p",{className:"text-center text-xs text-stone-500",children:"Los ejemplos te ayudan a aprender la sintaxis de VonSim"})})]})})]}),h.jsx(ss,{content:"editor.files.save",position:"top",children:h.jsx(At,{variant:"ghost",size:"sm",onClick:u,disabled:!i||!a,className:"hover-lift","aria-label":"editor.files.save",children:h.jsx("span",{className:"icon-[lucide--save] size-4"})})}),h.jsx(ss,{content:"editor.files.save-as",position:"top",children:h.jsx(At,{variant:"ghost",size:"sm",onClick:d,className:"hover-lift","aria-label":"editor.files.save-as",children:h.jsx("span",{className:"icon-[lucide--save-all] size-4"})})})]})]}),h.jsxs("div",{className:"flex items-center gap-6",children:[h.jsxs(Uy,{children:[h.jsx(Vy,{asChild:!0,children:h.jsx("button",{className:"flex items-center justify-center rounded-lg p-1 text-stone-300 hover:bg-stone-800 focus:outline-none focus:ring-2 focus:ring-mantis-500","aria-label":"Ajustar tamaño de fuente del editor",title:"Ajustar tamaño de fuente del editor",type:"button",children:h.jsx("span",{className:"icon-[lucide--pilcrow-square] size-5"})})}),h.jsxs(hm,{align:"end",className:"w-56 p-4",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[h.jsx("span",{className:"icon-[lucide--pilcrow-square] size-5 text-mantis-400"}),h.jsx("span",{className:"text-sm font-medium text-white",children:"Tamaño de fuente del editor"}),h.jsxs("span",{className:"ml-auto text-xs text-stone-400",children:[t.editorFontSize,"px"]})]}),h.jsx(Ua,{value:[t.editorFontSize],min:8,max:64,step:1,onValueChange:([f])=>e(p=>({...p,editorFontSize:f})),className:"w-full"}),h.jsxs("div",{className:"mt-2 flex justify-between text-xs text-stone-500",children:[h.jsx("span",{children:"8"}),h.jsx("span",{children:"64"})]})]})]}),h.jsxs("div",{className:re("flex items-center gap-1.5 rounded-full px-2 py-0.5 font-medium transition-colors",n>0?"border border-red-500/30 bg-red-500/20 text-red-300":"border border-green-500/30 bg-green-500/20 text-green-300"),children:[h.jsx("div",{className:re("size-2 rounded-full",n>0?"bg-red-400":"bg-green-400")}),h.jsx("span",{className:"font-mono",children:n>0?`${n} error${n>1?"es":""}`:"Sin errores"})]})]})]})}const Ki={character:et.character,comment:et.comment,"data-directive":Fn.define(),identifier:et.variableName,instruction:Fn.define(),label:et.labelName,number:et.number,operator:et.operator,offset:Fn.define(),"ptr-size":Fn.define(),punctuation:et.punctuation,register:Fn.define(),special:Fn.define(),string:et.string,unassigned:Fn.define()},E0e=$A.define({name:"vonsim",token:t=>{if(t.eatSpace())return null;if(t.match(/[01]+b\b/i)||t.match(/\d[a-f\d]*h\b/i)||t.match(/\d+\b/))return"number";if(t.match(/'[^'\n]'/))return"character";if(t.eat('"'))return t.eatWhile(/[^"\n]/),t.eat('"'),"string";if(t.eat(/[*+-]/))return"operator";if(t.eat(/[(),[\]]/))return"punctuation";if(t.eat("?"))return"unassigned";if(t.eat(";"))return t.skipToEnd(),"comment";if(t.eat(/[a-z_.]/i)){t.eatWhile(/\w/);const e=t.current().toUpperCase();return e==="ORG"||e==="END"||e===".DATA"||e===".CODE"?"special":e==="OFFSET"?"offset":e==="BYTE"||e==="WORD"||e==="PTR"?"ptr-size":sE.includes(e)?"data-directive":oE.includes(e)?"instruction":dy.includes(e)?"register":t.eat(":")?"label":"identifier"}return t.next(),null},languageData:{commentTokens:{line:";"},closeBrackets:{brackets:["(","[",'"']}},tokenTable:Ki}),A0e=Xhe(E1.define([{tag:Ki.character,class:"text-orange-300"},{tag:Ki.comment,class:"text-stone-500 italic"},{tag:Ki["data-directive"],class:"text-rose-400/80"},{tag:Ki.instruction,class:"text-mantis-400"},{tag:Ki.number,class:"text-cyan-300/60"},{tag:Ki.operator,class:"text-rose-300"},{tag:Ki.offset,class:"text-rose-400/80 italic"},{tag:Ki["ptr-size"],class:"text-rose-400/80 italic"},{tag:Ki.punctuation,class:"text-stone-600"},{tag:Ki.register,class:"text-emerald-400/80"},{tag:Ki.special,class:"text-yellow-300/80"},{tag:Ki.string,class:"text-orange-300"},{tag:Ki.unassigned,class:"text-rose-400/80"}])),P0e=qme(t=>{const e=t.state.doc.toString(),n=e8(e);if(n.success)return A.set(SC,0),[];const i=n,r=Ge().language,s=i.errors.map(o=>{var c,u;const a=((c=o.position)==null?void 0:c.start)??0,l=((u=o.position)==null?void 0:u.end)??e.length;return{message:o.translate(r),severity:"error",from:a,to:l}});return A.set(SC,s.length),s},{delay:200});function N0e(){return new khe(E0e,[A0e,P0e])}function IU({className:t}){const[e,n]=x.useState(),i=sZ(),r=x.useCallback(s=>{s&&n(s)},[]);return x.useEffect(()=>{if(e)return window.codemirror=new Be({state:kt.create({doc:MU()||"",extensions:[kt.tabSize.of(2),L6.of(kt.readOnly.of(!1)),x0e,wne(),Ene,Cne(),qte(),ype(),$te(),Be.domEventHandlers({drop:s=>s.preventDefault()}),kt.allowMultipleSelections.of(!0),ene(),Be.updateListener.of(s=>{s.selectionSet}),E6.of([{key:"Escape",run:s=>(s.dispatch({selection:ue.create([s.state.selection.main],0)}),!0)},{key:"Tab",run:s=>s.state.selection.ranges.some(o=>!o.empty)?yC(s):(s.dispatch(s.state.update(s.state.replaceSelection(" ".repeat(s.state.tabSize)),{scrollIntoView:!0,userEvent:"input"})),!0)},...ige]),N0e()]}),parent:e}),()=>{var s;return(s=window.codemirror)==null?void 0:s.destroy()}},[e]),h.jsxs("div",{className:re("flex flex-col rounded-lg border border-stone-700 bg-gradient-to-br from-stone-900 to-stone-800 shadow-xl",t),children:[h.jsx("div",{ref:r,className:"grow overflow-auto rounded-t-lg font-mono",style:{fontSize:`${i}px`,lineHeight:1.25}}),h.jsx(_0e,{})]})}const TU=x.memo(()=>{const t=nE(),e=_q("(max-width: 640px)");VF(),HF();const n=x.useMemo(()=>({}),[]);return h.jsxs("div",{"data-testid":"app-container",className:"flex h-screen w-screen flex-col bg-black text-white",lang:t,style:n,children:[h.jsx(WF,{}),h.jsx($F,{"data-testid":"header"}),e?h.jsx(LU,{}):h.jsx(OU,{}),h.jsx(Jj,{"data-testid":"footer"}),h.jsx(qF,{}),h.jsx(UF,{})]})});TU.displayName="App";const OU=x.memo(()=>{const[t]=Pm(w1);return h.jsxs(VD,{autoSaveId:"layout",direction:"horizontal",tagName:"main",className:"overflow-auto px-2",children:[h.jsx(G0,{id:"panel-editor",order:1,minSize:30,defaultSize:50,tagName:"section",className:"rounded-lg border border-stone-600 bg-black","data-testid":"panel-editor",children:h.jsx(IU,{className:"size-full"})}),h.jsx(y2,{className:"w-2"}),h.jsx(G0,{id:"panel-computer",order:2,minSize:20,defaultSize:50,tagName:"section",className:"computer-background rounded-lg border border-stone-600","data-testid":"panel-computer",children:h.jsx(kz,{})}),t&&h.jsxs(h.Fragment,{children:[h.jsx(y2,{className:"w-2"}),h.jsx(G0,{id:"panel-settings",order:3,minSize:30,defaultSize:30,tagName:"section",className:"rounded-lg border border-stone-600 bg-stone-800","data-testid":"panel-settings",children:h.jsx(jF,{className:"size-full"})})]})]})});OU.displayName="DesktopLayout";const LU=x.memo(()=>{const t=un(),[e,n]=x.useState("editor"),[i,r]=Pm(w1),s=rt(Wn),o=x.useMemo(()=>"metadata"in s&&s.metadata?`${s.metadata.name}${s.metadata.operands.length?" "+s.metadata.operands.join(", "):""}`:"",[s]),a=x.useMemo(()=>i?"settings":e,[i,e]),l=x.useCallback(u=>{i&&r(!1),n(u)},[i,r]),c=x.useMemo(()=>{switch(a){case"editor":return"Editor";case"computer":return"Computadora";case"settings":return"Configuración";default:return""}},[a]);return h.jsx(pD,{value:a,onValueChange:l,asChild:!0,children:h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"sticky top-0 z-30 w-full border-b border-stone-700 bg-stone-900 px-4 py-2",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-stone-500",children:"Pestaña:"}),h.jsx("span",{className:"text-sm font-medium text-white",children:c})]}),a==="computer"&&h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-xs text-stone-500",children:"Instrucción actual:"}),h.jsx("div",{className:"font-mono text-sm text-mantis-400",children:o||h.jsx("span",{className:"italic text-stone-400",children:"Sin instrucción"})})]})]})}),h.jsx(W0,{value:"editor",asChild:!0,children:h.jsx("section",{className:"mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-black data-[state=inactive]:hidden","data-testid":"panel-editor",children:h.jsx(IU,{className:"size-full"})})}),h.jsx(W0,{value:"computer",asChild:!0,children:h.jsx("section",{className:"computer-background mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden","data-testid":"panel-computer",children:h.jsx(kz,{})})}),h.jsx(W0,{value:"settings",asChild:!0,children:h.jsx("section",{className:"mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden","data-testid":"panel-settings",children:h.jsx(jF,{className:"size-full"})})}),h.jsx("div",{className:"border-t border-stone-700 bg-stone-900 p-2",children:h.jsxs(gD,{className:"grid grid-cols-3 gap-2",children:[h.jsxs(H0,{value:"editor",className:"inline-flex flex-col items-center justify-center rounded-lg py-2 text-xs font-medium text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-mantis-600 data-[state=active]:text-white",children:[h.jsx("span",{className:"icon-[lucide--file-terminal] mb-1 size-5"}),t("control.tabs.editor")]}),h.jsxs(H0,{value:"computer",className:"inline-flex flex-col items-center justify-center rounded-lg py-2 text-xs font-medium text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-mantis-600 data-[state=active]:text-white",children:[h.jsx("span",{className:"icon-[lucide--computer] mb-1 size-5"}),t("control.tabs.computer")]}),h.jsxs(H0,{value:"settings",className:"inline-flex flex-col items-center justify-center rounded-lg py-2 text-xs font-medium text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-mantis-600 data-[state=active]:text-white",children:[h.jsx("span",{className:"icon-[lucide--settings] mb-1 size-5"}),"Configuración"]})]})})]})})});LU.displayName="MobileLayout";var aP="ToastProvider",[lP,M0e,R0e]=Em("Toast"),[DU,zve]=zs("Toast",[R0e]),[I0e,T1]=DU(aP),jU=t=>{const{__scopeToast:e,label:n="Notification",duration:i=5e3,swipeDirection:r="right",swipeThreshold:s=50,children:o}=t,[a,l]=x.useState(null),[c,u]=x.useState(0),d=x.useRef(!1),f=x.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${aP}\`. Expected non-empty \`string\`.`),h.jsx(lP.Provider,{scope:e,children:h.jsx(I0e,{scope:e,label:n,duration:i,swipeDirection:r,swipeThreshold:s,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:x.useCallback(()=>u(p=>p+1),[]),onToastRemove:x.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:o})})};jU.displayName=aP;var BU="ToastViewport",T0e=["F8"],kC="toast.viewportPause",CC="toast.viewportResume",$U=x.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:i=T0e,label:r="Notifications ({hotkey})",...s}=t,o=T1(BU,n),a=M0e(n),l=x.useRef(null),c=x.useRef(null),u=x.useRef(null),d=x.useRef(null),f=St(e,d,o.onViewportChange),p=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),m=o.toastCount>0;x.useEffect(()=>{const y=v=>{var w;i.length!==0&&i.every(k=>v[k]||v.code===k)&&((w=d.current)==null||w.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[i]),x.useEffect(()=>{const y=l.current,v=d.current;if(m&&y&&v){const b=()=>{if(!o.isClosePausedRef.current){const E=new CustomEvent(kC);v.dispatchEvent(E),o.isClosePausedRef.current=!0}},w=()=>{if(o.isClosePausedRef.current){const E=new CustomEvent(CC);v.dispatchEvent(E),o.isClosePausedRef.current=!1}},k=E=>{!y.contains(E.relatedTarget)&&w()},C=()=>{y.contains(document.activeElement)||w()};return y.addEventListener("focusin",b),y.addEventListener("focusout",k),y.addEventListener("pointermove",b),y.addEventListener("pointerleave",C),window.addEventListener("blur",b),window.addEventListener("focus",w),()=>{y.removeEventListener("focusin",b),y.removeEventListener("focusout",k),y.removeEventListener("pointermove",b),y.removeEventListener("pointerleave",C),window.removeEventListener("blur",b),window.removeEventListener("focus",w)}}},[m,o.isClosePausedRef]);const g=x.useCallback(({tabbingDirection:y})=>{const b=a().map(w=>{const k=w.ref.current,C=[k,...G0e(k)];return y==="forwards"?C:C.reverse()});return(y==="forwards"?b.reverse():b).flat()},[a]);return x.useEffect(()=>{const y=d.current;if(y){const v=b=>{var C,E,_;const w=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!w){const M=document.activeElement,R=b.shiftKey;if(b.target===y&&R){(C=c.current)==null||C.focus();return}const I=g({tabbingDirection:R?"backwards":"forwards"}),G=I.findIndex(B=>B===M);Vw(I.slice(G+1))?b.preventDefault():R?(E=c.current)==null||E.focus():(_=u.current)==null||_.focus()}};return y.addEventListener("keydown",v),()=>y.removeEventListener("keydown",v)}},[a,g]),h.jsxs(oae,{ref:l,role:"region","aria-label":r.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:m?void 0:"none"},children:[m&&h.jsx(_C,{ref:c,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});Vw(y)}}),h.jsx(lP.Slot,{scope:n,children:h.jsx(it.ol,{tabIndex:-1,...s,ref:f})}),m&&h.jsx(_C,{ref:u,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});Vw(y)}})]})});$U.displayName=BU;var FU="ToastFocusProxy",_C=x.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:i,...r}=t,s=T1(FU,n);return h.jsx(kA,{"aria-hidden":!0,tabIndex:0,...r,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=s.viewport)!=null&&c.contains(a))&&i()}})});_C.displayName=FU;var Zm="Toast",O0e="toast.swipeStart",L0e="toast.swipeMove",D0e="toast.swipeCancel",j0e="toast.swipeEnd",zU=x.forwardRef((t,e)=>{const{forceMount:n,open:i,defaultOpen:r,onOpenChange:s,...o}=t,[a,l]=Rl({prop:i,defaultProp:r??!0,onChange:s,caller:Zm});return h.jsx(wa,{present:n||a,children:h.jsx(F0e,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:Or(t.onPause),onResume:Or(t.onResume),onSwipeStart:ke(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ke(t.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:ke(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ke(t.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});zU.displayName=Zm;var[B0e,$0e]=DU(Zm,{onClose(){}}),F0e=x.forwardRef((t,e)=>{const{__scopeToast:n,type:i="foreground",duration:r,open:s,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:p,...m}=t,g=T1(Zm,n),[y,v]=x.useState(null),b=St(e,B=>v(B)),w=x.useRef(null),k=x.useRef(null),C=r||g.duration,E=x.useRef(0),_=x.useRef(C),M=x.useRef(0),{onToastAdd:R,onToastRemove:T}=g,L=Or(()=>{var q;(y==null?void 0:y.contains(document.activeElement))&&((q=g.viewport)==null||q.focus()),o()}),I=x.useCallback(B=>{!B||B===1/0||(window.clearTimeout(M.current),E.current=new Date().getTime(),M.current=window.setTimeout(L,B))},[L]);x.useEffect(()=>{const B=g.viewport;if(B){const q=()=>{I(_.current),c==null||c()},Y=()=>{const ne=new Date().getTime()-E.current;_.current=_.current-ne,window.clearTimeout(M.current),l==null||l()};return B.addEventListener(kC,Y),B.addEventListener(CC,q),()=>{B.removeEventListener(kC,Y),B.removeEventListener(CC,q)}}},[g.viewport,C,l,c,I]),x.useEffect(()=>{s&&!g.isClosePausedRef.current&&I(C)},[s,C,g.isClosePausedRef,I]),x.useEffect(()=>(R(),()=>T()),[R,T]);const G=x.useMemo(()=>y?qU(y):null,[y]);return g.viewport?h.jsxs(h.Fragment,{children:[G&&h.jsx(z0e,{__scopeToast:n,role:"status","aria-live":i==="foreground"?"assertive":"polite","aria-atomic":!0,children:G}),h.jsx(B0e,{scope:n,onClose:L,children:Jl.createPortal(h.jsx(lP.ItemSlot,{scope:n,children:h.jsx(sae,{asChild:!0,onEscapeKeyDown:ke(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||L(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:h.jsx(it.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":g.swipeDirection,...m,ref:b,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:ke(t.onKeyDown,B=>{B.key==="Escape"&&(a==null||a(B.nativeEvent),B.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,L()))}),onPointerDown:ke(t.onPointerDown,B=>{B.button===0&&(w.current={x:B.clientX,y:B.clientY})}),onPointerMove:ke(t.onPointerMove,B=>{if(!w.current)return;const q=B.clientX-w.current.x,Y=B.clientY-w.current.y,ne=!!k.current,V=["left","right"].includes(g.swipeDirection),U=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,se=V?U(0,q):0,Ce=V?0:U(0,Y),Q=B.pointerType==="touch"?10:2,ae={x:se,y:Ce},z={originalEvent:B,delta:ae};ne?(k.current=ae,P0(L0e,d,z,{discrete:!1})):S4(ae,g.swipeDirection,Q)?(k.current=ae,P0(O0e,u,z,{discrete:!1}),B.target.setPointerCapture(B.pointerId)):(Math.abs(q)>Q||Math.abs(Y)>Q)&&(w.current=null)}),onPointerUp:ke(t.onPointerUp,B=>{const q=k.current,Y=B.target;if(Y.hasPointerCapture(B.pointerId)&&Y.releasePointerCapture(B.pointerId),k.current=null,w.current=null,q){const ne=B.currentTarget,V={originalEvent:B,delta:q};S4(q,g.swipeDirection,g.swipeThreshold)?P0(j0e,p,V,{discrete:!0}):P0(D0e,f,V,{discrete:!0}),ne.addEventListener("click",U=>U.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),z0e=t=>{const{__scopeToast:e,children:n,...i}=t,r=T1(Zm,e),[s,o]=x.useState(!1),[a,l]=x.useState(!1);return H0e(()=>o(!0)),x.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:h.jsx(Vm,{asChild:!0,children:h.jsx(kA,{...i,children:s&&h.jsxs(h.Fragment,{children:[r.label," ",n]})})})},U0e="ToastTitle",UU=x.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t;return h.jsx(it.div,{...i,ref:e})});UU.displayName=U0e;var V0e="ToastDescription",VU=x.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t;return h.jsx(it.div,{...i,ref:e})});VU.displayName=V0e;var HU="ToastAction",WU=x.forwardRef((t,e)=>{const{altText:n,...i}=t;return n.trim()?h.jsx(XU,{altText:n,asChild:!0,children:h.jsx(cP,{...i,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${HU}\`. Expected non-empty \`string\`.`),null)});WU.displayName=HU;var GU="ToastClose",cP=x.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t,r=$0e(GU,n);return h.jsx(XU,{asChild:!0,children:h.jsx(it.button,{type:"button",...i,ref:e,onClick:ke(t.onClick,r.onClose)})})});cP.displayName=GU;var XU=x.forwardRef((t,e)=>{const{__scopeToast:n,altText:i,...r}=t;return h.jsx(it.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":i||void 0,...r,ref:e})});function qU(t){const e=[];return Array.from(t.childNodes).forEach(i=>{if(i.nodeType===i.TEXT_NODE&&i.textContent&&e.push(i.textContent),W0e(i)){const r=i.ariaHidden||i.hidden||i.style.display==="none",s=i.dataset.radixToastAnnounceExclude==="";if(!r)if(s){const o=i.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...qU(i))}}),e}function P0(t,e,n,{discrete:i}){const r=n.originalEvent.currentTarget,s=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),i?O_(r,s):r.dispatchEvent(s)}var S4=(t,e,n=0)=>{const i=Math.abs(t.x),r=Math.abs(t.y),s=i>r;return e==="left"||e==="right"?s&&i>n:!s&&r>n};function H0e(t=()=>{}){const e=Or(t);hi(()=>{let n=0,i=0;return n=window.requestAnimationFrame(()=>i=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(i)}},[e])}function W0e(t){return t.nodeType===t.ELEMENT_NODE}function G0e(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Vw(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var X0e=jU,KU=$U,YU=zU,JU=UU,ZU=VU,QU=WU,e7=cP;const q0e=X0e,t7=x.forwardRef(({className:t,...e},n)=>h.jsx(KU,{ref:n,className:re("fixed inset-x-0 top-12 z-[100] mx-auto flex max-h-screen w-full flex-col p-4 md:max-w-[420px]",t),...e}));t7.displayName=KU.displayName;const n7=x.forwardRef(({className:t,variant:e="default",...n},i)=>h.jsx(YU,{ref:i,"data-variant":e,className:re("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md p-6 pr-8 shadow-lg transition-all",e==="default"&&"border border-stone-600 bg-stone-900 text-white",e==="error"&&"border border-red-600 bg-red-900 text-red-50",e==="info"&&"border border-green-500 bg-stone-900 text-white",t),...n}));n7.displayName=YU.displayName;const K0e=x.forwardRef(({className:t,...e},n)=>h.jsx(QU,{ref:n,className:re("inline-flex h-8 shrink-0 items-center justify-center rounded-md bg-mantis-500 px-3 text-sm font-medium ring-offset-stone-900 transition-colors hover:bg-mantis-400 focus:outline-none focus:ring-2 focus:ring-stone-600 focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50","group-data-[variant=error]:border group-data-[variant=error]:border-white/40 group-data-[variant=error]:hover:border-white/30  group-data-[variant=error]:hover:bg-red-700 group-data-[variant=error]:hover:text-white group-data-[variant=error]:focus:ring-white",t),...e}));K0e.displayName=QU.displayName;const i7=x.forwardRef(({className:t,...e},n)=>h.jsx(e7,{ref:n,className:re("text-current/50 absolute right-2 top-2 rounded-md p-1 opacity-0 transition-opacity hover:text-current focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100",t),"toast-close":"",...e,children:h.jsx("span",{className:"block size-4",children:"✕"})}));i7.displayName=e7.displayName;const r7=x.forwardRef(({className:t,...e},n)=>h.jsx(JU,{ref:n,className:re("text-sm font-semibold",t),...e}));r7.displayName=JU.displayName;const s7=x.forwardRef(({className:t,...e},n)=>h.jsx(ZU,{ref:n,className:re("text-sm opacity-90",t),...e}));s7.displayName=ZU.displayName;function Y0e(){const{toastList:t}=Tne();return h.jsxs(q0e,{children:[t.map(({id:e,title:n,description:i,action:r,variant:s,otherProps:o})=>h.jsxs(n7,{...o,variant:s,children:[h.jsxs("div",{className:"grid gap-1",children:[n&&h.jsx(r7,{children:n}),i&&h.jsx(s7,{children:i})]}),r,h.jsx(i7,{})]},e)),h.jsx(t7,{})]})}window.codemirror=null;const J0e=sD(document.getElementById("root"));J0e.render(h.jsx(x.StrictMode,{children:h.jsxs(nW,{client:B6,children:[h.jsx(Hj,{children:h.jsx(TU,{})}),h.jsx(Y0e,{})]})}));
