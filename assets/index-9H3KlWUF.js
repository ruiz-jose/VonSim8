var s7=Object.defineProperty;var oP=t=>{throw TypeError(t)};var o7=(t,e,n)=>e in t?s7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var be=(t,e,n)=>o7(t,typeof e!="symbol"?e+"":e,n),P1=(t,e,n)=>e.has(t)||oP("Cannot "+n);var N=(t,e,n)=>(P1(t,e,"read from private field"),n?n.call(t):e.get(t)),Ue=(t,e,n)=>e.has(t)?oP("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),ie=(t,e,n,i)=>(P1(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),Ut=(t,e,n)=>(P1(t,e,"access private method"),n);function a7(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var l7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var A4={exports:{}},Zy={},P4={exports:{}},xt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bm=Symbol.for("react.element"),c7=Symbol.for("react.portal"),u7=Symbol.for("react.fragment"),d7=Symbol.for("react.strict_mode"),f7=Symbol.for("react.profiler"),h7=Symbol.for("react.provider"),p7=Symbol.for("react.context"),m7=Symbol.for("react.forward_ref"),g7=Symbol.for("react.suspense"),v7=Symbol.for("react.memo"),y7=Symbol.for("react.lazy"),aP=Symbol.iterator;function b7(t){return t===null||typeof t!="object"?null:(t=aP&&t[aP]||t["@@iterator"],typeof t=="function"?t:null)}var N4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M4=Object.assign,R4={};function xf(t,e,n){this.props=t,this.context=e,this.refs=R4,this.updater=n||N4}xf.prototype.isReactComponent={};xf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};xf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function I4(){}I4.prototype=xf.prototype;function k_(t,e,n){this.props=t,this.context=e,this.refs=R4,this.updater=n||N4}var __=k_.prototype=new I4;__.constructor=k_;M4(__,xf.prototype);__.isPureReactComponent=!0;var lP=Array.isArray,T4=Object.prototype.hasOwnProperty,C_={current:null},O4={key:!0,ref:!0,__self:!0,__source:!0};function L4(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)T4.call(e,i)&&!O4.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:bm,type:t,key:s,ref:o,props:r,_owner:C_.current}}function x7(t,e){return{$$typeof:bm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function E_(t){return typeof t=="object"&&t!==null&&t.$$typeof===bm}function w7(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var cP=/\/+/g;function N1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?w7(""+t.key):e.toString(36)}function C0(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case bm:case c7:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+N1(o,0):i,lP(r)?(n="",t!=null&&(n=t.replace(cP,"$&/")+"/"),C0(r,e,n,"",function(c){return c})):r!=null&&(E_(r)&&(r=x7(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(cP,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",lP(t))for(var a=0;a<t.length;a++){s=t[a];var l=i+N1(s,a);o+=C0(s,e,n,l,r)}else if(l=b7(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=i+N1(s,a++),o+=C0(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Jm(t,e,n){if(t==null)return t;var i=[],r=0;return C0(t,i,"","",function(s){return e.call(n,s,r++)}),i}function S7(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ji={current:null},E0={transition:null},k7={ReactCurrentDispatcher:ji,ReactCurrentBatchConfig:E0,ReactCurrentOwner:C_};function D4(){throw Error("act(...) is not supported in production builds of React.")}xt.Children={map:Jm,forEach:function(t,e,n){Jm(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Jm(t,function(){e++}),e},toArray:function(t){return Jm(t,function(e){return e})||[]},only:function(t){if(!E_(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};xt.Component=xf;xt.Fragment=u7;xt.Profiler=f7;xt.PureComponent=k_;xt.StrictMode=d7;xt.Suspense=g7;xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k7;xt.act=D4;xt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=M4({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=C_.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)T4.call(e,l)&&!O4.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];i.children=a}return{$$typeof:bm,type:t.type,key:r,ref:s,props:i,_owner:o}};xt.createContext=function(t){return t={$$typeof:p7,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:h7,_context:t},t.Consumer=t};xt.createElement=L4;xt.createFactory=function(t){var e=L4.bind(null,t);return e.type=t,e};xt.createRef=function(){return{current:null}};xt.forwardRef=function(t){return{$$typeof:m7,render:t}};xt.isValidElement=E_;xt.lazy=function(t){return{$$typeof:y7,_payload:{_status:-1,_result:t},_init:S7}};xt.memo=function(t,e){return{$$typeof:v7,type:t,compare:e===void 0?null:e}};xt.startTransition=function(t){var e=E0.transition;E0.transition={};try{t()}finally{E0.transition=e}};xt.unstable_act=D4;xt.useCallback=function(t,e){return ji.current.useCallback(t,e)};xt.useContext=function(t){return ji.current.useContext(t)};xt.useDebugValue=function(){};xt.useDeferredValue=function(t){return ji.current.useDeferredValue(t)};xt.useEffect=function(t,e){return ji.current.useEffect(t,e)};xt.useId=function(){return ji.current.useId()};xt.useImperativeHandle=function(t,e,n){return ji.current.useImperativeHandle(t,e,n)};xt.useInsertionEffect=function(t,e){return ji.current.useInsertionEffect(t,e)};xt.useLayoutEffect=function(t,e){return ji.current.useLayoutEffect(t,e)};xt.useMemo=function(t,e){return ji.current.useMemo(t,e)};xt.useReducer=function(t,e,n){return ji.current.useReducer(t,e,n)};xt.useRef=function(t){return ji.current.useRef(t)};xt.useState=function(t){return ji.current.useState(t)};xt.useSyncExternalStore=function(t,e,n){return ji.current.useSyncExternalStore(t,e,n)};xt.useTransition=function(){return ji.current.useTransition()};xt.version="18.3.1";P4.exports=xt;var x=P4.exports;const Qt=uu(x),Qy=a7({__proto__:null,default:Qt},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _7=x,C7=Symbol.for("react.element"),E7=Symbol.for("react.fragment"),A7=Object.prototype.hasOwnProperty,P7=_7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,N7={key:!0,ref:!0,__self:!0,__source:!0};function j4(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)A7.call(e,i)&&!N7.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:C7,type:t,key:s,ref:o,props:r,_owner:P7.current}}Zy.Fragment=E7;Zy.jsx=j4;Zy.jsxs=j4;A4.exports=Zy;var h=A4.exports,X=typeof window<"u"?window:void 0,ir=typeof globalThis<"u"?globalThis:X,B4=Array.prototype,uP=B4.forEach,dP=B4.indexOf,Sr=ir==null?void 0:ir.navigator,Me=ir==null?void 0:ir.document,Qi=ir==null?void 0:ir.location,$w=ir==null?void 0:ir.fetch,Fw=ir!=null&&ir.XMLHttpRequest&&"withCredentials"in new ir.XMLHttpRequest?ir.XMLHttpRequest:void 0,fP=ir==null?void 0:ir.AbortController,Ji=Sr==null?void 0:Sr.userAgent,it=X??{},Uo={DEBUG:!1,LIB_VERSION:"1.256.2"},M1="$copy_autocapture",M7=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"],ta=function(t){return t.GZipJS="gzip-js",t.Base64="base64",t}({}),R7=["fatal","error","warning","log","info","debug"];function bt(t,e){return t.indexOf(e)!==-1}var eb=function(t){return t.trim()},zw=function(t){return t.replace(/^\$/,"")},I7=Array.isArray,$4=Object.prototype,F4=$4.hasOwnProperty,tb=$4.toString,an=I7||function(t){return tb.call(t)==="[object Array]"},es=t=>typeof t=="function",xn=t=>t===Object(t)&&!an(t),Vu=t=>{if(xn(t)){for(var e in t)if(F4.call(t,e))return!1;return!0}return!1},Se=t=>t===void 0,wn=t=>tb.call(t)=="[object String]",Uw=t=>wn(t)&&t.trim().length===0,Kl=t=>t===null,It=t=>Se(t)||Kl(t),yi=t=>tb.call(t)=="[object Number]",fo=t=>tb.call(t)==="[object Boolean]",T7=t=>t instanceof FormData,O7=t=>bt(M7,t),z4=t=>{var e={t:function(n){if(X&&(Uo.DEBUG||it.POSTHOG_DEBUG)&&!Se(X.console)&&X.console){for(var i=("__rrweb_original__"in X.console[n])?X.console[n].__rrweb_original__:X.console[n],r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];i(t,...s)}},info:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];e.t("log",...i)},warn:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];e.t("warn",...i)},error:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];e.t("error",...i)},critical:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];console.error(t,...i)},uninitializedWarning:n=>{e.error("You must initialize PostHog before calling "+n)},createLogger:n=>z4(t+" "+n)};return e},Ie=z4("[PostHog.js]"),qn=Ie.createLogger,L7=qn("[ExternalScriptsLoader]"),hP=(t,e,n)=>{if(t.config.disable_external_dependency_loading)return L7.warn(e+" was requested but loading of external scripts is disabled."),n("Loading of external scripts is disabled");var i=Me==null?void 0:Me.querySelectorAll("script");if(i){for(var r=0;r<i.length;r++)if(i[r].src===e)return n()}var s=()=>{if(!Me)return n("document not found");var o=Me.createElement("script");if(o.type="text/javascript",o.crossOrigin="anonymous",o.src=e,o.onload=c=>n(void 0,c),o.onerror=c=>n(c),t.config.prepare_external_dependency_script&&(o=t.config.prepare_external_dependency_script(o)),!o)return n("prepare_external_dependency_script returned null");var a,l=Me.querySelectorAll("body > script");l.length>0?(a=l[0].parentNode)==null||a.insertBefore(o,l[0]):Me.body.appendChild(o)};Me!=null&&Me.body?s():Me==null||Me.addEventListener("DOMContentLoaded",s)};function Ae(){return Ae=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Ae.apply(null,arguments)}function U4(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)!==-1)continue;n[i]=t[i]}return n}it.__PosthogExtensions__=it.__PosthogExtensions__||{},it.__PosthogExtensions__.loadExternalDependency=(t,e,n)=>{var i="/static/"+e+".js?v="+t.version;if(e==="remote-config"&&(i="/array/"+t.config.token+"/config.js"),e==="toolbar"){var r=3e5;i=i+"&t="+Math.floor(Date.now()/r)*r}var s=t.requestRouter.endpointFor("assets",i);hP(t,s,n)},it.__PosthogExtensions__.loadSiteApp=(t,e,n)=>{var i=t.requestRouter.endpointFor("api",e);hP(t,i,n)};var dv={};function ml(t,e,n){if(an(t)){if(uP&&t.forEach===uP)t.forEach(e,n);else if("length"in t&&t.length===+t.length){for(var i=0,r=t.length;i<r;i++)if(i in t&&e.call(n,t[i],i)===dv)return}}}function Ft(t,e,n){if(!It(t)){if(an(t))return ml(t,e,n);if(T7(t)){for(var i of t.entries())if(e.call(n,i[1],i[0])===dv)return}else for(var r in t)if(F4.call(t,r)&&e.call(n,t[r],r)===dv)return}}var Cn=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return ml(n,function(r){for(var s in r)r[s]!==void 0&&(t[s]=r[s])}),t},nb=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return ml(n,function(r){ml(r,function(s){t.push(s)})}),t};function A0(t){for(var e=Object.keys(t),n=e.length,i=new Array(n);n--;)i[n]=[e[n],t[e[n]]];return i}var pP=function(t){try{return t()}catch{return}},D7=function(t){return function(){try{for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,n)}catch(r){Ie.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),Ie.critical(r)}}},A_=function(t){var e={};return Ft(t,function(n,i){(wn(n)&&n.length>0||yi(n))&&(e[i]=n)}),e};function j7(t,e){return n=t,i=s=>wn(s)&&!Kl(e)?s.slice(0,e):s,r=new Set,function s(o,a){return o!==Object(o)?i?i(o,a):o:r.has(o)?void 0:(r.add(o),an(o)?(l=[],ml(o,c=>{l.push(s(c))})):(l={},Ft(o,(c,u)=>{r.has(c)||(l[u]=s(c,u))})),l);var l}(n);var n,i,r}var B7=["herokuapp.com","vercel.app","netlify.app"];function $7(t){var e=t==null?void 0:t.hostname;if(!wn(e))return!1;var n=e.split(".").slice(-2).join(".");for(var i of B7)if(n===i)return!1;return!0}function V4(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return t[n]}function fn(t,e,n,i){var{capture:r=!1,passive:s=!0}=i??{};t==null||t.addEventListener(e,n,{capture:r,passive:s})}var H4="$people_distinct_id",ah="__alias",lh="__timers",mP="$autocapture_disabled_server_side",Vw="$heatmaps_enabled_server_side",gP="$exception_capture_enabled_server_side",Hw="$error_tracking_suppression_rules",vP="$web_vitals_enabled_server_side",W4="$dead_clicks_enabled_server_side",yP="$web_vitals_allowed_metrics",Ww="$session_recording_enabled_server_side",bP="$console_log_recording_enabled_server_side",xP="$session_recording_network_payload_capture",wP="$session_recording_masking",SP="$session_recording_canvas_recording",kP="$replay_sample_rate",_P="$replay_minimum_duration",CP="$replay_script_config",fv="$sesid",ch="$session_is_sampled",Gw="$session_recording_url_trigger_activated_session",qw="$session_recording_event_trigger_activated_session",Hu="$enabled_feature_flags",P0="$early_access_features",Kw="$feature_flag_details",uh="$stored_person_properties",wc="$stored_group_properties",Xw="$surveys",Zm="$surveys_activated",hv="$flag_call_reported",Bo="$user_state",Yw="$client_session_props",Jw="$capture_rate_limit",Zw="$initial_campaign_params",Qw="$initial_referrer_info",pv="$initial_person_info",mv="$epp",G4="__POSTHOG_TOOLBAR__",Qm="$posthog_cookieless",F7=[H4,ah,"__cmpns",lh,Ww,Vw,fv,Hu,Hw,Bo,P0,Kw,wc,uh,Xw,hv,Yw,Jw,Zw,Qw,mv,pv];function EP(t){return t instanceof Element&&(t.id===G4||!(t.closest==null||!t.closest(".toolbar-global-fade-container")))}function ib(t){return!!t&&t.nodeType===1}function gl(t,e){return!!t&&!!t.tagName&&t.tagName.toLowerCase()===e.toLowerCase()}function q4(t){return!!t&&t.nodeType===3}function K4(t){return!!t&&t.nodeType===11}function P_(t){return t?eb(t).split(/\s+/):[]}function AP(t){var e=X==null?void 0:X.location.href;return!!(e&&t&&t.some(n=>e.match(n)))}function gv(t){var e="";switch(typeof t.className){case"string":e=t.className;break;case"object":e=(t.className&&"baseVal"in t.className?t.className.baseVal:null)||t.getAttribute("class")||"";break;default:e=""}return P_(e)}function X4(t){return It(t)?null:eb(t).split(/(\s+)/).filter(e=>$d(e)).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function rb(t){var e="";return tS(t)&&!Z4(t)&&t.childNodes&&t.childNodes.length&&Ft(t.childNodes,function(n){var i;q4(n)&&n.textContent&&(e+=(i=X4(n.textContent))!==null&&i!==void 0?i:"")}),eb(e)}function Y4(t){return Se(t.target)?t.srcElement||null:(e=t.target)!=null&&e.shadowRoot?t.composedPath()[0]||null:t.target||null;var e}var eS=["a","button","form","input","select","textarea","label"];function J4(t){var e=t.parentNode;return!(!e||!ib(e))&&e}function z7(t,e,n,i,r){var s,o,a;if(n===void 0&&(n=void 0),!X||!t||gl(t,"html")||!ib(t)||(s=n)!=null&&s.url_allowlist&&!AP(n.url_allowlist)||(o=n)!=null&&o.url_ignorelist&&AP(n.url_ignorelist))return!1;if((a=n)!=null&&a.dom_event_allowlist){var l=n.dom_event_allowlist;if(l&&!l.some(y=>e.type===y))return!1}for(var c=!1,u=[t],d=!0,f=t;f.parentNode&&!gl(f,"body");)if(K4(f.parentNode))u.push(f.parentNode.host),f=f.parentNode.host;else{if(!(d=J4(f)))break;if(i||eS.indexOf(d.tagName.toLowerCase())>-1)c=!0;else{var p=X.getComputedStyle(d);p&&p.getPropertyValue("cursor")==="pointer"&&(c=!0)}u.push(d),f=d}if(!function(y,v){var b=v==null?void 0:v.element_allowlist;if(Se(b))return!0;var w,k=function(E){if(b.some(_=>E.tagName.toLowerCase()===_))return{v:!0}};for(var C of y)if(w=k(C))return w.v;return!1}(u,n)||!function(y,v){var b=v==null?void 0:v.css_selector_allowlist;if(Se(b))return!0;var w,k=function(E){if(b.some(_=>E.matches(_)))return{v:!0}};for(var C of y)if(w=k(C))return w.v;return!1}(u,n))return!1;var m=X.getComputedStyle(t);if(m&&m.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var g=t.tagName.toLowerCase();switch(g){case"html":return!1;case"form":return(r||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(r||["change","click"]).indexOf(e.type)>=0;default:return c?(r||["click"]).indexOf(e.type)>=0:(r||["click"]).indexOf(e.type)>=0&&(eS.indexOf(g)>-1||t.getAttribute("contenteditable")==="true")}}function tS(t){for(var e=t;e.parentNode&&!gl(e,"body");e=e.parentNode){var n=gv(e);if(bt(n,"ph-sensitive")||bt(n,"ph-no-capture"))return!1}if(bt(gv(t),"ph-include"))return!0;var i=t.type||"";if(wn(i))switch(i.toLowerCase()){case"hidden":case"password":return!1}var r=t.name||t.id||"";return!(wn(r)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(r.replace(/[^a-zA-Z0-9]/g,"")))}function Z4(t){return!!(gl(t,"input")&&!["button","checkbox","submit","reset"].includes(t.type)||gl(t,"select")||gl(t,"textarea")||t.getAttribute("contenteditable")==="true")}var Q4="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",U7=new RegExp("^(?:"+Q4+")$"),V7=new RegExp(Q4),eO="\\d{3}-?\\d{2}-?\\d{4}",H7=new RegExp("^("+eO+")$"),W7=new RegExp("("+eO+")");function $d(t,e){return e===void 0&&(e=!0),!(It(t)||wn(t)&&(t=eb(t),(e?U7:V7).test((t||"").replace(/[- ]/g,""))||(e?H7:W7).test(t)))}function tO(t){var e=rb(t);return $d(e=(e+" "+nO(t)).trim())?e:""}function nO(t){var e="";return t&&t.childNodes&&t.childNodes.length&&Ft(t.childNodes,function(n){var i;if(n&&((i=n.tagName)==null?void 0:i.toLowerCase())==="span")try{var r=rb(n);e=(e+" "+r).trim(),n.childNodes&&n.childNodes.length&&(e=(e+" "+nO(n)).trim())}catch(s){Ie.error("[AutoCapture]",s)}}),e}function G7(t){return function(e){var n=e.map(i=>{var r,s,o="";if(i.tag_name&&(o+=i.tag_name),i.attr_class)for(var a of(i.attr_class.sort(),i.attr_class))o+="."+a.replace(/"/g,"");var l=Ae({},i.text?{text:i.text}:{},{"nth-child":(r=i.nth_child)!==null&&r!==void 0?r:0,"nth-of-type":(s=i.nth_of_type)!==null&&s!==void 0?s:0},i.href?{href:i.href}:{},i.attr_id?{attr_id:i.attr_id}:{},i.attributes),c={};return A0(l).sort((u,d)=>{var[f]=u,[p]=d;return f.localeCompare(p)}).forEach(u=>{var[d,f]=u;return c[PP(d.toString())]=PP(f.toString())}),o+=":",o+=A0(c).map(u=>{var[d,f]=u;return d+'="'+f+'"'}).join("")});return n.join(";")}(function(e){return e.map(n=>{var i,r,s={text:(i=n.$el_text)==null?void 0:i.slice(0,400),tag_name:n.tag_name,href:(r=n.attr__href)==null?void 0:r.slice(0,2048),attr_class:q7(n),attr_id:n.attr__id,nth_child:n.nth_child,nth_of_type:n.nth_of_type,attributes:{}};return A0(n).filter(o=>{var[a]=o;return a.indexOf("attr__")===0}).forEach(o=>{var[a,l]=o;return s.attributes[a]=l}),s})}(t))}function PP(t){return t.replace(/"|\\"/g,'\\"')}function q7(t){var e=t.attr__class;return e?an(e)?e:P_(e):void 0}let iO=class{constructor(){this.clicks=[]}isRageClick(e,n,i){var r=this.clicks[this.clicks.length-1];if(r&&Math.abs(e-r.x)+Math.abs(n-r.y)<30&&i-r.timestamp<1e3){if(this.clicks.push({x:e,y:n,timestamp:i}),this.clicks.length===3)return!0}else this.clicks=[{x:e,y:n,timestamp:i}];return!1}};var K7=["localhost","127.0.0.1"],Fd=t=>{var e=Me==null?void 0:Me.createElement("a");return Se(e)?null:(e.href=t,e)},X7=function(t,e){var n,i;e===void 0&&(e="&");var r=[];return Ft(t,function(s,o){Se(s)||Se(o)||o==="undefined"||(n=encodeURIComponent((a=>a instanceof File)(s)?s.name:s.toString()),i=encodeURIComponent(o),r[r.length]=i+"="+n)}),r.join(e)},vv=function(t,e){for(var n,i=((t.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),r=0;r<i.length;r++){var s=i[r].split("=");if(s[0]===e){n=s;break}}if(!an(n)||n.length<2)return"";var o=n[1];try{o=decodeURIComponent(o)}catch{Ie.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},N_=function(t,e,n){if(!t||!e||!e.length)return t;for(var i=t.split("#"),r=i[0]||"",s=i[1],o=r.split("?"),a=o[1],l=o[0],c=(a||"").split("&"),u=[],d=0;d<c.length;d++){var f=c[d].split("=");an(f)&&(e.includes(f[0])?u.push(f[0]+"="+n):u.push(c[d]))}var p=l;return a!=null&&(p+="?"+u.join("&")),s!=null&&(p+="#"+s),p},yv=function(t,e){var n=t.match(new RegExp(e+"=([^&]*)"));return n?n[1]:null},NP=qn("[AutoCapture]");function R1(t,e){return e.length>t?e.slice(0,t)+"...":e}function Y7(t){if(t.previousElementSibling)return t.previousElementSibling;var e=t;do e=e.previousSibling;while(e&&!ib(e));return e}function J7(t,e,n,i){var r=t.tagName.toLowerCase(),s={tag_name:r};eS.indexOf(r)>-1&&!n&&(r.toLowerCase()==="a"||r.toLowerCase()==="button"?s.$el_text=R1(1024,tO(t)):s.$el_text=R1(1024,rb(t)));var o=gv(t);o.length>0&&(s.classes=o.filter(function(u){return u!==""})),Ft(t.attributes,function(u){var d;if((!Z4(t)||["name","id","class","aria-label"].indexOf(u.name)!==-1)&&(i==null||!i.includes(u.name))&&!e&&$d(u.value)&&(d=u.name,!wn(d)||d.substring(0,10)!=="_ngcontent"&&d.substring(0,7)!=="_nghost")){var f=u.value;u.name==="class"&&(f=P_(f).join(" ")),s["attr__"+u.name]=R1(1024,f)}});for(var a=1,l=1,c=t;c=Y7(c);)a++,c.tagName===t.tagName&&l++;return s.nth_child=a,s.nth_of_type=l,s}function Z7(t,e){for(var n,i,{e:r,maskAllElementAttributes:s,maskAllText:o,elementAttributeIgnoreList:a,elementsChainAsString:l}=e,c=[t],u=t;u.parentNode&&!gl(u,"body");)K4(u.parentNode)?(c.push(u.parentNode.host),u=u.parentNode.host):(c.push(u.parentNode),u=u.parentNode);var d,f=[],p={},m=!1,g=!1;if(Ft(c,k=>{var C=tS(k);k.tagName.toLowerCase()==="a"&&(m=k.getAttribute("href"),m=C&&m&&$d(m)&&m),bt(gv(k),"ph-no-capture")&&(g=!0),f.push(J7(k,s,o,a));var E=function(_){if(!tS(_))return{};var A={};return Ft(_.attributes,function(R){if(R.name&&R.name.indexOf("data-ph-capture-attribute")===0){var L=R.name.replace("data-ph-capture-attribute-",""),O=R.value;L&&O&&$d(O)&&(A[L]=O)}}),A}(k);Cn(p,E)}),g)return{props:{},explicitNoCapture:g};if(o||(t.tagName.toLowerCase()==="a"||t.tagName.toLowerCase()==="button"?f[0].$el_text=tO(t):f[0].$el_text=rb(t)),m){var y,v;f[0].attr__href=m;var b=(y=Fd(m))==null?void 0:y.host,w=X==null||(v=X.location)==null?void 0:v.host;b&&w&&b!==w&&(d=m)}return{props:Cn({$event_type:r.type,$ce_version:1},l?{}:{$elements:f},{$elements_chain:G7(f)},(n=f[0])!=null&&n.$el_text?{$el_text:(i=f[0])==null?void 0:i.$el_text}:{},d&&r.type==="click"?{$external_click_url:d}:{},p)}}let Q7=class{constructor(e){this.i=!1,this.o=null,this.rageclicks=new iO,this.h=!1,this.instance=e,this.m=null}get S(){var e,n,i=xn(this.instance.config.autocapture)?this.instance.config.autocapture:{};return i.url_allowlist=(e=i.url_allowlist)==null?void 0:e.map(r=>new RegExp(r)),i.url_ignorelist=(n=i.url_ignorelist)==null?void 0:n.map(r=>new RegExp(r)),i}$(){if(this.isBrowserSupported()){if(X&&Me){var e=i=>{i=i||(X==null?void 0:X.event);try{this.k(i)}catch(r){NP.error("Failed to capture event",r)}};if(fn(Me,"submit",e,{capture:!0}),fn(Me,"change",e,{capture:!0}),fn(Me,"click",e,{capture:!0}),this.S.capture_copied_text){var n=i=>{i=i||(X==null?void 0:X.event),this.k(i,M1)};fn(Me,"copy",n,{capture:!0}),fn(Me,"cut",n,{capture:!0})}}}else NP.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.i&&(this.$(),this.i=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.h=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[mP]:!!e.autocapture_opt_out}),this.o=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.m=e}getElementSelectors(e){var n,i=[];return(n=this.m)==null||n.forEach(r=>{var s=Me==null?void 0:Me.querySelectorAll(r);s==null||s.forEach(o=>{e===o&&i.push(r)})}),i}get isEnabled(){var e,n,i=(e=this.instance.persistence)==null?void 0:e.props[mP],r=this.o;if(Kl(r)&&!fo(i)&&!this.instance.I())return!1;var s=(n=this.o)!==null&&n!==void 0?n:!!i;return!!this.instance.config.autocapture&&!s}k(e,n){if(n===void 0&&(n="$autocapture"),this.isEnabled){var i,r=Y4(e);q4(r)&&(r=r.parentNode||null),n==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(i=this.rageclicks)!=null&&i.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.k(e,"$rageclick");var s=n===M1;if(r&&z7(r,e,this.S,s,s?["copy","cut"]:void 0)){var{props:o,explicitNoCapture:a}=Z7(r,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.S.element_attribute_ignorelist,elementsChainAsString:this.h});if(a)return!1;var l=this.getElementSelectors(r);if(l&&l.length>0&&(o.$element_selectors=l),n===M1){var c,u=X4(X==null||(c=X.getSelection())==null?void 0:c.toString()),d=e.type||"clipboard";if(!u)return!1;o.$selected_content=u,o.$copy_type=d}return this.instance.capture(n,o),!0}}}isBrowserSupported(){return es(Me==null?void 0:Me.querySelectorAll)}};Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Number.isInteger||(Number.isInteger=function(t){return yi(t)&&isFinite(t)&&Math.floor(t)===t});var MP="0123456789abcdef";let eV=class nS{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,n,i,r){if(!Number.isInteger(e)||!Number.isInteger(n)||!Number.isInteger(i)||!Number.isInteger(r)||e<0||n<0||i<0||r<0||e>0xffffffffffff||n>4095||i>1073741823||r>4294967295)throw new RangeError("invalid field value");var s=new Uint8Array(16);return s[0]=e/Math.pow(2,40),s[1]=e/Math.pow(2,32),s[2]=e/Math.pow(2,24),s[3]=e/Math.pow(2,16),s[4]=e/Math.pow(2,8),s[5]=e,s[6]=112|n>>>8,s[7]=n,s[8]=128|i>>>24,s[9]=i>>>16,s[10]=i>>>8,s[11]=i,s[12]=r>>>24,s[13]=r>>>16,s[14]=r>>>8,s[15]=r,new nS(s)}toString(){for(var e="",n=0;n<this.bytes.length;n++)e=e+MP.charAt(this.bytes[n]>>>4)+MP.charAt(15&this.bytes[n]),n!==3&&n!==5&&n!==7&&n!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new nS(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var n=0;n<16;n++){var i=this.bytes[n]-e.bytes[n];if(i!==0)return Math.sign(i)}return 0}},tV=class{constructor(){this.P=0,this.R=0,this.T=new nV}generate(){var e=this.generateOrAbort();if(Se(e)){this.P=0;var n=this.generateOrAbort();if(Se(n))throw new Error("Could not generate UUID after timestamp reset");return n}return e}generateOrAbort(){var e=Date.now();if(e>this.P)this.P=e,this.M();else{if(!(e+1e4>this.P))return;this.R++,this.R>4398046511103&&(this.P++,this.M())}return eV.fromFieldsV7(this.P,Math.trunc(this.R/Math.pow(2,30)),this.R&Math.pow(2,30)-1,this.T.nextUint32())}M(){this.R=1024*this.T.nextUint32()+(1023&this.T.nextUint32())}};var RP,rO=t=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<t.length;e++)t[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return t};X&&!Se(X.crypto)&&crypto.getRandomValues&&(rO=t=>crypto.getRandomValues(t));let nV=class{constructor(){this.C=new Uint32Array(8),this.F=1/0}nextUint32(){return this.F>=this.C.length&&(rO(this.C),this.F=0),this.C[this.F++]}};var il=()=>iV().toString(),iV=()=>(RP||(RP=new tV)).generate(),Lf="",rV=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function sV(t,e){if(e){var n=function(r,s){if(s===void 0&&(s=Me),Lf)return Lf;if(!s||["localhost","127.0.0.1"].includes(r))return"";for(var o=r.split("."),a=Math.min(o.length,8),l="dmn_chk_"+il();!Lf&&a--;){var c=o.slice(a).join("."),u=l+"=1;domain=."+c+";path=/";s.cookie=u+";max-age=3",s.cookie.includes(l)&&(s.cookie=u+";max-age=0",Lf=c)}return Lf}(t);if(!n){var i=(r=>{var s=r.match(rV);return s?s[0]:""})(t);i!==n&&Ie.info("Warning: cookie subdomain discovery mismatch",i,n),n=i}return n?"; domain=."+n:""}return""}var xo={O:()=>!!Me,A:function(t){Ie.error("cookieStore error: "+t)},D:function(t){if(Me){try{for(var e=t+"=",n=Me.cookie.split(";").filter(s=>s.length),i=0;i<n.length;i++){for(var r=n[i];r.charAt(0)==" ";)r=r.substring(1,r.length);if(r.indexOf(e)===0)return decodeURIComponent(r.substring(e.length,r.length))}}catch{}return null}},L:function(t){var e;try{e=JSON.parse(xo.D(t))||{}}catch{}return e},j:function(t,e,n,i,r){if(Me)try{var s="",o="",a=sV(Me.location.hostname,i);if(n){var l=new Date;l.setTime(l.getTime()+24*n*60*60*1e3),s="; expires="+l.toUTCString()}r&&(o="; secure");var c=t+"="+encodeURIComponent(JSON.stringify(e))+s+"; SameSite=Lax; path=/"+a+o;return c.length>3686.4&&Ie.warn("cookieStore warning: large cookie, len="+c.length),Me.cookie=c,c}catch{return}},N:function(t,e){try{xo.j(t,"",-1,e)}catch{return}}},I1=null,Dn={O:function(){if(!Kl(I1))return I1;var t=!0;if(Se(X))t=!1;else try{var e="__mplssupport__";Dn.j(e,"xyz"),Dn.D(e)!=='"xyz"'&&(t=!1),Dn.N(e)}catch{t=!1}return t||Ie.error("localStorage unsupported; falling back to cookie store"),I1=t,t},A:function(t){Ie.error("localStorage error: "+t)},D:function(t){try{return X==null?void 0:X.localStorage.getItem(t)}catch(e){Dn.A(e)}return null},L:function(t){try{return JSON.parse(Dn.D(t))||{}}catch{}return null},j:function(t,e){try{X==null||X.localStorage.setItem(t,JSON.stringify(e))}catch(n){Dn.A(n)}},N:function(t){try{X==null||X.localStorage.removeItem(t)}catch(e){Dn.A(e)}}},oV=["distinct_id",fv,ch,mv,pv],eg=Ae({},Dn,{L:function(t){try{var e={};try{e=xo.L(t)||{}}catch{}var n=Cn(e,JSON.parse(Dn.D(t)||"{}"));return Dn.j(t,n),n}catch{}return null},j:function(t,e,n,i,r,s){try{Dn.j(t,e,void 0,void 0,s);var o={};oV.forEach(a=>{e[a]&&(o[a]=e[a])}),Object.keys(o).length&&xo.j(t,o,n,i,r,s)}catch(a){Dn.A(a)}},N:function(t,e){try{X==null||X.localStorage.removeItem(t),xo.N(t,e)}catch(n){Dn.A(n)}}}),tg={},aV={O:function(){return!0},A:function(t){Ie.error("memoryStorage error: "+t)},D:function(t){return tg[t]||null},L:function(t){return tg[t]||null},j:function(t,e){tg[t]=e},N:function(t){delete tg[t]}},cc=null,Qn={O:function(){if(!Kl(cc))return cc;if(cc=!0,Se(X))cc=!1;else try{var t="__support__";Qn.j(t,"xyz"),Qn.D(t)!=='"xyz"'&&(cc=!1),Qn.N(t)}catch{cc=!1}return cc},A:function(t){Ie.error("sessionStorage error: ",t)},D:function(t){try{return X==null?void 0:X.sessionStorage.getItem(t)}catch(e){Qn.A(e)}return null},L:function(t){try{return JSON.parse(Qn.D(t))||null}catch{}return null},j:function(t,e){try{X==null||X.sessionStorage.setItem(t,JSON.stringify(e))}catch(n){Qn.A(n)}},N:function(t){try{X==null||X.sessionStorage.removeItem(t)}catch(e){Qn.A(e)}}},vu=function(t){return t[t.PENDING=-1]="PENDING",t[t.DENIED=0]="DENIED",t[t.GRANTED=1]="GRANTED",t}({});let lV=class{constructor(e){this._instance=e}get S(){return this._instance.config}get consent(){return this.U()?vu.DENIED:this.q}isOptedOut(){return this.consent===vu.DENIED||this.consent===vu.PENDING&&this.S.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(e){this.B.j(this.H,e?1:0,this.S.cookie_expiration,this.S.cross_subdomain_cookie,this.S.secure_cookie)}reset(){this.B.N(this.H,this.S.cross_subdomain_cookie)}get H(){var{token:e,opt_out_capturing_cookie_prefix:n}=this._instance.config;return(n||"__ph_opt_in_out_")+e}get q(){var e=this.B.D(this.H);return e==="1"?vu.GRANTED:e==="0"?vu.DENIED:vu.PENDING}get B(){if(!this.W){var e=this.S.opt_out_capturing_persistence_type;this.W=e==="localStorage"?Dn:xo;var n=e==="localStorage"?xo:Dn;n.D(this.H)&&(this.W.D(this.H)||this.optInOut(n.D(this.H)==="1"),n.N(this.H,this.S.cross_subdomain_cookie))}return this.W}U(){return!!this.S.respect_dnt&&!!V4([Sr==null?void 0:Sr.doNotTrack,Sr==null?void 0:Sr.msDoNotTrack,it.doNotTrack],e=>bt([!0,1,"1","yes"],e))}};var ng=qn("[Dead Clicks]"),cV=()=>!0,uV=t=>{var e,n=!((e=t.instance.persistence)==null||!e.get_property(W4)),i=t.instance.config.capture_dead_clicks;return fo(i)?i:n};let sO=class{get lazyLoadedDeadClicksAutocapture(){return this.G}constructor(e,n,i){this.instance=e,this.isEnabled=n,this.onCapture=i,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[W4]:e==null?void 0:e.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.J(()=>{this.V()})}J(e){var n,i;(n=it.__PosthogExtensions__)!=null&&n.initDeadClicksAutocapture&&e(),(i=it.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this.instance,"dead-clicks-autocapture",r=>{r?ng.error("failed to load script",r):e()})}V(){var e;if(Me){if(!this.G&&(e=it.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var n=xn(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};n.__onCapture=this.onCapture,this.G=it.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,n),this.G.start(Me),ng.info("starting...")}}else ng.error("`document` not found. Cannot start.")}stop(){this.G&&(this.G.stop(),this.G=void 0,ng.info("stopping..."))}};function kr(t,e,n,i,r){return e>n&&(Ie.warn("min cannot be greater than max."),e=n),yi(t)?t>n?(i&&Ie.warn(i+" cannot be  greater than max: "+n+". Using max value instead."),n):t<e?(i&&Ie.warn(i+" cannot be less than min: "+e+". Using min value instead."),e):t:(i&&Ie.warn(i+" must be a number. using max or fallback. max: "+n+", fallback: "+r),kr(r||n,e,n,i))}let oO=class{constructor(e){this.K={},this.Y=()=>{Object.keys(this.K).forEach(n=>{var i=this.X(n)+this.Z;i>=this.tt?delete this.K[n]:this.it(n,i)})},this.X=n=>this.K[String(n)],this.it=(n,i)=>{this.K[String(n)]=i},this.consumeRateLimit=n=>{var i,r=(i=this.X(n))!==null&&i!==void 0?i:this.tt;if((r=Math.max(r-1,0))===0)return!0;this.it(n,r);var s,o=r===0;return o&&((s=this.et)==null||s.call(this,n)),o},this.rt=e,this.et=this.rt.et,this.tt=kr(this.rt.bucketSize,0,100,"rate limiter bucket size"),this.Z=kr(this.rt.refillRate,0,this.tt,"rate limiter refill rate"),this.st=kr(this.rt.refillInterval,0,864e5,"rate limiter refill interval"),setInterval(()=>{this.Y()},this.st)}};var ig=qn("[ExceptionAutocapture]");let dV=class{constructor(e){var n,i,r;this.nt=()=>{var s;if(X&&this.isEnabled&&(s=it.__PosthogExtensions__)!=null&&s.errorWrappingFunctions){var o=it.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,a=it.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,l=it.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.ot&&this.S.capture_unhandled_errors&&(this.ot=o(this.captureException.bind(this))),!this.lt&&this.S.capture_unhandled_rejections&&(this.lt=a(this.captureException.bind(this))),!this.ut&&this.S.capture_console_errors&&(this.ut=l(this.captureException.bind(this)))}catch(c){ig.error("failed to start",c),this.ht()}}},this._instance=e,this.dt=!((n=this._instance.persistence)==null||!n.props[gP]),this.S=this.vt(),this.ct=new oO({refillRate:(i=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&i!==void 0?i:1,bucketSize:(r=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&r!==void 0?r:10,refillInterval:1e4}),this.startIfEnabled()}vt(){var e=this._instance.config.capture_exceptions,n={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return xn(e)?n=Ae({},n,e):(Se(e)?this.dt:e)&&(n=Ae({},n,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),n}get isEnabled(){return this.S.capture_console_errors||this.S.capture_unhandled_errors||this.S.capture_unhandled_rejections}startIfEnabled(){this.isEnabled&&(ig.info("enabled"),this.J(this.nt))}J(e){var n,i;(n=it.__PosthogExtensions__)!=null&&n.errorWrappingFunctions&&e(),(i=it.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,"exception-autocapture",r=>{if(r)return ig.error("failed to load script",r);e()})}ht(){var e,n,i;(e=this.ot)==null||e.call(this),this.ot=void 0,(n=this.lt)==null||n.call(this),this.lt=void 0,(i=this.ut)==null||i.call(this),this.ut=void 0}onRemoteConfig(e){var n=e.autocaptureExceptions;this.dt=!!n||!1,this.S=this.vt(),this._instance.persistence&&this._instance.persistence.register({[gP]:this.dt}),this.startIfEnabled()}captureException(e){var n,i=this._instance.requestRouter.endpointFor("ui");e.$exception_personURL=i+"/project/"+this._instance.config.token+"/person/"+this._instance.get_distinct_id();var r=(n=e.$exception_list[0].type)!==null&&n!==void 0?n:"Exception";this.ct.consumeRateLimit(r)?ig.info("Skipping exception capture because of client rate limiting.",{exception:e.$exception_list[0].type}):this._instance.exceptions.sendExceptionEvent(e)}};function aO(t){return!Se(Event)&&lO(t,Event)}function lO(t,e){try{return t instanceof e}catch{return!1}}function cO(t){switch(Object.prototype.toString.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object DOMError]":return!0;default:return lO(t,Error)}}function N0(t,e){return Object.prototype.toString.call(t)==="[object "+e+"]"}function T1(t){return N0(t,"DOMError")}var IP=/\(error: (.*)\)/,TP=50,Wu="?";function O1(t,e,n,i){var r={platform:"web:javascript",filename:t,function:e==="<anonymous>"?Wu:e,in_app:!0};return Se(n)||(r.lineno=n),Se(i)||(r.colno=i),r}var fV=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,hV=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,pV=/\((\S*)(?::(\d+))(?::(\d+))\)/,mV=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,gV=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,vV=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=e.sort((r,s)=>r[0]-s[0]).map(r=>r[1]);return function(r,s){s===void 0&&(s=0);for(var o=[],a=r.split(`
`),l=s;l<a.length;l++){var c=a[l];if(!(c.length>1024)){var u=IP.test(c)?c.replace(IP,"$1"):c;if(!u.match(/\S*Error: /)){for(var d of i){var f=d(u);if(f){o.push(f);break}}if(o.length>=TP)break}}}return function(p){if(!p.length)return[];var m=Array.from(p);return m.reverse(),m.slice(0,TP).map(g=>Ae({},g,{filename:g.filename||yV(m).filename,function:g.function||Wu}))}(o)}}([30,t=>{var e=fV.exec(t);if(e){var[,n,i,r]=e;return O1(n,Wu,+i,+r)}var s=hV.exec(t);if(s){if(s[2]&&s[2].indexOf("eval")===0){var o=pV.exec(s[2]);o&&(s[2]=o[1],s[3]=o[2],s[4]=o[3])}var[a,l]=LP(s[1]||Wu,s[2]);return O1(l,a,s[3]?+s[3]:void 0,s[4]?+s[4]:void 0)}}],[50,t=>{var e=mV.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){var n=gV.exec(e[3]);n&&(e[1]=e[1]||"eval",e[3]=n[1],e[4]=n[2],e[5]="")}var i=e[3],r=e[1]||Wu;return[r,i]=LP(r,i),O1(i,r,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}]);function yV(t){return t[t.length-1]||{}}var rg,OP,L1,LP=(t,e)=>{var n=t.indexOf("safari-extension")!==-1,i=t.indexOf("safari-web-extension")!==-1;return n||i?[t.indexOf("@")!==-1?t.split("@")[0]:Wu,n?"safari-extension:"+e:"safari-web-extension:"+e]:[t,e]},bV=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;function M_(t,e){e===void 0&&(e=0);var n=t.stacktrace||t.stack||"",i=function(o){return o&&xV.test(o.message)?1:0}(t);try{var r=vV,s=function(o,a){var l=function(c){var u=globalThis._posthogChunkIds;if(!u)return{};var d=Object.keys(u);return L1&&d.length===OP||(OP=d.length,L1=d.reduce((f,p)=>{rg||(rg={});var m=rg[p];if(m)f[m[0]]=m[1];else for(var g=c(p),y=g.length-1;y>=0;y--){var v=g[y],b=v==null?void 0:v.filename,w=u[p];if(b&&w){f[b]=w,rg[p]=[b,w];break}}return f},{})),L1}(a);return o.forEach(c=>{c.filename&&(c.chunk_id=l[c.filename])}),o}(r(n,i),r);return s.slice(0,s.length-e)}catch{}return[]}var xV=/Minified React error #\d+;/i;function wV(t,e){var n,i,r=M_(t),s=(n=e==null?void 0:e.handled)===null||n===void 0||n,o=(i=e==null?void 0:e.synthetic)!==null&&i!==void 0&&i;return{type:e!=null&&e.overrideExceptionType?e.overrideExceptionType:t.name,value:function(a){var l=a.message;return l.error&&typeof l.error.message=="string"?String(l.error.message):String(l)}(t),stacktrace:{frames:r,type:"raw"},mechanism:{handled:s,synthetic:o}}}function uO(t,e){var n=wV(t,e);return t.cause&&cO(t.cause)&&t.cause!==t?[n,...uO(t.cause,{handled:e==null?void 0:e.handled,synthetic:e==null?void 0:e.synthetic})]:[n]}function D1(t,e){return{$exception_list:uO(t,e),$exception_level:"error"}}function j1(t,e){var n,i,r,s=(n=e==null?void 0:e.handled)===null||n===void 0||n,o=(i=e==null?void 0:e.synthetic)===null||i===void 0||i,a={type:e!=null&&e.overrideExceptionType?e.overrideExceptionType:(r=e==null?void 0:e.defaultExceptionType)!==null&&r!==void 0?r:"Error",value:t||(e==null?void 0:e.defaultExceptionMessage),mechanism:{handled:s,synthetic:o}};if(e!=null&&e.syntheticException){var l=M_(e.syntheticException,1);l.length&&(a.stacktrace={frames:l,type:"raw"})}return{$exception_list:[a],$exception_level:"error"}}function SV(t){return wn(t)&&!Uw(t)&&R7.indexOf(t)>=0}function kV(t,e){var n,i,r=(n=e==null?void 0:e.handled)===null||n===void 0||n,s=(i=e==null?void 0:e.synthetic)===null||i===void 0||i,o=e!=null&&e.overrideExceptionType?e.overrideExceptionType:aO(t)?t.constructor.name:"Error",a="Non-Error 'exception' captured with keys: "+function(u,d){d===void 0&&(d=40);var f=Object.keys(u);if(f.sort(),!f.length)return"[object has no keys]";for(var p=f.length;p>0;p--){var m=f.slice(0,p).join(", ");if(!(m.length>d))return p===f.length||m.length<=d?m:m.slice(0,d)+"..."}return""}(t),l={type:o,value:a,mechanism:{handled:r,synthetic:s}};if(e!=null&&e.syntheticException){var c=M_(e==null?void 0:e.syntheticException,1);c.length&&(l.stacktrace={frames:c,type:"raw"})}return{$exception_list:[l],$exception_level:SV(t.level)?t.level:"error"}}function _V(t,e){var{error:n,event:i}=t,r={$exception_list:[]},s=n||i;if(T1(s)||function(f){return N0(f,"DOMException")}(s)){var o=s;if(function(f){return"stack"in f}(s))r=D1(s,e);else{var a=o.name||(T1(o)?"DOMError":"DOMException"),l=o.message?a+": "+o.message:a;r=j1(l,Ae({},e,{overrideExceptionType:T1(o)?"DOMError":"DOMException",defaultExceptionMessage:l}))}return"code"in o&&(r.$exception_DOMException_code=""+o.code),r}if(function(f){return N0(f,"ErrorEvent")}(s)&&s.error)return D1(s.error,e);if(cO(s))return D1(s,e);if(function(f){return N0(f,"Object")}(s)||aO(s))return kV(s,e);if(Se(n)&&wn(i)){var c="Error",u=i,d=i.match(bV);return d&&(c=d[1],u=d[2]),j1(u,Ae({},e,{overrideExceptionType:c,defaultExceptionMessage:u}))}return j1(s,e)}function DP(t,e,n){try{if(!(e in t))return()=>{};var i=t[e],r=n(i);return es(r)&&(r.prototype=r.prototype||{},Object.defineProperties(r,{__posthog_wrapped__:{enumerable:!1,value:!0}})),t[e]=r,()=>{t[e]=i}}catch{return()=>{}}}let CV=class{constructor(e){var n;this._instance=e,this.ft=(X==null||(n=X.location)==null?void 0:n.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(Ie.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.gt&&this.gt(),this.gt=void 0,Ie.info("History API monitoring stopped")}monitorHistoryChanges(){var e,n;if(X&&X.history){var i=this;(e=X.history.pushState)!=null&&e.__posthog_wrapped__||DP(X.history,"pushState",r=>function(s,o,a){r.call(this,s,o,a),i._t("pushState")}),(n=X.history.replaceState)!=null&&n.__posthog_wrapped__||DP(X.history,"replaceState",r=>function(s,o,a){r.call(this,s,o,a),i._t("replaceState")}),this.bt()}}_t(e){try{var n,i=X==null||(n=X.location)==null?void 0:n.pathname;if(!i)return;i!==this.ft&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.ft=i}catch(r){Ie.error("Error capturing "+e+" pageview",r)}}bt(){if(!this.gt){var e=()=>{this._t("popstate")};fn(X,"popstate",e),this.gt=()=>{X&&X.removeEventListener("popstate",e)}}}};function bv(t){var e,n;return((e=JSON.stringify(t,(n=[],function(i,r){if(xn(r)){for(;n.length>0&&n[n.length-1]!==this;)n.pop();return n.includes(r)?"[Circular]":(n.push(r),r)}return r})))==null?void 0:e.length)||0}function iS(t,e){if(e===void 0&&(e=66060288e-1),t.size>=e&&t.data.length>1){var n=Math.floor(t.data.length/2),i=t.data.slice(0,n),r=t.data.slice(n);return[iS({size:bv(i),data:i,sessionId:t.sessionId,windowId:t.windowId}),iS({size:bv(r),data:r,sessionId:t.sessionId,windowId:t.windowId})].flatMap(s=>s)}return[t]}var $o=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))($o||{}),bs=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t))(bs||{}),rS="[SessionRecording]",sS="redacted",sg={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:t=>t,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com","bam.nr-data.net"]},EV=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],AV=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],PV=["/s/","/e/","/i/"];function jP(t,e,n,i){if(It(t))return t;var r=(e==null?void 0:e["content-length"])||function(s){return new Blob([s]).size}(t);return wn(r)&&(r=parseInt(r)),r>n?rS+" "+i+" body too large to record ("+r+" bytes)":t}function BP(t,e){if(It(t))return t;var n=t;return $d(n,!1)||(n=rS+" "+e+" body "+sS),Ft(AV,i=>{var r,s;(r=n)!=null&&r.length&&((s=n)==null?void 0:s.indexOf(i))!==-1&&(n=rS+" "+e+" body "+sS+" as might contain: "+i)}),n}var NV=(t,e)=>{var n,i,r,s={payloadSizeLimitBytes:sg.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...sg.performanceEntryTypeToObserve],payloadHostDenyList:[...e.payloadHostDenyList||[],...sg.payloadHostDenyList]},o=t.session_recording.recordHeaders!==!1&&e.recordHeaders,a=t.session_recording.recordBody!==!1&&e.recordBody,l=t.capture_performance!==!1&&e.recordPerformance,c=(n=s,r=Math.min(1e6,(i=n.payloadSizeLimitBytes)!==null&&i!==void 0?i:1e6),f=>(f!=null&&f.requestBody&&(f.requestBody=jP(f.requestBody,f.requestHeaders,r,"Request")),f!=null&&f.responseBody&&(f.responseBody=jP(f.responseBody,f.responseHeaders,r,"Response")),f)),u=f=>{return c(((g,y)=>{var v,b=Fd(g.name),w=y.indexOf("http")===0?(v=Fd(y))==null?void 0:v.pathname:y;w==="/"&&(w="");var k=b==null?void 0:b.pathname.replace(w||"","");if(!(b&&k&&PV.some(C=>k.indexOf(C)===0)))return g})((m=(p=f).requestHeaders,It(m)||Ft(Object.keys(m??{}),g=>{EV.includes(g.toLowerCase())&&(m[g]=sS)}),p),t.api_host));var p,m},d=es(t.session_recording.maskNetworkRequestFn);return d&&es(t.session_recording.maskCapturedNetworkRequestFn)&&Ie.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),d&&(t.session_recording.maskCapturedNetworkRequestFn=f=>{var p=t.session_recording.maskNetworkRequestFn({url:f.name});return Ae({},f,{name:p==null?void 0:p.url})}),s.maskRequestFn=es(t.session_recording.maskCapturedNetworkRequestFn)?f=>{var p,m=u(f);return m&&(p=t.session_recording.maskCapturedNetworkRequestFn==null?void 0:t.session_recording.maskCapturedNetworkRequestFn(m))!==null&&p!==void 0?p:void 0}:f=>function(p){if(!Se(p))return p.requestBody=BP(p.requestBody,"Request"),p.responseBody=BP(p.responseBody,"Response"),p}(u(f)),Ae({},sg,s,{recordHeaders:o,recordBody:a,recordPerformance:l,recordInitialRequests:l})};let MV=class{constructor(e,n){var i,r;n===void 0&&(n={}),this.yt={},this.wt=s=>{if(!this.yt[s]){var o,a;this.yt[s]=!0;var l=this.St(s);(o=(a=this.rt).onBlockedNode)==null||o.call(a,s,l)}},this.$t=s=>{var o=this.St(s);if((o==null?void 0:o.nodeName)!=="svg"&&o instanceof Element){var a=o.closest("svg");if(a)return[this._rrweb.mirror.getId(a),a]}return[s,o]},this.St=s=>this._rrweb.mirror.getNode(s),this.kt=s=>{var o,a,l,c,u,d,f,p;return((o=(a=s.removes)==null?void 0:a.length)!==null&&o!==void 0?o:0)+((l=(c=s.attributes)==null?void 0:c.length)!==null&&l!==void 0?l:0)+((u=(d=s.texts)==null?void 0:d.length)!==null&&u!==void 0?u:0)+((f=(p=s.adds)==null?void 0:p.length)!==null&&f!==void 0?f:0)},this.throttleMutations=s=>{if(s.type!==3||s.data.source!==0)return s;var o=s.data,a=this.kt(o);o.attributes&&(o.attributes=o.attributes.filter(c=>{var[u]=this.$t(c.id);return!this.ct.consumeRateLimit(u)&&c}));var l=this.kt(o);return l!==0||a===l?s:void 0},this._rrweb=e,this.rt=n,this.ct=new oO({bucketSize:(i=this.rt.bucketSize)!==null&&i!==void 0?i:100,refillRate:(r=this.rt.refillRate)!==null&&r!==void 0?r:10,refillInterval:1e3,et:this.wt})}};var ts=Uint8Array,rr=Uint16Array,zd=Uint32Array,R_=new ts([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),I_=new ts([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),$P=new ts([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dO=function(t,e){for(var n=new rr(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];var r=new zd(n[30]);for(i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)r[s]=s-n[i]<<5|i;return[n,r]},fO=dO(R_,2),RV=fO[0],oS=fO[1];RV[28]=258,oS[258]=28;for(var FP=dO(I_,0)[1],hO=new rr(32768),en=0;en<32768;++en){var uc=(43690&en)>>>1|(21845&en)<<1;uc=(61680&(uc=(52428&uc)>>>2|(13107&uc)<<2))>>>4|(3855&uc)<<4,hO[en]=((65280&uc)>>>8|(255&uc)<<8)>>>1}var Lh=function(t,e,n){for(var i=t.length,r=0,s=new rr(e);r<i;++r)++s[t[r]-1];var o,a=new rr(e);for(r=0;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;for(o=new rr(i),r=0;r<i;++r)o[r]=hO[a[t[r]-1]++]>>>15-t[r];return o},Vc=new ts(288);for(en=0;en<144;++en)Vc[en]=8;for(en=144;en<256;++en)Vc[en]=9;for(en=256;en<280;++en)Vc[en]=7;for(en=280;en<288;++en)Vc[en]=8;var xv=new ts(32);for(en=0;en<32;++en)xv[en]=5;var IV=Lh(Vc,9),TV=Lh(xv,5),pO=function(t){return(t/8>>0)+(7&t&&1)},mO=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var i=new(t instanceof rr?rr:t instanceof zd?zd:ts)(n-e);return i.set(t.subarray(e,n)),i},Do=function(t,e,n){n<<=7&e;var i=e/8>>0;t[i]|=n,t[i+1]|=n>>>8},Df=function(t,e,n){n<<=7&e;var i=e/8>>0;t[i]|=n,t[i+1]|=n>>>8,t[i+2]|=n>>>16},B1=function(t,e){for(var n=[],i=0;i<t.length;++i)t[i]&&n.push({s:i,f:t[i]});var r=n.length,s=n.slice();if(!r)return[new ts(0),0];if(r==1){var o=new ts(n[0].s+1);return o[n[0].s]=1,[o,1]}n.sort(function(C,E){return C.f-E.f}),n.push({s:-1,f:25001});var a=n[0],l=n[1],c=0,u=1,d=2;for(n[0]={s:-1,f:a.f+l.f,l:a,r:l};u!=r-1;)a=n[n[c].f<n[d].f?c++:d++],l=n[c!=u&&n[c].f<n[d].f?c++:d++],n[u++]={s:-1,f:a.f+l.f,l:a,r:l};var f=s[0].s;for(i=1;i<r;++i)s[i].s>f&&(f=s[i].s);var p=new rr(f+1),m=aS(n[u-1],p,0);if(m>e){i=0;var g=0,y=m-e,v=1<<y;for(s.sort(function(C,E){return p[E.s]-p[C.s]||C.f-E.f});i<r;++i){var b=s[i].s;if(!(p[b]>e))break;g+=v-(1<<m-p[b]),p[b]=e}for(g>>>=y;g>0;){var w=s[i].s;p[w]<e?g-=1<<e-p[w]++-1:++i}for(;i>=0&&g;--i){var k=s[i].s;p[k]==e&&(--p[k],++g)}m=e}return[new ts(p),m]},aS=function(t,e,n){return t.s==-1?Math.max(aS(t.l,e,n+1),aS(t.r,e,n+1)):e[t.s]=n},zP=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new rr(++e),i=0,r=t[0],s=1,o=function(l){n[i++]=l},a=1;a<=e;++a)if(t[a]==r&&a!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(r),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(r);s=1,r=t[a]}return[n.subarray(0,i),e]},jf=function(t,e){for(var n=0,i=0;i<e.length;++i)n+=t[i]*e[i];return n},lS=function(t,e,n){var i=n.length,r=pO(e+2);t[r]=255&i,t[r+1]=i>>>8,t[r+2]=255^t[r],t[r+3]=255^t[r+1];for(var s=0;s<i;++s)t[r+s+4]=n[s];return 8*(r+4+i)},UP=function(t,e,n,i,r,s,o,a,l,c,u){Do(e,u++,n),++r[256];for(var d=B1(r,15),f=d[0],p=d[1],m=B1(s,15),g=m[0],y=m[1],v=zP(f),b=v[0],w=v[1],k=zP(g),C=k[0],E=k[1],_=new rr(19),A=0;A<b.length;++A)_[31&b[A]]++;for(A=0;A<C.length;++A)_[31&C[A]]++;for(var R=B1(_,7),L=R[0],O=R[1],I=19;I>4&&!L[$P[I-1]];--I);var G,B,K,J,ne=c+5<<3,V=jf(r,Vc)+jf(s,xv)+o,U=jf(r,f)+jf(s,g)+o+14+3*I+jf(_,L)+(2*_[16]+3*_[17]+7*_[18]);if(ne<=V&&ne<=U)return lS(e,u,t.subarray(l,l+c));if(Do(e,u,1+(U<V)),u+=2,U<V){G=Lh(f,p),B=f,K=Lh(g,y),J=g;var se=Lh(L,O);for(Do(e,u,w-257),Do(e,u+5,E-1),Do(e,u+10,I-4),u+=14,A=0;A<I;++A)Do(e,u+3*A,L[$P[A]]);u+=3*I;for(var _e=[b,C],Q=0;Q<2;++Q){var ae=_e[Q];for(A=0;A<ae.length;++A){var z=31&ae[A];Do(e,u,se[z]),u+=L[z],z>15&&(Do(e,u,ae[A]>>>5&127),u+=ae[A]>>>12)}}}else G=IV,B=Vc,K=TV,J=xv;for(A=0;A<a;++A)if(i[A]>255){z=i[A]>>>18&31,Df(e,u,G[z+257]),u+=B[z+257],z>7&&(Do(e,u,i[A]>>>23&31),u+=R_[z]);var $=31&i[A];Df(e,u,K[$]),u+=J[$],$>3&&(Df(e,u,i[A]>>>5&8191),u+=I_[$])}else Df(e,u,G[i[A]]),u+=B[i[A]];return Df(e,u,G[256]),u+B[256]},OV=new zd([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),LV=function(){for(var t=new zd(256),e=0;e<256;++e){for(var n=e,i=9;--i;)n=(1&n&&3988292384)^n>>>1;t[e]=n}return t}(),DV=function(){var t=4294967295;return{p:function(e){for(var n=t,i=0;i<e.length;++i)n=LV[255&n^e[i]]^n>>>8;t=n},d:function(){return 4294967295^t}}},jV=function(t,e,n,i,r){return function(s,o,a,l,c,u){var d=s.length,f=new ts(l+d+5*(1+Math.floor(d/7e3))+c),p=f.subarray(l,f.length-c),m=0;if(!o||d<8)for(var g=0;g<=d;g+=65535){var y=g+65535;y<d?m=lS(p,m,s.subarray(g,y)):(p[g]=u,m=lS(p,m,s.subarray(g,d)))}else{for(var v=OV[o-1],b=v>>>13,w=8191&v,k=(1<<a)-1,C=new rr(32768),E=new rr(k+1),_=Math.ceil(a/3),A=2*_,R=function(Xe){return(s[Xe]^s[Xe+1]<<_^s[Xe+2]<<A)&k},L=new zd(25e3),O=new rr(288),I=new rr(32),G=0,B=0,K=(g=0,0),J=0,ne=0;g<d;++g){var V=R(g),U=32767&g,se=E[V];if(C[U]=se,E[V]=U,J<=g){var _e=d-g;if((G>7e3||K>24576)&&_e>423){m=UP(s,p,0,L,O,I,B,K,ne,g-ne,m),K=G=B=0,ne=g;for(var Q=0;Q<286;++Q)O[Q]=0;for(Q=0;Q<30;++Q)I[Q]=0}var ae=2,z=0,$=w,W=U-se&32767;if(_e>2&&V==R(g-W))for(var S=Math.min(b,_e)-1,T=Math.min(32767,g),j=Math.min(258,_e);W<=T&&--$&&U!=se;){if(s[g+ae]==s[g+ae-W]){for(var D=0;D<j&&s[g+D]==s[g+D-W];++D);if(D>ae){if(ae=D,z=W,D>S)break;var Y=Math.min(W,D-2),q=0;for(Q=0;Q<Y;++Q){var oe=g-W+Q+32768&32767,ee=oe-C[oe]+32768&32767;ee>q&&(q=ee,se=oe)}}}W+=(U=se)-(se=C[U])+32768&32767}if(z){L[K++]=268435456|oS[ae]<<18|FP[z];var Oe=31&oS[ae],We=31&FP[z];B+=R_[Oe]+I_[We],++O[257+Oe],++I[We],J=g+ae,++G}else L[K++]=s[g],++O[s[g]]}}m=UP(s,p,u,L,O,I,B,K,ne,g-ne,m)}return mO(f,0,l+pO(m)+c)}(t,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,n,i,!0)},cS=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},BV=function(t,e){var n=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:e.level==9?2:0,t[9]=3,e.mtime!=0&&cS(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),n){t[3]=8;for(var i=0;i<=n.length;++i)t[i+10]=n.charCodeAt(i)}},$V=function(t){return 10+(t.filename&&t.filename.length+1||0)};function gO(t,e){e===void 0&&(e={});var n=DV(),i=t.length;n.p(t);var r=jV(t,e,$V(e),8),s=r.length;return BV(r,e),cS(r,s-8,n.d()),cS(r,s-4,i),r}function vO(t,e){var n=t.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(t);for(var i=new ts(t.length+(t.length>>>1)),r=0,s=function(c){i[r++]=c},o=0;o<n;++o){if(r+5>i.length){var a=new ts(r+8+(n-o<<1));a.set(i),i=a}var l=t.charCodeAt(o);l<128||e?s(l):l<2048?(s(192|l>>>6),s(128|63&l)):l>55295&&l<57344?(s(240|(l=65536+(1047552&l)|1023&t.charCodeAt(++o))>>>18),s(128|l>>>12&63),s(128|l>>>6&63),s(128|63&l)):(s(224|l>>>12),s(128|l>>>6&63),s(128|63&l))}return mO(i,0,r)}function FV(t,e){return function(n){for(var i=0,r=0;r<n.length;r++)i=(i<<5)-i+n.charCodeAt(r),i|=0;return Math.abs(i)}(t)%100<kr(100*e,0,100)}var Nl="disabled",T_="sampled",wv="active",Hc="buffering",O_="paused",L_="trigger",wo=L_+"_activated",wi=L_+"_pending",Po=L_+"_"+Nl;function VP(t,e){return e.some(n=>n.matching==="regex"&&new RegExp(n.url).test(t))}class yO{constructor(e){this.xt=e}triggerStatus(e){var n=this.xt.map(i=>i.triggerStatus(e));return n.includes(wo)?wo:n.includes(wi)?wi:Po}stop(){this.xt.forEach(e=>e.stop())}}class bO{constructor(e){this.xt=e}triggerStatus(e){var n=new Set;for(var i of this.xt)n.add(i.triggerStatus(e));switch(n.delete(Po),n.size){case 0:return Po;case 1:return Array.from(n)[0];default:return wi}}stop(){this.xt.forEach(e=>e.stop())}}class zV{triggerStatus(){return wi}stop(){}}class UV{constructor(e){this.Et=[],this.It=[],this.urlBlocked=!1,this._instance=e}onRemoteConfig(e){var n,i;this.Et=((n=e.sessionRecording)==null?void 0:n.urlTriggers)||[],this.It=((i=e.sessionRecording)==null?void 0:i.urlBlocklist)||[]}Pt(e){var n;return this.Et.length===0?Po:((n=this._instance)==null?void 0:n.get_property(Gw))===e?wo:wi}triggerStatus(e){var n=this.Pt(e),i=n===wo?wo:n===wi?wi:Po;return this._instance.register_for_session({$sdk_debug_replay_url_trigger_status:i}),i}checkUrlTriggerConditions(e,n,i){if(X!==void 0&&X.location.href){var r=X.location.href,s=this.urlBlocked,o=VP(r,this.It);s&&o||(o&&!s?e():!o&&s&&n(),VP(r,this.Et)&&i("url"))}}stop(){}}class VV{constructor(e){this.linkedFlag=null,this.linkedFlagSeen=!1,this.Rt=()=>{},this._instance=e}triggerStatus(){var e=wi;return It(this.linkedFlag)&&(e=Po),this.linkedFlagSeen&&(e=wo),this._instance.register_for_session({$sdk_debug_replay_linked_flag_trigger_status:e}),e}onRemoteConfig(e,n){var i;if(this.linkedFlag=((i=e.sessionRecording)==null?void 0:i.linkedFlag)||null,!It(this.linkedFlag)&&!this.linkedFlagSeen){var r=wn(this.linkedFlag)?this.linkedFlag:this.linkedFlag.flag,s=wn(this.linkedFlag)?null:this.linkedFlag.variant;this.Rt=this._instance.onFeatureFlags((o,a)=>{var l=!1;if(xn(a)&&r in a){var c=a[r];l=fo(c)?c===!0:s?c===s:!!c}this.linkedFlagSeen=l,l&&n(r,s)})}}stop(){this.Rt()}}let HV=class{constructor(e){this.Tt=[],this._instance=e}onRemoteConfig(e){var n;this.Tt=((n=e.sessionRecording)==null?void 0:n.eventTriggers)||[]}Mt(e){var n;return this.Tt.length===0?Po:((n=this._instance)==null?void 0:n.get_property(qw))===e?wo:wi}triggerStatus(e){var n=this.Mt(e),i=n===wo?wo:n===wi?wi:Po;return this._instance.register_for_session({$sdk_debug_replay_event_trigger_status:i}),i}stop(){}};function WV(t){return t.isRecordingEnabled?Hc:Nl}function GV(t){if(!t.receivedFlags)return Hc;if(!t.isRecordingEnabled)return Nl;if(t.urlTriggerMatching.urlBlocked)return O_;var e=t.isSampled===!0,n=new yO([t.eventTriggerMatching,t.urlTriggerMatching,t.linkedFlagMatching]).triggerStatus(t.sessionId);return e?T_:n===wo?wv:n===wi?Hc:t.isSampled===!1?Nl:wv}function qV(t){if(!t.receivedFlags)return Hc;if(!t.isRecordingEnabled)return Nl;if(t.urlTriggerMatching.urlBlocked)return O_;var e=new bO([t.eventTriggerMatching,t.urlTriggerMatching,t.linkedFlagMatching]).triggerStatus(t.sessionId),n=e!==Po,i=fo(t.isSampled);return n&&e===wi?Hc:n&&e===Po||i&&!t.isSampled?Nl:t.isSampled===!0?T_:wv}var dh="[SessionRecording]",di=qn(dh);function og(){var t;return it==null||(t=it.__PosthogExtensions__)==null||(t=t.rrweb)==null?void 0:t.record}var KV=3e5,XV=[bs.MouseMove,bs.MouseInteraction,bs.Scroll,bs.ViewportResize,bs.Input,bs.TouchMove,bs.MediaInteraction,bs.Drag],HP=t=>({rrwebMethod:t,enqueuedAt:Date.now(),attempt:1});function dc(t){return function(e,n){for(var i="",r=0;r<e.length;){var s=e[r++];i+=String.fromCharCode(s)}return i}(gO(vO(JSON.stringify(t))))}function WP(t){return t.type===$o.Custom&&t.data.tag==="sessionIdle"}class YV{get sessionId(){return this.Ct}get Ft(){return this._instance.config.session_recording.session_idle_threshold_ms||3e5}get started(){return this.Ot}get At(){if(!this._instance.sessionManager)throw new Error(dh+" must be started with a valid sessionManager.");return this._instance.sessionManager}get Dt(){var e,n;return this.Lt.triggerStatus(this.sessionId)===wi?6e4:(e=(n=this._instance.config.session_recording)==null?void 0:n.full_snapshot_interval_millis)!==null&&e!==void 0?e:KV}get jt(){var e=this._instance.get_property(ch);return fo(e)?e:null}get Nt(){var e,n,i=(e=this.C)==null?void 0:e.data[((n=this.C)==null?void 0:n.data.length)-1],{sessionStartTimestamp:r}=this.At.checkAndGetSessionAndWindowId(!0);return i?i.timestamp-r:null}get zt(){var e=!!this._instance.get_property(Ww),n=!this._instance.config.disable_session_recording;return X&&e&&n}get Ut(){var e=!!this._instance.get_property(bP),n=this._instance.config.enable_recording_console_log;return n??e}get qt(){var e,n,i,r,s,o,a=this._instance.config.session_recording.captureCanvas,l=this._instance.get_property(SP),c=(e=(n=a==null?void 0:a.recordCanvas)!==null&&n!==void 0?n:l==null?void 0:l.enabled)!==null&&e!==void 0&&e,u=(i=(r=a==null?void 0:a.canvasFps)!==null&&r!==void 0?r:l==null?void 0:l.fps)!==null&&i!==void 0?i:4,d=(s=(o=a==null?void 0:a.canvasQuality)!==null&&o!==void 0?o:l==null?void 0:l.quality)!==null&&s!==void 0?s:.4;if(typeof d=="string"){var f=parseFloat(d);d=isNaN(f)?.4:f}return{enabled:c,fps:kr(u,0,12,"canvas recording fps",4),quality:kr(d,0,1,"canvas recording quality",.4)}}get Bt(){var e,n,i=this._instance.get_property(xP),r={recordHeaders:(e=this._instance.config.session_recording)==null?void 0:e.recordHeaders,recordBody:(n=this._instance.config.session_recording)==null?void 0:n.recordBody},s=(r==null?void 0:r.recordHeaders)||(i==null?void 0:i.recordHeaders),o=(r==null?void 0:r.recordBody)||(i==null?void 0:i.recordBody),a=xn(this._instance.config.capture_performance)?this._instance.config.capture_performance.network_timing:this._instance.config.capture_performance,l=!!(fo(a)?a:i!=null&&i.capturePerformance);return s||o||l?{recordHeaders:s,recordBody:o,recordPerformance:l}:void 0}get Ht(){var e,n,i,r,s,o,a=this._instance.get_property(wP),l={maskAllInputs:(e=this._instance.config.session_recording)==null?void 0:e.maskAllInputs,maskTextSelector:(n=this._instance.config.session_recording)==null?void 0:n.maskTextSelector,blockSelector:(i=this._instance.config.session_recording)==null?void 0:i.blockSelector},c=(r=l==null?void 0:l.maskAllInputs)!==null&&r!==void 0?r:a==null?void 0:a.maskAllInputs,u=(s=l==null?void 0:l.maskTextSelector)!==null&&s!==void 0?s:a==null?void 0:a.maskTextSelector,d=(o=l==null?void 0:l.blockSelector)!==null&&o!==void 0?o:a==null?void 0:a.blockSelector;return Se(c)&&Se(u)&&Se(d)?void 0:{maskAllInputs:c==null||c,maskTextSelector:u,blockSelector:d}}get Wt(){var e=this._instance.get_property(kP);return yi(e)?e:null}get Gt(){var e=this._instance.get_property(_P);return yi(e)?e:null}get status(){return this.Jt?this.Vt({receivedFlags:this.Jt,isRecordingEnabled:this.zt,isSampled:this.jt,urlTriggerMatching:this.Kt,eventTriggerMatching:this.Yt,linkedFlagMatching:this.Xt,sessionId:this.sessionId}):Hc}constructor(e){if(this.Vt=WV,this.Jt=!1,this.Qt=[],this.Zt="unknown",this.ti=Date.now(),this.Lt=new zV,this.ii=void 0,this.ei=void 0,this.ri=void 0,this.si=void 0,this.ni=void 0,this._forceAllowLocalhostNetworkCapture=!1,this.oi=()=>{this.ai()},this.li=()=>{this.ui("browser offline",{})},this.hi=()=>{this.ui("browser online",{})},this.di=()=>{if(Me!=null&&Me.visibilityState){var r="window "+Me.visibilityState;this.ui(r,{})}},this._instance=e,this.Ot=!1,this.vi="/s/",this.ci=void 0,this.Jt=!1,!this._instance.sessionManager)throw di.error("started without valid sessionManager"),new Error(dh+" started without valid sessionManager. This is a bug.");if(this._instance.config.__preview_experimental_cookieless_mode)throw new Error(dh+" cannot be used with __preview_experimental_cookieless_mode.");this.Xt=new VV(this._instance),this.Kt=new UV(this._instance),this.Yt=new HV(this._instance);var{sessionId:n,windowId:i}=this.At.checkAndGetSessionAndWindowId();this.Ct=n,this.fi=i,this.C=this.pi(),this.Ft>=this.At.sessionTimeoutMs&&di.warn("session_idle_threshold_ms ("+this.Ft+") is greater than the session timeout ("+this.At.sessionTimeoutMs+"). Session will never be detected as idle")}startIfEnabledOrStop(e){this.zt?(this.gi(e),fn(X,"beforeunload",this.oi),fn(X,"offline",this.li),fn(X,"online",this.hi),fn(X,"visibilitychange",this.di),this.mi(),this.bi(),It(this.ii)&&(this.ii=this._instance.on("eventCaptured",n=>{try{if(n.event==="$pageview"){var i=n!=null&&n.properties.$current_url?this.yi(n==null?void 0:n.properties.$current_url):"";if(!i)return;this.ui("$pageview",{href:i})}}catch(r){di.error("Could not add $pageview to rrweb session",r)}})),this.ei||(this.ei=this.At.onSessionId((n,i,r)=>{var s,o;r&&(this.ui("$session_id_change",{sessionId:n,windowId:i,changeReason:r}),(s=this._instance)==null||(s=s.persistence)==null||s.unregister(qw),(o=this._instance)==null||(o=o.persistence)==null||o.unregister(Gw))}))):this.stopRecording()}stopRecording(){var e,n,i,r;this.Ot&&this.ci&&(this.ci(),this.ci=void 0,this.Ot=!1,X==null||X.removeEventListener("beforeunload",this.oi),X==null||X.removeEventListener("offline",this.li),X==null||X.removeEventListener("online",this.hi),X==null||X.removeEventListener("visibilitychange",this.di),this.pi(),clearInterval(this.wi),(e=this.ii)==null||e.call(this),this.ii=void 0,(n=this.ni)==null||n.call(this),this.ni=void 0,(i=this.ei)==null||i.call(this),this.ei=void 0,(r=this.si)==null||r.call(this),this.si=void 0,this.Yt.stop(),this.Kt.stop(),this.Xt.stop(),di.info("stopped"))}Si(){var e;(e=this._instance.persistence)==null||e.unregister(ch)}$i(e){var n,i=this.Ct!==e,r=this.Wt;if(yi(r)){var s=this.jt,o=i||!fo(s),a=o?FV(e,r):s;o&&(a?this.ki(T_):di.warn("Sample rate ("+r+") has determined that this sessionId ("+e+") will not be sent to the server."),this.ui("samplingDecisionMade",{sampleRate:r,isSampled:a})),(n=this._instance.persistence)==null||n.register({[ch]:a})}else this.Si()}onRemoteConfig(e){var n,i,r,s;this.ui("$remote_config_received",e),this.xi(e),(n=e.sessionRecording)!=null&&n.endpoint&&(this.vi=(s=e.sessionRecording)==null?void 0:s.endpoint),this.mi(),((i=e.sessionRecording)==null?void 0:i.triggerMatchType)==="any"?(this.Vt=GV,this.Lt=new yO([this.Yt,this.Kt])):(this.Vt=qV,this.Lt=new bO([this.Yt,this.Kt])),this._instance.register_for_session({$sdk_debug_replay_remote_trigger_matching_config:(r=e.sessionRecording)==null?void 0:r.triggerMatchType}),this.Kt.onRemoteConfig(e),this.Yt.onRemoteConfig(e),this.Xt.onRemoteConfig(e,(o,a)=>{this.ki("linked_flag_matched",{flag:o,variant:a})}),this.Jt=!0,this.startIfEnabledOrStop()}mi(){yi(this.Wt)&&It(this.si)&&(this.si=this.At.onSessionId(e=>{this.$i(e)}))}xi(e){if(this._instance.persistence){var n,i=this._instance.persistence,r=()=>{var s,o,a,l,c,u,d,f,p,m=(s=e.sessionRecording)==null?void 0:s.sampleRate,g=It(m)?null:parseFloat(m);It(g)&&this.Si();var y=(o=e.sessionRecording)==null?void 0:o.minimumDurationMilliseconds;i.register({[Ww]:!!e.sessionRecording,[bP]:(a=e.sessionRecording)==null?void 0:a.consoleLogRecordingEnabled,[xP]:Ae({capturePerformance:e.capturePerformance},(l=e.sessionRecording)==null?void 0:l.networkPayloadCapture),[wP]:(c=e.sessionRecording)==null?void 0:c.masking,[SP]:{enabled:(u=e.sessionRecording)==null?void 0:u.recordCanvas,fps:(d=e.sessionRecording)==null?void 0:d.canvasFps,quality:(f=e.sessionRecording)==null?void 0:f.canvasQuality},[kP]:g,[_P]:Se(y)?null:y,[CP]:(p=e.sessionRecording)==null?void 0:p.scriptConfig})};r(),(n=this.ri)==null||n.call(this),this.ri=this.At.onSessionId(r)}}log(e,n){var i;n===void 0&&(n="log"),(i=this._instance.sessionRecording)==null||i.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:n,trace:[],payload:[JSON.stringify(e)]}},timestamp:Date.now()})}gi(e){if(!Se(Object.assign)&&!Se(Array.from)&&!(this.Ot||this._instance.config.disable_session_recording||this._instance.consent.isOptedOut())){var n;this.Ot=!0,this.At.checkAndGetSessionAndWindowId(),og()?this.Ei():(n=it.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,this.Ii,i=>{if(i)return di.error("could not load recorder",i);this.Ei()}),di.info("starting"),this.status===wv&&this.ki(e||"recording_initialized")}}get Ii(){var e;return((e=this._instance)==null||(e=e.persistence)==null||(e=e.get_property(CP))==null?void 0:e.script)||"recorder"}Pi(e){var n;return e.type===3&&XV.indexOf((n=e.data)==null?void 0:n.source)!==-1}Ri(e){var n=this.Pi(e);n||this.Zt||e.timestamp-this.ti>this.Ft&&(this.Zt=!0,clearInterval(this.wi),this.ui("sessionIdle",{eventTimestamp:e.timestamp,lastActivityTimestamp:this.ti,threshold:this.Ft,bufferLength:this.C.data.length,bufferSize:this.C.size}),this.ai());var i=!1;if(n&&(this.ti=e.timestamp,this.Zt)){var r=this.Zt==="unknown";this.Zt=!1,r||(this.ui("sessionNoLongerIdle",{reason:"user activity",type:e.type}),i=!0)}if(!this.Zt){var{windowId:s,sessionId:o}=this.At.checkAndGetSessionAndWindowId(!n,e.timestamp),a=this.Ct!==o,l=this.fi!==s;this.fi=s,this.Ct=o,a||l?(this.stopRecording(),this.startIfEnabledOrStop("session_id_changed")):i&&this.Ti()}}Mi(e){try{return e.rrwebMethod(),!0}catch(n){return this.Qt.length<10?this.Qt.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}):di.warn("could not emit queued rrweb event.",n,e),!1}}ui(e,n){return this.Mi(HP(()=>og().addCustomEvent(e,n)))}Ci(){return this.Mi(HP(()=>og().takeFullSnapshot()))}Ei(){var e,n,i,r,s={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},o=this._instance.config.session_recording;for(var[a,l]of Object.entries(o||{}))a in s&&(a==="maskInputOptions"?s.maskInputOptions=Ae({password:!0},l):s[a]=l);this.qt&&this.qt.enabled&&(s.recordCanvas=!0,s.sampling={canvas:this.qt.fps},s.dataURLOptions={type:"image/webp",quality:this.qt.quality}),this.Ht&&(s.maskAllInputs=(n=this.Ht.maskAllInputs)===null||n===void 0||n,s.maskTextSelector=(i=this.Ht.maskTextSelector)!==null&&i!==void 0?i:void 0,s.blockSelector=(r=this.Ht.blockSelector)!==null&&r!==void 0?r:void 0);var c=og();if(c){this.Fi=(e=this.Fi)!==null&&e!==void 0?e:new MV(c,{refillRate:this._instance.config.session_recording.__mutationThrottlerRefillRate,bucketSize:this._instance.config.session_recording.__mutationThrottlerBucketSize,onBlockedNode:(d,f)=>{var p="Too many mutations on node '"+d+"'. Rate limiting. This could be due to SVG animations or something similar";di.info(p,{node:f}),this.log(dh+" "+p,"warn")}});var u=this.Oi();this.ci=c(Ae({emit:d=>{this.onRRwebEmit(d)},plugins:u},s)),this.ti=Date.now(),this.Zt=fo(this.Zt)?this.Zt:"unknown",this.ui("$session_options",{sessionRecordingOptions:s,activePlugins:u.map(d=>d==null?void 0:d.name)}),this.ui("$posthog_config",{config:this._instance.config})}else di.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}Ti(){if(this.wi&&clearInterval(this.wi),this.Zt!==!0){var e=this.Dt;e&&(this.wi=setInterval(()=>{this.Ci()},e))}}Oi(){var e,n,i=[],r=(e=it.__PosthogExtensions__)==null||(e=e.rrwebPlugins)==null?void 0:e.getRecordConsolePlugin;r&&this.Ut&&i.push(r());var s=(n=it.__PosthogExtensions__)==null||(n=n.rrwebPlugins)==null?void 0:n.getRecordNetworkPlugin;return this.Bt&&es(s)&&(!K7.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?i.push(s(NV(this._instance.config,this.Bt))):di.info("NetworkCapture not started because we are on localhost.")),i}onRRwebEmit(e){var n;if(this.Ai(),e&&xn(e)){if(e.type===$o.Meta){var i=this.yi(e.data.href);if(this.Di=i,!i)return;e.data.href=i}else this.Li();if(this.Kt.checkUrlTriggerConditions(()=>this.ji(),()=>this.Ni(),f=>this.zi(f)),!this.Kt.urlBlocked||(r=e).type===$o.Custom&&r.data.tag==="recording paused"){var r;e.type===$o.FullSnapshot&&this.Ti(),e.type===$o.FullSnapshot&&this.Jt&&this.Lt.triggerStatus(this.sessionId)===wi&&this.pi();var s=this.Fi?this.Fi.throttleMutations(e):e;if(s){var o=function(f){var p=f;if(p&&xn(p)&&p.type===6&&xn(p.data)&&p.data.plugin==="rrweb/console@1"){p.data.payload.payload.length>10&&(p.data.payload.payload=p.data.payload.payload.slice(0,10),p.data.payload.payload.push("...[truncated]"));for(var m=[],g=0;g<p.data.payload.payload.length;g++)p.data.payload.payload[g]&&p.data.payload.payload[g].length>2e3?m.push(p.data.payload.payload[g].slice(0,2e3)+"...[truncated]"):m.push(p.data.payload.payload[g]);return p.data.payload.payload=m,f}return f}(s);if(this.Ri(o),this.Zt!==!0||WP(o)){if(WP(o)){var a=o.data.payload;if(a){var l=a.lastActivityTimestamp,c=a.threshold;o.timestamp=l+c}}var u=(n=this._instance.config.session_recording.compress_events)===null||n===void 0||n?function(f){if(bv(f)<1024)return f;try{if(f.type===$o.FullSnapshot)return Ae({},f,{data:dc(f.data),cv:"2024-10"});if(f.type===$o.IncrementalSnapshot&&f.data.source===bs.Mutation)return Ae({},f,{cv:"2024-10",data:Ae({},f.data,{texts:dc(f.data.texts),attributes:dc(f.data.attributes),removes:dc(f.data.removes),adds:dc(f.data.adds)})});if(f.type===$o.IncrementalSnapshot&&f.data.source===bs.StyleSheetRule)return Ae({},f,{cv:"2024-10",data:Ae({},f.data,{adds:f.data.adds?dc(f.data.adds):void 0,removes:f.data.removes?dc(f.data.removes):void 0})})}catch(p){di.error("could not compress event - will use uncompressed event",p)}return f}(o):o,d={$snapshot_bytes:bv(u),$snapshot_data:u,$session_id:this.Ct,$window_id:this.fi};this.status!==Nl?this.Ui(d):this.pi()}}}}}Li(){if(!this._instance.config.capture_pageview&&X){var e=this.yi(X.location.href);this.Di!==e&&(this.ui("$url_changed",{href:e}),this.Di=e)}}Ai(){if(this.Qt.length){var e=[...this.Qt];this.Qt=[],e.forEach(n=>{Date.now()-n.enqueuedAt<=2e3&&this.Mi(n)})}}yi(e){var n=this._instance.config.session_recording;if(n.maskNetworkRequestFn){var i,r={url:e};return(i=r=n.maskNetworkRequestFn(r))==null?void 0:i.url}return e}pi(){return this.C={size:0,data:[],sessionId:this.Ct,windowId:this.fi},this.C}ai(){this.qi&&(clearTimeout(this.qi),this.qi=void 0);var e=this.Gt,n=this.Nt,i=yi(n)&&n>=0,r=yi(e)&&i&&n<e;return this.status===Hc||this.status===O_||this.status===Nl||r?(this.qi=setTimeout(()=>{this.ai()},2e3),this.C):(this.C.data.length>0&&iS(this.C).forEach(s=>{this.Bi({$snapshot_bytes:s.size,$snapshot_data:s.data,$session_id:s.sessionId,$window_id:s.windowId,$lib:"web",$lib_version:Uo.LIB_VERSION})}),this.pi())}Ui(e){var n,i=2+(((n=this.C)==null?void 0:n.data.length)||0);!this.Zt&&(this.C.size+e.$snapshot_bytes+i>943718.4||this.C.sessionId!==this.Ct)&&(this.C=this.ai()),this.C.size+=e.$snapshot_bytes,this.C.data.push(e.$snapshot_data),this.qi||this.Zt||(this.qi=setTimeout(()=>{this.ai()},2e3))}Bi(e){this._instance.capture("$snapshot",e,{_url:this._instance.requestRouter.endpointFor("api",this.vi),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}zi(e){var n;this.Lt.triggerStatus(this.sessionId)===wi&&((n=this._instance)==null||(n=n.persistence)==null||n.register({[e==="url"?Gw:qw]:this.Ct}),this.ai(),this.ki(e+"_trigger_matched"))}ji(){this.Kt.urlBlocked||(this.Kt.urlBlocked=!0,clearInterval(this.wi),di.info("recording paused due to URL blocker"),this.ui("recording paused",{reason:"url blocker"}))}Ni(){this.Kt.urlBlocked&&(this.Kt.urlBlocked=!1,this.Ci(),this.Ti(),this.ui("recording resumed",{reason:"left blocked url"}),di.info("recording resumed"))}bi(){this.Yt.Tt.length!==0&&It(this.ni)&&(this.ni=this._instance.on("eventCaptured",e=>{try{this.Yt.Tt.includes(e.event)&&this.zi("event")}catch(n){di.error("Could not activate event trigger",n)}}))}overrideLinkedFlag(){this.Xt.linkedFlagSeen=!0,this.Ci(),this.ki("linked_flag_overridden")}overrideSampling(){var e;(e=this._instance.persistence)==null||e.register({[ch]:!0}),this.Ci(),this.ki("sampling_overridden")}overrideTrigger(e){this.zi(e)}ki(e,n){this._instance.register_for_session({$session_recording_start_reason:e}),di.info(e.replace("_"," "),n),bt(["recording_initialized","session_id_changed"],e)||this.ui(e,n)}get sdkDebugProperties(){var{sessionStartTimestamp:e}=this.At.checkAndGetSessionAndWindowId(!0);return{$recording_status:this.status,$sdk_debug_replay_internal_buffer_length:this.C.data.length,$sdk_debug_replay_internal_buffer_size:this.C.size,$sdk_debug_current_session_duration:this.Nt,$sdk_debug_session_start:e}}}var $1=qn("[SegmentIntegration]");function JV(t,e){var n=t.config.segment;if(!n)return e();(function(i,r){var s=i.config.segment;if(!s)return r();var o=l=>{var c=()=>l.anonymousId()||il();i.config.get_device_id=c,l.id()&&(i.register({distinct_id:l.id(),$device_id:c()}),i.persistence.set_property(Bo,"identified")),r()},a=s.user();"then"in a&&es(a.then)?a.then(l=>o(l)):o(a)})(t,()=>{n.register((i=>{Promise&&Promise.resolve||$1.warn("This browser does not have Promise support, and can not use the segment integration");var r=(s,o)=>{if(!o)return s;s.event.userId||s.event.anonymousId===i.get_distinct_id()||($1.info("No userId set, resetting PostHog"),i.reset()),s.event.userId&&s.event.userId!==i.get_distinct_id()&&($1.info("UserId set, identifying with PostHog"),i.identify(s.event.userId));var a=i.calculateEventProperties(o,s.event.properties);return s.event.properties=Object.assign({},a,s.event.properties),s};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:s=>r(s,s.event.event),page:s=>r(s,"$pageview"),identify:s=>r(s,"$identify"),screen:s=>r(s,"$screen")}})(t)).then(()=>{e()})})}var xO="posthog-js";function wO(t,e){var{organization:n,projectId:i,prefix:r,severityAllowList:s=["error"]}=e===void 0?{}:e;return o=>{var a,l,c,u,d;if(!(s==="*"||s.includes(o.level))||!t.__loaded)return o;o.tags||(o.tags={});var f=t.requestRouter.endpointFor("ui","/project/"+t.config.token+"/person/"+t.get_distinct_id());o.tags["PostHog Person URL"]=f,t.sessionRecordingStarted()&&(o.tags["PostHog Recording URL"]=t.get_session_replay_url({withTimestamp:!0}));var p=((a=o.exception)==null?void 0:a.values)||[],m=p.map(y=>Ae({},y,{stacktrace:y.stacktrace?Ae({},y.stacktrace,{type:"raw",frames:(y.stacktrace.frames||[]).map(v=>Ae({},v,{platform:"web:javascript"}))}):void 0})),g={$exception_message:((l=p[0])==null?void 0:l.value)||o.message,$exception_type:(c=p[0])==null?void 0:c.type,$exception_personURL:f,$exception_level:o.level,$exception_list:m,$sentry_event_id:o.event_id,$sentry_exception:o.exception,$sentry_exception_message:((u=p[0])==null?void 0:u.value)||o.message,$sentry_exception_type:(d=p[0])==null?void 0:d.type,$sentry_tags:o.tags};return n&&i&&(g.$sentry_url=(r||"https://sentry.io/organizations/")+n+"/issues/?project="+i+"&query="+o.event_id),t.exceptions.sendExceptionEvent(g),o}}class ZV{constructor(e,n,i,r,s){this.name=xO,this.setupOnce=function(o){o(wO(e,{organization:n,projectId:i,prefix:r,severityAllowList:s}))}}}var QV=X!=null&&X.location?yv(X.location.hash,"__posthog")||yv(location.hash,"state"):null,GP="_postHogToolbarParams",qP=qn("[Toolbar]"),ja=function(t){return t[t.UNINITIALIZED=0]="UNINITIALIZED",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED",t}(ja||{});class eH{constructor(e){this.instance=e}Hi(e){it.ph_toolbar_state=e}Wi(){var e;return(e=it.ph_toolbar_state)!==null&&e!==void 0?e:ja.UNINITIALIZED}maybeLoadToolbar(e,n,i){if(e===void 0&&(e=void 0),n===void 0&&(n=void 0),i===void 0&&(i=void 0),!X||!Me)return!1;e=e??X.location,i=i??X.history;try{if(!n){try{X.localStorage.setItem("test","test"),X.localStorage.removeItem("test")}catch{return!1}n=X==null?void 0:X.localStorage}var r,s=QV||yv(e.hash,"__posthog")||yv(e.hash,"state"),o=s?pP(()=>JSON.parse(atob(decodeURIComponent(s))))||pP(()=>JSON.parse(decodeURIComponent(s))):null;return o&&o.action==="ph_authorize"?((r=o).source="url",r&&Object.keys(r).length>0&&(o.desiredHash?e.hash=o.desiredHash:i?i.replaceState(i.state,"",e.pathname+e.search):e.hash="")):((r=JSON.parse(n.getItem(GP)||"{}")).source="localstorage",delete r.userIntent),!(!r.token||this.instance.config.token!==r.token)&&(this.loadToolbar(r),!0)}catch{return!1}}Gi(e){var n=it.ph_load_toolbar||it.ph_load_editor;!It(n)&&es(n)?n(e,this.instance):qP.warn("No toolbar load function found")}loadToolbar(e){var n=!(Me==null||!Me.getElementById(G4));if(!X||n)return!1;var i=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,r=Ae({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},i?{instrument:!1}:{});if(X.localStorage.setItem(GP,JSON.stringify(Ae({},r,{source:void 0}))),this.Wi()===ja.LOADED)this.Gi(r);else if(this.Wi()===ja.UNINITIALIZED){var s;this.Hi(ja.LOADING),(s=it.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this.instance,"toolbar",o=>{if(o)return qP.error("[Toolbar] Failed to load",o),void this.Hi(ja.UNINITIALIZED);this.Hi(ja.LOADED),this.Gi(r)}),fn(X,"turbolinks:load",()=>{this.Hi(ja.UNINITIALIZED),this.loadToolbar(r)})}return!0}Ji(e){return this.loadToolbar(e)}maybeLoadEditor(e,n,i){return e===void 0&&(e=void 0),n===void 0&&(n=void 0),i===void 0&&(i=void 0),this.maybeLoadToolbar(e,n,i)}}var tH=qn("[TracingHeaders]");class nH{constructor(e){this.Vi=void 0,this.Ki=void 0,this.nt=()=>{var n,i;Se(this.Vi)&&((n=it.__PosthogExtensions__)==null||(n=n.tracingHeadersPatchFns)==null||n._patchXHR(this._instance.get_distinct_id(),this._instance.sessionManager)),Se(this.Ki)&&((i=it.__PosthogExtensions__)==null||(i=i.tracingHeadersPatchFns)==null||i._patchFetch(this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}J(e){var n,i;(n=it.__PosthogExtensions__)!=null&&n.tracingHeadersPatchFns&&e(),(i=it.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,"tracing-headers",r=>{if(r)return tH.error("failed to load script",r);e()})}startIfEnabledOrStop(){var e,n;this._instance.config.__add_tracing_headers?this.J(this.nt):((e=this.Vi)==null||e.call(this),(n=this.Ki)==null||n.call(this),this.Vi=void 0,this.Ki=void 0)}}var Na=qn("[Web Vitals]"),KP=9e5;class iH{constructor(e){var n;this.Yi=!1,this.i=!1,this.C={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Xi=()=>{clearTimeout(this.Qi),this.C.metrics.length!==0&&(this._instance.capture("$web_vitals",this.C.metrics.reduce((i,r)=>Ae({},i,{["$web_vitals_"+r.name+"_event"]:Ae({},r),["$web_vitals_"+r.name+"_value"]:r.value}),{})),this.C={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.Zi=i=>{var r,s=(r=this._instance.sessionManager)==null?void 0:r.checkAndGetSessionAndWindowId(!0);if(Se(s))Na.error("Could not read session ID. Dropping metrics!");else{this.C=this.C||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var o=this.te();Se(o)||(It(i==null?void 0:i.name)||It(i==null?void 0:i.value)?Na.error("Invalid metric received",i):this.ie&&i.value>=this.ie?Na.error("Ignoring metric with value >= "+this.ie,i):(this.C.url!==o&&(this.Xi(),this.Qi=setTimeout(this.Xi,this.flushToCaptureTimeoutMs)),Se(this.C.url)&&(this.C.url=o),this.C.firstMetricTimestamp=Se(this.C.firstMetricTimestamp)?Date.now():this.C.firstMetricTimestamp,i.attribution&&i.attribution.interactionTargetElement&&(i.attribution.interactionTargetElement=void 0),this.C.metrics.push(Ae({},i,{$current_url:o,$session_id:s.sessionId,$window_id:s.windowId,timestamp:Date.now()})),this.C.metrics.length===this.allowedMetrics.length&&this.Xi()))}},this.nt=()=>{var i,r,s,o,a=it.__PosthogExtensions__;Se(a)||Se(a.postHogWebVitalsCallbacks)||({onLCP:i,onCLS:r,onFCP:s,onINP:o}=a.postHogWebVitalsCallbacks),i&&r&&s&&o?(this.allowedMetrics.indexOf("LCP")>-1&&i(this.Zi.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&r(this.Zi.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&s(this.Zi.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&o(this.Zi.bind(this)),this.i=!0):Na.error("web vitals callbacks not loaded - not starting")},this._instance=e,this.Yi=!((n=this._instance.persistence)==null||!n.props[vP]),this.startIfEnabled()}get allowedMetrics(){var e,n,i=xn(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return Se(i)?((n=this._instance.persistence)==null?void 0:n.props[yP])||["CLS","FCP","INP","LCP"]:i}get flushToCaptureTimeoutMs(){return(xn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get ie(){var e=xn(this._instance.config.capture_performance)&&yi(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:KP;return 0<e&&e<=6e4?KP:e}get isEnabled(){var e=Qi==null?void 0:Qi.protocol;if(e!=="http:"&&e!=="https:")return Na.info("Web Vitals are disabled on non-http/https protocols"),!1;var n=xn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:fo(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return fo(n)?n:this.Yi}startIfEnabled(){this.isEnabled&&!this.i&&(Na.info("enabled, starting..."),this.J(this.nt))}onRemoteConfig(e){var n=xn(e.capturePerformance)&&!!e.capturePerformance.web_vitals,i=xn(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[vP]:n}),this._instance.persistence.register({[yP]:i})),this.Yi=n,this.startIfEnabled()}J(e){var n,i;(n=it.__PosthogExtensions__)!=null&&n.postHogWebVitalsCallbacks&&e(),(i=it.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,"web-vitals",r=>{r?Na.error("failed to load script",r):e()})}te(){var e=X?X.location.href:void 0;return e||Na.error("Could not determine current URL"),e}}var rH=qn("[Heatmaps]");function XP(t){return xn(t)&&"clientX"in t&&"clientY"in t&&yi(t.clientX)&&yi(t.clientY)}class sH{constructor(e){var n;this.rageclicks=new iO,this.Yi=!1,this.i=!1,this.ee=null,this.instance=e,this.Yi=!((n=this.instance.persistence)==null||!n.props[Vw])}get flushIntervalMilliseconds(){var e=5e3;return xn(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return Se(this.instance.config.capture_heatmaps)?Se(this.instance.config.enable_heatmaps)?this.Yi:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.i)return;rH.info("starting..."),this.re(),this.ee=setInterval(this.se.bind(this),this.flushIntervalMilliseconds)}else{var e,n;clearInterval((e=this.ee)!==null&&e!==void 0?e:void 0),(n=this.ne)==null||n.stop(),this.getAndClearBuffer()}}onRemoteConfig(e){var n=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[Vw]:n}),this.Yi=n,this.startIfEnabled()}getAndClearBuffer(){var e=this.C;return this.C=void 0,e}oe(e){this.ae(e.originalEvent,"deadclick")}re(){X&&Me&&(fn(X,"beforeunload",this.se.bind(this)),fn(Me,"click",e=>this.ae(e||(X==null?void 0:X.event)),{capture:!0}),fn(Me,"mousemove",e=>this.le(e||(X==null?void 0:X.event)),{capture:!0}),this.ne=new sO(this.instance,cV,this.oe.bind(this)),this.ne.startIfEnabled(),this.i=!0)}ue(e,n){var i=this.instance.scrollManager.scrollY(),r=this.instance.scrollManager.scrollX(),s=this.instance.scrollManager.scrollElement(),o=function(a,l,c){for(var u=a;u&&ib(u)&&!gl(u,"body");){if(u===c)return!1;if(bt(l,X==null?void 0:X.getComputedStyle(u).position))return!0;u=J4(u)}return!1}(Y4(e),["fixed","sticky"],s);return{x:e.clientX+(o?0:r),y:e.clientY+(o?0:i),target_fixed:o,type:n}}ae(e,n){var i;if(n===void 0&&(n="click"),!EP(e.target)&&XP(e)){var r=this.ue(e,n);(i=this.rageclicks)!=null&&i.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.he(Ae({},r,{type:"rageclick"})),this.he(r)}}le(e){!EP(e.target)&&XP(e)&&(clearTimeout(this.de),this.de=setTimeout(()=>{this.he(this.ue(e,"mousemove"))},500))}he(e){if(X){var n=X.location.href;this.C=this.C||{},this.C[n]||(this.C[n]=[]),this.C[n].push(e)}}se(){this.C&&!Vu(this.C)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class oH{constructor(e){this._instance=e}doPageView(e,n){var i,r=this.ve(e,n);return this.ce={pathname:(i=X==null?void 0:X.location.pathname)!==null&&i!==void 0?i:"",pageViewId:n,timestamp:e},this._instance.scrollManager.resetContext(),r}doPageLeave(e){var n;return this.ve(e,(n=this.ce)==null?void 0:n.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.ce)==null?void 0:e.pageViewId}}ve(e,n){var i=this.ce;if(!i)return{$pageview_id:n};var r={$pageview_id:n,$prev_pageview_id:i.pageViewId},s=this._instance.scrollManager.getContext();if(s&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:o,lastScrollY:a,maxScrollY:l,maxContentHeight:c,lastContentY:u,maxContentY:d}=s;if(!(Se(o)||Se(a)||Se(l)||Se(c)||Se(u)||Se(d))){o=Math.ceil(o),a=Math.ceil(a),l=Math.ceil(l),c=Math.ceil(c),u=Math.ceil(u),d=Math.ceil(d);var f=o<=1?1:kr(a/o,0,1),p=o<=1?1:kr(l/o,0,1),m=c<=1?1:kr(u/c,0,1),g=c<=1?1:kr(d/c,0,1);r=Cn(r,{$prev_pageview_last_scroll:a,$prev_pageview_last_scroll_percentage:f,$prev_pageview_max_scroll:l,$prev_pageview_max_scroll_percentage:p,$prev_pageview_last_content:u,$prev_pageview_last_content_percentage:m,$prev_pageview_max_content:d,$prev_pageview_max_content_percentage:g})}}return i.pathname&&(r.$prev_pageview_pathname=i.pathname),i.timestamp&&(r.$prev_pageview_duration=(e.getTime()-i.timestamp.getTime())/1e3),r}}var aH=function(t){var e,n,i,r,s="";for(e=n=0,i=(t=(t+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,r=0;r<i;r++){var o=t.charCodeAt(r),a=null;o<128?n++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),Kl(a)||(n>e&&(s+=t.substring(e,n)),s+=a,e=n=r+1)}return n>e&&(s+=t.substring(e,t.length)),s},lH=!!Fw||!!$w,YP="text/plain",Sv=(t,e)=>{var[n,i]=t.split("?"),r=Ae({},e);i==null||i.split("&").forEach(o=>{var[a]=o.split("=");delete r[a]});var s=X7(r);return n+"?"+(s=s?(i?i+"&":"")+s:i)},fh=(t,e)=>JSON.stringify(t,(n,i)=>typeof i=="bigint"?i.toString():i,e),F1=t=>{var{data:e,compression:n}=t;if(e){if(n===ta.GZipJS){var i=gO(vO(fh(e)),{mtime:0}),r=new Blob([i],{type:YP});return{contentType:YP,body:r,estimatedSize:r.size}}if(n===ta.Base64){var s=function(l){var c,u,d,f,p,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g=0,y=0,v="",b=[];if(!l)return l;l=aH(l);do c=(p=l.charCodeAt(g++)<<16|l.charCodeAt(g++)<<8|l.charCodeAt(g++))>>18&63,u=p>>12&63,d=p>>6&63,f=63&p,b[y++]=m.charAt(c)+m.charAt(u)+m.charAt(d)+m.charAt(f);while(g<l.length);switch(v=b.join(""),l.length%3){case 1:v=v.slice(0,-2)+"==";break;case 2:v=v.slice(0,-1)+"="}return v}(fh(e)),o=(l=>"data="+encodeURIComponent(typeof l=="string"?l:fh(l)))(s);return{contentType:"application/x-www-form-urlencoded",body:o,estimatedSize:new Blob([o]).size}}var a=fh(e);return{contentType:"application/json",body:a,estimatedSize:new Blob([a]).size}}},Dh=[];$w&&Dh.push({transport:"fetch",method:t=>{var e,n,{contentType:i,body:r,estimatedSize:s}=(e=F1(t))!==null&&e!==void 0?e:{},o=new Headers;Ft(t.headers,function(u,d){o.append(d,u)}),i&&o.append("Content-Type",i);var a=t.url,l=null;if(fP){var c=new fP;l={signal:c.signal,timeout:setTimeout(()=>c.abort(),t.timeout)}}$w(a,Ae({method:(t==null?void 0:t.method)||"GET",headers:o,keepalive:t.method==="POST"&&(s||0)<52428.8,body:r,signal:(n=l)==null?void 0:n.signal},t.fetchOptions)).then(u=>u.text().then(d=>{var f={statusCode:u.status,text:d};if(u.status===200)try{f.json=JSON.parse(d)}catch(p){Ie.error(p)}t.callback==null||t.callback(f)})).catch(u=>{Ie.error(u),t.callback==null||t.callback({statusCode:0,text:u})}).finally(()=>l?clearTimeout(l.timeout):null)}}),Fw&&Dh.push({transport:"XHR",method:t=>{var e,n=new Fw;n.open(t.method||"GET",t.url,!0);var{contentType:i,body:r}=(e=F1(t))!==null&&e!==void 0?e:{};Ft(t.headers,function(s,o){n.setRequestHeader(o,s)}),i&&n.setRequestHeader("Content-Type",i),t.timeout&&(n.timeout=t.timeout),n.withCredentials=!0,n.onreadystatechange=()=>{if(n.readyState===4){var s={statusCode:n.status,text:n.responseText};if(n.status===200)try{s.json=JSON.parse(n.responseText)}catch{}t.callback==null||t.callback(s)}},n.send(r)}}),Sr!=null&&Sr.sendBeacon&&Dh.push({transport:"sendBeacon",method:t=>{var e=Sv(t.url,{beacon:"1"});try{var n,{contentType:i,body:r}=(n=F1(t))!==null&&n!==void 0?n:{},s=typeof r=="string"?new Blob([r],{type:i}):r;Sr.sendBeacon(e,s)}catch{}}});var Ud=function(t,e){if(!function(n){try{new RegExp(n)}catch{return!1}return!0}(e))return!1;try{return new RegExp(e).test(t)}catch{return!1}};function JP(t,e,n){return fh({distinct_id:t,userPropertiesToSet:e,userPropertiesToSetOnce:n})}var cH={exact:(t,e)=>e.some(n=>t.some(i=>n===i)),is_not:(t,e)=>e.every(n=>t.every(i=>n!==i)),regex:(t,e)=>e.some(n=>t.some(i=>Ud(n,i))),not_regex:(t,e)=>e.every(n=>t.every(i=>!Ud(n,i))),icontains:(t,e)=>e.map(ag).some(n=>t.map(ag).some(i=>n.includes(i))),not_icontains:(t,e)=>e.map(ag).every(n=>t.map(ag).every(i=>!n.includes(i)))},ag=t=>t.toLowerCase(),uH=qn("[Error tracking]");class dH{constructor(e){var n,i;this.fe=[],this._instance=e,this.fe=(n=(i=this._instance.persistence)==null?void 0:i.get_property(Hw))!==null&&n!==void 0?n:[]}onRemoteConfig(e){var n,i,r=(n=(i=e.errorTracking)==null?void 0:i.suppressionRules)!==null&&n!==void 0?n:[];this.fe=r,this._instance.persistence&&this._instance.persistence.register({[Hw]:this.fe})}sendExceptionEvent(e){this.pe(e)?uH.info("Skipping exception capture because a suppression rule matched"):this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}pe(e){var n=e.$exception_list;if(!n||!an(n)||n.length===0)return!1;var i=n.reduce((r,s)=>{var{type:o,value:a}=s;return wn(o)&&o.length>0&&r.$exception_types.push(o),wn(a)&&a.length>0&&r.$exception_values.push(a),r},{$exception_types:[],$exception_values:[]});return this.fe.some(r=>{var s=r.values.map(o=>{var a,l=cH[o.operator],c=an(o.value)?o.value:[o.value],u=(a=i[o.key])!==null&&a!==void 0?a:[];return c.length>0&&l(c,u)});return r.type==="OR"?s.some(Boolean):s.every(Boolean)})}}var ns="Mobile",kv="iOS",ho="Android",cp="Tablet",SO=ho+" "+cp,kO="iPad",_O="Apple",CO=_O+" Watch",up="Safari",Vd="BlackBerry",EO="Samsung",AO=EO+"Browser",PO=EO+" Internet",Wc="Chrome",fH=Wc+" OS",NO=Wc+" "+kv,D_="Internet Explorer",MO=D_+" "+ns,j_="Opera",hH=j_+" Mini",B_="Edge",RO="Microsoft "+B_,dd="Firefox",IO=dd+" "+kv,dp="Nintendo",fp="PlayStation",fd="Xbox",TO=ho+" "+ns,OO=ns+" "+up,hh="Windows",uS=hh+" Phone",ZP="Nokia",dS="Ouya",LO="Generic",pH=LO+" "+ns.toLowerCase(),DO=LO+" "+cp.toLowerCase(),fS="Konqueror",_i="(\\d+(\\.\\d+)?)",z1=new RegExp("Version/"+_i),mH=new RegExp(fd,"i"),gH=new RegExp(fp+" \\w+","i"),vH=new RegExp(dp+" \\w+","i"),$_=new RegExp(Vd+"|PlayBook|BB10","i"),yH={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},bH=(t,e)=>e&&bt(e,_O)||function(n){return bt(n,up)&&!bt(n,Wc)&&!bt(n,ho)}(t),jO=function(t,e){return e=e||"",bt(t," OPR/")&&bt(t,"Mini")?hH:bt(t," OPR/")?j_:$_.test(t)?Vd:bt(t,"IE"+ns)||bt(t,"WPDesktop")?MO:bt(t,AO)?PO:bt(t,B_)||bt(t,"Edg/")?RO:bt(t,"FBIOS")?"Facebook "+ns:bt(t,"UCWEB")||bt(t,"UCBrowser")?"UC Browser":bt(t,"CriOS")?NO:bt(t,"CrMo")||bt(t,Wc)?Wc:bt(t,ho)&&bt(t,up)?TO:bt(t,"FxiOS")?IO:bt(t.toLowerCase(),fS.toLowerCase())?fS:bH(t,e)?bt(t,ns)?OO:up:bt(t,dd)?dd:bt(t,"MSIE")||bt(t,"Trident/")?D_:bt(t,"Gecko")?dd:""},xH={[MO]:[new RegExp("rv:"+_i)],[RO]:[new RegExp(B_+"?\\/"+_i)],[Wc]:[new RegExp("("+Wc+"|CrMo)\\/"+_i)],[NO]:[new RegExp("CriOS\\/"+_i)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+_i)],[up]:[z1],[OO]:[z1],[j_]:[new RegExp("(Opera|OPR)\\/"+_i)],[dd]:[new RegExp(dd+"\\/"+_i)],[IO]:[new RegExp("FxiOS\\/"+_i)],[fS]:[new RegExp("Konqueror[:/]?"+_i,"i")],[Vd]:[new RegExp(Vd+" "+_i),z1],[TO]:[new RegExp("android\\s"+_i,"i")],[PO]:[new RegExp(AO+"\\/"+_i)],[D_]:[new RegExp("(rv:|MSIE )"+_i)],Mozilla:[new RegExp("rv:"+_i)]},wH=function(t,e){var n=jO(t,e),i=xH[n];if(Se(i))return null;for(var r=0;r<i.length;r++){var s=i[r],o=t.match(s);if(o)return parseFloat(o[o.length-2])}return null},QP=[[new RegExp(fd+"; "+fd+" (.*?)[);]","i"),t=>[fd,t&&t[1]||""]],[new RegExp(dp,"i"),[dp,""]],[new RegExp(fp,"i"),[fp,""]],[$_,[Vd,""]],[new RegExp(hh,"i"),(t,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[uS,""];if(new RegExp(ns).test(e)&&!/IEMobile\b/.test(e))return[hh+" "+ns,""];var n=/Windows NT ([0-9.]+)/i.exec(e);if(n&&n[1]){var i=n[1],r=yH[i]||"";return/arm/i.test(e)&&(r="RT"),[hh,r]}return[hh,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,t=>{if(t&&t[3]){var e=[t[3],t[4],t[5]||"0"];return[kv,e.join(".")]}return[kv,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,t=>{var e="";return t&&t.length>=3&&(e=Se(t[2])?t[3]:t[2]),["watchOS",e]}],[new RegExp("("+ho+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+ho+")","i"),t=>{if(t&&t[2]){var e=[t[2],t[3],t[4]||"0"];return[ho,e.join(".")]}return[ho,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,t=>{var e=["Mac OS X",""];if(t&&t[1]){var n=[t[1],t[2],t[3]||"0"];e[1]=n.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[fH,""]],[/Linux|debian/i,["Linux",""]]],eN=function(t){return vH.test(t)?dp:gH.test(t)?fp:mH.test(t)?fd:new RegExp(dS,"i").test(t)?dS:new RegExp("("+uS+"|WPDesktop)","i").test(t)?uS:/iPad/.test(t)?kO:/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(t)?CO:$_.test(t)?Vd:/(kobo)\s(ereader|touch)/i.test(t)?"Kobo":new RegExp(ZP,"i").test(t)?ZP:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(t)||/(kf[a-z]+)( bui|\)).+silk\//i.test(t)?"Kindle Fire":/(Android|ZTE)/i.test(t)?!new RegExp(ns).test(t)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(t)?/pixel[\daxl ]{1,6}/i.test(t)&&!/pixel c/i.test(t)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(t)||/lmy47v/i.test(t)&&!/QTAQZ3/i.test(t)?ho:SO:ho:new RegExp("(pda|"+ns+")","i").test(t)?pH:new RegExp(cp,"i").test(t)&&!new RegExp(cp+" pc","i").test(t)?DO:""},lg="https?://(.*)",sb=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],SH=nb(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],sb),F_="<masked>",kH=["li_fat_id"];function BO(t,e,n){if(!Me)return{};var i,r=e?nb([],sb,n||[]):[],s=$O(N_(Me.URL,r,F_),t),o=(i={},Ft(kH,function(a){var l=xo.D(a);i[a]=l||null}),i);return Cn(o,s)}function $O(t,e){var n=SH.concat(e||[]),i={};return Ft(n,function(r){var s=vv(t,r);i[r]=s||null}),i}function FO(t){var e=function(s){return s?s.search(lg+"google.([^/?]*)")===0?"google":s.search(lg+"bing.com")===0?"bing":s.search(lg+"yahoo.com")===0?"yahoo":s.search(lg+"duckduckgo.com")===0?"duckduckgo":null:null}(t),n=e!="yahoo"?"q":"p",i={};if(!Kl(e)){i.$search_engine=e;var r=Me?vv(Me.referrer,n):"";r.length&&(i.ph_keyword=r)}return i}function tN(){return navigator.language||navigator.userLanguage}function zO(){return(Me==null?void 0:Me.referrer)||"$direct"}function UO(t,e){var n=t?nb([],sb,e||[]):[],i=Qi==null?void 0:Qi.href.substring(0,1e3);return{r:zO().substring(0,1e3),u:i?N_(i,n,F_):void 0}}function VO(t){var e,{r:n,u:i}=t,r={$referrer:n,$referring_domain:n==null?void 0:n=="$direct"?"$direct":(e=Fd(n))==null?void 0:e.host};if(i){r.$current_url=i;var s=Fd(i);r.$host=s==null?void 0:s.host,r.$pathname=s==null?void 0:s.pathname;var o=$O(i);Cn(r,o)}if(n){var a=FO(n);Cn(r,a)}return r}function HO(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function _H(){try{return new Date().getTimezoneOffset()}catch{return}}function CH(t,e){if(!Ji)return{};var n,i,r,s=t?nb([],sb,e||[]):[],[o,a]=function(l){for(var c=0;c<QP.length;c++){var[u,d]=QP[c],f=u.exec(l),p=f&&(es(d)?d(f,l):d);if(p)return p}return["",""]}(Ji);return Cn(A_({$os:o,$os_version:a,$browser:jO(Ji,navigator.vendor),$device:eN(Ji),$device_type:(i=Ji,r=eN(i),r===kO||r===SO||r==="Kobo"||r==="Kindle Fire"||r===DO?cp:r===dp||r===fd||r===fp||r===dS?"Console":r===CO?"Wearable":r?ns:"Desktop"),$timezone:HO(),$timezone_offset:_H()}),{$current_url:N_(Qi==null?void 0:Qi.href,s,F_),$host:Qi==null?void 0:Qi.host,$pathname:Qi==null?void 0:Qi.pathname,$raw_user_agent:Ji.length>1e3?Ji.substring(0,997)+"...":Ji,$browser_version:wH(Ji,navigator.vendor),$browser_language:tN(),$browser_language_prefix:(n=tN(),typeof n=="string"?n.split("-")[0]:void 0),$screen_height:X==null?void 0:X.screen.height,$screen_width:X==null?void 0:X.screen.width,$viewport_height:X==null?void 0:X.innerHeight,$viewport_width:X==null?void 0:X.innerWidth,$lib:"web",$lib_version:Uo.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var Ks=qn("[FeatureFlags]"),U1="$active_feature_flags",yu="$override_feature_flags",nN="$feature_flag_payloads",Bf="$override_feature_flag_payloads",iN="$feature_flag_request_id",rN=t=>{var e={};for(var[n,i]of A0(t||{}))i&&(e[n]=i);return e},EH=t=>{var e=t.flags;return e?(t.featureFlags=Object.fromEntries(Object.keys(e).map(n=>{var i;return[n,(i=e[n].variant)!==null&&i!==void 0?i:e[n].enabled]})),t.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter(n=>e[n].enabled).filter(n=>{var i;return(i=e[n].metadata)==null?void 0:i.payload}).map(n=>{var i;return[n,(i=e[n].metadata)==null?void 0:i.payload]}))):Ks.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),t},AH=function(t){return t.FeatureFlags="feature_flags",t.Recordings="recordings",t}({}),sN=new Set(["7c6f7b45","66c1f69c","2727f65a","f3287528","8cc9a311","eb9f671b","c0e1c6f9","057989ec","723f4019","7b102104","563359d3","bad973ea","f6f2c4f4","59454a61","89ad1076","4edd0da1","26c52e72","a970bd2e","89cf4454","16e2b4e7","fba0e7b6","301c8488","bc65d69e","fe66a3c5","37926ca6","52a196df","d32a7577","42c4c9ef","6883bd5a","04809ff7","e59430a8","61be3dd8","7fa5500b","bf027177","8cfdba9b","96f6df5f","569798e9","0ebc61a5","1b5d7b92","17ebb0a4","f97ea965","85cc817b","3044dfc1","0c3fe5c3","b1f95fa3","8a6342e8","72365c68","12d34ad9","733853ec","3beeb69a","0645bb64","32de7f98","5dcbee21","3fe85053","ad960278","9466e5dd","7ca97b2d","2ee2a65c","28fde5f2","85c52f49","0ad823f4","f11b6cc9","aacf8af9","ab3e62b3","3a85ff15","8a67d3c4","f5e91ef1","4b873698","c5dae949","5b643d76","9599c892","34377448","2189e408","3be9ad53","1a14ce7c","2a164ded","8d53ea86","53bdb37d","bfc3f590","8df38ede","bdb81e49","38fde5c0","8d707e6d","73cbc496","f9d8a5ef","d3a9f8c4","a980d8cd","5bcfe086","e4818f68","4f11fb39","a13c6ae3","150c7fbb","98f3d658","f84f7377","1924dd9c","1f6b63b3","24748755","7c0f717c","8a87f11b","49f57f22","3c9e9234","3772f65b","dff631b6","cd609d40","f853c7f7","952db5ee","c5aa8a79","2d21b6fd","79b7164c","4110e26c","a7d3b43f","84e1b8f6","75cc0998","07f78e33","10ca9b1a","ce441b18","01eb8256","c0ac4b67","8e8e5216","db7943dd","fa133a95","498a4508","21bbda67","7dbfed69","be3ec24c","fc80b8e2"]);class PH{constructor(e){this.ge=!1,this._e=!1,this.me=!1,this.be=!1,this.ye=!1,this.we=!1,this.Se=!1,this._instance=e,this.featureFlagEventHandlers=[]}flags(){if(this._instance.config.__preview_remote_config)this.we=!0;else{var e=!this.$e&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.ke({disableFlags:e})}}get hasLoadedFlags(){return this._e}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(Kw),n=this._instance.get_property(yu),i=this._instance.get_property(Bf);if(!i&&!n)return e||{};var r=Cn({},e||{}),s=[...new Set([...Object.keys(i||{}),...Object.keys(n||{})])];for(var o of s){var a,l,c=r[o],u=n==null?void 0:n[o],d=Se(u)?(a=c==null?void 0:c.enabled)!==null&&a!==void 0&&a:!!u,f=Se(u)?c.variant:typeof u=="string"?u:void 0,p=i==null?void 0:i[o],m=Ae({},c,{enabled:d,variant:d?f??(c==null?void 0:c.variant):void 0});d!==(c==null?void 0:c.enabled)&&(m.original_enabled=c==null?void 0:c.enabled),f!==(c==null?void 0:c.variant)&&(m.original_variant=c==null?void 0:c.variant),p&&(m.metadata=Ae({},c==null?void 0:c.metadata,{payload:p,original_payload:c==null||(l=c.metadata)==null?void 0:l.payload})),r[o]=m}return this.ge||(Ks.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:i,finalDetails:r}),this.ge=!0),r}getFlagVariants(){var e=this._instance.get_property(Hu),n=this._instance.get_property(yu);if(!n)return e||{};for(var i=Cn({},e),r=Object.keys(n),s=0;s<r.length;s++)i[r[s]]=n[r[s]];return this.ge||(Ks.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:n,finalFlags:i}),this.ge=!0),i}getFlagPayloads(){var e=this._instance.get_property(nN),n=this._instance.get_property(Bf);if(!n)return e||{};for(var i=Cn({},e||{}),r=Object.keys(n),s=0;s<r.length;s++)i[r[s]]=n[r[s]];return this.ge||(Ks.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:n,finalPayloads:i}),this.ge=!0),i}reloadFeatureFlags(){this.be||this._instance.config.advanced_disable_feature_flags||this.$e||(this.$e=setTimeout(()=>{this.ke()},5))}xe(){clearTimeout(this.$e),this.$e=void 0}ensureFlagsLoaded(){this._e||this.me||this.$e||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.be=e}ke(e){var n;if(this.xe(),!this._instance.I())if(this.me)this.ye=!0;else{var i={token:this._instance.config.token,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:Ae({},((n=this._instance.persistence)==null?void 0:n.get_initial_props())||{},this._instance.get_property(uh)||{}),group_properties:this._instance.get_property(wc)};(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(i.disable_flags=!0);var r=this._instance.config.__preview_flags_v2&&this._instance.config.__preview_remote_config,s=function(l){var c=function(u){for(var d=2166136261,f=0;f<u.length;f++)d^=u.charCodeAt(f),d+=(d<<1)+(d<<4)+(d<<7)+(d<<8)+(d<<24);return("00000000"+(d>>>0).toString(16)).slice(-8)}(l);return sN==null?void 0:sN.has(c)}(this._instance.config.token)?"/decide?v=4":r?"/flags/?v=2":"/flags/?v=2&config=true",o=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",a=this._instance.requestRouter.endpointFor("api",s+o);r&&(i.timezone=HO()),this.me=!0,this._instance.Ee({method:"POST",url:a,data:i,compression:this._instance.config.disable_compression?void 0:ta.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:l=>{var c,u,d=!0;if(l.statusCode===200&&(this.ye||(this.$anon_distinct_id=void 0),d=!1),this.me=!1,this.we||(this.we=!0,this._instance.Ie((u=l.json)!==null&&u!==void 0?u:{})),!i.disable_flags||this.ye)if(this.Se=!d,l.json&&(c=l.json.quotaLimited)!=null&&c.includes(AH.FeatureFlags))Ks.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var f;i.disable_flags||this.receivedFeatureFlags((f=l.json)!==null&&f!==void 0?f:{},d),this.ye&&(this.ye=!1,this.ke())}}})}}getFeatureFlag(e,n){if(n===void 0&&(n={}),this._e||this.getFlags()&&this.getFlags().length>0){var i=this.getFlagVariants()[e],r=""+i,s=this._instance.get_property(iN)||void 0,o=this._instance.get_property(hv)||{};if((n.send_event||!("send_event"in n))&&(!(e in o)||!o[e].includes(r))){var a,l,c,u,d,f,p,m,g;an(o[e])?o[e].push(r):o[e]=[r],(a=this._instance.persistence)==null||a.register({[hv]:o});var y=this.getFeatureFlagDetails(e),v={$feature_flag:e,$feature_flag_response:i,$feature_flag_payload:this.getFeatureFlagPayload(e)||null,$feature_flag_request_id:s,$feature_flag_bootstrapped_response:((l=this._instance.config.bootstrap)==null||(l=l.featureFlags)==null?void 0:l[e])||null,$feature_flag_bootstrapped_payload:((c=this._instance.config.bootstrap)==null||(c=c.featureFlagPayloads)==null?void 0:c[e])||null,$used_bootstrap_value:!this.Se};Se(y==null||(u=y.metadata)==null?void 0:u.version)||(v.$feature_flag_version=y.metadata.version);var b,w=(d=y==null||(f=y.reason)==null?void 0:f.description)!==null&&d!==void 0?d:y==null||(p=y.reason)==null?void 0:p.code;w&&(v.$feature_flag_reason=w),y!=null&&(m=y.metadata)!=null&&m.id&&(v.$feature_flag_id=y.metadata.id),Se(y==null?void 0:y.original_variant)&&Se(y==null?void 0:y.original_enabled)||(v.$feature_flag_original_response=Se(y.original_variant)?y.original_enabled:y.original_variant),y!=null&&(g=y.metadata)!=null&&g.original_payload&&(v.$feature_flag_original_payload=y==null||(b=y.metadata)==null?void 0:b.original_payload),this._instance.capture("$feature_flag_called",v)}return i}Ks.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){return this.getFlagPayloads()[e]}getRemoteConfigPayload(e,n){var i=this._instance.config.token;this._instance.Ee({method:"POST",url:this._instance.requestRouter.endpointFor("api","/flags/?v=2&config=true"),data:{distinct_id:this._instance.get_distinct_id(),token:i},compression:this._instance.config.disable_compression?void 0:ta.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:r=>{var s,o=(s=r.json)==null?void 0:s.featureFlagPayloads;n((o==null?void 0:o[e])||void 0)}})}isFeatureEnabled(e,n){if(n===void 0&&(n={}),this._e||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(e,n);Ks.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(n=>n!==e)}receivedFeatureFlags(e,n){if(this._instance.persistence){this._e=!0;var i=this.getFlagVariants(),r=this.getFlagPayloads(),s=this.getFlagsWithDetails();(function(o,a,l,c,u){l===void 0&&(l={}),c===void 0&&(c={}),u===void 0&&(u={});var d=EH(o),f=d.flags,p=d.featureFlags,m=d.featureFlagPayloads;if(p){var g=o.requestId;if(an(p)){Ks.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var y={};if(p)for(var v=0;v<p.length;v++)y[p[v]]=!0;a&&a.register({[U1]:p,[Hu]:y})}else{var b=p,w=m,k=f;o.errorsWhileComputingFlags&&(b=Ae({},l,b),w=Ae({},c,w),k=Ae({},u,k)),a&&a.register(Ae({[U1]:Object.keys(rN(b)),[Hu]:b||{},[nN]:w||{},[Kw]:k||{}},g?{[iN]:g}:{}))}}})(e,this._instance.persistence,i,r,s),this.Pe(n)}}override(e,n){n===void 0&&(n=!1),Ks.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:n})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return Ks.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(yu),this._instance.persistence.unregister(Bf),void this.Pe();if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var n,i=e;if(this.ge=!!((n=i.suppressWarning)!==null&&n!==void 0&&n),"flags"in i){if(i.flags===!1)this._instance.persistence.unregister(yu);else if(i.flags)if(an(i.flags)){for(var r={},s=0;s<i.flags.length;s++)r[i.flags[s]]=!0;this._instance.persistence.register({[yu]:r})}else this._instance.persistence.register({[yu]:i.flags})}return"payloads"in i&&(i.payloads===!1?this._instance.persistence.unregister(Bf):i.payloads&&this._instance.persistence.register({[Bf]:i.payloads})),void this.Pe()}this.Pe()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this._e){var{flags:n,flagVariants:i}=this.Re();e(n,i)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,n){var i,r=(this._instance.get_property(P0)||[]).find(l=>l.flagKey===e),s={["$feature_enrollment/"+e]:n},o={$feature_flag:e,$feature_enrollment:n,$set:s};r&&(o.$early_access_feature_name=r.name),this._instance.capture("$feature_enrollment_update",o),this.setPersonPropertiesForFlags(s,!1);var a=Ae({},this.getFlagVariants(),{[e]:n});(i=this._instance.persistence)==null||i.register({[U1]:Object.keys(rN(a)),[Hu]:a}),this.Pe()}getEarlyAccessFeatures(e,n,i){n===void 0&&(n=!1);var r=this._instance.get_property(P0),s=i?"&"+i.map(o=>"stage="+o).join("&"):"";if(r&&!n)return e(r);this._instance.Ee({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+s),method:"GET",callback:o=>{var a;if(o.json){var l=o.json.earlyAccessFeatures;return(a=this._instance.persistence)==null||a.register({[P0]:l}),e(l)}}})}Re(){var e=this.getFlags(),n=this.getFlagVariants();return{flags:e.filter(i=>n[i]),flagVariants:Object.keys(n).filter(i=>n[i]).reduce((i,r)=>(i[r]=n[r],i),{})}}Pe(e){var{flags:n,flagVariants:i}=this.Re();this.featureFlagEventHandlers.forEach(r=>r(n,i,{errorsLoading:e}))}setPersonPropertiesForFlags(e,n){n===void 0&&(n=!0);var i=this._instance.get_property(uh)||{};this._instance.register({[uh]:Ae({},i,e)}),n&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(uh)}setGroupPropertiesForFlags(e,n){n===void 0&&(n=!0);var i=this._instance.get_property(wc)||{};Object.keys(i).length!==0&&Object.keys(i).forEach(r=>{i[r]=Ae({},i[r],e[r]),delete e[r]}),this._instance.register({[wc]:Ae({},i,e)}),n&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var n=this._instance.get_property(wc)||{};this._instance.register({[wc]:Ae({},n,{[e]:{}})})}else this._instance.unregister(wc)}}var NH=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class V1{constructor(e){this.S=e,this.props={},this.Te=!1,this.Me=(n=>{var i="";return n.token&&(i=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+i+"_posthog"})(e),this.B=this.Ce(e),this.load(),e.debug&&Ie.info("Persistence loaded",e.persistence,Ae({},this.props)),this.update_config(e,e),this.save()}Ce(e){NH.indexOf(e.persistence.toLowerCase())===-1&&(Ie.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var n=e.persistence.toLowerCase();return n==="localstorage"&&Dn.O()?Dn:n==="localstorage+cookie"&&eg.O()?eg:n==="sessionstorage"&&Qn.O()?Qn:n==="memory"?aV:n==="cookie"?xo:eg.O()?eg:xo}properties(){var e={};return Ft(this.props,function(n,i){if(i===Hu&&xn(n))for(var r=Object.keys(n),s=0;s<r.length;s++)e["$feature/"+r[s]]=n[r[s]];else a=i,l=!1,(Kl(o=F7)?l:dP&&o.indexOf===dP?o.indexOf(a)!=-1:(Ft(o,function(c){if(l||(l=c===a))return dv}),l))||(e[i]=n);var o,a,l}),e}load(){if(!this.Fe){var e=this.B.L(this.Me);e&&(this.props=Cn({},e))}}save(){this.Fe||this.B.j(this.Me,this.props,this.Oe,this.Ae,this.De,this.S.debug)}remove(){this.B.N(this.Me,!1),this.B.N(this.Me,!0)}clear(){this.remove(),this.props={}}register_once(e,n,i){if(xn(e)){Se(n)&&(n="None"),this.Oe=Se(i)?this.Le:i;var r=!1;if(Ft(e,(s,o)=>{this.props.hasOwnProperty(o)&&this.props[o]!==n||(this.props[o]=s,r=!0)}),r)return this.save(),!0}return!1}register(e,n){if(xn(e)){this.Oe=Se(n)?this.Le:n;var i=!1;if(Ft(e,(r,s)=>{e.hasOwnProperty(s)&&this.props[s]!==r&&(this.props[s]=r,i=!0)}),i)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.Te){var e=BO(this.S.custom_campaign_params,this.S.mask_personal_data_properties,this.S.custom_personal_data_properties);Vu(A_(e))||this.register(e),this.Te=!0}}update_search_keyword(){var e;this.register((e=Me==null?void 0:Me.referrer)?FO(e):{})}update_referrer_info(){var e;this.register_once({$referrer:zO(),$referring_domain:Me!=null&&Me.referrer&&((e=Fd(Me.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[Zw]||this.props[Qw]||this.register_once({[pv]:UO(this.S.mask_personal_data_properties,this.S.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};Ft([Qw,Zw],o=>{var a=this.props[o];a&&Ft(a,function(l,c){e["$initial_"+zw(c)]=l})});var n,i,r=this.props[pv];if(r){var s=(n=VO(r),i={},Ft(n,function(o,a){i["$initial_"+zw(a)]=o}),i);Cn(e,s)}return e}safe_merge(e){return Ft(this.props,function(n,i){i in e||(e[i]=n)}),e}update_config(e,n){if(this.Le=this.Oe=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==n.persistence){var i=this.Ce(e),r=this.props;this.clear(),this.B=i,this.props=r,this.save()}}set_disabled(e){this.Fe=e,this.Fe?this.remove():this.save()}set_cross_subdomain(e){e!==this.Ae&&(this.Ae=e,this.remove(),this.save())}set_secure(e){e!==this.De&&(this.De=e,this.remove(),this.save())}set_event_timer(e,n){var i=this.props[lh]||{};i[e]=n,this.props[lh]=i,this.save()}remove_event_timer(e){var n=(this.props[lh]||{})[e];return Se(n)||(delete this.props[lh][e],this.save()),n}get_property(e){return this.props[e]}set_property(e,n){this.props[e]=n,this.save()}}class WO{constructor(){this.je={},this.je={}}on(e,n){return this.je[e]||(this.je[e]=[]),this.je[e].push(n),()=>{this.je[e]=this.je[e].filter(i=>i!==n)}}emit(e,n){for(var i of this.je[e]||[])i(n);for(var r of this.je["*"]||[])r(e,n)}}class Ec{constructor(e){this.Ne=new WO,this.ze=(n,i)=>this.Ue(n,i)&&this.qe(n,i)&&this.Be(n,i),this.Ue=(n,i)=>i==null||!i.event||(n==null?void 0:n.event)===(i==null?void 0:i.event),this._instance=e,this.He=new Set,this.We=new Set}init(){var e;if(!Se((e=this._instance)==null?void 0:e.Ge)){var n;(n=this._instance)==null||n.Ge((i,r)=>{this.on(i,r)})}}register(e){var n,i;if(!Se((n=this._instance)==null?void 0:n.Ge)&&(e.forEach(o=>{var a,l;(a=this.We)==null||a.add(o),(l=o.steps)==null||l.forEach(c=>{var u;(u=this.He)==null||u.add((c==null?void 0:c.event)||"")})}),(i=this._instance)!=null&&i.autocapture)){var r,s=new Set;e.forEach(o=>{var a;(a=o.steps)==null||a.forEach(l=>{l!=null&&l.selector&&s.add(l==null?void 0:l.selector)})}),(r=this._instance)==null||r.autocapture.setElementSelectors(s)}}on(e,n){var i;n!=null&&e.length!=0&&(this.He.has(e)||this.He.has(n==null?void 0:n.event))&&this.We&&((i=this.We)==null?void 0:i.size)>0&&this.We.forEach(r=>{this.Je(n,r)&&this.Ne.emit("actionCaptured",r.name)})}Ve(e){this.onAction("actionCaptured",n=>e(n))}Je(e,n){if((n==null?void 0:n.steps)==null)return!1;for(var i of n.steps)if(this.ze(e,i))return!0;return!1}onAction(e,n){return this.Ne.on(e,n)}qe(e,n){if(n!=null&&n.url){var i,r=e==null||(i=e.properties)==null?void 0:i.$current_url;if(!r||typeof r!="string"||!Ec.Ke(r,n==null?void 0:n.url,(n==null?void 0:n.url_matching)||"contains"))return!1}return!0}static Ke(e,n,i){switch(i){case"regex":return!!X&&Ud(e,n);case"exact":return n===e;case"contains":var r=Ec.Ye(n).replace(/_/g,".").replace(/%/g,".*");return Ud(e,r);default:return!1}}static Ye(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}Be(e,n){if((n!=null&&n.href||n!=null&&n.tag_name||n!=null&&n.text)&&!this.Xe(e).some(s=>!(n!=null&&n.href&&!Ec.Ke(s.href||"",n==null?void 0:n.href,(n==null?void 0:n.href_matching)||"exact"))&&(n==null||!n.tag_name||s.tag_name===(n==null?void 0:n.tag_name))&&!(n!=null&&n.text&&!Ec.Ke(s.text||"",n==null?void 0:n.text,(n==null?void 0:n.text_matching)||"exact")&&!Ec.Ke(s.$el_text||"",n==null?void 0:n.text,(n==null?void 0:n.text_matching)||"exact"))))return!1;if(n!=null&&n.selector){var i,r=e==null||(i=e.properties)==null?void 0:i.$element_selectors;if(!r||!r.includes(n==null?void 0:n.selector))return!1}return!0}Xe(e){return(e==null?void 0:e.properties.$elements)==null?[]:e==null?void 0:e.properties.$elements}}var Vn=qn("[Surveys]"),hS="seenSurvey_",MH=(t,e)=>{var n="$survey_"+e+"/"+t.id;return t.current_iteration&&t.current_iteration>0&&(n="$survey_"+e+"/"+t.id+"/"+t.current_iteration),n};class RH{constructor(e){this._instance=e,this.Qe=new Map,this.Ze=new Map}register(e){var n;Se((n=this._instance)==null?void 0:n.Ge)||(this.tr(e),this.ir(e))}ir(e){var n=e.filter(i=>{var r,s;return((r=i.conditions)==null?void 0:r.actions)&&((s=i.conditions)==null||(s=s.actions)==null||(s=s.values)==null?void 0:s.length)>0});n.length!==0&&(this.er==null&&(this.er=new Ec(this._instance),this.er.init(),this.er.Ve(i=>{this.onAction(i)})),n.forEach(i=>{var r,s,o,a,l;i.conditions&&(r=i.conditions)!=null&&r.actions&&(s=i.conditions)!=null&&(s=s.actions)!=null&&s.values&&((o=i.conditions)==null||(o=o.actions)==null||(o=o.values)==null?void 0:o.length)>0&&((a=this.er)==null||a.register(i.conditions.actions.values),(l=i.conditions)==null||(l=l.actions)==null||(l=l.values)==null||l.forEach(c=>{if(c&&c.name){var u=this.Ze.get(c.name);u&&u.push(i.id),this.Ze.set(c.name,u||[i.id])}}))}))}tr(e){var n;e.filter(i=>{var r,s;return((r=i.conditions)==null?void 0:r.events)&&((s=i.conditions)==null||(s=s.events)==null||(s=s.values)==null?void 0:s.length)>0}).length!==0&&((n=this._instance)==null||n.Ge((i,r)=>{this.onEvent(i,r)}),e.forEach(i=>{var r;(r=i.conditions)==null||(r=r.events)==null||(r=r.values)==null||r.forEach(s=>{if(s&&s.name){var o=this.Qe.get(s.name);o&&o.push(i.id),this.Qe.set(s.name,o||[i.id])}})}))}onEvent(e,n){var i,r=((i=this._instance)==null||(i=i.persistence)==null?void 0:i.props[Zm])||[];if(e==="survey shown"&&n&&r.length>0){var s;Vn.info("survey event matched, removing survey from activated surveys",{event:e,eventPayload:n,existingActivatedSurveys:r});var o=n==null||(s=n.properties)==null?void 0:s.$survey_id;if(o){var a=r.indexOf(o);a>=0&&(r.splice(a,1),this.rr(r))}}else this.Qe.has(e)&&(Vn.info("survey event matched, updating activated surveys",{event:e,surveys:this.Qe.get(e)}),this.rr(r.concat(this.Qe.get(e)||[])))}onAction(e){var n,i=((n=this._instance)==null||(n=n.persistence)==null?void 0:n.props[Zm])||[];this.Ze.has(e)&&this.rr(i.concat(this.Ze.get(e)||[]))}rr(e){var n;(n=this._instance)==null||(n=n.persistence)==null||n.register({[Zm]:[...new Set(e)]})}getSurveys(){var e,n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[Zm];return n||[]}getEventToSurveys(){return this.Qe}sr(){return this.er}}class IH{constructor(e){this.nr=void 0,this.ar=null,this.lr=!1,this.ur=!1,this.hr=[],this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){var n=e.surveys;if(It(n))return Vn.warn("Flags not loaded yet. Not loading surveys.");var i=an(n);this.nr=i?n.length>0:n,Vn.info("flags response received, isSurveysEnabled: "+this.nr),this.loadIfEnabled()}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],n=0;n<localStorage.length;n++){var i=localStorage.key(n);(i!=null&&i.startsWith(hS)||i!=null&&i.startsWith("inProgressSurvey_"))&&e.push(i)}e.forEach(r=>localStorage.removeItem(r))}loadIfEnabled(){if(!this.ar)if(this.ur)Vn.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)Vn.info("Disabled. Not loading surveys.");else{var e=it==null?void 0:it.__PosthogExtensions__;if(e){var n=this.nr;if(!Se(n)){this.ur=!0;try{var i=e.generateSurveys;if(i)return void this.dr(i,n);var r=e.loadExternalDependency;if(!r)return void this.vr("PostHog loadExternalDependency extension not found.");r(this._instance,"surveys",s=>{s||!e.generateSurveys?this.vr("Could not load surveys script",s):this.dr(e.generateSurveys,n)})}catch(s){throw this.vr("Error initializing surveys",s),s}finally{this.ur=!1}}}else Vn.error("PostHog Extensions not found.")}}dr(e,n){this.ar=e(this._instance,n),this._surveyEventReceiver=new RH(this._instance),Vn.info("Surveys loaded successfully"),this.cr({isLoaded:!0})}vr(e,n){Vn.error(e,n),this.cr({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.hr.push(e),this.ar&&this.cr({isLoaded:!0}),()=>{this.hr=this.hr.filter(n=>n!==e)}}getSurveys(e,n){if(n===void 0&&(n=!1),this._instance.config.disable_surveys)return Vn.info("Disabled. Not loading surveys."),e([]);var i=this._instance.get_property(Xw);if(i&&!n)return e(i,{isLoaded:!0});if(this.lr)return e([],{isLoaded:!1,error:"Surveys are already being loaded"});try{this.lr=!0,this._instance.Ee({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:r=>{var s;this.lr=!1;var o=r.statusCode;if(o!==200||!r.json){var a="Surveys API could not be loaded, status: "+o;return Vn.error(a),e([],{isLoaded:!1,error:a})}var l,c=r.json.surveys||[],u=c.filter(d=>function(f){return!(!f.start_date||f.end_date)}(d)&&(function(f){var p;return!((p=f.conditions)==null||(p=p.events)==null||(p=p.values)==null||!p.length)}(d)||function(f){var p;return!((p=f.conditions)==null||(p=p.actions)==null||(p=p.values)==null||!p.length)}(d)));return u.length>0&&((l=this._surveyEventReceiver)==null||l.register(u)),(s=this._instance.persistence)==null||s.register({[Xw]:c}),e(c,{isLoaded:!0})}})}catch(r){throw this.lr=!1,r}}cr(e){for(var n of this.hr)try{e.isLoaded?this.getSurveys(n):n([],e)}catch(i){Vn.error("Error in survey callback",i)}}getActiveMatchingSurveys(e,n){if(n===void 0&&(n=!1),!It(this.ar))return this.ar.getActiveMatchingSurveys(e,n);Vn.warn("init was not called")}pr(e){var n=null;return this.getSurveys(i=>{var r;n=(r=i.find(s=>s.id===e))!==null&&r!==void 0?r:null}),n}gr(e){if(It(this.ar))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var n=typeof e=="string"?this.pr(e):e;return n?this.ar.checkSurveyEligibility(n):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(It(this.ar))return Vn.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var n=this.gr(e);return{visible:n.eligible,disabledReason:n.reason}}canRenderSurveyAsync(e,n){return It(this.ar)?(Vn.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise(i=>{this.getSurveys(r=>{var s,o=(s=r.find(l=>l.id===e))!==null&&s!==void 0?s:null;if(o){var a=this.gr(o);i({visible:a.eligible,disabledReason:a.reason})}else i({visible:!1,disabledReason:"Survey not found"})},n)})}renderSurvey(e,n){if(It(this.ar))Vn.warn("init was not called");else{var i=this.pr(e),r=Me==null?void 0:Me.querySelector(n);i?r?this.ar.renderSurvey(i,r):Vn.warn("Survey element not found"):Vn.warn("Survey not found")}}}(function(t){return t.Button="button",t.Tab="tab",t.Selector="selector",t})({});(function(t){return t.TopLeft="top_left",t.TopRight="top_right",t.TopCenter="top_center",t.MiddleLeft="middle_left",t.MiddleRight="middle_right",t.MiddleCenter="middle_center",t.Left="left",t.Center="center",t.Right="right",t.NextToTrigger="next_to_trigger",t})({});(function(t){return t.Popover="popover",t.API="api",t.Widget="widget",t})({});(function(t){return t.Open="open",t.MultipleChoice="multiple_choice",t.SingleChoice="single_choice",t.Rating="rating",t.Link="link",t})({});(function(t){return t.NextQuestion="next_question",t.End="end",t.ResponseBased="response_based",t.SpecificQuestion="specific_question",t})({});(function(t){return t.Once="once",t.Recurring="recurring",t.Always="always",t})({});var H1=function(t){return t.SHOWN="survey shown",t.DISMISSED="survey dismissed",t.SENT="survey sent",t}({}),oN=function(t){return t.SURVEY_ID="$survey_id",t.SURVEY_NAME="$survey_name",t.SURVEY_RESPONSE="$survey_response",t.SURVEY_ITERATION="$survey_iteration",t.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",t.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",t.SURVEY_SUBMISSION_ID="$survey_submission_id",t.SURVEY_QUESTIONS="$survey_questions",t.SURVEY_COMPLETED="$survey_completed",t}({}),aN=qn("[RateLimiter]");let TH=class{constructor(e){var n,i;this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=r=>{var s=r.text;if(s&&s.length)try{(JSON.parse(s).quota_limited||[]).forEach(o=>{aN.info((o||"events")+" is quota limited."),this.serverLimits[o]=new Date().getTime()+6e4})}catch(o){return void aN.warn('could not rate limit - continuing. Error: "'+(o==null?void 0:o.message)+'"',{text:s})}},this.instance=e,this.captureEventsPerSecond=((n=e.config.rate_limiting)==null?void 0:n.events_per_second)||10,this.captureEventsBurstLimit=Math.max(((i=e.config.rate_limiting)==null?void 0:i.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(e){var n,i,r;e===void 0&&(e=!1);var s=new Date().getTime(),o=(n=(i=this.instance.persistence)==null?void 0:i.get_property(Jw))!==null&&n!==void 0?n:{tokens:this.captureEventsBurstLimit,last:s};o.tokens+=(s-o.last)/1e3*this.captureEventsPerSecond,o.last=s,o.tokens>this.captureEventsBurstLimit&&(o.tokens=this.captureEventsBurstLimit);var a=o.tokens<1;return a||e||(o.tokens=Math.max(0,o.tokens-1)),!a||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+this.captureEventsPerSecond+" events per second and "+this.captureEventsBurstLimit+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=a,(r=this.instance.persistence)==null||r.set_property(Jw,o),{isRateLimited:a,remainingTokens:o.tokens}}isServerRateLimited(e){var n=this.serverLimits[e||"events"]||!1;return n!==!1&&new Date().getTime()<n}};var fc=qn("[RemoteConfig]");class OH{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=it._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}_r(e){var n,i;(n=it.__PosthogExtensions__)!=null&&n.loadExternalDependency?(i=it.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,"remote-config",()=>e(this.remoteConfig)):(fc.error("PostHog Extensions not found. Cannot load remote config."),e())}mr(e){this._instance.Ee({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:n=>{e(n.json)}})}load(){try{if(this.remoteConfig)return fc.info("Using preloaded remote config",this.remoteConfig),void this.Ie(this.remoteConfig);if(this._instance.I())return void fc.warn("Remote config is disabled. Falling back to local config.");this._r(e=>{if(!e)return fc.info("No config found after loading remote JS config. Falling back to JSON."),void this.mr(n=>{this.Ie(n)});this.Ie(e)})}catch(e){fc.error("Error loading remote config",e)}}Ie(e){e?this._instance.config.__preview_remote_config?(this._instance.Ie(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):fc.info("__preview_remote_config is disabled. Logging config instead",e):fc.error("Failed to fetch remote config from PostHog.")}}var pS=3e3;class LH{constructor(e,n){this.br=!0,this.yr=[],this.wr=kr((n==null?void 0:n.flush_interval_ms)||pS,250,5e3,"flush interval",pS),this.Sr=e}enqueue(e){this.yr.push(e),this.$r||this.kr()}unload(){this.Er();var e=this.yr.length>0?this.Ir():{},n=Object.values(e);[...n.filter(i=>i.url.indexOf("/e")===0),...n.filter(i=>i.url.indexOf("/e")!==0)].map(i=>{this.Sr(Ae({},i,{transport:"sendBeacon"}))})}enable(){this.br=!1,this.kr()}kr(){var e=this;this.br||(this.$r=setTimeout(()=>{if(this.Er(),this.yr.length>0){var n=this.Ir(),i=function(){var s=n[r],o=new Date().getTime();s.data&&an(s.data)&&Ft(s.data,a=>{a.offset=Math.abs(a.timestamp-o),delete a.timestamp}),e.Sr(s)};for(var r in n)i()}},this.wr))}Er(){clearTimeout(this.$r),this.$r=void 0}Ir(){var e={};return Ft(this.yr,n=>{var i,r=n,s=(r?r.batchKey:null)||r.url;Se(e[s])&&(e[s]=Ae({},r,{data:[]})),(i=e[s].data)==null||i.push(r.data)}),this.yr=[],e}}var DH=["retriesPerformedSoFar"];class jH{constructor(e){this.Pr=!1,this.Rr=3e3,this.yr=[],this._instance=e,this.yr=[],this.Tr=!0,!Se(X)&&"onLine"in X.navigator&&(this.Tr=X.navigator.onLine,fn(X,"online",()=>{this.Tr=!0,this.se()}),fn(X,"offline",()=>{this.Tr=!1}))}get length(){return this.yr.length}retriableRequest(e){var{retriesPerformedSoFar:n}=e,i=U4(e,DH);yi(n)&&n>0&&(i.url=Sv(i.url,{retry_count:n})),this._instance.Ee(Ae({},i,{callback:r=>{r.statusCode!==200&&(r.statusCode<400||r.statusCode>=500)&&(n??0)<10?this.Mr(Ae({retriesPerformedSoFar:n},i)):i.callback==null||i.callback(r)}}))}Mr(e){var n=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=n+1;var i=function(o){var a=3e3*Math.pow(2,o),l=a/2,c=Math.min(18e5,a),u=(Math.random()-.5)*(c-l);return Math.ceil(c+u)}(n),r=Date.now()+i;this.yr.push({retryAt:r,requestOptions:e});var s="Enqueued failed request for retry in "+i;navigator.onLine||(s+=" (Browser is offline)"),Ie.warn(s),this.Pr||(this.Pr=!0,this.Cr())}Cr(){this.Fr&&clearTimeout(this.Fr),this.Fr=setTimeout(()=>{this.Tr&&this.yr.length>0&&this.se(),this.Cr()},this.Rr)}se(){var e=Date.now(),n=[],i=this.yr.filter(s=>s.retryAt<e||(n.push(s),!1));if(this.yr=n,i.length>0)for(var{requestOptions:r}of i)this.retriableRequest(r)}unload(){for(var{requestOptions:e}of(this.Fr&&(clearTimeout(this.Fr),this.Fr=void 0),this.yr))try{this._instance.Ee(Ae({},e,{transport:"sendBeacon"}))}catch(n){Ie.error(n)}this.yr=[]}}class BH{constructor(e){this.Or=()=>{var n,i,r,s;this.Ar||(this.Ar={});var o=this.scrollElement(),a=this.scrollY(),l=o?Math.max(0,o.scrollHeight-o.clientHeight):0,c=a+((o==null?void 0:o.clientHeight)||0),u=(o==null?void 0:o.scrollHeight)||0;this.Ar.lastScrollY=Math.ceil(a),this.Ar.maxScrollY=Math.max(a,(n=this.Ar.maxScrollY)!==null&&n!==void 0?n:0),this.Ar.maxScrollHeight=Math.max(l,(i=this.Ar.maxScrollHeight)!==null&&i!==void 0?i:0),this.Ar.lastContentY=c,this.Ar.maxContentY=Math.max(c,(r=this.Ar.maxContentY)!==null&&r!==void 0?r:0),this.Ar.maxContentHeight=Math.max(u,(s=this.Ar.maxContentHeight)!==null&&s!==void 0?s:0)},this._instance=e}getContext(){return this.Ar}resetContext(){var e=this.Ar;return setTimeout(this.Or,0),e}startMeasuringScrollPosition(){fn(X,"scroll",this.Or,{capture:!0}),fn(X,"scrollend",this.Or,{capture:!0}),fn(X,"resize",this.Or)}scrollElement(){if(!this._instance.config.scroll_root_selector)return X==null?void 0:X.document.documentElement;var e=an(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var n of e){var i=X==null?void 0:X.document.querySelector(n);if(i)return i}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return X&&(X.scrollY||X.pageYOffset||X.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return X&&(X.scrollX||X.pageXOffset||X.document.documentElement.scrollLeft)||0}}var $H=t=>UO(t==null?void 0:t.config.mask_personal_data_properties,t==null?void 0:t.config.custom_personal_data_properties);class FH{constructor(e,n,i,r){this.Dr=s=>{var o=this.Lr();if(!o||o.sessionId!==s){var a={sessionId:s,props:this.jr(this._instance)};this.Nr.register({[Yw]:a})}},this._instance=e,this.zr=n,this.Nr=i,this.jr=r||$H,this.zr.onSessionId(this.Dr)}Lr(){return this.Nr.props[Yw]}getSetOnceProps(){var e,n=(e=this.Lr())==null?void 0:e.props;return n?"r"in n?VO(n):{$referring_domain:n.referringDomain,$pathname:n.initialPathName,utm_source:n.utm_source,utm_campaign:n.utm_campaign,utm_medium:n.utm_medium,utm_content:n.utm_content,utm_term:n.utm_term}:{}}getSessionProps(){var e={};return Ft(A_(this.getSetOnceProps()),(n,i)=>{i==="$current_url"&&(i="url"),e["$session_entry_"+zw(i)]=n}),e}}var lN=qn("[SessionId]");class zH{constructor(e,n,i){var r;if(this.Ur=[],!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.__preview_experimental_cookieless_mode)throw new Error("SessionIdManager cannot be used with __preview_experimental_cookieless_mode");this.S=e.config,this.Nr=e.persistence,this.fi=void 0,this.Ct=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.qr=n||il,this.Br=i||il;var s=this.S.persistence_name||this.S.token,o=this.S.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*kr(o,60,36e3,"session_idle_timeout_seconds",1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.Hr(),this.Wr="ph_"+s+"_window_id",this.Gr="ph_"+s+"_primary_window_exists",this.Jr()){var a=Qn.L(this.Wr),l=Qn.L(this.Gr);a&&!l?this.fi=a:Qn.N(this.Wr),Qn.j(this.Gr,!0)}if((r=this.S.bootstrap)!=null&&r.sessionID)try{var c=(u=>{var d=u.replace(/-/g,"");if(d.length!==32)throw new Error("Not a valid UUID");if(d[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(d.substring(0,12),16)})(this.S.bootstrap.sessionID);this.Vr(this.S.bootstrap.sessionID,new Date().getTime(),c)}catch(u){lN.error("Invalid sessionID in bootstrap",u)}this.Kr()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return Se(this.Ur)&&(this.Ur=[]),this.Ur.push(e),this.Ct&&e(this.Ct,this.fi),()=>{this.Ur=this.Ur.filter(n=>n!==e)}}Jr(){return this.S.persistence!=="memory"&&!this.Nr.Fe&&Qn.O()}Yr(e){e!==this.fi&&(this.fi=e,this.Jr()&&Qn.j(this.Wr,e))}Xr(){return this.fi?this.fi:this.Jr()?Qn.L(this.Wr):null}Vr(e,n,i){e===this.Ct&&n===this._sessionActivityTimestamp&&i===this._sessionStartTimestamp||(this._sessionStartTimestamp=i,this._sessionActivityTimestamp=n,this.Ct=e,this.Nr.register({[fv]:[n,e,i]}))}Qr(){if(this.Ct&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this.Ct,this._sessionStartTimestamp];var e=this.Nr.props[fv];return an(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.Vr(null,null,null)}Kr(){fn(X,"beforeunload",()=>{this.Jr()&&Qn.N(this.Gr)},{capture:!1})}checkAndGetSessionAndWindowId(e,n){if(e===void 0&&(e=!1),n===void 0&&(n=null),this.S.__preview_experimental_cookieless_mode)throw new Error("checkAndGetSessionAndWindowId should not be called in __preview_experimental_cookieless_mode");var i=n||new Date().getTime(),[r,s,o]=this.Qr(),a=this.Xr(),l=yi(o)&&o>0&&Math.abs(i-o)>864e5,c=!1,u=!s,d=!e&&Math.abs(i-r)>this.sessionTimeoutMs;u||d||l?(s=this.qr(),a=this.Br(),lN.info("new session ID generated",{sessionId:s,windowId:a,changeReason:{noSessionId:u,activityTimeout:d,sessionPastMaximumLength:l}}),o=i,c=!0):a||(a=this.Br(),c=!0);var f=r===0||!e||l?i:r,p=o===0?new Date().getTime():o;return this.Yr(a),this.Vr(s,f,p),e||this.Hr(),c&&this.Ur.forEach(m=>m(s,a,c?{noSessionId:u,activityTimeout:d,sessionPastMaximumLength:l}:void 0)),{sessionId:s,windowId:a,sessionStartTimestamp:p,changeReason:c?{noSessionId:u,activityTimeout:d,sessionPastMaximumLength:l}:void 0,lastActivityTimestamp:r}}Hr(){clearTimeout(this.Zr),this.Zr=setTimeout(()=>{this.resetSessionId()},1.1*this.sessionTimeoutMs)}}var UH=["$set_once","$set"],Ma=qn("[SiteApps]");class VH{constructor(e){this._instance=e,this.ts=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}es(e,n){if(n){var i=this.globalsForEvent(n);this.ts.push(i),this.ts.length>1e3&&(this.ts=this.ts.slice(10))}}get siteAppLoaders(){var e;return(e=it._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance.Ge(this.es.bind(this));this.rs=()=>{e(),this.ts=[],this.rs=void 0}}}globalsForEvent(e){var n,i,r,s,o,a,l;if(!e)throw new Error("Event payload is required");var c={},u=this._instance.get_property("$groups")||[],d=this._instance.get_property("$stored_group_properties")||{};for(var[f,p]of Object.entries(d))c[f]={id:u[f],type:f,properties:p};var{$set_once:m,$set:g}=e;return{event:Ae({},U4(e,UH),{properties:Ae({},e.properties,g?{$set:Ae({},(n=(i=e.properties)==null?void 0:i.$set)!==null&&n!==void 0?n:{},g)}:{},m?{$set_once:Ae({},(r=(s=e.properties)==null?void 0:s.$set_once)!==null&&r!==void 0?r:{},m)}:{}),elements_chain:(o=(a=e.properties)==null?void 0:a.$elements_chain)!==null&&o!==void 0?o:"",distinct_id:(l=e.properties)==null?void 0:l.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:c}}setupSiteApp(e){var n=this.apps[e.id],i=()=>{var a;!n.errored&&this.ts.length&&(Ma.info("Processing "+this.ts.length+" events for site app with id "+e.id),this.ts.forEach(l=>n.processEvent==null?void 0:n.processEvent(l)),n.processedBuffer=!0),Object.values(this.apps).every(l=>l.processedBuffer||l.errored)&&((a=this.rs)==null||a.call(this))},r=!1,s=a=>{n.errored=!a,n.loaded=!0,Ma.info("Site app with id "+e.id+" "+(a?"loaded":"errored")),r&&i()};try{var{processEvent:o}=e.init({posthog:this._instance,callback:a=>{s(a)}});o&&(n.processEvent=o),r=!0}catch(a){Ma.error("Error while initializing PostHog app with config id "+e.id,a),s(!1)}if(r&&n.loaded)try{i()}catch(a){Ma.error("Error while processing buffered events PostHog app with config id "+e.id,a),n.errored=!0}}ss(){var e=this.siteAppLoaders||[];for(var n of e)this.apps[n.id]={id:n.id,loaded:!1,errored:!1,processedBuffer:!1};for(var i of e)this.setupSiteApp(i)}ns(e){if(Object.keys(this.apps).length!==0){var n=this.globalsForEvent(e);for(var i of Object.values(this.apps))try{i.processEvent==null||i.processEvent(n)}catch(r){Ma.error("Error while processing event "+e.event+" for site app "+i.id,r)}}}onRemoteConfig(e){var n,i,r,s=this;if((n=this.siteAppLoaders)!=null&&n.length)return this.isEnabled?(this.ss(),void this._instance.on("eventCaptured",c=>this.ns(c))):void Ma.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((i=this.rs)==null||i.call(this),(r=e.siteApps)!=null&&r.length)if(this.isEnabled){var o=function(c){var u;it["__$$ph_site_app_"+c]=s._instance,(u=it.__PosthogExtensions__)==null||u.loadSiteApp==null||u.loadSiteApp(s._instance,l,d=>{if(d)return Ma.error("Error while initializing PostHog app with config id "+c,d)})};for(var{id:a,url:l}of e.siteApps)o(a)}else Ma.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var HH=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],cN=function(t,e){if(!t)return!1;var n=t.toLowerCase();return HH.concat(e||[]).some(i=>{var r=i.toLowerCase();return n.indexOf(r)!==-1})},GO=function(t,e){if(!t)return!1;var n=t.userAgent;if(n&&cN(n,e))return!0;try{var i=t==null?void 0:t.userAgentData;if(i!=null&&i.brands&&i.brands.some(r=>cN(r==null?void 0:r.brand,e)))return!0}catch{}return!!t.webdriver},ph=function(t){return t.US="us",t.EU="eu",t.CUSTOM="custom",t}({}),uN="i.posthog.com";class WH{constructor(e){this.os={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get uiHost(){var e,n=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return n||(n=this.apiHost.replace("."+uN,".posthog.com")),n==="https://app.posthog.com"?"https://us.posthog.com":n}get region(){return this.os[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.os[this.apiHost]=ph.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.os[this.apiHost]=ph.EU:this.os[this.apiHost]=ph.CUSTOM),this.os[this.apiHost]}endpointFor(e,n){if(n===void 0&&(n=""),n&&(n=n[0]==="/"?n:"/"+n),e==="ui")return this.uiHost+n;if(this.region===ph.CUSTOM)return this.apiHost+n;var i=uN+n;switch(e){case"assets":return"https://"+this.region+"-assets."+i;case"api":return"https://"+this.region+"."+i}}}var GH={icontains:(t,e)=>!!X&&e.href.toLowerCase().indexOf(t.toLowerCase())>-1,not_icontains:(t,e)=>!!X&&e.href.toLowerCase().indexOf(t.toLowerCase())===-1,regex:(t,e)=>!!X&&Ud(e.href,t),not_regex:(t,e)=>!!X&&!Ud(e.href,t),exact:(t,e)=>e.href===t,is_not:(t,e)=>e.href!==t};let qH=class Ci{constructor(e){var n=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(i){i===void 0&&(i=!1),n.getWebExperiments(r=>{Ci.ls("retrieved web experiments from the server"),n.us=new Map,r.forEach(s=>{if(s.feature_flag_key){var o;n.us&&(Ci.ls("setting flag key ",s.feature_flag_key," to web experiment ",s),(o=n.us)==null||o.set(s.feature_flag_key,s));var a=n._instance.getFeatureFlag(s.feature_flag_key);wn(a)&&s.variants[a]&&n.hs(s.name,a,s.variants[a].transforms)}else if(s.variants)for(var l in s.variants){var c=s.variants[l];Ci.ds(c)&&n.hs(s.name,l,c.transforms)}})},i)},this._instance=e,this._instance.onFeatureFlags(i=>{this.onFeatureFlags(i)})}onFeatureFlags(e){if(this._is_bot())Ci.ls("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(It(this.us))return this.us=new Map,this.loadIfEnabled(),void this.previewWebExperiment();Ci.ls("applying feature flags",e),e.forEach(n=>{var i;if(this.us&&(i=this.us)!=null&&i.has(n)){var r,s=this._instance.getFeatureFlag(n),o=(r=this.us)==null?void 0:r.get(n);s&&o!=null&&o.variants[s]&&this.hs(o.name,s,o.variants[s].transforms)}})}}previewWebExperiment(){var e=Ci.getWindowLocation();if(e!=null&&e.search){var n=vv(e==null?void 0:e.search,"__experiment_id"),i=vv(e==null?void 0:e.search,"__experiment_variant");n&&i&&(Ci.ls("previewing web experiments "+n+" && "+i),this.getWebExperiments(r=>{this.vs(parseInt(n),i,r)},!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,n,i){if(this._instance.config.disable_web_experiments&&!i)return e([]);var r=this._instance.get_property("$web_experiments");if(r&&!n)return e(r);this._instance.Ee({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:s=>{if(s.statusCode!==200||!s.json)return e([]);var o=s.json.experiments||[];return e(o)}})}vs(e,n,i){var r=i.filter(s=>s.id===e);r&&r.length>0&&(Ci.ls("Previewing web experiment ["+r[0].name+"] with variant ["+n+"]"),this.hs(r[0].name,n,r[0].variants[n].transforms))}static ds(e){return!It(e.conditions)&&Ci.cs(e)&&Ci.fs(e)}static cs(e){var n;if(It(e.conditions)||It((n=e.conditions)==null?void 0:n.url))return!0;var i,r,s,o=Ci.getWindowLocation();return!!o&&((i=e.conditions)==null||!i.url||GH[(r=(s=e.conditions)==null?void 0:s.urlMatchType)!==null&&r!==void 0?r:"icontains"](e.conditions.url,o))}static getWindowLocation(){return X==null?void 0:X.location}static fs(e){var n;if(It(e.conditions)||It((n=e.conditions)==null?void 0:n.utm))return!0;var i=BO();if(i.utm_source){var r,s,o,a,l,c,u,d,f=(r=e.conditions)==null||(r=r.utm)==null||!r.utm_campaign||((s=e.conditions)==null||(s=s.utm)==null?void 0:s.utm_campaign)==i.utm_campaign,p=(o=e.conditions)==null||(o=o.utm)==null||!o.utm_source||((a=e.conditions)==null||(a=a.utm)==null?void 0:a.utm_source)==i.utm_source,m=(l=e.conditions)==null||(l=l.utm)==null||!l.utm_medium||((c=e.conditions)==null||(c=c.utm)==null?void 0:c.utm_medium)==i.utm_medium,g=(u=e.conditions)==null||(u=u.utm)==null||!u.utm_term||((d=e.conditions)==null||(d=d.utm)==null?void 0:d.utm_term)==i.utm_term;return f&&m&&g&&p}return!1}static ls(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];Ie.info("[WebExperiments] "+e,i)}hs(e,n,i){this._is_bot()?Ci.ls("Refusing to render web experiment since the viewer is a likely bot"):n!=="control"?i.forEach(r=>{if(r.selector){var s;Ci.ls("applying transform of variant "+n+" for experiment "+e+" ",r);var o=(s=document)==null?void 0:s.querySelectorAll(r.selector);o==null||o.forEach(a=>{var l=a;r.html&&(l.innerHTML=r.html),r.css&&l.setAttribute("style",r.css)})}}):Ci.ls("Control variants leave the page unmodified.")}_is_bot(){return Sr&&this._instance?GO(Sr,this._instance.config.custom_blocked_useragents):void 0}};var KH=qn("[PostHog ExternalIntegrations]"),XH={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};let YH=class{constructor(e){this._instance=e}J(e,n){var i;(i=it.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,e,r=>{if(r)return KH.error("failed to load script",r);n()})}startIfEnabledOrStop(){var e=this,n=function(o){var a,l,c;!r||(a=it.__PosthogExtensions__)!=null&&(a=a.integrations)!=null&&a[o]||e.J(XH[o],()=>{var u;(u=it.__PosthogExtensions__)==null||(u=u.integrations)==null||(u=u[o])==null||u.start(e._instance)}),!r&&(l=it.__PosthogExtensions__)!=null&&(l=l.integrations)!=null&&l[o]&&((c=it.__PosthogExtensions__)==null||(c=c.integrations)==null||(c=c[o])==null||c.stop())};for(var[i,r]of Object.entries((s=this._instance.config.integrations)!==null&&s!==void 0?s:{})){var s;n(i)}}};var jh={},mS=()=>{},Ou="posthog",qO=!lH&&(Ji==null?void 0:Ji.indexOf("MSIE"))===-1&&(Ji==null?void 0:Ji.indexOf("Mozilla"))===-1,dN=t=>{var e;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:$7(Me==null?void 0:Me.location),persistence:"localStorage+cookie",persistence_name:"",loaded:mS,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:t!=="2025-05-24"||"history_change",capture_pageleave:"if_capture_pageview",defaults:t??"unset",debug:Qi&&wn(Qi==null?void 0:Qi.search)&&Qi.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(X==null||(e=X.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:n=>{var i="Bad HTTP status: "+n.statusCode+" "+n.text;Ie.error(i)},get_device_id:n=>n,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:pS},error_tracking:{},_onCapture:mS}},fN=t=>{var e={};Se(t.process_person)||(e.person_profiles=t.process_person),Se(t.xhr_headers)||(e.request_headers=t.xhr_headers),Se(t.cookie_name)||(e.persistence_name=t.cookie_name),Se(t.disable_cookie)||(e.disable_persistence=t.disable_cookie),Se(t.store_google)||(e.save_campaign_params=t.store_google),Se(t.verbose)||(e.debug=t.verbose);var n=Cn({},e,t);return an(t.property_blacklist)&&(Se(t.property_denylist)?n.property_denylist=t.property_blacklist:an(t.property_denylist)?n.property_denylist=[...t.property_blacklist,...t.property_denylist]:Ie.error("Invalid value for property_denylist config: "+t.property_denylist)),n};let JH=class{constructor(){this.__forceAllowLocalhost=!1}get ps(){return this.__forceAllowLocalhost}set ps(e){Ie.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}},KO=class XO{get decideEndpointWasHit(){var e,n;return(e=(n=this.featureFlags)==null?void 0:n.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,n;return(e=(n=this.featureFlags)==null?void 0:n.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new JH,this.gs=!1,this.version=Uo.LIB_VERSION,this._s=new WO,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=dN(),this.SentryIntegration=ZV,this.sentryIntegration=e=>function(n,i){var r=wO(n,i);return{name:xO,processEvent:s=>r(s)}}(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.bs=!1,this.ys=null,this.ws=null,this.Ss=null,this.featureFlags=new PH(this),this.toolbar=new eH(this),this.scrollManager=new BH(this),this.pageViewManager=new oH(this),this.surveys=new IH(this),this.experiments=new qH(this),this.exceptions=new dH(this),this.rateLimiter=new TH(this),this.requestRouter=new WH(this),this.consent=new lV(this),this.externalIntegrations=new YH(this),this.people={set:(e,n,i)=>{var r=wn(e)?{[e]:n}:e;this.setPersonProperties(r),i==null||i({})},set_once:(e,n,i)=>{var r=wn(e)?{[e]:n}:e;this.setPersonProperties(void 0,r),i==null||i({})}},this.on("eventCaptured",e=>Ie.info('send "'+(e==null?void 0:e.event)+'"',e))}init(e,n,i){if(i&&i!==Ou){var r,s=(r=jh[i])!==null&&r!==void 0?r:new XO;return s._init(e,n,i),jh[i]=s,jh[Ou][i]=s,s}return this._init(e,n,i)}_init(e,n,i){var r,s;if(n===void 0&&(n={}),Se(e)||Uw(e))return Ie.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return Ie.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},this.$s=n,this.ks=[],n.person_profiles&&(this.ws=n.person_profiles),this.set_config(Cn({},dN(n.defaults),fN(n),{name:i,token:e})),this.config.on_xhr_error&&Ie.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=n.disable_compression?void 0:ta.GZipJS,this.persistence=new V1(this.config),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new V1(Ae({},this.config,{persistence:"sessionStorage"}));var o=Ae({},this.persistence.props),a=Ae({},this.sessionPersistence.props);if(this.register({$initialization_time:new Date().toISOString()}),this.xs=new LH(v=>this.Es(v),this.config.request_queue_config),this.Is=new jH(this),this.__request_queue=[],this.config.__preview_experimental_cookieless_mode||(this.sessionManager=new zH(this),this.sessionPropsManager=new FH(this,this.sessionManager,this.persistence)),new nH(this).startIfEnabledOrStop(),this.siteApps=new VH(this),(r=this.siteApps)==null||r.init(),this.config.__preview_experimental_cookieless_mode||(this.sessionRecording=new YV(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new Q7(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new sH(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new iH(this),this.exceptionObserver=new dV(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new sO(this,uV),this.deadClicksAutocapture.startIfEnabled(),this.historyAutocapture=new CV(this),this.historyAutocapture.startIfEnabled(),Uo.DEBUG=Uo.DEBUG||this.config.debug,Uo.DEBUG&&Ie.info("Starting in debug mode",{this:this,config:n,thisC:Ae({},this.config),p:o,s:a}),this.Ps(),((s=n.bootstrap)==null?void 0:s.distinctID)!==void 0){var l,c,u=this.config.get_device_id(il()),d=(l=n.bootstrap)!=null&&l.isIdentifiedID?u:n.bootstrap.distinctID;this.persistence.set_property(Bo,(c=n.bootstrap)!=null&&c.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:n.bootstrap.distinctID,$device_id:d})}if(this.Rs()){var f,p,m=Object.keys(((f=n.bootstrap)==null?void 0:f.featureFlags)||{}).filter(v=>{var b;return!((b=n.bootstrap)==null||(b=b.featureFlags)==null||!b[v])}).reduce((v,b)=>{var w;return v[b]=((w=n.bootstrap)==null||(w=w.featureFlags)==null?void 0:w[b])||!1,v},{}),g=Object.keys(((p=n.bootstrap)==null?void 0:p.featureFlagPayloads)||{}).filter(v=>m[v]).reduce((v,b)=>{var w,k;return(w=n.bootstrap)!=null&&(w=w.featureFlagPayloads)!=null&&w[b]&&(v[b]=(k=n.bootstrap)==null||(k=k.featureFlagPayloads)==null?void 0:k[b]),v},{});this.featureFlags.receivedFeatureFlags({featureFlags:m,featureFlagPayloads:g})}if(this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:Qm,$device_id:null},"");else if(!this.get_distinct_id()){var y=this.config.get_device_id(il());this.register_once({distinct_id:y,$device_id:y},""),this.persistence.set_property(Bo,"anonymous")}return fn(X,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),n.segment?JV(this,()=>this.Ts()):this.Ts(),es(this.config._onCapture)&&this.config._onCapture!==mS&&(Ie.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",v=>this.config._onCapture(v.event,v))),this.config.ip&&Ie.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}Ie(e){var n,i,r,s,o,a,l,c;if(!Me||!Me.body)return Ie.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(()=>{this.Ie(e)},500);this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=bt(e.supportedCompression,ta.GZipJS)?ta.GZipJS:bt(e.supportedCompression,ta.Base64)?ta.Base64:void 0),(n=e.analytics)!=null&&n.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.ws?this.ws:"identified_only"}),(i=this.siteApps)==null||i.onRemoteConfig(e),(r=this.sessionRecording)==null||r.onRemoteConfig(e),(s=this.autocapture)==null||s.onRemoteConfig(e),(o=this.heatmaps)==null||o.onRemoteConfig(e),this.surveys.onRemoteConfig(e),(a=this.webVitalsAutocapture)==null||a.onRemoteConfig(e),(l=this.exceptionObserver)==null||l.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(c=this.deadClicksAutocapture)==null||c.onRemoteConfig(e)}Ts(){try{this.config.loaded(this)}catch(e){Ie.critical("`loaded` function failed",e)}this.Ms(),this.config.capture_pageview&&setTimeout(()=>{this.consent.isOptedIn()&&this.Cs()},1),new OH(this).load(),this.featureFlags.flags()}Ms(){var e;this.has_opted_out_capturing()||this.config.request_batching&&((e=this.xs)==null||e.enable())}_dom_loaded(){this.has_opted_out_capturing()||ml(this.__request_queue,e=>this.Es(e)),this.__request_queue=[],this.Ms()}_handle_unload(){var e,n;this.config.request_batching?(this.Fs()&&this.capture("$pageleave"),(e=this.xs)==null||e.unload(),(n=this.Is)==null||n.unload()):this.Fs()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}Ee(e){this.__loaded&&(qO?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=Sv(e.url,{ip:this.config.ip?1:0}),e.headers=Ae({},this.config.request_headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.fetchOptions=e.fetchOptions||this.config.fetch_options,(n=>{var i,r,s,o=Ae({},n);o.timeout=o.timeout||6e4,o.url=Sv(o.url,{_:new Date().getTime().toString(),ver:Uo.LIB_VERSION,compression:o.compression});var a=(i=o.transport)!==null&&i!==void 0?i:"fetch",l=(r=(s=V4(Dh,c=>c.transport===a))==null?void 0:s.method)!==null&&r!==void 0?r:Dh[0].method;if(!l)throw new Error("No available transport method");l(o)})(Ae({},e,{callback:n=>{var i,r;this.rateLimiter.checkForLimiting(n),n.statusCode>=400&&((i=(r=this.config).on_request_error)==null||i.call(r,n)),e.callback==null||e.callback(n)}}))))}Es(e){this.Is?this.Is.retriableRequest(e):this.Ee(e)}_execute_array(e){var n,i=[],r=[],s=[];ml(e,a=>{a&&(n=a[0],an(n)?s.push(a):es(a)?a.call(this):an(a)&&n==="alias"?i.push(a):an(a)&&n.indexOf("capture")!==-1&&es(this[n])?s.push(a):r.push(a))});var o=function(a,l){ml(a,function(c){if(an(c[0])){var u=l;Ft(c,function(d){u=u[d[0]].apply(u,d.slice(1))})}else this[c[0]].apply(this,c.slice(1))},l)};o(i,this),o(r,this),o(s,this)}Rs(){var e,n;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((n=this.config.bootstrap)==null?void 0:n.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,n,i){var r;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.xs){if(!this.consent.isOptedOut())if(!Se(e)&&wn(e)){if(this.config.opt_out_useragent_filter||!this._is_bot()){var s=i!=null&&i.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(s==null||!s.isRateLimited){n!=null&&n.$current_url&&!wn(n==null?void 0:n.$current_url)&&(Ie.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),n==null||delete n.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var o=new Date,a=(i==null?void 0:i.timestamp)||o,l=il(),c={uuid:l,event:e,properties:this.calculateEventProperties(e,n||{},a,l)};s&&(c.properties.$lib_rate_limit_remaining_tokens=s.remainingTokens),i!=null&&i.$set&&(c.$set=i==null?void 0:i.$set);var u,d,f=this.Os(i==null?void 0:i.$set_once);if(f&&(c.$set_once=f),(c=j7(c,i!=null&&i._noTruncate?null:this.config.properties_string_max_length)).timestamp=a,Se(i==null?void 0:i.timestamp)||(c.properties.$event_time_override_provided=!0,c.properties.$event_time_override_system_time=o),e===H1.DISMISSED||e===H1.SENT){var p=n==null?void 0:n[oN.SURVEY_ID],m=n==null?void 0:n[oN.SURVEY_ITERATION];localStorage.setItem((d=""+hS+(u={id:p,current_iteration:m}).id,u.current_iteration&&u.current_iteration>0&&(d=""+hS+u.id+"_"+u.current_iteration),d),"true"),c.$set=Ae({},c.$set,{[MH({id:p,current_iteration:m},e===H1.SENT?"responded":"dismissed")]:!0})}var g=Ae({},c.properties.$set,c.$set);if(Vu(g)||this.setPersonPropertiesForFlags(g),!It(this.config.before_send)){var y=this.As(c);if(!y)return;c=y}this._s.emit("eventCaptured",c);var v={method:"POST",url:(r=i==null?void 0:i._url)!==null&&r!==void 0?r:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:c,compression:"best-available",batchKey:i==null?void 0:i._batchKey};return!this.config.request_batching||i&&(i==null||!i._batchKey)||i!=null&&i.send_instantly?this.Es(v):this.xs.enqueue(v),c}Ie.critical("This capture call is ignored due to client rate limiting.")}}else Ie.error("No event name provided to posthog.capture")}else Ie.uninitializedWarning("posthog.capture")}Ge(e){return this.on("eventCaptured",n=>e(n.event,n))}calculateEventProperties(e,n,i,r,s){if(i=i||new Date,!this.persistence||!this.sessionPersistence)return n;var o=s?void 0:this.persistence.remove_event_timer(e),a=Ae({},n);if(a.token=this.config.token,a.$config_defaults=this.config.defaults,this.config.__preview_experimental_cookieless_mode&&(a.$cookieless_mode=!0),e==="$snapshot"){var l=Ae({},this.persistence.properties(),this.sessionPersistence.properties());return a.distinct_id=l.distinct_id,(!wn(a.distinct_id)&&!yi(a.distinct_id)||Uw(a.distinct_id))&&Ie.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),a}var c,u=CH(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:d,windowId:f}=this.sessionManager.checkAndGetSessionAndWindowId(s,i.getTime());a.$session_id=d,a.$window_id=f}this.sessionPropsManager&&Cn(a,this.sessionPropsManager.getSessionProps());try{var p;this.sessionRecording&&Cn(a,this.sessionRecording.sdkDebugProperties),a.$sdk_debug_retry_queue_size=(p=this.Is)==null?void 0:p.length}catch(v){a.$sdk_debug_error_capturing_properties=String(v)}if(this.requestRouter.region===ph.CUSTOM&&(a.$lib_custom_api_host=this.config.api_host),c=e!=="$pageview"||s?e!=="$pageleave"||s?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(i):this.pageViewManager.doPageView(i,r),a=Cn(a,c),e==="$pageview"&&Me&&(a.title=Me.title),!Se(o)){var m=i.getTime()-o;a.$duration=parseFloat((m/1e3).toFixed(3))}Ji&&this.config.opt_out_useragent_filter&&(a.$browser_type=this._is_bot()?"bot":"browser"),(a=Cn({},u,this.persistence.properties(),this.sessionPersistence.properties(),a)).$is_identified=this._isIdentified(),an(this.config.property_denylist)?Ft(this.config.property_denylist,function(v){delete a[v]}):Ie.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var g=this.config.sanitize_properties;g&&(Ie.error("sanitize_properties is deprecated. Use before_send instead"),a=g(a,e));var y=this.Ds();return a.$process_person_profile=y,y&&!s&&this.Ls("_calculate_event_properties"),a}Os(e){var n;if(!this.persistence||!this.Ds()||this.gs)return e;var i=this.persistence.get_initial_props(),r=(n=this.sessionPropsManager)==null?void 0:n.getSetOnceProps(),s=Cn({},i,r||{},e||{}),o=this.config.sanitize_properties;return o&&(Ie.error("sanitize_properties is deprecated. Use before_send instead"),s=o(s,"$set_once")),this.gs=!0,Vu(s)?void 0:s}register(e,n){var i;(i=this.persistence)==null||i.register(e,n)}register_once(e,n,i){var r;(r=this.persistence)==null||r.register_once(e,n,i)}register_for_session(e){var n;(n=this.sessionPersistence)==null||n.register(e)}unregister(e){var n;(n=this.persistence)==null||n.unregister(e)}unregister_for_session(e){var n;(n=this.sessionPersistence)==null||n.unregister(e)}js(e,n){this.register({[e]:n})}getFeatureFlag(e,n){return this.featureFlags.getFeatureFlag(e,n)}getFeatureFlagPayload(e){var n=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(n)}catch{return n}}isFeatureEnabled(e,n){return this.featureFlags.isFeatureEnabled(e,n)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(e,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,n)}getEarlyAccessFeatures(e,n,i){return n===void 0&&(n=!1),this.featureFlags.getEarlyAccessFeatures(e,n,i)}on(e,n){return this._s.on(e,n)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var n,i;return(n=(i=this.sessionManager)==null?void 0:i.onSessionId(e))!==null&&n!==void 0?n:()=>{}}getSurveys(e,n){n===void 0&&(n=!1),this.surveys.getSurveys(e,n)}getActiveMatchingSurveys(e,n){n===void 0&&(n=!1),this.surveys.getActiveMatchingSurveys(e,n)}renderSurvey(e,n){this.surveys.renderSurvey(e,n)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,n){return n===void 0&&(n=!1),this.surveys.canRenderSurveyAsync(e,n)}identify(e,n,i){if(!this.__loaded||!this.persistence)return Ie.uninitializedWarning("posthog.identify");if(yi(e)&&(e=e.toString(),Ie.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))Ie.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==Qm){if(this.Ls("posthog.identify")){var r=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var s=r;this.register_once({$had_persisted_distinct_id:!0,$device_id:s},"")}e!==r&&e!==this.get_property(ah)&&(this.unregister(ah),this.register({distinct_id:e}));var o=(this.persistence.get_property(Bo)||"anonymous")==="anonymous";e!==r&&o?(this.persistence.set_property(Bo,"identified"),this.setPersonPropertiesForFlags(Ae({},i||{},n||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:r},{$set:n||{},$set_once:i||{}}),this.Ss=JP(e,n,i),this.featureFlags.setAnonymousDistinctId(r)):(n||i)&&this.setPersonProperties(n,i),e!==r&&(this.reloadFeatureFlags(),this.unregister(hv))}}else Ie.critical('The string "'+Qm+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else Ie.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,n){if((e||n)&&this.Ls("posthog.setPersonProperties")){var i=JP(this.get_distinct_id(),e,n);this.Ss!==i?(this.setPersonPropertiesForFlags(Ae({},n||{},e||{})),this.capture("$set",{$set:e||{},$set_once:n||{}}),this.Ss=i):Ie.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,n,i){if(e&&n){if(this.Ls("posthog.group")){var r=this.getGroups();r[e]!==n&&this.resetGroupPropertiesForFlags(e),this.register({$groups:Ae({},r,{[e]:n})}),i&&(this.capture("$groupidentify",{$group_type:e,$group_key:n,$group_set:i}),this.setGroupPropertiesForFlags({[e]:i})),r[e]===n||i||this.reloadFeatureFlags()}}else Ie.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,n){n===void 0&&(n=!0),this.featureFlags.setPersonPropertiesForFlags(e,n)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,n){n===void 0&&(n=!0),this.Ls("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,n)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var n,i,r,s;if(Ie.info("reset"),!this.__loaded)return Ie.uninitializedWarning("posthog.reset");var o=this.get_property("$device_id");if(this.consent.reset(),(n=this.persistence)==null||n.clear(),(i=this.sessionPersistence)==null||i.clear(),this.surveys.reset(),(r=this.persistence)==null||r.set_property(Bo,"anonymous"),(s=this.sessionManager)==null||s.resetSessionId(),this.Ss=null,this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:Qm,$device_id:null},"");else{var a=this.config.get_device_id(il());this.register_once({distinct_id:a,$device_id:e?a:o},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,n;return(e=(n=this.sessionManager)==null?void 0:n.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:n,sessionStartTimestamp:i}=this.sessionManager.checkAndGetSessionAndWindowId(!0),r=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+n);if(e!=null&&e.withTimestamp&&i){var s,o=(s=e.timestampLookBack)!==null&&s!==void 0?s:10;if(!i)return r;r+="?t="+Math.max(Math.floor((new Date().getTime()-i)/1e3)-o,0)}return r}alias(e,n){return e===this.get_property(H4)?(Ie.critical("Attempting to create alias for existing People user - aborting."),-2):this.Ls("posthog.alias")?(Se(n)&&(n=this.get_distinct_id()),e!==n?(this.js(ah,e),this.capture("$create_alias",{alias:e,distinct_id:n})):(Ie.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var n,i,r,s,o,a=Ae({},this.config);xn(e)&&(Cn(this.config,fN(e)),(n=this.persistence)==null||n.update_config(this.config,a),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new V1(Ae({},this.config,{persistence:"sessionStorage"})),Dn.O()&&Dn.D("ph_debug")==="true"&&(this.config.debug=!0),this.config.debug&&(Uo.DEBUG=!0,Ie.info("set_config",{config:e,oldConfig:a,newConfig:Ae({},this.config)})),(i=this.sessionRecording)==null||i.startIfEnabledOrStop(),(r=this.autocapture)==null||r.startIfEnabled(),(s=this.heatmaps)==null||s.startIfEnabled(),this.surveys.loadIfEnabled(),this.Ps(),(o=this.externalIntegrations)==null||o.startIfEnabledOrStop())}startSessionRecording(e){var n=e===!0,i={sampling:n||!(e==null||!e.sampling),linked_flag:n||!(e==null||!e.linked_flag),url_trigger:n||!(e==null||!e.url_trigger),event_trigger:n||!(e==null||!e.event_trigger)};if(Object.values(i).some(Boolean)){var r,s,o,a,l;(r=this.sessionManager)==null||r.checkAndGetSessionAndWindowId(),i.sampling&&((s=this.sessionRecording)==null||s.overrideSampling()),i.linked_flag&&((o=this.sessionRecording)==null||o.overrideLinkedFlag()),i.url_trigger&&((a=this.sessionRecording)==null||a.overrideTrigger("url")),i.event_trigger&&((l=this.sessionRecording)==null||l.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,n){var i=new Error("PostHog syntheticException");this.exceptions.sendExceptionEvent(Ae({},_V((r=>r instanceof Error)(e)?{error:e,event:e.message}:{event:e},{syntheticException:i}),n))}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var n;return(n=this.persistence)==null?void 0:n.props[e]}getSessionProperty(e){var n;return(n=this.sessionPersistence)==null?void 0:n.props[e]}toString(){var e,n=(e=this.config.name)!==null&&e!==void 0?e:Ou;return n!==Ou&&(n=Ou+"."+n),n}_isIdentified(){var e,n;return((e=this.persistence)==null?void 0:e.get_property(Bo))==="identified"||((n=this.sessionPersistence)==null?void 0:n.get_property(Bo))==="identified"}Ds(){var e,n;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Vu(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[ah])&&((n=this.persistence)==null||(n=n.props)==null||!n[mv]))}Fs(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.Ds()||this.Ls("posthog.createPersonProfile")&&this.setPersonProperties({},{})}Ls(e){return this.config.person_profiles==="never"?(Ie.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.js(mv,!0),!0)}Ps(){var e,n,i,r,s=this.consent.isOptedOut(),o=this.config.opt_out_persistence_by_default,a=this.config.disable_persistence||s&&!!o;((e=this.persistence)==null?void 0:e.Fe)!==a&&((i=this.persistence)==null||i.set_disabled(a)),((n=this.sessionPersistence)==null?void 0:n.Fe)!==a&&((r=this.sessionPersistence)==null||r.set_disabled(a))}opt_in_capturing(e){var n;this.consent.optInOut(!0),this.Ps(),(Se(e==null?void 0:e.captureEventName)||e!=null&&e.captureEventName)&&this.capture((n=e==null?void 0:e.captureEventName)!==null&&n!==void 0?n:"$opt_in",e==null?void 0:e.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.Cs()}opt_out_capturing(){this.consent.optInOut(!1),this.Ps()}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}clear_opt_in_out_capturing(){this.consent.reset(),this.Ps()}_is_bot(){return Sr?GO(Sr,this.config.custom_blocked_useragents):void 0}Cs(){Me&&(Me.visibilityState==="visible"?this.bs||(this.bs=!0,this.capture("$pageview",{title:Me.title},{send_instantly:!0}),this.ys&&(Me.removeEventListener("visibilitychange",this.ys),this.ys=null)):this.ys||(this.ys=this.Cs.bind(this),fn(Me,"visibilitychange",this.ys)))}debug(e){e===!1?(X==null||X.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(X==null||X.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}I(){var e,n,i,r,s,o,a,l=this.$s||{};return"advanced_disable_flags"in l?!!l.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(Ie.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(i="advanced_disable_decide",r=!1,s=Ie,o=(n="advanced_disable_flags")in(e=l)&&!Se(e[n]),a=i in e&&!Se(e[i]),o?e[n]:a?(s&&s.warn("Config field '"+i+"' is deprecated. Please use '"+n+"' instead. The old field will be removed in a future major version."),e[i]):r)}As(e){if(It(this.config.before_send))return e;var n=an(this.config.before_send)?this.config.before_send:[this.config.before_send],i=e;for(var r of n){if(i=r(i),It(i)){var s="Event '"+e.event+"' was rejected in beforeSend function";return O7(e.event)?Ie.warn(s+". This can cause unexpected behavior."):Ie.info(s),null}i.properties&&!Vu(i.properties)||Ie.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return i}getPageViewId(){var e;return(e=this.pageViewManager.ce)==null?void 0:e.pageViewId}captureTraceFeedback(e,n){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:n})}captureTraceMetric(e,n,i){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:n,$ai_metric_value:String(i)})}};(function(t,e){for(var n=0;n<e.length;n++)t.prototype[e[n]]=D7(t.prototype[e[n]])})(KO,["identify"]);var hN,Xa=(hN=jh[Ou]=new KO,function(){function t(){t.done||(t.done=!0,qO=!1,Ft(jh,function(e){e._dom_loaded()}))}Me!=null&&Me.addEventListener?Me.readyState==="complete"?t():fn(Me,"DOMContentLoaded",t,{capture:!1}):X&&Ie.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),hN),YO=x.createContext({client:Xa});function JO(t,e,n){if(n===void 0&&(n=new WeakMap),t===e)return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(n.has(t)&&n.get(t)===e)return!0;n.set(t,e);var i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(var s=0,o=i;s<o.length;s++){var a=o[s];if(!r.includes(a)||!JO(t[a],e[a],n))return!1}return!0}function ZH(t){var e=t.children,n=t.client,i=t.apiKey,r=t.options,s=x.useRef(null),o=x.useMemo(function(){return n?(i&&console.warn("[PostHog.js] You have provided both `client` and `apiKey` to `PostHogProvider`. `apiKey` will be ignored in favour of `client`."),r&&console.warn("[PostHog.js] You have provided both `client` and `options` to `PostHogProvider`. `options` will be ignored in favour of `client`."),n):(i||console.warn("[PostHog.js] No `apiKey` or `client` were provided to `PostHogProvider`. Using default global `window.posthog` instance. You must initialize it manually. This is not recommended behavior."),Xa)},[n,i,JSON.stringify(r)]);return x.useEffect(function(){if(!n){var a=s.current;a?(i!==a.apiKey&&console.warn("[PostHog.js] You have provided a different `apiKey` to `PostHogProvider` than the one that was already initialized. This is not supported by our provider and we'll keep using the previous key. If you need to toggle between API Keys you need to control the `client` yourself and pass it in as a prop rather than an `apiKey` prop."),r&&!JO(r,a.options)&&Xa.set_config(r),s.current={apiKey:i,options:r??{}}):(Xa.__loaded&&console.warn("[PostHog.js] `posthog` was already loaded elsewhere. This may cause issues."),Xa.init(i,r),s.current={apiKey:i,options:r??{}})}},[n,i,JSON.stringify(r)]),Qt.createElement(YO.Provider,{value:{client:o}},e)}var gS=function(t,e){return gS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},gS(t,e)};function QH(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");gS(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var W1=function(t){return typeof t=="function"},eW={componentStack:null,error:null},tW={INVALID_FALLBACK:"[PostHog.js][PostHogErrorBoundary] Invalid fallback prop, provide a valid React element or a function that returns a valid React element."};(function(t){QH(e,t);function e(n){var i=t.call(this,n)||this;return i.state=eW,i}return e.prototype.componentDidCatch=function(n,i){var r=i.componentStack,s=this.props.additionalProperties;this.setState({error:n,componentStack:r});var o;W1(s)?o=s(n):typeof s=="object"&&(o=s);var a=this.context.client;a.captureException(n,o)},e.prototype.render=function(){var n=this.props,i=n.children,r=n.fallback,s=this.state;if(s.componentStack==null)return W1(i)?i():i;var o=W1(r)?Qt.createElement(r,{error:s.error,componentStack:s.componentStack}):r;return Qt.isValidElement(o)?o:(console.warn(tW.INVALID_FALLBACK),Qt.createElement(Qt.Fragment,null))},e.contextType=YO,e})(Qt.Component);var ZO={exports:{}},Lr={},QO={exports:{}},e5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,U){var se=V.length;V.push(U);e:for(;0<se;){var _e=se-1>>>1,Q=V[_e];if(0<r(Q,U))V[_e]=U,V[se]=Q,se=_e;else break e}}function n(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var U=V[0],se=V.pop();if(se!==U){V[0]=se;e:for(var _e=0,Q=V.length,ae=Q>>>1;_e<ae;){var z=2*(_e+1)-1,$=V[z],W=z+1,S=V[W];if(0>r($,se))W<Q&&0>r(S,$)?(V[_e]=S,V[W]=se,_e=W):(V[_e]=$,V[z]=se,_e=z);else if(W<Q&&0>r(S,se))V[_e]=S,V[W]=se,_e=W;else break e}}return U}function r(V,U){var se=V.sortIndex-U.sortIndex;return se!==0?se:V.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,f=3,p=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(V){for(var U=n(c);U!==null;){if(U.callback===null)i(c);else if(U.startTime<=V)i(c),U.sortIndex=U.expirationTime,e(l,U);else break;U=n(c)}}function k(V){if(g=!1,w(V),!m)if(n(l)!==null)m=!0,J(C);else{var U=n(c);U!==null&&ne(k,U.startTime-V)}}function C(V,U){m=!1,g&&(g=!1,v(A),A=-1),p=!0;var se=f;try{for(w(U),d=n(l);d!==null&&(!(d.expirationTime>U)||V&&!O());){var _e=d.callback;if(typeof _e=="function"){d.callback=null,f=d.priorityLevel;var Q=_e(d.expirationTime<=U);U=t.unstable_now(),typeof Q=="function"?d.callback=Q:d===n(l)&&i(l),w(U)}else i(l);d=n(l)}if(d!==null)var ae=!0;else{var z=n(c);z!==null&&ne(k,z.startTime-U),ae=!1}return ae}finally{d=null,f=se,p=!1}}var E=!1,_=null,A=-1,R=5,L=-1;function O(){return!(t.unstable_now()-L<R)}function I(){if(_!==null){var V=t.unstable_now();L=V;var U=!0;try{U=_(!0,V)}finally{U?G():(E=!1,_=null)}}else E=!1}var G;if(typeof b=="function")G=function(){b(I)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,K=B.port2;B.port1.onmessage=I,G=function(){K.postMessage(null)}}else G=function(){y(I,0)};function J(V){_=V,E||(E=!0,G())}function ne(V,U){A=y(function(){V(t.unstable_now())},U)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,J(C))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(V){switch(f){case 1:case 2:case 3:var U=3;break;default:U=f}var se=f;f=U;try{return V()}finally{f=se}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,U){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var se=f;f=V;try{return U()}finally{f=se}},t.unstable_scheduleCallback=function(V,U,se){var _e=t.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?_e+se:_e):se=_e,V){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=se+Q,V={id:u++,callback:U,priorityLevel:V,startTime:se,expirationTime:Q,sortIndex:-1},se>_e?(V.sortIndex=se,e(c,V),n(l)===null&&V===n(c)&&(g?(v(A),A=-1):g=!0,ne(k,se-_e))):(V.sortIndex=Q,e(l,V),m||p||(m=!0,J(C))),V},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(V){var U=f;return function(){var se=f;f=U;try{return V.apply(this,arguments)}finally{f=se}}}})(e5);QO.exports=e5;var nW=QO.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iW=x,Rr=nW;function de(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t5=new Set,hp={};function du(t,e){Hd(t,e),Hd(t+"Capture",e)}function Hd(t,e){for(hp[t]=e,t=0;t<e.length;t++)t5.add(e[t])}var da=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vS=Object.prototype.hasOwnProperty,rW=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pN={},mN={};function sW(t){return vS.call(mN,t)?!0:vS.call(pN,t)?!1:rW.test(t)?mN[t]=!0:(pN[t]=!0,!1)}function oW(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function aW(t,e,n,i){if(e===null||typeof e>"u"||oW(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Bi(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var li={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){li[t]=new Bi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];li[e]=new Bi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){li[t]=new Bi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){li[t]=new Bi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){li[t]=new Bi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){li[t]=new Bi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){li[t]=new Bi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){li[t]=new Bi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){li[t]=new Bi(t,5,!1,t.toLowerCase(),null,!1,!1)});var z_=/[\-:]([a-z])/g;function U_(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(z_,U_);li[e]=new Bi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(z_,U_);li[e]=new Bi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(z_,U_);li[e]=new Bi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){li[t]=new Bi(t,1,!1,t.toLowerCase(),null,!1,!1)});li.xlinkHref=new Bi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){li[t]=new Bi(t,1,!1,t.toLowerCase(),null,!0,!0)});function V_(t,e,n,i){var r=li.hasOwnProperty(e)?li[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(aW(e,n,r,i)&&(n=null),i||r===null?sW(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var wa=iW.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cg=Symbol.for("react.element"),Gu=Symbol.for("react.portal"),qu=Symbol.for("react.fragment"),H_=Symbol.for("react.strict_mode"),yS=Symbol.for("react.profiler"),n5=Symbol.for("react.provider"),i5=Symbol.for("react.context"),W_=Symbol.for("react.forward_ref"),bS=Symbol.for("react.suspense"),xS=Symbol.for("react.suspense_list"),G_=Symbol.for("react.memo"),$a=Symbol.for("react.lazy"),r5=Symbol.for("react.offscreen"),gN=Symbol.iterator;function $f(t){return t===null||typeof t!="object"?null:(t=gN&&t[gN]||t["@@iterator"],typeof t=="function"?t:null)}var gn=Object.assign,G1;function mh(t){if(G1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);G1=e&&e[1]||""}return`
`+G1+t}var q1=!1;function K1(t,e){if(!t||q1)return"";q1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{q1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?mh(t):""}function lW(t){switch(t.tag){case 5:return mh(t.type);case 16:return mh("Lazy");case 13:return mh("Suspense");case 19:return mh("SuspenseList");case 0:case 2:case 15:return t=K1(t.type,!1),t;case 11:return t=K1(t.type.render,!1),t;case 1:return t=K1(t.type,!0),t;default:return""}}function wS(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qu:return"Fragment";case Gu:return"Portal";case yS:return"Profiler";case H_:return"StrictMode";case bS:return"Suspense";case xS:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case i5:return(t.displayName||"Context")+".Consumer";case n5:return(t._context.displayName||"Context")+".Provider";case W_:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case G_:return e=t.displayName||null,e!==null?e:wS(t.type)||"Memo";case $a:e=t._payload,t=t._init;try{return wS(t(e))}catch{}}return null}function cW(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wS(e);case 8:return e===H_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ml(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function s5(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function uW(t){var e=s5(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ug(t){t._valueTracker||(t._valueTracker=uW(t))}function o5(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=s5(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function _v(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function SS(t,e){var n=e.checked;return gn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function vN(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=Ml(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function a5(t,e){e=e.checked,e!=null&&V_(t,"checked",e,!1)}function kS(t,e){a5(t,e);var n=Ml(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?_S(t,e.type,n):e.hasOwnProperty("defaultValue")&&_S(t,e.type,Ml(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function yN(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function _S(t,e,n){(e!=="number"||_v(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var gh=Array.isArray;function hd(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Ml(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function CS(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(de(91));return gn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function bN(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(de(92));if(gh(n)){if(1<n.length)throw Error(de(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ml(n)}}function l5(t,e){var n=Ml(e.value),i=Ml(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function xN(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function c5(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ES(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?c5(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var dg,u5=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(dg=dg||document.createElement("div"),dg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=dg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function pp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Bh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dW=["Webkit","ms","Moz","O"];Object.keys(Bh).forEach(function(t){dW.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Bh[e]=Bh[t]})});function d5(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Bh.hasOwnProperty(t)&&Bh[t]?(""+e).trim():e+"px"}function f5(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=d5(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var fW=gn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function AS(t,e){if(e){if(fW[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(de(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(de(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(de(61))}if(e.style!=null&&typeof e.style!="object")throw Error(de(62))}}function PS(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var NS=null;function q_(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var MS=null,pd=null,md=null;function wN(t){if(t=Sm(t)){if(typeof MS!="function")throw Error(de(280));var e=t.stateNode;e&&(e=ub(e),MS(t.stateNode,t.type,e))}}function h5(t){pd?md?md.push(t):md=[t]:pd=t}function p5(){if(pd){var t=pd,e=md;if(md=pd=null,wN(t),e)for(t=0;t<e.length;t++)wN(e[t])}}function m5(t,e){return t(e)}function g5(){}var X1=!1;function v5(t,e,n){if(X1)return t(e,n);X1=!0;try{return m5(t,e,n)}finally{X1=!1,(pd!==null||md!==null)&&(g5(),p5())}}function mp(t,e){var n=t.stateNode;if(n===null)return null;var i=ub(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(de(231,e,typeof n));return n}var RS=!1;if(da)try{var Ff={};Object.defineProperty(Ff,"passive",{get:function(){RS=!0}}),window.addEventListener("test",Ff,Ff),window.removeEventListener("test",Ff,Ff)}catch{RS=!1}function hW(t,e,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var $h=!1,Cv=null,Ev=!1,IS=null,pW={onError:function(t){$h=!0,Cv=t}};function mW(t,e,n,i,r,s,o,a,l){$h=!1,Cv=null,hW.apply(pW,arguments)}function gW(t,e,n,i,r,s,o,a,l){if(mW.apply(this,arguments),$h){if($h){var c=Cv;$h=!1,Cv=null}else throw Error(de(198));Ev||(Ev=!0,IS=c)}}function fu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function y5(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function SN(t){if(fu(t)!==t)throw Error(de(188))}function vW(t){var e=t.alternate;if(!e){if(e=fu(t),e===null)throw Error(de(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return SN(r),t;if(s===i)return SN(r),e;s=s.sibling}throw Error(de(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(de(189))}}if(n.alternate!==i)throw Error(de(190))}if(n.tag!==3)throw Error(de(188));return n.stateNode.current===n?t:e}function b5(t){return t=vW(t),t!==null?x5(t):null}function x5(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=x5(t);if(e!==null)return e;t=t.sibling}return null}var w5=Rr.unstable_scheduleCallback,kN=Rr.unstable_cancelCallback,yW=Rr.unstable_shouldYield,bW=Rr.unstable_requestPaint,En=Rr.unstable_now,xW=Rr.unstable_getCurrentPriorityLevel,K_=Rr.unstable_ImmediatePriority,S5=Rr.unstable_UserBlockingPriority,Av=Rr.unstable_NormalPriority,wW=Rr.unstable_LowPriority,k5=Rr.unstable_IdlePriority,ob=null,So=null;function SW(t){if(So&&typeof So.onCommitFiberRoot=="function")try{So.onCommitFiberRoot(ob,t,void 0,(t.current.flags&128)===128)}catch{}}var Ts=Math.clz32?Math.clz32:CW,kW=Math.log,_W=Math.LN2;function CW(t){return t>>>=0,t===0?32:31-(kW(t)/_W|0)|0}var fg=64,hg=4194304;function vh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Pv(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=vh(a):(s&=o,s!==0&&(i=vh(s)))}else o=n&~r,o!==0?i=vh(o):s!==0&&(i=vh(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Ts(e),r=1<<n,i|=t[n],e&=~r;return i}function EW(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AW(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Ts(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=EW(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function TS(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function _5(){var t=fg;return fg<<=1,!(fg&4194240)&&(fg=64),t}function Y1(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function xm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ts(e),t[e]=n}function PW(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Ts(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function X_(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Ts(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var jt=0;function C5(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var E5,Y_,A5,P5,N5,OS=!1,pg=[],vl=null,yl=null,bl=null,gp=new Map,vp=new Map,Ya=[],NW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _N(t,e){switch(t){case"focusin":case"focusout":vl=null;break;case"dragenter":case"dragleave":yl=null;break;case"mouseover":case"mouseout":bl=null;break;case"pointerover":case"pointerout":gp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":vp.delete(e.pointerId)}}function zf(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Sm(e),e!==null&&Y_(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function MW(t,e,n,i,r){switch(e){case"focusin":return vl=zf(vl,t,e,n,i,r),!0;case"dragenter":return yl=zf(yl,t,e,n,i,r),!0;case"mouseover":return bl=zf(bl,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return gp.set(s,zf(gp.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,vp.set(s,zf(vp.get(s)||null,t,e,n,i,r)),!0}return!1}function M5(t){var e=Mc(t.target);if(e!==null){var n=fu(e);if(n!==null){if(e=n.tag,e===13){if(e=y5(n),e!==null){t.blockedOn=e,N5(t.priority,function(){A5(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function M0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=LS(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);NS=i,n.target.dispatchEvent(i),NS=null}else return e=Sm(n),e!==null&&Y_(e),t.blockedOn=n,!1;e.shift()}return!0}function CN(t,e,n){M0(t)&&n.delete(e)}function RW(){OS=!1,vl!==null&&M0(vl)&&(vl=null),yl!==null&&M0(yl)&&(yl=null),bl!==null&&M0(bl)&&(bl=null),gp.forEach(CN),vp.forEach(CN)}function Uf(t,e){t.blockedOn===e&&(t.blockedOn=null,OS||(OS=!0,Rr.unstable_scheduleCallback(Rr.unstable_NormalPriority,RW)))}function yp(t){function e(r){return Uf(r,t)}if(0<pg.length){Uf(pg[0],t);for(var n=1;n<pg.length;n++){var i=pg[n];i.blockedOn===t&&(i.blockedOn=null)}}for(vl!==null&&Uf(vl,t),yl!==null&&Uf(yl,t),bl!==null&&Uf(bl,t),gp.forEach(e),vp.forEach(e),n=0;n<Ya.length;n++)i=Ya[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Ya.length&&(n=Ya[0],n.blockedOn===null);)M5(n),n.blockedOn===null&&Ya.shift()}var gd=wa.ReactCurrentBatchConfig,Nv=!0;function IW(t,e,n,i){var r=jt,s=gd.transition;gd.transition=null;try{jt=1,J_(t,e,n,i)}finally{jt=r,gd.transition=s}}function TW(t,e,n,i){var r=jt,s=gd.transition;gd.transition=null;try{jt=4,J_(t,e,n,i)}finally{jt=r,gd.transition=s}}function J_(t,e,n,i){if(Nv){var r=LS(t,e,n,i);if(r===null)ox(t,e,i,Mv,n),_N(t,i);else if(MW(r,t,e,n,i))i.stopPropagation();else if(_N(t,i),e&4&&-1<NW.indexOf(t)){for(;r!==null;){var s=Sm(r);if(s!==null&&E5(s),s=LS(t,e,n,i),s===null&&ox(t,e,i,Mv,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else ox(t,e,i,null,n)}}var Mv=null;function LS(t,e,n,i){if(Mv=null,t=q_(i),t=Mc(t),t!==null)if(e=fu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=y5(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Mv=t,null}function R5(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xW()){case K_:return 1;case S5:return 4;case Av:case wW:return 16;case k5:return 536870912;default:return 16}default:return 16}}var rl=null,Z_=null,R0=null;function I5(){if(R0)return R0;var t,e=Z_,n=e.length,i,r="value"in rl?rl.value:rl.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return R0=r.slice(t,1<i?1-i:void 0)}function I0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function mg(){return!0}function EN(){return!1}function Dr(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?mg:EN,this.isPropagationStopped=EN,this}return gn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=mg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=mg)},persist:function(){},isPersistent:mg}),e}var wf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Q_=Dr(wf),wm=gn({},wf,{view:0,detail:0}),OW=Dr(wm),J1,Z1,Vf,ab=gn({},wm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eC,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Vf&&(Vf&&t.type==="mousemove"?(J1=t.screenX-Vf.screenX,Z1=t.screenY-Vf.screenY):Z1=J1=0,Vf=t),J1)},movementY:function(t){return"movementY"in t?t.movementY:Z1}}),AN=Dr(ab),LW=gn({},ab,{dataTransfer:0}),DW=Dr(LW),jW=gn({},wm,{relatedTarget:0}),Q1=Dr(jW),BW=gn({},wf,{animationName:0,elapsedTime:0,pseudoElement:0}),$W=Dr(BW),FW=gn({},wf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),zW=Dr(FW),UW=gn({},wf,{data:0}),PN=Dr(UW),VW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=WW[t])?!!e[t]:!1}function eC(){return GW}var qW=gn({},wm,{key:function(t){if(t.key){var e=VW[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=I0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?HW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eC,charCode:function(t){return t.type==="keypress"?I0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?I0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),KW=Dr(qW),XW=gn({},ab,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),NN=Dr(XW),YW=gn({},wm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eC}),JW=Dr(YW),ZW=gn({},wf,{propertyName:0,elapsedTime:0,pseudoElement:0}),QW=Dr(ZW),eG=gn({},ab,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),tG=Dr(eG),nG=[9,13,27,32],tC=da&&"CompositionEvent"in window,Fh=null;da&&"documentMode"in document&&(Fh=document.documentMode);var iG=da&&"TextEvent"in window&&!Fh,T5=da&&(!tC||Fh&&8<Fh&&11>=Fh),MN=" ",RN=!1;function O5(t,e){switch(t){case"keyup":return nG.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function L5(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ku=!1;function rG(t,e){switch(t){case"compositionend":return L5(e);case"keypress":return e.which!==32?null:(RN=!0,MN);case"textInput":return t=e.data,t===MN&&RN?null:t;default:return null}}function sG(t,e){if(Ku)return t==="compositionend"||!tC&&O5(t,e)?(t=I5(),R0=Z_=rl=null,Ku=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return T5&&e.locale!=="ko"?null:e.data;default:return null}}var oG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function IN(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!oG[t.type]:e==="textarea"}function D5(t,e,n,i){h5(i),e=Rv(e,"onChange"),0<e.length&&(n=new Q_("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var zh=null,bp=null;function aG(t){q5(t,0)}function lb(t){var e=Ju(t);if(o5(e))return t}function lG(t,e){if(t==="change")return e}var j5=!1;if(da){var ex;if(da){var tx="oninput"in document;if(!tx){var TN=document.createElement("div");TN.setAttribute("oninput","return;"),tx=typeof TN.oninput=="function"}ex=tx}else ex=!1;j5=ex&&(!document.documentMode||9<document.documentMode)}function ON(){zh&&(zh.detachEvent("onpropertychange",B5),bp=zh=null)}function B5(t){if(t.propertyName==="value"&&lb(bp)){var e=[];D5(e,bp,t,q_(t)),v5(aG,e)}}function cG(t,e,n){t==="focusin"?(ON(),zh=e,bp=n,zh.attachEvent("onpropertychange",B5)):t==="focusout"&&ON()}function uG(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return lb(bp)}function dG(t,e){if(t==="click")return lb(e)}function fG(t,e){if(t==="input"||t==="change")return lb(e)}function hG(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ls=typeof Object.is=="function"?Object.is:hG;function xp(t,e){if(Ls(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!vS.call(e,r)||!Ls(t[r],e[r]))return!1}return!0}function LN(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function DN(t,e){var n=LN(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=LN(n)}}function $5(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$5(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function F5(){for(var t=window,e=_v();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=_v(t.document)}return e}function nC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function pG(t){var e=F5(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&$5(n.ownerDocument.documentElement,n)){if(i!==null&&nC(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=DN(n,s);var o=DN(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mG=da&&"documentMode"in document&&11>=document.documentMode,Xu=null,DS=null,Uh=null,jS=!1;function jN(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;jS||Xu==null||Xu!==_v(i)||(i=Xu,"selectionStart"in i&&nC(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Uh&&xp(Uh,i)||(Uh=i,i=Rv(DS,"onSelect"),0<i.length&&(e=new Q_("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Xu)))}function gg(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Yu={animationend:gg("Animation","AnimationEnd"),animationiteration:gg("Animation","AnimationIteration"),animationstart:gg("Animation","AnimationStart"),transitionend:gg("Transition","TransitionEnd")},nx={},z5={};da&&(z5=document.createElement("div").style,"AnimationEvent"in window||(delete Yu.animationend.animation,delete Yu.animationiteration.animation,delete Yu.animationstart.animation),"TransitionEvent"in window||delete Yu.transitionend.transition);function cb(t){if(nx[t])return nx[t];if(!Yu[t])return t;var e=Yu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in z5)return nx[t]=e[n];return t}var U5=cb("animationend"),V5=cb("animationiteration"),H5=cb("animationstart"),W5=cb("transitionend"),G5=new Map,BN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xl(t,e){G5.set(t,e),du(e,[t])}for(var ix=0;ix<BN.length;ix++){var rx=BN[ix],gG=rx.toLowerCase(),vG=rx[0].toUpperCase()+rx.slice(1);Xl(gG,"on"+vG)}Xl(U5,"onAnimationEnd");Xl(V5,"onAnimationIteration");Xl(H5,"onAnimationStart");Xl("dblclick","onDoubleClick");Xl("focusin","onFocus");Xl("focusout","onBlur");Xl(W5,"onTransitionEnd");Hd("onMouseEnter",["mouseout","mouseover"]);Hd("onMouseLeave",["mouseout","mouseover"]);Hd("onPointerEnter",["pointerout","pointerover"]);Hd("onPointerLeave",["pointerout","pointerover"]);du("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));du("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));du("onBeforeInput",["compositionend","keypress","textInput","paste"]);du("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));du("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));du("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yG=new Set("cancel close invalid load scroll toggle".split(" ").concat(yh));function $N(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,gW(i,e,void 0,t),t.currentTarget=null}function q5(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;$N(r,a,c),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;$N(r,a,c),s=l}}}if(Ev)throw t=IS,Ev=!1,IS=null,t}function Yt(t,e){var n=e[US];n===void 0&&(n=e[US]=new Set);var i=t+"__bubble";n.has(i)||(K5(e,t,2,!1),n.add(i))}function sx(t,e,n){var i=0;e&&(i|=4),K5(n,t,i,e)}var vg="_reactListening"+Math.random().toString(36).slice(2);function wp(t){if(!t[vg]){t[vg]=!0,t5.forEach(function(n){n!=="selectionchange"&&(yG.has(n)||sx(n,!1,t),sx(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[vg]||(e[vg]=!0,sx("selectionchange",!1,e))}}function K5(t,e,n,i){switch(R5(e)){case 1:var r=IW;break;case 4:r=TW;break;default:r=J_}n=r.bind(null,e,n,t),r=void 0,!RS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function ox(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Mc(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}v5(function(){var c=s,u=q_(n),d=[];e:{var f=G5.get(t);if(f!==void 0){var p=Q_,m=t;switch(t){case"keypress":if(I0(n)===0)break e;case"keydown":case"keyup":p=KW;break;case"focusin":m="focus",p=Q1;break;case"focusout":m="blur",p=Q1;break;case"beforeblur":case"afterblur":p=Q1;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=AN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=DW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=JW;break;case U5:case V5:case H5:p=$W;break;case W5:p=QW;break;case"scroll":p=OW;break;case"wheel":p=tG;break;case"copy":case"cut":case"paste":p=zW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=NN}var g=(e&4)!==0,y=!g&&t==="scroll",v=g?f!==null?f+"Capture":null:f;g=[];for(var b=c,w;b!==null;){w=b;var k=w.stateNode;if(w.tag===5&&k!==null&&(w=k,v!==null&&(k=mp(b,v),k!=null&&g.push(Sp(b,k,w)))),y)break;b=b.return}0<g.length&&(f=new p(f,m,null,n,u),d.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==NS&&(m=n.relatedTarget||n.fromElement)&&(Mc(m)||m[fa]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=c,m=m?Mc(m):null,m!==null&&(y=fu(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=c),p!==m)){if(g=AN,k="onMouseLeave",v="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(g=NN,k="onPointerLeave",v="onPointerEnter",b="pointer"),y=p==null?f:Ju(p),w=m==null?f:Ju(m),f=new g(k,b+"leave",p,n,u),f.target=y,f.relatedTarget=w,k=null,Mc(u)===c&&(g=new g(v,b+"enter",m,n,u),g.target=w,g.relatedTarget=y,k=g),y=k,p&&m)t:{for(g=p,v=m,b=0,w=g;w;w=bu(w))b++;for(w=0,k=v;k;k=bu(k))w++;for(;0<b-w;)g=bu(g),b--;for(;0<w-b;)v=bu(v),w--;for(;b--;){if(g===v||v!==null&&g===v.alternate)break t;g=bu(g),v=bu(v)}g=null}else g=null;p!==null&&FN(d,f,p,g,!1),m!==null&&y!==null&&FN(d,y,m,g,!0)}}e:{if(f=c?Ju(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var C=lG;else if(IN(f))if(j5)C=fG;else{C=uG;var E=cG}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=dG);if(C&&(C=C(t,c))){D5(d,C,n,u);break e}E&&E(t,f,c),t==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&_S(f,"number",f.value)}switch(E=c?Ju(c):window,t){case"focusin":(IN(E)||E.contentEditable==="true")&&(Xu=E,DS=c,Uh=null);break;case"focusout":Uh=DS=Xu=null;break;case"mousedown":jS=!0;break;case"contextmenu":case"mouseup":case"dragend":jS=!1,jN(d,n,u);break;case"selectionchange":if(mG)break;case"keydown":case"keyup":jN(d,n,u)}var _;if(tC)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Ku?O5(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(T5&&n.locale!=="ko"&&(Ku||A!=="onCompositionStart"?A==="onCompositionEnd"&&Ku&&(_=I5()):(rl=u,Z_="value"in rl?rl.value:rl.textContent,Ku=!0)),E=Rv(c,A),0<E.length&&(A=new PN(A,t,null,n,u),d.push({event:A,listeners:E}),_?A.data=_:(_=L5(n),_!==null&&(A.data=_)))),(_=iG?rG(t,n):sG(t,n))&&(c=Rv(c,"onBeforeInput"),0<c.length&&(u=new PN("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=_))}q5(d,e)})}function Sp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Rv(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=mp(t,n),s!=null&&i.unshift(Sp(t,s,r)),s=mp(t,e),s!=null&&i.push(Sp(t,s,r))),t=t.return}return i}function bu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function FN(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&c!==null&&(a=c,r?(l=mp(n,s),l!=null&&o.unshift(Sp(n,l,a))):r||(l=mp(n,s),l!=null&&o.push(Sp(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var bG=/\r\n?/g,xG=/\u0000|\uFFFD/g;function zN(t){return(typeof t=="string"?t:""+t).replace(bG,`
`).replace(xG,"")}function yg(t,e,n){if(e=zN(e),zN(t)!==e&&n)throw Error(de(425))}function Iv(){}var BS=null,$S=null;function FS(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var zS=typeof setTimeout=="function"?setTimeout:void 0,wG=typeof clearTimeout=="function"?clearTimeout:void 0,UN=typeof Promise=="function"?Promise:void 0,SG=typeof queueMicrotask=="function"?queueMicrotask:typeof UN<"u"?function(t){return UN.resolve(null).then(t).catch(kG)}:zS;function kG(t){setTimeout(function(){throw t})}function ax(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),yp(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);yp(e)}function xl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function VN(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Sf=Math.random().toString(36).slice(2),oo="__reactFiber$"+Sf,kp="__reactProps$"+Sf,fa="__reactContainer$"+Sf,US="__reactEvents$"+Sf,_G="__reactListeners$"+Sf,CG="__reactHandles$"+Sf;function Mc(t){var e=t[oo];if(e)return e;for(var n=t.parentNode;n;){if(e=n[fa]||n[oo]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=VN(t);t!==null;){if(n=t[oo])return n;t=VN(t)}return e}t=n,n=t.parentNode}return null}function Sm(t){return t=t[oo]||t[fa],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ju(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(de(33))}function ub(t){return t[kp]||null}var VS=[],Zu=-1;function Yl(t){return{current:t}}function tn(t){0>Zu||(t.current=VS[Zu],VS[Zu]=null,Zu--)}function Xt(t,e){Zu++,VS[Zu]=t.current,t.current=e}var Rl={},Si=Yl(Rl),ar=Yl(!1),Gc=Rl;function Wd(t,e){var n=t.type.contextTypes;if(!n)return Rl;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function lr(t){return t=t.childContextTypes,t!=null}function Tv(){tn(ar),tn(Si)}function HN(t,e,n){if(Si.current!==Rl)throw Error(de(168));Xt(Si,e),Xt(ar,n)}function X5(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(de(108,cW(t)||"Unknown",r));return gn({},n,i)}function Ov(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Rl,Gc=Si.current,Xt(Si,t),Xt(ar,ar.current),!0}function WN(t,e,n){var i=t.stateNode;if(!i)throw Error(de(169));n?(t=X5(t,e,Gc),i.__reactInternalMemoizedMergedChildContext=t,tn(ar),tn(Si),Xt(Si,t)):tn(ar),Xt(ar,n)}var Vo=null,db=!1,lx=!1;function Y5(t){Vo===null?Vo=[t]:Vo.push(t)}function EG(t){db=!0,Y5(t)}function Jl(){if(!lx&&Vo!==null){lx=!0;var t=0,e=jt;try{var n=Vo;for(jt=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Vo=null,db=!1}catch(r){throw Vo!==null&&(Vo=Vo.slice(t+1)),w5(K_,Jl),r}finally{jt=e,lx=!1}}return null}var Qu=[],ed=0,Lv=null,Dv=0,Wr=[],Gr=0,qc=null,oa=1,aa="";function Sc(t,e){Qu[ed++]=Dv,Qu[ed++]=Lv,Lv=t,Dv=e}function J5(t,e,n){Wr[Gr++]=oa,Wr[Gr++]=aa,Wr[Gr++]=qc,qc=t;var i=oa;t=aa;var r=32-Ts(i)-1;i&=~(1<<r),n+=1;var s=32-Ts(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,oa=1<<32-Ts(e)+r|n<<r|i,aa=s+t}else oa=1<<s|n<<r|i,aa=t}function iC(t){t.return!==null&&(Sc(t,1),J5(t,1,0))}function rC(t){for(;t===Lv;)Lv=Qu[--ed],Qu[ed]=null,Dv=Qu[--ed],Qu[ed]=null;for(;t===qc;)qc=Wr[--Gr],Wr[Gr]=null,aa=Wr[--Gr],Wr[Gr]=null,oa=Wr[--Gr],Wr[Gr]=null}var Nr=null,_r=null,ln=!1,Es=null;function Z5(t,e){var n=Yr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function GN(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Nr=t,_r=xl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Nr=t,_r=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=qc!==null?{id:oa,overflow:aa}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Yr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Nr=t,_r=null,!0):!1;default:return!1}}function HS(t){return(t.mode&1)!==0&&(t.flags&128)===0}function WS(t){if(ln){var e=_r;if(e){var n=e;if(!GN(t,e)){if(HS(t))throw Error(de(418));e=xl(n.nextSibling);var i=Nr;e&&GN(t,e)?Z5(i,n):(t.flags=t.flags&-4097|2,ln=!1,Nr=t)}}else{if(HS(t))throw Error(de(418));t.flags=t.flags&-4097|2,ln=!1,Nr=t}}}function qN(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Nr=t}function bg(t){if(t!==Nr)return!1;if(!ln)return qN(t),ln=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!FS(t.type,t.memoizedProps)),e&&(e=_r)){if(HS(t))throw Q5(),Error(de(418));for(;e;)Z5(t,e),e=xl(e.nextSibling)}if(qN(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(de(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){_r=xl(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}_r=null}}else _r=Nr?xl(t.stateNode.nextSibling):null;return!0}function Q5(){for(var t=_r;t;)t=xl(t.nextSibling)}function Gd(){_r=Nr=null,ln=!1}function sC(t){Es===null?Es=[t]:Es.push(t)}var AG=wa.ReactCurrentBatchConfig;function Hf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(de(309));var i=n.stateNode}if(!i)throw Error(de(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(de(284));if(!n._owner)throw Error(de(290,t))}return t}function xg(t,e){throw t=Object.prototype.toString.call(e),Error(de(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function KN(t){var e=t._init;return e(t._payload)}function eL(t){function e(v,b){if(t){var w=v.deletions;w===null?(v.deletions=[b],v.flags|=16):w.push(b)}}function n(v,b){if(!t)return null;for(;b!==null;)e(v,b),b=b.sibling;return null}function i(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function r(v,b){return v=_l(v,b),v.index=0,v.sibling=null,v}function s(v,b,w){return v.index=w,t?(w=v.alternate,w!==null?(w=w.index,w<b?(v.flags|=2,b):w):(v.flags|=2,b)):(v.flags|=1048576,b)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,b,w,k){return b===null||b.tag!==6?(b=mx(w,v.mode,k),b.return=v,b):(b=r(b,w),b.return=v,b)}function l(v,b,w,k){var C=w.type;return C===qu?u(v,b,w.props.children,k,w.key):b!==null&&(b.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===$a&&KN(C)===b.type)?(k=r(b,w.props),k.ref=Hf(v,b,w),k.return=v,k):(k=$0(w.type,w.key,w.props,null,v.mode,k),k.ref=Hf(v,b,w),k.return=v,k)}function c(v,b,w,k){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=gx(w,v.mode,k),b.return=v,b):(b=r(b,w.children||[]),b.return=v,b)}function u(v,b,w,k,C){return b===null||b.tag!==7?(b=$c(w,v.mode,k,C),b.return=v,b):(b=r(b,w),b.return=v,b)}function d(v,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=mx(""+b,v.mode,w),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case cg:return w=$0(b.type,b.key,b.props,null,v.mode,w),w.ref=Hf(v,null,b),w.return=v,w;case Gu:return b=gx(b,v.mode,w),b.return=v,b;case $a:var k=b._init;return d(v,k(b._payload),w)}if(gh(b)||$f(b))return b=$c(b,v.mode,w,null),b.return=v,b;xg(v,b)}return null}function f(v,b,w,k){var C=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:a(v,b,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case cg:return w.key===C?l(v,b,w,k):null;case Gu:return w.key===C?c(v,b,w,k):null;case $a:return C=w._init,f(v,b,C(w._payload),k)}if(gh(w)||$f(w))return C!==null?null:u(v,b,w,k,null);xg(v,w)}return null}function p(v,b,w,k,C){if(typeof k=="string"&&k!==""||typeof k=="number")return v=v.get(w)||null,a(b,v,""+k,C);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case cg:return v=v.get(k.key===null?w:k.key)||null,l(b,v,k,C);case Gu:return v=v.get(k.key===null?w:k.key)||null,c(b,v,k,C);case $a:var E=k._init;return p(v,b,w,E(k._payload),C)}if(gh(k)||$f(k))return v=v.get(w)||null,u(b,v,k,C,null);xg(b,k)}return null}function m(v,b,w,k){for(var C=null,E=null,_=b,A=b=0,R=null;_!==null&&A<w.length;A++){_.index>A?(R=_,_=null):R=_.sibling;var L=f(v,_,w[A],k);if(L===null){_===null&&(_=R);break}t&&_&&L.alternate===null&&e(v,_),b=s(L,b,A),E===null?C=L:E.sibling=L,E=L,_=R}if(A===w.length)return n(v,_),ln&&Sc(v,A),C;if(_===null){for(;A<w.length;A++)_=d(v,w[A],k),_!==null&&(b=s(_,b,A),E===null?C=_:E.sibling=_,E=_);return ln&&Sc(v,A),C}for(_=i(v,_);A<w.length;A++)R=p(_,v,A,w[A],k),R!==null&&(t&&R.alternate!==null&&_.delete(R.key===null?A:R.key),b=s(R,b,A),E===null?C=R:E.sibling=R,E=R);return t&&_.forEach(function(O){return e(v,O)}),ln&&Sc(v,A),C}function g(v,b,w,k){var C=$f(w);if(typeof C!="function")throw Error(de(150));if(w=C.call(w),w==null)throw Error(de(151));for(var E=C=null,_=b,A=b=0,R=null,L=w.next();_!==null&&!L.done;A++,L=w.next()){_.index>A?(R=_,_=null):R=_.sibling;var O=f(v,_,L.value,k);if(O===null){_===null&&(_=R);break}t&&_&&O.alternate===null&&e(v,_),b=s(O,b,A),E===null?C=O:E.sibling=O,E=O,_=R}if(L.done)return n(v,_),ln&&Sc(v,A),C;if(_===null){for(;!L.done;A++,L=w.next())L=d(v,L.value,k),L!==null&&(b=s(L,b,A),E===null?C=L:E.sibling=L,E=L);return ln&&Sc(v,A),C}for(_=i(v,_);!L.done;A++,L=w.next())L=p(_,v,A,L.value,k),L!==null&&(t&&L.alternate!==null&&_.delete(L.key===null?A:L.key),b=s(L,b,A),E===null?C=L:E.sibling=L,E=L);return t&&_.forEach(function(I){return e(v,I)}),ln&&Sc(v,A),C}function y(v,b,w,k){if(typeof w=="object"&&w!==null&&w.type===qu&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case cg:e:{for(var C=w.key,E=b;E!==null;){if(E.key===C){if(C=w.type,C===qu){if(E.tag===7){n(v,E.sibling),b=r(E,w.props.children),b.return=v,v=b;break e}}else if(E.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===$a&&KN(C)===E.type){n(v,E.sibling),b=r(E,w.props),b.ref=Hf(v,E,w),b.return=v,v=b;break e}n(v,E);break}else e(v,E);E=E.sibling}w.type===qu?(b=$c(w.props.children,v.mode,k,w.key),b.return=v,v=b):(k=$0(w.type,w.key,w.props,null,v.mode,k),k.ref=Hf(v,b,w),k.return=v,v=k)}return o(v);case Gu:e:{for(E=w.key;b!==null;){if(b.key===E)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){n(v,b.sibling),b=r(b,w.children||[]),b.return=v,v=b;break e}else{n(v,b);break}else e(v,b);b=b.sibling}b=gx(w,v.mode,k),b.return=v,v=b}return o(v);case $a:return E=w._init,y(v,b,E(w._payload),k)}if(gh(w))return m(v,b,w,k);if($f(w))return g(v,b,w,k);xg(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(n(v,b.sibling),b=r(b,w),b.return=v,v=b):(n(v,b),b=mx(w,v.mode,k),b.return=v,v=b),o(v)):n(v,b)}return y}var qd=eL(!0),tL=eL(!1),jv=Yl(null),Bv=null,td=null,oC=null;function aC(){oC=td=Bv=null}function lC(t){var e=jv.current;tn(jv),t._currentValue=e}function GS(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function vd(t,e){Bv=t,oC=td=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(sr=!0),t.firstContext=null)}function cs(t){var e=t._currentValue;if(oC!==t)if(t={context:t,memoizedValue:e,next:null},td===null){if(Bv===null)throw Error(de(308));td=t,Bv.dependencies={lanes:0,firstContext:t}}else td=td.next=t;return e}var Rc=null;function cC(t){Rc===null?Rc=[t]:Rc.push(t)}function nL(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,cC(e)):(n.next=r.next,r.next=n),e.interleaved=n,ha(t,i)}function ha(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fa=!1;function uC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function iL(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function la(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function wl(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Pt&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,ha(t,n)}return r=i.interleaved,r===null?(e.next=e,cC(i)):(e.next=r.next,r.next=e),i.interleaved=e,ha(t,n)}function T0(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,X_(t,n)}}function XN(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function $v(t,e,n,i){var r=t.updateQueue;Fa=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=r.baseState;o=0,u=c=l=null,a=s;do{var f=a.lane,p=a.eventTime;if((i&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,g=a;switch(f=e,p=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){d=m.call(p,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,f=typeof m=="function"?m.call(p,d,f):m,f==null)break e;d=gn({},d,f);break e;case 2:Fa=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Xc|=o,t.lanes=o,t.memoizedState=d}}function YN(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(de(191,r));r.call(i)}}}var km={},ko=Yl(km),_p=Yl(km),Cp=Yl(km);function Ic(t){if(t===km)throw Error(de(174));return t}function dC(t,e){switch(Xt(Cp,e),Xt(_p,t),Xt(ko,km),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ES(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ES(e,t)}tn(ko),Xt(ko,e)}function Kd(){tn(ko),tn(_p),tn(Cp)}function rL(t){Ic(Cp.current);var e=Ic(ko.current),n=ES(e,t.type);e!==n&&(Xt(_p,t),Xt(ko,n))}function fC(t){_p.current===t&&(tn(ko),tn(_p))}var dn=Yl(0);function Fv(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var cx=[];function hC(){for(var t=0;t<cx.length;t++)cx[t]._workInProgressVersionPrimary=null;cx.length=0}var O0=wa.ReactCurrentDispatcher,ux=wa.ReactCurrentBatchConfig,Kc=0,mn=null,Ln=null,Wn=null,zv=!1,Vh=!1,Ep=0,PG=0;function fi(){throw Error(de(321))}function pC(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ls(t[n],e[n]))return!1;return!0}function mC(t,e,n,i,r,s){if(Kc=s,mn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,O0.current=t===null||t.memoizedState===null?IG:TG,t=n(i,r),Vh){s=0;do{if(Vh=!1,Ep=0,25<=s)throw Error(de(301));s+=1,Wn=Ln=null,e.updateQueue=null,O0.current=OG,t=n(i,r)}while(Vh)}if(O0.current=Uv,e=Ln!==null&&Ln.next!==null,Kc=0,Wn=Ln=mn=null,zv=!1,e)throw Error(de(300));return t}function gC(){var t=Ep!==0;return Ep=0,t}function Js(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?mn.memoizedState=Wn=t:Wn=Wn.next=t,Wn}function us(){if(Ln===null){var t=mn.alternate;t=t!==null?t.memoizedState:null}else t=Ln.next;var e=Wn===null?mn.memoizedState:Wn.next;if(e!==null)Wn=e,Ln=t;else{if(t===null)throw Error(de(310));Ln=t,t={memoizedState:Ln.memoizedState,baseState:Ln.baseState,baseQueue:Ln.baseQueue,queue:Ln.queue,next:null},Wn===null?mn.memoizedState=Wn=t:Wn=Wn.next=t}return Wn}function Ap(t,e){return typeof e=="function"?e(t):e}function dx(t){var e=us(),n=e.queue;if(n===null)throw Error(de(311));n.lastRenderedReducer=t;var i=Ln,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((Kc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:t(i,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=i):l=l.next=d,mn.lanes|=u,Xc|=u}c=c.next}while(c!==null&&c!==s);l===null?o=i:l.next=a,Ls(i,e.memoizedState)||(sr=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,mn.lanes|=s,Xc|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function fx(t){var e=us(),n=e.queue;if(n===null)throw Error(de(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);Ls(s,e.memoizedState)||(sr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function sL(){}function oL(t,e){var n=mn,i=us(),r=e(),s=!Ls(i.memoizedState,r);if(s&&(i.memoizedState=r,sr=!0),i=i.queue,vC(cL.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||Wn!==null&&Wn.memoizedState.tag&1){if(n.flags|=2048,Pp(9,lL.bind(null,n,i,r,e),void 0,null),Gn===null)throw Error(de(349));Kc&30||aL(n,e,r)}return r}function aL(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=mn.updateQueue,e===null?(e={lastEffect:null,stores:null},mn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function lL(t,e,n,i){e.value=n,e.getSnapshot=i,uL(e)&&dL(t)}function cL(t,e,n){return n(function(){uL(e)&&dL(t)})}function uL(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ls(t,n)}catch{return!0}}function dL(t){var e=ha(t,1);e!==null&&Os(e,t,1,-1)}function JN(t){var e=Js();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ap,lastRenderedState:t},e.queue=t,t=t.dispatch=RG.bind(null,mn,t),[e.memoizedState,t]}function Pp(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=mn.updateQueue,e===null?(e={lastEffect:null,stores:null},mn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function fL(){return us().memoizedState}function L0(t,e,n,i){var r=Js();mn.flags|=t,r.memoizedState=Pp(1|e,n,void 0,i===void 0?null:i)}function fb(t,e,n,i){var r=us();i=i===void 0?null:i;var s=void 0;if(Ln!==null){var o=Ln.memoizedState;if(s=o.destroy,i!==null&&pC(i,o.deps)){r.memoizedState=Pp(e,n,s,i);return}}mn.flags|=t,r.memoizedState=Pp(1|e,n,s,i)}function ZN(t,e){return L0(8390656,8,t,e)}function vC(t,e){return fb(2048,8,t,e)}function hL(t,e){return fb(4,2,t,e)}function pL(t,e){return fb(4,4,t,e)}function mL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function gL(t,e,n){return n=n!=null?n.concat([t]):null,fb(4,4,mL.bind(null,e,t),n)}function yC(){}function vL(t,e){var n=us();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&pC(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function yL(t,e){var n=us();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&pC(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function bL(t,e,n){return Kc&21?(Ls(n,e)||(n=_5(),mn.lanes|=n,Xc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,sr=!0),t.memoizedState=n)}function NG(t,e){var n=jt;jt=n!==0&&4>n?n:4,t(!0);var i=ux.transition;ux.transition={};try{t(!1),e()}finally{jt=n,ux.transition=i}}function xL(){return us().memoizedState}function MG(t,e,n){var i=kl(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},wL(t))SL(e,n);else if(n=nL(t,e,n,i),n!==null){var r=Ii();Os(n,t,i,r),kL(n,e,i)}}function RG(t,e,n){var i=kl(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(wL(t))SL(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,Ls(a,o)){var l=e.interleaved;l===null?(r.next=r,cC(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=nL(t,e,r,i),n!==null&&(r=Ii(),Os(n,t,i,r),kL(n,e,i))}}function wL(t){var e=t.alternate;return t===mn||e!==null&&e===mn}function SL(t,e){Vh=zv=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function kL(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,X_(t,n)}}var Uv={readContext:cs,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},IG={readContext:cs,useCallback:function(t,e){return Js().memoizedState=[t,e===void 0?null:e],t},useContext:cs,useEffect:ZN,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,L0(4194308,4,mL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return L0(4194308,4,t,e)},useInsertionEffect:function(t,e){return L0(4,2,t,e)},useMemo:function(t,e){var n=Js();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=Js();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=MG.bind(null,mn,t),[i.memoizedState,t]},useRef:function(t){var e=Js();return t={current:t},e.memoizedState=t},useState:JN,useDebugValue:yC,useDeferredValue:function(t){return Js().memoizedState=t},useTransition:function(){var t=JN(!1),e=t[0];return t=NG.bind(null,t[1]),Js().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=mn,r=Js();if(ln){if(n===void 0)throw Error(de(407));n=n()}else{if(n=e(),Gn===null)throw Error(de(349));Kc&30||aL(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,ZN(cL.bind(null,i,s,t),[t]),i.flags|=2048,Pp(9,lL.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=Js(),e=Gn.identifierPrefix;if(ln){var n=aa,i=oa;n=(i&~(1<<32-Ts(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ep++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=PG++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},TG={readContext:cs,useCallback:vL,useContext:cs,useEffect:vC,useImperativeHandle:gL,useInsertionEffect:hL,useLayoutEffect:pL,useMemo:yL,useReducer:dx,useRef:fL,useState:function(){return dx(Ap)},useDebugValue:yC,useDeferredValue:function(t){var e=us();return bL(e,Ln.memoizedState,t)},useTransition:function(){var t=dx(Ap)[0],e=us().memoizedState;return[t,e]},useMutableSource:sL,useSyncExternalStore:oL,useId:xL,unstable_isNewReconciler:!1},OG={readContext:cs,useCallback:vL,useContext:cs,useEffect:vC,useImperativeHandle:gL,useInsertionEffect:hL,useLayoutEffect:pL,useMemo:yL,useReducer:fx,useRef:fL,useState:function(){return fx(Ap)},useDebugValue:yC,useDeferredValue:function(t){var e=us();return Ln===null?e.memoizedState=t:bL(e,Ln.memoizedState,t)},useTransition:function(){var t=fx(Ap)[0],e=us().memoizedState;return[t,e]},useMutableSource:sL,useSyncExternalStore:oL,useId:xL,unstable_isNewReconciler:!1};function xs(t,e){if(t&&t.defaultProps){e=gn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function qS(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:gn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var hb={isMounted:function(t){return(t=t._reactInternals)?fu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Ii(),r=kl(t),s=la(i,r);s.payload=e,n!=null&&(s.callback=n),e=wl(t,s,r),e!==null&&(Os(e,t,r,i),T0(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Ii(),r=kl(t),s=la(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=wl(t,s,r),e!==null&&(Os(e,t,r,i),T0(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ii(),i=kl(t),r=la(n,i);r.tag=2,e!=null&&(r.callback=e),e=wl(t,r,i),e!==null&&(Os(e,t,i,n),T0(e,t,i))}};function QN(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!xp(n,i)||!xp(r,s):!0}function _L(t,e,n){var i=!1,r=Rl,s=e.contextType;return typeof s=="object"&&s!==null?s=cs(s):(r=lr(e)?Gc:Si.current,i=e.contextTypes,s=(i=i!=null)?Wd(t,r):Rl),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=hb,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function eM(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&hb.enqueueReplaceState(e,e.state,null)}function KS(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},uC(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=cs(s):(s=lr(e)?Gc:Si.current,r.context=Wd(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(qS(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&hb.enqueueReplaceState(r,r.state,null),$v(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Xd(t,e){try{var n="",i=e;do n+=lW(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function hx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function XS(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var LG=typeof WeakMap=="function"?WeakMap:Map;function CL(t,e,n){n=la(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Hv||(Hv=!0,s2=i),XS(t,e)},n}function EL(t,e,n){n=la(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){XS(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){XS(t,e),typeof i!="function"&&(Sl===null?Sl=new Set([this]):Sl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function tM(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new LG;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=XG.bind(null,t,e,n),e.then(t,t))}function nM(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function iM(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=la(-1,1),e.tag=2,wl(n,e,1))),n.lanes|=1),t)}var DG=wa.ReactCurrentOwner,sr=!1;function Mi(t,e,n,i){e.child=t===null?tL(e,null,n,i):qd(e,t.child,n,i)}function rM(t,e,n,i,r){n=n.render;var s=e.ref;return vd(e,r),i=mC(t,e,n,i,s,r),n=gC(),t!==null&&!sr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,pa(t,e,r)):(ln&&n&&iC(e),e.flags|=1,Mi(t,e,i,r),e.child)}function sM(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!EC(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,AL(t,e,s,i,r)):(t=$0(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:xp,n(o,i)&&t.ref===e.ref)return pa(t,e,r)}return e.flags|=1,t=_l(s,i),t.ref=e.ref,t.return=e,e.child=t}function AL(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(xp(s,i)&&t.ref===e.ref)if(sr=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(sr=!0);else return e.lanes=t.lanes,pa(t,e,r)}return YS(t,e,n,i,r)}function PL(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xt(id,yr),yr|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Xt(id,yr),yr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,Xt(id,yr),yr|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,Xt(id,yr),yr|=i;return Mi(t,e,r,n),e.child}function NL(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function YS(t,e,n,i,r){var s=lr(n)?Gc:Si.current;return s=Wd(e,s),vd(e,r),n=mC(t,e,n,i,s,r),i=gC(),t!==null&&!sr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,pa(t,e,r)):(ln&&i&&iC(e),e.flags|=1,Mi(t,e,n,r),e.child)}function oM(t,e,n,i,r){if(lr(n)){var s=!0;Ov(e)}else s=!1;if(vd(e,r),e.stateNode===null)D0(t,e),_L(e,n,i),KS(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=cs(c):(c=lr(n)?Gc:Si.current,c=Wd(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==c)&&eM(e,o,i,c),Fa=!1;var f=e.memoizedState;o.state=f,$v(e,i,o,r),l=e.memoizedState,a!==i||f!==l||ar.current||Fa?(typeof u=="function"&&(qS(e,n,u,i),l=e.memoizedState),(a=Fa||QN(e,n,a,i,f,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,iL(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:xs(e.type,a),o.props=c,d=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=cs(l):(l=lr(n)?Gc:Si.current,l=Wd(e,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==l)&&eM(e,o,i,l),Fa=!1,f=e.memoizedState,o.state=f,$v(e,i,o,r);var m=e.memoizedState;a!==d||f!==m||ar.current||Fa?(typeof p=="function"&&(qS(e,n,p,i),m=e.memoizedState),(c=Fa||QN(e,n,c,i,f,m,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=m),o.props=i,o.state=m,o.context=l,i=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),i=!1)}return JS(t,e,n,i,s,r)}function JS(t,e,n,i,r,s){NL(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&WN(e,n,!1),pa(t,e,s);i=e.stateNode,DG.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=qd(e,t.child,null,s),e.child=qd(e,null,a,s)):Mi(t,e,a,s),e.memoizedState=i.state,r&&WN(e,n,!0),e.child}function ML(t){var e=t.stateNode;e.pendingContext?HN(t,e.pendingContext,e.pendingContext!==e.context):e.context&&HN(t,e.context,!1),dC(t,e.containerInfo)}function aM(t,e,n,i,r){return Gd(),sC(r),e.flags|=256,Mi(t,e,n,i),e.child}var ZS={dehydrated:null,treeContext:null,retryLane:0};function QS(t){return{baseLanes:t,cachePool:null,transitions:null}}function RL(t,e,n){var i=e.pendingProps,r=dn.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Xt(dn,r&1),t===null)return WS(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=gb(o,i,0,null),t=$c(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=QS(n),e.memoizedState=ZS,t):bC(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return jG(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=_l(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=_l(a,s):(s=$c(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?QS(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=ZS,i}return s=t.child,t=s.sibling,i=_l(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function bC(t,e){return e=gb({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function wg(t,e,n,i){return i!==null&&sC(i),qd(e,t.child,null,n),t=bC(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function jG(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=hx(Error(de(422))),wg(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=gb({mode:"visible",children:i.children},r,0,null),s=$c(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&qd(e,t.child,null,o),e.child.memoizedState=QS(o),e.memoizedState=ZS,s);if(!(e.mode&1))return wg(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(de(419)),i=hx(s,i,void 0),wg(t,e,o,i)}if(a=(o&t.childLanes)!==0,sr||a){if(i=Gn,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,ha(t,r),Os(i,t,r,-1))}return CC(),i=hx(Error(de(421))),wg(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=YG.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,_r=xl(r.nextSibling),Nr=e,ln=!0,Es=null,t!==null&&(Wr[Gr++]=oa,Wr[Gr++]=aa,Wr[Gr++]=qc,oa=t.id,aa=t.overflow,qc=e),e=bC(e,i.children),e.flags|=4096,e)}function lM(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),GS(t.return,e,n)}function px(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function IL(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Mi(t,e,i.children,n),i=dn.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&lM(t,n,e);else if(t.tag===19)lM(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Xt(dn,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Fv(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),px(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Fv(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}px(e,!0,n,null,s);break;case"together":px(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function D0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function pa(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Xc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(de(153));if(e.child!==null){for(t=e.child,n=_l(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=_l(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function BG(t,e,n){switch(e.tag){case 3:ML(e),Gd();break;case 5:rL(e);break;case 1:lr(e.type)&&Ov(e);break;case 4:dC(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Xt(jv,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Xt(dn,dn.current&1),e.flags|=128,null):n&e.child.childLanes?RL(t,e,n):(Xt(dn,dn.current&1),t=pa(t,e,n),t!==null?t.sibling:null);Xt(dn,dn.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return IL(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Xt(dn,dn.current),i)break;return null;case 22:case 23:return e.lanes=0,PL(t,e,n)}return pa(t,e,n)}var TL,e2,OL,LL;TL=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};e2=function(){};OL=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Ic(ko.current);var s=null;switch(n){case"input":r=SS(t,r),i=SS(t,i),s=[];break;case"select":r=gn({},r,{value:void 0}),i=gn({},i,{value:void 0}),s=[];break;case"textarea":r=CS(t,r),i=CS(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=Iv)}AS(n,i);var o;n=null;for(c in r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(hp.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(a=r!=null?r[c]:void 0,i.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(hp.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Yt("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};LL=function(t,e,n,i){n!==i&&(e.flags|=4)};function Wf(t,e){if(!ln)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function hi(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function $G(t,e,n){var i=e.pendingProps;switch(rC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hi(e),null;case 1:return lr(e.type)&&Tv(),hi(e),null;case 3:return i=e.stateNode,Kd(),tn(ar),tn(Si),hC(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(bg(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Es!==null&&(l2(Es),Es=null))),e2(t,e),hi(e),null;case 5:fC(e);var r=Ic(Cp.current);if(n=e.type,t!==null&&e.stateNode!=null)OL(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(de(166));return hi(e),null}if(t=Ic(ko.current),bg(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[oo]=e,i[kp]=s,t=(e.mode&1)!==0,n){case"dialog":Yt("cancel",i),Yt("close",i);break;case"iframe":case"object":case"embed":Yt("load",i);break;case"video":case"audio":for(r=0;r<yh.length;r++)Yt(yh[r],i);break;case"source":Yt("error",i);break;case"img":case"image":case"link":Yt("error",i),Yt("load",i);break;case"details":Yt("toggle",i);break;case"input":vN(i,s),Yt("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Yt("invalid",i);break;case"textarea":bN(i,s),Yt("invalid",i)}AS(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&yg(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&yg(i.textContent,a,t),r=["children",""+a]):hp.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Yt("scroll",i)}switch(n){case"input":ug(i),yN(i,s,!0);break;case"textarea":ug(i),xN(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Iv)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=c5(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[oo]=e,t[kp]=i,TL(t,e,!1,!1),e.stateNode=t;e:{switch(o=PS(n,i),n){case"dialog":Yt("cancel",t),Yt("close",t),r=i;break;case"iframe":case"object":case"embed":Yt("load",t),r=i;break;case"video":case"audio":for(r=0;r<yh.length;r++)Yt(yh[r],t);r=i;break;case"source":Yt("error",t),r=i;break;case"img":case"image":case"link":Yt("error",t),Yt("load",t),r=i;break;case"details":Yt("toggle",t),r=i;break;case"input":vN(t,i),r=SS(t,i),Yt("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=gn({},i,{value:void 0}),Yt("invalid",t);break;case"textarea":bN(t,i),r=CS(t,i),Yt("invalid",t);break;default:r=i}AS(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?f5(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&u5(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&pp(t,l):typeof l=="number"&&pp(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(hp.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Yt("scroll",t):l!=null&&V_(t,s,l,o))}switch(n){case"input":ug(t),yN(t,i,!1);break;case"textarea":ug(t),xN(t);break;case"option":i.value!=null&&t.setAttribute("value",""+Ml(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?hd(t,!!i.multiple,s,!1):i.defaultValue!=null&&hd(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Iv)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return hi(e),null;case 6:if(t&&e.stateNode!=null)LL(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(de(166));if(n=Ic(Cp.current),Ic(ko.current),bg(e)){if(i=e.stateNode,n=e.memoizedProps,i[oo]=e,(s=i.nodeValue!==n)&&(t=Nr,t!==null))switch(t.tag){case 3:yg(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&yg(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[oo]=e,e.stateNode=i}return hi(e),null;case 13:if(tn(dn),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ln&&_r!==null&&e.mode&1&&!(e.flags&128))Q5(),Gd(),e.flags|=98560,s=!1;else if(s=bg(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(de(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(de(317));s[oo]=e}else Gd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;hi(e),s=!1}else Es!==null&&(l2(Es),Es=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||dn.current&1?Fn===0&&(Fn=3):CC())),e.updateQueue!==null&&(e.flags|=4),hi(e),null);case 4:return Kd(),e2(t,e),t===null&&wp(e.stateNode.containerInfo),hi(e),null;case 10:return lC(e.type._context),hi(e),null;case 17:return lr(e.type)&&Tv(),hi(e),null;case 19:if(tn(dn),s=e.memoizedState,s===null)return hi(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Wf(s,!1);else{if(Fn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Fv(t),o!==null){for(e.flags|=128,Wf(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Xt(dn,dn.current&1|2),e.child}t=t.sibling}s.tail!==null&&En()>Yd&&(e.flags|=128,i=!0,Wf(s,!1),e.lanes=4194304)}else{if(!i)if(t=Fv(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Wf(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ln)return hi(e),null}else 2*En()-s.renderingStartTime>Yd&&n!==1073741824&&(e.flags|=128,i=!0,Wf(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=En(),e.sibling=null,n=dn.current,Xt(dn,i?n&1|2:n&1),e):(hi(e),null);case 22:case 23:return _C(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?yr&1073741824&&(hi(e),e.subtreeFlags&6&&(e.flags|=8192)):hi(e),null;case 24:return null;case 25:return null}throw Error(de(156,e.tag))}function FG(t,e){switch(rC(e),e.tag){case 1:return lr(e.type)&&Tv(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Kd(),tn(ar),tn(Si),hC(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return fC(e),null;case 13:if(tn(dn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(de(340));Gd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return tn(dn),null;case 4:return Kd(),null;case 10:return lC(e.type._context),null;case 22:case 23:return _C(),null;case 24:return null;default:return null}}var Sg=!1,bi=!1,zG=typeof WeakSet=="function"?WeakSet:Set,Te=null;function nd(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){bn(t,e,i)}else n.current=null}function t2(t,e,n){try{n()}catch(i){bn(t,e,i)}}var cM=!1;function UG(t,e){if(BS=Nv,t=F5(),nC(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,f=null;t:for(;;){for(var p;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(l=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===t)break t;if(f===n&&++c===r&&(a=o),f===s&&++u===i&&(l=o),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for($S={focusedElem:t,selectionRange:n},Nv=!1,Te=e;Te!==null;)if(e=Te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Te=t;else for(;Te!==null;){e=Te;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:xs(e.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(de(163))}}catch(k){bn(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,Te=t;break}Te=e.return}return m=cM,cM=!1,m}function Hh(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&t2(e,n,s)}r=r.next}while(r!==i)}}function pb(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function n2(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function DL(t){var e=t.alternate;e!==null&&(t.alternate=null,DL(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[oo],delete e[kp],delete e[US],delete e[_G],delete e[CG])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function jL(t){return t.tag===5||t.tag===3||t.tag===4}function uM(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||jL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function i2(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Iv));else if(i!==4&&(t=t.child,t!==null))for(i2(t,e,n),t=t.sibling;t!==null;)i2(t,e,n),t=t.sibling}function r2(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(r2(t,e,n),t=t.sibling;t!==null;)r2(t,e,n),t=t.sibling}var Jn=null,Cs=!1;function Ra(t,e,n){for(n=n.child;n!==null;)BL(t,e,n),n=n.sibling}function BL(t,e,n){if(So&&typeof So.onCommitFiberUnmount=="function")try{So.onCommitFiberUnmount(ob,n)}catch{}switch(n.tag){case 5:bi||nd(n,e);case 6:var i=Jn,r=Cs;Jn=null,Ra(t,e,n),Jn=i,Cs=r,Jn!==null&&(Cs?(t=Jn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Jn.removeChild(n.stateNode));break;case 18:Jn!==null&&(Cs?(t=Jn,n=n.stateNode,t.nodeType===8?ax(t.parentNode,n):t.nodeType===1&&ax(t,n),yp(t)):ax(Jn,n.stateNode));break;case 4:i=Jn,r=Cs,Jn=n.stateNode.containerInfo,Cs=!0,Ra(t,e,n),Jn=i,Cs=r;break;case 0:case 11:case 14:case 15:if(!bi&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&t2(n,e,o),r=r.next}while(r!==i)}Ra(t,e,n);break;case 1:if(!bi&&(nd(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){bn(n,e,a)}Ra(t,e,n);break;case 21:Ra(t,e,n);break;case 22:n.mode&1?(bi=(i=bi)||n.memoizedState!==null,Ra(t,e,n),bi=i):Ra(t,e,n);break;default:Ra(t,e,n)}}function dM(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new zG),e.forEach(function(i){var r=JG.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function ps(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Jn=a.stateNode,Cs=!1;break e;case 3:Jn=a.stateNode.containerInfo,Cs=!0;break e;case 4:Jn=a.stateNode.containerInfo,Cs=!0;break e}a=a.return}if(Jn===null)throw Error(de(160));BL(s,o,r),Jn=null,Cs=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){bn(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)$L(e,t),e=e.sibling}function $L(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ps(e,t),Hs(t),i&4){try{Hh(3,t,t.return),pb(3,t)}catch(g){bn(t,t.return,g)}try{Hh(5,t,t.return)}catch(g){bn(t,t.return,g)}}break;case 1:ps(e,t),Hs(t),i&512&&n!==null&&nd(n,n.return);break;case 5:if(ps(e,t),Hs(t),i&512&&n!==null&&nd(n,n.return),t.flags&32){var r=t.stateNode;try{pp(r,"")}catch(g){bn(t,t.return,g)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&a5(r,s),PS(a,o);var c=PS(a,s);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?f5(r,d):u==="dangerouslySetInnerHTML"?u5(r,d):u==="children"?pp(r,d):V_(r,u,d,c)}switch(a){case"input":kS(r,s);break;case"textarea":l5(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?hd(r,!!s.multiple,p,!1):f!==!!s.multiple&&(s.defaultValue!=null?hd(r,!!s.multiple,s.defaultValue,!0):hd(r,!!s.multiple,s.multiple?[]:"",!1))}r[kp]=s}catch(g){bn(t,t.return,g)}}break;case 6:if(ps(e,t),Hs(t),i&4){if(t.stateNode===null)throw Error(de(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(g){bn(t,t.return,g)}}break;case 3:if(ps(e,t),Hs(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{yp(e.containerInfo)}catch(g){bn(t,t.return,g)}break;case 4:ps(e,t),Hs(t);break;case 13:ps(e,t),Hs(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(SC=En())),i&4&&dM(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(bi=(c=bi)||u,ps(e,t),bi=c):ps(e,t),Hs(t),i&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Te=t,u=t.child;u!==null;){for(d=Te=u;Te!==null;){switch(f=Te,p=f.child,f.tag){case 0:case 11:case 14:case 15:Hh(4,f,f.return);break;case 1:nd(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){i=f,n=f.return;try{e=i,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){bn(i,n,g)}}break;case 5:nd(f,f.return);break;case 22:if(f.memoizedState!==null){hM(d);continue}}p!==null?(p.return=f,Te=p):hM(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=d5("display",o))}catch(g){bn(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){bn(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ps(e,t),Hs(t),i&4&&dM(t);break;case 21:break;default:ps(e,t),Hs(t)}}function Hs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(jL(n)){var i=n;break e}n=n.return}throw Error(de(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(pp(r,""),i.flags&=-33);var s=uM(t);r2(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=uM(t);i2(t,a,o);break;default:throw Error(de(161))}}catch(l){bn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function VG(t,e,n){Te=t,FL(t)}function FL(t,e,n){for(var i=(t.mode&1)!==0;Te!==null;){var r=Te,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||Sg;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||bi;a=Sg;var c=bi;if(Sg=o,(bi=l)&&!c)for(Te=r;Te!==null;)o=Te,l=o.child,o.tag===22&&o.memoizedState!==null?pM(r):l!==null?(l.return=o,Te=l):pM(r);for(;s!==null;)Te=s,FL(s),s=s.sibling;Te=r,Sg=a,bi=c}fM(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Te=s):fM(t)}}function fM(t){for(;Te!==null;){var e=Te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:bi||pb(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!bi)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:xs(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&YN(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}YN(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&yp(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(de(163))}bi||e.flags&512&&n2(e)}catch(f){bn(e,e.return,f)}}if(e===t){Te=null;break}if(n=e.sibling,n!==null){n.return=e.return,Te=n;break}Te=e.return}}function hM(t){for(;Te!==null;){var e=Te;if(e===t){Te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Te=n;break}Te=e.return}}function pM(t){for(;Te!==null;){var e=Te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{pb(4,e)}catch(l){bn(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){bn(e,r,l)}}var s=e.return;try{n2(e)}catch(l){bn(e,s,l)}break;case 5:var o=e.return;try{n2(e)}catch(l){bn(e,o,l)}}}catch(l){bn(e,e.return,l)}if(e===t){Te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Te=a;break}Te=e.return}}var HG=Math.ceil,Vv=wa.ReactCurrentDispatcher,xC=wa.ReactCurrentOwner,is=wa.ReactCurrentBatchConfig,Pt=0,Gn=null,Rn=null,ai=0,yr=0,id=Yl(0),Fn=0,Np=null,Xc=0,mb=0,wC=0,Wh=null,er=null,SC=0,Yd=1/0,Fo=null,Hv=!1,s2=null,Sl=null,kg=!1,sl=null,Wv=0,Gh=0,o2=null,j0=-1,B0=0;function Ii(){return Pt&6?En():j0!==-1?j0:j0=En()}function kl(t){return t.mode&1?Pt&2&&ai!==0?ai&-ai:AG.transition!==null?(B0===0&&(B0=_5()),B0):(t=jt,t!==0||(t=window.event,t=t===void 0?16:R5(t.type)),t):1}function Os(t,e,n,i){if(50<Gh)throw Gh=0,o2=null,Error(de(185));xm(t,n,i),(!(Pt&2)||t!==Gn)&&(t===Gn&&(!(Pt&2)&&(mb|=n),Fn===4&&Ja(t,ai)),cr(t,i),n===1&&Pt===0&&!(e.mode&1)&&(Yd=En()+500,db&&Jl()))}function cr(t,e){var n=t.callbackNode;AW(t,e);var i=Pv(t,t===Gn?ai:0);if(i===0)n!==null&&kN(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&kN(n),e===1)t.tag===0?EG(mM.bind(null,t)):Y5(mM.bind(null,t)),SG(function(){!(Pt&6)&&Jl()}),n=null;else{switch(C5(i)){case 1:n=K_;break;case 4:n=S5;break;case 16:n=Av;break;case 536870912:n=k5;break;default:n=Av}n=KL(n,zL.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function zL(t,e){if(j0=-1,B0=0,Pt&6)throw Error(de(327));var n=t.callbackNode;if(yd()&&t.callbackNode!==n)return null;var i=Pv(t,t===Gn?ai:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Gv(t,i);else{e=i;var r=Pt;Pt|=2;var s=VL();(Gn!==t||ai!==e)&&(Fo=null,Yd=En()+500,Bc(t,e));do try{qG();break}catch(a){UL(t,a)}while(!0);aC(),Vv.current=s,Pt=r,Rn!==null?e=0:(Gn=null,ai=0,e=Fn)}if(e!==0){if(e===2&&(r=TS(t),r!==0&&(i=r,e=a2(t,r))),e===1)throw n=Np,Bc(t,0),Ja(t,i),cr(t,En()),n;if(e===6)Ja(t,i);else{if(r=t.current.alternate,!(i&30)&&!WG(r)&&(e=Gv(t,i),e===2&&(s=TS(t),s!==0&&(i=s,e=a2(t,s))),e===1))throw n=Np,Bc(t,0),Ja(t,i),cr(t,En()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(de(345));case 2:kc(t,er,Fo);break;case 3:if(Ja(t,i),(i&130023424)===i&&(e=SC+500-En(),10<e)){if(Pv(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){Ii(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=zS(kc.bind(null,t,er,Fo),e);break}kc(t,er,Fo);break;case 4:if(Ja(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Ts(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=En()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*HG(i/1960))-i,10<i){t.timeoutHandle=zS(kc.bind(null,t,er,Fo),i);break}kc(t,er,Fo);break;case 5:kc(t,er,Fo);break;default:throw Error(de(329))}}}return cr(t,En()),t.callbackNode===n?zL.bind(null,t):null}function a2(t,e){var n=Wh;return t.current.memoizedState.isDehydrated&&(Bc(t,e).flags|=256),t=Gv(t,e),t!==2&&(e=er,er=n,e!==null&&l2(e)),t}function l2(t){er===null?er=t:er.push.apply(er,t)}function WG(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Ls(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ja(t,e){for(e&=~wC,e&=~mb,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ts(e),i=1<<n;t[n]=-1,e&=~i}}function mM(t){if(Pt&6)throw Error(de(327));yd();var e=Pv(t,0);if(!(e&1))return cr(t,En()),null;var n=Gv(t,e);if(t.tag!==0&&n===2){var i=TS(t);i!==0&&(e=i,n=a2(t,i))}if(n===1)throw n=Np,Bc(t,0),Ja(t,e),cr(t,En()),n;if(n===6)throw Error(de(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,kc(t,er,Fo),cr(t,En()),null}function kC(t,e){var n=Pt;Pt|=1;try{return t(e)}finally{Pt=n,Pt===0&&(Yd=En()+500,db&&Jl())}}function Yc(t){sl!==null&&sl.tag===0&&!(Pt&6)&&yd();var e=Pt;Pt|=1;var n=is.transition,i=jt;try{if(is.transition=null,jt=1,t)return t()}finally{jt=i,is.transition=n,Pt=e,!(Pt&6)&&Jl()}}function _C(){yr=id.current,tn(id)}function Bc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,wG(n)),Rn!==null)for(n=Rn.return;n!==null;){var i=n;switch(rC(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Tv();break;case 3:Kd(),tn(ar),tn(Si),hC();break;case 5:fC(i);break;case 4:Kd();break;case 13:tn(dn);break;case 19:tn(dn);break;case 10:lC(i.type._context);break;case 22:case 23:_C()}n=n.return}if(Gn=t,Rn=t=_l(t.current,null),ai=yr=e,Fn=0,Np=null,wC=mb=Xc=0,er=Wh=null,Rc!==null){for(e=0;e<Rc.length;e++)if(n=Rc[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}Rc=null}return t}function UL(t,e){do{var n=Rn;try{if(aC(),O0.current=Uv,zv){for(var i=mn.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}zv=!1}if(Kc=0,Wn=Ln=mn=null,Vh=!1,Ep=0,xC.current=null,n===null||n.return===null){Fn=1,Np=e,Rn=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=ai,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=nM(o);if(p!==null){p.flags&=-257,iM(p,o,a,s,e),p.mode&1&&tM(s,c,e),e=p,l=c;var m=e.updateQueue;if(m===null){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break e}else{if(!(e&1)){tM(s,c,e),CC();break e}l=Error(de(426))}}else if(ln&&a.mode&1){var y=nM(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),iM(y,o,a,s,e),sC(Xd(l,a));break e}}s=l=Xd(l,a),Fn!==4&&(Fn=2),Wh===null?Wh=[s]:Wh.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=CL(s,l,e);XN(s,v);break e;case 1:a=l;var b=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Sl===null||!Sl.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var k=EL(s,a,e);XN(s,k);break e}}s=s.return}while(s!==null)}WL(n)}catch(C){e=C,Rn===n&&n!==null&&(Rn=n=n.return);continue}break}while(!0)}function VL(){var t=Vv.current;return Vv.current=Uv,t===null?Uv:t}function CC(){(Fn===0||Fn===3||Fn===2)&&(Fn=4),Gn===null||!(Xc&268435455)&&!(mb&268435455)||Ja(Gn,ai)}function Gv(t,e){var n=Pt;Pt|=2;var i=VL();(Gn!==t||ai!==e)&&(Fo=null,Bc(t,e));do try{GG();break}catch(r){UL(t,r)}while(!0);if(aC(),Pt=n,Vv.current=i,Rn!==null)throw Error(de(261));return Gn=null,ai=0,Fn}function GG(){for(;Rn!==null;)HL(Rn)}function qG(){for(;Rn!==null&&!yW();)HL(Rn)}function HL(t){var e=qL(t.alternate,t,yr);t.memoizedProps=t.pendingProps,e===null?WL(t):Rn=e,xC.current=null}function WL(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=FG(n,e),n!==null){n.flags&=32767,Rn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Fn=6,Rn=null;return}}else if(n=$G(n,e,yr),n!==null){Rn=n;return}if(e=e.sibling,e!==null){Rn=e;return}Rn=e=t}while(e!==null);Fn===0&&(Fn=5)}function kc(t,e,n){var i=jt,r=is.transition;try{is.transition=null,jt=1,KG(t,e,n,i)}finally{is.transition=r,jt=i}return null}function KG(t,e,n,i){do yd();while(sl!==null);if(Pt&6)throw Error(de(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(de(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(PW(t,s),t===Gn&&(Rn=Gn=null,ai=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||kg||(kg=!0,KL(Av,function(){return yd(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=is.transition,is.transition=null;var o=jt;jt=1;var a=Pt;Pt|=4,xC.current=null,UG(t,n),$L(n,t),pG($S),Nv=!!BS,$S=BS=null,t.current=n,VG(n),bW(),Pt=a,jt=o,is.transition=s}else t.current=n;if(kg&&(kg=!1,sl=t,Wv=r),s=t.pendingLanes,s===0&&(Sl=null),SW(n.stateNode),cr(t,En()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Hv)throw Hv=!1,t=s2,s2=null,t;return Wv&1&&t.tag!==0&&yd(),s=t.pendingLanes,s&1?t===o2?Gh++:(Gh=0,o2=t):Gh=0,Jl(),null}function yd(){if(sl!==null){var t=C5(Wv),e=is.transition,n=jt;try{if(is.transition=null,jt=16>t?16:t,sl===null)var i=!1;else{if(t=sl,sl=null,Wv=0,Pt&6)throw Error(de(331));var r=Pt;for(Pt|=4,Te=t.current;Te!==null;){var s=Te,o=s.child;if(Te.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Te=c;Te!==null;){var u=Te;switch(u.tag){case 0:case 11:case 15:Hh(8,u,s)}var d=u.child;if(d!==null)d.return=u,Te=d;else for(;Te!==null;){u=Te;var f=u.sibling,p=u.return;if(DL(u),u===c){Te=null;break}if(f!==null){f.return=p,Te=f;break}Te=p}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Te=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Te=o;else e:for(;Te!==null;){if(s=Te,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Hh(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Te=v;break e}Te=s.return}}var b=t.current;for(Te=b;Te!==null;){o=Te;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Te=w;else e:for(o=b;Te!==null;){if(a=Te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:pb(9,a)}}catch(C){bn(a,a.return,C)}if(a===o){Te=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,Te=k;break e}Te=a.return}}if(Pt=r,Jl(),So&&typeof So.onPostCommitFiberRoot=="function")try{So.onPostCommitFiberRoot(ob,t)}catch{}i=!0}return i}finally{jt=n,is.transition=e}}return!1}function gM(t,e,n){e=Xd(n,e),e=CL(t,e,1),t=wl(t,e,1),e=Ii(),t!==null&&(xm(t,1,e),cr(t,e))}function bn(t,e,n){if(t.tag===3)gM(t,t,n);else for(;e!==null;){if(e.tag===3){gM(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Sl===null||!Sl.has(i))){t=Xd(n,t),t=EL(e,t,1),e=wl(e,t,1),t=Ii(),e!==null&&(xm(e,1,t),cr(e,t));break}}e=e.return}}function XG(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=Ii(),t.pingedLanes|=t.suspendedLanes&n,Gn===t&&(ai&n)===n&&(Fn===4||Fn===3&&(ai&130023424)===ai&&500>En()-SC?Bc(t,0):wC|=n),cr(t,e)}function GL(t,e){e===0&&(t.mode&1?(e=hg,hg<<=1,!(hg&130023424)&&(hg=4194304)):e=1);var n=Ii();t=ha(t,e),t!==null&&(xm(t,e,n),cr(t,n))}function YG(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),GL(t,n)}function JG(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(de(314))}i!==null&&i.delete(e),GL(t,n)}var qL;qL=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ar.current)sr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return sr=!1,BG(t,e,n);sr=!!(t.flags&131072)}else sr=!1,ln&&e.flags&1048576&&J5(e,Dv,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;D0(t,e),t=e.pendingProps;var r=Wd(e,Si.current);vd(e,n),r=mC(null,e,i,t,r,n);var s=gC();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,lr(i)?(s=!0,Ov(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,uC(e),r.updater=hb,e.stateNode=r,r._reactInternals=e,KS(e,i,t,n),e=JS(null,e,i,!0,s,n)):(e.tag=0,ln&&s&&iC(e),Mi(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(D0(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=QG(i),t=xs(i,t),r){case 0:e=YS(null,e,i,t,n);break e;case 1:e=oM(null,e,i,t,n);break e;case 11:e=rM(null,e,i,t,n);break e;case 14:e=sM(null,e,i,xs(i.type,t),n);break e}throw Error(de(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xs(i,r),YS(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xs(i,r),oM(t,e,i,r,n);case 3:e:{if(ML(e),t===null)throw Error(de(387));i=e.pendingProps,s=e.memoizedState,r=s.element,iL(t,e),$v(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Xd(Error(de(423)),e),e=aM(t,e,i,n,r);break e}else if(i!==r){r=Xd(Error(de(424)),e),e=aM(t,e,i,n,r);break e}else for(_r=xl(e.stateNode.containerInfo.firstChild),Nr=e,ln=!0,Es=null,n=tL(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gd(),i===r){e=pa(t,e,n);break e}Mi(t,e,i,n)}e=e.child}return e;case 5:return rL(e),t===null&&WS(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,FS(i,r)?o=null:s!==null&&FS(i,s)&&(e.flags|=32),NL(t,e),Mi(t,e,o,n),e.child;case 6:return t===null&&WS(e),null;case 13:return RL(t,e,n);case 4:return dC(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=qd(e,null,i,n):Mi(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xs(i,r),rM(t,e,i,r,n);case 7:return Mi(t,e,e.pendingProps,n),e.child;case 8:return Mi(t,e,e.pendingProps.children,n),e.child;case 12:return Mi(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Xt(jv,i._currentValue),i._currentValue=o,s!==null)if(Ls(s.value,o)){if(s.children===r.children&&!ar.current){e=pa(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=la(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),GS(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(de(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),GS(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Mi(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,vd(e,n),r=cs(r),i=i(r),e.flags|=1,Mi(t,e,i,n),e.child;case 14:return i=e.type,r=xs(i,e.pendingProps),r=xs(i.type,r),sM(t,e,i,r,n);case 15:return AL(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xs(i,r),D0(t,e),e.tag=1,lr(i)?(t=!0,Ov(e)):t=!1,vd(e,n),_L(e,i,r),KS(e,i,r,n),JS(null,e,i,!0,t,n);case 19:return IL(t,e,n);case 22:return PL(t,e,n)}throw Error(de(156,e.tag))};function KL(t,e){return w5(t,e)}function ZG(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yr(t,e,n,i){return new ZG(t,e,n,i)}function EC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function QG(t){if(typeof t=="function")return EC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===W_)return 11;if(t===G_)return 14}return 2}function _l(t,e){var n=t.alternate;return n===null?(n=Yr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function $0(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")EC(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case qu:return $c(n.children,r,s,e);case H_:o=8,r|=8;break;case yS:return t=Yr(12,n,e,r|2),t.elementType=yS,t.lanes=s,t;case bS:return t=Yr(13,n,e,r),t.elementType=bS,t.lanes=s,t;case xS:return t=Yr(19,n,e,r),t.elementType=xS,t.lanes=s,t;case r5:return gb(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case n5:o=10;break e;case i5:o=9;break e;case W_:o=11;break e;case G_:o=14;break e;case $a:o=16,i=null;break e}throw Error(de(130,t==null?t:typeof t,""))}return e=Yr(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function $c(t,e,n,i){return t=Yr(7,t,i,e),t.lanes=n,t}function gb(t,e,n,i){return t=Yr(22,t,i,e),t.elementType=r5,t.lanes=n,t.stateNode={isHidden:!1},t}function mx(t,e,n){return t=Yr(6,t,null,e),t.lanes=n,t}function gx(t,e,n){return e=Yr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function eq(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Y1(0),this.expirationTimes=Y1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Y1(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function AC(t,e,n,i,r,s,o,a,l){return t=new eq(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Yr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},uC(s),t}function tq(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gu,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function XL(t){if(!t)return Rl;t=t._reactInternals;e:{if(fu(t)!==t||t.tag!==1)throw Error(de(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(lr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(de(171))}if(t.tag===1){var n=t.type;if(lr(n))return X5(t,n,e)}return e}function YL(t,e,n,i,r,s,o,a,l){return t=AC(n,i,!0,t,r,s,o,a,l),t.context=XL(null),n=t.current,i=Ii(),r=kl(n),s=la(i,r),s.callback=e??null,wl(n,s,r),t.current.lanes=r,xm(t,r,i),cr(t,i),t}function vb(t,e,n,i){var r=e.current,s=Ii(),o=kl(r);return n=XL(n),e.context===null?e.context=n:e.pendingContext=n,e=la(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=wl(r,e,o),t!==null&&(Os(t,r,o,s),T0(t,r,o)),o}function qv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function vM(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function PC(t,e){vM(t,e),(t=t.alternate)&&vM(t,e)}function nq(){return null}var JL=typeof reportError=="function"?reportError:function(t){console.error(t)};function NC(t){this._internalRoot=t}yb.prototype.render=NC.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(de(409));vb(t,e,null,null)};yb.prototype.unmount=NC.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Yc(function(){vb(null,t,null,null)}),e[fa]=null}};function yb(t){this._internalRoot=t}yb.prototype.unstable_scheduleHydration=function(t){if(t){var e=P5();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ya.length&&e!==0&&e<Ya[n].priority;n++);Ya.splice(n,0,t),n===0&&M5(t)}};function MC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function bb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function yM(){}function iq(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var c=qv(o);s.call(c)}}var o=YL(e,i,t,0,null,!1,!1,"",yM);return t._reactRootContainer=o,t[fa]=o.current,wp(t.nodeType===8?t.parentNode:t),Yc(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var c=qv(l);a.call(c)}}var l=AC(t,0,!1,null,null,!1,!1,"",yM);return t._reactRootContainer=l,t[fa]=l.current,wp(t.nodeType===8?t.parentNode:t),Yc(function(){vb(e,l,n,i)}),l}function xb(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=qv(o);a.call(l)}}vb(e,o,t,r)}else o=iq(n,e,t,r,i);return qv(o)}E5=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=vh(e.pendingLanes);n!==0&&(X_(e,n|1),cr(e,En()),!(Pt&6)&&(Yd=En()+500,Jl()))}break;case 13:Yc(function(){var i=ha(t,1);if(i!==null){var r=Ii();Os(i,t,1,r)}}),PC(t,1)}};Y_=function(t){if(t.tag===13){var e=ha(t,134217728);if(e!==null){var n=Ii();Os(e,t,134217728,n)}PC(t,134217728)}};A5=function(t){if(t.tag===13){var e=kl(t),n=ha(t,e);if(n!==null){var i=Ii();Os(n,t,e,i)}PC(t,e)}};P5=function(){return jt};N5=function(t,e){var n=jt;try{return jt=t,e()}finally{jt=n}};MS=function(t,e,n){switch(e){case"input":if(kS(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=ub(i);if(!r)throw Error(de(90));o5(i),kS(i,r)}}}break;case"textarea":l5(t,n);break;case"select":e=n.value,e!=null&&hd(t,!!n.multiple,e,!1)}};m5=kC;g5=Yc;var rq={usingClientEntryPoint:!1,Events:[Sm,Ju,ub,h5,p5,kC]},Gf={findFiberByHostInstance:Mc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sq={bundleType:Gf.bundleType,version:Gf.version,rendererPackageName:Gf.rendererPackageName,rendererConfig:Gf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wa.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=b5(t),t===null?null:t.stateNode},findFiberByHostInstance:Gf.findFiberByHostInstance||nq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_g.isDisabled&&_g.supportsFiber)try{ob=_g.inject(sq),So=_g}catch{}}Lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rq;Lr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!MC(e))throw Error(de(200));return tq(t,e,null,n)};Lr.createRoot=function(t,e){if(!MC(t))throw Error(de(299));var n=!1,i="",r=JL;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=AC(t,1,!1,null,null,n,!1,i,r),t[fa]=e.current,wp(t.nodeType===8?t.parentNode:t),new NC(e)};Lr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(de(188)):(t=Object.keys(t).join(","),Error(de(268,t)));return t=b5(e),t=t===null?null:t.stateNode,t};Lr.flushSync=function(t){return Yc(t)};Lr.hydrate=function(t,e,n){if(!bb(e))throw Error(de(200));return xb(null,t,e,!0,n)};Lr.hydrateRoot=function(t,e,n){if(!MC(t))throw Error(de(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=JL;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=YL(e,null,t,1,n??null,r,!1,s,o),t[fa]=e.current,wp(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new yb(e)};Lr.render=function(t,e,n){if(!bb(e))throw Error(de(200));return xb(null,t,e,!1,n)};Lr.unmountComponentAtNode=function(t){if(!bb(t))throw Error(de(40));return t._reactRootContainer?(Yc(function(){xb(null,null,t,!1,function(){t._reactRootContainer=null,t[fa]=null})}),!0):!1};Lr.unstable_batchedUpdates=kC;Lr.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!bb(n))throw Error(de(200));if(t==null||t._reactInternals===void 0)throw Error(de(38));return xb(t,e,n,!1,i)};Lr.version="18.3.1-next-f1338f8080-20240426";function ZL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ZL)}catch(t){console.error(t)}}ZL(),ZO.exports=Lr;var Zl=ZO.exports;const oq=uu(Zl);var QL,bM=Zl;QL=bM.createRoot,bM.hydrateRoot;function ke(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function zs(t,e=[]){let n=[];function i(s,o){const a=x.createContext(o),l=n.length;n=[...n,o];const c=d=>{var v;const{scope:f,children:p,...m}=d,g=((v=f==null?void 0:f[t])==null?void 0:v[l])||a,y=x.useMemo(()=>m,Object.values(m));return h.jsx(g.Provider,{value:y,children:p})};c.displayName=s+"Provider";function u(d,f){var g;const p=((g=f==null?void 0:f[t])==null?void 0:g[l])||a,m=x.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const r=()=>{const s=n.map(o=>x.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return x.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[i,aq(r,...e)]}function aq(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const i=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=i.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function xM(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function wb(...t){return e=>{let n=!1;const i=t.map(r=>{const s=xM(r,e);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():xM(t[r],null)}}}}function wt(...t){return x.useCallback(wb(...t),t)}function Jd(t){const e=lq(t),n=x.forwardRef((i,r)=>{const{children:s,...o}=i,a=x.Children.toArray(s),l=a.find(uq);if(l){const c=l.props.children,u=a.map(d=>d===l?x.Children.count(c)>1?x.Children.only(null):x.isValidElement(c)?c.props.children:null:d);return h.jsx(e,{...o,ref:r,children:x.isValidElement(c)?x.cloneElement(c,void 0,u):null})}return h.jsx(e,{...o,ref:r,children:s})});return n.displayName=`${t}.Slot`,n}function lq(t){const e=x.forwardRef((n,i)=>{const{children:r,...s}=n;if(x.isValidElement(r)){const o=fq(r),a=dq(s,r.props);return r.type!==x.Fragment&&(a.ref=i?wb(i,o):o),x.cloneElement(r,a)}return x.Children.count(r)>1?x.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var cq=Symbol("radix.slottable");function uq(t){return x.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===cq}function dq(t,e){const n={...e};for(const i in e){const r=t[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?n[i]=(...a)=>{const l=s(...a);return r(...a),l}:r&&(n[i]=r):i==="style"?n[i]={...r,...s}:i==="className"&&(n[i]=[r,s].filter(Boolean).join(" "))}return{...t,...n}}function fq(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function _m(t){const e=t+"CollectionProvider",[n,i]=zs(e),[r,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:y,children:v}=g,b=Qt.useRef(null),w=Qt.useRef(new Map).current;return h.jsx(r,{scope:y,itemMap:w,collectionRef:b,children:v})};o.displayName=e;const a=t+"CollectionSlot",l=Jd(a),c=Qt.forwardRef((g,y)=>{const{scope:v,children:b}=g,w=s(a,v),k=wt(y,w.collectionRef);return h.jsx(l,{ref:k,children:b})});c.displayName=a;const u=t+"CollectionItemSlot",d="data-radix-collection-item",f=Jd(u),p=Qt.forwardRef((g,y)=>{const{scope:v,children:b,...w}=g,k=Qt.useRef(null),C=wt(y,k),E=s(u,v);return Qt.useEffect(()=>(E.itemMap.set(k,{ref:k,...w}),()=>void E.itemMap.delete(k))),h.jsx(f,{[d]:"",ref:C,children:b})});p.displayName=u;function m(g){const y=s(t+"CollectionConsumer",g);return Qt.useCallback(()=>{const b=y.collectionRef.current;if(!b)return[];const w=Array.from(b.querySelectorAll(`[${d}]`));return Array.from(y.itemMap.values()).sort((E,_)=>w.indexOf(E.ref.current)-w.indexOf(_.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:o,Slot:c,ItemSlot:p},m,i]}var ci=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},hq=Qy[" useId ".trim().toString()]||(()=>{}),pq=0;function kf(t){const[e,n]=x.useState(hq());return ci(()=>{n(i=>i??String(pq++))},[t]),e?`radix-${e}`:""}var mq=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],et=mq.reduce((t,e)=>{const n=Jd(`Primitive.${e}`),i=x.forwardRef((r,s)=>{const{asChild:o,...a}=r,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(l,{...a,ref:s})});return i.displayName=`Primitive.${e}`,{...t,[e]:i}},{});function RC(t,e){t&&Zl.flushSync(()=>t.dispatchEvent(e))}function Ir(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>{var i;return(i=e.current)==null?void 0:i.call(e,...n)},[])}var gq=Qy[" useInsertionEffect ".trim().toString()]||ci;function Il({prop:t,defaultProp:e,onChange:n=()=>{},caller:i}){const[r,s,o]=vq({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:r;{const u=x.useRef(t!==void 0);x.useEffect(()=>{const d=u.current;d!==a&&console.warn(`${i} is changing from ${d?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,i])}const c=x.useCallback(u=>{var d;if(a){const f=yq(u)?u(t):u;f!==t&&((d=o.current)==null||d.call(o,f))}else s(u)},[a,t,s,o]);return[l,c]}function vq({defaultProp:t,onChange:e}){const[n,i]=x.useState(t),r=x.useRef(n),s=x.useRef(e);return gq(()=>{s.current=e},[e]),x.useEffect(()=>{var o;r.current!==n&&((o=s.current)==null||o.call(s,n),r.current=n)},[n,r]),[n,i,s]}function yq(t){return typeof t=="function"}var bq=x.createContext(void 0);function Sb(t){const e=x.useContext(bq);return t||e||"ltr"}var vx="rovingFocusGroup.onEntryFocus",xq={bubbles:!1,cancelable:!0},Cm="RovingFocusGroup",[c2,eD,wq]=_m(Cm),[Sq,kb]=zs(Cm,[wq]),[kq,_q]=Sq(Cm),tD=x.forwardRef((t,e)=>h.jsx(c2.Provider,{scope:t.__scopeRovingFocusGroup,children:h.jsx(c2.Slot,{scope:t.__scopeRovingFocusGroup,children:h.jsx(Cq,{...t,ref:e})})}));tD.displayName=Cm;var Cq=x.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:r=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=t,f=x.useRef(null),p=wt(e,f),m=Sb(s),[g,y]=Il({prop:o,defaultProp:a??null,onChange:l,caller:Cm}),[v,b]=x.useState(!1),w=Ir(c),k=eD(n),C=x.useRef(!1),[E,_]=x.useState(0);return x.useEffect(()=>{const A=f.current;if(A)return A.addEventListener(vx,w),()=>A.removeEventListener(vx,w)},[w]),h.jsx(kq,{scope:n,orientation:i,dir:m,loop:r,currentTabStopId:g,onItemFocus:x.useCallback(A=>y(A),[y]),onItemShiftTab:x.useCallback(()=>b(!0),[]),onFocusableItemAdd:x.useCallback(()=>_(A=>A+1),[]),onFocusableItemRemove:x.useCallback(()=>_(A=>A-1),[]),children:h.jsx(et.div,{tabIndex:v||E===0?-1:0,"data-orientation":i,...d,ref:p,style:{outline:"none",...t.style},onMouseDown:ke(t.onMouseDown,()=>{C.current=!0}),onFocus:ke(t.onFocus,A=>{const R=!C.current;if(A.target===A.currentTarget&&R&&!v){const L=new CustomEvent(vx,xq);if(A.currentTarget.dispatchEvent(L),!L.defaultPrevented){const O=k().filter(J=>J.focusable),I=O.find(J=>J.active),G=O.find(J=>J.id===g),K=[I,G,...O].filter(Boolean).map(J=>J.ref.current);rD(K,u)}}C.current=!1}),onBlur:ke(t.onBlur,()=>b(!1))})})}),nD="RovingFocusGroupItem",iD=x.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:r=!1,tabStopId:s,children:o,...a}=t,l=kf(),c=s||l,u=_q(nD,n),d=u.currentTabStopId===c,f=eD(n),{onFocusableItemAdd:p,onFocusableItemRemove:m,currentTabStopId:g}=u;return x.useEffect(()=>{if(i)return p(),()=>m()},[i,p,m]),h.jsx(c2.ItemSlot,{scope:n,id:c,focusable:i,active:r,children:h.jsx(et.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...a,ref:e,onMouseDown:ke(t.onMouseDown,y=>{i?u.onItemFocus(c):y.preventDefault()}),onFocus:ke(t.onFocus,()=>u.onItemFocus(c)),onKeyDown:ke(t.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const v=Pq(y,u.orientation,u.dir);if(v!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let w=f().filter(k=>k.focusable).map(k=>k.ref.current);if(v==="last")w.reverse();else if(v==="prev"||v==="next"){v==="prev"&&w.reverse();const k=w.indexOf(y.currentTarget);w=u.loop?Nq(w,k+1):w.slice(k+1)}setTimeout(()=>rD(w))}}),children:typeof o=="function"?o({isCurrentTabStop:d,hasTabStop:g!=null}):o})})});iD.displayName=nD;var Eq={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Aq(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Pq(t,e,n){const i=Aq(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return Eq[i]}function rD(t,e=!1){const n=document.activeElement;for(const i of t)if(i===n||(i.focus({preventScroll:e}),document.activeElement!==n))return}function Nq(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var sD=tD,oD=iD;function Mq(t,e){return x.useReducer((n,i)=>e[n][i]??n,t)}var Sa=t=>{const{present:e,children:n}=t,i=Rq(e),r=typeof n=="function"?n({present:i.isPresent}):x.Children.only(n),s=wt(i.ref,Iq(r));return typeof n=="function"||i.isPresent?x.cloneElement(r,{ref:s}):null};Sa.displayName="Presence";function Rq(t){const[e,n]=x.useState(),i=x.useRef(null),r=x.useRef(t),s=x.useRef("none"),o=t?"mounted":"unmounted",[a,l]=Mq(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const c=Cg(i.current);s.current=a==="mounted"?c:"none"},[a]),ci(()=>{const c=i.current,u=r.current;if(u!==t){const f=s.current,p=Cg(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),ci(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=p=>{const g=Cg(i.current).includes(p.animationName);if(p.target===e&&g&&(l("ANIMATION_END"),!r.current)){const y=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=y)})}},f=p=>{p.target===e&&(s.current=Cg(i.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:x.useCallback(c=>{i.current=c?getComputedStyle(c):null,n(c)},[])}}function Cg(t){return(t==null?void 0:t.animationName)||"none"}function Iq(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var _b="Tabs",[Tq,Q0e]=zs(_b,[kb]),aD=kb(),[Oq,IC]=Tq(_b),lD=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,onValueChange:r,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=t,u=Sb(a),[d,f]=Il({prop:i,onChange:r,defaultProp:s??"",caller:_b});return h.jsx(Oq,{scope:n,baseId:kf(),value:d,onValueChange:f,orientation:o,dir:u,activationMode:l,children:h.jsx(et.div,{dir:u,"data-orientation":o,...c,ref:e})})});lD.displayName=_b;var cD="TabsList",uD=x.forwardRef((t,e)=>{const{__scopeTabs:n,loop:i=!0,...r}=t,s=IC(cD,n),o=aD(n);return h.jsx(sD,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:i,children:h.jsx(et.div,{role:"tablist","aria-orientation":s.orientation,...r,ref:e})})});uD.displayName=cD;var dD="TabsTrigger",F0=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,disabled:r=!1,...s}=t,o=IC(dD,n),a=aD(n),l=hD(o.baseId,i),c=pD(o.baseId,i),u=i===o.value;return h.jsx(oD,{asChild:!0,...a,focusable:!r,active:u,children:h.jsx(et.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:l,...s,ref:e,onMouseDown:ke(t.onMouseDown,d=>{!r&&d.button===0&&d.ctrlKey===!1?o.onValueChange(i):d.preventDefault()}),onKeyDown:ke(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(i)}),onFocus:ke(t.onFocus,()=>{const d=o.activationMode!=="manual";!u&&!r&&d&&o.onValueChange(i)})})})});F0.displayName=dD;var fD="TabsContent",z0=x.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,forceMount:r,children:s,...o}=t,a=IC(fD,n),l=hD(a.baseId,i),c=pD(a.baseId,i),u=i===a.value,d=x.useRef(u);return x.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),h.jsx(Sa,{present:r||u,children:({present:f})=>h.jsx(et.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!f,id:c,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:f&&s})})});z0.displayName=fD;function hD(t,e){return`${t}-trigger-${e}`}function pD(t,e){return`${t}-content-${e}`}const bh={},wM=(t,e)=>t.unstable_is?t.unstable_is(e):e===t,SM=t=>"init"in t,yx=t=>!!t.write,kM=t=>"v"in t||"e"in t,Eg=t=>{if("e"in t)throw t.e;if((bh?"production":void 0)!=="production"&&!("v"in t))throw new Error("[Bug] atom state is not initialized");return t.v},Kv=new WeakMap,_M=t=>{var e;return Xv(t)&&!!((e=Kv.get(t))!=null&&e[0])},Lq=t=>{const e=Kv.get(t);e!=null&&e[0]&&(e[0]=!1,e[1].forEach(n=>n()))},mD=(t,e)=>{let n=Kv.get(t);if(!n){n=[!0,new Set],Kv.set(t,n);const i=()=>{n[0]=!1};t.then(i,i)}n[1].add(e)},Xv=t=>typeof(t==null?void 0:t.then)=="function",gD=(t,e,n)=>{n.p.has(t)||(n.p.add(t),e.then(()=>{n.p.delete(t)},()=>{n.p.delete(t)}))},bx=(t,e,n)=>{const i=n(t),r="v"in i,s=i.v;if(Xv(e))for(const o of i.d.keys())gD(t,e,n(o));i.v=e,delete i.e,(!r||!Object.is(s,i.v))&&(++i.n,Xv(s)&&Lq(s))},CM=(t,e,n)=>{var i;const r=new Set;for(const s of((i=n.get(t))==null?void 0:i.t)||[])n.has(s)&&r.add(s);for(const s of e.p)r.add(s);return r},Dq=()=>{const t=new Set,e=()=>{t.forEach(n=>n())};return e.add=n=>(t.add(n),()=>{t.delete(n)}),e},xx=()=>{const t={},e=new WeakMap,n=i=>{var r,s;(r=e.get(t))==null||r.forEach(o=>o(i)),(s=e.get(i))==null||s.forEach(o=>o())};return n.add=(i,r)=>{const s=i||t,o=(e.has(s)?e:e.set(s,new Set)).get(s);return o.add(r),()=>{o==null||o.delete(r),o.size||e.delete(s)}},n},jq=t=>(t.c||(t.c=xx()),t.m||(t.m=xx()),t.u||(t.u=xx()),t.f||(t.f=Dq()),t),Bq=Symbol(),$q=(t=new WeakMap,e=new WeakMap,n=new WeakMap,i=new Set,r=new Set,s=new Set,o={},a=(f,...p)=>f.read(...p),l=(f,...p)=>f.write(...p),c=(f,p)=>{var m;return(m=f.unstable_onInit)==null?void 0:m.call(f,p)},u=(f,p)=>{var m;return(m=f.onMount)==null?void 0:m.call(f,p)},...d)=>{const f=d[0]||(_=>{if((bh?"production":void 0)!=="production"&&!_)throw new Error("Atom is undefined or null");let A=t.get(_);return A||(A={d:new Map,p:new Set,n:0},t.set(_,A),c==null||c(_,E)),A}),p=d[1]||(()=>{const _=[],A=R=>{try{R()}catch(L){_.push(L)}};do{o.f&&A(o.f);const R=new Set,L=R.add.bind(R);i.forEach(O=>{var I;return(I=e.get(O))==null?void 0:I.l.forEach(L)}),i.clear(),s.forEach(L),s.clear(),r.forEach(L),r.clear(),R.forEach(A),i.size&&m()}while(i.size||s.size||r.size);if(_.length)throw new AggregateError(_)}),m=d[2]||(()=>{const _=[],A=new WeakSet,R=new WeakSet,L=Array.from(i);for(;L.length;){const O=L[L.length-1],I=f(O);if(R.has(O)){L.pop();continue}if(A.has(O)){if(n.get(O)===I.n)_.push([O,I]);else if((bh?"production":void 0)!=="production"&&n.has(O))throw new Error("[Bug] invalidated atom exists");R.add(O),L.pop();continue}A.add(O);for(const G of CM(O,I,e))A.has(G)||L.push(G)}for(let O=_.length-1;O>=0;--O){const[I,G]=_[O];let B=!1;for(const K of G.d.keys())if(K!==I&&i.has(K)){B=!0;break}B&&(g(I),b(I)),n.delete(I)}}),g=d[3]||(_=>{var A;const R=f(_);if(kM(R)&&(e.has(_)&&n.get(_)!==R.n||Array.from(R.d).every(([ne,V])=>g(ne).n===V)))return R;R.d.clear();let L=!0;const O=()=>{e.has(_)&&(b(_),m(),p())},I=ne=>{var V;if(wM(_,ne)){const se=f(ne);if(!kM(se))if(SM(ne))bx(ne,ne.init,f);else throw new Error("no atom init");return Eg(se)}const U=g(ne);try{return Eg(U)}finally{R.d.set(ne,U.n),_M(R.v)&&gD(_,R.v,U),(V=e.get(ne))==null||V.t.add(_),L||O()}};let G,B;const K={get signal(){return G||(G=new AbortController),G.signal},get setSelf(){return(bh?"production":void 0)!=="production"&&!yx(_)&&console.warn("setSelf function cannot be used with read-only atom"),!B&&yx(_)&&(B=(...ne)=>{if((bh?"production":void 0)!=="production"&&L&&console.warn("setSelf function cannot be called in sync"),!L)try{return v(_,...ne)}finally{m(),p()}}),B}},J=R.n;try{const ne=a(_,I,K);return bx(_,ne,f),Xv(ne)&&(mD(ne,()=>G==null?void 0:G.abort()),ne.then(O,O)),R}catch(ne){return delete R.v,R.e=ne,++R.n,R}finally{L=!1,J!==R.n&&n.get(_)===J&&(n.set(_,R.n),i.add(_),(A=o.c)==null||A.call(o,_))}}),y=d[4]||(_=>{const A=[_];for(;A.length;){const R=A.pop(),L=f(R);for(const O of CM(R,L,e)){const I=f(O);n.set(O,I.n),A.push(O)}}}),v=d[5]||((_,...A)=>{let R=!0;const L=I=>Eg(g(I)),O=(I,...G)=>{var B;const K=f(I);try{if(wM(_,I)){if(!SM(I))throw new Error("atom not writable");const J=K.n,ne=G[0];bx(I,ne,f),b(I),J!==K.n&&(i.add(I),(B=o.c)==null||B.call(o,I),y(I));return}else return v(I,...G)}finally{R||(m(),p())}};try{return l(_,L,O,...A)}finally{R=!1}}),b=d[6]||(_=>{var A;const R=f(_),L=e.get(_);if(L&&!_M(R.v)){for(const[O,I]of R.d)if(!L.d.has(O)){const G=f(O);w(O).t.add(_),L.d.add(O),I!==G.n&&(i.add(O),(A=o.c)==null||A.call(o,O),y(O))}for(const O of L.d||[])if(!R.d.has(O)){L.d.delete(O);const I=k(O);I==null||I.t.delete(_)}}}),w=d[7]||(_=>{var A;const R=f(_);let L=e.get(_);if(!L){g(_);for(const O of R.d.keys())w(O).t.add(_);if(L={l:new Set,d:new Set(R.d.keys()),t:new Set},e.set(_,L),(A=o.m)==null||A.call(o,_),yx(_)){const O=()=>{let I=!0;const G=(...B)=>{try{return v(_,...B)}finally{I||(m(),p())}};try{const B=u(_,G);B&&(L.u=()=>{I=!0;try{B()}finally{I=!1}})}finally{I=!1}};r.add(O)}}return L}),k=d[8]||(_=>{var A;const R=f(_);let L=e.get(_);if(L&&!L.l.size&&!Array.from(L.t).some(O=>{var I;return(I=e.get(O))==null?void 0:I.d.has(_)})){L.u&&s.add(L.u),L=void 0,e.delete(_),(A=o.u)==null||A.call(o,_);for(const O of R.d.keys()){const I=k(O);I==null||I.t.delete(_)}return}return L}),C=[t,e,n,i,r,s,o,a,l,c,u,f,p,m,g,y,v,b,w,k],E={get:_=>Eg(g(_)),set:(_,...A)=>{try{return v(_,...A)}finally{m(),p()}},sub:(_,A)=>{const L=w(_).l;return L.add(A),p(),()=>{L.delete(A),k(_),p()}}};return Object.defineProperty(E,Bq,{value:C}),E},vD=$q,Fq=jq,EM=mD,TC={};let zq=0;function pe(t,e){const n=`atom${++zq}`,i={toString(){return(TC?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof t=="function"?i.read=t:(i.init=t,i.read=Uq,i.write=Vq),e&&(i.write=e),i}function Uq(t){return t(this)}function Vq(t,e,n){return e(this,typeof n=="function"?n(t(this)):n)}const Hq=()=>{let t=0;const e=Fq({}),n=new WeakMap,i=new WeakMap,r=vD(n,i,void 0,void 0,void 0,void 0,e,void 0,(a,l,c,...u)=>t?c(a,...u):a.write(l,c,...u)),s=new Set;return e.m.add(void 0,a=>{s.add(a);const l=n.get(a);l.m=i.get(a)}),e.u.add(void 0,a=>{s.delete(a);const l=n.get(a);delete l.m}),Object.assign(r,{dev4_get_internal_weak_map:()=>(console.log("Deprecated: Use devstore from the devtools library"),n),dev4_get_mounted_atoms:()=>s,dev4_restore_atoms:a=>{const l={read:()=>null,write:(c,u)=>{++t;try{for(const[d,f]of a)"init"in d&&u(d,f)}finally{--t}}};r.set(l)}})};function OC(){return(TC?"production":void 0)!=="production"?Hq():vD()}let qf;function Wq(){return qf||(qf=OC(),(TC?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=qf),globalThis.__JOTAI_DEFAULT_STORE__!==qf&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),qf}const Gq={},yD=x.createContext(void 0);function bD(t){return x.useContext(yD)||Wq()}function qq({children:t,store:e}){const n=x.useRef(void 0);return!e&&!n.current&&(n.current=OC()),x.createElement(yD.Provider,{value:e||n.current},t)}const u2=t=>typeof(t==null?void 0:t.then)=="function",d2=t=>{t.status||(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}))},Kq=Qt.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(d2(t),t)}),wx=new WeakMap,AM=(t,e)=>{let n=wx.get(t);return n||(n=new Promise((i,r)=>{let s=t;const o=c=>u=>{s===c&&i(u)},a=c=>u=>{s===c&&r(u)},l=()=>{try{const c=e();u2(c)?(wx.set(c,n),s=c,c.then(o(c),a(c)),EM(c,l)):i(c)}catch(c){r(c)}};t.then(o(t),a(t)),EM(t,l)}),wx.set(t,n)),n};function tt(t,e){const{delay:n,unstable_promiseStatus:i=!Qt.use}={},r=bD(),[[s,o,a],l]=x.useReducer(u=>{const d=r.get(t);return Object.is(u[0],d)&&u[1]===r&&u[2]===t?u:[d,r,t]},void 0,()=>[r.get(t),r,t]);let c=s;if((o!==r||a!==t)&&(l(),c=r.get(t)),x.useEffect(()=>{const u=r.sub(t,()=>{if(i)try{const d=r.get(t);u2(d)&&d2(AM(d,()=>r.get(t)))}catch{}if(typeof n=="number"){setTimeout(l,n);return}l()});return l(),u},[r,t,n,i]),x.useDebugValue(c),u2(c)){const u=AM(c,()=>r.get(t));return i&&d2(u),Kq(u)}return c}function Mp(t,e){const n=bD();return x.useCallback((...r)=>{if((Gq?"production":void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return n.set(t,...r)},[n,t])}function Em(t,e){return[tt(t),Mp(t)]}const{createElement:Zd,createContext:Xq,forwardRef:xD,useCallback:Wi,useContext:wD,useEffect:Fc,useImperativeHandle:SD,useLayoutEffect:Yq,useMemo:Jq,useRef:xr,useState:Yv}=Qy,PM=Qy.useId,Cb=Xq(null);Cb.displayName="PanelGroupContext";const Rp=Yq,Zq=typeof PM=="function"?PM:()=>null;let Qq=0;function LC(t=null){const e=Zq(),n=xr(t||e||null);return n.current===null&&(n.current=""+Qq++),t??n.current}function kD({children:t,className:e="",collapsedSize:n,collapsible:i,defaultSize:r,forwardedRef:s,id:o,maxSize:a,minSize:l,onCollapse:c,onExpand:u,onResize:d,order:f,style:p,tagName:m="div",...g}){const y=wD(Cb);if(y===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:v,expandPanel:b,getPanelSize:w,getPanelStyle:k,groupId:C,isPanelCollapsed:E,reevaluatePanelConstraints:_,registerPanel:A,resizePanel:R,unregisterPanel:L}=y,O=LC(o),I=xr({callbacks:{onCollapse:c,onExpand:u,onResize:d},constraints:{collapsedSize:n,collapsible:i,defaultSize:r,maxSize:a,minSize:l},id:O,idIsFromProps:o!==void 0,order:f});xr({didLogMissingDefaultSizeWarning:!1}),Rp(()=>{const{callbacks:B,constraints:K}=I.current,J={...K};I.current.id=O,I.current.idIsFromProps=o!==void 0,I.current.order=f,B.onCollapse=c,B.onExpand=u,B.onResize=d,K.collapsedSize=n,K.collapsible=i,K.defaultSize=r,K.maxSize=a,K.minSize=l,(J.collapsedSize!==K.collapsedSize||J.collapsible!==K.collapsible||J.maxSize!==K.maxSize||J.minSize!==K.minSize)&&_(I.current,J)}),Rp(()=>{const B=I.current;return A(B),()=>{L(B)}},[f,O,A,L]),SD(s,()=>({collapse:()=>{v(I.current)},expand:()=>{b(I.current)},getId(){return O},getSize(){return w(I.current)},isCollapsed(){return E(I.current)},isExpanded(){return!E(I.current)},resize:B=>{R(I.current,B)}}),[v,b,w,E,O,R]);const G=k(I.current,r);return Zd(m,{...g,children:t,className:e,style:{...G,...p},"data-panel":"","data-panel-id":O,"data-panel-group-id":C,"data-panel-collapsible":void 0,"data-panel-size":void 0})}const U0=xD((t,e)=>Zd(kD,{...t,forwardedRef:e}));kD.displayName="Panel";U0.displayName="forwardRef(Panel)";function ut(t,e="Assertion failed!"){if(!t)throw console.error(e),Error(e)}const _D=10;function Ip(t,e,n=_D){t=parseFloat(t.toFixed(n)),e=parseFloat(e.toFixed(n));const i=t-e;return i===0?0:i>0?1:-1}function vr(t,e,n){return Ip(t,e,n)===0}function rd({panelConstraints:t,panelIndex:e,size:n}){const i=t[e];ut(i!=null);let{collapsedSize:r=0,collapsible:s,maxSize:o=100,minSize:a=0}=i;if(Ip(n,a)<0)if(s){const l=(r+a)/2;Ip(n,l)<0?n=r:n=a}else n=a;return n=Math.min(o,n),n=parseFloat(n.toFixed(_D)),n}function xh({delta:t,layout:e,panelConstraints:n,pivotIndices:i,trigger:r}){if(vr(t,0))return e;const s=[...e],[o,a]=i;ut(o!=null),ut(a!=null);let l=0;if(r==="keyboard"){{const u=t<0?a:o,d=n[u];if(ut(d),d.collapsible){const f=e[u];ut(f!=null);const p=n[u];ut(p);const{collapsedSize:m=0,minSize:g=0}=p;if(vr(f,m)){const y=g-f;Ip(y,Math.abs(t))>0&&(t=t<0?0-y:y)}}}{const u=t<0?o:a,d=n[u];ut(d);const{collapsible:f}=d;if(f){const p=e[u];ut(p!=null);const m=n[u];ut(m);const{collapsedSize:g=0,minSize:y=0}=m;if(vr(p,y)){const v=p-g;Ip(v,Math.abs(t))>0&&(t=t<0?0-v:v)}}}}{const u=t<0?1:-1;let d=t<0?a:o,f=0;for(;;){const m=e[d];ut(m!=null);const y=rd({panelConstraints:n,panelIndex:d,size:100})-m;if(f+=y,d+=u,d<0||d>=n.length)break}const p=Math.min(Math.abs(t),Math.abs(f));t=t<0?0-p:p}{let d=t<0?o:a;for(;d>=0&&d<n.length;){const f=Math.abs(t)-Math.abs(l),p=e[d];ut(p!=null);const m=p-f,g=rd({panelConstraints:n,panelIndex:d,size:m});if(!vr(p,g)&&(l+=p-g,s[d]=g,l.toPrecision(3).localeCompare(Math.abs(t).toPrecision(3),void 0,{numeric:!0})>=0))break;t<0?d--:d++}}if(vr(l,0))return e;{const u=t<0?a:o,d=e[u];ut(d!=null);const f=d+l,p=rd({panelConstraints:n,panelIndex:u,size:f});if(s[u]=p,!vr(p,f)){let m=f-p,y=t<0?a:o;for(;y>=0&&y<n.length;){const v=s[y];ut(v!=null);const b=v+m,w=rd({panelConstraints:n,panelIndex:y,size:b});if(vr(v,w)||(m-=w-v,s[y]=w),vr(m,0))break;t>0?y--:y++}}}const c=s.reduce((u,d)=>d+u,0);return vr(c,100)?s:e}function eK({layout:t,panelsArray:e,pivotIndices:n}){let i=0,r=100,s=0,o=0;const a=n[0];ut(a!=null),e.forEach((d,f)=>{const{constraints:p}=d,{maxSize:m=100,minSize:g=0}=p;f===a?(i=g,r=m):(s+=g,o+=m)});const l=Math.min(r,100-s),c=Math.max(i,100-o),u=t[a];return{valueMax:l,valueMin:c,valueNow:u}}function Tp(t,e=document){return Array.from(e.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${t}"]`))}function CD(t,e,n=document){const r=Tp(t,n).findIndex(s=>s.getAttribute("data-panel-resize-handle-id")===e);return r??null}function ED(t,e,n){const i=CD(t,e,n);return i!=null?[i,i+1]:[-1,-1]}function AD(t,e=document){var n;if(e instanceof HTMLElement&&(e==null||(n=e.dataset)===null||n===void 0?void 0:n.panelGroupId)==t)return e;const i=e.querySelector(`[data-panel-group][data-panel-group-id="${t}"]`);return i||null}function Eb(t,e=document){const n=e.querySelector(`[data-panel-resize-handle-id="${t}"]`);return n||null}function tK(t,e,n,i=document){var r,s,o,a;const l=Eb(e,i),c=Tp(t,i),u=l?c.indexOf(l):-1,d=(r=(s=n[u])===null||s===void 0?void 0:s.id)!==null&&r!==void 0?r:null,f=(o=(a=n[u+1])===null||a===void 0?void 0:a.id)!==null&&o!==void 0?o:null;return[d,f]}function nK({committedValuesRef:t,eagerValuesRef:e,groupId:n,layout:i,panelDataArray:r,panelGroupElement:s,setLayout:o}){xr({didWarnAboutMissingResizeHandle:!1}),Rp(()=>{if(!s)return;const a=Tp(n,s);for(let l=0;l<r.length-1;l++){const{valueMax:c,valueMin:u,valueNow:d}=eK({layout:i,panelsArray:r,pivotIndices:[l,l+1]}),f=a[l];if(f!=null){const p=r[l];ut(p),f.setAttribute("aria-controls",p.id),f.setAttribute("aria-valuemax",""+Math.round(c)),f.setAttribute("aria-valuemin",""+Math.round(u)),f.setAttribute("aria-valuenow",d!=null?""+Math.round(d):"")}}return()=>{a.forEach((l,c)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[n,i,r,s]),Fc(()=>{if(!s)return;const a=e.current;ut(a);const{panelDataArray:l}=a,c=AD(n,s);ut(c!=null,`No group found for id "${n}"`);const u=Tp(n,s);ut(u);const d=u.map(f=>{const p=f.getAttribute("data-panel-resize-handle-id");ut(p);const[m,g]=tK(n,p,l,s);if(m==null||g==null)return()=>{};const y=v=>{if(!v.defaultPrevented)switch(v.key){case"Enter":{v.preventDefault();const b=l.findIndex(w=>w.id===m);if(b>=0){const w=l[b];ut(w);const k=i[b],{collapsedSize:C=0,collapsible:E,minSize:_=0}=w.constraints;if(k!=null&&E){const A=xh({delta:vr(k,C)?_-C:C-k,layout:i,panelConstraints:l.map(R=>R.constraints),pivotIndices:ED(n,p,s),trigger:"keyboard"});i!==A&&o(A)}}break}}};return f.addEventListener("keydown",y),()=>{f.removeEventListener("keydown",y)}});return()=>{d.forEach(f=>f())}},[s,t,e,n,i,r,o])}function NM(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function PD(t){return t.type==="keydown"}function ND(t){return t.type.startsWith("mouse")}function MD(t){return t.type.startsWith("touch")}function RD(t,e){const n=t==="horizontal";if(ND(e))return n?e.clientX:e.clientY;if(MD(e)){const i=e.touches[0];return ut(i),n?i.screenX:i.screenY}else throw Error(`Unsupported event type "${e.type}"`)}function iK(t,e,n,i,r){const s=n==="horizontal",o=Eb(e,r);ut(o);const a=o.getAttribute("data-panel-group-id");ut(a);let{initialCursorPosition:l}=i;const c=RD(n,t),u=AD(a,r);ut(u);const d=u.getBoundingClientRect(),f=s?d.width:d.height;return(c-l)/f*100}function rK(t,e,n,i,r,s){if(PD(t)){const o=n==="horizontal";let a=0;t.shiftKey?a=100:r!=null?a=r:a=10;let l=0;switch(t.key){case"ArrowDown":l=o?0:a;break;case"ArrowLeft":l=o?-a:0;break;case"ArrowRight":l=o?a:0;break;case"ArrowUp":l=o?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return i==null?0:iK(t,e,n,i,s)}function sK({panelDataArray:t}){const e=Array(t.length),n=t.map(s=>s.constraints);let i=0,r=100;for(let s=0;s<t.length;s++){const o=n[s];ut(o);const{defaultSize:a}=o;a!=null&&(i++,e[s]=a,r-=a)}for(let s=0;s<t.length;s++){const o=n[s];ut(o);const{defaultSize:a}=o;if(a!=null)continue;const l=t.length-i,c=r/l;i++,e[s]=c,r-=c}return e}function xu(t,e,n){e.forEach((i,r)=>{const s=t[r];ut(s);const{callbacks:o,constraints:a,id:l}=s,{collapsedSize:c=0,collapsible:u}=a,d=n[l];if(d==null||i!==d){n[l]=i;const{onCollapse:f,onExpand:p,onResize:m}=o;m&&m(i,d),u&&(f||p)&&(p&&(d==null||d===c)&&i!==c&&p(),f&&(d==null||d!==c)&&i===c&&f())}})}function Ag(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n])return!1;return!0}function oK({defaultSize:t,dragState:e,layout:n,panelData:i,panelIndex:r,precision:s=3}){const o=n[r];let a;return o==null?a=t??"1":i.length===1?a="1":a=o.toPrecision(s),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}let f2=null,Tc=null;function ID(t){switch(t){case"horizontal":return"ew-resize";case"horizontal-max":return"w-resize";case"horizontal-min":return"e-resize";case"vertical":return"ns-resize";case"vertical-max":return"n-resize";case"vertical-min":return"s-resize"}}function aK(){Tc!==null&&(document.head.removeChild(Tc),f2=null,Tc=null)}function Sx(t){if(f2===t)return;f2=t;const e=ID(t);Tc===null&&(Tc=document.createElement("style"),document.head.appendChild(Tc)),Tc.innerHTML=`*{cursor: ${e}!important;}`}function lK(t,e=10){let n=null;return(...r)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{t(...r)},e)}}function MM(t){try{if(typeof localStorage<"u")t.getItem=e=>localStorage.getItem(e),t.setItem=(e,n)=>{localStorage.setItem(e,n)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),t.getItem=()=>null,t.setItem=()=>{}}}function TD(t){return`react-resizable-panels:${t}`}function OD(t){return t.map(e=>{const{constraints:n,id:i,idIsFromProps:r,order:s}=e;return r?i:s?`${s}:${JSON.stringify(n)}`:JSON.stringify(n)}).sort((e,n)=>e.localeCompare(n)).join(",")}function LD(t,e){try{const n=TD(t),i=e.getItem(n);if(i){const r=JSON.parse(i);if(typeof r=="object"&&r!=null)return r}}catch{}return null}function cK(t,e,n){var i,r;const s=(i=LD(t,n))!==null&&i!==void 0?i:{},o=OD(e);return(r=s[o])!==null&&r!==void 0?r:null}function uK(t,e,n,i,r){var s;const o=TD(t),a=OD(e),l=(s=LD(t,r))!==null&&s!==void 0?s:{};l[a]={expandToSizes:Object.fromEntries(n.entries()),layout:i};try{r.setItem(o,JSON.stringify(l))}catch(c){console.error(c)}}function RM({layout:t,panelConstraints:e}){const n=[...t],i=n.reduce((s,o)=>s+o,0);if(n.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${n.map(s=>`${s}%`).join(", ")}`);if(!vr(i,100))for(let s=0;s<e.length;s++){const o=n[s];ut(o!=null);const a=100/i*o;n[s]=a}let r=0;for(let s=0;s<e.length;s++){const o=n[s];ut(o!=null);const a=rd({panelConstraints:e,panelIndex:s,size:o});o!=a&&(r+=o-a,n[s]=a)}if(!vr(r,0))for(let s=0;s<e.length;s++){const o=n[s];ut(o!=null);const a=o+r,l=rd({panelConstraints:e,panelIndex:s,size:a});if(o!==l&&(r-=l-o,n[s]=l,vr(r,0)))break}return n}const dK=100,wh={getItem:t=>(MM(wh),wh.getItem(t)),setItem:(t,e)=>{MM(wh),wh.setItem(t,e)}},IM={};function DD({autoSaveId:t=null,children:e,className:n="",direction:i,forwardedRef:r,id:s=null,onLayout:o=null,keyboardResizeBy:a=null,storage:l=wh,style:c,tagName:u="div",...d}){const f=LC(s),p=xr(null),[m,g]=Yv(null),[y,v]=Yv([]),b=xr({}),w=xr(new Map),k=xr(0),C=xr({autoSaveId:t,direction:i,dragState:m,id:f,keyboardResizeBy:a,onLayout:o,storage:l}),E=xr({layout:y,panelDataArray:[],panelDataArrayChanged:!1});xr({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),SD(r,()=>({getId:()=>C.current.id,getLayout:()=>{const{layout:Q}=E.current;return Q},setLayout:Q=>{const{onLayout:ae}=C.current,{layout:z,panelDataArray:$}=E.current,W=RM({layout:Q,panelConstraints:$.map(S=>S.constraints)});NM(z,W)||(v(W),E.current.layout=W,ae&&ae(W),xu($,W,b.current))}}),[]),Rp(()=>{C.current.autoSaveId=t,C.current.direction=i,C.current.dragState=m,C.current.id=f,C.current.onLayout=o,C.current.storage=l}),nK({committedValuesRef:C,eagerValuesRef:E,groupId:f,layout:y,panelDataArray:E.current.panelDataArray,setLayout:v,panelGroupElement:p.current}),Fc(()=>{const{panelDataArray:Q}=E.current;if(t){if(y.length===0||y.length!==Q.length)return;let ae=IM[t];ae==null&&(ae=lK(uK,dK),IM[t]=ae);const z=[...Q],$=new Map(w.current);ae(t,z,$,y,l)}},[t,y,l]),Fc(()=>{});const _=Wi(Q=>{const{onLayout:ae}=C.current,{layout:z,panelDataArray:$}=E.current;if(Q.constraints.collapsible){const W=$.map(D=>D.constraints),{collapsedSize:S=0,panelSize:T,pivotIndices:j}=hc($,Q,z);if(ut(T!=null),T!==S){w.current.set(Q.id,T);const Y=Lu($,Q)===$.length-1?T-S:S-T,q=xh({delta:Y,layout:z,panelConstraints:W,pivotIndices:j,trigger:"imperative-api"});Ag(z,q)||(v(q),E.current.layout=q,ae&&ae(q),xu($,q,b.current))}}},[]),A=Wi(Q=>{const{onLayout:ae}=C.current,{layout:z,panelDataArray:$}=E.current;if(Q.constraints.collapsible){const W=$.map(Y=>Y.constraints),{collapsedSize:S=0,panelSize:T,minSize:j=0,pivotIndices:D}=hc($,Q,z);if(T===S){const Y=w.current.get(Q.id),q=Y!=null&&Y>=j?Y:j,ee=Lu($,Q)===$.length-1?T-q:q-T,Oe=xh({delta:ee,layout:z,panelConstraints:W,pivotIndices:D,trigger:"imperative-api"});Ag(z,Oe)||(v(Oe),E.current.layout=Oe,ae&&ae(Oe),xu($,Oe,b.current))}}},[]),R=Wi(Q=>{const{layout:ae,panelDataArray:z}=E.current,{panelSize:$}=hc(z,Q,ae);return ut($!=null),$},[]),L=Wi((Q,ae)=>{const{panelDataArray:z}=E.current,$=Lu(z,Q);return oK({defaultSize:ae,dragState:m,layout:y,panelData:z,panelIndex:$})},[m,y]),O=Wi(Q=>{const{layout:ae,panelDataArray:z}=E.current,{collapsedSize:$=0,collapsible:W,panelSize:S}=hc(z,Q,ae);return W===!0&&S===$},[]),I=Wi(Q=>{const{layout:ae,panelDataArray:z}=E.current,{collapsedSize:$=0,collapsible:W,panelSize:S}=hc(z,Q,ae);return ut(S!=null),!W||S>$},[]),G=Wi(Q=>{const{panelDataArray:ae}=E.current;ae.push(Q),ae.sort((z,$)=>{const W=z.order,S=$.order;return W==null&&S==null?0:W==null?-1:S==null?1:W-S}),E.current.panelDataArrayChanged=!0},[]);Rp(()=>{if(E.current.panelDataArrayChanged){E.current.panelDataArrayChanged=!1;const{autoSaveId:Q,onLayout:ae,storage:z}=C.current,{layout:$,panelDataArray:W}=E.current;let S=null;if(Q){const j=cK(Q,W,z);j&&(w.current=new Map(Object.entries(j.expandToSizes)),S=j.layout)}S==null&&(S=sK({panelDataArray:W}));const T=RM({layout:S,panelConstraints:W.map(j=>j.constraints)});NM($,T)||(v(T),E.current.layout=T,ae&&ae(T),xu(W,T,b.current))}});const B=Wi(Q=>function(z){z.preventDefault();const $=p.current;if(!$)return()=>null;const{direction:W,dragState:S,id:T,keyboardResizeBy:j,onLayout:D}=C.current,{layout:Y,panelDataArray:q}=E.current,{initialLayout:oe}=S??{},ee=ED(T,Q,$);let Oe=rK(z,Q,W,S,j,$);if(Oe===0)return;const We=W==="horizontal";document.dir==="rtl"&&We&&(Oe=-Oe);const Xe=q.map(we=>we.constraints),Ve=xh({delta:Oe,layout:oe??Y,panelConstraints:Xe,pivotIndices:ee,trigger:PD(z)?"keyboard":"mouse-or-touch"}),ot=!Ag(Y,Ve);(ND(z)||MD(z))&&k.current!=Oe&&(k.current=Oe,Sx(ot?We?"horizontal":"vertical":We?Oe<0?"horizontal-min":"horizontal-max":Oe<0?"vertical-min":"vertical-max")),ot&&(v(Ve),E.current.layout=Ve,D&&D(Ve),xu(q,Ve,b.current))},[]),K=Wi((Q,ae)=>{const{onLayout:z}=C.current,{layout:$,panelDataArray:W}=E.current,S=W.map(oe=>oe.constraints),{panelSize:T,pivotIndices:j}=hc(W,Q,$);ut(T!=null);const Y=Lu(W,Q)===W.length-1?T-ae:ae-T,q=xh({delta:Y,layout:$,panelConstraints:S,pivotIndices:j,trigger:"imperative-api"});Ag($,q)||(v(q),E.current.layout=q,z&&z(q),xu(W,q,b.current))},[]),J=Wi((Q,ae)=>{const{layout:z,panelDataArray:$}=E.current,{collapsedSize:W=0,collapsible:S}=ae,{collapsedSize:T=0,collapsible:j,maxSize:D=100,minSize:Y=0}=Q.constraints,{panelSize:q}=hc($,Q,z);ut(q!=null),S&&j&&q===W?W!==T&&K(Q,T):q<Y?K(Q,Y):q>D&&K(Q,D)},[K]),ne=Wi((Q,ae)=>{const{direction:z}=C.current,{layout:$}=E.current;if(!p.current)return;const W=Eb(Q,p.current);ut(W);const S=RD(z,ae);g({dragHandleId:Q,dragHandleRect:W.getBoundingClientRect(),initialCursorPosition:S,initialLayout:$})},[]),V=Wi(()=>{aK(),g(null)},[]),U=Wi(Q=>{const{panelDataArray:ae}=E.current,z=Lu(ae,Q);z>=0&&(ae.splice(z,1),delete b.current[Q.id],E.current.panelDataArrayChanged=!0)},[]),se=Jq(()=>({collapsePanel:_,direction:i,dragState:m,expandPanel:A,getPanelSize:R,getPanelStyle:L,groupId:f,isPanelCollapsed:O,isPanelExpanded:I,reevaluatePanelConstraints:J,registerPanel:G,registerResizeHandle:B,resizePanel:K,startDragging:ne,stopDragging:V,unregisterPanel:U,panelGroupElement:p.current}),[_,m,i,A,R,L,f,O,I,J,G,B,K,ne,V,U]),_e={display:"flex",flexDirection:i==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return Zd(Cb.Provider,{value:se},Zd(u,{...d,children:e,className:n,style:{..._e,...c},ref:p,"data-panel-group":"","data-panel-group-direction":i,"data-panel-group-id":f}))}const jD=xD((t,e)=>Zd(DD,{...t,forwardedRef:e}));DD.displayName="PanelGroup";jD.displayName="forwardRef(PanelGroup)";function Lu(t,e){return t.findIndex(n=>n===e||n.id===e.id)}function hc(t,e,n){const i=Lu(t,e),s=i===t.length-1?[i-1,i]:[i,i+1],o=n[i];return{...e.constraints,panelSize:o,pivotIndices:s}}function fK({disabled:t,handleId:e,resizeHandler:n,panelGroupElement:i}){Fc(()=>{if(t||n==null||i==null)return;const r=Eb(e,i);if(r==null)return;const s=o=>{if(!o.defaultPrevented)switch(o.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{o.preventDefault(),n(o);break}case"F6":{o.preventDefault();const a=r.getAttribute("data-panel-group-id");ut(a);const l=Tp(a,i),c=CD(a,e,i);ut(c!==null);const u=o.shiftKey?c>0?c-1:l.length-1:c+1<l.length?c+1:0;l[u].focus();break}}};return r.addEventListener("keydown",s),()=>{r.removeEventListener("keydown",s)}},[i,t,e,n])}function h2({children:t=null,className:e="",disabled:n=!1,id:i,onDragging:r,style:s={},tabIndex:o=0,tagName:a="div",...l}){const c=xr(null),u=xr({onDragging:r});Fc(()=>{u.current.onDragging=r});const d=wD(Cb);if(d===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:f,dragState:p,groupId:m,registerResizeHandle:g,startDragging:y,stopDragging:v,panelGroupElement:b}=d,w=LC(i),k=(p==null?void 0:p.dragHandleId)===w,[C,E]=Yv(!1),[_,A]=Yv(null),R=Wi(()=>{const O=c.current;ut(O),O.blur(),v();const{onDragging:I}=u.current;I&&I(!1)},[v]);Fc(()=>{if(n)A(null);else{const O=g(w);A(()=>O)}},[n,w,g]),Fc(()=>{if(n||_==null||!k)return;const O=K=>{_(K)},I=K=>{_(K)},G=c.current;ut(G);const B=G.ownerDocument;return B.body.addEventListener("contextmenu",R),B.body.addEventListener("mousemove",O),B.body.addEventListener("touchmove",O),B.body.addEventListener("mouseleave",I),window.addEventListener("mouseup",R),window.addEventListener("touchend",R),()=>{B.body.removeEventListener("contextmenu",R),B.body.removeEventListener("mousemove",O),B.body.removeEventListener("touchmove",O),B.body.removeEventListener("mouseleave",I),window.removeEventListener("mouseup",R),window.removeEventListener("touchend",R)}},[f,n,k,_,R]),fK({disabled:n,handleId:w,resizeHandler:_,panelGroupElement:b});const L={cursor:ID(f),touchAction:"none",userSelect:"none"};return Zd(a,{...l,children:t,className:e,onBlur:()=>E(!1),onFocus:()=>E(!0),onMouseDown:O=>{y(w,O.nativeEvent);const I=u.current;ut(I);const{onDragging:G}=I;G&&G(!0)},onMouseUp:R,onTouchCancel:R,onTouchEnd:R,onTouchStart:O=>{y(w,O.nativeEvent);const I=u.current;ut(I);const{onDragging:G}=I;G&&G(!0)},ref:c,role:"separator",style:{...L,...s},tabIndex:o,"data-panel-group-direction":f,"data-panel-group-id":m,"data-resize-handle":"","data-resize-handle-active":k?"pointer":C?"keyboard":void 0,"data-panel-resize-handle-enabled":!n,"data-panel-resize-handle-id":w})}h2.displayName="PanelResizeHandle";var ao=function(){return ao=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ao.apply(this,arguments)};function BD(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function hK(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}var pK=function(){};function mK(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.addEventListener&&t.addEventListener.apply(t,e)}function gK(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.removeEventListener&&t.removeEventListener.apply(t,e)}var $D=typeof window<"u",vK=$D?window:null,TM=function(t){return!!t.addEventListener},OM=function(t){return!!t.on},yK=function(t,e,n,i){n===void 0&&(n=vK),x.useEffect(function(){if(e&&n)return TM(n)?mK(n,t,e,i):OM(n)&&n.on(t,e,i),function(){TM(n)?gK(n,t,e,i):OM(n)&&n.off(t,e,i)}},[t,e,n,JSON.stringify(i)])},bK=function(t){return typeof t=="function"?t:typeof t=="string"?function(e){return e.key===t}:t?function(){return!0}:function(){return!1}},Du=function(t,e,n,i){e===void 0&&(e=pK),n===void 0&&(n={}),i===void 0&&(i=[t]);var r=n.event,s=r===void 0?"keydown":r,o=n.target,a=n.options,l=x.useMemo(function(){var c=bK(t),u=function(d){if(c(d))return e(d)};return u},i);yK(s,l,o,a)},xK=function(t,e){return $D?window.matchMedia(t).matches:!1},wK=function(t,e){var n=x.useState(xK(t)),i=n[0],r=n[1];return x.useEffect(function(){var s=!0,o=window.matchMedia(t),a=function(){s&&r(!!o.matches)};return o.addEventListener("change",a),r(o.matches),function(){s=!1,o.removeEventListener("change",a)}},[t]),i};/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const SK={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]};/*!
 * Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */function kK(t,e,n){return(e=CK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function ue(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LM(Object(n),!0).forEach(function(i){kK(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LM(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function _K(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CK(t){var e=_K(t,"string");return typeof e=="symbol"?e:e+""}const DM=()=>{};let DC={},FD={},zD=null,UD={mark:DM,measure:DM};try{typeof window<"u"&&(DC=window),typeof document<"u"&&(FD=document),typeof MutationObserver<"u"&&(zD=MutationObserver),typeof performance<"u"&&(UD=performance)}catch{}const{userAgent:jM=""}=DC.navigator||{},Tl=DC,nn=FD,BM=zD,Pg=UD;Tl.document;const ka=!!nn.documentElement&&!!nn.head&&typeof nn.addEventListener=="function"&&typeof nn.createElement=="function",VD=~jM.indexOf("MSIE")||~jM.indexOf("Trident/");var EK=/fa(s|r|l|t|d|dr|dl|dt|b|k|kd|ss|sr|sl|st|sds|sdr|sdl|sdt)?[\-\ ]/,AK=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,HD={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fab:"brands","fa-brands":"brands"},duotone:{fa:"solid",fad:"solid","fa-solid":"solid","fa-duotone":"solid",fadr:"regular","fa-regular":"regular",fadl:"light","fa-light":"light",fadt:"thin","fa-thin":"thin"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid",fasdr:"regular","fa-regular":"regular",fasdl:"light","fa-light":"light",fasdt:"thin","fa-thin":"thin"}},PK={GROUP:"duotone-group",PRIMARY:"primary",SECONDARY:"secondary"},WD=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],ki="classic",Ab="duotone",NK="sharp",MK="sharp-duotone",GD=[ki,Ab,NK,MK],RK={classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},duotone:{900:"fad",400:"fadr",300:"fadl",100:"fadt"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds",400:"fasdr",300:"fasdl",100:"fasdt"}},IK={"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad",400:"fadr",normal:"fadr",300:"fadl",100:"fadt"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds",400:"fasdr",normal:"fasdr",300:"fasdl",100:"fasdt"}},TK=new Map([["classic",{defaultShortPrefixId:"fas",defaultStyleId:"solid",styleIds:["solid","regular","light","thin","brands"],futureStyleIds:[],defaultFontWeight:900}],["sharp",{defaultShortPrefixId:"fass",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["duotone",{defaultShortPrefixId:"fad",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["sharp-duotone",{defaultShortPrefixId:"fasds",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}]]),OK={classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",brands:"fab"},duotone:{solid:"fad",regular:"fadr",light:"fadl",thin:"fadt"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds",regular:"fasdr",light:"fasdl",thin:"fasdt"}},LK=["fak","fa-kit","fakd","fa-kit-duotone"],$M={kit:{fak:"kit","fa-kit":"kit"},"kit-duotone":{fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"}},DK=["kit"],jK={kit:{"fa-kit":"fak"}},BK=["fak","fakd"],$K={kit:{fak:"fa-kit"}},FM={kit:{kit:"fak"},"kit-duotone":{"kit-duotone":"fakd"}},Ng={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},FK=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],zK=["fak","fa-kit","fakd","fa-kit-duotone"],UK={"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}},VK={classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},duotone:{"fa-regular":"fadr","fa-light":"fadl","fa-thin":"fadt"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds","fa-regular":"fasdr","fa-light":"fasdl","fa-thin":"fasdt"}},HK={classic:["fas","far","fal","fat","fad"],duotone:["fadr","fadl","fadt"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds","fasdr","fasdl","fasdt"]},p2={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},duotone:{fadr:"fa-regular",fadl:"fa-light",fadt:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid",fasdr:"fa-regular",fasdl:"fa-light",fasdt:"fa-thin"}},WK=["fa-solid","fa-regular","fa-light","fa-thin","fa-duotone","fa-brands"],m2=["fa","fas","far","fal","fat","fad","fadr","fadl","fadt","fab","fass","fasr","fasl","fast","fasds","fasdr","fasdl","fasdt",...FK,...WK],GK=["solid","regular","light","thin","duotone","brands"],qD=[1,2,3,4,5,6,7,8,9,10],qK=qD.concat([11,12,13,14,15,16,17,18,19,20]),KK=[...Object.keys(HK),...GK,"2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",Ng.GROUP,Ng.SWAP_OPACITY,Ng.PRIMARY,Ng.SECONDARY].concat(qD.map(t=>"".concat(t,"x"))).concat(qK.map(t=>"w-".concat(t))),XK={"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"}};const ma="___FONT_AWESOME___",g2=16,KD="fa",XD="svg-inline--fa",Jc="data-fa-i2svg",v2="data-fa-pseudo-element",YK="data-fa-pseudo-element-pending",jC="data-prefix",BC="data-icon",zM="fontawesome-i2svg",JK="async",ZK=["HTML","HEAD","STYLE","SCRIPT"],YD=(()=>{try{return!0}catch{return!1}})();function Am(t){return new Proxy(t,{get(e,n){return n in e?e[n]:e[ki]}})}const JD=ue({},HD);JD[ki]=ue(ue(ue(ue({},{"fa-duotone":"duotone"}),HD[ki]),$M.kit),$M["kit-duotone"]);const QK=Am(JD),y2=ue({},OK);y2[ki]=ue(ue(ue(ue({},{duotone:"fad"}),y2[ki]),FM.kit),FM["kit-duotone"]);const UM=Am(y2),b2=ue({},p2);b2[ki]=ue(ue({},b2[ki]),$K.kit);const $C=Am(b2),x2=ue({},VK);x2[ki]=ue(ue({},x2[ki]),jK.kit);Am(x2);const eX=EK,ZD="fa-layers-text",tX=AK,nX=ue({},RK);Am(nX);const iX=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],kx=PK,rX=[...DK,...KK],qh=Tl.FontAwesomeConfig||{};function sX(t){var e=nn.querySelector("script["+t+"]");if(e)return e.getAttribute(t)}function oX(t){return t===""?!0:t==="false"?!1:t==="true"?!0:t}nn&&typeof nn.querySelector=="function"&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(e=>{let[n,i]=e;const r=oX(sX(n));r!=null&&(qh[i]=r)});const QD={styleDefault:"solid",familyDefault:ki,cssPrefix:KD,replacementClass:XD,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};qh.familyPrefix&&(qh.cssPrefix=qh.familyPrefix);const Qd=ue(ue({},QD),qh);Qd.autoReplaceSvg||(Qd.observeMutations=!1);const Fe={};Object.keys(QD).forEach(t=>{Object.defineProperty(Fe,t,{enumerable:!0,set:function(e){Qd[t]=e,Kh.forEach(n=>n(Fe))},get:function(){return Qd[t]}})});Object.defineProperty(Fe,"familyPrefix",{enumerable:!0,set:function(t){Qd.cssPrefix=t,Kh.forEach(e=>e(Fe))},get:function(){return Qd.cssPrefix}});Tl.FontAwesomeConfig=Fe;const Kh=[];function aX(t){return Kh.push(t),()=>{Kh.splice(Kh.indexOf(t),1)}}const Ia=g2,po={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function lX(t){if(!t||!ka)return;const e=nn.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=t;const n=nn.head.childNodes;let i=null;for(let r=n.length-1;r>-1;r--){const s=n[r],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(i=s)}return nn.head.insertBefore(e,i),t}const cX="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Op(){let t=12,e="";for(;t-- >0;)e+=cX[Math.random()*62|0];return e}function _f(t){const e=[];for(let n=(t||[]).length>>>0;n--;)e[n]=t[n];return e}function FC(t){return t.classList?_f(t.classList):(t.getAttribute("class")||"").split(" ").filter(e=>e)}function ej(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function uX(t){return Object.keys(t||{}).reduce((e,n)=>e+"".concat(n,'="').concat(ej(t[n]),'" '),"").trim()}function Pb(t){return Object.keys(t||{}).reduce((e,n)=>e+"".concat(n,": ").concat(t[n].trim(),";"),"")}function zC(t){return t.size!==po.size||t.x!==po.x||t.y!==po.y||t.rotate!==po.rotate||t.flipX||t.flipY}function dX(t){let{transform:e,containerWidth:n,iconWidth:i}=t;const r={transform:"translate(".concat(n/2," 256)")},s="translate(".concat(e.x*32,", ").concat(e.y*32,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)"),l={transform:"".concat(s," ").concat(o," ").concat(a)},c={transform:"translate(".concat(i/2*-1," -256)")};return{outer:r,inner:l,path:c}}function fX(t){let{transform:e,width:n=g2,height:i=g2,startCentered:r=!1}=t,s="";return r&&VD?s+="translate(".concat(e.x/Ia-n/2,"em, ").concat(e.y/Ia-i/2,"em) "):r?s+="translate(calc(-50% + ".concat(e.x/Ia,"em), calc(-50% + ").concat(e.y/Ia,"em)) "):s+="translate(".concat(e.x/Ia,"em, ").concat(e.y/Ia,"em) "),s+="scale(".concat(e.size/Ia*(e.flipX?-1:1),", ").concat(e.size/Ia*(e.flipY?-1:1),") "),s+="rotate(".concat(e.rotate,"deg) "),s}var hX=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-counter-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(-1 * var(--fa-li-width, 2em));
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  animation-name: fa-beat;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  animation-name: fa-bounce;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  animation-name: fa-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  animation-name: fa-beat-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  animation-name: fa-flip;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  animation-name: fa-shake;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  animation-name: fa-spin;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 2s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  animation-name: fa-spin;
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    animation-delay: -1ms;
    animation-duration: 1ms;
    animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@keyframes fa-beat {
  0%, 90% {
    transform: scale(1);
  }
  45% {
    transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-bounce {
  0% {
    transform: scale(1, 1) translateY(0);
  }
  10% {
    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    transform: scale(1, 1) translateY(0);
  }
  100% {
    transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-flip {
  50% {
    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-shake {
  0% {
    transform: rotate(-15deg);
  }
  4% {
    transform: rotate(15deg);
  }
  8%, 24% {
    transform: rotate(-18deg);
  }
  12%, 28% {
    transform: rotate(18deg);
  }
  16% {
    transform: rotate(-22deg);
  }
  20% {
    transform: rotate(22deg);
  }
  32% {
    transform: rotate(-12deg);
  }
  36% {
    transform: rotate(12deg);
  }
  40%, 100% {
    transform: rotate(0deg);
  }
}
@keyframes fa-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  transform: rotate(90deg);
}

.fa-rotate-180 {
  transform: rotate(180deg);
}

.fa-rotate-270 {
  transform: rotate(270deg);
}

.fa-flip-horizontal {
  transform: scale(-1, 1);
}

.fa-flip-vertical {
  transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  transform: scale(-1, -1);
}

.fa-rotate-by {
  transform: rotate(var(--fa-rotate-angle, 0));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}`;function tj(){const t=KD,e=XD,n=Fe.cssPrefix,i=Fe.replacementClass;let r=hX;if(n!==t||i!==e){const s=new RegExp("\\.".concat(t,"\\-"),"g"),o=new RegExp("\\--".concat(t,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");r=r.replace(s,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(a,".".concat(i))}return r}let VM=!1;function _x(){Fe.autoAddCss&&!VM&&(lX(tj()),VM=!0)}var pX={mixout(){return{dom:{css:tj,insertCss:_x}}},hooks(){return{beforeDOMElementCreation(){_x()},beforeI2svg(){_x()}}}};const ga=Tl||{};ga[ma]||(ga[ma]={});ga[ma].styles||(ga[ma].styles={});ga[ma].hooks||(ga[ma].hooks={});ga[ma].shims||(ga[ma].shims=[]);var mo=ga[ma];const nj=[],ij=function(){nn.removeEventListener("DOMContentLoaded",ij),Jv=1,nj.map(t=>t())};let Jv=!1;ka&&(Jv=(nn.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(nn.readyState),Jv||nn.addEventListener("DOMContentLoaded",ij));function mX(t){ka&&(Jv?setTimeout(t,0):nj.push(t))}function Pm(t){const{tag:e,attributes:n={},children:i=[]}=t;return typeof t=="string"?ej(t):"<".concat(e," ").concat(uX(n),">").concat(i.map(Pm).join(""),"</").concat(e,">")}function HM(t,e,n){if(t&&t[e]&&t[e][n])return{prefix:e,iconName:n,icon:t[e][n]}}var Cx=function(e,n,i,r){var s=Object.keys(e),o=s.length,a=n,l,c,u;for(i===void 0?(l=1,u=e[s[0]]):(l=0,u=i);l<o;l++)c=s[l],u=a(u,e[c],c,e);return u};function gX(t){const e=[];let n=0;const i=t.length;for(;n<i;){const r=t.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){const s=t.charCodeAt(n++);(s&64512)==56320?e.push(((r&1023)<<10)+(s&1023)+65536):(e.push(r),n--)}else e.push(r)}return e}function w2(t){const e=gX(t);return e.length===1?e[0].toString(16):null}function vX(t,e){const n=t.length;let i=t.charCodeAt(e),r;return i>=55296&&i<=56319&&n>e+1&&(r=t.charCodeAt(e+1),r>=56320&&r<=57343)?(i-55296)*1024+r-56320+65536:i}function WM(t){return Object.keys(t).reduce((e,n)=>{const i=t[n];return!!i.icon?e[i.iconName]=i.icon:e[n]=i,e},{})}function S2(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{skipHooks:i=!1}=n,r=WM(e);typeof mo.hooks.addPack=="function"&&!i?mo.hooks.addPack(t,WM(e)):mo.styles[t]=ue(ue({},mo.styles[t]||{}),r),t==="fas"&&S2("fa",e)}const{styles:Lp,shims:yX}=mo,rj=Object.keys($C),bX=rj.reduce((t,e)=>(t[e]=Object.keys($C[e]),t),{});let UC=null,sj={},oj={},aj={},lj={},cj={};function xX(t){return~rX.indexOf(t)}function wX(t,e){const n=e.split("-"),i=n[0],r=n.slice(1).join("-");return i===t&&r!==""&&!xX(r)?r:null}const uj=()=>{const t=i=>Cx(Lp,(r,s,o)=>(r[o]=Cx(s,i,{}),r),{});sj=t((i,r,s)=>(r[3]&&(i[r[3]]=s),r[2]&&r[2].filter(a=>typeof a=="number").forEach(a=>{i[a.toString(16)]=s}),i)),oj=t((i,r,s)=>(i[s]=s,r[2]&&r[2].filter(a=>typeof a=="string").forEach(a=>{i[a]=s}),i)),cj=t((i,r,s)=>{const o=r[2];return i[s]=s,o.forEach(a=>{i[a]=s}),i});const e="far"in Lp||Fe.autoFetchSvg,n=Cx(yX,(i,r)=>{const s=r[0];let o=r[1];const a=r[2];return o==="far"&&!e&&(o="fas"),typeof s=="string"&&(i.names[s]={prefix:o,iconName:a}),typeof s=="number"&&(i.unicodes[s.toString(16)]={prefix:o,iconName:a}),i},{names:{},unicodes:{}});aj=n.names,lj=n.unicodes,UC=Nb(Fe.styleDefault,{family:Fe.familyDefault})};aX(t=>{UC=Nb(t.styleDefault,{family:Fe.familyDefault})});uj();function VC(t,e){return(sj[t]||{})[e]}function SX(t,e){return(oj[t]||{})[e]}function Oc(t,e){return(cj[t]||{})[e]}function dj(t){return aj[t]||{prefix:null,iconName:null}}function kX(t){const e=lj[t],n=VC("fas",t);return e||(n?{prefix:"fas",iconName:n}:null)||{prefix:null,iconName:null}}function Ol(){return UC}const fj=()=>({prefix:null,iconName:null,rest:[]});function _X(t){let e=ki;const n=rj.reduce((i,r)=>(i[r]="".concat(Fe.cssPrefix,"-").concat(r),i),{});return GD.forEach(i=>{(t.includes(n[i])||t.some(r=>bX[i].includes(r)))&&(e=i)}),e}function Nb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{family:n=ki}=e,i=QK[n][t];if(n===Ab&&!t)return"fad";const r=UM[n][t]||UM[n][i],s=t in mo.styles?t:null;return r||s||null}function CX(t){let e=[],n=null;return t.forEach(i=>{const r=wX(Fe.cssPrefix,i);r?n=r:i&&e.push(i)}),{iconName:n,rest:e}}function GM(t){return t.sort().filter((e,n,i)=>i.indexOf(e)===n)}function Mb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{skipLookups:n=!1}=e;let i=null;const r=m2.concat(zK),s=GM(t.filter(d=>r.includes(d))),o=GM(t.filter(d=>!m2.includes(d))),a=s.filter(d=>(i=d,!WD.includes(d))),[l=null]=a,c=_X(s),u=ue(ue({},CX(o)),{},{prefix:Nb(l,{family:c})});return ue(ue(ue({},u),NX({values:t,family:c,styles:Lp,config:Fe,canonical:u,givenPrefix:i})),EX(n,i,u))}function EX(t,e,n){let{prefix:i,iconName:r}=n;if(t||!i||!r)return{prefix:i,iconName:r};const s=e==="fa"?dj(r):{},o=Oc(i,r);return r=s.iconName||o||r,i=s.prefix||i,i==="far"&&!Lp.far&&Lp.fas&&!Fe.autoFetchSvg&&(i="fas"),{prefix:i,iconName:r}}const AX=GD.filter(t=>t!==ki||t!==Ab),PX=Object.keys(p2).filter(t=>t!==ki).map(t=>Object.keys(p2[t])).flat();function NX(t){const{values:e,family:n,canonical:i,givenPrefix:r="",styles:s={},config:o={}}=t,a=n===Ab,l=e.includes("fa-duotone")||e.includes("fad"),c=o.familyDefault==="duotone",u=i.prefix==="fad"||i.prefix==="fa-duotone";if(!a&&(l||c||u)&&(i.prefix="fad"),(e.includes("fa-brands")||e.includes("fab"))&&(i.prefix="fab"),!i.prefix&&AX.includes(n)&&(Object.keys(s).find(f=>PX.includes(f))||o.autoFetchSvg)){const f=TK.get(n).defaultShortPrefixId;i.prefix=f,i.iconName=Oc(i.prefix,i.iconName)||i.iconName}return(i.prefix==="fa"||r==="fa")&&(i.prefix=Ol()||"fas"),i}class MX{constructor(){this.definitions={}}add(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];const r=n.reduce(this._pullDefinitions,{});Object.keys(r).forEach(s=>{this.definitions[s]=ue(ue({},this.definitions[s]||{}),r[s]),S2(s,r[s]);const o=$C[ki][s];o&&S2(o,r[s]),uj()})}reset(){this.definitions={}}_pullDefinitions(e,n){const i=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(i).map(r=>{const{prefix:s,iconName:o,icon:a}=i[r],l=a[2];e[s]||(e[s]={}),l.length>0&&l.forEach(c=>{typeof c=="string"&&(e[s][c]=a)}),e[s][o]=a}),e}}let qM=[],sd={};const bd={},RX=Object.keys(bd);function IX(t,e){let{mixoutsTo:n}=e;return qM=t,sd={},Object.keys(bd).forEach(i=>{RX.indexOf(i)===-1&&delete bd[i]}),qM.forEach(i=>{const r=i.mixout?i.mixout():{};if(Object.keys(r).forEach(s=>{typeof r[s]=="function"&&(n[s]=r[s]),typeof r[s]=="object"&&Object.keys(r[s]).forEach(o=>{n[s]||(n[s]={}),n[s][o]=r[s][o]})}),i.hooks){const s=i.hooks();Object.keys(s).forEach(o=>{sd[o]||(sd[o]=[]),sd[o].push(s[o])})}i.provides&&i.provides(bd)}),n}function k2(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return(sd[t]||[]).forEach(o=>{e=o.apply(null,[e,...i])}),e}function Zc(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];(sd[t]||[]).forEach(s=>{s.apply(null,n)})}function Ll(){const t=arguments[0],e=Array.prototype.slice.call(arguments,1);return bd[t]?bd[t].apply(null,e):void 0}function _2(t){t.prefix==="fa"&&(t.prefix="fas");let{iconName:e}=t;const n=t.prefix||Ol();if(e)return e=Oc(n,e)||e,HM(hj.definitions,n,e)||HM(mo.styles,n,e)}const hj=new MX,TX=()=>{Fe.autoReplaceSvg=!1,Fe.observeMutations=!1,Zc("noAuto")},OX={i2svg:function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ka?(Zc("beforeI2svg",t),Ll("pseudoElements2svg",t),Ll("i2svg",t)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e}=t;Fe.autoReplaceSvg===!1&&(Fe.autoReplaceSvg=!0),Fe.observeMutations=!0,mX(()=>{DX({autoReplaceSvgRoot:e}),Zc("watch",t)})}},LX={icon:t=>{if(t===null)return null;if(typeof t=="object"&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:Oc(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&t.length===2){const e=t[1].indexOf("fa-")===0?t[1].slice(3):t[1],n=Nb(t[0]);return{prefix:n,iconName:Oc(n,e)||e}}if(typeof t=="string"&&(t.indexOf("".concat(Fe.cssPrefix,"-"))>-1||t.match(eX))){const e=Mb(t.split(" "),{skipLookups:!0});return{prefix:e.prefix||Ol(),iconName:Oc(e.prefix,e.iconName)||e.iconName}}if(typeof t=="string"){const e=Ol();return{prefix:e,iconName:Oc(e,t)||t}}}},jr={noAuto:TX,config:Fe,dom:OX,parse:LX,library:hj,findIconDefinition:_2,toHtml:Pm},DX=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e=nn}=t;(Object.keys(mo.styles).length>0||Fe.autoFetchSvg)&&ka&&Fe.autoReplaceSvg&&jr.dom.i2svg({node:e})};function Rb(t,e){return Object.defineProperty(t,"abstract",{get:e}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(n=>Pm(n))}}),Object.defineProperty(t,"node",{get:function(){if(!ka)return;const n=nn.createElement("div");return n.innerHTML=t.html,n.children}}),t}function jX(t){let{children:e,main:n,mask:i,attributes:r,styles:s,transform:o}=t;if(zC(o)&&n.found&&!i.found){const{width:a,height:l}=n,c={x:a/l/2,y:.5};r.style=Pb(ue(ue({},s),{},{"transform-origin":"".concat(c.x+o.x/16,"em ").concat(c.y+o.y/16,"em")}))}return[{tag:"svg",attributes:r,children:e}]}function BX(t){let{prefix:e,iconName:n,children:i,attributes:r,symbol:s}=t;const o=s===!0?"".concat(e,"-").concat(Fe.cssPrefix,"-").concat(n):s;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:ue(ue({},r),{},{id:o}),children:i}]}]}function HC(t){const{icons:{main:e,mask:n},prefix:i,iconName:r,transform:s,symbol:o,title:a,maskId:l,titleId:c,extra:u,watchable:d=!1}=t,{width:f,height:p}=n.found?n:e,m=BK.includes(i),g=[Fe.replacementClass,r?"".concat(Fe.cssPrefix,"-").concat(r):""].filter(C=>u.classes.indexOf(C)===-1).filter(C=>C!==""||!!C).concat(u.classes).join(" ");let y={children:[],attributes:ue(ue({},u.attributes),{},{"data-prefix":i,"data-icon":r,class:g,role:u.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(f," ").concat(p)})};const v=m&&!~u.classes.indexOf("fa-fw")?{width:"".concat(f/p*16*.0625,"em")}:{};d&&(y.attributes[Jc]=""),a&&(y.children.push({tag:"title",attributes:{id:y.attributes["aria-labelledby"]||"title-".concat(c||Op())},children:[a]}),delete y.attributes.title);const b=ue(ue({},y),{},{prefix:i,iconName:r,main:e,mask:n,maskId:l,transform:s,symbol:o,styles:ue(ue({},v),u.styles)}),{children:w,attributes:k}=n.found&&e.found?Ll("generateAbstractMask",b)||{children:[],attributes:{}}:Ll("generateAbstractIcon",b)||{children:[],attributes:{}};return b.children=w,b.attributes=k,o?BX(b):jX(b)}function KM(t){const{content:e,width:n,height:i,transform:r,title:s,extra:o,watchable:a=!1}=t,l=ue(ue(ue({},o.attributes),s?{title:s}:{}),{},{class:o.classes.join(" ")});a&&(l[Jc]="");const c=ue({},o.styles);zC(r)&&(c.transform=fX({transform:r,startCentered:!0,width:n,height:i}),c["-webkit-transform"]=c.transform);const u=Pb(c);u.length>0&&(l.style=u);const d=[];return d.push({tag:"span",attributes:l,children:[e]}),s&&d.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),d}function $X(t){const{content:e,title:n,extra:i}=t,r=ue(ue(ue({},i.attributes),n?{title:n}:{}),{},{class:i.classes.join(" ")}),s=Pb(i.styles);s.length>0&&(r.style=s);const o=[];return o.push({tag:"span",attributes:r,children:[e]}),n&&o.push({tag:"span",attributes:{class:"sr-only"},children:[n]}),o}const{styles:Ex}=mo;function C2(t){const e=t[0],n=t[1],[i]=t.slice(4);let r=null;return Array.isArray(i)?r={tag:"g",attributes:{class:"".concat(Fe.cssPrefix,"-").concat(kx.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Fe.cssPrefix,"-").concat(kx.SECONDARY),fill:"currentColor",d:i[0]}},{tag:"path",attributes:{class:"".concat(Fe.cssPrefix,"-").concat(kx.PRIMARY),fill:"currentColor",d:i[1]}}]}:r={tag:"path",attributes:{fill:"currentColor",d:i}},{found:!0,width:e,height:n,icon:r}}const FX={found:!1,width:512,height:512};function zX(t,e){!YD&&!Fe.showMissingIcons&&t&&console.error('Icon with name "'.concat(t,'" and prefix "').concat(e,'" is missing.'))}function E2(t,e){let n=e;return e==="fa"&&Fe.styleDefault!==null&&(e=Ol()),new Promise((i,r)=>{if(n==="fa"){const s=dj(t)||{};t=s.iconName||t,e=s.prefix||e}if(t&&e&&Ex[e]&&Ex[e][t]){const s=Ex[e][t];return i(C2(s))}zX(t,e),i(ue(ue({},FX),{},{icon:Fe.showMissingIcons&&t?Ll("missingIconAbstract")||{}:{}}))})}const XM=()=>{},A2=Fe.measurePerformance&&Pg&&Pg.mark&&Pg.measure?Pg:{mark:XM,measure:XM},Sh='FA "6.7.1"',UX=t=>(A2.mark("".concat(Sh," ").concat(t," begins")),()=>pj(t)),pj=t=>{A2.mark("".concat(Sh," ").concat(t," ends")),A2.measure("".concat(Sh," ").concat(t),"".concat(Sh," ").concat(t," begins"),"".concat(Sh," ").concat(t," ends"))};var WC={begin:UX,end:pj};const V0=()=>{};function YM(t){return typeof(t.getAttribute?t.getAttribute(Jc):null)=="string"}function VX(t){const e=t.getAttribute?t.getAttribute(jC):null,n=t.getAttribute?t.getAttribute(BC):null;return e&&n}function HX(t){return t&&t.classList&&t.classList.contains&&t.classList.contains(Fe.replacementClass)}function WX(){return Fe.autoReplaceSvg===!0?H0.replace:H0[Fe.autoReplaceSvg]||H0.replace}function GX(t){return nn.createElementNS("http://www.w3.org/2000/svg",t)}function qX(t){return nn.createElement(t)}function mj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{ceFn:n=t.tag==="svg"?GX:qX}=e;if(typeof t=="string")return nn.createTextNode(t);const i=n(t.tag);return Object.keys(t.attributes||[]).forEach(function(s){i.setAttribute(s,t.attributes[s])}),(t.children||[]).forEach(function(s){i.appendChild(mj(s,{ceFn:n}))}),i}function KX(t){let e=" ".concat(t.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}const H0={replace:function(t){const e=t[0];if(e.parentNode)if(t[1].forEach(n=>{e.parentNode.insertBefore(mj(n),e)}),e.getAttribute(Jc)===null&&Fe.keepOriginalSource){let n=nn.createComment(KX(e));e.parentNode.replaceChild(n,e)}else e.remove()},nest:function(t){const e=t[0],n=t[1];if(~FC(e).indexOf(Fe.replacementClass))return H0.replace(t);const i=new RegExp("".concat(Fe.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){const s=n[0].attributes.class.split(" ").reduce((o,a)=>(a===Fe.replacementClass||a.match(i)?o.toSvg.push(a):o.toNode.push(a),o),{toNode:[],toSvg:[]});n[0].attributes.class=s.toSvg.join(" "),s.toNode.length===0?e.removeAttribute("class"):e.setAttribute("class",s.toNode.join(" "))}const r=n.map(s=>Pm(s)).join(`
`);e.setAttribute(Jc,""),e.innerHTML=r}};function JM(t){t()}function gj(t,e){const n=typeof e=="function"?e:V0;if(t.length===0)n();else{let i=JM;Fe.mutateApproach===JK&&(i=Tl.requestAnimationFrame||JM),i(()=>{const r=WX(),s=WC.begin("mutate");t.map(r),s(),n()})}}let GC=!1;function vj(){GC=!0}function P2(){GC=!1}let Zv=null;function ZM(t){if(!BM||!Fe.observeMutations)return;const{treeCallback:e=V0,nodeCallback:n=V0,pseudoElementsCallback:i=V0,observeMutationsRoot:r=nn}=t;Zv=new BM(s=>{if(GC)return;const o=Ol();_f(s).forEach(a=>{if(a.type==="childList"&&a.addedNodes.length>0&&!YM(a.addedNodes[0])&&(Fe.searchPseudoElements&&i(a.target),e(a.target)),a.type==="attributes"&&a.target.parentNode&&Fe.searchPseudoElements&&i(a.target.parentNode),a.type==="attributes"&&YM(a.target)&&~iX.indexOf(a.attributeName))if(a.attributeName==="class"&&VX(a.target)){const{prefix:l,iconName:c}=Mb(FC(a.target));a.target.setAttribute(jC,l||o),c&&a.target.setAttribute(BC,c)}else HX(a.target)&&n(a.target)})}),ka&&Zv.observe(r,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function XX(){Zv&&Zv.disconnect()}function YX(t){const e=t.getAttribute("style");let n=[];return e&&(n=e.split(";").reduce((i,r)=>{const s=r.split(":"),o=s[0],a=s.slice(1);return o&&a.length>0&&(i[o]=a.join(":").trim()),i},{})),n}function JX(t){const e=t.getAttribute("data-prefix"),n=t.getAttribute("data-icon"),i=t.innerText!==void 0?t.innerText.trim():"";let r=Mb(FC(t));return r.prefix||(r.prefix=Ol()),e&&n&&(r.prefix=e,r.iconName=n),r.iconName&&r.prefix||(r.prefix&&i.length>0&&(r.iconName=SX(r.prefix,t.innerText)||VC(r.prefix,w2(t.innerText))),!r.iconName&&Fe.autoFetchSvg&&t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&(r.iconName=t.firstChild.data)),r}function ZX(t){const e=_f(t.attributes).reduce((r,s)=>(r.name!=="class"&&r.name!=="style"&&(r[s.name]=s.value),r),{}),n=t.getAttribute("title"),i=t.getAttribute("data-fa-title-id");return Fe.autoA11y&&(n?e["aria-labelledby"]="".concat(Fe.replacementClass,"-title-").concat(i||Op()):(e["aria-hidden"]="true",e.focusable="false")),e}function QX(){return{iconName:null,title:null,titleId:null,prefix:null,transform:po,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function QM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0};const{iconName:n,prefix:i,rest:r}=JX(t),s=ZX(t),o=k2("parseNodeAttributes",{},t);let a=e.styleParser?YX(t):[];return ue({iconName:n,title:t.getAttribute("title"),titleId:t.getAttribute("data-fa-title-id"),prefix:i,transform:po,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:r,styles:a,attributes:s}},o)}const{styles:eY}=mo;function yj(t){const e=Fe.autoReplaceSvg==="nest"?QM(t,{styleParser:!1}):QM(t);return~e.extra.classes.indexOf(ZD)?Ll("generateLayersText",t,e):Ll("generateSvgReplacementMutation",t,e)}function tY(){return[...LK,...m2]}function eR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!ka)return Promise.resolve();const n=nn.documentElement.classList,i=u=>n.add("".concat(zM,"-").concat(u)),r=u=>n.remove("".concat(zM,"-").concat(u)),s=Fe.autoFetchSvg?tY():WD.concat(Object.keys(eY));s.includes("fa")||s.push("fa");const o=[".".concat(ZD,":not([").concat(Jc,"])")].concat(s.map(u=>".".concat(u,":not([").concat(Jc,"])"))).join(", ");if(o.length===0)return Promise.resolve();let a=[];try{a=_f(t.querySelectorAll(o))}catch{}if(a.length>0)i("pending"),r("complete");else return Promise.resolve();const l=WC.begin("onTree"),c=a.reduce((u,d)=>{try{const f=yj(d);f&&u.push(f)}catch(f){YD||f.name==="MissingIcon"&&console.error(f)}return u},[]);return new Promise((u,d)=>{Promise.all(c).then(f=>{gj(f,()=>{i("active"),i("complete"),r("pending"),typeof e=="function"&&e(),l(),u()})}).catch(f=>{l(),d(f)})})}function nY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;yj(t).then(n=>{n&&gj([n],e)})}function iY(t){return function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=(e||{}).icon?e:_2(e||{});let{mask:r}=n;return r&&(r=(r||{}).icon?r:_2(r||{})),t(i,ue(ue({},n),{},{mask:r}))}}const rY=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:n=po,symbol:i=!1,mask:r=null,maskId:s=null,title:o=null,titleId:a=null,classes:l=[],attributes:c={},styles:u={}}=e;if(!t)return;const{prefix:d,iconName:f,icon:p}=t;return Rb(ue({type:"icon"},t),()=>(Zc("beforeDOMElementCreation",{iconDefinition:t,params:e}),Fe.autoA11y&&(o?c["aria-labelledby"]="".concat(Fe.replacementClass,"-title-").concat(a||Op()):(c["aria-hidden"]="true",c.focusable="false")),HC({icons:{main:C2(p),mask:r?C2(r.icon):{found:!1,width:null,height:null,icon:{}}},prefix:d,iconName:f,transform:ue(ue({},po),n),symbol:i,title:o,maskId:s,titleId:a,extra:{attributes:c,styles:u,classes:l}})))};var sY={mixout(){return{icon:iY(rY)}},hooks(){return{mutationObserverCallbacks(t){return t.treeCallback=eR,t.nodeCallback=nY,t}}},provides(t){t.i2svg=function(e){const{node:n=nn,callback:i=()=>{}}=e;return eR(n,i)},t.generateSvgReplacementMutation=function(e,n){const{iconName:i,title:r,titleId:s,prefix:o,transform:a,symbol:l,mask:c,maskId:u,extra:d}=n;return new Promise((f,p)=>{Promise.all([E2(i,o),c.iconName?E2(c.iconName,c.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(m=>{let[g,y]=m;f([e,HC({icons:{main:g,mask:y},prefix:o,iconName:i,transform:a,symbol:l,maskId:u,title:r,titleId:s,extra:d,watchable:!0})])}).catch(p)})},t.generateAbstractIcon=function(e){let{children:n,attributes:i,main:r,transform:s,styles:o}=e;const a=Pb(o);a.length>0&&(i.style=a);let l;return zC(s)&&(l=Ll("generateAbstractTransformGrouping",{main:r,transform:s,containerWidth:r.width,iconWidth:r.width})),n.push(l||r.icon),{children:n,attributes:i}}}},oY={mixout(){return{layer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{classes:n=[]}=e;return Rb({type:"layer"},()=>{Zc("beforeDOMElementCreation",{assembler:t,params:e});let i=[];return t(r=>{Array.isArray(r)?r.map(s=>{i=i.concat(s.abstract)}):i=i.concat(r.abstract)}),[{tag:"span",attributes:{class:["".concat(Fe.cssPrefix,"-layers"),...n].join(" ")},children:i}]})}}}},aY={mixout(){return{counter(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{title:n=null,classes:i=[],attributes:r={},styles:s={}}=e;return Rb({type:"counter",content:t},()=>(Zc("beforeDOMElementCreation",{content:t,params:e}),$X({content:t.toString(),title:n,extra:{attributes:r,styles:s,classes:["".concat(Fe.cssPrefix,"-layers-counter"),...i]}})))}}}},lY={mixout(){return{text(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:n=po,title:i=null,classes:r=[],attributes:s={},styles:o={}}=e;return Rb({type:"text",content:t},()=>(Zc("beforeDOMElementCreation",{content:t,params:e}),KM({content:t,transform:ue(ue({},po),n),title:i,extra:{attributes:s,styles:o,classes:["".concat(Fe.cssPrefix,"-layers-text"),...r]}})))}}},provides(t){t.generateLayersText=function(e,n){const{title:i,transform:r,extra:s}=n;let o=null,a=null;if(VD){const l=parseInt(getComputedStyle(e).fontSize,10),c=e.getBoundingClientRect();o=c.width/l,a=c.height/l}return Fe.autoA11y&&!i&&(s.attributes["aria-hidden"]="true"),Promise.resolve([e,KM({content:e.innerHTML,width:o,height:a,transform:r,title:i,extra:s,watchable:!0})])}}};const cY=new RegExp('"',"ug"),tR=[1105920,1112319],nR=ue(ue(ue(ue({},{FontAwesome:{normal:"fas",400:"fas"}}),IK),XK),UK),N2=Object.keys(nR).reduce((t,e)=>(t[e.toLowerCase()]=nR[e],t),{}),uY=Object.keys(N2).reduce((t,e)=>{const n=N2[e];return t[e]=n[900]||[...Object.entries(n)][0][1],t},{});function dY(t){const e=t.replace(cY,""),n=vX(e,0),i=n>=tR[0]&&n<=tR[1],r=e.length===2?e[0]===e[1]:!1;return{value:w2(r?e[0]:e),isSecondary:i||r}}function fY(t,e){const n=t.replace(/^['"]|['"]$/g,"").toLowerCase(),i=parseInt(e),r=isNaN(i)?"normal":i;return(N2[n]||{})[r]||uY[n]}function iR(t,e){const n="".concat(YK).concat(e.replace(":","-"));return new Promise((i,r)=>{if(t.getAttribute(n)!==null)return i();const o=_f(t.children).filter(f=>f.getAttribute(v2)===e)[0],a=Tl.getComputedStyle(t,e),l=a.getPropertyValue("font-family"),c=l.match(tX),u=a.getPropertyValue("font-weight"),d=a.getPropertyValue("content");if(o&&!c)return t.removeChild(o),i();if(c&&d!=="none"&&d!==""){const f=a.getPropertyValue("content");let p=fY(l,u);const{value:m,isSecondary:g}=dY(f),y=c[0].startsWith("FontAwesome");let v=VC(p,m),b=v;if(y){const w=kX(m);w.iconName&&w.prefix&&(v=w.iconName,p=w.prefix)}if(v&&!g&&(!o||o.getAttribute(jC)!==p||o.getAttribute(BC)!==b)){t.setAttribute(n,b),o&&t.removeChild(o);const w=QX(),{extra:k}=w;k.attributes[v2]=e,E2(v,p).then(C=>{const E=HC(ue(ue({},w),{},{icons:{main:C,mask:fj()},prefix:p,iconName:b,extra:k,watchable:!0})),_=nn.createElementNS("http://www.w3.org/2000/svg","svg");e==="::before"?t.insertBefore(_,t.firstChild):t.appendChild(_),_.outerHTML=E.map(A=>Pm(A)).join(`
`),t.removeAttribute(n),i()}).catch(r)}else i()}else i()})}function hY(t){return Promise.all([iR(t,"::before"),iR(t,"::after")])}function pY(t){return t.parentNode!==document.head&&!~ZK.indexOf(t.tagName.toUpperCase())&&!t.getAttribute(v2)&&(!t.parentNode||t.parentNode.tagName!=="svg")}function rR(t){if(ka)return new Promise((e,n)=>{const i=_f(t.querySelectorAll("*")).filter(pY).map(hY),r=WC.begin("searchPseudoElements");vj(),Promise.all(i).then(()=>{r(),P2(),e()}).catch(()=>{r(),P2(),n()})})}var mY={hooks(){return{mutationObserverCallbacks(t){return t.pseudoElementsCallback=rR,t}}},provides(t){t.pseudoElements2svg=function(e){const{node:n=nn}=e;Fe.searchPseudoElements&&rR(n)}}};let sR=!1;var gY={mixout(){return{dom:{unwatch(){vj(),sR=!0}}}},hooks(){return{bootstrap(){ZM(k2("mutationObserverCallbacks",{}))},noAuto(){XX()},watch(t){const{observeMutationsRoot:e}=t;sR?P2():ZM(k2("mutationObserverCallbacks",{observeMutationsRoot:e}))}}}};const oR=t=>{let e={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return t.toLowerCase().split(" ").reduce((n,i)=>{const r=i.toLowerCase().split("-"),s=r[0];let o=r.slice(1).join("-");if(s&&o==="h")return n.flipX=!0,n;if(s&&o==="v")return n.flipY=!0,n;if(o=parseFloat(o),isNaN(o))return n;switch(s){case"grow":n.size=n.size+o;break;case"shrink":n.size=n.size-o;break;case"left":n.x=n.x-o;break;case"right":n.x=n.x+o;break;case"up":n.y=n.y-o;break;case"down":n.y=n.y+o;break;case"rotate":n.rotate=n.rotate+o;break}return n},e)};var vY={mixout(){return{parse:{transform:t=>oR(t)}}},hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-transform");return n&&(t.transform=oR(n)),t}}},provides(t){t.generateAbstractTransformGrouping=function(e){let{main:n,transform:i,containerWidth:r,iconWidth:s}=e;const o={transform:"translate(".concat(r/2," 256)")},a="translate(".concat(i.x*32,", ").concat(i.y*32,") "),l="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),c="rotate(".concat(i.rotate," 0 0)"),u={transform:"".concat(a," ").concat(l," ").concat(c)},d={transform:"translate(".concat(s/2*-1," -256)")},f={outer:o,inner:u,path:d};return{tag:"g",attributes:ue({},f.outer),children:[{tag:"g",attributes:ue({},f.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:ue(ue({},n.icon.attributes),f.path)}]}]}}}};const Ax={x:0,y:0,width:"100%",height:"100%"};function aR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.attributes&&(t.attributes.fill||e)&&(t.attributes.fill="black"),t}function yY(t){return t.tag==="g"?t.children:[t]}var bY={hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-mask"),i=n?Mb(n.split(" ").map(r=>r.trim())):fj();return i.prefix||(i.prefix=Ol()),t.mask=i,t.maskId=e.getAttribute("data-fa-mask-id"),t}}},provides(t){t.generateAbstractMask=function(e){let{children:n,attributes:i,main:r,mask:s,maskId:o,transform:a}=e;const{width:l,icon:c}=r,{width:u,icon:d}=s,f=dX({transform:a,containerWidth:u,iconWidth:l}),p={tag:"rect",attributes:ue(ue({},Ax),{},{fill:"white"})},m=c.children?{children:c.children.map(aR)}:{},g={tag:"g",attributes:ue({},f.inner),children:[aR(ue({tag:c.tag,attributes:ue(ue({},c.attributes),f.path)},m))]},y={tag:"g",attributes:ue({},f.outer),children:[g]},v="mask-".concat(o||Op()),b="clip-".concat(o||Op()),w={tag:"mask",attributes:ue(ue({},Ax),{},{id:v,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[p,y]},k={tag:"defs",children:[{tag:"clipPath",attributes:{id:b},children:yY(d)},w]};return n.push(k,{tag:"rect",attributes:ue({fill:"currentColor","clip-path":"url(#".concat(b,")"),mask:"url(#".concat(v,")")},Ax)}),{children:n,attributes:i}}}},xY={provides(t){let e=!1;Tl.matchMedia&&(e=Tl.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){const n=[],i={fill:"currentColor"},r={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:ue(ue({},i),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});const s=ue(ue({},r),{},{attributeName:"opacity"}),o={tag:"circle",attributes:ue(ue({},i),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||o.children.push({tag:"animate",attributes:ue(ue({},r),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:ue(ue({},s),{},{values:"1;0;1;1;0;1;"})}),n.push(o),n.push({tag:"path",attributes:ue(ue({},i),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:ue(ue({},s),{},{values:"1;0;0;0;0;1;"})}]}),e||n.push({tag:"path",attributes:ue(ue({},i),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:ue(ue({},s),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},wY={hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-symbol"),i=n===null?!1:n===""?!0:n;return t.symbol=i,t}}}},SY=[pX,sY,oY,aY,lY,mY,gY,vY,bY,xY,wY];IX(SY,{mixoutsTo:jr});jr.noAuto;jr.config;jr.library;jr.dom;const M2=jr.parse;jr.findIconDefinition;jr.toHtml;const kY=jr.icon;jr.layer;jr.text;jr.counter;var bj={exports:{}},_Y="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",CY=_Y,EY=CY;function xj(){}function wj(){}wj.resetWarningCache=xj;var AY=function(){function t(i,r,s,o,a,l){if(l!==EY){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:wj,resetWarningCache:xj};return n.PropTypes=n,n};bj.exports=AY();var PY=bj.exports;const gt=uu(PY);function lR(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function so(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?lR(Object(n),!0).forEach(function(i){od(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lR(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Qv(t){"@babel/helpers - typeof";return Qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qv(t)}function od(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NY(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function MY(t,e){if(t==null)return{};var n=NY(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function R2(t){return RY(t)||IY(t)||TY(t)||OY()}function RY(t){if(Array.isArray(t))return I2(t)}function IY(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function TY(t,e){if(t){if(typeof t=="string")return I2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I2(t,e)}}function I2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function OY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LY(t){var e,n=t.beat,i=t.fade,r=t.beatFade,s=t.bounce,o=t.shake,a=t.flash,l=t.spin,c=t.spinPulse,u=t.spinReverse,d=t.pulse,f=t.fixedWidth,p=t.inverse,m=t.border,g=t.listItem,y=t.flip,v=t.size,b=t.rotation,w=t.pull,k=(e={"fa-beat":n,"fa-fade":i,"fa-beat-fade":r,"fa-bounce":s,"fa-shake":o,"fa-flash":a,"fa-spin":l,"fa-spin-reverse":u,"fa-spin-pulse":c,"fa-pulse":d,"fa-fw":f,"fa-inverse":p,"fa-border":m,"fa-li":g,"fa-flip":y===!0,"fa-flip-horizontal":y==="horizontal"||y==="both","fa-flip-vertical":y==="vertical"||y==="both"},od(e,"fa-".concat(v),typeof v<"u"&&v!==null),od(e,"fa-rotate-".concat(b),typeof b<"u"&&b!==null&&b!==0),od(e,"fa-pull-".concat(w),typeof w<"u"&&w!==null),od(e,"fa-swap-opacity",t.swapOpacity),e);return Object.keys(k).map(function(C){return k[C]?C:null}).filter(function(C){return C})}function DY(t){return t=t-0,t===t}function Sj(t){return DY(t)?t:(t=t.replace(/[\-_\s]+(.)?/g,function(e,n){return n?n.toUpperCase():""}),t.substr(0,1).toLowerCase()+t.substr(1))}var jY=["style"];function BY(t){return t.charAt(0).toUpperCase()+t.slice(1)}function $Y(t){return t.split(";").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,n){var i=n.indexOf(":"),r=Sj(n.slice(0,i)),s=n.slice(i+1).trim();return r.startsWith("webkit")?e[BY(r)]=s:e[r]=s,e},{})}function kj(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string")return e;var i=(e.children||[]).map(function(l){return kj(t,l)}),r=Object.keys(e.attributes||{}).reduce(function(l,c){var u=e.attributes[c];switch(c){case"class":l.attrs.className=u,delete e.attributes.class;break;case"style":l.attrs.style=$Y(u);break;default:c.indexOf("aria-")===0||c.indexOf("data-")===0?l.attrs[c.toLowerCase()]=u:l.attrs[Sj(c)]=u}return l},{attrs:{}}),s=n.style,o=s===void 0?{}:s,a=MY(n,jY);return r.attrs.style=so(so({},r.attrs.style),o),t.apply(void 0,[e.tag,so(so({},r.attrs),a)].concat(R2(i)))}var _j=!1;try{_j=!0}catch{}function FY(){if(!_j&&console&&typeof console.error=="function"){var t;(t=console).error.apply(t,arguments)}}function cR(t){if(t&&Qv(t)==="object"&&t.prefix&&t.iconName&&t.icon)return t;if(M2.icon)return M2.icon(t);if(t===null)return null;if(t&&Qv(t)==="object"&&t.prefix&&t.iconName)return t;if(Array.isArray(t)&&t.length===2)return{prefix:t[0],iconName:t[1]};if(typeof t=="string")return{prefix:"fas",iconName:t}}function Px(t,e){return Array.isArray(e)&&e.length>0||!Array.isArray(e)&&e?od({},t,e):{}}var uR={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1},Ye=Qt.forwardRef(function(t,e){var n=so(so({},uR),t),i=n.icon,r=n.mask,s=n.symbol,o=n.className,a=n.title,l=n.titleId,c=n.maskId,u=cR(i),d=Px("classes",[].concat(R2(LY(n)),R2((o||"").split(" ")))),f=Px("transform",typeof n.transform=="string"?M2.transform(n.transform):n.transform),p=Px("mask",cR(r)),m=kY(u,so(so(so(so({},d),f),p),{},{symbol:s,title:a,titleId:l,maskId:c}));if(!m)return FY("Could not find icon",u),null;var g=m.abstract,y={ref:e};return Object.keys(n).forEach(function(v){uR.hasOwnProperty(v)||(y[v]=n[v])}),zY(g[0],y)});Ye.displayName="FontAwesomeIcon";Ye.propTypes={beat:gt.bool,border:gt.bool,beatFade:gt.bool,bounce:gt.bool,className:gt.string,fade:gt.bool,flash:gt.bool,mask:gt.oneOfType([gt.object,gt.array,gt.string]),maskId:gt.string,fixedWidth:gt.bool,inverse:gt.bool,flip:gt.oneOf([!0,!1,"horizontal","vertical","both"]),icon:gt.oneOfType([gt.object,gt.array,gt.string]),listItem:gt.bool,pull:gt.oneOf(["right","left"]),pulse:gt.bool,rotation:gt.oneOf([0,90,180,270]),shake:gt.bool,size:gt.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:gt.bool,spinPulse:gt.bool,spinReverse:gt.bool,symbol:gt.oneOfType([gt.bool,gt.string]),title:gt.string,titleId:gt.string,transform:gt.oneOfType([gt.string,gt.object]),swapOpacity:gt.bool};var zY=kj.bind(null,Qt.createElement);function Cj(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=Cj(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function re(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=Cj(t))&&(i&&(i+=" "),i+=e);return i}/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const UY={prefix:"fas",iconName:"forward-step",icon:[320,512,["step-forward"],"f051","M52.5 440.6c-9.5 7.9-22.8 9.7-34.1 4.4S0 428.4 0 416L0 96C0 83.6 7.2 72.3 18.4 67s24.5-3.6 34.1 4.4l192 160L256 241l0-145c0-17.7 14.3-32 32-32s32 14.3 32 32l0 320c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-145-11.5 9.6-192 160z"]},qC=UY,xd={prefix:"fas",iconName:"lightbulb",icon:[384,512,[128161],"f0eb","M272 384c9.6-31.9 29.5-59.1 49.2-86.2c0 0 0 0 0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4c0 0 0 0 0 0c19.8 27.1 39.7 54.4 49.2 86.2l160 0zM192 512c44.2 0 80-35.8 80-80l0-16-160 0 0 16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"]},VY={prefix:"fas",iconName:"compress",icon:[448,512,[],"f066","M160 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96zM32 320c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM352 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 320c-17.7 0-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0z"]},HY={prefix:"fas",iconName:"user",icon:[448,512,[128100,62144],"f007","M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512l388.6 0c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304l-91.4 0z"]},WY={prefix:"fas",iconName:"star",icon:[576,512,[11088,61446],"f005","M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z"]},dR={prefix:"fas",iconName:"microchip",icon:[512,512,[],"f2db","M176 24c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40c-35.3 0-64 28.7-64 64l-40 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l40 0 0 56-40 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l40 0 0 56-40 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l40 0c0 35.3 28.7 64 64 64l0 40c0 13.3 10.7 24 24 24s24-10.7 24-24l0-40 56 0 0 40c0 13.3 10.7 24 24 24s24-10.7 24-24l0-40 56 0 0 40c0 13.3 10.7 24 24 24s24-10.7 24-24l0-40c35.3 0 64-28.7 64-64l40 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-40 0 0-56 40 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-40 0 0-56 40 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-40 0c0-35.3-28.7-64-64-64l0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40-56 0 0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40-56 0 0-40zM160 128l192 0c17.7 0 32 14.3 32 32l0 192c0 17.7-14.3 32-32 32l-192 0c-17.7 0-32-14.3-32-32l0-192c0-17.7 14.3-32 32-32zm192 32l-192 0 0 192 192 0 0-192z"]},GY={prefix:"fas",iconName:"rotate-left",icon:[512,512,["rotate-back","rotate-backward","undo-alt"],"f2ea","M48.5 224L40 224c-13.3 0-24-10.7-24-24L16 72c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2L98.6 96.6c87.6-86.5 228.7-86.2 315.8 1c87.5 87.5 87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3c-62.2-62.2-162.7-62.5-225.3-1L185 183c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8L48.5 224z"]},qY={prefix:"fas",iconName:"circle-check",icon:[512,512,[61533,"check-circle"],"f058","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"]},Ej=qY,Xh={prefix:"fas",iconName:"pause",icon:[320,512,[9208],"f04c","M48 64C21.5 64 0 85.5 0 112L0 400c0 26.5 21.5 48 48 48l32 0c26.5 0 48-21.5 48-48l0-288c0-26.5-21.5-48-48-48L48 64zm192 0c-26.5 0-48 21.5-48 48l0 288c0 26.5 21.5 48 48 48l32 0c26.5 0 48-21.5 48-48l0-288c0-26.5-21.5-48-48-48l-32 0z"]},KY={prefix:"fas",iconName:"arrows-rotate",icon:[512,512,[128472,"refresh","sync"],"f021","M105.1 202.6c7.7-21.8 20.2-42.3 37.8-59.8c62.5-62.5 163.8-62.5 226.3 0L386.3 160 352 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l111.5 0c0 0 0 0 0 0l.4 0c17.7 0 32-14.3 32-32l0-112c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 35.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5zM39 289.3c-5 1.5-9.8 4.2-13.7 8.2c-4 4-6.7 8.8-8.1 14c-.3 1.2-.6 2.5-.8 3.8c-.3 1.7-.4 3.4-.4 5.1L16 432c0 17.7 14.3 32 32 32s32-14.3 32-32l0-35.1 17.6 17.5c0 0 0 0 0 0c87.5 87.4 229.3 87.4 316.7 0c24.4-24.4 42.1-53.1 52.9-83.8c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.5 62.5-163.8 62.5-226.3 0l-.1-.1L125.6 352l34.4 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L48.4 288c-1.6 0-3.2 .1-4.8 .3s-3.1 .5-4.6 1z"]},XY=KY,YY={prefix:"fas",iconName:"chart-line",icon:[512,512,["line-chart"],"f201","M64 64c0-17.7-14.3-32-32-32S0 46.3 0 64L0 400c0 44.2 35.8 80 80 80l400 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L80 416c-8.8 0-16-7.2-16-16L64 64zm406.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L320 210.7l-57.4-57.4c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L240 221.3l57.4 57.4c12.5 12.5 32.8 12.5 45.3 0l128-128z"]},JY={prefix:"fas",iconName:"circle-question",icon:[512,512,[62108,"question-circle"],"f059","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM169.8 165.3c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"]},ZY=JY,QY={prefix:"fas",iconName:"arrow-rotate-right",icon:[512,512,[8635,"arrow-right-rotate","arrow-rotate-forward","redo"],"f01e","M386.3 160L336 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l128 0c17.7 0 32-14.3 32-32l0-128c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 51.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0s-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3s163.8-62.5 226.3 0L386.3 160z"]},Aj=QY,eJ={prefix:"fas",iconName:"circle-info",icon:[512,512,["info-circle"],"f05a","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336l24 0 0-64-24 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l48 0c13.3 0 24 10.7 24 24l0 88 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-80 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"]},Pj=eJ,tJ={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29l0-320c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241 64 96c0-17.7-14.3-32-32-32S0 78.3 0 96L0 416c0 17.7 14.3 32 32 32s32-14.3 32-32l0-145 11.5 9.6 192 160z"]},Nj=tJ,nJ={prefix:"fas",iconName:"download",icon:[512,512,[],"f019","M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 242.7-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7 288 32zM64 352c-35.3 0-64 28.7-64 64l0 32c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-32c0-35.3-28.7-64-64-64l-101.5 0-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352 64 352zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"]},Ib={prefix:"fas",iconName:"play",icon:[384,512,[9654],"f04b","M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80L0 432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"]},iJ={prefix:"fas",iconName:"expand",icon:[448,512,[],"f065","M32 32C14.3 32 0 46.3 0 64l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L32 32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96z"]},rJ={prefix:"fas",iconName:"xmark",icon:[384,512,[128473,10005,10006,10060,215,"close","multiply","remove","times"],"f00d","M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"]},Tb=rJ,KC={prefix:"fas",iconName:"rocket",icon:[512,512,[],"f135","M156.6 384.9L125.7 354c-8.5-8.5-11.5-20.8-7.7-32.2c3-8.9 7-20.5 11.8-33.8L24 288c-8.6 0-16.6-4.6-20.9-12.1s-4.2-16.7 .2-24.1l52.5-88.5c13-21.9 36.5-35.3 61.9-35.3l82.3 0c2.4-4 4.8-7.7 7.2-11.3C289.1-4.1 411.1-8.1 483.9 5.3c11.6 2.1 20.6 11.2 22.8 22.8c13.4 72.9 9.3 194.8-111.4 276.7c-3.5 2.4-7.3 4.8-11.3 7.2l0 82.3c0 25.4-13.4 49-35.3 61.9l-88.5 52.5c-7.4 4.4-16.6 4.5-24.1 .2s-12.1-12.2-12.1-20.9l0-107.2c-14.1 4.9-26.4 8.9-35.7 11.9c-11.2 3.6-23.4 .5-31.8-7.8zM384 168a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"]},sJ={prefix:"fas",iconName:"chevron-left",icon:[320,512,[9001],"f053","M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"]},oJ={prefix:"fas",iconName:"chevron-right",icon:[320,512,[9002],"f054","M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"]},XC={prefix:"fas",iconName:"trophy",icon:[576,512,[127942],"f091","M400 0L176 0c-26.5 0-48.1 21.8-47.1 48.2c.2 5.3 .4 10.6 .7 15.8L24 64C10.7 64 0 74.7 0 88c0 92.6 33.5 157 78.5 200.7c44.3 43.1 98.3 64.8 138.1 75.8c23.4 6.5 39.4 26 39.4 45.6c0 20.9-17 37.9-37.9 37.9L192 448c-17.7 0-32 14.3-32 32s14.3 32 32 32l192 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-26.1 0C337 448 320 431 320 410.1c0-19.6 15.9-39.2 39.4-45.6c39.9-11 93.9-32.7 138.2-75.8C542.5 245 576 180.6 576 88c0-13.3-10.7-24-24-24L446.4 64c.3-5.2 .5-10.4 .7-15.8C448.1 21.8 426.5 0 400 0zM48.9 112l84.4 0c9.1 90.1 29.2 150.3 51.9 190.6c-24.9-11-50.8-26.5-73.2-48.3c-32-31.1-58-76-63-142.3zM464.1 254.3c-22.4 21.8-48.3 37.3-73.2 48.3c22.7-40.3 42.8-100.5 51.9-190.6l84.4 0c-5.1 66.3-31.1 111.2-63 142.3z"]},Mj={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},aJ={prefix:"fas",iconName:"gears",icon:[640,512,["cogs"],"f085","M308.5 135.3c7.1-6.3 9.9-16.2 6.2-25c-2.3-5.3-4.8-10.5-7.6-15.5L304 89.4c-3-5-6.3-9.9-9.8-14.6c-5.7-7.6-15.7-10.1-24.7-7.1l-28.2 9.3c-10.7-8.8-23-16-36.2-20.9L199 27.1c-1.9-9.3-9.1-16.7-18.5-17.8C173.9 8.4 167.2 8 160.4 8l-.7 0c-6.8 0-13.5 .4-20.1 1.2c-9.4 1.1-16.6 8.6-18.5 17.8L115 56.1c-13.3 5-25.5 12.1-36.2 20.9L50.5 67.8c-9-3-19-.5-24.7 7.1c-3.5 4.7-6.8 9.6-9.9 14.6l-3 5.3c-2.8 5-5.3 10.2-7.6 15.6c-3.7 8.7-.9 18.6 6.2 25l22.2 19.8C32.6 161.9 32 168.9 32 176s.6 14.1 1.7 20.9L11.5 216.7c-7.1 6.3-9.9 16.2-6.2 25c2.3 5.3 4.8 10.5 7.6 15.6l3 5.2c3 5.1 6.3 9.9 9.9 14.6c5.7 7.6 15.7 10.1 24.7 7.1l28.2-9.3c10.7 8.8 23 16 36.2 20.9l6.1 29.1c1.9 9.3 9.1 16.7 18.5 17.8c6.7 .8 13.5 1.2 20.4 1.2s13.7-.4 20.4-1.2c9.4-1.1 16.6-8.6 18.5-17.8l6.1-29.1c13.3-5 25.5-12.1 36.2-20.9l28.2 9.3c9 3 19 .5 24.7-7.1c3.5-4.7 6.8-9.5 9.8-14.6l3.1-5.4c2.8-5 5.3-10.2 7.6-15.5c3.7-8.7 .9-18.6-6.2-25l-22.2-19.8c1.1-6.8 1.7-13.8 1.7-20.9s-.6-14.1-1.7-20.9l22.2-19.8zM112 176a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zM504.7 500.5c6.3 7.1 16.2 9.9 25 6.2c5.3-2.3 10.5-4.8 15.5-7.6l5.4-3.1c5-3 9.9-6.3 14.6-9.8c7.6-5.7 10.1-15.7 7.1-24.7l-9.3-28.2c8.8-10.7 16-23 20.9-36.2l29.1-6.1c9.3-1.9 16.7-9.1 17.8-18.5c.8-6.7 1.2-13.5 1.2-20.4s-.4-13.7-1.2-20.4c-1.1-9.4-8.6-16.6-17.8-18.5L583.9 307c-5-13.3-12.1-25.5-20.9-36.2l9.3-28.2c3-9 .5-19-7.1-24.7c-4.7-3.5-9.6-6.8-14.6-9.9l-5.3-3c-5-2.8-10.2-5.3-15.6-7.6c-8.7-3.7-18.6-.9-25 6.2l-19.8 22.2c-6.8-1.1-13.8-1.7-20.9-1.7s-14.1 .6-20.9 1.7l-19.8-22.2c-6.3-7.1-16.2-9.9-25-6.2c-5.3 2.3-10.5 4.8-15.6 7.6l-5.2 3c-5.1 3-9.9 6.3-14.6 9.9c-7.6 5.7-10.1 15.7-7.1 24.7l9.3 28.2c-8.8 10.7-16 23-20.9 36.2L315.1 313c-9.3 1.9-16.7 9.1-17.8 18.5c-.8 6.7-1.2 13.5-1.2 20.4s.4 13.7 1.2 20.4c1.1 9.4 8.6 16.6 17.8 18.5l29.1 6.1c5 13.3 12.1 25.5 20.9 36.2l-9.3 28.2c-3 9-.5 19 7.1 24.7c4.7 3.5 9.5 6.8 14.6 9.8l5.4 3.1c5 2.8 10.2 5.3 15.5 7.6c8.7 3.7 18.6 .9 25-6.2l19.8-22.2c6.8 1.1 13.8 1.7 20.9 1.7s14.1-.6 20.9-1.7l19.8 22.2zM464 304a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"]},fR=aJ,lJ={prefix:"fas",iconName:"infinity",icon:[640,512,[8734,9854],"f534","M0 241.1C0 161 65 96 145.1 96c38.5 0 75.4 15.3 102.6 42.5L320 210.7l72.2-72.2C419.5 111.3 456.4 96 494.9 96C575 96 640 161 640 241.1l0 29.7C640 351 575 416 494.9 416c-38.5 0-75.4-15.3-102.6-42.5L320 301.3l-72.2 72.2C220.5 400.7 183.6 416 145.1 416C65 416 0 351 0 270.9l0-29.7zM274.7 256l-72.2-72.2c-15.2-15.2-35.9-23.8-57.4-23.8C100.3 160 64 196.3 64 241.1l0 29.7c0 44.8 36.3 81.1 81.1 81.1c21.5 0 42.2-8.5 57.4-23.8L274.7 256zm90.5 0l72.2 72.2c15.2 15.2 35.9 23.8 57.4 23.8c44.8 0 81.1-36.3 81.1-81.1l0-29.7c0-44.8-36.3-81.1-81.1-81.1c-21.5 0-42.2 8.5-57.4 23.8L365.3 256z"]},cJ={prefix:"fas",iconName:"book",icon:[448,512,[128212],"f02d","M96 0C43 0 0 43 0 96L0 416c0 53 43 96 96 96l288 0 32 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l0-64c17.7 0 32-14.3 32-32l0-320c0-17.7-14.3-32-32-32L384 0 96 0zm0 384l256 0 0 64L96 448c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16l192 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-192 0c-8.8 0-16-7.2-16-16zm16 48l192 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-192 0c-8.8 0-16-7.2-16-16s7.2-16 16-16z"]},uJ={prefix:"fas",iconName:"check",icon:[448,512,[10003,10004],"f00c","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"]},dJ={prefix:"fas",iconName:"triangle-exclamation",icon:[512,512,[9888,"exclamation-triangle","warning"],"f071","M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480L40 480c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24l0 112c0 13.3 10.7 24 24 24s24-10.7 24-24l0-112c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"]},fJ=dJ,hJ={prefix:"fas",iconName:"database",icon:[448,512,[],"f1c0","M448 80l0 48c0 44.2-100.3 80-224 80S0 172.2 0 128L0 80C0 35.8 100.3 0 224 0S448 35.8 448 80zM393.2 214.7c20.8-7.4 39.9-16.9 54.8-28.6L448 288c0 44.2-100.3 80-224 80S0 332.2 0 288L0 186.1c14.9 11.8 34 21.2 54.8 28.6C99.7 230.7 159.5 240 224 240s124.3-9.3 169.2-25.3zM0 346.1c14.9 11.8 34 21.2 54.8 28.6C99.7 390.7 159.5 400 224 400s124.3-9.3 169.2-25.3c20.8-7.4 39.9-16.9 54.8-28.6l0 85.9c0 44.2-100.3 80-224 80S0 476.2 0 432l0-85.9z"]},Nm={prefix:"fas",iconName:"graduation-cap",icon:[640,512,[127891,"mortar-board"],"f19d","M320 32c-8.1 0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9 0 149.9 0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9l0 28.1c0 28.4-10.8 57.7-22.3 80.8c-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3 .9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7 .3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7C90.3 344.3 86 329.8 80 316.5l0-24.6c0-30.2 10.2-58.7 27.9-81.5c12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5 .8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1L624.2 182.6c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32zM128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6 354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6L143.3 262.6 128 408z"]},Rj={default:"bg-stone-800 text-white hover:bg-stone-700 focus:ring-stone-500",destructive:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"border border-stone-600 bg-transparent text-white hover:bg-stone-800 focus:ring-stone-500",secondary:"bg-stone-700 text-white hover:bg-stone-600 focus:ring-stone-500",ghost:"bg-transparent text-stone-300 hover:bg-stone-800 hover:text-white focus:ring-stone-500",link:"bg-transparent text-mantis-400 hover:text-mantis-300 hover:underline focus:ring-mantis-500",primary:"bg-mantis-600 text-white hover:bg-mantis-700 focus:ring-mantis-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500",warning:"bg-yellow-600 text-white hover:bg-yellow-700 focus:ring-yellow-500",error:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"},pJ={sm:"h-8 px-3 text-xs",md:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base",xl:"h-14 px-8 text-lg"},Ct=x.memo(x.forwardRef(({variant:t="default",size:e="md",isLoading:n=!1,loadingText:i,leftIcon:r,rightIcon:s,disabled:o=!1,fullWidth:a=!1,className:l,children:c,onClick:u,type:d="button","aria-label":f,title:p,...m},g)=>{const y=o||n;return h.jsxs("button",{ref:g,type:d,disabled:y,onClick:u,"aria-label":f,title:p,className:re("inline-flex items-center justify-center gap-2 rounded-lg font-medium transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-stone-900","disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50","hover:scale-105 active:scale-95",Rj[t],pJ[e],a&&"w-full",l),...m,children:[n&&h.jsx(Ye,{icon:Mj,className:"animate-spin","aria-hidden":"true"}),!n&&r&&h.jsx("span",{className:"flex items-center","aria-hidden":"true",children:r}),h.jsx("span",{children:n&&i?i:c}),!n&&s&&h.jsx("span",{className:"flex items-center","aria-hidden":"true",children:s})]})}));Ct.displayName="Button";const W0=x.memo(x.forwardRef(({icon:t,variant:e="ghost",size:n="md",isLoading:i=!1,disabled:r=!1,className:s,onClick:o,"aria-label":a,title:l,...c},u)=>{const d=r||i,f={sm:"size-8",md:"size-10",lg:"size-12",xl:"size-14"};return h.jsx("button",{ref:u,disabled:d,onClick:o,"aria-label":a,title:l,className:re("inline-flex items-center justify-center rounded-lg transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-stone-900","disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50","hover:scale-105 active:scale-95",Rj[e],f[n],s),...c,children:i?h.jsx(Ye,{icon:Mj,className:"animate-spin","aria-hidden":"true"}):h.jsx("span",{className:"flex items-center justify-center","aria-hidden":"true",children:t})})}));W0.displayName="IconButton";const mJ=x.memo(({children:t,orientation:e="horizontal",className:n})=>h.jsx("div",{className:re("inline-flex",e==="horizontal"?"flex-row":"flex-col",n),role:"group",children:t}));mJ.displayName="ButtonGroup";const Ij={top:"bottom-full left-1/2 transform -translate-x-1/2 mb-2",bottom:"top-full left-1/2 transform -translate-x-1/2 mt-2",left:"right-full top-1/2 transform -translate-y-1/2 mr-2",right:"left-full top-1/2 transform -translate-y-1/2 ml-2","top-start":"bottom-full left-0 mb-2","top-end":"bottom-full right-0 mb-2","bottom-start":"top-full left-0 mt-2","bottom-end":"top-full right-0 mt-2"},Tj={top:"top-full left-1/2 transform -translate-x-1/2 border-t-stone-800",bottom:"bottom-full left-1/2 transform -translate-x-1/2 border-b-stone-800",left:"left-full top-1/2 transform -translate-y-1/2 border-l-stone-800",right:"right-full top-1/2 transform -translate-y-1/2 border-r-stone-800","top-start":"top-full left-4 border-t-stone-800","top-end":"top-full right-4 border-t-stone-800","bottom-start":"bottom-full left-4 border-b-stone-800","bottom-end":"bottom-full right-4 border-b-stone-800"},rs=x.memo(({content:t,children:e,position:n="top",delay:i=200,className:r,maxWidth:s=300,showArrow:o=!0,disabled:a=!1})=>{const[l,c]=x.useState(!1),[u,d]=x.useState(n),f=x.useRef(null),p=x.useRef(null),m=x.useRef(),g=x.useCallback(()=>{a||(document.body.classList.add("tooltip-open"),m.current=setTimeout(()=>{c(!0)},i))},[a,i]),y=x.useCallback(()=>{m.current&&clearTimeout(m.current),document.body.classList.remove("tooltip-open"),c(!1)},[]);return x.useEffect(()=>{if(!l||!p.current||!f.current)return;const v=p.current,w=f.current.getBoundingClientRect(),k=v.getBoundingClientRect();let C=n;w.left+k.width>window.innerWidth&&(n.includes("right")?C="left":n.includes("top")?C="top-end":n.includes("bottom")&&(C="bottom-end")),w.left-k.width<0&&(n.includes("left")?C="right":n.includes("top")?C="top-start":n.includes("bottom")&&(C="bottom-start")),w.top-k.height<0&&n.includes("top")&&(C="bottom"),w.bottom+k.height>window.innerHeight&&n.includes("bottom")&&(C="top"),d(C)},[l,n]),h.jsxs("div",{ref:f,className:re("relative inline-block",r),onMouseEnter:g,onMouseLeave:y,onFocus:g,onBlur:y,children:[e,l&&h.jsxs("div",{ref:p,className:re("absolute z-50 rounded-lg border border-stone-600 bg-stone-800 px-4 py-3 text-sm text-white shadow-lg","animate-fade-in",Ij[u]),style:{maxWidth:`${s}px`,minWidth:"200px"},role:"tooltip",children:[t,o&&h.jsx("div",{className:re("absolute size-0 border-4 border-transparent",Tj[u])})]})]})});rs.displayName="Tooltip";const gJ=x.memo(({content:t,className:e,size:n="md"})=>{const i={sm:"size-3",md:"size-4",lg:"size-5"};return h.jsx(rs,{content:t,className:e,children:h.jsx(Ye,{icon:Pj,className:re("cursor-help text-stone-400 transition-colors hover:text-stone-300",i[n])})})});gJ.displayName="InfoTooltip";const vJ=x.memo(({content:t,trigger:e,position:n="top",delay:i=200,className:r,maxWidth:s=300,showArrow:o=!0,disabled:a=!1})=>{const[l,c]=x.useState(!1),u=x.useRef(null),d=x.useRef(null),f=x.useRef(),p=x.useCallback(()=>{a||(f.current=setTimeout(()=>{c(!0)},i))},[a,i]),m=x.useCallback(()=>{f.current&&clearTimeout(f.current),c(!1)},[]);return h.jsxs("div",{ref:u,className:re("relative inline-block",r),onMouseEnter:p,onMouseLeave:m,onFocus:p,onBlur:m,children:[e,l&&h.jsxs("div",{ref:d,className:re("absolute z-50 rounded-lg border border-stone-600 bg-stone-800 px-4 py-3 text-sm text-white shadow-lg","animate-fade-in",Ij[n]),style:{maxWidth:`${s}px`,minWidth:"200px"},role:"tooltip",children:[t,o&&h.jsx("div",{className:re("absolute size-0 border-4 border-transparent",Tj[n])})]})]})});vJ.displayName="CustomTooltip";function Oj(t,e){const n=e.split(".");let i=t;for(const r of n)if(r in i)i=i[r];else throw new ReferenceError(`Couldn't find path "${e}".`);return i}const Lj=["en","es"];function YC(t){return function(n,i,...r){const s=Oj(t[n],i);if(typeof s=="function")return s(...r);if(typeof s=="string")return s;throw new Error(`Missing translation for key ${i}`)}}const JC={},yJ=Symbol((JC?"production":void 0)!=="production"?"RESET":""),Dj=t=>typeof(t==null?void 0:t.then)=="function";function bJ(t=()=>{try{return window.localStorage}catch(n){(JC?"production":void 0)!=="production"&&typeof window<"u"&&console.warn(n);return}},e){var n;let i,r;const s={getItem:(l,c)=>{var u,d;const f=m=>{if(m=m||"",i!==m){try{r=JSON.parse(m,e==null?void 0:e.reviver)}catch{return c}i=m}return r},p=(d=(u=t())==null?void 0:u.getItem(l))!=null?d:null;return Dj(p)?p.then(f):f(p)},setItem:(l,c)=>{var u;return(u=t())==null?void 0:u.setItem(l,JSON.stringify(c,void 0))},removeItem:l=>{var c;return(c=t())==null?void 0:c.removeItem(l)}},o=l=>(c,u,d)=>l(c,f=>{let p;try{p=JSON.parse(f||"")}catch{p=d}u(p)});let a;try{a=(n=t())==null?void 0:n.subscribe}catch{}return!a&&typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(a=(l,c)=>{if(!(t()instanceof window.Storage))return()=>{};const u=d=>{d.storageArea===t()&&d.key===l&&c(d.newValue)};return window.addEventListener("storage",u),()=>{window.removeEventListener("storage",u)}}),a&&(s.subscribe=o(a)),s}const xJ=bJ();function jj(t,e,n=xJ,i){const r=i==null?void 0:i.getOnInit,s=pe(r?n.getItem(t,e):e);return(JC?"production":void 0)!=="production"&&(s.debugPrivate=!0),s.onMount=a=>{a(n.getItem(t,e));let l;return n.subscribe&&(l=n.subscribe(t,a,e)),l},pe(a=>a(s),(a,l,c)=>{const u=typeof c=="function"?c(a(s)):c;return u===yJ?(l(s,e),n.removeItem(t)):Dj(u)?u.then(d=>(l(s,d),n.setItem(t,d))):(l(s,u),n.setItem(t,u))})}const P=OC();function Bj(t){return h.jsx(qq,{store:P,children:t.children})}const wJ=Object.freeze(Object.defineProperty({__proto__:null,JotaiProvider:Bj,store:P},Symbol.toStringTag,{value:"Module"}));var Mt;(function(t){t.assertEqual=r=>{};function e(r){}t.assertIs=e;function n(r){throw new Error}t.assertNever=n,t.arrayToEnum=r=>{const s={};for(const o of r)s[o]=o;return s},t.getValidEnumValues=r=>{const s=t.objectKeys(r).filter(a=>typeof r[r[a]]!="number"),o={};for(const a of s)o[a]=r[a];return t.objectValues(o)},t.objectValues=r=>t.objectKeys(r).map(function(s){return r[s]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const s=[];for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&s.push(o);return s},t.find=(r,s)=>{for(const o of r)if(s(o))return o},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function i(r,s=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}t.joinValues=i,t.jsonStringifyReplacer=(r,s)=>typeof s=="bigint"?s.toString():s})(Mt||(Mt={}));var hR;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(hR||(hR={}));const Le=Mt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),za=t=>{switch(typeof t){case"undefined":return Le.undefined;case"string":return Le.string;case"number":return Number.isNaN(t)?Le.nan:Le.number;case"boolean":return Le.boolean;case"function":return Le.function;case"bigint":return Le.bigint;case"symbol":return Le.symbol;case"object":return Array.isArray(t)?Le.array:t===null?Le.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Le.promise:typeof Map<"u"&&t instanceof Map?Le.map:typeof Set<"u"&&t instanceof Set?Le.set:typeof Date<"u"&&t instanceof Date?Le.date:Le.object;default:return Le.unknown}},me=Mt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class va extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(s){return s.message},i={_errors:[]},r=s=>{for(const o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)i._errors.push(n(o));else{let a=i,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(n(o))):a[c]=a[c]||{_errors:[]},a=a[c],l++}}};return r(this),i}static assert(e){if(!(e instanceof va))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Mt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},i=[];for(const r of this.issues)if(r.path.length>0){const s=r.path[0];n[s]=n[s]||[],n[s].push(e(r))}else i.push(e(r));return{formErrors:i,fieldErrors:n}}get formErrors(){return this.flatten()}}va.create=t=>new va(t);const T2=(t,e)=>{let n;switch(t.code){case me.invalid_type:t.received===Le.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case me.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Mt.jsonStringifyReplacer)}`;break;case me.unrecognized_keys:n=`Unrecognized key(s) in object: ${Mt.joinValues(t.keys,", ")}`;break;case me.invalid_union:n="Invalid input";break;case me.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Mt.joinValues(t.options)}`;break;case me.invalid_enum_value:n=`Invalid enum value. Expected ${Mt.joinValues(t.options)}, received '${t.received}'`;break;case me.invalid_arguments:n="Invalid function arguments";break;case me.invalid_return_type:n="Invalid function return type";break;case me.invalid_date:n="Invalid date";break;case me.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Mt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case me.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case me.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case me.custom:n="Invalid input";break;case me.invalid_intersection_types:n="Intersection results could not be merged";break;case me.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case me.not_finite:n="Number must be finite";break;default:n=e.defaultError,Mt.assertNever(t)}return{message:n}};let SJ=T2;function kJ(){return SJ}const _J=t=>{const{data:e,path:n,errorMaps:i,issueData:r}=t,s=[...n,...r.path||[]],o={...r,path:s};if(r.message!==void 0)return{...r,path:s,message:r.message};let a="";const l=i.filter(c=>!!c).slice().reverse();for(const c of l)a=c(o,{data:e,defaultError:a}).message;return{...r,path:s,message:a}};function Ee(t,e){const n=kJ(),i=_J({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===T2?void 0:T2].filter(r=>!!r)});t.common.issues.push(i)}class Tr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const i=[];for(const r of n){if(r.status==="aborted")return rt;r.status==="dirty"&&e.dirty(),i.push(r.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,n){const i=[];for(const r of n){const s=await r.key,o=await r.value;i.push({key:s,value:o})}return Tr.mergeObjectSync(e,i)}static mergeObjectSync(e,n){const i={};for(const r of n){const{key:s,value:o}=r;if(s.status==="aborted"||o.status==="aborted")return rt;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(i[s.value]=o.value)}return{status:e.value,value:i}}}const rt=Object.freeze({status:"aborted"}),kh=t=>({status:"dirty",value:t}),hs=t=>({status:"valid",value:t}),pR=t=>t.status==="aborted",mR=t=>t.status==="dirty",ef=t=>t.status==="valid",ey=t=>typeof Promise<"u"&&t instanceof Promise;var Be;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Be||(Be={}));class Dl{constructor(e,n,i,r){this._cachedPath=[],this.parent=e,this.data=n,this._path=i,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const gR=(t,e)=>{if(ef(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new va(t.common.issues);return this._error=n,this._error}}};function mt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:i,description:r}=t;if(e&&(n||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,a)=>{const{message:l}=t;return o.code==="invalid_enum_value"?{message:l??a.defaultError}:typeof a.data>"u"?{message:l??i??a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:l??n??a.defaultError}},description:r}}class Nt{get description(){return this._def.description}_getType(e){return za(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:za(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Tr,ctx:{common:e.parent.common,data:e.data,parsedType:za(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(ey(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const i=this.safeParse(e,n);if(i.success)return i.data;throw i.error}safeParse(e,n){const i={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:za(e)},r=this._parseSync({data:e,path:i.path,parent:i});return gR(i,r)}"~validate"(e){var i,r;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:za(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:n});return ef(s)?{value:s.value}:{issues:n.common.issues}}catch(s){(r=(i=s==null?void 0:s.message)==null?void 0:i.toLowerCase())!=null&&r.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(s=>ef(s)?{value:s.value}:{issues:n.common.issues})}async parseAsync(e,n){const i=await this.safeParseAsync(e,n);if(i.success)return i.data;throw i.error}async safeParseAsync(e,n){const i={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:za(e)},r=this._parse({data:e,path:i.path,parent:i}),s=await(ey(r)?r:Promise.resolve(r));return gR(i,s)}refine(e,n){const i=r=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(r):n;return this._refinement((r,s)=>{const o=e(r),a=()=>s.addIssue({code:me.custom,...i(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((i,r)=>e(i)?!0:(r.addIssue(typeof n=="function"?n(i,r):n),!1))}_refinement(e){return new rf({schema:this,typeName:st.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Cl.create(this,this._def)}nullable(){return sf.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return _o.create(this)}promise(){return ry.create(this,this._def)}or(e){return ny.create([this,e],this._def)}and(e){return iy.create(this,e,this._def)}transform(e){return new rf({...mt(this._def),schema:this,typeName:st.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new j2({...mt(this._def),innerType:this,defaultValue:n,typeName:st.ZodDefault})}brand(){return new qJ({typeName:st.ZodBranded,type:this,...mt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new B2({...mt(this._def),innerType:this,catchValue:n,typeName:st.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return ZC.create(this,e)}readonly(){return $2.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const CJ=/^c[^\s-]{8,}$/i,EJ=/^[0-9a-z]+$/,AJ=/^[0-9A-HJKMNP-TV-Z]{26}$/i,PJ=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,NJ=/^[a-z0-9_-]{21}$/i,MJ=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,RJ=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,IJ=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,TJ="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Nx;const OJ=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,LJ=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,DJ=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,jJ=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,BJ=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,$J=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,$j="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",FJ=new RegExp(`^${$j}$`);function Fj(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function zJ(t){return new RegExp(`^${Fj(t)}$`)}function UJ(t){let e=`${$j}T${Fj(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function VJ(t,e){return!!((e==="v4"||!e)&&OJ.test(t)||(e==="v6"||!e)&&DJ.test(t))}function HJ(t,e){if(!MJ.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const i=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),r=JSON.parse(atob(i));return!(typeof r!="object"||r===null||"typ"in r&&(r==null?void 0:r.typ)!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function WJ(t,e){return!!((e==="v4"||!e)&&LJ.test(t)||(e==="v6"||!e)&&jJ.test(t))}class Lc extends Nt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Le.string){const s=this._getOrReturnCtx(e);return Ee(s,{code:me.invalid_type,expected:Le.string,received:s.parsedType}),rt}const i=new Tr;let r;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(r=this._getOrReturnCtx(e,r),Ee(r,{code:me.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="max")e.data.length>s.value&&(r=this._getOrReturnCtx(e,r),Ee(r,{code:me.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="length"){const o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(r=this._getOrReturnCtx(e,r),o?Ee(r,{code:me.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&Ee(r,{code:me.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),i.dirty())}else if(s.kind==="email")IJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"email",code:me.invalid_string,message:s.message}),i.dirty());else if(s.kind==="emoji")Nx||(Nx=new RegExp(TJ,"u")),Nx.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"emoji",code:me.invalid_string,message:s.message}),i.dirty());else if(s.kind==="uuid")PJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"uuid",code:me.invalid_string,message:s.message}),i.dirty());else if(s.kind==="nanoid")NJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"nanoid",code:me.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid")CJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"cuid",code:me.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid2")EJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"cuid2",code:me.invalid_string,message:s.message}),i.dirty());else if(s.kind==="ulid")AJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"ulid",code:me.invalid_string,message:s.message}),i.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),Ee(r,{validation:"url",code:me.invalid_string,message:s.message}),i.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"regex",code:me.invalid_string,message:s.message}),i.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:me.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),i.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:me.invalid_string,validation:{startsWith:s.value},message:s.message}),i.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:me.invalid_string,validation:{endsWith:s.value},message:s.message}),i.dirty()):s.kind==="datetime"?UJ(s).test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:me.invalid_string,validation:"datetime",message:s.message}),i.dirty()):s.kind==="date"?FJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:me.invalid_string,validation:"date",message:s.message}),i.dirty()):s.kind==="time"?zJ(s).test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{code:me.invalid_string,validation:"time",message:s.message}),i.dirty()):s.kind==="duration"?RJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"duration",code:me.invalid_string,message:s.message}),i.dirty()):s.kind==="ip"?VJ(e.data,s.version)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"ip",code:me.invalid_string,message:s.message}),i.dirty()):s.kind==="jwt"?HJ(e.data,s.alg)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"jwt",code:me.invalid_string,message:s.message}),i.dirty()):s.kind==="cidr"?WJ(e.data,s.version)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"cidr",code:me.invalid_string,message:s.message}),i.dirty()):s.kind==="base64"?BJ.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"base64",code:me.invalid_string,message:s.message}),i.dirty()):s.kind==="base64url"?$J.test(e.data)||(r=this._getOrReturnCtx(e,r),Ee(r,{validation:"base64url",code:me.invalid_string,message:s.message}),i.dirty()):Mt.assertNever(s);return{status:i.value,value:e.data}}_regex(e,n,i){return this.refinement(r=>e.test(r),{validation:n,code:me.invalid_string,...Be.errToObj(i)})}_addCheck(e){return new Lc({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Be.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Be.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Be.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Be.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Be.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Be.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Be.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Be.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Be.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Be.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Be.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Be.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Be.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...Be.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Be.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Be.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Be.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Be.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Be.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Be.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Be.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Be.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Be.errToObj(n)})}nonempty(e){return this.min(1,Be.errToObj(e))}trim(){return new Lc({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Lc({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Lc({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Lc.create=t=>new Lc({checks:[],typeName:st.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...mt(t)});function GJ(t,e){const n=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,r=n>i?n:i,s=Number.parseInt(t.toFixed(r).replace(".","")),o=Number.parseInt(e.toFixed(r).replace(".",""));return s%o/10**r}class tf extends Nt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Le.number){const s=this._getOrReturnCtx(e);return Ee(s,{code:me.invalid_type,expected:Le.number,received:s.parsedType}),rt}let i;const r=new Tr;for(const s of this._def.checks)s.kind==="int"?Mt.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),Ee(i,{code:me.invalid_type,expected:"integer",received:"float",message:s.message}),r.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:me.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:me.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):s.kind==="multipleOf"?GJ(e.data,s.value)!==0&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:me.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),Ee(i,{code:me.not_finite,message:s.message}),r.dirty()):Mt.assertNever(s);return{status:r.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Be.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Be.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Be.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Be.toString(n))}setLimit(e,n,i,r){return new tf({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:Be.toString(r)}]})}_addCheck(e){return new tf({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Be.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Be.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Be.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Be.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Be.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Be.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Mt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(n===null||i.value>n)&&(n=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(n)&&Number.isFinite(e)}}tf.create=t=>new tf({checks:[],typeName:st.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...mt(t)});class Dp extends Nt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Le.bigint)return this._getInvalidInput(e);let i;const r=new Tr;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:me.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:me.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),Ee(i,{code:me.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):Mt.assertNever(s);return{status:r.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return Ee(n,{code:me.invalid_type,expected:Le.bigint,received:n.parsedType}),rt}gte(e,n){return this.setLimit("min",e,!0,Be.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Be.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Be.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Be.toString(n))}setLimit(e,n,i,r){return new Dp({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:Be.toString(r)}]})}_addCheck(e){return new Dp({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Be.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Be.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Dp.create=t=>new Dp({checks:[],typeName:st.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...mt(t)});class O2 extends Nt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Le.boolean){const i=this._getOrReturnCtx(e);return Ee(i,{code:me.invalid_type,expected:Le.boolean,received:i.parsedType}),rt}return hs(e.data)}}O2.create=t=>new O2({typeName:st.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...mt(t)});class ty extends Nt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Le.date){const s=this._getOrReturnCtx(e);return Ee(s,{code:me.invalid_type,expected:Le.date,received:s.parsedType}),rt}if(Number.isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return Ee(s,{code:me.invalid_date}),rt}const i=new Tr;let r;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(r=this._getOrReturnCtx(e,r),Ee(r,{code:me.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),i.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(r=this._getOrReturnCtx(e,r),Ee(r,{code:me.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),i.dirty()):Mt.assertNever(s);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ty({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Be.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Be.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}ty.create=t=>new ty({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:st.ZodDate,...mt(t)});class vR extends Nt{_parse(e){if(this._getType(e)!==Le.symbol){const i=this._getOrReturnCtx(e);return Ee(i,{code:me.invalid_type,expected:Le.symbol,received:i.parsedType}),rt}return hs(e.data)}}vR.create=t=>new vR({typeName:st.ZodSymbol,...mt(t)});class yR extends Nt{_parse(e){if(this._getType(e)!==Le.undefined){const i=this._getOrReturnCtx(e);return Ee(i,{code:me.invalid_type,expected:Le.undefined,received:i.parsedType}),rt}return hs(e.data)}}yR.create=t=>new yR({typeName:st.ZodUndefined,...mt(t)});class bR extends Nt{_parse(e){if(this._getType(e)!==Le.null){const i=this._getOrReturnCtx(e);return Ee(i,{code:me.invalid_type,expected:Le.null,received:i.parsedType}),rt}return hs(e.data)}}bR.create=t=>new bR({typeName:st.ZodNull,...mt(t)});class xR extends Nt{constructor(){super(...arguments),this._any=!0}_parse(e){return hs(e.data)}}xR.create=t=>new xR({typeName:st.ZodAny,...mt(t)});class wR extends Nt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return hs(e.data)}}wR.create=t=>new wR({typeName:st.ZodUnknown,...mt(t)});class jl extends Nt{_parse(e){const n=this._getOrReturnCtx(e);return Ee(n,{code:me.invalid_type,expected:Le.never,received:n.parsedType}),rt}}jl.create=t=>new jl({typeName:st.ZodNever,...mt(t)});class SR extends Nt{_parse(e){if(this._getType(e)!==Le.undefined){const i=this._getOrReturnCtx(e);return Ee(i,{code:me.invalid_type,expected:Le.void,received:i.parsedType}),rt}return hs(e.data)}}SR.create=t=>new SR({typeName:st.ZodVoid,...mt(t)});class _o extends Nt{_parse(e){const{ctx:n,status:i}=this._processInputParams(e),r=this._def;if(n.parsedType!==Le.array)return Ee(n,{code:me.invalid_type,expected:Le.array,received:n.parsedType}),rt;if(r.exactLength!==null){const o=n.data.length>r.exactLength.value,a=n.data.length<r.exactLength.value;(o||a)&&(Ee(n,{code:o?me.too_big:me.too_small,minimum:a?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),i.dirty())}if(r.minLength!==null&&n.data.length<r.minLength.value&&(Ee(n,{code:me.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),i.dirty()),r.maxLength!==null&&n.data.length>r.maxLength.value&&(Ee(n,{code:me.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),i.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>r.type._parseAsync(new Dl(n,o,n.path,a)))).then(o=>Tr.mergeArray(i,o));const s=[...n.data].map((o,a)=>r.type._parseSync(new Dl(n,o,n.path,a)));return Tr.mergeArray(i,s)}get element(){return this._def.type}min(e,n){return new _o({...this._def,minLength:{value:e,message:Be.toString(n)}})}max(e,n){return new _o({...this._def,maxLength:{value:e,message:Be.toString(n)}})}length(e,n){return new _o({...this._def,exactLength:{value:e,message:Be.toString(n)}})}nonempty(e){return this.min(1,e)}}_o.create=(t,e)=>new _o({type:t,minLength:null,maxLength:null,exactLength:null,typeName:st.ZodArray,...mt(e)});function ju(t){if(t instanceof Nn){const e={};for(const n in t.shape){const i=t.shape[n];e[n]=Cl.create(ju(i))}return new Nn({...t._def,shape:()=>e})}else return t instanceof _o?new _o({...t._def,type:ju(t.element)}):t instanceof Cl?Cl.create(ju(t.unwrap())):t instanceof sf?sf.create(ju(t.unwrap())):t instanceof Qc?Qc.create(t.items.map(e=>ju(e))):t}class Nn extends Nt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Mt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==Le.object){const c=this._getOrReturnCtx(e);return Ee(c,{code:me.invalid_type,expected:Le.object,received:c.parsedType}),rt}const{status:i,ctx:r}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof jl&&this._def.unknownKeys==="strip"))for(const c in r.data)o.includes(c)||a.push(c);const l=[];for(const c of o){const u=s[c],d=r.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Dl(r,d,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof jl){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of a)l.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")a.length>0&&(Ee(r,{code:me.unrecognized_keys,keys:a}),i.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of a){const d=r.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Dl(r,d,r.path,u)),alwaysSet:u in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,f=await u.value;c.push({key:d,value:f,alwaysSet:u.alwaysSet})}return c}).then(c=>Tr.mergeObjectSync(i,c)):Tr.mergeObjectSync(i,l)}get shape(){return this._def.shape()}strict(e){return Be.errToObj,new Nn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,i)=>{var s,o;const r=((o=(s=this._def).errorMap)==null?void 0:o.call(s,n,i).message)??i.defaultError;return n.code==="unrecognized_keys"?{message:Be.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new Nn({...this._def,unknownKeys:"strip"})}passthrough(){return new Nn({...this._def,unknownKeys:"passthrough"})}extend(e){return new Nn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Nn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:st.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Nn({...this._def,catchall:e})}pick(e){const n={};for(const i of Mt.objectKeys(e))e[i]&&this.shape[i]&&(n[i]=this.shape[i]);return new Nn({...this._def,shape:()=>n})}omit(e){const n={};for(const i of Mt.objectKeys(this.shape))e[i]||(n[i]=this.shape[i]);return new Nn({...this._def,shape:()=>n})}deepPartial(){return ju(this)}partial(e){const n={};for(const i of Mt.objectKeys(this.shape)){const r=this.shape[i];e&&!e[i]?n[i]=r:n[i]=r.optional()}return new Nn({...this._def,shape:()=>n})}required(e){const n={};for(const i of Mt.objectKeys(this.shape))if(e&&!e[i])n[i]=this.shape[i];else{let s=this.shape[i];for(;s instanceof Cl;)s=s._def.innerType;n[i]=s}return new Nn({...this._def,shape:()=>n})}keyof(){return zj(Mt.objectKeys(this.shape))}}Nn.create=(t,e)=>new Nn({shape:()=>t,unknownKeys:"strip",catchall:jl.create(),typeName:st.ZodObject,...mt(e)});Nn.strictCreate=(t,e)=>new Nn({shape:()=>t,unknownKeys:"strict",catchall:jl.create(),typeName:st.ZodObject,...mt(e)});Nn.lazycreate=(t,e)=>new Nn({shape:t,unknownKeys:"strip",catchall:jl.create(),typeName:st.ZodObject,...mt(e)});class ny extends Nt{_parse(e){const{ctx:n}=this._processInputParams(e),i=this._def.options;function r(s){for(const a of s)if(a.result.status==="valid")return a.result;for(const a of s)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(a=>new va(a.ctx.common.issues));return Ee(n,{code:me.invalid_union,unionErrors:o}),rt}if(n.common.async)return Promise.all(i.map(async s=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(r);{let s;const o=[];for(const l of i){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const a=o.map(l=>new va(l));return Ee(n,{code:me.invalid_union,unionErrors:a}),rt}}get options(){return this._def.options}}ny.create=(t,e)=>new ny({options:t,typeName:st.ZodUnion,...mt(e)});function L2(t,e){const n=za(t),i=za(e);if(t===e)return{valid:!0,data:t};if(n===Le.object&&i===Le.object){const r=Mt.objectKeys(e),s=Mt.objectKeys(t).filter(a=>r.indexOf(a)!==-1),o={...t,...e};for(const a of s){const l=L2(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(n===Le.array&&i===Le.array){if(t.length!==e.length)return{valid:!1};const r=[];for(let s=0;s<t.length;s++){const o=t[s],a=e[s],l=L2(o,a);if(!l.valid)return{valid:!1};r.push(l.data)}return{valid:!0,data:r}}else return n===Le.date&&i===Le.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class iy extends Nt{_parse(e){const{status:n,ctx:i}=this._processInputParams(e),r=(s,o)=>{if(pR(s)||pR(o))return rt;const a=L2(s.value,o.value);return a.valid?((mR(s)||mR(o))&&n.dirty(),{status:n.value,value:a.data}):(Ee(i,{code:me.invalid_intersection_types}),rt)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([s,o])=>r(s,o)):r(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}iy.create=(t,e,n)=>new iy({left:t,right:e,typeName:st.ZodIntersection,...mt(n)});class Qc extends Nt{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==Le.array)return Ee(i,{code:me.invalid_type,expected:Le.array,received:i.parsedType}),rt;if(i.data.length<this._def.items.length)return Ee(i,{code:me.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),rt;!this._def.rest&&i.data.length>this._def.items.length&&(Ee(i,{code:me.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...i.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new Dl(i,o,i.path,a)):null}).filter(o=>!!o);return i.common.async?Promise.all(s).then(o=>Tr.mergeArray(n,o)):Tr.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new Qc({...this._def,rest:e})}}Qc.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Qc({items:t,typeName:st.ZodTuple,rest:null,...mt(e)})};class kR extends Nt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==Le.map)return Ee(i,{code:me.invalid_type,expected:Le.map,received:i.parsedType}),rt;const r=this._def.keyType,s=this._def.valueType,o=[...i.data.entries()].map(([a,l],c)=>({key:r._parse(new Dl(i,a,i.path,[c,"key"])),value:s._parse(new Dl(i,l,i.path,[c,"value"]))}));if(i.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return rt;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(c.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const l of o){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return rt;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(c.value,u.value)}return{status:n.value,value:a}}}}kR.create=(t,e,n)=>new kR({valueType:e,keyType:t,typeName:st.ZodMap,...mt(n)});class jp extends Nt{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==Le.set)return Ee(i,{code:me.invalid_type,expected:Le.set,received:i.parsedType}),rt;const r=this._def;r.minSize!==null&&i.data.size<r.minSize.value&&(Ee(i,{code:me.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),n.dirty()),r.maxSize!==null&&i.data.size>r.maxSize.value&&(Ee(i,{code:me.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),n.dirty());const s=this._def.valueType;function o(l){const c=new Set;for(const u of l){if(u.status==="aborted")return rt;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const a=[...i.data.values()].map((l,c)=>s._parse(new Dl(i,l,i.path,c)));return i.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,n){return new jp({...this._def,minSize:{value:e,message:Be.toString(n)}})}max(e,n){return new jp({...this._def,maxSize:{value:e,message:Be.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}jp.create=(t,e)=>new jp({valueType:t,minSize:null,maxSize:null,typeName:st.ZodSet,...mt(e)});class _R extends Nt{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}_R.create=(t,e)=>new _R({getter:t,typeName:st.ZodLazy,...mt(e)});class D2 extends Nt{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Ee(n,{received:n.data,code:me.invalid_literal,expected:this._def.value}),rt}return{status:"valid",value:e.data}}get value(){return this._def.value}}D2.create=(t,e)=>new D2({value:t,typeName:st.ZodLiteral,...mt(e)});function zj(t,e){return new nf({values:t,typeName:st.ZodEnum,...mt(e)})}class nf extends Nt{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),i=this._def.values;return Ee(n,{expected:Mt.joinValues(i),received:n.parsedType,code:me.invalid_type}),rt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),i=this._def.values;return Ee(n,{received:n.data,code:me.invalid_enum_value,options:i}),rt}return hs(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return nf.create(e,{...this._def,...n})}exclude(e,n=this._def){return nf.create(this.options.filter(i=>!e.includes(i)),{...this._def,...n})}}nf.create=zj;class CR extends Nt{_parse(e){const n=Mt.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==Le.string&&i.parsedType!==Le.number){const r=Mt.objectValues(n);return Ee(i,{expected:Mt.joinValues(r),received:i.parsedType,code:me.invalid_type}),rt}if(this._cache||(this._cache=new Set(Mt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=Mt.objectValues(n);return Ee(i,{received:i.data,code:me.invalid_enum_value,options:r}),rt}return hs(e.data)}get enum(){return this._def.values}}CR.create=(t,e)=>new CR({values:t,typeName:st.ZodNativeEnum,...mt(e)});class ry extends Nt{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Le.promise&&n.common.async===!1)return Ee(n,{code:me.invalid_type,expected:Le.promise,received:n.parsedType}),rt;const i=n.parsedType===Le.promise?n.data:Promise.resolve(n.data);return hs(i.then(r=>this._def.type.parseAsync(r,{path:n.path,errorMap:n.common.contextualErrorMap})))}}ry.create=(t,e)=>new ry({type:t,typeName:st.ZodPromise,...mt(e)});class rf extends Nt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===st.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:i}=this._processInputParams(e),r=this._def.effect||null,s={addIssue:o=>{Ee(i,o),o.fatal?n.abort():n.dirty()},get path(){return i.path}};if(s.addIssue=s.addIssue.bind(s),r.type==="preprocess"){const o=r.transform(i.data,s);if(i.common.async)return Promise.resolve(o).then(async a=>{if(n.value==="aborted")return rt;const l=await this._def.schema._parseAsync({data:a,path:i.path,parent:i});return l.status==="aborted"?rt:l.status==="dirty"||n.value==="dirty"?kh(l.value):l});{if(n.value==="aborted")return rt;const a=this._def.schema._parseSync({data:o,path:i.path,parent:i});return a.status==="aborted"?rt:a.status==="dirty"||n.value==="dirty"?kh(a.value):a}}if(r.type==="refinement"){const o=a=>{const l=r.refinement(a,s);if(i.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(i.common.async===!1){const a=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return a.status==="aborted"?rt:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(a=>a.status==="aborted"?rt:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(r.type==="transform")if(i.common.async===!1){const o=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!ef(o))return rt;const a=r.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(o=>ef(o)?Promise.resolve(r.transform(o.value,s)).then(a=>({status:n.value,value:a})):rt);Mt.assertNever(r)}}rf.create=(t,e,n)=>new rf({schema:t,typeName:st.ZodEffects,effect:e,...mt(n)});rf.createWithPreprocess=(t,e,n)=>new rf({schema:e,effect:{type:"preprocess",transform:t},typeName:st.ZodEffects,...mt(n)});class Cl extends Nt{_parse(e){return this._getType(e)===Le.undefined?hs(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Cl.create=(t,e)=>new Cl({innerType:t,typeName:st.ZodOptional,...mt(e)});class sf extends Nt{_parse(e){return this._getType(e)===Le.null?hs(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}sf.create=(t,e)=>new sf({innerType:t,typeName:st.ZodNullable,...mt(e)});class j2 extends Nt{_parse(e){const{ctx:n}=this._processInputParams(e);let i=n.data;return n.parsedType===Le.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}j2.create=(t,e)=>new j2({innerType:t,typeName:st.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...mt(e)});class B2 extends Nt{_parse(e){const{ctx:n}=this._processInputParams(e),i={...n,common:{...n.common,issues:[]}},r=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return ey(r)?r.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new va(i.common.issues)},input:i.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new va(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}B2.create=(t,e)=>new B2({innerType:t,typeName:st.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...mt(e)});class ER extends Nt{_parse(e){if(this._getType(e)!==Le.nan){const i=this._getOrReturnCtx(e);return Ee(i,{code:me.invalid_type,expected:Le.nan,received:i.parsedType}),rt}return{status:"valid",value:e.data}}}ER.create=t=>new ER({typeName:st.ZodNaN,...mt(t)});class qJ extends Nt{_parse(e){const{ctx:n}=this._processInputParams(e),i=n.data;return this._def.type._parse({data:i,path:n.path,parent:n})}unwrap(){return this._def.type}}class ZC extends Nt{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return s.status==="aborted"?rt:s.status==="dirty"?(n.dirty(),kh(s.value)):this._def.out._parseAsync({data:s.value,path:i.path,parent:i})})();{const r=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return r.status==="aborted"?rt:r.status==="dirty"?(n.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:i.path,parent:i})}}static create(e,n){return new ZC({in:e,out:n,typeName:st.ZodPipeline})}}class $2 extends Nt{_parse(e){const n=this._def.innerType._parse(e),i=r=>(ef(r)&&(r.value=Object.freeze(r.value)),r);return ey(n)?n.then(r=>i(r)):i(n)}unwrap(){return this._def.innerType}}$2.create=(t,e)=>new $2({innerType:t,typeName:st.ZodReadonly,...mt(e)});var st;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(st||(st={}));const pc=tf.create,wu=O2.create;jl.create;_o.create;const AR=Nn.create,KJ=ny.create;iy.create;Qc.create;const Mg=D2.create,Kf=nf.create;ry.create;Cl.create;sf.create;const XJ=["randomize","clean","unchanged"],YJ=["switches-and-leds","printer","null"],JJ=["printer","null"],F2=AR({showInstructionCycle:wu().catch(!1),showStatsCPU:wu().catch(!1),language:Kf(Lj).catch(ZJ),editorFontSize:pc().int().min(8).max(64).catch(14),dataOnLoad:Kf(XJ).catch("clean"),devices:AR({keyboardAndScreen:wu(),pic:wu(),pio:Kf(["switches-and-leds","printer"]).nullable(),handshake:Kf(["printer"]).nullable()}).catch({keyboardAndScreen:!1,pic:!1,pio:null,handshake:null}),animations:wu().catch(!0),executionUnit:pc().min(1).max(250).catch(150),clockSpeed:pc().min(100).max(1e3).catch(1e3),cpuSpeed:KJ([Mg(1),Mg(2),Mg(4),Mg(10)]).catch(1),printerSpeed:pc().min(500).max(2e4).catch(5e3),flagsVisibility:Kf(["CF_ZF","SF_OF_CF_ZF","IF_CF_ZF","IF_SF_OF_CF_ZF"]).catch("CF_ZF"),filterBightness:pc().min(0).catch(1),filterContrast:pc().min(0).catch(1),filterInvert:wu().catch(!1),filterSaturation:pc().min(0).catch(1)}),Bu=F2.parse({animations:!1});function ZJ(){const t=navigator.language.toLowerCase();for(const e of Lj)if(t.startsWith(e))return e;return"en"}const Ti=jj("vonsim-settings",Bu,{getItem(t,e){try{const n=localStorage.getItem(t);return F2.parse(JSON.parse(n??""))}catch{return e}},setItem(t,e){localStorage.setItem(t,JSON.stringify(e))},removeItem(t){localStorage.removeItem(t)},subscribe(t,e,n){const i=r=>{if(r.storageArea===localStorage&&r.key===t){let s;try{s=F2.parse(JSON.parse(r.newValue??""))}catch{s=n}e(s)}};return window==null||window.addEventListener("storage",i),()=>window==null?void 0:window.removeEventListener("storage",i)}},{getOnInit:!0}),nt=()=>P.get(Ti),Oo=()=>Em(Ti);pe(t=>t(Ti).showInstructionCycle);pe(t=>t(Ti).showStatsCPU);const QJ=pe(t=>t(Ti).language),QC=()=>tt(QJ);pe(t=>t(Ti).flagsVisibility);const eZ=pe(t=>t(Ti).editorFontSize),tZ=()=>tt(eZ);pe(t=>t(Ti).dataOnLoad);const nZ=pe(t=>t(Ti).devices),iZ=()=>tt(nZ);pe(t=>{const e=t(Ti);return{executionUnit:e.executionUnit,clock:e.clockSpeed,printer:e.printerSpeed}});pe(t=>{const e=t(Ti);return[`brightness(${e.filterBightness})`,`contrast(${e.filterContrast})`,`invert(${e.filterInvert?1:0})`,`saturate(${e.filterSaturation})`].filter(Boolean).join(" ")});function Bp(t){const e=t.charCodeAt(0);return H.fitsUnsigned(e,8)?e:null}function eE(t){return H.fitsUnsigned(t,8)?String.fromCharCode(t):null}function Uj(t){return rZ.at(t)??null}const rZ=["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","BS","HT","LF","VT","FF","CR","SO","SI","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","EM","SUB","ESC","FS","GS","RS","US","SPACE","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","DEL","XXX","XXX","BPH","NBH","IND","NEL","SSA","ESA","HTS","HTJ","VTS","PLD","PLU","RI","SS2","SS3","DCS","PU1","PU2","STS","CCH","MW","SPA","EPA","SOS","XXX","SCI","CSI","ST","OSC","PM","APC","NBSP","¡","¢","£","¤","¥","¦","§","¨","©","ª","«","¬","SHY","®","¯","°","±","²","³","´","µ","¶","·","¸","¹","º","»","¼","½","¾","¿","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","×","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","÷","ø","ù","ú","û","ü","ý","þ","ÿ"];var sn,un;const _t=class _t{constructor(e,n){Ue(this,sn);Ue(this,un);ie(this,sn,e|0),ie(this,un,n)}get size(){return N(this,un)}is8bits(){return N(this,un)===8}is16bits(){return N(this,un)===16}get unsigned(){return N(this,sn)}get signed(){return N(this,sn)<=_t.maxSignedValue(N(this,un))?N(this,sn):N(this,sn)-(_t.maxValue(N(this,un))+1)}get low(){return this.is8bits()?this:_t.fromUnsigned(N(this,sn)&_t.maxValue(8),8)}get high(){return this.is8bits()?new _t(0,8):_t.fromUnsigned(N(this,sn)>>8&_t.maxValue(8),8)}withLow(e){if(e.is16bits())throw new TypeError("Byte must be 8 bits");return _t.fromUnsigned(N(this,sn)&~_t.maxValue(8)|e.unsigned,N(this,un))}withHigh(e){if(e.is16bits())throw new TypeError("Byte must be 8 bits");return _t.fromUnsigned(N(this,sn)&_t.maxValue(8)|e.unsigned<<8,16)}bit(e){if(!Number.isSafeInteger(e)||e<0||e>=N(this,un))throw new RangeError(`Index ${e} out of bounds for byte of size ${N(this,un)}`);return(N(this,sn)&1<<e)!==0}withBit(e,n){if(!Number.isSafeInteger(e)||e<0||e>=N(this,un))throw new RangeError(`Index ${e} out of bounds for byte of size ${N(this,un)}`);return n?_t.fromUnsigned(N(this,sn)|1<<e,N(this,un)):_t.fromUnsigned(N(this,sn)&~(1<<e),N(this,un))}add(e){return e=Number(e),_t.fromUnsigned(N(this,sn)+e,N(this,un))}isZero(){return this.unsigned===0}equals(e){return typeof e=="number"?e<0?this.signed===e:this.unsigned===e:N(this,sn)===N(e,sn)}toUint8Array(){return this.is8bits()?new Uint8Array([this.unsigned]):new Uint8Array([this.low.unsigned,this.high.unsigned])}toArray(){const e=new Array(N(this,un));for(let n=0;n<N(this,un);n++)e[n]=this.bit(n);return e}toString(e="int"){switch(e){case"hex":return N(this,sn).toString(16).padStart(N(this,un)/4,"0").toUpperCase();case"bin":return N(this,sn).toString(2).padStart(N(this,un),"0");case"int":return this.signed.toString(10);case"uint":return this.unsigned.toString(10);case"ascii":return N(this,un)===8?eE(N(this,sn))??"---":this.low.toString("ascii")+this.high.toString("ascii");case"safe-ascii":return N(this,un)===8?Uj(N(this,sn))??"---":this.low.toString("safe-ascii")+" "+this.high.toString("safe-ascii")}}toJSON(){return N(this,sn)}valueOf(){return N(this,sn)}static minValue(){return 0}static maxValue(e){return 2**e-1}static minSignedValue(e){return-(2**(e-1))}static maxSignedValue(e){return 2**(e-1)-1}static fits(e,n){return Number.isSafeInteger(e)&&e>=_t.minSignedValue(n)&&e<=_t.maxValue(n)}static fitsUnsigned(e,n){return Number.isSafeInteger(e)&&e>=_t.minValue()&&e<=_t.maxValue(n)}static fitsSigned(e,n){return Number.isSafeInteger(e)&&e>=_t.minSignedValue(n)&&e<=_t.maxSignedValue(n)}static fromUnsigned(e,n){if(!_t.fitsUnsigned(e,n))throw new RangeError(`Value ${e} does not fit in a ${n}-bit byte.`);return new _t(e,n)}static fromSigned(e,n){if(!_t.fitsSigned(e,n))throw new RangeError(`Value ${e} does not fit in a ${n}-bit byte.`);return e<0?new _t(e+_t.maxValue(n)+1,n):new _t(e,n)}static fromNumber(e,n){return e<0?_t.fromSigned(e,n):_t.fromUnsigned(e,n)}static fromChar(e){const n=Bp(e)??-1;return _t.fromUnsigned(n,8)}static random(e){const n=Math.round(Math.random()*_t.maxValue(e));return new _t(n,e)}static zero(e){return new _t(0,e)}};sn=new WeakMap,un=new WeakMap;let H=_t;var Ho;const qa=class qa{constructor(e){Ue(this,Ho);ie(this,Ho,e)}get value(){return N(this,Ho).unsigned}get byte(){return N(this,Ho)}toString(e=!1){let n=N(this,Ho).toString("hex");return e&&(n+="h"),n.slice(-2)}toJSON(){return N(this,Ho).toJSON()}valueOf(){return N(this,Ho).valueOf()}static inRange(e){return e=Number(e),Number.isSafeInteger(e)&&e>=qa.MIN_ADDRESS&&e<=qa.MAX_ADDRESS}static from(e){if(e=Number(e),!qa.inRange(e))throw new RangeError(`Address ${e} is out of range.`);const n=H.fromUnsigned(e,16);return new qa(n)}static format(e,n=!0){if(e=Number(e),!Number.isSafeInteger(e)||e<0)return"????";let i=e.toString(16).padStart(4,"0").toUpperCase();return n&&(i+="h"),i.slice(-3)}};Ho=new WeakMap,be(qa,"MIN_ADDRESS",0),be(qa,"MAX_ADDRESS",255);let Pe=qa;var Wo;const Ka=class Ka{constructor(e){Ue(this,Wo);ie(this,Wo,e)}get value(){return N(this,Wo).unsigned}get byte(){return N(this,Wo)}toString(e=!0){let n=N(this,Wo).toString("hex");return e&&(n+="h"),n}toJSON(){return N(this,Wo).toJSON()}valueOf(){return N(this,Wo).valueOf()}static inRange(e){return e=Number(e),Number.isSafeInteger(e)&&e>=Ka.MIN_ADDRESS&&e<=Ka.MAX_ADDRESS}static from(e){if(e=Number(e),!Ka.inRange(e))throw new RangeError(`Address ${e} is out of range.`);const n=H.fromUnsigned(e,8);return new Ka(n)}static format(e,n=!0){if(e=Number(e),!Number.isSafeInteger(e)||e<0)return"??";let i=e.toString(16).padStart(2,"0").toUpperCase();return n&&(i+="h"),i}};Wo=new WeakMap,be(Ka,"MIN_ADDRESS",0),be(Ka,"MAX_ADDRESS",127);let Or=Ka;function PR(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function NR(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?PR(Object(n),!0).forEach(function(i){sZ(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):PR(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function sZ(t,e,n){return e=oZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oZ(t){var e=aZ(t,"string");return typeof e=="symbol"?e:String(e)}function aZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sy=Vj({});function Vj(t){return e.withOptions=n=>Vj(NR(NR({},t),n)),e;function e(n,...i){const r=typeof n=="string"?[n]:n.raw,{escapeSpecialCharacters:s=Array.isArray(n),trimWhitespace:o=!0}=t;let a="";for(let u=0;u<r.length;u++){let d=r[u];s&&(d=d.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\\{/g,"{")),a+=d,u<i.length&&(a+=i[u])}const l=a.split(`
`);let c=null;for(const u of l){const d=u.match(/^(\s+)\S+/);if(d){const f=d[1].length;c?c=Math.min(c,f):c=f}}if(c!==null){const u=c;a=l.map(d=>d[0]===" "||d[0]==="	"?d.slice(u):d).join(`
`)}return o&&(a=a.trim()),s&&(a=a.replace(/\\n/g,`
`)),a}}const lZ=Pe.from(Pe.MAX_ADDRESS).toString(),cZ={generics:{clean:"Clean","io-register":(t,e)=>`${t} register (${Or.format(e)})`,"byte-representation":{hex:"Hexadecimal",bin:"Binary",uint:"Unsigned integer",int:"Signed integer","safe-ascii":"ASCII"}},update:{"update-available":"There's a new version available!","new-version-available":"There's a new version available in the repository.","local-update":"A new local version has been detected.",reload:"Update"},messages:{"assemble-error":"Assemble error. Fix the errors and try again.","invalid-action":"Invalid action.","keyboard-input-required":"Enter a character from keyboard","keyboard-input-description":"The program is waiting for you to enter a character. Use the virtual keyboard or your physical keyboard."},editor:{lintSummary:t=>t===0?"Ready to compile":t===1?"There's an error":`There're ${t} errors`,files:{unsupported:"Your browser doesn't support the FileSystem API","no-file":"No file open",open:"Open file",unsaved:"There are unsaved changes, do you want to discard them?","open-error":"Error opening file",save:"Save file","save-as":"Save file as","save-error":"Error saving file"},example:sy`
      ; Welcome to VonSim!
      ; This is an example program that calculates the first
      ; n numbers of the Fibonacci sequence, and stores them
      ; starting at memory position 1000h.
      
           n  equ 10    ; Calculate the first 10 numbers
      
              org 1000h
      start   db 1
      
              org 2000h
              mov bx, offset start + 1
              mov al, 0
              mov ah, start
      
      loop:   cmp bx, offset start + n
              jns finish
              mov cl, ah
              add cl, al
              mov al, ah
              mov ah, cl
              mov [bx], cl
              inc bx
              jmp loop
      finish: hlt
              end
    `},control:{action:{start:"Start",continue:"Continue",running:"Running...",run:{"cycle-change":"Cycle","end-of-instruction":"Instruction",infinity:"End"},stop:"Stop",reset:"Reset",pause:"Pause"},tabs:{editor:"Editor",computer:"Computer"},zoom:{in:"Zoom in",out:"Zoom out"}},computer:{cpu:{name:"CPU",register:t=>`${t} register`,"control-unit":"Control unit",decoder:"Decoder",stats:"stats CPU","instruction-cycle":"Ciclo de instrucción",status:{fetching:"Fetching instruction...","fetching-operands":"Fetching operands...","fetching-operands-completed":"Operands fetched",executing:"Executing...",writeback:"Saving results...",interrupt:"Handling interrupt...",stopped:"Stopped","stopped-error":"Error","waiting-for-input":"Waiting for input...",int6:"Running INT 6...",int7:"Running INT 7..."},"total-cycles":"Total cycles","instruction-count":"Instruction count",cpi:"Cycles per instruction (CPI)","cpi-help":"Average clock cycles per executed instruction (CPI = total cycles / total instructions)","cpu-time":"CPU time","cpu-time-help":"Total CPU time = total cycles × cycle time (current: {cycleTime} ms)"},memory:{name:"Memory",cell:t=>`Cell ${Pe.format(t)}`,"fix-address":"Fix address","unfix-address":"Unfix address","address-must-be-integer":"Start address must be an hexadecimal integer.","address-out-of-range":`Start address must be less or equal to ${lZ}.`,"address-increment":"Increment address (Page Up)","address-decrement":"Decrement address (Page Down)"},"chip-select":{name:"Chip select",mem:"mem",pic:"pic",timer:"timer",pio:"pio",handshake:"handshake"},bus:{"read-memory":"READ MEMORY","write-memory":"WRITE MEMORY"},f10:"F10 key",keyboard:"Keyboard",leds:"LEDs",printer:{name:"Printer",buffer:"Buffer"},screen:"Screen",switches:"Switches",handshake:{name:"Handshake",data:"Data",state:"State"},pic:"PIC",pio:{name:"PIO",port:t=>`Port ${t}`},timer:"Timer"},settings:{title:"Settings",instructionCycle:{label:"Instruction Cycle"},statsCPU:{label:"CPU Statistics"},flags:{label:"Flags",description:"Select which flags to display in the ALU."},language:{label:"Language"},editorFontSize:{label:"Editor font size",increase:"Increase font size",decrease:"Decrease font size"},dataOnLoad:{label:"Data on load",description:"What to do with the memory when loading a new program.",randomize:"Randomize",clean:"Empty",unchanged:"Unchanged"},devices:{label:"Devices",description:"Which devices should be enabled.","keyboard-and-screen":"Keyboard and screen",pic:{label:"PIC",description:"Also adds a timer and the F10 key."},pio:{label:"PIO","switches-and-leds":"Switches and LEDs",printer:"Printer",null:"Disconnected"},handshake:{label:"Handshake",printer:"Printer",null:"Disconnected"}},animations:{label:"Animations",description:["Enabling animations."].join(" ")},speeds:{executionUnit:"Simulation speed",clockSpeed:"Clock speed",printerSpeed:"Printer speed"},filters:{label:"Filters",description:"Filters applied to the page. Useful when you're using a projector.",revert:"Revert to default filters",brightness:"Brightness",contrast:"Contrast",invert:"Invert",saturation:"Saturation"},reset:"Reset settings"},footer:{documentation:"Documentation",copyright:"III-LIDI, FI, UNLP",issue:{report:"Report an issue",body:(t,e)=>sy`
        <!-- Please describe the problem you are having in as much detail as possible. -->
        <!-- Most importantly, add the steps to reproduce the problem. -->

        <details>
          <summary>Debug info (PLEASE, DO NOT DELETE)</summary>

          **Version**: [${"8af22e1"}](https://github.com/ruiz-jose/VonSim8/commit/${"8af22e1"})

          #### Program

          \`\`\`asm
          ${e.split(`
`).map(n=>n.trim()).join(`
`)}
          \`\`\`

          #### Settings

          \`\`\`json
          ${JSON.stringify(t,null,2)}
          \`\`\`
          
        </details>
      `}}},uZ=Pe.from(Pe.MAX_ADDRESS).toString(),dZ={generics:{clean:"Limpiar","io-register":(t,e)=>`Registro ${t} (${Or.format(e)})`,"byte-representation":{hex:"Hexadecimal",bin:"Binario",uint:"Entero sin signo",int:"Entero con signo","safe-ascii":"ASCII"}},update:{"update-available":"¡Hay una nueva versión disponible!","new-version-available":"Hay una nueva versión disponible en el repositorio.","local-update":"Se ha detectado una nueva versión local.",reload:"Actualizar"},messages:{"assemble-error":"Error de ensamblado. Solucione los errores y vuelva a intentar.","invalid-action":"Acción inválida.","keyboard-input-required":"Ingrese un carácter por teclado","keyboard-input-description":"El programa está esperando que ingrese un carácter. Use el teclado virtual o su teclado físico."},editor:{lintSummary:t=>t===0?"Listo para compilar":t===1?"Hay un error":`Hay ${t} errores`,files:{unsupported:"Tu navegador no soporta la “FileSystem API”","no-file":"No hay ningún archivo abierto",open:"Abrir",unsaved:"Hay cambios sin guardar, ¿desea descartarlos?","open-error":"Error al abrir el archivo",save:"Guardar","save-as":"Guardar como","save-error":"Error al guardar el archivo"},example:sy`
      ; ¡Bienvenido a VonSim 8!
      ; Este es un ejemplo de código que suma dos variables z = x + y      
        x  db 3
        y  db 2
        z  db 0
        mov al, x
        add al, y
        mov z, al
        hlt
    `},control:{action:{start:"Iniciar",continue:"Continuar",running:"Ejecutando...",run:{"cycle-change":"Ciclo","end-of-instruction":"Instrucción",infinity:"Final"},stop:"Detener",reset:"Reiniciar",pause:"Pausar"},tabs:{editor:"Editor",computer:"Computadora"},zoom:{in:"Acercar",out:"Alejar"}},computer:{cpu:{name:"CPU",register:t=>`Registro ${t}`,"control-unit":"Unidad de control",decoder:"Decodificador",stats:"Estadísticas CPU","instruction-cycle":"Ciclo de instrucción",status:{fetching:"Captación instrucción...","fetching-operands":"Leyendo operandos...","fetching-operands-completed":"Operandos obtenidos",executing:"Ejecutando...",writeback:"Escribiendo resultados...",interrupt:"Manejando interrupción...",stopped:"Detenido","stopped-error":"Error","waiting-for-input":"Esperando tecla...",int6:"Ejecutando INT 6...",int7:"Ejecutando INT 7..."},"total-cycles":"Total de ciclos","instruction-count":"Recuento de instrucciones",cpi:"Ciclos por instrucción (CPI)","cpi-help":"Promedio de ciclos de reloj por instrucción ejecutada (CPI = ciclos totales / instrucciones totales)","cpu-time":"Tiempo de CPU","cpu-time-help":"Tiempo total de CPU = ciclos totales × tiempo de ciclo (actual: {cycleTime} ms)"},memory:{name:"Memoria",cell:t=>`Celda ${Pe.format(t)}`,"fix-address":"Fijar dirección","unfix-address":"Desfijar dirección","address-must-be-integer":"El valor de inicio debe ser un número entero hexadecimal.","address-out-of-range":`El valor de inicio debe ser menor o igual a ${uZ}.`,"address-increment":"Incrementar dirección (Page Up)","address-decrement":"Decrementar dirección (Page Down)"},"chip-select":{name:"Chip select",mem:"mem",pic:"pic",timer:"timer",pio:"pio",handshake:"handshake"},bus:{"read-memory":"LEER MEMORIA","write-memory":"ESCRIBIR MEMORIA"},f10:"Tecla F10",keyboard:"Teclado",leds:"Leds",printer:{name:"Impresora",buffer:"Buffer"},screen:"Pantalla",switches:"Llaves",handshake:{name:"Handshake",data:"Dato",state:"Estado"},pic:"PIC",pio:{name:"PIO",port:t=>`Puerto ${t}`},timer:"Timer"},settings:{title:"Configuración",instructionCycle:{label:"Ciclo de Instrucción"},statsCPU:{label:"Estadísticas CPU"},flags:{label:"Banderas",description:"Selecciona qué banderas mostrar en la ALU."},language:{label:"Idioma"},editorFontSize:{label:"Tamaño de fuente del editor",increase:"Aumentar",decrease:"Disminuir"},dataOnLoad:{label:"Memoria al cargar",description:"Qué hacer con la memoria al cargar un nuevo programa.",randomize:"Aleatoria",clean:"Vaciar",unchanged:"Reusar"},devices:{label:"Dispositivos",description:"Qué dispositivos deben estar habilitados.","keyboard-and-screen":"Teclado y pantalla",pic:{label:"PIC",description:"También agrega un timer y la tecla F10."},pio:{label:"PIO","switches-and-leds":"Llaves y Leds",printer:"Impresora",null:"Desconectado"},handshake:{label:"Handshake",printer:"Impresora",null:"Desconectado"}},animations:{label:"Animaciones",description:["Habilitación de animaciones."].join(" ")},speeds:{executionUnit:"Velocidad de simulación",clockSpeed:"Velocidad del reloj",printerSpeed:"Velocidad de impresión"},filters:{label:"Filtros",description:"Filtros aplicados a la página. Útil cuando se usa un proyector.",revert:"Revertir a los valores por defecto",brightness:"Brillo",contrast:"Contraste",invert:"Invertir",saturation:"Saturación"},reset:"Restablecer configuración"},footer:{documentation:"Documentación",copyright:"III-LIDI, FI, UNLP, UNER",issue:{report:"Reportar un error",body:(t,e)=>sy`
        <!-- Por favor, describa el problema que está teniendo en la mayor cantidad de detalle posible. -->
        <!-- Por sobre todo, agregue los pasos para reproducir el problema. -->

        <details>
          <summary>Información extra (POR FAVOR, NO BORRAR)</summary>

          **Versión**: [${"8af22e1"}](https://github.com/ruiz-jose/VonSim8/commit/${"8af22e1"})

          #### Programa

          \`\`\`asm
          ${e.split(`
`).map(n=>n.trim()).join(`
`)}
          \`\`\`

          #### Configuración

          \`\`\`json
          ${JSON.stringify(t,null,2)}
          \`\`\`
          
        </details>
      `}}},of=YC({en:cZ,es:dZ});function cn(){const t=QC();return x.useCallback((e,...n)=>of(t,e,...n),[t])}const fZ=[{name:"Documentación",url:"https://ruiz-jose.github.io/VonSim8/docs/",icon:"icon-[lucide--book-open]"},{name:"GitHub",url:"https://github.com/ruiz-jose/VonSim8",icon:SK}],Hj=x.memo(({name:t,url:e,icon:n})=>h.jsx(rs,{content:t,position:"top",children:h.jsx(Ct,{variant:"ghost",size:"sm",onClick:()=>window.open(e,"_blank"),className:"hover-lift","aria-label":t,children:typeof n=="string"?h.jsx("span",{className:re(n,"size-4")}):h.jsx(Ye,{icon:n,className:"size-4"})})}));Hj.displayName="SocialLink";const Wj=x.memo(()=>{const t=cn(),[e]=Oo(),n=x.useMemo(()=>{var s;const i=((s=window.codemirror)==null?void 0:s.state.doc.toString())||"",r=t("footer.issue.body",e,i);return`https://github.com/ruiz-jose/VonSim8/issues/new?body=${encodeURIComponent(r)}`},[t,e]);return h.jsx("footer",{className:"bg-black px-3 py-1.5 text-xs text-white","data-testid":"footer",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("span",{className:"text-xs text-stone-400 sm:text-sm",children:["© 2025 — UNLP, UNER — v","8af22e1"]}),h.jsxs("div",{className:"flex items-center gap-1","data-testid":"footer-links",children:[fZ.map(i=>h.jsx(Hj,{name:i.name,url:i.url,icon:i.icon},i.name)),h.jsx(rs,{content:t("footer.issue.report"),position:"top",children:h.jsx(Ct,{variant:"ghost",size:"sm",onClick:()=>window.open(n,"_blank"),className:"hover-lift","aria-label":t("footer.issue.report"),children:h.jsx("span",{className:"icon-[lucide--bug] size-4"})})})]})]})})});Wj.displayName="Footer";const hZ="modulepreload",pZ=function(t){return"/VonSim8/"+t},MR={},$p=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(l=>{if(l=pZ(l),l in MR)return;MR[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":hZ,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function Fp(t,e,n){const i=[];for(let r=0;r<t.length;r++)try{const s=e(t[r],r,t);s&&(Array.isArray(s)?s.forEach(o=>o&&i.push(n(o,r,t))):i.push(n(s,r,t)))}catch(s){i.push(n(s,r,t))}return i}class _n{constructor(e,n){be(this,"start");be(this,"end");this.start=e|0,this.end=(n??e)|0}get range(){return[this.start,this.end]}toString(){let e=`${this.start}`;return this.end!==this.start&&(e+=`:${this.end}`),e}static merge(...e){const n=e.filter(Boolean);if(n.length===0)throw new Error("Cannot merge 0 positions");let i=n[0].start,r=n[0].end;for(const s of n)s.start<i&&(i=s.start),s.end>r&&(r=s.end);return new _n(i,r)}toJSON(){return this.range}}const RR=Pe.from(Pe.MAX_ADDRESS).toString(),mZ=Or.from(Or.MAX_ADDRESS).toString(),gZ={"address-has-code":t=>`Memory address ${t} has instructions. It cannot be used as a data address.`,"address-out-of-range":t=>`Memory address ${Pe.format(t)} is out of range (max memory address: ${RR}).`,"cannot-accept-strings":t=>`${t} can't accept strings.`,"cannot-be-indirect":"This operand can't be an indirect memory address.","cannot-be-unassinged":t=>`${t} can't be unassigned.`,"cannot-be-word":"This operand can't be of 16 bits.","circular-reference":"Circular reference detected.","constant-must-have-a-label":"Constant must have a label.","constant-must-have-one-value":"Constant must have exactly one value.","destination-cannot-be-immediate":"The destination can't be an immediate value.","double-memory-access":"Can't access to a memory location twice in the same instruction.","duplicated-label":t=>`Duplicated label "${t}".`,"empty-program":`The program is empty or does not contain executable instructions.

Remember: a valid program must have at least one instruction and end with the END directive.

For example:

    org 1000h
    mov al, 3
    hlt
    end

See the documentation or examples for more help.`,"end-must-be-the-last-statement":"END must be the last statement.","equ-not-found":t=>`EQU "${t}" not found.`,"expects-ax":"This operand should be AL.","expects-dx":"The only valid register is DL.","expects-immediate":"This operand should be immediate.","expects-label":"This operand should be a label.","expects-no-operands":"This instruction doesn't expect any operands.","expects-one-operand":"This instruction expects one operand.","expects-two-operands":"This instruction expects two operands.","expects-word-register":"This instruction expects a 8-bits register as its operand.","parser.data-block-no-parameters":"La directiva .DATA no debe tener parámetros. Solo se permiten comentarios en la misma línea.","parser.code-block-no-parameters":"La directiva .CODE no debe tener parámetros. Solo se permiten comentarios en la misma línea.","instruction-out-of-range":t=>`This instruction would be placed in address ${Pe.format(t)}, which is outside the memory range (max memory address: ${RR}).`,"invalid-interrupt":t=>`Invalid interrupt number ${t}.`,"io-address-out-of-range":t=>`I/O address ${t} is out of range (max I/O address: ${mZ}).`,"label-not-found":t=>`Label "${t}" has not been defined.`,"label-should-be-a-number":t=>`Label ${t} should point to a EQU declaration or to a instruction. Maybe you ment to write OFFSET ${t}.`,"label-should-be-an-instruction":t=>`Label ${t} should point to a instruction.`,"missing-org":"No ORG before this instruction — cannot determine its location in memory.","must-have-one-or-more-values":t=>`${t} must have at least one value.`,"occupied-address":t=>`This instruction would be placed in address ${t}, which is already occupied.`,"offset-only-with-data-directive":"OFFSET can only be use with data directives.","reserved-address":t=>`This instruction would be placed in address ${t}, which is reserved by the system.`,"size-mismatch":(t,e)=>`The source (${t}-bit) and destination (${e}-bit) must be the same size.`,"unexpected-error":t=>`Unexpected error: ${String(t)}`,"unknown-size":"Addressing an unknown memory address with an immediate operand requires specifying the type of pointer with WORD PTR or BYTE PTR before the address.","value-out-of-range":(t,e)=>`The number ${t} cannot be represented with ${e} bits.`,lexer:{"character-too-long":"Character literals can only have one character.","empty-character":"Character literals can't be empty.","invalid-binary":"Invalid binary number. It should only contain 0s and 1s.","invalid-decimal":"Invalid decimal number. It should only contain digits.","only-ascii":"Only ASCII character are supported for characters literals and strings.","unexpected-character":t=>`Unexpected character "${t}".`,"unterminated-character":"Unterminated character.","unterminated-string":"Unterminated string."},parser:{"ambiguous-unary":"Ambiguous unary expression detected. Use parentheses to disambiguate.","expected-address-after-org":"Expected address after ORG.","expected-argument":"Expected argument.","expected-eos":"Expected end of statement.","expected-instruction":t=>`Expected instruction, got ${t.type}.`,"expected-label-after-offset":"Expected label after OFFSET.","expected-instruction-after-label":t=>`Expected instruction after label, got ${t.type}.`,"expected-literal-after-expression":t=>`Expected "${t}" after expression.`,"expected-literal-after-literal":(t,e)=>`Expected "${t}" after "${e}".`,"expected-type":(t,e)=>`Expected ${t}, got ${e}.`,"indirect-addressing-must-be-bx":"The only register supported for indirect addressing is BX.","unclosed-parenthesis":"Unclosed parenthesis.","unexpected-identifier":"Unexpected identifier. You may have forgotten a colon (:) to make it a label.","parser.data-block-no-parameters":"La directiva .DATA no debe tener parámetros. Solo se permiten comentarios en la misma línea."}},IR=Pe.from(Pe.MAX_ADDRESS).toString(),vZ=Or.from(Or.MAX_ADDRESS).toString(),yZ={"address-has-code":t=>`La dirección de memoria ${Pe.format(t)} tiene instrucciones. No se puede usar como dirección de datos.`,"address-out-of-range":t=>`La dirección de memoria ${Pe.format(t)} está fuera de rango (dirección máxima de memoria: ${IR}).`,"cannot-accept-strings":t=>`${t} no puede aceptar cadenas de texto.`,"cannot-be-indirect":"Este operando no puede ser una dirección de memoria indirecta.","cannot-be-unassinged":t=>`${t} no puede estar sin asignar.`,"cannot-be-word":"Este operando no puede ser de 16 bits.","circular-reference":"Se detectó una referencia circular.","constant-must-have-a-label":"La constante debe tener una etiqueta.","constant-must-have-one-value":"La constante debe tener una exactamente un valor.","destination-cannot-be-immediate":"El destino no puede ser un valor inmediato.","double-memory-access":"No se puede acceder a una memoria dos veces en la misma instrucción.","duplicated-label":t=>`Etiqueta duplicada "${t}".`,"empty-program":`El programa está vacío o no contiene instrucciones ejecutables.

Recuerda que un programa válido debe tener al menos una instrucción y finalizar con la directiva END.

Por ejemplo:

    org 1000h
    mov al, 3
    hlt
    end

Consulta la documentación o los ejemplos para más ayuda.`,"end-must-be-the-last-statement":"END debe ser la última instrucción.","equ-not-found":t=>`EQU "${t}" no encontrado.`,"expects-ax":"Este operando debe ser AL.","expects-dx":"El único registro válido es DL.","expects-immediate":"Este operando debe ser inmediato.","expects-label":"Este operando debe ser una etiqueta.","expects-no-operands":"Esta instrucción no espera ningún operando.","expects-one-operand":"Esta instrucción espera un operando.","expects-two-operands":"Esta instrucción espera dos operandos.","expects-word-register":"Esta instrucción espera un registro de 8 bits como su operando.","parser.data-block-no-parameters":"La directiva .DATA no debe tener parámetros. Solo se permiten comentarios en la misma línea.","parser.code-block-no-parameters":"La directiva .CODE no debe tener parámetros. Solo se permiten comentarios en la misma línea.","instruction-out-of-range":t=>`Esta instrucción se colocaría en la dirección ${Pe.format(t)}, la cual se encuentra fuera del rango de memoria (dirección máxima de memoria: ${IR}).`,"invalid-interrupt":t=>`${t} no es un número de interrupción válido.`,"io-address-out-of-range":t=>`La dirección de E/S ${t} está fuera de rango (dirección máxima de memoria E/S: ${vZ}).`,"label-not-found":t=>`La etiqueta "${t}" no ha sido definida.`,"label-should-be-a-number":t=>`La etiqueta ${t} debería apuntar a una constante EQU o a una instrucción. Quizás quiso escribir OFFSET ${t}.`,"label-should-be-an-instruction":t=>`La etiqueta ${t} debería apuntar a una instrucción.`,"missing-org":"No hay ningún ORG antes de esta instrucción, por lo que no se puede determinar su ubicación en memoria.","must-have-one-or-more-values":t=>`${t} debe tener al menos un valor.`,"occupied-address":t=>`Esta instrucción sería colocada en la dirección ${Pe.format(t)}, la cual ya está ocupada.`,"offset-only-with-data-directive":"OFFSET solo puede ser usado con variables.","reserved-address":t=>`Esta instrucción sería colocada en la dirección ${Pe.format(t)}, la cual ya está reservada por el sistema.`,"size-mismatch":(t,e)=>`La fuente (${t} bits) y el destino (${e} bits) deben ser del mismo tamaño.`,"unexpected-error":t=>`Error inesperado: ${String(t)}`,"unknown-size":"Acceder a una dirección de memoria desconocida con un operando inmediato requiere especificar el tipo de puntero con WORD PTR o BYTE PTR antes de la dirección.","value-out-of-range":(t,e)=>`El número ${t} no puede ser representado con ${e} bits.`,lexer:{"character-too-long":"El carácter solo puede contener un carácter.","empty-character":"Los carácter no puede estar vacío.","invalid-binary":"Número binario inválido. Solo puede contener ceros y unos.","invalid-decimal":"Número decimal inválido. Solo puede contener dígitos.","only-ascii":"Solo se soportan caracteres ASCII para caracteres y cadenas de texto.","unexpected-character":t=>`Carácter inesperado "${t}".`,"unterminated-character":"Carácter sin terminar.","unterminated-string":"Cadena sin terminar."},parser:{"ambiguous-unary":"Se detectó una expresión unaria ambigua. Use paréntesis para evitar ambigüedades.","expected-address-after-org":"Se esperaba una dirección después de ORG.","expected-argument":"Se esperaba un argumento.","expected-eos":"Se esperaba que la instrucción termine.","expected-instruction":t=>`Se esperaba una instrucción, se obtuvo ${t.type}.`,"expected-label-after-offset":"Se esperaba una etiqueta después de OFFSET.","expected-instruction-after-label":t=>`Se esperaba una instrucción después de la etiqueta, se obtuvo ${t.type}.`,"expected-literal-after-expression":t=>`Se esperaba "${t}" después de la expresión.`,"expected-literal-after-literal":(t,e)=>`Se esperaba "${t}" después de "${e}".`,"expected-type":(t,e)=>`Se esperaba ${t}, se obtuvo ${e}.`,"indirect-addressing-must-be-bx":"El único registro válido para el direccionamiento indirecto es BL.","unclosed-parenthesis":"Paréntesis sin cerrar.","unexpected-identifier":"Identificador inesperado. Tal vez te olvidaste agregar dos puntos (:) para hacerlo una etiqueta.","parser.data-block-no-parameters":"La directiva .DATA no debe tener parámetros. Solo se permiten comentarios en la misma línea."}},bZ=YC({en:gZ,es:yZ});class ce extends Error{constructor(n,...i){super();be(this,"code");be(this,"context");be(this,"position");this.code=n,this.context=i,this.position=null,n==="unexpected-error"&&console.error("[Unexpected Assembler Error]",...i)}at(n){return n&&(n instanceof _n?this.position=n:"position"in n?this.position=n.position:"meta"in n&&(this.position=n.meta.position)),this}translate(n){return bZ(n,this.code,...this.context)}get message(){let n=this.translate("en");return this.position&&(n+=` (${this.position})`),n}toString(){return this.message}static from(n){return n instanceof ce?n:new ce("unexpected-error",n)}}const tE=[[0,H.fromUnsigned(160,8)],[3,H.fromUnsigned(176,8)],[6,H.fromUnsigned(192,8)],[7,H.fromUnsigned(208,8)]],TR=new Set(...tE.map(([t])=>[t]));var Qa,Id;class xZ{constructor(){be(this,"codeMemory",new Set);be(this,"labels",new Map);be(this,"hasORG",!1);be(this,"_hasORG20hAtStart",!1);be(this,"_mayUsePIC",!1);Ue(this,Qa,!1);Ue(this,Id,!1)}loadStatements(e){if(N(this,Qa))throw new Error("Tried to load statements twice");ie(this,Qa,!0),this.labels.clear();const n=[];for(const i of e)if("label"in i&&i.label){if(this.labels.has(i.label)){n.push(new ce("duplicated-label",i.label).at(i.position));continue}i.isInstruction()?this.labels.set(i.label,{type:"instruction",address:Pe.from(0)}):i.directive==="EQU"?this.labels.set(i.label,{type:"EQU",constant:i}):this.labels.set(i.label,{type:i.directive,address:Pe.from(0)})}return n}computeAddresses(e){var v,b,w;if(N(this,Id))throw new Error("Tried to compute addresses twice");ie(this,Id,!0),this.codeMemory.clear();const n=new Set,i=e.some(k=>k.isInstruction()&&k.instruction==="INT");this.hasORG=e.some(k=>k.isOriginChange());const r=e.some((k,C)=>k.isOriginChange()&&C>0),s=((v=e[0])==null?void 0:v.isOriginChange())&&e[0].newAddress===32;if(this._hasORG20hAtStart=s,console.log("DEBUG ASSEMBLER:",{hasORG:this.hasORG,hasORG20hAtStart:s,firstStatement:(b=e[0])!=null&&b.isOriginChange()?e[0].newAddress:"no ORG"}),this.hasORG&&!r&&!e[0].isOriginChange())throw new ce("missing-org").at(e[0].position);const o=e.some(k=>k.isInstruction()&&k.instruction==="INT");console.log("🔍 ASSEMBLER: Iniciando detección de PIC. Labels disponibles:",Array.from(this.labels.keys()));const a=Array.from(this.labels.entries()).some(([k,C])=>{if(C.type==="EQU")try{const E=C.constant.evaluate(this);if(console.log(`🔍 ASSEMBLER: Evaluando constante EQU ${k} = ${E} (tipo: ${typeof E})`),typeof E=="number"&&E>=32&&E<=43)return console.log(`🎯 ASSEMBLER: ¡DETECTADA! Constante EQU en rango PIC: ${k} = 0x${E.toString(16)}`),!0}catch(E){console.log(`⚠️ ASSEMBLER: Error evaluando constante EQU ${k}:`,E)}return!1});console.log(`🔍 ASSEMBLER: hasPICConstants = ${a}`);const l=a||e.some(k=>!k.isInstruction()||k.instruction!=="IN"&&k.instruction!=="OUT"?!1:(console.log(`🔍 ASSEMBLER: Analizando instrucción ${k.instruction} con operandos:`,k.operands),k.operands.some(E=>{var _;if(console.log(`🔍 ASSEMBLER: Operando tipo ${E.type}, valor:`,E.value),E.type==="number-expression"&&typeof((_=E.value)==null?void 0:_.value)=="number"){const A=E.value.value,R=A>=32&&A<=43;return R&&console.log(`🎯 ASSEMBLER: Detectado uso de PIC (directo) - ${k.instruction} ${A.toString(16)}h`),R}if(E.type==="identifier"){const A=E.value;console.log(`🔍 ASSEMBLER: Verificando identificador ${A}`);const R={IMR:33,EOI:32,INT0:36,INT1:37,INT2:38,INT3:39,INT4:40,INT5:41,INT6:42,INT7:43};if(Object.hasOwnProperty.call(R,A)){const O=R[A];return console.log(`🎯 ASSEMBLER: Detectado uso de PIC (constante conocida ${A}) - ${k.instruction} ${A}(${O.toString(16)}h)`),!0}const L=this.labels.get(A);if(console.log(`🔍 ASSEMBLER: Datos de etiqueta para ${A}:`,L),L&&L.type==="EQU")try{const O=L.constant.evaluate(this);if(console.log(`🔍 ASSEMBLER: Valor evaluado de ${A}: ${O}`),typeof O=="number"&&O>=32&&O<=43)return console.log(`🎯 ASSEMBLER: Detectado uso de PIC (constante EQU usuario ${A}=${O.toString(16)}h) - ${k.instruction} ${A}`),!0}catch(O){console.log(`⚠️ ASSEMBLER: No se pudo evaluar constante ${A} para detección PIC:`,O)}}return!1})));console.log(`🔍 ASSEMBLER: Resultado detección PIC: ${l}`),this._mayUsePIC=l;let c;s?c=32:o||l?c=8:c=0,console.log("DEBUG ASSEMBLER mainCodePointer:",{hasORG20hAtStart:s,hasINTInstruction:o,mayUsePIC:l,mainCodePointer:"0x"+c.toString(16).padStart(2,"0"),strategy:s?"ORG 20h":o||l?"reserve interrupt space (INT/PIC)":"start at 00h"});let u=c,d=null,f=c,p=c;const m=[],g=[],y=[];for(const k of e)k.isInstruction()?m.push(k):k.isOriginChange()?g.push(k):k.isDataDirective()&&y.push(k);if(r||this.hasORG){const k=[],C=[];(w=e[0])!=null&&w.isOriginChange()||(u=c);const E=[],_=[],A=[];let R=!0,L=!1;for(const I of e)I.isOriginChange()?!L&&I.newAddress===32?(L=!0,R=!0,A.push(I)):(R=!1,A.push(I)):I.isInstruction()?R?E.push(I):A.push(I):I.isDataDirective()?_.push(I):I.isEnd()&&A.push(I);const O=[];return O.push(...E,..._,...A),Fp(O,I=>{if(I.isEnd()||I.isDataDirective()&&I.directive==="EQU")return;if(I.isOriginChange()){u=I.newAddress;return}const G=u;if(G===null)throw new ce("missing-org").at(I);const B=I.length,K=G,J=G+B-1;for(const V of C)if(Math.max(K,V.start)<=Math.min(J,V.end)){k.push(new ce("occupied-address",Pe.from(K)).at(I));return}C.push({start:K,end:J,statement:I});for(let V=0;V<B;V++){if(!Pe.inRange(G+V))throw new ce("instruction-out-of-range",G+V).at(I);const U=Pe.from(G+V);if(n.has(U.value))throw new ce("occupied-address",U).at(I);if(i&&TR.has(U.value))throw new ce("reserved-address",U).at(I);n.add(U.value),I.isInstruction()&&this.codeMemory.add(U.value)}const ne=Pe.from(G);I.setStart(ne),I.label&&this.labels.set(I.label,{type:I.isInstruction()?"instruction":I.directive,address:ne}),(I.isDataDirective()||I.isInstruction())&&(I.isInstruction()&&E.includes(I)&&(p=u+B),I.isDataDirective()&&d===null&&(d=p,u=d),u+=B,f=Math.max(f,u))},ce.from),k}else return Fp([...m,...g,...y],C=>{if(C.isDataDirective()&&C.directive==="EQU")return;if(C.isOriginChange()){const R=C.newAddress;R<32?d=R:u=R;return}let E;if(C.isDataDirective())d===null&&(d=f),E=d;else if(C.isInstruction())E=u;else throw new ce("missing-org").at(C);const _=C.length;for(let R=0;R<_;R++){if(!Pe.inRange(E+R))throw new ce("instruction-out-of-range",E+R).at(C);const L=Pe.from(E+R);if(n.has(L.value))throw new ce("occupied-address",L).at(C);if(i&&TR.has(L.value))throw new ce("reserved-address",L).at(C);n.add(L.value),C.isInstruction()&&this.codeMemory.add(L.value)}const A=Pe.from(E);if(C.setStart(A),C.label&&this.labels.set(C.label,{type:C.isInstruction()?"instruction":C.directive,address:A}),C.isDataDirective()){if(d===null)throw new Error("Data pointer is null");d+=_}else C.isInstruction()&&(u+=_,f=Math.max(f,u))},ce.from)}labelExists(e){if(!N(this,Qa))throw new Error("Tried to check if label exists before loading statements");return this.labels.has(e)}getLabelType(e){var n;if(!N(this,Qa))throw new Error("Tried to get type of label before loading statements");return(n=this.labels.get(e))==null?void 0:n.type}getLabelValue(e){if(!N(this,Qa))throw new Error("Tried to get type of label before loading statements");const n=this.labels.get(e);if(n){if(n.type==="EQU")return n.constant.evaluate(this);if(!N(this,Id))throw new Error("Tried to get address of label before computing addresses");return n.address.value}}addressIsReserved(e){return e instanceof Pe&&(e=e.value),this.codeMemory.has(e)}hasOriginDirective(){return this.hasORG}hasORG20hAtStart(){return this._hasORG20hAtStart}mayUsePIC(){return this._mayUsePIC}}Qa=new WeakMap,Id=new WeakMap;const wZ=["AL","BL","CL","DL","AH","BH","CH","DH"],Gj=["AX","BX","CX","DX","SP"],oy=[...wZ,...Gj],nE=["DB","DW","EQU"],iE=["MOV","PUSH","POP","IN","OUT","PUSHF","POPF","ADD","ADC","INC","SUB","SBB","DEC","NEG","CMP","NOT","AND","OR","XOR","CALL","JMP","RET","JZ","JO","JS","JC","JNZ","JNO","JNS","JNC","INT","IRET","CLI","STI","NOP","HLT"],SZ=["OFFSET","ORG","BYTE","WORD","PTR","END",".DATA",".CODE",...oy,...iE,...nE];class kZ{constructor(e,n,i){be(this,"type");be(this,"lexeme");be(this,"position");this.type=e,this.lexeme=n,this.position=i}toJSON(){return{type:this.type,lexeme:this.lexeme,position:this.position.toJSON()}}}class _Z{constructor(e){be(this,"scanned",!1);be(this,"tokens",[]);be(this,"position",new _n(0));this.source=e}scanTokens(){if(this.scanned)throw new Error("Scanner has already been used.");for(this.scanned=!0;!this.isAtEnd();){this.position=new _n(this.position.end);const e=this.advance();switch(e){case"(":this.addToken("LEFT_PAREN");continue;case")":this.addToken("RIGHT_PAREN");continue;case"[":this.addToken("LEFT_BRACKET");continue;case"]":this.addToken("RIGHT_BRACKET");continue;case",":this.addToken("COMMA");continue;case"?":this.addToken("QUESTION_MARK");continue;case"+":this.addToken("PLUS");continue;case"-":this.addToken("MINUS");continue;case"*":this.addToken("ASTERISK");continue;case"'":{let n=0;for(;this.peek()!=="'";){if(this.isAtEnd()||this.peek()===`
`)throw new ce("lexer.unterminated-character").at(this.position);if(Bp(this.peek())===null)throw new ce("lexer.only-ascii").at(new _n(this.position.end,this.position.end+1));this.advance(),n++}if(this.advance(),n===0)throw new ce("lexer.empty-character").at(this.position);if(n>=2)throw new ce("lexer.character-too-long").at(this.position);this.addToken("CHARACTER");continue}case'"':for(;this.peek()!=='"';){if(this.isAtEnd()||this.peek()===`
`)throw new ce("lexer.unterminated-string").at(this.position);if(Bp(this.peek())===null)throw new ce("lexer.only-ascii").at(new _n(this.position.end,this.position.end+1));this.advance()}this.advance(),this.addToken("STRING");continue;case";":for(;this.peek()!==`
`&&!this.isAtEnd();)this.advance();continue;case" ":case"\r":case"	":continue;case`
`:this.addToken("EOL");continue}if(this.isDigit(e)){for(;this.isDigit(this.peek())||this.peek()>="a"&&this.peek()<="f"||this.peek()>="A"&&this.peek()<="F";)this.advance();if(this.peek()===".")throw new ce("lexer.unexpected-character",".").at(new _n(this.position.end,this.position.end+1));if(this.peek()==="H"||this.peek()==="h")this.advance();else{const n=this.source.slice(this.position.start,this.position.end);if(n.at(-1)==="b"||n.at(-1)==="B"){if(!/^[01]+b$/i.test(n))throw new ce("lexer.invalid-binary").at(this.position)}else if(!/^\d+$/.test(n))throw new ce("lexer.invalid-decimal").at(this.position)}this.addToken("NUMBER");continue}if(this.isAlpha(e)||e==="."){if(e==="."&&this.isDigit(this.peek()))throw new ce("lexer.unexpected-character",".").at(new _n(this.position.start,this.position.start+1));for(;this.isAlphaNumeric(this.peek())||this.peek()===".";)this.advance();const n=this.source.slice(this.position.start,this.position.end).toUpperCase();SZ.includes(n)?this.addToken(n):this.peek()===":"?(this.advance(),this.addToken("LABEL")):this.addToken("IDENTIFIER");continue}throw new ce("lexer.unexpected-character",e).at(this.position)}return this.position=new _n(this.position.end),this.addToken("EOF"),this.tokens}addToken(e){this.tokens.push(new kZ(e,this.source.slice(this.position.start,this.position.end),this.position))}advance(){const e=this.source.charAt(this.position.end);return this.position=new _n(this.position.start,this.position.end+1),e}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}isAtEnd(){return this.position.end>=this.source.length}isDigit(e){return e>="0"&&e<="9"}peek(){return this.isAtEnd()?"\0":this.source.charAt(this.position.end)}}class ei{constructor(e){this.position=e}isNumberLiteral(){return this.type==="number-literal"}isLabel(){return this.type==="label"}isUnaryOperation(){return this.type==="unary-operation"}isBinaryOperation(){return this.type==="binary-operation"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}be(ei,"numberLiteral",(...e)=>new CZ(...e)),be(ei,"label",(...e)=>new EZ(...e)),be(ei,"unaryOperation",(...e)=>new AZ(...e)),be(ei,"binaryOperation",(...e)=>new PZ(...e));class CZ extends ei{constructor(n,i){super(i);be(this,"type","number-literal");this.value=n}evaluate(){return this.value}toJSON(){return{...super.toJSON(),value:this.value}}}let EZ=class extends ei{constructor(n,i,r){super(r);be(this,"type","label");this.value=n,this.offset=i}evaluate(n){if(!n.labelExists(this.value))throw new ce("label-not-found",this.value).at(this.position);const i=n.getLabelType(this.value);if((i==="DB"||i==="DW")&&!this.offset)throw new ce("label-should-be-a-number",this.value).at(this.position);if((i==="EQU"||i==="instruction")&&this.offset)throw new ce("offset-only-with-data-directive").at(this.position);return n.getLabelValue(this.value)}toJSON(){return{...super.toJSON(),value:this.value,offset:this.offset}}};class AZ extends ei{constructor(n,i,r){super(r);be(this,"type","unary-operation");this.operator=n,this.right=i}evaluate(n){return this.operator==="+"?this.right.evaluate(n):-this.right.evaluate(n)}toJSON(){return{...super.toJSON(),operator:this.operator,right:this.right.toJSON()}}}class PZ extends ei{constructor(n,i,r,s){super(s);be(this,"type","binary-operation");this.left=n,this.operator=i,this.right=r}evaluate(n){return this.operator==="+"?this.left.evaluate(n)+this.right.evaluate(n):this.operator==="-"?this.left.evaluate(n)-this.right.evaluate(n):this.left.evaluate(n)*this.right.evaluate(n)}toJSON(){return{...super.toJSON(),operator:this.operator,left:this.left.toJSON(),right:this.right.toJSON()}}}class Ob{constructor(e){this.position=e}isOriginChange(){return this.type==="origin-change"}isEnd(){return this.type==="end"}isDataDirective(){return this.type==="data-directive"}isInstruction(){return this.type==="instruction"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}var Go;class qj extends Ob{constructor(n,i,r){super(r);be(this,"type","data-directive");be(this,"label");be(this,"values");Ue(this,Go,null);this.values=n,this.label=i}get start(){if(N(this,Go)===null)throw new Error("Start not set");return N(this,Go)}setStart(n){if(N(this,Go)!==null)throw new Error("Start already set");ie(this,Go,n)}toJSON(){return{...super.toJSON(),...N(this,Go)?{start:N(this,Go).toJSON()}:{},directive:this.directive,label:this.label}}}Go=new WeakMap;var jc,el,Td;class NZ extends qj{constructor(n,i,r){super(n,i,r);be(this,"directive","EQU");Ue(this,jc,"not-processed");Ue(this,el,null);Ue(this,Td,null)}toJSON(){var n;return{...super.toJSON(),value:N(this,Td)??((n=N(this,el))==null?void 0:n.toJSON())??this.values.map(i=>i.toJSON())}}validate(){if(N(this,el))throw new Error("Constant already validated");if(!this.label)throw new ce("constant-must-have-a-label").at(this);if(this.values.length!==1)throw new ce("constant-must-have-one-value").at(this);const n=this.values[0];if(n.type==="string")throw new ce("cannot-accept-strings","EQU").at(n);if(n.type==="unassigned")throw new ce("cannot-be-unassinged","EQU").at(n);ie(this,el,n.value)}evaluateExpressions(n){if(!N(this,el))throw new Error("Constant not validated");if(N(this,jc)==="processed")return N(this,Td);if(N(this,jc)==="processing")throw new ce("circular-reference").at(this.position);ie(this,jc,"processed");const i=N(this,el).evaluate(n);return ie(this,jc,"processed"),ie(this,Td,i),i}evaluate(n){return this.evaluateExpressions(n)}}jc=new WeakMap,el=new WeakMap,Td=new WeakMap;const _h=Symbol("unassigned");var Ki,Ss;class MZ extends qj{constructor(n,i,r,s){super(i,r,s);be(this,"size");Ue(this,Ki,null);Ue(this,Ss,null);this.directive=n,this.size=n==="DB"?8:16}get length(){if(!N(this,Ki))throw new Error("Data directive not validated");return N(this,Ki).length*(this.size/8)}getValues(){if(!N(this,Ss))throw new Error("Data directive not evaluated");return N(this,Ss)}toJSON(){return{...super.toJSON(),values:(N(this,Ss)??N(this,Ki)??this.values).map(n=>n===_h?"?":n.toJSON())}}validate(){if(N(this,Ki))throw new Error("Data directive already validated");ie(this,Ki,[]);for(const n of this.values)if(n.isUnassigned())N(this,Ki).push(_h);else if(n.isString()){if(this.directive!=="DB")throw new ce("cannot-accept-strings",this.directive).at(n);const i=n.value;for(let r=0;r<i.length;r++){const s=Bp(i[r]);if(s===null)throw new Error("Invalid character, should not happen");const o=new _n(n.position.start+r,n.position.start+r+1),a=ei.numberLiteral(s,o);N(this,Ki).push(a)}}else N(this,Ki).push(n.value);if(N(this,Ki).length===0)throw new ce("must-have-one-or-more-values",this.directive).at(this)}evaluateExpressions(n){if(!N(this,Ki))throw new Error("Data directive not validated");if(N(this,Ss))throw new Error("Data directive already evaluated");ie(this,Ss,[]);const i=Fp(N(this,Ki),r=>{if(r===_h)N(this,Ss).push(_h);else{const s=r.evaluate(n);if(!H.fits(s,this.size))throw new ce("value-out-of-range",s,this.size).at(this);const o=H.fromNumber(s,this.size);N(this,Ss).push(o)}},ce.from);return i.length>0&&ie(this,Ss,null),i}}Ki=new WeakMap,Ss=new WeakMap;class rE{constructor(e){this.position=e}isString(){return this.type==="string"}isUnassigned(){return this.type==="unassigned"}isNumberExpression(){return this.type==="number-expression"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}class RZ extends rE{constructor(n,i){super(i);be(this,"type","string");this.value=n}toJSON(){return{...super.toJSON(),value:this.value}}}class IZ extends rE{constructor(n){super(n);be(this,"type","unassigned")}}class TZ extends rE{constructor(n){super(n.position);be(this,"type","number-expression");this.value=n}toJSON(){return{...super.toJSON(),value:this.value.toJSON()}}}function OZ(t,e,n){const i=_n.merge(t.position,...e.map(r=>r.position));switch(t.type){case"DB":case"DW":return new MZ(t.type,e,n,i);case"EQU":return new NZ(e,n,i)}}class Mx extends Ob{constructor(n){super(n);be(this,"type","end")}}function Ua(t){switch(t){case"AL":case"AX":return 0;case"BL":case"BX":return 1;case"CL":case"CX":return 2;case"DL":case"DX":return 3;case"AH":case"SP":return 4;case"CH":return 5;case"DH":return 6;case"BH":return 7;default:throw new Error(`Registro no soportado: ${t}`)}}var qo;class hu extends Ob{constructor(n,i,r){super(r);be(this,"type","instruction");be(this,"label");be(this,"operands");Ue(this,qo,null);this.operands=n,this.label=i}getOperands(){return this.operands}get start(){if(N(this,qo)===null)throw new Error("Start not set");return N(this,qo)}setStart(n){if(N(this,qo)!==null)throw new Error("Start already set");ie(this,qo,n)}toJSON(){return{...super.toJSON(),...N(this,qo)?{start:N(this,qo).toJSON()}:{},instruction:this.instruction,label:this.label}}}qo=new WeakMap;var mi,Ur;class LZ extends hu{constructor(n,i,r,s){super(i,r,s);Ue(this,mi,null);Ue(this,Ur,null);this.instruction=n}get length(){if(!N(this,mi))throw new Error("Instruction not validated");const{mode:n,size:i,out:r,src:s}=N(this,mi);let o=1;return(n==="reg<-mem"&&s.mode==="direct"||(n==="mem<-reg"||n==="mem<-imd")&&r.mode==="direct")&&(o+=1),(n==="reg<-imd"||n==="mem<-imd")&&(o+=i/8),o}get operation(){if(!N(this,Ur))throw new Error("Instruction not evaluated");return N(this,Ur)}toBytes(){const{mode:n,size:i,out:r,src:s}=this.operation,o=[],a={MOV:0,AND:240,OR:240,XOR:240,ADD:48,ADC:48,SUB:96,SBB:64,CMP:144};if(o[0]=a[this.instruction],i===16&&(o[0]|=1),!(this.instruction==="AND"||this.instruction==="OR"||this.instruction==="XOR"))switch(n){case"reg<-reg":break;case"reg<-mem":case"reg<-imd":o[0]+=16;break;case"mem<-reg":case"mem<-imd":o[0]+=32;break}switch(n){case"reg<-reg":{o[0]|=(Ua(r)&3)<<2,o[0]|=(Ua(s)&3)<<0;break}case"reg<-mem":{s.mode==="direct"?(o[0]=o[0]&252|0,o.push(s.address.byte.low.unsigned)):o[0]=o[0]&252|1,o[0]|=(Ua(r)&3)<<2;break}case"reg<-imd":{o[0]=o[0]&252|2,o.push(s.low.unsigned),o[0]|=(Ua(r)&3)<<2,i===16&&o.push(s.high.unsigned);break}case"mem<-reg":{r.mode==="direct"?(o[0]=o[0]&240|0,o[0]|=(Ua(s)&3)<<0,o.push(r.address.byte.low.unsigned)):(o[0]=o[0]&240|4,o[0]|=(Ua(s)&3)<<0);break}case"mem<-imd":{r.mode==="direct"?(o[0]=o[0]&240|12,o.push(r.address.byte.low.unsigned)):o[0]=o[0]&240|13,o.push(s.low.unsigned),i===16&&o.push(s.high.unsigned);break}default:return n}return new Uint8Array(o)}toJSON(){return{...super.toJSON(),...N(this,Ur)??N(this,mi)??{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(N(this,mi))throw new Error("Instruction already validated");if(this.operands.length!==2)throw new ce("expects-two-operands").at(this);const[i,r]=this.operands;if(i.isRegister()){if(r.isRegister()){if(i.size!==r.size)throw new ce("size-mismatch",r.size,i.size).at(this);ie(this,mi,{mode:"reg<-reg",size:i.size,out:i.value,src:r.value});return}if(r.isDirectAddress()){if(r.size!=="auto"&&r.size!==i.size)throw new ce("size-mismatch",r.size,i.size).at(this);ie(this,mi,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"direct",address:r.value}});return}if(r.isIndirectAddress()){if(r.size!=="auto"&&r.size!==i.size)throw new ce("size-mismatch",r.size,i.size).at(this);ie(this,mi,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"indirect"}});return}const s=r.getAsDirectAddress(n);if(s){if(s.size!==i.size)throw new ce("size-mismatch",s.size,i.size).at(this);ie(this,mi,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"direct",address:s.expression}});return}ie(this,mi,{mode:"reg<-imd",size:i.size,out:i.value,src:r.value});return}else{let s,o;if(i.isIndirectAddress())s=i.size,o={mode:"indirect"};else if(i.isDirectAddress())s=i.size,o={mode:"direct",address:i.value};else{const a=i.getAsDirectAddress(n);if(a)s=a.size,o={mode:"direct",address:a.expression};else throw new ce("destination-cannot-be-immediate").at(i)}if(r.isRegister()){if(s!=="auto"&&s!==r.size)throw new ce("size-mismatch",s,r.size).at(this);ie(this,mi,{mode:"mem<-reg",size:r.size,out:o,src:r.value});return}if(r.isNumberExpression()){if(r.getAsDirectAddress(n))throw new ce("double-memory-access").at(this);s==="auto"&&(s=8),ie(this,mi,{mode:"mem<-imd",size:s,out:o,src:r.value});return}throw new ce("double-memory-access").at(this)}}evaluateExpressions(n){if(!N(this,mi))throw new Error("Instruction not validated");if(N(this,Ur))throw new Error("Instruction aready evaluated");const{mode:i,size:r,out:s,src:o}=N(this,mi),a=l=>{const c=l.evaluate(n);if(!Pe.inRange(c))throw new ce("address-out-of-range",c).at(l);const u=Pe.from(c);if(n.addressIsReserved(u))throw new ce("address-has-code",u).at(l);return u};switch(i){case"reg<-reg":{ie(this,Ur,{mode:i,size:r,out:s,src:o});return}case"reg<-mem":{ie(this,Ur,{mode:i,size:r,out:s,src:o.mode==="direct"?{mode:"direct",address:a(o.address)}:{mode:"indirect"}});return}case"reg<-imd":{const l=o.evaluate(n);if(!H.fits(l,r))throw new ce("value-out-of-range",l,r).at(o);const c=H.fromNumber(l,r);ie(this,Ur,{mode:i,size:r,out:s,src:c});return}case"mem<-reg":{ie(this,Ur,{mode:i,size:r,out:s.mode==="direct"?{mode:"direct",address:a(s.address)}:{mode:"indirect"},src:o});return}case"mem<-imd":{const l=o.evaluate(n);if(!H.fits(l,r))throw new ce("value-out-of-range",l,r).at(o);const c=H.fromNumber(l,r);ie(this,Ur,{mode:i,size:r,out:s.mode==="direct"?{mode:"direct",address:a(s.address)}:{mode:"indirect"},src:c});return}default:return i}}}mi=new WeakMap,Ur=new WeakMap;var eo,Ko;class DZ extends hu{constructor(n,i,r,s){super(i,r,s);Ue(this,eo,null);Ue(this,Ko,null);be(this,"length",2);this.instruction=n}toBytes(){return new Uint8Array([26,this.value.unsigned])}get value(){if(!N(this,Ko))throw new Error("Instruction not evaluated");return N(this,Ko)}toJSON(){return{...super.toJSON(),...N(this,Ko)?{value:N(this,Ko).toJSON()}:N(this,eo)?{initialValue:N(this,eo).toJSON()}:{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(N(this,eo))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new ce("expects-one-operand").at(this);const n=this.operands[0];if(!n.isNumberExpression())throw new ce("expects-immediate").at(n);ie(this,eo,n.value)}evaluateExpressions(n){if(!N(this,eo))throw new Error("Instruction not validated");if(N(this,Ko))throw new Error("Instruction aready evaluated");const i=N(this,eo).evaluate(n);if(!H.fitsUnsigned(i,8))throw new ce("invalid-interrupt",i).at(N(this,eo));ie(this,Ko,H.fromUnsigned(i,8))}}eo=new WeakMap,Ko=new WeakMap;var ks,Xo,v4;let jZ=(v4=class extends hu{constructor(n,i,r,s){super(i,r,s);Ue(this,ks,null);Ue(this,Xo,null);this.instruction=n}get length(){if(!N(this,ks))throw new Error("Instruction not validated");return N(this,ks).port==="fixed"?2:1}toBytes(){const n=[],i={IN:216,OUT:220};return n[0]=i[this.instruction],this.operation.size===16&&(n[0]|=1),this.operation.port==="fixed"?n[1]=this.operation.address.value:n[0]|=2,new Uint8Array(n)}get operation(){if(N(this,Xo)===null)throw new Error("Operation not set");return N(this,Xo)}toJSON(){return{...super.toJSON(),...N(this,Xo)??N(this,ks)??{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(N(this,ks))throw new Error("Instruction already validated");if(this.operands.length!==2)throw new ce("expects-two-operands").at(this);const n=this.operands[this.instruction==="IN"?0:1],i=this.operands[this.instruction==="IN"?1:0];if(!n.isRegister()||n.value!=="AL"&&n.value!=="AX")throw new ce("expects-ax").at(n);const r=n.value==="AX"?16:8;if(i.isRegister()){if(i.value!=="DX")throw new ce("expects-dx").at(i);ie(this,ks,{port:"variable",size:r});return}if(i.isNumberExpression()){ie(this,ks,{port:"fixed",size:r,address:i.value});return}throw new ce("expects-immediate").at(i)}evaluateExpressions(n){if(!N(this,ks))throw new Error("Instruction not validated");if(N(this,Xo))throw new Error("Instruction aready evaluated");const i=N(this,ks);if(i.port==="fixed"){const r=i.address.evaluate(n);if(!Or.inRange(r))throw new ce("io-address-out-of-range",r).at(this);const s=Or.from(r);ie(this,Xo,{port:"fixed",size:i.size,address:s})}else ie(this,Xo,{port:"variable",size:i.size})}},ks=new WeakMap,Xo=new WeakMap,v4);var Yo,to,y4;let BZ=(y4=class extends hu{constructor(n,i,r,s){super(i,r,s);Ue(this,Yo,null);Ue(this,to,null);be(this,"length",2);this.instruction=n}toBytes(){const n=[],i={JC:195,JNC:196,JZ:193,JNZ:34,JS:197,JNS:198,JO:199,JNO:200,JMP:192,CALL:201};return n.push(i[this.instruction]),n.push(this.address.byte.low.unsigned),new Uint8Array(n)}get address(){if(N(this,to)===null)throw new Error("Instruction not evaluated");return N(this,to)}toJSON(){return{...super.toJSON(),...N(this,to)?{address:N(this,to).toJSON()}:N(this,Yo)?{jumpTo:N(this,Yo)}:{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(N(this,Yo))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new ce("expects-one-operand").at(this);const i=this.operands[0];if(!i.isNumberExpression()||!i.value.isLabel()&&!i.value.isNumberLiteral())throw new ce("expects-label").at(i);if(i.value.isLabel()){const r=i.value.value,s=n.getLabelType(r);if(!s)throw new ce("label-not-found",r).at(i);if(s!=="instruction")throw new ce("label-should-be-an-instruction",r).at(i);ie(this,Yo,r)}else if(i.value.isNumberLiteral()){const r=i.value.value;if(!Pe.inRange(r))throw new ce("address-out-of-range",r).at(i);ie(this,to,Pe.from(r))}}evaluateExpressions(n){if(!N(this,to)&&N(this,Yo)){const i=n.getLabelValue(N(this,Yo));if(!Pe.inRange(i))throw new ce("address-out-of-range",i).at(this);ie(this,to,Pe.from(i))}}},Yo=new WeakMap,to=new WeakMap,y4);var no,b4;let $Z=(b4=class extends hu{constructor(n,i,r,s){super(i,r,s);Ue(this,no,null);be(this,"length",1);this.instruction=n}toBytes(){let i={PUSH:208,POP:212}[this.instruction];return i|=Ua(this.register),new Uint8Array([i])}get register(){if(!N(this,no))throw new Error("Instruction not evaluated");return N(this,no)}toJSON(){return{...super.toJSON(),...N(this,no)?{register:N(this,no)}:{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(N(this,no))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new ce("expects-one-operand").at(this);const n=this.operands[0];if(!n.isRegister()||n.size!==8)throw new ce("expects-word-register").at(n);ie(this,no,n.value)}evaluateExpressions(){if(!N(this,no))throw new Error("Instruction not validated")}},no=new WeakMap,b4);var pr,io;class FZ extends hu{constructor(n,i,r,s){super(i,r,s);Ue(this,pr,null);Ue(this,io,null);this.instruction=n}get length(){if(!N(this,pr))throw new Error("Instruction not validated");const{mode:n}=N(this,pr);let i=1;return n==="mem-direct"&&(i+=1),i}toBytes(){const n=[],i={NOT:64,NEG:66,INC:68,DEC:70};switch(n[0]=i[this.instruction],this.operation.size===16&&(n[0]|=1),this.operation.mode){case"reg":{n[0]|=Ua(this.operation.reg);break}case"mem-direct":{const r=this.operation.address.byte;n.push(r.low.unsigned);break}case"mem-indirect":break;default:return this.operation}return new Uint8Array(n)}get operation(){if(!N(this,io))throw new Error("Instruction not evaluated");return N(this,io)}toJSON(){return{...super.toJSON(),...N(this,io)??N(this,pr)??{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(N(this,pr))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new ce("expects-one-operand").at(this);const i=this.operands[0];if(i.isRegister()){ie(this,pr,{mode:"reg",size:i.size,reg:i.value});return}if(i.isDirectAddress()){if(i.size==="auto")throw new ce("unknown-size").at(i);ie(this,pr,{mode:"mem-direct",size:i.size,address:i.value});return}if(i.isIndirectAddress()){if(i.size==="auto")throw new ce("unknown-size").at(i);ie(this,pr,{mode:"mem-indirect",size:i.size});return}const r=i.getAsDirectAddress(n);if(r){ie(this,pr,{mode:"mem-direct",size:r.size,address:r.expression});return}throw new ce("destination-cannot-be-immediate").at(i)}evaluateExpressions(n){if(!N(this,pr))throw new Error("Instruction not validated");if(N(this,io))throw new Error("Instruction aready evaluated");const i=N(this,pr);switch(i.mode){case"reg":{ie(this,io,{mode:"reg",size:i.size,reg:i.reg});return}case"mem-direct":{const r=i.address.evaluate(n);if(!Pe.inRange(r))throw new ce("address-out-of-range",r).at(i.address);const s=Pe.from(r);if(n.addressIsReserved(s))throw new ce("address-has-code",s).at(i.address);ie(this,io,{mode:"mem-direct",size:i.size,address:s});return}case"mem-indirect":{ie(this,io,{mode:"mem-indirect",size:i.size});return}default:return i}}}pr=new WeakMap,io=new WeakMap;var Od;class zZ extends hu{constructor(n,i,r,s){super(i,r,s);Ue(this,Od,!1);be(this,"length",1);this.instruction=n}toBytes(){const n={PUSHF:112,POPF:120,RET:51,CLI:226,STI:227,IRET:225,NOP:240,HLT:241};return new Uint8Array([n[this.instruction]])}validate(){if(N(this,Od))throw new Error("Instruction already validated");if(this.operands.length>0)throw new ce("expects-no-operands").at(this);ie(this,Od,!0)}evaluateExpressions(){if(!N(this,Od))throw new Error("Instruction not validated")}}Od=new WeakMap;class Lb{constructor(e){this.position=e}isRegister(){return this.type==="register"}isIndirectAddress(){return this.type==="indirect-address"}isDirectAddress(){return this.type==="direct-address"}isNumberExpression(){return this.type==="number-expression"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}class UZ extends Lb{constructor(n){super(n.position);be(this,"type","register");be(this,"value");this.value=n.type}get size(){return Gj.includes(this.value)?16:8}toJSON(){return{...super.toJSON(),value:this.value}}}class VZ extends Lb{constructor(n,i){super(i);be(this,"type","indirect-address");be(this,"size");n?this.size=n==="BYTE"?8:16:this.size="auto"}toJSON(){return{...super.toJSON(),size:this.size}}}class HZ extends Lb{constructor(n,i,r){super(r);be(this,"type","direct-address");be(this,"size");this.value=n,i?this.size=i==="BYTE"?8:16:this.size=8}toJSON(){return{...super.toJSON(),size:this.size,value:this.value.toJSON()}}}class ay extends Lb{constructor(n){super(n.position);be(this,"type","number-expression");this.value=n}getAsDirectAddress(n){return ay.recursiveGetAsDirectAddress(this.value,n)}static recursiveGetAsDirectAddress(n,i){if(n.isLabel()){const r=n;if(r.offset)return!1;if(!i.labelExists(r.value))throw new ce("label-not-found",r.value).at(n.position);const s=i.getLabelType(r.value),o=s==="DB"?8:s==="DW"?16:!1;return o?{size:o,expression:ei.label(r.value,!0,n.position)}:!1}else if(n.isBinaryOperation()){if(n.operator!=="+"&&n.operator!=="-")return!1;const r=ay.recursiveGetAsDirectAddress(n.left,i);return r?{size:r.size,expression:ei.binaryOperation(r.expression,n.operator,n.right,n.position)}:!1}return!1}toJSON(){return{...super.toJSON(),value:this.value.toJSON()}}}function OR(t,e,n){const i=_n.merge(t.position,...e.map(r=>r.position));switch(t.type){case"PUSHF":case"POPF":case"RET":case"IRET":case"CLI":case"STI":case"NOP":case"HLT":return new zZ(t.type,e,n,i);case"MOV":case"ADD":case"ADC":case"SUB":case"SBB":case"CMP":case"AND":case"OR":case"XOR":return new LZ(t.type,e,n,i);case"NEG":case"INC":case"DEC":case"NOT":return new FZ(t.type,e,n,i);case"PUSH":case"POP":return new $Z(t.type,e,n,i);case"CALL":case"JZ":case"JNZ":case"JS":case"JNS":case"JC":case"JNC":case"JO":case"JNO":case"JMP":return new BZ(t.type,e,n,i);case"IN":case"OUT":return new jZ(t.type,e,n,i);case"INT":return new DZ(t.type,e,n,i)}}class WZ extends Ob{constructor(n,i){super(i);be(this,"type","origin-change");this.newAddress=n}toJSON(){return{...super.toJSON(),newAddress:this.newAddress}}}let GZ=class{constructor(e){be(this,"tokens");be(this,"current",0);this.tokens=e}parse(){this.current=0;const e=[];for(;!this.isAtEnd();)this.match("EOL")||e.push(this.statement());return e}statement(){const e=this.originChangeStatement()??this.endStatement()??this.dataBlockStatement()??this.codeBlockStatement()??this.dataDirectiveStatement()??this.instructionStatement();if(!e){const n=this.peek();throw new ce("parser.expected-instruction",n).at(n)}return e}originChangeStatement(){const e=this.match("ORG");if(!e)return null;const n=this.consume("NUMBER",new ce("parser.expected-address-after-org")),i=this.parseNumber(n);return this.endOfStatement(),new WZ(i,_n.merge(e.position,n.position))}endStatement(){const e=this.match("END");if(!e)return null;for(;!this.isAtEnd();)if(!this.match("EOL"))throw new ce("end-must-be-the-last-statement").at(e);return new Mx(e.position)}dataBlockStatement(){const e=this.match(".DATA");return e?new Mx(e.position):null}codeBlockStatement(){const e=this.match(".CODE");return e?new Mx(e.position):null}dataDirectiveStatement(){const e=this.match("IDENTIFIER"),n=this.match(...nE);if(e&&!n)throw new ce("parser.unexpected-identifier").at(e);if(!n)return null;const i=(e==null?void 0:e.lexeme.toUpperCase())||null,r=[this.dataDirectiveValue()];for(;this.match("COMMA");)r.push(this.dataDirectiveValue());return this.endOfStatement(),OZ(n,r,i)}dataDirectiveValue(){if(this.match("STRING")){const e=this.previous();return new RZ(this.parseString(e),e.position)}if(this.match("QUESTION_MARK")){const e=this.previous();return new IZ(e.position)}return new TZ(this.numberExpression())}instructionStatement(){const e=this.match("LABEL");for(;this.match("EOL"););const n=this.match(...iE);if(e&&!n){const s=this.peek();throw new ce("parser.expected-instruction-after-label",s).at(s)}if(!n)return null;const i=(e==null?void 0:e.lexeme.toUpperCase().slice(0,-1))||null;if(this.isAtEndOfStatement())return OR(n,[],i);const r=[this.instructionOperand()];for(;this.match("COMMA");)r.push(this.instructionOperand());return this.endOfStatement(),OR(n,r,i)}instructionOperand(){if(this.match(...oy)){const n=this.previous();return new UZ(n)}const e=this.match("BYTE","WORD");if(e&&this.consume("PTR",new ce("parser.expected-literal-after-literal","PTR",this.previous().type)),this.match("LEFT_BRACKET")){const n=this.previous();if(this.check(...oy)){if(!this.check("BX","BL"))throw new ce("parser.indirect-addressing-must-be-bx");const i=this.advance(),r=this.consume("RIGHT_BRACKET",new ce("parser.expected-literal-after-literal","]",i.lexeme));return new VZ(e==null?void 0:e.type,_n.merge(e==null?void 0:e.position,n.position,r.position))}else{const i=this.numberExpression(),r=this.consume("RIGHT_BRACKET",new ce("parser.expected-literal-after-expression","]"));return new HZ(i,e==null?void 0:e.type,_n.merge(e==null?void 0:e.position,n.position,r.position))}}else if(e)throw new ce("parser.expected-literal-after-literal","[","PTR");return new ay(this.numberExpression())}advance(){return this.tokens[this.current++]}check(...e){if(this.isAtEnd())return!1;for(const n of e)if(this.peek().type===n)return!0;return!1}consume(e,n){Array.isArray(e)||(e=[e]);const i=this.match(...e);if(i)return i;throw n||(n=new ce("parser.expected-type",e.join(","),this.peek().type)),n.at(this.peek())}endOfStatement(){if(!this.isAtEnd()){if(this.check("EOL"))return this.advance();throw new ce("parser.expected-eos").at(this.peek())}}isAtEnd(){return this.peek().type==="EOF"}isAtEndOfStatement(){return this.check("EOL")||this.isAtEnd()}match(...e){return this.check(...e)?this.advance():null}parseNumber(e){return e.lexeme.at(-1)==="h"||e.lexeme.at(-1)==="H"?parseInt(e.lexeme.slice(0,-1),16):e.lexeme.at(-1)==="b"||e.lexeme.at(-1)==="B"?parseInt(e.lexeme.slice(0,-1),2):parseInt(e.lexeme,10)}parseString(e){return e.lexeme.slice(1,-1)}peek(){return this.tokens[this.current]}previous(){return this.tokens[this.current-1]}primaryNE(){if(this.match("NUMBER")){const i=this.previous(),r=this.parseNumber(i);return ei.numberLiteral(r,i.position)}if(this.match("CHARACTER")){const i=this.previous(),r=Bp(i.lexeme.slice(1,-1));return ei.numberLiteral(r,i.position)}if(this.match("LEFT_PAREN")){const i=this.numberExpression();return this.consume("RIGHT_PAREN",new ce("parser.unclosed-parenthesis")),i}const e=this.match("OFFSET"),n=this.match("IDENTIFIER");if(e&&!n)throw new ce("parser.expected-label-after-offset").at(this.peek());if(!n)throw new ce("parser.expected-argument").at(this.peek());return ei.label(n.lexeme.toUpperCase(),e!==null,_n.merge(e==null?void 0:e.position,n.position))}unaryNE(){if(this.match("PLUS","MINUS")){const e=this.previous();if(this.check("PLUS","MINUS"))throw new ce("parser.ambiguous-unary").at(this.peek());const n=this.unaryNE();return ei.unaryOperation(e.type==="PLUS"?"+":"-",n,_n.merge(e.position,n.position))}return this.primaryNE()}factorNE(){let e=this.unaryNE();for(;this.match("ASTERISK");){const n=this.unaryNE();e=ei.binaryOperation(e,"*",n,_n.merge(e.position,n.position))}return e}termNE(){let e=this.factorNE();for(;this.match("PLUS","MINUS");){const n=this.previous(),i=this.factorNE();e=ei.binaryOperation(e,n.type==="PLUS"?"+":"-",i,_n.merge(e.position,i.position))}return e}numberExpression(){return this.termNE()}};function Kj(t){try{const n=new _Z(t).scanTokens(),r=new GZ(n).parse();if(!r.at(-1))throw new ce("empty-program");let o=[];const a=new xZ;if(o=a.loadStatements(r),o.length>0)return{success:!1,errors:o};if(o=Fp(r,u=>{u.isOriginChange()||u.isEnd()||u.validate(a)},ce.from),o.length>0)return{success:!1,errors:o};if(o=a.computeAddresses(r),o.length>0)return{success:!1,errors:o};const l=[],c=[];return o=Fp(r,u=>{if(u.isDataDirective())if(u.directive==="EQU")u.evaluateExpressions(a);else{const d=u.evaluateExpressions(a);return l.push(u),d}else u.isInstruction()&&(u.evaluateExpressions(a),c.push(u))},ce.from),o.length>0?{success:!1,errors:o}:{success:!0,data:l,instructions:c,hasORG:a.hasOriginDirective(),hasORG20hAtStart:a.hasORG20hAtStart(),mayUsePIC:a.mayUsePIC()}}catch(e){return{success:!1,errors:[ce.from(e)]}}}class Us{constructor(e){be(this,"computer");this.computer=e.computer}}const qZ=t=>Pe.format(t).slice(-2),KZ=qZ(Pe.MAX_ADDRESS),XZ={"address-has-instruction":t=>`Memory address ${Pe.format(t)} has an instruction, and cannot be written.`,"address-is-reserved":t=>`Memory address ${Pe.format(t)} is reserved, and cannot be written.`,"address-out-of-range":t=>`Memory address ${Pe.format(t)} is out of range (max memory address: ${KZ}).`,"device-not-connected":t=>`"${t}" is not connected to the computer.`,"io-memory-not-connected":t=>`Didn't found a module connected to I/O memory address ${Or.format(t)}.`,"io-printer-conflict":()=>"Printer must be connected to either the PIO or the Handshake, but not both.","no-instruction":t=>`Expected instruction at memory address ${Pe.format(t)} but none was found.`,"no-program":"No program loaded. Assemble before running.","stack-overflow":"Stack overflow","stack-underflow":"Stack underflow","unexpected-error":t=>`Unexpected error: ${String(t)}`},YZ=Pe.from(Pe.MAX_ADDRESS).toString(),JZ={"address-has-instruction":t=>`La dirección de memoria ${Pe.format(t)} tiene una instrucción, y no se puede escribir.`,"address-is-reserved":t=>`La dirección de memoria ${Pe.format(t)} está reservada, y no se puede escribir.`,"address-out-of-range":t=>`La dirección de memoria ${Pe.format(t)} está fuera de rango (dirección máxima de memoria: ${YZ}).`,"device-not-connected":t=>`"${t}" no está conectado a la computadora.`,"io-memory-not-connected":t=>`No se encontró ningún módulo conectado a la dirección de memoria E/S ${Or.format(t)}.`,"io-printer-conflict":()=>"La impresora debe estar conectada a la PIO o al Handshake, pero no a ambos.","no-instruction":t=>`Se esperaba una instrucción en la dirección de memoria ${Pe.format(t)} pero no se encontró ninguna.`,"no-program":"No hay ningún programa cargado. Ensamblá antes de ejecutar.","stack-overflow":"Stack overflow","stack-underflow":"Stack underflow","unexpected-error":t=>`Error inesperado: ${String(t)}`},ZZ=YC({en:XZ,es:JZ});class hn extends Error{constructor(n,...i){super();be(this,"code");be(this,"context");this.code=n,this.context=i,n==="unexpected-error"&&console.error("[Unexpected Simulator Error]",...i)}translate(n){return ZZ(n,this.code,...this.context)}get message(){return this.translate("en")}toString(){return this.message}static from(n){return n instanceof hn?n:new hn("unexpected-error",n)}}class _a{constructor(e){this.statement=e}get name(){return this.statement.instruction}get start(){return this.statement.start}get position(){return this.statement.position}*consumeInstruction(e,n,i){if(yield*e.cpu.setMAR("IP"),!(yield*e.cpu.useBus("mem-read"))){const s=e.cpu.getRegister("IP").toString("hex");throw new hn("unexpected-error",`Could not read instruction byte at address ${s}h`)}yield*e.cpu.updateWordRegister("IP",s=>s.add(1)),i||(yield*e.cpu.getMBR(n))}}var Ky,Xj;class QZ extends _a{constructor(){super(...arguments);Ue(this,Ky)}get operation(){return this.statement.operation}*execute(n){const{mode:i,size:r,out:s,src:o}=this.operation;if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:Ut(this,Ky,Xj).call(this),willUse:{id:this.operation.mode==="mem<-imd"&&(this.operation.out.mode==="direct"||this.operation.out.mode==="indirect"),ri:this.operation.mode==="mem<-imd"&&this.operation.out.mode==="direct"&&this.name!=="CMP"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},i==="mem<-imd"&&s.mode==="direct"){if(yield*this.consumeInstruction(n,"ri.l"),yield*this.consumeInstruction(n,"id.l"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.l"),yield*n.cpu.copyByteRegister("id.l","right.l"),yield{type:"cpu:cycle.update",phase:"execute"};const d=n.cpu.getRegister("left.l"),f=n.cpu.getRegister("right.l");let p;const m={};switch(this.name){case"AND":case"OR":case"XOR":{const g=this.name==="AND"?d.signed&f.signed:this.name==="OR"?d.signed|f.signed:d.signed^f.signed;p=H.fromSigned(g,r),m.CF=!1,m.OF=!1;break}case"ADD":case"ADC":{const g=this.name==="ADC"&&n.cpu.getFlag("CF")?1:0,y=d.unsigned+f.unsigned+g;y>H.maxValue(r)?(m.CF=!0,p=H.fromUnsigned(y-H.maxValue(r)-1,r)):(m.CF=!1,p=H.fromUnsigned(y,r)),m.OF=d.signed>=0&&f.signed>=0&&p.signed<0||d.signed<0&&f.signed<0&&p.signed>=0;break}case"SUB":case"SBB":case"CMP":{const g=this.name==="SBB"&&n.cpu.getFlag("CF")?1:0,y=d.unsigned-f.unsigned-g;y<0?(m.CF=!0,p=H.fromUnsigned(y+H.maxValue(r)+1,r)):(m.CF=!1,p=H.fromUnsigned(y,r)),m.OF=d.signed>=0&&f.signed<0&&p.signed<0||d.signed<0&&f.signed>=0&&p.signed>=0;break}}return m.ZF=p.isZero(),m.SF=p.signed<0,yield*n.cpu.aluExecute(this.name==="CMP"?"SUB":this.name,p,m),this.name==="CMP"?!0:(yield{type:"cpu:cycle.update",phase:"writeback"},yield*n.cpu.setMBR("result.l"),!!(yield*n.cpu.useBus("mem-write")))}if(i==="mem<-imd"&&s.mode==="indirect"&&(yield*this.consumeInstruction(n,"ri.l",!0)),i==="reg<-reg"||i==="reg<-mem"||i==="reg<-imd")i!=="reg<-mem"?r===8?yield*n.cpu.copyByteRegister(s,"left.l"):yield*n.cpu.copyWordRegister(s,"left"):(typeof window<"u"&&window.setShowPath2&&i==="reg<-mem"&&o.mode==="direct"&&window.setShowPath2(!0),typeof window<"u"&&window.setShowPath2&&i==="reg<-mem"&&o.mode==="direct"&&window.setShowPath2(!1));else{if(s.mode==="direct"?yield*this.consumeInstruction(n,"ri.l"):this.operation.mode==="mem<-imd"&&s.mode==="indirect"||(yield*n.cpu.copyByteRegister("BL","ri.l")),this.operation.mode==="mem<-imd"&&s.mode==="indirect"&&(yield*n.cpu.copyByteRegister("BL","ri.l"),yield*n.cpu.getMBR("id.l")),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(this.operation.mode==="mem<-imd"?yield*n.cpu.getMBR("left.l"):yield*n.cpu.getMBR("left.l"),r===16){if(yield*n.cpu.updateWordRegister("ri",d=>d.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.h")}}if(i==="reg<-reg"||i==="mem<-reg")r===8?yield*n.cpu.copyByteRegister(o,"right.l"):yield*n.cpu.copyWordRegister(o,"right");else if(i==="reg<-imd"||i==="mem<-imd")i==="mem<-imd"&&s.mode==="indirect"?yield*n.cpu.copyByteRegister("id.l","right.l"):yield*this.consumeInstruction(n,"right.l"),r===16&&(yield*this.consumeInstruction(n,"right.h"));else{if(o.mode==="direct"?yield*this.consumeInstruction(n,"ri.l"):yield*n.cpu.copyByteRegister("BL","ri.l"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("right.l"),r===16){if(yield*n.cpu.updateWordRegister("ri",d=>d.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("right.h")}i==="reg<-mem"&&(r===8?yield*n.cpu.copyByteRegister(s,"left.l"):yield*n.cpu.copyWordRegister(s,"left"))}yield{type:"cpu:cycle.update",phase:"execute"};const a=r===8?n.cpu.getRegister("left.l"):n.cpu.getRegister("left"),l=r===8?n.cpu.getRegister("right.l"):n.cpu.getRegister("right");let c;const u={};switch(this.name){case"AND":case"OR":case"XOR":{const d=this.name==="AND"?a.signed&l.signed:this.name==="OR"?a.signed|l.signed:a.signed^l.signed;c=H.fromSigned(d,r),u.CF=!1,u.OF=!1;break}case"ADD":case"ADC":{const d=this.name==="ADC"&&n.cpu.getFlag("CF")?1:0,f=a.unsigned+l.unsigned+d;f>H.maxValue(r)?(u.CF=!0,c=H.fromUnsigned(f-H.maxValue(r)-1,r)):(u.CF=!1,c=H.fromUnsigned(f,r)),u.OF=a.signed>=0&&l.signed>=0&&c.signed<0||a.signed<0&&l.signed<0&&c.signed>=0;break}case"SUB":case"SBB":case"CMP":{const d=this.name==="SBB"&&n.cpu.getFlag("CF")?1:0,f=a.unsigned-l.unsigned-d;f<0?(u.CF=!0,c=H.fromUnsigned(f+H.maxValue(r)+1,r)):(u.CF=!1,c=H.fromUnsigned(f,r)),u.OF=a.signed>=0&&l.signed<0&&c.signed<0||a.signed<0&&l.signed>=0&&c.signed>=0;break}}if(u.ZF=c.isZero(),u.SF=c.signed<0,yield*n.cpu.aluExecute(this.name==="CMP"?"SUB":this.name,c,u),this.name==="CMP")return!0;if(yield{type:"cpu:cycle.update",phase:"writeback"},i==="reg<-reg"||i==="reg<-mem"||i==="reg<-imd")r===8?yield*n.cpu.copyByteRegister("result.l",s):yield*n.cpu.copyWordRegister("result",s);else{if(r===16){if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.h"),!(yield*n.cpu.useBus("mem-write")))return!1;yield*n.cpu.updateWordRegister("ri",d=>d.add(-1))}if(yield*n.cpu.setMBR("result.l"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-write")))return!1}return!0}}Ky=new WeakSet,Xj=function(){const{mode:n,out:i,src:r}=this.operation;switch(n){case"reg<-reg":return[i,r];case"reg<-mem":{const s=r.mode==="direct"?r.address.toString():"BL";return[i,`[${s}]`]}case"reg<-imd":return[i,`${r.toString("hex")}h`];case"mem<-reg":return[`[${i.mode==="direct"?i.address.toString():"BL"}]`,r];case"mem<-imd":return[`[${i.mode==="direct"?i.address.toString():"BL"}]`,`${r.toString("hex")}h`];default:return n}};var Xy,Yj;class eQ extends _a{constructor(){super(...arguments);Ue(this,Xy)}get operation(){return this.statement.operation}*execute(n){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:Ut(this,Xy,Yj).call(this),willUse:{ri:!1}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},this.operation.mode==="reg")this.operation.size===8?yield*n.cpu.copyByteRegister(this.operation.reg,"left.l"):yield*n.cpu.copyWordRegister(this.operation.reg,"left");else{if(this.operation.mode==="mem-direct"?yield*this.consumeInstruction(n,"ri.l"):yield*n.cpu.copyByteRegister("BL","ri.l"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("left.l"),this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",o=>o.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.h")}}yield{type:"cpu:cycle.update",phase:"execute"};const i=this.operation.size===8?n.cpu.getRegister("left.l"):n.cpu.getRegister("left");let r;const s={};switch(this.name){case"NOT":{r=H.fromSigned(~i.signed,this.operation.size),s.CF=!1,s.OF=!1;break}case"NEG":{r=H.fromSigned(-i.signed,this.operation.size),s.CF=!i.isZero(),s.OF=i.signed===H.minSignedValue(this.operation.size);break}case"INC":{yield*n.cpu.updateWordRegister("right",H.fromSigned(1,16));const o=i.unsigned+1;o>H.maxValue(this.operation.size)?(s.CF=!0,r=H.fromUnsigned(o-H.maxValue(this.operation.size)-1,this.operation.size)):(s.CF=!1,r=H.fromUnsigned(o,this.operation.size)),s.OF=i.signed>=0&&r.signed<0;break}case"DEC":{yield*n.cpu.updateWordRegister("right",H.fromSigned(1,16));const o=i.unsigned-1;o<0?(s.CF=!0,r=H.fromUnsigned(o+H.maxValue(this.operation.size)+1,this.operation.size)):(s.CF=!1,r=H.fromUnsigned(o,this.operation.size)),s.OF=i.signed<0&&r.signed>=0;break}}if(s.ZF=r.isZero(),s.SF=r.signed<0,yield*n.cpu.aluExecute(this.name==="INC"?"ADD":this.name==="DEC"?"SUB":this.name,r,s),yield{type:"cpu:cycle.update",phase:"writeback"},this.operation.mode==="reg")this.operation.size===8?yield*n.cpu.copyByteRegister("result.l",this.operation.reg):yield*n.cpu.copyWordRegister("result",this.operation.reg);else{if(this.operation.size===16){if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.h"),!(yield*n.cpu.useBus("mem-write")))return!1;yield*n.cpu.updateWordRegister("ri",o=>o.add(-1))}if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.l"),!(yield*n.cpu.useBus("mem-write")))return!1}return!0}}Xy=new WeakSet,Yj=function(){switch(this.operation.mode){case"reg":return[this.operation.reg];case"mem-direct":return[`[${this.operation.address.toString()}]`];case"mem-indirect":return["[BL]"];default:return this.operation}};class tQ extends _a{get number(){return this.statement.value}*execute(e){return yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[this.number.toString("uint")],willUse:{ri:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},yield*super.consumeInstruction(e,"ri.l"),yield{type:"cpu:cycle.update",phase:"execute"},yield*e.cpu.startInterrupt(this.number)}}var Yy,Jj;class nQ extends _a{constructor(){super(...arguments);Ue(this,Yy)}get operation(){return this.statement.operation}*execute(n){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:Ut(this,Yy,Jj).call(this),willUse:{ri:!1}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},this.operation.port==="fixed")yield*super.consumeInstruction(n,"ri.l");else if(yield*n.cpu.copyByteRegister("DL","ri.l"),!n.cpu.getRegister("DX").high.isZero())return yield{type:"cpu:error",error:new hn("io-memory-not-connected",n.cpu.getRegister("DX"))},!1;if(yield{type:"cpu:cycle.update",phase:"writeback"},this.name==="IN"){if(yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("io-read")))return!1;if(yield*n.cpu.getMBR("AL"),this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",i=>i.add(1)),yield*n.cpu.setMAR("ri"),!n.cpu.getRegister("ri.h").isZero())return yield{type:"cpu:error",error:new hn("io-memory-not-connected",n.cpu.getRegister("ri"))},!1;if(!(yield*n.cpu.useBus("io-read")))return!1;yield*n.cpu.getMBR("AH")}}else{if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("AL"),!(yield*n.cpu.useBus("io-write")))return!1;if(this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",i=>i.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("AH"),!n.cpu.getRegister("ri.h").isZero())return yield{type:"cpu:error",error:new hn("io-memory-not-connected",n.cpu.getRegister("ri"))},!1;if(!(yield*n.cpu.useBus("io-write")))return!1}}return!0}}Yy=new WeakSet,Jj=function(){const n=[];return this.operation.port==="variable"?n.push("DX"):n.push(this.operation.address.toString()),this.operation.size===8?n.push("AL"):n.push("AX"),this.name==="IN"?n.reverse():n};class iQ extends _a{get jumpTo(){return this.statement.address}*execute(e){yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[this.jumpTo.toString(!1)],willUse:{id:!1,ri:this.name==="CALL"}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},yield*super.consumeInstruction(e,"ri.l",!1),yield{type:"cpu:cycle.update",phase:"execute"};let n;switch(this.name){case"JC":n=e.cpu.getFlag("CF");break;case"JNC":n=!e.cpu.getFlag("CF");break;case"JZ":n=e.cpu.getFlag("ZF");break;case"JNZ":n=!e.cpu.getFlag("ZF");break;case"JS":n=e.cpu.getFlag("SF");break;case"JNS":n=!e.cpu.getFlag("SF");break;case"JO":n=e.cpu.getFlag("OF");break;case"JNO":n=!e.cpu.getFlag("OF");break;case"CALL":case"JMP":n=!0;break;default:return this.name}if(n)if(this.name==="CALL"){if(!(yield*e.cpu.pushToStack("IP.l")))return!1;yield*e.cpu.copyByteRegister("ri.l","IP.l")}else yield*e.cpu.getMBR("ri.l"),yield*e.cpu.copyByteRegister("ri.l","IP.l");return!0}}class rQ extends _a{*execute(e){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[],willUse:{}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},this.name==="CLI")yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield*e.cpu.updateFLAGS({IF:!1});else if(this.name==="STI")yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield*e.cpu.updateFLAGS({IF:!0});else if(this.name==="HLT")return yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield{type:"cpu:halt"},yield{type:"cpu:cycle.end"},!1;return!0}}function z2(t){switch(t){case"AL":return["AX","low"];case"AH":return["AX","high"];case"BL":return["BX","low"];case"BH":return["BX","high"];case"CL":return["CX","low"];case"CH":return["CX","high"];case"DL":return["DX","low"];case"DH":return["DX","high"];default:{const[e,n]=t.split(".");return e==="MBR"?[e,null]:[e,n==="l"?"low":n==="h"?"high":null]}}}function Rx(t){switch(t){case"AX":return["AL","AH"];case"BX":return["BL","BH"];case"CX":return["CL","CH"];case"DX":return["DL","DH"];case"SP":return["SP.l","SP.h"];case"IP":return["IP.l","IP.h"];case"ri":return["ri.l","ri.h"];case"id":return["id.l","id.h"];case"left":return["left.l","left.h"];case"right":return["right.l","right.h"];case"result":return["result.l","result.h"];case"FLAGS":return["FLAGS.l","FLAGS.h"];default:return[t,null]}}var Jy,Zj;class sQ extends _a{constructor(){super(...arguments);Ue(this,Jy)}get operation(){return this.statement.operation}*execute(n){const{mode:i,size:r,out:s,src:o}=this.operation;switch(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:Ut(this,Jy,Zj).call(this),willUse:{id:!1,ri:this.operation.mode==="mem<-imd"&&this.operation.out.mode==="direct"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},(this.operation.mode==="reg<-mem"||this.operation.mode==="mem<-reg"||this.operation.mode==="mem<-imd")&&((this.operation.mode==="reg<-mem"?this.operation.src.mode:this.operation.out.mode)==="direct"?yield*super.consumeInstruction(n,"ri.l"):(this.operation.mode==="mem<-reg"||this.operation.mode==="reg<-mem")&&(yield*n.cpu.copyByteRegister("BL","ri.l"))),this.operation.mode==="reg<-imd"&&(yield{type:"cpu:cycle.update",phase:"writeback"},r===8&&typeof s=="string"&&(yield*super.consumeInstruction(n,s)),this.operation.size===16&&(yield*super.consumeInstruction(n,"id.h"))),this.operation.mode==="mem<-imd"&&(yield*super.consumeInstruction(n,"ri.l",!0),this.operation.size===16&&(yield*super.consumeInstruction(n,"id.h"))),i){case"reg<-reg":{if(yield{type:"cpu:cycle.update",phase:"writeback"},r===8)yield{type:"cpu:register.buscopy",src:o,dest:s,size:8};else{const[a,l]=Rx(o),[c,u]=Rx(s);yield{type:"cpu:register.buscopy",src:a,dest:c,size:8},l&&u&&(yield{type:"cpu:register.buscopy",src:l,dest:u,size:8})}return!0}case"reg<-mem":return yield*n.cpu.setMAR("ri"),(yield*n.cpu.useBus("mem-read"))?(yield{type:"cpu:cycle.update",phase:"writeback"},r===8&&(yield*n.cpu.getMBR(s)),!0):!1;case"reg<-imd":return r===16&&(yield*n.cpu.setMBR("id.h")),!0;case"mem<-reg":{const[a]=Rx(o);return yield*n.cpu.setMAR("ri"),yield{type:"cpu:cycle.update",phase:"writeback"},yield*n.cpu.setMBR(a),!!(yield*n.cpu.useBus("mem-write"))}case"mem<-imd":return s.mode==="direct"||(yield*n.cpu.copyByteRegister("BL","ri.l")),yield*n.cpu.setMAR("ri"),yield{type:"cpu:cycle.update",phase:"writeback"},!(!(yield*n.cpu.useBus("mem-write"))||r===16&&(yield*n.cpu.updateWordRegister("ri",a=>a.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("id.h"),!(yield*n.cpu.useBus("mem-write"))));default:return i}}}Jy=new WeakSet,Zj=function(){const{mode:n,out:i,src:r}=this.operation;switch(n){case"reg<-reg":return[i,r];case"reg<-mem":{const s=r.mode==="direct"?r.address.toString():"BL";return[i,`[${s}]`]}case"reg<-imd":return[i,`${r.toString("hex")}h`];case"mem<-reg":return[`[${i.mode==="direct"?i.address.toString():"BL"}]`,r];case"mem<-imd":return[`[${i.mode==="direct"?i.address.toString():"BL"}]`,`${r.toString("hex")}h`];default:return n}};class oQ extends _a{*execute(e){return yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[],willUse:{id:!1}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},!(!(yield*e.cpu.popFromStack("IP.l"))||this.name==="IRET"&&!(yield*e.cpu.popFromStack("FLAGS.l")))}}class aQ extends _a{*execute(e){const n=this.statement.instruction==="PUSH"||this.statement.instruction==="POP"?this.statement.register:"FLAGS";if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:n!=="FLAGS"?[n]:[],willUse:{id:!1}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},this.name==="PUSH"||this.name==="PUSHF"){const i=n==="FLAGS"?"FLAGS.l":`${n[0]}L`;return yield*e.cpu.pushToStack(i)}else{const i=n==="FLAGS"?"FLAGS.l":`${n[0]}L`;return!!(yield*e.cpu.popFromStack(i))}}}function lQ(t){switch(t.instruction){case"MOV":return new sQ(t);case"AND":case"OR":case"XOR":case"ADD":case"ADC":case"SUB":case"SBB":case"CMP":return new QZ(t);case"NOT":case"NEG":case"INC":case"DEC":return new eQ(t);case"IN":case"OUT":return new nQ(t);case"PUSH":case"POP":case"PUSHF":case"POPF":return new aQ(t);case"JC":case"JNC":case"JZ":case"JNZ":case"JS":case"JNS":case"JO":case"JNO":case"JMP":case"CALL":return new iQ(t);case"RET":case"IRET":return new oQ(t);case"INT":return new tQ(t);case"CLI":case"STI":case"NOP":case"HLT":return new rQ(t)}}function cQ(t){for(const[e,n]of tE)if(n.unsigned===t.unsigned)return e;return null}function*uQ(t,e){switch(e){case 0:return yield{type:"cpu:int.0"},!1;case 6:{if(yield{type:"cpu:int.6"},!("keyboard"in t.io))return yield{type:"cpu:error",error:new hn("device-not-connected","keyboard")},!1;if(yield*t.cpu.setMAR("IP"),!(yield*t.cpu.useBus("mem-read"))||(yield*t.cpu.updateWordRegister("IP",r=>r.add(1)),yield*t.cpu.getMBR("IR"),!(yield*t.cpu.pushToStack("AL"))))return!1;const n=t.io.keyboard;if(!n)return yield{type:"cpu:error",error:new hn("device-not-connected","keyboard")},!1;const i=yield*n.readChar();if(yield*t.cpu.updateByteRegister("AL",i),yield*t.cpu.copyByteRegister("BL","ri.l"),yield*t.cpu.setMAR("ri"),yield*t.cpu.setMBR("AL"),!(yield*t.cpu.useBus("mem-write"))||!(yield*t.cpu.popFromStack("AL")))return!1;break}case 7:{if(yield{type:"cpu:int.7"},!("screen"in t.io))return yield{type:"cpu:error",error:new hn("device-not-connected","screen")},!1;if(!(yield*t.cpu.pushToStack("DL")))return!1;let n=216;for(;!t.cpu.getRegister("AL").isZero();){if(yield*t.cpu.copyByteRegister("BL","ri.l"),yield*t.cpu.setMAR("ri"),!(yield*t.cpu.useBus("mem-read"))||(yield*t.cpu.getMBR("DL"),yield*t.cpu.updateByteRegister("ri.l",H.fromUnsigned(n,8)),yield*t.cpu.setMAR("ri"),yield*t.cpu.setMBR("DL"),!(yield*t.cpu.useBus("mem-write"))))return!1;const i=t.cpu.getRegister("DL");if(t.io.screen)yield*t.io.screen.sendChar(i);else return yield{type:"cpu:error",error:new hn("device-not-connected","screen")},!1;n++,yield*t.cpu.copyByteRegister("BL","left.l"),yield*t.cpu.updateWordRegister("right",H.fromUnsigned(1,16));const r=t.cpu.getRegister("BX").add(1);yield*t.cpu.aluExecute("ADD",r,{CF:!1,OF:r.signed<0,SF:r.signed<0,ZF:!1}),yield*t.cpu.copyByteRegister("result.l","BL"),yield*t.cpu.copyByteRegister("AL","left.l"),yield*t.cpu.updateByteRegister("right.l",H.fromUnsigned(1,8));const s=t.cpu.getRegister("AL").add(-1);yield*t.cpu.aluExecute("SUB",s,{CF:!1,OF:s.signed===H.maxSignedValue(8),SF:s.signed<0,ZF:s.isZero()}),yield*t.cpu.copyByteRegister("result.l","AL")}if(!(yield*t.cpu.popFromStack("DL")))return!1;break}default:throw new Error("Invalid interrupt number")}return!(!(yield*t.cpu.popFromStack("IP.l"))||!(yield*t.cpu.popFromStack("FLAGS.l")))}var Ld,ct,Vr,Xi,Pn,$u,Fr,x4;let dQ=(x4=class extends Us{constructor(n){super(n);Ue(this,Pn);Ue(this,Ld);Ue(this,ct);Ue(this,Vr);Ue(this,Xi);n.data==="unchanged"?(ie(this,ct,N(n.previous.cpu,ct)),ie(this,Vr,N(n.previous.cpu,Vr)),ie(this,Xi,N(n.previous.cpu,Xi))):(ie(this,ct,{AX:H.zero(16),BX:H.zero(16),CX:H.zero(16),DX:H.zero(16),SP:H.zero(16),IP:H.zero(16),IR:H.zero(8),ri:H.zero(16),id:H.zero(16),left:H.zero(16),right:H.zero(16),result:H.zero(16),FLAGS:H.zero(16)}),ie(this,Vr,H.zero(16)),ie(this,Xi,H.zero(8))),N(this,ct).SP=H.fromUnsigned(Pe.MAX_ADDRESS,16);const i=n.program.instructions.some(u=>u.isInstruction()&&u.instruction==="INT"),r=n.hasORG20hAtStart??!1,s=n.hasINTOrInterruptDevices??i,o=n.devices.pic,a=n.program.instructions.length>0?n.program.instructions[0]:null,l=a?typeof a.start=="number"?a.start:a.start.value:0;console.log("DEBUG CPU:",{hasINT:i,hasORG20hAtStart:r,hasORG:n.hasORG,hasINTOrInterruptDevices:s,hasPICConfig:o,firstInstructionAddress:"0x"+l.toString(16).padStart(2,"0"),devices:n.devices,instructionsCount:n.program.instructions.length,firstFewInstructions:n.program.instructions.slice(0,3).map(u=>({type:u.type,instruction:u.isInstruction()?u.instruction:"not-instruction",start:"0x"+(typeof u.start=="number"?u.start:u.start.value).toString(16).padStart(2,"0")}))});let c;r?(c=32,console.log("IP set to 0x20 (hasORG20hAtStart)")):(s||o)&&l>=8?(c=8,console.log("IP set to 0x08 (INT/PIC + code at 08h+)")):(c=l,console.log(`IP set to 0x${c.toString(16).padStart(2,"0")} (first instruction address)`)),N(this,ct).IP=H.fromUnsigned(c,16),N(this,ct).ri=H.fromUnsigned(0,16),N(this,ct).id=H.fromUnsigned(0,16),Ut(this,Pn,Fr).call(this,"IF",!0),ie(this,Ld,new Map);for(const u of n.program.instructions){const d=lQ(u);N(this,Ld).set(d.start.value,d)}}*run(){var n;for(;;){const i=N(this,ct).IP,r=cQ(i);if(r!==null){if(!(yield*uQ(this.computer,r)))return}else{const s=N(this,Ld).get(i.unsigned);if(!s){yield{type:"cpu:error",error:new hn("no-instruction",N(this,ct).IP)};return}if(!(yield*s.execute(this.computer)))return}if(this.getFlag("IF")&&((n=this.computer.io.pic)!=null&&n.isINTRActive())){yield{type:"cpu:cycle.interrupt"};const s=yield*this.computer.io.pic.handleINTR();yield*this.getMBR("ri.l"),yield*this.updateByteRegister("ri.h",H.zero(8)),yield*this.startInterrupt(s)}yield{type:"cpu:cycle.end"}}}*startInterrupt(n){if(!(yield*this.pushToStack("FLAGS.l"))||(yield*this.updateFLAGS({IF:!1}),!(yield*this.pushToStack("IP.l"))))return!1;const i=H.fromUnsigned(n.unsigned,8);return yield*this.updateByteRegister("ri.l",i),yield*this.copyByteRegister("ri.l","IP.l"),yield*this.setMAR("ri"),(yield*this.useBus("mem-read"))?(yield*this.getMBR("IP.l"),!0):!1}toJSON(){return{...Object.entries(N(this,ct)).reduce((i,[r,s])=>({...i,[r]:s.toJSON()}),{}),MAR:N(this,Vr).toJSON(),MBR:N(this,Xi).toJSON()}}getRegister(n){const[i,r]=z2(n);return r==="low"?N(this,ct)[i].low:r==="high"?N(this,ct)[i].high:N(this,ct)[i]}*copyByteRegister(n,i){const r=this.getRegister(n);Ut(this,Pn,$u).call(this,i,r),yield{type:"cpu:register.copy",size:8,src:n,dest:i}}*copyWordRegister(n,i){const r=this.getRegister(n);Ut(this,Pn,$u).call(this,i,r.withHigh(H.zero(8))),yield{type:"cpu:register.copy",size:16,src:n,dest:i}}*updateByteRegister(n,i){i=typeof i=="function"?i(this.getRegister(n)):i,Ut(this,Pn,$u).call(this,n,i),yield{type:"cpu:register.update",size:8,register:n,value:i}}*updateWordRegister(n,i){i=typeof i=="function"?i(this.getRegister(n)):i,Ut(this,Pn,$u).call(this,n,i),yield{type:"cpu:register.update",size:16,register:n,value:i}}getFlag(n){switch(n){case"CF":return N(this,ct).FLAGS.bit(1);case"ZF":return N(this,ct).FLAGS.bit(0);case"SF":return N(this,ct).FLAGS.bit(3);case"IF":return N(this,ct).FLAGS.bit(4);case"OF":return N(this,ct).FLAGS.bit(2);default:throw new TypeError(`Invalid flag ${n}`)}}*updateFLAGS(n){typeof n.CF=="boolean"&&Ut(this,Pn,Fr).call(this,"CF",n.CF),typeof n.ZF=="boolean"&&Ut(this,Pn,Fr).call(this,"ZF",n.ZF),typeof n.SF=="boolean"&&Ut(this,Pn,Fr).call(this,"SF",n.SF),typeof n.IF=="boolean"&&Ut(this,Pn,Fr).call(this,"IF",n.IF),typeof n.OF=="boolean"&&Ut(this,Pn,Fr).call(this,"OF",n.OF),yield{type:"cpu:register.update",size:16,register:"FLAGS",value:N(this,ct).FLAGS}}*aluExecute(n,i,r){N(this,ct).result=i.is8bits()?N(this,ct).result.withLow(i):i,typeof r.CF=="boolean"&&Ut(this,Pn,Fr).call(this,"CF",r.CF),typeof r.ZF=="boolean"&&Ut(this,Pn,Fr).call(this,"ZF",r.ZF),typeof r.SF=="boolean"&&Ut(this,Pn,Fr).call(this,"SF",r.SF),typeof r.IF=="boolean"&&Ut(this,Pn,Fr).call(this,"IF",r.IF),typeof r.OF=="boolean"&&Ut(this,Pn,Fr).call(this,"OF",r.OF),yield{type:"cpu:alu.execute",operation:n,size:i.size,result:N(this,ct).result,flags:N(this,ct).FLAGS}}*setMAR(n){const i=this.getRegister(n);ie(this,Vr,i.withHigh(H.zero(8))),yield{type:"cpu:mar.set",register:n}}*getMBR(n){Ut(this,Pn,$u).call(this,n,N(this,Xi)),yield{type:"cpu:mbr.get",register:n}}*setMBR(n){const i=this.getRegister(n);ie(this,Xi,i),yield{type:"cpu:mbr.set",register:n}}*useBus(n){switch(n){case"mem-read":{yield{type:"cpu:rd.on"};const i=yield*this.computer.memory.read(N(this,Vr));return i?(ie(this,Xi,i),yield{type:"bus:reset"},!0):!1}case"mem-write":return yield{type:"cpu:wr.on"},(yield*this.computer.memory.write(N(this,Vr),N(this,Xi)))?(yield{type:"bus:reset"},!0):!1;case"io-read":{yield{type:"cpu:iom.on"};const i=yield*this.computer.io.chipSelect(N(this,Vr).low);if(!i)return!1;yield{type:"cpu:rd.on"};const r=yield*this.computer.io.read(i);return r?(ie(this,Xi,r),yield{type:"bus:reset"},!0):!1}case"io-write":{yield{type:"cpu:iom.on"};const i=yield*this.computer.io.chipSelect(N(this,Vr).low);return!i||(yield{type:"cpu:wr.on"},!(yield*this.computer.io.write(i,N(this,Xi))))?!1:(yield{type:"bus:reset"},!0)}case"intr-read":{if(!this.computer.io.pic)return!1;const i=yield*this.computer.io.pic.handleINTR();return ie(this,Xi,i),yield{type:"bus:reset"},!0}default:return n}}*pushToStack(n){let i=this.getRegister("SP");return Pe.inRange(i.unsigned-1)?(i=i.add(-1),yield*this.updateWordRegister("SP",i),yield*this.setMBR(n),yield*this.setMAR("SP"),(yield*this.useBus("mem-write"))?Pe.inRange(i.unsigned-1)?!0:(yield{type:"cpu:error",error:new hn("stack-overflow")},!1):!1):(yield{type:"cpu:error",error:new hn("stack-overflow")},!1)}*popFromStack(n){let i=this.getRegister("SP");return Pe.inRange(i)?(yield*this.setMAR("SP"),(yield*this.useBus("mem-read"))?(yield*this.getMBR(n),i=i.add(1),yield*this.updateWordRegister("SP",i),!0):!1):(yield{type:"cpu:error",error:new hn("stack-underflow")},!1)}},Ld=new WeakMap,ct=new WeakMap,Vr=new WeakMap,Xi=new WeakMap,Pn=new WeakSet,$u=function(n,i){const[r,s]=z2(n);if(s===null){if(N(this,ct)[r].size!==i.size)throw new TypeError(`Cannot set register ${n} with value ${i} of different size`);N(this,ct)[r]=i}else{if(!i.is8bits())throw new TypeError(`Cannot set register ${n} with value ${i} of different size`);s==="low"?N(this,ct)[r]=N(this,ct)[r].withLow(i):N(this,ct)[r]=N(this,ct)[r].withHigh(i)}},Fr=function(n,i){switch(n){case"CF":N(this,ct).FLAGS=N(this,ct).FLAGS.withBit(1,i);return;case"ZF":N(this,ct).FLAGS=N(this,ct).FLAGS.withBit(0,i);return;case"SF":N(this,ct).FLAGS=N(this,ct).FLAGS.withBit(3,i);return;case"IF":N(this,ct).FLAGS=N(this,ct).FLAGS.withBit(4,i);return;case"OF":N(this,ct).FLAGS=N(this,ct).FLAGS.withBit(2,i);return;default:throw new TypeError(`Invalid flag ${n}`)}},x4);var hl,mr,Jo,tl;let Qj=(hl=class extends Us{constructor(n){super(n);Ue(this,mr);Ue(this,Jo);Ue(this,tl,!1);n.data==="unchanged"&&n.previous.io.printer?(ie(this,mr,N(n.previous.io.printer,mr)),ie(this,Jo,N(n.previous.io.printer,Jo)),ie(this,tl,N(n.previous.io.printer,tl))):(ie(this,mr,[]),ie(this,Jo,""),ie(this,tl,!1))}get busy(){return N(this,mr).length>=hl.BUFFER_SIZE}*setStrobe(n){const i=N(this,tl);if(i===n)return;if(ie(this,tl,n),n?yield{type:"printer:strobe.on"}:yield{type:"printer:strobe.off"},n&&!i&&!this.busy){const s=yield*this.readData();N(this,mr).push(s),yield{type:"printer:buffer.add",char:s},yield*this.updateBusy(!0),this.busy||(yield*this.updateBusy(!1))}}*clear(){ie(this,Jo,""),yield{type:"printer:paper.replace"}}*print(){if(N(this,mr).length===0)return;const[n,...i]=N(this,mr);if(ie(this,mr,i),yield{type:"printer:buffer.pop",char:n},i.length===hl.BUFFER_SIZE-1&&(yield*this.updateBusy(!1)),n.unsigned===12)yield*this.clear();else{const r=eE(n.unsigned);ie(this,Jo,N(this,Jo)+r),yield{type:"printer:paper.print",char:r}}}get hasPending(){return N(this,mr).length>0}toJSON(){return{paper:N(this,Jo),buffer:[...N(this,mr).map(n=>n.unsigned)]}}},mr=new WeakMap,Jo=new WeakMap,tl=new WeakMap,be(hl,"BUFFER_SIZE",5),hl);class Db extends Us{}let e8=class extends Db{constructor(n){super(n);be(this,"PA");be(this,"PB");be(this,"CA");be(this,"CB");be(this,"leds",null);be(this,"printer",null);be(this,"switches",null);n.data==="unchanged"&&n.previous.io.pio?(this.PA=n.previous.io.pio.PA,this.PB=n.previous.io.pio.PB,this.CA=n.previous.io.pio.CA,this.CB=n.previous.io.pio.CB):n.data==="randomize"?(this.PA=H.random(8),this.PB=H.random(8),this.CA=H.random(8),this.CB=H.random(8)):(this.PA=H.zero(8),this.PB=H.zero(8),this.CA=H.zero(8),this.CB=H.zero(8))}chipSelect(n){return n=Number(n),n===48?"PA":n===49?"PB":n===50?"CA":n===51?"CB":null}*read(n){yield{type:"pio:read",register:n};let i;if(n==="PA")i=this.PA;else if(n==="PB")i=this.PB;else if(n==="CA")i=this.CA;else if(n==="CB")i=this.CB;else return n;return yield{type:"pio:read.ok",value:i},i}*write(n,i){if(yield{type:"pio:write",register:n,value:i},n==="PA")this.PA=i;else if(n==="PB")this.PB=i;else if(n==="CA")this.CA=i;else if(n==="CB")this.CB=i;else return n;yield{type:"pio:register.update",register:n,value:i},n==="PA"||n==="CA"?yield*this.updatePort("A"):yield*this.updatePort("B"),yield{type:"pio:write.ok"}}line(n,i){return n==="A"?this.CA.bit(i)?"input":"output":this.CB.bit(i)?"input":"output"}toJSON(){return{PA:this.PA.toJSON(),PB:this.PB.toJSON(),CA:this.CA.toJSON(),CB:this.CB.toJSON()}}};class LR extends e8{constructor(e){super(e),this.PA=this.PA.withBit(1,!1);const n=this;this.printer=new class extends Qj{*readData(){const i=n.readData();return yield{type:"printer:data.read",char:i},i}*updateBusy(i){i?yield{type:"printer:busy.on"}:yield{type:"printer:busy.off"},yield*n.updatePort("A")}}(e)}readData(){const e=this.PB.unsigned&~this.CB.unsigned;return H.fromUnsigned(e,8)}*updatePort(e){if(e==="B")return;let n=this.PA.unsigned;const i=this.CA.unsigned,r=this.printer.busy;n=n&~i,this.line("A",0)==="input"&&r&&(n|=1),n!==this.PA.unsigned&&(this.PA=H.fromUnsigned(n,8),yield{type:"pio:register.update",register:"PA",value:this.PA}),this.line("A",1)==="output"&&(yield*this.printer.setStrobe(this.PA.bit(1)))}}var Zo,w4;let fQ=(w4=class extends Us{constructor(n){super(n);Ue(this,Zo);n.data==="unchanged"&&n.previous.io.leds?ie(this,Zo,N(n.previous.io.leds,Zo)):n.data==="randomize"?ie(this,Zo,H.random(8)):ie(this,Zo,H.zero(8))}get state(){return N(this,Zo)}*update(n){yield{type:"leds:update",state:n}}toJSON(){return N(this,Zo).toJSON()}},Zo=new WeakMap,w4);var Hr,S4;let hQ=(S4=class extends Us{constructor(n){super(n);Ue(this,Hr);n.data==="unchanged"&&n.previous.io.switches?ie(this,Hr,N(n.previous.io.switches,Hr)):n.data==="randomize"?ie(this,Hr,H.random(8)):ie(this,Hr,H.zero(8))}get state(){return N(this,Hr)}*toggle(n){ie(this,Hr,N(this,Hr).withBit(n,!N(this,Hr).bit(n))),yield{type:"switches:toggle",index:n}}toJSON(){return N(this,Hr).toJSON()}},Hr=new WeakMap,S4);class pQ extends e8{constructor(e){super(e);const n=this;this.leds=new class extends fQ{}(e),this.switches=new class extends hQ{*toggle(i){yield*super.toggle(i),yield*n.updatePort("A")}}(e)}*updatePort(e){if(e==="A"){const n=this.switches.state.unsigned;let i=this.PA.unsigned;const r=this.CA.unsigned;i=n&r|i&~r,i!==this.PA.unsigned&&(this.PA=H.fromUnsigned(i,8),yield{type:"pio:register.update",register:"PA",value:this.PA})}else{let n=this.PB.unsigned;const i=this.CB.unsigned;n=n&~i,yield*this.leds.update(H.fromUnsigned(n,8))}}}let mQ=class extends Us{*tick(){yield{type:"clock:tick"},this.computer.io.timer&&(yield*this.computer.io.timer.tick())}toJSON(){return null}},gQ=class extends Us{*press(){yield{type:"f10:press"},this.computer.io.pic&&(yield*this.computer.io.pic.interrupt(0))}toJSON(){return null}};var Dd,k4;let vQ=(k4=class extends Us{constructor(){super(...arguments);Ue(this,Dd,null)}*readChar(){yield{type:"keyboard:listen-key"};const n=N(this,Dd);if(!n)throw new Error("INT 6 was not given a valid 8-bit character!");return yield{type:"keyboard:read",char:n},ie(this,Dd,null),n}setLastCharRead(n){ie(this,Dd,n)}toJSON(){return null}},Dd=new WeakMap,k4);var gr,_4;let yQ=(_4=class extends Us{constructor(n){super(n);Ue(this,gr);n.data==="unchanged"&&n.previous.io.screen?ie(this,gr,N(n.previous.io.screen,gr)):ie(this,gr,"")}clear(){return this.sendChar(H.fromUnsigned(12,8))}*sendChar(n){switch(n.unsigned){case 8:ie(this,gr,N(this,gr).slice(0,-1));break;case 10:ie(this,gr,N(this,gr)+`
`);break;case 12:ie(this,gr,"");break;default:ie(this,gr,N(this,gr)+eE(n.unsigned));break}yield{type:"screen:send-char",char:n,output:N(this,gr)}}toJSON(){return N(this,gr)}},gr=new WeakMap,_4);var Qo,Ai,C4;let bQ=(C4=class extends Db{constructor(n){super(n);Ue(this,Qo);Ue(this,Ai);be(this,"printer");n.data==="randomize"?ie(this,Qo,H.random(8)):ie(this,Qo,H.zero(8)),ie(this,Ai,H.zero(8));const i=this;this.printer=new class extends Qj{*readData(){const r=N(i,Qo);return yield{type:"printer:data.read",char:r},r}*updateBusy(r){r?yield{type:"printer:busy.on"}:yield{type:"printer:busy.off"},yield*i.updateBusy(r)}}(n)}get interrupts(){return N(this,Ai).bit(7)}chipSelect(n){return n=Number(n),n===64?"DATA":n===65?"STATE":null}*read(n){yield{type:"handshake:read",register:n};let i;if(n==="DATA")i=N(this,Qo);else if(n==="STATE")i=N(this,Ai);else return n;return yield{type:"handshake:read.ok",value:i},i}*write(n,i){if(yield{type:"handshake:write",register:n,value:i},n==="DATA")ie(this,Qo,i),yield{type:"handshake:register.update",register:n,value:i},yield*this.printer.setStrobe(!0),yield*this.printer.setStrobe(!1);else if(n==="STATE")i=i.withBit(0,this.printer.busy),ie(this,Ai,i),yield{type:"handshake:register.update",register:n,value:i},N(this,Ai).bit(1)?(yield*this.printer.setStrobe(!0),yield*this.printer.setStrobe(!1),ie(this,Ai,N(this,Ai).withBit(1,!1)),yield{type:"handshake:register.update",register:n,value:N(this,Ai)}):this.interrupts&&!this.printer.busy?(yield{type:"handshake:int.on"},this.computer.io.pic&&(yield*this.computer.io.pic.interrupt(2))):yield{type:"handshake:int.off"};else return n;yield{type:"handshake:write.ok"}}*updateBusy(n){ie(this,Ai,N(this,Ai).withBit(0,n)),yield{type:"handshake:register.update",register:"STATE",value:N(this,Ai)},this.interrupts&&!n?(yield{type:"handshake:int.on"},this.computer.io.pic&&(yield*this.computer.io.pic.interrupt(2))):yield{type:"handshake:int.off"}}toJSON(){return{DATA:N(this,Qo).toJSON(),STATE:N(this,Ai).toJSON()}}},Qo=new WeakMap,Ai=new WeakMap,C4);var Ns,ea,Yi,Pi,_s,Ao,G0,q0;let xQ=(Ns=class extends Db{constructor(n){super(n);Ue(this,Ao);Ue(this,ea);Ue(this,Yi);Ue(this,Pi);Ue(this,_s);ie(this,ea,H.fromUnsigned(255,8)),ie(this,Yi,H.fromUnsigned(0,8)),ie(this,Pi,H.fromUnsigned(0,8)),n.data==="unchanged"&&n.previous.io.pic?ie(this,_s,N(n.previous.io.pic,_s)):n.data==="randomize"?ie(this,_s,new Array(Ns.LINES).fill(H.zero(8)).map(()=>H.random(8))):ie(this,_s,new Array(Ns.LINES).fill(H.zero(8)))}chipSelect(n){const r=4+Ns.LINES;return n=Number(n)-32,n<0||n>=r?null:n===0?"EOI":n===1?"IMR":n===2?"IRR":n===3?"ISR":`INT${n-4}`}*read(n){yield{type:"pic:read",register:n};let i;if(n==="EOI")i=H.zero(8);else if(n==="IMR")i=N(this,ea);else if(n==="IRR")i=N(this,Yi);else if(n==="ISR")i=N(this,Pi);else{const r=Number(n.slice(3));i=N(this,_s)[r]}return yield{type:"pic:read.ok",value:i},i}*write(n,i){if(yield{type:"pic:write",register:n,value:i},n==="EOI")N(this,Pi).isZero()||(yield{type:"pic:intr.off"},ie(this,Pi,H.zero(8)),yield{type:"pic:register.update",register:"ISR",value:N(this,Pi)},yield*Ut(this,Ao,q0).call(this));else if(n==="IMR")ie(this,ea,i),yield{type:"pic:register.update",register:"IMR",value:N(this,ea)},yield*Ut(this,Ao,q0).call(this);else if(!(n==="IRR"||n==="ISR")){const r=Number(n.slice(3));N(this,_s)[r]=i,yield{type:"pic:register.update",register:n,value:i}}yield{type:"pic:write.ok"}}*interrupt(n){if(n<0||n>=Ns.LINES)throw new RangeError(`Invalid interrupt line ${n}`);N(this,Yi).bit(n)||(ie(this,Yi,N(this,Yi).withBit(n,!0)),yield{type:"pic:register.update",register:"IRR",value:N(this,Yi)},yield*Ut(this,Ao,q0).call(this))}isINTRActive(){return N(this,Pi).isZero()&&Ut(this,Ao,G0).call(this)!==null}*handleINTR(){if(yield{type:"cpu:inta.on"},!N(this,Pi).isZero())throw new Error("INTR line is active but ISR is not zero");const n=Ut(this,Ao,G0).call(this);if(n===null)throw new Error("INTR line is active but no interrupt is pending");ie(this,Pi,N(this,Pi).withBit(n,!0)),yield{type:"pic:register.update",register:"ISR",value:N(this,Pi)},ie(this,Yi,N(this,Yi).withBit(n,!1)),yield{type:"pic:register.update",register:"IRR",value:N(this,Yi)},yield{type:"cpu:inta.off"},yield{type:"cpu:inta.on"};const i=N(this,_s)[n];return yield{type:"pic:int.send",number:i},yield{type:"cpu:inta.off"},yield{type:"pic:intr.off"},i}toJSON(){return{IMR:N(this,ea).toJSON(),IRR:N(this,Yi).toJSON(),ISR:N(this,Pi).toJSON(),lines:N(this,_s).map(n=>n.toJSON())}}},ea=new WeakMap,Yi=new WeakMap,Pi=new WeakMap,_s=new WeakMap,Ao=new WeakSet,G0=function(){for(let n=0;n<Ns.LINES;n++)if(N(this,Yi).bit(n)&&!N(this,ea).bit(n))return n;return null},q0=function*(){N(this,Pi).isZero()&&Ut(this,Ao,G0).call(this)!==null&&(yield{type:"pic:intr.on"})},be(Ns,"LINES",8),Ns);var ro,nl,E4;let wQ=(E4=class extends Db{constructor(n){super(n);Ue(this,ro);Ue(this,nl);ie(this,ro,H.zero(8)),ie(this,nl,H.zero(8))}chipSelect(n){return n=Number(n),n===16?"CONT":n===17?"COMP":null}*read(n){yield{type:"timer:read",register:n};let i;if(n==="CONT")i=N(this,ro);else if(n==="COMP")i=N(this,nl);else return n;return yield{type:"timer:read.ok",value:i},i}*write(n,i){if(yield{type:"timer:write",register:n,value:i},n==="CONT")ie(this,ro,i);else if(n==="COMP")ie(this,nl,i);else return n;yield{type:"timer:register.update",register:n,value:i},yield{type:"timer:write.ok"}}*tick(){const n=N(this,ro).unsigned===H.maxValue(8)?H.zero(8):N(this,ro).add(1);ie(this,ro,n),yield{type:"timer:register.update",register:"CONT",value:n},N(this,nl).equals(n)?(yield{type:"timer:int.on"},this.computer.io.pic&&(yield*this.computer.io.pic.interrupt(1))):yield{type:"timer:int.off"}}toJSON(){return{CONT:N(this,ro).toJSON(),COMP:N(this,nl).toJSON()}}},ro=new WeakMap,nl=new WeakMap,E4);class SQ extends Us{constructor(n){super(n);be(this,"clock",null);be(this,"f10",null);be(this,"keyboard",null);be(this,"screen",null);be(this,"handshake",null);be(this,"pic",null);be(this,"pio",null);be(this,"timer",null);if(n.devices.keyboardAndScreen&&(this.keyboard=new vQ(n),this.screen=new yQ(n)),n.devices.pic&&(this.clock=new mQ(n),this.f10=new gQ(n),this.timer=new wQ(n),this.pic=new xQ(n)),this.pio=n.devices.pio==="switches-and-leds"?new pQ(n):n.devices.pio==="printer"?new LR(n):null,n.devices.handshake){if(this.pio instanceof LR)throw new hn("io-printer-conflict");this.handshake=new bQ(n)}}get leds(){var n;return((n=this.pio)==null?void 0:n.leds)??null}get printer(){var n,i;return((n=this.pio)==null?void 0:n.printer)??((i=this.handshake)==null?void 0:i.printer)??null}get switches(){var n;return((n=this.pio)==null?void 0:n.switches)??null}*chipSelect(n){var a,l,c,u;const i=(a=this.handshake)==null?void 0:a.chipSelect(n);if(i)return yield{type:"bus:io.selected",chip:"handshake"},{chip:"handshake",register:i};const r=(l=this.pic)==null?void 0:l.chipSelect(n);if(r)return yield{type:"bus:io.selected",chip:"pic"},{chip:"pic",register:r};const s=(c=this.pio)==null?void 0:c.chipSelect(n);if(s)return yield{type:"bus:io.selected",chip:"pio"},{chip:"pio",register:s};const o=(u=this.timer)==null?void 0:u.chipSelect(n);return o?(yield{type:"bus:io.selected",chip:"timer"},{chip:"timer",register:o}):(yield{type:"bus:io.error",error:new hn("io-memory-not-connected",n)},null)}*read(n){const{chip:i,register:r}=n;return this[i]?yield*this[i].read(r):(yield{type:"bus:io.error",error:new hn("device-not-connected",i)},null)}*write(n,i){const{chip:r,register:s}=n;return this[r]?(yield*this[r].write(s,i),!0):(yield{type:"bus:io.error",error:new hn("device-not-connected",r)},!1)}toJSON(){var n,i,r,s,o,a,l,c,u,d,f;return{clock:((n=this.clock)==null?void 0:n.toJSON())??null,f10:((i=this.f10)==null?void 0:i.toJSON())??null,keyboard:((r=this.keyboard)==null?void 0:r.toJSON())??null,leds:((s=this.leds)==null?void 0:s.toJSON())??null,printer:((o=this.printer)==null?void 0:o.toJSON())??null,screen:((a=this.screen)==null?void 0:a.toJSON())??null,switches:((l=this.switches)==null?void 0:l.toJSON())??null,handshake:((c=this.handshake)==null?void 0:c.toJSON())??null,pic:((u=this.pic)==null?void 0:u.toJSON())??null,pio:((d=this.pio)==null?void 0:d.toJSON())??null,timer:((f=this.timer)==null?void 0:f.toJSON())??null}}}var pl,Ni,jd,Bd;let kQ=(pl=class extends Us{constructor(n){super(n);Ue(this,Ni);Ue(this,jd);Ue(this,Bd);n.data==="unchanged"?ie(this,Ni,N(n.previous.memory,Ni)):n.data==="randomize"?ie(this,Ni,new Uint8Array(pl.SIZE).map(()=>H.random(8).unsigned)):ie(this,Ni,new Uint8Array(pl.SIZE).fill(0)),N(this,Ni)[255]=1;const i=n.program.instructions.some(r=>r.instruction==="INT");if(ie(this,Bd,new Set),i)for(const[r,s]of tE){const o=r;if(N(this,Ni)[o]=s.unsigned,N(this,Bd).add(o),r===6){const a=[208,216,48,18,1,193,193,216,49,212,65,225],l=s.unsigned;for(let c=0;c<a.length;c++)N(this,Ni)[l+c]=a[c],N(this,Bd).add(l+c)}}for(const r of n.program.data){let s=r.start.value;for(const o of r.getValues())o!==_h&&N(this,Ni).set(o.toUint8Array(),s),s+=r.size/8}ie(this,jd,new Set);for(const r of n.program.instructions){N(this,Ni).set(r.toBytes(),r.start.value);for(let s=0;s<r.length;s++)N(this,jd).add(r.start.value+s)}}*read(n){if(n=Number(n),yield{type:"memory:read",address:n},!Pe.inRange(n))return yield{type:"memory:read.error",error:new hn("address-out-of-range",n)},null;const i=H.fromUnsigned(N(this,Ni).at(n),8);return yield{type:"memory:read.ok",address:Pe.from(n),value:i},i}*write(n,i){return n=Number(n),yield{type:"memory:write",address:n,value:i},Pe.inRange(n)?(N(this,jd).has(n)&&(yield{type:"memory:write.warning",warning:`Sobrescribiendo instrucción en la dirección ${Pe.format(n)}`},console.warn(`Advertencia: Sobrescribiendo instrucción en la dirección ${Pe.format(n)}`)),N(this,Ni).set([i.unsigned],n),yield{type:"memory:write.ok",address:Pe.from(n),value:i},!0):(yield{type:"memory:write.error",error:new hn("address-out-of-range",n)},!1)}toJSON(){return[...N(this,Ni)]}},Ni=new WeakMap,jd=new WeakMap,Bd=new WeakMap,be(pl,"SIZE",Pe.MAX_ADDRESS+1),pl);class DR{constructor(e){be(this,"cpu");be(this,"memory");be(this,"io");const n={computer:this,...e};this.cpu=new dQ(n),this.memory=new kQ(n),this.io=new SQ(n)}toJSON(){return{cpu:this.cpu.toJSON(),memory:this.memory.toJSON(),io:this.io.toJSON()}}}var Rt;class _Q{constructor(){Ue(this,Rt,new DR({program:{data:[],instructions:[]},devices:{keyboardAndScreen:!1,pic:!1,pio:null,handshake:null},data:"clean"}))}loadProgram(e){ie(this,Rt,new DR({...e,previous:N(this,Rt)}))}getComputerState(){var e;return((e=N(this,Rt))==null?void 0:e.toJSON())||null}startCPU(){if(!N(this,Rt))throw new hn("no-program");return N(this,Rt).cpu.run()}get devices(){if(!N(this,Rt))throw new Error("No computer loaded!");return{clock:{connected:()=>N(this,Rt).io.clock!==null,tick:()=>{if(N(this,Rt).io.clock)return N(this,Rt).io.clock.tick();console.warn("Called clock.tick() when no clock was connected to the computer")}},f10:{connected:()=>"f10"in N(this,Rt).io,press:()=>{if(N(this,Rt).io.f10)return N(this,Rt).io.f10.press();console.warn("Called f10.press() when no f10 was connected to the computer")}},keyboard:{connected:()=>"keyboard"in N(this,Rt).io,readChar:e=>{if(N(this,Rt).io.keyboard)return N(this,Rt).io.keyboard.setLastCharRead(e);console.warn("Called keyboard.press() when no keyboard was connected to the computer")}},leds:{connected:()=>"leds"in N(this,Rt).io},printer:{connected:()=>N(this,Rt).io.printer!==null,clear:()=>{if(N(this,Rt).io.printer)return N(this,Rt).io.printer.clear();console.warn("No printer connected to the computer!")},print:()=>{if(N(this,Rt).io.printer)return N(this,Rt).io.printer.print();console.warn("No printer connected to the computer!")},hasPending:()=>{var e;return((e=N(this,Rt).io.printer)==null?void 0:e.hasPending)??!1}},screen:{connected:()=>"screen"in N(this,Rt).io,clear:()=>{if(N(this,Rt).io.screen)return N(this,Rt).io.screen.clear();console.warn("Called screen.clear() when no screen was connected to the computer")}},switches:{connected:()=>"switches"in N(this,Rt).io,toggle:e=>{if(N(this,Rt).io.switches)return N(this,Rt).io.switches.toggle(e);console.warn("Called switches.toggle() when no switches were connected to the computer")}}}}}Rt=new WeakMap;const Ix=pe(H.zero(16)),Tx=pe(H.zero(16)),CQ=pe(H.zero(8)),Ox=pe(H.zero(16)),Lx=pe(H.zero(16)),Dx=pe(H.zero(16)),jx=pe(H.zero(16)),Bx=pe(H.zero(16)),$x=pe(H.zero(16)),Ei=pe(H.zero(16)),Yn=pe(H.zero(8)),Je=pe(""),af=pe(0),zp=pe(0),Dt=pe(0),jb=pe(!1),t8=pe(!1),Bl=pe(0),ws=pe([]),sE=pe(!1);pe(!0);pe(!0);const oE=pe(!1),Bb=pe(!1),na=pe({canAnimate:!0,pendingMessage:null}),Ta=t=>pe(e=>e(t).low,(e,n,i)=>{const r=e(t),s=typeof i=="function"?i(r.low):i;n(t,r.withLow(s))}),Oa=t=>pe(e=>e(t).high,(e,n,i)=>{const r=e(t),s=typeof i=="function"?i(r.high):i;n(t,r.withHigh(s))}),he={AL:pe(H.zero(8)),BL:pe(H.zero(8)),CL:pe(H.zero(8)),DL:pe(H.zero(8)),SP:Ix,"SP.l":Ta(Ix),"SP.h":Oa(Ix),IP:Tx,"IP.l":Ta(Tx),"IP.h":Oa(Tx),IR:CQ,ri:Ox,"ri.l":Ta(Ox),"ri.h":Oa(Ox),id:Lx,"id.l":Ta(Lx),"id.h":Oa(Lx),left:Dx,"left.l":Ta(Dx),"left.h":Oa(Dx),right:jx,"right.l":Ta(jx),"right.h":Oa(jx),result:Bx,"result.l":Ta(Bx),"result.h":Oa(Bx),FLAGS:$x,"FLAGS.l":Ta($x),"FLAGS.h":Oa($x),MAR:Ei,MBR:Yn},Hn=pe({phase:"stopped"}),aE=pe("ADD");function n8(t,e=!1){e?(P.set(he.AL,H.zero(8)),P.set(he.BL,H.zero(8)),P.set(he.CL,H.zero(8)),P.set(he.DL,H.zero(8)),P.set(he.SP,H.fromUnsigned(255,16)),P.set(he.IP,H.zero(16)),P.set(he.IR,H.zero(8)),P.set(he.ri,H.zero(16)),P.set(he.id,H.zero(16)),P.set(he.left,H.zero(16)),P.set(he.right,H.zero(16)),P.set(he.result,H.zero(16)),P.set(he.FLAGS,H.zero(16)),P.set(he.MAR,H.zero(16)),P.set(he.MBR,H.zero(8))):(P.set(he.AL,H.fromUnsigned(t.cpu.AX&255,8)),P.set(he.BL,H.fromUnsigned(t.cpu.BX&255,8)),P.set(he.CL,H.fromUnsigned(t.cpu.CX&255,8)),P.set(he.DL,H.fromUnsigned(t.cpu.DX&255,8)),P.set(he.SP,H.fromUnsigned(t.cpu.SP,16)),P.set(he.IP,H.fromUnsigned(t.cpu.IP,16)),P.set(he.IR,H.fromUnsigned(t.cpu.IR,8)),P.set(he.ri,H.fromUnsigned(t.cpu.ri,16)),P.set(he.id,H.fromUnsigned(t.cpu.id,16)),P.set(he.left,H.fromUnsigned(t.cpu.left,16)),P.set(he.right,H.fromUnsigned(t.cpu.right,16)),P.set(he.result,H.fromUnsigned(t.cpu.result,16)),t.cpu.FLAGS=16,P.set(he.FLAGS,H.fromUnsigned(t.cpu.FLAGS,16)),P.set(he.MAR,H.fromUnsigned(t.cpu.MAR,16)),P.set(he.MBR,H.fromUnsigned(t.cpu.MBR,8))),P.set(Hn,{phase:"stopped"})}const EQ=Object.freeze(Object.defineProperty({__proto__:null,MARAtom:Ei,MBRAtom:Yn,aluOperationAtom:aE,animationSyncAtom:na,connectScreenAndKeyboardAtom:sE,currentInstructionCycleCountAtom:Dt,cycleAtom:Hn,cycleCountAtom:af,hasINTInstructionAtom:oE,instructionCountAtom:Bl,mayUsePICAtom:Bb,messageAtom:Je,messageHistoryAtom:ws,registerAtoms:he,resetCPUState:n8,showSPAtom:jb,showriAtom:t8,totalCycleCountAtom:zp},Symbol.toStringTag,{value:"Module"})),i8=pe([]),r8=pe([]),ly=pe(new Array(Pe.MAX_ADDRESS+1).fill(H.zero(8))),Up=pe(Pe.from(32)),AQ=pe(null),cy=pe(new Set),Rg=256,PQ=pe(t=>{const e=t(AQ)??t(Up);let n=e.value-e.value%Rg,i=n+Rg-1;i>Pe.MAX_ADDRESS&&(i=Pe.MAX_ADDRESS,n=i-Rg+1);const r=t(ly),s=[];for(let o=0;o<Rg;o++)s.push({address:Pe.from(n+o),value:r[n+o]});return s});function NQ(t,e=!1){e?P.set(ly,new Array(Pe.MAX_ADDRESS+1).fill(H.zero(8))):P.set(ly,t.memory.map(n=>H.fromUnsigned(n,8))),P.set(Up,Pe.from(32)),P.set(cy,new Set)}let U2=[],s8=[];(()=>{let t="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,n=0;e<t.length;e++)(e%2?s8:U2).push(n=n+t[e])})();function MQ(t){if(t<768)return!1;for(let e=0,n=U2.length;;){let i=e+n>>1;if(t<U2[i])n=i;else if(t>=s8[i])e=i+1;else return!0;if(e==n)return!1}}function jR(t){return t>=127462&&t<=127487}const BR=8205;function RQ(t,e,n=!0,i=!0){return(n?o8:IQ)(t,e,i)}function o8(t,e,n){if(e==t.length)return e;e&&a8(t.charCodeAt(e))&&l8(t.charCodeAt(e-1))&&e--;let i=Fx(t,e);for(e+=$R(i);e<t.length;){let r=Fx(t,e);if(i==BR||r==BR||n&&MQ(r))e+=$R(r),i=r;else if(jR(r)){let s=0,o=e-2;for(;o>=0&&jR(Fx(t,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function IQ(t,e,n){for(;e>0;){let i=o8(t,e-2,n);if(i<e)return i;e--}return 0}function Fx(t,e){let n=t.charCodeAt(e);if(!l8(n)||e+1==t.length)return n;let i=t.charCodeAt(e+1);return a8(i)?(n-55296<<10)+(i-56320)+65536:n}function a8(t){return t>=56320&&t<57344}function l8(t){return t>=55296&&t<56320}function $R(t){return t<65536?1:2}class At{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,n,i){[e,n]=lf(this,e,n);let r=[];return this.decompose(0,e,r,2),i.length&&i.decompose(0,i.length,r,3),this.decompose(n,this.length,r,1),lo.from(r,this.length-(n-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,n=this.length){[e,n]=lf(this,e,n);let i=[];return this.decompose(e,n,i,0),lo.from(i,n-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let n=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),r=new Yh(this),s=new Yh(e);for(let o=n,a=n;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(a+=r.value.length,r.done||a>=i)return!0}}iter(e=1){return new Yh(this,e)}iterRange(e,n=this.length){return new c8(this,e,n)}iterLines(e,n){let i;if(e==null)i=this.iter();else{n==null&&(n=this.lines+1);let r=this.line(e).from;i=this.iterRange(r,Math.max(r,n==this.lines+1?this.length:n<=1?0:this.line(n-1).to))}return new u8(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?At.empty:e.length<=32?new kn(e):lo.from(kn.split(e,[]))}}class kn extends At{constructor(e,n=TQ(e)){super(),this.text=e,this.length=n}get lines(){return this.text.length}get children(){return null}lineInner(e,n,i,r){for(let s=0;;s++){let o=this.text[s],a=r+o.length;if((n?i:a)>=e)return new OQ(r,a,i,o);r=a+1,i++}}decompose(e,n,i,r){let s=e<=0&&n>=this.length?this:new kn(FR(this.text,e,n),Math.min(n,this.length)-Math.max(0,e));if(r&1){let o=i.pop(),a=K0(s.text,o.text.slice(),0,s.length);if(a.length<=32)i.push(new kn(a,o.length+s.length));else{let l=a.length>>1;i.push(new kn(a.slice(0,l)),new kn(a.slice(l)))}}else i.push(s)}replace(e,n,i){if(!(i instanceof kn))return super.replace(e,n,i);[e,n]=lf(this,e,n);let r=K0(this.text,K0(i.text,FR(this.text,0,e)),n),s=this.length+i.length-(n-e);return r.length<=32?new kn(r,s):lo.from(kn.split(r,[]),s)}sliceString(e,n=this.length,i=`
`){[e,n]=lf(this,e,n);let r="";for(let s=0,o=0;s<=n&&o<this.text.length;o++){let a=this.text[o],l=s+a.length;s>e&&o&&(r+=i),e<l&&n>s&&(r+=a.slice(Math.max(0,e-s),n-s)),s=l+1}return r}flatten(e){for(let n of this.text)e.push(n)}scanIdentical(){return 0}static split(e,n){let i=[],r=-1;for(let s of e)i.push(s),r+=s.length+1,i.length==32&&(n.push(new kn(i,r)),i=[],r=-1);return r>-1&&n.push(new kn(i,r)),n}}class lo extends At{constructor(e,n){super(),this.children=e,this.length=n,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,n,i,r){for(let s=0;;s++){let o=this.children[s],a=r+o.length,l=i+o.lines-1;if((n?l:a)>=e)return o.lineInner(e,n,i,r);r=a+1,i=l+1}}decompose(e,n,i,r){for(let s=0,o=0;o<=n&&s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e<=l&&n>=o){let c=r&((o<=e?1:0)|(l>=n?2:0));o>=e&&l<=n&&!c?i.push(a):a.decompose(e-o,n-o,i,c)}o=l+1}}replace(e,n,i){if([e,n]=lf(this,e,n),i.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.length;if(e>=s&&n<=a){let l=o.replace(e-s,n-s,i),c=this.lines-o.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let u=this.children.slice();return u[r]=l,new lo(u,this.length-(n-e)+i.length)}return super.replace(s,a,l)}s=a+1}return super.replace(e,n,i)}sliceString(e,n=this.length,i=`
`){[e,n]=lf(this,e,n);let r="";for(let s=0,o=0;s<this.children.length&&o<=n;s++){let a=this.children[s],l=o+a.length;o>e&&s&&(r+=i),e<l&&n>o&&(r+=a.sliceString(e-o,n-o,i)),o=l+1}return r}flatten(e){for(let n of this.children)n.flatten(e)}scanIdentical(e,n){if(!(e instanceof lo))return 0;let i=0,[r,s,o,a]=n>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=n,s+=n){if(r==o||s==a)return i;let l=this.children[r],c=e.children[s];if(l!=c)return i+l.scanIdentical(c,n);i+=l.length+1}}static from(e,n=e.reduce((i,r)=>i+r.length+1,-1)){let i=0;for(let p of e)i+=p.lines;if(i<32){let p=[];for(let m of e)m.flatten(p);return new kn(p,n)}let r=Math.max(32,i>>5),s=r<<1,o=r>>1,a=[],l=0,c=-1,u=[];function d(p){let m;if(p.lines>s&&p instanceof lo)for(let g of p.children)d(g);else p.lines>o&&(l>o||!l)?(f(),a.push(p)):p instanceof kn&&l&&(m=u[u.length-1])instanceof kn&&p.lines+m.lines<=32?(l+=p.lines,c+=p.length+1,u[u.length-1]=new kn(m.text.concat(p.text),m.length+1+p.length)):(l+p.lines>r&&f(),l+=p.lines,c+=p.length+1,u.push(p))}function f(){l!=0&&(a.push(u.length==1?u[0]:lo.from(u,c)),c=-1,l=u.length=0)}for(let p of e)d(p);return f(),a.length==1?a[0]:new lo(a,n)}}At.empty=new kn([""],0);function TQ(t){let e=-1;for(let n of t)e+=n.length+1;return e}function K0(t,e,n=0,i=1e9){for(let r=0,s=0,o=!0;s<t.length&&r<=i;s++){let a=t[s],l=r+a.length;l>=n&&(l>i&&(a=a.slice(0,i-r)),r<n&&(a=a.slice(n-r)),o?(e[e.length-1]+=a,o=!1):e.push(a)),r=l+1}return e}function FR(t,e,n){return K0(t,[""],e,n)}class Yh{constructor(e,n=1){this.dir=n,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[n>0?1:(e instanceof kn?e.text.length:e.children.length)<<1]}nextInner(e,n){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,r=this.nodes[i],s=this.offsets[i],o=s>>1,a=r instanceof kn?r.text.length:r.children.length;if(o==(n>0?a:0)){if(i==0)return this.done=!0,this.value="",this;n>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(n>0?0:1)){if(this.offsets[i]+=n,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof kn){let l=r.text[o+(n<0?-1:0)];if(this.offsets[i]+=n,l.length>Math.max(0,e))return this.value=e==0?l:n>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=r.children[o+(n<0?-1:0)];e>l.length?(e-=l.length,this.offsets[i]+=n):(n<0&&this.offsets[i]--,this.nodes.push(l),this.offsets.push(n>0?1:(l instanceof kn?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class c8{constructor(e,n,i){this.value="",this.done=!1,this.cursor=new Yh(e,n>i?-1:1),this.pos=n>i?e.length:0,this.from=Math.min(n,i),this.to=Math.max(n,i)}nextInner(e,n){if(n<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,n<0?this.pos-this.to:this.from-this.pos);let i=n<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*n,this.value=r.length<=i?r:n<0?r.slice(r.length-i):r.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class u8{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:n,lineBreak:i,value:r}=this.inner.next(e);return n&&this.afterBreak?(this.value="",this.afterBreak=!1):n?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(At.prototype[Symbol.iterator]=function(){return this.iter()},Yh.prototype[Symbol.iterator]=c8.prototype[Symbol.iterator]=u8.prototype[Symbol.iterator]=function(){return this});class OQ{constructor(e,n,i,r){this.from=e,this.to=n,this.number=i,this.text=r}get length(){return this.to-this.from}}function lf(t,e,n){return e=Math.max(0,Math.min(t.length,e)),[e,Math.max(e,Math.min(t.length,n))]}function si(t,e,n=!0,i=!0){return RQ(t,e,n,i)}function LQ(t){return t>=56320&&t<57344}function DQ(t){return t>=55296&&t<56320}function qr(t,e){let n=t.charCodeAt(e);if(!DQ(n)||e+1==t.length)return n;let i=t.charCodeAt(e+1);return LQ(i)?(n-55296<<10)+(i-56320)+65536:n}function lE(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}function ia(t){return t<65536?1:2}const V2=/\r\n?|\n/;var nr=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(nr||(nr={}));class Co{constructor(e){this.sections=e}get length(){let e=0;for(let n=0;n<this.sections.length;n+=2)e+=this.sections[n];return e}get newLength(){let e=0;for(let n=0;n<this.sections.length;n+=2){let i=this.sections[n+1];e+=i<0?this.sections[n]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let n=0,i=0,r=0;n<this.sections.length;){let s=this.sections[n++],o=this.sections[n++];o<0?(e(i,r,s),r+=s):r+=o,i+=s}}iterChangedRanges(e,n=!1){H2(this,e,n)}get invertedDesc(){let e=[];for(let n=0;n<this.sections.length;){let i=this.sections[n++],r=this.sections[n++];r<0?e.push(i,r):e.push(r,i)}return new Co(e)}composeDesc(e){return this.empty?e:e.empty?this:d8(this,e)}mapDesc(e,n=!1){return e.empty?this:W2(this,e,n)}mapPos(e,n=-1,i=nr.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],c=r+a;if(l<0){if(c>e)return s+(e-r);s+=a}else{if(i!=nr.Simple&&c>=e&&(i==nr.TrackDel&&r<e&&c>e||i==nr.TrackBefore&&r<e||i==nr.TrackAfter&&c>e))return null;if(c>e||c==e&&n<0&&!a)return e==r||n<0?s:s+l;s+=l}r=c}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,n=e){for(let i=0,r=0;i<this.sections.length&&r<=n;){let s=this.sections[i++],o=this.sections[i++],a=r+s;if(o>=0&&r<=n&&a>=e)return r<e&&a>n?"cover":!0;r=a}return!1}toString(){let e="";for(let n=0;n<this.sections.length;){let i=this.sections[n++],r=this.sections[n++];e+=(e?" ":"")+i+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(n=>typeof n!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Co(e)}static create(e){return new Co(e)}}class jn extends Co{constructor(e,n){super(e),this.inserted=n}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return H2(this,(n,i,r,s,o)=>e=e.replace(r,r+(i-n),o),!1),e}mapDesc(e,n=!1){return W2(this,e,n,!0)}invert(e){let n=this.sections.slice(),i=[];for(let r=0,s=0;r<n.length;r+=2){let o=n[r],a=n[r+1];if(a>=0){n[r]=a,n[r+1]=o;let l=r>>1;for(;i.length<l;)i.push(At.empty);i.push(o?e.slice(s,s+o):At.empty)}s+=o}return new jn(n,i)}compose(e){return this.empty?e:e.empty?this:d8(this,e,!0)}map(e,n=!1){return e.empty?this:W2(this,e,n,!0)}iterChanges(e,n=!1){H2(this,e,n)}get desc(){return Co.create(this.sections)}filter(e){let n=[],i=[],r=[],s=new Vp(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&s.len==0;){if(s.done)break e;let u=Math.min(s.len,l-a);vi(r,u,-1);let d=s.ins==-1?-1:s.off==0?s.ins:0;vi(n,u,d),d>0&&ol(i,n,s.text),s.forward(u),a+=u}let c=e[o++];for(;a<c;){if(s.done)break e;let u=Math.min(s.len,c-a);vi(n,u,-1),vi(r,u,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(u),a+=u}}return{changes:new jn(n,i),filtered:Co.create(r)}}toJSON(){let e=[];for(let n=0;n<this.sections.length;n+=2){let i=this.sections[n],r=this.sections[n+1];r<0?e.push(i):r==0?e.push([i]):e.push([i].concat(this.inserted[n>>1].toJSON()))}return e}static of(e,n,i){let r=[],s=[],o=0,a=null;function l(u=!1){if(!u&&!r.length)return;o<n&&vi(r,n-o,-1);let d=new jn(r,s);a=a?a.compose(d.map(a)):d,r=[],s=[],o=0}function c(u){if(Array.isArray(u))for(let d of u)c(d);else if(u instanceof jn){if(u.length!=n)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${n})`);l(),a=a?a.compose(u.map(a)):u}else{let{from:d,to:f=d,insert:p}=u;if(d>f||d<0||f>n)throw new RangeError(`Invalid change range ${d} to ${f} (in doc of length ${n})`);let m=p?typeof p=="string"?At.of(p.split(i||V2)):p:At.empty,g=m.length;if(d==f&&g==0)return;d<o&&l(),d>o&&vi(r,d-o,-1),vi(r,f-d,g),ol(s,r,m),o=f}}return c(e),l(!a),a}static empty(e){return new jn(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let n=[],i=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")n.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)n.push(s[0],0);else{for(;i.length<r;)i.push(At.empty);i[r]=At.of(s.slice(1)),n.push(s[0],i[r].length)}}}return new jn(n,i)}static createSet(e,n){return new jn(e,n)}}function vi(t,e,n,i=!1){if(e==0&&n<=0)return;let r=t.length-2;r>=0&&n<=0&&n==t[r+1]?t[r]+=e:r>=0&&e==0&&t[r]==0?t[r+1]+=n:i?(t[r]+=e,t[r+1]+=n):t.push(e,n)}function ol(t,e,n){if(n.length==0)return;let i=e.length-2>>1;if(i<t.length)t[t.length-1]=t[t.length-1].append(n);else{for(;t.length<i;)t.push(At.empty);t.push(n)}}function H2(t,e,n){let i=t.inserted;for(let r=0,s=0,o=0;o<t.sections.length;){let a=t.sections[o++],l=t.sections[o++];if(l<0)r+=a,s+=a;else{let c=r,u=s,d=At.empty;for(;c+=a,u+=l,l&&i&&(d=d.append(i[o-2>>1])),!(n||o==t.sections.length||t.sections[o+1]<0);)a=t.sections[o++],l=t.sections[o++];e(r,c,s,u,d),r=c,s=u}}}function W2(t,e,n,i=!1){let r=[],s=i?[]:null,o=new Vp(t),a=new Vp(e);for(let l=-1;;){if(o.done&&a.len||a.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&a.ins==-1){let c=Math.min(o.len,a.len);vi(r,c,-1),o.forward(c),a.forward(c)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!n))){let c=a.len;for(vi(r,a.ins,-1);c;){let u=Math.min(o.len,c);o.ins>=0&&l<o.i&&o.len<=u&&(vi(r,0,o.ins),s&&ol(s,r,o.text),l=o.i),o.forward(u),c-=u}a.next()}else if(o.ins>=0){let c=0,u=o.len;for(;u;)if(a.ins==-1){let d=Math.min(u,a.len);c+=d,u-=d,a.forward(d)}else if(a.ins==0&&a.len<u)u-=a.len,a.next();else break;vi(r,c,l<o.i?o.ins:0),s&&l<o.i&&ol(s,r,o.text),l=o.i,o.forward(o.len-u)}else{if(o.done&&a.done)return s?jn.createSet(r,s):Co.create(r);throw new Error("Mismatched change set lengths")}}}function d8(t,e,n=!1){let i=[],r=n?[]:null,s=new Vp(t),o=new Vp(e);for(let a=!1;;){if(s.done&&o.done)return r?jn.createSet(i,r):Co.create(i);if(s.ins==0)vi(i,s.len,0,a),s.next();else if(o.len==0&&!o.done)vi(i,0,o.ins,a),r&&ol(r,i,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,o.len),c=i.length;if(s.ins==-1){let u=o.ins==-1?-1:o.off?0:o.ins;vi(i,l,u,a),r&&u&&ol(r,i,o.text)}else o.ins==-1?(vi(i,s.off?0:s.len,l,a),r&&ol(r,i,s.textBit(l))):(vi(i,s.off?0:s.len,o.off?0:o.ins,a),r&&!o.off&&ol(r,i,o.text));a=(s.ins>l||o.ins>=0&&o.len>l)&&(a||i.length>c),s.forward2(l),o.forward(l)}}}}class Vp{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,n=this.i-2>>1;return n>=e.length?At.empty:e[n]}textBit(e){let{inserted:n}=this.set,i=this.i-2>>1;return i>=n.length&&!e?At.empty:n[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Dc{constructor(e,n,i){this.from=e,this.to=n,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,n=-1){let i,r;return this.empty?i=r=e.mapPos(this.from,n):(i=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),i==this.from&&r==this.to?this:new Dc(i,r,this.flags)}extend(e,n=e){if(e<=this.anchor&&n>=this.anchor)return le.range(e,n);let i=Math.abs(e-this.anchor)>Math.abs(n-this.anchor)?e:n;return le.range(this.anchor,i)}eq(e,n=!1){return this.anchor==e.anchor&&this.head==e.head&&(!n||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return le.range(e.anchor,e.head)}static create(e,n,i){return new Dc(e,n,i)}}class le{constructor(e,n){this.ranges=e,this.mainIndex=n}map(e,n=-1){return e.empty?this:le.create(this.ranges.map(i=>i.map(e,n)),this.mainIndex)}eq(e,n=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],n))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new le([this.main],0)}addRange(e,n=!0){return le.create([e].concat(this.ranges),n?0:this.mainIndex+1)}replaceRange(e,n=this.mainIndex){let i=this.ranges.slice();return i[n]=e,le.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new le(e.ranges.map(n=>Dc.fromJSON(n)),e.main)}static single(e,n=e){return new le([le.range(e,n)],0)}static create(e,n=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=i:s.from<i)return le.normalized(e.slice(),n);i=s.to}return new le(e,n)}static cursor(e,n=0,i,r){return Dc.create(e,e,(n==0?0:n<0?8:16)|(i==null?7:Math.min(6,i))|(r??16777215)<<6)}static range(e,n,i,r){let s=(i??16777215)<<6|(r==null?7:Math.min(6,r));return n<e?Dc.create(n,e,48|s):Dc.create(e,n,(n>e?8:0)|s)}static normalized(e,n=0){let i=e[n];e.sort((r,s)=>r.from-s.from),n=e.indexOf(i);for(let r=1;r<e.length;r++){let s=e[r],o=e[r-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,l=Math.max(s.to,o.to);r<=n&&n--,e.splice(--r,2,s.anchor>s.head?le.range(l,a):le.range(a,l))}}return new le(e,n)}}function f8(t,e){for(let n of t.ranges)if(n.to>e)throw new RangeError("Selection points outside of document")}let cE=0;class Re{constructor(e,n,i,r,s){this.combine=e,this.compareInput=n,this.compare=i,this.isStatic=r,this.id=cE++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new Re(e.combine||(n=>n),e.compareInput||((n,i)=>n===i),e.compare||(e.combine?(n,i)=>n===i:uE),!!e.static,e.enables)}of(e){return new X0([],this,0,e)}compute(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new X0(e,this,1,n)}computeN(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new X0(e,this,2,n)}from(e,n){return n||(n=i=>i),this.compute([e],i=>n(i.field(e)))}}function uE(t,e){return t==e||t.length==e.length&&t.every((n,i)=>n===e[i])}class X0{constructor(e,n,i,r){this.dependencies=e,this.facet=n,this.type=i,this.value=r,this.id=cE++}dynamicSlot(e){var n;let i=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,a=this.type==2,l=!1,c=!1,u=[];for(let d of this.dependencies)d=="doc"?l=!0:d=="selection"?c=!0:((n=e[d.id])!==null&&n!==void 0?n:1)&1||u.push(e[d.id]);return{create(d){return d.values[o]=i(d),1},update(d,f){if(l&&f.docChanged||c&&(f.docChanged||f.selection)||G2(d,u)){let p=i(d);if(a?!zR(p,d.values[o],r):!r(p,d.values[o]))return d.values[o]=p,1}return 0},reconfigure:(d,f)=>{let p,m=f.config.address[s];if(m!=null){let g=dy(f,m);if(this.dependencies.every(y=>y instanceof Re?f.facet(y)===d.facet(y):y instanceof $i?f.field(y,!1)==d.field(y,!1):!0)||(a?zR(p=i(d),g,r):r(p=i(d),g)))return d.values[o]=g,0}else p=i(d);return d.values[o]=p,1}}}}function zR(t,e,n){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!n(t[i],e[i]))return!1;return!0}function G2(t,e){let n=!1;for(let i of e)Jh(t,i)&1&&(n=!0);return n}function jQ(t,e,n){let i=n.map(l=>t[l.id]),r=n.map(l=>l.type),s=i.filter(l=>!(l&1)),o=t[e.id]>>1;function a(l){let c=[];for(let u=0;u<i.length;u++){let d=dy(l,i[u]);if(r[u]==2)for(let f of d)c.push(f);else c.push(d)}return e.combine(c)}return{create(l){for(let c of i)Jh(l,c);return l.values[o]=a(l),1},update(l,c){if(!G2(l,s))return 0;let u=a(l);return e.compare(u,l.values[o])?0:(l.values[o]=u,1)},reconfigure(l,c){let u=G2(l,i),d=c.config.facets[e.id],f=c.facet(e);if(d&&!u&&uE(n,d))return l.values[o]=f,0;let p=a(l);return e.compare(p,f)?(l.values[o]=f,0):(l.values[o]=p,1)}}}const Ig=Re.define({static:!0});class $i{constructor(e,n,i,r,s){this.id=e,this.createF=n,this.updateF=i,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let n=new $i(cE++,e.create,e.update,e.compare||((i,r)=>i===r),e);return e.provide&&(n.provides=e.provide(n)),n}create(e){let n=e.facet(Ig).find(i=>i.field==this);return((n==null?void 0:n.create)||this.createF)(e)}slot(e){let n=e[this.id]>>1;return{create:i=>(i.values[n]=this.create(i),1),update:(i,r)=>{let s=i.values[n],o=this.updateF(s,r);return this.compareF(s,o)?0:(i.values[n]=o,1)},reconfigure:(i,r)=>{let s=i.facet(Ig),o=r.facet(Ig),a;return(a=s.find(l=>l.field==this))&&a!=o.find(l=>l.field==this)?(i.values[n]=a.create(i),1):r.config.address[this.id]!=null?(i.values[n]=r.field(this),0):(i.values[n]=this.create(i),1)}}}init(e){return[this,Ig.of({field:this,create:e})]}get extension(){return this}}const Ac={lowest:4,low:3,default:2,high:1,highest:0};function Xf(t){return e=>new h8(e,t)}const Mm={highest:Xf(Ac.highest),high:Xf(Ac.high),default:Xf(Ac.default),low:Xf(Ac.low),lowest:Xf(Ac.lowest)};class h8{constructor(e,n){this.inner=e,this.prec=n}}class Rm{of(e){return new q2(this,e)}reconfigure(e){return Rm.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class q2{constructor(e,n){this.compartment=e,this.inner=n}}class uy{constructor(e,n,i,r,s,o){for(this.base=e,this.compartments=n,this.dynamicSlots=i,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let n=this.address[e.id];return n==null?e.default:this.staticValues[n>>1]}static resolve(e,n,i){let r=[],s=Object.create(null),o=new Map;for(let f of BQ(e,n,o))f instanceof $i?r.push(f):(s[f.facet.id]||(s[f.facet.id]=[])).push(f);let a=Object.create(null),l=[],c=[];for(let f of r)a[f.id]=c.length<<1,c.push(p=>f.slot(p));let u=i==null?void 0:i.config.facets;for(let f in s){let p=s[f],m=p[0].facet,g=u&&u[f]||[];if(p.every(y=>y.type==0))if(a[m.id]=l.length<<1|1,uE(g,p))l.push(i.facet(m));else{let y=m.combine(p.map(v=>v.value));l.push(i&&m.compare(y,i.facet(m))?i.facet(m):y)}else{for(let y of p)y.type==0?(a[y.id]=l.length<<1|1,l.push(y.value)):(a[y.id]=c.length<<1,c.push(v=>y.dynamicSlot(v)));a[m.id]=c.length<<1,c.push(y=>jQ(y,m,p))}}let d=c.map(f=>f(a));return new uy(e,o,d,a,l,s)}}function BQ(t,e,n){let i=[[],[],[],[],[]],r=new Map;function s(o,a){let l=r.get(o);if(l!=null){if(l<=a)return;let c=i[l].indexOf(o);c>-1&&i[l].splice(c,1),o instanceof q2&&n.delete(o.compartment)}if(r.set(o,a),Array.isArray(o))for(let c of o)s(c,a);else if(o instanceof q2){if(n.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;n.set(o.compartment,c),s(c,a)}else if(o instanceof h8)s(o.inner,o.prec);else if(o instanceof $i)i[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof X0)i[a].push(o),o.facet.extensions&&s(o.facet.extensions,Ac.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(c,a)}}return s(t,Ac.default),i.reduce((o,a)=>o.concat(a))}function Jh(t,e){if(e&1)return 2;let n=e>>1,i=t.status[n];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;t.status[n]=4;let r=t.computeSlot(t,t.config.dynamicSlots[n]);return t.status[n]=2|r}function dy(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}const p8=Re.define(),K2=Re.define({combine:t=>t.some(e=>e),static:!0}),m8=Re.define({combine:t=>t.length?t[0]:void 0,static:!0}),g8=Re.define(),v8=Re.define(),y8=Re.define(),b8=Re.define({combine:t=>t.length?t[0]:!1});class Ca{constructor(e,n){this.type=e,this.value=n}static define(){return new $Q}}class $Q{of(e){return new Ca(this,e)}}class FQ{constructor(e){this.map=e}of(e){return new ft(this,e)}}class ft{constructor(e,n){this.type=e,this.value=n}map(e){let n=this.type.map(this.value,e);return n===void 0?void 0:n==this.value?this:new ft(this.type,n)}is(e){return this.type==e}static define(e={}){return new FQ(e.map||(n=>n))}static mapEffects(e,n){if(!e.length)return e;let i=[];for(let r of e){let s=r.map(n);s&&i.push(s)}return i}}ft.reconfigure=ft.define();ft.appendConfig=ft.define();class zn{constructor(e,n,i,r,s,o){this.startState=e,this.changes=n,this.selection=i,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&f8(i,n.newLength),s.some(a=>a.type==zn.time)||(this.annotations=s.concat(zn.time.of(Date.now())))}static create(e,n,i,r,s,o){return new zn(e,n,i,r,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let n of this.annotations)if(n.type==e)return n.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let n=this.annotation(zn.userEvent);return!!(n&&(n==e||n.length>e.length&&n.slice(0,e.length)==e&&n[e.length]=="."))}}zn.time=Ca.define();zn.userEvent=Ca.define();zn.addToHistory=Ca.define();zn.remote=Ca.define();function zQ(t,e){let n=[];for(let i=0,r=0;;){let s,o;if(i<t.length&&(r==e.length||e[r]>=t[i]))s=t[i++],o=t[i++];else if(r<e.length)s=e[r++],o=e[r++];else return n;!n.length||n[n.length-1]<s?n.push(s,o):n[n.length-1]<o&&(n[n.length-1]=o)}}function x8(t,e,n){var i;let r,s,o;return n?(r=e.changes,s=jn.empty(e.changes.length),o=t.changes.compose(e.changes)):(r=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(i=t.selection)===null||i===void 0?void 0:i.map(r),effects:ft.mapEffects(t.effects,r).concat(ft.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function X2(t,e,n){let i=e.selection,r=wd(e.annotations);return e.userEvent&&(r=r.concat(zn.userEvent.of(e.userEvent))),{changes:e.changes instanceof jn?e.changes:jn.of(e.changes||[],n,t.facet(m8)),selection:i&&(i instanceof le?i:le.single(i.anchor,i.head)),effects:wd(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function w8(t,e,n){let i=X2(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(n=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(n=!1);let o=!!e[s].sequential;i=x8(i,X2(t,e[s],o?i.changes.newLength:t.doc.length),o)}let r=zn.create(t,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return VQ(n?UQ(r):r)}function UQ(t){let e=t.startState,n=!0;for(let r of e.facet(g8)){let s=r(t);if(s===!1){n=!1;break}Array.isArray(s)&&(n=n===!0?s:zQ(n,s))}if(n!==!0){let r,s;if(n===!1)s=t.changes.invertedDesc,r=jn.empty(e.doc.length);else{let o=t.changes.filter(n);r=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}t=zn.create(e,r,t.selection&&t.selection.map(s),ft.mapEffects(t.effects,s),t.annotations,t.scrollIntoView)}let i=e.facet(v8);for(let r=i.length-1;r>=0;r--){let s=i[r](t);s instanceof zn?t=s:Array.isArray(s)&&s.length==1&&s[0]instanceof zn?t=s[0]:t=w8(e,wd(s),!1)}return t}function VQ(t){let e=t.startState,n=e.facet(y8),i=t;for(let r=n.length-1;r>=0;r--){let s=n[r](t);s&&Object.keys(s).length&&(i=x8(i,X2(e,s,t.changes.newLength),!0))}return i==t?t:zn.create(e,t.changes,t.selection,i.effects,i.annotations,i.scrollIntoView)}const HQ=[];function wd(t){return t==null?HQ:Array.isArray(t)?t:[t]}var oi=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(oi||(oi={}));const WQ=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Y2;try{Y2=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function GQ(t){if(Y2)return Y2.test(t);for(let e=0;e<t.length;e++){let n=t[e];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||WQ.test(n)))return!0}return!1}function qQ(t){return e=>{if(!/\S/.test(e))return oi.Space;if(GQ(e))return oi.Word;for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return oi.Word;return oi.Other}}class St{constructor(e,n,i,r,s,o){this.config=e,this.doc=n,this.selection=i,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)Jh(this,a<<1);this.computeSlot=null}field(e,n=!0){let i=this.config.address[e.id];if(i==null){if(n)throw new RangeError("Field is not present in this state");return}return Jh(this,i),dy(this,i)}update(...e){return w8(this,e,!0)}applyTransaction(e){let n=this.config,{base:i,compartments:r}=n;for(let a of e.effects)a.is(Rm.reconfigure)?(n&&(r=new Map,n.compartments.forEach((l,c)=>r.set(c,l)),n=null),r.set(a.value.compartment,a.value.extension)):a.is(ft.reconfigure)?(n=null,i=a.value):a.is(ft.appendConfig)&&(n=null,i=wd(i).concat(a.value));let s;n?s=e.startState.values.slice():(n=uy.resolve(i,r,this),s=new St(n,this.doc,this.selection,n.dynamicSlots.map(()=>null),(l,c)=>c.reconfigure(l,this),null).values);let o=e.startState.facet(K2)?e.newSelection:e.newSelection.asSingle();new St(n,e.newDoc,o,s,(a,l)=>l.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:e},range:le.cursor(n.from+e.length)}))}changeByRange(e){let n=this.selection,i=e(n.ranges[0]),r=this.changes(i.changes),s=[i.range],o=wd(i.effects);for(let a=1;a<n.ranges.length;a++){let l=e(n.ranges[a]),c=this.changes(l.changes),u=c.map(r);for(let f=0;f<a;f++)s[f]=s[f].map(u);let d=r.mapDesc(c,!0);s.push(l.range.map(d)),r=r.compose(u),o=ft.mapEffects(o,u).concat(ft.mapEffects(wd(l.effects),d))}return{changes:r,selection:le.create(s,n.mainIndex),effects:o}}changes(e=[]){return e instanceof jn?e:jn.of(e,this.doc.length,this.facet(St.lineSeparator))}toText(e){return At.of(e.split(this.facet(St.lineSeparator)||V2))}sliceDoc(e=0,n=this.doc.length){return this.doc.sliceString(e,n,this.lineBreak)}facet(e){let n=this.config.address[e.id];return n==null?e.default:(Jh(this,n),dy(this,n))}toJSON(e){let n={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let r=e[i];r instanceof $i&&this.config.address[r.id]!=null&&(n[i]=r.spec.toJSON(this.field(e[i]),this))}return n}static fromJSON(e,n={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(i){for(let s in i)if(Object.prototype.hasOwnProperty.call(e,s)){let o=i[s],a=e[s];r.push(o.init(l=>o.spec.fromJSON(a,l)))}}return St.create({doc:e.doc,selection:le.fromJSON(e.selection),extensions:n.extensions?r.concat([n.extensions]):r})}static create(e={}){let n=uy.resolve(e.extensions||[],new Map),i=e.doc instanceof At?e.doc:At.of((e.doc||"").split(n.staticFacet(St.lineSeparator)||V2)),r=e.selection?e.selection instanceof le?e.selection:le.single(e.selection.anchor,e.selection.head):le.single(0);return f8(r,i.length),n.staticFacet(K2)||(r=r.asSingle()),new St(n,i,r,n.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(St.tabSize)}get lineBreak(){return this.facet(St.lineSeparator)||`
`}get readOnly(){return this.facet(b8)}phrase(e,...n){for(let i of this.facet(St.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return n.length&&(e=e.replace(/\$(\$|\d*)/g,(i,r)=>{if(r=="$")return"$";let s=+(r||1);return!s||s>n.length?i:n[s-1]})),e}languageDataAt(e,n,i=-1){let r=[];for(let s of this.facet(p8))for(let o of s(this,n,i))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return qQ(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:n,from:i,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-i,a=e-i;for(;o>0;){let l=si(n,o,!1);if(s(n.slice(l,o))!=oi.Word)break;o=l}for(;a<r;){let l=si(n,a);if(s(n.slice(a,l))!=oi.Word)break;a=l}return o==a?null:le.range(o+i,a+i)}}St.allowMultipleSelections=K2;St.tabSize=Re.define({combine:t=>t.length?t[0]:4});St.lineSeparator=m8;St.readOnly=b8;St.phrases=Re.define({compare(t,e){let n=Object.keys(t),i=Object.keys(e);return n.length==i.length&&n.every(r=>t[r]==e[r])}});St.languageData=p8;St.changeFilter=g8;St.transactionFilter=v8;St.transactionExtender=y8;Rm.reconfigure=ft.define();function Ql(t,e,n={}){let i={};for(let r of t)for(let s of Object.keys(r)){let o=r[s],a=i[s];if(a===void 0)i[s]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(n,s))i[s]=n[s](a,o);else throw new Error("Config merge conflict for field "+s)}for(let r in e)i[r]===void 0&&(i[r]=e[r]);return i}class eu{eq(e){return this==e}range(e,n=e){return J2.create(e,n,this)}}eu.prototype.startSide=eu.prototype.endSide=0;eu.prototype.point=!1;eu.prototype.mapMode=nr.TrackDel;let J2=class S8{constructor(e,n,i){this.from=e,this.to=n,this.value=i}static create(e,n,i){return new S8(e,n,i)}};function Z2(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class dE{constructor(e,n,i,r){this.from=e,this.to=n,this.value=i,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,n,i,r=0){let s=i?this.to:this.from;for(let o=r,a=s.length;;){if(o==a)return o;let l=o+a>>1,c=s[l]-e||(i?this.value[l].endSide:this.value[l].startSide)-n;if(l==o)return c>=0?o:a;c>=0?a=l:o=l+1}}between(e,n,i,r){for(let s=this.findIndex(n,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,n){let i=[],r=[],s=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],u=this.from[l]+e,d=this.to[l]+e,f,p;if(u==d){let m=n.mapPos(u,c.startSide,c.mapMode);if(m==null||(f=p=m,c.startSide!=c.endSide&&(p=n.mapPos(u,c.endSide),p<f)))continue}else if(f=n.mapPos(u,c.startSide),p=n.mapPos(d,c.endSide),f>p||f==p&&c.startSide>0&&c.endSide<=0)continue;(p-f||c.endSide-c.startSide)<0||(o<0&&(o=f),c.point&&(a=Math.max(a,p-f)),i.push(c),r.push(f-o),s.push(p-o))}return{mapped:i.length?new dE(r,s,i,a):null,pos:o}}}class Ot{constructor(e,n,i,r){this.chunkPos=e,this.chunk=n,this.nextLayer=i,this.maxPoint=r}static create(e,n,i,r){return new Ot(e,n,i,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let n of this.chunk)e+=n.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:n=[],sort:i=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(n.length==0&&!o)return this;if(i&&(n=n.slice().sort(Z2)),this.isEmpty)return n.length?Ot.of(n):this;let a=new k8(this,null,-1).goto(0),l=0,c=[],u=new $l;for(;a.value||l<n.length;)if(l<n.length&&(a.from-n[l].from||a.startSide-n[l].value.startSide)>=0){let d=n[l++];u.addInner(d.from,d.to,d.value)||c.push(d)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==n.length||this.chunkEnd(a.chunkIndex)<n[l].from)&&(!o||r>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&u.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||r>a.to||s<a.from||o(a.from,a.to,a.value))&&(u.addInner(a.from,a.to,a.value)||c.push(J2.create(a.from,a.to,a.value))),a.next());return u.finishInner(this.nextLayer.isEmpty&&!c.length?Ot.empty:this.nextLayer.update({add:c,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let n=[],i=[],r=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],c=e.touchesRange(a,a+l.length);if(c===!1)r=Math.max(r,l.maxPoint),n.push(l),i.push(e.mapPos(a));else if(c===!0){let{mapped:u,pos:d}=l.map(a,e);u&&(r=Math.max(r,u.maxPoint),n.push(u),i.push(d))}}let s=this.nextLayer.map(e);return n.length==0?s:new Ot(i,n,s||Ot.empty,r)}between(e,n,i){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(n>=s&&e<=s+o.length&&o.between(s,e-s,n-s,i)===!1)return}this.nextLayer.between(e,n,i)}}iter(e=0){return Hp.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,n=0){return Hp.from(e).goto(n)}static compare(e,n,i,r,s=-1){let o=e.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),a=n.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),l=UR(o,a,i),c=new Yf(o,l,s),u=new Yf(a,l,s);i.iterGaps((d,f,p)=>VR(c,d,u,f,p,r)),i.empty&&i.length==0&&VR(c,0,u,0,0,r)}static eq(e,n,i=0,r){r==null&&(r=999999999);let s=e.filter(u=>!u.isEmpty&&n.indexOf(u)<0),o=n.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let a=UR(s,o),l=new Yf(s,a,0).goto(i),c=new Yf(o,a,0).goto(i);for(;;){if(l.to!=c.to||!Q2(l.active,c.active)||l.point&&(!c.point||!l.point.eq(c.point)))return!1;if(l.to>r)return!0;l.next(),c.next()}}static spans(e,n,i,r,s=-1){let o=new Yf(e,null,s).goto(n),a=n,l=o.openStart;for(;;){let c=Math.min(o.to,i);if(o.point){let u=o.activeForPoint(o.to),d=o.pointFrom<n?u.length+1:o.point.startSide<0?u.length:Math.min(u.length,l);r.point(a,c,o.point,u,d,o.pointRank),l=Math.min(o.openEnd(c),u.length)}else c>a&&(r.span(a,c,o.active,l),l=o.openEnd(c));if(o.to>i)return l+(o.point&&o.to>i?1:0);a=o.to,o.next()}}static of(e,n=!1){let i=new $l;for(let r of e instanceof J2?[e]:n?KQ(e):e)i.add(r.from,r.to,r.value);return i.finish()}static join(e){if(!e.length)return Ot.empty;let n=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let r=e[i];r!=Ot.empty;r=r.nextLayer)n=new Ot(r.chunkPos,r.chunk,n,Math.max(r.maxPoint,n.maxPoint));return n}}Ot.empty=new Ot([],[],null,-1);function KQ(t){if(t.length>1)for(let e=t[0],n=1;n<t.length;n++){let i=t[n];if(Z2(e,i)>0)return t.slice().sort(Z2);e=i}return t}Ot.empty.nextLayer=Ot.empty;class $l{finishChunk(e){this.chunks.push(new dE(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,n,i){this.addInner(e,n,i)||(this.nextLayer||(this.nextLayer=new $l)).add(e,n,i)}addInner(e,n,i){let r=e-this.lastTo||i.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(n-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=n,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,n-e)),!0)}addChunk(e,n){if((e-this.lastTo||n.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,n.maxPoint),this.chunks.push(n),this.chunkPos.push(e);let i=n.value.length-1;return this.last=n.value[i],this.lastFrom=n.from[i]+e,this.lastTo=n.to[i]+e,!0}finish(){return this.finishInner(Ot.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let n=Ot.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,n}}function UR(t,e,n){let i=new Map;for(let s of t)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&i.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=i.get(s.chunk[o]);a!=null&&(n?n.mapPos(a):a)==s.chunkPos[o]&&!(n!=null&&n.touchesRange(a,a+s.chunk[o].length))&&r.add(s.chunk[o])}return r}class k8{constructor(e,n,i,r=0){this.layer=e,this.skip=n,this.minPoint=i,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,n=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,n,!1),this}gotoInner(e,n,i){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],n,!0);(!i||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,n){(this.to-e||this.endSide-n)<0&&this.gotoInner(e,n,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],n=this.layer.chunk[this.chunkIndex],i=e+n.from[this.rangeIndex];if(this.from=i,this.to=e+n.to[this.rangeIndex],this.value=n.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Hp{constructor(e){this.heap=e}static from(e,n=null,i=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&r.push(new k8(o,n,i,s));return r.length==1?r[0]:new Hp(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,n=-1e9){for(let i of this.heap)i.goto(e,n);for(let i=this.heap.length>>1;i>=0;i--)zx(this.heap,i);return this.next(),this}forward(e,n){for(let i of this.heap)i.forward(e,n);for(let i=this.heap.length>>1;i>=0;i--)zx(this.heap,i);(this.to-e||this.value.endSide-n)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),zx(this.heap,0)}}}function zx(t,e){for(let n=t[e];;){let i=(e<<1)+1;if(i>=t.length)break;let r=t[i];if(i+1<t.length&&r.compare(t[i+1])>=0&&(r=t[i+1],i++),n.compare(r)<0)break;t[i]=n,t[e]=r,e=i}}class Yf{constructor(e,n,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Hp.from(e,n,i)}goto(e,n=-1e9){return this.cursor.goto(e,n),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=n,this.openStart=-1,this.next(),this}forward(e,n){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-n)<0;)this.removeActive(this.minActive);this.cursor.forward(e,n)}removeActive(e){Tg(this.active,e),Tg(this.activeTo,e),Tg(this.activeRank,e),this.minActive=HR(this.active,this.activeTo)}addActive(e){let n=0,{value:i,to:r,rank:s}=this.cursor;for(;n<this.activeRank.length&&(s-this.activeRank[n]||r-this.activeTo[n])>0;)n++;Og(this.active,n,i),Og(this.activeTo,n,r),Og(this.activeRank,n,s),e&&Og(e,n,this.cursor.from),this.minActive=HR(this.active,this.activeTo)}next(){let e=this.to,n=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&Tg(i,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(i),this.cursor.next();else if(n&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let r=i.length-1;r>=0&&i[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let n=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&n.push(this.active[i]);return n.reverse()}openEnd(e){let n=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)n++;return n}}function VR(t,e,n,i,r,s){t.goto(e),n.goto(i);let o=i+r,a=i,l=i-e;for(;;){let c=t.to+l-n.to,u=c||t.endSide-n.endSide,d=u<0?t.to+l:n.to,f=Math.min(d,o);if(t.point||n.point?t.point&&n.point&&(t.point==n.point||t.point.eq(n.point))&&Q2(t.activeForPoint(t.to),n.activeForPoint(n.to))||s.comparePoint(a,f,t.point,n.point):f>a&&!Q2(t.active,n.active)&&s.compareRange(a,f,t.active,n.active),d>o)break;(c||t.openEnd!=n.openEnd)&&s.boundChange&&s.boundChange(d),a=d,u<=0&&t.next(),u>=0&&n.next()}}function Q2(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n]&&!t[n].eq(e[n]))return!1;return!0}function Tg(t,e){for(let n=e,i=t.length-1;n<i;n++)t[n]=t[n+1];t.pop()}function Og(t,e,n){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=n}function HR(t,e){let n=-1,i=1e9;for(let r=0;r<e.length;r++)(e[r]-i||t[r].endSide-t[n].endSide)<0&&(n=r,i=e[r]);return n}function Im(t,e,n=t.length){let i=0;for(let r=0;r<n&&r<t.length;)t.charCodeAt(r)==9?(i+=e-i%e,r++):(i++,r=si(t,r));return i}function XQ(t,e,n,i){for(let r=0,s=0;;){if(s>=e)return r;if(r==t.length)break;s+=t.charCodeAt(r)==9?n-s%n:1,r=si(t,r)}return t.length}const ek="ͼ",WR=typeof Symbol>"u"?"__"+ek:Symbol.for(ek),tk=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),GR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Fl{constructor(e,n){this.rules=[];let{finish:i}=n||{};function r(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,l,c){let u=[],d=/^@(\w+)\b/.exec(o[0]),f=d&&d[1]=="keyframes";if(d&&a==null)return l.push(o[0]+";");for(let p in a){let m=a[p];if(/&/.test(p))s(p.split(/,\s*/).map(g=>o.map(y=>g.replace(/&/,y))).reduce((g,y)=>g.concat(y)),m,l);else if(m&&typeof m=="object"){if(!d)throw new RangeError("The value of a property ("+p+") should be a primitive value.");s(r(p),m,u,f)}else m!=null&&u.push(p.replace(/_.*/,"").replace(/[A-Z]/g,g=>"-"+g.toLowerCase())+": "+m+";")}(u.length||f)&&l.push((i&&!d&&!c?o.map(i):o).join(", ")+" {"+u.join(" ")+"}")}for(let o in e)s(r(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=GR[WR]||1;return GR[WR]=e+1,ek+e.toString(36)}static mount(e,n,i){let r=e[tk],s=i&&i.nonce;r?s&&r.setNonce(s):r=new YQ(e,s),r.mount(Array.isArray(n)?n:[n],e)}}let qR=new Map;class YQ{constructor(e,n){let i=e.ownerDocument||e,r=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let s=qR.get(i);if(s)return e[tk]=s;this.sheet=new r.CSSStyleSheet,qR.set(i,this)}else this.styleTag=i.createElement("style"),n&&this.styleTag.setAttribute("nonce",n);this.modules=[],e[tk]=this}mount(e,n){let i=this.sheet,r=0,s=0;for(let o=0;o<e.length;o++){let a=e[o],l=this.modules.indexOf(a);if(l<s&&l>-1&&(this.modules.splice(l,1),s--,l=-1),l==-1){if(this.modules.splice(s++,0,a),i)for(let c=0;c<a.rules.length;c++)i.insertRule(a.rules[c],r++)}else{for(;s<l;)r+=this.modules[s++].rules.length;r+=a.rules.length,s++}}if(i)n.adoptedStyleSheets.indexOf(this.sheet)<0&&(n.adoptedStyleSheets=[this.sheet,...n.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=n.head||n;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var zl={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Wp={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},JQ=typeof navigator<"u"&&/Mac/.test(navigator.platform),ZQ=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ti=0;ti<10;ti++)zl[48+ti]=zl[96+ti]=String(ti);for(var ti=1;ti<=24;ti++)zl[ti+111]="F"+ti;for(var ti=65;ti<=90;ti++)zl[ti]=String.fromCharCode(ti+32),Wp[ti]=String.fromCharCode(ti);for(var Ux in zl)Wp.hasOwnProperty(Ux)||(Wp[Ux]=zl[Ux]);function QQ(t){var e=JQ&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||ZQ&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Wp:zl)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}function Vt(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var r=n[i];typeof r=="string"?t.setAttribute(i,r):r!=null&&(t[i]=r)}e++}for(;e<arguments.length;e++)_8(t,arguments[e]);return t}function _8(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)_8(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}function Gp(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function nk(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function Y0(t,e){if(!e.anchorNode)return!1;try{return nk(t,e.anchorNode)}catch{return!1}}function qp(t){return t.nodeType==3?nu(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function Zh(t,e,n,i){return n?KR(t,e,n,i,-1)||KR(t,e,n,i,1):!1}function tu(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function fy(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function KR(t,e,n,i,r){for(;;){if(t==n&&e==i)return!0;if(e==(r<0?0:No(t))){if(t.nodeName=="DIV")return!1;let s=t.parentNode;if(!s||s.nodeType!=1)return!1;e=tu(t)+(r<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(r<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=r<0?No(t):0}else return!1}}function No(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function $b(t,e){let n=e?t.left:t.right;return{left:n,right:n,top:t.top,bottom:t.bottom}}function eee(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function C8(t,e){let n=e.width/t.offsetWidth,i=e.height/t.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.width-t.offsetWidth)<1)&&(n=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-t.offsetHeight)<1)&&(i=1),{scaleX:n,scaleY:i}}function tee(t,e,n,i,r,s,o,a){let l=t.ownerDocument,c=l.defaultView||window;for(let u=t,d=!1;u&&!d;)if(u.nodeType==1){let f,p=u==l.body,m=1,g=1;if(p)f=eee(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(d=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let b=u.getBoundingClientRect();({scaleX:m,scaleY:g}=C8(u,b)),f={left:b.left,right:b.left+u.clientWidth*m,top:b.top,bottom:b.top+u.clientHeight*g}}let y=0,v=0;if(r=="nearest")e.top<f.top?(v=e.top-(f.top+o),n>0&&e.bottom>f.bottom+v&&(v=e.bottom-f.bottom+o)):e.bottom>f.bottom&&(v=e.bottom-f.bottom+o,n<0&&e.top-v<f.top&&(v=e.top-(f.top+o)));else{let b=e.bottom-e.top,w=f.bottom-f.top;v=(r=="center"&&b<=w?e.top+b/2-w/2:r=="start"||r=="center"&&n<0?e.top-o:e.bottom-w+o)-f.top}if(i=="nearest"?e.left<f.left?(y=e.left-(f.left+s),n>0&&e.right>f.right+y&&(y=e.right-f.right+s)):e.right>f.right&&(y=e.right-f.right+s,n<0&&e.left<f.left+y&&(y=e.left-(f.left+s))):y=(i=="center"?e.left+(e.right-e.left)/2-(f.right-f.left)/2:i=="start"==a?e.left-s:e.right-(f.right-f.left)+s)-f.left,y||v)if(p)c.scrollBy(y,v);else{let b=0,w=0;if(v){let k=u.scrollTop;u.scrollTop+=v/g,w=(u.scrollTop-k)*g}if(y){let k=u.scrollLeft;u.scrollLeft+=y/m,b=(u.scrollLeft-k)*m}e={left:e.left-b,top:e.top-w,right:e.right-b,bottom:e.bottom-w},b&&Math.abs(b-y)<1&&(i="nearest"),w&&Math.abs(w-v)<1&&(r="nearest")}if(p)break;(e.top<f.top||e.bottom>f.bottom||e.left<f.left||e.right>f.right)&&(e={left:Math.max(e.left,f.left),right:Math.min(e.right,f.right),top:Math.max(e.top,f.top),bottom:Math.min(e.bottom,f.bottom)}),u=u.assignedSlot||u.parentNode}else if(u.nodeType==11)u=u.host;else break}function nee(t){let e=t.ownerDocument,n,i;for(let r=t.parentNode;r&&!(r==e.body||n&&i);)if(r.nodeType==1)!i&&r.scrollHeight>r.clientHeight&&(i=r),!n&&r.scrollWidth>r.clientWidth&&(n=r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;return{x:n,y:i}}class iee{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:n,focusNode:i}=e;this.set(n,Math.min(e.anchorOffset,n?No(n):0),i,Math.min(e.focusOffset,i?No(i):0))}set(e,n,i,r){this.anchorNode=e,this.anchorOffset=n,this.focusNode=i,this.focusOffset=r}}let Su=null;function E8(t){if(t.setActive)return t.setActive();if(Su)return t.focus(Su);let e=[];for(let n=t;n&&(e.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(t.focus(Su==null?{get preventScroll(){return Su={preventScroll:!0},!0}}:void 0),!Su){Su=!1;for(let n=0;n<e.length;){let i=e[n++],r=e[n++],s=e[n++];i.scrollTop!=r&&(i.scrollTop=r),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let XR;function nu(t,e,n=e){let i=XR||(XR=document.createRange());return i.setEnd(t,n),i.setStart(t,e),i}function Sd(t,e,n,i){let r={key:e,code:e,keyCode:n,which:n,cancelable:!0};i&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=i);let s=new KeyboardEvent("keydown",r);s.synthetic=!0,t.dispatchEvent(s);let o=new KeyboardEvent("keyup",r);return o.synthetic=!0,t.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function ree(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function A8(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function see(t,e){let n=e.focusNode,i=e.focusOffset;if(!n||e.anchorNode!=n||e.anchorOffset!=i)return!1;for(i=Math.min(i,No(n));;)if(i){if(n.nodeType!=1)return!1;let r=n.childNodes[i-1];r.contentEditable=="false"?i--:(n=r,i=No(n))}else{if(n==t)return!0;i=tu(n),n=n.parentNode}}function P8(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function N8(t,e){for(let n=t,i=e;;){if(n.nodeType==3&&i>0)return{node:n,offset:i};if(n.nodeType==1&&i>0){if(n.contentEditable=="false")return null;n=n.childNodes[i-1],i=No(n)}else if(n.parentNode&&!fy(n))i=tu(n),n=n.parentNode;else return null}}function M8(t,e){for(let n=t,i=e;;){if(n.nodeType==3&&i<n.nodeValue.length)return{node:n,offset:i};if(n.nodeType==1&&i<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[i],i=0}else if(n.parentNode&&!fy(n))i=tu(n)+1,n=n.parentNode;else return null}}class xi{constructor(e,n,i=!0){this.node=e,this.offset=n,this.precise=i}static before(e,n){return new xi(e.parentNode,tu(e),n)}static after(e,n){return new xi(e.parentNode,tu(e)+1,n)}}const fE=[];class Gt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let n=this.posAtStart;for(let i of this.children){if(i==e)return n;n+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,n){if(this.flags&2){let i=this.dom,r=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=r?r.nextSibling:i.firstChild)){let a=Gt.get(s);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,n),o.flags&=-8}if(s=r?r.nextSibling:i.firstChild,n&&!n.written&&n.node==i&&s!=o.dom&&(n.written=!0),o.dom.parentNode==i)for(;s&&s!=o.dom;)s=YR(s);else i.insertBefore(o.dom,s);r=o.dom}for(s=r?r.nextSibling:i.firstChild,s&&n&&n.node==i&&(n.written=!0);s;)s=YR(s)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,n),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,n){let i;if(e==this.dom)i=this.dom.childNodes[n];else{let r=No(e)==0?0:n==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!Gt.get(i);)i=i.nextSibling;if(!i)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==i)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,n,i=0){let r=-1,s=-1,o=-1,a=-1;for(let l=0,c=i,u=i;l<this.children.length;l++){let d=this.children[l],f=c+d.length;if(c<e&&f>n)return d.domBoundsAround(e,n,c);if(f>=e&&r==-1&&(r=l,s=c),c>n&&d.dom.parentNode==this.dom){o=l,a=u;break}u=f,c=f+d.breakAfter}return{from:s,to:a<0?i+this.length:a,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let n=this.parent;n;n=n.parent){if(e&&(n.flags|=2),n.flags&1)return;n.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let n=e.parent;if(!n)return e;e=n}}replaceChildren(e,n,i=fE){this.markDirty();for(let r=e;r<n;r++){let s=this.children[r];s.parent==this&&i.indexOf(s)<0&&s.destroy()}i.length<250?this.children.splice(e,n-e,...i):this.children=[].concat(this.children.slice(0,e),i,this.children.slice(n));for(let r=0;r<i.length;r++)i[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new R8(this.children,e,this.children.length)}childPos(e,n=1){return this.childCursor().findPos(e,n)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,n,i,r,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}Gt.prototype.breakAfter=0;function YR(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class R8{constructor(e,n,i){this.children=e,this.pos=n,this.i=i,this.off=0}findPos(e,n=1){for(;;){if(e>this.pos||e==this.pos&&(n>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function I8(t,e,n,i,r,s,o,a,l){let{children:c}=t,u=c.length?c[e]:null,d=s.length?s[s.length-1]:null,f=d?d.breakAfter:o;if(!(e==i&&u&&!o&&!f&&s.length<2&&u.merge(n,r,s.length?d:null,n==0,a,l))){if(i<c.length){let p=c[i];p&&(r<p.length||p.breakAfter&&(d!=null&&d.breakAfter))?(e==i&&(p=p.split(r),r=0),!f&&d&&p.merge(0,r,d,!0,0,l)?s[s.length-1]=p:((r||p.children.length&&!p.children[0].length)&&p.merge(0,r,null,!1,0,l),s.push(p))):p!=null&&p.breakAfter&&(d?d.breakAfter=1:o=1),i++}for(u&&(u.breakAfter=o,n>0&&(!o&&s.length&&u.merge(n,u.length,s[0],!1,a,0)?u.breakAfter=s.shift().breakAfter:(n<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(n,u.length,null,!1,a,0),e++));e<i&&s.length;)if(c[i-1].become(s[s.length-1]))i--,s.pop(),l=s.length?0:a;else if(c[e].become(s[0]))e++,s.shift(),a=s.length?0:l;else break;!s.length&&e&&i<c.length&&!c[e-1].breakAfter&&c[i].merge(0,0,c[e-1],!1,a,l)&&e--,(e<i||s.length)&&t.replaceChildren(e,i,s)}}function T8(t,e,n,i,r,s){let o=t.childCursor(),{i:a,off:l}=o.findPos(n,1),{i:c,off:u}=o.findPos(e,-1),d=e-n;for(let f of i)d+=f.length;t.length+=d,I8(t,c,u,a,l,i,0,r,s)}let tr=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},ik=typeof document<"u"?document:{documentElement:{style:{}}};const rk=/Edge\/(\d+)/.exec(tr.userAgent),O8=/MSIE \d/.test(tr.userAgent),sk=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(tr.userAgent),Fb=!!(O8||sk||rk),JR=!Fb&&/gecko\/(\d+)/i.test(tr.userAgent),Vx=!Fb&&/Chrome\/(\d+)/.exec(tr.userAgent),oee="webkitFontSmoothing"in ik.documentElement.style,L8=!Fb&&/Apple Computer/.test(tr.vendor),ZR=L8&&(/Mobile\/\w+/.test(tr.userAgent)||tr.maxTouchPoints>2);var Ne={mac:ZR||/Mac/.test(tr.platform),windows:/Win/.test(tr.platform),linux:/Linux|X11/.test(tr.platform),ie:Fb,ie_version:O8?ik.documentMode||6:sk?+sk[1]:rk?+rk[1]:0,gecko:JR,gecko_version:JR?+(/Firefox\/(\d+)/.exec(tr.userAgent)||[0,0])[1]:0,chrome:!!Vx,chrome_version:Vx?+Vx[1]:0,ios:ZR,android:/Android\b/.test(tr.userAgent),safari:L8,webkit_version:oee?+(/\bAppleWebKit\/(\d+)/.exec(tr.userAgent)||[0,0])[1]:0,tabSize:ik.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const aee=256;class Ds extends Gt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,n){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(n&&n.node==this.dom&&(n.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,n,i){return this.flags&8||i&&(!(i instanceof Ds)||this.length-(n-e)+i.length>aee||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(n),this.markDirty(),!0)}split(e){let n=new Ds(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),n.flags|=this.flags&8,n}localPosFromDOM(e,n){return e==this.dom?n:n?this.text.length:0}domAtPos(e){return new xi(this.dom,e)}domBoundsAround(e,n,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,n){return lee(this.dom,e,n)}}class ya extends Gt{constructor(e,n=[],i=0){super(),this.mark=e,this.children=n,this.length=i;for(let r of n)r.setParent(this)}setAttrs(e){if(A8(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let n in this.mark.attrs)e.setAttribute(n,this.mark.attrs[n]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,n){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,n)}merge(e,n,i,r,s,o){return i&&(!(i instanceof ya&&i.mark.eq(this.mark))||e&&s<=0||n<this.length&&o<=0)?!1:(T8(this,e,n,i?i.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let n=[],i=0,r=-1,s=0;for(let a of this.children){let l=i+a.length;l>e&&n.push(i<e?a.split(e-i):a),r<0&&i>=e&&(r=s),i=l,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new ya(this.mark,n,o)}domAtPos(e){return D8(this,e)}coordsAt(e,n){return B8(this,e,n)}}function lee(t,e,n){let i=t.nodeValue.length;e>i&&(e=i);let r=e,s=e,o=0;e==0&&n<0||e==i&&n>=0?Ne.chrome||Ne.gecko||(e?(r--,o=1):s<i&&(s++,o=-1)):n<0?r--:s<i&&s++;let a=nu(t,r,s).getClientRects();if(!a.length)return null;let l=a[(o?o<0:n>=0)?0:a.length-1];return Ne.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,c=>c.width)||l),o?$b(l,o<0):l||null}class al extends Gt{static create(e,n,i){return new al(e,n,i)}constructor(e,n,i){super(),this.widget=e,this.length=n,this.side=i,this.prevWidget=null}split(e){let n=al.create(this.widget,this.length-e,this.side);return this.length-=e,n}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,n,i,r,s,o){return i&&(!(i instanceof al)||!this.widget.compare(i.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-n),!0)}become(e){return e instanceof al&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return At.empty;let e=this;for(;e.parent;)e=e.parent;let{view:n}=e,i=n&&n.state.doc,r=this.posAtStart;return i?i.slice(r,r+this.length):At.empty}domAtPos(e){return(this.length?e==0:this.side>0)?xi.before(this.dom):xi.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,n){let i=this.widget.coordsAt(this.dom,e,n);if(i)return i;let r=this.dom.getClientRects(),s=null;if(!r.length)return null;let o=this.side?this.side<0:e>0;for(let a=o?r.length-1:0;s=r[a],!(e>0?a==0:a==r.length-1||s.top<s.bottom);a+=o?-1:1);return $b(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class cf extends Gt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof cf&&e.side==this.side}split(){return new cf(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?xi.before(this.dom):xi.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return At.empty}get isHidden(){return!0}}Ds.prototype.children=al.prototype.children=cf.prototype.children=fE;function D8(t,e){let n=t.dom,{children:i}=t,r=0;for(let s=0;r<i.length;r++){let o=i[r],a=s+o.length;if(!(a==s&&o.getSide()<=0)){if(e>s&&e<a&&o.dom.parentNode==n)return o.domAtPos(e-s);if(e<=s)break;s=a}}for(let s=r;s>0;s--){let o=i[s-1];if(o.dom.parentNode==n)return o.domAtPos(o.length)}for(let s=r;s<i.length;s++){let o=i[s];if(o.dom.parentNode==n)return o.domAtPos(0)}return new xi(n,0)}function j8(t,e,n){let i,{children:r}=t;n>0&&e instanceof ya&&r.length&&(i=r[r.length-1])instanceof ya&&i.mark.eq(e.mark)?j8(i,e.children[0],n-1):(r.push(e),e.setParent(t)),t.length+=e.length}function B8(t,e,n){let i=null,r=-1,s=null,o=-1;function a(c,u){for(let d=0,f=0;d<c.children.length&&f<=u;d++){let p=c.children[d],m=f+p.length;m>=u&&(p.children.length?a(p,u-f):(!s||s.isHidden&&(n>0||uee(s,p)))&&(m>u||f==m&&p.getSide()>0)?(s=p,o=u-f):(f<u||f==m&&p.getSide()<0&&!p.isHidden)&&(i=p,r=u-f)),f=m}}a(t,e);let l=(n<0?i:s)||i||s;return l?l.coordsAt(Math.max(0,l==i?r:o),n):cee(t)}function cee(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let n=qp(e);return n[n.length-1]||null}function uee(t,e){let n=t.coordsAt(0,1),i=e.coordsAt(0,1);return n&&i&&i.top<n.bottom}function ok(t,e){for(let n in t)n=="class"&&e.class?e.class+=" "+t.class:n=="style"&&e.style?e.style+=";"+t.style:e[n]=t[n];return e}const QR=Object.create(null);function hy(t,e,n){if(t==e)return!0;t||(t=QR),e||(e=QR);let i=Object.keys(t),r=Object.keys(e);if(i.length-(n&&i.indexOf(n)>-1?1:0)!=r.length-(n&&r.indexOf(n)>-1?1:0))return!1;for(let s of i)if(s!=n&&(r.indexOf(s)==-1||t[s]!==e[s]))return!1;return!0}function ak(t,e,n){let i=!1;if(e)for(let r in e)n&&r in n||(i=!0,r=="style"?t.style.cssText="":t.removeAttribute(r));if(n)for(let r in n)e&&e[r]==n[r]||(i=!0,r=="style"?t.style.cssText=n[r]:t.setAttribute(r,n[r]));return i}function dee(t){let e=Object.create(null);for(let n=0;n<t.attributes.length;n++){let i=t.attributes[n];e[i.name]=i.value}return e}class ec{eq(e){return!1}updateDOM(e,n){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,n,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Oi=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(Oi||(Oi={}));class ht extends eu{constructor(e,n,i,r){super(),this.startSide=e,this.endSide=n,this.widget=i,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Tm(e)}static widget(e){let n=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return n+=i&&!e.inlineOrder?n>0?3e8:-4e8:n>0?1e8:-1e8,new Ul(e,n,n,i,e.widget||null,!1)}static replace(e){let n=!!e.block,i,r;if(e.isBlockGap)i=-5e8,r=4e8;else{let{start:s,end:o}=$8(e,n);i=(s?n?-3e8:-1:5e8)-1,r=(o?n?2e8:1:-6e8)+1}return new Ul(e,i,r,n,e.widget||null,!0)}static line(e){return new Om(e)}static set(e,n=!1){return Ot.of(e,n)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ht.none=Ot.empty;class Tm extends ht{constructor(e){let{start:n,end:i}=$8(e);super(n?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var n,i;return this==e||e instanceof Tm&&this.tagName==e.tagName&&(this.class||((n=this.attrs)===null||n===void 0?void 0:n.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&hy(this.attrs,e.attrs,"class")}range(e,n=e){if(e>=n)throw new RangeError("Mark decorations may not be empty");return super.range(e,n)}}Tm.prototype.point=!1;class Om extends ht{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Om&&this.spec.class==e.spec.class&&hy(this.spec.attributes,e.spec.attributes)}range(e,n=e){if(n!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,n)}}Om.prototype.mapMode=nr.TrackBefore;Om.prototype.point=!0;class Ul extends ht{constructor(e,n,i,r,s,o){super(n,i,s,e),this.block=r,this.isReplace=o,this.mapMode=r?n<=0?nr.TrackBefore:nr.TrackAfter:nr.TrackDel}get type(){return this.startSide!=this.endSide?Oi.WidgetRange:this.startSide<=0?Oi.WidgetBefore:Oi.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Ul&&fee(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,n=e){if(this.isReplace&&(e>n||e==n&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&n!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,n)}}Ul.prototype.point=!0;function $8(t,e=!1){let{inclusiveStart:n,inclusiveEnd:i}=t;return n==null&&(n=t.inclusive),i==null&&(i=t.inclusive),{start:n??e,end:i??e}}function fee(t,e){return t==e||!!(t&&e&&t.compare(e))}function J0(t,e,n,i=0){let r=n.length-1;r>=0&&n[r]+i>=t?n[r]=Math.max(n[r],e):n.push(t,e)}class Mn extends Gt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,n,i,r,s,o){if(i){if(!(i instanceof Mn))return!1;this.dom||i.transferDOM(this)}return r&&this.setDeco(i?i.attrs:null),T8(this,e,n,i?i.children.slice():[],s,o),!0}split(e){let n=new Mn;if(n.breakAfter=this.breakAfter,this.length==0)return n;let{i,off:r}=this.childPos(e);r&&(n.append(this.children[i].split(r),0),this.children[i].merge(r,this.children[i].length,null,!1,0,0),i++);for(let s=i;s<this.children.length;s++)n.append(this.children[s],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,n}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){hy(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,n){j8(this,e,n)}addLineDeco(e){let n=e.spec.attributes,i=e.spec.class;n&&(this.attrs=ok(n,this.attrs||{})),i&&(this.attrs=ok({class:i},this.attrs||{}))}domAtPos(e){return D8(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,n){var i;this.dom?this.flags&4&&(A8(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(ak(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,n);let r=this.dom.lastChild;for(;r&&Gt.get(r)instanceof ya;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((i=Gt.get(r))===null||i===void 0?void 0:i.isEditable)==!1&&(!Ne.ios||!this.children.some(s=>s instanceof Ds))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,n;for(let i of this.children){if(!(i instanceof Ds)||/[^ -~]/.test(i.text))return null;let r=qp(i.dom);if(r.length!=1)return null;e+=r[0].width,n=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:n}:null}coordsAt(e,n){let i=B8(this,e,n);if(!this.children.length&&i&&this.parent){let{heightOracle:r}=this.parent.view.viewState,s=i.bottom-i.top;if(Math.abs(s-r.lineHeight)<2&&r.textHeight<s){let o=(s-r.textHeight)/2;return{top:i.top+o,bottom:i.bottom-o,left:i.left,right:i.left}}}return i}become(e){return e instanceof Mn&&this.children.length==0&&e.children.length==0&&hy(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,n){for(let i=0,r=0;i<e.children.length;i++){let s=e.children[i],o=r+s.length;if(o>=n){if(s instanceof Mn)return s;if(o>n)break}r=o+s.breakAfter}return null}}class ca extends Gt{constructor(e,n,i){super(),this.widget=e,this.length=n,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,n,i,r,s,o){return i&&(!(i instanceof ca)||!this.widget.compare(i.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-n),!0)}domAtPos(e){return e==0?xi.before(this.dom):xi.after(this.dom,e==this.length)}split(e){let n=this.length-e;this.length=e;let i=new ca(this.widget,n,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return fE}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):At.empty}domBoundsAround(){return null}become(e){return e instanceof ca&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,n){let i=this.widget.coordsAt(this.dom,e,n);return i||(this.widget instanceof lk?null:$b(this.dom.getBoundingClientRect(),this.length?e==0:n<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:n,endSide:i}=this.deco;return n==i?!1:e<0?n<0:i>0}}class lk extends ec{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Qh{constructor(e,n,i,r){this.doc=e,this.pos=n,this.end=i,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=n}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof ca&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Mn),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Lg(new cf(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof ca)&&this.getLine()}buildText(e,n,i){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(n.slice(n.length-i)),this.getLine().append(Lg(new Ds(this.text.slice(this.textOff,this.textOff+r)),n),i),this.atCursorPos=!0,this.textOff+=r,e-=r,i=0}}span(e,n,i,r){this.buildText(n-e,i,r),this.pos=n,this.openStart<0&&(this.openStart=r)}point(e,n,i,r,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof Ul){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(n>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=n-e;if(i instanceof Ul)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new ca(i.widget||uf.block,a,i));else{let l=al.create(i.widget||uf.inline,a,a?0:i.startSide),c=this.atCursorPos&&!l.isEditable&&s<=r.length&&(e<n||i.startSide>0),u=!l.isEditable&&(e<n||s>r.length||i.startSide<=0),d=this.getLine();this.pendingBuffer==2&&!c&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),c&&(d.append(Lg(new cf(1),r),s),s=r.length+Math.max(0,s-r.length)),d.append(Lg(l,r),s),this.atCursorPos=u,this.pendingBuffer=u?e<n||s>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=n),this.openStart<0&&(this.openStart=s)}static build(e,n,i,r,s){let o=new Qh(e,n,i,s);return o.openEnd=Ot.spans(r,n,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function Lg(t,e){for(let n of e)t=new ya(n,[t],t.length);return t}class uf extends ec{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}uf.inline=new uf("span");uf.block=new uf("div");var rn=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(rn||(rn={}));const iu=rn.LTR,hE=rn.RTL;function F8(t){let e=[];for(let n=0;n<t.length;n++)e.push(1<<+t[n]);return e}const hee=F8("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),pee=F8("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),ck=Object.create(null),Ws=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),n=t.charCodeAt(1);ck[e]=n,ck[n]=-e}function z8(t){return t<=247?hee[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?pee[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const mee=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ll{get dir(){return this.level%2?hE:iu}constructor(e,n,i){this.from=e,this.to=n,this.level=i}side(e,n){return this.dir==n==e?this.to:this.from}forward(e,n){return e==(this.dir==n)}static find(e,n,i,r){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=n&&a.to>=n){if(a.level==i)return o;(s<0||(r!=0?r<0?a.from<n:a.to>n:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function U8(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++){let i=t[n],r=e[n];if(i.from!=r.from||i.to!=r.to||i.direction!=r.direction||!U8(i.inner,r.inner))return!1}return!0}const Ht=[];function gee(t,e,n,i,r){for(let s=0;s<=i.length;s++){let o=s?i[s-1].to:e,a=s<i.length?i[s].from:n,l=s?256:r;for(let c=o,u=l,d=l;c<a;c++){let f=z8(t.charCodeAt(c));f==512?f=u:f==8&&d==4&&(f=16),Ht[c]=f==4?2:f,f&7&&(d=f),u=f}for(let c=o,u=l,d=l;c<a;c++){let f=Ht[c];if(f==128)c<a-1&&u==Ht[c+1]&&u&24?f=Ht[c]=u:Ht[c]=256;else if(f==64){let p=c+1;for(;p<a&&Ht[p]==64;)p++;let m=c&&u==8||p<n&&Ht[p]==8?d==1?1:8:256;for(let g=c;g<p;g++)Ht[g]=m;c=p-1}else f==8&&d==1&&(Ht[c]=1);u=f,f&7&&(d=f)}}}function vee(t,e,n,i,r){let s=r==1?2:1;for(let o=0,a=0,l=0;o<=i.length;o++){let c=o?i[o-1].to:e,u=o<i.length?i[o].from:n;for(let d=c,f,p,m;d<u;d++)if(p=ck[f=t.charCodeAt(d)])if(p<0){for(let g=a-3;g>=0;g-=3)if(Ws[g+1]==-p){let y=Ws[g+2],v=y&2?r:y&4?y&1?s:r:0;v&&(Ht[d]=Ht[Ws[g]]=v),a=g;break}}else{if(Ws.length==189)break;Ws[a++]=d,Ws[a++]=f,Ws[a++]=l}else if((m=Ht[d])==2||m==1){let g=m==r;l=g?0:1;for(let y=a-3;y>=0;y-=3){let v=Ws[y+2];if(v&2)break;if(g)Ws[y+2]|=2;else{if(v&4)break;Ws[y+2]|=4}}}}}function yee(t,e,n,i){for(let r=0,s=i;r<=n.length;r++){let o=r?n[r-1].to:t,a=r<n.length?n[r].from:e;for(let l=o;l<a;){let c=Ht[l];if(c==256){let u=l+1;for(;;)if(u==a){if(r==n.length)break;u=n[r++].to,a=r<n.length?n[r].from:e}else if(Ht[u]==256)u++;else break;let d=s==1,f=(u<e?Ht[u]:i)==1,p=d==f?d?1:2:i;for(let m=u,g=r,y=g?n[g-1].to:t;m>l;)m==y&&(m=n[--g].from,y=g?n[g-1].to:t),Ht[--m]=p;l=u}else s=c,l++}}}function uk(t,e,n,i,r,s,o){let a=i%2?2:1;if(i%2==r%2)for(let l=e,c=0;l<n;){let u=!0,d=!1;if(c==s.length||l<s[c].from){let g=Ht[l];g!=a&&(u=!1,d=g==16)}let f=!u&&a==1?[]:null,p=u?i:i+1,m=l;e:for(;;)if(c<s.length&&m==s[c].from){if(d)break e;let g=s[c];if(!u)for(let y=g.to,v=c+1;;){if(y==n)break e;if(v<s.length&&s[v].from==y)y=s[v++].to;else{if(Ht[y]==a)break e;break}}if(c++,f)f.push(g);else{g.from>l&&o.push(new ll(l,g.from,p));let y=g.direction==iu!=!(p%2);dk(t,y?i+1:i,r,g.inner,g.from,g.to,o),l=g.to}m=g.to}else{if(m==n||(u?Ht[m]!=a:Ht[m]==a))break;m++}f?uk(t,l,m,i+1,r,f,o):l<m&&o.push(new ll(l,m,p)),l=m}else for(let l=n,c=s.length;l>e;){let u=!0,d=!1;if(!c||l>s[c-1].to){let g=Ht[l-1];g!=a&&(u=!1,d=g==16)}let f=!u&&a==1?[]:null,p=u?i:i+1,m=l;e:for(;;)if(c&&m==s[c-1].to){if(d)break e;let g=s[--c];if(!u)for(let y=g.from,v=c;;){if(y==e)break e;if(v&&s[v-1].to==y)y=s[--v].from;else{if(Ht[y-1]==a)break e;break}}if(f)f.push(g);else{g.to<l&&o.push(new ll(g.to,l,p));let y=g.direction==iu!=!(p%2);dk(t,y?i+1:i,r,g.inner,g.from,g.to,o),l=g.from}m=g.from}else{if(m==e||(u?Ht[m-1]!=a:Ht[m-1]==a))break;m--}f?uk(t,m,l,i+1,r,f,o):m<l&&o.push(new ll(m,l,p)),l=m}}function dk(t,e,n,i,r,s,o){let a=e%2?2:1;gee(t,r,s,i,a),vee(t,r,s,i,a),yee(r,s,i,a),uk(t,r,s,e,n,i,o)}function bee(t,e,n){if(!t)return[new ll(0,0,e==hE?1:0)];if(e==iu&&!n.length&&!mee.test(t))return V8(t.length);if(n.length)for(;t.length>Ht.length;)Ht[Ht.length]=256;let i=[],r=e==iu?0:1;return dk(t,r,r,n,0,t.length,i),i}function V8(t){return[new ll(0,t,0)]}let H8="";function xee(t,e,n,i,r){var s;let o=i.head-t.from,a=ll.find(e,o,(s=i.bidiLevel)!==null&&s!==void 0?s:-1,i.assoc),l=e[a],c=l.side(r,n);if(o==c){let f=a+=r?1:-1;if(f<0||f>=e.length)return null;l=e[a=f],o=l.side(!r,n),c=l.side(r,n)}let u=si(t.text,o,l.forward(r,n));(u<l.from||u>l.to)&&(u=c),H8=t.text.slice(Math.min(o,u),Math.max(o,u));let d=a==(r?e.length-1:0)?null:e[a+(r?1:-1)];return d&&u==c&&d.level+(r?0:1)<l.level?le.cursor(d.side(!r,n)+t.from,d.forward(r,n)?1:-1,d.level):le.cursor(u+t.from,l.forward(r,n)?-1:1,l.level)}function wee(t,e,n){for(let i=e;i<n;i++){let r=z8(t.charCodeAt(i));if(r==1)return iu;if(r==2||r==4)return hE}return iu}const W8=Re.define(),G8=Re.define(),q8=Re.define(),K8=Re.define(),fk=Re.define(),X8=Re.define(),Y8=Re.define(),pE=Re.define(),mE=Re.define(),J8=Re.define({combine:t=>t.some(e=>e)}),Z8=Re.define({combine:t=>t.some(e=>e)}),Q8=Re.define();class kd{constructor(e,n="nearest",i="nearest",r=5,s=5,o=!1){this.range=e,this.y=n,this.x=i,this.yMargin=r,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new kd(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new kd(le.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Dg=ft.define({map:(t,e)=>t.map(e)}),e6=ft.define();function Cr(t,e,n){let i=t.facet(K8);i.length?i[0](e):window.onerror&&window.onerror(String(e),n,void 0,void 0,e)||(n?console.error(n+":",e):console.error(e))}const ra=Re.define({combine:t=>t.length?t[0]:!0});let See=0;const ad=Re.define({combine(t){return t.filter((e,n)=>{for(let i=0;i<n;i++)if(t[i].plugin==e.plugin)return!1;return!0})}});class ui{constructor(e,n,i,r,s){this.id=e,this.create=n,this.domEventHandlers=i,this.domEventObservers=r,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(ad.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(ad.of({plugin:this,arg:e}))}static define(e,n){const{eventHandlers:i,eventObservers:r,provide:s,decorations:o}=n||{};return new ui(See++,e,i,r,a=>{let l=[];return o&&l.push(Kp.of(c=>{let u=c.plugin(a);return u?o(u):ht.none})),s&&l.push(s(a)),l})}static fromClass(e,n){return ui.define((i,r)=>new e(i,r),n)}}class Hx{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let n=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(n)}catch(i){if(Cr(n.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(n){Cr(e.state,n,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var n;if(!((n=this.value)===null||n===void 0)&&n.destroy)try{this.value.destroy()}catch(i){Cr(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const t6=Re.define(),gE=Re.define(),Kp=Re.define(),n6=Re.define(),vE=Re.define(),i6=Re.define();function eI(t,e){let n=t.state.facet(i6);if(!n.length)return n;let i=n.map(s=>s instanceof Function?s(t):s),r=[];return Ot.spans(i,e.from,e.to,{point(){},span(s,o,a,l){let c=s-e.from,u=o-e.from,d=r;for(let f=a.length-1;f>=0;f--,l--){let p=a[f].spec.bidiIsolate,m;if(p==null&&(p=wee(e.text,c,u)),l>0&&d.length&&(m=d[d.length-1]).to==c&&m.direction==p)m.to=u,d=m.inner;else{let g={from:c,to:u,direction:p,inner:[]};d.push(g),d=g.inner}}}}),r}const r6=Re.define();function yE(t){let e=0,n=0,i=0,r=0;for(let s of t.state.facet(r6)){let o=s(t);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(n=Math.max(n,o.right)),o.top!=null&&(i=Math.max(i,o.top)),o.bottom!=null&&(r=Math.max(r,o.bottom)))}return{left:e,right:n,top:i,bottom:r}}const Ch=Re.define();class ss{constructor(e,n,i,r){this.fromA=e,this.toA=n,this.fromB=i,this.toB=r}join(e){return new ss(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let n=e.length,i=this;for(;n>0;n--){let r=e[n-1];if(!(r.fromA>i.toA)){if(r.toA<i.fromA)break;i=i.join(r),e.splice(n-1,1)}}return e.splice(n,0,i),e}static extendWithRanges(e,n){if(n.length==0)return e;let i=[];for(let r=0,s=0,o=0,a=0;;r++){let l=r==e.length?null:e[r],c=o-a,u=l?l.fromB:1e9;for(;s<n.length&&n[s]<u;){let d=n[s],f=n[s+1],p=Math.max(a,d),m=Math.min(u,f);if(p<=m&&new ss(p+c,m+c,p,m).addToSet(i),f>u)break;s+=2}if(!l)return i;new ss(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,a=l.toB}}}class py{constructor(e,n,i){this.view=e,this.state=n,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=jn.empty(this.startState.doc.length);for(let s of i)this.changes=this.changes.compose(s.changes);let r=[];this.changes.iterChangedRanges((s,o,a,l)=>r.push(new ss(s,o,a,l))),this.changedRanges=r}static create(e,n,i){return new py(e,n,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class tI extends Gt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=ht.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Mn],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ss(0,0,0,e.state.doc.length)],0,null)}update(e){var n;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:c,toA:u})=>u<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let r=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((n=this.domChanged)===null||n===void 0)&&n.newSel?r=this.domChanged.newSel.head:!Nee(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let s=r>-1?_ee(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:u}=this.hasComposition;i=new ss(c,u,e.changes.mapPos(c,-1),e.changes.mapPos(u,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Ne.ie||Ne.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.updateDeco(),l=Aee(o,a,e.changes);return i=ss.extendWithRanges(i,l),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,n,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,n,i);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=Ne.chrome||Ne.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||r.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof ca&&o.widget instanceof lk&&s.push(o.dom);r.updateGaps(s)}updateChildren(e,n,i){let r=i?i.range.addToSet(e.slice()):e,s=this.childCursor(n);for(let o=r.length-1;;o--){let a=o>=0?r[o]:null;if(!a)break;let{fromA:l,toA:c,fromB:u,toB:d}=a,f,p,m,g;if(i&&i.range.fromB<d&&i.range.toB>u){let k=Qh.build(this.view.state.doc,u,i.range.fromB,this.decorations,this.dynamicDecorationMap),C=Qh.build(this.view.state.doc,i.range.toB,d,this.decorations,this.dynamicDecorationMap);p=k.breakAtStart,m=k.openStart,g=C.openEnd;let E=this.compositionView(i);C.breakAtStart?E.breakAfter=1:C.content.length&&E.merge(E.length,E.length,C.content[0],!1,C.openStart,0)&&(E.breakAfter=C.content[0].breakAfter,C.content.shift()),k.content.length&&E.merge(0,0,k.content[k.content.length-1],!0,0,k.openEnd)&&k.content.pop(),f=k.content.concat(E).concat(C.content)}else({content:f,breakAtStart:p,openStart:m,openEnd:g}=Qh.build(this.view.state.doc,u,d,this.decorations,this.dynamicDecorationMap));let{i:y,off:v}=s.findPos(c,1),{i:b,off:w}=s.findPos(l,-1);I8(this,b,w,y,v,f,p,m,g)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let n of e.transactions)for(let i of n.effects)i.is(e6)&&(this.editContextFormatting=i.value)}compositionView(e){let n=new Ds(e.text.nodeValue);n.flags|=8;for(let{deco:r}of e.marks)n=new ya(r,[n],n.length);let i=new Mn;return i.append(n,0),i}fixCompositionDOM(e){let n=(s,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let a=Gt.get(s);a&&a!=o&&(a.dom=null),o.setDOM(s)},i=this.childPos(e.range.fromB,1),r=this.children[i.i];n(e.line,r);for(let s=e.marks.length-1;s>=-1;s--)i=r.childPos(i.off,1),r=r.children[i.i],n(s>=0?e.marks[s].node:e.text,r)}updateSelection(e=!1,n=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,r=i==this.dom,s=!r&&!(this.view.state.facet(ra)||this.dom.tabIndex>-1)&&Y0(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(r||n||s))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),c=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(Ne.gecko&&a.empty&&!this.hasComposition&&kee(l)){let d=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(d,l.node.childNodes[l.offset]||null)),l=c=new xi(d,0),o=!0}let u=this.view.observer.selectionRange;(o||!u.focusNode||(!Zh(l.node,l.offset,u.anchorNode,u.anchorOffset)||!Zh(c.node,c.offset,u.focusNode,u.focusOffset))&&!this.suppressWidgetCursorChange(u,a))&&(this.view.observer.ignore(()=>{Ne.android&&Ne.chrome&&this.dom.contains(u.focusNode)&&Pee(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let d=Gp(this.view.root);if(d)if(a.empty){if(Ne.gecko){let f=Cee(l.node,l.offset);if(f&&f!=3){let p=(f==1?N8:M8)(l.node,l.offset);p&&(l=new xi(p.node,p.offset))}}d.collapse(l.node,l.offset),a.bidiLevel!=null&&d.caretBidiLevel!==void 0&&(d.caretBidiLevel=a.bidiLevel)}else if(d.extend){d.collapse(l.node,l.offset);try{d.extend(c.node,c.offset)}catch{}}else{let f=document.createRange();a.anchor>a.head&&([l,c]=[c,l]),f.setEnd(c.node,c.offset),f.setStart(l.node,l.offset),d.removeAllRanges(),d.addRange(f)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new xi(u.anchorNode,u.anchorOffset),this.impreciseHead=c.precise?null:new xi(u.focusNode,u.focusOffset)}suppressWidgetCursorChange(e,n){return this.hasComposition&&n.empty&&Zh(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==n.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,n=e.state.selection.main,i=Gp(e.root),{anchorNode:r,anchorOffset:s}=e.observer.selectionRange;if(!i||!n.empty||!n.assoc||!i.modify)return;let o=Mn.find(this,n.head);if(!o)return;let a=o.posAtStart;if(n.head==a||n.head==a+o.length)return;let l=this.coordsAt(n.head,-1),c=this.coordsAt(n.head,1);if(!l||!c||l.bottom>c.top)return;let u=this.domAtPos(n.head+n.assoc);i.collapse(u.node,u.offset),i.modify("move",n.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let d=e.observer.selectionRange;e.docView.posFromDOM(d.anchorNode,d.anchorOffset)!=n.from&&i.collapse(r,s)}moveToLine(e){let n=this.dom,i;if(e.node!=n)return e;for(let r=e.offset;!i&&r<n.childNodes.length;r++){let s=Gt.get(n.childNodes[r]);s instanceof Mn&&(i=s.domAtPos(0))}for(let r=e.offset-1;!i&&r>=0;r--){let s=Gt.get(n.childNodes[r]);s instanceof Mn&&(i=s.domAtPos(s.length))}return i?new xi(i.node,i.offset,!0):e}nearest(e){for(let n=e;n;){let i=Gt.get(n);if(i&&i.rootView==this)return i;n=n.parentNode}return null}posFromDOM(e,n){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,n)+i.posAtStart}domAtPos(e){let{i:n,off:i}=this.childCursor().findPos(e,-1);for(;n<this.children.length-1;){let r=this.children[n];if(i<r.length||r instanceof Mn)break;n++,i=0}return this.children[n].domAtPos(i)}coordsAt(e,n){let i=null,r=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=s-a.breakAfter,c=l-a.length;if(l<e)break;if(c<=e&&(c<e||a.covers(-1))&&(l>e||a.covers(1))&&(!i||a instanceof Mn&&!(i instanceof Mn&&n>=0)))i=a,r=c;else if(i&&c==e&&l==e&&a instanceof ca&&Math.abs(n)<2){if(a.deco.startSide<0)break;o&&(i=null)}s=c}return i?i.coordsAt(e-r,n):null}coordsForChar(e){let{i:n,off:i}=this.childPos(e,1),r=this.children[n];if(!(r instanceof Mn))return null;for(;r.children.length;){let{i:a,off:l}=r.childPos(i,1);for(;;a++){if(a==r.children.length)return null;if((r=r.children[a]).length)break}i=l}if(!(r instanceof Ds))return null;let s=si(r.text,i);if(s==i)return null;let o=nu(r.dom,i,s).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let n=[],{from:i,to:r}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==rn.LTR;for(let c=0,u=0;u<this.children.length;u++){let d=this.children[u],f=c+d.length;if(f>r)break;if(c>=i){let p=d.dom.getBoundingClientRect();if(n.push(p.height),o){let m=d.dom.lastChild,g=m?qp(m):[];if(g.length){let y=g[g.length-1],v=l?y.right-p.left:p.right-y.left;v>a&&(a=v,this.minWidth=s,this.minWidthFrom=c,this.minWidthTo=f)}}}c=f+d.breakAfter}return n}textDirectionAt(e){let{i:n}=this.childPos(e,1);return getComputedStyle(this.children[n].dom).direction=="rtl"?rn.RTL:rn.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Mn){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),n,i,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=qp(e.firstChild)[0];n=e.getBoundingClientRect().height,i=s?s.width/27:7,r=s?s.height:n,e.remove()}),{lineHeight:n,charWidth:i,textHeight:r}}childCursor(e=this.length){let n=this.children.length;return n&&(e-=this.children[--n].length),new R8(this.children,e,n)}computeBlockGapDeco(){let e=[],n=this.view.viewState;for(let i=0,r=0;;r++){let s=r==n.viewports.length?null:n.viewports[r],o=s?s.from-1:this.length;if(o>i){let a=(n.lineBlockAt(o).bottom-n.lineBlockAt(i).top)/this.view.scaleY;e.push(ht.replace({widget:new lk(a),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return ht.set(e)}updateDeco(){let e=1,n=this.view.state.facet(Kp).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),i=!1,r=this.view.state.facet(n6).map((s,o)=>{let a=typeof s=="function";return a&&(i=!0),a?s(this.view):s});for(r.length&&(this.dynamicDecorationMap[e++]=i,n.push(Ot.join(r))),this.decorations=[this.editContextFormatting,...n,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(Q8))try{if(c(this.view,e.range,e))return!0}catch(u){Cr(this.view.state,u,"scroll handler")}let{range:n}=e,i=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1),r;if(!i)return;!n.empty&&(r=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(i={left:Math.min(i.left,r.left),top:Math.min(i.top,r.top),right:Math.max(i.right,r.right),bottom:Math.max(i.bottom,r.bottom)});let s=yE(this.view),o={left:i.left-s.left,top:i.top-s.top,right:i.right+s.right,bottom:i.bottom+s.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;tee(this.view.scrollDOM,o,n.head<n.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==rn.LTR)}}function kee(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}function s6(t,e){let n=t.observer.selectionRange;if(!n.focusNode)return null;let i=N8(n.focusNode,n.focusOffset),r=M8(n.focusNode,n.focusOffset),s=i||r;if(r&&i&&r.node!=i.node){let a=Gt.get(r.node);if(!a||a instanceof Ds&&a.text!=r.node.nodeValue)s=r;else if(t.docView.lastCompositionAfterCursor){let l=Gt.get(i.node);!l||l instanceof Ds&&l.text!=i.node.nodeValue||(s=r)}}if(t.docView.lastCompositionAfterCursor=s!=i,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function _ee(t,e,n){let i=s6(t,n);if(!i)return null;let{node:r,from:s,to:o}=i,a=r.nodeValue;if(/[\n\r]/.test(a)||t.state.doc.sliceString(i.from,i.to)!=a)return null;let l=e.invertedDesc,c=new ss(l.mapPos(s),l.mapPos(o),s,o),u=[];for(let d=r.parentNode;;d=d.parentNode){let f=Gt.get(d);if(f instanceof ya)u.push({node:d,deco:f.mark});else{if(f instanceof Mn||d.nodeName=="DIV"&&d.parentNode==t.contentDOM)return{range:c,text:r,marks:u,line:d};if(d!=t.contentDOM)u.push({node:d,deco:new Tm({inclusive:!0,attributes:dee(d),tagName:d.tagName.toLowerCase()})});else return null}}}function Cee(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}let Eee=class{constructor(){this.changes=[]}compareRange(e,n){J0(e,n,this.changes)}comparePoint(e,n){J0(e,n,this.changes)}boundChange(e){J0(e,e,this.changes)}};function Aee(t,e,n){let i=new Eee;return Ot.compare(t,e,n,i),i.changes}function Pee(t,e){for(let n=t;n&&n!=e;n=n.assignedSlot||n.parentNode)if(n.nodeType==1&&n.contentEditable=="false")return!0;return!1}function Nee(t,e){let n=!1;return e&&t.iterChangedRanges((i,r)=>{i<e.to&&r>e.from&&(n=!0)}),n}function Mee(t,e,n=1){let i=t.charCategorizer(e),r=t.doc.lineAt(e),s=e-r.from;if(r.length==0)return le.cursor(e);s==0?n=1:s==r.length&&(n=-1);let o=s,a=s;n<0?o=si(r.text,s,!1):a=si(r.text,s);let l=i(r.text.slice(o,a));for(;o>0;){let c=si(r.text,o,!1);if(i(r.text.slice(c,o))!=l)break;o=c}for(;a<r.length;){let c=si(r.text,a);if(i(r.text.slice(a,c))!=l)break;a=c}return le.range(o+r.from,a+r.from)}function Ree(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function Iee(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Wx(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function nI(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function iI(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function hk(t,e,n){let i,r,s,o,a=!1,l,c,u,d;for(let m=t.firstChild;m;m=m.nextSibling){let g=qp(m);for(let y=0;y<g.length;y++){let v=g[y];r&&Wx(r,v)&&(v=nI(iI(v,r.bottom),r.top));let b=Ree(e,v),w=Iee(n,v);if(b==0&&w==0)return m.nodeType==3?rI(m,e,n):hk(m,e,n);(!i||o>w||o==w&&s>b)&&(i=m,r=v,s=b,o=w,a=b?e<v.left?y>0:y<g.length-1:!0),b==0?n>v.bottom&&(!u||u.bottom<v.bottom)?(l=m,u=v):n<v.top&&(!d||d.top>v.top)&&(c=m,d=v):u&&Wx(u,v)?u=iI(u,v.bottom):d&&Wx(d,v)&&(d=nI(d,v.top))}}if(u&&u.bottom>=n?(i=l,r=u):d&&d.top<=n&&(i=c,r=d),!i)return{node:t,offset:0};let f=Math.max(r.left,Math.min(r.right,e));if(i.nodeType==3)return rI(i,f,n);if(a&&i.contentEditable!="false")return hk(i,f,n);let p=Array.prototype.indexOf.call(t.childNodes,i)+(e>=(r.left+r.right)/2?1:0);return{node:t,offset:p}}function rI(t,e,n){let i=t.nodeValue.length,r=-1,s=1e9,o=0;for(let a=0;a<i;a++){let l=nu(t,a,a+1).getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(u.top==u.bottom)continue;o||(o=e-u.left);let d=(u.top>n?u.top-n:n-u.bottom)-1;if(u.left-1<=e&&u.right+1>=e&&d<s){let f=e>=(u.left+u.right)/2,p=f;if((Ne.chrome||Ne.gecko)&&nu(t,a).getBoundingClientRect().left==u.right&&(p=!f),d<=0)return{node:t,offset:a+(p?1:0)};r=a+(p?1:0),s=d}}}return{node:t,offset:r>-1?r:o>0?t.nodeValue.length:0}}function o6(t,e,n,i=-1){var r,s;let o=t.contentDOM.getBoundingClientRect(),a=o.top+t.viewState.paddingTop,l,{docHeight:c}=t.viewState,{x:u,y:d}=e,f=d-a;if(f<0)return 0;if(f>c)return t.state.doc.length;for(let k=t.viewState.heightOracle.textHeight/2,C=!1;l=t.elementAtHeight(f),l.type!=Oi.Text;)for(;f=i>0?l.bottom+k:l.top-k,!(f>=0&&f<=c);){if(C)return n?null:0;C=!0,i=-i}d=a+f;let p=l.from;if(p<t.viewport.from)return t.viewport.from==0?0:n?null:sI(t,o,l,u,d);if(p>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:sI(t,o,l,u,d);let m=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:m,y=g.elementFromPoint(u,d);y&&!t.contentDOM.contains(y)&&(y=null),y||(u=Math.max(o.left+1,Math.min(o.right-1,u)),y=g.elementFromPoint(u,d),y&&!t.contentDOM.contains(y)&&(y=null));let v,b=-1;if(y&&((r=t.docView.nearest(y))===null||r===void 0?void 0:r.isEditable)!=!1){if(m.caretPositionFromPoint){let k=m.caretPositionFromPoint(u,d);k&&({offsetNode:v,offset:b}=k)}else if(m.caretRangeFromPoint){let k=m.caretRangeFromPoint(u,d);k&&({startContainer:v,startOffset:b}=k,(!t.contentDOM.contains(v)||Ne.safari&&Tee(v,b,u)||Ne.chrome&&Oee(v,b,u))&&(v=void 0))}v&&(b=Math.min(No(v),b))}if(!v||!t.docView.dom.contains(v)){let k=Mn.find(t.docView,p);if(!k)return f>l.top+l.height/2?l.to:l.from;({node:v,offset:b}=hk(k.dom,u,d))}let w=t.docView.nearest(v);if(!w)return null;if(w.isWidget&&((s=w.dom)===null||s===void 0?void 0:s.nodeType)==1){let k=w.dom.getBoundingClientRect();return e.y<k.top||e.y<=k.bottom&&e.x<=(k.left+k.right)/2?w.posAtStart:w.posAtEnd}else return w.localPosFromDOM(v,b)+w.posAtStart}function sI(t,e,n,i,r){let s=Math.round((i-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&n.height>t.defaultLineHeight*1.5){let a=t.viewState.heightOracle.textHeight,l=Math.floor((r-n.top-(t.defaultLineHeight-a)*.5)/a);s+=l*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(n.from,n.to);return n.from+XQ(o,s,t.state.tabSize)}function Tee(t,e,n){let i,r=t;if(t.nodeType!=3||e!=(i=t.nodeValue.length))return!1;for(;;){let s=r.nextSibling;if(s){if(s.nodeName=="BR")break;return!1}else{let o=r.parentNode;if(!o||o.nodeName=="DIV")break;r=o}}return nu(t,i-1,i).getBoundingClientRect().right>n}function Oee(t,e,n){if(e!=0)return!1;for(let r=t;;){let s=r.parentNode;if(!s||s.nodeType!=1||s.firstChild!=r)return!1;if(s.classList.contains("cm-line"))break;r=s}let i=t.nodeType==1?t.getBoundingClientRect():nu(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return n-i.left>5}function pk(t,e,n){let i=t.lineBlockAt(e);if(Array.isArray(i.type)){let r;for(let s of i.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!r||s.type==Oi.Text&&(r.type!=s.type||(n<0?s.from<e:s.to>e)))&&(r=s)}}return r||i}return i}function Lee(t,e,n,i){let r=pk(t,e.head,e.assoc||-1),s=!i||r.type!=Oi.Text||!(t.lineWrapping||r.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(s){let o=t.dom.getBoundingClientRect(),a=t.textDirectionAt(r.from),l=t.posAtCoords({x:n==(a==rn.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(l!=null)return le.cursor(l,n?-1:1)}return le.cursor(n?r.to:r.from,n?-1:1)}function oI(t,e,n,i){let r=t.state.doc.lineAt(e.head),s=t.bidiSpans(r),o=t.textDirectionAt(r.from);for(let a=e,l=null;;){let c=xee(r,s,o,a,n),u=H8;if(!c){if(r.number==(n?t.state.doc.lines:1))return a;u=`
`,r=t.state.doc.line(r.number+(n?1:-1)),s=t.bidiSpans(r),c=t.visualLineSide(r,!n)}if(l){if(!l(u))return a}else{if(!i)return c;l=i(u)}a=c}}function Dee(t,e,n){let i=t.state.charCategorizer(e),r=i(n);return s=>{let o=i(s);return r==oi.Space&&(r=o),r==o}}function jee(t,e,n,i){let r=e.head,s=n?1:-1;if(r==(n?t.state.doc.length:0))return le.cursor(r,e.assoc);let o=e.goalColumn,a,l=t.contentDOM.getBoundingClientRect(),c=t.coordsAtPos(r,e.assoc||-1),u=t.documentTop;if(c)o==null&&(o=c.left-l.left),a=s<0?c.top:c.bottom;else{let p=t.viewState.lineBlockAt(r);o==null&&(o=Math.min(l.right-l.left,t.defaultCharacterWidth*(r-p.from))),a=(s<0?p.top:p.bottom)+u}let d=l.left+o,f=i??t.viewState.heightOracle.textHeight>>1;for(let p=0;;p+=10){let m=a+(f+p)*s,g=o6(t,{x:d,y:m},!1,s);if(m<l.top||m>l.bottom||(s<0?g<r:g>r)){let y=t.docView.coordsForChar(g),v=!y||m<y.top?-1:1;return le.cursor(g,v,void 0,o)}}}function Z0(t,e,n){for(;;){let i=0;for(let r of t)r.between(e-1,e+1,(s,o,a)=>{if(e>s&&e<o){let l=i||n||(e-s<o-e?-1:1);e=l<0?s:o,i=l}});if(!i)return e}}function Gx(t,e,n){let i=Z0(t.state.facet(vE).map(r=>r(t)),n.from,e.head>n.from?-1:1);return i==n.from?n:le.cursor(i,i<n.from?1:-1)}const Eh="￿";class Bee{constructor(e,n){this.points=e,this.text="",this.lineSeparator=n.facet(St.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Eh}readRange(e,n){if(!e)return this;let i=e.parentNode;for(let r=e;;){this.findPointBefore(i,r);let s=this.text.length;this.readNode(r);let o=r.nextSibling;if(o==n)break;let a=Gt.get(r),l=Gt.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:fy(r))||fy(o)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>s)&&this.lineBreak(),r=o}return this.findPointBefore(i,n),this}readTextNode(e){let n=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,n.length));for(let i=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,a;if(this.lineSeparator?(s=n.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(a=r.exec(n))&&(s=a.index,o=a[0].length),this.append(n.slice(i,s<0?n.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);i=s+o}}readNode(e){if(e.cmIgnore)return;let n=Gt.get(e),i=n&&n.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let r=i.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,n){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==n&&(i.pos=this.text.length)}findPointInside(e,n){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+($ee(e,i.node,i.offset)?n:0))}}function $ee(t,e,n){for(;;){if(!e||n<No(e))return!1;if(e==t)return!0;n=tu(e)+1,e=e.parentNode}}class aI{constructor(e,n){this.node=e,this.offset=n,this.pos=-1}}class Fee{constructor(e,n,i,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=n>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&n>-1)this.newSel=null;else if(n>-1&&(this.bounds=e.docView.domBoundsAround(n,i,0))){let a=s||o?[]:Vee(e),l=new Bee(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=Hee(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=s&&s.node==a.focusNode&&s.offset==a.focusOffset||!nk(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),c=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!nk(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),u=e.viewport;if((Ne.ios||Ne.chrome)&&e.state.selection.main.empty&&l!=c&&(u.from>0||u.to<e.state.doc.length)){let d=Math.min(l,c),f=Math.max(l,c),p=u.from-d,m=u.to-f;(p==0||p==1||d==0)&&(m==0||m==-1||f==e.state.doc.length)&&(l=0,c=e.state.doc.length)}this.newSel=le.single(c,l)}}}function a6(t,e){let n,{newSel:i}=e,r=t.state.selection.main,s=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=r.from,c=null;(s===8||Ne.android&&e.text.length<a-o)&&(l=r.to,c="end");let u=Uee(t.state.doc.sliceString(o,a,Eh),e.text,l-o,c);u&&(Ne.chrome&&s==13&&u.toB==u.from+2&&e.text.slice(u.from,u.toB)==Eh+Eh&&u.toB--,n={from:o+u.from,to:o+u.toA,insert:At.of(e.text.slice(u.from,u.toB).split(Eh))})}else i&&(!t.hasFocus&&t.state.facet(ra)||i.main.eq(r))&&(i=null);if(!n&&!i)return!1;if(!n&&e.typeOver&&!r.empty&&i&&i.main.empty?n={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,r.to)}:(Ne.mac||Ne.android)&&n&&n.from==n.to&&n.from==r.head-1&&/^\. ?$/.test(n.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(i&&n.insert.length==2&&(i=le.single(i.main.anchor-1,i.main.head-1)),n={from:n.from,to:n.to,insert:At.of([n.insert.toString().replace("."," ")])}):n&&n.from>=r.from&&n.to<=r.to&&(n.from!=r.from||n.to!=r.to)&&r.to-r.from-(n.to-n.from)<=4?n={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,n.from).append(n.insert).append(t.state.doc.slice(n.to,r.to))}:Ne.chrome&&n&&n.from==n.to&&n.from==r.head&&n.insert.toString()==`
 `&&t.lineWrapping&&(i&&(i=le.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:At.of([" "])}),n)return bE(t,n,i,s);if(i&&!i.main.eq(r)){let o=!1,a="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(o=!0),a=t.inputState.lastSelectionOrigin),t.dispatch({selection:i,scrollIntoView:o,userEvent:a}),!0}else return!1}function bE(t,e,n,i=-1){if(Ne.ios&&t.inputState.flushIOSKey(e))return!0;let r=t.state.selection.main;if(Ne.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&t.state.sliceDoc(e.from,r.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Sd(t.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>r.head)&&Sd(t.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&e.insert.length==0&&Sd(t.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let o,a=()=>o||(o=zee(t,e,n));return t.state.facet(X8).some(l=>l(t,e.from,e.to,s,a))||t.dispatch(a()),!0}function zee(t,e,n){let i,r=t.state,s=r.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!n||n.main.empty&&n.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let a=s.from<e.from?r.sliceDoc(s.from,e.from):"",l=s.to>e.to?r.sliceDoc(e.to,s.to):"";i=r.replaceSelection(t.state.toText(a+e.insert.sliceString(0,void 0,t.state.lineBreak)+l))}else{let a=r.changes(e),l=n&&n.main.to<=a.newLength?n.main:void 0;if(r.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let c=t.state.sliceDoc(e.from,e.to),u,d=n&&s6(t,n.main.head);if(d){let m=e.insert.length-(e.to-e.from);u={from:d.from,to:d.to-m}}else u=t.state.doc.lineAt(s.head);let f=s.to-e.to,p=s.to-s.from;i=r.changeByRange(m=>{if(m.from==s.from&&m.to==s.to)return{changes:a,range:l||m.map(a)};let g=m.to-f,y=g-c.length;if(m.to-m.from!=p||t.state.sliceDoc(y,g)!=c||m.to>=u.from&&m.from<=u.to)return{range:m};let v=r.changes({from:y,to:g,insert:e.insert}),b=m.to-s.to;return{changes:v,range:l?le.range(Math.max(0,l.anchor+b),Math.max(0,l.head+b)):m.map(v)}})}else i={changes:a,selection:l&&r.selection.replaceRange(l)}}let o="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,o+=".compose",t.inputState.compositionFirstChange&&(o+=".start",t.inputState.compositionFirstChange=!1)),r.update(i,{userEvent:o,scrollIntoView:!0})}function Uee(t,e,n,i){let r=Math.min(t.length,e.length),s=0;for(;s<r&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&t.length==e.length)return null;let o=t.length,a=e.length;for(;o>0&&a>0&&t.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(i=="end"){let l=Math.max(0,s-Math.min(o,a));n-=o+l-s}if(o<s&&t.length<e.length){let l=n<=s&&n>=o?s-n:0;s-=l,a=s+(a-o),o=s}else if(a<s){let l=n<=s&&n>=a?s-n:0;s-=l,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}function Vee(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}=t.observer.selectionRange;return n&&(e.push(new aI(n,i)),(r!=n||s!=i)&&e.push(new aI(r,s))),e}function Hee(t,e){if(t.length==0)return null;let n=t[0].pos,i=t.length==2?t[1].pos:n;return n>-1&&i>-1?le.single(n+e,i+e):null}class Wee{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Ne.safari&&e.contentDOM.addEventListener("input",()=>null),Ne.gecko&&ate(e.contentDOM.ownerDocument)}handleEvent(e){!Qee(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,n){let i=this.handlers[e];if(i){for(let r of i.observers)r(this.view,n);for(let r of i.handlers){if(n.defaultPrevented)break;if(r(this.view,n)){n.preventDefault();break}}}}ensureHandlers(e){let n=Gee(e),i=this.handlers,r=this.view.contentDOM;for(let s in n)if(s!="scroll"){let o=!n[s].handlers.length,a=i[s];a&&o!=!a.handlers.length&&(r.removeEventListener(s,this.handleEvent),a=null),a||r.addEventListener(s,this.handleEvent,{passive:o})}for(let s in i)s!="scroll"&&!n[s]&&r.removeEventListener(s,this.handleEvent);this.handlers=n}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&c6.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Ne.android&&Ne.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let n;return Ne.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((n=l6.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||qee.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=n||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let n=this.pendingIOSKey;return!n||n.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Sd(this.view.contentDOM,n.key,n.keyCode,n instanceof KeyboardEvent?n:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Ne.safari&&!Ne.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function lI(t,e){return(n,i)=>{try{return e.call(t,i,n)}catch(r){Cr(n.state,r)}}}function Gee(t){let e=Object.create(null);function n(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of t){let r=i.spec,s=r&&r.plugin.domEventHandlers,o=r&&r.plugin.domEventObservers;if(s)for(let a in s){let l=s[a];l&&n(a).handlers.push(lI(i.value,l))}if(o)for(let a in o){let l=o[a];l&&n(a).observers.push(lI(i.value,l))}}for(let i in js)n(i).handlers.push(js[i]);for(let i in ds)n(i).observers.push(ds[i]);return e}const l6=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],qee="dthko",c6=[16,17,18,20,91,92,224,225],jg=6;function Bg(t){return Math.max(0,t)*.7+8}function Kee(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}class Xee{constructor(e,n,i,r){this.view=e,this.startEvent=n,this.style=i,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=n,this.scrollParents=nee(e.contentDOM),this.atoms=e.state.facet(vE).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=n.shiftKey,this.multiple=e.state.facet(St.allowMultipleSelections)&&Yee(e,n),this.dragging=Zee(e,n)&&f6(n)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Kee(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,i=0,r=0,s=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=yE(this.view);e.clientX-l.left<=r+jg?n=-Bg(r-e.clientX):e.clientX+l.right>=o-jg&&(n=Bg(e.clientX-o)),e.clientY-l.top<=s+jg?i=-Bg(s-e.clientY):e.clientY+l.bottom>=a-jg&&(i=Bg(e.clientY-a)),this.setScrollSpeed(n,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,n){this.scrollSpeed={x:e,y:n},e||n?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:n}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),n&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=n,n=0),(e||n)&&this.view.win.scrollBy(e,n),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let n=null;for(let i=0;i<e.ranges.length;i++){let r=e.ranges[i],s=null;if(r.empty){let o=Z0(this.atoms,r.from,0);o!=r.from&&(s=le.cursor(o,-1))}else{let o=Z0(this.atoms,r.from,-1),a=Z0(this.atoms,r.to,1);(o!=r.from||a!=r.to)&&(s=le.range(r.from==r.anchor?o:a,r.from==r.head?o:a))}s&&(n||(n=e.ranges.slice()),n[i]=s)}return n?le.create(n,e.mainIndex):e}select(e){let{view:n}=this,i=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(n.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(n=>n.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Yee(t,e){let n=t.state.facet(W8);return n.length?n[0](e):Ne.mac?e.metaKey:e.ctrlKey}function Jee(t,e){let n=t.state.facet(G8);return n.length?n[0](e):Ne.mac?!e.altKey:!e.ctrlKey}function Zee(t,e){let{main:n}=t.state.selection;if(n.empty)return!1;let i=Gp(t.root);if(!i||i.rangeCount==0)return!0;let r=i.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function Qee(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target,i;n!=t.contentDOM;n=n.parentNode)if(!n||n.nodeType==11||(i=Gt.get(n))&&i.ignoreEvent(e))return!1;return!0}const js=Object.create(null),ds=Object.create(null),u6=Ne.ie&&Ne.ie_version<15||Ne.ios&&Ne.webkit_version<604;function ete(t){let e=t.dom.parentNode;if(!e)return;let n=e.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{t.focus(),n.remove(),d6(t,n.value)},50)}function zb(t,e,n){for(let i of t.facet(e))n=i(n,t);return n}function d6(t,e){e=zb(t.state,pE,e);let{state:n}=t,i,r=1,s=n.toText(e),o=s.lines==n.selection.ranges.length;if(mk!=null&&n.selection.ranges.every(l=>l.empty)&&mk==s.toString()){let l=-1;i=n.changeByRange(c=>{let u=n.doc.lineAt(c.from);if(u.from==l)return{range:c};l=u.from;let d=n.toText((o?s.line(r++).text:e)+n.lineBreak);return{changes:{from:u.from,insert:d},range:le.cursor(c.from+d.length)}})}else o?i=n.changeByRange(l=>{let c=s.line(r++);return{changes:{from:l.from,to:l.to,insert:c.text},range:le.cursor(l.from+c.length)}}):i=n.replaceSelection(s);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}ds.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft};js.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),e.keyCode==27&&t.inputState.tabFocusMode!=0&&(t.inputState.tabFocusMode=Date.now()+2e3),!1);ds.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};ds.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};js.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let i of t.state.facet(q8))if(n=i(t,e),n)break;if(!n&&e.button==0&&(n=ite(t,e)),n){let i=!t.hasFocus;t.inputState.startMouseSelection(new Xee(t,e,n,i)),i&&t.observer.ignore(()=>{E8(t.contentDOM);let s=t.root.activeElement;s&&!s.contains(t.contentDOM)&&s.blur()});let r=t.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function cI(t,e,n,i){if(i==1)return le.cursor(e,n);if(i==2)return Mee(t.state,e,n);{let r=Mn.find(t.docView,e),s=t.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,a=r?r.posAtEnd:s.to;return a<t.state.doc.length&&a==s.to&&a++,le.range(o,a)}}let uI=(t,e,n)=>e>=n.top&&e<=n.bottom&&t>=n.left&&t<=n.right;function tte(t,e,n,i){let r=Mn.find(t.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&uI(n,i,o))return-1;let a=r.coordsAt(s,1);return a&&uI(n,i,a)?1:o&&o.bottom>=i?-1:1}function dI(t,e){let n=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:n,bias:tte(t,n,e.clientX,e.clientY)}}const nte=Ne.ie&&Ne.ie_version<=11;let fI=null,hI=0,pI=0;function f6(t){if(!nte)return t.detail;let e=fI,n=pI;return fI=t,pI=Date.now(),hI=!e||n>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(hI+1)%3:1}function ite(t,e){let n=dI(t,e),i=f6(e),r=t.state.selection;return{update(s){s.docChanged&&(n.pos=s.changes.mapPos(n.pos),r=r.map(s.changes))},get(s,o,a){let l=dI(t,s),c,u=cI(t,l.pos,l.bias,i);if(n.pos!=l.pos&&!o){let d=cI(t,n.pos,n.bias,i),f=Math.min(d.from,u.from),p=Math.max(d.to,u.to);u=f<u.from?le.range(f,p):le.range(p,f)}return o?r.replaceRange(r.main.extend(u.from,u.to)):a&&i==1&&r.ranges.length>1&&(c=rte(r,l.pos))?c:a?r.addRange(u):le.create([u])}}}function rte(t,e){for(let n=0;n<t.ranges.length;n++){let{from:i,to:r}=t.ranges[n];if(i<=e&&r>=e)return le.create(t.ranges.slice(0,n).concat(t.ranges.slice(n+1)),t.mainIndex==n?0:t.mainIndex-(t.mainIndex>n?1:0))}return null}js.dragstart=(t,e)=>{let{selection:{main:n}}=t.state;if(e.target.draggable){let r=t.docView.nearest(e.target);if(r&&r.isWidget){let s=r.posAtStart,o=s+r.length;(s>=n.to||o<=n.from)&&(n=le.range(s,o))}}let{inputState:i}=t;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=n,e.dataTransfer&&(e.dataTransfer.setData("Text",zb(t.state,mE,t.state.sliceDoc(n.from,n.to))),e.dataTransfer.effectAllowed="copyMove"),!1};js.dragend=t=>(t.inputState.draggedContent=null,!1);function mI(t,e,n,i){if(n=zb(t.state,pE,n),!n)return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=t.inputState,o=i&&s&&Jee(t,e)?{from:s.from,to:s.to}:null,a={from:r,insert:n},l=t.state.changes(o?[o,a]:a);t.focus(),t.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"}),t.inputState.draggedContent=null}js.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let n=e.dataTransfer.files;if(n&&n.length){let i=Array(n.length),r=0,s=()=>{++r==n.length&&mI(t,e,i.filter(o=>o!=null).join(t.state.lineBreak),!1)};for(let o=0;o<n.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(i[o]=a.result),s()},a.readAsText(n[o])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return mI(t,e,i,!0),!0}return!1};js.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let n=u6?null:e.clipboardData;return n?(d6(t,n.getData("text/plain")||n.getData("text/uri-list")),!0):(ete(t),!1)};function ste(t,e){let n=t.dom.parentNode;if(!n)return;let i=n.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),t.focus()},50)}function ote(t){let e=[],n=[],i=!1;for(let r of t.selection.ranges)r.empty||(e.push(t.sliceDoc(r.from,r.to)),n.push(r));if(!e.length){let r=-1;for(let{from:s}of t.selection.ranges){let o=t.doc.lineAt(s);o.number>r&&(e.push(o.text),n.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),r=o.number}i=!0}return{text:zb(t,mE,e.join(t.lineBreak)),ranges:n,linewise:i}}let mk=null;js.copy=js.cut=(t,e)=>{let{text:n,ranges:i,linewise:r}=ote(t.state);if(!n&&!r)return!1;mk=r?n:null,e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let s=u6?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",n),!0):(ste(t,n),!1)};const h6=Ca.define();function p6(t,e){let n=[];for(let i of t.facet(Y8)){let r=i(t,e);r&&n.push(r)}return n.length?t.update({effects:n,annotations:h6.of(!0)}):null}function m6(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let n=p6(t.state,e);n?t.dispatch(n):t.update([])}},10)}ds.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),m6(t)};ds.blur=t=>{t.observer.clearSelectionRange(),m6(t)};ds.compositionstart=ds.compositionupdate=t=>{t.observer.editContext||(t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))};ds.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,Ne.chrome&&Ne.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))};ds.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};js.beforeinput=(t,e)=>{var n,i;if(e.inputType=="insertReplacementText"&&t.observer.editContext){let s=(n=e.dataTransfer)===null||n===void 0?void 0:n.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let a=o[0],l=t.posAtDOM(a.startContainer,a.startOffset),c=t.posAtDOM(a.endContainer,a.endOffset);return bE(t,{from:l,to:c,insert:t.state.toText(s)},null),!0}}let r;if(Ne.chrome&&Ne.android&&(r=l6.find(s=>s.inputType==e.inputType))&&(t.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let s=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return Ne.ios&&e.inputType=="deleteContentForward"&&t.observer.flushSoon(),Ne.safari&&e.inputType=="insertText"&&t.inputState.composing>=0&&setTimeout(()=>ds.compositionend(t,e),20),!1};const gI=new Set;function ate(t){gI.has(t)||(gI.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}const vI=["pre-wrap","normal","pre-line","break-spaces"];let df=!1;function yI(){df=!1}class lte{constructor(e){this.lineWrapping=e,this.doc=At.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,n){let i=this.doc.lineAt(n).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((n-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return vI.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let n=!1;for(let i=0;i<e.length;i++){let r=e[i];r<0?i++:this.heightSamples[Math.floor(r*10)]||(n=!0,this.heightSamples[Math.floor(r*10)]=!0)}return n}refresh(e,n,i,r,s,o){let a=vI.indexOf(e)>-1,l=Math.round(n)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=n,this.charWidth=i,this.textHeight=r,this.lineLength=s,l){this.heightSamples={};for(let c=0;c<o.length;c++){let u=o[c];u<0?c++:this.heightSamples[Math.floor(u*10)]=!0}}return l}}class cte{constructor(e,n){this.from=e,this.heights=n,this.index=0}get more(){return this.index<this.heights.length}}class co{constructor(e,n,i,r,s){this.from=e,this.length=n,this.top=i,this.height=r,this._content=s}get type(){return typeof this._content=="number"?Oi.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Ul?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let n=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new co(this.from,this.length+e.length,this.top,this.height+e.height,n)}}var Zt=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(Zt||(Zt={}));const Q0=.001;class Li{constructor(e,n,i=2){this.length=e,this.height=n,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Q0&&(df=!0),this.height=e)}replace(e,n,i){return Li.of(i)}decomposeLeft(e,n){n.push(this)}decomposeRight(e,n){n.push(this)}applyChanges(e,n,i,r){let s=this,o=i.doc;for(let a=r.length-1;a>=0;a--){let{fromA:l,toA:c,fromB:u,toB:d}=r[a],f=s.lineAt(l,Zt.ByPosNoHeight,i.setDoc(n),0,0),p=f.to>=c?f:s.lineAt(c,Zt.ByPosNoHeight,i,0,0);for(d+=p.to-c,c=p.to;a>0&&f.from<=r[a-1].toA;)l=r[a-1].fromA,u=r[a-1].fromB,a--,l<f.from&&(f=s.lineAt(l,Zt.ByPosNoHeight,i,0,0));u+=f.from-l,l=f.from;let m=xE.build(i.setDoc(o),e,u,d);s=my(s,s.replace(l,c,m))}return s.updateHeight(i,0)}static empty(){return new br(0,0)}static of(e){if(e.length==1)return e[0];let n=0,i=e.length,r=0,s=0;for(;;)if(n==i)if(r>s*2){let a=e[n-1];a.break?e.splice(--n,1,a.left,null,a.right):e.splice(--n,1,a.left,a.right),i+=1+a.break,r-=a.size}else if(s>r*2){let a=e[i];a.break?e.splice(i,1,a.left,null,a.right):e.splice(i,1,a.left,a.right),i+=2+a.break,s-=a.size}else break;else if(r<s){let a=e[n++];a&&(r+=a.size)}else{let a=e[--i];a&&(s+=a.size)}let o=0;return e[n-1]==null?(o=1,n--):e[n]==null&&(o=1,i++),new ute(Li.of(e.slice(0,n)),o,Li.of(e.slice(i)))}}function my(t,e){return t==e?t:(t.constructor!=e.constructor&&(df=!0),e)}Li.prototype.size=1;class g6 extends Li{constructor(e,n,i){super(e,n),this.deco=i}blockAt(e,n,i,r){return new co(r,this.length,i,this.height,this.deco||0)}lineAt(e,n,i,r,s){return this.blockAt(0,i,r,s)}forEachLine(e,n,i,r,s,o){e<=s+this.length&&n>=s&&o(this.blockAt(0,i,r,s))}updateHeight(e,n=0,i=!1,r){return r&&r.from<=n&&r.more&&this.setHeight(r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class br extends g6{constructor(e,n){super(e,n,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,n,i,r){return new co(r,this.length,i,this.height,this.breaks)}replace(e,n,i){let r=i[0];return i.length==1&&(r instanceof br||r instanceof Zn&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof Zn?r=new br(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):Li.of(i)}updateHeight(e,n=0,i=!1,r){return r&&r.from<=n&&r.more?this.setHeight(r.heights[r.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Zn extends Li{constructor(e){super(e,0)}heightMetrics(e,n){let i=e.doc.lineAt(n).number,r=e.doc.lineAt(n+this.length).number,s=r-i+1,o,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);o=l/s,this.length>s+1&&(a=(this.height-l)/(this.length-s-1))}else o=this.height/s;return{firstLine:i,lastLine:r,perLine:o,perChar:a}}blockAt(e,n,i,r){let{firstLine:s,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(n,r);if(n.lineWrapping){let c=r+(e<n.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),u=n.doc.lineAt(c),d=a+u.length*l,f=Math.max(i,e-d/2);return new co(u.from,u.length,f,d,0)}else{let c=Math.max(0,Math.min(o-s,Math.floor((e-i)/a))),{from:u,length:d}=n.doc.line(s+c);return new co(u,d,i+a*c,a,0)}}lineAt(e,n,i,r,s){if(n==Zt.ByHeight)return this.blockAt(e,i,r,s);if(n==Zt.ByPosNoHeight){let{from:p,to:m}=i.doc.lineAt(e);return new co(p,m-p,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(i,s),c=i.doc.lineAt(e),u=a+c.length*l,d=c.number-o,f=r+a*d+l*(c.from-s-d);return new co(c.from,c.length,Math.max(r,Math.min(f,r+this.height-u)),u,0)}forEachLine(e,n,i,r,s,o){e=Math.max(e,s),n=Math.min(n,s+this.length);let{firstLine:a,perLine:l,perChar:c}=this.heightMetrics(i,s);for(let u=e,d=r;u<=n;){let f=i.doc.lineAt(u);if(u==e){let m=f.number-a;d+=l*m+c*(e-s-m)}let p=l+c*f.length;o(new co(f.from,f.length,d,p,0)),d+=p,u=f.to+1}}replace(e,n,i){let r=this.length-n;if(r>0){let s=i[i.length-1];s instanceof Zn?i[i.length-1]=new Zn(s.length+r):i.push(null,new Zn(r-1))}if(e>0){let s=i[0];s instanceof Zn?i[0]=new Zn(e+s.length):i.unshift(new Zn(e-1),null)}return Li.of(i)}decomposeLeft(e,n){n.push(new Zn(e-1),null)}decomposeRight(e,n){n.push(null,new Zn(this.length-e-1))}updateHeight(e,n=0,i=!1,r){let s=n+this.length;if(r&&r.from<=n+this.length&&r.more){let o=[],a=Math.max(n,r.from),l=-1;for(r.from>n&&o.push(new Zn(r.from-n-1).updateHeight(e,n));a<=s&&r.more;){let u=e.doc.lineAt(a).length;o.length&&o.push(null);let d=r.heights[r.index++];l==-1?l=d:Math.abs(d-l)>=Q0&&(l=-2);let f=new br(u,d);f.outdated=!1,o.push(f),a+=u+1}a<=s&&o.push(null,new Zn(s-a).updateHeight(e,a));let c=Li.of(o);return(l<0||Math.abs(c.height-this.height)>=Q0||Math.abs(l-this.heightMetrics(e,n).perLine)>=Q0)&&(df=!0),my(this,c)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(n,n+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class ute extends Li{constructor(e,n,i){super(e.length+n+i.length,e.height+i.height,n|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,n,i,r){let s=i+this.left.height;return e<s?this.left.blockAt(e,n,i,r):this.right.blockAt(e,n,s,r+this.left.length+this.break)}lineAt(e,n,i,r,s){let o=r+this.left.height,a=s+this.left.length+this.break,l=n==Zt.ByHeight?e<o:e<a,c=l?this.left.lineAt(e,n,i,r,s):this.right.lineAt(e,n,i,o,a);if(this.break||(l?c.to<a:c.from>a))return c;let u=n==Zt.ByPosNoHeight?Zt.ByPosNoHeight:Zt.ByPos;return l?c.join(this.right.lineAt(a,u,i,o,a)):this.left.lineAt(a,u,i,r,s).join(c)}forEachLine(e,n,i,r,s,o){let a=r+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,n,i,r,s,o),n>=l&&this.right.forEachLine(e,n,i,a,l,o);else{let c=this.lineAt(l,Zt.ByPos,i,r,s);e<c.from&&this.left.forEachLine(e,c.from-1,i,r,s,o),c.to>=e&&c.from<=n&&o(c),n>c.to&&this.right.forEachLine(c.to+1,n,i,a,l,o)}}replace(e,n,i){let r=this.left.length+this.break;if(n<r)return this.balanced(this.left.replace(e,n,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,n-r,i));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of i)s.push(a);if(e>0&&bI(s,o-1),n<this.length){let a=s.length;this.decomposeRight(n,s),bI(s,a)}return Li.of(s)}decomposeLeft(e,n){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,n);n.push(this.left),this.break&&(i++,e>=i&&n.push(null)),e>i&&this.right.decomposeLeft(e-i,n)}decomposeRight(e,n){let i=this.left.length,r=i+this.break;if(e>=r)return this.right.decomposeRight(e-r,n);e<i&&this.left.decomposeRight(e,n),this.break&&e<r&&n.push(null),n.push(this.right)}balanced(e,n){return e.size>2*n.size||n.size>2*e.size?Li.of(this.break?[e,null,n]:[e,n]):(this.left=my(this.left,e),this.right=my(this.right,n),this.setHeight(e.height+n.height),this.outdated=e.outdated||n.outdated,this.size=e.size+n.size,this.length=e.length+this.break+n.length,this)}updateHeight(e,n=0,i=!1,r){let{left:s,right:o}=this,a=n+s.length+this.break,l=null;return r&&r.from<=n+s.length&&r.more?l=s=s.updateHeight(e,n,i,r):s.updateHeight(e,n,i),r&&r.from<=a+o.length&&r.more?l=o=o.updateHeight(e,a,i,r):o.updateHeight(e,a,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function bI(t,e){let n,i;t[e]==null&&(n=t[e-1])instanceof Zn&&(i=t[e+1])instanceof Zn&&t.splice(e-1,3,new Zn(n.length+1+i.length))}const dte=5;class xE{constructor(e,n){this.pos=e,this.oracle=n,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,n){if(this.lineStart>-1){let i=Math.min(n,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof br?r.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new br(i-this.pos,-1)),this.writtenTo=i,n>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=n}point(e,n,i){if(e<n||i.heightRelevant){let r=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let o=n-e;i.block?this.addBlock(new g6(o,r,i)):(o||s||r>=dte)&&this.addLineDeco(r,s,o)}else n>e&&this.span(e,n);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:n}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=n,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new br(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,n){let i=new Zn(n-e);return this.oracle.doc.lineAt(e).to==n&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof br)return e;let n=new br(0,-1);return this.nodes.push(n),n}addBlock(e){this.enterLine();let n=e.deco;n&&n.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,n&&n.endSide>0&&(this.covering=e)}addLineDeco(e,n,i){let r=this.ensureLine();r.length+=i,r.collapsed+=i,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=n,this.writtenTo=this.pos=this.pos+i}finish(e){let n=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(n instanceof br)&&!this.isCovered?this.nodes.push(new br(0,-1)):(this.writtenTo<this.pos||n==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let r of this.nodes)r instanceof br&&r.updateHeight(this.oracle,i),i+=r?r.length:1;return this.nodes}static build(e,n,i,r){let s=new xE(i,e);return Ot.spans(n,i,r,s,0),s.finish(i)}}function fte(t,e,n){let i=new hte;return Ot.compare(t,e,n,i,0),i.changes}class hte{constructor(){this.changes=[]}compareRange(){}comparePoint(e,n,i,r){(e<n||i&&i.heightRelevant||r&&r.heightRelevant)&&J0(e,n,this.changes,5)}}function pte(t,e){let n=t.getBoundingClientRect(),i=t.ownerDocument,r=i.defaultView||window,s=Math.max(0,n.left),o=Math.min(r.innerWidth,n.right),a=Math.max(0,n.top),l=Math.min(r.innerHeight,n.bottom);for(let c=t.parentNode;c&&c!=i.body;)if(c.nodeType==1){let u=c,d=window.getComputedStyle(u);if((u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&d.overflow!="visible"){let f=u.getBoundingClientRect();s=Math.max(s,f.left),o=Math.min(o,f.right),a=Math.max(a,f.top),l=Math.min(c==t.parentNode?r.innerHeight:l,f.bottom)}c=d.position=="absolute"||d.position=="fixed"?u.offsetParent:u.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:s-n.left,right:Math.max(s,o)-n.left,top:a-(n.top+e),bottom:Math.max(a,l)-(n.top+e)}}function mte(t){let e=t.getBoundingClientRect(),n=t.ownerDocument.defaultView||window;return e.left<n.innerWidth&&e.right>0&&e.top<n.innerHeight&&e.bottom>0}function gte(t,e){let n=t.getBoundingClientRect();return{left:0,right:n.right-n.left,top:e,bottom:n.bottom-(n.top+e)}}class qx{constructor(e,n,i,r){this.from=e,this.to=n,this.size=i,this.displaySize=r}static same(e,n){if(e.length!=n.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=n[i];if(r.from!=s.from||r.to!=s.to||r.size!=s.size)return!1}return!0}draw(e,n){return ht.replace({widget:new vte(this.displaySize*(n?e.scaleY:e.scaleX),n)}).range(this.from,this.to)}}class vte extends ec{constructor(e,n){super(),this.size=e,this.vertical=n}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class xI{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=wI,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=rn.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let n=e.facet(gE).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new lte(n),this.stateDeco=e.facet(Kp).filter(i=>typeof i!="function"),this.heightMap=Li.empty().applyChanges(this.stateDeco,At.empty,this.heightOracle.setDoc(e.doc),[new ss(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ht.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:n}=this.state.selection;for(let i=0;i<=1;i++){let r=i?n.head:n.anchor;if(!e.some(({from:s,to:o})=>r>=s&&r<=o)){let{from:s,to:o}=this.lineBlockAt(r);e.push(new $g(s,o))}}return this.viewports=e.sort((i,r)=>i.from-r.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?wI:new wE(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Ah(e,this.scaler))})}update(e,n=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Kp).filter(u=>typeof u!="function");let r=e.changedRanges,s=ss.extendWithRanges(r,fte(i,this.stateDeco,e?e.changes:jn.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);yI(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||df)&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(n&&(n.range.head<l.from||n.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,n));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),n&&(this.scrollTarget=n),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(Z8)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let n=e.contentDOM,i=window.getComputedStyle(n),r=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?rn.RTL:rn.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),a=n.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let c=0,u=0;if(a.width&&a.height){let{scaleX:k,scaleY:C}=C8(n,a);(k>.005&&Math.abs(this.scaleX-k)>.005||C>.005&&Math.abs(this.scaleY-C)>.005)&&(this.scaleX=k,this.scaleY=C,c|=16,o=l=!0)}let d=(parseInt(i.paddingTop)||0)*this.scaleY,f=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=d||this.paddingBottom!=f)&&(this.paddingTop=d,this.paddingBottom=f,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let p=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=p&&(this.scrollAnchorHeight=-1,this.scrollTop=p),this.scrolledToBottom=P8(e.scrollDOM);let m=(this.printing?gte:pte)(n,this.paddingTop),g=m.top-this.pixelViewport.top,y=m.bottom-this.pixelViewport.bottom;this.pixelViewport=m;let v=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(v!=this.inView&&(this.inView=v,v&&(l=!0)),!this.inView&&!this.scrollTarget&&!mte(e.dom))return 0;let b=a.width;if((this.contentDOMWidth!=b||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),l){let k=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(k)&&(o=!0),o||r.lineWrapping&&Math.abs(b-this.contentDOMWidth)>r.charWidth){let{lineHeight:C,charWidth:E,textHeight:_}=e.docView.measureTextSize();o=C>0&&r.refresh(s,C,E,_,b/E,k),o&&(e.docView.minWidth=0,c|=16)}g>0&&y>0?u=Math.max(g,y):g<0&&y<0&&(u=Math.min(g,y)),yI();for(let C of this.viewports){let E=C.from==this.viewport.from?k:e.docView.measureVisibleLineHeights(C);this.heightMap=(o?Li.empty().applyChanges(this.stateDeco,At.empty,this.heightOracle,[new ss(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,o,new cte(C.from,E))}df&&(c|=2)}let w=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return w&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(u,this.scrollTarget),c|=this.updateForViewport()),(c&2||w)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,n){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new $g(r.lineAt(o-i*1e3,Zt.ByHeight,s,0,0).from,r.lineAt(a+(1-i)*1e3,Zt.ByHeight,s,0,0).to);if(n){let{head:c}=n.range;if(c<l.from||c>l.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),d=r.lineAt(c,Zt.ByPos,s,0,0),f;n.y=="center"?f=(d.top+d.bottom)/2-u/2:n.y=="start"||n.y=="nearest"&&c<l.from?f=d.top:f=d.bottom-u,l=new $g(r.lineAt(f-1e3/2,Zt.ByHeight,s,0,0).from,r.lineAt(f+u+1e3/2,Zt.ByHeight,s,0,0).to)}}return l}mapViewport(e,n){let i=n.mapPos(e.from,-1),r=n.mapPos(e.to,1);return new $g(this.heightMap.lineAt(i,Zt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,Zt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:n},i=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,Zt.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(n,Zt.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||r<=o-Math.max(10,Math.min(-i,250)))&&(n==this.state.doc.length||s>=a+Math.max(10,Math.min(i,250)))&&r>o-2*1e3&&s<a+2*1e3}mapLineGaps(e,n){if(!e.length||n.empty)return e;let i=[];for(let r of e)n.touchesRange(r.from,r.to)||i.push(new qx(n.mapPos(r.from),n.mapPos(r.to),r.size,r.displaySize));return i}ensureLineGaps(e,n){let i=this.heightOracle.lineWrapping,r=i?1e4:2e3,s=r>>1,o=r<<1;if(this.defaultTextDirection!=rn.LTR&&!i)return[];let a=[],l=(u,d,f,p)=>{if(d-u<s)return;let m=this.state.selection.main,g=[m.from];m.empty||g.push(m.to);for(let v of g)if(v>u&&v<d){l(u,v-10,f,p),l(v+10,d,f,p);return}let y=bte(e,v=>v.from>=f.from&&v.to<=f.to&&Math.abs(v.from-u)<s&&Math.abs(v.to-d)<s&&!g.some(b=>v.from<b&&v.to>b));if(!y){if(d<f.to&&n&&i&&n.visibleRanges.some(w=>w.from<=d&&w.to>=d)){let w=n.moveToLineBoundary(le.cursor(d),!1,!0).head;w>u&&(d=w)}let v=this.gapSize(f,u,d,p),b=i||v<2e6?v:2e6;y=new qx(u,d,v,b)}a.push(y)},c=u=>{if(u.length<o||u.type!=Oi.Text)return;let d=yte(u.from,u.to,this.stateDeco);if(d.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,p,m;if(i){let g=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,y,v;if(f!=null){let b=zg(d,f),w=((this.visibleBottom-this.visibleTop)/2+g)/u.height;y=b-w,v=b+w}else y=(this.visibleTop-u.top-g)/u.height,v=(this.visibleBottom-u.top+g)/u.height;p=Fg(d,y),m=Fg(d,v)}else{let g=d.total*this.heightOracle.charWidth,y=r*this.heightOracle.charWidth,v=0;if(g>2e6)for(let E of e)E.from>=u.from&&E.from<u.to&&E.size!=E.displaySize&&E.from*this.heightOracle.charWidth+v<this.pixelViewport.left&&(v=E.size-E.displaySize);let b=this.pixelViewport.left+v,w=this.pixelViewport.right+v,k,C;if(f!=null){let E=zg(d,f),_=((w-b)/2+y)/g;k=E-_,C=E+_}else k=(b-y)/g,C=(w+y)/g;p=Fg(d,k),m=Fg(d,C)}p>u.from&&l(u.from,p,u,d),m<u.to&&l(m,u.to,u,d)};for(let u of this.viewportLines)Array.isArray(u.type)?u.type.forEach(c):c(u);return a}gapSize(e,n,i,r){let s=zg(r,i)-zg(r,n);return this.heightOracle.lineWrapping?e.height*s:r.total*this.heightOracle.charWidth*s}updateLineGaps(e){qx.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ht.set(e.map(n=>n.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let n=this.stateDeco;this.lineGaps.length&&(n=n.concat(this.lineGapDeco));let i=[];Ot.spans(n,this.viewport.from,this.viewport.to,{span(s,o){i.push({from:s,to:o})},point(){}},20);let r=0;if(i.length!=this.visibleRanges.length)r=12;else for(let s=0;s<i.length&&!(r&8);s++){let o=this.visibleRanges[s],a=i[s];(o.from!=a.from||o.to!=a.to)&&(r|=4,e&&e.mapPos(o.from,-1)==a.from&&e.mapPos(o.to,1)==a.to||(r|=8))}return this.visibleRanges=i,r}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(n=>n.from<=e&&n.to>=e)||Ah(this.heightMap.lineAt(e,Zt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(n=>n.top<=e&&n.bottom>=e)||Ah(this.heightMap.lineAt(this.scaler.fromDOM(e),Zt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let n=this.lineBlockAtHeight(e+8);return n.from>=this.viewport.from||this.viewportLines[0].top-e>200?n:this.viewportLines[0]}elementAtHeight(e){return Ah(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}let $g=class{constructor(e,n){this.from=e,this.to=n}};function yte(t,e,n){let i=[],r=t,s=0;return Ot.spans(n,t,e,{span(){},point(o,a){o>r&&(i.push({from:r,to:o}),s+=o-r),r=a}},20),r<e&&(i.push({from:r,to:e}),s+=e-r),{total:s,ranges:i}}function Fg({total:t,ranges:e},n){if(n<=0)return e[0].from;if(n>=1)return e[e.length-1].to;let i=Math.floor(t*n);for(let r=0;;r++){let{from:s,to:o}=e[r],a=o-s;if(i<=a)return s+i;i-=a}}function zg(t,e){let n=0;for(let{from:i,to:r}of t.ranges){if(e<=r){n+=e-i;break}n+=r-i}return n/t.total}function bte(t,e){for(let n of t)if(e(n))return n}const wI={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class wE{constructor(e,n,i){let r=0,s=0,o=0;this.viewports=i.map(({from:a,to:l})=>{let c=n.lineAt(a,Zt.ByPos,e,0,0).top,u=n.lineAt(l,Zt.ByPos,e,0,0).bottom;return r+=u-c,{from:a,to:l,top:c,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(n.height-r);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let n=0,i=0,r=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.top)return r+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom,r=s.domBottom}}fromDOM(e){for(let n=0,i=0,r=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.domTop)return i+(e-r)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom,r=s.domBottom}}eq(e){return e instanceof wE?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((n,i)=>n.from==e.viewports[i].from&&n.to==e.viewports[i].to):!1}}function Ah(t,e){if(e.scale==1)return t;let n=e.toDOM(t.top),i=e.toDOM(t.bottom);return new co(t.from,t.length,n,i-n,Array.isArray(t._content)?t._content.map(r=>Ah(r,e)):t._content)}const Ug=Re.define({combine:t=>t.join(" ")}),gk=Re.define({combine:t=>t.indexOf(!0)>-1}),vk=Fl.newName(),v6=Fl.newName(),y6=Fl.newName(),b6={"&light":"."+v6,"&dark":"."+y6};function yk(t,e,n){return new Fl(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,r=>{if(r=="&")return t;if(!n||!n[r])throw new RangeError(`Unsupported selector: ${r}`);return n[r]}):t+" "+i}})}const xte=yk("."+vk,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},b6),wte={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Kx=Ne.ie&&Ne.ie_version<=11;class Ste{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new iee,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(n=>{for(let i of n)this.queue.push(i);(Ne.ie&&Ne.ie_version<=11||Ne.ios&&e.composing)&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&Ne.android&&e.constructor.EDIT_CONTEXT!==!1&&!(Ne.chrome&&Ne.chrome_version<126)&&(this.editContext=new _te(e),e.state.facet(ra)&&(e.contentDOM.editContext=this.editContext.editContext)),Kx&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var n;((n=this.view.docView)===null||n===void 0?void 0:n.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(n=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),n.length>0&&n[n.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(n=>{n.length>0&&n[n.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((n,i)=>n!=e[i]))){this.gapIntersection.disconnect();for(let n of e)this.gapIntersection.observe(n);this.gaps=e}}onSelectionChange(e){let n=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,r=this.selectionRange;if(i.state.facet(ra)?i.root.activeElement!=this.dom:!Y0(this.dom,r))return;let s=r.anchorNode&&i.docView.nearest(r.anchorNode);if(s&&s.ignoreEvent(e)){n||(this.selectionChanged=!1);return}(Ne.ie&&Ne.ie_version<=11||Ne.android&&Ne.chrome)&&!i.state.selection.main.empty&&r.focusNode&&Zh(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,n=Gp(e.root);if(!n)return!1;let i=Ne.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&kte(this.view,n)||n;if(!i||this.selectionRange.eq(i))return!1;let r=Y0(this.dom,i);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&see(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,n){this.selectionRange.set(e.node,e.offset,n.node,n.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,n=null;for(let i=this.dom;i;)if(i.nodeType==1)!n&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:n||(n=this.scrollTargets.slice(0,e)),n&&n.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!n&&(n=this.scrollTargets.slice(0,e)),n){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=n)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,wte),Kx&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Kx&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,n){var i;if(!this.delayedAndroidKey){let r=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&Sd(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:n,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let n=-1,i=-1,r=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(r=!0),n==-1?{from:n,to:i}=o:(n=Math.min(o.from,n),i=Math.max(o.to,i)))}return{from:n,to:i,typeOver:r}}readChange(){let{from:e,to:n,typeOver:i}=this.processRecords(),r=this.selectionChanged&&Y0(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new Fee(this.view,e,n,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let n=this.readChange();if(!n)return this.view.requestMeasure(),!1;let i=this.view.state,r=a6(this.view,n);return this.view.state==i&&(n.domChanged||n.newSel&&!n.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),r}readMutation(e){let n=this.view.docView.nearest(e.target);if(!n||n.ignoreMutation(e))return null;if(n.markDirty(e.type=="attributes"),e.type=="attributes"&&(n.flags|=4),e.type=="childList"){let i=SI(n,e.previousSibling||e.target.previousSibling,-1),r=SI(n,e.nextSibling||e.target.nextSibling,1);return{from:i?n.posAfter(i):n.posAtStart,to:r?n.posBefore(r):n.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(ra)!=e.state.facet(ra)&&(e.view.contentDOM.editContext=e.state.facet(ra)?this.editContext.editContext:null))}destroy(){var e,n,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(n=this.gapIntersection)===null||n===void 0||n.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function SI(t,e,n){for(;e;){let i=Gt.get(e);if(i&&i.parent==t)return i;let r=e.parentNode;e=r!=t.dom?r:n>0?e.nextSibling:e.previousSibling}return null}function kI(t,e){let n=e.startContainer,i=e.startOffset,r=e.endContainer,s=e.endOffset,o=t.docView.domAtPos(t.state.selection.main.anchor);return Zh(o.node,o.offset,r,s)&&([n,i,r,s]=[r,s,n,i]),{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}}function kte(t,e){if(e.getComposedRanges){let r=e.getComposedRanges(t.root)[0];if(r)return kI(t,r)}let n=null;function i(r){r.preventDefault(),r.stopImmediatePropagation(),n=r.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",i,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",i,!0),n?kI(t,n):null}class _te{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let n=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let r=e.state.selection.main,{anchor:s,head:o}=r,a=this.toEditorPos(i.updateRangeStart),l=this.toEditorPos(i.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:a,drifted:!1});let c={from:a,to:l,insert:At.of(i.text.split(`
`))};if(c.from==this.from&&s<this.from?c.from=s:c.to==this.to&&s>this.to&&(c.to=s),c.from==c.to&&!c.insert.length){let u=le.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));u.main.eq(r)||e.dispatch({selection:u,userEvent:"select"});return}if((Ne.mac||Ne.android)&&c.from==o-1&&/^\. ?$/.test(i.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:a,to:l,insert:At.of([i.text.replace("."," ")])}),this.pendingContextChange=c,!e.state.readOnly){let u=this.to-this.from+(c.to-c.from+c.insert.length);bE(e,c,le.single(this.toEditorPos(i.selectionStart,u),this.toEditorPos(i.selectionEnd,u)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=i=>{let r=[],s=null;for(let o=this.toEditorPos(i.rangeStart),a=this.toEditorPos(i.rangeEnd);o<a;o++){let l=e.coordsForChar(o);s=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||s||new DOMRect,r.push(s)}n.updateCharacterBounds(i.rangeStart,r)},this.handlers.textformatupdate=i=>{let r=[];for(let s of i.getTextFormats()){let o=s.underlineStyle,a=s.underlineThickness;if(o!="None"&&a!="None"){let l=this.toEditorPos(s.rangeStart),c=this.toEditorPos(s.rangeEnd);if(l<c){let u=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${a=="Thin"?1:2}px`;r.push(ht.mark({attributes:{style:u}}).range(l,c))}}}e.dispatch({effects:e6.of(ht.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(e.state)}};for(let i in this.handlers)n.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let r=Gp(i.root);r&&r.rangeCount&&this.editContext.updateSelectionBounds(r.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let n=0,i=!1,r=this.pendingContextChange;return e.changes.iterChanges((s,o,a,l,c)=>{if(i)return;let u=c.length-(o-s);if(r&&o>=r.to)if(r.from==s&&r.to==o&&r.insert.eq(c)){r=this.pendingContextChange=null,n+=u,this.to+=u;return}else r=null,this.revertPending(e.state);if(s+=n,o+=n,o<=this.from)this.from+=u,this.to+=u;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+c.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),c.toString()),this.to+=u}n+=u}),r&&!i&&this.revertPending(e.state),!i}update(e){let n=this.pendingContextChange,i=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(i.from,i.to)&&e.transactions.some(r=>!r.isUserEvent("input.type")&&r.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||n)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:n}=e.selection.main;this.from=Math.max(0,n-1e4),this.to=Math.min(e.doc.length,n+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let n=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(n.from),this.toContextPos(n.from+n.insert.length),e.doc.sliceString(n.from,n.to))}setSelection(e){let{main:n}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,n.anchor))),r=this.toContextPos(n.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(i,r)}rangeIsValid(e){let{head:n}=e.selection.main;return!(this.from>0&&n-this.from<500||this.to<e.doc.length&&this.to-n<500||this.to-this.from>1e4*3)}toEditorPos(e,n=this.to-this.from){e=Math.min(e,n);let i=this.composing;return i&&i.drifted?i.editorBase+(e-i.contextBase):e+this.from}toContextPos(e){let n=this.composing;return n&&n.drifted?n.contextBase+(e-n.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class De{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var n;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(r=>r.forEach(s=>i(s,this)))||(r=>this.update(r)),this.dispatch=this.dispatch.bind(this),this._root=e.root||ree(e.parent)||document,this.viewState=new xI(e.state||St.create(e)),e.scrollTo&&e.scrollTo.is(Dg)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(ad).map(r=>new Hx(r));for(let r of this.plugins)r.update(this);this.observer=new Ste(this),this.inputState=new Wee(this),this.inputState.ensureHandlers(this.plugins),this.docView=new tI(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((n=document.fonts)===null||n===void 0)&&n.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let n=e.length==1&&e[0]instanceof zn?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(n,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let n=!1,i=!1,r,s=this.state;for(let f of e){if(f.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=f.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,a=0,l=null;e.some(f=>f.annotation(h6))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=p6(s,o),l||(a=1));let c=this.observer.delayedAndroidKey,u=null;if(c?(this.observer.clearDelayedAndroidKey(),u=this.observer.readChange(),(u&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(u=null)):this.observer.clear(),s.facet(St.phrases)!=this.state.facet(St.phrases))return this.setState(s);r=py.create(this,s,e),r.flags|=a;let d=this.viewState.scrollTarget;try{this.updateState=2;for(let f of e){if(d&&(d=d.map(f.changes)),f.scrollIntoView){let{main:p}=f.state.selection;d=new kd(p.empty?p:le.cursor(p.head,p.head>p.anchor?-1:1))}for(let p of f.effects)p.is(Dg)&&(d=p.value.clip(this.state))}this.viewState.update(r,d),this.bidiCache=gy.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),n=this.docView.update(r),this.state.facet(Ch)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(Ug)!=r.state.facet(Ug)&&(this.viewState.mustMeasureContent=!0),(n||i||d||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),n&&this.docViewUpdate(),!r.empty)for(let f of this.state.facet(fk))try{f(r)}catch(p){Cr(this.state,p,"update listener")}(l||u)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),u&&!a6(this,u)&&c.force&&Sd(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let n=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new xI(e),this.plugins=e.facet(ad).map(i=>new Hx(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new tI(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}n&&this.focus(),this.requestMeasure()}updatePlugins(e){let n=e.startState.facet(ad),i=e.state.facet(ad);if(n!=i){let r=[];for(let s of i){let o=n.indexOf(s);if(o<0)r.push(new Hx(s));else{let a=this.plugins[o];a.mustUpdate=e,r.push(a)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);n!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let n=e.value;if(n&&n.docViewUpdate)try{n.docViewUpdate(this)}catch(i){Cr(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let n=null,i=this.scrollDOM,r=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(P8(i))s=-1,o=this.viewState.heightMap.height;else{let p=this.viewState.scrollAnchorAt(r);s=p.from,o=p.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let u=c.map(p=>{try{return p.read(this)}catch(m){return Cr(this.state,m),_I}}),d=py.create(this,this.state,[]),f=!1;d.flags|=l,n?n.flags|=l:n=d,this.updateState=2,d.empty||(this.updatePlugins(d),this.inputState.update(d),this.updateAttrs(),f=this.docView.update(d),f&&this.docViewUpdate());for(let p=0;p<c.length;p++)if(u[p]!=_I)try{let m=c[p];m.write&&m.write(u[p],this)}catch(m){Cr(this.state,m)}if(f&&this.docView.updateSelection(!0),!d.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let m=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(m>1||m<-1){r=r+m,i.scrollTop=r/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(n&&!n.empty)for(let a of this.state.facet(fk))a(n)}get themeClasses(){return vk+" "+(this.state.facet(gk)?y6:v6)+" "+this.state.facet(Ug)}updateAttrs(){let e=CI(this,t6,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),n={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(ra)?"true":"false",class:"cm-content",style:`${Ne.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(n["aria-readonly"]="true"),CI(this,gE,n);let i=this.observer.ignore(()=>{let r=ak(this.contentDOM,this.contentAttrs,n),s=ak(this.dom,this.editorAttrs,e);return r||s});return this.editorAttrs=e,this.contentAttrs=n,i}showAnnouncements(e){let n=!0;for(let i of e)for(let r of i.effects)if(r.is(De.announce)){n&&(this.announceDOM.textContent=""),n=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(Ch);let e=this.state.facet(De.cspNonce);Fl.mount(this.root,this.styleModules.concat(xte).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let n=0;n<this.measureRequests.length;n++)if(this.measureRequests[n].key===e.key){this.measureRequests[n]=e;return}}this.measureRequests.push(e)}}plugin(e){let n=this.pluginMap.get(e);return(n===void 0||n&&n.plugin!=e)&&this.pluginMap.set(e,n=this.plugins.find(i=>i.plugin==e)||null),n&&n.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,n,i){return Gx(this,e,oI(this,e,n,i))}moveByGroup(e,n){return Gx(this,e,oI(this,e,n,i=>Dee(this,e.head,i)))}visualLineSide(e,n){let i=this.bidiSpans(e),r=this.textDirectionAt(e.from),s=i[n?i.length-1:0];return le.cursor(s.side(n,r)+e.from,s.forward(!n,r)?1:-1)}moveToLineBoundary(e,n,i=!0){return Lee(this,e,n,i)}moveVertically(e,n,i){return Gx(this,e,jee(this,e,n,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,n=0){return this.docView.posFromDOM(e,n)}posAtCoords(e,n=!0){return this.readMeasured(),o6(this,e,n)}coordsAtPos(e,n=1){this.readMeasured();let i=this.docView.coordsAt(e,n);if(!i||i.left==i.right)return i;let r=this.state.doc.lineAt(e),s=this.bidiSpans(r),o=s[ll.find(s,e-r.from,-1,n)];return $b(i,o.dir==rn.LTR==n>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(J8)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Cte)return V8(e.length);let n=this.textDirectionAt(e.from),i;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==n&&(s.fresh||U8(s.isolates,i=eI(this,e))))return s.order;i||(i=eI(this,e));let r=bee(e.text,n,i);return this.bidiCache.push(new gy(e.from,e.to,n,i,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Ne.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{E8(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,n={}){return Dg.of(new kd(typeof e=="number"?le.cursor(e):e,n.y,n.x,n.yMargin,n.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:n}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return Dg.of(new kd(le.cursor(i.from),"start","start",i.top-e,n,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return ui.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return ui.define(()=>({}),{eventObservers:e})}static theme(e,n){let i=Fl.newName(),r=[Ug.of(i),Ch.of(yk(`.${i}`,e))];return n&&n.dark&&r.push(gk.of(!0)),r}static baseTheme(e){return Mm.lowest(Ch.of(yk("."+vk,e,b6)))}static findFromDOM(e){var n;let i=e.querySelector(".cm-content"),r=i&&Gt.get(i)||Gt.get(e);return((n=r==null?void 0:r.rootView)===null||n===void 0?void 0:n.view)||null}}De.styleModule=Ch;De.inputHandler=X8;De.clipboardInputFilter=pE;De.clipboardOutputFilter=mE;De.scrollHandler=Q8;De.focusChangeEffect=Y8;De.perLineTextDirection=J8;De.exceptionSink=K8;De.updateListener=fk;De.editable=ra;De.mouseSelectionStyle=q8;De.dragMovesSelection=G8;De.clickAddsSelectionRange=W8;De.decorations=Kp;De.outerDecorations=n6;De.atomicRanges=vE;De.bidiIsolatedRanges=i6;De.scrollMargins=r6;De.darkTheme=gk;De.cspNonce=Re.define({combine:t=>t.length?t[0]:""});De.contentAttributes=gE;De.editorAttributes=t6;De.lineWrapping=De.contentAttributes.of({class:"cm-lineWrapping"});De.announce=ft.define();const Cte=4096,_I={};class gy{constructor(e,n,i,r,s,o){this.from=e,this.to=n,this.dir=i,this.isolates=r,this.fresh=s,this.order=o}static update(e,n){if(n.empty&&!e.some(s=>s.fresh))return e;let i=[],r=e.length?e[e.length-1].dir:rn.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==r&&!n.touchesRange(o.from,o.to)&&i.push(new gy(n.mapPos(o.from,1),n.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function CI(t,e,n){for(let i=t.state.facet(e),r=i.length-1;r>=0;r--){let s=i[r],o=typeof s=="function"?s(t):s;o&&ok(o,n)}return n}const Ete=Ne.mac?"mac":Ne.windows?"win":Ne.linux?"linux":"key";function Ate(t,e){const n=t.split(/-(?!$)/);let i=n[n.length-1];i=="Space"&&(i=" ");let r,s,o,a;for(let l=0;l<n.length-1;++l){const c=n[l];if(/^(cmd|meta|m)$/i.test(c))a=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(i="Alt-"+i),s&&(i="Ctrl-"+i),a&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function Vg(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n!==!1&&e.shiftKey&&(t="Shift-"+t),t}const Pte=Mm.default(De.domEventHandlers({keydown(t,e){return S6(w6(e.state),t,e,"editor")}})),x6=Re.define({enables:Pte}),EI=new WeakMap;function w6(t){let e=t.facet(x6),n=EI.get(e);return n||EI.set(e,n=Rte(e.reduce((i,r)=>i.concat(r),[]))),n}function Nte(t,e,n){return S6(w6(t.state),e,t,n)}let Za=null;const Mte=4e3;function Rte(t,e=Ete){let n=Object.create(null),i=Object.create(null),r=(o,a)=>{let l=i[o];if(l==null)i[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,l,c,u)=>{var d,f;let p=n[o]||(n[o]=Object.create(null)),m=a.split(/ (?!$)/).map(v=>Ate(v,e));for(let v=1;v<m.length;v++){let b=m.slice(0,v).join(" ");r(b,!0),p[b]||(p[b]={preventDefault:!0,stopPropagation:!1,run:[w=>{let k=Za={view:w,prefix:b,scope:o};return setTimeout(()=>{Za==k&&(Za=null)},Mte),!0}]})}let g=m.join(" ");r(g,!1);let y=p[g]||(p[g]={preventDefault:!1,stopPropagation:!1,run:((f=(d=p._any)===null||d===void 0?void 0:d.run)===null||f===void 0?void 0:f.slice())||[]});l&&y.run.push(l),c&&(y.preventDefault=!0),u&&(y.stopPropagation=!0)};for(let o of t){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of a){let u=n[c]||(n[c]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:d}=o;for(let f in u)u[f].run.push(p=>d(p,bk))}let l=o[e]||o.key;if(l)for(let c of a)s(c,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(c,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return n}let bk=null;function S6(t,e,n,i){bk=e;let r=QQ(e),s=qr(r,0),o=ia(s)==r.length&&r!=" ",a="",l=!1,c=!1,u=!1;Za&&Za.view==n&&Za.scope==i&&(a=Za.prefix+" ",c6.indexOf(e.keyCode)<0&&(c=!0,Za=null));let d=new Set,f=y=>{if(y){for(let v of y.run)if(!d.has(v)&&(d.add(v),v(n)))return y.stopPropagation&&(u=!0),!0;y.preventDefault&&(y.stopPropagation&&(u=!0),c=!0)}return!1},p=t[i],m,g;return p&&(f(p[a+Vg(r,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Ne.windows&&e.ctrlKey&&e.altKey)&&(m=zl[e.keyCode])&&m!=r?(f(p[a+Vg(m,e,!0)])||e.shiftKey&&(g=Wp[e.keyCode])!=r&&g!=m&&f(p[a+Vg(g,e,!1)]))&&(l=!0):o&&e.shiftKey&&f(p[a+Vg(r,e,!0)])&&(l=!0),!l&&f(p._any)&&(l=!0)),c&&(l=!0),l&&u&&e.stopPropagation(),bk=null,l}class Lm{constructor(e,n,i,r,s){this.className=e,this.left=n,this.top=i,this.width=r,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,n){return n.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,n,i){if(i.empty){let r=e.coordsAtPos(i.head,i.assoc||1);if(!r)return[];let s=k6(e);return[new Lm(n,r.left-s.left,r.top-s.top,null,r.bottom-r.top)]}else return Ite(e,n,i)}}function k6(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==rn.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function AI(t,e,n,i){let r=t.coordsAtPos(e,n*2);if(!r)return i;let s=t.dom.getBoundingClientRect(),o=(r.top+r.bottom)/2,a=t.posAtCoords({x:s.left+1,y:o}),l=t.posAtCoords({x:s.right-1,y:o});return a==null||l==null?i:{from:Math.max(i.from,Math.min(a,l)),to:Math.min(i.to,Math.max(a,l))}}function Ite(t,e,n){if(n.to<=t.viewport.from||n.from>=t.viewport.to)return[];let i=Math.max(n.from,t.viewport.from),r=Math.min(n.to,t.viewport.to),s=t.textDirection==rn.LTR,o=t.contentDOM,a=o.getBoundingClientRect(),l=k6(t),c=o.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),d=a.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),f=a.right-(u?parseInt(u.paddingRight):0),p=pk(t,i,1),m=pk(t,r,-1),g=p.type==Oi.Text?p:null,y=m.type==Oi.Text?m:null;if(g&&(t.lineWrapping||p.widgetLineBreaks)&&(g=AI(t,i,1,g)),y&&(t.lineWrapping||m.widgetLineBreaks)&&(y=AI(t,r,-1,y)),g&&y&&g.from==y.from&&g.to==y.to)return b(w(n.from,n.to,g));{let C=g?w(n.from,null,g):k(p,!1),E=y?w(null,n.to,y):k(m,!0),_=[];return(g||p).to<(y||m).from-(g&&y?1:0)||p.widgetLineBreaks>1&&C.bottom+t.defaultLineHeight/2<E.top?_.push(v(d,C.bottom,f,E.top)):C.bottom<E.top&&t.elementAtHeight((C.bottom+E.top)/2).type==Oi.Text&&(C.bottom=E.top=(C.bottom+E.top)/2),b(C).concat(_).concat(b(E))}function v(C,E,_,A){return new Lm(e,C-l.left,E-l.top,_-C,A-E)}function b({top:C,bottom:E,horizontal:_}){let A=[];for(let R=0;R<_.length;R+=2)A.push(v(_[R],C,_[R+1],E));return A}function w(C,E,_){let A=1e9,R=-1e9,L=[];function O(B,K,J,ne,V){let U=t.coordsAtPos(B,B==_.to?-2:2),se=t.coordsAtPos(J,J==_.from?2:-2);!U||!se||(A=Math.min(U.top,se.top,A),R=Math.max(U.bottom,se.bottom,R),V==rn.LTR?L.push(s&&K?d:U.left,s&&ne?f:se.right):L.push(!s&&ne?d:se.left,!s&&K?f:U.right))}let I=C??_.from,G=E??_.to;for(let B of t.visibleRanges)if(B.to>I&&B.from<G)for(let K=Math.max(B.from,I),J=Math.min(B.to,G);;){let ne=t.state.doc.lineAt(K);for(let V of t.bidiSpans(ne)){let U=V.from+ne.from,se=V.to+ne.from;if(U>=J)break;se>K&&O(Math.max(U,K),C==null&&U<=I,Math.min(se,J),E==null&&se>=G,V.dir)}if(K=ne.to+1,K>=J)break}return L.length==0&&O(I,C==null,G,E==null,t.textDirection),{top:A,bottom:R,horizontal:L}}function k(C,E){let _=a.top+(E?C.top:C.bottom);return{top:_,bottom:_,horizontal:[]}}}function Tte(t,e){return t.constructor==e.constructor&&t.eq(e)}class Ote{constructor(e,n){this.view=e,this.layer=n,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),n.above&&this.dom.classList.add("cm-layer-above"),n.class&&this.dom.classList.add(n.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),n.mount&&n.mount(this.dom,e)}update(e){e.startState.facet(ev)!=e.state.facet(ev)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let n=0,i=e.facet(ev);for(;n<i.length&&i[n]!=this.layer;)n++;this.dom.style.zIndex=String((this.layer.above?150:-1)-n)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:n}=this.view;(e!=this.scaleX||n!=this.scaleY)&&(this.scaleX=e,this.scaleY=n,this.dom.style.transform=`scale(${1/e}, ${1/n})`)}draw(e){if(e.length!=this.drawn.length||e.some((n,i)=>!Tte(n,this.drawn[i]))){let n=this.dom.firstChild,i=0;for(let r of e)r.update&&n&&r.constructor&&this.drawn[i].constructor&&r.update(n,this.drawn[i])?(n=n.nextSibling,i++):this.dom.insertBefore(r.draw(),n);for(;n;){let r=n.nextSibling;n.remove(),n=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const ev=Re.define();function _6(t){return[ui.define(e=>new Ote(e,t)),ev.of(t)]}const Xp=Re.define({combine(t){return Ql(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,n)=>Math.min(e,n),drawRangeCursor:(e,n)=>e||n})}});function Lte(t={}){return[Xp.of(t),Dte,jte,Bte,Z8.of(!0)]}function C6(t){return t.startState.facet(Xp)!=t.state.facet(Xp)}const Dte=_6({above:!0,markers(t){let{state:e}=t,n=e.facet(Xp),i=[];for(let r of e.selection.ranges){let s=r==e.selection.main;if(r.empty||n.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=r.empty?r:le.cursor(r.head,r.head>r.anchor?-1:1);for(let l of Lm.forRange(t,o,a))i.push(l)}}return i},update(t,e){t.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let n=C6(t);return n&&PI(t.state,e),t.docChanged||t.selectionSet||n},mount(t,e){PI(e.state,t)},class:"cm-cursorLayer"});function PI(t,e){e.style.animationDuration=t.facet(Xp).cursorBlinkRate+"ms"}const jte=_6({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:Lm.forRange(t,"cm-selectionBackground",e)).reduce((e,n)=>e.concat(n))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||C6(t)},class:"cm-selectionLayer"}),Bte=Mm.highest(De.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}}));function NI(t,e,n,i,r){e.lastIndex=0;for(let s=t.iterRange(n,i),o=n,a;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;a=e.exec(s.value);)r(o+a.index,a)}function $te(t,e){let n=t.visibleRanges;if(n.length==1&&n[0].from==t.viewport.from&&n[0].to==t.viewport.to)return n;let i=[];for(let{from:r,to:s}of n)r=Math.max(t.state.doc.lineAt(r).from,r-e),s=Math.min(t.state.doc.lineAt(s).to,s+e),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}class Fte{constructor(e){const{regexp:n,decoration:i,decorate:r,boundary:s,maxLength:o=1e3}=e;if(!n.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=n,r)this.addMatch=(a,l,c,u)=>r(u,c,c+a[0].length,a,l);else if(typeof i=="function")this.addMatch=(a,l,c,u)=>{let d=i(a,l,c);d&&u(c,c+a[0].length,d)};else if(i)this.addMatch=(a,l,c,u)=>u(c,c+a[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let n=new $l,i=n.add.bind(n);for(let{from:r,to:s}of $te(e,this.maxLength))NI(e.state.doc,this.regexp,r,s,(o,a)=>this.addMatch(a,e,o,i));return n.finish()}updateDeco(e,n){let i=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((s,o,a,l)=>{l>=e.view.viewport.from&&a<=e.view.viewport.to&&(i=Math.min(a,i),r=Math.max(l,r))}),e.viewportMoved||r-i>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,n.map(e.changes),i,r):n}updateRange(e,n,i,r){for(let s of e.visibleRanges){let o=Math.max(s.from,i),a=Math.min(s.to,r);if(a>=o){let l=e.state.doc.lineAt(o),c=l.to<a?e.state.doc.lineAt(a):l,u=Math.max(s.from,l.from),d=Math.min(s.to,c.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){u=o;break}for(;a<c.to;a++)if(this.boundary.test(c.text[a-c.from])){d=a;break}}let f=[],p,m=(g,y,v)=>f.push(v.range(g,y));if(l==c)for(this.regexp.lastIndex=u-l.from;(p=this.regexp.exec(l.text))&&p.index<d-l.from;)this.addMatch(p,e,p.index+l.from,m);else NI(e.state.doc,this.regexp,u,d,(g,y)=>this.addMatch(y,e,g,m));n=n.update({filterFrom:u,filterTo:d,filter:(g,y)=>g<u||y>d,add:f})}}return n}}const xk=/x/.unicode!=null?"gu":"g",zte=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,xk),Ute={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Xx=null;function Vte(){var t;if(Xx==null&&typeof document<"u"&&document.body){let e=document.body.style;Xx=((t=e.tabSize)!==null&&t!==void 0?t:e.MozTabSize)!=null}return Xx||!1}const tv=Re.define({combine(t){let e=Ql(t,{render:null,specialChars:zte,addSpecialChars:null});return(e.replaceTabs=!Vte())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,xk)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,xk)),e}});function Hte(t={}){return[tv.of(t),Wte()]}let MI=null;function Wte(){return MI||(MI=ui.fromClass(class{constructor(t){this.view=t,this.decorations=ht.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(tv)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new Fte({regexp:t.specialChars,decoration:(e,n,i)=>{let{doc:r}=n.state,s=qr(e[0],0);if(s==9){let o=r.lineAt(i),a=n.state.tabSize,l=Im(o.text,a,i-o.from);return ht.replace({widget:new Xte((a-l%a)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=ht.replace({widget:new Kte(t,s)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(tv);t.startState.facet(tv)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))}const Gte="•";function qte(t){return t>=32?Gte:t==10?"␤":String.fromCharCode(9216+t)}class Kte extends ec{constructor(e,n){super(),this.options=e,this.code=n}eq(e){return e.code==this.code}toDOM(e){let n=qte(this.code),i=e.state.phrase("Control character")+" "+(Ute[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,i,n);if(r)return r;let s=document.createElement("span");return s.textContent=n,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class Xte extends ec{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function Yte(){return Zte}const Jte=ht.line({class:"cm-activeLine"}),Zte=ui.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,n=[];for(let i of t.state.selection.ranges){let r=t.lineBlockAt(i.head);r.from>e&&(n.push(Jte.range(r.from)),e=r.from)}return ht.set(n)}},{decorations:t=>t.decorations}),Jf="-10000px";class E6{constructor(e,n,i,r){this.facet=n,this.createTooltipView=i,this.removeTooltipView=r,this.input=e.state.facet(n),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=i(o,s))}update(e,n){var i;let r=e.state.facet(this.facet),s=r.filter(l=>l);if(r===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let o=[],a=n?[]:null;for(let l=0;l<s.length;l++){let c=s[l],u=-1;if(c){for(let d=0;d<this.tooltips.length;d++){let f=this.tooltips[d];f&&f.create==c.create&&(u=d)}if(u<0)o[l]=this.createTooltipView(c,l?o[l-1]:null),a&&(a[l]=!!c.above);else{let d=o[l]=this.tooltipViews[u];a&&(a[l]=n[u]),d.update&&d.update(e)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(i=l.destroy)===null||i===void 0||i.call(l));return n&&(a.forEach((l,c)=>n[c]=l),n.length=a.length),this.input=r,this.tooltips=s,this.tooltipViews=o,!0}}function Qte(t){let e=t.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const Yx=Re.define({combine:t=>{var e,n,i;return{position:Ne.ios?"absolute":((e=t.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((n=t.find(r=>r.parent))===null||n===void 0?void 0:n.parent)||null,tooltipSpace:((i=t.find(r=>r.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||Qte}}}),RI=new WeakMap,SE=ui.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(Yx);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new E6(t,kE,(n,i)=>this.createTooltip(n,i),n=>{this.resizeObserver&&this.resizeObserver.unobserve(n.dom),n.dom.remove()}),this.above=this.manager.tooltips.map(n=>!!n.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(n=>{Date.now()>this.lastTransaction-50&&n.length>0&&n[n.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let n=e||t.geometryChanged,i=t.state.facet(Yx);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;n=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(t,e){let n=t.create(this.view),i=e?e.dom:null;if(n.dom.classList.add("cm-tooltip"),t.arrow&&!n.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",n.dom.appendChild(r)}return n.dom.style.position=this.position,n.dom.style.top=Jf,n.dom.style.left="0px",this.container.insertBefore(n.dom,i),n.mount&&n.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(n.dom),n}destroy(){var t,e,n;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(t=i.destroy)===null||t===void 0||t.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(n=this.intersectionObserver)===null||n===void 0||n.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=1,e=1,n=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(Ne.gecko)n=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==Jf&&s.style.left=="0px"){let o=s.getBoundingClientRect();n=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(n||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(t=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),r=yE(this.view);return{visible:{left:i.left+r.left,top:i.top+r.top,right:i.right-r.right,bottom:i.bottom-r.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,o)=>{let a=this.manager.tooltipViews[o];return a.getCoords?a.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(Yx).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:n}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{visible:n,space:i,scaleX:r,scaleY:s}=t,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:u}=c,d=t.pos[a],f=t.size[a];if(!d||l.clip!==!1&&(d.bottom<=Math.max(n.top,i.top)||d.top>=Math.min(n.bottom,i.bottom)||d.right<Math.max(n.left,i.left)-.1||d.left>Math.min(n.right,i.right)+.1)){u.style.top=Jf;continue}let p=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,m=p?7:0,g=f.right-f.left,y=(e=RI.get(c))!==null&&e!==void 0?e:f.bottom-f.top,v=c.offset||tne,b=this.view.textDirection==rn.LTR,w=f.width>i.right-i.left?b?i.left:i.right-f.width:b?Math.max(i.left,Math.min(d.left-(p?14:0)+v.x,i.right-g)):Math.min(Math.max(i.left,d.left-g+(p?14:0)-v.x),i.right-g),k=this.above[a];!l.strictSide&&(k?d.top-y-m-v.y<i.top:d.bottom+y+m+v.y>i.bottom)&&k==i.bottom-d.bottom>d.top-i.top&&(k=this.above[a]=!k);let C=(k?d.top-i.top:i.bottom-d.bottom)-m;if(C<y&&c.resize!==!1){if(C<this.view.defaultLineHeight){u.style.top=Jf;continue}RI.set(c,y),u.style.height=(y=C)/s+"px"}else u.style.height&&(u.style.height="");let E=k?d.top-y-m-v.y:d.bottom+m+v.y,_=w+g;if(c.overlap!==!0)for(let A of o)A.left<_&&A.right>w&&A.top<E+y&&A.bottom>E&&(E=k?A.top-y-2-m:A.bottom+m+2);if(this.position=="absolute"?(u.style.top=(E-t.parent.top)/s+"px",II(u,(w-t.parent.left)/r)):(u.style.top=E/s+"px",II(u,w/r)),p){let A=d.left+(b?v.x:-v.x)-(w+14-7);p.style.left=A/r+"px"}c.overlap!==!0&&o.push({left:w,top:E,right:_,bottom:E+y}),u.classList.toggle("cm-tooltip-above",k),u.classList.toggle("cm-tooltip-below",!k),c.positioned&&c.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=Jf}},{eventObservers:{scroll(){this.maybeMeasure()}}});function II(t,e){let n=parseInt(t.style.left,10);(isNaN(n)||Math.abs(e-n)>1)&&(t.style.left=e+"px")}const ene=De.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),tne={x:0,y:0},kE=Re.define({enables:[SE,ene]}),vy=Re.define({combine:t=>t.reduce((e,n)=>e.concat(n),[])});class Ub{static create(e){return new Ub(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new E6(e,vy,(n,i)=>this.createHostedView(n,i),n=>n.dom.remove())}createHostedView(e,n){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,n?n.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let n of this.manager.tooltipViews)n.mount&&n.mount(e);this.mounted=!0}positioned(e){for(let n of this.manager.tooltipViews)n.positioned&&n.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let n of this.manager.tooltipViews)(e=n.destroy)===null||e===void 0||e.call(n)}passProp(e){let n;for(let i of this.manager.tooltipViews){let r=i[e];if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}}return n}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const nne=kE.compute([vy],t=>{let e=t.facet(vy);return e.length===0?null:{pos:Math.min(...e.map(n=>n.pos)),end:Math.max(...e.map(n=>{var i;return(i=n.end)!==null&&i!==void 0?i:n.pos})),create:Ub.create,above:e[0].above,arrow:e.some(n=>n.arrow)}});class ine{constructor(e,n,i,r,s){this.view=e,this.source=n,this.field=i,this.setHover=r,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:n}=this,i=e.docView.nearest(n.target);if(!i)return;let r,s=1;if(i instanceof al)r=i.posAtStart;else{if(r=e.posAtCoords(n),r==null)return;let a=e.coordsAtPos(r);if(!a||n.y<a.top||n.y>a.bottom||n.x<a.left-e.defaultCharacterWidth||n.x>a.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(r)).find(u=>u.from<=r&&u.to>=r),c=l&&l.dir==rn.RTL?-1:1;s=n.x<a.left?-c:c}let o=this.source(e,r,s);if(o!=null&&o.then){let a=this.pending={pos:r};o.then(l=>{this.pending==a&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>Cr(e.state,l,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(SE),n=e?e.manager.tooltips.findIndex(i=>i.create==Ub.create):-1;return n>-1?e.manager.tooltipViews[n]:null}mousemove(e){var n,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:r,tooltip:s}=this;if(r.length&&s&&!rne(s.dom,e)||this.pending){let{pos:o}=r[0]||this.pending,a=(i=(n=r[0])===null||n===void 0?void 0:n.end)!==null&&i!==void 0?i:o;(o==a?this.view.posAtCoords(this.lastMove)!=o:!sne(this.view,o,a,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:n}=this;if(n.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let n=i=>{e.removeEventListener("mouseleave",n),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",n)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Hg=4;function rne(t,e){let{left:n,right:i,top:r,bottom:s}=t.getBoundingClientRect(),o;if(o=t.querySelector(".cm-tooltip-arrow")){let a=o.getBoundingClientRect();r=Math.min(a.top,r),s=Math.max(a.bottom,s)}return e.clientX>=n-Hg&&e.clientX<=i+Hg&&e.clientY>=r-Hg&&e.clientY<=s+Hg}function sne(t,e,n,i,r,s){let o=t.scrollDOM.getBoundingClientRect(),a=t.documentTop+t.documentPadding.top+t.contentHeight;if(o.left>i||o.right<i||o.top>r||Math.min(o.bottom,a)<r)return!1;let l=t.posAtCoords({x:i,y:r},!1);return l>=e&&l<=n}function one(t,e={}){let n=ft.define(),i=$i.define({create(){return[]},update(r,s){if(r.length&&(e.hideOnChange&&(s.docChanged||s.selection)?r=[]:e.hideOn&&(r=r.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let a of r){let l=s.changes.mapPos(a.pos,-1,nr.TrackDel);if(l!=null){let c=Object.assign(Object.create(null),a);c.pos=l,c.end!=null&&(c.end=s.changes.mapPos(c.end)),o.push(c)}}r=o}for(let o of s.effects)o.is(n)&&(r=o.value),o.is(lne)&&(r=[]);return r},provide:r=>vy.from(r)});return{active:i,extension:[i,ui.define(r=>new ine(r,t,i,n,e.hoverTime||300)),nne]}}function ane(t,e){let n=t.plugin(SE);if(!n)return null;let i=n.manager.tooltips.indexOf(e);return i<0?null:n.manager.tooltipViews[i]}const lne=ft.define(),TI=Re.define({combine(t){let e,n;for(let i of t)e=e||i.topContainer,n=n||i.bottomContainer;return{topContainer:e,bottomContainer:n}}});function Yp(t,e){let n=t.plugin(A6),i=n?n.specs.indexOf(e):-1;return i>-1?n.panels[i]:null}const A6=ui.fromClass(class{constructor(t){this.input=t.state.facet(Jp),this.specs=this.input.filter(n=>n),this.panels=this.specs.map(n=>n(t));let e=t.state.facet(TI);this.top=new Wg(t,!0,e.topContainer),this.bottom=new Wg(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(n=>n.top)),this.bottom.sync(this.panels.filter(n=>!n.top));for(let n of this.panels)n.dom.classList.add("cm-panel"),n.mount&&n.mount()}update(t){let e=t.state.facet(TI);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Wg(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Wg(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=t.state.facet(Jp);if(n!=this.input){let i=n.filter(l=>l),r=[],s=[],o=[],a=[];for(let l of i){let c=this.specs.indexOf(l),u;c<0?(u=l(t.view),a.push(u)):(u=this.panels[c],u.update&&u.update(t)),r.push(u),(u.top?s:o).push(u)}this.specs=i,this.panels=r,this.top.sync(s),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let i of this.panels)i.update&&i.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>De.scrollMargins.of(e=>{let n=e.plugin(t);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}})});class Wg{constructor(e,n,i){this.view=e,this.top=n,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let n of this.panels)n.destroy&&e.indexOf(n)<0&&n.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let n=this.container||this.view.dom;n.insertBefore(this.dom,this.top?n.firstChild:null)}let e=this.dom.firstChild;for(let n of this.panels)if(n.dom.parentNode==this.dom){for(;e!=n.dom;)e=OI(e);e=e.nextSibling}else this.dom.insertBefore(n.dom,e);for(;e;)e=OI(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function OI(t){let e=t.nextSibling;return t.remove(),e}const Jp=Re.define({enables:A6});class Vl extends eu{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Vl.prototype.elementClass="";Vl.prototype.toDOM=void 0;Vl.prototype.mapMode=nr.TrackBefore;Vl.prototype.startSide=Vl.prototype.endSide=-1;Vl.prototype.point=!0;const nv=Re.define(),cne=Re.define(),iv=Re.define(),LI=Re.define({combine:t=>t.some(e=>e)});function une(t){return[dne]}const dne=ui.fromClass(class{constructor(t){this.view=t,this.domAfter=null,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(iv).map(e=>new jI(t,e)),this.fixed=!t.state.facet(LI);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(t){if(this.updateGutters(t)){let e=this.prevViewport,n=t.view.viewport,i=Math.min(e.to,n.to)-Math.max(e.from,n.from);this.syncGutters(i<(n.to-n.from)*.8)}if(t.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(LI)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let n=Ot.iter(this.view.state.facet(nv),this.view.viewport.from),i=[],r=this.gutters.map(s=>new fne(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(s.type)){let o=!0;for(let a of s.type)if(a.type==Oi.Text&&o){wk(n,i,a.from);for(let l of r)l.line(this.view,a,i);o=!1}else if(a.widget)for(let l of r)l.widget(this.view,a)}else if(s.type==Oi.Text){wk(n,i,s.from);for(let o of r)o.line(this.view,s,i)}else if(s.widget)for(let o of r)o.widget(this.view,s);for(let s of r)s.finish();t&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(t){let e=t.startState.facet(iv),n=t.state.facet(iv),i=t.docChanged||t.heightChanged||t.viewportChanged||!Ot.eq(t.startState.facet(nv),t.state.facet(nv),t.view.viewport.from,t.view.viewport.to);if(e==n)for(let r of this.gutters)r.update(t)&&(i=!0);else{i=!0;let r=[];for(let s of n){let o=e.indexOf(s);o<0?r.push(new jI(this.view,s)):(this.gutters[o].update(t),r.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),r.indexOf(s)<0&&s.destroy();for(let s of r)s.config.side=="after"?this.getDOMAfter().appendChild(s.dom):this.dom.appendChild(s.dom);this.gutters=r}return i}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:t=>De.scrollMargins.of(e=>{let n=e.plugin(t);if(!n||n.gutters.length==0||!n.fixed)return null;let i=n.dom.offsetWidth*e.scaleX,r=n.domAfter?n.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==rn.LTR?{left:i,right:r}:{right:i,left:r}})});function DI(t){return Array.isArray(t)?t:[t]}function wk(t,e,n){for(;t.value&&t.from<=n;)t.from==n&&e.push(t.value),t.next()}class fne{constructor(e,n,i){this.gutter=e,this.height=i,this.i=0,this.cursor=Ot.iter(e.markers,n.from)}addElement(e,n,i){let{gutter:r}=this,s=(n.top-this.height)/e.scaleY,o=n.height/e.scaleY;if(this.i==r.elements.length){let a=new P6(e,o,s,i);r.elements.push(a),r.dom.appendChild(a.dom)}else r.elements[this.i].update(e,o,s,i);this.height=n.bottom,this.i++}line(e,n,i){let r=[];wk(this.cursor,r,n.from),i.length&&(r=r.concat(i));let s=this.gutter.config.lineMarker(e,n,r);s&&r.unshift(s);let o=this.gutter;r.length==0&&!o.config.renderEmptyElements||this.addElement(e,n,r)}widget(e,n){let i=this.gutter.config.widgetMarker(e,n.widget,n),r=i?[i]:null;for(let s of e.state.facet(cne)){let o=s(e,n.widget,n);o&&(r||(r=[])).push(o)}r&&this.addElement(e,n,r)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let n=e.elements.pop();e.dom.removeChild(n.dom),n.destroy()}}}class jI{constructor(e,n){this.view=e,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in n.domEventHandlers)this.dom.addEventListener(i,r=>{let s=r.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let l=s.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=r.clientY;let a=e.lineBlockAtHeight(o-e.documentTop);n.domEventHandlers[i](e,a,r)&&r.preventDefault()});this.markers=DI(n.markers(e)),n.initialSpacer&&(this.spacer=new P6(e,0,0,[n.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let n=this.markers;if(this.markers=DI(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let i=e.view.viewport;return!Ot.eq(this.markers,n,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class P6{constructor(e,n,i,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,n,i,r)}update(e,n,i,r){this.height!=n&&(this.height=n,this.dom.style.height=n+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),hne(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,n){let i="cm-gutterElement",r=this.dom.firstChild;for(let s=0,o=0;;){let a=o,l=s<n.length?n[s++]:null,c=!1;if(l){let u=l.elementClass;u&&(i+=" "+u);for(let d=o;d<this.markers.length;d++)if(this.markers[d].compare(l)){a=d,c=!0;break}}else a=this.markers.length;for(;o<a;){let u=this.markers[o++];if(u.toDOM){u.destroy(r);let d=r.nextSibling;r.remove(),r=d}}if(!l)break;l.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(l.toDOM(e),r)),c&&o++}this.dom.className=i,this.markers=n}destroy(){this.setMarkers(null,[])}}function hne(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].compare(e[n]))return!1;return!0}const pne=Re.define(),mne=Re.define(),ld=Re.define({combine(t){return Ql(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,n){let i=Object.assign({},e);for(let r in n){let s=i[r],o=n[r];i[r]=s?(a,l,c)=>s(a,l,c)||o(a,l,c):o}return i}})}});class Jx extends Vl{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Zx(t,e){return t.state.facet(ld).formatNumber(e,t.state)}const gne=iv.compute([ld],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(pne)},lineMarker(e,n,i){return i.some(r=>r.toDOM)?null:new Jx(Zx(e,e.state.doc.lineAt(n.from).number))},widgetMarker:(e,n,i)=>{for(let r of e.state.facet(mne)){let s=r(e,n,i);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(ld)!=e.state.facet(ld),initialSpacer(e){return new Jx(Zx(e,BI(e.state.doc.lines)))},updateSpacer(e,n){let i=Zx(n.view,BI(n.view.state.doc.lines));return i==e.number?e:new Jx(i)},domEventHandlers:t.facet(ld).domEventHandlers,side:"before"}));function vne(t={}){return[ld.of(t),une(),gne]}function BI(t){let e=9;for(;e<t;)e=e*10+9;return e}const yne=new class extends Vl{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},bne=nv.compute(["selection"],t=>{let e=[],n=-1;for(let i of t.selection.ranges){let r=t.doc.lineAt(i.head).from;r>n&&(n=r,e.push(yne.range(r)))}return Ot.of(e)});function xne(){return bne}const N6=new Rm;function wne(t){window.codemirror&&window.codemirror.dispatch({effects:N6.reconfigure(St.readOnly.of(t))})}const M6=ft.define(),Sk=ft.define(),Sne=$i.define({create(){return ht.none},update(t,e){let n=t.map(e.changes);for(const i of e.effects)i.is(M6)&&(n=ht.none,i.value!==null&&(n=n.update({add:[kne.range(i.value)]}))),i.is(Sk)&&(n=ht.none,i.value!==null&&(n=n.update({add:[_ne.range(i.value)]})));return n},provide:t=>De.decorations.from(t)}),kne=ht.line({class:"!bg-gradient-to-r !from-mantis-500/8 !via-mantis-500/5 !to-transparent !border-l-2 !border-mantis-400/40 !shadow-sm"}),_ne=ht.line({class:"cm-current-instruction"});function Cne(t){window.codemirror&&window.codemirror.dispatch({effects:M6.of(null)})}function R6(t){if(window.codemirror)if(t===null)window.codemirror.dispatch({effects:Sk.of(null)});else{const e=window.codemirror.state.doc.lineAt(t).from;window.codemirror.dispatch({effects:Sk.of(e)})}}const Zp=pe(!1),I6=Xa.init("phc_Iq0zy6d8IRJY2ts0uHNWlSbectCsUgQK77MLj3ypSdM",{api_host:"https://us.posthog.com",autocapture:!1,capture_pageview:!0,persistence:"memory"})||Xa,Ene=1,$I=5e3,Zs=new Map,ep=[];function Ane(){let t=0;for(const e of Zs.keys())e>t&&(t=e);return t+1}function Pne(){let t=1/0;for(const e of Zs.keys())e<t&&(t=e);return t}function cl(t,e=!0){switch(t.type){case"ADD_TOAST":{const{toastId:n,toast:i}=t,r=i.duration??$I,s=Number.isFinite(r)?setTimeout(()=>cl({type:"DISMISS_TOAST",toastId:n}),r):null;Zs.set(n,{...i,timeout:s,otherProps:{open:!0,onOpenChange:o=>{o||cl({type:"DISMISS_TOAST",toastId:n})}}}),Zs.size>Ene&&cl({type:"DISMISS_TOAST",toastId:Pne()},!1);break}case"UPDATE_TOAST":{const{toastId:n,toast:i}=t,r=Zs.get(n);if(!r)return;if(typeof i.duration=="number"){r.timeout!==null&&clearTimeout(r.timeout);const s=i.duration??$I,o=Number.isFinite(s)?setTimeout(()=>cl({type:"DISMISS_TOAST",toastId:n}),s):null;Zs.set(n,{...r,...i,timeout:o})}else Zs.set(n,{...r,...i});break}case"DISMISS_TOAST":{const{toastId:n}=t,i=Zs.get(n);if(!i)return;i.timeout!==null&&clearTimeout(i.timeout),Zs.delete(n);break}default:{const n=t;throw new Error(`Unhandled action: ${n}`)}}if(e&&ep.length>0){const n=Array.from(Zs.entries()).map(([i,r])=>({...r,id:i})).sort((i,r)=>r.id-i.id);for(const i of ep)i(n)}}function gi(t){const e=Ane(),n=r=>cl({type:"UPDATE_TOAST",toastId:e,toast:{...r}}),i=()=>cl({type:"DISMISS_TOAST",toastId:e});return cl({type:"ADD_TOAST",toastId:e,toast:t}),{id:e,dismiss:i,update:n}}function Nne(){const[t,e]=x.useState([]);return x.useEffect(()=>(ep.push(e),()=>{const n=ep.indexOf(e);n>-1&&ep.splice(n,1)}),[]),{toastList:t,toast:gi,dismiss:n=>cl({type:"DISMISS_TOAST",toastId:n})}}var _E={exports:{}},_d=typeof Reflect=="object"?Reflect:null,FI=_d&&typeof _d.apply=="function"?_d.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},rv;_d&&typeof _d.ownKeys=="function"?rv=_d.ownKeys:Object.getOwnPropertySymbols?rv=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:rv=function(e){return Object.getOwnPropertyNames(e)};function Mne(t){console&&console.warn&&console.warn(t)}var T6=Number.isNaN||function(e){return e!==e};function zt(){zt.init.call(this)}_E.exports=zt;_E.exports.once=One;zt.EventEmitter=zt;zt.prototype._events=void 0;zt.prototype._eventsCount=0;zt.prototype._maxListeners=void 0;var zI=10;function Vb(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(zt,"defaultMaxListeners",{enumerable:!0,get:function(){return zI},set:function(t){if(typeof t!="number"||t<0||T6(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");zI=t}});zt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};zt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||T6(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function O6(t){return t._maxListeners===void 0?zt.defaultMaxListeners:t._maxListeners}zt.prototype.getMaxListeners=function(){return O6(this)};zt.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")FI(l,this,n);else for(var c=l.length,u=$6(l,c),i=0;i<c;++i)FI(u[i],this,n);return!0};function L6(t,e,n,i){var r,s,o;if(Vb(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),r=O6(t),r>0&&o.length>r&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Mne(a)}return t}zt.prototype.addListener=function(e,n){return L6(this,e,n,!1)};zt.prototype.on=zt.prototype.addListener;zt.prototype.prependListener=function(e,n){return L6(this,e,n,!0)};function Rne(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function D6(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=Rne.bind(i);return r.listener=n,i.wrapFn=r,r}zt.prototype.once=function(e,n){return Vb(n),this.on(e,D6(this,e,n)),this};zt.prototype.prependOnceListener=function(e,n){return Vb(n),this.prependListener(e,D6(this,e,n)),this};zt.prototype.removeListener=function(e,n){var i,r,s,o,a;if(Vb(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===n||i[o].listener===n){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():Ine(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};zt.prototype.off=zt.prototype.removeListener;zt.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(r=0;r<s.length;++r)o=s[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function j6(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?Tne(r):$6(r,r.length)}zt.prototype.listeners=function(e){return j6(this,e,!0)};zt.prototype.rawListeners=function(e){return j6(this,e,!1)};zt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):B6.call(t,e)};zt.prototype.listenerCount=B6;function B6(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}zt.prototype.eventNames=function(){return this._eventsCount>0?rv(this._events):[]};function $6(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function Ine(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Tne(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function One(t,e){return new Promise(function(n,i){function r(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}F6(t,e,s,{once:!0}),e!=="error"&&Lne(t,r,{once:!0})})}function Lne(t,e,n){typeof t.on=="function"&&F6(t,"error",e,n)}function F6(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Dne=_E.exports;function Mo(t){if(typeof t!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=t}typeof Symbol<"u"&&(Mo.prototype[Symbol.iterator]=function(){return this});Mo.of=function(){var t=arguments,e=t.length,n=0;return new Mo(function(){return n>=e?{done:!0}:{done:!1,value:t[n++]}})};Mo.empty=function(){var t=new Mo(function(){return{done:!0}});return t};Mo.fromSequence=function(t){var e=0,n=t.length;return new Mo(function(){return e>=n?{done:!0}:{done:!1,value:t[e++]}})};Mo.is=function(t){return t instanceof Mo?!0:typeof t=="object"&&t!==null&&typeof t.next=="function"};var Hb=Mo;const fs=uu(Hb);var Wb={};Wb.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";Wb.SYMBOL_SUPPORT=typeof Symbol<"u";var jne=Hb,z6=Wb,Bne=z6.ARRAY_BUFFER_SUPPORT,$ne=z6.SYMBOL_SUPPORT;function Fne(t){return typeof t=="string"||Array.isArray(t)||Bne&&ArrayBuffer.isView(t)?jne.fromSequence(t):typeof t!="object"||t===null?null:$ne&&typeof t[Symbol.iterator]=="function"?t[Symbol.iterator]():typeof t.next=="function"?t:null}var U6=function(e){var n=Fne(e);if(!n)throw new Error("obliterator: target is not iterable nor a valid iterator.");return n},zne=U6,Une=function(e,n){for(var i=arguments.length>1?n:1/0,r=i!==1/0?new Array(i):[],s,o=0,a=zne(e);;){if(o===i)return r;if(s=a.next(),s.done)return o!==n&&(r.length=o),r;r[o++]=s.value}};const V6=uu(Une);var Vne=Hb,Hne=U6,Wne=function(){var e=arguments,n=null,i=-1;return new Vne(function(){var s=null;do{if(n===null){if(i++,i>=e.length)return{done:!0};n=Hne(e[i])}if(s=n.next(),s.done===!0){n=null;continue}break}while(!0);return s})};const ua=uu(Wne);function Gne(){const t=arguments[0];for(let e=1,n=arguments.length;e<n;e++)if(arguments[e])for(const i in arguments[e])t[i]=arguments[e][i];return t}let Bn=Gne;typeof Object.assign=="function"&&(Bn=Object.assign);function os(t,e,n,i){const r=t._nodes.get(e);let s=null;return r&&(i==="mixed"?s=r.out&&r.out[n]||r.undirected&&r.undirected[n]:i==="directed"?s=r.out&&r.out[n]:s=r.undirected&&r.undirected[n]),s}function ii(t){return typeof t=="object"&&t!==null}function H6(t){let e;for(e in t)return!1;return!0}function Br(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,writable:!0,value:n})}function ms(t,e,n){const i={enumerable:!0,configurable:!0};typeof n=="function"?i.get=n:(i.value=n,i.writable=!1),Object.defineProperty(t,e,i)}function UI(t){return!(!ii(t)||t.attributes&&!Array.isArray(t.attributes))}function qne(){let t=Math.floor(Math.random()*256)&255;return()=>t++}class CE extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class Ce extends CE{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ce.prototype.constructor)}}class ve extends CE{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ve.prototype.constructor)}}class qe extends CE{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,qe.prototype.constructor)}}function W6(t,e){this.key=t,this.attributes=e,this.clear()}W6.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function G6(t,e){this.key=t,this.attributes=e,this.clear()}G6.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function q6(t,e){this.key=t,this.attributes=e,this.clear()}q6.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Cf(t,e,n,i,r){this.key=e,this.attributes=r,this.undirected=t,this.source=n,this.target=i}Cf.prototype.attach=function(){let t="out",e="in";this.undirected&&(t=e="undirected");const n=this.source.key,i=this.target.key;this.source[t][i]=this,!(this.undirected&&n===i)&&(this.target[e][n]=this)};Cf.prototype.attachMulti=function(){let t="out",e="in";const n=this.source.key,i=this.target.key;this.undirected&&(t=e="undirected");const r=this.source[t],s=r[i];if(typeof s>"u"){r[i]=this,this.undirected&&n===i||(this.target[e][n]=this);return}s.previous=this,this.next=s,r[i]=this,this.target[e][n]=this};Cf.prototype.detach=function(){const t=this.source.key,e=this.target.key;let n="out",i="in";this.undirected&&(n=i="undirected"),delete this.source[n][e],delete this.target[i][t]};Cf.prototype.detachMulti=function(){const t=this.source.key,e=this.target.key;let n="out",i="in";this.undirected&&(n=i="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[n][e],delete this.target[i][t]):(this.next.previous=void 0,this.source[n][e]=this.next,this.target[i][t]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const K6=0,X6=1,Kne=2,Y6=3;function Ea(t,e,n,i,r,s,o){let a,l,c,u;if(i=""+i,n===K6){if(a=t._nodes.get(i),!a)throw new ve(`Graph.${e}: could not find the "${i}" node in the graph.`);c=r,u=s}else if(n===Y6){if(r=""+r,l=t._edges.get(r),!l)throw new ve(`Graph.${e}: could not find the "${r}" edge in the graph.`);const d=l.source.key,f=l.target.key;if(i===d)a=l.target;else if(i===f)a=l.source;else throw new ve(`Graph.${e}: the "${i}" node is not attached to the "${r}" edge (${d}, ${f}).`);c=s,u=o}else{if(l=t._edges.get(i),!l)throw new ve(`Graph.${e}: could not find the "${i}" edge in the graph.`);n===X6?a=l.source:a=l.target,c=r,u=s}return[a,c,u]}function Xne(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Ea(this,e,n,i,r,s);return o.attributes[a]}}function Yne(t,e,n){t.prototype[e]=function(i,r){const[s]=Ea(this,e,n,i,r);return s.attributes}}function Jne(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Ea(this,e,n,i,r,s);return o.attributes.hasOwnProperty(a)}}function Zne(t,e,n){t.prototype[e]=function(i,r,s,o){const[a,l,c]=Ea(this,e,n,i,r,s,o);return a.attributes[l]=c,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:l}),this}}function Qne(t,e,n){t.prototype[e]=function(i,r,s,o){const[a,l,c]=Ea(this,e,n,i,r,s,o);if(typeof c!="function")throw new Ce(`Graph.${e}: updater should be a function.`);const u=a.attributes,d=c(u[l]);return u[l]=d,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:l}),this}}function eie(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Ea(this,e,n,i,r,s);return delete o.attributes[a],this.emit("nodeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:a}),this}}function tie(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Ea(this,e,n,i,r,s);if(!ii(a))throw new Ce(`Graph.${e}: provided attributes are not a plain object.`);return o.attributes=a,this.emit("nodeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function nie(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Ea(this,e,n,i,r,s);if(!ii(a))throw new Ce(`Graph.${e}: provided attributes are not a plain object.`);return Bn(o.attributes,a),this.emit("nodeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:a}),this}}function iie(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Ea(this,e,n,i,r,s);if(typeof a!="function")throw new Ce(`Graph.${e}: provided updater is not a function.`);return o.attributes=a(o.attributes),this.emit("nodeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const rie=[{name:t=>`get${t}Attribute`,attacher:Xne},{name:t=>`get${t}Attributes`,attacher:Yne},{name:t=>`has${t}Attribute`,attacher:Jne},{name:t=>`set${t}Attribute`,attacher:Zne},{name:t=>`update${t}Attribute`,attacher:Qne},{name:t=>`remove${t}Attribute`,attacher:eie},{name:t=>`replace${t}Attributes`,attacher:tie},{name:t=>`merge${t}Attributes`,attacher:nie},{name:t=>`update${t}Attributes`,attacher:iie}];function sie(t){rie.forEach(function({name:e,attacher:n}){n(t,e("Node"),K6),n(t,e("Source"),X6),n(t,e("Target"),Kne),n(t,e("Opposite"),Y6)})}function oie(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new qe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new qe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=os(this,o,a,n),!s)throw new ve(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new qe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ve(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return s.attributes[r]}}function aie(t,e,n){t.prototype[e]=function(i){let r;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new qe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new qe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+i,o=""+arguments[1];if(r=os(this,s,o,n),!r)throw new ve(`Graph.${e}: could not find an edge for the given path ("${s}" - "${o}").`)}else{if(n!=="mixed")throw new qe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,r=this._edges.get(i),!r)throw new ve(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return r.attributes}}function lie(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new qe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new qe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=os(this,o,a,n),!s)throw new ve(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new qe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ve(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return s.attributes.hasOwnProperty(r)}}function cie(t,e,n){t.prototype[e]=function(i,r,s){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new qe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new qe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,l=""+r;if(r=arguments[2],s=arguments[3],o=os(this,a,l,n),!o)throw new ve(`Graph.${e}: could not find an edge for the given path ("${a}" - "${l}").`)}else{if(n!=="mixed")throw new qe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new ve(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return o.attributes[r]=s,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}function uie(t,e,n){t.prototype[e]=function(i,r,s){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new qe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new qe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,l=""+r;if(r=arguments[2],s=arguments[3],o=os(this,a,l,n),!o)throw new ve(`Graph.${e}: could not find an edge for the given path ("${a}" - "${l}").`)}else{if(n!=="mixed")throw new qe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new ve(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(typeof s!="function")throw new Ce(`Graph.${e}: updater should be a function.`);return o.attributes[r]=s(o.attributes[r]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}function die(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new qe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new qe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=os(this,o,a,n),!s)throw new ve(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new qe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ve(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return delete s.attributes[r],this.emit("edgeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:r}),this}}function fie(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new qe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new qe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=os(this,o,a,n),!s)throw new ve(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new qe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ve(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(!ii(r))throw new Ce(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=r,this.emit("edgeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function hie(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new qe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new qe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=os(this,o,a,n),!s)throw new ve(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new qe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ve(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(!ii(r))throw new Ce(`Graph.${e}: provided attributes are not a plain object.`);return Bn(s.attributes,r),this.emit("edgeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:r}),this}}function pie(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new qe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new qe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=os(this,o,a,n),!s)throw new ve(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new qe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ve(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(typeof r!="function")throw new Ce(`Graph.${e}: provided updater is not a function.`);return s.attributes=r(s.attributes),this.emit("edgeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}const mie=[{name:t=>`get${t}Attribute`,attacher:oie},{name:t=>`get${t}Attributes`,attacher:aie},{name:t=>`has${t}Attribute`,attacher:lie},{name:t=>`set${t}Attribute`,attacher:cie},{name:t=>`update${t}Attribute`,attacher:uie},{name:t=>`remove${t}Attribute`,attacher:die},{name:t=>`replace${t}Attributes`,attacher:fie},{name:t=>`merge${t}Attributes`,attacher:hie},{name:t=>`update${t}Attributes`,attacher:pie}];function gie(t){mie.forEach(function({name:e,attacher:n}){n(t,e("Edge"),"mixed"),n(t,e("DirectedEdge"),"directed"),n(t,e("UndirectedEdge"),"undirected")})}const vie=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function yie(t,e,n,i){let r=!1;for(const s in e){if(s===i)continue;const o=e[s];if(r=n(o.key,o.attributes,o.source.key,o.target.key,o.source.attributes,o.target.attributes,o.undirected),t&&r)return o.key}}function bie(t,e,n,i){let r,s,o,a=!1;for(const l in e)if(l!==i){r=e[l];do{if(s=r.source,o=r.target,a=n(r.key,r.attributes,s.key,o.key,s.attributes,o.attributes,r.undirected),t&&a)return r.key;r=r.next}while(r!==void 0)}}function Qx(t,e){const n=Object.keys(t),i=n.length;let r,s=0;return new fs(function(){do if(r)r=r.next;else{if(s>=i)return{done:!0};const a=n[s++];if(a===e){r=void 0;continue}r=t[a]}while(!r);return{done:!1,value:{edge:r.key,attributes:r.attributes,source:r.source.key,target:r.target.key,sourceAttributes:r.source.attributes,targetAttributes:r.target.attributes,undirected:r.undirected}}})}function xie(t,e,n,i){const r=e[n];if(!r)return;const s=r.source,o=r.target;if(i(r.key,r.attributes,s.key,o.key,s.attributes,o.attributes,r.undirected)&&t)return r.key}function wie(t,e,n,i){let r=e[n];if(!r)return;let s=!1;do{if(s=i(r.key,r.attributes,r.source.key,r.target.key,r.source.attributes,r.target.attributes,r.undirected),t&&s)return r.key;r=r.next}while(r!==void 0)}function ew(t,e){let n=t[e];return n.next!==void 0?new fs(function(){if(!n)return{done:!0};const i={edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected};return n=n.next,{done:!1,value:i}}):fs.of({edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected})}function Sie(t,e){if(t.size===0)return[];if(e==="mixed"||e===t.type)return typeof Array.from=="function"?Array.from(t._edges.keys()):V6(t._edges.keys(),t._edges.size);const n=e==="undirected"?t.undirectedSize:t.directedSize,i=new Array(n),r=e==="undirected",s=t._edges.values();let o=0,a,l;for(;a=s.next(),a.done!==!0;)l=a.value,l.undirected===r&&(i[o++]=l.key);return i}function J6(t,e,n,i){if(e.size===0)return;const r=n!=="mixed"&&n!==e.type,s=n==="undirected";let o,a,l=!1;const c=e._edges.values();for(;o=c.next(),o.done!==!0;){if(a=o.value,r&&a.undirected!==s)continue;const{key:u,attributes:d,source:f,target:p}=a;if(l=i(u,d,f.key,p.key,f.attributes,p.attributes,a.undirected),t&&l)return u}}function kie(t,e){if(t.size===0)return fs.empty();const n=e!=="mixed"&&e!==t.type,i=e==="undirected",r=t._edges.values();return new fs(function(){let o,a;for(;;){if(o=r.next(),o.done)return o;if(a=o.value,!(n&&a.undirected!==i))break}return{value:{edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected},done:!1}})}function EE(t,e,n,i,r,s){const o=e?bie:yie;let a;if(n!=="undirected"&&(i!=="out"&&(a=o(t,r.in,s),t&&a)||i!=="in"&&(a=o(t,r.out,s,i?void 0:r.key),t&&a))||n!=="directed"&&(a=o(t,r.undirected,s),t&&a))return a}function _ie(t,e,n,i){const r=[];return EE(!1,t,e,n,i,function(s){r.push(s)}),r}function Cie(t,e,n){let i=fs.empty();return t!=="undirected"&&(e!=="out"&&typeof n.in<"u"&&(i=ua(i,Qx(n.in))),e!=="in"&&typeof n.out<"u"&&(i=ua(i,Qx(n.out,e?void 0:n.key)))),t!=="directed"&&typeof n.undirected<"u"&&(i=ua(i,Qx(n.undirected))),i}function AE(t,e,n,i,r,s,o){const a=n?wie:xie;let l;if(e!=="undirected"&&(typeof r.in<"u"&&i!=="out"&&(l=a(t,r.in,s,o),t&&l)||typeof r.out<"u"&&i!=="in"&&(i||r.key!==s)&&(l=a(t,r.out,s,o),t&&l))||e!=="directed"&&typeof r.undirected<"u"&&(l=a(t,r.undirected,s,o),t&&l))return l}function Eie(t,e,n,i,r){const s=[];return AE(!1,t,e,n,i,r,function(o){s.push(o)}),s}function Aie(t,e,n,i){let r=fs.empty();return t!=="undirected"&&(typeof n.in<"u"&&e!=="out"&&i in n.in&&(r=ua(r,ew(n.in,i))),typeof n.out<"u"&&e!=="in"&&i in n.out&&(e||n.key!==i)&&(r=ua(r,ew(n.out,i)))),t!=="directed"&&typeof n.undirected<"u"&&i in n.undirected&&(r=ua(r,ew(n.undirected,i))),r}function Pie(t,e){const{name:n,type:i,direction:r}=e;t.prototype[n]=function(s,o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];if(!arguments.length)return Sie(this,i);if(arguments.length===1){s=""+s;const a=this._nodes.get(s);if(typeof a>"u")throw new ve(`Graph.${n}: could not find the "${s}" node in the graph.`);return _ie(this.multi,i==="mixed"?this.type:i,r,a)}if(arguments.length===2){s=""+s,o=""+o;const a=this._nodes.get(s);if(!a)throw new ve(`Graph.${n}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(o))throw new ve(`Graph.${n}:  could not find the "${o}" target node in the graph.`);return Eie(i,this.multi,r,a,o)}throw new Ce(`Graph.${n}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Nie(t,e){const{name:n,type:i,direction:r}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(c,u,d){if(!(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)){if(arguments.length===1)return d=c,J6(!1,this,i,d);if(arguments.length===2){c=""+c,d=u;const f=this._nodes.get(c);if(typeof f>"u")throw new ve(`Graph.${s}: could not find the "${c}" node in the graph.`);return EE(!1,this.multi,i==="mixed"?this.type:i,r,f,d)}if(arguments.length===3){c=""+c,u=""+u;const f=this._nodes.get(c);if(!f)throw new ve(`Graph.${s}:  could not find the "${c}" source node in the graph.`);if(!this._nodes.has(u))throw new ve(`Graph.${s}:  could not find the "${u}" target node in the graph.`);return AE(!1,i,this.multi,r,f,u,d)}throw new Ce(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(){const c=Array.prototype.slice.call(arguments),u=c.pop();let d;if(c.length===0){let f=0;i!=="directed"&&(f+=this.undirectedSize),i!=="undirected"&&(f+=this.directedSize),d=new Array(f);let p=0;c.push((m,g,y,v,b,w,k)=>{d[p++]=u(m,g,y,v,b,w,k)})}else d=[],c.push((f,p,m,g,y,v,b)=>{d.push(u(f,p,m,g,y,v,b))});return this[s].apply(this,c),d};const a="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(){const c=Array.prototype.slice.call(arguments),u=c.pop(),d=[];return c.push((f,p,m,g,y,v,b)=>{u(f,p,m,g,y,v,b)&&d.push(f)}),this[s].apply(this,c),d};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(){let c=Array.prototype.slice.call(arguments);if(c.length<2||c.length>4)throw new Ce(`Graph.${l}: invalid number of arguments (expecting 2, 3 or 4 and got ${c.length}).`);if(typeof c[c.length-1]=="function"&&typeof c[c.length-2]!="function")throw new Ce(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let u,d;c.length===2?(u=c[0],d=c[1],c=[]):c.length===3?(u=c[1],d=c[2],c=[c[0]]):c.length===4&&(u=c[2],d=c[3],c=[c[0],c[1]]);let f=d;return c.push((p,m,g,y,v,b,w)=>{f=u(f,p,m,g,y,v,b,w)}),this[s].apply(this,c),f}}function Mie(t,e){const{name:n,type:i,direction:r}=e,s="find"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(l,c,u){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return!1;if(arguments.length===1)return u=l,J6(!0,this,i,u);if(arguments.length===2){l=""+l,u=c;const d=this._nodes.get(l);if(typeof d>"u")throw new ve(`Graph.${s}: could not find the "${l}" node in the graph.`);return EE(!0,this.multi,i==="mixed"?this.type:i,r,d,u)}if(arguments.length===3){l=""+l,c=""+c;const d=this._nodes.get(l);if(!d)throw new ve(`Graph.${s}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(c))throw new ve(`Graph.${s}:  could not find the "${c}" target node in the graph.`);return AE(!0,i,this.multi,r,d,c,u)}throw new Ce(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const o="some"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[o]=function(){const l=Array.prototype.slice.call(arguments),c=l.pop();return l.push((d,f,p,m,g,y,v)=>c(d,f,p,m,g,y,v)),!!this[s].apply(this,l)};const a="every"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[a]=function(){const l=Array.prototype.slice.call(arguments),c=l.pop();return l.push((d,f,p,m,g,y,v)=>!c(d,f,p,m,g,y,v)),!this[s].apply(this,l)}}function Rie(t,e){const{name:n,type:i,direction:r}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(o,a){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return fs.empty();if(!arguments.length)return kie(this,i);if(arguments.length===1){o=""+o;const l=this._nodes.get(o);if(!l)throw new ve(`Graph.${s}: could not find the "${o}" node in the graph.`);return Cie(i,r,l)}if(arguments.length===2){o=""+o,a=""+a;const l=this._nodes.get(o);if(!l)throw new ve(`Graph.${s}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new ve(`Graph.${s}:  could not find the "${a}" target node in the graph.`);return Aie(i,r,l,a)}throw new Ce(`Graph.${s}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Iie(t){vie.forEach(e=>{Pie(t,e),Nie(t,e),Mie(t,e),Rie(t,e)})}const Tie=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Gb(){this.A=null,this.B=null}Gb.prototype.wrap=function(t){this.A===null?this.A=t:this.B===null&&(this.B=t)};Gb.prototype.has=function(t){return this.A!==null&&t in this.A||this.B!==null&&t in this.B};function Zf(t,e,n,i,r){for(const s in i){const o=i[s],a=o.source,l=o.target,c=a===n?l:a;if(e&&e.has(c.key))continue;const u=r(c.key,c.attributes);if(t&&u)return c.key}}function PE(t,e,n,i,r){if(e!=="mixed"){if(e==="undirected")return Zf(t,null,i,i.undirected,r);if(typeof n=="string")return Zf(t,null,i,i[n],r)}const s=new Gb;let o;if(e!=="undirected"){if(n!=="out"){if(o=Zf(t,null,i,i.in,r),t&&o)return o;s.wrap(i.in)}if(n!=="in"){if(o=Zf(t,s,i,i.out,r),t&&o)return o;s.wrap(i.out)}}if(e!=="directed"&&(o=Zf(t,s,i,i.undirected,r),t&&o))return o}function Oie(t,e,n){if(t!=="mixed"){if(t==="undirected")return Object.keys(n.undirected);if(typeof e=="string")return Object.keys(n[e])}const i=[];return PE(!1,t,e,n,function(r){i.push(r)}),i}function Qf(t,e,n){const i=Object.keys(n),r=i.length;let s=0;return new fs(function(){let a=null;do{if(s>=r)return t&&t.wrap(n),{done:!0};const l=n[i[s++]],c=l.source,u=l.target;if(a=c===e?u:c,t&&t.has(a.key)){a=null;continue}}while(a===null);return{done:!1,value:{neighbor:a.key,attributes:a.attributes}}})}function Lie(t,e,n){if(t!=="mixed"){if(t==="undirected")return Qf(null,n,n.undirected);if(typeof e=="string")return Qf(null,n,n[e])}let i=fs.empty();const r=new Gb;return t!=="undirected"&&(e!=="out"&&(i=ua(i,Qf(r,n,n.in))),e!=="in"&&(i=ua(i,Qf(r,n,n.out)))),t!=="directed"&&(i=ua(i,Qf(r,n,n.undirected))),i}function Die(t,e){const{name:n,type:i,direction:r}=e;t.prototype[n]=function(s){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];s=""+s;const o=this._nodes.get(s);if(typeof o>"u")throw new ve(`Graph.${n}: could not find the "${s}" node in the graph.`);return Oie(i==="mixed"?this.type:i,r,o)}}function jie(t,e){const{name:n,type:i,direction:r}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(c,u){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;c=""+c;const d=this._nodes.get(c);if(typeof d>"u")throw new ve(`Graph.${s}: could not find the "${c}" node in the graph.`);PE(!1,i==="mixed"?this.type:i,r,d,u)};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(c,u){const d=[];return this[s](c,(f,p)=>{d.push(u(f,p))}),d};const a="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(c,u){const d=[];return this[s](c,(f,p)=>{u(f,p)&&d.push(f)}),d};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(c,u,d){if(arguments.length<3)throw new Ce(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let f=d;return this[s](c,(p,m)=>{f=u(f,p,m)}),f}}function Bie(t,e){const{name:n,type:i,direction:r}=e,s=n[0].toUpperCase()+n.slice(1,-1),o="find"+s;t.prototype[o]=function(c,u){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;c=""+c;const d=this._nodes.get(c);if(typeof d>"u")throw new ve(`Graph.${o}: could not find the "${c}" node in the graph.`);return PE(!0,i==="mixed"?this.type:i,r,d,u)};const a="some"+s;t.prototype[a]=function(c,u){return!!this[o](c,u)};const l="every"+s;t.prototype[l]=function(c,u){return!this[o](c,(f,p)=>!u(f,p))}}function $ie(t,e){const{name:n,type:i,direction:r}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return fs.empty();o=""+o;const a=this._nodes.get(o);if(typeof a>"u")throw new ve(`Graph.${s}: could not find the "${o}" node in the graph.`);return Lie(i==="mixed"?this.type:i,r,a)}}function Fie(t){Tie.forEach(e=>{Die(t,e),jie(t,e),Bie(t,e),$ie(t,e)})}function Gg(t,e,n,i,r){const s=i._nodes.values(),o=i.type;let a,l,c,u,d,f;for(;a=s.next(),a.done!==!0;){let p=!1;if(l=a.value,o!=="undirected"){u=l.out;for(c in u){d=u[c];do f=d.target,p=!0,r(l.key,f.key,l.attributes,f.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}if(o!=="directed"){u=l.undirected;for(c in u)if(!(e&&l.key>c)){d=u[c];do f=d.target,f.key!==c&&(f=d.source),p=!0,r(l.key,f.key,l.attributes,f.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}n&&!p&&r(l.key,null,l.attributes,null,null,null,null)}}function zie(t,e){const n={key:t};return H6(e.attributes)||(n.attributes=Bn({},e.attributes)),n}function Uie(t,e,n){const i={key:e,source:n.source.key,target:n.target.key};return H6(n.attributes)||(i.attributes=Bn({},n.attributes)),t==="mixed"&&n.undirected&&(i.undirected=!0),i}function Vie(t){if(!ii(t))throw new Ce('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in t))throw new Ce("Graph.import: serialized node is missing its key.");if("attributes"in t&&(!ii(t.attributes)||t.attributes===null))throw new Ce("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function Hie(t){if(!ii(t))throw new Ce('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in t))throw new Ce("Graph.import: serialized edge is missing its source.");if(!("target"in t))throw new Ce("Graph.import: serialized edge is missing its target.");if("attributes"in t&&(!ii(t.attributes)||t.attributes===null))throw new Ce("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in t&&typeof t.undirected!="boolean")throw new Ce("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const Wie=qne(),Gie=new Set(["directed","undirected","mixed"]),VI=new Set(["domain","_events","_eventsCount","_maxListeners"]),qie=[{name:t=>`${t}Edge`,generateKey:!0},{name:t=>`${t}DirectedEdge`,generateKey:!0,type:"directed"},{name:t=>`${t}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:t=>`${t}EdgeWithKey`},{name:t=>`${t}DirectedEdgeWithKey`,type:"directed"},{name:t=>`${t}UndirectedEdgeWithKey`,type:"undirected"}],Kie={allowSelfLoops:!0,multi:!1,type:"mixed"};function Xie(t,e,n){if(n&&!ii(n))throw new Ce(`Graph.addNode: invalid attributes. Expecting an object but got "${n}"`);if(e=""+e,n=n||{},t._nodes.has(e))throw new qe(`Graph.addNode: the "${e}" node already exist in the graph.`);const i=new t.NodeDataClass(e,n);return t._nodes.set(e,i),t.emit("nodeAdded",{key:e,attributes:n}),i}function HI(t,e,n){const i=new t.NodeDataClass(e,n);return t._nodes.set(e,i),t.emit("nodeAdded",{key:e,attributes:n}),i}function Z6(t,e,n,i,r,s,o,a){if(!i&&t.type==="undirected")throw new qe(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(i&&t.type==="directed")throw new qe(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(a&&!ii(a))throw new Ce(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`);if(s=""+s,o=""+o,a=a||{},!t.allowSelfLoops&&s===o)throw new qe(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const l=t._nodes.get(s),c=t._nodes.get(o);if(!l)throw new ve(`Graph.${e}: source node "${s}" not found.`);if(!c)throw new ve(`Graph.${e}: target node "${o}" not found.`);const u={key:null,undirected:i,source:s,target:o,attributes:a};if(n)r=t._edgeKeyGenerator();else if(r=""+r,t._edges.has(r))throw new qe(`Graph.${e}: the "${r}" edge already exists in the graph.`);if(!t.multi&&(i?typeof l.undirected[o]<"u":typeof l.out[o]<"u"))throw new qe(`Graph.${e}: an edge linking "${s}" to "${o}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const d=new Cf(i,r,l,c,a);t._edges.set(r,d);const f=s===o;return i?(l.undirectedDegree++,c.undirectedDegree++,f&&(l.undirectedLoops++,t._undirectedSelfLoopCount++)):(l.outDegree++,c.inDegree++,f&&(l.directedLoops++,t._directedSelfLoopCount++)),t.multi?d.attachMulti():d.attach(),i?t._undirectedSize++:t._directedSize++,u.key=r,t.emit("edgeAdded",u),r}function Yie(t,e,n,i,r,s,o,a,l){if(!i&&t.type==="undirected")throw new qe(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(i&&t.type==="directed")throw new qe(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(a){if(l){if(typeof a!="function")throw new Ce(`Graph.${e}: invalid updater function. Expecting a function but got "${a}"`)}else if(!ii(a))throw new Ce(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`)}s=""+s,o=""+o;let c;if(l&&(c=a,a=void 0),!t.allowSelfLoops&&s===o)throw new qe(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let u=t._nodes.get(s),d=t._nodes.get(o),f,p;if(!n&&(f=t._edges.get(r),f)){if((f.source.key!==s||f.target.key!==o)&&(!i||f.source.key!==o||f.target.key!==s))throw new qe(`Graph.${e}: inconsistency detected when attempting to merge the "${r}" edge with "${s}" source & "${o}" target vs. ("${f.source.key}", "${f.target.key}").`);p=f}if(!p&&!t.multi&&u&&(p=i?u.undirected[o]:u.out[o]),p){const b=[p.key,!1,!1,!1];if(l?!c:!a)return b;if(l){const w=p.attributes;p.attributes=c(w),t.emit("edgeAttributesUpdated",{type:"replace",key:p.key,attributes:p.attributes})}else Bn(p.attributes,a),t.emit("edgeAttributesUpdated",{type:"merge",key:p.key,attributes:p.attributes,data:a});return b}a=a||{},l&&c&&(a=c(a));const m={key:null,undirected:i,source:s,target:o,attributes:a};if(n)r=t._edgeKeyGenerator();else if(r=""+r,t._edges.has(r))throw new qe(`Graph.${e}: the "${r}" edge already exists in the graph.`);let g=!1,y=!1;u||(u=HI(t,s,{}),g=!0,s===o&&(d=u,y=!0)),d||(d=HI(t,o,{}),y=!0),f=new Cf(i,r,u,d,a),t._edges.set(r,f);const v=s===o;return i?(u.undirectedDegree++,d.undirectedDegree++,v&&(u.undirectedLoops++,t._undirectedSelfLoopCount++)):(u.outDegree++,d.inDegree++,v&&(u.directedLoops++,t._directedSelfLoopCount++)),t.multi?f.attachMulti():f.attach(),i?t._undirectedSize++:t._directedSize++,m.key=r,t.emit("edgeAdded",m),[r,!0,g,y]}function ku(t,e){t._edges.delete(e.key);const{source:n,target:i,attributes:r}=e,s=e.undirected,o=n===i;s?(n.undirectedDegree--,i.undirectedDegree--,o&&(n.undirectedLoops--,t._undirectedSelfLoopCount--)):(n.outDegree--,i.inDegree--,o&&(n.directedLoops--,t._directedSelfLoopCount--)),t.multi?e.detachMulti():e.detach(),s?t._undirectedSize--:t._directedSize--,t.emit("edgeDropped",{key:e.key,attributes:r,source:n.key,target:i.key,undirected:s})}class qt extends Dne.EventEmitter{constructor(e){if(super(),e=Bn({},Kie,e),typeof e.multi!="boolean")throw new Ce(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!Gie.has(e.type))throw new Ce(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new Ce(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const n=e.type==="mixed"?W6:e.type==="directed"?G6:q6;Br(this,"NodeDataClass",n);const i="geid_"+Wie()+"_";let r=0;const s=()=>{let o;do o=i+r++;while(this._edges.has(o));return o};Br(this,"_attributes",{}),Br(this,"_nodes",new Map),Br(this,"_edges",new Map),Br(this,"_directedSize",0),Br(this,"_undirectedSize",0),Br(this,"_directedSelfLoopCount",0),Br(this,"_undirectedSelfLoopCount",0),Br(this,"_edgeKeyGenerator",s),Br(this,"_options",e),VI.forEach(o=>Br(this,o,this[o])),ms(this,"order",()=>this._nodes.size),ms(this,"size",()=>this._edges.size),ms(this,"directedSize",()=>this._directedSize),ms(this,"undirectedSize",()=>this._undirectedSize),ms(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),ms(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),ms(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),ms(this,"multi",this._options.multi),ms(this,"type",this._options.type),ms(this,"allowSelfLoops",this._options.allowSelfLoops),ms(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,n){if(this.type==="undirected")return!1;if(arguments.length===1){const i=""+e,r=this._edges.get(i);return!!r&&!r.undirected}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?i.out.hasOwnProperty(n):!1}throw new Ce(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,n){if(this.type==="directed")return!1;if(arguments.length===1){const i=""+e,r=this._edges.get(i);return!!r&&r.undirected}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?i.undirected.hasOwnProperty(n):!1}throw new Ce(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,n){if(arguments.length===1){const i=""+e;return this._edges.has(i)}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?typeof i.out<"u"&&i.out.hasOwnProperty(n)||typeof i.undirected<"u"&&i.undirected.hasOwnProperty(n):!1}throw new Ce(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,n){if(this.type==="undirected")return;if(e=""+e,n=""+n,this.multi)throw new qe("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const i=this._nodes.get(e);if(!i)throw new ve(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ve(`Graph.directedEdge: could not find the "${n}" target node in the graph.`);const r=i.out&&i.out[n]||void 0;if(r)return r.key}undirectedEdge(e,n){if(this.type==="directed")return;if(e=""+e,n=""+n,this.multi)throw new qe("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const i=this._nodes.get(e);if(!i)throw new ve(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ve(`Graph.undirectedEdge: could not find the "${n}" target node in the graph.`);const r=i.undirected&&i.undirected[n]||void 0;if(r)return r.key}edge(e,n){if(this.multi)throw new qe("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ve(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ve(`Graph.edge: could not find the "${n}" target node in the graph.`);const r=i.out&&i.out[n]||i.undirected&&i.undirected[n]||void 0;if(r)return r.key}areDirectedNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ve(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.in||n in i.out}areOutNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ve(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.out}areInNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ve(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.in}areUndirectedNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ve(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:n in i.undirected}areNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ve(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(n in i.in||n in i.out)||this.type!=="directed"&&n in i.undirected}areInboundNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ve(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in i.in||this.type!=="directed"&&n in i.undirected}areOutboundNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ve(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in i.out||this.type!=="directed"&&n in i.undirected}inDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree}outDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree}directedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree}undirectedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree}inboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.inDegree),i}outboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.outDegree),i}degree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.degree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.inDegree+n.outDegree),i}inDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree-n.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree-n.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree-n.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree-n.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.inDegree,r+=n.directedLoops),i-r}outboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.outDegree,r+=n.directedLoops),i-r}degreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.inDegree+n.outDegree,r+=n.directedLoops*2),i-r}source(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ve(`Graph.source: could not find the "${e}" edge in the graph.`);return n.source.key}target(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ve(`Graph.target: could not find the "${e}" edge in the graph.`);return n.target.key}extremities(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ve(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[n.source.key,n.target.key]}opposite(e,n){e=""+e,n=""+n;const i=this._edges.get(n);if(!i)throw new ve(`Graph.opposite: could not find the "${n}" edge in the graph.`);const r=i.source.key,s=i.target.key;if(e===r)return s;if(e===s)return r;throw new ve(`Graph.opposite: the "${e}" node is not attached to the "${n}" edge (${r}, ${s}).`)}hasExtremity(e,n){e=""+e,n=""+n;const i=this._edges.get(e);if(!i)throw new ve(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return i.source.key===n||i.target.key===n}isUndirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ve(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return n.undirected}isDirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ve(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!n.undirected}isSelfLoop(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ve(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return n.source===n.target}addNode(e,n){return Xie(this,e,n).key}mergeNode(e,n){if(n&&!ii(n))throw new Ce(`Graph.mergeNode: invalid attributes. Expecting an object but got "${n}"`);e=""+e,n=n||{};let i=this._nodes.get(e);return i?(n&&(Bn(i.attributes,n),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:i.attributes,data:n})),[e,!1]):(i=new this.NodeDataClass(e,n),this._nodes.set(e,i),this.emit("nodeAdded",{key:e,attributes:n}),[e,!0])}updateNode(e,n){if(n&&typeof n!="function")throw new Ce(`Graph.updateNode: invalid updater function. Expecting a function but got "${n}"`);e=""+e;let i=this._nodes.get(e);if(i){if(n){const s=i.attributes;i.attributes=n(s),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:i.attributes})}return[e,!1]}const r=n?n({}):{};return i=new this.NodeDataClass(e,r),this._nodes.set(e,i),this.emit("nodeAdded",{key:e,attributes:r}),[e,!0]}dropNode(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ve(`Graph.dropNode: could not find the "${e}" node in the graph.`);let i;if(this.type!=="undirected"){for(const r in n.out){i=n.out[r];do ku(this,i),i=i.next;while(i)}for(const r in n.in){i=n.in[r];do ku(this,i),i=i.next;while(i)}}if(this.type!=="directed")for(const r in n.undirected){i=n.undirected[r];do ku(this,i),i=i.next;while(i)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:n.attributes})}dropEdge(e){let n;if(arguments.length>1){const i=""+arguments[0],r=""+arguments[1];if(n=os(this,i,r,this.type),!n)throw new ve(`Graph.dropEdge: could not find the "${i}" -> "${r}" edge in the graph.`)}else if(e=""+e,n=this._edges.get(e),!n)throw new ve(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return ku(this,n),this}dropDirectedEdge(e,n){if(arguments.length<2)throw new qe("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new qe("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,n=""+n;const i=os(this,e,n,"directed");if(!i)throw new ve(`Graph.dropDirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return ku(this,i),this}dropUndirectedEdge(e,n){if(arguments.length<2)throw new qe("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new qe("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const i=os(this,e,n,"undirected");if(!i)throw new ve(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return ku(this,i),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let n;for(;n=e.next(),n.done!==!0;)n.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,n){return this._attributes[e]=n,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,n){if(typeof n!="function")throw new Ce("Graph.updateAttribute: updater should be a function.");const i=this._attributes[e];return this._attributes[e]=n(i),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!ii(e))throw new Ce("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!ii(e))throw new Ce("Graph.mergeAttributes: provided attributes are not a plain object.");return Bn(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new Ce("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,n){if(typeof e!="function")throw new Ce("Graph.updateEachNodeAttributes: expecting an updater function.");if(n&&!UI(n))throw new Ce("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._nodes.values();let r,s;for(;r=i.next(),r.done!==!0;)s=r.value,s.attributes=e(s.key,s.attributes);this.emit("eachNodeAttributesUpdated",{hints:n||null})}updateEachEdgeAttributes(e,n){if(typeof e!="function")throw new Ce("Graph.updateEachEdgeAttributes: expecting an updater function.");if(n&&!UI(n))throw new Ce("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._edges.values();let r,s,o,a;for(;r=i.next(),r.done!==!0;)s=r.value,o=s.source,a=s.target,s.attributes=e(s.key,s.attributes,o.key,a.key,o.attributes,a.attributes,s.undirected);this.emit("eachEdgeAttributesUpdated",{hints:n||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new Ce("Graph.forEachAdjacencyEntry: expecting a callback.");Gg(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new Ce("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");Gg(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new Ce("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");Gg(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new Ce("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");Gg(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):V6(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new Ce("Graph.forEachNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)r=i.value,e(r.key,r.attributes)}findNode(e){if(typeof e!="function")throw new Ce("Graph.findNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,e(r.key,r.attributes))return r.key}mapNodes(e){if(typeof e!="function")throw new Ce("Graph.mapNode: expecting a callback.");const n=this._nodes.values();let i,r;const s=new Array(this.order);let o=0;for(;i=n.next(),i.done!==!0;)r=i.value,s[o++]=e(r.key,r.attributes);return s}someNode(e){if(typeof e!="function")throw new Ce("Graph.someNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,e(r.key,r.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new Ce("Graph.everyNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,!e(r.key,r.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new Ce("Graph.filterNodes: expecting a callback.");const n=this._nodes.values();let i,r;const s=[];for(;i=n.next(),i.done!==!0;)r=i.value,e(r.key,r.attributes)&&s.push(r.key);return s}reduceNodes(e,n){if(typeof e!="function")throw new Ce("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new Ce("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let i=n;const r=this._nodes.values();let s,o;for(;s=r.next(),s.done!==!0;)o=s.value,i=e(i,o.key,o.attributes);return i}nodeEntries(){const e=this._nodes.values();return new fs(()=>{const n=e.next();if(n.done)return n;const i=n.value;return{value:{node:i.key,attributes:i.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let n=0;this._nodes.forEach((r,s)=>{e[n++]=zie(s,r)});const i=new Array(this._edges.size);return n=0,this._edges.forEach((r,s)=>{i[n++]=Uie(this.type,s,r)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:i}}import(e,n=!1){if(e instanceof qt)return e.forEachNode((l,c)=>{n?this.mergeNode(l,c):this.addNode(l,c)}),e.forEachEdge((l,c,u,d,f,p,m)=>{n?m?this.mergeUndirectedEdgeWithKey(l,u,d,c):this.mergeDirectedEdgeWithKey(l,u,d,c):m?this.addUndirectedEdgeWithKey(l,u,d,c):this.addDirectedEdgeWithKey(l,u,d,c)}),this;if(!ii(e))throw new Ce("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!ii(e.attributes))throw new Ce("Graph.import: invalid attributes. Expecting a plain object.");n?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let i,r,s,o,a;if(e.nodes){if(s=e.nodes,!Array.isArray(s))throw new Ce("Graph.import: invalid nodes. Expecting an array.");for(i=0,r=s.length;i<r;i++){o=s[i],Vie(o);const{key:l,attributes:c}=o;n?this.mergeNode(l,c):this.addNode(l,c)}}if(e.edges){let l=!1;if(this.type==="undirected"&&(l=!0),s=e.edges,!Array.isArray(s))throw new Ce("Graph.import: invalid edges. Expecting an array.");for(i=0,r=s.length;i<r;i++){a=s[i],Hie(a);const{source:c,target:u,attributes:d,undirected:f=l}=a;let p;"key"in a?(p=n?f?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:f?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,p.call(this,a.key,c,u,d)):(p=n?f?this.mergeUndirectedEdge:this.mergeDirectedEdge:f?this.addUndirectedEdge:this.addDirectedEdge,p.call(this,c,u,d))}}return this}nullCopy(e){const n=new qt(Bn({},this._options,e));return n.replaceAttributes(Bn({},this.getAttributes())),n}emptyCopy(e){const n=this.nullCopy(e);return this._nodes.forEach((i,r)=>{const s=Bn({},i.attributes);i=new n.NodeDataClass(r,s),n._nodes.set(r,i)}),n}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new qe(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new qe("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new qe("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const n=this.emptyCopy(e),i=this._edges.values();let r,s;for(;r=i.next(),r.done!==!0;)s=r.value,Z6(n,"copy",!1,s.undirected,s.key,s.source.key,s.target.key,Bn({},s.attributes));return n}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((s,o)=>{e[o]=s.attributes});const n={},i={};this._edges.forEach((s,o)=>{const a=s.undirected?"--":"->";let l="",c=s.source.key,u=s.target.key,d;s.undirected&&c>u&&(d=c,c=u,u=d);const f=`(${c})${a}(${u})`;o.startsWith("geid_")?this.multi&&(typeof i[f]>"u"?i[f]=0:i[f]++,l+=`${i[f]}. `):l+=`[${o}]: `,l+=f,n[l]=s.attributes});const r={};for(const s in this)this.hasOwnProperty(s)&&!VI.has(s)&&typeof this[s]!="function"&&typeof s!="symbol"&&(r[s]=this[s]);return r.attributes=this._attributes,r.nodes=e,r.edges=n,Br(r,"constructor",this.constructor),r}}typeof Symbol<"u"&&(qt.prototype[Symbol.for("nodejs.util.inspect.custom")]=qt.prototype.inspect);qie.forEach(t=>{["add","merge","update"].forEach(e=>{const n=t.name(e),i=e==="add"?Z6:Yie;t.generateKey?qt.prototype[n]=function(r,s,o){return i(this,n,!0,(t.type||this.type)==="undirected",null,r,s,o,e==="update")}:qt.prototype[n]=function(r,s,o,a){return i(this,n,!1,(t.type||this.type)==="undirected",r,s,o,a,e==="update")}})});sie(qt);gie(qt);Iie(qt);Fie(qt);class Q6 extends qt{constructor(e){const n=Bn({type:"directed"},e);if("multi"in n&&n.multi!==!1)throw new Ce("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="directed")throw new Ce('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class NE extends qt{constructor(e){const n=Bn({type:"undirected"},e);if("multi"in n&&n.multi!==!1)throw new Ce("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="undirected")throw new Ce('UndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class eB extends qt{constructor(e){const n=Bn({multi:!0},e);if("multi"in n&&n.multi!==!0)throw new Ce("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(n)}}class tB extends qt{constructor(e){const n=Bn({type:"directed",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new Ce("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="directed")throw new Ce('MultiDirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class nB extends qt{constructor(e){const n=Bn({type:"undirected",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new Ce("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="undirected")throw new Ce('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}function Ef(t){t.from=function(e,n){const i=Bn({},e.options,n),r=new t(i);return r.import(e),r}}Ef(qt);Ef(Q6);Ef(NE);Ef(eB);Ef(tB);Ef(nB);qt.Graph=qt;qt.DirectedGraph=Q6;qt.UndirectedGraph=NE;qt.MultiGraph=eB;qt.MultiDirectedGraph=tB;qt.MultiUndirectedGraph=nB;qt.InvalidArgumentsGraphError=Ce;qt.NotFoundGraphError=ve;qt.UsageGraphError=qe;var Jie=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"},iB=Wb,Zie=iB.ARRAY_BUFFER_SUPPORT,Qie=iB.SYMBOL_SUPPORT,ere=function(e,n){var i,r,s,o,a;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if(typeof n!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||Zie&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(s=0,o=e.length;s<o;s++)n(e[s],s);return}if(typeof e.forEach=="function"){e.forEach(n);return}if(Qie&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(i=e,s=0;a=i.next(),a.done!==!0;)n(a.value,s),s++;return}for(r in e)e.hasOwnProperty(r)&&n(e[r],r)},rB=Hb,tre=ere;function In(){this.clear()}In.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};In.prototype.enqueue=function(t){return this.items.push(t),++this.size};In.prototype.dequeue=function(){if(this.size){var t=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,t}};In.prototype.peek=function(){if(this.size)return this.items[this.offset]};In.prototype.forEach=function(t,e){e=arguments.length>1?e:this;for(var n=this.offset,i=0,r=this.items.length;n<r;n++,i++)t.call(e,this.items[n],i,this)};In.prototype.toArray=function(){return this.items.slice(this.offset)};In.prototype.values=function(){var t=this.items,e=this.offset;return new rB(function(){if(e>=t.length)return{done:!0};var n=t[e];return e++,{value:n,done:!1}})};In.prototype.entries=function(){var t=this.items,e=this.offset,n=0;return new rB(function(){if(e>=t.length)return{done:!0};var i=t[e];return e++,{value:[n++,i],done:!1}})};typeof Symbol<"u"&&(In.prototype[Symbol.iterator]=In.prototype.values);In.prototype.toString=function(){return this.toArray().join(",")};In.prototype.toJSON=function(){return this.toArray()};In.prototype.inspect=function(){var t=this.toArray();return Object.defineProperty(t,"constructor",{value:In,enumerable:!1}),t};typeof Symbol<"u"&&(In.prototype[Symbol.for("nodejs.util.inspect.custom")]=In.prototype.inspect);In.from=function(t){var e=new In;return tre(t,function(n){e.enqueue(n)}),e};In.of=function(){return In.from(arguments)};var nre=function(e,n){var i=n.length;if(i!==0){var r=e.length;e.length+=i;for(var s=0;s<i;s++)e[r+s]=n[s]}},sB=Jie,ire=nre;function rre(t,e,n){if(!sB(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');if(!t.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" target node does not exist in the given graph.');if(e=""+e,n=""+n,e===n)return[e];var i=t.inboundNeighbors.bind(t),r=t.outboundNeighbors.bind(t),s={},o={};s[e]=null,o[n]=null;var a=[e],l=[n],c,u,d,f,p,m,g,y,v=!1;e:for(;a.length&&l.length;)if(a.length<=l.length){for(c=a,a=[],p=0,g=c.length;p<g;p++)for(u=c[p],d=r(u),m=0,y=d.length;m<y;m++)if(f=d[m],f in s||(a.push(f),s[f]=u),f in o){v=!0;break e}}else for(c=l,l=[],p=0,g=c.length;p<g;p++)for(u=c[p],d=i(u),m=0,y=d.length;m<y;m++)if(f=d[m],f in o||(l.push(f),o[f]=u),f in s){v=!0;break e}if(!v)return null;for(var b=[];f;)b.unshift(f),f=s[f];for(f=o[b[b.length-1]];f;)b.push(f),f=o[f];return b.length?b:null}function oB(t,e,n){if(!sB(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!e.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" source node does not exist in the given graph.');n=""+n;var i=new Set,r={},s=0;r[n]=0;for(var o=[n],a,l,c;o.length!==0;){var u=[];for(a=0,l=o.length;a<l;a++)c=o[a],!i.has(c)&&(i.add(c),ire(u,e[t](c)),r[c]=s);s++,o=u}return r}oB.bind(null,"outboundNeighbors");oB.bind(null,"neighbors");var sre=rre,ME=jm(),lt=t=>Dm(t,ME),RE=jm();lt.write=t=>Dm(t,RE);var qb=jm();lt.onStart=t=>Dm(t,qb);var IE=jm();lt.onFrame=t=>Dm(t,IE);var TE=jm();lt.onFinish=t=>Dm(t,TE);var Cd=[];lt.setTimeout=(t,e)=>{const n=lt.now()+e,i=()=>{const s=Cd.findIndex(o=>o.cancel==i);~s&&Cd.splice(s,1),dl-=~s?1:0},r={time:n,handler:t,cancel:i};return Cd.splice(aB(n),0,r),dl+=1,lB(),r};var aB=t=>~(~Cd.findIndex(e=>e.time>t)||~Cd.length);lt.cancel=t=>{qb.delete(t),IE.delete(t),TE.delete(t),ME.delete(t),RE.delete(t)};lt.sync=t=>{kk=!0,lt.batchedUpdates(t),kk=!1};lt.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function i(...r){e=r,lt.onStart(n)}return i.handler=t,i.cancel=()=>{qb.delete(n),e=null},i};var OE=typeof window<"u"?window.requestAnimationFrame:()=>{};lt.use=t=>OE=t;lt.now=typeof performance<"u"?()=>performance.now():Date.now;lt.batchedUpdates=t=>t();lt.catch=console.error;lt.frameLoop="always";lt.advance=()=>{lt.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):uB()};var ul=-1,dl=0,kk=!1;function Dm(t,e){kk?(e.delete(t),t(0)):(e.add(t),lB())}function lB(){ul<0&&(ul=0,lt.frameLoop!=="demand"&&OE(cB))}function ore(){ul=-1}function cB(){~ul&&(OE(cB),lt.batchedUpdates(uB))}function uB(){const t=ul;ul=lt.now();const e=aB(ul);if(e&&(dB(Cd.splice(0,e),n=>n.handler()),dl-=e),!dl){ore();return}qb.flush(),ME.flush(t?Math.min(64,ul-t):16.667),IE.flush(),RE.flush(),TE.flush()}function jm(){let t=new Set,e=t;return{add(n){dl+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return dl-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,dl-=e.size,dB(e,i=>i(n)&&t.add(i)),dl+=t.size,e=t)}}}function dB(t,e){t.forEach(n=>{try{e(n)}catch(i){lt.catch(i)}})}var are=Object.defineProperty,lre=(t,e)=>{for(var n in e)are(t,n,{get:e[n],enumerable:!0})},Bs={};lre(Bs,{assign:()=>ure,colors:()=>El,createStringInterpolator:()=>DE,skipAnimation:()=>hB,to:()=>fB,willAdvance:()=>jE});function _k(){}var cre=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),ge={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function zo(t,e){if(ge.arr(t)){if(!ge.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}var kt=(t,e)=>t.forEach(e);function Ro(t,e,n){if(ge.arr(t)){for(let i=0;i<t.length;i++)e.call(n,t[i],`${i}`);return}for(const i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i)}var Er=t=>ge.und(t)?[]:ge.arr(t)?t:[t];function tp(t,e){if(t.size){const n=Array.from(t);t.clear(),kt(n,e)}}var Ph=(t,...e)=>tp(t,n=>n(...e)),LE=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),DE,fB,El=null,hB=!1,jE=_k,ure=t=>{t.to&&(fB=t.to),t.now&&(lt.now=t.now),t.colors!==void 0&&(El=t.colors),t.skipAnimation!=null&&(hB=t.skipAnimation),t.createStringInterpolator&&(DE=t.createStringInterpolator),t.requestAnimationFrame&&lt.use(t.requestAnimationFrame),t.batchedUpdates&&(lt.batchedUpdates=t.batchedUpdates),t.willAdvance&&(jE=t.willAdvance),t.frameLoop&&(lt.frameLoop=t.frameLoop)},np=new Set,Xr=[],tw=[],yy=0,Kb={get idle(){return!np.size&&!Xr.length},start(t){yy>t.priority?(np.add(t),lt.onStart(dre)):(pB(t),lt(Ck))},advance:Ck,sort(t){if(yy)lt.onFrame(()=>Kb.sort(t));else{const e=Xr.indexOf(t);~e&&(Xr.splice(e,1),mB(t))}},clear(){Xr=[],np.clear()}};function dre(){np.forEach(pB),np.clear(),lt(Ck)}function pB(t){Xr.includes(t)||mB(t)}function mB(t){Xr.splice(fre(Xr,e=>e.priority>t.priority),0,t)}function Ck(t){const e=tw;for(let n=0;n<Xr.length;n++){const i=Xr[n];yy=i.priority,i.idle||(jE(i),i.advance(t),i.idle||e.push(i))}return yy=0,tw=Xr,tw.length=0,Xr=e,Xr.length>0}function fre(t,e){const n=t.findIndex(e);return n<0?t.length:n}var hre=(t,e,n)=>Math.min(Math.max(n,t),e),pre={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},Ms="[-+]?\\d*\\.?\\d+",by=Ms+"%";function Xb(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var mre=new RegExp("rgb"+Xb(Ms,Ms,Ms)),gre=new RegExp("rgba"+Xb(Ms,Ms,Ms,Ms)),vre=new RegExp("hsl"+Xb(Ms,by,by)),yre=new RegExp("hsla"+Xb(Ms,by,by,Ms)),bre=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,xre=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,wre=/^#([0-9a-fA-F]{6})$/,Sre=/^#([0-9a-fA-F]{8})$/;function kre(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=wre.exec(t))?parseInt(e[1]+"ff",16)>>>0:El&&El[t]!==void 0?El[t]:(e=mre.exec(t))?(_u(e[1])<<24|_u(e[2])<<16|_u(e[3])<<8|255)>>>0:(e=gre.exec(t))?(_u(e[1])<<24|_u(e[2])<<16|_u(e[3])<<8|qI(e[4]))>>>0:(e=bre.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=Sre.exec(t))?parseInt(e[1],16)>>>0:(e=xre.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=vre.exec(t))?(WI(GI(e[1]),qg(e[2]),qg(e[3]))|255)>>>0:(e=yre.exec(t))?(WI(GI(e[1]),qg(e[2]),qg(e[3]))|qI(e[4]))>>>0:null}function nw(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function WI(t,e,n){const i=n<.5?n*(1+e):n+e-n*e,r=2*n-i,s=nw(r,i,t+1/3),o=nw(r,i,t),a=nw(r,i,t-1/3);return Math.round(s*255)<<24|Math.round(o*255)<<16|Math.round(a*255)<<8}function _u(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function GI(t){return(parseFloat(t)%360+360)%360/360}function qI(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function qg(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function KI(t){let e=kre(t);if(e===null)return t;e=e||0;const n=(e&4278190080)>>>24,i=(e&16711680)>>>16,r=(e&65280)>>>8,s=(e&255)/255;return`rgba(${n}, ${i}, ${r}, ${s})`}var Qp=(t,e,n)=>{if(ge.fun(t))return t;if(ge.arr(t))return Qp({range:t,output:e,extrapolate:n});if(ge.str(t.output[0]))return DE(t);const i=t,r=i.output,s=i.range||[0,1],o=i.extrapolateLeft||i.extrapolate||"extend",a=i.extrapolateRight||i.extrapolate||"extend",l=i.easing||(c=>c);return c=>{const u=Cre(c,s);return _re(c,s[u],s[u+1],r[u],r[u+1],l,o,a,i.map)}};function _re(t,e,n,i,r,s,o,a,l){let c=l?l(t):t;if(c<e){if(o==="identity")return c;o==="clamp"&&(c=e)}if(c>n){if(a==="identity")return c;a==="clamp"&&(c=n)}return i===r?i:e===n?t<=e?i:r:(e===-1/0?c=-c:n===1/0?c=c-e:c=(c-e)/(n-e),c=s(c),i===-1/0?c=-c:r===1/0?c=c+i:c=c*(r-i)+i,c)}function Cre(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}var Ere=(t,e="end")=>n=>{n=e==="end"?Math.min(n,.999):Math.max(n,.001);const i=n*t,r=e==="end"?Math.floor(i):Math.ceil(i);return hre(0,1,r/t)},xy=1.70158,Kg=xy*1.525,XI=xy+1,YI=2*Math.PI/3,JI=2*Math.PI/4.5,Xg=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,gB={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>XI*t*t*t-xy*t*t,easeOutBack:t=>1+XI*Math.pow(t-1,3)+xy*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((Kg+1)*2*t-Kg)/2:(Math.pow(2*t-2,2)*((Kg+1)*(t*2-2)+Kg)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*YI),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*YI)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*JI))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*JI)/2+1,easeInBounce:t=>1-Xg(1-t),easeOutBounce:Xg,easeInOutBounce:t=>t<.5?(1-Xg(1-2*t))/2:(1+Xg(2*t-1))/2,steps:Ere},em=Symbol.for("FluidValue.get"),ff=Symbol.for("FluidValue.observers"),Kr=t=>!!(t&&t[em]),Zi=t=>t&&t[em]?t[em]():t,ZI=t=>t[ff]||null;function Are(t,e){t.eventObserved?t.eventObserved(e):t(e)}function tm(t,e){const n=t[ff];n&&n.forEach(i=>{Are(i,e)})}var vB=class{constructor(t){if(!t&&!(t=this.get))throw Error("Unknown getter");Pre(this,t)}},Pre=(t,e)=>yB(t,em,e);function Af(t,e){if(t[em]){let n=t[ff];n||yB(t,ff,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function nm(t,e){const n=t[ff];if(n&&n.has(e)){const i=n.size-1;i?n.delete(e):t[ff]=null,t.observerRemoved&&t.observerRemoved(i,e)}}var yB=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),sv=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Nre=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,QI=new RegExp(`(${sv.source})(%|[a-z]+)`,"i"),Mre=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,Yb=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,bB=t=>{const[e,n]=Rre(t);if(!e||LE())return t;const i=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(i)return i.trim();if(n&&n.startsWith("--")){const r=window.getComputedStyle(document.documentElement).getPropertyValue(n);return r||t}else{if(n&&Yb.test(n))return bB(n);if(n)return n}return t},Rre=t=>{const e=Yb.exec(t);if(!e)return[,];const[,n,i]=e;return[n,i]},iw,Ire=(t,e,n,i,r)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(i)}, ${r})`,xB=t=>{iw||(iw=El?new RegExp(`(${Object.keys(El).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(s=>Zi(s).replace(Yb,bB).replace(Nre,KI).replace(iw,KI)),n=e.map(s=>s.match(sv).map(Number)),r=n[0].map((s,o)=>n.map(a=>{if(!(o in a))throw Error('The arity of each "output" value must be equal');return a[o]})).map(s=>Qp({...t,output:s}));return s=>{var l;const o=!QI.test(e[0])&&((l=e.find(c=>QI.test(c)))==null?void 0:l.replace(sv,""));let a=0;return e[0].replace(sv,()=>`${r[a++](s)}${o||""}`).replace(Mre,Ire)}},BE="react-spring: ",wB=t=>{const e=t;let n=!1;if(typeof e!="function")throw new TypeError(`${BE}once requires a function parameter`);return(...i)=>{n||(e(...i),n=!0)}},Tre=wB(console.warn);function Ore(){Tre(`${BE}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var Lre=wB(console.warn);function Dre(){Lre(`${BE}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function Jb(t){return ge.str(t)&&(t[0]=="#"||/\d/.test(t)||!LE()&&Yb.test(t)||t in(El||{}))}var $E=LE()?x.useEffect:x.useLayoutEffect,jre=()=>{const t=x.useRef(!1);return $E(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function SB(){const t=x.useState()[1],e=jre();return()=>{e.current&&t(Math.random())}}function Bre(t,e){const[n]=x.useState(()=>({inputs:e,result:t()})),i=x.useRef(),r=i.current;let s=r;return s?e&&s.inputs&&$re(e,s.inputs)||(s={inputs:e,result:t()}):s=n,x.useEffect(()=>{i.current=s,r==n&&(n.inputs=n.result=void 0)},[s]),s.result}function $re(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var kB=t=>x.useEffect(t,Fre),Fre=[];function e3(t){const e=x.useRef();return x.useEffect(()=>{e.current=t}),e.current}var im=Symbol.for("Animated:node"),zre=t=>!!t&&t[im]===t,Qs=t=>t&&t[im],FE=(t,e)=>cre(t,im,e),Zb=t=>t&&t[im]&&t[im].getPayload(),_B=class{constructor(){FE(this,this)}getPayload(){return this.payload||[]}},Bm=class extends _B{constructor(t){super(),this._value=t,this.done=!0,this.durationProgress=0,ge.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new Bm(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,e){return ge.num(t)&&(this.lastPosition=t,e&&(t=Math.round(t/e)*e,this.done&&(this.lastPosition=t))),this._value===t?!1:(this._value=t,!0)}reset(){const{done:t}=this;this.done=!1,ge.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}},rm=class extends Bm{constructor(t){super(0),this._string=null,this._toString=Qp({output:[t,t]})}static create(t){return new rm(t)}getValue(){const t=this._string;return t??(this._string=this._toString(this._value))}setValue(t){if(ge.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else if(super.setValue(t))this._string=null;else return!1;return!0}reset(t){t&&(this._toString=Qp({output:[this.getValue(),t]})),this._value=0,super.reset()}},wy={dependencies:null},Qb=class extends _B{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const e={};return Ro(this.source,(n,i)=>{zre(n)?e[i]=n.getValue(t):Kr(n)?e[i]=Zi(n):t||(e[i]=n)}),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&kt(this.payload,t=>t.reset())}_makePayload(t){if(t){const e=new Set;return Ro(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){wy.dependencies&&Kr(t)&&wy.dependencies.add(t);const e=Zb(t);e&&kt(e,n=>this.add(n))}},CB=class extends Qb{constructor(t){super(t)}static create(t){return new CB(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){const e=this.getPayload();return t.length==e.length?e.map((n,i)=>n.setValue(t[i])).some(Boolean):(super.setValue(t.map(Ure)),!0)}};function Ure(t){return(Jb(t)?rm:Bm).create(t)}function Ek(t){const e=Qs(t);return e?e.constructor:ge.arr(t)?CB:Jb(t)?rm:Bm}var t3=(t,e)=>{const n=!ge.fun(t)||t.prototype&&t.prototype.isReactComponent;return x.forwardRef((i,r)=>{const s=x.useRef(null),o=n&&x.useCallback(m=>{s.current=Wre(r,m)},[r]),[a,l]=Hre(i,e),c=SB(),u=()=>{const m=s.current;if(n&&!m)return;(m?e.applyAnimatedValues(m,a.getValue(!0)):!1)===!1&&c()},d=new Vre(u,l),f=x.useRef();$E(()=>(f.current=d,kt(l,m=>Af(m,d)),()=>{f.current&&(kt(f.current.deps,m=>nm(m,f.current)),lt.cancel(f.current.update))})),x.useEffect(u,[]),kB(()=>()=>{const m=f.current;kt(m.deps,g=>nm(g,m))});const p=e.getComponentProps(a.getValue());return x.createElement(t,{...p,ref:o})})},Vre=class{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){t.type=="change"&&lt.write(this.update)}};function Hre(t,e){const n=new Set;return wy.dependencies=n,t.style&&(t={...t,style:e.createAnimatedStyle(t.style)}),t=new Qb(t),wy.dependencies=null,[t,n]}function Wre(t,e){return t&&(ge.fun(t)?t(e):t.current=e),e}var n3=Symbol.for("AnimatedComponent"),Gre=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=r=>new Qb(r),getComponentProps:i=r=>r}={})=>{const r={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:i},s=o=>{const a=i3(o)||"Anonymous";return ge.str(o)?o=s[o]||(s[o]=t3(o,r)):o=o[n3]||(o[n3]=t3(o,r)),o.displayName=`Animated(${a})`,o};return Ro(t,(o,a)=>{ge.arr(t)&&(a=i3(o)),s[a]=s(o)}),{animated:s}},i3=t=>ge.str(t)?t:t&&ge.str(t.displayName)?t.displayName:ge.fun(t)&&t.name||null;function Pc(t,...e){return ge.fun(t)?t(...e):t}var ip=(t,e)=>t===!0||!!(e&&t&&(ge.fun(t)?t(e):Er(t).includes(e))),EB=(t,e)=>ge.obj(t)?e&&t[e]:t,AB=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,qre=t=>t,zE=(t,e=qre)=>{let n=Kre;t.default&&t.default!==!0&&(t=t.default,n=Object.keys(t));const i={};for(const r of n){const s=e(t[r],r);ge.und(s)||(i[r]=s)}return i},Kre=["config","onProps","onStart","onChange","onPause","onResume","onRest"],Xre={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function Yre(t){const e={};let n=0;if(Ro(t,(i,r)=>{Xre[r]||(e[r]=i,n++)}),n)return e}function PB(t){const e=Yre(t);if(e){const n={to:e};return Ro(t,(i,r)=>r in e||(n[r]=i)),n}return{...t}}function sm(t){return t=Zi(t),ge.arr(t)?t.map(sm):Jb(t)?Bs.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function Jre(t){for(const e in t)return!0;return!1}function Ak(t){return ge.fun(t)||ge.arr(t)&&ge.obj(t[0])}function Zre(t,e){var n;(n=t.ref)==null||n.delete(t),e==null||e.delete(t)}function Qre(t,e){var n;e&&t.ref!==e&&((n=t.ref)==null||n.delete(t),e.add(t),t.ref=e)}var ese={default:{tension:170,friction:26}},Pk={...ese.default,mass:1,damping:1,easing:gB.linear,clamp:!1},tse=class{constructor(){this.velocity=0,Object.assign(this,Pk)}};function nse(t,e,n){n&&(n={...n},r3(n,e),e={...n,...e}),r3(t,e),Object.assign(t,e);for(const o in Pk)t[o]==null&&(t[o]=Pk[o]);let{frequency:i,damping:r}=t;const{mass:s}=t;return ge.und(i)||(i<.01&&(i=.01),r<0&&(r=0),t.tension=Math.pow(2*Math.PI/i,2)*s,t.friction=4*Math.PI*r*s/i),t}function r3(t,e){if(!ge.und(e.decay))t.duration=void 0;else{const n=!ge.und(e.tension)||!ge.und(e.friction);(n||!ge.und(e.frequency)||!ge.und(e.damping)||!ge.und(e.mass))&&(t.duration=void 0,t.decay=void 0),n&&(t.frequency=void 0)}}var s3=[],ise=class{constructor(){this.changed=!1,this.values=s3,this.toValues=null,this.fromValues=s3,this.config=new tse,this.immediate=!1}};function NB(t,{key:e,props:n,defaultProps:i,state:r,actions:s}){return new Promise((o,a)=>{let l,c,u=ip(n.cancel??(i==null?void 0:i.cancel),e);if(u)p();else{ge.und(n.pause)||(r.paused=ip(n.pause,e));let m=i==null?void 0:i.pause;m!==!0&&(m=r.paused||ip(m,e)),l=Pc(n.delay||0,e),m?(r.resumeQueue.add(f),s.pause()):(s.resume(),f())}function d(){r.resumeQueue.add(f),r.timeouts.delete(c),c.cancel(),l=c.time-lt.now()}function f(){l>0&&!Bs.skipAnimation?(r.delayed=!0,c=lt.setTimeout(p,l),r.pauseQueue.add(d),r.timeouts.add(c)):p()}function p(){r.delayed&&(r.delayed=!1),r.pauseQueue.delete(d),r.timeouts.delete(c),t<=(r.cancelId||0)&&(u=!0);try{s.start({...n,callId:t,cancel:u},o)}catch(m){a(m)}}})}var UE=(t,e)=>e.length==1?e[0]:e.some(n=>n.cancelled)?Ed(t.get()):e.every(n=>n.noop)?MB(t.get()):As(t.get(),e.every(n=>n.finished)),MB=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),As=(t,e,n=!1)=>({value:t,finished:e,cancelled:n}),Ed=t=>({value:t,cancelled:!0,finished:!1});function RB(t,e,n,i){const{callId:r,parentId:s,onRest:o}=e,{asyncTo:a,promise:l}=n;return!s&&t===a&&!e.reset?l:n.promise=(async()=>{n.asyncId=r,n.asyncTo=t;const c=zE(e,(y,v)=>v==="onRest"?void 0:y);let u,d;const f=new Promise((y,v)=>(u=y,d=v)),p=y=>{const v=r<=(n.cancelId||0)&&Ed(i)||r!==n.asyncId&&As(i,!1);if(v)throw y.result=v,d(y),y},m=(y,v)=>{const b=new o3,w=new a3;return(async()=>{if(Bs.skipAnimation)throw om(n),w.result=As(i,!1),d(w),w;p(b);const k=ge.obj(y)?{...y}:{...v,to:y};k.parentId=r,Ro(c,(E,_)=>{ge.und(k[_])&&(k[_]=E)});const C=await i.start(k);return p(b),n.paused&&await new Promise(E=>{n.resumeQueue.add(E)}),C})()};let g;if(Bs.skipAnimation)return om(n),As(i,!1);try{let y;ge.arr(t)?y=(async v=>{for(const b of v)await m(b)})(t):y=Promise.resolve(t(m,i.stop.bind(i))),await Promise.all([y.then(u),f]),g=As(i.get(),!0,!1)}catch(y){if(y instanceof o3)g=y.result;else if(y instanceof a3)g=y.result;else throw y}finally{r==n.asyncId&&(n.asyncId=s,n.asyncTo=s?a:void 0,n.promise=s?l:void 0)}return ge.fun(o)&&lt.batchedUpdates(()=>{o(g,i,i.item)}),g})()}function om(t,e){tp(t.timeouts,n=>n.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}var o3=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},a3=class extends Error{constructor(){super("SkipAnimationSignal")}},Nk=t=>t instanceof VE,rse=1,VE=class extends vB{constructor(){super(...arguments),this.id=rse++,this._priority=0}get priority(){return this._priority}set priority(t){this._priority!=t&&(this._priority=t,this._onPriorityChange(t))}get(){const t=Qs(this);return t&&t.getValue()}to(...t){return Bs.to(this,t)}interpolate(...t){return Ore(),Bs.to(this,t)}toJSON(){return this.get()}observerAdded(t){t==1&&this._attach()}observerRemoved(t){t==0&&this._detach()}_attach(){}_detach(){}_onChange(t,e=!1){tm(this,{type:"change",parent:this,value:t,idle:e})}_onPriorityChange(t){this.idle||Kb.sort(this),tm(this,{type:"priority",parent:this,priority:t})}},ru=Symbol.for("SpringPhase"),IB=1,Mk=2,Rk=4,rw=t=>(t[ru]&IB)>0,La=t=>(t[ru]&Mk)>0,eh=t=>(t[ru]&Rk)>0,l3=(t,e)=>e?t[ru]|=Mk|IB:t[ru]&=~Mk,c3=(t,e)=>e?t[ru]|=Rk:t[ru]&=~Rk,Ge=class extends VE{constructor(t,e){if(super(),this.animation=new ise,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!ge.und(t)||!ge.und(e)){const n=ge.obj(t)?{...t}:{...e,from:t};ge.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(La(this)||this._state.asyncTo)||eh(this)}get goal(){return Zi(this.animation.to)}get velocity(){const t=Qs(this);return t instanceof Bm?t.lastVelocity||0:t.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return rw(this)}get isAnimating(){return La(this)}get isPaused(){return eh(this)}get isDelayed(){return this._state.delayed}advance(t){let e=!0,n=!1;const i=this.animation;let{toValues:r}=i;const{config:s}=i,o=Zb(i.to);!o&&Kr(i.to)&&(r=Er(Zi(i.to))),i.values.forEach((c,u)=>{if(c.done)return;const d=c.constructor==rm?1:o?o[u].lastPosition:r[u];let f=i.immediate,p=d;if(!f){if(p=c.lastPosition,s.tension<=0){c.done=!0;return}let m=c.elapsedTime+=t;const g=i.fromValues[u],y=c.v0!=null?c.v0:c.v0=ge.arr(s.velocity)?s.velocity[u]:s.velocity;let v;const b=s.precision||(g==d?.005:Math.min(1,Math.abs(d-g)*.001));if(ge.und(s.duration))if(s.decay){const w=s.decay===!0?.998:s.decay,k=Math.exp(-(1-w)*m);p=g+y/(1-w)*(1-k),f=Math.abs(c.lastPosition-p)<=b,v=y*k}else{v=c.lastVelocity==null?y:c.lastVelocity;const w=s.restVelocity||b/10,k=s.clamp?0:s.bounce,C=!ge.und(k),E=g==d?c.v0>0:g<d;let _,A=!1;const R=1,L=Math.ceil(t/R);for(let O=0;O<L&&(_=Math.abs(v)>w,!(!_&&(f=Math.abs(d-p)<=b,f)));++O){C&&(A=p==d||p>d==E,A&&(v=-v*k,p=d));const I=-s.tension*1e-6*(p-d),G=-s.friction*.001*v,B=(I+G)/s.mass;v=v+B*R,p=p+v*R}}else{let w=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,c.durationProgress>0&&(c.elapsedTime=s.duration*c.durationProgress,m=c.elapsedTime+=t)),w=(s.progress||0)+m/this._memoizedDuration,w=w>1?1:w<0?0:w,c.durationProgress=w),p=g+s.easing(w)*(d-g),v=(p-c.lastPosition)/t,f=w==1}c.lastVelocity=v,Number.isNaN(p)&&(console.warn("Got NaN while animating:",this),f=!0)}o&&!o[u].done&&(f=!1),f?c.done=!0:e=!1,c.setValue(p,s.round)&&(n=!0)});const a=Qs(this),l=a.getValue();if(e){const c=Zi(i.to);(l!==c||n)&&!s.decay?(a.setValue(c),this._onChange(c)):n&&s.decay&&this._onChange(l),this._stop()}else n&&this._onChange(l)}set(t){return lt.batchedUpdates(()=>{this._stop(),this._focus(t),this._set(t)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(La(this)){const{to:t,config:e}=this.animation;lt.batchedUpdates(()=>{this._onStart(),e.decay||this._set(t,!1),this._stop()})}return this}update(t){return(this.queue||(this.queue=[])).push(t),this}start(t,e){let n;return ge.und(t)?(n=this.queue||[],this.queue=[]):n=[ge.obj(t)?t:{...e,to:t}],Promise.all(n.map(i=>this._update(i))).then(i=>UE(this,i))}stop(t){const{to:e}=this.animation;return this._focus(this.get()),om(this._state,t&&this._lastCallId),lt.batchedUpdates(()=>this._stop(e,t)),this}reset(){this._update({reset:!0})}eventObserved(t){t.type=="change"?this._start():t.type=="priority"&&(this.priority=t.priority+1)}_prepareNode(t){const e=this.key||"";let{to:n,from:i}=t;n=ge.obj(n)?n[e]:n,(n==null||Ak(n))&&(n=void 0),i=ge.obj(i)?i[e]:i,i==null&&(i=void 0);const r={to:n,from:i};return rw(this)||(t.reverse&&([n,i]=[i,n]),i=Zi(i),ge.und(i)?Qs(this)||this._set(n):this._set(i)),r}_update({...t},e){const{key:n,defaultProps:i}=this;t.default&&Object.assign(i,zE(t,(o,a)=>/^on/.test(a)?EB(o,n):o)),d3(this,t,"onProps"),nh(this,"onProps",t,this);const r=this._prepareNode(t);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return NB(++this._lastCallId,{key:n,props:t,defaultProps:i,state:s,actions:{pause:()=>{eh(this)||(c3(this,!0),Ph(s.pauseQueue),nh(this,"onPause",As(this,th(this,this.animation.to)),this))},resume:()=>{eh(this)&&(c3(this,!1),La(this)&&this._resume(),Ph(s.resumeQueue),nh(this,"onResume",As(this,th(this,this.animation.to)),this))},start:this._merge.bind(this,r)}}).then(o=>{if(t.loop&&o.finished&&!(e&&o.noop)){const a=TB(t);if(a)return this._update(a,!0)}return o})}_merge(t,e,n){if(e.cancel)return this.stop(!0),n(Ed(this));const i=!ge.und(t.to),r=!ge.und(t.from);if(i||r)if(e.callId>this._lastToId)this._lastToId=e.callId;else return n(Ed(this));const{key:s,defaultProps:o,animation:a}=this,{to:l,from:c}=a;let{to:u=l,from:d=c}=t;r&&!i&&(!e.default||ge.und(u))&&(u=d),e.reverse&&([u,d]=[d,u]);const f=!zo(d,c);f&&(a.from=d),d=Zi(d);const p=!zo(u,l);p&&this._focus(u);const m=Ak(e.to),{config:g}=a,{decay:y,velocity:v}=g;(i||r)&&(g.velocity=0),e.config&&!m&&nse(g,Pc(e.config,s),e.config!==o.config?Pc(o.config,s):void 0);let b=Qs(this);if(!b||ge.und(u))return n(As(this,!0));const w=ge.und(e.reset)?r&&!e.default:!ge.und(d)&&ip(e.reset,s),k=w?d:this.get(),C=sm(u),E=ge.num(C)||ge.arr(C)||Jb(C),_=!m&&(!E||ip(o.immediate||e.immediate,s));if(p){const O=Ek(u);if(O!==b.constructor)if(_)b=this._set(C);else throw Error(`Cannot animate between ${b.constructor.name} and ${O.name}, as the "to" prop suggests`)}const A=b.constructor;let R=Kr(u),L=!1;if(!R){const O=w||!rw(this)&&f;(p||O)&&(L=zo(sm(k),C),R=!L),(!zo(a.immediate,_)&&!_||!zo(g.decay,y)||!zo(g.velocity,v))&&(R=!0)}if(L&&La(this)&&(a.changed&&!w?R=!0:R||this._stop(l)),!m&&((R||Kr(l))&&(a.values=b.getPayload(),a.toValues=Kr(u)?null:A==rm?[1]:Er(C)),a.immediate!=_&&(a.immediate=_,!_&&!w&&this._set(l)),R)){const{onRest:O}=a;kt(ose,G=>d3(this,e,G));const I=As(this,th(this,l));Ph(this._pendingCalls,I),this._pendingCalls.add(n),a.changed&&lt.batchedUpdates(()=>{var G;a.changed=!w,O==null||O(I,this),w?Pc(o.onRest,I):(G=a.onStart)==null||G.call(a,I,this)})}w&&this._set(k),m?n(RB(e.to,e,this._state,this)):R?this._start():La(this)&&!p?this._pendingCalls.add(n):n(MB(k))}_focus(t){const e=this.animation;t!==e.to&&(ZI(this)&&this._detach(),e.to=t,ZI(this)&&this._attach())}_attach(){let t=0;const{to:e}=this.animation;Kr(e)&&(Af(e,this),Nk(e)&&(t=e.priority+1)),this.priority=t}_detach(){const{to:t}=this.animation;Kr(t)&&nm(t,this)}_set(t,e=!0){const n=Zi(t);if(!ge.und(n)){const i=Qs(this);if(!i||!zo(n,i.getValue())){const r=Ek(n);!i||i.constructor!=r?FE(this,r.create(n)):i.setValue(n),i&&lt.batchedUpdates(()=>{this._onChange(n,e)})}}return Qs(this)}_onStart(){const t=this.animation;t.changed||(t.changed=!0,nh(this,"onStart",As(this,th(this,t.to)),this))}_onChange(t,e){e||(this._onStart(),Pc(this.animation.onChange,t,this)),Pc(this.defaultProps.onChange,t,this),super._onChange(t,e)}_start(){const t=this.animation;Qs(this).reset(Zi(t.to)),t.immediate||(t.fromValues=t.values.map(e=>e.lastPosition)),La(this)||(l3(this,!0),eh(this)||this._resume())}_resume(){Bs.skipAnimation?this.finish():Kb.start(this)}_stop(t,e){if(La(this)){l3(this,!1);const n=this.animation;kt(n.values,r=>{r.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),tm(this,{type:"idle",parent:this});const i=e?Ed(this.get()):As(this.get(),th(this,t??n.to));Ph(this._pendingCalls,i),n.changed&&(n.changed=!1,nh(this,"onRest",i,this))}}};function th(t,e){const n=sm(e),i=sm(t.get());return zo(i,n)}function TB(t,e=t.loop,n=t.to){const i=Pc(e);if(i){const r=i!==!0&&PB(i),s=(r||t).reverse,o=!r||r.reset;return am({...t,loop:e,default:!1,pause:void 0,to:!s||Ak(n)?n:void 0,from:o?t.from:void 0,reset:o,...r})}}function am(t){const{to:e,from:n}=t=PB(t),i=new Set;return ge.obj(e)&&u3(e,i),ge.obj(n)&&u3(n,i),t.keys=i.size?Array.from(i):null,t}function sse(t){const e=am(t);return ge.und(e.default)&&(e.default=zE(e)),e}function u3(t,e){Ro(t,(n,i)=>n!=null&&e.add(i))}var ose=["onStart","onRest","onChange","onPause","onResume"];function d3(t,e,n){t.animation[n]=e[n]!==AB(e,n)?EB(e[n],t.key):void 0}function nh(t,e,...n){var i,r,s,o;(r=(i=t.animation)[e])==null||r.call(i,...n),(o=(s=t.defaultProps)[e])==null||o.call(s,...n)}var ase=["onStart","onChange","onRest"],lse=1,cse=class{constructor(t,e){this.id=lse++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),e&&(this._flush=e),t&&this.start({default:!0,...t})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(t=>t.idle&&!t.isDelayed&&!t.isPaused)}get item(){return this._item}set item(t){this._item=t}get(){const t={};return this.each((e,n)=>t[n]=e.get()),t}set(t){for(const e in t){const n=t[e];ge.und(n)||this.springs[e].set(n)}}update(t){return t&&this.queue.push(am(t)),this}start(t){let{queue:e}=this;return t?e=Er(t).map(am):this.queue=[],this._flush?this._flush(this,e):(BB(this,e),Ik(this,e))}stop(t,e){if(t!==!!t&&(e=t),e){const n=this.springs;kt(Er(e),i=>n[i].stop(!!t))}else om(this._state,this._lastAsyncId),this.each(n=>n.stop(!!t));return this}pause(t){if(ge.und(t))this.start({pause:!0});else{const e=this.springs;kt(Er(t),n=>e[n].pause())}return this}resume(t){if(ge.und(t))this.start({pause:!1});else{const e=this.springs;kt(Er(t),n=>e[n].resume())}return this}each(t){Ro(this.springs,t)}_onFrame(){const{onStart:t,onChange:e,onRest:n}=this._events,i=this._active.size>0,r=this._changed.size>0;(i&&!this._started||r&&!this._started)&&(this._started=!0,tp(t,([a,l])=>{l.value=this.get(),a(l,this,this._item)}));const s=!i&&this._started,o=r||s&&n.size?this.get():null;r&&e.size&&tp(e,([a,l])=>{l.value=o,a(l,this,this._item)}),s&&(this._started=!1,tp(n,([a,l])=>{l.value=o,a(l,this,this._item)}))}eventObserved(t){if(t.type=="change")this._changed.add(t.parent),t.idle||this._active.add(t.parent);else if(t.type=="idle")this._active.delete(t.parent);else return;lt.onFrame(this._onFrame)}};function Ik(t,e){return Promise.all(e.map(n=>OB(t,n))).then(n=>UE(t,n))}async function OB(t,e,n){const{keys:i,to:r,from:s,loop:o,onRest:a,onResolve:l}=e,c=ge.obj(e.default)&&e.default;o&&(e.loop=!1),r===!1&&(e.to=null),s===!1&&(e.from=null);const u=ge.arr(r)||ge.fun(r)?r:void 0;u?(e.to=void 0,e.onRest=void 0,c&&(c.onRest=void 0)):kt(ase,g=>{const y=e[g];if(ge.fun(y)){const v=t._events[g];e[g]=({finished:b,cancelled:w})=>{const k=v.get(y);k?(b||(k.finished=!1),w&&(k.cancelled=!0)):v.set(y,{value:null,finished:b||!1,cancelled:w||!1})},c&&(c[g]=e[g])}});const d=t._state;e.pause===!d.paused?(d.paused=e.pause,Ph(e.pause?d.pauseQueue:d.resumeQueue)):d.paused&&(e.pause=!0);const f=(i||Object.keys(t.springs)).map(g=>t.springs[g].start(e)),p=e.cancel===!0||AB(e,"cancel")===!0;(u||p&&d.asyncId)&&f.push(NB(++t._lastAsyncId,{props:e,state:d,actions:{pause:_k,resume:_k,start(g,y){p?(om(d,t._lastAsyncId),y(Ed(t))):(g.onRest=a,y(RB(u,g,d,t)))}}})),d.paused&&await new Promise(g=>{d.resumeQueue.add(g)});const m=UE(t,await Promise.all(f));if(o&&m.finished&&!(n&&m.noop)){const g=TB(e,o,r);if(g)return BB(t,[g]),OB(t,g,!0)}return l&&lt.batchedUpdates(()=>l(m,t,t.item)),m}function f3(t,e){const n={...t.springs};return e&&kt(Er(e),i=>{ge.und(i.keys)&&(i=am(i)),ge.obj(i.to)||(i={...i,to:void 0}),jB(n,i,r=>DB(r))}),LB(t,n),n}function LB(t,e){Ro(e,(n,i)=>{t.springs[i]||(t.springs[i]=n,Af(n,t))})}function DB(t,e){const n=new Ge;return n.key=t,e&&Af(n,e),n}function jB(t,e,n){e.keys&&kt(e.keys,i=>{(t[i]||(t[i]=n(i)))._prepareNode(e)})}function BB(t,e){kt(e,n=>{jB(t.springs,n,i=>DB(i,t))})}var e1=({children:t,...e})=>{const n=x.useContext(Sy),i=e.pause||!!n.pause,r=e.immediate||!!n.immediate;e=Bre(()=>({pause:i,immediate:r}),[i,r]);const{Provider:s}=Sy;return x.createElement(s,{value:e},t)},Sy=use(e1,{});e1.Provider=Sy.Provider;e1.Consumer=Sy.Consumer;function use(t,e){return Object.assign(t,x.createContext(e)),t.Provider._context=t,t.Consumer._context=t,t}var dse=()=>{const t=[],e=function(i){Dre();const r=[];return kt(t,(s,o)=>{if(ge.und(i))r.push(s.start());else{const a=n(i,s,o);a&&r.push(s.start(a))}}),r};e.current=t,e.add=function(i){t.includes(i)||t.push(i)},e.delete=function(i){const r=t.indexOf(i);~r&&t.splice(r,1)},e.pause=function(){return kt(t,i=>i.pause(...arguments)),this},e.resume=function(){return kt(t,i=>i.resume(...arguments)),this},e.set=function(i){kt(t,(r,s)=>{const o=ge.fun(i)?i(s,r):i;o&&r.set(o)})},e.start=function(i){const r=[];return kt(t,(s,o)=>{if(ge.und(i))r.push(s.start());else{const a=this._getProps(i,s,o);a&&r.push(s.start(a))}}),r},e.stop=function(){return kt(t,i=>i.stop(...arguments)),this},e.update=function(i){return kt(t,(r,s)=>r.update(this._getProps(i,r,s))),this};const n=function(i,r,s){return ge.fun(i)?i(s,r):i};return e._getProps=n,e};function fse(t,e,n){const i=ge.fun(e)&&e;i&&!n&&(n=[]);const r=x.useMemo(()=>i||arguments.length==3?dse():void 0,[]),s=x.useRef(0),o=SB(),a=x.useMemo(()=>({ctrls:[],queue:[],flush(v,b){const w=f3(v,b);return s.current>0&&!a.queue.length&&!Object.keys(w).some(C=>!v.springs[C])?Ik(v,b):new Promise(C=>{LB(v,w),a.queue.push(()=>{C(Ik(v,b))}),o()})}}),[]),l=x.useRef([...a.ctrls]),c=[],u=e3(t)||0;x.useMemo(()=>{kt(l.current.slice(t,u),v=>{Zre(v,r),v.stop(!0)}),l.current.length=t,d(u,t)},[t]),x.useMemo(()=>{d(0,Math.min(u,t))},n);function d(v,b){for(let w=v;w<b;w++){const k=l.current[w]||(l.current[w]=new cse(null,a.flush)),C=i?i(w,k):e[w];C&&(c[w]=sse(C))}}const f=l.current.map((v,b)=>f3(v,c[b])),p=x.useContext(e1),m=e3(p),g=p!==m&&Jre(p);$E(()=>{s.current++,a.ctrls=l.current;const{queue:v}=a;v.length&&(a.queue=[],kt(v,b=>b())),kt(l.current,(b,w)=>{r==null||r.add(b),g&&b.start({default:p});const k=c[w];k&&(Qre(b,k.ref),b.ref?b.queue.push(k):b.start(k))})}),kB(()=>()=>{kt(a.ctrls,v=>v.stop(!0))});const y=f.map(v=>({...v}));return r?[y,r]:y}function t1(t,e){const n=ge.fun(t),[[i],r]=fse(1,n?t:[t],n?[]:e);return n||arguments.length==2?[i,r]:i}var hse=class extends VE{constructor(t,e){super(),this.source=t,this.idle=!0,this._active=new Set,this.calc=Qp(...e);const n=this._get(),i=Ek(n);FE(this,i.create(n))}advance(t){const e=this._get(),n=this.get();zo(e,n)||(Qs(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&h3(this._active)&&sw(this)}_get(){const t=ge.arr(this.source)?this.source.map(Zi):Er(Zi(this.source));return this.calc(...t)}_start(){this.idle&&!h3(this._active)&&(this.idle=!1,kt(Zb(this),t=>{t.done=!1}),Bs.skipAnimation?(lt.batchedUpdates(()=>this.advance()),sw(this)):Kb.start(this))}_attach(){let t=1;kt(Er(this.source),e=>{Kr(e)&&Af(e,this),Nk(e)&&(e.idle||this._active.add(e),t=Math.max(t,e.priority+1))}),this.priority=t,this._start()}_detach(){kt(Er(this.source),t=>{Kr(t)&&nm(t,this)}),this._active.clear(),sw(this)}eventObserved(t){t.type=="change"?t.idle?this.advance():(this._active.add(t.parent),this._start()):t.type=="idle"?this._active.delete(t.parent):t.type=="priority"&&(this.priority=Er(this.source).reduce((e,n)=>Math.max(e,(Nk(n)?n.priority:0)+1),0))}};function pse(t){return t.idle!==!1}function h3(t){return!t.size||Array.from(t).every(pse)}function sw(t){t.idle||(t.idle=!0,kt(Zb(t),e=>{e.done=!0}),tm(t,{type:"idle",parent:t}))}Bs.assign({createStringInterpolator:xB,to:(t,e)=>new hse(t,e)});var $B=/^--/;function mse(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!$B.test(t)&&!(rp.hasOwnProperty(t)&&rp[t])?e+"px":(""+e).trim()}var p3={};function gse(t,e){if(!t.nodeType||!t.setAttribute)return!1;const n=t.nodeName==="filter"||t.parentNode&&t.parentNode.nodeName==="filter",{className:i,style:r,children:s,scrollTop:o,scrollLeft:a,viewBox:l,...c}=e,u=Object.values(c),d=Object.keys(c).map(f=>n||t.hasAttribute(f)?f:p3[f]||(p3[f]=f.replace(/([A-Z])/g,p=>"-"+p.toLowerCase())));s!==void 0&&(t.textContent=s);for(const f in r)if(r.hasOwnProperty(f)){const p=mse(f,r[f]);$B.test(f)?t.style.setProperty(f,p):t.style[f]=p}d.forEach((f,p)=>{t.setAttribute(f,u[p])}),i!==void 0&&(t.className=i),o!==void 0&&(t.scrollTop=o),a!==void 0&&(t.scrollLeft=a),l!==void 0&&t.setAttribute("viewBox",l)}var rp={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vse=(t,e)=>t+e.charAt(0).toUpperCase()+e.substring(1),yse=["Webkit","Ms","Moz","O"];rp=Object.keys(rp).reduce((t,e)=>(yse.forEach(n=>t[vse(n,e)]=t[e]),t),rp);var bse=/^(matrix|translate|scale|rotate|skew)/,xse=/^(translate)/,wse=/^(rotate|skew)/,ow=(t,e)=>ge.num(t)&&t!==0?t+e:t,ov=(t,e)=>ge.arr(t)?t.every(n=>ov(n,e)):ge.num(t)?t===e:parseFloat(t)===e,Sse=class extends Qb{constructor({x:t,y:e,z:n,...i}){const r=[],s=[];(t||e||n)&&(r.push([t||0,e||0,n||0]),s.push(o=>[`translate3d(${o.map(a=>ow(a,"px")).join(",")})`,ov(o,0)])),Ro(i,(o,a)=>{if(a==="transform")r.push([o||""]),s.push(l=>[l,l===""]);else if(bse.test(a)){if(delete i[a],ge.und(o))return;const l=xse.test(a)?"px":wse.test(a)?"deg":"";r.push(Er(o)),s.push(a==="rotate3d"?([c,u,d,f])=>[`rotate3d(${c},${u},${d},${ow(f,l)})`,ov(f,0)]:c=>[`${a}(${c.map(u=>ow(u,l)).join(",")})`,ov(c,a.startsWith("scale")?1:0)])}}),r.length&&(i.transform=new kse(r,s)),super(i)}},kse=class extends vB{constructor(t,e){super(),this.inputs=t,this.transforms=e,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let t="",e=!0;return kt(this.inputs,(n,i)=>{const r=Zi(n[0]),[s,o]=this.transforms[i](ge.arr(r)?r:n.map(Zi));t+=" "+s,e=e&&o}),e?"none":t}observerAdded(t){t==1&&kt(this.inputs,e=>kt(e,n=>Kr(n)&&Af(n,this)))}observerRemoved(t){t==0&&kt(this.inputs,e=>kt(e,n=>Kr(n)&&nm(n,this)))}eventObserved(t){t.type=="change"&&(this._value=null),tm(this,t)}},_se=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];Bs.assign({batchedUpdates:Zl.unstable_batchedUpdates,createStringInterpolator:xB,colors:pre});var Cse=Gre(_se,{applyAnimatedValues:gse,createAnimatedStyle:t=>new Sse(t),getComponentProps:({scrollTop:t,scrollLeft:e,...n})=>n}),Qe=Cse.animated;const Wt={blue:{500:"#3b82f6"},mantis:{400:"#82bd69"},red:{500:"#ef4444"},stone:{600:"#57534e",700:"#44403c",800:"#292524"},white:"#ffffff"},He=(t=Wt.stone[800])=>({backgroundColor:new Ge(t),opacity:new Ge(1)}),Un=()=>({strokeDashoffset:new Ge(1),opacity:new Ge(1)}),Yg=()=>({strokeDashoffset:new Ge(1),opacity:new Ge(1),path:new Ge("")}),ky={bus:{address:Yg(),data:Yg(),rd:Yg(),wr:Yg(),iom:Un(),mem:{stroke:new Ge(Wt.red[500])},handshake:Un(),pic:Un(),pio:Un(),timer:Un(),intr:Un(),inta:Un(),int0:Un(),int1:Un(),int2:Un(),"switches->pio":Un(),"pio->leds":Un(),printer:{data:Un(),strobe:Un(),busy:Un()}},clock:{angle:new Ge(0)},controlMemory:{overlay:{opacity:new Ge(0)},container:{opacity:new Ge(0),scale:new Ge(.8)},currentInstruction:{glow:new Ge(0)},microop:{0:{opacity:new Ge(0),translateX:new Ge(-20)},1:{opacity:new Ge(0),translateX:new Ge(-20)},2:{opacity:new Ge(0),translateX:new Ge(-20)},3:{opacity:new Ge(0),translateX:new Ge(-20)},4:{opacity:new Ge(0),translateX:new Ge(-20)}}},sequencer:{overlay:{opacity:new Ge(0)},container:{opacity:new Ge(0),scale:new Ge(.8)},progress:{progress:new Ge(0),opacity:new Ge(1)}},cpu:{internalBus:{address:{strokeDashoffset:new Ge(1),opacity:new Ge(1),path:new Ge("")},data:{strokeDashoffset:new Ge(1),opacity:new Ge(1),path:new Ge("")}},alu:{operands:Un(),results:Un(),cog:{rot:new Ge(0)},operation:{backgroundColor:new Ge(Wt.stone[800])},resultText:{opacity:new Ge(0)},leftText:{opacity:new Ge(0)},rightText:{opacity:new Ge(0)}},decoder:{path:Un(),progress:{progress:new Ge(0),opacity:new Ge(1)}},AX:He(),BX:He(),CX:He(),DX:He(),AL:He(),BL:He(),CL:He(),DL:He(),SP:He(),"SP.l":He(),"SP.h":He(),IP:He(),"IP.l":He(),"IP.h":He(),IR:He(),ri:{...He(),opacity:new Ge(0)},"ri.l":He(),"ri.h":He(),id:{...He(),opacity:new Ge(0)},"id.l":He(),"id.h":He(),left:He(),"left.l":He(),"left.h":He(),right:He(),"right.l":He(),"right.h":He(),result:He(),"result.l":He(),"result.h":He(),FLAGS:He(),"FLAGS.l":He(),"FLAGS.h":He(),MAR:He(),MBR:He()},handshake:{DATA:He(),STATE:He()},memory:{"operating-cell":{color:new Ge(Wt.white)}},pic:{IMR:He(),IRR:He(),ISR:He(),INT0:He(),INT1:He(),INT2:He(),INT3:He(),INT4:He(),INT5:He(),INT6:He(),INT7:He()},pio:{PA:He(),PB:He(),CA:He(),CB:He()},printer:{printing:{progress:new Ge(0),opacity:new Ge(1)}},timer:{CONT:He(),COMP:He()}};function je(t){try{return Oj(ky,t)}catch{const n=t.split(".");let i=ky;for(const r of n)if(r in i)i=i[r];else return console.warn(`Path not found: ${t}`),{backgroundColor:new Ge(Wt.stone[800]),opacity:new Ge(1),stop(){},pause(){},resume(){},start:()=>Promise.resolve(),set(){},get:()=>Wt.stone[800],isPaused:!1};return i}}function FB(t){const e={};for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];i instanceof Ge?e[n]=i.get():e[n]=FB(i)}return e}const Ese=FB(ky);function zB(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];i instanceof Ge?i.set(e[n]):zB(t[n],e[n])}}const Ase=()=>zB(ky,Ese),F=new NE({allowSelfLoops:!1});F.addNode("MBR",{position:[615,249]});F.addNode("MBR bottom",{position:[615,274]});F.addNode("MBR reg input",{position:[595,249]});F.addNode("AL",{position:[455,45]});F.addNode("BL",{position:[455,85]});F.addNode("CL",{position:[455,125]});F.addNode("DL",{position:[455,165]});F.addNode("id",{position:[455,205]});F.addNode("SP",{position:[455,309]});F.addNode("IP",{position:[455,349]});F.addNode("ri",{position:[455,388]});F.addNode("ri out",{position:[480,388]});F.addNode("MAR",{position:[630,349]});F.addNode("result",{position:[272,115]});F.addNode("NodoRegIn",{position:[390,115]});F.addNode("NodoRegOut",{position:[550,115]});F.addNode("FLAGS",{position:[250,225]});F.addNode("IR",{position:[250,275]});F.addNode("IR mbr join",{position:[250,250]});F.addNode("left",{position:[130,85]});F.addNode("right",{position:[125,145]});F.addNode("left end",{position:[220,85]});F.addNode("right end",{position:[220,145]});F.addNode("result start",{position:[280,115]});F.addNode("rmbr",{position:[250,390]});F.addNode("bleft1",{position:[550,16]});F.addNode("bleft2",{position:[90,16]});F.addNode("bleft3",{position:[90,85]});F.addNode("CL join",{position:[425,125]});F.addNode("AL join",{position:[425,45]});F.addNode("BL join",{position:[425,85]});F.addNode("MBR top",{position:[615,215]});F.addNode("DL join",{position:[425,165]});F.addNode("id join",{position:[425,205]});F.addNode("data mbr join",{position:[390,250]});F.addNode("mbr approach horizontal",{position:[580,250]});F.addNode("mbr approach vertical",{position:[580,215]});F.addNode("mbr top approach",{position:[600,215]});F.addNode("mbr top entry",{position:[615,215]});F.addNode("mbr bottom exit",{position:[615,285]});F.addNode("mbr to bus horizontal",{position:[585,285]});F.addNode("mbr to bus join",{position:[585,250]});F.addNode("mbr to cpu center",{position:[390,250]});F.addNode("mbr to ir horizontal",{position:[250,250]});F.addNode("mbr to ir vertical end",{position:[250,272]});F.addNode("mbr to ir approach",{position:[250,275]});F.addNode("mbr to ri vertical",{position:[425,388]});F.addNode("SP join",{position:[425,309]});F.addNode("IP join",{position:[390,349]});F.addNode("ri join",{position:[425,388]});F.addNode("MAR join1",{position:[550,388]});F.addNode("MAR join2",{position:[550,349]});F.addNode("result mbr join",{position:[370,250]});F.addNode("FLAGS mbr join",{position:[250,250]});F.addNode("left join",{position:[30,85]});F.addNode("right join",{position:[90,145]});F.addNode("operands mbr join",{position:[90,250]});F.addNode("outr mbr join",{position:[550,250]});F.addNode("mbr reg join",{position:[390,250]});F.addNode("MBR join",{position:[390,250]});F.addNode("AL out",{position:[483,45]});F.addNode("BL out",{position:[483,85]});F.addNode("CL out",{position:[483,125]});F.addNode("DL out",{position:[483,165]});F.addNode("id out",{position:[483,205]});F.addNode("MBR out",{position:[626,249]});F.addNode("MBR out join",{position:[550,250]});F.addNode("SP out",{position:[510,309]});F.addNode("IP out",{position:[510,349]});F.addNode("IP out join",{position:[550,349]});F.addNode("ri out join",{position:[525,388]});F.addNode("SP out join",{position:[525,309]});F.addNode("AL out join",{position:[525,45]});F.addNode("BL out join",{position:[525,85]});F.addNode("CL out join",{position:[525,125]});F.addNode("DL out join",{position:[525,165]});F.addNode("id out join",{position:[521,205]});F.addUndirectedEdge("AL","AL out");F.addUndirectedEdge("BL","BL out");F.addUndirectedEdge("CL","CL out");F.addUndirectedEdge("DL","DL out");F.addUndirectedEdge("id","id out");F.addUndirectedEdge("IP","IP out");F.addUndirectedEdge("SP","SP out");F.addUndirectedEdge("AL out","AL out join");F.addUndirectedEdge("BL out","BL out join");F.addUndirectedEdge("BL out","mbr approach horizontal");F.addUndirectedEdge("CL out","CL out join");F.addUndirectedEdge("DL out","DL out join");F.addUndirectedEdge("id out","id out join");F.addUndirectedEdge("AL out join","NodoRegOut");F.addUndirectedEdge("BL out join","NodoRegOut");F.addUndirectedEdge("CL out join","NodoRegOut");F.addUndirectedEdge("DL out join","NodoRegOut");F.addUndirectedEdge("id out join","NodoRegOut");F.addUndirectedEdge("NodoRegOut","outr mbr join");F.addUndirectedEdge("NodoRegOut","bleft1");F.addUndirectedEdge("bleft1","bleft2");F.addUndirectedEdge("bleft2","bleft3");F.addUndirectedEdge("bleft3","left");F.addUndirectedEdge("left","left end");F.addUndirectedEdge("IP out join","outr mbr join");F.addUndirectedEdge("ri out join","outr mbr join");F.addUndirectedEdge("SP out join","outr mbr join");F.addUndirectedEdge("SP out join","MAR join2");F.addUndirectedEdge("outr mbr join","MAR join2");F.addUndirectedEdge("outr mbr join","data mbr join");F.addUndirectedEdge("MBR","outr mbr join");F.addUndirectedEdge("MBR","MBR out");F.addUndirectedEdge("MBR out","MBR out join");F.addUndirectedEdge("MBR out join","NodoRegOut");F.addUndirectedEdge("MBR out","outr mbr join");F.addUndirectedEdge("mbr reg join","NodoRegIn");F.addUndirectedEdge("outr mbr join","MBR join");F.addUndirectedEdge("MBR join","NodoRegIn");F.addUndirectedEdge("NodoRegIn","AL join");F.addUndirectedEdge("NodoRegIn","BL join");F.addUndirectedEdge("NodoRegIn","CL join");F.addUndirectedEdge("NodoRegIn","DL join");F.addUndirectedEdge("NodoRegIn","id join");F.addUndirectedEdge("outr mbr join","operands mbr join");F.addUndirectedEdge("AL join","AL");F.addUndirectedEdge("BL join","BL");F.addUndirectedEdge("CL join","CL");F.addUndirectedEdge("DL join","DL");F.addUndirectedEdge("id join","id");F.addUndirectedEdge("id join","data mbr join");F.addUndirectedEdge("MBR","data mbr join");F.addUndirectedEdge("MBR","MBR top");F.addUndirectedEdge("MBR","MBR bottom");F.addUndirectedEdge("MBR","MBR reg input");F.addUndirectedEdge("NodoRegOut","MBR reg input");F.addUndirectedEdge("outr mbr join","mbr approach horizontal");F.addUndirectedEdge("mbr approach horizontal","mbr approach vertical");F.addUndirectedEdge("mbr approach vertical","mbr top approach");F.addUndirectedEdge("mbr top approach","mbr top entry");F.addUndirectedEdge("mbr top entry","MBR top");F.addUndirectedEdge("MBR bottom","mbr bottom exit");F.addUndirectedEdge("mbr bottom exit","mbr to bus horizontal");F.addUndirectedEdge("mbr to bus horizontal","mbr to bus join");F.addUndirectedEdge("mbr to bus join","mbr to cpu center");F.addUndirectedEdge("mbr to cpu center","mbr to ir horizontal");F.addUndirectedEdge("mbr to ir horizontal","mbr to ir vertical end");F.addUndirectedEdge("mbr to ir vertical end","mbr to ir approach");F.addUndirectedEdge("mbr to ir approach","IR");F.addUndirectedEdge("mbr to cpu center","mbr to ri vertical");F.addUndirectedEdge("mbr to ri vertical","ri");F.addUndirectedEdge("data mbr join","NodoRegIn");F.addUndirectedEdge("IP","IP join");F.addUndirectedEdge("SP","SP join");F.addUndirectedEdge("ri","ri join");F.addUndirectedEdge("ri","ri out");F.addUndirectedEdge("ri out","ri out join");F.addUndirectedEdge("MAR join1","ri");F.addUndirectedEdge("MAR join2","MAR join1");F.addUndirectedEdge("MAR","MAR join2");F.addUndirectedEdge("IP join","SP join");F.addUndirectedEdge("SP join","ri join");F.addUndirectedEdge("result start","result");F.addUndirectedEdge("result","NodoRegIn");F.addUndirectedEdge("FLAGS","FLAGS mbr join");F.addUndirectedEdge("FLAGS mbr join","data mbr join");F.addUndirectedEdge("IR","IR mbr join");F.addUndirectedEdge("IR mbr join","FLAGS mbr join");F.addUndirectedEdge("left","left join");F.addUndirectedEdge("right","right join");F.addUndirectedEdge("left join","right join");F.addUndirectedEdge("right join","operands mbr join");F.addUndirectedEdge("right","right end");F.addNode("NodoRegOutLeft",{position:[550,90]});F.addUndirectedEdge("MBR out join","NodoRegOutLeft");F.addUndirectedEdge("NodoRegOutLeft","bleft1");F.addNode("NodoRegOutRight",{position:[550,140]});F.addUndirectedEdge("MBR out join","NodoRegOutRight");F.addUndirectedEdge("NodoRegOutRight","outr mbr join");F.addNode("NodoRegOutToRight",{position:[540,115]});F.addUndirectedEdge("NodoRegOut","NodoRegOutToRight");F.addUndirectedEdge("NodoRegOutToRight","outr mbr join");F.addNode("outr mbr join left",{position:[560,250]});F.addNode("NodoRegOutToLeft",{position:[560,115]});F.addUndirectedEdge("outr mbr join left","NodoRegOutToLeft");F.addUndirectedEdge("NodoRegOutToLeft","NodoRegOut");function Pse(t,e,n){const r=(a=>a.replace(/\.(l|h)$/,""))(t);if(!F.hasNode(r))return console.warn(`Nodo origen '${r}' no existe en el grafo`),"";const s=Ri(t,"left end",e,n,{separateMBRPaths:!0,direction:"left"}),o=Ri(t,"right end",e,n,{separateMBRPaths:!0,direction:"right"});return s&&o?`${s} ${o}`:s||o||""}function Ri(t,e,n,i,r){console.log("🔍 generateDataPath llamado con:",{from:t,to:e,instruction:n,mode:i,options:r});const s=f=>{let p=f.replace(/\.(l|h)$/,"");return["MBR","AL","BL","CL","DL","SP","IP","MAR","FLAGS","IR","RESULT"].includes(p.toUpperCase())&&(p=p.toUpperCase()),p},o=s(t),a=s(e),l=["AL","BL","CL","DL","id","SP","IP","ri","MAR","MBR","left","right","left end","right end"];console.log("🔍 Debug inicial:",{normalizedFrom:o,normalizedTo:a,instruction:n,mode:i,isFromRegister:l.includes(o),isToMBR:a==="MBR",condition:l.includes(o)&&a==="MBR"});let c=[];if(console.log("🔍 Evaluando condición ri → MAR:",{normalizedFrom:o,normalizedTo:a,mode:i,condition:o==="ri"&&a==="MAR"&&i==="mem<-imd"}),o==="ri"&&a==="MAR"&&i==="mem<-imd")return console.log("🎯 Usando ruta especial ri → MAR:","M 455 388 H 550 V 348 H 580"),"M 455 388  H 480 H 525 L 550 V 348 H 580";if(o==="ri"&&a==="left end")return console.log("🎯 Usando ruta especial ri → left end"),"M 455 388 H 480 H 550 H 590 V 250 H 30 V 85 H 125 H 220";if(o==="ri"&&a==="right end")return console.log("🎯 Usando ruta especial ri → right end"),"M 455 388 H 480 H 550 V 250 H 390 H 250 H 90 V 145 H 125 H 220";if(!F.hasNode(o))return console.warn(`Nodo origen '${o}' no existe en el grafo`),"";if(!F.hasNode(a))return console.warn(`Nodo destino '${a}' no existe en el grafo`),"";if(o==="FLAGS"&&a==="MBR")return console.log("🎯 Usando ruta FLAGS → MBR pasando por secuencia completa de nodos"),"M 250 225 L 250 250 L 390 250 L 550 250 L 580 250 L 580 215 L 600 215 L 615 215 L 615 215 L 615 249";if(o==="MBR"&&a==="IR"){const f=["MBR bottom","mbr bottom exit","mbr to bus horizontal","mbr to bus join","mbr to cpu center","mbr to ir horizontal","mbr to ir vertical end","mbr to ir approach","IR"],p=F.getNodeAttribute(f[0],"position");let m=`M ${p[0]} ${p[1]}`;for(let g=1;g<f.length;g++){const[y,v]=F.getNodeAttribute(f[g],"position");m+=` L ${y} ${v}`}return m}if(r!=null&&r.separateMBRPaths&&t==="MBR"&&(e==="left"||e==="right"))e==="left"?c=[o,`${o} out`,`${o} out join`,"outr mbr join left","NodoRegOutToLeft","NodoRegOut","bleft1","bleft2","bleft3","left","left end"]:e==="right"&&(c=[o,`${o} out`,`${o} out join`,"outr mbr join","mbr reg join","IR mbr join","operands mbr join","right join","right","right end"]);else if(a==="left")c=[o,`${o} out`,`${o} out join`,"NodoRegOut","bleft1","bleft2","bleft3","left","left end"];else if(a==="right")if(o==="MBR"){const f="MBR_down300";F.hasNode(f)||(F.addNode(f,{position:[620,300]}),F.addUndirectedEdge("MBR",f));const p="MBR_right125_300";F.hasNode(p)||(F.addNode(p,{position:[125,300]}),F.addUndirectedEdge(f,p)),c=["MBR bottom","MBR",f,p,"right","right end"]}else c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr reg join","IR mbr join","operands mbr join","right join","right","right end"];else if(o==="BL"&&a==="ri")c=["BL","BL out","BL out join","NodoRegOut","outr mbr join","MAR join2","MAR"];else if(o==="MBR"&&a==="id"&&i==="mem<-imd"){console.log("🎯 Caso específico MBR → id detectado");const f=["MBR bottom","MBR","mbr reg join","NodoRegIn","id join","id"],p=F.getNodeAttribute(f[0],"position");let m=`M ${p[0]} ${p[1]}`;for(let g=1;g<f.length;g++){const[y,v]=F.getNodeAttribute(f[g],"position");m+=` L ${y} ${v}`}return console.log("🎯 Path definido para MBR → id:",m),m}else if(o==="MBR"&&a==="BL")c=["MBR bottom","mbr bottom exit","mbr to bus horizontal","mbr to bus join","outr mbr join","mbr reg join","NodoRegIn","BL join","BL"],console.log("🎯 Path definido para MBR → BL (animación desde MBR bottom, ingresando por mbr reg join, NodoRegIn, BL join):",c);else if(o==="MBR"&&["AL","BL","CL","DL","id"].includes(a))c=["MBR bottom","mbr bottom exit","mbr to bus horizontal","mbr to bus join","outr mbr join","mbr reg join","NodoRegIn",`${a} join`,a],console.log(`🎯 Path definido para MBR → ${a} (animación desde MBR bottom, pasando por bus gris y nodos de entrada):`,c);else if(o==="BL"&&a==="MBR")console.log("🎯 Caso específico BL → MBR detectado - evitando NodoRegIn y mbr reg join"),c=["BL","BL out","mbr approach horizontal","mbr approach vertical","mbr top approach","mbr top entry","MBR top","MBR"],console.log("🎯 Path definido para BL → MBR:",c);else if(l.includes(o)&&a==="MBR"&&(n==null?void 0:n.toUpperCase())==="MOV")console.log("🎯 Usando ruta prioritaria para MOV registro→MBR (evitando NodoRegOut y NodoRegIn)"),c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr approach horizontal","mbr approach vertical","mbr top approach","mbr top entry","MBR top","MBR"];else if(l.includes(o)&&l.includes(a))["SP","IP","ri"].includes(a)?c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr reg join","NodoRegIn",`${a} join`,a]:c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr reg join","NodoRegIn",`${a} join`,a];else if(l.includes(o)&&a==="MBR")c=[o,`${o} out`,`${o} out join`,"NodoRegOut","outr mbr join","mbr approach horizontal","mbr approach vertical","mbr top approach","mbr top entry","MBR top","MBR"];else if(o==="MBR"&&a==="ri"){console.log("🎯 Usando ruta directa MBR → ri (evitando NodoRegIn/NodoRegOut)"),c=["MBR bottom","mbr bottom exit","mbr to bus horizontal","mbr to bus join","mbr to cpu center","mbr to ri vertical","ri"];const f=F.getNodeAttribute(c[0],"position");let p=`M ${f[0]} ${f[1]}`;for(let m=1;m<c.length;m++){const[g,y]=F.getNodeAttribute(c[m],"position");p+=` L ${g} ${y}`}return console.log("🎯 Path SVG directo MBR → ri:",p),p}else try{c=sre(F,o,a)||[]}catch(f){return console.warn(`Error calculando ruta de ${o} a ${a}:`,f),""}if(o==="MBR"&&a==="IP"){const f=F.getNodeAttribute("MBR bottom","position"),p=F.getNodeAttribute("mbr bottom exit","position"),m=F.getNodeAttribute("mbr to bus horizontal","position"),g=F.getNodeAttribute("mbr to bus join","position"),y=F.getNodeAttribute("mbr to cpu center","position"),v=F.getNodeAttribute("IP","position");return console.log("🎯 Usando ruta especial MBR → IP desde MBR bottom (similar a MBR → IR)"),`M ${f[0]} ${f[1]} L ${p[0]} ${p[1]} L ${m[0]} ${m[1]} L ${g[0]} ${g[1]} L ${y[0]} ${y[1]} L ${y[0]} ${v[1]} L ${v[0]} ${v[1]}`}if(o==="ri"&&a==="IP")return console.log("🎯 Usando ruta especial ri → IP pasando por bus central a altura MBR"),"M 455 388 H 480 H 525 L 550 349 V 250 H 390 V 349 H 455";if(o==="MBR"&&a==="ri"&&["JMP","JZ","JC"].includes(n??""))return"";if(o==="MBR"&&a==="ri"&&(n==="CALL"||n==="INT")&&(c=["MBR bottom","mbr bottom exit","mbr to bus horizontal","mbr to bus join","mbr to cpu center","IP join","mbr to ri vertical","ri"]),o==="IP"&&a==="MBR"&&(n==="INT"||n==="CALL"))return"M 455 349 H 550 V 233 H 615 V 249";if(c.length===0)return console.warn(`No se encontró ruta de ${o} a ${a}`),"";for(const f of c)if(!F.hasNode(f))return console.error(`❌ Nodo "${f}" no existe en el grafo. Path completo:`,c),"";const u=F.getNodeAttribute(c[0],"position");let d=`M ${u[0]} ${u[1]}`;for(let f=1;f<c.length;f++){const[p,m]=F.getNodeAttribute(c[f],"position");d+=` L ${p} ${m}`}return console.log("🎯 generateDataPath retornando:",d),console.log("🎯 Path completo:",c),o==="MBR"&&a==="id"&&console.log("🎯 Path SVG generado para MBR → id:",d),d}function aw(){const t=[615,274],e=[615,285],n=[580,285],i=[580,250],r=[550,250],s=[550,349],o=[630,349];return`M ${t[0]} ${t[1]} L ${e[0]} ${e[1]} L ${n[0]} ${n[1]} L ${i[0]} ${i[1]} L ${r[0]} ${r[1]} L ${s[0]} ${s[1]} L ${o[0]} ${o[1]}`}function Nse({showSP:t,showid:e,showri:n}){const{path:i,...r}=je("cpu.internalBus.data"),{path:s,...o}=je("cpu.internalBus.address"),a=tt(Hn),l=(a==null?void 0:a.phase)==="writeback",c=()=>l?"stroke-purple-400 drop-shadow-[0_0_8px_rgba(168,85,247,0.6)]":"stroke-mantis-400 drop-shadow-[0_0_8px_rgba(34,197,94,0.6)]",u=()=>l?"stroke-purple-300":"stroke-mantis-300";return h.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0 z-30",children:[h.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:["M 220 145 H 90","V 250 H 580","M 90 145 H 90","M 272 115 H 390","M 250 225 V 250","M 580 250 H 390","M 390 250 H 250","M 250 145 v 46","M 250 250 V 272","M 250 300 V 320","M 451 349 H 390 V 250",t?"M 390 349 L 425 309 L 455 309":"",n?"M 390 349 L 425 388 L 455 388":"","M 455 45 H 425","M 455 85 H 425","M 455 125 H 425","M 455 165 H 425",e?"M 455 205 H 425":"","M 550 40 V 250","M 550 45 V 16 H 90 V 84 H 220","M 390 250 V 115","M 390 115 L 425 45 L 455 45","M 390 115 L 425 85 L 455 85","M 390 115 L 425 125 L 455 125","M 390 115 L 425 165 L 455 165",e?"M 390 115 L 425 205 L 451 205":"","M 550 115 L 525 45 L 445 45","M 550 115 L 525 85 L 445 85","M 550 115 L 525 125 L 445 125","M 550 115 L 525 165 L 445 165",e?"M 550 115 L 521 205 L 441 205":"","M 550 250 H 585 V 222 H 615","M 550 250 H 585 V 285 H 700","M 645 249 V 222 H 615 V 233","M 615 274 V 285 H 645 V 249"].join(" ")}),h.jsx("circle",{cx:390,cy:115,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:550,cy:115,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:250,cy:250,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:390,cy:250,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:550,cy:250,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:550,cy:348,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx("circle",{cx:615,cy:222,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2})," ",h.jsx("circle",{cx:615,cy:287,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2})," ",(n||t)&&h.jsx("circle",{cx:390,cy:349,r:8,fill:"#292524",stroke:"#44403c",strokeWidth:2}),h.jsx(Qe.path,{d:i,className:`fill-none stroke-[3px] ${c()}`,strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:r}),h.jsx(Qe.path,{d:i,className:`fill-none stroke-1 opacity-50 ${u()}`,strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:r}),h.jsx(Qe.path,{d:s,className:"fill-none stroke-[#3B82F6] stroke-[3px] drop-shadow-[0_0_8px_rgba(59,130,246,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:o}),h.jsx(Qe.path,{d:s,className:"fill-none stroke-[#60A5FA] stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:o})]})}const lm=new Set;async function ye(t,e){const n=P.get(Tt);if(!nt().animations)return Promise.resolve();if(n.type==="stopped")return null;if(n.type==="paused")return await new Promise(a=>{const l=P.sub(Tt,()=>{P.get(Tt).type!=="paused"&&(l(),a())})}),await ye(t,e);const i=nt();if(!i.animations&&!e.forceMs)return null;const s=Math.min(i.executionUnit,250),o={duration:e.forceMs?e.duration:i.animations?e.duration*s:1,easing:gB[e.easing]};return Array.isArray(t)||(t=[t]),await Promise.all(t.map(async({key:a,from:l,to:c})=>{if(c===void 0&&l===void 0)return null;try{const u=je(a);if(c===void 0)return u.set(l);{lm.add(a);const d=await je(a).start({from:l,to:c,config:o});return lm.delete(a),d}}catch(u){return console.warn(`Error animando la clave ${a}:`,u),null}}))}const UB=()=>lm.forEach(t=>{try{const e=je(t);e&&typeof e.pause=="function"&&e.pause()}catch(e){console.warn(`Error pausing animation for key ${t}:`,e)}}),VB=()=>lm.forEach(t=>{try{const e=je(t);e&&typeof e.resume=="function"&&e.resume()}catch(e){console.warn(`Error resuming animation for key ${t}:`,e)}});function HE(){lm.forEach(t=>{try{const e=je(t);e&&typeof e.stop=="function"&&(e.stop(!0),e.isPaused&&typeof e.resume=="function"&&e.resume())}catch(e){console.warn(`Error stopping animation for key ${t}:`,e)}}),setTimeout(()=>Ase(),10)}const Mse={AX:Wt.blue[500],BX:"#4F46E5",CX:"#3B82F6",DX:"#1E40AF",IP:Wt.red[500],SP:"#FACC15",MAR:Wt.blue[500],MBR:Wt.blue[500],IR:Wt.blue[500],FLAGS:"#F59E0B",result:"#10B981",id:"#06B6D4",ri:"#06B6D4",left:"#22C55E",right:"#16A34A"};function HB(t){const e=t.replace("cpu.","").split(".")[0];return Mse[e]||Wt.stone[600]}async function vt(t,e){try{if(t==="cpu.MBR"&&window.__nextTransferMBRtoIP||t==="cpu.right.l"||t==="cpu.left.l")return;const n=e||HB(t);await ye({key:`${t}.backgroundColor`,to:n},{duration:2,easing:"easeOutCubic"}),await ye({key:`${t}.backgroundColor`,to:Wt.stone[750]},{duration:3,easing:"easeInCubic"});return}catch(n){return console.warn(`No se pudo animar el registro ${t}:`,n),null}}async function yt(t){try{return t==="cpu.right.l"||t==="cpu.left.l"?void 0:await ye({key:`${t}.backgroundColor`,to:Wt.stone[800]},{duration:2,easing:"easeInOutQuart"})}catch(e){return console.warn(`No se pudo desactivar el registro ${t}:`,e),null}}async function Ad(t){try{if(t==="cpu.MBR"&&window.__nextTransferMBRtoIP)return;const e=nt(),n=HB(t);await ye({key:`${t}.backgroundColor`,to:n},{duration:2,easing:"easeOutQuart"});const i=e.animations?1e3:1;await new Promise(r=>setTimeout(r,i)),await ye({key:`${t}.backgroundColor`,to:Wt.stone[800]},{duration:2,easing:"easeInQuart"});return}catch(e){return console.warn(`No se pudo actualizar el registro ${t}:`,e),null}}async function hf(t){await vt("cpu.MBR"),P.set(Yn,t),await yt("cpu.MBR")}function Tk(){setTimeout(()=>{try{const t=je("bus.rd.opacity");t&&t.set(0)}catch{}try{const t=je("bus.wr.opacity");t&&t.set(0)}catch{}},0)}function Ok(){try{const t=je("bus.rd.opacity");t&&t.start({to:1})}catch{}}function Lk(){try{const t=je("bus.rd.opacity");t&&t.start({to:0})}catch{}}function WB(){try{const t=je("bus.wr.opacity");t&&t.start({to:1})}catch{}}function GB(){try{const t=je("bus.wr.opacity");t&&t.start({to:0})}catch{}}function qB(){try{const t=je("cpu.alu.resultText.opacity");t&&t.start({to:1})}catch{}}function KB(){try{const t=je("cpu.alu.resultText.opacity");t&&t.start({to:0})}catch{}}function Dk(){setTimeout(()=>{try{const t=je("cpu.alu.resultText.opacity");t&&t.set(0)}catch{}},0)}function XB(){try{const t=je("cpu.alu.leftText.opacity");t&&t.start({to:1})}catch{}}function YB(){try{const t=je("cpu.alu.leftText.opacity");t&&t.start({to:0})}catch{}}function jk(){setTimeout(()=>{try{const t=je("cpu.alu.leftText.opacity");t&&t.set(0)}catch{}},0)}function JB(){try{const t=je("cpu.alu.rightText.opacity");t&&t.start({to:1})}catch{}}function ZB(){try{const t=je("cpu.alu.rightText.opacity");t&&t.start({to:0})}catch{}}function Bk(){setTimeout(()=>{try{const t=je("cpu.alu.rightText.opacity");t&&t.set(0)}catch{}},0)}async function Di(t,e){return await ye([{key:`${t}.strokeDashoffset`,from:1,to:0},{key:`${t}.opacity`,from:1}],{duration:e,easing:"easeInOutSine"})}async function ri(t){return await ye({key:`${t}.opacity`,to:0},{duration:1,easing:"easeInSine"})}const Rse=Object.freeze(Object.defineProperty({__proto__:null,activateRegister:vt,anim:ye,deactivateRegister:yt,getSettings:nt,hideALULeftText:YB,hideALULeftTextOnInit:jk,hideALUResultText:KB,hideALUResultTextOnInit:Dk,hideALURightText:ZB,hideALURightTextOnInit:Bk,hideControlBusTextsOnInit:Tk,hideReadControlText:Lk,hideWriteControlText:GB,pauseAllAnimations:UB,populateDataBus:hf,resumeAllAnimations:VB,showALULeftText:XB,showALUResultText:qB,showALURightText:JB,showReadControlText:Ok,showWriteControlText:WB,stopAllAnimations:HE,turnLineOff:ri,turnLineOn:Di,updateRegisterWithGlow:Ad},Symbol.toStringTag,{value:"Module"}));async function m3(t){switch(t.type){case"bus:io.selected":{await Promise.all([ye({key:"bus.mem.stroke",to:Wt.stone[700]},{duration:1,easing:"easeInSine"}),Di(`bus.${t.chip}`,15)]);return}case"bus:io.error":{const e=t.error;if(e.code==="io-memory-not-connected"){let n;try{const i=e.context;if(i&&i[0]){const r=i[0];typeof r=="number"?n=r:r&&typeof r.valueOf=="function"&&(n=Number(r.valueOf()))}}catch{const s=e.message.match(/0x([0-9A-Fa-f]+)/);s&&(n=parseInt(s[1],16))}if(typeof n=="number"&&n>=48&&n<=51&&!nt().devices.pio){console.log(`🔧 Detectada operación I/O en dirección PIO ${n.toString(16).toUpperCase()}h. Activando PIO automáticamente.`);const s={48:"PA",49:"PB",50:"CA",51:"CB"}[n]||"Unknown";Pd("PIO activado automáticamente",`Se detectó una operación I/O en la dirección ${n.toString(16).toUpperCase()}h (${s}). El PIO se ha activado automáticamente.`),P.set(Ti,a=>({...a,devices:{...a.devices,pio:"switches-and-leds","switches-and-leds":!0}}));const o=new CustomEvent("pioActivated",{detail:{address:n,registerName:s,shouldReload:!0}});window.dispatchEvent(o);return}if(typeof n=="number"&&n>=64&&n<=65&&!nt().devices.handshake){console.log(`🔧 Detectada operación I/O en dirección Handshake ${n.toString(16).toUpperCase()}h. Activando impresora con Handshake automáticamente.`);const s={64:"HS_DATA",65:"HS_STATUS"}[n]||"Unknown";Pd("Impresora (Handshake) activada automáticamente",`Se detectó una operación I/O en la dirección ${n.toString(16).toUpperCase()}h (${s}). La impresora con Handshake se ha activado automáticamente.`),P.set(Ti,a=>({...a,devices:{...a.devices,handshake:"printer"}}));const o=new CustomEvent("handshakeActivated",{detail:{address:n,registerName:s,shouldReload:!0}});window.dispatchEvent(o);return}if(typeof n=="number"&&n>=32&&n<=43&&!nt().devices.pic){console.log(`🔧 Detectada operación I/O en dirección PIC ${n.toString(16).toUpperCase()}h. Activando PIC automáticamente.`);const s={32:"EOI",33:"IMR",34:"IRR",35:"ISR",36:"INT0",37:"INT1",38:"INT2",39:"INT3",40:"INT4",41:"INT5",42:"INT6",43:"INT7"}[n]||`PIC_REG_${n.toString(16).toUpperCase()}h`;Pd("PIC activado automáticamente",`Se detectó una operación I/O en la dirección ${n.toString(16).toUpperCase()}h (${s}). El PIC se ha activado automáticamente.`),P.set(Ti,a=>({...a,devices:{...a.devices,pic:!0}}));const o=new CustomEvent("picActivated",{detail:{address:n,registerName:s,shouldReload:!0}});window.dispatchEvent(o);return}}Jr(t.error);return}case"bus:reset":{await Promise.all([ye([{key:"bus.address.strokeDashoffset",to:1},{key:"bus.data.strokeDashoffset",to:1},{key:"bus.rd.strokeDashoffset",to:1},{key:"bus.wr.strokeDashoffset",to:1}],{duration:1,easing:"easeInSine"}),ye({key:"bus.mem.stroke",to:Wt.red[500]},{duration:1,easing:"easeOutSine"}),ri("bus.iom"),ri("bus.handshake"),ri("bus.pio"),ri("bus.pic"),ri("bus.timer")]);return}default:return t}}async function Ise(t){switch(console.log("🕐 [DEBUG] handleClockEvent llamado con evento:",t),t.type){case"clock:tick":{console.log("🕐 [DEBUG] Evento clock:tick recibido - iniciando animación");try{const e=je("clock.angle");console.log("🕐 [DEBUG] Spring clock.angle obtenido:",e);const n=nt(),i=n.clockSpeed;console.log("🕐 [DEBUG] Configuración del reloj:",{duration:i,clockSpeed:n.clockSpeed,animations:n.animations}),console.log("🕐 [DEBUG] Iniciando animación del spring clock.angle"),await ye({key:"clock.angle",from:0,to:360},{duration:i,forceMs:!0,easing:"linear"}),console.log("🕐 [DEBUG] Animación del reloj completada exitosamente")}catch(e){console.error("🕐 [ERROR] Error en la animación del reloj:",e)}return}default:return t.type}}function vs(t,e,n){let i="";switch(e&&(i="M 455 388 L 525 388 L 550 348 H 610"),n&&(i="M 594 249 H 550 V 348 H 610"),t){case"SP":return"M 455 309 L 525 309 L 550 348 H 610";case"IP":return"M 460 349 H 610";case"ri":return e||n?i:"M 455 388 L 525 388 L 550 348 H 610";default:throw new Error(`Invalid register ${t}`)}}function Tse({showSP:t,showri:e}){const{path:n,...i}=je("cpu.internalBus.address"),r=[t?"M 455 309 L 525 309 L 550 348":"","M 400 349 H 550 V 255",e?"M 455 388 L 525 388 L 550 348":"","M 400 349 H 610","M 610 349 H 650","M 390 115 H 250 V 205"];return h.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0 z-30",children:[r.map((s,o)=>h.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:s},o)),h.jsx(Qe.path,{d:n,className:"fill-none stroke-[#3B82F6] stroke-[3px] drop-shadow-[0_0_8px_rgba(59,130,246,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:i}),h.jsx(Qe.path,{d:n,className:"fill-none stroke-[#60A5FA] stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:i})]})}console.log("🔧 generateDataPath importado:",typeof Ri);let _c=null,Cc=null,qi=0,Bt="";function Ose(){return qi}function Lse(t,e){qi=t,Bt=e,console.log(`🎯 updateInstructionContext: executeStageCounter=${t}, instructionName=${e}`)}let Jt="fetching";const $r=async(t=.1)=>{console.log("📊 Animando solo secuenciador - progreso del paso:",t,"fase actual:",Jt);let e=t;Jt==="fetching"?(e=.15,console.log("📥 Fase de captación - incremento grande:",e)):Jt==="fetching-operands"?(e=.12,console.log("📥 Fase de captación de operandos - incremento mediano:",e)):(e=Math.min(t,.08),console.log("⚙️ Fase de ejecución/writeback - incremento menor:",e));const n=je("sequencer.progress.progress").get(),i=Math.min(n+e,1);console.log(`📊 Progreso: ${(n*100).toFixed(1)}% → ${(i*100).toFixed(1)}%`),await ye({key:"sequencer.progress.progress",to:i},{duration:150,easing:"easeInOutSine",forceMs:!0})},Dse=async(t=.1)=>{console.log("🧠 Animando memoria de control + secuenciador - progreso del paso:",t,"fase actual:",Jt);let e=t;Jt==="fetching"?(e=.15,console.log("📥 Fase de captación - incremento grande:",e)):Jt==="fetching-operands"?(e=.12,console.log("📥 Fase de captación de operandos - incremento mediano:",e)):(e=Math.min(t,.08),console.log("⚙️ Fase de ejecución/writeback - incremento menor:",e)),await ye([{key:"cpu.decoder.path.opacity",from:1},{key:"cpu.decoder.path.strokeDashoffset",from:1,to:0}],{duration:200,easing:"easeInOutSine",forceMs:!0});const i=je("sequencer.progress.progress").get(),r=Math.min(i+e,1);console.log(`📊 Progreso: ${(i*100).toFixed(1)}% → ${(r*100).toFixed(1)}%`),await ye({key:"sequencer.progress.progress",to:r},{duration:150,easing:"easeInOutSine",forceMs:!0}),await ye({key:"cpu.decoder.path.opacity",to:0},{duration:100,easing:"easeInSine",forceMs:!0}),console.log(`✅ Unidades de control animadas - nuevo progreso: ${r}`)},yn=(t,e,n,i)=>{console.log("🎨 drawDataPath llamado con:",{from:t,to:e,instruction:n,mode:i});try{console.log("🔧 Antes de llamar generateDataPath"),console.log("🔧 generateDataPath es:",typeof Ri);const r=Ri(t,e,n,i);if(console.log("🔧 Después de llamar generateDataPath"),console.log("🎯 Ruta generada en drawDataPath:",r),!r)return console.log("❌ No hay ruta, retornando Promise.resolve()"),Promise.resolve();const s=nt(),o=s.animations?s.executionUnit:1;return console.log("🔧 settings.animations:",s.animations),console.log("🔧 settings.executionUnit:",s.executionUnit),console.log("🔧 Duración de la animación:",o),ye([{key:"cpu.internalBus.data.path",from:r},{key:"cpu.internalBus.data.opacity",from:1},{key:"cpu.internalBus.data.strokeDashoffset",from:1,to:0}],{duration:o,easing:"easeInOutSine",forceMs:!0})}catch(r){return console.error("❌ Error en drawDataPath:",r),console.error("❌ Stack trace:",r instanceof Error?r.stack:"No stack trace"),Promise.resolve()}},jse=(t,e,n)=>{try{const i=Pse(t,e,n);if(!i)return Promise.resolve();const r=nt(),s=r.animations?r.executionUnit:1;return ye([{key:"cpu.internalBus.data.path",from:i},{key:"cpu.internalBus.data.opacity",from:1},{key:"cpu.internalBus.data.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0})}catch(i){return console.warn("Error en drawSimultaneousLeftRightPath:",i),Promise.resolve()}},pi=()=>ye({key:"cpu.internalBus.data.opacity",to:0},{duration:1,easing:"easeInSine"}),Bse=(t,e)=>{console.log("🎨 drawAddressPath llamado con:",{from:t,to:e});try{const n=vs(t);if(console.log("🎯 Ruta generada en drawAddressPath:",n),!n)return console.log("❌ No hay ruta para bus de direcciones, retornando Promise.resolve()"),Promise.resolve();const i=nt(),r=i.animations?i.executionUnit:1;return console.log("🔧 Duración de la animación (bus de direcciones):",r),ye([{key:"cpu.internalBus.address.path",from:n},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:r,easing:"easeInOutSine",forceMs:!0})}catch(n){return console.error("❌ Error en drawAddressPath:",n),Promise.resolve()}},$se=()=>ye({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),Fse=async(t,e,n)=>{console.log("🎯 Animación simultánea detectada: left y right desde",t),Jt!=="fetching-operands"&&(console.log("⏳ Esperando fase fetching-operands para animación simultánea..."),await new Promise(i=>{const r=()=>{Jt==="fetching-operands"?i():setTimeout(r,50)};r()}),console.log("✅ Fase fetching-operands alcanzada, procediendo con animación simultánea")),await jse(t,e,n),await Promise.all([vt("cpu.left"),vt("cpu.right")]),P.set(he.left,P.get(he[t])),P.set(he.right,P.get(he[t])),await Promise.all([yt("cpu.left"),yt("cpu.right")]),_c=null,Cc=null,await pi()};let te="",$e="",Sn=null,jo=null,Fi=null,mc=null,gc=null;const Da=t=>t.replace(/\.(l|h)$/,"");async function g3(){await Promise.all([Ad("cpu.MBR"),Ad("cpu.IP"),new Promise(t=>{window.dispatchEvent(new CustomEvent("ip-register-update")),t()})])}async function $k(t){switch(console.log("🔍 CPU Event:",t.type,t),window.VONSIM_PARALLEL_ANIMATIONS&&t.type==="cpu:mar.set"&&window.dispatchEvent(new CustomEvent("vonsim:parallel-memory-read-visual")),t.type){case"cpu:alu.execute":{console.log("🚀 Evento cpu:alu.execute recibido, fase actual:",Jt),await $r(.12);const e=nt(),r={duration:e.animations?Math.min(e.executionUnit,250):1,easing:"easeInOutSine",forceMs:!0},s=Bt==="INT"&&Jt==="fetching";e.animations&&!s?Jt!=="executing"?(console.log("⏳ Esperando fase executing para animación de la ALU..."),await new Promise(o=>{let a=0;const l=40;let c=0;const u=()=>{a++,(a%10===0||a!==c+1)&&(console.log(`🔍 Verificando fase actual: ${Jt} (intento ${a}/${l})`),c=a),Jt==="executing"?(console.log("✅ Fase executing alcanzada"),o()):a>=l?(console.warn("⚠️ Timeout esperando fase executing después de 2s, procediendo de todas formas"),console.warn(`🔍 Fase final: ${Jt}, se esperaba: executing`),o()):setTimeout(u,50)};u()}),console.log("✅ Fase executing alcanzada, procediendo con animación de la ALU")):console.log("✅ Ya estamos en fase executing, procediendo directamente"):s&&console.log("🔧 Operación interna detectada durante INT, saltando espera de fase"),await Promise.all([(async()=>{XB(),JB(),await ye([{key:"cpu.alu.operands.opacity",from:1},{key:"cpu.alu.operands.strokeDashoffset",from:1,to:0}],r),YB(),ZB()})()]),P.set(aE,t.operation),await ye({key:"cpu.alu.operation.backgroundColor",to:Wt.mantis[400]},{duration:1,easing:"easeOutQuart"}),await ye({key:"cpu.alu.operation.backgroundColor",to:Wt.stone[800]},{duration:1,easing:"easeOutQuart"}),console.log("� Iniciando animación del bus de resultado..."),await ye([{key:"cpu.alu.results.opacity",from:1},{key:"cpu.alu.results.strokeDashoffset",from:1,to:0}],r),await Promise.all([vt("cpu.result"),vt("cpu.FLAGS")]),P.set(he.FLAGS,t.flags),P.set(he.result,t.result),await Promise.all([yt("cpu.result"),yt("cpu.FLAGS")]),console.log("💜 Mostrando texto del resultado después de actualizar FLAGS..."),e.animations&&(qB(),await new Promise(o=>setTimeout(o,1e3))),await Promise.all([ye({key:"cpu.alu.results.opacity",to:0},{duration:1,easing:"easeInSine"}),(async()=>{KB()})()]),await ye({key:"cpu.alu.operands.opacity",to:0},{duration:1,easing:"easeInSine"});return}case"cpu:cycle.end":{_c=null,Cc=null,Sn=null,jo=null,Fi=null,mc=null,gc=null,Jt="fetching";const{store:e}=await $p(async()=>{const{store:c}=await Promise.resolve().then(()=>wJ);return{store:c}},void 0),{messageAtom:n,totalCycleCountAtom:i,currentInstructionCycleCountAtom:r,cycleCountAtom:s}=await $p(async()=>{const{messageAtom:c,totalCycleCountAtom:u,currentInstructionCycleCountAtom:d,cycleCountAtom:f}=await Promise.resolve().then(()=>EQ);return{messageAtom:c,totalCycleCountAtom:u,currentInstructionCycleCountAtom:d,cycleCountAtom:f}},void 0);if(Bt==="CALL"){const c="Ejecución: write(Memoria[MAR]) ← MBR | IP ← ri";e.set(n,c);const u=e.get(s),d=e.get(r);e.set(s,u+1),e.set(r,d+1),console.log("✅ CALL cpu:cycle.end - Mensaje final establecido:",c),console.log("✅ CALL cpu:cycle.end - Ciclo 8 registrado:",{cycleCount:u+1,currentInstructionCycleCount:d+1})}const o=e.get(r);e.set(i,c=>c+o);const a=e.get(Tt);a.type==="running"&&a.until==="cycle-change"?(console.log("🎯 Modo paso a paso: completando barra de progreso al 100%"),await ye({key:"sequencer.progress.progress",to:1},{duration:300,easing:"easeInOutSine",forceMs:!0}),console.log("✅ Instrucción completada - barra al 100% (se reiniciará al comenzar la siguiente)")):(console.log("🔄 Modo continuo: reiniciando barra de progreso a cero"),ye({key:"sequencer.progress.progress",to:0},{duration:200,easing:"easeInOutSine",forceMs:!0}));return}case"cpu:cycle.interrupt":{P.set(Hn,e=>"metadata"in e?{...e,phase:"interrupt"}:e),await ye([{key:"cpu.id.opacity",to:0},{key:"cpu.ri.opacity",to:0}],{duration:150,easing:"easeInOutQuad",forceMs:!0});return}case"cpu:cycle.start":{$r(.05),te=t.instruction.name,$e=t.instruction.willUse.ri?"mem<-imd":"",console.log("[cpu:cycle.start] instructionName:",te,"willUse.ri:",t.instruction.willUse.ri,"mode:",$e,"position:",t.instruction.position),t.instruction.willUse.ri,t.instruction.willUse.ri,_c=null,Cc=null,Sn=null,jo=null,Fi=null,mc=null,gc=null,Jt="fetching",R6(t.instruction.position.start),P.set(Hn,{phase:"fetching",metadata:t.instruction});const e=P.get(Tt);e.type==="running"&&e.until==="cycle-change"&&(console.log("Modo paso a paso: reiniciando barra de progreso a cero para nueva instrucción"),await ye({key:"sequencer.progress.progress",to:0},{duration:250,easing:"easeInOutSine",forceMs:!0})),console.log("🔄 Asegurando que la barra de progreso del decodificador esté en cero"),await ye({key:"sequencer.progress.progress",to:0},{duration:200,easing:"easeInOutSine",forceMs:!0}),console.log("� Iniciando nueva instrucción - la barra comenzará a incrementarse durante la captación"),await ye([{key:"cpu.id.opacity",to:t.instruction.willUse.id?1:0},{key:"cpu.ri.opacity",to:t.instruction.willUse.ri?1:0}],{duration:150,easing:"easeInOutQuad",forceMs:!0});return}case"cpu:cycle.update":{const e=t.phase==="execute"?"executing":t.phase==="writeback"?"writeback":t.next==="fetch-operands"?"fetching-operands":t.next==="execute"?"executing":t.next==="writeback"?"writeback":t.next==="halting"?"halting":"fetching";Jt=e,console.log("🔄 Fase del ciclo actualizada:",Jt);let n=0;switch(e){case"fetching":n=0;break;case"fetching-operands":n=.25;break;case"executing":n=.5;break;case"writeback":n=.75;break;case"halting":n=1;break;default:n=0}ye({key:"sequencer.progress.progress",to:n},{duration:300,easing:"easeInOutSine",forceMs:!0}),P.set(Hn,i=>"metadata"in i?{...i,phase:e}:i);return}case"cpu:decode":{Dse(.1),ye([{key:"cpu.decoder.progress.opacity",from:1},{key:"cpu.decoder.progress.progress",from:0,to:1}],{duration:150,easing:"easeInOutSine",forceMs:!0}),ye({key:"cpu.decoder.progress.opacity",to:0},{duration:80,easing:"easeInSine",forceMs:!0});return}case"cpu:error":{P.set(Hn,{phase:"stopped",error:t.error}),Jr(t.error);return}case"cpu:halt":case"cpu:int.0":{if(t.type==="cpu:halt"){P.set(go,!0),console.log("🛑 events.ts: isHaltExecutionAtom set to true before finishSimulation");const e=P.get(Hn);"metadata"in e&&(P.set(Hn,{phase:"halting",metadata:e.metadata}),await new Promise(n=>setTimeout(n,1e3)))}P.set(Hn,{phase:"stopped"}),Jr();return}case"cpu:int.6":{P.set(Hn,{phase:"int6"});return}case"cpu:int.7":{P.set(Hn,{phase:"int7"});return}case"cpu:inta.off":{await ri("bus.inta");return}case"cpu:inta.on":{await Di("bus.inta",10);return}case"cpu:rd.on":case"cpu:wr.on":{$r(.05);const e=t.type.slice(4,6);window.dispatchEvent(new CustomEvent("vonsim:parallel-memory-write-visual")),await Di(`bus.${e}`,10);return}case"cpu:iom.on":{await Di("bus.iom",15);return}case"cpu:mar.set":{$r(.05);const e=Da(t.register),n=e==="MBR";if(e==="IP")if(console.log("🔄 Detectando transferencia IP→MAR para animación simultánea"),Fi={instruction:te,mode:$e},console.log(`📝 Guardando pendingIPtoMARFromRegCopy desde cpu:mar.set: ${te}, ${$e}`),Sn&&Sn.instruction===te||jo&&jo.instruction===te){if(Sn&&Sn.instruction===te)console.log("🎯 Ejecutando animaciones simultáneas para MBR→ID + IP→MAR desde cpu:mar.set"),await Promise.all([yn("MBR","id",Sn.instruction,Sn.mode),(async()=>{const l=nt(),u=l.animations?Math.min(l.executionUnit,250):1;return ye([{key:"cpu.internalBus.address.path",from:vs("IP")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:u,easing:"easeInOutSine",forceMs:!0})})()]),P.set(he.id,P.get(Yn)),P.set(Ei,P.get(he.IP)),await Promise.all([vt("cpu.id"),vt("cpu.MAR")]),await Promise.all([yt("cpu.id"),yt("cpu.MAR")]),await Promise.all([pi(),ye({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]),Sn=null,Fi=null;else if(jo&&jo.instruction===te){console.log("🎯 Ejecutando animación simultánea de buses para MBR→RI + IP→MAR (directo-inmediato)"),await Promise.all([(async()=>{const l=nt(),u=l.animations?Math.min(l.executionUnit,250):1;return ye([{key:"cpu.internalBus.address.path",from:vs("IP")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:u,easing:"easeInOutSine",forceMs:!0})})(),yn("MBR","ri",te,jo.mode)]),P.set(he.ri,P.get(Yn)),P.set(Ei,P.get(he.IP)),await Promise.all([vt("cpu.ri"),vt("cpu.MAR")]),await Promise.all([yt("cpu.ri"),yt("cpu.MAR")]),await Promise.all([pi(),ye({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]),jo=null,Fi=null;return}return}else{console.log("🎯 Ejecutando animación IP→MAR normal (sin transferencia simultánea)");{const l=nt(),u=l.animations?Math.min(l.executionUnit,250):1;await ye([{key:"cpu.internalBus.address.path",from:vs("IP")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:u,easing:"easeInOutSine",forceMs:!0})}await vt("cpu.MAR",Wt.blue[500]),P.set(Ei,P.get(he.IP)),await Promise.all([yt("cpu.MAR"),ye({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]),Fi=null;return}const i=e==="ri"&&(Bt==="ADD"||Bt==="SUB"||Bt==="CMP")&&qi>=5,r=e==="ri"&&(Bt==="ADD"||Bt==="SUB"||Bt==="CMP"||Bt==="AND"||Bt==="OR"||Bt==="XOR")&&!i&&(qi>=5||qi===4&&te===Bt);if(console.log("🔍 isRiToMARSimultaneous Debug:",{regNorm:e,currentInstructionName:Bt,currentExecuteStageCounter:qi,isRiToMARSimultaneous:i,isRiToMARSkipAnimation:r,mode:$e,instructionName:te}),i&&!r)if(console.log(`🔄 Detectando transferencia ri→MAR para animación simultánea (paso 8) - ${Bt}`),mc={instruction:te,mode:$e},gc&&gc.instruction===te){console.log("🎯 Ejecutando animaciones simultáneas para ri→MAR + MBR→id (paso 8)"),await Promise.all([ye([{key:"cpu.internalBus.address.path",from:vs("ri",!0,!1)},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),yn("MBR","id",te,$e)]),P.set(Ei,P.get(he.ri)),P.set(he.id,P.get(Yn)),await Promise.all([vt("cpu.MAR"),vt("cpu.id")]),await Promise.all([yt("cpu.MAR"),yt("cpu.id")]),await Promise.all([ye({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),pi()]),mc=null,gc=null;return}else{P.set(Ei,P.get(he.ri));return}if(e==="ri"&&(Bt==="ADD"||Bt==="SUB"||Bt==="CMP"||Bt==="AND"||Bt==="OR"||Bt==="XOR")&&qi===4&&$e==="mem<-imd"){console.log(`🎯 Caso especial detectado: ${Bt} [BL], n - paso 6`),console.log("🎬 Ejecutando animaciones simultáneas: BL → MAR + MBR → ID");const l=nt(),u=l.animations?Math.min(l.executionUnit,250):1;console.log("🚌 Iniciando animación del bus de direcciones BL → MAR"),console.log("📊 Iniciando animación del bus de datos MBR → ID"),await Promise.all([(async()=>{console.log("🚌 Generando path para BL → MAR usando ri");const d=vs("ri");return console.log("🚌 Path generado para BL → MAR:",d),ye([{key:"cpu.internalBus.address.path",from:d},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:u,easing:"easeInOutSine"})})(),(async()=>(console.log("📊 Ejecutando animación MBR → ID"),yn("MBR","id",te,$e)))()]),console.log("✅ Ambas animaciones completadas, actualizando registros"),P.set(Ei,P.get(he.ri)),P.set(he.id,P.get(Yn)),await Promise.all([vt("cpu.MAR"),vt("cpu.id")]),await Promise.all([yt("cpu.MAR"),yt("cpu.id")]),console.log("🧹 Reseteando animaciones de bus"),await Promise.all([ye({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),pi()]),console.log("✅ Animaciones simultáneas completadas para paso 6");return}const o=n?aw():vs(e);if(console.log("[cpu:mar.set] event.register:",t.register,"| Animación especial:",n,"| regNorm:",e,"| mode:",$e,"| instructionName:",te,"| isRiToMARSkipAnimation:",r),!(e==="IP"&&$e==="mem<-imd")&&e!=="ri"&&!(e==="ri"&&(te==="MOV"||te==="ADD"||te==="SUB"||te==="CMP")&&$e!=="mem<-imd")&&(await ye([{key:"cpu.internalBus.address.path",from:o},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),await vt("cpu.MAR",Wt.blue[500]),P.set(Ei,P.get(he[e]))),e==="ri"&&!r&&!i){if(console.log("[cpu:mar.set] ri detectado, mode:",$e,"instructionName:",te),(te==="MOV"||te==="ADD"||te==="SUB"||te==="CMP")&&$e!=="mem<-imd"){P.set(Ei,P.get(he.ri)),await vt("cpu.MAR",Wt.blue[500]),await yt("cpu.MAR");return}console.log("✅ Animando bus de direcciones: ri → MAR",{instructionName:te,mode:$e}),await Bse("ri","MAR"),await vt("cpu.MAR",Wt.blue[500]),P.set(Ei,P.get(he.ri)),await yt("cpu.MAR"),await $se();return}else e==="IP"&&$e==="mem<-imd"?(Fi={instruction:te,mode:$e},console.log("📝 Marcando animación IP → MAR como pendiente desde cpu:mar.set")):n||(await yn(e,"MAR",te,$e),await pi());!(e==="IP"&&$e==="mem<-imd")&&e!=="ri"&&await Promise.all([yt("cpu.MAR"),ye({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]);return}case"cpu:mbr.get":{Jt==="fetching-operands"?await $r(.07):await $r(.05);const e=Da(t.register);if(console.log("🎯 cpu:mbr.get - evento recibido:",{register:t.register,normalizedRegister:e,instructionName:te,mode:$e}),(te==="CALL"||te==="INT")&&e==="ri"){const s=P.get(Yn),o=P.get(he["ri.l"]);console.log(`🔍 ${te} Debug - MBR → ri:`),console.log("  📍 Registro:",e,"| Modo:",$e),console.log("  📊 MBR Value:",s.unsigned,`(0x${s.unsigned.toString(16).padStart(2,"0").toUpperCase()})`),console.log("  📋 Ri Value (antes):",o.unsigned,`(0x${o.unsigned.toString(16).padStart(2,"0").toUpperCase()})`),console.log("  🎬 willSkipAnimation:",$e!=="mem<-imd"),console.log("  ✏️ willUpdateRegister:",e==="ri"&&$e==="mem<-imd"),console.log("  🎯 willDoActivation:",e==="ri"&&$e==="mem<-imd")}e==="IP"&&(window.__nextTransferMBRtoIP=!0,(te==="RET"||te==="IRET")&&(console.log(`🎯 ${te} detectado: ejecutando animación MBR → IP inmediatamente`),await yn("MBR","IP",te,$e)));const i=["ADD","SUB","AND","OR","XOR","CMP"].some(s=>te.startsWith(s));let r=!1;if((e==="MAR"||e.startsWith("MAR."))&&!["ADD","SUB","CMP"].some(a=>te.startsWith(a))){const a=P.get(he.IP),l=P.get(Yn);a===l&&(r=!0)}if(e==="IR")await yn("MBR","IR",te,$e);else if((e==="MAR"||e.startsWith("MAR."))&&!r){console.log("Animando bus de direcciones (azul): MBR → MAR en mbr.get",{instructionName:te,mode:$e});const s=nt(),o=s.animations?s.executionUnit:1;await ye([{key:"cpu.internalBus.address.path",from:aw()},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:o,easing:"easeInOutSine",forceMs:!0})}else if(["AL","BL","CL","DL","ri","id"].includes(e)){const o=["ADD","SUB","CMP"].some(a=>te.startsWith(a));if(e==="ri"&&$e==="mem<-imd")te.startsWith("CALL")||te.startsWith("INT")?(console.log(`🎯 ${te} detectado: ejecutando animación MBR → ri inmediatamente en paso 6`),await yn("MBR","ri",te,$e)):te.startsWith("MOV")||te.startsWith("ADD")||te.startsWith("SUB")||te.startsWith("CMP")||te.startsWith("AND")||te.startsWith("OR")||te.startsWith("XOR")?(jo={instruction:te,mode:$e,destination:"ri"},console.log("📝 Marcando animación MBR → ri como pendiente para animación simultánea")):(Sn={instruction:te,mode:$e,destination:"ri"},console.log("📝 Marcando animación MBR → ri como pendiente para animación simultánea (sistema existente)"));else if(e==="id"){const a=(Bt==="ADD"||Bt==="SUB"||Bt==="CMP")&&qi>=5;if(console.log("🔍 isStep8Simultaneous Debug:",{normalizedRegister:e,currentInstructionName:Bt,currentExecuteStageCounter:qi,isStep8Simultaneous:a,mode:$e,instructionName:te}),a)if(console.log(`🔄 Detectando transferencia MBR→id para animación simultánea (paso 8) - ${Bt}`),gc={instruction:te,mode:$e},mc&&mc.instruction===te){console.log("🎯 Ejecutando animaciones simultáneas para ri→MAR + MBR→id (paso 8)"),await Promise.all([ye([{key:"cpu.internalBus.address.path",from:vs("ri",!0,!1)},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),yn("MBR","id",te,$e)]),P.set(Ei,P.get(he.ri)),P.set(he.id,P.get(Yn)),await Promise.all([vt("cpu.MAR"),vt("cpu.id")]),await Promise.all([yt("cpu.MAR"),yt("cpu.id")]),await Promise.all([ye({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),pi()]),mc=null,gc=null;return}else{P.set(he.id,P.get(Yn));return}else if(console.log("🔄 Detectando transferencia MBR→ID para animación simultánea"),Sn={instruction:te,mode:$e,destination:"id"},console.log(`📝 Guardando pendingMBRtoID desde cpu:mbr.get: ${te}, ${$e}`),Fi&&Fi.instruction===te){console.log("🎯 Ejecutando animaciones simultáneas para MBR→ID + IP→MAR desde cpu:mbr.get"),await Promise.all([yn("MBR","id",Sn.instruction,Sn.mode),(async()=>{const l=nt(),u=l.animations?Math.min(l.executionUnit,250):1;return ye([{key:"cpu.internalBus.address.path",from:vs("IP")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:u,easing:"easeInOutSine",forceMs:!0})})()]),P.set(he.id,P.get(Yn)),P.set(Ei,P.get(he.IP)),await Promise.all([vt("cpu.id"),vt("cpu.MAR")]),await Promise.all([yt("cpu.id"),yt("cpu.MAR")]),await Promise.all([pi(),ye({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]),Sn=null,Fi=null;return}else{P.set(he.id,P.get(Yn));return}}else(!i||o)&&(e==="ri"&&$e!=="mem<-imd"&&(te==="MOV"||te==="ADD"||te==="SUB"||te==="CMP")?(console.log("📘 Animación de direcciones (mbr.get directo): MBR → MAR (bus azul)"),await ye([{key:"cpu.internalBus.address.path",from:aw()},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),await ye({key:"cpu.internalBus.address.opacity",to:0},{duration:100,easing:"easeInSine",forceMs:!0}),console.log("⏭️ Omitiendo animación de datos MBR → ri en direccionamiento directo (mbr.get)")):e==="ri"&&$e!=="mem<-imd"?console.log("⏭️ Omitiendo animación MBR → ri para direccionamiento directo"):await yn("MBR",e,te,$e))}if((!(e==="ri"&&$e==="mem<-imd")||te==="CALL"||te==="INT")&&(P.set(he[t.register],P.get(Yn)),(te==="CALL"||te==="INT")&&e==="ri")){const s=P.get(he[t.register]);console.log(`🔥 ${te} - Registro ri actualizado:`,s.unsigned,`(0x${s.unsigned.toString(16).padStart(2,"0").toUpperCase()})`)}if(e==="IR")await Ad(`cpu.${e}`);else if(e==="IP"){if(te==="RET"||te==="INT"){console.log(`🎯 ${te} detectado: mostrando animación MBR → IP`);try{await yn("MBR","IP",te,$e),await vt("cpu.IP"),await yt("cpu.IP")}catch(s){console.error(`❌ Error en animación MBR → IP para ${te}:`,s)}}}else(!(e==="ri"&&$e==="mem<-imd")||te==="CALL"||te==="INT")&&(await vt(`cpu.${e}`),await yt(`cpu.${e}`));if((!(e==="ri"&&$e==="mem<-imd")||te==="CALL"||te==="INT"||te==="RET")&&await pi(),Jt==="fetching-operands"&&e!=="IR"){const s=te&&(te==="MOV"||te==="ADD"||te==="SUB"||te==="CMP"||te==="AND"||te==="OR"||te==="XOR");(s&&e==="MBR"||!s&&e!=="MBR")&&(Jt="fetching-operands-completed",console.log("✅ Fase 'fetch-operands' completada al escribir en",e),P.set(Hn,a=>"metadata"in a?{...a,phase:"fetching-operands-completed"}:a))}return}case"cpu:mbr.set":{$r(.05),Jt==="writeback"&&ye({key:"sequencer.progress.progress",to:.9},{duration:200,easing:"easeInOutSine",forceMs:!0});const e=Da(t.register);if(te==="MOV"&&["AL","BL","CL","DL","AH","BH","CH","DH"].includes(e)&&qi===5){console.log(`🎯 cpu:mbr.set: Registrando paso 7 para ${te} [memoria], ${e}`),console.log(`📊 Estado antes: executeStageCounter=${qi}, register=${t.register}`),qi++,console.log(`📊 Execute Stage Counter incrementado a: ${qi} (Paso 7)`);const i=P.get(Tt);console.log("🔍 Estado de simulación:",i),i.type==="running"&&i.until==="cycle-change"&&(console.log("⏸️ Pausando simulación después del paso 7 (cpu:mbr.set) - ejecución por ciclo"),setTimeout(()=>{$t()},100))}else console.log(`ℹ️ No se activó contabilización paso 7: instructionName=${te}, register=${e}, executeStageCounter=${qi}`);if((te==="CALL"||te==="INT")&&e==="IP")console.log(`🎯 ${te} detectado: ejecutando animación IP → MBR inmediatamente`),await yn("IP","MBR",te,$e),P.set(Yn,P.get(he[t.register])),await pi();else if(e==="IP")await g3();else{const i=t.register.replace(/\.(l|h)$/,"");console.log(`🔍 Animación MBR.set: ${i} → MBR para ${te}`),console.log(`🔍 Event.register original: ${t.register}`),console.log(`🔍 Normalized source: ${i}`),await yn(i,"MBR",te,$e),P.set(Yn,P.get(he[t.register])),await pi()}return}case"cpu:register.copy":{const e=Da(t.src),n=Da(t.dest);if(console.log(`🔄 cpu:register.copy: ${t.src} → ${t.dest} (normalizado: ${e} → ${n})`),(n==="left"||n==="right")&&Jt==="executing"?await $r(.1):n==="result"&&Jt==="writeback"?await $r(.15):(e==="MBR"||e==="ri")&&Jt==="fetching-operands"?await $r(.08):await $r(.05),(n==="left"||n==="right")&&(te==="ADD"&&$e==="mem<-imd")){if(console.log(`🎯 Detectando preparación de operando ALU: ${e} → ${n} para ${te}`),e==="ri"&&n==="right"){console.log("📋 Animación ALU: Valor inmediato (ri) → operando derecho ALU"),await Promise.all([yn("ri","right",te,$e),ye([{key:"cpu.internalBus.address.path",from:vs("ri")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0})]),P.set(he.right,P.get(he[e])),await Promise.all([vt("cpu.right"),vt("cpu.MAR")]),await Promise.all([yt("cpu.right"),yt("cpu.MAR")]),await Promise.all([pi(),ye({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]);return}else if(e==="id"&&n==="left"){console.log("📋 Animación ALU: Valor de memoria (id) → operando izquierdo ALU"),await Promise.all([yn("id","left",te,$e),yn("MBR","id",te,$e)]),P.set(he.left,P.get(he[e])),await Promise.all([vt("cpu.left"),vt("cpu.id")]),await Promise.all([yt("cpu.left"),yt("cpu.id")]),await pi();return}}if(n==="left"||n==="right"){const r={from:e,instruction:te,mode:$e};if(n==="left"?_c=r:n==="right"&&(Cc=r),_c&&Cc&&_c.from===Cc.from&&_c.instruction===Cc.instruction){await Fse(e,te,$e);return}n==="left"?P.set(he.left,P.get(he[e])):P.set(he.right,P.get(he[e]));return}if(e==="MBR"&&(n==="id"||n==="ri")||e==="IP"&&n==="MAR"){if(console.log(`🔄 Detectando transferencia para animación simultánea: ${e} → ${n}`),e==="MBR"&&(n==="id"||n==="ri")?(Sn={instruction:te,mode:$e,destination:n},console.log(`📝 Guardando pendingMBRtoID: ${te}, ${$e}, destino: ${n}`)):e==="IP"&&n==="MAR"&&(Fi={instruction:te,mode:$e},console.log(`📝 Guardando pendingIPtoMARFromRegCopy: ${te}, ${$e}`)),Sn&&Fi&&Sn.instruction===Fi.instruction){const r=Sn.destination;console.log(`🎯 Ejecutando animaciones simultáneas para MBR→${r} + IP→MAR`),await Promise.all([yn("MBR",r,Sn.instruction,Sn.mode),(async()=>{const o=nt(),l=o.animations?Math.min(o.executionUnit,250):1;return ye([{key:"cpu.internalBus.address.path",from:vs("IP")},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:l,easing:"easeInOutSine",forceMs:!0})})(),ye({key:"cpu.alu.cog.rot",to:6},{duration:3,easing:"easeInOutCubic"})]),r==="id"?P.set(he.id,P.get(he.MBR)):r==="ri"&&P.set(he.ri,P.get(he.MBR)),P.set(Ei,P.get(he.IP));const s=r==="id"?"cpu.id":"cpu.ri";await Promise.all([vt(s),vt("cpu.MAR")]),await Promise.all([yt(s),yt("cpu.MAR")]),await Promise.all([pi(),ye({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),ye({key:"cpu.alu.cog.rot",to:0},{duration:1,easing:"easeInOutSine"})]),Sn=null,Fi=null;return}e==="MBR"&&n==="id"?P.set(he.id,P.get(he.MBR)):e==="MBR"&&n==="ri"?P.set(he.ri,P.get(he.MBR)):e==="IP"&&n==="MAR"&&P.set(Ei,P.get(he.IP));return}e==="ri"&&n==="IP"?te==="CALL"?(console.log("🎯 Animando ri → IP para instrucción CALL"),await yn("ri","IP",te,$e)):["JMP","JZ","JNZ","JC","JNC","JS","JNS","JO","JNO"].includes(te)?(console.log(`🎯 Animando MBR → IP para instrucción de salto: ${te}`),await yn("MBR","IP",te,$e)):console.log("⚠️  Saltando animación para transferencia ri → IP"):(console.log(`🎯 Ejecutando drawDataPath para transferencia normal: ${e} → ${n}`),await yn(e,n,te,$e)),await vt(`cpu.${n}`),P.set(he[n],P.get(he[e])),await yt(`cpu.${n}`),await pi();return}case"cpu:register.update":{$r(.05);const[e]=z2(t.register),n=Da(e);if(n==="IP"||n==="MBR")await g3();else if(n==="SP"){await Ad("cpu.SP");let i="+1";switch(Bt){case"PUSH":case"CALL":case"INT":i="-1";break;case"RET":case"IRET":case"POP":i="+1";break;default:i="+1";break}window.dispatchEvent(new CustomEvent("sp-register-update",{detail:{type:i}}))}else await Ad(n==="ri"?"cpu.ri":`cpu.${n}`);P.set(he[t.register],t.value);return}case"cpu:register.buscopy":{const e=Da(t.src),n=Da(t.dest);e==="ri"&&n.toLowerCase()==="mar"||e==="ri"&&n==="IP"||(await yn(e,n,te,$e),await new Promise(i=>setTimeout(i,150))),P.set(he[n],P.get(he[e])),await vt(`cpu.${n}`),await yt(`cpu.${n}`),n!=="ri"&&await pi();return}default:return t}}const zse=Object.freeze(Object.defineProperty({__proto__:null,getCurrentExecuteStageCounter:Ose,handleCPUEvent:$k,updateInstructionContext:Lse},Symbol.toStringTag,{value:"Module"}));async function Use(t){switch(t.type){case"f10:press":await Di("bus.int0",2),await ri("bus.int0");return;default:return t.type}}const WE=pe(H.zero(8)),GE=pe(H.zero(8));function Vse(t){t.io.handshake&&(P.set(WE,H.fromUnsigned(t.io.handshake.DATA,8)),P.set(GE,H.fromUnsigned(t.io.handshake.STATE,8)))}async function Hse(t){switch(t.type){case"handshake:read":return;case"handshake:read.ok":{await hf(t.value);return}case"handshake:write":case"handshake:register.update":{switch(await vt(`handshake.${t.register}`),t.register){case"DATA":{P.set(WE,t.value);break}case"STATE":{P.set(GE,t.value);break}default:return t.register}await yt(`handshake.${t.register}`);return}case"handshake:write.ok":return;case"handshake:int.off":{await ri("bus.int2");return}case"handshake:int.on":{await Di("bus.int2",10);return}default:return t}}async function Wse(t){switch(t.type){case"keyboard:listen-key":{const e=nt().language,n=of(e,"messages.keyboard-input-required"),i=of(e,"messages.keyboard-input-description");gi({title:n,description:i,variant:"info",duration:5e3}),P.set(Tt,r=>r.type!=="running"||r.waitingForInput?r:{...r,waitingForInput:!0}),await new Promise(r=>{P.sub(Tt,()=>{const s=P.get(Tt);(s.type!=="running"||!s.waitingForInput)&&r()})});return}case"keyboard:read":return;default:return t}}const qE=pe(H.zero(8));function Gse(t){t.io.leds!==null&&P.set(qE,H.fromUnsigned(t.io.leds,8))}async function qse(t){switch(t.type){case"leds:update":{await Di("bus.pio->leds",2),P.set(qE,t.state),await ri("bus.pio->leds");return}default:return t.type}}const _y=pe(!1),Cy=pe(!1);function Kse(t){return t==="memory-to-mbr"?"M 800 249 L 645 249 L 645 222 L 615 222 L 615 233":"M 615 274 L 615 285 L 645 285 L 645 249 L 800 249"}const v3=(t,e)=>{try{const n=Kse(t);if(!n)return console.warn("❌ No se generó path para drawExternalDataPath"),Promise.resolve();const i=nt(),s=Math.min(i.executionUnit,250),o=e??(i.animations?s:1);return ye([{key:"bus.data.path",from:n},{key:"bus.data.opacity",from:1},{key:"bus.data.strokeDashoffset",from:1,to:0}],{duration:o,easing:"easeInOutSine",forceMs:!0})}catch(n){return console.warn("Error en drawExternalDataPath:",n),Promise.resolve()}},y3=()=>ye({key:"bus.data.opacity",to:0},{duration:1,easing:"easeInSine"});function Xse(){return"M 635 349 H 800"}const lw=t=>{try{const e=Xse(),n=nt(),r=Math.min(n.executionUnit,250),s=t??(n.animations?r:1);return ye([{key:"bus.address.path",from:e},{key:"bus.address.opacity",from:1},{key:"bus.address.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0})}catch(e){return console.warn("Error en drawExternalAddressPath:",e),Promise.resolve()}},cw=()=>ye({key:"bus.address.opacity",to:0},{duration:1,easing:"easeInSine"}),b3=t=>{try{const e="M 380 420 H 800",n=nt(),r=Math.min(n.executionUnit,250),s=t??(n.animations?r:1);return ye([{key:"bus.rd.path",from:e},{key:"bus.rd.opacity",from:1},{key:"bus.rd.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0})}catch(e){return console.warn("Error en drawRDControlPath:",e),Promise.resolve()}},Yse=t=>{try{const e="M 380 440 H 800",n=nt(),r=Math.min(n.executionUnit,250),s=t??(n.animations?r:1);return ye([{key:"bus.wr.path",from:e},{key:"bus.wr.opacity",from:1},{key:"bus.wr.strokeDashoffset",from:1,to:0}],{duration:s,easing:"easeInOutSine",forceMs:!0})}catch(e){return console.warn("Error en drawWRControlPath:",e),Promise.resolve()}},x3=()=>ye({key:"bus.rd.opacity",to:0},{duration:1,easing:"easeInSine"}),w3=()=>ye({key:"bus.wr.opacity",to:0},{duration:1,easing:"easeInSine"});async function S3(t){switch(typeof window<"u"&&window.VONSIM_PARALLEL_ANIMATIONS&&window.addEventListener("vonsim:parallel-memory-read-visual",()=>{P.set(_y,!0),ye([{key:"bus.address.opacity",to:.7},{key:"bus.rd.opacity",to:.7}],{duration:.15,easing:"easeOutQuad"}).then(()=>{ye([{key:"bus.address.opacity",to:1},{key:"bus.rd.opacity",to:1}],{duration:.15,easing:"easeInQuad"})}),Promise.all([lw(),(async()=>{Ok(),await b3(),Lk()})()])}),t.type){case"memory:read":{window.VONSIM_PARALLEL_ANIMATIONS||(P.set(_y,!0),ye([{key:"bus.address.opacity",to:.7},{key:"bus.rd.opacity",to:.7}],{duration:.15,easing:"easeOutQuad"}).then(()=>{ye([{key:"bus.address.opacity",to:1},{key:"bus.rd.opacity",to:1}],{duration:.15,easing:"easeInQuad"})}),await Promise.all([lw(),(async()=>{Ok(),await b3(),Lk()})()]),await cw());return}case"memory:read.ok":{P.set(Up,Pe.from(t.address)),await ye({key:"memory.operating-cell.color",to:Wt.mantis[400]},{duration:1,easing:"easeOutQuart"}),await v3("memory-to-mbr"),P.set(Yn,t.value),await Promise.all([ye({key:"memory.operating-cell.color",to:Wt.white},{duration:1,easing:"easeOutQuart"}),y3(),cw(),x3(),w3()]);return}case"memory:write":{P.set(Cy,!0),WB(),await Promise.all([lw(),Yse()]),GB(),P.set(Cy,!1);return}case"memory:write.ok":{P.set(Up,Pe.from(t.address)),await vt("cpu.MBR"),await v3("mbr-to-memory"),await ye({key:"memory.operating-cell.color",to:Wt.mantis[400]},{duration:1,easing:"easeOutQuart"}),P.set(ly,e=>[...e.slice(0,t.address.value),t.value,...e.slice(t.address.value+1)]),P.set(cy,e=>{const n=new Set(e);return n.add(t.address.value),n}),setTimeout(()=>{P.set(cy,e=>{const n=new Set(e);return n.delete(t.address.value),n})},3e3),await Promise.all([yt("cpu.MBR"),ye({key:"memory.operating-cell.color",to:Wt.white},{duration:1,easing:"easeOutQuart"}),y3(),cw(),x3(),w3()]);return}case"memory:read.error":case"memory:write.error":{Jr(t.error);return}case"memory:write.warning":{Pd("Advertencia de Memoria",`${t.warning}`);return}default:return t}}const KE=pe(H.fromUnsigned(255,8)),XE=pe(H.fromUnsigned(0,8)),YE=pe(H.fromUnsigned(0,8)),Ey=[pe(H.zero(8)),pe(H.zero(8)),pe(H.zero(8)),pe(H.zero(8)),pe(H.zero(8)),pe(H.zero(8)),pe(H.zero(8)),pe(H.zero(8))];function Jse(t){if(t.io.pic){P.set(KE,H.fromUnsigned(t.io.pic.IMR,8)),P.set(XE,H.fromUnsigned(t.io.pic.IRR,8)),P.set(YE,H.fromUnsigned(t.io.pic.ISR,8));for(let e=0;e<Ey.length;e++)P.set(Ey[e],H.fromUnsigned(t.io.pic.lines[e],8))}}async function Zse(t){switch(t.type){case"pic:read":return;case"pic:read.ok":{await hf(t.value);return}case"pic:write":return;case"pic:register.update":{switch(await vt(`pic.${t.register}`),t.register){case"IMR":{P.set(KE,t.value);break}case"IRR":{P.set(XE,t.value);break}case"ISR":{P.set(YE,t.value);break}case"INT0":case"INT1":case"INT2":case"INT3":case"INT4":case"INT5":case"INT6":case"INT7":{const e=Number(t.register.slice(3));P.set(Ey[e],t.value);break}default:return t}await yt(`pic.${t.register}`);return}case"pic:write.ok":return;case"pic:intr.off":{await ri("bus.intr");return}case"pic:intr.on":{await Di("bus.intr",10);return}case"pic:int.send":{await hf(t.number);return}default:return t}}const JE=pe(H.zero(8)),ZE=pe(H.zero(8)),QE=pe(H.zero(8)),eA=pe(H.zero(8));function Qse(t){t.io.pio&&(P.set(JE,H.fromUnsigned(t.io.pio.PA,8)),P.set(ZE,H.fromUnsigned(t.io.pio.PB,8)),P.set(QE,H.fromUnsigned(t.io.pio.CA,8)),P.set(eA,H.fromUnsigned(t.io.pio.CB,8)))}async function eoe(t){switch(t.type){case"pio:read":return;case"pio:read.ok":{await hf(t.value);return}case"pio:write":return;case"pio:register.update":{switch(await vt(`pio.${t.register}`),t.register){case"PA":{P.set(JE,t.value);break}case"PB":{P.set(ZE,t.value);break}case"CA":{P.set(QE,t.value);break}case"CB":{P.set(eA,t.value);break}default:return t.register}await yt(`pio.${t.register}`);return}case"pio:write.ok":return;default:return t}}const Ay=pe([]),Py=pe("");function toe(t){t.io.printer&&(P.set(Ay,t.io.printer.buffer.map(e=>H.fromUnsigned(e,8))),P.set(Py,t.io.printer.paper))}async function noe(t){switch(t.type){case"printer:buffer.add":{P.set(Ay,e=>[...e,t.char]);return}case"printer:buffer.pop":{P.set(Ay,e=>e.slice(1));return}case"printer:busy.off":{await ri("bus.printer.busy");return}case"printer:busy.on":{await Di("bus.printer.busy",15);return}case"printer:data.read":{await Di("bus.printer.data",15),await ri("bus.printer.data");return}case"printer:paper.print":{P.set(Py,e=>e+t.char);return}case"printer:paper.replace":{P.set(Py,"");return}case"printer:strobe.off":{await ri("bus.printer.strobe");return}case"printer:strobe.on":{await Di("bus.printer.strobe",15);return}default:return t}}const tA=pe("");function ioe(t){"screen"in t.io&&t.io.screen!==null&&P.set(tA,t.io.screen)}async function roe(t){switch(t.type){case"screen:send-char":{P.set(tA,t.output);return}default:return t.type}}const n1=pe(H.zero(8));function soe(t){t.io.switches!==null&&P.set(n1,H.fromUnsigned(t.io.switches,8))}async function ooe(t){switch(t.type){case"switches:toggle":{P.set(n1,e=>e.withBit(t.index,!e.bit(t.index))),await Di("bus.switches->pio",2),await ri("bus.switches->pio");return}default:return t}}const Ny=pe(H.zero(8)),nA=pe(H.zero(8));function aoe(t){t.io.timer&&(P.set(Ny,H.fromUnsigned(t.io.timer.CONT,8)),P.set(nA,H.fromUnsigned(t.io.timer.COMP,8)))}async function loe(t){switch(t.type){case"timer:read":return;case"timer:read.ok":{await hf(t.value);return}case"timer:write":return;case"timer:register.update":{switch(await vt(`timer.${t.register}`),t.register){case"CONT":{P.set(Ny,t.value);break}case"COMP":{P.set(nA,t.value);break}default:return t.register}await yt(`timer.${t.register}`);return}case"timer:write.ok":return;case"timer:int.off":{await ri("bus.int1");return}case"timer:int.on":{await Di("bus.int1",10);return}case"timer:tick":{P.set(Ny,t.cont),await Di("bus.int1",2),await ri("bus.int1");return}default:return t}}const Fk=new Set;async function uw(t){P.get(na).canAnimate||await new Promise(n=>{const i=P.sub(na,()=>{P.get(na).canAnimate&&(i(),n())})}),await t()}async function QB(t){uoe(t);const[e]=t.type.split(":",2);Fk.add(t.type);const i=["cpu:mar.set","cpu:register.update","cpu:mbr.get","cpu:mbr.set","cpu:register.buscopy","cpu:register.copy","memory:read","memory:write"].includes(t.type);try{switch(e){case"bus":{i?await uw(()=>m3(t)):await m3(t);break}case"clock":{await Ise(t);break}case"cpu":{i?await uw(()=>$k(t)):await $k(t);break}case"f10":{await Use(t);break}case"handshake":{await Hse(t);break}case"keyboard":{await Wse(t);break}case"leds":{await qse(t);break}case"memory":{i?await uw(()=>S3(t)):await S3(t);break}case"pic":{await Zse(t);break}case"pio":{await eoe(t);break}case"printer":{await noe(t);break}case"screen":{await roe(t);break}case"switches":{await ooe(t);break}case"timer":{await loe(t);break}default:return e}}finally{Fk.delete(t.type)}}function k3(...t){for(const e of t)if(Fk.has(e))return!0;return!1}const coe={bus:"#2563eb",clock:"#65a30d",cpu:"#dc2626",f10:"#65a30d",handshake:"#2563eb",keyboard:"#65a30d",leds:"#65a30d",memory:"#f59e0b",pic:"#2563eb",pio:"#2563eb",printer:"#65a30d",screen:"#65a30d",switches:"#65a30d",timer:"#2563eb"};function uoe(t){const[e,n]=t.type.split(":",2);console.group(`%c ${e} %c ${n}`,`background: ${coe[e]}; color: #fff; font-weight: bold;`,"background: unset; color: unset; font-weight: normal;");for(const i in t)if(i!=="type"&&Object.prototype.hasOwnProperty.call(t,i)){const r=t[i];r instanceof H?console.log(`${i}: %c${r.toString("hex")}h %c(Byte)`,"color: #8b5cf6;","color: #737373;"):r instanceof Pe?console.log(`${i}: %c${r.toString()} %c(MemoryAddress)`,"color: #8b5cf6;","color: #737373;"):r instanceof Or?console.log(`${i}: %c${r.toString()} %c(IOAddress)`,"color: #8b5cf6;","color: #737373;"):typeof r=="number"?console.log(`${i}: %c${r.toString(16)}h %c(number)`,"color: #8b5cf6;","color: #737373;"):typeof r=="string"?console.log(`${i}: %c"${r}" %c(string)`,"color: #f97316;","color: #737373;"):typeof r=="boolean"?console.log(`${i}: %c${r}`,"color: #06b6d4;"):r===null?console.log(`${i}: %cnull`,"color: #b91c1c;"):console.log(`${i}:`,r)}console.groupEnd()}const An=new _Q;typeof window<"u"&&(window.addEventListener("pioActivated",t=>{const{address:e,registerName:n,shouldReload:i}=t.detail;i&&(console.log(`🔄 Recargando programa debido a activación automática del PIO (${n} - ${e.toString(16).toUpperCase()}h)`),P.get(Tt).type==="running"&&Jr(),setTimeout(()=>{Mh("cpu.run","infinity")},100))}),window.addEventListener("handshakeActivated",t=>{const{address:e,registerName:n,shouldReload:i}=t.detail;i&&(console.log(`🔄 Recargando programa debido a activación automática de la impresora con Handshake (${n} - ${e.toString(16).toUpperCase()}h)`),P.get(Tt).type==="running"&&Jr(),setTimeout(()=>{Mh("cpu.run","infinity")},100))}),window.addEventListener("picActivated",t=>{const{address:e,registerName:n,shouldReload:i}=t.detail;i&&(console.log(`🔄 Recargando programa debido a activación automática del PIC (${n} - ${e.toString(16).toUpperCase()}h)`),P.get(Tt).type==="running"&&Jr(),setTimeout(()=>{Mh("cpu.run","infinity")},100))}),window.addEventListener("programModified",t=>{const{shouldReload:e,until:n}=t.detail;e&&(console.log("🔄 Recargando programa debido a modificación del código"),P.set(go,!1),P.get(Tt).type==="running"&&Jr(),setTimeout(()=>{Mh("cpu.run",n)},100))}));const Tt=pe({type:"stopped"}),go=pe(!1);let su=null;try{window.VonSimAddNotification&&(su=window.VonSimAddNotification)}catch{}function iA(t,e=10){window.VonSimAddNotification?window.VonSimAddNotification(t):e>0&&setTimeout(()=>iA(t,e-1),100)}function doe(t){const e=t.translate(nt().language);gi({title:e,variant:"error"}),su?su({type:"error",title:"Error de simulación",message:e}):iA({type:"error",title:"Error de simulación",message:e})}function Pd(t,e){gi({title:t,description:e,variant:"info"}),su&&su({type:"warning",title:t,message:e})}function Jr(t){if(Nh=!1,zk.clear(),console.log("🧹 [DEBUG] Hilos activos limpiados"),t&&(doe(t),t.code==="no-instruction")){P.set(Tt,{type:"paused"});return}Cne(),R6(null),wne(!1),P.set(Tt,{type:"stopped",error:t}),P.set(Hn,{phase:"stopped",error:t}),HE(),P.set(go,!1),console.log("✅ [DEBUG] Simulación finalizada - todos los hilos y procesos limpiados")}function $t(){P.set(Tt,{type:"paused"}),UB()}function foe(){const t=of(nt().language,"messages.assemble-error");gi({title:t,variant:"error"}),su?su({type:"error",title:"Error de ensamblado",message:t}):iA({type:"error",title:"Error de ensamblado",message:t})}function Cu(){gi({title:of(nt().language,"messages.invalid-action"),variant:"error"})}function _3(t,e=!1){n8(t,e),NQ(t,e),Vse(t),Jse(t),Qse(t),aoe(t),Gse(t),toe(t),ioe(t),soe(t),dt=0,sa=0,zr=0,Z=0,P.set(af,dt),P.set(Bl,sa),P.set(Je,""),e&&(P.set(ws,[]),P.set(go,!1)),P.set(zp,0)}let M=null,zr=0,Z=0,pt="",Eu=!0,at=!1,Ke=!1,fe=[],dt=0,ze=0,sa=0,Au="",C3="",E3="",gs=!1,Jg=!1,Zg="",e$="",vc=!1,yc="",Qg=!1,Pu=!1,e0=!1;function hoe(t){return t.modeId&&t.modeRi?"directo-inmediato":t.modeId?"inmediato":t.modeRi?"directo":"registro"}function t0(t){if(t.length!==2)return!1;const[e,n]=t,i=/^[A-D][LH]$/.test(e)||/^[A-D]X$/.test(e),r=n.startsWith("[")&&n.endsWith("]");return i&&r}function poe(t,e){const{name:n,modeId:i,modeRi:r,executeStage:s}=e;return n==="MOV"&&i&&r?moe(t,s):n==="MOV"&&r&&!i?goe(t,s):n==="MOV"&&i&&!r?voe(t):n==="INT"?boe(t,s,r):n==="CALL"?xoe(t):["ADD","SUB","CMP","AND","OR","XOR"].includes(n)&&r&&!i?yoe(t,s):["ADD","SUB","CMP","AND","OR","XOR"].includes(n)&&t==="ri"?s===5?{message:"",shouldDisplay:!1,shouldPause:!1}:{message:"Ejecución: MAR ← MBR",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function moe(t,e){switch(e){case 2:return{message:"Ejecución: MAR ← IP",shouldDisplay:!0,shouldPause:!0};case 4:return{message:"Ejecución: ri ← MBR; MAR ← IP",shouldDisplay:!0,shouldPause:!0};case 5:return{message:"Ejecución: MAR ← IP | ri ← MBR",shouldDisplay:!0,shouldPause:!0};default:return{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}}function goe(t,e){return e===2?{message:"Ejecución: MAR ← IP",shouldDisplay:!0,shouldPause:!0}:e===4&&t==="ri"?{message:"Ejecución: MAR ← MBR",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function voe(t){return t==="ri"?{message:"Ejecución: MAR ← MBR",shouldDisplay:!0,shouldPause:!0}:t==="IP"?{message:"Ejecución: MAR ← IP",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function yoe(t,e){return e===2?{message:"Ejecución: MAR ← IP",shouldDisplay:!0,shouldPause:!0}:e===4&&t==="ri"?{message:"Ejecución: MAR ← MBR",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function boe(t,e,n){return e===2&&t==="IP"?{message:"Ejecución: MAR ← IP",shouldDisplay:!0,shouldPause:!0}:e===2&&n?{message:"Ejecución: ri ← MBR; MAR ← SP",shouldDisplay:!0,shouldPause:!0}:e===5&&t==="SP"?{message:"Ejecución: MAR ← SP | MBR ← FLAGS",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function xoe(t){return{message:`Ejecución: MAR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function woe(t,e){const{name:n,modeId:i,modeRi:r,executeStage:s}=e;return t==="SP"?Soe(n,s,r):t==="FLAGS"?koe(n,s,r):n==="INT"?_oe(t):n==="MOV"&&i&&r&&fe&&fe.length===2&&/^\[[A-Z]{2}\]$/i.test(fe[0])&&/^[0-9A-F]+h?$/i.test(fe[1])&&(s===4||s===5)?{message:"",shouldDisplay:!1,shouldPause:!1}:n==="MOV"&&i&&r?Coe():n==="MOV"&&r&&!i?Eoe():["ADD","SUB","CMP","AND","OR","XOR"].includes(n)&&r&&!i?Aoe():n==="CALL"?Poe(t):t==="IP"&&r&&!i&&s===3?{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MBR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function Soe(t,e,n){if(n&&e===4&&t==="INT")return{message:"",shouldDisplay:!1,shouldPause:!1};switch(t){case"PUSH":return{message:"Ejecución: SP = SP - 1",shouldDisplay:!0,shouldPause:!0};case"RET":return e===3?{message:"Ejecución: IP ← MBR | SP ← SP + 1",shouldDisplay:!0,shouldPause:!1}:{message:"Ejecución: SP = SP + 1",shouldDisplay:!0,shouldPause:!1};case"IRET":return e===3?{message:"Ejecución: IP ← MBR | SP ← SP + 1",shouldDisplay:!0,shouldPause:!0}:{message:"Ejecución: SP = SP + 1",shouldDisplay:!0,shouldPause:!0};case"POP":if(e===3)return{message:`${e$}; SP = SP + 1`,shouldDisplay:!0,shouldPause:!0};break}return{message:"",shouldDisplay:!1,shouldPause:!1}}function koe(t,e,n){return n&&e===5&&t==="INT"?{message:"Ejecución: write(Memoria[MAR]) ← MBR; SP ← SP - 1; update(Flags I=0)",shouldDisplay:!0,shouldPause:!0}:{message:"Ejecución: update(Flags I=0)",shouldDisplay:!0,shouldPause:!0}}function _oe(t){switch(t){case"IP":if(Z===3)return{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0};break;case"DL":return{message:"Interrupción: AL ← ASCII",shouldDisplay:!0,shouldPause:!0};case"right.l":return{message:"Interrupción: SUB AL, 1",shouldDisplay:!0,shouldPause:!0};case"right":return{message:"Interrupción: ADD BL, 1",shouldDisplay:!0,shouldPause:!0}}return{message:`Ejecución: MBR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function Coe(){return M==="MOV"&&fe&&fe.length===2&&/^\[[A-Z]{2}\]$/i.test(fe[0])&&/^[0-9A-F]+h?$/i.test(fe[1])&&(Z===4||Z===5)?{message:"",shouldDisplay:!1,shouldPause:!1}:{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0}}function Eoe(){return{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0}}function Aoe(){return{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0}}function Poe(t){return Z===3&&t==="IP"?{message:"Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",shouldDisplay:!0,shouldPause:!0}:{message:`Ejecución: MBR ← ${t}`,shouldDisplay:!0,shouldPause:!0}}function A3(){return{name:M||"",modeId:at,modeRi:Ke,executeStage:Z,cycleCount:ze}}function P3(t,e,n,i){const r=hoe(n);console.log(`🔍 [${t}] Registro: ${e}`),console.log(`   Instrucción: ${n.name}`),console.log(`   Modo de direccionamiento: ${r}`),console.log(`   Etapa de ejecución: ${n.executeStage}`),console.log(`   Ciclo: ${n.cycleCount}`),console.log(`   Mensaje: ${i.message}`),console.log(`   Mostrar: ${i.shouldDisplay}`),console.log(`   Pausar: ${i.shouldPause}`),console.log("---")}function N3(t){return t.name?t.executeStage<0?(console.warn("⚠️ Etapa de ejecución inválida:",t.executeStage),!1):!0:(console.warn("⚠️ Contexto de instrucción sin nombre"),!1)}const zk=new Set;let Nh=!1;async function Fu(t,e=!1){if(Nh&&t!==An.startCPU()&&!e){console.log("🔒 [DEBUG] Hilo secundario bloqueado - CPU principal activo");return}const n=!Nh&&t===An.startCPU();n?(Nh=!0,console.log("🎯 [DEBUG] Iniciando hilo principal del CPU")):e&&console.log("🕐 [DEBUG] Iniciando hilo concurrente del reloj");const i=Noe(t);zk.add(i);try{await i}finally{zk.delete(i),n&&(Nh=!1,console.log("✅ [DEBUG] Hilo principal del CPU terminado"))}}async function Noe(t){try{let e=0;const n=1e4;for(;;){if(e++,e>n){console.error("❌ [DEBUG] Bucle infinito detectado - demasiadas iteraciones:",e),Jr();return}const i=P.get(Tt),r=P.get(Zp);if(console.log(`🔄 [DEBUG] Iteración ${e} - Estado:`,{status:i.type,programModified:r,executeStageCounter:Z,currentInstructionName:M}),r){if(console.log("🔄 Programa modificado - disparando evento de recarga automática"),typeof window<"u"){const a=new CustomEvent("programModified",{detail:{shouldReload:!0,until:i.type==="running"?i.until:"infinity"}});window.dispatchEvent(a)}zr=0,Z=0,Jr();return}if(i.type==="stopped"){zr=0,Z=0,pt="",console.log("✅ [DEBUG] Simulación detenida, saliendo de startThread");return}if(i.type==="paused"){await new Promise(a=>{const l=P.sub(Tt,()=>{l(),a()})});continue}console.log("🔄 [DEBUG] Obteniendo siguiente evento del generador...");const s=t.next();if(console.log("📋 [DEBUG] Evento obtenido:",{done:s.done,type:s.value?s.value.type:void 0,hasValue:!!s.value}),s.done){console.log("✅ [DEBUG] Generador terminado, saliendo del bucle");return}if(s.value&&typeof s.value<"u"){const a=s.value.type;console.log("🎯 [DEBUG] Procesando evento:",{type:a,executeStageCounter:Z,currentInstructionName:M,isTraceEvent:a==null?void 0:a.includes("trace"),isPrinterEvent:a==null?void 0:a.includes("printer"),isPioEvent:a==null?void 0:a.includes("pio")});try{console.log("📥 [DEBUG] Importando funciones de events.ts...");const l=await $p(()=>Promise.resolve().then(()=>zse),void 0);console.log("✅ [DEBUG] Módulo events.ts importado correctamente");const{updateInstructionContext:c,getCurrentExecuteStageCounter:u}=l;if(typeof c!="function")throw new Error("updateInstructionContext no es una función");if(typeof u!="function")throw new Error("getCurrentExecuteStageCounter no es una función");if(console.log("🔄 [DEBUG] Actualizando contexto de instrucción..."),c(Z,M||""),console.log("✅ [DEBUG] Contexto actualizado correctamente"),a==="cpu:register.update"&&M==="INT"&&Z===11&&s.value.register==="ri.l"){console.log("⏭️ [DEBUG] Omitiendo evento cpu:register.update (ri.l) en INT paso 11 - registro ya actualizado");continue}if(a==="cpu:register.copy"&&M==="INT"&&Z===11&&s.value.src==="ri.l"&&s.value.dest==="IP.l"){console.log("⏭️ [DEBUG] Omitiendo evento cpu:register.copy (ri → IP) en INT paso 11 - el valor va directamente a MAR");continue}console.log("🎯 [DEBUG] Llamando a handleEvent...");const d=performance.now();s.value.type.startsWith("clock:")&&console.log("🕐 [DEBUG] Procesando evento del reloj:",s.value);const f=QB(s.value),p=new Promise((g,y)=>{setTimeout(()=>y(new Error(`Timeout procesando evento: ${a}`)),1e4)});await Promise.race([f,p]);const m=performance.now();console.log(`✅ [DEBUG] handleEvent completado en ${(m-d).toFixed(2)}ms`),console.log("🔄 [DEBUG] Sincronizando executeStageCounter..."),Z=u(),console.log("✅ [DEBUG] executeStageCounter sincronizado:",Z)}catch(l){throw console.error("❌ [DEBUG] Error procesando evento:",{eventType:a,error:l.message,stack:l.stack,executeStageCounter:Z,currentInstructionName:M}),l}}else{console.log("⏭️ [DEBUG] Evento vacío o indefinido, continuando...");continue}if(s.value.type==="cpu:cycle.start"){M=s.value.instruction.name,at=!!s.value.instruction.willUse.id,Ke=!!s.value.instruction.willUse.ri,fe=s.value.instruction.operands;const a=Ke||M==="INT"||M==="CALL";P.set(t8,a),ze=0,P.set(Dt,ze),e0=!1,dt=0,console.log("🔄 Nueva instrucción iniciada:",M,"- Contador reiniciado a 0"),console.log("🔍 Detalles de la instrucción:","willUse.id:",s.value.instruction.willUse.id,"willUse.ri:",s.value.instruction.willUse.ri,"modeId:",at,"modeRi:",Ke),console.log("🔍 Instrucción completa:",JSON.stringify(s.value.instruction,null,2)),gs=!1,Jg=!1,Zg="",vc=!1,yc="",Qg=!1}if(i.until==="cycle-change"||i.until==="end-of-instruction"||i.until==="infinity"){if(s.value.type==="cpu:cycle.end"){zr=0,Z=0,Eu=!0,pt="",sa++,console.log(`Instrucciones: ${sa}`),P.set(Bl,sa),(i.until==="cycle-change"||i.until==="end-of-instruction")&&$t();continue}else if(s.value.type==="cpu:halt"){console.log("🛑 HLT detected - setting isHaltExecutionAtom to true BEFORE any other operations"),P.set(go,!0),sa++,P.set(Bl,sa),console.log("🛑 HLT - after setting instruction count, isHaltExecutionAtom:",P.get(go)),console.log("🔄 fetchStageCounter",zr),dt++,P.set(af,dt);const a=P.get(zp);P.set(zp,a+dt),P.set(Je,"Ejecución: Detenido"),ze++,P.set(Dt,ze),console.log("🛑 HLT ejecutado - executeStageCounter establecido a 4, cycleCount:",dt)}else s.value.type==="cpu:int.6"?P.set(Je,"INT 6: Lectura de carácter del teclado"):s.value.type==="cpu:int.7"&&(P.set(Je,"Interrupción: Rutina mostrar por pantalla"),i.until==="cycle-change"&&$t());if(zr<3)s.value.type==="cpu:mar.set"?(s.value.register==="SP"?(zr=3,Z=3,M!=="CALL"&&P.set(Je,"Ejecución: MAR ← SP")):(P.set(Je,"Captación: MAR ← IP"),dt++,ze++,P.set(Dt,ze),Z++),i.until==="cycle-change"&&$t(),zr++):s.value.type==="cpu:register.update"?(console.log("🔍 Debug: Captación register.update - fetchStageCounter:",zr,"executeStageCounter:",Z),P.set(Je,"Captación: MBR ← read(Memoria[MAR]) | IP ← IP + 1"),dt++,ze++,P.set(Dt,ze),i.until==="cycle-change"&&$t(),Z++,zr++):s.value.type==="cpu:mbr.get"&&(P.set(Je,"Captación: IR ← MBR"),dt++,ze++,P.set(Dt,ze),i.until==="cycle-change"&&$t(),zr++);else if(s.value.type==="cpu:rd.on"&&Z>1?(pt="Ejecución: MBR ← read(Memoria[MAR])",Pu=!1):s.value.type==="cpu:wr.on"?(M==="CALL"&&Z>=8?console.log("✅ CALL paso",Z,"- cpu:wr.on mensaje omitido para mensaje combinado"):pt="Ejecución: write(Memoria[MAR]) ← MBR",Pu=!0,M==="MOV"&&!t0(fe)&&(console.log("🔍 MOV Debug - Escritura en memoria detectada"),console.log("🔍 MOV Debug - Operandos:",fe),console.log("🔍 MOV Debug - Es lectura:",t0(fe)))):s.value.type==="pio:write.ok"&&(P.set(Je,"Ejecución: write(PIO[MAR]) ← MBR"),dt++,ze++,P.set(Dt,ze),Z++),s.value.type==="cpu:mar.set"){const a=s.value.register;M==="MOV"&&Z===2&&fe&&fe.length>=2&&fe[0]==="CL"&&fe[1]==="[BL]"&&a==="ri"&&i.until==="cycle-change"&&(console.log("🛑 Marcando pausa especial: MOV CL, [BL] en paso 4 (executeStageCounter=2) - se pausará al final del evento"),e0=!0),i.until==="cycle-change"&&(M==="CALL"&&a==="SP"||$t()),console.log("executeStageCounter:",Z),console.log("mbridirmar:",gs),console.log("resultmbrimar:",Jg),console.log("displayMessageresultmbr:",Zg),console.log("shouldDisplayMessage:",Eu),console.log("🔍 BL/BX Debug - blBxToRiProcessed:",vc),console.log("🔍 BL/BX Debug - blBxRegisterName:",yc);let l=!1;const c=(M==="MOV"||M==="ADD"||M==="SUB")&&a==="ri"&&(Z===3||vc)&&(!at&&!Ke||at&&!Ke),u=a==="ri"&&(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&(Z>=5&&(pt==="Ejecución: write(Memoria[MAR]) ← MBR"||Z>=7)||Z===5&&!Ke&&at),d=["ADD","SUB","CMP","AND","OR","XOR"].includes(M)&&Z===5,f=A3();if(N3(f)){const m=poe(a,f);if(P3("MAR.set",a,f,m),a==="IP"&&M==="MOV"&&Z===4&&(console.log("🔍 Debug MOV IP - Verificando condiciones:"),console.log("   sourceRegister === 'IP':",a==="IP"),console.log("   currentInstructionName === 'MOV':",M==="MOV"),console.log("   currentInstructionModeri:",Ke),console.log("   !currentInstructionModeid:",!at),console.log("   executeStageCounter === 4:",Z===4),console.log("   currentInstructionOperands:",fe),console.log("   currentInstructionOperands.length === 2:",fe.length===2),fe.length>=2&&(console.log("   Segundo operando:",fe[1]),console.log("   !startsWith('['):",!fe[1].startsWith("[")),console.log("   !endsWith(']'):",!fe[1].endsWith("]")),console.log("   /^\\d+$/.test():",/^\d+$/.test(fe[1])),console.log("   /^\\d+h$/i.test():",/^\d+h$/i.test(fe[1])),console.log("   Es valor inmediato (decimal o hex):",/^\d+$/.test(fe[1])||/^\d+h$/i.test(fe[1])))),M==="INT"&&Z===6&&a==="SP")console.log("🎯 INT paso 7 detectado en cpu:mar.set"),console.log("   currentInstructionName:",M),console.log("   executeStageCounter:",Z),console.log("   sourceRegister:",a),console.log("   Estableciendo mensaje: MAR ← SP | MBR ← Flags"),P.set(Je,"Ejecución: MAR ← SP | MBR ← Flags");else if(M==="INT"&&Z===10&&a==="SP")console.log("🎯 INT paso 10 detectado en cpu:mar.set"),console.log("   currentInstructionName:",M),console.log("   executeStageCounter:",Z),console.log("   sourceRegister:",a),console.log("   Estableciendo mensaje: MAR ← SP"),P.set(Je,"Ejecución: MAR ← SP");else if(a==="IP"&&Ke&&dt===5&&fe.length===2)P.set(Je,"Ejecución: MAR ← IP | ri ← MBR"),l=!1;else if(Jg)P.set(Je,Zg);else if(gs&&!u&&!(M==="INT"&&Z===6&&a==="SP")&&!(M==="INT"&&Z===11&&a==="ri"))if(M==="MOV"&&Ke&&at)P.set(Je,"Ejecución: MAR ← IP; MBR→MBR");else if(a==="ri"&&M==="MOV"&&!Ke&&!at)dt++,ze++,P.set(Je,`Ejecución: MAR ← ${yc}`),P.set(Dt,ze),console.log("🔢 Ciclo incrementado ANTES de mostrar MAR ← BL/BX - cycleCount:",dt,"currentInstructionCycleCount:",ze),l=!0,gs=!1,vc=!1,yc="";else if(a==="ri"&&(M==="ADD"||M==="SUB")&&!Ke&&!at)dt++,ze++,P.set(Dt,ze),console.log("🔢 Ciclo incrementado ANTES de mostrar MAR ← BL/BX - cycleCount:",dt,"currentInstructionCycleCount:",ze),l=!0,P.set(Je,`Ejecución: MAR ← ${yc}`),gs=!1,vc=!1,yc="";else{if(["ADD","SUB","CMP","AND","OR","XOR"].includes(M)&&Ke&&!at&&a==="ri"){d||P.set(Je,"Ejecución: MAR ← MBR");return}Qg?(P.set(Je,"Ejecución: MAR ← ri | id ← MBR"),Qg=!1):M!=="INT"&&M!=="CALL"&&(dt++,ze++,P.set(Je,"Ejecución: MAR ← BL | id ← MBR"),M&&["ADD","SUB","CMP","AND","OR","XOR"].includes(M)&&at&&!Ke&&typeof ye=="function"&&typeof Ri=="function"&&await Promise.all([ye([{key:"cpu.internalBus.address.path",from:Ri("BL","MAR",M)},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0}),ye([{key:"cpu.internalBus.data.path",from:Ri("MBR","id",M,"mem<-imd")},{key:"cpu.internalBus.data.opacity",from:1},{key:"cpu.internalBus.data.strokeDashoffset",from:1,to:0}],{duration:300,easing:"easeInOutSine",forceMs:!0})]))}else a==="ri"&&M==="MOV"&&Z===4?P.set(Je,"Ejecución: MAR ← MBR"):a==="ri"&&(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&!Ke&&at&&(Z===4||Z===5)&&!u?(P.set(Je,"Ejecución: MAR ← BL | id ← MBR"),console.log("🎯 Paso 6 de ADD [BL], 6 - Mensaje simultáneo: MAR ← BL | id ← MBR")):u&&a==="ri"?console.log("⏭️ ri → MAR omitido completamente - no mostrar mensaje ni contabilizar ciclo"):M==="INT"&&Z===11&&a==="ri"?(console.log("🎯 INT paso 12 detectado en cpu:mar.set - mostrando MAR ← ri"),P.set(Je,"Ejecución: MAR ← ri")):(M==="INT"&&a==="SP"||Eu||a==="SP"&&M!=="CALL"&&M!=="INT"||at&&a==="IP"||m.shouldDisplay)&&(!c&&!u&&!(M==="CALL"&&a==="SP")?M==="INT"&&a==="SP"?P.set(Je,"Ejecución: MAR ← SP | MBR ← FLAGS"):P.set(Je,m.message):u?console.log("⏭️ Mensaje NO mostrado para ri → MAR en etapa avanzada (dirección ya en MAR)"):M==="CALL"&&a==="SP"&&console.log("⏭️ Mensaje NO mostrado para CALL MAR ← SP (se mostrará en cpu:mbr.set)"))}gs&&u&&a==="ri"&&(gs=!1,console.log("🧹 mbridirmar limpiado para ri → MAR omitido en etapa avanzada"));const p=c||u||l||d||M==="CALL"&&a==="SP";p?console.log("⏭️ Ciclo NO contabilizado en cpu:mar.set - skipCycleCount:",p,"isIndirectInstruction:",c,"isRiToMARSkipCycle:",u,"isArithmeticRegToDirectStep5:",d,"CALL con SP:",M==="CALL"&&a==="SP","(dirección ya almacenada en MAR o será manejado en mbr.set)"):(dt++,ze++,d||P.set(Dt,ze),console.log("🔢 Ciclo contabilizado en cpu:mar.set - cycleCount:",dt,"currentInstructionCycleCount:",ze)),i.until==="cycle-change"&&(M==="MOV"&&a==="ri"&&Z===4&&!Ke&&!at&&fe.length===2&&fe[1].startsWith("[")&&fe[1].endsWith("]")?(console.log("🔍 MOV CL, [BL] paso 4 detectado - pausando en mar.set"),$t()):M==="CALL"&&a==="SP"&&Z===6?(console.log("🛑 CALL paso 7 detectado - pausando en cpu:mar.set (SP → MAR)"),$t()):M==="INT"&&a==="SP"&&Z===6?(console.log("🛑 INT paso 7 detectado - pausando en cpu:mar.set (SP → MAR)"),$t()):!u&&!(c&&!vc)&&$t()),u?console.log("⏭️ executeStageCounter NO incrementado para ri → MAR en etapa avanzada"):(Z++,console.log("🔍 cpu:mar.set - executeStageCounter después del incremento:",Z))}else if(s.value.type==="cpu:register.update"){const a=s.value.register;console.log("🔍 Debug register.update - fetchStageCounter:",zr,"executeStageCounter:",Z),console.log("🔍 Debug register.update - currentInstructionModeri:",Ke,"currentInstructionModeid:",at);const l=A3();if(N3(l)){const c=woe(a,l);P3("register.update",a,l,c);let u=c.message;Eu=c.shouldDisplay;let d=c.shouldPause;Ke&&Z===8&&M==="INT"&&(u="Ejecución: write(Memoria[MAR]) ← MBR; SP ← SP - 1"),Z===7&&M==="INT"&&a==="FLAGS"&&(u="Ejecución: write(Memoria[MAR]) ← MBR | update(Flags I=0)",d=!0),Z===4&&M==="CALL"&&(u="Ejecución: ri ← MBR | SP ← SP - 1",d=!0),Z===4&&M==="INT"&&(u="Ejecución: ri ← MBR | SP ← SP - 1",d=!0),Z===3&&M==="CALL"&&a==="IP"&&(u="Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1",d=!0),Z===6&&M==="CALL"&&(u="Ejecución: write(Memoria[MAR]) ← MBR; SP ← SP - 1",d=!0),Z===3&&a==="IP"&&(M==="MOV"||M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&(u="Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1"),Z===3&&a==="IP"&&["JMP","JZ","JNZ","JC","JNC","JO","JNO","JS","JNS"].includes((M||"").toUpperCase())&&(u="Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1"),Z===5&&a==="IP"&&Ke&&at&&(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&(u="Ejecución: MBR ← read(Memoria[MAR]) | IP ← IP + 1"),console.log("displayMessage:",u),console.log("currentInstructionName:",M),console.log("currentInstructionModeri:",Ke),console.log("executeStageCounter:",Z),console.log("pause:",d),M!=="DEC"&&M!=="INC"&&M!=="NOT"&&M!=="NEG"&&!(M==="INT"&&Z===5)&&!(M==="INT"&&Z===8)&&!(M==="INT"&&Z===11)?(P.set(Je,u),dt++,ze++,P.set(Dt,ze)):M==="INT"&&Z===11&&console.log("⏭️ INT paso 11 (ri.l update) - omitiendo ciclo y mensaje"),Z++,u!=="Interrupción: MAR ← (video)"&&i.until==="cycle-change"&&M!=="DEC"&&M!=="INC"&&M!=="NOT"&&M!=="NEG"&&!(M==="INT"&&Z===12)&&d&&$t()}}else if(s.value.type==="cpu:alu.execute")M==="CMP"&&(P.set(Je,`Ejecución: ${C3} ${M} ${Au} ; update(FLAGS)`),dt++,ze++,P.set(Dt,ze),i.until==="cycle-change"&&$t());else if(s.value.type==="cpu:mbr.get"){const a=s.value.register,l=s.value.register==="id.l"?"id":s.value.register==="IP.l"?"IP":s.value.register==="FLAGS.l"?"FLAGS":s.value.register==="ri.l"?"MBR":s.value.register;(String(l)==="right.l"||String(l)==="left.l")&&(Au="MBR"),(Ke&&Z===3&&(M==="ADD"||M==="SUB"||M==="CMP")||Z===3&&(M==="ADD"||M==="SUB"||M==="CMP")&&Ke&&fe.length>=2&&(fe[0].startsWith("[")&&fe[0].endsWith("]")&&/^\[[0-9A-F]+h?\]$/i.test(fe[0])||fe[1].startsWith("[")&&fe[1].endsWith("]")&&/^\[[0-9A-F]+h?\]$/i.test(fe[1]))||Z===3&&M==="POP"||Ke&&at&&Z===4&&M==="MOV"||a==="id.l"&&Ke&&at&&(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")||a==="ri.l"&&Ke&&at&&Z===4&&(M==="MOV"||M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")||a==="ri.l"&&Z===4&&(M==="INT"||M==="CALL"))&&(a==="id.l"&&Ke&&at&&(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&(Qg=!0),gs=!0),M==="POP"&&Z===3&&(e$=`Ejecución: ${l} ← MBR`);const c=a==="id.l"&&(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&!Ke&&at&&Z===4,u=M==="RET"&&Z===3&&l==="IP",d=M==="IRET"&&Z===3&&l==="IP";if(c&&(console.log("🎯 Caso especial detectado: MBR → ID sin contabilizar ciclo ni mostrar mensaje"),console.log("   Instrucción:",M),console.log("   executeStageCounter:",Z),console.log("   originalRegister:",a)),u&&(console.log("🎯 Caso especial RET paso 6 detectado: IP ← MBR sin contabilizar ciclo ni mostrar mensaje"),console.log("   Se mostrará mensaje combinado en cpu:register.update")),d&&(console.log("🎯 Caso especial IRET paso 6 detectado: IP ← MBR sin contabilizar ciclo ni mostrar mensaje"),console.log("   Se mostrará mensaje combinado en cpu:register.update")),a==="ri.l"&&Z===4&&(M==="INT"||M==="CALL")&&(console.log(`🎯 ${M} paso 6 detectado: MBR → ri con mbridirmar=${gs}`),console.log(`🎯 showriAtom debería estar habilitado para ${M}`)),M==="INT"&&Z===12&&a==="IP.l")console.log("🎯 INT paso 13 detectado: IP ← MBR - último paso antes de saltar a rutina de interrupción"),P.set(Je,"Ejecución: IP ← MBR"),dt++,ze++,P.set(Dt,ze),i.until==="cycle-change"&&$t();else if(!gs&&!c&&!u&&!d&&String(l)!=="MBR"&&String(l)!=="right.l"&&String(l)!=="left.l"){P.set(Je,`Ejecución: ${l} ← MBR`),dt++,ze++,P.set(Dt,ze);const m=M==="MOV"&&(l==="AL"||l==="AH"||l==="BL"||l==="BH"||l==="CL"||l==="CH"||l==="DL"||l==="DH");i.until==="cycle-change"&&!m&&$t()}}else if(s.value.type==="cpu:register.buscopy"){console.log("📋 Evento cpu:register.buscopy detectado");const a=s.value.src.replace(/\.l$/,""),l=s.value.dest.replace(/\.l$/,"");if(M==="MOV"){const c=`Ejecución: ${l} ← ${a}`;P.set(Je,c),dt++,ze++,P.set(Dt,ze),console.log("✅ Ciclo contabilizado para MOV register.buscopy - cycleCount:",dt,"currentInstructionCycleCount:",ze)}}else if(s.value.type==="cpu:register.copy"){console.log("📋 Evento cpu:register.copy detectado");const a=s.value.src.replace(/\.l$/,""),l=s.value.dest.replace(/\.l$/,"");M==="CALL"&&(console.log("🔍 CALL Debug en register.copy:"),console.log("   sourceRegister:",a,"(original:",s.value.src,")"),console.log("   destRegister:",l,"(original:",s.value.dest,")"),console.log("   executeStageCounter:",Z),console.log("   currentInstructionName:",M),console.log("   ¿Es ri → IP?:",a==="ri"&&l==="IP"),console.log("   ¿Destino contiene IP?:",l.includes("IP")||s.value.dest.includes("IP")));let c="";M==="DEC"||M==="INC"||M==="NOT"||M==="NEG"?c=a==="result"?`${M} ${Au}`:a:(c=a==="result"?`${l} ${M} ${Au}`:a==="ri"?"MBR":a,E3=`MBR ${M} ${fe[1]}; update(FLAGS)`),M==="CMP"&&String(l)==="right"&&(Au=a),M==="CMP"&&String(l)==="left"&&(C3=a);let u=`Ejecución: ${l==="ri"?"MAR":l} ← ${c}`;if((M==="ADD"||M==="SUB"||M==="CMP")&&l!=="left"&&l!=="right"&&(u+="; update(FLAGS)"),a==="ri"&&l==="IP")u="Ejecución: IP ← MBR",M==="CALL"?(console.log("🔍 CALL Debug - CONDICIÓN ri→IP CUMPLIDA"),console.log("🔍 CALL Debug - sourceRegister === 'ri':",a==="ri"),console.log("🔍 CALL Debug - destRegister === 'IP':",l==="IP"),console.log("🔍 CALL Debug - executeStageCounter:",Z),console.log("🔍 CALL Debug - currentInstructionName:",M),console.log("🔄 CALL ri→IP: Delegando contabilización y mensaje a cpu:cycle.end"),console.log("🔄 CALL ri→IP: NO pausando, esperando cpu:cycle.end")):M==="INT"&&Z===12?console.log("🔄 INT paso 12 (ri→IP): NO registrando mensaje ni contabilizando ciclo"):P.set(Je,u),i.until==="cycle-change"&&M!=="CALL"&&!(M==="INT"&&Z===12)&&$t();else if(M==="CALL"&&Z>=8&&(l==="IP"||s.value.dest.includes("IP")))console.log("🔍 CALL Debug - CONDICIÓN AMPLIADA PARA IP"),console.log("🔍 CALL Debug - sourceRegister:",a),console.log("🔍 CALL Debug - destRegister:",l),console.log("🔍 CALL Debug - executeStageCounter:",Z),console.log("🔄 CALL transferencia ampliada: Delegando contabilización y mensaje a cpu:cycle.end"),console.log("🔄 CALL transferencia a IP (ampliada): NO pausando, esperando cpu:cycle.end");else if(l==="left"&&M==="INT")u="ADD BL, 1";else if(a==="result"&&M==="INT")i.until==="cycle-change"&&$t();else if(a==="IP"&&l==="id")u="Ejecución: id ← IP",P.set(Je,u),i.until==="cycle-change"&&$t();else if(a==="id"&&l==="ri")u="Ejecución: MAR ← id",Eu=!1,P.set(Je,u);else if(a==="MBR"&&l==="ri")u="Ejecución: MAR ← MBR",P.set(Je,u);else if(a==="id"&&l==="IP")u="Ejecución: IP ← MBR",P.set(Je,u),i.until==="cycle-change"&&$t();else if(a==="BL"&&l==="ri"||a==="BX"&&l==="ri"){const f=a==="BL"?"BL":"BX";yc=f,u=`Ejecución: MAR ← ${f}`,Eu=!1,gs=!0,vc=!0}else String(a)==="right.l"&&(Au=a);if(console.log("cpu:register.copy - sourceRegister:",a,"destRegister:",l,"currentInstructionName:",M,"executeStageCounter:",Z),(M==="MOV"||M==="ADD"||M==="SUB")&&l!=="left"&&l!=="right"){const f=(a==="BL"||a==="BX")&&l==="ri",p=M==="MOV"&&l==="ri"&&fe&&fe.length===2&&/^\[[A-Z]{2}\]$/i.test(fe[0])&&/^[0-9A-F]+h?$/i.test(fe[1]);!f&&!p?(P.set(Je,u),dt++,ze++,P.set(Dt,ze),console.log(`✅ Ciclo contabilizado para ${M} register.copy - cycleCount:`,dt,"currentInstructionCycleCount:",ze)):console.log(`⏭️ Ciclo NO contabilizado para ${M} register.copy (BL/BX→ri o indirecto-inmediato) - se contabilizará en cpu:mar.set`)}else(l!=="result"&&a!=="result"||a==="result"&&l!=="MBR")&&!((a==="BL"||a==="BX")&&l==="ri")&&!(l==="left"||l==="right")&&!(M==="CALL"&&a==="ri"&&l==="IP")&&M!=="INT"?(l==="left"||l==="right"||P.set(Je,u),dt++,ze++,P.set(Dt,ze),console.log("✅ Ciclo contabilizado para register.copy - cycleCount:",dt,"currentInstructionCycleCount:",ze,"destRegister:",l,"sourceRegister:",a)):console.log("❌ Ciclo NO contabilizado para register.copy - condición no cumplida:","destRegister:",l,"sourceRegister:",a)}else if(s.value.type==="bus:reset"&&Z>1&&(M==="MOV"||M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR"||M==="CALL"||M==="INT"||M==="PUSH"||M==="POP"||M==="IN"||M==="RET"||M==="IRET")){(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&(!Ke&&!at&&Z===6&&fe.length===2&&fe[0].startsWith("[")&&fe[0].endsWith("]")&&/^[0-9A-F]+h?$/i.test(fe[0].replace(/\[|\]/g,""))&&/^[A-Z]+$/i.test(fe[1])?pt="Ejecución: write(Memoria[MAR]) ← MBR":pt="Ejecución: MBR ← read(Memoria[MAR])"),M==="RET"&&(pt="Ejecución: MBR ← read(Memoria[MAR])"),M==="IRET"&&(pt="Ejecución: MBR ← read(Memoria[MAR])"),M==="IN"&&(pt="Ejecución: MBR ← read(PIO[MAR])"),M==="INT"&&(Z===11?(pt="Ejecución: write(Memoria[MAR]) ← MBR",console.log("🎯 INT paso 11 detectado - estableciendo mensaje de escritura:",pt)):Z===7||Pu?pt="Ejecución: write(Memoria[MAR]) ← MBR":pt="Ejecución: MBR ← read(Memoria[MAR])"),M==="MOV"&&Z===5&&(console.log("🔍 MOV Debug - Operandos:",fe),console.log("🔍 MOV Debug - Es lectura:",t0(fe)),t0(fe)?pt="Ejecución: MBR ← read(Memoria[MAR])":pt="Ejecución: write(Memoria[MAR]) ← MBR"),(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&at&&!Ke&&Z===5?Pu?pt="Ejecución: write(Memoria[MAR]) ← MBR":pt="Ejecución: MBR ← read(Memoria[MAR])":(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&at&&!Ke&&Z===9?(pt="Ejecución: write(Memoria[MAR]) ← MBR",console.log("🎯 Paso 9 ADD [BL], 2 - Estableciendo mensaje de escritura:",pt)):(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&at&&Ke&&Z===8?Pu?(pt="Ejecución: write(Memoria[MAR]) ← MBR",console.log("🎯 Paso 8 ADD [04], 02h - Estableciendo mensaje de escritura:",pt)):(pt="Ejecución: MBR ← read(Memoria[MAR])",console.log("🎯 Paso 8 ADD [04], 02h - Estableciendo mensaje de lectura:",pt)):(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&!at&&!Ke&&(Pu?pt="Ejecución: write(Memoria[MAR]) ← MBR":pt="Ejecución: MBR ← read(Memoria[MAR])");let a=!1,l=!1;(M==="MOV"||M==="ADD"||M==="SUB")&&pt==="Ejecución: write(Memoria[MAR]) ← MBR"&&(Ke&&!at&&Z===6||!at&&Z===5||Ke&&at&&Z===8)&&(l=!0),Ke&&(Z===4||Z===8)&&M==="INT"||Z===3&&(M==="MOV"||M==="ADD"||M==="SUB")&&Ke||Z===3&&(M==="MOV"||M==="ADD"||M==="SUB")&&!Ke&&!at&&fe.length>=2&&(!fe[0].startsWith("[")&&!fe[0].endsWith("]")&&!fe[1].startsWith("[")&&!fe[1].endsWith("]")&&(/^\d+$/.test(fe[1])||/^\d+h$/i.test(fe[1])||/^[0-9A-F]+h?$/i.test(fe[1])||/^\d+$/.test(fe[0])||/^\d+h$/i.test(fe[0])||/^[0-9A-F]+h?$/i.test(fe[0]))||fe[0].startsWith("[")&&fe[0].endsWith("]")&&/^\[[0-9A-F]+h?\]$/i.test(fe[0])||fe[1].startsWith("[")&&fe[1].endsWith("]")&&/^\[[0-9A-F]+h?\]$/i.test(fe[1]))||Z===3&&(M==="MOV"||M==="ADD"||M==="SUB")&&!Ke&&!at&&fe.length>=2&&(fe[0].startsWith("[")&&fe[0].endsWith("]")&&/^\[[A-Z]+\]$/i.test(fe[0])&&(/^\d+$/.test(fe[1])||/^\d+h$/i.test(fe[1]))||fe[1].startsWith("[")&&fe[1].endsWith("]")&&/^\[[A-Z]+\]$/i.test(fe[1])&&(/^\d+$/.test(fe[0])||/^\d+h$/i.test(fe[0])))||Z===5&&(M==="MOV"||M==="ADD"||M==="SUB")&&Ke||at&&Z===4&&(M==="ADD"||M==="SUB"||M==="CMP")||Z===3&&(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&pt!=="Ejecución: MBR ← read(Memoria[MAR])"||Z===3&&(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")&&at&&!Ke&&pt==="Ejecución: MBR ← read(Memoria[MAR])"||Z===3&&M==="CALL"&&pt==="Ejecución: MBR ← read(Memoria[MAR])"||Z===7&&M==="CALL"&&pt==="Ejecución: write(Memoria[MAR]) ← MBR"||Z>=8&&M==="CALL"||Z===3&&M==="INT"&&pt==="Ejecución: MBR ← read(Memoria[MAR])"?(a=!0,console.log("🔄 ContinuarSinGuardar establecido a true - condición cumplida"),M==="CALL"&&Z>=8&&console.log("✅ CALL paso",Z,"- bus:reset omitido correctamente")):(console.log("🔄 ContinuarSinGuardar mantenido como false - ninguna condición cumplida"),Z===3&&(M==="MOV"||M==="ADD"||M==="SUB")&&!Ke&&!at&&(console.log(`🔍 Debug ${M} step 3:`),console.log("   Operandos length >= 2:",fe.length>=2),console.log("   Operando[0] no tiene []:",!fe[0].startsWith("[")&&!fe[0].endsWith("]")),console.log("   Operando[1] no tiene []:",!fe[1].startsWith("[")&&!fe[1].endsWith("]")),console.log("   Test operando[0] es dirección:",/^\d+$/.test(fe[0])||/^\d+h$/i.test(fe[0])||/^[0-9A-F]+h?$/i.test(fe[0])),console.log("   Test operando[1] es inmediato:",/^\d+$/.test(fe[1])||/^\d+h$/i.test(fe[1])||/^[0-9A-F]+h?$/i.test(fe[1])))),console.log("ContinuarSinGuarda:",a),console.log("executeStageCounter:",Z),console.log("isLastStepBeforeCycleEnd:",l),console.log("🔍 bus:reset Debug - messageReadWrite:",pt),console.log("🔍 bus:reset Debug - currentInstructionModeri:",Ke),console.log("🔍 bus:reset Debug - currentInstructionModeid:",at),console.log("🔍 bus:reset Debug - currentInstructionOperands:",fe),console.log("🔍 bus:reset Debug - Operando[0]:",fe[0]),console.log("🔍 bus:reset Debug - Operando[1]:",fe[1]),console.log("🔍 bus:reset Debug - Condición MOV/ADD/SUB directo step 3:",Z===3&&(M==="MOV"||M==="ADD"||M==="SUB")&&!Ke&&!at),console.log("🔍 bus:reset Debug - Es lectura de memoria:",pt==="Ejecución: MBR ← read(Memoria[MAR])"),console.log("🔍 bus:reset Debug - MOV/ADD/SUB indirecto debe mostrar:",(M==="MOV"||M==="ADD"||M==="SUB")&&!Ke&&!at&&Z===5&&pt==="Ejecución: MBR ← read(Memoria[MAR])");const c=M==="INT"&&Z===7&&pt==="Ejecución: write(Memoria[MAR]) ← MBR";!a&&!c?(P.set(Je,pt),dt++,ze++,P.set(Dt,ze),i.until==="cycle-change"&&$t()):c?console.log("⏭️ INT ciclo 8 detectado - omitiendo bus:reset, se manejará en cpu:register.update con mensaje combinado"):l&&(P.set(Je,pt),dt++,ze++,P.set(Dt,ze))}else if(s.value.type==="cpu:mbr.set"){const a=s.value.register==="id.l"?"id":s.value.register==="FLAGS.l"?"FLAGS":s.value.register==="IP.l"?"IP":s.value.register==="result.l"?E3:s.value.register;if(Ke&&Z===5&&(M==="ADD"||M==="SUB"))Jg=!0,Zg=`Ejecución: MBR ← ${a} ; MAR ← MBR`;else if(Ke&&at&&Z===5&&(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR"))P.set(Je,"Ejecución: id ← MBR"),i.until==="cycle-change"&&$t(),Z++,dt++,ze++,P.set(Dt,ze);else if(Ke&&at&&Z===6&&(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR"))console.log("🎯 Ciclo 6 detectado - delegando a events.ts para animación simultánea MBR → ri + IP → MAR");else if(Ke&&at&&Z===7&&s.value.register==="result.l"&&(M==="ADD"||M==="SUB"||M==="CMP"||M==="AND"||M==="OR"||M==="XOR")){const l=a.replace("; write(FLAGS)","; update(FLAGS)");P.set(Je,`Ejecución: MBR ← ${l}`),i.until==="cycle-change"&&$t(),Z++,dt++,ze++,P.set(Dt,ze)}else if(M==="MOV"&&(Z===5||Z===6||Z===3)&&["AL","BL","CL","DL","AH","BH","CH","DH"].includes(a)&&!Ke&&!at)console.log(`🎯 MOV paso 5/3 detectado: ${a} → MBR`),P.set(Je,`Ejecución: MBR ← ${a}`),dt++,ze++,P.set(Dt,ze),Z++,i.until==="cycle-change"&&$t();else if(M==="CALL"&&a==="IP")P.set(Je,"Ejecución: MAR ← SP | MBR ← IP"),dt++,ze++,P.set(Dt,ze),Z++,console.log("⏭️ CALL IP → MBR: NO pausando, pausará en siguiente cpu:mar.set con SP");else if(M==="INT"&&a==="FLAGS"&&Z===5)console.log("⏭️ INT paso 7 (FLAGS → MBR) - omitiendo ciclo/mensaje/pausa, se manejará en cpu:mar.set"),Z++;else if(M==="INT"&&a==="IP"&&Z===9)P.set(Je,"Ejecución: MBR ← IP | SP ← SP - 1"),dt++,ze++,P.set(Dt,ze),Z++,i.until==="cycle-change"&&(console.log("🛑 INT paso 9 detectado - pausando en cpu:mbr.set (IP → MBR | SP ← SP - 1)"),$t());else if(s.value.register==="result.l"){const l=`Ejecución: MBR ← ${a.replace("; write(FLAGS)"," ; update(FLAGS)")}`;P.set(Je,l),dt++,ze++,P.set(Dt,ze),i.until==="cycle-change"&&$t()}else console.log("🎬 Permitiendo que events.ts maneje cpu:mbr.set para animaciones normales")}}else P.set(Je,"");if(console.log(`Ciclos ejecutados: ${dt}`),P.set(af,dt),e0&&i.until==="cycle-change"){console.log("🛑 Ejecutando pausa especial después del evento"),e0=!1,$t();continue}const o=new CustomEvent("instructionChange",{detail:{instruction:M,modeid:at,moderi:Ke}});window.dispatchEvent(o),s.value.type==="cpu:cycle.update"||s.value.type==="cpu:cycle.interrupt"?i.until:s.value.type==="cpu:cycle.end"&&(i.until==="end-of-instruction"||i.until==="cycle-change")&&$t()}t.return()}catch(e){const n=hn.from(e);Jr(n)}}async function Mh(...t){const e=t[0],n=P.get(Tt);switch(e){case"cpu.run":{if(n.type==="running")return Cu();const i=t[1];if(n.type==="stopped"){if(!window.codemirror)return;dt=0,sa=0,P.set(af,dt),P.set(Bl,sa),P.set(ws,[]);const r=window.codemirror.state.doc.toString(),s=Kj(r);if(!s.success)return foe();const o=s.instructions.map(_=>_.instruction),a=o.some(_=>["CALL","RET","INT","IRET","POP","PUSH"].includes(_));P.set(jb,a);const l=o.includes("INT"),c=s.instructions.some(_=>_.instruction==="INT"?_.operands.some(A=>A.type==="number-expression"&&typeof A.value.value=="number"?A.value.value===6||A.value.value===7:!1):!1),u=s.instructions.some(_=>_.instruction==="IN"||_.instruction==="OUT"?_.operands.some(A=>A.type==="number-expression"&&typeof A.value.value=="number"?A.value.value>=48&&A.value.value<=51:!1):!1),d=s.instructions.some(_=>_.instruction==="IN"||_.instruction==="OUT"?_.operands.some(A=>{if(A.type==="number-expression"){if(typeof A.value.value=="number"){const R=A.value.value>=32&&A.value.value<=43;return R&&console.log(`🎯 PIC detectado: ${_.instruction} con operando ${A.value.value.toString(16)}h`),R}try{if(A.value&&typeof A.value.resolve=="function"){const R=A.value.resolve();if(typeof R=="number"){const L=R>=32&&R<=43;return L&&console.log(`🎯 PIC detectado: ${_.instruction} con operando resuelto ${R.toString(16)}h`),L}}}catch(R){console.warn("No se pudo resolver operando PIC:",R)}}return!1}):!1);console.log("🔍 Análisis de instrucciones para PIC:",{totalInstructions:s.instructions.length,inOutInstructions:s.instructions.filter(_=>_.instruction==="IN"||_.instruction==="OUT").length,usesPIC:d,mayUsePICFromAssembler:s.mayUsePIC,firstFewInstructions:s.instructions.slice(0,5).map(_=>{var A;return{instruction:_.instruction,operands:(A=_.operands)==null?void 0:A.map(R=>({type:R.type,value:R.type==="number-expression"?R.value.value:R.value}))}})});const f=s.instructions.some(_=>_.instruction==="IN"||_.instruction==="OUT"?_.operands.some(A=>{if(A.type==="number-expression"){if(typeof A.value.value=="number")return A.value.value===64||A.value.value===65;try{if(A.value&&typeof A.value.resolve=="function"){const R=A.value.resolve();if(typeof R=="number")return R===64||R===65}}catch(R){console.warn("No se pudo resolver operando Handshake:",R)}}return!1}):!1),p=s.instructions.some(_=>_.instruction==="IN"||_.instruction==="OUT"?_.operands.some(A=>{if(A.type==="number-expression"){if(typeof A.value.value=="number")return A.value.value===16||A.value.value===17;try{if(A.value&&typeof A.value.resolve=="function"){const R=A.value.resolve();if(typeof R=="number")return R===16||R===17}}catch(R){console.warn("No se pudo resolver operando Timer:",R)}}return!1}):!1),m=nt(),g=P.get(Zp);console.log("🔍 Verificando si programa fue modificado:",g);const y=d||(s.mayUsePIC??!1);y&&!m.devices.pic&&(Pd("PIC activado automáticamente","Se detectó que el programa utiliza el PIC (direcciones 20h-2Bh). El módulo PIC se ha activado automáticamente, se ha reservado espacio para el vector de interrupciones y se ha configurado la visualización del flag I (interrupt flag)."),console.log("🔧 PIC activado automáticamente debido a detección de uso en el código"),console.log("🔧 Flag I configurado para mostrarse automáticamente")),p&&!m.devices.pic&&(Pd("Timer y Reloj activados automáticamente","Se detectó que el programa utiliza el Timer (direcciones 10h-11h). El módulo PIC se ha activado automáticamente ya que el Timer requiere el PIC para funcionar."),console.log("🔧 PIC y Timer activados automáticamente debido a detección de uso del Timer en el código")),P.set(Ti,_=>({..._,devices:{..._.devices,keyboardAndScreen:c,pio:u?"switches-and-leds":f?"printer":_.devices.pio,handshake:f?"printer":_.devices.handshake,pic:y||p||_.devices.pic,"switches-and-leds":u},flagsVisibility:(y||p)&&!m.devices.pic?_.flagsVisibility==="SF_OF_CF_ZF"?"IF_SF_OF_CF_ZF":"IF_CF_ZF":_.flagsVisibility})),P.set(sE,c);const v=l||y;P.set(oE,v),P.set(Bb,s.mayUsePIC??!1),console.log("🔍 DEBUG Vector de Interrupciones:",{hasINT:l,usesPIC:d,shouldActivatePIC:y,usesHandshake:f,usesTimer:p,connectScreenAndKeyboard:c,hasINTOrInterruptDevices:v,currentHandshakeConfig:nt().devices.handshake,currentPICConfig:nt().devices.pic}),console.log("Detectado - PIC:",d,"shouldActivatePIC:",y,"Handshake:",f,"Timer:",p,"INT:",l,"PIC Config:",nt().devices.pic),console.log("Habilitando vector de interrupciones:",v),console.log("Timer se activará automáticamente:",p,"- PIC se activará para soportar Timer:",p||y);const b=nt(),w=g?"clean":m.dataOnLoad;console.log("🔧 Configuración de carga de datos:",w,"(programa modificado:",g,")"),g&&P.set(Zp,!1),An.loadProgram({program:s,data:w,devices:{keyboardAndScreen:b.devices.keyboardAndScreen??!1,pic:b.devices.pic??!1,pio:b.devices.pio??null,handshake:b.devices.handshake??null},hasORG:s.hasORG,hasORG20hAtStart:s.hasORG20hAtStart,hasINTOrInterruptDevices:v,mayUsePIC:s.mayUsePIC}),console.log("result:",s);const k=s.instructions.filter(_=>_.type==="instruction").flatMap(_=>{const A=_.operands.map(O=>{if(O.type==="register")return O.value;if(O.type==="number-expression"){const I=O.value;if(I.isNumberLiteral())return I.value.toString(16)+"h";if(I.isLabel())return I.value}else{if(O.type==="indirect-address")return"[BL]";if(O.type==="direct-address"){const I=O.value;if(I.isNumberLiteral())return I.value.toString(16)+"h"}}return""}).join(", "),R=`${_.instruction} ${A}`.trim(),L=[{address:_.start.value,name:R,length:_.length.toString().trim()}];if(_.operands.some(O=>O.type==="number-expression"||O.type==="direct-address")){const O=_.start.value+1,I=_.operands.filter((G,B)=>_.length===3?B===0&&G.type==="number-expression":G.type==="number-expression").map(G=>{if(G.type==="number-expression"){const B=G.value;if(B.isNumberLiteral())return B.value.toString(16)+"h";if(B.isLabel())return B.value}else if(G.type==="direct-address"){const B=G.value;if(B.isNumberLiteral())return B.value.toString(16)+"h"}return""}).join(", ");L.push({address:O,name:I,length:""})}if(_.length===3){const O=_.start.value+2,I=_.operands.filter(G=>G.type==="number-expression").map(G=>{if(G.type==="number-expression"){const B=G.value;if(B.isNumberLiteral())return B.value.toString(16)+"h"}return""}).join(" ");L.push({address:O,name:I,length:""})}return L}),C=s.data.filter(_=>_.type==="data-directive").flatMap(_=>{const A=_.start.value;return _.getValues().map(L=>typeof L=="object"&&L!==null&&"toNumber"in L&&typeof L.toNumber=="function"?L.toNumber():typeof L=="number"?L:0).map((L,O)=>({address:A+O,label:O===0&&_.label||null,value:L}))});console.log("Direcciones de las instrucciones:",k),console.log("Direcciones de los datos:",C),P.set(i8,k),P.set(r8,C.map(_=>({..._,length:""}))),_3(An.getComputerState());const E=["Start CPU",{until:i,devices:nt().devices,language:nt().language,animations:nt().animations?"yes":"no"}];I6.capture(...E),P.set(Tt,{type:"running",until:i,waitingForInput:!1}),Fu(An.startCPU()),console.log("🕐 [DEBUG] Iniciando reloj..."),Moe(),console.log("🖨️ [DEBUG] Iniciando impresora..."),Roe()}else P.set(Tt,{type:"running",until:i,waitingForInput:!1}),VB();return}case"cpu.stop":{const i=t[1];if(i){Jr(),_3(An.getComputerState(),i);const{anim:r}=await $p(async()=>{const{anim:o}=await Promise.resolve().then(()=>Rse);return{anim:o}},void 0);await Promise.all([r({key:"cpu.internalBus.data.opacity",to:0},{duration:.1,easing:"easeInSine"}),r({key:"cpu.internalBus.address.opacity",to:0},{duration:.1,easing:"easeInSine"})]);const s=new CustomEvent("instructionChange",{detail:{instruction:"",modeid:!1,moderi:!1}});window.dispatchEvent(s)}else $t();return}case"f10.press":{if(!An.devices.f10.connected()||n.type!=="running")return Cu();if(k3("f10:press"))return;Fu(An.devices.f10.press());return}case"switch.toggle":{if(!An.devices.switches.connected())return Cu();if(k3("switches:toggle"))return;const i=t[1];n.type==="running"?Fu(An.devices.switches.toggle(i)):P.set(n1,r=>r.withBit(i,!r.bit(i)));return}case"keyboard.sendChar":{if(n.type!=="running"||!n.waitingForInput)return Cu();An.devices.keyboard.readChar(H.fromChar(t[1])),P.set(Tt,{...n,waitingForInput:!1});return}case"screen.clean":{if(!An.devices.screen.connected())return Cu();Fu(An.devices.screen.clear());return}case"printer.clean":{if(!An.devices.printer.connected())return Cu();Fu(An.devices.printer.clear());return}default:return e}}async function Moe(){if(console.log("🕐 [DEBUG] startClock llamado, verificando conexión..."),!An.devices.clock.connected()){console.log("🕐 [DEBUG] Reloj NO conectado, saliendo");return}for(console.log("🕐 [DEBUG] Reloj conectado, iniciando bucle de ticks");P.get(Tt).type!=="stopped";){const t=nt().clockSpeed;if(console.log("🕐 [DEBUG] Esperando",t,"ms antes del próximo tick"),await new Promise(e=>setTimeout(e,t)),P.get(Tt).type!=="stopped"){console.log("🕐 [DEBUG] Disparando tick del reloj");const e=An.devices.clock.tick();console.log("🕐 [DEBUG] Generador del reloj creado:",e),Fu(e,!0)}else{console.log("🕐 [DEBUG] Simulación detenida, saliendo del bucle de reloj");break}}console.log("🕐 [DEBUG] Bucle de reloj terminado")}async function Roe(){if(!An.devices.printer.connected())return;console.log("🖨️ [DEBUG] startPrinter: Impresora conectada, iniciando procesamiento de buffer");const t=async()=>{if(P.get(Tt).type!=="stopped"){if(An.devices.printer.hasPending()){console.log("🖨️ [DEBUG] Procesando caracteres pendientes en buffer de impresora");const e=nt().printerSpeed;await ye([{key:"printer.printing.opacity",from:1},{key:"printer.printing.progress",from:0,to:1}],{duration:e,forceMs:!0,easing:"easeInOutSine"}),await ye({key:"printer.printing.opacity",to:0},{duration:1,easing:"easeInSine"});const n=An.devices.printer.print();if(n){let i=n.next();for(;!i.done;)i.value&&typeof i.value<"u"&&await QB(i.value),i=n.next()}}P.get(Tt).type!=="stopped"&&setTimeout(t,nt().printerSpeed)}};t()}function Kn(){const t=tt(Tt),e=iZ(),n=x.useMemo(()=>({hasIOBus:e.pic||e.pio!==null||e.handshake!==null,clock:e.pic,f10:e.pic,keyboard:e.keyboardAndScreen,handshake:e.handshake,leds:e.pio==="switches-and-leds",pic:e.pic,pio:e.pio,printer:e.pio==="printer"||e.handshake==="printer",screen:e.keyboardAndScreen,switches:e.pio==="switches-and-leds",timer:e.pic}),[e]);return{status:t,dispatch:Mh,devices:n}}function Ioe({className:t}){const e=cn(),{status:n,dispatch:i}=Kn(),[r,s]=x.useState(null),[o,a]=x.useState("desktop");x.useEffect(()=>{const g=()=>{const y=window.innerWidth;y<=480?a("mobile"):y<=768?a("compact"):y<=1024?a("tablet"):a("desktop")};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),x.useEffect(()=>{n.type!=="running"&&s(null)},[n.type]);const l=x.useCallback(()=>{n.type!=="running"&&(s("cycle-change"),i("cpu.run","cycle-change"))},[n.type,i]);Du("F7",g=>{g.preventDefault(),l()},void 0,[l]);const c=x.useCallback(()=>{n.type!=="running"&&(s("end-of-instruction"),i("cpu.run","end-of-instruction"))},[n.type,i]);Du("F8",g=>{g.preventDefault(),c()},void 0,[c]);const u=x.useCallback(()=>{n.type!=="running"&&(s("infinity"),i("cpu.run","infinity"))},[n.type,i]);Du("F4",g=>{g.preventDefault(),u()},void 0,[u]);const d=x.useCallback(()=>{n.type==="running"&&i("cpu.stop",!1)},[n.type,i]),f=x.useCallback(()=>{n.type!=="running"&&i("cpu.stop",!0)},[n.type,i]);Du("F9",g=>{g.preventDefault(),f()},void 0,[f]),Du(" ",g=>{const y=g.target;y.tagName==="INPUT"||y.tagName==="TEXTAREA"||y.contentEditable==="true"||(g.preventDefault(),n.type==="running"&&d())},{event:"keydown"},[n.type,d]);const p=o==="desktop"||o==="tablet",m=o==="desktop";return h.jsxs("div",{"data-testid":"controls",className:re("flex items-center justify-center gap-4 rounded-xl border border-stone-700 bg-stone-900/80 shadow-lg",o==="mobile"?"gap-2 px-2 py-0.5":o==="compact"?"gap-3 px-2 py-1":"gap-4 px-3 py-1",t),children:[n.type==="running"&&r==="cycle-change"?h.jsxs("button",{"data-testid":"cycle-button",onClick:d,title:e("control.action.pause"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-orange-600/20 focus-visible:ring-2 focus-visible:ring-orange-400",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Ye,{icon:Xh,size:"lg",className:"text-orange-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"Space"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.pause")})]}):h.jsxs("button",{"data-testid":"cycle-button",disabled:n.type==="running",onClick:l,title:e("control.action.run.cycle-change"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-mantis-600/20 focus-visible:ring-2 focus-visible:ring-mantis-400 disabled:opacity-50",n.type==="running"&&n.until==="cycle-change"&&"animate-pulse-glow-mantis",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Ye,{icon:Ib,size:"lg",className:"text-mantis-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"F7"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.run.cycle-change")})]}),n.type==="running"&&r==="end-of-instruction"?h.jsxs("button",{"data-testid":"new-button",onClick:d,title:e("control.action.pause"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-orange-600/20 focus-visible:ring-2 focus-visible:ring-orange-400",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Ye,{icon:Xh,size:"lg",className:"text-orange-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"Space"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.pause")})]}):h.jsxs("button",{"data-testid":"new-button",disabled:n.type==="running",onClick:c,title:e("control.action.run.end-of-instruction"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-mantis-600/20 focus-visible:ring-2 focus-visible:ring-mantis-400 disabled:opacity-50",n.type==="running"&&n.until==="end-of-instruction"&&"animate-pulse-glow-mantis",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Ye,{icon:qC,size:"lg",className:"text-mantis-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"F8"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.run.end-of-instruction")})]}),n.type==="running"&&r==="infinity"?h.jsxs("button",{"data-testid":"open-button",onClick:d,title:e("control.action.pause"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-orange-600/20 focus-visible:ring-2 focus-visible:ring-orange-400",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Ye,{icon:Xh,size:"lg",className:"text-orange-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"Space"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.pause")})]}):h.jsxs("button",{"data-testid":"open-button",disabled:n.type==="running",onClick:u,title:e("control.action.run.infinity"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-mantis-600/20 focus-visible:ring-2 focus-visible:ring-mantis-400 disabled:opacity-50",n.type==="running"&&n.until==="infinity"&&"animate-pulse-glow-mantis",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Ye,{icon:lJ,size:"lg",className:"text-mantis-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"F4"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.run.infinity")})]}),h.jsxs("button",{"data-testid":"assemble-button",onClick:f,disabled:n.type==="stopped"||n.type==="running",title:e("control.action.reset"),className:re("group relative flex flex-col items-center rounded-lg transition hover:bg-red-600/20 focus-visible:ring-2 focus-visible:ring-red-400 disabled:opacity-50",o==="mobile"?"px-1 py-0.5":"px-1.5 py-0.5"),children:[h.jsxs("span",{className:"flex items-center justify-center",children:[h.jsx(Ye,{icon:Aj,size:"lg",className:"text-red-400 transition group-hover:scale-110"}),m&&h.jsx("span",{className:"pointer-events-none ml-1 font-mono text-[10px] text-stone-400 opacity-80",children:"F9"})]}),p&&h.jsx("span",{className:"mt-0.5 text-xs",children:e("control.action.reset")})]})]})}const t$=x.memo(({currentPhase:t="idle",className:e})=>{const[n,i]=x.useState("idle"),[r,s]=x.useState(!1);x.useEffect(()=>{if(t!=="idle"){i(t);const a=setTimeout(()=>i("idle"),1e3);return()=>clearTimeout(a)}},[t]);const o=[{id:"captacion",label:"Captación",color:"text-blue-400",icon:"📥",descripcion:"Captando instrucción desde memoria",pasos:["IP apunta a la dirección de memoria, el MAR recibe la dirección del IP","Se lee el contenido de memoria y se almacena en el MBR, IP se incrementa automáticamente","La instrucción se transfiere al IR"]},{id:"ejecucion",label:"Ejecución",color:"text-green-400",icon:"⚡",descripcion:"Ejecutando instrucción",subfases:[{id:"operandos",label:"Obtención de operandos",color:"text-yellow-400",icon:"🔍",descripcion:"Obteniendo operandos de la instrucción",pasos:["Se identifican y preparan los operandos necesarios para la operación."]},{id:"alu",label:"Procesar en ALU",color:"text-green-400",icon:"⚡",descripcion:"Procesando en la ALU",pasos:["La ALU ejecuta la operación aritmética o lógica con los operandos."]},{id:"escritura",label:"Escribir resultado",color:"text-purple-400",icon:"💾",descripcion:"Escribiendo resultado en registros",pasos:["El resultado de la operación se almacena en el registro destino."]}]}];return h.jsxs("div",{className:re("flex flex-col gap-2 rounded-lg border-2 border-stone-400 bg-gradient-to-br from-stone-700 via-stone-600 to-stone-800 p-3 shadow-lg ring-1 ring-stone-300","min-w-[280px] max-w-[320px]",e),children:[h.jsx("div",{className:"mb-2 flex items-center justify-between",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[6px] font-bold text-stone-300",children:"CICLO CPU"}),h.jsx("button",{onClick:()=>s(!r),className:re("rounded border px-2 py-1 text-[10px] font-bold transition-all duration-200",r?"border-stone-300 bg-stone-300 text-stone-950 shadow-[0_0_4px_rgba(120,113,108,0.6)]":"border-stone-600 bg-stone-800 text-stone-300 hover:border-stone-400 hover:bg-stone-700"),children:r?"−":"+"})]})}),h.jsx("div",{className:"mt-2 flex items-center justify-center gap-2",children:o.map((a,l)=>h.jsxs("div",{className:"flex items-center",children:[h.jsxs("div",{className:re("flex cursor-pointer flex-col items-center gap-1 rounded border-2 px-2 py-1 transition-all duration-200","hover:border-stone-300 hover:bg-stone-700",t===a.id?"border-stone-300 bg-stone-300 text-stone-950 shadow-[0_0_4px_rgba(120,113,108,0.6)]":"border-stone-600 bg-stone-800 text-stone-300",n===a.id&&"animate-pulse"),onClick:()=>{var c;if(r)if(a.subfases){let u="";a.subfases.forEach(d=>{u+=`${d.label}
${d.descripcion}
Pasos:
${d.pasos.map((f,p)=>`${p+1}. ${f}`).join(`
`)}`,u+=`

`}),alert(u)}else alert(`${a.label}

${a.descripcion}

Pasos:
${(c=a.pasos)==null?void 0:c.map((u,d)=>`${d+1}. ${u}`).join(`
`)}`)},children:[h.jsx("div",{className:re("text-lg transition-transform duration-300",t===a.id&&"scale-110"),children:a.icon}),h.jsx("span",{className:re("text-[10px] font-bold uppercase tracking-wide transition-colors",t===a.id?"text-stone-950":"text-stone-300"),children:a.label}),h.jsx("span",{className:"max-w-16 text-center text-[9px] leading-tight text-stone-500",children:a.descripcion})]}),l<o.length-1&&h.jsx("div",{className:"mx-1 font-bold text-stone-400",children:"→"})]},a.id))}),r&&h.jsx("div",{className:"mt-2 rounded border-2 border-stone-600 bg-stone-800/80 p-2",children:h.jsxs("div",{className:"text-xs text-stone-300",children:[h.jsx("div",{className:"mb-1 font-bold text-stone-200",children:"Estado actual:"}),t==="fetch"&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 animate-pulse rounded-full bg-stone-300"}),h.jsx("span",{children:"Leyendo instrucción desde memoria"})]}),t==="decode"&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 animate-pulse rounded-full bg-stone-300"}),h.jsx("span",{children:"Interpretando código de operación"})]}),t==="execute"&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 animate-pulse rounded-full bg-stone-300"}),h.jsx("span",{children:"Ejecutando operación en ALU"})]}),t==="idle"&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 rounded-full bg-stone-400"}),h.jsx("span",{children:"CPU en espera de instrucciones"})]})]})}),h.jsx("div",{className:"text-center text-[8px] text-stone-500",children:"Haz clic en las fases para ver detalles"})]})});t$.displayName="ExecutionPhases";const Toe=x.memo(({steps:t,onStepChange:e,onComplete:n,className:i})=>{const[r,s]=x.useState(0),[o,a]=x.useState(!1),[l,c]=x.useState(2e3),u=t[r],d=r===0,f=r===t.length-1,p=x.useCallback(b=>{const w=Math.max(0,Math.min(b,t.length-1));s(w),e==null||e(w)},[t.length,e]),m=x.useCallback(()=>{f?(a(!1),n==null||n()):p(r+1)},[r,f,p,n]),g=x.useCallback(()=>{d||p(r-1)},[r,d,p]),y=x.useCallback(()=>{p(0),a(!1)},[p]),v=x.useCallback(()=>{a(!o)},[o]);return o&&!f&&setTimeout(m,l),h.jsxs("div",{className:re("rounded-lg border border-stone-600 bg-stone-900 p-4",i),children:[h.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[h.jsx("h3",{className:"text-lg font-semibold text-mantis-400",children:"Modo Paso a Paso"}),h.jsx("div",{className:"flex items-center gap-2",children:h.jsxs("span",{className:"text-sm text-stone-400",children:["Paso ",r+1," de ",t.length]})})]}),h.jsx(t$,{currentPhase:u==null?void 0:u.phase,className:"mb-4"}),h.jsxs("div",{className:"mb-4 rounded-lg bg-stone-800 p-4",children:[h.jsx("div",{className:"mb-2 flex items-center gap-2",children:h.jsx("span",{className:"text-sm font-medium text-mantis-400",children:u==null?void 0:u.title})}),h.jsx("p",{className:"mb-3 text-sm text-stone-300",children:u==null?void 0:u.description}),(u==null?void 0:u.instruction)&&h.jsxs("div",{className:"mb-3 rounded bg-stone-700 p-2",children:[h.jsx("span",{className:"text-xs text-stone-400",children:"Instrucción:"}),h.jsx("div",{className:"font-mono text-sm text-mantis-400",children:u.instruction})]}),(u==null?void 0:u.registers)&&h.jsx("div",{className:"mb-3 grid grid-cols-2 gap-4",children:h.jsxs("div",{children:[h.jsx("span",{className:"text-xs text-stone-400",children:"Registros:"}),h.jsx("div",{className:"mt-1 space-y-1",children:Object.entries(u.registers).map(([b,w])=>h.jsxs("div",{className:"flex justify-between text-xs",children:[h.jsxs("span",{className:"text-stone-300",children:[b,":"]}),h.jsx("span",{className:"font-mono text-mantis-400",children:w})]},b))})]})}),(u==null?void 0:u.memory)&&h.jsxs("div",{children:[h.jsx("span",{className:"text-xs text-stone-400",children:"Memoria:"}),h.jsx("div",{className:"mt-1 grid grid-cols-4 gap-1",children:Object.entries(u.memory).map(([b,w])=>h.jsxs("div",{className:"text-center text-xs",children:[h.jsx("div",{className:"text-stone-500",children:b}),h.jsx("div",{className:"font-mono text-mantis-400",children:w})]},b))})]})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("div",{className:"flex items-center gap-2",children:h.jsxs(Ct,{variant:"outline",size:"sm",onClick:y,disabled:d&&!o,className:"flex items-center gap-1",children:[h.jsx(Ye,{icon:Aj}),"Reiniciar"]})}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(Ct,{variant:"outline",size:"sm",onClick:g,disabled:d,className:"flex items-center gap-1",children:[h.jsx(Ye,{icon:Nj}),"Anterior"]}),h.jsxs(Ct,{variant:o?"secondary":"default",size:"sm",onClick:v,className:"flex items-center gap-1",children:[h.jsx(Ye,{icon:o?Xh:Ib}),o?"Pausar":"Reproducir"]}),h.jsxs(Ct,{variant:"outline",size:"sm",onClick:m,disabled:f,className:"flex items-center gap-1",children:["Siguiente",h.jsx(Ye,{icon:qC})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-stone-400",children:"Velocidad:"}),h.jsxs("select",{value:l,onChange:b=>c(Number(b.target.value)),className:"rounded border border-stone-600 bg-stone-800 px-2 py-1 text-xs",children:[h.jsx("option",{value:1e3,children:"Rápida"}),h.jsx("option",{value:2e3,children:"Normal"}),h.jsx("option",{value:4e3,children:"Lenta"})]})]})]}),h.jsx("div",{className:"mt-4",children:h.jsx("div",{className:"h-2 w-full rounded-full bg-stone-700",children:h.jsx("div",{className:"h-2 rounded-full bg-mantis-500 transition-all duration-300",style:{width:`${(r+1)/t.length*100}%`}})})})]})});Toe.displayName="StepByStepMode";const Ooe=x.memo(({from:t,to:e,data:n,duration:i,className:r,onComplete:s})=>{const[o,a]=x.useState(!1),[l,c]=x.useState(0),[u]=Oo(),f=Math.min(u.executionUnit,250),p=i??(u.animations?f*2:1e3);return x.useEffect(()=>{a(!0),c(0);const m=Date.now(),g=()=>{const y=Date.now()-m,v=Math.min(y/p,1);c(v),v<1?requestAnimationFrame(g):setTimeout(()=>{a(!1),s==null||s()},500)};requestAnimationFrame(g)},[t,e,n,p,s]),o?h.jsxs("div",{className:re("pointer-events-none absolute inset-0",r),children:[h.jsxs("svg",{className:"absolute inset-0 size-full",children:[h.jsx("defs",{children:h.jsxs("linearGradient",{id:"dataFlowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[h.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:"0.8"}),h.jsx("stop",{offset:"50%",stopColor:"#10b981",stopOpacity:"1"}),h.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:"0.8"})]})}),h.jsx("path",{d:`M ${t} L ${e}`,stroke:"url(#dataFlowGradient)",strokeWidth:"3",strokeDasharray:"10,5",strokeDashoffset:20-l*20,fill:"none",className:"animate-pulse"})]}),["Read","Write"].includes(n)?(()=>{const[m,g]=t.split(" ").map(Number),[y,v]=e.split(" ").map(Number),b=m+(y-m)*l,w=g+(v-g)*l;return h.jsx("div",{className:`absolute z-[100] select-none text-lg font-extrabold ${n==="Read"?"text-red-500":"text-orange-400"}`,style:{left:b,top:w-32,textShadow:"0 0 4px #000, 0 0 2px #000",background:"rgba(0,0,0,0.2)",padding:"2px 8px",borderRadius:"6px",transition:"left 0.1s linear, top 0.1s linear",opacity:o?1:0,pointerEvents:"none"},children:n})})():h.jsxs("div",{className:re("absolute rounded bg-mantis-500 px-2 py-1 font-mono text-xs text-white","border border-mantis-400 shadow-lg","transition-all duration-300 ease-out"),style:{left:`${l*100}%`,transform:"translateX(-50%)",top:"50%",marginTop:"-12px"},children:[n,h.jsx("div",{className:"absolute -top-1 left-1/2 size-0 -translate-x-1/2 border-x-4 border-b-4 border-transparent border-b-mantis-500"})]})]}):null});Ooe.displayName="DataFlowAnimation";const Loe={"cpu-components":{title:"Componentes de la CPU",description:"Visualiza los componentes principales de la CPU: ALU, Unidad de Control y registros",steps:[{id:"overview",title:"Vista General de la CPU",description:"Estructura general de la CPU VonSim8",duration:3e3,animation:{type:"highlight",targets:["CPU-container"],data:{title:"CPU",description:"Se basa en el procesador Intel 8086 de 16 bits, pero por simplicidad usamos registros de 8 bits."}}},{id:"alu",title:"ALU (Unidad Aritmético-Lógica)",description:"Ejecuta operaciones aritméticas y lógicas",duration:2500,animation:{type:"highlight",targets:["ALU"],data:{description:"Ejecuta operaciones aritméticas (como ADD + y SUB —) y lógicas.",icon:"⚙️"}}},{id:"control-unit",title:"Unidad de Control",description:"Coordina el funcionamiento de todos los componentes",duration:2500,animation:{type:"highlight",targets:["control-unit"],data:{description:"Coordina el funcionamiento de todos los componentes internos de la CPU.",components:["Decodificador","INSTRUCCIÓN"]}}},{id:"flags",title:"Registro de Flags",description:"Indicadores del estado de las operaciones",duration:2e3,animation:{type:"highlight",targets:["FLAGS"],data:{description:"Contiene indicadores del estado: C (Carry) y Z (Zero)",flags:["C","Z"]}}}]},"registers-overview":{title:"Registros de la CPU",description:"Visualiza los diferentes tipos de registros y sus funciones",steps:[{id:"general-purpose",title:"Registros de Propósito General",description:"AL, BL, CL, DL - registros para datos",duration:2500,animation:{type:"highlight",targets:["AL","BL","CL","DL"],data:{description:"Las instrucciones utilizan estos registros como operandos: AL, BL, CL, DL.",registers:["AL","BL","CL","DL"]}}},{id:"instruction-pointer",title:"Puntero de Instrucción (IP)",description:"Contiene la dirección de la próxima instrucción",duration:2e3,animation:{type:"highlight",targets:["IP"],data:{description:"Contiene la dirección de la próxima instrucción que se ejecutará.",color:"red"}}},{id:"instruction-register",title:"Registro de Instrucción (IR)",description:"Contiene la instrucción en curso",duration:2e3,animation:{type:"highlight",targets:["IR"],data:{description:"Contiene la instrucción en curso para su decodificación y ejecución.",color:"purple"}}},{id:"memory-registers",title:"Registros de Memoria",description:"MAR y MBR - para comunicación con memoria",duration:2500,animation:{type:"highlight",targets:["MAR","MBR"],data:{description:"MAR: dirección de memoria. MBR: datos transferidos.",registers:["MAR","MBR"]}}}]},"memory-structure":{title:"Estructura de Memoria",description:"Visualiza la organización de la memoria RAM y los buses",steps:[{id:"memory-grid",title:"Matriz de Memoria",description:"256 celdas organizadas en 16x16",duration:3e3,animation:{type:"highlight",targets:["memory-grid"],data:{description:"Compuesta por 256 celdas, cada una de 1 byte. Las direcciones y contenidos están representados en hexadecimal.",size:"16x16",cells:256}}},{id:"addressing",title:"Dirección de Memoria",description:"Formación de direcciones hexadecimales",duration:2500,animation:{type:"highlight",targets:["address-example"],data:{description:"La dirección 12h se obtiene de la intersección de la fila 1 y la columna 2.",example:"12h = fila 1, columna 2"}}},{id:"data-bus",title:"Bus de Datos",description:"Transferencia bidireccional de datos",duration:2e3,animation:{type:"flow",targets:["data-bus"],data:{description:"Transfiere entre CPU y memoria en ambos sentidos. Es bidireccional.",direction:"bidirectional"}}},{id:"address-bus",title:"Bus de Direcciones",description:"Envío de direcciones a memoria",duration:2e3,animation:{type:"flow",targets:["address-bus"],data:{description:"Envía desde la CPU a la memoria la dirección de la celda a leer o escribir. Es unidireccional.",direction:"unidirectional"}}},{id:"control-bus",title:"Buses de Control",description:"Señales de control para memoria",duration:2e3,animation:{type:"highlight",targets:["control-bus"],data:{description:"Transmiten las órdenes de lectura o escritura hacia la memoria.",signals:["rd","wr"]}}}]},"fetch-decode-execute":{title:"Ciclo Fetch-Decode-Execute",description:"Visualiza las tres fases del ciclo de instrucción",steps:[{id:"fetch",title:"Fase Fetch",description:"La CPU lee la instrucción desde memoria",duration:2e3,animation:{type:"flow",targets:["IP","MAR","MBR"],data:{from:"IP",to:"MBR",value:"A1"}}},{id:"decode",title:"Fase Decode",description:"La CPU interpreta la instrucción",duration:2e3,animation:{type:"highlight",targets:["IR"],data:{instruction:"MOV AL, 5"}}},{id:"execute",title:"Fase Execute",description:"La CPU ejecuta la operación",duration:2e3,animation:{type:"transform",targets:["AL"],data:{newValue:"05"}}}]},"memory-access":{title:"Acceso a Memoria",description:"Cómo la CPU lee y escribe en memoria RAM",steps:[{id:"address-setup",title:"Configurar Dirección",description:"La CPU coloca la dirección en el MAR",duration:1500,animation:{type:"highlight",targets:["MAR"],data:{address:"A0"}}},{id:"memory-read",title:"Lectura de Memoria",description:"El contenido se transfiere al MBR",duration:1500,animation:{type:"flow",targets:["memory-cell-A0","MBR"],data:{from:"memory",to:"MBR",value:"42"}}},{id:"data-transfer",title:"Transferencia de Datos",description:"Los datos se mueven al registro destino",duration:1500,animation:{type:"flow",targets:["MBR","AL"],data:{from:"MBR",to:"AL",value:"42"}}}]},"register-transfer":{title:"Transferencia entre Registros",description:"Movimiento de datos entre registros de la CPU",steps:[{id:"source-read",title:"Leer Registro Origen",description:"El valor se lee del registro origen",duration:1e3,animation:{type:"highlight",targets:["AL"],data:{value:"25"}}},{id:"bus-transfer",title:"Transferencia por Bus",description:"Los datos viajan por el bus interno",duration:1500,animation:{type:"flow",targets:["AL","BL"],data:{from:"AL",to:"BL",value:"25"}}},{id:"destination-write",title:"Escribir Registro Destino",description:"El valor se almacena en el registro destino",duration:1e3,animation:{type:"transform",targets:["BL"],data:{newValue:"25"}}}]},"alu-operation":{title:"Operación ALU",description:"Proceso de operación aritmética o lógica",steps:[{id:"operand-load",title:"Cargar Operandos",description:"Los operandos se cargan en la ALU",duration:1500,animation:{type:"highlight",targets:["AL","BL"],data:{operand1:"10",operand2:"05"}}},{id:"operation-execute",title:"Ejecutar Operación",description:"La ALU realiza la operación",duration:2e3,animation:{type:"sequence",targets:["ALU"],data:{operation:"ADD",result:"15"}}},{id:"result-store",title:"Almacenar Resultado",description:"El resultado se guarda en el registro destino",duration:1500,animation:{type:"transform",targets:["AL"],data:{newValue:"15"}}}]},"bus-communication":{title:"Comunicación por Bus",description:"Cómo los componentes se comunican a través del bus",steps:[{id:"bus-request",title:"Solicitud de Bus",description:"Un componente solicita acceso al bus",duration:1e3,animation:{type:"highlight",targets:["CPU"],data:{requesting:!0}}},{id:"bus-grant",title:"Concesión de Bus",description:"El bus se concede al componente solicitante",duration:1e3,animation:{type:"highlight",targets:["data-bus"],data:{granted:!0}}},{id:"data-transfer",title:"Transferencia de Datos",description:"Los datos se transfieren por el bus",duration:2e3,animation:{type:"flow",targets:["data-bus"],data:{data:"A1B2",direction:"CPU-to-Memory"}}},{id:"bus-release",title:"Liberación de Bus",description:"El bus se libera para otros componentes",duration:1e3,animation:{type:"highlight",targets:["data-bus"],data:{released:!0}}}]}},Doe=x.memo(({concept:t,onClose:e,className:n})=>{const[i,r]=x.useState(0),[s,o]=x.useState(!1),[a,l]=x.useState(!1),[c,u]=x.useState(!1),d=Loe[t],f=d.steps[i],p=i===0,m=i===d.steps.length-1;x.useEffect(()=>{if(s){const C=setTimeout(()=>{m?o(!1):r(E=>E+1)},f.duration);return()=>clearTimeout(C)}},[s,i,m,f.duration]);const g=x.useCallback(()=>{m||r(C=>C+1)},[m]),y=x.useCallback(()=>{p||r(C=>C-1)},[p]),v=x.useCallback(()=>{r(0),o(!1)},[]),b=x.useCallback(()=>{o(!s)},[s]),w=x.useCallback(()=>{l(!a)},[a]),k=()=>{const{type:C,targets:E,data:_}=f.animation;switch(C){case"highlight":return h.jsxs("div",{className:"relative",children:[E.map((A,R)=>h.jsx("div",{className:"absolute inset-0 animate-pulse rounded border-2 border-mantis-400 bg-mantis-400/20",style:{animationDelay:`${R*200}ms`}},R)),_&&h.jsx("div",{className:"absolute right-2 top-2 rounded bg-mantis-500 px-2 py-1 text-xs text-white",children:Object.entries(_).map(([A,R])=>h.jsxs("div",{children:[A,": ",String(R)]},A))})]});case"flow":return h.jsxs("div",{className:"relative",children:[h.jsxs("svg",{className:"absolute inset-0 size-full",children:[h.jsx("defs",{children:h.jsxs("linearGradient",{id:"flowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[h.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:"0.8"}),h.jsx("stop",{offset:"50%",stopColor:"#10b981",stopOpacity:"1"}),h.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:"0.8"})]})}),h.jsx("path",{d:`M ${"from"in _&&_.from||"0,0"} L ${"to"in _&&_.to||"100,100"}`,stroke:"url(#flowGradient)",strokeWidth:"3",strokeDasharray:"10,5",className:"animate-pulse"})]}),"value"in _&&_.value&&h.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:h.jsx("div",{className:"rounded bg-mantis-500 px-2 py-1 font-mono text-xs text-white",children:_.value})})]});case"transform":return h.jsxs("div",{className:"relative",children:[E.map((A,R)=>h.jsx("div",{className:"absolute inset-0 animate-ping rounded bg-mantis-400/30",style:{animationDelay:`${R*300}ms`}},R)),"newValue"in _&&_.newValue&&h.jsxs("div",{className:"absolute left-2 top-2 rounded bg-mantis-500 px-2 py-1 font-mono text-xs text-white",children:["Nuevo: ",_.newValue]})]});case"sequence":return h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:h.jsx("div",{className:"rounded-lg bg-mantis-500 px-4 py-2 font-mono text-sm text-white",children:"operation"in _&&_.operation?_.operation:"Operación"})}),"result"in _&&_.result&&h.jsxs("div",{className:"absolute bottom-2 right-2 rounded bg-green-500 px-2 py-1 font-mono text-xs text-white",children:["= ",_.result]})]});default:return null}};return h.jsx("div",{className:re("fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",a&&"p-0",n),children:h.jsxs("div",{className:re("rounded-lg border border-stone-600 bg-stone-900 shadow-xl",a?"size-full":"max-h-[90vh] w-full max-w-4xl"),children:[h.jsxs("div",{className:"border-b border-stone-600 p-4",children:[h.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[h.jsx("h2",{className:"text-lg font-semibold text-mantis-400",children:d.title}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Ct,{variant:"ghost",size:"sm",onClick:()=>u(!c),className:"text-stone-400 hover:text-mantis-400",children:h.jsx(Ye,{icon:Pj})}),h.jsx(Ct,{variant:"ghost",size:"sm",onClick:w,className:"text-stone-400 hover:text-mantis-400",children:h.jsx(Ye,{icon:a?VY:iJ})}),h.jsx(Ct,{variant:"ghost",size:"sm",onClick:e,className:"text-stone-400 hover:text-white",children:"×"})]})]}),h.jsxs("div",{className:"flex items-center gap-4 text-sm text-stone-400",children:[h.jsxs("span",{children:["Paso ",i+1," de ",d.steps.length]}),h.jsx("span",{children:"•"}),h.jsxs("span",{children:[f.duration/1e3,"s"]})]}),h.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-stone-700",children:h.jsx("div",{className:"h-2 rounded-full bg-mantis-500 transition-all duration-300",style:{width:`${(i+1)/d.steps.length*100}%`}})})]}),h.jsxs("div",{className:"flex-1 p-4",children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("h3",{className:"mb-2 text-base font-medium text-white",children:f.title}),h.jsx("p",{className:"text-sm text-stone-300",children:f.description})]}),h.jsxs("div",{className:"relative h-64 overflow-hidden rounded-lg border border-stone-600 bg-stone-800",children:[k(),c&&h.jsxs("div",{className:"absolute left-2 top-2 max-w-xs rounded border border-stone-600 bg-stone-900/90 p-3",children:[h.jsx("h4",{className:"mb-2 font-medium text-mantis-400",children:"Información"}),h.jsx("p",{className:"text-xs text-stone-300",children:d.description}),h.jsxs("div",{className:"mt-2 text-xs text-stone-400",children:[h.jsxs("div",{children:["Tipo de animación: ",f.animation.type]}),h.jsxs("div",{children:["Elementos: ",f.animation.targets.join(", ")]})]})]})]})]}),h.jsx("div",{className:"border-t border-stone-600 p-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(Ct,{variant:"outline",size:"sm",onClick:v,className:"flex items-center gap-1",children:[h.jsx(Ye,{icon:GY}),"Reiniciar"]}),h.jsx(Ct,{variant:"outline",size:"sm",onClick:y,disabled:p,className:"flex items-center gap-1",children:"Anterior"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(Ct,{variant:"outline",size:"sm",onClick:b,className:"flex items-center gap-1",children:[h.jsx(Ye,{icon:s?Xh:Ib}),s?"Pausar":"Reproducir"]}),h.jsx(Ct,{variant:"outline",size:"sm",onClick:g,disabled:m,className:"flex items-center gap-1",children:"Siguiente"})]})]})})]})})});Doe.displayName="ConceptVisualizer";const joe=[{id:"cpu-components",title:"Componentes de la CPU",description:"Aprende sobre los componentes principales de la CPU: ALU, Unidad de Control y registros",difficulty:"beginner",estimatedTime:12,steps:[{id:"intro",title:"Introducción a la CPU",description:"¿Qué es una CPU y para qué sirve?",content:"La CPU (Unidad Central de Procesamiento) es el cerebro de la computadora. Se encarga de ejecutar instrucciones y procesar datos. En VonSim8, se basa en el procesador Intel 8086 de 16 bits, pero por simplicidad usamos registros de 8 bits.",type:"explanation",completed:!1},{id:"alu",title:"ALU (Unidad Aritmético-Lógica)",description:"El componente que ejecuta operaciones matemáticas y lógicas",content:"La ALU ejecuta operaciones aritméticas (como ADD + y SUB —) y lógicas. Es el componente que realiza los cálculos dentro de la CPU. En el diagrama, puedes ver la ALU representada como un bloque azul con un ícono de engranaje.",type:"explanation",completed:!1},{id:"control-unit",title:"Unidad de Control (UC)",description:"Coordina el funcionamiento de todos los componentes",content:"La Unidad de Control coordina el funcionamiento de todos los componentes internos de la CPU. Contiene el decodificador que interpreta las instrucciones y genera las señales de control necesarias para ejecutar cada operación.",type:"explanation",completed:!1},{id:"flags",title:"Registro de Flags",description:"Indicadores del estado de las operaciones",content:"El registro FLAGS contiene indicadores del estado de las operaciones. Los flags más importantes son C (Carry) y Z (Zero). El flag Carry indica si hubo acarreo en una operación, y el flag Zero indica si el resultado fue cero.",type:"explanation",completed:!1},{id:"cpu-quiz",title:"Evaluación: Componentes de la CPU",description:"Pon a prueba tu conocimiento sobre los componentes de la CPU",type:"quiz",content:"",exercise:{question:"¿Cuál de estos componentes ejecuta las operaciones aritméticas y lógicas en la CPU?",options:["Unidad de Control","ALU","Registros","Memoria"],correctAnswer:1,explanation:"La ALU (Unidad Aritmético-Lógica) es específicamente la responsable de ejecutar operaciones matemáticas y lógicas dentro de la CPU."},completed:!1}]},{id:"registers",title:"Registros de la CPU",description:"Comprende los diferentes tipos de registros y sus funciones",difficulty:"beginner",estimatedTime:15,steps:[{id:"registers-intro",title:"¿Qué son los Registros?",description:"Memoria rápida dentro de la CPU",content:"Los registros son espacios de almacenamiento (memoria) dentro de la CPU. Son más rápidos que la RAM pero tienen menos capacidad. Se utilizan para almacenar datos temporalmente durante la ejecución de instrucciones.",type:"explanation",completed:!1},{id:"general-purpose",title:"Registros de Propósito General",description:"AL, BL, CL, DL - registros para datos",content:"Los registros de propósito general (AL, BL, CL, DL) son utilizados por las instrucciones como operandos. Pueden almacenar datos, direcciones o resultados de operaciones. En VonSim8, cada uno puede almacenar 8 bits (1 byte).",type:"explanation",completed:!1},{id:"instruction-pointer",title:"Puntero de Instrucción (IP)",description:"Contiene la dirección de la próxima instrucción",content:"El Puntero de Instrucción (IP) contiene la dirección de la próxima instrucción que se ejecutará. Se incrementa automáticamente después de cada instrucción para apuntar a la siguiente en memoria.",type:"explanation",completed:!1},{id:"instruction-register",title:"Registro de Instrucción (IR)",description:"Contiene la instrucción en curso",content:"El Registro de Instrucción (IR) contiene la instrucción en curso para su decodificación y ejecución. Es donde la CPU almacena temporalmente la instrucción que está procesando.",type:"explanation",completed:!1},{id:"memory-registers",title:"Registros de Memoria",description:"MAR y MBR - para comunicación con memoria",content:"MAR (Memory Address Register) contiene la dirección de memoria donde se desea leer o escribir. MBR (Memory Buffer Register) contiene datos que se transfieren hacia o desde la memoria. Estos registros facilitan la comunicación entre la CPU y la memoria RAM.",type:"explanation",completed:!1},{id:"registers-quiz",title:"Evaluación: Registros",description:"Pon a prueba tu conocimiento sobre los registros",type:"quiz",content:"Responde correctamente para continuar con el tutorial.",exercise:{question:"¿Cuál de estos registros contiene la dirección de la próxima instrucción a ejecutar?",options:["IR","IP","MAR","MBR"],correctAnswer:1,explanation:"El Puntero de Instrucción (IP) es el registro que contiene la dirección de la próxima instrucción que se ejecutará."},completed:!1}]},{id:"memory",title:"Memoria RAM",description:"Comprende cómo funciona la memoria principal y su acceso",difficulty:"beginner",estimatedTime:10,steps:[{id:"memory-intro",title:"¿Qué es la Memoria RAM?",description:"La memoria de acceso aleatorio",content:"La memoria RAM (Random Access Memory) está compuesta por 256 celdas, cada una de 1 byte. Las direcciones y contenidos están representados en hexadecimal. Es donde se almacenan programas y datos temporalmente durante la ejecución.",type:"explanation",completed:!1},{id:"memory-addressing",title:"Dirección de Memoria",description:"Cómo se forman las direcciones",content:"La dirección de memoria se expresa en hexadecimal y se forma combinando el número de fila y columna. Por ejemplo: la dirección 12h se obtiene de la intersección de la fila 1 y la columna 2 en la matriz de memoria.",type:"explanation",completed:!1},{id:"data-bus",title:"Bus de Datos",description:"Transferencia bidireccional de datos",content:"El bus de datos transfiere información entre la CPU y memoria en ambos sentidos. Es bidireccional, permitiendo tanto la lectura como la escritura de datos en memoria.",type:"explanation",completed:!1},{id:"address-bus",title:"Bus de Direcciones",description:"Envío de direcciones a memoria",content:"El bus de direcciones envía desde la CPU a la memoria la dirección de la celda a leer o escribir. Es unidireccional, ya que solo la CPU puede especificar direcciones de memoria.",type:"explanation",completed:!1},{id:"control-bus",title:"Buses de Control",description:"Señales de control para memoria",content:"Los buses de control transmiten las órdenes de lectura o escritura hacia la memoria. Estas señales indican a la memoria qué operación realizar (leer o escribir) en la dirección especificada.",type:"explanation",completed:!1},{id:"memory-quiz",title:"Evaluación: Memoria",description:"Pon a prueba tu conocimiento sobre memoria",type:"quiz",content:"Responde correctamente para continuar con el tutorial.",exercise:{question:"¿Cuántas celdas de memoria tiene VonSim8 y cuánto almacena cada una?",options:["128 celdas de 2 bytes","256 celdas de 1 byte","512 celdas de 1 byte","256 celdas de 2 bytes"],correctAnswer:1,explanation:"VonSim8 tiene 256 celdas de memoria, cada una capaz de almacenar 1 byte (8 bits) de información."},completed:!1}]},{id:"cpu-basics",title:"Fundamentos de la CPU",description:"Aprende cómo funciona una CPU y sus componentes principales",difficulty:"beginner",estimatedTime:10,steps:[{id:"intro",title:"Introducción a la CPU",description:"¿Qué es una CPU y para qué sirve?",content:"La CPU (Unidad Central de Procesamiento) es el cerebro de la computadora. Se encarga de ejecutar instrucciones y procesar datos.",type:"explanation",completed:!1},{id:"registers",title:"Registros de la CPU",description:"Los registros son memoria rápida dentro de la CPU",content:"Los registros almacenan datos temporalmente durante la ejecución. Son más rápidos que la RAM pero tienen menos capacidad.",type:"explanation",completed:!1},{id:"program-counter",title:"Puntero de Instrucción",description:"El IP indica la siguiente instrucción a ejecutar",content:"El Puntero de Instrucción (IP) se incrementa automáticamente después de cada instrucción.",type:"explanation",completed:!1}]}],n$=x.memo(({tutorial:t,onComplete:e,onClose:n,className:i})=>{var I,G;const[r,s]=x.useState(0),[o,a]=x.useState(t.steps),[l,c]=x.useState(!1),[u,d]=x.useState(!1),[f,p]=x.useState(""),[m,g]=x.useState(null),y=o[r],v=r===0,b=r===o.length-1,k=o.filter(B=>B.completed).length/o.length*100,C=x.useCallback(()=>{e==null||e(t.id)},[t.id,e]),E=x.useCallback(()=>{b?C():(s(B=>B+1),g(null),p(""))},[b,C]),_=x.useCallback(()=>{v||(s(B=>B-1),g(null),p(""))},[v]),A=x.useCallback(()=>{a(B=>B.map((K,J)=>J===r?{...K,completed:!0}:K))},[r]),R=x.useCallback(()=>{if(!y.exercise)return;const B=f===y.exercise.correctAnswer.toString();g({correct:B,message:B?"¡Correcto!":`Incorrecto. ${y.exercise.explanation}`}),B&&(A(),setTimeout(()=>{E()},2e3))},[y,f,A,E]);x.useEffect(()=>{if(l&&y.type==="explanation"){const B=setTimeout(()=>{b?c(!1):E()},5e3);return()=>clearTimeout(B)}},[l,r,b,y.type,E]);const L=B=>{switch(B){case"beginner":return"text-blue-400";case"intermediate":return"text-yellow-400";case"advanced":return"text-purple-400";default:return"text-stone-400"}},O=B=>{switch(B){case"beginner":return xd;case"intermediate":return Nm;case"advanced":return KC;default:return xd}};return h.jsx("div",{className:re("fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",i),children:h.jsxs("div",{className:"max-h-[90vh] w-full max-w-2xl overflow-hidden rounded-lg border border-stone-600 bg-stone-900 shadow-xl",children:[h.jsxs("div",{className:"border-b border-stone-600 p-4",children:[h.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[h.jsx("h2",{className:"text-lg font-semibold text-mantis-400",children:t.title}),h.jsx(Ct,{variant:"ghost",size:"sm",onClick:n,className:"text-stone-400 hover:text-white",children:"×"})]}),h.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Ye,{icon:O(t.difficulty),className:L(t.difficulty)}),h.jsx("span",{className:L(t.difficulty),children:t.difficulty==="beginner"?"Básico":t.difficulty==="intermediate"?"Intermedio":"Avanzado"})]}),h.jsx("span",{className:"text-stone-400",children:"•"}),h.jsxs("span",{className:"text-stone-400",children:[t.estimatedTime," min"]}),h.jsx("span",{className:"text-stone-400",children:"•"}),h.jsxs("span",{className:"text-stone-400",children:["Paso ",r+1," de ",o.length]})]}),h.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-stone-700",children:h.jsx("div",{className:"h-2 rounded-full bg-mantis-500 transition-all duration-300",style:{width:`${k}%`}})})]}),h.jsxs("div",{className:"max-h-96 overflow-y-auto p-4",children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("h3",{className:"mb-2 text-base font-medium text-white",children:y.title}),h.jsx("p",{className:"mb-3 text-sm text-stone-300",children:y.description}),h.jsx("div",{className:"text-sm leading-relaxed text-stone-400",children:y.content})]}),y.type==="exercise"||y.type==="quiz"?h.jsxs("div",{className:"rounded-lg border border-stone-600 bg-stone-800 p-4",children:[h.jsx("h4",{className:"mb-3 font-medium text-white",children:(I=y.exercise)==null?void 0:I.question}),(G=y.exercise)!=null&&G.options?h.jsx("div",{className:"space-y-2",children:y.exercise.options.map((B,K)=>h.jsxs("label",{className:re("flex cursor-pointer items-center gap-3 rounded border p-3 transition-colors",f===K.toString()?"border-mantis-400 bg-mantis-400/20":"border-stone-600 bg-stone-700 hover:bg-stone-600"),children:[h.jsx("input",{type:"radio",name:"answer",value:K.toString(),checked:f===K.toString(),onChange:J=>p(J.target.value),className:"text-mantis-400"}),h.jsx("span",{className:"text-stone-300",children:B})]},K))}):h.jsx("input",{type:"text",value:f,onChange:B=>p(B.target.value),placeholder:"Escribe tu respuesta...",className:"w-full rounded border border-stone-600 bg-stone-700 p-2 text-white"}),m&&h.jsx("div",{className:re("mt-3 rounded border p-3",m.correct?"border-green-400 bg-green-400/20 text-green-400":"border-red-400 bg-red-400/20 text-red-400"),children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Ye,{icon:m.correct?uJ:Tb}),m.message]})}),y.hints&&y.hints.length>0&&h.jsxs("div",{className:"mt-3",children:[h.jsxs(Ct,{variant:"ghost",size:"sm",onClick:()=>d(!u),className:"text-mantis-400 hover:text-mantis-300",children:[h.jsx(Ye,{icon:xd,className:"mr-2"}),u?"Ocultar":"Mostrar"," Pistas"]}),u&&h.jsx("div",{className:"mt-2 rounded border border-stone-600 bg-stone-700 p-3",children:h.jsx("ul",{className:"space-y-1 text-sm text-stone-300",children:y.hints.map((B,K)=>h.jsxs("li",{children:["• ",B]},K))})})]})]}):null]}),h.jsx("div",{className:"border-t border-stone-600 p-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("div",{className:"flex items-center gap-2",children:h.jsxs(Ct,{variant:"outline",size:"sm",onClick:_,disabled:v,className:"flex items-center gap-1",children:[h.jsx(Ye,{icon:Nj}),"Anterior"]})}),h.jsx("div",{className:"flex items-center gap-2",children:y.type==="exercise"||y.type==="quiz"?h.jsx(Ct,{size:"sm",onClick:R,disabled:!f,className:"bg-mantis-600 hover:bg-mantis-700",children:"Verificar Respuesta"}):h.jsxs(Ct,{size:"sm",onClick:E,className:"flex items-center gap-1 bg-mantis-600 hover:bg-mantis-700",children:[b?"Completar Tutorial":"Siguiente",!b&&h.jsx(Ye,{icon:qC})]})})]})})]})})});n$.displayName="InteractiveTutorial";const i$=x.memo(({isOpen:t=!1,onShowProgress:e})=>{const[n,i]=x.useState(!1),[r,s]=x.useState(!1),[o,a]=x.useState(null),l=f=>{console.log("Tutorial seleccionado:",f),a(f),s(!0)},c=()=>{s(!1),a(null)},u=[{id:"progress",title:"Progreso Educativo",description:"Ver logros y estadísticas de aprendizaje",icon:XC,color:"text-yellow-400",action:()=>e==null?void 0:e()},{id:"tutorials",title:"Tutoriales Interactivos",description:"Aprende paso a paso con ejercicios",icon:cJ,color:"text-blue-400",action:()=>i(!n)}],d=[{id:"cpu-components",title:"Componentes de la CPU",description:"ALU, Unidad de Control y registros",difficulty:"Básico",duration:"12 min"},{id:"registers",title:"Registros de la CPU",description:"Tipos y funciones de registros",difficulty:"Básico",duration:"15 min"},{id:"memory",title:"Memoria RAM",description:"Funcionamiento de la memoria principal",difficulty:"Básico",duration:"10 min"}];return h.jsxs(h.Fragment,{children:[t&&h.jsx("div",{className:"fixed bottom-12 left-1/2 z-50 -translate-x-1/2",children:h.jsxs("div",{className:"min-w-80 rounded-lg border border-stone-600 bg-stone-900 p-4 shadow-xl",children:[h.jsxs("div",{className:"mb-4 text-center",children:[h.jsx("h3",{className:"mb-1 text-lg font-semibold text-mantis-400",children:"Centro de Aprendizaje"}),h.jsx("p",{className:"text-sm text-stone-400",children:"Explora herramientas educativas interactivas"})]}),h.jsx("div",{className:"space-y-2",children:u.map(f=>h.jsx("div",{children:f.id==="tutorials"?h.jsxs("div",{children:[h.jsxs("button",{onClick:f.action,className:re("w-full rounded-lg border border-stone-600 p-3 text-left hover:bg-stone-800","flex items-center gap-3 transition-all duration-200"),children:[h.jsx(Ye,{icon:f.icon,className:re("text-lg",f.color)}),h.jsxs("div",{className:"flex-1",children:[h.jsx("div",{className:"font-medium text-white",children:f.title}),h.jsx("div",{className:"text-sm text-stone-400",children:f.description})]}),h.jsx(Ye,{icon:Ib,className:re("text-sm text-stone-400",n&&"text-blue-400")})]}),n&&h.jsx("div",{className:"ml-8 mt-2 space-y-1",children:d.map(p=>h.jsx("button",{onClick:()=>l(p.id),className:"w-full rounded border border-stone-700 p-2 text-left transition-colors hover:bg-stone-800",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-medium text-white",children:p.title}),h.jsx("div",{className:"text-xs text-stone-400",children:p.description})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("div",{className:"text-xs text-blue-400",children:p.difficulty}),h.jsx("div",{className:"text-xs text-stone-500",children:p.duration})]})]})},p.id))})]}):h.jsxs("button",{onClick:f.action,className:re("w-full rounded-lg border border-stone-600 p-3 text-left hover:bg-stone-800","flex items-center gap-3 transition-all duration-200"),children:[h.jsx(Ye,{icon:f.icon,className:re("text-lg",f.color)}),h.jsxs("div",{className:"flex-1",children:[h.jsx("div",{className:"font-medium text-white",children:f.title}),h.jsx("div",{className:"text-sm text-stone-400",children:f.description})]})]})},f.id))}),h.jsx("div",{className:"mt-4 border-t border-stone-600 pt-3",children:h.jsxs("div",{className:"flex items-center justify-between text-xs text-stone-400",children:[h.jsx("span",{children:"Herramientas educativas"}),h.jsx("span",{children:"VonSim8"})]})})]})}),r&&o&&(()=>{const f=joe.find(p=>p.id===o);return console.log("Tutorial encontrado:",f),f?h.jsx(n$,{tutorial:f,onComplete:c,onClose:()=>{console.log("Cerrando tutorial"),s(!1),a(null)}}):(console.error("Tutorial no encontrado:",o),null)})()]})});i$.displayName="EducationalMenu";const M3=[{id:"first_program",type:"programs_written",title:"Primer Programa",description:"Escribe tu primer programa en ensamblador",icon:xd,requirement:1,current:0,unlocked:!1,points:10},{id:"instruction_master",type:"instructions_executed",title:"Maestro de Instrucciones",description:"Ejecuta 100 instrucciones",icon:dR,requirement:100,current:0,unlocked:!1,points:25},{id:"cpu_components_master",type:"concept_mastered",title:"Conocedor de Componentes",description:"Comprende los componentes principales de la CPU",icon:fR,requirement:1,current:0,unlocked:!1,points:20},{id:"registers_expert",type:"concept_mastered",title:"Experto en Registros",description:"Domina los diferentes tipos de registros",icon:dR,requirement:1,current:0,unlocked:!1,points:25},{id:"memory_explorer",type:"concept_mastered",title:"Explorador de Memoria",description:"Comprende el funcionamiento de la memoria RAM",icon:hJ,requirement:1,current:0,unlocked:!1,points:15},{id:"cpu_architect",type:"concept_mastered",title:"Arquitecto de CPU",description:"Domina los conceptos de arquitectura de CPU",icon:fR,requirement:1,current:0,unlocked:!1,points:30},{id:"persistent_learner",type:"time_spent",title:"Estudiante Persistente",description:"Pasa 30 minutos aprendiendo",icon:Nm,requirement:30,current:0,unlocked:!1,points:20},{id:"tutorial_master",type:"tutorials_completed",title:"Maestro de Tutoriales",description:"Completa un tutorial interactivo educativo",icon:XC,requirement:1,current:0,unlocked:!1,points:40}],R3=[{id:"beginner",name:"Principiante",description:"Conceptos básicos: CPU, registros y memoria",concepts:["cpu-components","registers","memory"],requiredPoints:0,unlocked:!0,completed:!1},{id:"intermediate",name:"Intermedio",description:"Operaciones aritméticas y ciclo de instrucción",concepts:["alu","bus"],requiredPoints:50,unlocked:!1,completed:!1},{id:"advanced",name:"Avanzado",description:"Interrupciones y programación compleja",concepts:["flags","stack","interrupts"],requiredPoints:100,unlocked:!1,completed:!1}],r$=x.memo(({className:t,isVisible:e=!1,onClose:n})=>{const[i,r]=x.useState(M3),[s,o]=x.useState(R3),[a,l]=x.useState(0),[c,u]=x.useState(0);x.useEffect(()=>{const y=localStorage.getItem("vonsim8-educational-progress");if(y)try{const v=JSON.parse(y);r(v.achievements||M3),o(v.levels||R3),l(v.totalPoints||0),u(v.sessionTime||0)}catch{}},[]);const d=x.useCallback(()=>{const y={achievements:i,levels:s,totalPoints:a,sessionTime:c,lastSaved:Date.now()};localStorage.setItem("vonsim8-educational-progress",JSON.stringify(y))},[i,s,a,c]),f=x.useCallback((y,v)=>{r(b=>{const w=b.map(C=>{if(C.type===y){const E=Math.min(C.current+v,C.requirement),_=C.unlocked,A=E>=C.requirement;return!_&&A&&p(C),{...C,current:E,unlocked:A}}return C}),k=w.filter(C=>C.unlocked).reduce((C,E)=>C+E.points,0);return l(k),o(C=>C.map(E=>({...E,unlocked:k>=E.requiredPoints}))),w})},[]),p=y=>{const v=document.createElement("div");v.className=re("fixed right-4 top-4 z-50 rounded-lg border-2 p-4 shadow-lg","animate-slide-in-right bg-mantis-500 text-white"),v.innerHTML=`
      <div class="flex items-center gap-3">
        <FontAwesomeIcon icon="${y.icon}" class="text-2xl" />
        <div>
          <div class="font-bold">¡Logro Desbloqueado!</div>
          <div class="text-sm">${y.title}</div>
        </div>
      </div>
    `,document.body.appendChild(v),setTimeout(()=>{v.remove()},3e3)};if(x.useEffect(()=>{const y=v=>{const{type:b,value:w=1}=v.detail;f(b,w)};return window.addEventListener("educational-progress",y),()=>window.removeEventListener("educational-progress",y)},[f]),x.useEffect(()=>{const y=setInterval(()=>{u(v=>{const b=v+1;return b%60===0&&f("time_spent",1),b})},1e3);return()=>clearInterval(y)},[f]),x.useEffect(()=>{const y=setInterval(d,3e4);return()=>clearInterval(y)},[d]),!e)return null;const m=i.filter(y=>y.unlocked),g=s.filter(y=>y.unlocked);return h.jsxs("div",{className:re("fixed bottom-20 right-4 z-50 h-80 w-96 rounded-lg border border-stone-600 bg-stone-900 shadow-xl",t),children:[h.jsxs("div",{className:"flex items-center justify-between border-b border-stone-600 p-3",children:[h.jsxs("h3",{className:"flex items-center gap-2 text-sm font-semibold text-mantis-400",children:[h.jsx(Ye,{icon:XC}),"Progreso Educativo"]}),h.jsx(Ct,{variant:"ghost",size:"sm",onClick:n,className:"text-xs text-stone-400 hover:text-white",children:"×"})]}),h.jsxs("div",{className:"h-64 space-y-3 overflow-y-auto p-3",children:[h.jsxs("div",{className:"rounded-lg bg-stone-800 p-3 text-center",children:[h.jsx("div",{className:"text-2xl font-bold text-mantis-400",children:a}),h.jsx("div",{className:"text-xs text-stone-400",children:"Puntos Totales"})]}),h.jsxs("div",{children:[h.jsxs("h4",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-stone-300",children:[h.jsx(Ye,{icon:Nm}),"Niveles de Aprendizaje"]}),h.jsx("div",{className:"space-y-1",children:s.map(y=>h.jsxs("div",{className:re("rounded border p-2 text-xs",y.unlocked?"border-mantis-400 bg-mantis-400/10 text-mantis-400":"border-stone-600 bg-stone-800 text-stone-500"),children:[h.jsx("div",{className:"font-medium",children:y.name}),h.jsx("div",{className:"text-stone-400",children:y.description}),!y.unlocked&&h.jsxs("div",{className:"mt-1 text-stone-500",children:["Requiere ",y.requiredPoints," puntos"]})]},y.id))})]}),h.jsxs("div",{children:[h.jsxs("h4",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-stone-300",children:[h.jsx(Ye,{icon:WY}),"Logros (",m.length,"/",i.length,")"]}),h.jsx("div",{className:"space-y-1",children:i.map(y=>h.jsx("div",{className:re("rounded border p-2 text-xs",y.unlocked?"border-mantis-400 bg-mantis-400/10":"border-stone-600 bg-stone-800"),children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Ye,{icon:y.icon,className:y.unlocked?"text-mantis-400":"text-stone-500"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("div",{className:re("font-medium",y.unlocked?"text-mantis-400":"text-stone-400"),children:y.title}),h.jsx("div",{className:"text-stone-500",children:y.description}),h.jsxs("div",{className:"mt-1",children:[h.jsx("div",{className:"h-1 w-full rounded-full bg-stone-700",children:h.jsx("div",{className:"h-1 rounded-full bg-mantis-400 transition-all duration-300",style:{width:`${y.current/y.requirement*100}%`}})}),h.jsxs("div",{className:"mt-1 text-stone-500",children:[y.current,"/",y.requirement]})]})]})]})},y.id))})]}),h.jsxs("div",{children:[h.jsxs("h4",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-stone-300",children:[h.jsx(Ye,{icon:YY}),"Estadísticas"]}),h.jsxs("div",{className:"text-xs text-stone-400",children:[h.jsxs("div",{children:["Tiempo de sesión: ",Math.floor(c/60),"m ",c%60,"s"]}),h.jsxs("div",{children:["Niveles completados: ",g.length,"/",s.length]})]})]})]})]})});r$.displayName="EducationalProgress";function My(t,[e,n]){return Math.min(n,Math.max(e,t))}function Boe(t,e=globalThis==null?void 0:globalThis.document){const n=Ir(t);x.useEffect(()=>{const i=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",i,{capture:!0}),()=>e.removeEventListener("keydown",i,{capture:!0})},[n,e])}var $oe="DismissableLayer",Uk="dismissableLayer.update",Foe="dismissableLayer.pointerDownOutside",zoe="dismissableLayer.focusOutside",I3,s$=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),$m=x.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:r,onFocusOutside:s,onInteractOutside:o,onDismiss:a,...l}=t,c=x.useContext(s$),[u,d]=x.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=x.useState({}),m=wt(e,_=>d(_)),g=Array.from(c.layers),[y]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=g.indexOf(y),b=u?g.indexOf(u):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,k=b>=v,C=Voe(_=>{const A=_.target,R=[...c.branches].some(L=>L.contains(A));!k||R||(r==null||r(_),o==null||o(_),_.defaultPrevented||a==null||a())},f),E=Hoe(_=>{const A=_.target;[...c.branches].some(L=>L.contains(A))||(s==null||s(_),o==null||o(_),_.defaultPrevented||a==null||a())},f);return Boe(_=>{b===c.layers.size-1&&(i==null||i(_),!_.defaultPrevented&&a&&(_.preventDefault(),a()))},f),x.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(I3=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),T3(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=I3)}},[u,f,n,c]),x.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),T3())},[u,c]),x.useEffect(()=>{const _=()=>p({});return document.addEventListener(Uk,_),()=>document.removeEventListener(Uk,_)},[]),h.jsx(et.div,{...l,ref:m,style:{pointerEvents:w?k?"auto":"none":void 0,...t.style},onFocusCapture:ke(t.onFocusCapture,E.onFocusCapture),onBlurCapture:ke(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:ke(t.onPointerDownCapture,C.onPointerDownCapture)})});$m.displayName=$oe;var Uoe="DismissableLayerBranch",o$=x.forwardRef((t,e)=>{const n=x.useContext(s$),i=x.useRef(null),r=wt(e,i);return x.useEffect(()=>{const s=i.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),h.jsx(et.div,{...t,ref:r})});o$.displayName=Uoe;function Voe(t,e=globalThis==null?void 0:globalThis.document){const n=Ir(t),i=x.useRef(!1),r=x.useRef(()=>{});return x.useEffect(()=>{const s=a=>{if(a.target&&!i.current){let l=function(){a$(Foe,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);i.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>i.current=!0}}function Hoe(t,e=globalThis==null?void 0:globalThis.document){const n=Ir(t),i=x.useRef(!1);return x.useEffect(()=>{const r=s=>{s.target&&!i.current&&a$(zoe,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function T3(){const t=new CustomEvent(Uk);document.dispatchEvent(t)}function a$(t,e,n,{discrete:i}){const r=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),i?RC(r,s):r.dispatchEvent(s)}var Woe=$m,Goe=o$,dw=0;function rA(){x.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??O3()),document.body.insertAdjacentElement("beforeend",t[1]??O3()),dw++,()=>{dw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),dw--}},[])}function O3(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var fw="focusScope.autoFocusOnMount",hw="focusScope.autoFocusOnUnmount",L3={bubbles:!1,cancelable:!0},qoe="FocusScope",i1=x.forwardRef((t,e)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:r,onUnmountAutoFocus:s,...o}=t,[a,l]=x.useState(null),c=Ir(r),u=Ir(s),d=x.useRef(null),f=wt(e,g=>l(g)),p=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(i){let g=function(w){if(p.paused||!a)return;const k=w.target;a.contains(k)?d.current=k:Ba(d.current,{select:!0})},y=function(w){if(p.paused||!a)return;const k=w.relatedTarget;k!==null&&(a.contains(k)||Ba(d.current,{select:!0}))},v=function(w){if(document.activeElement===document.body)for(const C of w)C.removedNodes.length>0&&Ba(a)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const b=new MutationObserver(v);return a&&b.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),b.disconnect()}}},[i,a,p.paused]),x.useEffect(()=>{if(a){j3.add(p);const g=document.activeElement;if(!a.contains(g)){const v=new CustomEvent(fw,L3);a.addEventListener(fw,c),a.dispatchEvent(v),v.defaultPrevented||(Koe(Qoe(l$(a)),{select:!0}),document.activeElement===g&&Ba(a))}return()=>{a.removeEventListener(fw,c),setTimeout(()=>{const v=new CustomEvent(hw,L3);a.addEventListener(hw,u),a.dispatchEvent(v),v.defaultPrevented||Ba(g??document.body,{select:!0}),a.removeEventListener(hw,u),j3.remove(p)},0)}}},[a,c,u,p]);const m=x.useCallback(g=>{if(!n&&!i||p.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,v=document.activeElement;if(y&&v){const b=g.currentTarget,[w,k]=Xoe(b);w&&k?!g.shiftKey&&v===k?(g.preventDefault(),n&&Ba(w,{select:!0})):g.shiftKey&&v===w&&(g.preventDefault(),n&&Ba(k,{select:!0})):v===b&&g.preventDefault()}},[n,i,p.paused]);return h.jsx(et.div,{tabIndex:-1,...o,ref:f,onKeyDown:m})});i1.displayName=qoe;function Koe(t,{select:e=!1}={}){const n=document.activeElement;for(const i of t)if(Ba(i,{select:e}),document.activeElement!==n)return}function Xoe(t){const e=l$(t),n=D3(e,t),i=D3(e.reverse(),t);return[n,i]}function l$(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function D3(t,e){for(const n of t)if(!Yoe(n,{upTo:e}))return n}function Yoe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Joe(t){return t instanceof HTMLInputElement&&"select"in t}function Ba(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&Joe(t)&&e&&t.select()}}var j3=Zoe();function Zoe(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=B3(t,e),t.unshift(e)},remove(e){var n;t=B3(t,e),(n=t[0])==null||n.resume()}}}function B3(t,e){const n=[...t],i=n.indexOf(e);return i!==-1&&n.splice(i,1),n}function Qoe(t){return t.filter(e=>e.tagName!=="A")}const eae=["top","right","bottom","left"],Hl=Math.min,wr=Math.max,Ry=Math.round,n0=Math.floor,Eo=t=>({x:t,y:t}),tae={left:"right",right:"left",bottom:"top",top:"bottom"},nae={start:"end",end:"start"};function Vk(t,e,n){return wr(t,Hl(e,n))}function ba(t,e){return typeof t=="function"?t(e):t}function xa(t){return t.split("-")[0]}function Pf(t){return t.split("-")[1]}function sA(t){return t==="x"?"y":"x"}function oA(t){return t==="y"?"height":"width"}const iae=new Set(["top","bottom"]);function vo(t){return iae.has(xa(t))?"y":"x"}function aA(t){return sA(vo(t))}function rae(t,e,n){n===void 0&&(n=!1);const i=Pf(t),r=aA(t),s=oA(r);let o=r==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=Iy(o)),[o,Iy(o)]}function sae(t){const e=Iy(t);return[Hk(t),e,Hk(e)]}function Hk(t){return t.replace(/start|end/g,e=>nae[e])}const $3=["left","right"],F3=["right","left"],oae=["top","bottom"],aae=["bottom","top"];function lae(t,e,n){switch(t){case"top":case"bottom":return n?e?F3:$3:e?$3:F3;case"left":case"right":return e?oae:aae;default:return[]}}function cae(t,e,n,i){const r=Pf(t);let s=lae(xa(t),n==="start",i);return r&&(s=s.map(o=>o+"-"+r),e&&(s=s.concat(s.map(Hk)))),s}function Iy(t){return t.replace(/left|right|bottom|top/g,e=>tae[e])}function uae(t){return{top:0,right:0,bottom:0,left:0,...t}}function c$(t){return typeof t!="number"?uae(t):{top:t,right:t,bottom:t,left:t}}function Ty(t){const{x:e,y:n,width:i,height:r}=t;return{width:i,height:r,top:n,left:e,right:e+i,bottom:n+r,x:e,y:n}}function z3(t,e,n){let{reference:i,floating:r}=t;const s=vo(e),o=aA(e),a=oA(o),l=xa(e),c=s==="y",u=i.x+i.width/2-r.width/2,d=i.y+i.height/2-r.height/2,f=i[a]/2-r[a]/2;let p;switch(l){case"top":p={x:u,y:i.y-r.height};break;case"bottom":p={x:u,y:i.y+i.height};break;case"right":p={x:i.x+i.width,y:d};break;case"left":p={x:i.x-r.width,y:d};break;default:p={x:i.x,y:i.y}}switch(Pf(e)){case"start":p[o]-=f*(n&&c?-1:1);break;case"end":p[o]+=f*(n&&c?-1:1);break}return p}const dae=async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:d}=z3(c,i,l),f=i,p={},m=0;for(let g=0;g<a.length;g++){const{name:y,fn:v}=a[g],{x:b,y:w,data:k,reset:C}=await v({x:u,y:d,initialPlacement:i,placement:f,strategy:r,middlewareData:p,rects:c,platform:o,elements:{reference:t,floating:e}});u=b??u,d=w??d,p={...p,[y]:{...p[y],...k}},C&&m<=50&&(m++,typeof C=="object"&&(C.placement&&(f=C.placement),C.rects&&(c=C.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):C.rects),{x:u,y:d}=z3(c,f,l)),g=-1)}return{x:u,y:d,placement:f,strategy:r,middlewareData:p}};async function cm(t,e){var n;e===void 0&&(e={});const{x:i,y:r,platform:s,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=ba(e,t),m=c$(p),y=a[f?d==="floating"?"reference":"floating":d],v=Ty(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(y)))==null||n?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),b=d==="floating"?{x:i,y:r,width:o.floating.width,height:o.floating.height}:o.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),k=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},C=Ty(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:w,strategy:l}):b);return{top:(v.top-C.top+m.top)/k.y,bottom:(C.bottom-v.bottom+m.bottom)/k.y,left:(v.left-C.left+m.left)/k.x,right:(C.right-v.right+m.right)/k.x}}const fae=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:r,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=ba(t,e)||{};if(c==null)return{};const d=c$(u),f={x:n,y:i},p=aA(r),m=oA(p),g=await o.getDimensions(c),y=p==="y",v=y?"top":"left",b=y?"bottom":"right",w=y?"clientHeight":"clientWidth",k=s.reference[m]+s.reference[p]-f[p]-s.floating[m],C=f[p]-s.reference[p],E=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let _=E?E[w]:0;(!_||!await(o.isElement==null?void 0:o.isElement(E)))&&(_=a.floating[w]||s.floating[m]);const A=k/2-C/2,R=_/2-g[m]/2-1,L=Hl(d[v],R),O=Hl(d[b],R),I=L,G=_-g[m]-O,B=_/2-g[m]/2+A,K=Vk(I,B,G),J=!l.arrow&&Pf(r)!=null&&B!==K&&s.reference[m]/2-(B<I?L:O)-g[m]/2<0,ne=J?B<I?B-I:B-G:0;return{[p]:f[p]+ne,data:{[p]:K,centerOffset:B-K-ne,...J&&{alignmentOffset:ne}},reset:J}}}),hae=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:r,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:g=!0,...y}=ba(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const v=xa(r),b=vo(a),w=xa(a)===a,k=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=f||(w||!g?[Iy(a)]:sae(a)),E=m!=="none";!f&&E&&C.push(...cae(a,g,m,k));const _=[a,...C],A=await cm(e,y),R=[];let L=((i=s.flip)==null?void 0:i.overflows)||[];if(u&&R.push(A[v]),d){const B=rae(r,o,k);R.push(A[B[0]],A[B[1]])}if(L=[...L,{placement:r,overflows:R}],!R.every(B=>B<=0)){var O,I;const B=(((O=s.flip)==null?void 0:O.index)||0)+1,K=_[B];if(K&&(!(d==="alignment"?b!==vo(K):!1)||L.every(V=>V.overflows[0]>0&&vo(V.placement)===b)))return{data:{index:B,overflows:L},reset:{placement:K}};let J=(I=L.filter(ne=>ne.overflows[0]<=0).sort((ne,V)=>ne.overflows[1]-V.overflows[1])[0])==null?void 0:I.placement;if(!J)switch(p){case"bestFit":{var G;const ne=(G=L.filter(V=>{if(E){const U=vo(V.placement);return U===b||U==="y"}return!0}).map(V=>[V.placement,V.overflows.filter(U=>U>0).reduce((U,se)=>U+se,0)]).sort((V,U)=>V[1]-U[1])[0])==null?void 0:G[0];ne&&(J=ne);break}case"initialPlacement":J=a;break}if(r!==J)return{reset:{placement:J}}}return{}}}};function U3(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function V3(t){return eae.some(e=>t[e]>=0)}const pae=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:i="referenceHidden",...r}=ba(t,e);switch(i){case"referenceHidden":{const s=await cm(e,{...r,elementContext:"reference"}),o=U3(s,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:V3(o)}}}case"escaped":{const s=await cm(e,{...r,altBoundary:!0}),o=U3(s,n.floating);return{data:{escapedOffsets:o,escaped:V3(o)}}}default:return{}}}}},u$=new Set(["left","top"]);async function mae(t,e){const{placement:n,platform:i,elements:r}=t,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),o=xa(n),a=Pf(n),l=vo(n)==="y",c=u$.has(o)?-1:1,u=s&&l?-1:1,d=ba(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof m=="number"&&(p=a==="end"?m*-1:m),l?{x:p*u,y:f*c}:{x:f*c,y:p*u}}const gae=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:r,y:s,placement:o,middlewareData:a}=e,l=await mae(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:{...l,placement:o}}}}},vae=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:r}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:y=>{let{x:v,y:b}=y;return{x:v,y:b}}},...l}=ba(t,e),c={x:n,y:i},u=await cm(e,l),d=vo(xa(r)),f=sA(d);let p=c[f],m=c[d];if(s){const y=f==="y"?"top":"left",v=f==="y"?"bottom":"right",b=p+u[y],w=p-u[v];p=Vk(b,p,w)}if(o){const y=d==="y"?"top":"left",v=d==="y"?"bottom":"right",b=m+u[y],w=m-u[v];m=Vk(b,m,w)}const g=a.fn({...e,[f]:p,[d]:m});return{...g,data:{x:g.x-n,y:g.y-i,enabled:{[f]:s,[d]:o}}}}}},yae=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:i,placement:r,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=ba(t,e),u={x:n,y:i},d=vo(r),f=sA(d);let p=u[f],m=u[d];const g=ba(a,e),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const w=f==="y"?"height":"width",k=s.reference[f]-s.floating[w]+y.mainAxis,C=s.reference[f]+s.reference[w]-y.mainAxis;p<k?p=k:p>C&&(p=C)}if(c){var v,b;const w=f==="y"?"width":"height",k=u$.has(xa(r)),C=s.reference[d]-s.floating[w]+(k&&((v=o.offset)==null?void 0:v[d])||0)+(k?0:y.crossAxis),E=s.reference[d]+s.reference[w]+(k?0:((b=o.offset)==null?void 0:b[d])||0)-(k?y.crossAxis:0);m<C?m=C:m>E&&(m=E)}return{[f]:p,[d]:m}}}},bae=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,i;const{placement:r,rects:s,platform:o,elements:a}=e,{apply:l=()=>{},...c}=ba(t,e),u=await cm(e,c),d=xa(r),f=Pf(r),p=vo(r)==="y",{width:m,height:g}=s.floating;let y,v;d==="top"||d==="bottom"?(y=d,v=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(v=d,y=f==="end"?"top":"bottom");const b=g-u.top-u.bottom,w=m-u.left-u.right,k=Hl(g-u[y],b),C=Hl(m-u[v],w),E=!e.middlewareData.shift;let _=k,A=C;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(A=w),(i=e.middlewareData.shift)!=null&&i.enabled.y&&(_=b),E&&!f){const L=wr(u.left,0),O=wr(u.right,0),I=wr(u.top,0),G=wr(u.bottom,0);p?A=m-2*(L!==0||O!==0?L+O:wr(u.left,u.right)):_=g-2*(I!==0||G!==0?I+G:wr(u.top,u.bottom))}await l({...e,availableWidth:A,availableHeight:_});const R=await o.getDimensions(a.floating);return m!==R.width||g!==R.height?{reset:{rects:!0}}:{}}}};function r1(){return typeof window<"u"}function Nf(t){return d$(t)?(t.nodeName||"").toLowerCase():"#document"}function Mr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Lo(t){var e;return(e=(d$(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function d$(t){return r1()?t instanceof Node||t instanceof Mr(t).Node:!1}function $s(t){return r1()?t instanceof Element||t instanceof Mr(t).Element:!1}function Io(t){return r1()?t instanceof HTMLElement||t instanceof Mr(t).HTMLElement:!1}function H3(t){return!r1()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Mr(t).ShadowRoot}const xae=new Set(["inline","contents"]);function Fm(t){const{overflow:e,overflowX:n,overflowY:i,display:r}=Fs(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!xae.has(r)}const wae=new Set(["table","td","th"]);function Sae(t){return wae.has(Nf(t))}const kae=[":popover-open",":modal"];function s1(t){return kae.some(e=>{try{return t.matches(e)}catch{return!1}})}const _ae=["transform","translate","scale","rotate","perspective"],Cae=["transform","translate","scale","rotate","perspective","filter"],Eae=["paint","layout","strict","content"];function lA(t){const e=cA(),n=$s(t)?Fs(t):t;return _ae.some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||Cae.some(i=>(n.willChange||"").includes(i))||Eae.some(i=>(n.contain||"").includes(i))}function Aae(t){let e=Wl(t);for(;Io(e)&&!pf(e);){if(lA(e))return e;if(s1(e))return null;e=Wl(e)}return null}function cA(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Pae=new Set(["html","body","#document"]);function pf(t){return Pae.has(Nf(t))}function Fs(t){return Mr(t).getComputedStyle(t)}function o1(t){return $s(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Wl(t){if(Nf(t)==="html")return t;const e=t.assignedSlot||t.parentNode||H3(t)&&t.host||Lo(t);return H3(e)?e.host:e}function f$(t){const e=Wl(t);return pf(e)?t.ownerDocument?t.ownerDocument.body:t.body:Io(e)&&Fm(e)?e:f$(e)}function um(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=f$(t),s=r===((i=t.ownerDocument)==null?void 0:i.body),o=Mr(r);if(s){const a=Wk(o);return e.concat(o,o.visualViewport||[],Fm(r)?r:[],a&&n?um(a):[])}return e.concat(r,um(r,[],n))}function Wk(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function h$(t){const e=Fs(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=Io(t),s=r?t.offsetWidth:n,o=r?t.offsetHeight:i,a=Ry(n)!==s||Ry(i)!==o;return a&&(n=s,i=o),{width:n,height:i,$:a}}function uA(t){return $s(t)?t:t.contextElement}function Nd(t){const e=uA(t);if(!Io(e))return Eo(1);const n=e.getBoundingClientRect(),{width:i,height:r,$:s}=h$(e);let o=(s?Ry(n.width):n.width)/i,a=(s?Ry(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Nae=Eo(0);function p$(t){const e=Mr(t);return!cA()||!e.visualViewport?Nae:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Mae(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Mr(t)?!1:e}function ou(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=uA(t);let o=Eo(1);e&&(i?$s(i)&&(o=Nd(i)):o=Nd(t));const a=Mae(s,n,i)?p$(s):Eo(0);let l=(r.left+a.x)/o.x,c=(r.top+a.y)/o.y,u=r.width/o.x,d=r.height/o.y;if(s){const f=Mr(s),p=i&&$s(i)?Mr(i):i;let m=f,g=Wk(m);for(;g&&i&&p!==m;){const y=Nd(g),v=g.getBoundingClientRect(),b=Fs(g),w=v.left+(g.clientLeft+parseFloat(b.paddingLeft))*y.x,k=v.top+(g.clientTop+parseFloat(b.paddingTop))*y.y;l*=y.x,c*=y.y,u*=y.x,d*=y.y,l+=w,c+=k,m=Mr(g),g=Wk(m)}}return Ty({width:u,height:d,x:l,y:c})}function dA(t,e){const n=o1(t).scrollLeft;return e?e.left+n:ou(Lo(t)).left+n}function m$(t,e,n){n===void 0&&(n=!1);const i=t.getBoundingClientRect(),r=i.left+e.scrollLeft-(n?0:dA(t,i)),s=i.top+e.scrollTop;return{x:r,y:s}}function Rae(t){let{elements:e,rect:n,offsetParent:i,strategy:r}=t;const s=r==="fixed",o=Lo(i),a=e?s1(e.floating):!1;if(i===o||a&&s)return n;let l={scrollLeft:0,scrollTop:0},c=Eo(1);const u=Eo(0),d=Io(i);if((d||!d&&!s)&&((Nf(i)!=="body"||Fm(o))&&(l=o1(i)),Io(i))){const p=ou(i);c=Nd(i),u.x=p.x+i.clientLeft,u.y=p.y+i.clientTop}const f=o&&!d&&!s?m$(o,l,!0):Eo(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:n.y*c.y-l.scrollTop*c.y+u.y+f.y}}function Iae(t){return Array.from(t.getClientRects())}function Tae(t){const e=Lo(t),n=o1(t),i=t.ownerDocument.body,r=wr(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=wr(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let o=-n.scrollLeft+dA(t);const a=-n.scrollTop;return Fs(i).direction==="rtl"&&(o+=wr(e.clientWidth,i.clientWidth)-r),{width:r,height:s,x:o,y:a}}function Oae(t,e){const n=Mr(t),i=Lo(t),r=n.visualViewport;let s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;const c=cA();(!c||c&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a,y:l}}const Lae=new Set(["absolute","fixed"]);function Dae(t,e){const n=ou(t,!0,e==="fixed"),i=n.top+t.clientTop,r=n.left+t.clientLeft,s=Io(t)?Nd(t):Eo(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,l=r*s.x,c=i*s.y;return{width:o,height:a,x:l,y:c}}function W3(t,e,n){let i;if(e==="viewport")i=Oae(t,n);else if(e==="document")i=Tae(Lo(t));else if($s(e))i=Dae(e,n);else{const r=p$(t);i={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return Ty(i)}function g$(t,e){const n=Wl(t);return n===e||!$s(n)||pf(n)?!1:Fs(n).position==="fixed"||g$(n,e)}function jae(t,e){const n=e.get(t);if(n)return n;let i=um(t,[],!1).filter(a=>$s(a)&&Nf(a)!=="body"),r=null;const s=Fs(t).position==="fixed";let o=s?Wl(t):t;for(;$s(o)&&!pf(o);){const a=Fs(o),l=lA(o);!l&&a.position==="fixed"&&(r=null),(s?!l&&!r:!l&&a.position==="static"&&!!r&&Lae.has(r.position)||Fm(o)&&!l&&g$(t,o))?i=i.filter(u=>u!==o):r=a,o=Wl(o)}return e.set(t,i),i}function Bae(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const o=[...n==="clippingAncestors"?s1(e)?[]:jae(e,this._c):[].concat(n),i],a=o[0],l=o.reduce((c,u)=>{const d=W3(e,u,r);return c.top=wr(d.top,c.top),c.right=Hl(d.right,c.right),c.bottom=Hl(d.bottom,c.bottom),c.left=wr(d.left,c.left),c},W3(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function $ae(t){const{width:e,height:n}=h$(t);return{width:e,height:n}}function Fae(t,e,n){const i=Io(e),r=Lo(e),s=n==="fixed",o=ou(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=Eo(0);function c(){l.x=dA(r)}if(i||!i&&!s)if((Nf(e)!=="body"||Fm(r))&&(a=o1(e)),i){const p=ou(e,!0,s,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else r&&c();s&&!i&&r&&c();const u=r&&!i&&!s?m$(r,a):Eo(0),d=o.left+a.scrollLeft-l.x-u.x,f=o.top+a.scrollTop-l.y-u.y;return{x:d,y:f,width:o.width,height:o.height}}function pw(t){return Fs(t).position==="static"}function G3(t,e){if(!Io(t)||Fs(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Lo(t)===n&&(n=n.ownerDocument.body),n}function v$(t,e){const n=Mr(t);if(s1(t))return n;if(!Io(t)){let r=Wl(t);for(;r&&!pf(r);){if($s(r)&&!pw(r))return r;r=Wl(r)}return n}let i=G3(t,e);for(;i&&Sae(i)&&pw(i);)i=G3(i,e);return i&&pf(i)&&pw(i)&&!lA(i)?n:i||Aae(t)||n}const zae=async function(t){const e=this.getOffsetParent||v$,n=this.getDimensions,i=await n(t.floating);return{reference:Fae(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function Uae(t){return Fs(t).direction==="rtl"}const Vae={convertOffsetParentRelativeRectToViewportRelativeRect:Rae,getDocumentElement:Lo,getClippingRect:Bae,getOffsetParent:v$,getElementRects:zae,getClientRects:Iae,getDimensions:$ae,getScale:Nd,isElement:$s,isRTL:Uae};function y$(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Hae(t,e){let n=null,i;const r=Lo(t);function s(){var a;clearTimeout(i),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const c=t.getBoundingClientRect(),{left:u,top:d,width:f,height:p}=c;if(a||e(),!f||!p)return;const m=n0(d),g=n0(r.clientWidth-(u+f)),y=n0(r.clientHeight-(d+p)),v=n0(u),w={rootMargin:-m+"px "+-g+"px "+-y+"px "+-v+"px",threshold:wr(0,Hl(1,l))||1};let k=!0;function C(E){const _=E[0].intersectionRatio;if(_!==l){if(!k)return o();_?o(!1,_):i=setTimeout(()=>{o(!1,1e-7)},1e3)}_===1&&!y$(c,t.getBoundingClientRect())&&o(),k=!1}try{n=new IntersectionObserver(C,{...w,root:r.ownerDocument})}catch{n=new IntersectionObserver(C,w)}n.observe(t)}return o(!0),s}function Wae(t,e,n,i){i===void 0&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,c=uA(t),u=r||s?[...c?um(c):[],...um(e)]:[];u.forEach(v=>{r&&v.addEventListener("scroll",n,{passive:!0}),s&&v.addEventListener("resize",n)});const d=c&&a?Hae(c,n):null;let f=-1,p=null;o&&(p=new ResizeObserver(v=>{let[b]=v;b&&b.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var w;(w=p)==null||w.observe(e)})),n()}),c&&!l&&p.observe(c),p.observe(e));let m,g=l?ou(t):null;l&&y();function y(){const v=ou(t);g&&!y$(g,v)&&n(),g=v,m=requestAnimationFrame(y)}return n(),()=>{var v;u.forEach(b=>{r&&b.removeEventListener("scroll",n),s&&b.removeEventListener("resize",n)}),d==null||d(),(v=p)==null||v.disconnect(),p=null,l&&cancelAnimationFrame(m)}}const Gae=gae,qae=vae,Kae=hae,Xae=bae,Yae=pae,q3=fae,Jae=yae,Zae=(t,e,n)=>{const i=new Map,r={platform:Vae,...n},s={...r.platform,_c:i};return dae(t,e,{...r,platform:s})};var Qae=typeof document<"u",ele=function(){},av=Qae?x.useLayoutEffect:ele;function Oy(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,i,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(i=n;i--!==0;)if(!Oy(t[i],e[i]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(e,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!(s==="_owner"&&t.$$typeof)&&!Oy(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function b$(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function K3(t,e){const n=b$(t);return Math.round(e*n)/n}function mw(t){const e=x.useRef(t);return av(()=>{e.current=t}),e}function tle(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:i=[],platform:r,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=x.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=x.useState(i);Oy(f,i)||p(i);const[m,g]=x.useState(null),[y,v]=x.useState(null),b=x.useCallback(V=>{V!==E.current&&(E.current=V,g(V))},[]),w=x.useCallback(V=>{V!==_.current&&(_.current=V,v(V))},[]),k=s||m,C=o||y,E=x.useRef(null),_=x.useRef(null),A=x.useRef(u),R=l!=null,L=mw(l),O=mw(r),I=mw(c),G=x.useCallback(()=>{if(!E.current||!_.current)return;const V={placement:e,strategy:n,middleware:f};O.current&&(V.platform=O.current),Zae(E.current,_.current,V).then(U=>{const se={...U,isPositioned:I.current!==!1};B.current&&!Oy(A.current,se)&&(A.current=se,Zl.flushSync(()=>{d(se)}))})},[f,e,n,O,I]);av(()=>{c===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,d(V=>({...V,isPositioned:!1})))},[c]);const B=x.useRef(!1);av(()=>(B.current=!0,()=>{B.current=!1}),[]),av(()=>{if(k&&(E.current=k),C&&(_.current=C),k&&C){if(L.current)return L.current(k,C,G);G()}},[k,C,G,L,R]);const K=x.useMemo(()=>({reference:E,floating:_,setReference:b,setFloating:w}),[b,w]),J=x.useMemo(()=>({reference:k,floating:C}),[k,C]),ne=x.useMemo(()=>{const V={position:n,left:0,top:0};if(!J.floating)return V;const U=K3(J.floating,u.x),se=K3(J.floating,u.y);return a?{...V,transform:"translate("+U+"px, "+se+"px)",...b$(J.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:U,top:se}},[n,a,J.floating,u.x,u.y]);return x.useMemo(()=>({...u,update:G,refs:K,elements:J,floatingStyles:ne}),[u,G,K,J,ne])}const nle=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:i,padding:r}=typeof t=="function"?t(n):t;return i&&e(i)?i.current!=null?q3({element:i.current,padding:r}).fn(n):{}:i?q3({element:i,padding:r}).fn(n):{}}}},ile=(t,e)=>({...Gae(t),options:[t,e]}),rle=(t,e)=>({...qae(t),options:[t,e]}),sle=(t,e)=>({...Jae(t),options:[t,e]}),ole=(t,e)=>({...Kae(t),options:[t,e]}),ale=(t,e)=>({...Xae(t),options:[t,e]}),lle=(t,e)=>({...Yae(t),options:[t,e]}),cle=(t,e)=>({...nle(t),options:[t,e]});var ule="Arrow",x$=x.forwardRef((t,e)=>{const{children:n,width:i=10,height:r=5,...s}=t;return h.jsx(et.svg,{...s,ref:e,width:i,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});x$.displayName=ule;var dle=x$;function fA(t){const[e,n]=x.useState(void 0);return ci(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const i=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const s=r[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return i.observe(t,{box:"border-box"}),()=>i.unobserve(t)}else n(void 0)},[t]),e}var hA="Popper",[w$,Mf]=zs(hA),[fle,S$]=w$(hA),k$=t=>{const{__scopePopper:e,children:n}=t,[i,r]=x.useState(null);return h.jsx(fle,{scope:e,anchor:i,onAnchorChange:r,children:n})};k$.displayName=hA;var _$="PopperAnchor",C$=x.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:i,...r}=t,s=S$(_$,n),o=x.useRef(null),a=wt(e,o);return x.useEffect(()=>{s.onAnchorChange((i==null?void 0:i.current)||o.current)}),i?null:h.jsx(et.div,{...r,ref:a})});C$.displayName=_$;var pA="PopperContent",[hle,ple]=w$(pA),E$=x.forwardRef((t,e)=>{var S,T,j,D,Y,q;const{__scopePopper:n,side:i="bottom",sideOffset:r=0,align:s="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:m,...g}=t,y=S$(pA,n),[v,b]=x.useState(null),w=wt(e,oe=>b(oe)),[k,C]=x.useState(null),E=fA(k),_=(E==null?void 0:E.width)??0,A=(E==null?void 0:E.height)??0,R=i+(s!=="center"?"-"+s:""),L=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},O=Array.isArray(c)?c:[c],I=O.length>0,G={padding:L,boundary:O.filter(gle),altBoundary:I},{refs:B,floatingStyles:K,placement:J,isPositioned:ne,middlewareData:V}=tle({strategy:"fixed",placement:R,whileElementsMounted:(...oe)=>Wae(...oe,{animationFrame:p==="always"}),elements:{reference:y.anchor},middleware:[ile({mainAxis:r+A,alignmentAxis:o}),l&&rle({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?sle():void 0,...G}),l&&ole({...G}),ale({...G,apply:({elements:oe,rects:ee,availableWidth:Oe,availableHeight:We})=>{const{width:Xe,height:Ve}=ee.reference,ot=oe.floating.style;ot.setProperty("--radix-popper-available-width",`${Oe}px`),ot.setProperty("--radix-popper-available-height",`${We}px`),ot.setProperty("--radix-popper-anchor-width",`${Xe}px`),ot.setProperty("--radix-popper-anchor-height",`${Ve}px`)}}),k&&cle({element:k,padding:a}),vle({arrowWidth:_,arrowHeight:A}),f&&lle({strategy:"referenceHidden",...G})]}),[U,se]=N$(J),_e=Ir(m);ci(()=>{ne&&(_e==null||_e())},[ne,_e]);const Q=(S=V.arrow)==null?void 0:S.x,ae=(T=V.arrow)==null?void 0:T.y,z=((j=V.arrow)==null?void 0:j.centerOffset)!==0,[$,W]=x.useState();return ci(()=>{v&&W(window.getComputedStyle(v).zIndex)},[v]),h.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:ne?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:$,"--radix-popper-transform-origin":[(D=V.transformOrigin)==null?void 0:D.x,(Y=V.transformOrigin)==null?void 0:Y.y].join(" "),...((q=V.hide)==null?void 0:q.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:h.jsx(hle,{scope:n,placedSide:U,onArrowChange:C,arrowX:Q,arrowY:ae,shouldHideArrow:z,children:h.jsx(et.div,{"data-side":U,"data-align":se,...g,ref:w,style:{...g.style,animation:ne?void 0:"none"}})})})});E$.displayName=pA;var A$="PopperArrow",mle={top:"bottom",right:"left",bottom:"top",left:"right"},P$=x.forwardRef(function(e,n){const{__scopePopper:i,...r}=e,s=ple(A$,i),o=mle[s.placedSide];return h.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:h.jsx(dle,{...r,ref:n,style:{...r.style,display:"block"}})})});P$.displayName=A$;function gle(t){return t!==null}var vle=t=>({name:"transformOrigin",options:t,fn(e){var y,v,b;const{placement:n,rects:i,middlewareData:r}=e,o=((y=r.arrow)==null?void 0:y.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=N$(n),d={start:"0%",center:"50%",end:"100%"}[u],f=(((v=r.arrow)==null?void 0:v.x)??0)+a/2,p=(((b=r.arrow)==null?void 0:b.y)??0)+l/2;let m="",g="";return c==="bottom"?(m=o?d:`${f}px`,g=`${-l}px`):c==="top"?(m=o?d:`${f}px`,g=`${i.floating.height+l}px`):c==="right"?(m=`${-l}px`,g=o?d:`${p}px`):c==="left"&&(m=`${i.floating.width+l}px`,g=o?d:`${p}px`),{data:{x:m,y:g}}}});function N$(t){const[e,n="center"]=t.split("-");return[e,n]}var M$=k$,a1=C$,mA=E$,gA=P$,yle="Portal",zm=x.forwardRef((t,e)=>{var a;const{container:n,...i}=t,[r,s]=x.useState(!1);ci(()=>s(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?oq.createPortal(h.jsx(et.div,{...i,ref:e}),o):null});zm.displayName=yle;function vA(t){const e=x.useRef({value:t,previous:t});return x.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var R$=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),ble="VisuallyHidden",yA=x.forwardRef((t,e)=>h.jsx(et.span,{...t,ref:e,style:{...R$,...t.style}}));yA.displayName=ble;var xle=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Nu=new WeakMap,i0=new WeakMap,r0={},gw=0,I$=function(t){return t&&(t.host||I$(t.parentNode))},wle=function(t,e){return e.map(function(n){if(t.contains(n))return n;var i=I$(n);return i&&t.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},Sle=function(t,e,n,i){var r=wle(e,Array.isArray(t)?t:[t]);r0[n]||(r0[n]=new WeakMap);var s=r0[n],o=[],a=new Set,l=new Set(r),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};r.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(a.has(f))u(f);else try{var p=f.getAttribute(i),m=p!==null&&p!=="false",g=(Nu.get(f)||0)+1,y=(s.get(f)||0)+1;Nu.set(f,g),s.set(f,y),o.push(f),g===1&&m&&i0.set(f,!0),y===1&&f.setAttribute(n,"true"),m||f.setAttribute(i,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return u(e),a.clear(),gw++,function(){o.forEach(function(d){var f=Nu.get(d)-1,p=s.get(d)-1;Nu.set(d,f),s.set(d,p),f||(i0.has(d)||d.removeAttribute(i),i0.delete(d)),p||d.removeAttribute(n)}),gw--,gw||(Nu=new WeakMap,Nu=new WeakMap,i0=new WeakMap,r0={})}},T$=function(t,e,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(t)?t:[t]),r=xle(t);return r?(i.push.apply(i,Array.from(r.querySelectorAll("[aria-live]"))),Sle(i,r,n,"aria-hidden")):function(){return null}},lv="right-scroll-bar-position",cv="width-before-scroll-bar",kle="with-scroll-bars-hidden",_le="--removed-body-scroll-bar-size";function vw(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Cle(t,e){var n=x.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(i){var r=n.value;r!==i&&(n.value=i,n.callback(i,r))}}}})[0];return n.callback=e,n.facade}var Ele=typeof window<"u"?x.useLayoutEffect:x.useEffect,X3=new WeakMap;function Ale(t,e){var n=Cle(null,function(i){return t.forEach(function(r){return vw(r,i)})});return Ele(function(){var i=X3.get(n);if(i){var r=new Set(i),s=new Set(t),o=n.current;r.forEach(function(a){s.has(a)||vw(a,null)}),s.forEach(function(a){r.has(a)||vw(a,o)})}X3.set(n,t)},[t]),n}function Ple(t){return t}function Nle(t,e){e===void 0&&(e=Ple);var n=[],i=!1,r={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,i);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(i=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){i=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var l=function(){var u=o;o=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return r}function Mle(t){t===void 0&&(t={});var e=Nle(null);return e.options=ao({async:!0,ssr:!1},t),e}var O$=function(t){var e=t.sideCar,n=BD(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=e.read();if(!i)throw new Error("Sidecar medium not found");return x.createElement(i,ao({},n))};O$.isSideCarExport=!0;function Rle(t,e){return t.useMedium(e),O$}var L$=Mle(),yw=function(){},l1=x.forwardRef(function(t,e){var n=x.useRef(null),i=x.useState({onScrollCapture:yw,onWheelCapture:yw,onTouchMoveCapture:yw}),r=i[0],s=i[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,f=t.sideCar,p=t.noRelative,m=t.noIsolation,g=t.inert,y=t.allowPinchZoom,v=t.as,b=v===void 0?"div":v,w=t.gapMode,k=BD(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=f,E=Ale([n,e]),_=ao(ao({},k),r);return x.createElement(x.Fragment,null,u&&x.createElement(C,{sideCar:L$,removeScrollBar:c,shards:d,noRelative:p,noIsolation:m,inert:g,setCallbacks:s,allowPinchZoom:!!y,lockRef:n,gapMode:w}),o?x.cloneElement(x.Children.only(a),ao(ao({},_),{ref:E})):x.createElement(b,ao({},_,{className:l,ref:E}),a))});l1.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};l1.classNames={fullWidth:cv,zeroRight:lv};var Ile=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Tle(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Ile();return e&&t.setAttribute("nonce",e),t}function Ole(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Lle(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Dle=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Tle())&&(Ole(e,n),Lle(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},jle=function(){var t=Dle();return function(e,n){x.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},D$=function(){var t=jle(),e=function(n){var i=n.styles,r=n.dynamic;return t(i,r),null};return e},Ble={left:0,top:0,right:0,gap:0},bw=function(t){return parseInt(t||"",10)||0},$le=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],i=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[bw(n),bw(i),bw(r)]},Fle=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Ble;var e=$le(t),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,i-n+e[2]-e[0])}},zle=D$(),Md="data-scroll-locked",Ule=function(t,e,n,i){var r=t.left,s=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(kle,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(a,"px ").concat(i,`;
  }
  body[`).concat(Md,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(lv,` {
    right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(cv,` {
    margin-right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(lv," .").concat(lv,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(cv," .").concat(cv,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(Md,`] {
    `).concat(_le,": ").concat(a,`px;
  }
`)},Y3=function(){var t=parseInt(document.body.getAttribute(Md)||"0",10);return isFinite(t)?t:0},Vle=function(){x.useEffect(function(){return document.body.setAttribute(Md,(Y3()+1).toString()),function(){var t=Y3()-1;t<=0?document.body.removeAttribute(Md):document.body.setAttribute(Md,t.toString())}},[])},Hle=function(t){var e=t.noRelative,n=t.noImportant,i=t.gapMode,r=i===void 0?"margin":i;Vle();var s=x.useMemo(function(){return Fle(r)},[r]);return x.createElement(zle,{styles:Ule(s,!e,r,n?"":"!important")})},Gk=!1;if(typeof window<"u")try{var s0=Object.defineProperty({},"passive",{get:function(){return Gk=!0,!0}});window.addEventListener("test",s0,s0),window.removeEventListener("test",s0,s0)}catch{Gk=!1}var Mu=Gk?{passive:!1}:!1,Wle=function(t){return t.tagName==="TEXTAREA"},j$=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Wle(t)&&n[e]==="visible")},Gle=function(t){return j$(t,"overflowY")},qle=function(t){return j$(t,"overflowX")},J3=function(t,e){var n=e.ownerDocument,i=e;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var r=B$(t,i);if(r){var s=$$(t,i),o=s[1],a=s[2];if(o>a)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},Kle=function(t){var e=t.scrollTop,n=t.scrollHeight,i=t.clientHeight;return[e,n,i]},Xle=function(t){var e=t.scrollLeft,n=t.scrollWidth,i=t.clientWidth;return[e,n,i]},B$=function(t,e){return t==="v"?Gle(e):qle(e)},$$=function(t,e){return t==="v"?Kle(e):Xle(e)},Yle=function(t,e){return t==="h"&&e==="rtl"?-1:1},Jle=function(t,e,n,i,r){var s=Yle(t,window.getComputedStyle(e).direction),o=s*i,a=n.target,l=e.contains(a),c=!1,u=o>0,d=0,f=0;do{if(!a)break;var p=$$(t,a),m=p[0],g=p[1],y=p[2],v=g-y-s*m;(m||v)&&B$(t,a)&&(d+=v,f+=m);var b=a.parentNode;a=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&Math.abs(d)<1||!u&&Math.abs(f)<1)&&(c=!0),c},o0=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Z3=function(t){return[t.deltaX,t.deltaY]},Q3=function(t){return t&&"current"in t?t.current:t},Zle=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Qle=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},ece=0,Ru=[];function tce(t){var e=x.useRef([]),n=x.useRef([0,0]),i=x.useRef(),r=x.useState(ece++)[0],s=x.useState(D$)[0],o=x.useRef(t);x.useEffect(function(){o.current=t},[t]),x.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var g=hK([t.lockRef.current],(t.shards||[]).map(Q3),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var a=x.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var v=o0(g),b=n.current,w="deltaX"in g?g.deltaX:b[0]-v[0],k="deltaY"in g?g.deltaY:b[1]-v[1],C,E=g.target,_=Math.abs(w)>Math.abs(k)?"h":"v";if("touches"in g&&_==="h"&&E.type==="range")return!1;var A=J3(_,E);if(!A)return!0;if(A?C=_:(C=_==="v"?"h":"v",A=J3(_,E)),!A)return!1;if(!i.current&&"changedTouches"in g&&(w||k)&&(i.current=C),!C)return!0;var R=i.current||C;return Jle(R,y,g,R==="h"?w:k)},[]),l=x.useCallback(function(g){var y=g;if(!(!Ru.length||Ru[Ru.length-1]!==s)){var v="deltaY"in y?Z3(y):o0(y),b=e.current.filter(function(C){return C.name===y.type&&(C.target===y.target||y.target===C.shadowParent)&&Zle(C.delta,v)})[0];if(b&&b.should){y.cancelable&&y.preventDefault();return}if(!b){var w=(o.current.shards||[]).map(Q3).filter(Boolean).filter(function(C){return C.contains(y.target)}),k=w.length>0?a(y,w[0]):!o.current.noIsolation;k&&y.cancelable&&y.preventDefault()}}},[]),c=x.useCallback(function(g,y,v,b){var w={name:g,delta:y,target:v,should:b,shadowParent:nce(v)};e.current.push(w),setTimeout(function(){e.current=e.current.filter(function(k){return k!==w})},1)},[]),u=x.useCallback(function(g){n.current=o0(g),i.current=void 0},[]),d=x.useCallback(function(g){c(g.type,Z3(g),g.target,a(g,t.lockRef.current))},[]),f=x.useCallback(function(g){c(g.type,o0(g),g.target,a(g,t.lockRef.current))},[]);x.useEffect(function(){return Ru.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Mu),document.addEventListener("touchmove",l,Mu),document.addEventListener("touchstart",u,Mu),function(){Ru=Ru.filter(function(g){return g!==s}),document.removeEventListener("wheel",l,Mu),document.removeEventListener("touchmove",l,Mu),document.removeEventListener("touchstart",u,Mu)}},[]);var p=t.removeScrollBar,m=t.inert;return x.createElement(x.Fragment,null,m?x.createElement(s,{styles:Qle(r)}):null,p?x.createElement(Hle,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function nce(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const ice=Rle(L$,tce);var c1=x.forwardRef(function(t,e){return x.createElement(l1,ao({},t,{ref:e,sideCar:ice}))});c1.classNames=l1.classNames;var rce=[" ","Enter","ArrowUp","ArrowDown"],sce=[" ","Enter"],au="Select",[u1,d1,oce]=_m(au),[Rf,vve]=zs(au,[oce,Mf]),f1=Mf(),[ace,tc]=Rf(au),[lce,cce]=Rf(au),F$=t=>{const{__scopeSelect:e,children:n,open:i,defaultOpen:r,onOpenChange:s,value:o,defaultValue:a,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:f,required:p,form:m}=t,g=f1(e),[y,v]=x.useState(null),[b,w]=x.useState(null),[k,C]=x.useState(!1),E=Sb(c),[_,A]=Il({prop:i,defaultProp:r??!1,onChange:s,caller:au}),[R,L]=Il({prop:o,defaultProp:a,onChange:l,caller:au}),O=x.useRef(null),I=y?m||!!y.closest("form"):!0,[G,B]=x.useState(new Set),K=Array.from(G).map(J=>J.props.value).join(";");return h.jsx(M$,{...g,children:h.jsxs(ace,{required:p,scope:e,trigger:y,onTriggerChange:v,valueNode:b,onValueNodeChange:w,valueNodeHasChildren:k,onValueNodeHasChildrenChange:C,contentId:kf(),value:R,onValueChange:L,open:_,onOpenChange:A,dir:E,triggerPointerDownPosRef:O,disabled:f,children:[h.jsx(u1.Provider,{scope:e,children:h.jsx(lce,{scope:t.__scopeSelect,onNativeOptionAdd:x.useCallback(J=>{B(ne=>new Set(ne).add(J))},[]),onNativeOptionRemove:x.useCallback(J=>{B(ne=>{const V=new Set(ne);return V.delete(J),V})},[]),children:n})}),I?h.jsxs(sF,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:d,value:R,onChange:J=>L(J.target.value),disabled:f,form:m,children:[R===void 0?h.jsx("option",{value:""}):null,Array.from(G)]},K):null]})})};F$.displayName=au;var z$="SelectTrigger",U$=x.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:i=!1,...r}=t,s=f1(n),o=tc(z$,n),a=o.disabled||i,l=wt(e,o.onTriggerChange),c=d1(n),u=x.useRef("touch"),[d,f,p]=aF(g=>{const y=c().filter(w=>!w.disabled),v=y.find(w=>w.value===o.value),b=lF(y,g,v);b!==void 0&&o.onValueChange(b.value)}),m=g=>{a||(o.onOpenChange(!0),p()),g&&(o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return h.jsx(a1,{asChild:!0,...s,children:h.jsx(et.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":oF(o.value)?"":void 0,...r,ref:l,onClick:ke(r.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&m(g)}),onPointerDown:ke(r.onPointerDown,g=>{u.current=g.pointerType;const y=g.target;y.hasPointerCapture(g.pointerId)&&y.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(m(g),g.preventDefault())}),onKeyDown:ke(r.onKeyDown,g=>{const y=d.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&f(g.key),!(y&&g.key===" ")&&rce.includes(g.key)&&(m(),g.preventDefault())})})})});U$.displayName=z$;var V$="SelectValue",H$=x.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,children:s,placeholder:o="",...a}=t,l=tc(V$,n),{onValueNodeHasChildrenChange:c}=l,u=s!==void 0,d=wt(e,l.onValueNodeChange);return ci(()=>{c(u)},[c,u]),h.jsx(et.span,{...a,ref:d,style:{pointerEvents:"none"},children:oF(l.value)?h.jsx(h.Fragment,{children:o}):s})});H$.displayName=V$;var uce="SelectIcon",W$=x.forwardRef((t,e)=>{const{__scopeSelect:n,children:i,...r}=t;return h.jsx(et.span,{"aria-hidden":!0,...r,ref:e,children:i||"▼"})});W$.displayName=uce;var dce="SelectPortal",G$=t=>h.jsx(zm,{asChild:!0,...t});G$.displayName=dce;var lu="SelectContent",q$=x.forwardRef((t,e)=>{const n=tc(lu,t.__scopeSelect),[i,r]=x.useState();if(ci(()=>{r(new DocumentFragment)},[]),!n.open){const s=i;return s?Zl.createPortal(h.jsx(K$,{scope:t.__scopeSelect,children:h.jsx(u1.Slot,{scope:t.__scopeSelect,children:h.jsx("div",{children:t.children})})}),s):null}return h.jsx(X$,{...t,ref:e})});q$.displayName=lu;var ys=10,[K$,nc]=Rf(lu),fce="SelectContentImpl",hce=Jd("SelectContent.RemoveScroll"),X$=x.forwardRef((t,e)=>{const{__scopeSelect:n,position:i="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:s,onPointerDownOutside:o,side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:g,avoidCollisions:y,...v}=t,b=tc(lu,n),[w,k]=x.useState(null),[C,E]=x.useState(null),_=wt(e,S=>k(S)),[A,R]=x.useState(null),[L,O]=x.useState(null),I=d1(n),[G,B]=x.useState(!1),K=x.useRef(!1);x.useEffect(()=>{if(w)return T$(w)},[w]),rA();const J=x.useCallback(S=>{const[T,...j]=I().map(q=>q.ref.current),[D]=j.slice(-1),Y=document.activeElement;for(const q of S)if(q===Y||(q==null||q.scrollIntoView({block:"nearest"}),q===T&&C&&(C.scrollTop=0),q===D&&C&&(C.scrollTop=C.scrollHeight),q==null||q.focus(),document.activeElement!==Y))return},[I,C]),ne=x.useCallback(()=>J([A,w]),[J,A,w]);x.useEffect(()=>{G&&ne()},[G,ne]);const{onOpenChange:V,triggerPointerDownPosRef:U}=b;x.useEffect(()=>{if(w){let S={x:0,y:0};const T=D=>{var Y,q;S={x:Math.abs(Math.round(D.pageX)-(((Y=U.current)==null?void 0:Y.x)??0)),y:Math.abs(Math.round(D.pageY)-(((q=U.current)==null?void 0:q.y)??0))}},j=D=>{S.x<=10&&S.y<=10?D.preventDefault():w.contains(D.target)||V(!1),document.removeEventListener("pointermove",T),U.current=null};return U.current!==null&&(document.addEventListener("pointermove",T),document.addEventListener("pointerup",j,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",T),document.removeEventListener("pointerup",j,{capture:!0})}}},[w,V,U]),x.useEffect(()=>{const S=()=>V(!1);return window.addEventListener("blur",S),window.addEventListener("resize",S),()=>{window.removeEventListener("blur",S),window.removeEventListener("resize",S)}},[V]);const[se,_e]=aF(S=>{const T=I().filter(Y=>!Y.disabled),j=T.find(Y=>Y.ref.current===document.activeElement),D=lF(T,S,j);D&&setTimeout(()=>D.ref.current.focus())}),Q=x.useCallback((S,T,j)=>{const D=!K.current&&!j;(b.value!==void 0&&b.value===T||D)&&(R(S),D&&(K.current=!0))},[b.value]),ae=x.useCallback(()=>w==null?void 0:w.focus(),[w]),z=x.useCallback((S,T,j)=>{const D=!K.current&&!j;(b.value!==void 0&&b.value===T||D)&&O(S)},[b.value]),$=i==="popper"?qk:Y$,W=$===qk?{side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:p,sticky:m,hideWhenDetached:g,avoidCollisions:y}:{};return h.jsx(K$,{scope:n,content:w,viewport:C,onViewportChange:E,itemRefCallback:Q,selectedItem:A,onItemLeave:ae,itemTextRefCallback:z,focusSelectedItem:ne,selectedItemText:L,position:i,isPositioned:G,searchRef:se,children:h.jsx(c1,{as:hce,allowPinchZoom:!0,children:h.jsx(i1,{asChild:!0,trapped:b.open,onMountAutoFocus:S=>{S.preventDefault()},onUnmountAutoFocus:ke(r,S=>{var T;(T=b.trigger)==null||T.focus({preventScroll:!0}),S.preventDefault()}),children:h.jsx($m,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:S=>S.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:h.jsx($,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:S=>S.preventDefault(),...v,...W,onPlaced:()=>B(!0),ref:_,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:ke(v.onKeyDown,S=>{const T=S.ctrlKey||S.altKey||S.metaKey;if(S.key==="Tab"&&S.preventDefault(),!T&&S.key.length===1&&_e(S.key),["ArrowUp","ArrowDown","Home","End"].includes(S.key)){let D=I().filter(Y=>!Y.disabled).map(Y=>Y.ref.current);if(["ArrowUp","End"].includes(S.key)&&(D=D.slice().reverse()),["ArrowUp","ArrowDown"].includes(S.key)){const Y=S.target,q=D.indexOf(Y);D=D.slice(q+1)}setTimeout(()=>J(D)),S.preventDefault()}})})})})})})});X$.displayName=fce;var pce="SelectItemAlignedPosition",Y$=x.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:i,...r}=t,s=tc(lu,n),o=nc(lu,n),[a,l]=x.useState(null),[c,u]=x.useState(null),d=wt(e,_=>u(_)),f=d1(n),p=x.useRef(!1),m=x.useRef(!0),{viewport:g,selectedItem:y,selectedItemText:v,focusSelectedItem:b}=o,w=x.useCallback(()=>{if(s.trigger&&s.valueNode&&a&&c&&g&&y&&v){const _=s.trigger.getBoundingClientRect(),A=c.getBoundingClientRect(),R=s.valueNode.getBoundingClientRect(),L=v.getBoundingClientRect();if(s.dir!=="rtl"){const Y=L.left-A.left,q=R.left-Y,oe=_.left-q,ee=_.width+oe,Oe=Math.max(ee,A.width),We=window.innerWidth-ys,Xe=My(q,[ys,Math.max(ys,We-Oe)]);a.style.minWidth=ee+"px",a.style.left=Xe+"px"}else{const Y=A.right-L.right,q=window.innerWidth-R.right-Y,oe=window.innerWidth-_.right-q,ee=_.width+oe,Oe=Math.max(ee,A.width),We=window.innerWidth-ys,Xe=My(q,[ys,Math.max(ys,We-Oe)]);a.style.minWidth=ee+"px",a.style.right=Xe+"px"}const O=f(),I=window.innerHeight-ys*2,G=g.scrollHeight,B=window.getComputedStyle(c),K=parseInt(B.borderTopWidth,10),J=parseInt(B.paddingTop,10),ne=parseInt(B.borderBottomWidth,10),V=parseInt(B.paddingBottom,10),U=K+J+G+V+ne,se=Math.min(y.offsetHeight*5,U),_e=window.getComputedStyle(g),Q=parseInt(_e.paddingTop,10),ae=parseInt(_e.paddingBottom,10),z=_.top+_.height/2-ys,$=I-z,W=y.offsetHeight/2,S=y.offsetTop+W,T=K+J+S,j=U-T;if(T<=z){const Y=O.length>0&&y===O[O.length-1].ref.current;a.style.bottom="0px";const q=c.clientHeight-g.offsetTop-g.offsetHeight,oe=Math.max($,W+(Y?ae:0)+q+ne),ee=T+oe;a.style.height=ee+"px"}else{const Y=O.length>0&&y===O[0].ref.current;a.style.top="0px";const oe=Math.max(z,K+g.offsetTop+(Y?Q:0)+W)+j;a.style.height=oe+"px",g.scrollTop=T-z+g.offsetTop}a.style.margin=`${ys}px 0`,a.style.minHeight=se+"px",a.style.maxHeight=I+"px",i==null||i(),requestAnimationFrame(()=>p.current=!0)}},[f,s.trigger,s.valueNode,a,c,g,y,v,s.dir,i]);ci(()=>w(),[w]);const[k,C]=x.useState();ci(()=>{c&&C(window.getComputedStyle(c).zIndex)},[c]);const E=x.useCallback(_=>{_&&m.current===!0&&(w(),b==null||b(),m.current=!1)},[w,b]);return h.jsx(gce,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:p,onScrollButtonChange:E,children:h.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:k},children:h.jsx(et.div,{...r,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});Y$.displayName=pce;var mce="SelectPopperPosition",qk=x.forwardRef((t,e)=>{const{__scopeSelect:n,align:i="start",collisionPadding:r=ys,...s}=t,o=f1(n);return h.jsx(mA,{...o,...s,ref:e,align:i,collisionPadding:r,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});qk.displayName=mce;var[gce,bA]=Rf(lu,{}),Kk="SelectViewport",J$=x.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:i,...r}=t,s=nc(Kk,n),o=bA(Kk,n),a=wt(e,s.onViewportChange),l=x.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),h.jsx(u1.Slot,{scope:n,children:h.jsx(et.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...r.style},onScroll:ke(r.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=o;if(f!=null&&f.current&&d){const p=Math.abs(l.current-u.scrollTop);if(p>0){const m=window.innerHeight-ys*2,g=parseFloat(d.style.minHeight),y=parseFloat(d.style.height),v=Math.max(g,y);if(v<m){const b=v+p,w=Math.min(m,b),k=b-w;d.style.height=w+"px",d.style.bottom==="0px"&&(u.scrollTop=k>0?k:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});J$.displayName=Kk;var Z$="SelectGroup",[vce,yce]=Rf(Z$),bce=x.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=kf();return h.jsx(vce,{scope:n,id:r,children:h.jsx(et.div,{role:"group","aria-labelledby":r,...i,ref:e})})});bce.displayName=Z$;var Q$="SelectLabel",xce=x.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=yce(Q$,n);return h.jsx(et.div,{id:r.id,...i,ref:e})});xce.displayName=Q$;var Ly="SelectItem",[wce,eF]=Rf(Ly),tF=x.forwardRef((t,e)=>{const{__scopeSelect:n,value:i,disabled:r=!1,textValue:s,...o}=t,a=tc(Ly,n),l=nc(Ly,n),c=a.value===i,[u,d]=x.useState(s??""),[f,p]=x.useState(!1),m=wt(e,b=>{var w;return(w=l.itemRefCallback)==null?void 0:w.call(l,b,i,r)}),g=kf(),y=x.useRef("touch"),v=()=>{r||(a.onValueChange(i),a.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(wce,{scope:n,value:i,disabled:r,textId:g,isSelected:c,onItemTextChange:x.useCallback(b=>{d(w=>w||((b==null?void 0:b.textContent)??"").trim())},[]),children:h.jsx(u1.ItemSlot,{scope:n,value:i,disabled:r,textValue:u,children:h.jsx(et.div,{role:"option","aria-labelledby":g,"data-highlighted":f?"":void 0,"aria-selected":c&&f,"data-state":c?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...o,ref:m,onFocus:ke(o.onFocus,()=>p(!0)),onBlur:ke(o.onBlur,()=>p(!1)),onClick:ke(o.onClick,()=>{y.current!=="mouse"&&v()}),onPointerUp:ke(o.onPointerUp,()=>{y.current==="mouse"&&v()}),onPointerDown:ke(o.onPointerDown,b=>{y.current=b.pointerType}),onPointerMove:ke(o.onPointerMove,b=>{var w;y.current=b.pointerType,r?(w=l.onItemLeave)==null||w.call(l):y.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ke(o.onPointerLeave,b=>{var w;b.currentTarget===document.activeElement&&((w=l.onItemLeave)==null||w.call(l))}),onKeyDown:ke(o.onKeyDown,b=>{var k;((k=l.searchRef)==null?void 0:k.current)!==""&&b.key===" "||(sce.includes(b.key)&&v(),b.key===" "&&b.preventDefault())})})})})});tF.displayName=Ly;var Rh="SelectItemText",nF=x.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,...s}=t,o=tc(Rh,n),a=nc(Rh,n),l=eF(Rh,n),c=cce(Rh,n),[u,d]=x.useState(null),f=wt(e,v=>d(v),l.onItemTextChange,v=>{var b;return(b=a.itemTextRefCallback)==null?void 0:b.call(a,v,l.value,l.disabled)}),p=u==null?void 0:u.textContent,m=x.useMemo(()=>h.jsx("option",{value:l.value,disabled:l.disabled,children:p},l.value),[l.disabled,l.value,p]),{onNativeOptionAdd:g,onNativeOptionRemove:y}=c;return ci(()=>(g(m),()=>y(m)),[g,y,m]),h.jsxs(h.Fragment,{children:[h.jsx(et.span,{id:l.textId,...s,ref:f}),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Zl.createPortal(s.children,o.valueNode):null]})});nF.displayName=Rh;var iF="SelectItemIndicator",Sce=x.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return eF(iF,n).isSelected?h.jsx(et.span,{"aria-hidden":!0,...i,ref:e}):null});Sce.displayName=iF;var Xk="SelectScrollUpButton",kce=x.forwardRef((t,e)=>{const n=nc(Xk,t.__scopeSelect),i=bA(Xk,t.__scopeSelect),[r,s]=x.useState(!1),o=wt(e,i.onScrollButtonChange);return ci(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollTop>0;s(c)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?h.jsx(rF,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});kce.displayName=Xk;var Yk="SelectScrollDownButton",_ce=x.forwardRef((t,e)=>{const n=nc(Yk,t.__scopeSelect),i=bA(Yk,t.__scopeSelect),[r,s]=x.useState(!1),o=wt(e,i.onScrollButtonChange);return ci(()=>{if(n.viewport&&n.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;s(u)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?h.jsx(rF,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});_ce.displayName=Yk;var rF=x.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:i,...r}=t,s=nc("SelectScrollButton",n),o=x.useRef(null),a=d1(n),l=x.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return x.useEffect(()=>()=>l(),[l]),ci(()=>{var u;const c=a().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[a]),h.jsx(et.div,{"aria-hidden":!0,...r,ref:e,style:{flexShrink:0,...r.style},onPointerDown:ke(r.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(i,50))}),onPointerMove:ke(r.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),o.current===null&&(o.current=window.setInterval(i,50))}),onPointerLeave:ke(r.onPointerLeave,()=>{l()})})}),Cce="SelectSeparator",Ece=x.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return h.jsx(et.div,{"aria-hidden":!0,...i,ref:e})});Ece.displayName=Cce;var Jk="SelectArrow",Ace=x.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=f1(n),s=tc(Jk,n),o=nc(Jk,n);return s.open&&o.position==="popper"?h.jsx(gA,{...r,...i,ref:e}):null});Ace.displayName=Jk;var Pce="SelectBubbleInput",sF=x.forwardRef(({__scopeSelect:t,value:e,...n},i)=>{const r=x.useRef(null),s=wt(i,r),o=vA(e);return x.useEffect(()=>{const a=r.current;if(!a)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==e&&u){const d=new Event("change",{bubbles:!0});u.call(a,e),a.dispatchEvent(d)}},[o,e]),h.jsx(et.select,{...n,style:{...R$,...n.style},ref:s,defaultValue:e})});sF.displayName=Pce;function oF(t){return t===""||t===void 0}function aF(t){const e=Ir(t),n=x.useRef(""),i=x.useRef(0),r=x.useCallback(o=>{const a=n.current+o;e(a),function l(c){n.current=c,window.clearTimeout(i.current),c!==""&&(i.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),s=x.useCallback(()=>{n.current="",window.clearTimeout(i.current)},[]);return x.useEffect(()=>()=>window.clearTimeout(i.current),[]),[n,r,s]}function lF(t,e,n){const r=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=Nce(t,Math.max(s,0));r.length===1&&(o=o.filter(c=>c!==n));const l=o.find(c=>c.textValue.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function Nce(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var Mce=F$,cF=U$,Rce=H$,Ice=W$,Tce=G$,uF=q$,Oce=J$,dF=tF,Lce=nF;const a0=Mce,l0=Rce,Ih=x.forwardRef(({className:t,children:e,...n},i)=>h.jsxs(cF,{ref:i,className:re("flex h-10 items-center justify-between rounded-md border border-stone-600 bg-stone-900 px-3 py-2 text-sm ring-offset-stone-800 placeholder:text-stone-500 focus:outline-none focus:ring-2 focus:ring-stone-600 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:[e,h.jsx(Ice,{asChild:!0,children:h.jsx("span",{className:"icon-[lucide--chevron-down] size-4 opacity-50"})})]}));Ih.displayName=cF.displayName;const Th=x.forwardRef(({className:t,children:e,position:n="popper",...i},r)=>h.jsx(Tce,{children:h.jsx(uF,{ref:r,className:re("relative z-50 min-w-32 overflow-hidden rounded-md border border-stone-600 bg-stone-900 text-white shadow-md",t),position:n,...i,children:h.jsx(Oce,{className:"p-1",children:e})})}));Th.displayName=uF.displayName;const Xs=x.forwardRef(({className:t,children:e,...n},i)=>h.jsx(dF,{ref:i,className:re("w-full cursor-default select-none rounded-sm px-2 py-1.5 text-sm outline-none transition-colors duration-75 focus:bg-stone-800 focus:text-mantis-400 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:h.jsx(Lce,{children:e})}));Xs.displayName=dF.displayName;var fF=["PageUp","PageDown"],hF=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],pF={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},If="Slider",[Zk,Dce,jce]=_m(If),[mF,yve]=zs(If,[jce]),[Bce,h1]=mF(If),gF=x.forwardRef((t,e)=>{const{name:n,min:i=0,max:r=100,step:s=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[i],value:u,onValueChange:d=()=>{},onValueCommit:f=()=>{},inverted:p=!1,form:m,...g}=t,y=x.useRef(new Set),v=x.useRef(0),w=o==="horizontal"?$ce:Fce,[k=[],C]=Il({prop:u,defaultProp:c,onChange:O=>{var G;(G=[...y.current][v.current])==null||G.focus(),d(O)}}),E=x.useRef(k);function _(O){const I=Wce(k,O);L(O,I)}function A(O){L(O,v.current)}function R(){const O=E.current[v.current];k[v.current]!==O&&f(k)}function L(O,I,{commit:G}={commit:!1}){const B=Xce(s),K=Yce(Math.round((O-i)/s)*s+i,B),J=My(K,[i,r]);C((ne=[])=>{const V=Vce(ne,J,I);if(Kce(V,l*s)){v.current=V.indexOf(J);const U=String(V)!==String(ne);return U&&G&&f(V),U?V:ne}else return ne})}return h.jsx(Bce,{scope:t.__scopeSlider,name:n,disabled:a,min:i,max:r,valueIndexToChangeRef:v,thumbs:y.current,values:k,orientation:o,form:m,children:h.jsx(Zk.Provider,{scope:t.__scopeSlider,children:h.jsx(Zk.Slot,{scope:t.__scopeSlider,children:h.jsx(w,{"aria-disabled":a,"data-disabled":a?"":void 0,...g,ref:e,onPointerDown:ke(g.onPointerDown,()=>{a||(E.current=k)}),min:i,max:r,inverted:p,onSlideStart:a?void 0:_,onSlideMove:a?void 0:A,onSlideEnd:a?void 0:R,onHomeKeyDown:()=>!a&&L(i,0,{commit:!0}),onEndKeyDown:()=>!a&&L(r,k.length-1,{commit:!0}),onStepKeyDown:({event:O,direction:I})=>{if(!a){const K=fF.includes(O.key)||O.shiftKey&&hF.includes(O.key)?10:1,J=v.current,ne=k[J],V=s*K*I;L(ne+V,J,{commit:!0})}}})})})})});gF.displayName=If;var[vF,yF]=mF(If,{startEdge:"left",endEdge:"right",size:"width",direction:1}),$ce=x.forwardRef((t,e)=>{const{min:n,max:i,dir:r,inverted:s,onSlideStart:o,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=t,[d,f]=x.useState(null),p=wt(e,w=>f(w)),m=x.useRef(void 0),g=Sb(r),y=g==="ltr",v=y&&!s||!y&&s;function b(w){const k=m.current||d.getBoundingClientRect(),C=[0,k.width],_=xA(C,v?[n,i]:[i,n]);return m.current=k,_(w-k.left)}return h.jsx(vF,{scope:t.__scopeSlider,startEdge:v?"left":"right",endEdge:v?"right":"left",direction:v?1:-1,size:"width",children:h.jsx(bF,{dir:g,"data-orientation":"horizontal",...u,ref:p,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:w=>{const k=b(w.clientX);o==null||o(k)},onSlideMove:w=>{const k=b(w.clientX);a==null||a(k)},onSlideEnd:()=>{m.current=void 0,l==null||l()},onStepKeyDown:w=>{const C=pF[v?"from-left":"from-right"].includes(w.key);c==null||c({event:w,direction:C?-1:1})}})})}),Fce=x.forwardRef((t,e)=>{const{min:n,max:i,inverted:r,onSlideStart:s,onSlideMove:o,onSlideEnd:a,onStepKeyDown:l,...c}=t,u=x.useRef(null),d=wt(e,u),f=x.useRef(void 0),p=!r;function m(g){const y=f.current||u.current.getBoundingClientRect(),v=[0,y.height],w=xA(v,p?[i,n]:[n,i]);return f.current=y,w(g-y.top)}return h.jsx(vF,{scope:t.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:h.jsx(bF,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:g=>{const y=m(g.clientY);s==null||s(y)},onSlideMove:g=>{const y=m(g.clientY);o==null||o(y)},onSlideEnd:()=>{f.current=void 0,a==null||a()},onStepKeyDown:g=>{const v=pF[p?"from-bottom":"from-top"].includes(g.key);l==null||l({event:g,direction:v?-1:1})}})})}),bF=x.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:i,onSlideMove:r,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:l,...c}=t,u=h1(If,n);return h.jsx(et.span,{...c,ref:e,onKeyDown:ke(t.onKeyDown,d=>{d.key==="Home"?(o(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):fF.concat(hF).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:ke(t.onPointerDown,d=>{const f=d.target;f.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(f)?f.focus():i(d)}),onPointerMove:ke(t.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&r(d)}),onPointerUp:ke(t.onPointerUp,d=>{const f=d.target;f.hasPointerCapture(d.pointerId)&&(f.releasePointerCapture(d.pointerId),s(d))})})}),xF="SliderTrack",wF=x.forwardRef((t,e)=>{const{__scopeSlider:n,...i}=t,r=h1(xF,n);return h.jsx(et.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...i,ref:e})});wF.displayName=xF;var Qk="SliderRange",SF=x.forwardRef((t,e)=>{const{__scopeSlider:n,...i}=t,r=h1(Qk,n),s=yF(Qk,n),o=x.useRef(null),a=wt(e,o),l=r.values.length,c=r.values.map(f=>CF(f,r.min,r.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return h.jsx(et.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...i,ref:a,style:{...t.style,[s.startEdge]:u+"%",[s.endEdge]:d+"%"}})});SF.displayName=Qk;var e_="SliderThumb",kF=x.forwardRef((t,e)=>{const n=Dce(t.__scopeSlider),[i,r]=x.useState(null),s=wt(e,a=>r(a)),o=x.useMemo(()=>i?n().findIndex(a=>a.ref.current===i):-1,[n,i]);return h.jsx(zce,{...t,ref:s,index:o})}),zce=x.forwardRef((t,e)=>{const{__scopeSlider:n,index:i,name:r,...s}=t,o=h1(e_,n),a=yF(e_,n),[l,c]=x.useState(null),u=wt(e,b=>c(b)),d=l?o.form||!!l.closest("form"):!0,f=fA(l),p=o.values[i],m=p===void 0?0:CF(p,o.min,o.max),g=Hce(i,o.values.length),y=f==null?void 0:f[a.size],v=y?Gce(y,m,a.direction):0;return x.useEffect(()=>{if(l)return o.thumbs.add(l),()=>{o.thumbs.delete(l)}},[l,o.thumbs]),h.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${m}% + ${v}px)`},children:[h.jsx(Zk.ItemSlot,{scope:t.__scopeSlider,children:h.jsx(et.span,{role:"slider","aria-label":t["aria-label"]||g,"aria-valuemin":o.min,"aria-valuenow":p,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...s,ref:u,style:p===void 0?{display:"none"}:t.style,onFocus:ke(t.onFocus,()=>{o.valueIndexToChangeRef.current=i})})}),d&&h.jsx(_F,{name:r??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:p},i)]})});kF.displayName=e_;var Uce="RadioBubbleInput",_F=x.forwardRef(({__scopeSlider:t,value:e,...n},i)=>{const r=x.useRef(null),s=wt(r,i),o=vA(e);return x.useEffect(()=>{const a=r.current;if(!a)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==e&&u){const d=new Event("input",{bubbles:!0});u.call(a,e),a.dispatchEvent(d)}},[o,e]),h.jsx(et.input,{style:{display:"none"},...n,ref:s,defaultValue:e})});_F.displayName=Uce;function Vce(t=[],e,n){const i=[...t];return i[n]=e,i.sort((r,s)=>r-s)}function CF(t,e,n){const s=100/(n-e)*(t-e);return My(s,[0,100])}function Hce(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function Wce(t,e){if(t.length===1)return 0;const n=t.map(r=>Math.abs(r-e)),i=Math.min(...n);return n.indexOf(i)}function Gce(t,e,n){const i=t/2,s=xA([0,50],[0,i]);return(i-s(e)*n)*n}function qce(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function Kce(t,e){if(e>0){const n=qce(t);return Math.min(...n)>=e}return!0}function xA(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const i=(e[1]-e[0])/(t[1]-t[0]);return e[0]+i*(n-t[0])}}function Xce(t){return(String(t).split(".")[1]||"").length}function Yce(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}var EF=gF,Jce=wF,Zce=SF,Qce=kF;const Va=x.forwardRef(({className:t,...e},n)=>h.jsxs(EF,{ref:n,className:re("relative flex touch-none select-none items-center",t),...e,children:[h.jsx(Jce,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-stone-900",children:h.jsx(Zce,{className:"absolute h-full bg-mantis-400"})}),h.jsx(Qce,{className:"block size-5 rounded-full border-2 border-stone-900 bg-mantis-400 ring-offset-stone-800 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Va.displayName=EF.displayName;var p1="Switch",[eue,bve]=zs(p1),[tue,nue]=eue(p1),AF=x.forwardRef((t,e)=>{const{__scopeSwitch:n,name:i,checked:r,defaultChecked:s,required:o,disabled:a,value:l="on",onCheckedChange:c,form:u,...d}=t,[f,p]=x.useState(null),m=wt(e,w=>p(w)),g=x.useRef(!1),y=f?u||!!f.closest("form"):!0,[v,b]=Il({prop:r,defaultProp:s??!1,onChange:c,caller:p1});return h.jsxs(tue,{scope:n,checked:v,disabled:a,children:[h.jsx(et.button,{type:"button",role:"switch","aria-checked":v,"aria-required":o,"data-state":RF(v),"data-disabled":a?"":void 0,disabled:a,value:l,...d,ref:m,onClick:ke(t.onClick,w=>{b(k=>!k),y&&(g.current=w.isPropagationStopped(),g.current||w.stopPropagation())})}),y&&h.jsx(MF,{control:f,bubbles:!g.current,name:i,value:l,checked:v,required:o,disabled:a,form:u,style:{transform:"translateX(-100%)"}})]})});AF.displayName=p1;var PF="SwitchThumb",NF=x.forwardRef((t,e)=>{const{__scopeSwitch:n,...i}=t,r=nue(PF,n);return h.jsx(et.span,{"data-state":RF(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:e})});NF.displayName=PF;var iue="SwitchBubbleInput",MF=x.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:i=!0,...r},s)=>{const o=x.useRef(null),a=wt(o,s),l=vA(n),c=fA(e);return x.useEffect(()=>{const u=o.current;if(!u)return;const d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&p){const m=new Event("click",{bubbles:i});p.call(u,n),u.dispatchEvent(m)}},[l,n,i]),h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...r,tabIndex:-1,ref:a,style:{...r.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});MF.displayName=iue;function RF(t){return t?"checked":"unchecked"}var IF=AF,rue=NF;const Ha=x.forwardRef(({className:t,...e},n)=>h.jsx(IF,{className:re("peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-mantis-400 data-[state=unchecked]:bg-stone-900",t),...e,ref:n,children:h.jsx(rue,{className:re("pointer-events-none block size-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ha.displayName=IF.displayName;const m1=pe(!1);function sue(t){return(1e3/t).toFixed(1)}function TF({className:t}){const e=cn(),[n,i]=Oo();return h.jsxs("div",{className:re("overflow-auto scrollbar-stone-700",t),children:[h.jsxs("h3",{className:"flex items-center gap-2 border-b border-stone-600 py-2 pl-4 text-xl font-semibold",children:[h.jsx("span",{className:"icon-[lucide--settings] size-6"})," ",e("settings.title")]}),h.jsxs(zi,{children:[h.jsxs(Ui,{children:[h.jsxs(Vi,{children:[h.jsx("span",{className:"icon-[lucide--rotate-3d] size-6"}),e("settings.animations.label")]}),h.jsx(Iu,{children:e("settings.animations.description")})]}),h.jsx(Ha,{className:"ml-8",checked:n.animations,onCheckedChange:r=>{i(s=>({...s,animations:r})),r===!1&&HE()}})]}),h.jsxs(zi,{children:[h.jsx(Ui,{children:h.jsxs(Vi,{children:[h.jsx("span",{className:"icon-[lucide--gauge] size-6"}),e("settings.speeds.executionUnit")]})}),h.jsx(Va,{className:"w-44",...eT({value:Math.min(n.executionUnit,250),onValueChange:r=>i(s=>({...s,executionUnit:Math.min(r,250)})),min:250,max:1})})]}),h.jsx("hr",{className:"border-stone-600"}),h.jsxs(zi,{children:[h.jsx(Ui,{children:h.jsx(Vi,{children:e("settings.instructionCycle.label")})}),h.jsx(Ha,{className:"ml-8",checked:n.showInstructionCycle,onCheckedChange:r=>i(s=>({...s,showInstructionCycle:r}))})]}),h.jsxs(zi,{children:[h.jsx(Ui,{children:h.jsx(Vi,{children:e("settings.statsCPU.label")})}),h.jsx(Ha,{className:"ml-8",checked:n.showStatsCPU,onCheckedChange:r=>i(s=>({...s,showStatsCPU:r}))})]}),h.jsxs(zi,{children:[h.jsxs(Ui,{children:[h.jsxs(Vi,{children:[h.jsx("span",{className:"icon-[lucide--cpu] size-6"}),"Velocidad CPU (Hz)"]}),h.jsxs(Iu,{children:[h.jsxs("span",{className:"font-medium text-stone-300",children:[n.cpuSpeed," Hz"]})," (",(1/n.cpuSpeed).toFixed(2),"s por ciclo)",n.cpuSpeed===1&&" - Muy lenta",n.cpuSpeed===2&&" - Lenta",n.cpuSpeed===4&&" - Normal",n.cpuSpeed===10&&" - Rápida"]})]}),h.jsxs("div",{className:"flex flex-col items-end gap-2",children:[h.jsx(Va,{className:"w-44",value:[n.cpuSpeed===1?0:n.cpuSpeed===2?1:n.cpuSpeed===4?2:3],onValueChange:([r])=>{const s=[1,2,4,10];i(o=>({...o,cpuSpeed:s[r]}))},min:0,max:3,step:1}),h.jsxs("div",{className:"flex w-44 justify-between text-xs text-stone-500",children:[h.jsx("span",{children:"1 Hz"}),h.jsx("span",{children:"2 Hz"}),h.jsx("span",{children:"4 Hz"}),h.jsx("span",{children:"10 Hz"})]})]})]}),h.jsxs(zi,{children:[h.jsxs(Ui,{children:[h.jsxs(Vi,{children:[h.jsx("span",{className:"icon-[lucide--flag] size-6"}),e("settings.flags.label")]}),h.jsx(Iu,{children:e("settings.flags.description")})]}),h.jsxs(a0,{value:n.flagsVisibility,onValueChange:r=>i(s=>({...s,flagsVisibility:r})),children:[h.jsx(Ih,{className:"w-32",children:h.jsx(l0,{})}),h.jsxs(Th,{children:[h.jsx(Xs,{value:"CF_ZF",children:"C Z"}),h.jsx(Xs,{value:"SF_OF_CF_ZF",children:"S O C Z"})]})]})]}),h.jsx("hr",{className:"border-stone-600"}),h.jsx(zi,{children:h.jsxs(Ui,{children:[h.jsxs(Vi,{children:[h.jsx("span",{className:"icon-[lucide--monitor-smartphone] size-6"}),e("settings.devices.label")]}),h.jsx(Iu,{children:e("settings.devices.description")})]})}),h.jsxs(zi,{children:[h.jsx(Ui,{children:h.jsx(Vi,{children:e("settings.devices.keyboard-and-screen")})}),h.jsx(Ha,{className:"ml-8",checked:n.devices.keyboardAndScreen,onCheckedChange:r=>i(s=>({...s,devices:{...s.devices,keyboardAndScreen:r}}))})]}),h.jsxs(zi,{children:[h.jsxs(Ui,{children:[h.jsx(Vi,{children:e("settings.devices.pic.label")}),h.jsx(Iu,{children:e("settings.devices.pic.description")})]}),h.jsx(Ha,{className:"ml-8",checked:n.devices.pic,onCheckedChange:r=>i(s=>({...s,devices:{...s.devices,pic:r}}))})]}),h.jsxs(zi,{children:[h.jsx(Ui,{children:h.jsx(Vi,{children:e("settings.devices.pio.label")})}),h.jsxs(a0,{value:n.devices.pio??"null",onValueChange:r=>i(s=>({...s,devices:{...s.devices,pio:r==="null"?null:r,handshake:s.devices.handshake===r?null:s.devices.handshake}})),children:[h.jsx(Ih,{className:"w-52 min-w-[theme(width.52)]",children:h.jsx(l0,{})}),h.jsx(Th,{children:YJ.filter(r=>r!=="printer").map(r=>h.jsx(Xs,{value:r,children:e(`settings.devices.pio.${r}`)},r))})]})]}),h.jsxs(zi,{children:[h.jsx(Ui,{children:h.jsx(Vi,{children:e("settings.devices.handshake.label")})}),h.jsxs(a0,{value:n.devices.handshake??"null",onValueChange:r=>i(s=>({...s,devices:{...s.devices,handshake:r==="null"?null:r,pio:s.devices.pio===r?null:s.devices.pio}})),children:[h.jsx(Ih,{className:"w-52 min-w-[theme(width.52)]",children:h.jsx(l0,{})}),h.jsx(Th,{children:JJ.map(r=>h.jsx(Xs,{value:r,children:e(`settings.devices.handshake.${r}`)},r))})]})]}),n.devices.handshake==="printer"&&h.jsxs(zi,{children:[h.jsx(Ui,{children:h.jsxs(Vi,{children:[h.jsx("span",{className:"icon-[lucide--printer] size-6"}),e("settings.speeds.printerSpeed")]})}),h.jsx(Va,{className:"w-44",...eT({value:n.printerSpeed,onValueChange:r=>i(s=>({...s,printerSpeed:r})),min:2e4,max:500})})]}),n.devices.pic&&h.jsxs(zi,{children:[h.jsx(Ui,{children:h.jsxs(Vi,{children:[h.jsx("span",{className:"icon-[lucide--timer] size-6"}),"Frecuencia del Timer"]})}),h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsxs(a0,{value:n.clockSpeed.toString(),onValueChange:r=>i(s=>({...s,clockSpeed:parseInt(r)})),children:[h.jsx(Ih,{className:"w-40",children:h.jsx(l0,{})}),h.jsxs(Th,{children:[h.jsx(Xs,{value:"100",title:"Timer muy frecuente - Interrupciones cada 0.1 segundos",children:h.jsxs("div",{className:"flex w-full items-center justify-between",children:[h.jsx("span",{children:"Muy Frecuente"}),h.jsx("span",{className:"text-xs text-stone-400",children:"0.1s"})]})}),h.jsx(Xs,{value:"400",title:"Timer frecuente - Interrupciones cada 0.4 segundos",children:h.jsxs("div",{className:"flex w-full items-center justify-between",children:[h.jsx("span",{children:"Frecuente"}),h.jsx("span",{className:"text-xs text-stone-400",children:"0.4s"})]})}),h.jsx(Xs,{value:"600",title:"Timer normal - Interrupciones cada 0.6 segundos",children:h.jsxs("div",{className:"flex w-full items-center justify-between",children:[h.jsx("span",{children:"Normal"}),h.jsx("span",{className:"text-xs text-stone-400",children:"0.6s"})]})}),h.jsx(Xs,{value:"800",title:"Timer lento - Interrupciones cada 0.8 segundos",children:h.jsxs("div",{className:"flex w-full items-center justify-between",children:[h.jsx("span",{children:"Lento"}),h.jsx("span",{className:"text-xs text-stone-400",children:"0.8s"})]})}),h.jsx(Xs,{value:"1000",title:"Timer muy lento - Interrupciones cada 1 segundo",children:h.jsxs("div",{className:"flex w-full items-center justify-between",children:[h.jsx("span",{children:"Muy Lento"}),h.jsx("span",{className:"text-xs text-stone-400",children:"1.0s"})]})})]})]}),h.jsxs("div",{className:"flex items-center gap-1 text-xs text-stone-400",children:[h.jsx("span",{className:"icon-[lucide--info] size-4"}),h.jsxs("span",{children:["Frecuencia: ",sue(n.clockSpeed)," Hz"]})]})]})]}),h.jsx("hr",{className:"border-stone-600"}),h.jsxs(zi,{children:[h.jsxs(Ui,{children:[h.jsxs(Vi,{children:[h.jsx("span",{className:"icon-[lucide--contrast] size-6"}),e("settings.filters.label")]}),h.jsxs(Iu,{children:[e("settings.filters.description"),h.jsx("button",{className:"mt-1 block text-mantis-400 transition-colors hover:text-mantis-300",onClick:()=>i(r=>({...r,filterBightness:Bu.filterBightness,filterContrast:Bu.filterContrast,filterInvert:Bu.filterInvert,filterSaturation:Bu.filterSaturation})),children:e("settings.filters.revert")})]})]}),h.jsxs("div",{className:"ml-8 grid w-64 grid-cols-[min-content,auto] items-center gap-2",children:[h.jsx("span",{className:"text-xs",children:e("settings.filters.brightness")}),h.jsx(Va,{value:[n.filterBightness],onValueChange:([r])=>i(s=>({...s,filterBightness:r})),min:0,max:5,step:.05}),h.jsx("span",{className:"text-xs",children:e("settings.filters.contrast")}),h.jsx(Va,{value:[n.filterContrast],onValueChange:([r])=>i(s=>({...s,filterContrast:r})),min:0,max:5,step:.05}),h.jsx("span",{className:"text-xs",children:e("settings.filters.invert")}),h.jsx(Ha,{checked:n.filterInvert,onCheckedChange:r=>i(s=>({...s,filterInvert:r}))}),h.jsx("span",{className:"text-xs",children:e("settings.filters.saturation")}),h.jsx(Va,{value:[n.filterSaturation],onValueChange:([r])=>i(s=>({...s,filterSaturation:r})),min:0,max:5,step:.05})]})]}),h.jsx("hr",{className:"border-stone-600"}),h.jsx("div",{className:"flex justify-end p-4",children:h.jsxs("button",{className:"inline-flex items-center gap-1 text-sm text-red-500 transition-colors hover:text-red-400",onClick:()=>i(r=>({...Bu,language:r.language,devices:r.devices})),children:[h.jsx("span",{className:"icon-[lucide--trash-2] size-4"}),e("settings.reset")]})})]})}function zi({children:t}){return h.jsx("div",{className:"m-4 flex items-center justify-between gap-4",children:t})}function Ui({children:t}){return h.jsx("div",{className:"grow",children:t})}function Vi({children:t}){return h.jsx("p",{className:"flex items-center gap-2 font-medium",children:t})}function Iu({children:t}){return h.jsx("p",{className:"mt-1 text-xs text-stone-400",children:t})}function eT({value:t,onValueChange:e,min:n,max:i}){const r=Math.log(n),o=(Math.log(i)-r)/100;return{value:[(Math.log(t)-r)/o],onValueChange:a=>e(Math.exp(r+o*a[0])),min:0,max:100}}const oue=()=>({handleShowTour:x.useCallback(()=>{window.startWelcomeTour?window.startWelcomeTour():(localStorage.removeItem("vonsim8-tour-completed"),window.location.reload())},[])}),t_=x.memo(({status:t,isMobile:e,isCompact:n})=>{const i=tt(Hn),[r]=Oo(),[s,o]=x.useState(null),[a,l]=x.useState(!1),c=x.useMemo(()=>{switch(t.type){case"running":return"Ejecutando";case"paused":return"Pausado";default:return"Detenido"}},[t.type]),u=x.useMemo(()=>{switch(t.type){case"running":return"bg-green-600";case"paused":return"bg-yellow-600";default:return"bg-stone-600"}},[t.type]);x.useEffect(()=>{if(i&&i.phase&&i.phase!==s){o(i.phase),l(!0);const m=setTimeout(()=>{l(!1)},800);return()=>clearTimeout(m)}},[i,s]);const d=x.useMemo(()=>{if(!i||t.type!=="running"&&i.phase!=="halting"||!r.animations)return"";switch(i.phase){case"fetching":return"Captación";case"fetching-operands":return"Obtención de operandos";case"fetching-operands-completed":return"Operandos obtenidos";case"executing":return"Ejecución";case"writeback":return"Escritura";case"interrupt":return"Interrupción";case"int6":case"int7":return"Interrupción";case"halting":return"Detener CPU";default:return""}},[i,t.type,r.animations]),f=x.useMemo(()=>{if(!i||t.type!=="running"&&i.phase!=="halting")return"";switch(i.phase){case"fetching":return"bg-slate-800/70 text-blue-300 border-l-blue-400";case"fetching-operands":return"bg-slate-800/70 text-yellow-300 border-l-yellow-400";case"fetching-operands-completed":return"bg-slate-800/70 text-yellow-300 border-l-yellow-400";case"executing":return"bg-slate-800/70 text-green-300 border-l-green-400";case"writeback":return"bg-slate-800/70 text-purple-300 border-l-purple-400";case"interrupt":return"bg-slate-800/70 text-red-300 border-l-red-400";case"int6":case"int7":return"bg-slate-800/70 text-orange-300 border-l-orange-400";case"halting":return"bg-slate-800/70 text-red-300 border-l-red-400";default:return"bg-slate-800/70 text-stone-300 border-l-stone-400"}},[i,t.type]),p=x.useMemo(()=>{if(!a||!i)return"";switch(i.phase){case"fetching":return"animate-phase-pulse-blue";case"fetching-operands":return"animate-phase-pulse-yellow";case"fetching-operands-completed":return"animate-phase-pulse-yellow";case"executing":return"animate-phase-pulse-green";case"writeback":return"animate-phase-pulse-purple";case"interrupt":return"animate-phase-pulse-red";case"int6":case"int7":return"animate-phase-pulse-orange";case"halting":return"animate-phase-pulse-red";default:return"animate-phase-pulse-stone"}},[a,i]);return h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("div",{className:re("flex items-center gap-1.5 rounded-full px-2 py-1 font-medium text-white",u,t.type==="running"&&"animate-pulse-glow",e&&"px-1.5 py-0.5",n&&"px-1 py-0.5"),children:[h.jsx("div",{className:re("size-2 rounded-full",t.type==="running"?"bg-green-300":t.type==="paused"?"bg-yellow-300":"bg-stone-300")}),!e&&!n&&c]}),(t.type==="running"||i&&i.phase==="halting")&&d&&h.jsxs("div",{className:re("rounded-lg border-l-4 text-[10px] font-bold lowercase tracking-wide shadow-sm backdrop-blur-sm transition-all duration-300 ease-in-out",f,p,e?"flex min-h-[24px] items-center justify-center whitespace-nowrap px-3 py-1 text-[9px]":n?"flex min-h-[22px] items-center justify-center whitespace-nowrap px-2.5 py-1 text-[9px]":"px-3 py-1.5"),children:[d," "]})]})});t_.displayName="SimulationStatus";const OF=x.memo(({onShowTour:t,onToggleSettings:e,settingsOpen:n,onToggleEducational:i,educationalOpen:r})=>{const s=cn();return h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(rs,{content:"Centro de aprendizaje",position:"bottom",children:h.jsx(W0,{icon:h.jsx(Ye,{icon:Nm,className:"size-4"}),onClick:i,variant:r?"secondary":"ghost",size:"md","aria-label":"Centro de aprendizaje",className:re("hover-lift",r&&"animate-pulse-glow"),"data-testid":"educational-button"})}),h.jsx(rs,{content:"Mostrar tour de bienvenida",position:"bottom",children:h.jsx(W0,{icon:h.jsx(Ye,{icon:ZY,className:"size-4"}),onClick:t,variant:"ghost",size:"md","aria-label":"Mostrar tour de bienvenida",className:"hover-lift"})}),h.jsx(rs,{content:s("settings.title"),position:"bottom",children:h.jsx(W0,{icon:h.jsx("span",{className:"icon-[lucide--settings] block size-5"}),onClick:e,variant:n?"secondary":"ghost",size:"md","aria-label":s("settings.title"),className:re("hover-lift",n&&"animate-pulse-glow"),"data-testid":"settings-button"})})]})});OF.displayName="ActionButtons";const LF=x.memo(()=>{const[t,e]=Em(m1),[n,i]=x.useState(!1),[r,s]=x.useState(!1),{status:o}=Kn(),{handleShowTour:a}=oue(),[l,c]=x.useState("desktop");x.useEffect(()=>{const y=()=>{const v=window.innerWidth;v<=480?c("mobile"):v<=768?c("compact"):v<=1024?c("tablet"):c("desktop")};return y(),window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[]);const u=x.useCallback(()=>{e(y=>!y)},[e]),d=x.useCallback(()=>{i(y=>!y)},[]),f=x.useCallback(()=>{s(y=>!y)},[]),p=x.useMemo(()=>h.jsxs("div",{className:"hover-scale flex select-none items-center justify-center",children:[h.jsxs("div",{className:"group relative flex size-10 items-center justify-center overflow-hidden rounded-xl bg-gradient-to-br from-mantis-500 to-mantis-600 shadow-lg hover:scale-105",children:[h.jsx("div",{className:"absolute inset-0 opacity-10",children:h.jsx("div",{className:"size-full bg-[radial-gradient(circle_at_30%_30%,rgba(255,255,255,0.1)_1px,transparent_1px),radial-gradient(circle_at_70%_70%,rgba(255,255,255,0.1)_1px,transparent_1px)] bg-[length:8px_8px]"})}),h.jsx("div",{className:"relative z-10 flex items-center justify-center",children:h.jsx("span",{className:"text-lg font-bold tracking-tight text-white",children:"V8"})}),h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-white/10 to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),h.jsx("div",{className:"absolute -right-0.5 -top-0.5 size-2 animate-pulse rounded-full bg-mantis-300"})]}),h.jsxs("div",{className:"ml-3 flex flex-col",children:[h.jsxs("h1",{className:"text-lg font-bold max-sm:hidden",children:["Von",h.jsx("span",{className:"text-mantis-400",children:"Sim"}),"8"]}),h.jsx("span",{className:"text-xs text-stone-400 max-sm:hidden",children:"Simulador CPU 8-bit"})]})]}),[]),g=(()=>{switch(l){case"mobile":return{gridCols:"grid-cols-2",showStatusLeft:!0,showStatusCenter:!1,showActionButtons:!1,isCompact:!0,isMobile:!0};case"compact":return{gridCols:"grid-cols-3",showStatusLeft:!1,showStatusCenter:!0,showActionButtons:!1,isCompact:!0,isMobile:!1};case"tablet":return{gridCols:"grid-cols-3",showStatusLeft:!1,showStatusCenter:!0,showActionButtons:!0,isCompact:!1,isMobile:!1};case"desktop":return{gridCols:"grid-cols-3",showStatusLeft:!1,showStatusCenter:!0,showActionButtons:!0,isCompact:!1,isMobile:!1}}})();return h.jsxs(h.Fragment,{children:[h.jsx("header",{className:re("relative bg-black text-sm text-white",l==="mobile"?"header-mobile p-2":l==="compact"?"header-compact p-2":l==="tablet"?"header-tablet p-2":"p-2"),"data-testid":"header",children:h.jsxs("div",{className:re("grid items-center",g.gridCols),children:[h.jsxs("div",{className:"flex items-center gap-3",children:[p,g.showStatusLeft&&h.jsx(t_,{status:o,isMobile:g.isMobile,isCompact:g.isCompact})]}),g.showStatusCenter&&h.jsx("div",{className:"flex justify-center",children:h.jsx(t_,{status:o,isMobile:g.isMobile,isCompact:g.isCompact})}),h.jsxs("div",{className:"flex items-center justify-end gap-6",children:[h.jsx("div",{className:"flex justify-end",children:h.jsx(Ioe,{})}),g.showActionButtons&&h.jsx(OF,{onShowTour:a,onToggleSettings:u,settingsOpen:t,onToggleEducational:d,educationalOpen:n})]})]})}),!g.isMobile&&n&&h.jsx(i$,{isOpen:n,onClose:()=>i(!1),onShowProgress:f}),!g.isMobile&&r&&h.jsx(r$,{isVisible:r,onClose:()=>s(!1)})]})});LF.displayName="Header";const aue=[{key:"F7",description:"Ejecutar un ciclo",category:"Simulación"},{key:"F8",description:"Ejecutar una instrucción completa",category:"Simulación"},{key:"F4",description:"Ejecución infinita",category:"Simulación"},{key:"F9",description:"Resetear simulación",category:"Simulación"},{key:"Espacio",description:"Pausar/Reanudar (cuando está ejecutando)",category:"Simulación"},{key:"Ctrl+S",description:"Guardar archivo",category:"Editor"},{key:"Ctrl+O",description:"Abrir archivo",category:"Editor"},{key:"Ctrl+N",description:"Nuevo archivo",category:"Editor"},{key:"Ctrl+Z",description:"Deshacer",category:"Editor"},{key:"Ctrl+Y",description:"Rehacer",category:"Editor"},{key:"Ctrl+F",description:"Buscar",category:"Editor"},{key:"Ctrl+H",description:"Reemplazar",category:"Editor"},{key:"Tab",description:"Indentar",category:"Editor"},{key:"Shift+Tab",description:"Desindentar",category:"Editor"},{key:"F1",description:"Mostrar atajos de teclado",category:"Navegación"},{key:"F2",description:"Abrir configuración",category:"Navegación"},{key:"F3",description:"Buscar en el código",category:"Navegación"},{key:"F5",description:"Actualizar página",category:"Navegación"},{key:"F6",description:"Cambiar foco al editor",category:"Navegación"},{key:"Escape",description:"Cerrar diálogos",category:"Interfaz"},{key:"Ctrl+Shift+P",description:"Paleta de comandos",category:"Interfaz"},{key:"Ctrl+B",description:"Mostrar/ocultar barra lateral",category:"Interfaz"},{key:"Ctrl+J",description:"Mostrar/ocultar terminal",category:"Interfaz"},{key:"Ctrl++",description:"Zoom in",category:"Vista"},{key:"Ctrl+-",description:"Zoom out",category:"Vista"},{key:"Ctrl+0",description:"Resetear zoom",category:"Vista"},{key:"Ctrl+Shift+Z",description:"Zoom a la selección",category:"Vista"},{key:"F12",description:"Herramientas de desarrollador",category:"Desarrollo"},{key:"Ctrl+Shift+I",description:"Inspeccionar elemento",category:"Desarrollo"},{key:"Ctrl+Shift+C",description:"Seleccionar elemento",category:"Desarrollo"},{key:"Ctrl+Shift+J",description:"Consola",category:"Desarrollo"},{key:"Ctrl+Shift+M",description:"Vista móvil",category:"Desarrollo"}],lue=()=>{const[t,e]=x.useState(!1),n=x.useCallback(()=>{e(!0)},[]),i=x.useCallback(()=>{e(!1)},[]);return x.useEffect(()=>{const r=s=>{s.key==="F1"&&(s.preventDefault(),n())};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[n]),{isOpen:t,openModal:n,closeModal:i}},cue=()=>x.useMemo(()=>{const t=aue.reduce((e,n)=>(e[n.category]||(e[n.category]=[]),e[n.category].push(n),e),{});return Object.entries(t).sort(([e],[n])=>e.localeCompare(n))},[]),DF=x.memo(({shortcut:t})=>h.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-stone-800 p-3 transition-colors hover:bg-stone-700",children:[h.jsx("span",{className:"text-sm text-stone-300",children:t.description}),h.jsx("kbd",{className:"rounded border border-stone-600 bg-stone-700 px-2 py-1 font-mono text-xs text-white",children:t.key})]}));DF.displayName="ShortcutItem";const jF=x.memo(({category:t,shortcuts:e})=>h.jsxs("div",{className:"space-y-2",children:[h.jsx("h3",{className:"border-b border-stone-600 pb-2 text-lg font-semibold text-mantis-400",children:t}),h.jsx("div",{className:"space-y-2",children:e.map((n,i)=>h.jsx(DF,{shortcut:n},`${t}-${i}`))})]}));jF.displayName="ShortcutCategory";const BF=x.memo(()=>{const{isOpen:t,closeModal:e}=lue(),n=cue(),i=x.useCallback(s=>{s.target===s.currentTarget&&e()},[e]),r=x.useCallback(s=>{s.key==="Escape"&&e()},[e]);return x.useEffect(()=>{if(t)return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[t,r]),t?h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:i,children:h.jsxs("div",{className:"max-h-[80vh] w-full max-w-4xl overflow-hidden rounded-lg border border-stone-600 bg-stone-900 shadow-xl",children:[h.jsxs("div",{className:"flex items-center justify-between border-b border-stone-600 p-4",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"icon-[lucide--keyboard] size-6 text-mantis-400"}),h.jsx("h2",{className:"text-xl font-semibold text-white",children:"Atajos de Teclado"})]}),h.jsx("button",{onClick:e,className:"rounded p-2 text-stone-400 transition-colors hover:text-white",children:h.jsx(Ye,{icon:Tb,size:"lg"})})]}),h.jsx("div",{className:"max-h-[calc(80vh-80px)] overflow-y-auto p-4",children:h.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:n.map(([s,o])=>h.jsx(jF,{category:s,shortcuts:o},s))})}),h.jsx("div",{className:"border-t border-stone-600 bg-stone-800 p-4",children:h.jsxs("div",{className:"flex items-center justify-between text-sm text-stone-400",children:[h.jsxs("span",{children:["Presiona"," ",h.jsx("kbd",{className:"rounded border border-stone-600 bg-stone-700 px-1 py-0.5 font-mono text-xs",children:"F1"})," ","para abrir este diálogo"]}),h.jsx(Ct,{variant:"ghost",size:"sm",onClick:e,className:"text-stone-400 hover:text-white",children:"Cerrar"})]})})]})}):null});BF.displayName="KeyboardShortcuts";function uue(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:s,onRegisterError:o}=t;let a,l;const c=async(d=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(a=await $p(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:d}},[]).then(({Workbox:d})=>new d("/VonSim8/sw.js",{scope:"/VonSim8/",type:"classic"})).catch(d=>{o==null||o(d)}),!a)return;a.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),a.addEventListener("installed",d=>{d.isUpdate||i==null||i()}),a.register({immediate:e}).then(d=>{s?s("/VonSim8/sw.js",d):r==null||r(d)}).catch(d=>{o==null||o(d)})}}return l=u(),c}const $F=()=>{const[t,e]=x.useState({available:!1,updating:!1,lastUpdate:null}),n=x.useRef(null);return x.useEffect(()=>{const i=uue({onNeedRefresh(){e(a=>({...a,available:!0})),typeof window<"u"&&window.VonSimAddNotification&&window.VonSimAddNotification({type:"info",title:"Actualización disponible",message:"Una nueva versión está lista para instalar."})},onOfflineReady(){},onRegistered(a){console.log("Service Worker registrado:",a),a.waiting&&e(l=>({...l,available:!0}))},onRegisterError(a){console.error("Error al registrar Service Worker:",a)}});n.current=i;const r=async()=>{if(n.current){e(a=>({...a,updating:!0}));try{n.current(),e(a=>({...a,available:!1,updating:!1,lastUpdate:new Date}))}catch(a){console.error("Error al actualizar:",a),e(l=>({...l,updating:!1}))}}};window.updateVonSim8=r;const s=()=>{n.current&&n.current()};window.checkVonSim8Updates=s;const o=setInterval(s,5*60*1e3);return()=>{delete window.updateVonSim8,delete window.checkVonSim8Updates,clearInterval(o)}},[]),{updateInfo:t,updateApp:()=>{n.current&&n.current()},checkForUpdates:()=>{n.current&&n.current()}}},tT="vonsim8-commit-hash",due=5*60*1e3,FF=()=>{const[t,e]=x.useState({currentHash:"8af22e1",lastKnownHash:null,hasUpdate:!1,lastCheck:null}),n=x.useCallback(()=>{try{const s=localStorage.getItem(tT),o="8af22e1";return e(a=>({...a,currentHash:o,lastKnownHash:s,lastCheck:new Date})),s&&s!==o?(e(a=>({...a,hasUpdate:!0})),!0):!1}catch(s){return console.warn("Error checking version update:",s),!1}},[]),i=x.useCallback(()=>{try{localStorage.setItem(tT,"8af22e1")}catch(s){console.warn("Error saving version hash before reload:",s)}window.location.reload()},[]),r=x.useCallback(()=>{e(s=>({...s,hasUpdate:!1}))},[]);return x.useEffect(()=>{n()},[n]),x.useEffect(()=>{const s=setInterval(n,due);return()=>clearInterval(s)},[n]),x.useEffect(()=>{const s=()=>{document.hidden||n()};return document.addEventListener("visibilitychange",s),()=>{document.removeEventListener("visibilitychange",s)}},[n]),x.useEffect(()=>{const s=()=>{n()};return window.addEventListener("online",s),()=>{window.removeEventListener("online",s)}},[n]),{versionInfo:t,checkForVersionUpdate:n,updateToNewVersion:i,dismissUpdate:r}},zF=x.memo(()=>{const{updateInfo:t,updateApp:e}=$F(),{versionInfo:n,updateToNewVersion:i}=FF(),[r,s]=x.useState(!0),[o,a]=x.useState(!1),[l,c]=x.useState(!1),u=t.available||n.hasUpdate,d=x.useCallback(async()=>{a(!0);try{t.available?await e():n.hasUpdate&&i(),s(!1)}catch(p){console.error("Error al actualizar:",p)}finally{a(!1)}},[e,t.available,i,n.hasUpdate]),f=x.useCallback(()=>{c(!0),setTimeout(()=>{s(!1)},300)},[]);return!u||!r?null:h.jsxs("div",{className:re("fixed inset-x-0 top-0 z-50 transition-all duration-300 ease-out",l?"-translate-y-full opacity-0":"translate-y-0 opacity-100"),children:[h.jsx("div",{className:"border-b border-stone-700/50 bg-gradient-to-r from-stone-900/95 via-stone-800/95 to-stone-900/95 shadow-2xl backdrop-blur-md",children:h.jsx("div",{className:"mx-auto max-w-7xl p-4",children:h.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between sm:space-y-0",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs("div",{className:"relative shrink-0",children:[h.jsx("div",{className:"absolute inset-0 animate-ping rounded-full bg-mantis-500/20"}),h.jsx("div",{className:"relative rounded-full bg-gradient-to-br from-mantis-500 to-mantis-600 p-2 shadow-lg sm:p-3",children:h.jsx(Ye,{icon:KC,className:"size-4 animate-bounce text-white sm:size-5"})})]}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsxs("div",{className:"mb-1 flex flex-col space-y-1 sm:flex-row sm:items-center sm:space-x-2 sm:space-y-0",children:[h.jsx("h3",{className:"text-base font-bold text-white sm:text-lg",children:"Nueva versión disponible"}),h.jsxs("div",{className:"flex w-fit items-center space-x-1 rounded-full bg-mantis-500/20 px-2 py-1",children:[h.jsx(Ye,{icon:Ej,className:"size-3 text-mantis-400"}),h.jsx("span",{className:"text-xs font-medium text-mantis-300",children:"Actualización"})]})]}),h.jsx("p",{className:"text-xs leading-relaxed text-stone-300 sm:text-sm",children:"Hay una nueva versión de VonSim8 con mejoras y correcciones. Te recomendamos actualizar para obtener la mejor experiencia."})]})]}),h.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[h.jsx(Ct,{onClick:d,disabled:o,variant:"primary",size:"sm",className:re("relative overflow-hidden transition-all duration-300","bg-gradient-to-r from-mantis-600 to-mantis-700","hover:from-mantis-700 hover:to-mantis-800","shadow-lg hover:shadow-xl","border border-mantis-500/30","text-xs sm:text-sm",o&&"animate-pulse"),leftIcon:h.jsx(Ye,{icon:o?XY:nJ,className:re("size-3 transition-transform duration-200 sm:size-4",o&&"animate-spin")}),children:o?"Actualizando...":"Actualizar ahora"}),h.jsx(Ct,{onClick:f,variant:"ghost",size:"sm",className:"shrink-0 text-stone-400 transition-all duration-200 hover:bg-stone-700/50 hover:text-white","aria-label":"Cerrar banner de actualización",children:h.jsx(Ye,{icon:Tb,className:"size-3 sm:size-4"})})]})]})})}),o&&h.jsx("div",{className:"h-1 animate-pulse bg-gradient-to-r from-mantis-500 to-mantis-600",children:h.jsx("div",{className:"animate-shimmer h-full bg-white/30"})})]})});zF.displayName="UpdateBanner";pe(!1);const sp=[{id:"welcome",target:"app-container",title:"¡Bienvenido a VonSim8!",content:"Te acompañaré en un recorrido por las funciones principales de la plataforma. VonSim8 es un simulador de computadora de 8 bits que te permite programar en lenguaje ensamblador y ver cómo funciona internamente una computadora.",icon:HY,position:"top"},{id:"header",target:"header",title:"Barra de Navegación",content:"Aquí encontrarás el logo, el estado de la simulación, los controles principales y acceso a notificaciones, tour de ayuda y configuración.",icon:"icon-[lucide--navigation]",position:"bottom"},{id:"controls",target:"controls",title:"Controles de Simulación",content:"Controla la simulación: F7 (ejecutar ciclo), F8 (ejecutar instrucción), F4 (ejecución infinita), F9 (resetear). También puedes usar los botones visuales.",icon:"icon-[lucide--cpu]",position:"bottom"},{id:"editor-buttons",target:"panel-editor",title:"Editor de Código",content:"Aquí es donde escribirás tu código ensamblador. El editor tiene resaltado de sintaxis, autocompletado y validación en tiempo real. Usa los botones de arriba para crear, abrir, guardar y ensamblar tu programa.",icon:"icon-[lucide--file-terminal]",position:"right"},{id:"computer-view",target:"panel-computer",title:"Simulador de Computadora",content:"Aquí verás la computadora virtual con CPU, memoria RAM, registros, ALU, buses de datos y control, y todos los periféricos como pantalla, teclado, LEDs y switches.",icon:"icon-[lucide--monitor]",position:"left"},{id:"cpu-architecture",target:"cpu-component",title:"Arquitectura CPU",content:"Observa cómo la CPU ejecuta instrucciones paso a paso: fetch, decode, execute. Ve los valores en los registros, el contador de programa y el estado de las banderas.",icon:"icon-[lucide--microchip]",position:"left"},{id:"memory-ram",target:"memory-component",title:"Memoria RAM",content:"Explora la memoria RAM de 256 bytes. Ve cómo se almacenan datos e instrucciones, y cómo la CPU accede a diferentes direcciones de memoria. Cada celda muestra su dirección y valor en hexadecimal.",icon:"icon-[lucide--database]",position:"left"},{id:"settings-button",target:"settings-button",title:"Botón de Configuración",content:"Haz clic en este engranaje para acceder a las configuraciones avanzadas. Aquí podrás ajustar la velocidad de simulación, cambiar el tema visual, seleccionar el idioma y personalizar atajos de teclado.",icon:"icon-[lucide--settings]",position:"bottom"},{id:"settings-panel",target:"panel-settings",title:"Panel de Configuración",content:"En este panel encontrarás todas las opciones de configuración organizadas por categorías: simulación, interfaz, idioma y atajos de teclado. Los cambios se aplican automáticamente.",icon:"icon-[lucide--settings]",position:"left"},{id:"footer",target:"footer-links",title:"Recursos y Soporte",content:"Encuentra documentación completa, código fuente en GitHub, reporta bugs y accede a recursos de aprendizaje para dominar la programación en ensamblador.",icon:"icon-[lucide--help-circle]",position:"top"},{id:"final",target:"cycle-button",title:"¡Listo para Programar!",content:"Ya conoces las funciones principales de VonSim8. Comienza escribiendo código en el editor, ejecuta la simulación paso a paso con el botón 'Por Ciclo' y observa cómo funciona tu programa en la computadora virtual. ¡Disfruta programando!",icon:"icon-[lucide--rocket]",position:"bottom"}],fue=()=>{const[t,e]=x.useState(0),[n,i]=x.useState(!1),[r,s]=x.useState(!0),[,o]=Em(m1),a=x.useMemo(()=>t===sp.length-1,[t]),l=x.useMemo(()=>t===0,[t]),c=x.useCallback(()=>{i(!1),localStorage.setItem("vonsim8-tour-completed","true")},[]),u=x.useCallback(()=>{e(m=>Math.min(m+1,sp.length-1))},[]),d=x.useCallback(()=>{e(m=>Math.max(m-1,0))},[]),f=x.useCallback(()=>{c()},[c]),p=x.useCallback(()=>{i(!0),e(0)},[]);return x.useEffect(()=>{},[]),x.useEffect(()=>{const m=sp[t],g=()=>{const v=document.querySelector(`[data-testid="${m.target}"]`);s(!!v)};g();const y=setTimeout(g,100);return m.id==="settings-button"?o(!0):m.id!=="settings-panel"&&m.id!=="settings-button"&&o(!1),()=>clearTimeout(y)},[t,o]),{currentStep:t,isVisible:n,isLastStep:a,isFirstStep:l,handleNext:u,handlePrev:d,handleSkip:f,completeTour:c,startTour:p,targetFound:r}},hue=t=>x.useMemo(()=>{const e=document.querySelector(`[data-testid="${t.target}"]`);if(!e)return null;const n=e.getBoundingClientRect(),i=window.innerWidth,r=window.innerHeight;if(t.id==="welcome"&&t.position==="top")return{positionStyles:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},highlightStyles:{top:0,left:0,width:"100vw",height:"100vh"}};if(t.id==="footer"){let m=n.top-200-60,g=n.right+20;const y="translateX(0)";m<40&&(m=40),m+200>r-100&&(m=Math.max(40,r/2-200/2)),g+320>i&&(g=i-320-20);const v={top:m,left:g,transform:y},b={top:n.top-2,left:n.left-2,width:n.width+4,height:n.height+4};return{positionStyles:v,highlightStyles:b}}let s,o,a;switch(t.position){case"top":s=n.top-20,o=n.left+n.width/2,a="translateX(-50%)";break;case"bottom":s=n.bottom+20,o=n.left+n.width/2,a="translateX(-50%)";break;case"left":s=n.top+n.height/2,o=n.left-20,a="translateY(-50%)";break;case"right":s=n.top+n.height/2,o=n.right+20,a="translateY(-50%)";break}const l=320,c=200;o+l/2>i?o=i-l/2-20:o-l/2<0&&(o=l/2+20),s+c>r?s=r-c-20:s<0&&(s=20);const u={top:s,left:o,transform:a},d={top:n.top-8,left:n.left-8,width:n.width+16,height:n.height+16};return{positionStyles:u,highlightStyles:d}},[t]),UF=x.memo(({current:t,total:e})=>h.jsx("div",{className:"mb-2 h-2 w-full overflow-hidden rounded-full bg-stone-700",children:h.jsx("div",{className:"h-full bg-mantis-500 transition-all duration-300",style:{width:`${(t+1)/e*100}%`}})}));UF.displayName="ProgressBar";const VF=x.memo(({step:t,currentStep:e,isLastStep:n,isFirstStep:i,onNext:r,onPrev:s,onSkip:o,onFinish:a,totalSteps:l,targetFound:c})=>{const u=hue(t),d=x.useRef(null);x.useEffect(()=>{var g;(g=d.current)==null||g.focus()},[e]);const f="animate-fade-in";if(!c||!u)return h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:h.jsxs("div",{className:"max-w-sm rounded-lg border-2 border-mantis-400 bg-stone-900 p-8 text-center shadow-2xl",children:[h.jsx(Ye,{icon:fJ,className:"mb-4 text-4xl text-yellow-400"}),h.jsx("h3",{className:"mb-2 text-lg font-semibold text-mantis-400",children:"Elemento no encontrado"}),h.jsxs("p",{className:"mb-2 text-stone-300",children:["No se pudo encontrar el elemento:"," ",h.jsx("code",{className:"text-mantis-400",children:t.target})]}),h.jsxs("p",{className:"mb-4 text-xs text-stone-400",children:["Paso ",e+1," de ",l,": ",t.title]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(Ct,{onClick:s,disabled:i,variant:"outline",size:"sm",children:"Anterior"}),h.jsx(Ct,{onClick:o,className:"bg-mantis-600 hover:bg-mantis-700",children:"Saltar tour"})]})]})});const{positionStyles:p,highlightStyles:m}=u;return h.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",children:h.jsxs("div",{className:"relative size-full",children:[h.jsx("div",{className:"absolute rounded-lg border-2 border-mantis-400 bg-transparent shadow-2xl transition-all duration-300",style:m}),h.jsxs("div",{ref:d,tabIndex:-1,role:"dialog","aria-modal":"true",className:`absolute max-w-sm rounded-lg border border-mantis-400 bg-stone-900 p-6 text-white shadow-xl focus:outline-none ${f}`,style:p,children:[h.jsx(UF,{current:e,total:l}),h.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[t.icon&&(typeof t.icon=="string"?h.jsx("span",{className:`${t.icon} text-2xl text-mantis-400`}):h.jsx(Ye,{icon:t.icon,className:"text-2xl text-mantis-400"})),h.jsx("h3",{className:"text-lg font-semibold text-mantis-400",children:t.title})]}),h.jsx("p",{className:"mb-4 text-sm text-stone-300",children:t.content}),h.jsxs("div",{className:"mt-4 flex items-center justify-between gap-2",children:[h.jsx(Ct,{variant:"ghost",size:"sm",onClick:o,className:"text-stone-400 hover:text-white","aria-label":"Saltar tour",children:"Saltar"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs(Ct,{variant:"outline",size:"sm",onClick:s,disabled:i,className:"flex items-center gap-1","aria-label":"Anterior",children:[h.jsx(Ye,{icon:sJ}),"Anterior"]}),n?h.jsxs(Ct,{size:"sm",onClick:a,className:"flex items-center gap-1 bg-mantis-600 hover:bg-mantis-700","aria-label":"Finalizar",children:["Finalizar",h.jsx(Ye,{icon:Ej})]}):h.jsxs(Ct,{size:"sm",onClick:r,className:"flex items-center gap-1 bg-mantis-600 hover:bg-mantis-700","aria-label":"Siguiente",children:["Siguiente",h.jsx(Ye,{icon:oJ})]})]})]}),h.jsxs("div",{className:"mt-2 text-right text-xs text-stone-500",children:["Paso ",e+1," de ",l]}),h.jsx("button",{onClick:o,className:"absolute right-2 top-2 rounded p-1 text-stone-400 hover:text-white focus:outline-none","aria-label":"Cerrar",children:h.jsx(Ye,{icon:Tb,size:"sm"})})]})]})})});VF.displayName="TourTooltip";const HF=x.memo(()=>{const{currentStep:t,isVisible:e,isLastStep:n,isFirstStep:i,handleNext:r,handlePrev:s,handleSkip:o,completeTour:a,startTour:l,targetFound:c}=fue();x.useEffect(()=>(window.startWelcomeTour=l,()=>{delete window.startWelcomeTour}),[l]);const u=x.useMemo(()=>sp[t],[t]);return x.useEffect(()=>{if(!e)return;const d=f=>{f.key==="Escape"&&o(),f.key==="ArrowRight"&&r(),f.key==="ArrowLeft"&&s()};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[e,o,r,s]),!e||!u?null:h.jsx(VF,{step:u,currentStep:t,isLastStep:n,isFirstStep:i,onNext:r,onPrev:s,onSkip:o,onFinish:a,totalSteps:sp.length,targetFound:c})});HF.displayName="WelcomeTour";var Zr=function(t,e){return Number(t.toFixed(e))},pue=function(t,e){return e},on=function(t,e,n){n&&typeof n=="function"&&n(t,e)},mue=function(t){return-Math.cos(t*Math.PI)/2+.5},gue=function(t){return t},vue=function(t){return t*t},yue=function(t){return t*(2-t)},bue=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},xue=function(t){return t*t*t},wue=function(t){return--t*t*t+1},Sue=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},kue=function(t){return t*t*t*t},_ue=function(t){return 1- --t*t*t*t},Cue=function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},Eue=function(t){return t*t*t*t*t},Aue=function(t){return 1+--t*t*t*t*t},Pue=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},WF={easeOut:mue,linear:gue,easeInQuad:vue,easeOutQuad:yue,easeInOutQuad:bue,easeInCubic:xue,easeOutCubic:wue,easeInOutCubic:Sue,easeInQuart:kue,easeOutQuart:_ue,easeInOutQuart:Cue,easeInQuint:Eue,easeOutQuint:Aue,easeInOutQuint:Pue},GF=function(t){typeof t=="number"&&cancelAnimationFrame(t)},Ps=function(t){t.mounted&&(GF(t.animation),t.animate=!1,t.animation=null,t.velocity=null)};function qF(t,e,n,i){if(t.mounted){var r=new Date().getTime(),s=1;Ps(t),t.animation=function(){if(!t.mounted)return GF(t.animation);var o=new Date().getTime()-r,a=o/n,l=WF[e],c=l(a);o>=n?(i(s),t.animation=null):t.animation&&(i(c),requestAnimationFrame(t.animation))},requestAnimationFrame(t.animation)}}function Nue(t){var e=t.scale,n=t.positionX,i=t.positionY;return!(Number.isNaN(e)||Number.isNaN(n)||Number.isNaN(i))}function ic(t,e,n,i){var r=Nue(e);if(!(!t.mounted||!r)){var s=t.setTransformState,o=t.transformState,a=o.scale,l=o.positionX,c=o.positionY,u=e.scale-a,d=e.positionX-l,f=e.positionY-c;n===0?s(e.scale,e.positionX,e.positionY):qF(t,i,n,function(p){var m=a+u*p,g=l+d*p,y=c+f*p;s(m,g,y)})}}function Mue(t,e,n){var i=t.offsetWidth,r=t.offsetHeight,s=e.offsetWidth,o=e.offsetHeight,a=s*n,l=o*n,c=i-a,u=r-l;return{wrapperWidth:i,wrapperHeight:r,newContentWidth:a,newDiffWidth:c,newContentHeight:l,newDiffHeight:u}}var Rue=function(t,e,n,i,r,s,o){var a=t>e?n*(o?1:.5):0,l=i>r?s*(o?1:.5):0,c=t-e-a,u=a,d=i-r-l,f=l;return{minPositionX:c,maxPositionX:u,minPositionY:d,maxPositionY:f}},wA=function(t,e){var n=t.wrapperComponent,i=t.contentComponent,r=t.setup.centerZoomedOut;if(!n||!i)throw new Error("Components are not mounted");var s=Mue(n,i,e),o=s.wrapperWidth,a=s.wrapperHeight,l=s.newContentWidth,c=s.newDiffWidth,u=s.newContentHeight,d=s.newDiffHeight,f=Rue(o,l,c,a,u,d,!!r);return f},n_=function(t,e,n,i){return i?t<e?Zr(e,2):t>n?Zr(n,2):Zr(t,2):Zr(t,2)},zc=function(t,e){var n=wA(t,e);return t.bounds=n,n};function Um(t,e,n,i,r,s,o){var a=n.minPositionX,l=n.minPositionY,c=n.maxPositionX,u=n.maxPositionY,d=0,f=0;o&&(d=r,f=s);var p=n_(t,a-d,c+d,i),m=n_(e,l-f,u+f,i);return{x:p,y:m}}function g1(t,e,n,i,r,s){var o=t.transformState,a=o.scale,l=o.positionX,c=o.positionY,u=i-a;if(typeof e!="number"||typeof n!="number")return console.error("Mouse X and Y position were not provided!"),{x:l,y:c};var d=l-e*u,f=c-n*u,p=Um(d,f,r,s,0,0,null);return p}function Vm(t,e,n,i,r){var s=r?i:0,o=e-s;return!Number.isNaN(n)&&t>=n?n:!Number.isNaN(e)&&t<=o?o:t}var nT=function(t,e){var n=t.setup.panning.excluded,i=t.isInitialized,r=t.wrapperComponent,s=e.target,o="shadowRoot"in s&&"composedPath"in e,a=o?e.composedPath().some(function(u){return u instanceof Element?r==null?void 0:r.contains(u):!1}):r==null?void 0:r.contains(s),l=i&&s&&a;if(!l)return!1;var c=v1(s,n);return!c},iT=function(t){var e=t.isInitialized,n=t.isPanning,i=t.setup,r=i.panning.disabled,s=e&&n&&!r;return!!s},Iue=function(t,e){var n=t.transformState,i=n.positionX,r=n.positionY;t.isPanning=!0;var s=e.clientX,o=e.clientY;t.startCoords={x:s-i,y:o-r}},Tue=function(t,e){var n=e.touches,i=t.transformState,r=i.positionX,s=i.positionY;t.isPanning=!0;var o=n.length===1;if(o){var a=n[0].clientX,l=n[0].clientY;t.startCoords={x:a-r,y:l-s}}};function Oue(t){var e=t.transformState,n=e.positionX,i=e.positionY,r=e.scale,s=t.setup,o=s.disabled,a=s.limitToBounds,l=s.centerZoomedOut,c=t.wrapperComponent;if(!(o||!c||!t.bounds)){var u=t.bounds,d=u.maxPositionX,f=u.minPositionX,p=u.maxPositionY,m=u.minPositionY,g=n>d||n<f,y=i>p||i<m,v=n>d?c.offsetWidth:t.setup.minPositionX||0,b=i>p?c.offsetHeight:t.setup.minPositionY||0,w=g1(t,v,b,r,t.bounds,a||l),k=w.x,C=w.y;return{scale:r,positionX:g?k:n,positionY:y?C:i}}}function KF(t,e,n,i,r){var s=t.setup.limitToBounds,o=t.wrapperComponent,a=t.bounds,l=t.transformState,c=l.scale,u=l.positionX,d=l.positionY;if(!(o===null||a===null||e===u&&n===d)){var f=Um(e,n,a,s,i,r,o),p=f.x,m=f.y;t.setTransformState(c,p,m)}}var Lue=function(t,e,n){var i=t.startCoords,r=t.transformState,s=t.setup.panning,o=s.lockAxisX,a=s.lockAxisY,l=r.positionX,c=r.positionY;if(!i)return{x:l,y:c};var u=e-i.x,d=n-i.y,f=o?l:u,p=a?c:d;return{x:f,y:p}},Gl=function(t,e){var n=t.setup,i=t.transformState,r=i.scale,s=n.minScale,o=n.disablePadding;return e>0&&r>=s&&!o?e:0},Due=function(t){var e=t.mounted,n=t.setup,i=n.disabled,r=n.velocityAnimation,s=t.transformState.scale,o=r.disabled,a=!o||s>1||!i||e;return!!a},jue=function(t){var e=t.mounted,n=t.velocity,i=t.bounds,r=t.setup,s=r.disabled,o=r.velocityAnimation,a=t.transformState.scale,l=o.disabled,c=!l||a>1||!s||e;return!(!c||!n||!i)};function Bue(t,e){var n=t.setup.velocityAnimation,i=n.equalToMove,r=n.animationTime,s=n.sensitivity;return i?r*e*s:r}function rT(t,e,n,i,r,s,o,a,l,c){if(r){if(e>o&&n>o){var u=o+(t-o)*c;return u>l?l:u<o?o:u}if(e<s&&n<s){var u=s+(t-s)*c;return u<a?a:u>s?s:u}}return i?e:n_(t,s,o,r)}function $ue(t,e){var n=1;return e?Math.min(n,t.offsetWidth/window.innerWidth):n}function Fue(t,e){var n=Due(t);if(n){var i=t.lastMousePosition,r=t.velocityTime,s=t.setup,o=t.wrapperComponent,a=s.velocityAnimation.equalToMove,l=Date.now();if(i&&r&&o){var c=$ue(o,a),u=e.x-i.x,d=e.y-i.y,f=u/c,p=d/c,m=l-r,g=u*u+d*d,y=Math.sqrt(g)/m;t.velocity={velocityX:f,velocityY:p,total:y}}t.lastMousePosition=e,t.velocityTime=l}}function zue(t){var e=t.velocity,n=t.bounds,i=t.setup,r=t.wrapperComponent,s=jue(t);if(!(!s||!e||!n||!r)){var o=e.velocityX,a=e.velocityY,l=e.total,c=n.maxPositionX,u=n.minPositionX,d=n.maxPositionY,f=n.minPositionY,p=i.limitToBounds,m=i.alignmentAnimation,g=i.zoomAnimation,y=i.panning,v=y.lockAxisY,b=y.lockAxisX,w=g.animationType,k=m.sizeX,C=m.sizeY,E=m.velocityAlignmentTime,_=E,A=Bue(t,l),R=Math.max(A,_),L=Gl(t,k),O=Gl(t,C),I=L*r.offsetWidth/100,G=O*r.offsetHeight/100,B=c+I,K=u-I,J=d+G,ne=f-G,V=t.transformState,U=new Date().getTime();qF(t,w,R,function(se){var _e=t.transformState,Q=_e.scale,ae=_e.positionX,z=_e.positionY,$=new Date().getTime()-U,W=$/_,S=WF[m.animationType],T=1-S(Math.min(1,W)),j=1-se,D=ae+o*j,Y=z+a*j,q=rT(D,V.positionX,ae,b,p,u,c,K,B,T),oe=rT(Y,V.positionY,z,v,p,f,d,ne,J,T);(ae!==D||z!==Y)&&t.setTransformState(Q,q,oe)})}}function sT(t,e){var n=t.transformState.scale;Ps(t),zc(t,n),window.TouchEvent!==void 0&&e instanceof TouchEvent?Tue(t,e):Iue(t,e)}function SA(t,e){var n=t.transformState.scale,i=t.setup,r=i.minScale,s=i.alignmentAnimation,o=s.disabled,a=s.sizeX,l=s.sizeY,c=s.animationTime,u=s.animationType,d=o||n<r||!a&&!l;if(!d){var f=Oue(t);f&&ic(t,f,e??c,u)}}function oT(t,e,n){var i=t.startCoords,r=t.setup,s=r.alignmentAnimation,o=s.sizeX,a=s.sizeY;if(i){var l=Lue(t,e,n),c=l.x,u=l.y,d=Gl(t,o),f=Gl(t,a);Fue(t,{x:c,y:u}),KF(t,c,u,d,f)}}function Uue(t){if(t.isPanning){var e=t.setup.panning.velocityDisabled,n=t.velocity,i=t.wrapperComponent,r=t.contentComponent;t.isPanning=!1,t.animate=!1,t.animation=null;var s=i==null?void 0:i.getBoundingClientRect(),o=r==null?void 0:r.getBoundingClientRect(),a=(s==null?void 0:s.width)||0,l=(s==null?void 0:s.height)||0,c=(o==null?void 0:o.width)||0,u=(o==null?void 0:o.height)||0,d=a<c||l<u,f=!e&&n&&(n==null?void 0:n.total)>.1&&d;f?zue(t):SA(t)}}function kA(t,e,n,i){var r=t.setup,s=r.minScale,o=r.maxScale,a=r.limitToBounds,l=Vm(Zr(e,2),s,o,0,!1),c=zc(t,l),u=g1(t,n,i,l,c,a),d=u.x,f=u.y;return{scale:l,positionX:d,positionY:f}}function XF(t,e,n){var i=t.transformState.scale,r=t.wrapperComponent,s=t.setup,o=s.minScale,a=s.limitToBounds,l=s.zoomAnimation,c=l.disabled,u=l.animationTime,d=l.animationType,f=c||i>=o;if((i>=1||a)&&SA(t),!(f||!r||!t.mounted)){var p=e||r.offsetWidth/2,m=n||r.offsetHeight/2,g=kA(t,o,p,m);g&&ic(t,g,u,d)}}var Al=function(){return Al=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Al.apply(this,arguments)};function aT(t,e,n){for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}var c0={scale:1,positionX:0,positionY:0},ih={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},i_={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},YF=function(t){var e,n,i,r;return{previousScale:(e=t.initialScale)!==null&&e!==void 0?e:c0.scale,scale:(n=t.initialScale)!==null&&n!==void 0?n:c0.scale,positionX:(i=t.initialPositionX)!==null&&i!==void 0?i:c0.positionX,positionY:(r=t.initialPositionY)!==null&&r!==void 0?r:c0.positionY}},lT=function(t){var e=Al({},ih);return Object.keys(t).forEach(function(n){var i=typeof t[n]<"u",r=typeof ih[n]<"u";if(r&&i){var s=Object.prototype.toString.call(ih[n]),o=s==="[object Object]",a=s==="[object Array]";o?e[n]=Al(Al({},ih[n]),t[n]):a?e[n]=aT(aT([],ih[n],!0),t[n]):e[n]=t[n]}}),e},JF=function(t,e,n){var i=t.transformState.scale,r=t.wrapperComponent,s=t.setup,o=s.maxScale,a=s.minScale,l=s.zoomAnimation,c=s.smooth,u=l.size;if(!r)throw new Error("Wrapper is not mounted");var d=c?i*Math.exp(e*n):i+e*n,f=Vm(Zr(d,3),a,o,u,!1);return f};function ZF(t,e,n,i,r){var s=t.wrapperComponent,o=t.transformState,a=o.scale,l=o.positionX,c=o.positionY;if(!s)return console.error("No WrapperComponent found");var u=s.offsetWidth,d=s.offsetHeight,f=(u/2-l)/a,p=(d/2-c)/a,m=JF(t,e,n),g=kA(t,m,f,p);if(!g)return console.error("Error during zoom event. New transformation state was not calculated.");ic(t,g,i,r)}function QF(t,e,n,i){var r=t.setup,s=t.wrapperComponent,o=r.limitToBounds,a=YF(t.props),l=t.transformState,c=l.scale,u=l.positionX,d=l.positionY;if(s){var f=wA(t,a.scale),p=Um(a.positionX,a.positionY,f,o,0,0,s),m={scale:a.scale,positionX:p.x,positionY:p.y};c===a.scale&&u===a.positionX&&d===a.positionY||(i==null||i(),ic(t,m,e,n))}}function Vue(t,e,n,i){var r=t.getBoundingClientRect(),s=e.getBoundingClientRect(),o=n.getBoundingClientRect(),a=s.x*i.scale,l=s.y*i.scale;return{x:(r.x-o.x+a)/i.scale,y:(r.y-o.y+l)/i.scale}}function Hue(t,e,n){var i=t.wrapperComponent,r=t.contentComponent,s=t.transformState,o=t.setup,a=o.limitToBounds,l=o.minScale,c=o.maxScale;if(!i||!r)return s;var u=i.getBoundingClientRect(),d=e.getBoundingClientRect(),f=Vue(e,i,r,s),p=f.x,m=f.y,g=d.width/s.scale,y=d.height/s.scale,v=i.offsetWidth/g,b=i.offsetHeight/y,w=Vm(n||Math.min(v,b),l,c,0,!1),k=(u.width-g*w)/2,C=(u.height-y*w)/2,E=(u.left-p)*w+k,_=(u.top-m)*w+C,A=wA(t,w),R=Um(E,_,A,a,0,0,i),L=R.x,O=R.y;return{positionX:L,positionY:O,scale:w}}var Wue=function(t){return function(e,n,i){e===void 0&&(e=.5),n===void 0&&(n=300),i===void 0&&(i="easeOut"),ZF(t,1,e,n,i)}},Gue=function(t){return function(e,n,i){e===void 0&&(e=.5),n===void 0&&(n=300),i===void 0&&(i="easeOut"),ZF(t,-1,e,n,i)}},que=function(t){return function(e,n,i,r,s){r===void 0&&(r=300),s===void 0&&(s="easeOut");var o=t.transformState,a=o.positionX,l=o.positionY,c=o.scale,u=t.wrapperComponent,d=t.contentComponent,f=t.setup.disabled;if(!(f||!u||!d)){var p={positionX:Number.isNaN(e)?a:e,positionY:Number.isNaN(n)?l:n,scale:Number.isNaN(i)?c:i};ic(t,p,r,s)}}},Kue=function(t){return function(e,n){e===void 0&&(e=200),n===void 0&&(n="easeOut"),QF(t,e,n)}},Xue=function(t){return function(e,n,i){n===void 0&&(n=200),i===void 0&&(i="easeOut");var r=t.transformState,s=t.wrapperComponent,o=t.contentComponent;if(s&&o){var a=ez(e||r.scale,s,o);ic(t,a,n,i)}}},Yue=function(t){return function(e,n,i,r){i===void 0&&(i=600),r===void 0&&(r="easeOut"),Ps(t);var s=t.wrapperComponent,o=typeof e=="string"?document.getElementById(e):e;if(s&&o&&s.contains(o)){var a=Hue(t,o,n);ic(t,a,i,r)}}},r_=function(t){return{instance:t,zoomIn:Wue(t),zoomOut:Gue(t),setTransform:que(t),resetTransform:Kue(t),centerView:Xue(t),zoomToElement:Yue(t)}},Jue=function(t){return{instance:t,state:t.transformState}},Kt=function(t){var e={};return Object.assign(e,Jue(t)),Object.assign(e,r_(t)),e},xw=!1;function ww(){try{var t={get passive(){return xw=!0,!1}};return t}catch{return xw=!1,xw}}var u0=".".concat(i_.wrapperClass),v1=function(t,e){return e.some(function(n){return t.matches("".concat(u0," ").concat(n,", ").concat(u0," .").concat(n,", ").concat(u0," ").concat(n," *, ").concat(u0," .").concat(n," *"))})},s_=function(t){t&&clearTimeout(t)},Zue=function(t,e,n){return"translate(".concat(t,"px, ").concat(e,"px) scale(").concat(n,")")},ez=function(t,e,n){var i=n.offsetWidth*t,r=n.offsetHeight*t,s=(e.offsetWidth-i)/2,o=(e.offsetHeight-r)/2;return{scale:t,positionX:s,positionY:o}};function Que(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var ede=function(t,e){var n=t.setup.wheel,i=n.disabled,r=n.wheelDisabled,s=n.touchPadDisabled,o=n.excluded,a=t.isInitialized,l=t.isPanning,c=e.target,u=a&&!l&&!i&&c;if(!u||r&&!e.ctrlKey||s&&e.ctrlKey)return!1;var d=v1(c,o);return!d},tde=function(t){return t?t.deltaY<0?1:-1:0};function nde(t,e){var n=tde(t),i=pue(e,n);return i}function tz(t,e,n){var i=e.getBoundingClientRect(),r=0,s=0;if("clientX"in t)r=(t.clientX-i.left)/n,s=(t.clientY-i.top)/n;else{var o=t.touches[0];r=(o.clientX-i.left)/n,s=(o.clientY-i.top)/n}return(Number.isNaN(r)||Number.isNaN(s))&&console.error("No mouse or touch offset found"),{x:r,y:s}}var ide=function(t,e,n,i,r){var s=t.transformState.scale,o=t.wrapperComponent,a=t.setup,l=a.maxScale,c=a.minScale,u=a.zoomAnimation,d=a.disablePadding,f=u.size,p=u.disabled;if(!o)throw new Error("Wrapper is not mounted");var m=s+e*n,g=i?!1:!p,y=Vm(Zr(m,3),c,l,f,g&&!d);return y},rde=function(t,e){var n=t.previousWheelEvent,i=t.transformState.scale,r=t.setup,s=r.maxScale,o=r.minScale;return n?i<s||i>o||Math.sign(n.deltaY)!==Math.sign(e.deltaY)||n.deltaY>0&&n.deltaY<e.deltaY||n.deltaY<0&&n.deltaY>e.deltaY||Math.sign(n.deltaY)!==Math.sign(e.deltaY):!1},sde=function(t,e){var n=t.setup.pinch,i=n.disabled,r=n.excluded,s=t.isInitialized,o=e.target,a=s&&!i&&o;if(!a)return!1;var l=v1(o,r);return!l},ode=function(t){var e=t.setup.pinch.disabled,n=t.isInitialized,i=t.pinchStartDistance,r=n&&!e&&i;return!!r},ade=function(t,e,n){var i=n.getBoundingClientRect(),r=t.touches,s=Zr(r[0].clientX-i.left,5),o=Zr(r[0].clientY-i.top,5),a=Zr(r[1].clientX-i.left,5),l=Zr(r[1].clientY-i.top,5);return{x:(s+a)/2/e,y:(o+l)/2/e}},nz=function(t){return Math.sqrt(Math.pow(t.touches[0].pageX-t.touches[1].pageX,2)+Math.pow(t.touches[0].pageY-t.touches[1].pageY,2))},lde=function(t,e){var n=t.pinchStartScale,i=t.pinchStartDistance,r=t.setup,s=r.maxScale,o=r.minScale,a=r.zoomAnimation,l=r.disablePadding,c=a.size,u=a.disabled;if(!n||i===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return t.transformState.scale;var d=e/i,f=d*n;return Vm(Zr(f,2),o,s,c,!u&&!l)},cde=160,ude=100,dde=function(t,e){var n=t.props,i=n.onWheelStart,r=n.onZoomStart;t.wheelStopEventTimer||(Ps(t),on(Kt(t),e,i),on(Kt(t),e,r))},fde=function(t,e){var n=t.props,i=n.onWheel,r=n.onZoom,s=t.contentComponent,o=t.setup,a=t.transformState,l=a.scale,c=o.limitToBounds,u=o.centerZoomedOut,d=o.zoomAnimation,f=o.wheel,p=o.disablePadding,m=o.smooth,g=d.size,y=d.disabled,v=f.step,b=f.smoothStep;if(!s)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var w=nde(e,null),k=m?b*Math.abs(e.deltaY):v,C=ide(t,w,k,!e.ctrlKey);if(l!==C){var E=zc(t,C),_=tz(e,s,l),A=y||g===0||u||p,R=c&&A,L=g1(t,_.x,_.y,C,E,R),O=L.x,I=L.y;t.previousWheelEvent=e,t.setTransformState(C,O,I),on(Kt(t),e,i),on(Kt(t),e,r)}},hde=function(t,e){var n=t.props,i=n.onWheelStop,r=n.onZoomStop;s_(t.wheelAnimationTimer),t.wheelAnimationTimer=setTimeout(function(){t.mounted&&(XF(t,e.x,e.y),t.wheelAnimationTimer=null)},ude);var s=rde(t,e);s&&(s_(t.wheelStopEventTimer),t.wheelStopEventTimer=setTimeout(function(){t.mounted&&(t.wheelStopEventTimer=null,on(Kt(t),e,i),on(Kt(t),e,r))},cde))},iz=function(t){for(var e=0,n=0,i=0;i<2;i+=1)e+=t.touches[i].clientX,n+=t.touches[i].clientY;var r=e/2,s=n/2;return{x:r,y:s}},pde=function(t,e){var n=nz(e);t.pinchStartDistance=n,t.lastDistance=n,t.pinchStartScale=t.transformState.scale,t.isPanning=!1;var i=iz(e);t.pinchLastCenterX=i.x,t.pinchLastCenterY=i.y,Ps(t)},mde=function(t,e){var n=t.contentComponent,i=t.pinchStartDistance,r=t.wrapperComponent,s=t.transformState.scale,o=t.setup,a=o.limitToBounds,l=o.centerZoomedOut,c=o.zoomAnimation,u=o.alignmentAnimation,d=c.disabled,f=c.size;if(!(i===null||!n)){var p=ade(e,s,n);if(!(!Number.isFinite(p.x)||!Number.isFinite(p.y))){var m=nz(e),g=lde(t,m),y=iz(e),v=y.x-(t.pinchLastCenterX||0),b=y.y-(t.pinchLastCenterY||0);if(!(g===s&&v===0&&b===0)){t.pinchLastCenterX=y.x,t.pinchLastCenterY=y.y;var w=zc(t,g),k=d||f===0||l,C=a&&k,E=g1(t,p.x,p.y,g,w,C),_=E.x,A=E.y;t.pinchMidpoint=p,t.lastDistance=m;var R=u.sizeX,L=u.sizeY,O=Gl(t,R),I=Gl(t,L),G=_+v,B=A+b,K=Um(G,B,w,a,O,I,r),J=K.x,ne=K.y;t.setTransformState(g,J,ne)}}}},gde=function(t){var e=t.pinchMidpoint;t.velocity=null,t.lastDistance=null,t.pinchMidpoint=null,t.pinchStartScale=null,t.pinchStartDistance=null,XF(t,e==null?void 0:e.x,e==null?void 0:e.y)},rz=function(t,e){var n=t.props.onZoomStop,i=t.setup.doubleClick.animationTime;s_(t.doubleClickStopEventTimer),t.doubleClickStopEventTimer=setTimeout(function(){t.doubleClickStopEventTimer=null,on(Kt(t),e,n)},i)},vde=function(t,e){var n=t.props,i=n.onZoomStart,r=n.onZoom,s=t.setup.doubleClick,o=s.animationTime,a=s.animationType;on(Kt(t),e,i),QF(t,o,a,function(){return on(Kt(t),e,r)}),rz(t,e)};function yde(t,e){return t==="toggle"?e===1?1:-1:t==="zoomOut"?-1:1}function bde(t,e){var n=t.setup,i=t.doubleClickStopEventTimer,r=t.transformState,s=t.contentComponent,o=r.scale,a=t.props,l=a.onZoomStart,c=a.onZoom,u=n.doubleClick,d=u.disabled,f=u.mode,p=u.step,m=u.animationTime,g=u.animationType;if(!d&&!i){if(f==="reset")return vde(t,e);if(!s)return console.error("No ContentComponent found");var y=yde(f,t.transformState.scale),v=JF(t,y,p);if(o!==v){on(Kt(t),e,l);var b=tz(e,s,o),w=kA(t,v,b.x,b.y);if(!w)return console.error("Error during zoom event. New transformation state was not calculated.");on(Kt(t),e,c),ic(t,w,m,g),rz(t,e)}}}var xde=function(t,e){var n=t.isInitialized,i=t.setup,r=t.wrapperComponent,s=i.doubleClick,o=s.disabled,a=s.excluded,l=e.target,c=r==null?void 0:r.contains(l),u=n&&l&&c&&!o;if(!u)return!1;var d=v1(l,a);return!d},wde=function(){function t(e){var n=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){n.initializeWindowEvents()},this.unmount=function(){n.cleanupWindowEvents()},this.update=function(i){n.props=i,zc(n,n.transformState.scale),n.setup=lT(i)},this.initializeWindowEvents=function(){var i,r,s=ww(),o=(i=n.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,a=o==null?void 0:o.defaultView;(r=n.wrapperComponent)===null||r===void 0||r.addEventListener("wheel",n.onWheelPanning,s),a==null||a.addEventListener("mousedown",n.onPanningStart,s),a==null||a.addEventListener("mousemove",n.onPanning,s),a==null||a.addEventListener("mouseup",n.onPanningStop,s),o==null||o.addEventListener("mouseleave",n.clearPanning,s),a==null||a.addEventListener("keyup",n.setKeyUnPressed,s),a==null||a.addEventListener("keydown",n.setKeyPressed,s)},this.cleanupWindowEvents=function(){var i,r,s=ww(),o=(i=n.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,a=o==null?void 0:o.defaultView;a==null||a.removeEventListener("mousedown",n.onPanningStart,s),a==null||a.removeEventListener("mousemove",n.onPanning,s),a==null||a.removeEventListener("mouseup",n.onPanningStop,s),o==null||o.removeEventListener("mouseleave",n.clearPanning,s),a==null||a.removeEventListener("keyup",n.setKeyUnPressed,s),a==null||a.removeEventListener("keydown",n.setKeyPressed,s),document.removeEventListener("mouseleave",n.clearPanning,s),Ps(n),(r=n.observer)===null||r===void 0||r.disconnect()},this.handleInitializeWrapperEvents=function(i){var r=ww();i.addEventListener("wheel",n.onWheelZoom,r),i.addEventListener("dblclick",n.onDoubleClick,r),i.addEventListener("touchstart",n.onTouchPanningStart,r),i.addEventListener("touchmove",n.onTouchPanning,r),i.addEventListener("touchend",n.onTouchPanningStop,r)},this.handleInitialize=function(i,r){var s=!1,o=n.setup.centerOnInit,a=function(l,c){for(var u=0,d=l;u<d.length;u++){var f=d[u];if(f.target===c)return!0}return!1};n.applyTransformation(),n.onInitCallbacks.forEach(function(l){l(Kt(n))}),n.observer=new ResizeObserver(function(l){if(a(l,i)||a(l,r))if(o&&!s){var c=r.offsetWidth,u=r.offsetHeight;(c>0||u>0)&&(s=!0,n.setCenter())}else Ps(n),zc(n,n.transformState.scale),SA(n,0)}),n.observer.observe(i),n.observer.observe(r)},this.onWheelZoom=function(i){var r=n.setup.disabled;if(!r){var s=ede(n,i);if(s){var o=n.isPressingKeys(n.setup.wheel.activationKeys);o&&(dde(n,i),fde(n,i),hde(n,i))}}},this.onWheelPanning=function(i){var r=n.setup,s=r.disabled,o=r.wheel,a=r.panning;if(!(!n.wrapperComponent||!n.contentComponent||s||!o.wheelDisabled||a.disabled||!a.wheelPanning||i.ctrlKey)){i.preventDefault(),i.stopPropagation();var l=n.transformState,c=l.positionX,u=l.positionY,d=c-i.deltaX,f=u-i.deltaY,p=a.lockAxisX?c:d,m=a.lockAxisY?u:f,g=n.setup.alignmentAnimation,y=g.sizeX,v=g.sizeY,b=Gl(n,y),w=Gl(n,v);p===c&&m===u||KF(n,p,m,b,w)}},this.onPanningStart=function(i){var r=n.setup.disabled,s=n.props.onPanningStart;if(!r){var o=nT(n,i);if(o){var a=n.isPressingKeys(n.setup.panning.activationKeys);a&&(i.button===0&&!n.setup.panning.allowLeftClickPan||i.button===1&&!n.setup.panning.allowMiddleClickPan||i.button===2&&!n.setup.panning.allowRightClickPan||(i.preventDefault(),i.stopPropagation(),Ps(n),sT(n,i),on(Kt(n),i,s)))}}},this.onPanning=function(i){var r=n.setup.disabled,s=n.props.onPanning;if(!r){var o=iT(n);if(o){var a=n.isPressingKeys(n.setup.panning.activationKeys);a&&(i.preventDefault(),i.stopPropagation(),oT(n,i.clientX,i.clientY),on(Kt(n),i,s))}}},this.onPanningStop=function(i){var r=n.props.onPanningStop;n.isPanning&&(Uue(n),on(Kt(n),i,r))},this.onPinchStart=function(i){var r=n.setup.disabled,s=n.props,o=s.onPinchingStart,a=s.onZoomStart;if(!r){var l=sde(n,i);l&&(pde(n,i),Ps(n),on(Kt(n),i,o),on(Kt(n),i,a))}},this.onPinch=function(i){var r=n.setup.disabled,s=n.props,o=s.onPinching,a=s.onZoom;if(!r){var l=ode(n);l&&(i.preventDefault(),i.stopPropagation(),mde(n,i),on(Kt(n),i,o),on(Kt(n),i,a))}},this.onPinchStop=function(i){var r=n.props,s=r.onPinchingStop,o=r.onZoomStop;n.pinchStartScale&&(gde(n),on(Kt(n),i,s),on(Kt(n),i,o))},this.onTouchPanningStart=function(i){var r=n.setup.disabled,s=n.props.onPanningStart;if(!r){var o=nT(n,i);if(o){var a=n.lastTouch&&+new Date-n.lastTouch<200&&i.touches.length===1;if(!a){n.lastTouch=+new Date,Ps(n);var l=i.touches,c=l.length===1,u=l.length===2;c&&(Ps(n),sT(n,i),on(Kt(n),i,s)),u&&n.onPinchStart(i)}}}},this.onTouchPanning=function(i){var r=n.setup.disabled,s=n.props.onPanning;if(n.isPanning&&i.touches.length===1){if(r)return;var o=iT(n);if(!o)return;i.preventDefault(),i.stopPropagation();var a=i.touches[0];oT(n,a.clientX,a.clientY),on(Kt(n),i,s)}else i.touches.length>1&&n.onPinch(i)},this.onTouchPanningStop=function(i){n.onPanningStop(i),n.onPinchStop(i)},this.onDoubleClick=function(i){var r=n.setup.disabled;if(!r){var s=xde(n,i);s&&bde(n,i)}},this.clearPanning=function(i){n.isPanning&&n.onPanningStop(i)},this.setKeyPressed=function(i){n.pressedKeys[i.key]=!0},this.setKeyUnPressed=function(i){n.pressedKeys[i.key]=!1},this.isPressingKeys=function(i){return i.length?!!i.find(function(r){return n.pressedKeys[r]}):!0},this.setTransformState=function(i,r,s){var o=n.props.onTransformed;if(!Number.isNaN(i)&&!Number.isNaN(r)&&!Number.isNaN(s)){i!==n.transformState.scale&&(n.transformState.previousScale=n.transformState.scale,n.transformState.scale=i),n.transformState.positionX=r,n.transformState.positionY=s,n.applyTransformation();var a=Kt(n);n.onChangeCallbacks.forEach(function(l){return l(a)}),on(a,{scale:i,positionX:r,positionY:s},o)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(n.wrapperComponent&&n.contentComponent){var i=ez(n.transformState.scale,n.wrapperComponent,n.contentComponent);n.setTransformState(i.scale,i.positionX,i.positionY)}},this.handleTransformStyles=function(i,r,s){return n.props.customTransform?n.props.customTransform(i,r,s):Zue(i,r,s)},this.applyTransformation=function(){if(!(!n.mounted||!n.contentComponent)){var i=n.transformState,r=i.scale,s=i.positionX,o=i.positionY,a=n.handleTransformStyles(s,o,r);n.contentComponent.style.transform=a}},this.getContext=function(){return Kt(n)},this.onChange=function(i){return n.onChangeCallbacks.has(i)||n.onChangeCallbacks.add(i),function(){n.onChangeCallbacks.delete(i)}},this.onInit=function(i){return n.onInitCallbacks.has(i)||n.onInitCallbacks.add(i),function(){n.onInitCallbacks.delete(i)}},this.init=function(i,r){n.cleanupWindowEvents(),n.wrapperComponent=i,n.contentComponent=r,zc(n,n.transformState.scale),n.handleInitializeWrapperEvents(i),n.handleInitialize(i,r),n.initializeWindowEvents(),n.isInitialized=!0;var s=Kt(n);on(s,void 0,n.props.onInit)},this.props=e,this.setup=lT(this.props),this.transformState=YF(this.props)}return t}(),_A=Qt.createContext(null),Sde=function(t,e){return typeof t=="function"?t(e):t},kde=Qt.forwardRef(function(t,e){var n=x.useRef(new wde(t)).current,i=Sde(t.children,r_(n));return x.useImperativeHandle(e,function(){return r_(n)},[n]),x.useEffect(function(){n.update(t)},[n,t]),Qt.createElement(_A.Provider,{value:n},i)});Qt.forwardRef(function(t,e){var n=x.useRef(null),i=x.useContext(_A);return x.useEffect(function(){return i.onChange(function(r){if(n.current){var s=0,o=0;n.current.style.transform=i.handleTransformStyles(s,o,1/r.instance.transformState.scale)}})},[i]),Qt.createElement("div",Al({},t,{ref:Que([n,e])}))});function _de(t,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n==="top"&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}var Cde=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,cT={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};_de(Cde);var Ede=function(t){var e=t.children,n=t.wrapperClass,i=n===void 0?"":n,r=t.contentClass,s=r===void 0?"":r,o=t.wrapperStyle,a=t.contentStyle,l=t.wrapperProps,c=l===void 0?{}:l,u=t.contentProps,d=u===void 0?{}:u,f=x.useContext(_A),p=f.init,m=f.cleanupWindowEvents,g=x.useRef(null),y=x.useRef(null);return x.useEffect(function(){var v=g.current,b=y.current;return v!==null&&b!==null&&p&&(p==null||p(v,b)),function(){m==null||m()}},[]),Qt.createElement("div",Al({},c,{ref:g,className:"".concat(i_.wrapperClass," ").concat(cT.wrapper," ").concat(i),style:o}),Qt.createElement("div",Al({},d,{ref:y,className:"".concat(i_.contentClass," ").concat(cT.content," ").concat(s),style:a}),e))};function Ade({wrapperRef:t}){const e=cn();return h.jsxs("div",{className:"absolute right-2 top-2 flex flex-col rounded-lg border border-stone-600 bg-stone-900 shadow",children:[h.jsx("button",{className:"m-0.5 flex size-8 items-center justify-center rounded-t-lg text-white transition-colors hover:enabled:bg-stone-800",onClick:()=>{var n;return(n=t.current)==null?void 0:n.zoomIn()},title:e("control.zoom.in"),children:h.jsx("span",{className:"size-4",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),h.jsx("hr",{className:"border-stone-600"}),h.jsx("button",{className:"m-0.5 flex size-8 items-center justify-center rounded-b-lg text-white transition-colors hover:enabled:bg-stone-800",onClick:()=>{var n;return(n=t.current)==null?void 0:n.zoomOut()},title:e("control.zoom.out"),children:h.jsx("span",{className:"size-4",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})})})})]})}function uT(t){switch(t){case"Captación":return"text-blue-300 bg-gradient-to-r from-blue-500/10 to-cyan-500/10";case"Obtención de operandos":return"text-yellow-300 bg-gradient-to-r from-yellow-500/10 to-orange-500/10";case"Ejecución":return"text-green-300 bg-gradient-to-r from-green-500/10 to-emerald-500/10";case"Escritura":return"text-purple-300 bg-gradient-to-r from-purple-500/10 to-violet-500/10";default:return"text-stone-300 bg-gradient-to-r from-stone-500/10 to-gray-500/10"}}function Pde(t,e){if(t==="Ejecución")return/obten/i.test(e)||/operando/i.test(e)||/leer/i.test(e)||/cargar/i.test(e)?"text-yellow-300 bg-yellow-500/5 border-yellow-400/30 shadow-yellow-400/20":/escrib/i.test(e)||/guardar/i.test(e)||/almacenar/i.test(e)||/resultado/i.test(e)?"text-purple-300 bg-purple-500/5 border-purple-400/30 shadow-purple-400/20":(/procesar/i.test(e)||/alu/i.test(e)||/calcular/i.test(e)||/operar/i.test(e)||/ejecut/i.test(e),"text-green-300 bg-green-500/5 border-green-400/30 shadow-green-400/20");switch(t){case"Captación":return"text-blue-300 bg-blue-500/5 border-blue-400/30 shadow-blue-400/20";case"Obtención de operandos":return"text-yellow-300 bg-yellow-500/5 border-yellow-400/30 shadow-yellow-400/20";case"Escritura":return"text-purple-300 bg-purple-500/5 border-purple-400/30 shadow-purple-400/20";default:return"text-stone-300 bg-stone-500/5 border-stone-400/30 shadow-stone-400/20"}}function Nde(t,e=!1){const n=(()=>{switch(t){case"Captación":return"📥";case"Obtención de operandos":return"🔍";case"Ejecución":return"⚡";case"Escritura":return"💾";case"Interrupción":return"🚨";default:return"⚙️"}})();return e?h.jsx("span",{className:"inline-block animate-bounce",children:n}):n}function Mde(t,e){if(!t)return"";switch(e){case"Captación":return"ring-2 ring-blue-400/50 ring-offset-2 ring-offset-stone-800";case"Obtención de operandos":return"ring-2 ring-yellow-400/50 ring-offset-2 ring-offset-stone-800";case"Ejecución":return"ring-2 ring-green-400/50 ring-offset-2 ring-offset-stone-800";case"Escritura":return"ring-2 ring-purple-400/50 ring-offset-2 ring-offset-stone-800";default:return"ring-2 ring-stone-400/50 ring-offset-2 ring-offset-stone-800"}}function Rde(t,e){return t==="Captación"?"text-blue-400":t==="Ejecución"?/obten/i.test(e)||/operando/i.test(e)||/leer/i.test(e)||/cargar/i.test(e)?"text-yellow-400":/escrib/i.test(e)||/guardar/i.test(e)||/almacenar/i.test(e)||/resultado/i.test(e)?"text-purple-400":(/procesar/i.test(e)||/alu/i.test(e)||/calcular/i.test(e)||/operar/i.test(e)||/ejecut/i.test(e),"text-green-400"):t==="Escritura"?"text-purple-400":t==="Obtención de operandos"?"text-yellow-400":"text-stone-400"}function Ide(){const t=tt(Je),e=tt(ws),n=tt(Tt),i=tt(Zp),{devices:r}=Kn(),[s]=Oo(),o=x.useRef(null),a=(l,c)=>{const[u,...d]=l.split(":"),f=d.join(":").trim();return{cycle:c,stage:u.trim(),action:f}};return x.useEffect(()=>{if(t){const l=P.get(Dt),c=a(t,l);P.set(ws,u=>{const d=u[u.length-1];return d&&d.cycle===l&&d.action===c.action?u:[...u,c]})}},[t]),x.useEffect(()=>{const l=P.sub(Dt,()=>{const c=P.get(Dt),u=P.get(Je);if(u&&c>0){const d=a(u,c);P.set(na,{canAnimate:!1,pendingMessage:u}),P.set(ws,f=>{const p=f[f.length-1];return p&&p.cycle===c&&p.action===d.action?f:[...f,d]}),setTimeout(()=>{P.set(na,{canAnimate:!0,pendingMessage:null})},100)}if(c===0){const d=P.get(go);console.log("🔄 Cycle count reset to 0, isHaltExecution:",d,"current history length:",P.get(ws).length),d?console.log("⚠️ NOT clearing message history (HLT execution detected)"):(console.log("✅ Clearing message history (not HLT execution)"),P.set(ws,[]),P.set(na,{canAnimate:!0,pendingMessage:null}))}});return()=>{l()}},[]),x.useEffect(()=>{const l=P.sub(Tt,()=>{P.get(Tt).type==="stopped"&&(P.get(go)?console.log("⚠️ Simulation stopped, preserving message history (HLT execution detected)"):(console.log("✅ Simulation stopped, clearing message history (not HLT execution)"),P.set(ws,[]),P.set(na,{canAnimate:!0,pendingMessage:null})))});return()=>{l()}},[]),x.useEffect(()=>{n.type==="running"&&i&&gi({title:"El programa ha sido modificado",description:"La ejecución se reiniciará desde el principio para aplicar los cambios.",variant:"info"})},[n,i]),x.useEffect(()=>{const l=P.sub(Bl,()=>{const c=P.get(Bl),u=P.get(Tt);if(c===0&&u.type==="running"){const d=P.get(go);console.log("🔄 Instruction count reset to 0 with running simulation, isHaltExecution:",d,"current history length:",P.get(ws).length),d?console.log("⚠️ NOT clearing message history (HLT execution detected during instruction count reset)"):(console.log("✅ Clearing message history (instruction count reset, not HLT)"),P.set(ws,[]),P.set(na,{canAnimate:!0,pendingMessage:null}),P.set(go,!1))}});return()=>{l()}},[]),x.useEffect(()=>{const l=o.current;l&&(l.scrollTop=l.scrollHeight)},[e]),!s.showInstructionCycle||r.pic?null:h.jsx("div",{className:"absolute left-[120px] top-[520px] z-10 h-min w-[420px]",children:h.jsxs("div",{className:"rounded-xl border-2 border-stone-400/50 bg-gradient-to-br from-stone-800 to-stone-900 shadow-2xl backdrop-blur-sm",children:[h.jsx("div",{className:"rounded-t-xl border-b-2 border-stone-600/50 bg-gradient-to-r from-stone-700 to-stone-800 px-4 py-3",children:h.jsx("div",{className:"flex items-center justify-between",children:h.jsx("div",{className:"flex items-center gap-3",children:h.jsx("div",{children:h.jsx("span",{className:"text-sm font-bold uppercase tracking-wide text-mantis-400",children:"Ciclo de instrucción"})})})})}),h.jsxs("div",{ref:o,className:"scrollbar-thin max-h-80 overflow-y-auto p-4",children:[e.map((l,c)=>{const u=c===0||e[c-1].stage!==l.stage,d=c===e.length-1;return h.jsxs("div",{className:`transition-all duration-300 ease-in-out ${l.stage==="Captación"||l.stage==="Ejecución"?"mb-1":"mb-3"}`,children:[u&&h.jsx("div",{className:"animate-fade-in mb-2",children:h.jsxs("div",{className:`flex items-center gap-3 rounded-lg border border-stone-600/30 bg-gradient-to-r from-stone-800/60 to-stone-900/60 px-4 py-2.5 shadow-md backdrop-blur-sm ${uT(l.stage)}`,children:[h.jsxs("div",{className:"relative",children:[h.jsx("span",{className:"text-lg",children:Nde(l.stage,d)}),d&&h.jsx("div",{className:"absolute -right-0.5 -top-0.5 size-2.5 rounded-full bg-green-400 shadow-sm ring-1 ring-green-300/50"})]}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsx("h4",{className:`truncate text-sm font-bold tracking-wide ${uT(l.stage).split(" ")[0]}`,children:l.stage}),h.jsxs("p",{className:"mt-0.5 text-xs leading-tight text-stone-400",children:[l.stage==="Captación"&&"Leer instrucción desde memoria",l.stage==="Obtención de operandos"&&"Preparar datos necesarios",l.stage==="Ejecución"&&"Procesar instrucción",l.stage==="Escritura"&&"Guardar resultado final",l.stage==="Interrupción"&&"Manejar interrupción"]})]})]})}),l.stage==="Interrupción"?h.jsx("div",{className:`rounded-xl border-l-4 border-red-400 bg-gradient-to-r from-red-900/30 to-red-800/20 p-4 shadow-lg transition-all duration-300 ${d?"ring-2 ring-red-400/50 ring-offset-2 ring-offset-stone-800":""}`,children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"text-lg",children:"🚨"}),h.jsx("span",{className:"text-sm font-medium text-red-300",children:l.action})]})}):l.stage==="Captación"?h.jsxs("div",{className:`ml-8 flex items-center gap-3 rounded-lg border-l-2 border-blue-400/30 bg-gradient-to-r from-blue-900/20 to-blue-800/10 py-2 pl-4 pr-3 transition-all duration-200 hover:bg-blue-800/20 ${d?"ring-1 ring-blue-400/50":""}`,children:[h.jsx("div",{className:`flex size-6 items-center justify-center rounded-full text-xs font-bold transition-all duration-300 ${d?"bg-blue-600 shadow-md shadow-blue-400/30 ring-1 ring-blue-400/50":"bg-blue-700/80"} text-white`,children:l.cycle}),h.jsx("div",{className:"flex-1",children:h.jsx("span",{className:"text-xs font-medium text-blue-200/90",children:l.action})}),d&&h.jsx("div",{className:"size-1.5 rounded-full bg-blue-300 shadow-sm shadow-blue-400/30"})]}):l.stage==="Ejecución"?h.jsxs("div",{className:`ml-8 flex items-center gap-3 rounded-lg border-l-2 border-green-400/30 bg-gradient-to-r from-green-900/20 to-green-800/10 py-2 pl-4 pr-3 transition-all duration-200 hover:bg-green-800/20 ${d?"ring-1 ring-green-400/50":""}`,children:[h.jsx("div",{className:`flex size-6 items-center justify-center rounded-full text-xs font-bold transition-all duration-300 ${d?"bg-green-600 shadow-md shadow-green-400/30 ring-1 ring-green-400/50":"bg-green-700/80"} text-white`,children:l.cycle}),h.jsx("div",{className:"flex-1",children:h.jsx("span",{className:"text-xs font-medium text-green-200/90",children:l.action})}),d&&h.jsx("div",{className:"size-1.5 rounded-full bg-green-300 shadow-sm shadow-green-400/30"})]}):h.jsxs("div",{className:`flex items-center gap-3 rounded-xl border border-stone-600/50 bg-gradient-to-r from-stone-800/80 to-stone-900/80 p-4 transition-all duration-300 hover:scale-[1.02] ${d?"bg-stone-700/80 "+Mde(d,l.stage):""}`,children:[h.jsx("div",{className:`flex size-8 items-center justify-center rounded-full text-sm font-bold transition-all duration-300 ${d?"scale-110 bg-gradient-to-r from-green-600 to-emerald-700 shadow-lg shadow-green-400/30 ring-2 ring-green-400/50":"bg-stone-700"} ${d?"text-white":Rde(l.stage,l.action)}`,children:l.cycle}),h.jsx("div",{className:"flex-1",children:h.jsx("span",{className:`text-sm font-medium transition-all duration-200 ${Pde(l.stage,l.action).split(" ")[0]}`,children:l.action})}),d&&h.jsx("div",{className:"flex items-center gap-1",children:h.jsx("div",{className:"size-2 rounded-full bg-green-400 shadow-lg shadow-green-400/50"})})]})]},c)}),e.length===0&&h.jsx("div",{className:"animate-fade-in flex items-center justify-center py-12",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"mb-4 text-5xl",children:"⏳"}),h.jsx("h4",{className:"mb-2 bg-gradient-to-r from-stone-300 to-stone-400 bg-clip-text text-sm font-bold text-transparent",children:"Esperando instrucciones"}),h.jsx("p",{className:"text-xs text-stone-500",children:"Ejecuta un programa para ver el ciclo"})]})})]}),h.jsx("div",{className:"rounded-b-xl border-t border-stone-600/50 bg-gradient-to-r from-stone-800/80 to-stone-900/80 px-4 py-3",children:h.jsxs("div",{className:"flex items-center justify-between text-xs text-stone-400",children:[h.jsxs("span",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 rounded-full bg-blue-400"}),"Ciclos: ",P.get(Dt)]}),h.jsxs("span",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"size-2 rounded-full bg-green-400 shadow-lg shadow-green-400/50"}),h.jsx("span",{className:"text-xs font-medium text-green-300",children:"Activo"})]})]})})]})})}function Tde(){const t=cn(),{devices:e}=Kn();return e.hasIOBus?h.jsx("div",{className:"absolute left-[500px] top-[525px] z-40 h-[70px] w-[250px] rounded-lg border border-stone-600 bg-stone-900",children:h.jsx("span",{className:"block w-min whitespace-nowrap rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-lg text-white",children:t("computer.chip-select.name")})}):null}function Ode(){const{devices:t}=Kn(),e=tt(_y),n=tt(Cy),i=x.useRef(null),r=x.useRef(null),s=x.useRef(null),o=["M 380 420 H 800",t.pic&&"M 780 420 V 805 H 450",t.pio&&"M 780 420 V 805 H 900",t.timer&&"M 780 420 V 805 H 583 V 875",t.handshake&&"M 780 420 V 1015 H 900"].filter(Boolean).join(" "),a=["M 380 440 H 800",t.pic&&"M 790 440 V 815 H 450",t.pio&&"M 790 440 V 815 H 900",t.timer&&"M 790 440 V 815 H 573 V 875",t.handshake&&"M 790 440 V 1025 H 900"].filter(Boolean).join(" "),l="M 750 545 H 800",{path:c,strokeDashoffset:u,opacity:d}=je("bus.rd"),{path:f,strokeDashoffset:p,opacity:m}=je("bus.wr");return h.jsxs(h.Fragment,{children:[e&&h.jsx(Dde,{pathRef:r}),n&&h.jsx(jde,{pathRef:s}),h.jsxs("svg",{className:"pointer-events-none absolute inset-0 z-[15] size-full",children:[h.jsx("path",{ref:i,className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:o}),h.jsx("path",{className:"fill-none stroke-stone-700 stroke-[4px]",strokeLinejoin:"round",d:o}),e&&h.jsx(Qe.path,{ref:r,d:c||o,className:"fill-none stroke-red-500 stroke-[3px] drop-shadow-[0_0_8px_rgba(239,68,68,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:u,opacity:d}}),e&&h.jsx(Qe.path,{d:c||o,className:"fill-none stroke-red-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:u,opacity:d}}),h.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:a}),h.jsx("path",{className:"fill-none stroke-stone-700 stroke-[4px]",strokeLinejoin:"round",d:a}),n&&h.jsx(Qe.path,{ref:s,d:f||a,className:"fill-none stroke-orange-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(251,146,60,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:p,opacity:m}}),n&&h.jsx(Qe.path,{d:f||a,className:"fill-none stroke-orange-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:p,opacity:m}}),t.hasIOBus&&h.jsxs(h.Fragment,{children:[h.jsx(On,{springs:"bus.iom",d:"M 380 460 H 675 V 525"}),h.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:l}),h.jsx(Qe.path,{className:"fill-none stroke-[4px]",strokeLinejoin:"round",d:l,style:je("bus.mem")})]}),t.pic&&h.jsx(On,{springs:"bus.pic",d:"M 521 595 V 730 H 450"}),t.timer&&h.jsx(On,{springs:"bus.timer",d:"M 563 595 V 875"}),t.handshake&&h.jsx(On,{springs:"bus.handshake",d:"M 710 595 V 950 H 900"}),t.pic&&h.jsxs(h.Fragment,{children:[h.jsx(On,{springs:"bus.intr",d:"M 110 700 V 482"}),h.jsx(On,{springs:"bus.inta",d:"M 160 482 V 700"})]}),t.pic&&t.f10&&h.jsx(On,{springs:"bus.int0",d:"M 70 950 V 900"}),t.pic&&t.timer&&h.jsx(On,{springs:"bus.int1",d:"M 475 955 H 180 V 900"}),t.pic&&t.handshake&&h.jsx(On,{springs:"bus.int2",d:"M 900 1075 H 300 V 900"}),t.pio&&h.jsx(On,{springs:"bus.pio",d:"M 612 595 V 730 H 900"}),t.handshake&&h.jsx(On,{springs:"bus.int0",d:"M 900 1015 H 900"}),t.pio==="printer"&&h.jsxs(h.Fragment,{children:[h.jsx(On,{springs:"bus.printer.strobe",d:"M 1120 767 H 1225 V 992 H 1300"}),h.jsx(On,{springs:"bus.printer.busy",d:"M 1300 1007 H 1210 V 782 H 1120"}),h.jsx(On,{springs:"bus.printer.data",d:"M 1120 837 H 1175 V 1062 H 1300"})]}),t.handshake==="printer"&&h.jsxs(h.Fragment,{children:[h.jsx(On,{springs:"bus.printer.strobe",d:"M 1120 992 H 1300"}),h.jsx(On,{springs:"bus.printer.busy",d:"M 1300 1007 H 1120"}),h.jsx(On,{springs:"bus.printer.data",d:"M 1120 1062 H 1300"})]}),t.pio&&t.switches&&h.jsx(On,{springs:"bus.switches->pio",d:"M 1300 768 H 1120"}),t.pio&&t.leds&&h.jsx(On,{springs:"bus.pio->leds",d:"M 1300 848 H 1120"})]})]})}function On({d:t,springs:e}){return h.jsxs(h.Fragment,{children:[h.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:t}),h.jsx("path",{className:"fill-none stroke-stone-700 stroke-[3px]",strokeLinejoin:"round",d:t}),h.jsx(Qe.path,{d:t,className:"fill-none stroke-red-500 stroke-[3px] drop-shadow-[0_0_8px_rgba(239,68,68,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:je(e)}),h.jsx(Qe.path,{d:t,className:"fill-none stroke-red-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:je(e)})]})}function Lde(){const t=cn(),{devices:e}=Kn();return h.jsxs(h.Fragment,{children:[h.jsx(fr,{style:{left:385,top:405},children:"rd"}),h.jsx(fr,{style:{left:385,top:425},children:"wr"}),e.hasIOBus&&h.jsxs(h.Fragment,{children:[h.jsx(fr,{style:{left:384,top:443},children:"io/m"}),h.jsx(fr,{style:{left:715,top:538},children:t("computer.chip-select.mem")})]}),e.pic&&h.jsx(h.Fragment,{children:h.jsx(fr,{className:"left-[510px] top-[573px]",children:t("computer.chip-select.pic")})}),e.timer&&h.jsx(h.Fragment,{children:h.jsx(fr,{className:"left-[545px] top-[573px]",children:t("computer.chip-select.timer")})}),e.pio&&h.jsx(h.Fragment,{children:h.jsx(fr,{className:"left-[600px] top-[573px]",children:t("computer.chip-select.pio")})}),e.handshake&&h.jsx(h.Fragment,{children:h.jsx(fr,{className:"left-[675px] top-[573px]",children:t("computer.chip-select.handshake")})}),e.pic&&h.jsxs(h.Fragment,{children:[h.jsx(fr,{className:"left-[75px] top-[482px]",children:"intr"}),h.jsx(fr,{className:"left-[125px] top-[482px]",children:"inta"})]}),e.printer&&h.jsxs(h.Fragment,{children:[h.jsx(fr,{className:"left-[1310px] top-[983px]",children:"strobe"}),h.jsx(fr,{className:"left-[1310px] top-[998px]",children:"busy"}),h.jsx(fr,{className:"left-[1310px] top-[1053px]",children:"data"})]})]})}function fr({children:t,style:e,className:n}){return h.jsx("span",{className:`pointer-events-none absolute z-50 block font-mono text-xs font-bold tracking-wider text-stone-400${n?" "+n:""}`,style:e,children:t})}function Dde({pathRef:t}){const[e,n]=x.useState(!0),i=Mp(_y),[r,s]=x.useState(!1),[o,a]=x.useState(0),[l]=Oo();if(x.useEffect(()=>{if(e&&r){const p=Date.now(),g=l.animations?Math.min(l.executionUnit,250):1,y=()=>{const v=Date.now()-p,b=Math.min(v/g,1);a(b),b<1?requestAnimationFrame(y):(n(!1),setTimeout(()=>i(!1),100))};y()}},[e,r,i,l.animations,l.executionUnit]),x.useEffect(()=>{let p=0;const m=50,g=()=>{if(t.current){s(!0);return}p++,p<m?setTimeout(g,10):s(!1)};g()},[t]),!e||!r||!l.animations)return null;const c=380,u=800,d=420,f=c+(u-c)*o;return h.jsx("div",{className:"pointer-events-none absolute z-[100] select-none text-xs font-extrabold",style:{left:f,top:d-32,color:"#ef4444",textShadow:"0 0 4px #000, 0 0 2px #000",background:"rgba(0,0,0,0.2)",padding:"2px 8px",borderRadius:"6px",transition:"left 0.1s linear, top 0.1s linear",opacity:e?1:0},children:"Read"})}function jde({pathRef:t}){const[e,n]=x.useState(!0),i=Mp(Cy),[r,s]=x.useState(!1),[o,a]=x.useState(0),[l]=Oo();if(x.useEffect(()=>{if(e&&r){const p=Date.now(),g=l.animations?Math.min(l.executionUnit,250):1,y=()=>{const v=Date.now()-p,b=Math.min(v/g,1);a(b),b<1?requestAnimationFrame(y):(n(!1),setTimeout(()=>i(!1),100))};y()}},[e,r,i,l.animations,l.executionUnit]),x.useEffect(()=>{let p=0;const m=50,g=()=>{if(t.current){s(!0);return}p++,p<m?setTimeout(g,10):s(!1)};g()},[t]),!e||!r)return null;const c=380,u=800,d=440,f=c+(u-c)*o;return h.jsx("div",{className:"pointer-events-none absolute z-[100] select-none text-xs font-extrabold",style:{left:f,top:d+12,color:"#f59e42",textShadow:"0 0 4px #000, 0 0 2px #000",background:"rgba(0,0,0,0.2)",padding:"2px 8px",borderRadius:"6px",transition:"left 0.1s linear, top 0.1s linear",opacity:e?1:0},children:"Write"})}function Bde(){const{devices:t}=Kn(),e=["M 645 349 H 800",t.pic&&"M 725 349 V 770 H 450",t.pio&&"M 725 349 V 770 H 900",t.timer&&"M 725 349 V 770 H 618 V 875",t.handshake&&"M 725 349 V 980 H 900"].filter(Boolean).join(" "),n=["M 645 250 H 645 V 249 H 800",t.pic&&"M 765 249 V 790 H 450",t.pio&&"M 765 249 V 790 H 900",t.timer&&"M 765 249 V 790 H 598 V 875",t.handshake&&"M 765 249 V 1000 H 900"].filter(Boolean).join(" "),{path:i,strokeDashoffset:r,opacity:s}=je("bus.data"),{path:o,strokeDashoffset:a,opacity:l}=je("bus.address");return h.jsxs("svg",{className:"pointer-events-none absolute inset-0 z-[25] size-full",children:[h.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:n}),h.jsx(Qe.path,{d:i,className:"fill-none stroke-mantis-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(34,197,94,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:r,opacity:s}}),h.jsx(Qe.path,{d:i,className:"fill-none stroke-mantis-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:r,opacity:s}}),h.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:e}),h.jsx(Qe.path,{d:o,className:"fill-none stroke-blue-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(59,130,246,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:a,opacity:l}}),h.jsx(Qe.path,{d:o,className:"fill-none stroke-blue-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:{strokeDashoffset:a,opacity:l}})]})}function $de(){return h.jsxs(h.Fragment,{children:[h.jsx(Bde,{}),h.jsx(Ode,{}),h.jsx(Lde,{}),h.jsx(Tde,{})]})}function Fde(){const{devices:t}=Kn();if(!t.clock)return null;const e=je("clock.angle");return h.jsx("div",{className:"absolute left-[520px] top-[930px] z-10 size-12 rounded-full border border-stone-600 bg-stone-800 p-1 [&_*]:z-20",children:h.jsxs("svg",{viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"size-full fill-none stroke-white stroke-2",children:[h.jsx("circle",{cx:"12",cy:"12",r:"10"}),h.jsx(Qe.line,{x1:e.to(n=>12+6*Math.sin(n*Math.PI/180)),y1:e.to(n=>12-6*Math.cos(n*Math.PI/180)),x2:12,y2:12})]})})}const zde={register:{beginner:"Un registro es como una caja pequeña donde la CPU guarda datos temporalmente. Es muy rápido de acceder.",intermediate:"Los registros son memoria de acceso rápido dentro de la CPU. Son más rápidos que la RAM pero tienen menos capacidad.",advanced:"Registros de propósito general (AL, BL, CL, DL) para operaciones aritméticas. Cada uno puede almacenar 8 bits."},memory:{beginner:"La memoria RAM es como un gran almacén donde se guardan programas y datos. Cada ubicación tiene una dirección única.",intermediate:"Memoria de acceso aleatorio (RAM) de 256 bytes. La CPU puede leer y escribir en cualquier dirección.",advanced:"Memoria principal de 256 bytes con direccionamiento de 8 bits (00-FF). Organizada en celdas de 8 bits cada una."},alu:{beginner:'La ALU (Unidad Aritmético-Lógica) es el "cerebro matemático" de la CPU. Realiza sumas, restas y comparaciones.',intermediate:"Arithmetic Logic Unit procesa operaciones matemáticas y lógicas. Recibe operandos y devuelve resultados.",advanced:"ALU de 8 bits que ejecuta operaciones: ADD, SUB, AND, OR, XOR, NOT, CMP. Incluye flags de estado (Z, N, C)."},bus:{beginner:'Los buses son como "carreteras" por donde viajan los datos entre los componentes de la computadora.',intermediate:"Buses de datos y control conectan CPU, memoria y periféricos. El bus de datos transporta información.",advanced:"Bus de datos de 8 bits bidireccional, bus de direcciones de 8 bits, y líneas de control para sincronización."},instruction:{beginner:"Una instrucción es un comando que le dice a la CPU qué operación realizar, como sumar dos números.",intermediate:"Cada instrucción tiene un código de operación (opcode) y operandos. La CPU las ejecuta secuencialmente.",advanced:"Formato de instrucción: opcode (1 byte) + operandos. Ejemplos: MOV, ADD, JMP, CALL. Ciclo fetch-decode-execute."},"program-counter":{beginner:"El contador de programa (IP) indica qué instrucción ejecutar a continuación. Se incrementa automáticamente.",intermediate:"Program Counter (IP) contiene la dirección de la siguiente instrucción. Se actualiza en cada ciclo.",advanced:"Instruction Pointer (IP) de 8 bits. Incrementa en 1-2 bytes según el tamaño de la instrucción actual."},flags:{beginner:"Las banderas son indicadores que muestran el resultado de operaciones, como si el resultado fue cero.",intermediate:"Flags de estado: Zero (Z), Negative (N), Carry (C). Se actualizan automáticamente en operaciones.",advanced:"Flags de 1 bit: Z (resultado cero), N (resultado negativo), C (acarreo/overflow). Controlan saltos condicionales."},stack:{beginner:"La pila es como una pila de platos. Solo puedes agregar o quitar del tope. Útil para guardar direcciones de retorno.",intermediate:"Stack Pointer (SP) apunta al tope de la pila. PUSH agrega datos, POP los retira. LIFO (Last In, First Out).",advanced:"Pila de 256 bytes con SP de 8 bits. PUSH decrementa SP, POP lo incrementa. Usada para CALL/RET y variables locales."},interrupt:{beginner:"Una interrupción es como un timbre que interrumpe lo que está haciendo la CPU para atender algo urgente.",intermediate:"Las interrupciones permiten que dispositivos externos notifiquen a la CPU eventos importantes.",advanced:"Sistema de interrupciones con PIC (Programmable Interrupt Controller). IRET retorna de la rutina de interrupción."},peripheral:{beginner:"Los periféricos son dispositivos externos como teclado, pantalla y LEDs que se conectan a la computadora.",intermediate:"Periféricos se comunican con la CPU a través de puertos de entrada/salida (I/O).",advanced:"Sistema de I/O con PIO (Programmable I/O) y módulos específicos para cada periférico."},assembly:{beginner:"El lenguaje ensamblador es un lenguaje de programación que usa palabras en lugar de números para las instrucciones.",intermediate:"Cada instrucción de ensamblador se traduce a código de máquina. El ensamblador hace esta traducción.",advanced:"Sintaxis: etiqueta, mnemónico, operandos, comentarios. Directivas como ORG, DB, DW para datos."},addressing:{beginner:"El direccionamiento es cómo la CPU encuentra los datos que necesita en la memoria.",intermediate:"Modos de direccionamiento: inmediato, directo, indirecto. Cada uno accede a datos de forma diferente.",advanced:"Direccionamiento inmediato (valor en instrucción), directo (dirección en instrucción), indirecto (dirección en registro)."}},Ude={beginner:xd,intermediate:Nm,advanced:KC},dT={beginner:"text-blue-400",intermediate:"text-yellow-400",advanced:"text-purple-400"},sz=x.memo(({concept:t,level:e="beginner",children:n,className:i})=>{const[r,s]=x.useState(e),o=zde[t];if(!o)return console.warn(`No educational content found for concept: ${t}`),h.jsx(h.Fragment,{children:n});const a=o[r],l=Ude[r],c=h.jsxs("div",{className:"max-w-xs p-3",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[h.jsx(Ye,{icon:l,className:re("text-sm",dT[r])}),h.jsxs("span",{className:re("text-sm font-medium",dT[r]),children:["Nivel"," ",r==="beginner"?"Básico":r==="intermediate"?"Intermedio":"Avanzado"]})]}),h.jsx("p",{className:"mb-3 text-sm text-stone-300",children:a}),h.jsx("div",{className:"flex gap-1",children:["beginner","intermediate","advanced"].map(u=>h.jsx("button",{onClick:d=>{d.stopPropagation(),s(u)},className:re("rounded px-2 py-1 text-xs transition-colors",r===u?"bg-mantis-600 text-white":"bg-stone-700 text-stone-400 hover:bg-stone-600"),children:u==="beginner"?"B":u==="intermediate"?"I":"A"},u))})]});return h.jsx(rs,{content:c,position:"top",children:h.jsxs("span",{className:re("inline-flex cursor-help items-center gap-1",i),children:[n,h.jsx(Ye,{icon:xd,className:"text-xs text-mantis-400 opacity-70 transition-opacity hover:opacity-100"})]})})});sz.displayName="EducationalTooltip";var y1="Popover",[oz,xve]=zs(y1,[Mf]),Hm=Mf(),[Vde,rc]=oz(y1),az=t=>{const{__scopePopover:e,children:n,open:i,defaultOpen:r,onOpenChange:s,modal:o=!1}=t,a=Hm(e),l=x.useRef(null),[c,u]=x.useState(!1),[d,f]=Il({prop:i,defaultProp:r??!1,onChange:s,caller:y1});return h.jsx(M$,{...a,children:h.jsx(Vde,{scope:e,contentId:kf(),triggerRef:l,open:d,onOpenChange:f,onOpenToggle:x.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:c,onCustomAnchorAdd:x.useCallback(()=>u(!0),[]),onCustomAnchorRemove:x.useCallback(()=>u(!1),[]),modal:o,children:n})})};az.displayName=y1;var lz="PopoverAnchor",Hde=x.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=rc(lz,n),s=Hm(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=r;return x.useEffect(()=>(o(),()=>a()),[o,a]),h.jsx(a1,{...s,...i,ref:e})});Hde.displayName=lz;var cz="PopoverTrigger",uz=x.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=rc(cz,n),s=Hm(n),o=wt(e,r.triggerRef),a=h.jsx(et.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":mz(r.open),...i,ref:o,onClick:ke(t.onClick,r.onOpenToggle)});return r.hasCustomAnchor?a:h.jsx(a1,{asChild:!0,...s,children:a})});uz.displayName=cz;var CA="PopoverPortal",[Wde,Gde]=oz(CA,{forceMount:void 0}),dz=t=>{const{__scopePopover:e,forceMount:n,children:i,container:r}=t,s=rc(CA,e);return h.jsx(Wde,{scope:e,forceMount:n,children:h.jsx(Sa,{present:n||s.open,children:h.jsx(zm,{asChild:!0,container:r,children:i})})})};dz.displayName=CA;var mf="PopoverContent",fz=x.forwardRef((t,e)=>{const n=Gde(mf,t.__scopePopover),{forceMount:i=n.forceMount,...r}=t,s=rc(mf,t.__scopePopover);return h.jsx(Sa,{present:i||s.open,children:s.modal?h.jsx(Kde,{...r,ref:e}):h.jsx(Xde,{...r,ref:e})})});fz.displayName=mf;var qde=Jd("PopoverContent.RemoveScroll"),Kde=x.forwardRef((t,e)=>{const n=rc(mf,t.__scopePopover),i=x.useRef(null),r=wt(e,i),s=x.useRef(!1);return x.useEffect(()=>{const o=i.current;if(o)return T$(o)},[]),h.jsx(c1,{as:qde,allowPinchZoom:!0,children:h.jsx(hz,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ke(t.onCloseAutoFocus,o=>{var a;o.preventDefault(),s.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:ke(t.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:ke(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),Xde=x.forwardRef((t,e)=>{const n=rc(mf,t.__scopePopover),i=x.useRef(!1),r=x.useRef(!1);return h.jsx(hz,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,s),s.defaultPrevented||(i.current||(a=n.triggerRef.current)==null||a.focus(),s.preventDefault()),i.current=!1,r.current=!1},onInteractOutside:s=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,s),s.defaultPrevented||(i.current=!0,s.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&r.current&&s.preventDefault()}})}),hz=x.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:r,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=t,f=rc(mf,n),p=Hm(n);return rA(),h.jsx(i1,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:r,onUnmountAutoFocus:s,children:h.jsx($m,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:h.jsx(mA,{"data-state":mz(f.open),role:"dialog",id:f.contentId,...p,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),pz="PopoverClose",Yde=x.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=rc(pz,n);return h.jsx(et.button,{type:"button",...i,ref:e,onClick:ke(t.onClick,()=>r.onOpenChange(!1))})});Yde.displayName=pz;var Jde="PopoverArrow",Zde=x.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=Hm(n);return h.jsx(gA,{...r,...i,ref:e})});Zde.displayName=Jde;function mz(t){return t?"open":"closed"}var Qde=az,efe=uz,tfe=dz,gz=fz;const Dy=Qde,jy=efe,dm=x.forwardRef(({className:t,align:e="center",sideOffset:n=4,...i},r)=>h.jsx(tfe,{children:h.jsx(gz,{ref:r,align:e,sideOffset:n,className:re("z-50 w-72 rounded-md border border-stone-600 bg-stone-900 text-white shadow-md outline-none transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...i})}));dm.displayName=gz.displayName;function Ar({name:t,valueAtom:e,springs:n,emphasis:i=!1,className:r}){const s=cn(),o=tt(e),a=o.low,c={AX:"AL",BX:"BL",CX:"CL",DX:"DL"}[t]||t,u=["AL","BL","CL","DL"].includes(t),d=t==="IP",f=t==="SP",p=t==="MBR",m=t==="MAR",g=t==="IR",y=["id","ri"].includes(t),v=c==="FLAGS";return h.jsxs(Dy,{children:[h.jsx(jy,{asChild:!0,children:h.jsxs(Qe.button,{title:c!=="left"&&c!=="right"&&c!=="result"?`Registro ${c}`:c,className:re("flex cursor-pointer items-center font-mono leading-none transition-opacity",u||d||f||p||m||g||y?"size-10 justify-center rounded border-2 text-lg font-bold shadow-[0_2px_8px_0_rgba(60,180,120,0.10)] transition-all duration-200 hover:scale-110 hover:shadow-xl":v?"min-h-[32px] min-w-[90px] gap-2 rounded border-2 border-yellow-400 bg-gradient-to-br from-yellow-900 via-yellow-800 to-stone-900 px-2.5 py-0.5 font-bold text-yellow-200 shadow-[0_2px_8px_0_rgba(250,204,21,0.10)]":"rounded-md border bg-stone-800 px-2 py-1",u?"border-mantis-500 bg-stone-800 text-mantis-300":d?"border-red-500 bg-stone-800 text-red-300":f?"border-yellow-400 bg-stone-800 text-yellow-300":p||m||g?"border-indigo-400 bg-stone-800 text-indigo-300":y?"border-cyan-400 bg-stone-800 text-cyan-300":v?"":i?"border-mantis-400 text-lg":"border-stone-600 text-base",r),style:c==="left"||c==="right"||c==="result"?{backgroundColor:"transparent"}:je(n),children:[u||f||p||m||g||y?h.jsx(h.Fragment,{children:h.jsx("span",{className:re(u||y||g||m||p?"mt-4":"mt-2","font-mono text-base font-bold"),children:a.toString("hex")})}):d?h.jsx(h.Fragment,{children:h.jsx("span",{className:re("mt-4 font-mono text-base font-bold text-red-300"),children:a.toString("hex")})}):c==="left"?h.jsx("span",{className:"opacity-0"}):c==="right"?h.jsx("span",{className:"opacity-0"}):c==="result"?h.jsx("span",{className:"opacity-0"}):h.jsxs(h.Fragment,{children:[h.jsx("span",{className:re("mr-2 font-extrabold tracking-wide",u&&"text-mantis-300 drop-shadow",v&&"text-yellow-200",y&&"text-cyan-300",(c==="left"||c==="right")&&"text-xs"),children:c}),h.jsx("span",{className:re("rounded px-1 py-0.5 font-light",u?"border border-mantis-400 bg-stone-950 text-mantis-300":v?"border border-yellow-400 bg-yellow-950 text-yellow-200":y?"border border-cyan-400 bg-cyan-950 text-cyan-200":"border border-stone-600 bg-stone-900 text-white"),children:a.toString("hex")})]}),v&&h.jsxs("span",{className:"ml-2 flex gap-1",children:[h.jsx("span",{className:re("rounded border px-1 text-xs font-bold",Number(a)&2?"border-yellow-300 bg-yellow-400 text-yellow-950":"border-yellow-700 bg-stone-800 text-yellow-300"),children:"Z"}),h.jsx("span",{className:re("rounded border px-1 text-xs font-bold",Number(a)&1?"border-yellow-300 bg-yellow-400 text-yellow-950":"border-yellow-700 bg-stone-800 text-yellow-300"),children:"C"})]})]})}),h.jsxs(dm,{className:"w-60",children:[h.jsx("div",{className:"px-4 py-2",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("p",{className:"font-medium text-white",children:c!=="left"&&c!=="right"&&c!=="result"?`Registro ${c}`:c}),c!=="left"&&c!=="right"&&c!=="result"&&h.jsx(sz,{concept:"register",level:"beginner",children:h.jsx("span",{className:"text-xs text-mantis-400",children:"💡"})})]})}),h.jsx("hr",{className:"border-stone-600"}),h.jsx("ul",{className:"px-4 py-2 text-sm",children:["hex","bin","uint","int","safe-ascii"].map(b=>h.jsxs("li",{children:[h.jsx("b",{className:"font-medium",children:s(`generics.byte-representation.${b}`)}),":"," ",h.jsx("span",{className:"font-mono text-mantis-400",children:o.low.toString(b)})]},b))})]})]})}function nfe(){const t=tt(he.FLAGS),e=tt(he.result),n=tt(he.left),i=tt(he.right),r=tt(aE),s=tt(Hn),[o,a]=x.useState(!1),[l,c]=x.useState(""),[u,d]=x.useState(""),[f,p]=x.useState(""),[m,g]=x.useState(""),[y,v]=x.useState(""),[b,w]=x.useState(""),k=tt(sE),C=tt(Bb),[E]=Oo(),_=x.useCallback(()=>s&&"metadata"in s&&s.metadata?`${s.metadata.name}${s.metadata.operands.length?" "+s.metadata.operands.join(", "):""}`:"",[s]),A=K=>["ADD","SUB","CMP","AND","OR","XOR"].some(ne=>K.startsWith(ne)),R=K=>{let J="AL",ne="BL",V="AL";const U=[/ADD\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/,/SUB\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/,/CMP\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/,/AND\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/,/OR\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/,/XOR\s+([[\]A-Z0-9]+),\s*([[\]A-Z0-9]+)/],se=/^(ADD|SUB|CMP|AND|OR|XOR)\s+(\[[^\]]+\]|[0-9A-F]+h?)\s*,\s*([0-9A-F]+h?|0x[0-9A-F]+)$/i;if(K.match(se))return{left:"mbr",right:"id",destination:"mbr"};for(const ae of U){const z=K.match(ae);if(z){J=z[1],ne=z[2],/\[.*\]/.test(J)&&(J="MBR"),/\[.*\]/.test(ne)&&(ne="MBR"),V=z[1];break}}const Q=["AL","BL","CL","DL","MBR"];return Q.includes(J)||(J="AL"),Q.includes(ne)||(ne="BL"),Q.includes(V)||(V="AL"),{left:J,right:ne,destination:V}};x.useEffect(()=>{const K=V=>{console.log("🎯 handleInstruction llamado con:",V);const se=_()||V;if(console.log("🎯 Instrucción completa a usar:",se),V)if(A(se)){a(!0);const{left:Q,right:ae,destination:z}=R(se);console.log("🎯 Registros detectados:",{left:Q,right:ae,destination:z}),g(Q),v(ae),w(z);let $,W;Q==="MBR"&&ae!=="MBR"?($=Ri(Q,"left",V,void 0,{separateMBRPaths:!0,direction:"left"}),W=Ri(ae,"right",V)):ae==="MBR"&&Q!=="MBR"?($=Ri(Q,"left",V),W=Ri(ae,"right",V,void 0,{separateMBRPaths:!0,direction:"right"})):($=Ri(Q,"left",V),W=Ri(ae,"right",V));const S=Ri("result start",z,V),T="M 455 45 L 465 45 L 550 45 L 550 16 L 90 16 L 90 85 L 130 85 L 220 85",j="M 455 85 L 465 85 L 550 85 L 550 250 L 90 250 L 90 145 L 125 145 L 220 145",D="M 280 115 L 370 115 L 390 115 L 425 115 L 425 45 L 455 45";c($||T),d(W||j),p(S||D)}else a(!1),c(""),d(""),p(""),g(""),v(""),w("");else a(!1),c(""),d(""),p(""),g(""),v(""),w("")},J=V=>{const U=V,se=_();K(se||U.detail.instruction)},ne=V=>{const U=V;if(U.detail&&U.detail.instruction){const se=_();K(se||U.detail.instruction)}};return window.addEventListener("instructionChange",J),window.addEventListener("cpu:alu.execute",ne),()=>{window.removeEventListener("instructionChange",J),window.removeEventListener("cpu:alu.execute",ne)}},[s,_]);const L=t.bit(1),O=t.bit(0),I=t.bit(3),G=t.bit(4),B=t.bit(2);return h.jsxs(h.Fragment,{children:[h.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[l&&h.jsx(Qe.path,{className:"fill-none stroke-green-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(34,197,94,0.6)]",strokeLinejoin:"round",d:l,pathLength:1,strokeDasharray:1,style:je("cpu.alu.operands")}),u&&h.jsx(Qe.path,{className:"fill-none stroke-blue-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(59,130,246,0.6)]",strokeLinejoin:"round",d:u,pathLength:1,strokeDasharray:1,style:je("cpu.alu.operands")}),f&&h.jsx(Qe.path,{className:"fill-none stroke-violet-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(139,92,246,0.6)]",strokeLinejoin:"round",d:f,pathLength:1,strokeDasharray:1,style:je("cpu.alu.results")}),l&&h.jsx(Qe.path,{className:"fill-none stroke-green-300 stroke-1 opacity-50",strokeLinejoin:"round",d:l,pathLength:1,strokeDasharray:1,style:je("cpu.alu.operands")}),u&&h.jsx(Qe.path,{className:"fill-none stroke-blue-300 stroke-1 opacity-50",strokeLinejoin:"round",d:u,pathLength:1,strokeDasharray:1,style:je("cpu.alu.operands")}),f&&h.jsx(Qe.path,{className:"fill-none stroke-violet-300 stroke-1 opacity-50",strokeLinejoin:"round",d:f,pathLength:1,strokeDasharray:1,style:je("cpu.alu.results")}),m&&y&&o&&l&&u&&h.jsxs(Qe.text,{x:"125",y:"65",fill:"#34D399",fontSize:"12",fontWeight:"bold",style:{opacity:je("cpu.alu.leftText").opacity},children:[m," = ",n.low.toString("hex")]}),m&&y&&o&&l&&u&&h.jsxs(Qe.text,{x:"125",y:"168",fill:"#60A5FA",fontSize:"12",fontWeight:"bold",style:{opacity:je("cpu.alu.rightText").opacity},children:[y," = ",i.low.toString("hex")]}),b&&o&&h.jsxs(Qe.text,{x:"310",y:"95",fill:"#A855F7",fontSize:"12",fontWeight:"bold",style:{...je("cpu.alu.cog"),opacity:je("cpu.alu.resultText").opacity},children:[b," = ",e.low.toString("hex")]}),h.jsxs("defs",{children:[h.jsxs("linearGradient",{id:"aluGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[h.jsx("stop",{offset:"0%",stopColor:"#374151"}),h.jsx("stop",{offset:"50%",stopColor:"#4B5563"}),h.jsx("stop",{offset:"100%",stopColor:"#1F2937"})]}),h.jsx("filter",{id:"aluShadow",children:h.jsx("feDropShadow",{dx:"2",dy:"2",stdDeviation:"3",floodColor:"rgba(0,0,0,0.3)"})})]}),h.jsx("path",{d:"M 220 60 v 50 l 20 12 l -20 12 v 50 l 60 -36 v -52 Z",fill:"url(#aluGradient)",stroke:"#6B7280",strokeWidth:"2",strokeLinejoin:"round",filter:"url(#aluShadow)"}),h.jsx("text",{x:"250",y:"105",fill:"#E5E7EB",fontSize:"12",fontWeight:"bold",textAnchor:"middle",children:"ALU"})]}),h.jsx(Qe.span,{className:"icon-[lucide--settings] absolute left-[244px] top-[120px] block size-5 text-stone-300",style:{transform:je("cpu.alu.cog").rot.to(K=>`rotate(${K*60}deg)`)}}),o&&h.jsx(Qe.span,{className:"absolute left-[244px] top-[40px] z-30 flex w-min items-center rounded-md border border-stone-600 px-2 py-1 font-mono leading-none",style:je("cpu.alu.operation"),children:r}),h.jsxs(Qe.div,{className:re("absolute flex items-center justify-center gap-0.5 rounded border-2 border-amber-400 bg-transparent font-bold text-stone-200 shadow-lg ring-1 ring-amber-300",E.flagsVisibility==="SF_OF_CF_ZF"?"left-[210px] top-[190px] min-h-[40px] min-w-[60px] px-2":"left-[230px] top-[190px] min-h-[40px] min-w-[40px] px-1"),style:je("cpu.FLAGS"),children:[h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[7px] font-bold text-stone-300",children:"FLAGS"}),h.jsxs("div",{className:"mt-3 flex items-center gap-0.5",children:[(k||C||E.flagsVisibility==="IF_CF_ZF"||E.flagsVisibility==="IF_SF_OF_CF_ZF")&&h.jsx("span",{className:re("rounded border px-0.5 py-0 text-[10px] font-bold transition-all duration-200",G?"border-amber-400 bg-amber-400 text-stone-950 shadow-[0_0_4px_rgba(251,191,36,0.6)]":"border-stone-600 bg-stone-800 text-stone-300"),children:"I"}),(E.flagsVisibility==="SF_OF_CF_ZF"||E.flagsVisibility==="IF_SF_OF_CF_ZF")&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:re("rounded border px-0.5 py-0 text-[10px] font-bold transition-all duration-200",I?"border-amber-400 bg-amber-400 text-stone-950 shadow-[0_0_4px_rgba(251,191,36,0.6)]":"border-stone-600 bg-stone-800 text-stone-300"),children:"S"}),h.jsx("span",{className:re("rounded border px-0.5 py-0 text-[10px] font-bold transition-all duration-200",B?"border-amber-400 bg-amber-400 text-stone-950 shadow-[0_0_4px_rgba(251,191,36,0.6)]":"border-stone-600 bg-stone-800 text-stone-300"),children:"O"})]}),h.jsx("span",{className:re("rounded border px-0.5 py-0 text-[10px] font-bold transition-all duration-200",L?"border-amber-400 bg-amber-400 text-stone-950 shadow-[0_0_4px_rgba(251,191,36,0.6)]":"border-stone-600 bg-stone-800 text-stone-300"),children:"C"}),h.jsx("span",{className:re("rounded border px-0.5 py-0 text-[10px] font-bold transition-all duration-200",O?"border-yellow-400 bg-yellow-400 text-stone-950 shadow-[0_0_4px_rgba(250,204,21,0.6)]":"border-stone-600 bg-stone-800 text-stone-300"),children:"Z"})]})]})]})}function ife({progress:t,resetAnimations:e,returnToOriginal:n}){const{opacity:r,filterIntensity:s}=t1({opacity:t.to(o=>n||e||o===0?.4:o>0&&o<1?1:(o>=1,.4)),filterIntensity:t.to(o=>n||e||o===0?.25:o>0&&o<1?.6:(o>=1,.25)),config:{tension:280,friction:60,duration:300}});return h.jsx(Qe.div,{style:{opacity:r,filter:s.to(o=>`drop-shadow(0 0 ${8*o}px rgba(56,189,248,${o}))`),transition:"opacity 0.3s ease-out, filter 0.3s ease-out"},children:h.jsxs("svg",{width:"90",height:"42",viewBox:"0 0 90 42",children:[h.jsx("rect",{x:"10",y:"8",width:"50",height:"26",rx:"8",fill:"#0369a1",stroke:"#38bdf8",strokeWidth:"2.5"}),Array.from({length:4}).map((o,a)=>h.jsx("rect",{x:2,y:10+a*5,width:8,height:2.5,rx:1.2,fill:"#38bdf8"},a)),Array.from({length:8}).map((o,a)=>h.jsx(Qe.rect,{x:60,y:8+a*3.2,width:24,height:2.5,rx:1.2,fill:t.to(l=>{if(n||e)return"#0ea5e9";const c=a/7;return l>=c?"#7dd3fc":"#0ea5e9"}),style:{filter:t.to(l=>{if(n||e)return"none";const c=a/7;return l>=c?"drop-shadow(0 0 8px #38bdf8)":"none"})}},a)),Array.from({length:5}).map((o,a)=>h.jsx(Qe.rect,{x:15,y:t.to(()=>12+a*3.5),width:40,height:2.8,rx:1.4,fill:t.to(l=>{if(n||e||l===0)return"#0c4a6e";const c=a/4;return l>=c?"#7dd3fc":"#0c4a6e"}),style:{filter:t.to(l=>{if(n||e||l===0)return"none";const c=a/4;return l>=c?"drop-shadow(0 0 6px #38bdf8)":"none"}),transition:"fill 0.7s, filter 0.7s"}},a)),h.jsx(Qe.rect,{x:"10",y:"8",width:"50",height:"26",rx:"8",fill:"none",stroke:"#7dd3fc",strokeWidth:"2.5",strokeDasharray:"160",strokeDashoffset:t.to(o=>n||e||o>0&&o<1?160:o===1?0:160),style:{opacity:t.to(o=>n||e||o>0&&o<1?0:o===1?.8:0),transition:"stroke-dashoffset 1.2s cubic-bezier(0.4, 0, 0.2, 1)"}})]})})}function rfe({progress:t,phase:e,resetAnimations:n,returnToOriginal:i}){return h.jsxs(h.Fragment,{children:[Array.from({length:5}).map((s,o)=>h.jsx(Qe.rect,{x:16,y:t.to(()=>10+o*4),width:38,height:3,rx:1,fill:t.to(a=>i||n||e==="fetching"&&a===0||a===0?"#581c87":a>=(o+1)/5?"#f0abfc":Math.floor(a*5)===o&&a>0&&a<1?"#fff1fb":"#581c87"),style:{filter:t.to(a=>i||n||e==="fetching"&&a===0||a===0?"none":a>=(o+1)/5?"drop-shadow(0 0 6px #e879f9)":Math.floor(a*5)===o&&a>0&&a<1?"drop-shadow(0 0 12px #e879f9)":"none"),transition:"fill 0.7s, filter 0.7s"}},o)),h.jsx(Qe.rect,{x:15,y:t.to(s=>10+Math.floor(s*5)*4-.5),width:40,height:3.5,rx:1.5,fill:"#e879f9",style:{opacity:t.to(s=>i||n?0:s>0&&s<1?.25+.25*Math.sin(s*Math.PI):0),transition:"y 0.3s, opacity 0.2s"}}),h.jsx(Qe.rect,{x:"8",y:"6",width:"54",height:"26",rx:"4",fill:"none",stroke:"#f0abfc",strokeWidth:"2",strokeDasharray:"160",strokeDashoffset:t.to(s=>i||n||e==="fetching"&&s===0||s===0?160:160-160*s),style:{opacity:t.to(s=>i||n?0:s>0&&s<1&&e==="fetching-operands"?.7:0),transition:"stroke-dashoffset 1.2s cubic-bezier(0.4, 0, 0.2, 1)"}})]})}function sfe({progress:t,showControlMem:e,returnToOriginal:n}){const{opacity:i,pulseActive:r}=t1({opacity:t.to(s=>n||s===0?.4:s>0&&s<1?1:.4),pulseActive:t.to(s=>n?!1:e&&s>0&&s<1),config:{tension:280,friction:60,duration:300}});return h.jsx(Qe.span,{className:"flex size-4 items-center justify-center rounded-full bg-fuchsia-400 text-[10px] font-extrabold text-white shadow-[0_0_4px_rgba(232,121,249,0.6)]",style:{opacity:i,fontVariantNumeric:"tabular-nums",fontFamily:"monospace",transition:"opacity 0.3s ease-out"},title:"Lectura de microinstrucciones",children:h.jsx(Qe.span,{style:{animation:r.to(s=>s?"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite":"none")},children:"1"})})}function ofe({progress:t,showControlMem:e,returnToOriginal:n}){const{opacity:i,pulseActive:r}=t1({opacity:t.to(s=>n||s===0?.4:s>0&&s<1?1:(s>=1,.4)),pulseActive:t.to(s=>n?!1:e&&s>0&&s<1),config:{tension:280,friction:60,duration:300}});return h.jsx(Qe.span,{className:"flex size-4 items-center justify-center rounded-full bg-sky-400 text-[10px] font-extrabold text-white shadow-[0_0_4px_rgba(56,189,248,0.6)]",style:{opacity:i,fontVariantNumeric:"tabular-nums",fontFamily:"monospace",transition:"opacity 0.3s ease-out"},title:"Envío de señales de control",children:h.jsx(Qe.span,{style:{animation:r.to(s=>s?"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite":"none")},children:"2"})})}function afe({progress:t,phase:e,memAnimKey:n,resetAnimations:i,returnToOriginal:r}){const{opacity:s,filterIntensity:o}=t1({opacity:t.to(a=>r||a===0?.4:a>0&&a<1?1:.4),filterIntensity:t.to(a=>r||a===0?.25:a>0&&a<1?.6:.25),config:{tension:280,friction:60,duration:300}});return h.jsx(Qe.div,{style:{opacity:s,filter:o.to(a=>`drop-shadow(0 0 ${8*a}px rgba(232,121,249,${a}))`),transition:"opacity 0.3s ease-out, filter 0.3s ease-out"},children:h.jsxs("svg",{width:"70",height:"38",viewBox:"0 0 70 38",className:"mb-0.5",children:[h.jsx("rect",{x:"8",y:"6",width:"54",height:"26",rx:"4",fill:"#a21caf",stroke:"#e879f9",strokeWidth:"2"}),Array.from({length:4}).map((a,l)=>h.jsx("rect",{x:2,y:9+l*6,width:6,height:2,rx:1,fill:"#e879f9"},l)),Array.from({length:4}).map((a,l)=>h.jsx("rect",{x:62,y:9+l*6,width:6,height:2,rx:1,fill:"#e879f9"},l)),h.jsx(rfe,{progress:t,phase:e,resetAnimations:i,returnToOriginal:r},n)]})})}function lfe(){const[t,e]=x.useState(0),[n,i]=x.useState(!1),[r,s]=x.useState(!1);x.useEffect(()=>{let d=0;const f=je("sequencer.progress.progress").to(p=>{d===0&&p>0&&(e(m=>m+1),i(!1),s(!1)),d>0&&p===0&&(e(m=>m+1),i(!0),setTimeout(()=>{s(!0)},100),setTimeout(()=>i(!1),100)),d=p});return()=>{typeof f=="function"&&f()}},[]);const o=cn(),a=tt(Hn),[l,c]=x.useState(!1),[,u]=x.useState(!1);return x.useEffect(()=>{let d=null;u(!1);let f;return l?f=je("sequencer.progress.progress").to(p=>{p>=.5?d=setTimeout(()=>{u(!0)},500):(d&&clearTimeout(d),u(!1))}):u(!1),()=>{d&&clearTimeout(d),typeof f=="function"&&f()}},[l]),h.jsxs(h.Fragment,{children:[h.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[h.jsx(Qe.path,{d:"M 250 310 V 320",className:"fill-none stroke-mantis-400 stroke-[3px] drop-shadow-[0_0_8px_rgba(34,197,94,0.6)]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:je("cpu.decoder.path")}),h.jsx(Qe.path,{d:"M 250 310 V 320",className:"fill-none stroke-mantis-300 stroke-1 opacity-50",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:je("cpu.decoder.path")})]}),h.jsx("div",{className:"absolute bottom-[172px] left-[30px] flex w-full items-start",children:h.jsx("span",{className:"block w-min whitespace-nowrap rounded-t-lg border border-b-0 border-stone-600 bg-mantis-500 px-2 pb-3 pt-1 text-xs tracking-wide text-white",children:o("computer.cpu.control-unit")})}),h.jsxs("div",{className:"absolute bottom-[17px] left-[30px] flex h-[160px] w-[350px] flex-col items-center rounded-lg border border-stone-600 bg-stone-800",children:[h.jsx("div",{className:"min-w-[180px] overflow-hidden rounded-b-lg border border-t-0 border-stone-600 bg-stone-900 px-3 py-1",children:h.jsxs("div",{style:{position:"relative",left:0},children:[h.jsx("div",{className:"flex items-center justify-between",children:h.jsxs("div",{style:{position:"relative",left:0,display:"flex",alignItems:"center"},children:[h.jsx("span",{className:"text-sm leading-none",children:o("computer.cpu.decoder")}),h.jsx("button",{type:"button","aria-label":l?"Ocultar memoria de control":"Mostrar memoria de control",className:"ml-2 flex size-6 items-center justify-center rounded-lg bg-gradient-to-r from-mantis-600 to-mantis-500 text-white shadow-lg transition-all duration-300 hover:from-mantis-500 hover:to-mantis-400 focus:outline-none focus:ring-2 focus:ring-mantis-400",style:{fontSize:"1.2em",lineHeight:1,padding:0,minWidth:0,minHeight:0,transform:l?"rotate(180deg)":"rotate(0deg)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:l?"0 4px 12px rgba(34,197,94,0.4)":"0 2px 8px rgba(34,197,94,0.2)"},onClick:()=>c(d=>!d),children:h.jsx("span",{style:{fontWeight:"bold",transform:l?"scale(0.8)":"scale(1)",transition:"transform 0.2s ease-out"},children:l?"−":"+"})})]})}),h.jsx("div",{className:"my-1 h-1 w-full overflow-hidden rounded-full bg-stone-600",children:h.jsx(Qe.div,{className:"h-full bg-sky-400",style:{width:je("sequencer.progress.progress").to(d=>`${d*100}%`),opacity:je("sequencer.progress.opacity")}})}),h.jsx("div",{className:"flex w-full justify-center",children:l&&h.jsx("div",{className:"flex min-w-[120px] flex-col items-center",children:h.jsxs("div",{className:"flex flex-row items-start gap-4",children:[h.jsxs("div",{className:"flex min-w-[90px] flex-col items-center",children:[h.jsxs("span",{className:"mb-0.5 flex items-center gap-1 text-center text-[10px] font-bold tracking-wide text-fuchsia-100 drop-shadow-[0_0_6px_rgba(232,121,249,0.6)]",style:{minHeight:"18px"},children:[h.jsx(sfe,{progress:je("sequencer.progress.progress"),showControlMem:l,returnToOriginal:r}),"Memoria de control"]}),h.jsx(afe,{progress:je("sequencer.progress.progress"),phase:a==null?void 0:a.phase,memAnimKey:t,resetAnimations:n,returnToOriginal:r})]}),h.jsxs("div",{className:"flex min-w-[90px] flex-col items-center",children:[h.jsxs("span",{className:"mb-0.5 flex items-center gap-1 text-center text-[10px] font-bold tracking-wide text-sky-100 drop-shadow-[0_0_6px_rgba(56,189,248,0.6)]",style:{minHeight:"18px"},children:[h.jsx(ofe,{progress:je("sequencer.progress.progress"),showControlMem:l,returnToOriginal:r}),"Secuenciador"]}),h.jsx(ife,{progress:je("sequencer.progress.progress"),phase:a==null?void 0:a.phase,memAnimKey:t,resetAnimations:n,returnToOriginal:r})]})]})})}),h.jsx("div",{className:"flex w-full justify-center",style:{maxHeight:l?90:0,opacity:l?1:0,transform:l?"translateY(0)":"translateY(-10px)",transition:"max-height 0.6s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s ease-out, transform 0.5s ease-out",overflow:"hidden"}})]})}),h.jsx("div",{className:"flex w-full flex-1 items-start justify-center p-0.5",children:h.jsx("div",{className:"w-[220px] max-w-[220px]",children:h.jsx("div",{className:"mb-0 p-0.5",children:h.jsx("div",{className:"min-w-0 flex-1 text-center",children:a&&"metadata"in a&&a.metadata?h.jsxs("div",{className:"text-xs text-stone-300",children:[h.jsx("div",{className:"mb-1 flex justify-center",children:h.jsx("div",{className:`
                          flex min-h-[20px] items-center justify-center whitespace-nowrap rounded-md border
                          border-stone-600 px-3 py-1 text-[11px] font-bold uppercase tracking-wide
                          transition-all duration-300 ease-in-out
                          ${(()=>{switch(a.phase){case"fetching":return"bg-gradient-to-r from-blue-600/80 to-blue-500/80 text-blue-100 shadow-[0_0_8px_rgba(59,130,246,0.3)]";case"fetching-operands":return"bg-gradient-to-r from-yellow-600/80 to-yellow-500/80 text-yellow-100 shadow-[0_0_8px_rgba(234,179,8,0.3)]";case"fetching-operands-completed":return"bg-gradient-to-r from-yellow-600/80 to-yellow-500/80 text-yellow-100 shadow-[0_0_8px_rgba(234,179,8,0.3)]";case"executing":return"bg-gradient-to-r from-mantis-600/80 to-mantis-500/80 text-mantis-100 shadow-[0_0_8px_rgba(34,197,94,0.3)]";case"writeback":return"bg-gradient-to-r from-purple-600/80 to-purple-500/80 text-purple-100 shadow-[0_0_8px_rgba(147,51,234,0.3)]";case"interrupt":return"bg-gradient-to-r from-red-600/80 to-red-500/80 text-red-100 shadow-[0_0_8px_rgba(239,68,68,0.3)]";case"halting":return"bg-gradient-to-r from-red-600/80 to-red-500/80 text-red-100 shadow-[0_0_8px_rgba(239,68,68,0.3)]";default:return"bg-gradient-to-r from-stone-600/80 to-stone-500/80 text-stone-100 shadow-[0_0_8px_rgba(120,113,108,0.3)]"}})()}
                        `,children:(()=>{switch(a.phase){case"fetching":return"Captación";case"fetching-operands":return"Obtención de operandos";case"fetching-operands-completed":return"Operandos obtenidos";case"executing":return"Ejecución";case"writeback":return"Escritura";case"interrupt":return"Interrupción";case"halting":return"Detener CPU";default:return"Procesando"}})()})}),h.jsxs("div",{className:"truncate text-center",children:[h.jsx("span",{className:"font-mono text-mantis-300",children:a.metadata.name}),a.metadata.operands.length>0&&h.jsxs("span",{className:"text-white",children:[" ",a.metadata.operands.join(", ")]})]})]}):h.jsx("div",{className:"text-xs text-stone-500",children:(a==null?void 0:a.phase)==="stopped"?"CPU detenida":"Esperando..."})})})})})]})]})}function cfe(){const[t,e]=x.useState(!1),[n,i]=x.useState(0);return x.useEffect(()=>{const r=()=>{e(!0),i(a=>a+1);const o=nt().executionUnit*10;setTimeout(()=>{e(!1)},o)};return window.addEventListener("ip-register-update",r),()=>{window.removeEventListener("ip-register-update",r)}},[]),t?h.jsxs(h.Fragment,{children:[h.jsx("style",{children:`
        @keyframes slideUpAndFade {
          0% {
            opacity: 1;
            transform: translateY(0px);
          }
          30% {
            opacity: 1;
            transform: translateY(-20px);
          }
          70% {
            opacity: 1;
            transform: translateY(-20px);
          }
          100% {
            opacity: 0;
            transform: translateY(-40px);
          }
        }
      `}),nt().animations&&h.jsx("div",{className:re("pointer-events-none absolute left-[435px] top-[332px]","font-mono text-xs font-bold"),style:{color:"#ff6347",animation:`slideUpAndFade ${nt().executionUnit*10}ms ease-out forwards`},children:"+1"},n)]}):null}function ufe(){const[t,e]=x.useState(!1),[n,i]=x.useState(0),[r,s]=x.useState("+1");return x.useEffect(()=>{const o=a=>{s(a.detail.type),e(!0),i(u=>u+1);const c=nt().executionUnit*10;setTimeout(()=>{e(!1)},c)};return window.addEventListener("sp-register-update",o),()=>{window.removeEventListener("sp-register-update",o)}},[]),t?h.jsx(h.Fragment,{children:nt().animations&&h.jsx("div",{className:re("pointer-events-none absolute left-[435px] top-[292px]","font-mono text-xs font-bold"),style:{color:"#facc15",animation:`slideUpAndFade ${nt().executionUnit*10}ms ease-out forwards`},children:r},n)}):null}function dfe(){const t=cn(),e=tt(jb),[n,i]=x.useState(!1),[r,s]=x.useState(!1),[o,a]=x.useState(!1);return x.useEffect(()=>{const l=(u,d,f)=>{a(u==="ADD"||u==="SUB"||u==="CMP"||u==="AND"||u==="OR"||u==="XOR"||u==="NOT"||u==="NEG"||u==="DEC"||u==="INC"),i(!!d),s(!!f)},c=u=>{const d=u;l(d.detail.instruction,d.detail.modeid,d.detail.moderi)};return window.addEventListener("instructionChange",c),()=>{window.removeEventListener("instructionChange",c)}},[]),h.jsxs("div",{"data-testid":"cpu-component",className:"absolute left-0 top-0 z-10 h-[500px] w-[650px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-3xl text-white",children:t("computer.cpu.name")}),h.jsx(Tse,{showSP:e,showri:r}),h.jsx(Nse,{showSP:e,showid:n,showri:r}),o&&h.jsxs(h.Fragment,{children:[h.jsx(Hi,{name:"left",className:re("left-[96px] top-[49px]","border-transparent","bg-transparent")}),h.jsx(Hi,{name:"right",className:re("left-[96px] top-[150px]","border-transparent","bg-transparent")}),h.jsx(Hi,{name:"result",className:re("left-[280px] top-[79px]","border-transparent","bg-transparent")})]}),h.jsx(nfe,{}),h.jsxs("div",{className:"absolute left-[450px] top-[30px] z-10",children:[h.jsx(Hi,{name:"AL",emphasis:!0,className:""}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-emerald-400 bg-emerald-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-emerald-400",children:"AL"})]}),h.jsxs("div",{className:"absolute left-[450px] top-[70px] z-10",children:[h.jsx(Hi,{name:"BL",emphasis:!0,className:""}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-emerald-400 bg-emerald-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-emerald-400",children:"BL"})]}),h.jsxs("div",{className:"absolute left-[450px] top-[110px] z-10",children:[h.jsx(Hi,{name:"CL",emphasis:!0,className:""}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-emerald-400 bg-emerald-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-emerald-400",children:"CL"})]}),h.jsxs("div",{className:"absolute left-[450px] top-[150px] z-10",children:[h.jsx(Hi,{name:"DL",emphasis:!0,className:""}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-emerald-400 bg-emerald-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-emerald-400",children:"DL"})]}),n&&h.jsxs("div",{className:"absolute left-[450px] top-[190px] z-10",children:[h.jsx(Hi,{name:"id",className:"border-cyan-400 pt-1"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-cyan-400 bg-cyan-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-cyan-400",children:"id"})]}),h.jsxs("div",{className:"absolute left-[450px] top-[332px] z-10",children:[h.jsx(Hi,{name:"IP",emphasis:!0,className:"border-red-500"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-red-500 bg-red-800 px-1 py-0 font-mono text-[10px] font-bold tracking-widest text-red-200",style:{textShadow:"0 1px 4px #000, 0 0px 2px #fff4"},children:"IP"})]}),h.jsxs("div",{className:"absolute left-[594px] top-[332px] z-10",children:[h.jsx(Hi,{name:"MAR",className:"border-indigo-400"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-indigo-400 bg-indigo-800 px-1 py-0 font-mono text-[10px] font-bold tracking-widest text-indigo-200",style:{textShadow:"0 1px 4px #000, 0 0px 2px #fff4"},children:"MAR"})]}),h.jsxs("div",{className:"absolute left-[594px] top-[233px] z-10",children:[h.jsx(Hi,{name:"MBR",className:"border-indigo-400"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-indigo-400 bg-indigo-800 px-1 py-0 font-mono text-[10px] font-bold tracking-widest text-indigo-200",style:{textShadow:"0 1px 4px #000, 0 0px 2px #fff4"},children:"MBR"})]}),h.jsxs("div",{className:"absolute left-[230px] top-[270px] z-10",children:[h.jsx(Hi,{name:"IR",className:"border-indigo-400"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-indigo-400 bg-indigo-800 px-1 py-0 font-mono text-[10px] font-bold tracking-widest text-indigo-200",style:{textShadow:"0 1px 4px #000, 0 0px 2px #fff4"},children:"IR"})]}),h.jsx(lfe,{}),e&&h.jsxs("div",{className:"absolute left-[450px] top-[292px] z-10",children:[h.jsx(Hi,{name:"SP",emphasis:!0,className:"border-yellow-400 pt-2"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-yellow-400 bg-yellow-800 px-1 py-0 font-mono text-[10px] font-bold tracking-widest text-yellow-200",style:{textShadow:"0 1px 4px #000, 0 0px 2px #fff4"},children:"SP"})]}),r&&h.jsxs("div",{className:"absolute left-[450px] top-[372px] z-10",children:[h.jsx(Hi,{name:"ri",emphasis:!0,className:"border-cyan-400"}),h.jsx("span",{className:"absolute left-0 top-0 z-30 select-none rounded-full border border-cyan-400 bg-cyan-800 px-1 py-0 font-mono text-xs font-bold tracking-widest text-cyan-400",children:"ri"})]}),h.jsx(cfe,{}),h.jsx(ufe,{})]})}function Hi({name:t,emphasis:e,className:n}){const i=r=>`cpu.${r}`;return h.jsx(Ar,{name:t,valueAtom:he[t],springs:i(t),emphasis:e,className:re("absolute",n)})}const vz=x.memo(({className:t})=>{const e=cn(),n=tt(af),i=tt(zp),r=tt(Bl),[s]=Oo(),[o,a]=x.useState(!1),c=1e3/s.cpuSpeed;if(!s.showStatsCPU)return null;const u=r>0?(i/r).toFixed(2):"-",d=i*c,f=c/1e3,p=()=>n===0?"📊":r===0?"⏸️":"⚡",m=()=>n===0?"text-stone-400":r===0?"text-yellow-400":"text-mantis-400",g=h.jsxs("div",{className:"space-y-3 text-xs",children:[h.jsxs("div",{children:[h.jsx("strong",{className:"text-mantis-300",children:"CPI (Ciclos por Instrucción):"}),h.jsx("br",{}),h.jsx("span",{className:"text-stone-300",children:"Métrica fundamental que indica la eficiencia del procesador. Calculada como el cociente entre ciclos totales e instrucciones ejecutadas. Un CPI más bajo significa mejor rendimiento."})]}),h.jsxs("div",{children:[h.jsx("strong",{className:"text-mantis-300",children:"Tiempo de CPU:"}),h.jsx("br",{}),h.jsx("span",{className:"text-stone-300",children:"Tiempo real transcurrido durante la ejecución del programa. Se calcula multiplicando los ciclos totales por el tiempo de cada ciclo según la velocidad configurada."})]})]}),y=h.jsxs("div",{className:"space-y-3 text-xs",children:[h.jsxs("div",{children:[h.jsx("strong",{className:"text-mantis-300",children:"Velocidad CPU (Hz):"}),h.jsx("br",{}),h.jsx("span",{className:"text-stone-300",children:"Frecuencia del reloj del procesador que determina la velocidad de ejecución. Cada ciclo de reloj ejecuta una microoperación del procesador."})]}),h.jsxs("div",{children:[h.jsx("strong",{className:"text-mantis-300",children:"Tiempo por Ciclo:"}),h.jsx("br",{}),h.jsx("span",{className:"text-stone-300",children:"Duración de cada ciclo calculada como 1/velocidad. Por ejemplo, 1 MHz = 1 microsegundo por ciclo."})]})]});return h.jsxs("div",{className:re("flex flex-col gap-2 rounded-lg border border-stone-600 bg-stone-900/95 p-3 shadow-lg","min-w-[300px] max-w-[350px]",t),children:[h.jsx("div",{className:"flex items-center justify-between",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-sm font-bold uppercase tracking-wide text-mantis-400",children:e("computer.cpu.stats")}),h.jsx("button",{onClick:()=>a(!o),className:re("rounded px-2 py-1 text-xs transition-colors",o?"bg-mantis-400/20 text-mantis-400":"text-stone-400 hover:bg-mantis-400/10 hover:text-mantis-400"),children:o?"−":"+"})]})}),h.jsxs("div",{className:"flex items-center gap-3 rounded border border-stone-600 bg-stone-800/80 p-2",children:[h.jsx("div",{className:re("text-2xl",m()),children:p()}),h.jsxs("div",{className:"flex-1",children:[h.jsx("div",{className:re("text-sm font-semibold",m()),children:n>0?"Ejecutando":"En espera"}),h.jsx("div",{className:"mt-1 text-xs text-stone-400",children:r>0?`${r} instrucciones ejecutadas`:"Sin instrucciones ejecutadas"})]})]}),o&&h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"rounded border border-stone-600 bg-stone-800/80 p-2",children:[h.jsx("div",{className:"mb-2 text-xs font-bold text-mantis-400",children:"Métricas principales:"}),h.jsx("div",{className:"mb-2 text-xs text-stone-400",children:"Estadísticas acumuladas del programa completo"}),h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-xs text-stone-300",children:"Ciclos totales del programa"}),h.jsx("div",{className:"font-mono text-lg text-white",children:i})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-xs text-stone-300",children:e("computer.cpu.instruction-count")}),h.jsx("div",{className:"font-mono text-lg text-white",children:r})]})]})]}),h.jsxs("div",{className:"rounded border border-stone-600 bg-stone-800/80 p-2",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[h.jsx("span",{className:"text-xs font-bold text-mantis-400",children:"Métricas de Rendimiento:"}),h.jsx(rs,{content:g,position:"top",maxWidth:400,className:"text-stone-400 transition-colors hover:text-mantis-400",children:h.jsx("button",{className:"text-xs transition-transform hover:scale-110",children:"💡"})})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("span",{className:"text-xs text-stone-300",title:e("computer.cpu.cpi-help"),children:[e("computer.cpu.cpi"),":"]}),h.jsx("span",{className:"font-mono text-sm text-mantis-300",children:u})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-xs text-stone-300",title:`${e("computer.cpu.cpu-time-help")} (${f.toFixed(1)} s)`,children:e("computer.cpu.cpu-time")}),h.jsxs("span",{className:"font-mono text-sm text-mantis-300",children:[(d/1e3).toFixed(1)," s"]})]})]})]}),h.jsxs("div",{className:"rounded border border-stone-600 bg-stone-800/80 p-2",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[h.jsx("span",{className:"text-xs font-bold text-mantis-400",children:"Configuración Actual:"}),h.jsx(rs,{content:y,position:"top",maxWidth:400,className:"text-stone-400 transition-colors hover:text-mantis-400",children:h.jsx("button",{className:"text-xs transition-transform hover:scale-110",children:"⚙️"})})]}),h.jsx("div",{className:"space-y-1 text-xs text-stone-300",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-stone-300",children:h.jsx("strong",{children:"Velocidad CPU:"})}),h.jsxs("span",{className:"font-mono text-mantis-300",children:[s.cpuSpeed," Hz (",f.toFixed(1)," s/ciclo)"]})]})})]})]})]})});vz.displayName="CPUStats";const ffe="_pushable_1qx3l_2",hfe="_front_1qx3l_15",pfe="_shadow_1qx3l_20",mfe="_edge_1qx3l_52",d0={pushable:ffe,front:hfe,shadow:pfe,edge:mfe};function gfe(){const t=cn(),{status:e,dispatch:n,devices:i}=Kn();return Du("F10",r=>{r.preventDefault(),i.f10&&n("f10.press")},void 0,[n,i.f10]),i.f10?h.jsx("div",{className:"absolute left-[10px] top-[950px] z-10 flex h-min w-28 flex-col rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:h.jsxs("button",{className:d0.pushable,disabled:e.type!=="running",onClick:()=>n("f10.press"),children:[h.jsx("div",{className:d0.shadow}),h.jsx("div",{className:d0.edge}),h.jsx("span",{className:d0.front,children:t("computer.f10")})]})}):null}function vfe(){const t=cn(),{devices:e}=Kn();return e.handshake?h.jsxs("div",{className:"absolute left-[900px] top-[925px] z-10 h-min w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block size-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.handshake.name")}),h.jsx(Ar,{name:t("computer.handshake.state"),title:t("generics.io-register","STATE",65),valueAtom:GE,springs:"handshake.STATE",className:"mx-auto my-4"}),h.jsx("hr",{className:"border-stone-600"}),h.jsx(Ar,{name:t("computer.handshake.data"),title:t("generics.io-register","DATA",64),valueAtom:WE,springs:"handshake.DATA",className:"mx-auto my-4"})]}):null}var yz={exports:{}};/*!
 * 
 *   react-simple-keyboard v3.8.89 (index.modern.js - Modern Browsers bundle)
 *   https://github.com/hodgef/react-simple-keyboard
 *
 *   NOTE: This modern browsers bundle (index.modern.js) removes all polyfills
 *   included in the standard version. Use this if you are supporting
 *   modern browsers only. Otherwise, use the standard version (index.js).
 *
 *   Copyright (c) Francisco Hodge (https://github.com/hodgef) and project contributors.
 *
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */(function(t,e){(function(n,i){t.exports=i(x)})(l7,function(n){return function(){var i={442:function(a){a.exports=n},651:function(a){a.exports=function(){var l={d:function(z,$){for(var W in $)l.o($,W)&&!l.o(z,W)&&Object.defineProperty(z,W,{enumerable:!0,get:$[W]})},o:function(z,$){return Object.prototype.hasOwnProperty.call(z,$)},r:function(z){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(z,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(z,"__esModule",{value:!0})}},c={};function u(z){return function($){if(Array.isArray($))return f($)}(z)||function($){if(typeof Symbol<"u"&&$[Symbol.iterator]!=null||$["@@iterator"]!=null)return Array.from($)}(z)||d(z)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function d(z,$){if(z){if(typeof z=="string")return f(z,$);var W={}.toString.call(z).slice(8,-1);return W==="Object"&&z.constructor&&(W=z.constructor.name),W==="Map"||W==="Set"?Array.from(z):W==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(W)?f(z,$):void 0}}function f(z,$){($==null||$>z.length)&&($=z.length);for(var W=0,S=Array($);W<$;W++)S[W]=z[W];return S}function p(z){return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},p(z)}function m(z,$){for(var W=0;W<$.length;W++){var S=$[W];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(z,y(S.key),S)}}function g(z,$,W){return($=y($))in z?Object.defineProperty(z,$,{value:W,enumerable:!0,configurable:!0,writable:!0}):z[$]=W,z}function y(z){var $=function(W,S){if(p(W)!="object"||!W)return W;var T=W[Symbol.toPrimitive];if(T!==void 0){var j=T.call(W,S);if(p(j)!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(W)}(z,"string");return p($)=="symbol"?$:$+""}l.r(c),l.d(c,{SimpleKeyboard:function(){return Q},default:function(){return ae}});var v=function(){return z=function S(T){var j=T.getOptions,D=T.getCaretPosition,Y=T.getCaretPositionEnd,q=T.dispatch;(function(oe,ee){if(!(oe instanceof ee))throw new TypeError("Cannot call a class as a function")})(this,S),g(this,"getOptions",void 0),g(this,"getCaretPosition",void 0),g(this,"getCaretPositionEnd",void 0),g(this,"dispatch",void 0),g(this,"maxLengthReached",void 0),g(this,"isStandardButton",function(oe){return oe&&!(oe[0]==="{"&&oe[oe.length-1]==="}")}),this.getOptions=j,this.getCaretPosition=D,this.getCaretPositionEnd=Y,this.dispatch=q,S.bindMethods(S,this)},$=[{key:"getButtonType",value:function(S){return S.includes("{")&&S.includes("}")&&S!=="{//}"?"functionBtn":"standardBtn"}},{key:"getButtonClass",value:function(S){var T=this.getButtonType(S),j=S.replace("{","").replace("}",""),D="";return T!=="standardBtn"&&(D=" hg-button-".concat(j)),"hg-".concat(T).concat(D)}},{key:"getDefaultDiplay",value:function(){return{"{bksp}":"backspace","{backspace}":"backspace","{enter}":"< enter","{shift}":"shift","{shiftleft}":"shift","{shiftright}":"shift","{alt}":"alt","{s}":"shift","{tab}":"tab","{lock}":"caps","{capslock}":"caps","{accept}":"Submit","{space}":" ","{//}":" ","{esc}":"esc","{escape}":"esc","{f1}":"f1","{f2}":"f2","{f3}":"f3","{f4}":"f4","{f5}":"f5","{f6}":"f6","{f7}":"f7","{f8}":"f8","{f9}":"f9","{f10}":"f10","{f11}":"f11","{f12}":"f12","{numpaddivide}":"/","{numlock}":"lock","{arrowup}":"↑","{arrowleft}":"←","{arrowdown}":"↓","{arrowright}":"→","{prtscr}":"print","{scrolllock}":"scroll","{pause}":"pause","{insert}":"ins","{home}":"home","{pageup}":"up","{delete}":"del","{forwarddelete}":"del","{end}":"end","{pagedown}":"down","{numpadmultiply}":"*","{numpadsubtract}":"-","{numpadadd}":"+","{numpadenter}":"enter","{period}":".","{numpaddecimal}":".","{numpad0}":"0","{numpad1}":"1","{numpad2}":"2","{numpad3}":"3","{numpad4}":"4","{numpad5}":"5","{numpad6}":"6","{numpad7}":"7","{numpad8}":"8","{numpad9}":"9"}}},{key:"getButtonDisplayName",value:function(S,T){return(T=arguments.length>2&&arguments[2]!==void 0&&arguments[2]?Object.assign({},this.getDefaultDiplay(),T):T||this.getDefaultDiplay())[S]||S}},{key:"getUpdatedInput",value:function(S,T,j){var D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:j,Y=arguments.length>4&&arguments[4]!==void 0&&arguments[4],q=this.getOptions(),oe=[j,D,Y],ee=T;return(S==="{bksp}"||S==="{backspace}")&&ee.length>0?ee=this.removeAt.apply(this,[ee].concat(oe)):(S==="{delete}"||S==="{forwarddelete}")&&ee.length>0?ee=this.removeForwardsAt.apply(this,[ee].concat(oe)):S==="{space}"?ee=this.addStringAt.apply(this,[ee," "].concat(oe)):S!=="{tab}"||typeof q.tabCharOnTab=="boolean"&&q.tabCharOnTab===!1?S!=="{enter}"&&S!=="{numpadenter}"||!q.newLineOnEnter?S.includes("numpad")&&Number.isInteger(Number(S[S.length-2]))?ee=this.addStringAt.apply(this,[ee,S[S.length-2]].concat(oe)):S==="{numpaddivide}"?ee=this.addStringAt.apply(this,[ee,"/"].concat(oe)):S==="{numpadmultiply}"?ee=this.addStringAt.apply(this,[ee,"*"].concat(oe)):S==="{numpadsubtract}"?ee=this.addStringAt.apply(this,[ee,"-"].concat(oe)):S==="{numpadadd}"?ee=this.addStringAt.apply(this,[ee,"+"].concat(oe)):S==="{numpaddecimal}"?ee=this.addStringAt.apply(this,[ee,"."].concat(oe)):S==="{"||S==="}"?ee=this.addStringAt.apply(this,[ee,S].concat(oe)):S.includes("{")||S.includes("}")||(ee=this.addStringAt.apply(this,[ee,S].concat(oe))):ee=this.addStringAt.apply(this,[ee,`
`].concat(oe)):ee=this.addStringAt.apply(this,[ee,"	"].concat(oe)),q.debug&&console.log("Input will be: "+ee),ee}},{key:"updateCaretPos",value:function(S){var T=arguments.length>1&&arguments[1]!==void 0&&arguments[1],j=this.updateCaretPosAction(S,T);this.dispatch(function(D){D.setCaretPosition(j)})}},{key:"updateCaretPosAction",value:function(S){var T=arguments.length>1&&arguments[1]!==void 0&&arguments[1],j=this.getOptions(),D=this.getCaretPosition();return D!=null&&(T?D>0&&(D-=S):D+=S),j.debug&&console.log("Caret at:",D),D}},{key:"addStringAt",value:function(S,T){var j,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:S.length,Y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:S.length,q=arguments.length>4&&arguments[4]!==void 0&&arguments[4];return D||D===0?(j=[S.slice(0,D),T,S.slice(Y)].join(""),this.isMaxLengthReached()||q&&this.updateCaretPos(T.length)):j=S+T,j}},{key:"removeAt",value:function(S){var T,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S.length,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:S.length,Y=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(j===0&&D===0)return S;if(j===D){var q=/([\uD800-\uDBFF][\uDC00-\uDFFF])/g;j&&j>=0?S.substring(j-2,j).match(q)?(T=S.substr(0,j-2)+S.substr(j),Y&&this.updateCaretPos(2,!0)):(T=S.substr(0,j-1)+S.substr(j),Y&&this.updateCaretPos(1,!0)):S.slice(-2).match(q)?(T=S.slice(0,-2),Y&&this.updateCaretPos(2,!0)):(T=S.slice(0,-1),Y&&this.updateCaretPos(1,!0))}else T=S.slice(0,j)+S.slice(D),Y&&this.dispatch(function(oe){oe.setCaretPosition(j)});return T}},{key:"removeForwardsAt",value:function(S){var T,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S.length,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:S.length,Y=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return S!=null&&S.length&&j!==null?(j===D?T=S.substring(j,j+2).match(/([\uD800-\uDBFF][\uDC00-\uDFFF])/g)?S.substr(0,j)+S.substr(j+2):S.substr(0,j)+S.substr(j+1):(T=S.slice(0,j)+S.slice(D),Y&&this.dispatch(function(q){q.setCaretPosition(j)})),T):S}},{key:"handleMaxLength",value:function(S,T){var j=this.getOptions(),D=j.maxLength,Y=S[j.inputName||"default"],q=T.length-1>=D;if(T.length<=Y.length)return!1;if(Number.isInteger(D))return j.debug&&console.log("maxLength (num) reached:",q),q?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1);if(p(D)==="object"){var oe=T.length-1>=D[j.inputName||"default"];return j.debug&&console.log("maxLength (obj) reached:",oe),oe?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1)}}},{key:"isMaxLengthReached",value:function(){return!!this.maxLengthReached}},{key:"isTouchDevice",value:function(){return"ontouchstart"in window||navigator.maxTouchPoints}},{key:"pointerEventsSupported",value:function(){return!!window.PointerEvent}},{key:"camelCase",value:function(S){return S?S.toLowerCase().trim().split(/[.\-_\s]/g).reduce(function(T,j){return j.length?T+j[0].toUpperCase()+j.slice(1):T}):""}},{key:"chunkArray",value:function(S,T){return u(Array(Math.ceil(S.length/T))).map(function(j,D){return S.slice(T*D,T+T*D)})}},{key:"escapeRegex",value:function(S){return S.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},{key:"getRtlOffset",value:function(S,T){var j=S,D=T.indexOf("‫");return D<S&&D!=-1&&j--,T.indexOf("‬")<S&&D!=-1&&j--,j<0?0:j}},{key:"isConstructor",value:function(S){try{Reflect.construct(String,[],S)}catch{return!1}return!0}}],W=[{key:"bindMethods",value:function(S,T){var j,D=function(q,oe){var ee=typeof Symbol<"u"&&q[Symbol.iterator]||q["@@iterator"];if(!ee){if(Array.isArray(q)||(ee=d(q))||oe){ee&&(q=ee);var Oe=0,We=function(){};return{s:We,n:function(){return Oe>=q.length?{done:!0}:{done:!1,value:q[Oe++]}},e:function(we){throw we},f:We}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Xe,Ve=!0,ot=!1;return{s:function(){ee=ee.call(q)},n:function(){var we=ee.next();return Ve=we.done,we},e:function(we){ot=!0,Xe=we},f:function(){try{Ve||ee.return==null||ee.return()}finally{if(ot)throw Xe}}}}(Object.getOwnPropertyNames(S.prototype));try{for(D.s();!(j=D.n()).done;){var Y=j.value;Y==="constructor"||Y==="bindMethods"||(T[Y]=T[Y].bind(T))}}catch(q){D.e(q)}finally{D.f()}}}],$&&m(z.prototype,$),W&&m(z,W),Object.defineProperty(z,"prototype",{writable:!1}),z;var z,$,W}();g(v,"noop",function(){});var b=v;function w(z){return w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},w(z)}function k(z,$){for(var W=0;W<$.length;W++){var S=$[W];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(z,E(S.key),S)}}function C(z,$,W){return($=E($))in z?Object.defineProperty(z,$,{value:W,enumerable:!0,configurable:!0,writable:!0}):z[$]=W,z}function E(z){var $=function(W,S){if(w(W)!="object"||!W)return W;var T=W[Symbol.toPrimitive];if(T!==void 0){var j=T.call(W,S);if(w(j)!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(W)}(z,"string");return w($)=="symbol"?$:$+""}var _=function(){return z=function S(T){var j=this,D=T.dispatch,Y=T.getOptions;(function(q,oe){if(!(q instanceof oe))throw new TypeError("Cannot call a class as a function")})(this,S),C(this,"getOptions",void 0),C(this,"dispatch",void 0),C(this,"isModifierKey",function(q){return q.altKey||q.ctrlKey||q.shiftKey||["Tab","CapsLock","Esc","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(q.code||q.key||j.keyCodeToKey(q==null?void 0:q.keyCode))}),this.dispatch=D,this.getOptions=Y,b.bindMethods(S,this)},$=[{key:"handleHighlightKeyDown",value:function(S){var T=this.getOptions();T.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(S)&&(S.preventDefault(),S.stopImmediatePropagation());var j=this.getSimpleKeyboardLayoutKey(S);this.dispatch(function(D){var Y,q,oe=D.getButtonElement(j),ee=D.getButtonElement("{".concat(j,"}"));if(oe)Y=oe,q=j;else{if(!ee)return;Y=ee,q="{".concat(j,"}")}var Oe,We,Xe,Ve,ot=function(Lt){Lt.style.background=T.physicalKeyboardHighlightBgColor||"#dadce4",Lt.style.color=T.physicalKeyboardHighlightTextColor||"black"};if(Y)if(Array.isArray(Y)){if(Y.forEach(function(Lt){return ot(Lt)}),T.physicalKeyboardHighlightPress)if(T.physicalKeyboardHighlightPressUsePointerEvents)(Oe=Y[0])===null||Oe===void 0||(We=Oe.onpointerdown)===null||We===void 0||We.call(Oe,S);else if(T.physicalKeyboardHighlightPressUseClick){var we;(we=Y[0])===null||we===void 0||we.click()}else D.handleButtonClicked(q,S)}else ot(Y),T.physicalKeyboardHighlightPress&&(T.physicalKeyboardHighlightPressUsePointerEvents?(Xe=Y)===null||Xe===void 0||(Ve=Xe.onpointerdown)===null||Ve===void 0||Ve.call(Xe,S):T.physicalKeyboardHighlightPressUseClick?Y.click():D.handleButtonClicked(q,S))})}},{key:"handleHighlightKeyUp",value:function(S){var T=this.getOptions();T.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(S)&&(S.preventDefault(),S.stopImmediatePropagation());var j=this.getSimpleKeyboardLayoutKey(S);this.dispatch(function(D){var Y,q,oe,ee=D.getButtonElement(j)||D.getButtonElement("{".concat(j,"}")),Oe=function(We){We.removeAttribute&&We.removeAttribute("style")};ee&&(Array.isArray(ee)?(ee.forEach(function(We){return Oe(We)}),T.physicalKeyboardHighlightPressUsePointerEvents&&((Y=ee[0])===null||Y===void 0||(q=Y.onpointerup)===null||q===void 0||q.call(Y,S))):(Oe(ee),T.physicalKeyboardHighlightPressUsePointerEvents&&(ee==null||(oe=ee.onpointerup)===null||oe===void 0||oe.call(ee,S))))})}},{key:"getSimpleKeyboardLayoutKey",value:function(S){var T,j="",D=S.code||S.key||this.keyCodeToKey(S==null?void 0:S.keyCode);return(j=D!=null&&D.includes("Numpad")||D!=null&&D.includes("Shift")||D!=null&&D.includes("Space")||D!=null&&D.includes("Backspace")||D!=null&&D.includes("Control")||D!=null&&D.includes("Alt")||D!=null&&D.includes("Meta")?S.code||"":S.key||this.keyCodeToKey(S==null?void 0:S.keyCode)||"").length>1?(T=j)===null||T===void 0?void 0:T.toLowerCase():j}},{key:"keyCodeToKey",value:function(S){return{8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Meta",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"NumpadMultiply",107:"NumpadAdd",109:"NumpadSubtract",110:"NumpadDecimal",111:"NumpadDivide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[S]||""}}],$&&k(z.prototype,$),W&&k(z,W),Object.defineProperty(z,"prototype",{writable:!1}),z;var z,$,W}();function A(z){return A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},A(z)}function R(z,$){for(var W=0;W<$.length;W++){var S=$[W];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(z,O(S.key),S)}}function L(z,$,W){return($=O($))in z?Object.defineProperty(z,$,{value:W,enumerable:!0,configurable:!0,writable:!0}):z[$]=W,z}function O(z){var $=function(W,S){if(A(W)!="object"||!W)return W;var T=W[Symbol.toPrimitive];if(T!==void 0){var j=T.call(W,S);if(A(j)!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(W)}(z,"string");return A($)=="symbol"?$:$+""}var I=function(){return z=function S(T){var j=T.utilities,D=T.options;(function(Y,q){if(!(Y instanceof q))throw new TypeError("Cannot call a class as a function")})(this,S),L(this,"utilities",void 0),L(this,"options",void 0),L(this,"candidateBoxElement",void 0),L(this,"pageIndex",0),L(this,"pageSize",void 0),this.utilities=j,this.options=D,b.bindMethods(S,this),this.pageSize=this.utilities.getOptions().layoutCandidatesPageSize||5},$=[{key:"destroy",value:function(){this.candidateBoxElement&&(this.candidateBoxElement.remove(),this.pageIndex=0)}},{key:"show",value:function(S){var T=this,j=S.candidateValue,D=S.targetElement,Y=S.onSelect;if(j&&j.length){var q=this.utilities.chunkArray(j.split(" "),this.pageSize);this.renderPage({candidateListPages:q,targetElement:D,pageIndex:this.pageIndex,nbPages:q.length,onItemSelected:function(oe,ee){Y(oe,ee),T.destroy()}})}}},{key:"renderPage",value:function(S){var T,j=this,D=S.candidateListPages,Y=S.targetElement,q=S.pageIndex,oe=S.nbPages,ee=S.onItemSelected;(T=this.candidateBoxElement)===null||T===void 0||T.remove(),this.candidateBoxElement=document.createElement("div"),this.candidateBoxElement.className="hg-candidate-box";var Oe=document.createElement("ul");Oe.className="hg-candidate-box-list",D[q].forEach(function(Tn){var lc,Vs=document.createElement("li"),Aa=function(){var Pa=new(j.options.useTouchEvents?TouchEvent:MouseEvent)("click");return Object.defineProperty(Pa,"target",{value:Vs}),Pa};Vs.className="hg-candidate-box-list-item",Vs.innerHTML=((lc=j.options.display)===null||lc===void 0?void 0:lc[Tn])||Tn,j.options.useTouchEvents?Vs.ontouchstart=function(Pa){return ee(Tn,Pa||Aa())}:Vs.onclick=function(){var Pa=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Aa();return ee(Tn,Pa)},Oe.appendChild(Vs)});var We=q>0,Xe=document.createElement("div");Xe.classList.add("hg-candidate-box-prev"),We&&Xe.classList.add("hg-candidate-box-btn-active");var Ve=function(){We&&j.renderPage({candidateListPages:D,targetElement:Y,pageIndex:q-1,nbPages:oe,onItemSelected:ee})};this.options.useTouchEvents?Xe.ontouchstart=Ve:Xe.onclick=Ve,this.candidateBoxElement.appendChild(Xe),this.candidateBoxElement.appendChild(Oe);var ot=q<oe-1,we=document.createElement("div");we.classList.add("hg-candidate-box-next"),ot&&we.classList.add("hg-candidate-box-btn-active");var Lt=function(){ot&&j.renderPage({candidateListPages:D,targetElement:Y,pageIndex:q+1,nbPages:oe,onItemSelected:ee})};this.options.useTouchEvents?we.ontouchstart=Lt:we.onclick=Lt,this.candidateBoxElement.appendChild(we),Y.prepend(this.candidateBoxElement)}}],$&&R(z.prototype,$),W&&R(z,W),Object.defineProperty(z,"prototype",{writable:!1}),z;var z,$,W}(),G=I;function B(z){return function($){if(Array.isArray($))return K($)}(z)||function($){if(typeof Symbol<"u"&&$[Symbol.iterator]!=null||$["@@iterator"]!=null)return Array.from($)}(z)||function($,W){if($){if(typeof $=="string")return K($,W);var S={}.toString.call($).slice(8,-1);return S==="Object"&&$.constructor&&(S=$.constructor.name),S==="Map"||S==="Set"?Array.from($):S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S)?K($,W):void 0}}(z)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function K(z,$){($==null||$>z.length)&&($=z.length);for(var W=0,S=Array($);W<$;W++)S[W]=z[W];return S}function J(z){return J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},J(z)}function ne(z,$){var W=Object.keys(z);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(z);$&&(S=S.filter(function(T){return Object.getOwnPropertyDescriptor(z,T).enumerable})),W.push.apply(W,S)}return W}function V(z,$){for(var W=0;W<$.length;W++){var S=$[W];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(z,se(S.key),S)}}function U(z,$,W){return($=se($))in z?Object.defineProperty(z,$,{value:W,enumerable:!0,configurable:!0,writable:!0}):z[$]=W,z}function se(z){var $=function(W,S){if(J(W)!="object"||!W)return W;var T=W[Symbol.toPrimitive];if(T!==void 0){var j=T.call(W,S);if(J(j)!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(W)}(z,"string");return J($)=="symbol"?$:$+""}var _e=function(){return z=function S(T,j){var D=this;if(function(Ve,ot){if(!(Ve instanceof ot))throw new TypeError("Cannot call a class as a function")}(this,S),U(this,"input",void 0),U(this,"options",void 0),U(this,"utilities",void 0),U(this,"caretPosition",void 0),U(this,"caretPositionEnd",void 0),U(this,"keyboardDOM",void 0),U(this,"keyboardPluginClasses",void 0),U(this,"keyboardDOMClass",void 0),U(this,"buttonElements",void 0),U(this,"currentInstanceName",void 0),U(this,"allKeyboardInstances",void 0),U(this,"keyboardInstanceNames",void 0),U(this,"isFirstKeyboardInstance",void 0),U(this,"physicalKeyboard",void 0),U(this,"modules",void 0),U(this,"activeButtonClass",void 0),U(this,"holdInteractionTimeout",void 0),U(this,"holdTimeout",void 0),U(this,"isMouseHold",void 0),U(this,"initialized",void 0),U(this,"candidateBox",void 0),U(this,"keyboardRowsDOM",void 0),U(this,"defaultName","default"),U(this,"activeInputElement",null),U(this,"handleParams",function(Ve,ot){var we,Lt,Tn;if(typeof Ve=="string")we=Ve.split(".").join(""),Lt=document.querySelector(".".concat(we)),Tn=ot;else if(Ve instanceof HTMLDivElement){if(!Ve.className)throw console.warn("Any DOM element passed as parameter must have a class."),new Error("KEYBOARD_DOM_CLASS_ERROR");we=Ve.className.split(" ")[0],Lt=Ve,Tn=ot}else we="simple-keyboard",Lt=document.querySelector(".".concat(we)),Tn=Ve;return{keyboardDOMClass:we,keyboardDOM:Lt,options:Tn}}),U(this,"getOptions",function(){return D.options}),U(this,"getCaretPosition",function(){return D.caretPosition}),U(this,"getCaretPositionEnd",function(){return D.caretPositionEnd}),U(this,"registerModule",function(Ve,ot){D.modules[Ve]||(D.modules[Ve]={}),ot(D.modules[Ve])}),U(this,"getKeyboardClassString",function(){for(var Ve=arguments.length,ot=new Array(Ve),we=0;we<Ve;we++)ot[we]=arguments[we];return[D.keyboardDOMClass].concat(ot).filter(function(Lt){return!!Lt}).join(" ")}),typeof window<"u"){var Y=this.handleParams(T,j),q=Y.keyboardDOMClass,oe=Y.keyboardDOM,ee=Y.options,Oe=ee===void 0?{}:ee;this.utilities=new b({getOptions:this.getOptions,getCaretPosition:this.getCaretPosition,getCaretPositionEnd:this.getCaretPositionEnd,dispatch:this.dispatch}),this.caretPosition=null,this.caretPositionEnd=null,this.keyboardDOM=oe,this.options=function(Ve){for(var ot=1;ot<arguments.length;ot++){var we=arguments[ot]!=null?arguments[ot]:{};ot%2?ne(Object(we),!0).forEach(function(Lt){U(Ve,Lt,we[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ve,Object.getOwnPropertyDescriptors(we)):ne(Object(we)).forEach(function(Lt){Object.defineProperty(Ve,Lt,Object.getOwnPropertyDescriptor(we,Lt))})}return Ve}({layoutName:"default",theme:"hg-theme-default",inputName:"default",preventMouseDownDefault:!1,enableLayoutCandidates:!0,excludeFromLayout:{}},Oe),this.keyboardPluginClasses="",b.bindMethods(S,this);var We=this.options.inputName,Xe=We===void 0?this.defaultName:We;if(this.input={},this.input[Xe]="",this.keyboardDOMClass=q,this.buttonElements={},window.SimpleKeyboardInstances||(window.SimpleKeyboardInstances={}),this.currentInstanceName=this.utilities.camelCase(this.keyboardDOMClass),window.SimpleKeyboardInstances[this.currentInstanceName]=this,this.allKeyboardInstances=window.SimpleKeyboardInstances,this.keyboardInstanceNames=Object.keys(window.SimpleKeyboardInstances),this.isFirstKeyboardInstance=this.keyboardInstanceNames[0]===this.currentInstanceName,this.physicalKeyboard=new _({dispatch:this.dispatch,getOptions:this.getOptions}),this.candidateBox=this.options.enableLayoutCandidates?new G({utilities:this.utilities,options:this.options}):null,!this.keyboardDOM)throw console.warn('".'.concat(q,'" was not found in the DOM.')),new Error("KEYBOARD_DOM_ERROR");this.render(),this.modules={},this.loadModules()}},$=[{key:"setCaretPosition",value:function(S){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S;this.caretPosition=S,this.caretPositionEnd=T}},{key:"getInputCandidates",value:function(S){var T=this,j=this.options,D=j.layoutCandidates,Y=j.layoutCandidatesCaseSensitiveMatch;if(!D||J(D)!=="object")return{};var q=Object.keys(D).filter(function(Oe){var We=S.substring(0,T.getCaretPositionEnd()||0)||S,Xe=new RegExp("".concat(T.utilities.escapeRegex(Oe),"$"),Y?"g":"gi");return!!B(We.matchAll(Xe)).length});if(q.length>1){var oe=q.sort(function(Oe,We){return We.length-Oe.length})[0];return{candidateKey:oe,candidateValue:D[oe]}}if(q.length){var ee=q[0];return{candidateKey:ee,candidateValue:D[ee]}}return{}}},{key:"showCandidatesBox",value:function(S,T,j){var D=this;this.candidateBox&&this.candidateBox.show({candidateValue:T,targetElement:j,onSelect:function(Y,q){var oe=D.options,ee=oe.layoutCandidatesCaseSensitiveMatch,Oe=oe.disableCandidateNormalization,We=oe.enableLayoutCandidatesKeyPress,Xe=Y;Oe||(Xe=Y.normalize("NFD")),typeof D.options.beforeInputUpdate=="function"&&D.options.beforeInputUpdate(D);var Ve=D.getInput(D.options.inputName,!0),ot=D.getCaretPositionEnd()||0,we=Ve.substring(0,ot||0)||Ve,Lt=new RegExp("".concat(D.utilities.escapeRegex(S),"$"),ee?"g":"gi"),Tn=we.replace(Lt,Xe),lc=Ve.replace(we,Tn),Vs=Tn.length-we.length,Aa=(ot||Ve.length)+Vs;Aa<0&&(Aa=0),D.setInput(lc,D.options.inputName,!0),D.setCaretPosition(Aa),We&&typeof D.options.onKeyPress=="function"&&D.options.onKeyPress(Y,q),typeof D.options.onChange=="function"&&D.options.onChange(D.getInput(D.options.inputName,!0),q),typeof D.options.onChangeAll=="function"&&D.options.onChangeAll(D.getAllInputs(),q)}})}},{key:"handleButtonClicked",value:function(S,T){var j=this.options,D=j.inputName,Y=D===void 0?this.defaultName:D,q=j.debug;if(S!=="{//}"){this.input[Y]||(this.input[Y]=""),typeof this.options.beforeInputUpdate=="function"&&this.options.beforeInputUpdate(this);var oe=this.utilities.getUpdatedInput(S,this.input[Y],this.caretPosition,this.caretPositionEnd);if(this.utilities.isStandardButton(S)&&this.activeInputElement&&this.input[Y]&&this.input[Y]===oe&&this.caretPosition===0&&this.caretPositionEnd===oe.length)return this.setInput("",this.options.inputName,!0),this.setCaretPosition(0),this.activeInputElement.value="",this.activeInputElement.setSelectionRange(0,0),void this.handleButtonClicked(S,T);if(typeof this.options.onKeyPress=="function"&&this.options.onKeyPress(S,T),this.input[Y]!==oe&&(!this.options.inputPattern||this.options.inputPattern&&this.inputPatternIsValid(oe))){if(this.options.maxLength&&this.utilities.handleMaxLength(this.input,oe))return;var ee=this.utilities.getUpdatedInput(S,this.input[Y],this.caretPosition,this.caretPositionEnd,!0);if(this.setInput(ee,this.options.inputName,!0),q&&console.log("Input changed:",this.getAllInputs()),this.options.debug&&console.log("Caret at: ",this.getCaretPosition(),this.getCaretPositionEnd(),"(".concat(this.keyboardDOMClass,")"),T==null?void 0:T.type),this.options.syncInstanceInputs&&this.syncInstanceInputs(),typeof this.options.onChange=="function"&&this.options.onChange(this.getInput(this.options.inputName,!0),T),typeof this.options.onChangeAll=="function"&&this.options.onChangeAll(this.getAllInputs(),T),T!=null&&T.target&&this.options.enableLayoutCandidates){var Oe,We=this.getInputCandidates(oe),Xe=We.candidateKey,Ve=We.candidateValue;Xe&&Ve?this.showCandidatesBox(Xe,Ve,this.keyboardDOM):(Oe=this.candidateBox)===null||Oe===void 0||Oe.destroy()}}this.caretPositionEnd&&this.caretPosition!==this.caretPositionEnd&&(this.setCaretPosition(this.caretPositionEnd,this.caretPositionEnd),this.activeInputElement&&this.activeInputElement.setSelectionRange(this.caretPositionEnd,this.caretPositionEnd),this.options.debug&&console.log("Caret position aligned",this.caretPosition)),q&&console.log("Key pressed:",S)}}},{key:"getMouseHold",value:function(){return this.isMouseHold}},{key:"setMouseHold",value:function(S){this.options.syncInstanceInputs?this.dispatch(function(T){T.isMouseHold=S}):this.isMouseHold=S}},{key:"handleButtonMouseDown",value:function(S,T){var j=this;T&&(this.options.preventMouseDownDefault&&T.preventDefault(),this.options.stopMouseDownPropagation&&T.stopPropagation(),T.target.classList.add(this.activeButtonClass)),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdTimeout&&clearTimeout(this.holdTimeout),this.setMouseHold(!0),this.options.disableButtonHold||(this.holdTimeout=window.setTimeout(function(){(j.getMouseHold()&&(!S.includes("{")&&!S.includes("}")||S==="{delete}"||S==="{backspace}"||S==="{bksp}"||S==="{space}"||S==="{tab}")||S==="{arrowright}"||S==="{arrowleft}"||S==="{arrowup}"||S==="{arrowdown}")&&(j.options.debug&&console.log("Button held:",S),j.handleButtonHold(S)),clearTimeout(j.holdTimeout)},500))}},{key:"handleButtonMouseUp",value:function(S,T){var j=this;T&&(this.options.preventMouseUpDefault&&T.preventDefault&&T.preventDefault(),this.options.stopMouseUpPropagation&&T.stopPropagation&&T.stopPropagation(),!(T.target===this.keyboardDOM||T.target&&this.keyboardDOM.contains(T.target)||this.candidateBox&&this.candidateBox.candidateBoxElement&&(T.target===this.candidateBox.candidateBoxElement||T.target&&this.candidateBox.candidateBoxElement.contains(T.target)))&&this.candidateBox&&this.candidateBox.destroy()),this.recurseButtons(function(D){D.classList.remove(j.activeButtonClass)}),this.setMouseHold(!1),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),S&&typeof this.options.onKeyReleased=="function"&&this.options.onKeyReleased(S,T)}},{key:"handleKeyboardContainerMouseDown",value:function(S){this.options.preventMouseDownDefault&&S.preventDefault()}},{key:"handleButtonHold",value:function(S){var T=this;this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdInteractionTimeout=window.setTimeout(function(){T.getMouseHold()?(T.handleButtonClicked(S),T.handleButtonHold(S)):clearTimeout(T.holdInteractionTimeout)},100)}},{key:"syncInstanceInputs",value:function(){var S=this;this.dispatch(function(T){T.replaceInput(S.input),T.setCaretPosition(S.caretPosition,S.caretPositionEnd)})}},{key:"clearInput",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName;this.input[S]="",this.setCaretPosition(0),this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"getInput",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName,T=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.options.syncInstanceInputs&&!T&&this.syncInstanceInputs(),this.options.rtl?"‫"+this.input[S].replace("‫","").replace("‬","")+"‬":this.input[S]}},{key:"getAllInputs",value:function(){var S=this,T={};return Object.keys(this.input).forEach(function(j){T[j]=S.getInput(j,!0)}),T}},{key:"setInput",value:function(S){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.inputName||this.defaultName,j=arguments.length>2?arguments[2]:void 0;this.input[T]=S,!j&&this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"replaceInput",value:function(S){this.input=S}},{key:"setOptions",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},T=this.changedOptions(S);this.options=Object.assign(this.options,S),T.length&&(this.options.debug&&console.log("changedOptions",T),this.onSetOptions(T),this.render())}},{key:"changedOptions",value:function(S){var T=this;return Object.keys(S).filter(function(j){return JSON.stringify(S[j])!==JSON.stringify(T.options[j])})}},{key:"onSetOptions",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];S.includes("layoutName")&&this.candidateBox&&this.candidateBox.destroy(),(S.includes("layoutCandidatesPageSize")||S.includes("layoutCandidates"))&&this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=new G({utilities:this.utilities,options:this.options}))}},{key:"resetRows",value:function(){this.keyboardRowsDOM&&this.keyboardRowsDOM.remove(),this.keyboardDOM.className=this.keyboardDOMClass,this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.buttonElements={}}},{key:"dispatch",value:function(S){if(!window.SimpleKeyboardInstances)throw console.warn("SimpleKeyboardInstances is not defined. Dispatch cannot be called."),new Error("INSTANCES_VAR_ERROR");return Object.keys(window.SimpleKeyboardInstances).forEach(function(T){S(window.SimpleKeyboardInstances[T],T)})}},{key:"addButtonTheme",value:function(S,T){var j=this;T&&S&&(S.split(" ").forEach(function(D){T.split(" ").forEach(function(Y){j.options.buttonTheme||(j.options.buttonTheme=[]);var q=!1;j.options.buttonTheme.map(function(oe){if(oe!=null&&oe.class.split(" ").includes(Y)){q=!0;var ee=oe.buttons.split(" ");ee.includes(D)||(q=!0,ee.push(D),oe.buttons=ee.join(" "))}return oe}),q||j.options.buttonTheme.push({class:Y,buttons:S})})}),this.render())}},{key:"removeButtonTheme",value:function(S,T){var j=this;if(!S&&!T)return this.options.buttonTheme=[],void this.render();S&&Array.isArray(this.options.buttonTheme)&&this.options.buttonTheme.length&&(S.split(" ").forEach(function(D){var Y;(Y=j.options)===null||Y===void 0||(Y=Y.buttonTheme)===null||Y===void 0||Y.map(function(q,oe){if(q&&T&&T.includes(q.class)||!T){var ee,Oe,We=(ee=q)===null||ee===void 0?void 0:ee.buttons.split(" ").filter(function(Xe){return Xe!==D});q&&We!=null&&We.length?q.buttons=We.join(" "):((Oe=j.options.buttonTheme)===null||Oe===void 0||Oe.splice(oe,1),q=null)}return q})}),this.render())}},{key:"getButtonElement",value:function(S){var T,j=this.buttonElements[S];return j&&(T=j.length>1?j:j[0]),T}},{key:"inputPatternIsValid",value:function(S){var T,j=this.options.inputPattern;if((T=j instanceof RegExp?j:j[this.options.inputName||this.defaultName])&&S){var D=T.test(S);return this.options.debug&&console.log('inputPattern ("'.concat(T,'"): ').concat(D?"passed":"did not pass!")),D}return!0}},{key:"setEventListeners",value:function(){if(this.isFirstKeyboardInstance||!this.allKeyboardInstances){this.options.debug&&console.log("Caret handling started (".concat(this.keyboardDOMClass,")"));var S=this.options.physicalKeyboardHighlightPreventDefault,T=S!==void 0&&S;document.addEventListener("keyup",this.handleKeyUp,T),document.addEventListener("keydown",this.handleKeyDown,T),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchend",this.handleTouchEnd),this.options.updateCaretOnSelectionChange&&document.addEventListener("selectionchange",this.handleSelectionChange),document.addEventListener("select",this.handleSelect)}}},{key:"handleKeyUp",value:function(S){this.caretEventHandler(S),this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyUp(S)}},{key:"handleKeyDown",value:function(S){this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyDown(S)}},{key:"handleMouseUp",value:function(S){this.caretEventHandler(S)}},{key:"handleTouchEnd",value:function(S){this.caretEventHandler(S)}},{key:"handleSelect",value:function(S){this.caretEventHandler(S)}},{key:"handleSelectionChange",value:function(S){navigator.userAgent.includes("Firefox")||this.caretEventHandler(S)}},{key:"caretEventHandler",value:function(S){var T,j=this;S.target.tagName&&(T=S.target.tagName.toLowerCase()),this.dispatch(function(D){var Y=S.target===D.keyboardDOM||S.target&&D.keyboardDOM.contains(S.target);if(j.options.syncInstanceInputs&&Array.isArray(S.path)&&(Y=S.path.some(function(ee){var Oe;return ee==null||(Oe=ee.hasAttribute)===null||Oe===void 0?void 0:Oe.call(ee,"data-skInstance")})),(T==="textarea"||T==="input"&&["text","search","url","tel","password"].includes(S.target.type))&&!D.options.disableCaretPositioning){var q=S.target.selectionStart,oe=S.target.selectionEnd;D.options.rtl&&(q=D.utilities.getRtlOffset(q,D.getInput()),oe=D.utilities.getRtlOffset(oe,D.getInput())),D.setCaretPosition(q,oe),D.activeInputElement=S.target,D.options.debug&&console.log("Caret at: ",D.getCaretPosition(),D.getCaretPositionEnd(),S&&S.target.tagName.toLowerCase(),"(".concat(D.keyboardDOMClass,")"),S==null?void 0:S.type)}else!D.options.disableCaretPositioning&&Y||(S==null?void 0:S.type)==="selectionchange"||(D.setCaretPosition(null),D.activeInputElement=null,D.options.debug&&console.log('Caret position reset due to "'.concat(S==null?void 0:S.type,'" event'),S))})}},{key:"recurseButtons",value:function(S){var T=this;S&&Object.keys(this.buttonElements).forEach(function(j){return T.buttonElements[j].forEach(S)})}},{key:"destroy",value:function(){this.options.debug&&console.log("Destroying simple-keyboard instance: ".concat(this.currentInstanceName));var S=this.options.physicalKeyboardHighlightPreventDefault,T=S!==void 0&&S;document.removeEventListener("keyup",this.handleKeyUp,T),document.removeEventListener("keydown",this.handleKeyDown,T),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchend",this.handleTouchEnd),document.removeEventListener("select",this.handleSelect),this.options.updateCaretOnSelectionChange&&document.removeEventListener("selectionchange",this.handleSelectionChange),document.onpointerup=null,document.ontouchend=null,document.ontouchcancel=null,document.onmouseup=null,this.recurseButtons(function(j){j&&(j.onpointerdown=null,j.onpointerup=null,j.onpointercancel=null,j.ontouchstart=null,j.ontouchend=null,j.ontouchcancel=null,j.onclick=null,j.onmousedown=null,j.onmouseup=null,j.remove(),j=null)}),this.keyboardDOM.onpointerdown=null,this.keyboardDOM.ontouchstart=null,this.keyboardDOM.onmousedown=null,this.resetRows(),this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=null),this.activeInputElement=null,this.keyboardDOM.removeAttribute("data-skInstance"),this.keyboardDOM.innerHTML="",window.SimpleKeyboardInstances[this.currentInstanceName]=null,delete window.SimpleKeyboardInstances[this.currentInstanceName],this.initialized=!1}},{key:"getButtonThemeClasses",value:function(S){var T=this.options.buttonTheme,j=[];return Array.isArray(T)&&T.forEach(function(D){if(D&&D.class&&typeof D.class=="string"&&D.buttons&&typeof D.buttons=="string"){var Y=D.class.split(" ");D.buttons.split(" ").includes(S)&&(j=[].concat(B(j),B(Y)))}else console.warn('Incorrect "buttonTheme". Please check the documentation.',D)}),j}},{key:"setDOMButtonAttributes",value:function(S,T){var j=this.options.buttonAttributes;Array.isArray(j)&&j.forEach(function(D){D.attribute&&typeof D.attribute=="string"&&D.value&&typeof D.value=="string"&&D.buttons&&typeof D.buttons=="string"?D.buttons.split(" ").includes(S)&&T(D.attribute,D.value):console.warn('Incorrect "buttonAttributes". Please check the documentation.',D)})}},{key:"onTouchDeviceDetected",value:function(){this.processAutoTouchEvents(),this.disableContextualWindow()}},{key:"disableContextualWindow",value:function(){window.oncontextmenu=function(S){var T;if((T=S.target.classList)!==null&&T!==void 0&&T.contains("hg-button"))return S.preventDefault(),S.stopPropagation(),!1}}},{key:"processAutoTouchEvents",value:function(){this.options.autoUseTouchEvents&&(this.options.useTouchEvents=!0,this.options.debug&&console.log("autoUseTouchEvents: Touch device detected, useTouchEvents enabled."))}},{key:"onInit",value:function(){this.options.debug&&console.log("".concat(this.keyboardDOMClass," Initialized")),this.setEventListeners(),typeof this.options.onInit=="function"&&this.options.onInit(this)}},{key:"beforeFirstRender",value:function(){this.utilities.isTouchDevice()&&this.onTouchDeviceDetected(),typeof this.options.beforeFirstRender=="function"&&this.options.beforeFirstRender(this),this.isFirstKeyboardInstance&&this.utilities.pointerEventsSupported()&&!this.options.useTouchEvents&&!this.options.useMouseEvents&&this.options.debug&&console.log("Using PointerEvents as it is supported by this browser"),this.options.useTouchEvents&&this.options.debug&&console.log("useTouchEvents has been enabled. Only touch events will be used.")}},{key:"beforeRender",value:function(){typeof this.options.beforeRender=="function"&&this.options.beforeRender(this)}},{key:"onRender",value:function(){typeof this.options.onRender=="function"&&this.options.onRender(this)}},{key:"onModulesLoaded",value:function(){typeof this.options.onModulesLoaded=="function"&&this.options.onModulesLoaded(this)}},{key:"loadModules",value:function(){var S=this;Array.isArray(this.options.modules)&&(this.options.modules.forEach(function(T){var j=S.utilities.isConstructor(T)?new T(S):T(S);j.init&&j.init(S)}),this.keyboardPluginClasses="modules-loaded",this.render(),this.onModulesLoaded())}},{key:"getModuleProp",value:function(S,T){return!!this.modules[S]&&this.modules[S][T]}},{key:"getModulesList",value:function(){return Object.keys(this.modules)}},{key:"parseRowDOMContainers",value:function(S,T,j,D){var Y=this,q=Array.from(S.children),oe=0;return q.length&&j.forEach(function(ee,Oe){var We=D[Oe];if(!(We&&We>ee))return!1;var Xe=ee-oe,Ve=We-oe,ot=document.createElement("div");ot.className+="hg-button-container";var we="".concat(Y.options.layoutName,"-r").concat(T,"c").concat(Oe);ot.setAttribute("data-skUID",we);var Lt=q.splice(Xe,Ve-Xe+1);oe+=Ve-Xe,Lt.forEach(function(Tn){return ot.appendChild(Tn)}),q.splice(Xe,0,ot),S.innerHTML="",q.forEach(function(Tn){return S.appendChild(Tn)}),Y.options.debug&&console.log("rowDOMContainer",Lt,Xe,Ve,oe+1)}),S}},{key:"render",value:function(){var S=this;this.resetRows(),this.initialized||this.beforeFirstRender(),this.beforeRender();var T="hg-layout-".concat(this.options.layoutName),j=this.options.layout||{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]},D=this.options.useTouchEvents||!1,Y=D?"hg-touch-events":"",q=this.options.useMouseEvents||!1,oe=this.options.disableRowButtonContainers;this.keyboardDOM.className=this.getKeyboardClassString(this.options.theme,T,this.keyboardPluginClasses,Y),this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.keyboardRowsDOM=document.createElement("div"),this.keyboardRowsDOM.className="hg-rows",j[this.options.layoutName||this.defaultName].forEach(function(ee,Oe){var We=ee.split(" ");S.options.excludeFromLayout&&S.options.excludeFromLayout[S.options.layoutName||S.defaultName]&&(We=We.filter(function(we){return S.options.excludeFromLayout&&!S.options.excludeFromLayout[S.options.layoutName||S.defaultName].includes(we)}));var Xe=document.createElement("div");Xe.className+="hg-row";var Ve=[],ot=[];We.forEach(function(we,Lt){var Tn,lc=!oe&&typeof we=="string"&&we.length>1&&we.indexOf("[")===0,Vs=!oe&&typeof we=="string"&&we.length>1&&we.indexOf("]")===we.length-1;lc&&(Ve.push(Lt),we=we.replace(/\[/g,"")),Vs&&(ot.push(Lt),we=we.replace(/\]/g,""));var Aa=S.utilities.getButtonClass(we),Pa=S.utilities.getButtonDisplayName(we,S.options.display,S.options.mergeDisplay),n7=S.options.useButtonTag?"button":"div",Xn=document.createElement(n7);Xn.className+="hg-button ".concat(Aa),(Tn=Xn.classList).add.apply(Tn,B(S.getButtonThemeClasses(we))),S.setDOMButtonAttributes(we,function(vn,r7){Xn.setAttribute(vn,r7)}),S.activeButtonClass="hg-activeButton",!S.utilities.pointerEventsSupported()||D||q?D?(Xn.ontouchstart=function(vn){S.handleButtonClicked(we,vn),S.handleButtonMouseDown(we,vn)},Xn.ontouchend=function(vn){S.handleButtonMouseUp(we,vn)},Xn.ontouchcancel=function(vn){S.handleButtonMouseUp(we,vn)}):(Xn.onclick=function(vn){S.setMouseHold(!1),typeof S.options.onKeyReleased=="function"||S.options.useMouseEvents&&S.options.clickOnMouseDown||S.handleButtonClicked(we,vn)},Xn.onmousedown=function(vn){(typeof S.options.onKeyReleased=="function"||S.options.useMouseEvents&&S.options.clickOnMouseDown)&&!S.isMouseHold&&S.handleButtonClicked(we,vn),S.handleButtonMouseDown(we,vn)},Xn.onmouseup=function(vn){S.handleButtonMouseUp(we,vn)}):(Xn.onpointerdown=function(vn){S.handleButtonClicked(we,vn),S.handleButtonMouseDown(we,vn)},Xn.onpointerup=function(vn){S.handleButtonMouseUp(we,vn)},Xn.onpointercancel=function(vn){S.handleButtonMouseUp(we,vn)}),Xn.setAttribute("data-skBtn",we);var i7="".concat(S.options.layoutName,"-r").concat(Oe,"b").concat(Lt);Xn.setAttribute("data-skBtnUID",i7);var sP=document.createElement("span");sP.innerHTML=Pa,Xn.appendChild(sP),S.buttonElements[we]||(S.buttonElements[we]=[]),S.buttonElements[we].push(Xn),Xe.appendChild(Xn)}),Xe=S.parseRowDOMContainers(Xe,Oe,Ve,ot),S.keyboardRowsDOM.appendChild(Xe)}),this.keyboardDOM.appendChild(this.keyboardRowsDOM),this.onRender(),this.initialized||(this.initialized=!0,!this.utilities.pointerEventsSupported()||D||q?D?(document.ontouchend=function(ee){return S.handleButtonMouseUp(void 0,ee)},document.ontouchcancel=function(ee){return S.handleButtonMouseUp(void 0,ee)},this.keyboardDOM.ontouchstart=function(ee){return S.handleKeyboardContainerMouseDown(ee)}):D||(document.onmouseup=function(ee){return S.handleButtonMouseUp(void 0,ee)},this.keyboardDOM.onmousedown=function(ee){return S.handleKeyboardContainerMouseDown(ee)}):(document.onpointerup=function(ee){return S.handleButtonMouseUp(void 0,ee)},this.keyboardDOM.onpointerdown=function(ee){return S.handleKeyboardContainerMouseDown(ee)}),this.onInit())}}],$&&V(z.prototype,$),W&&V(z,W),Object.defineProperty(z,"prototype",{writable:!1}),z;var z,$,W}(),Q=_e,ae=Q;return c}()}},r={};function s(a){var l=r[a];if(l!==void 0)return l.exports;var c=r[a]={exports:{}};return i[a].call(c.exports,c,c.exports,s),c.exports}s.n=function(a){var l=a&&a.__esModule?function(){return a.default}:function(){return a};return s.d(l,{a:l}),l},s.d=function(a,l){for(var c in l)s.o(l,c)&&!s.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:l[c]})},s.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)},s.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var o={};return function(){s.r(o),s.d(o,{KeyboardReact:function(){return g},default:function(){return y}});var a=s(442);function l(v){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},l(v)}function c(v,b){var w=Object.keys(v);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(v);b&&(k=k.filter(function(C){return Object.getOwnPropertyDescriptor(v,C).enumerable})),w.push.apply(w,k)}return w}function u(v){for(var b=1;b<arguments.length;b++){var w=arguments[b]!=null?arguments[b]:{};b%2?c(Object(w),!0).forEach(function(k){d(v,k,w[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(w)):c(Object(w)).forEach(function(k){Object.defineProperty(v,k,Object.getOwnPropertyDescriptor(w,k))})}return v}function d(v,b,w){return(b=function(k){var C=function(E,_){if(l(E)!="object"||!E)return E;var A=E[Symbol.toPrimitive];if(A!==void 0){var R=A.call(E,_);if(l(R)!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(E)}(k,"string");return l(C)=="symbol"?C:C+""}(b))in v?Object.defineProperty(v,b,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[b]=w,v}var f=function(v){return u(u({},v),{},{keyboardRef:null})},p=s(651),m=s.n(p),g=function(v){var b=v.baseClass||"react-simple-keyboard",w=a.useRef(null),k=a.useRef(null),C=a.useRef(null),E=a.useRef(v);return a.useEffect(function(){return function(){C.current&&C.current.destroy(),w.current=!1}},[]),a.useEffect(function(){var _=function(I){return u(u({},I),{},{theme:"simple-keyboard ".concat(I.theme||"hg-theme-default")})}(v);if(!w.current){w.current=!0,_.debug&&console.log("ReactSimpleKeyboard: Init");var A=k.current,R=".".concat(b);C.current=new(m())(A||R,_),_.keyboardRef&&_.keyboardRef(C.current)}var L=function(I,G){var B=f(G),K=f(I);return Object.keys(B).filter(function(J){return B[J]!==K[J]})}(E.current,_);if(L.length){var O=C.current;E.current=_,O==null||O.setOptions(_),_.debug&&console.log("ReactSimpleKeyboard - setOptions called due to updated props:",L)}},[w,b,E,v]),a.createElement("div",{className:b,ref:k})},y=g}(),o}()})})(yz);var yfe=yz.exports;const bfe=uu(yfe),xfe={en:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shiftleft} z x c v b n m , . / {shiftright}","{space}"],"en-shift":["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shiftleft} Z X C V B N M < > ? {shiftright}","{space}"],es:["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w e r t y u i o p ́ +","{lock} a s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W E R T Y U I O P ̈ *","{lock} A S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"],"es-accent":["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w é r t y ú í ó p ́ +","{lock} á s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-accent-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W É R T Y Ú Í Ó P ̈ *","{lock} Á S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"],"es-diaeresis-default":["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w e r t y ü i o p ́ +","{lock} a s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-diaeresis-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W E R T Y Ü I O P ̈ *","{lock} A S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"]},wfe={en:{"{bksp}":"Backspace ⌫","{enter}":"Enter ↵","{shiftleft}":"Shift ⇧","{shiftright}":"Shift ⇧","{tab}":"Tab ⇥","{lock}":"Caps Lock ⇪","{space}":"Space"},es:{"{bksp}":"⌫","{enter}":"Intro ↵","{shiftleft}":"Shift ⇧","{shiftright}":"Shift ⇧","{tab}":"Tab ⇥","{lock}":"Bloq Mayús ⇪","{space}":"Espacio"}},fT="Á É Í Ó Ú á é í ó ú ́",hT="Ü ü ̈";function Sfe(){const t=QC(),e=cn(),{status:n,dispatch:i,devices:r}=Kn(),[s,o]=x.useState("none"),[a,l]=x.useState(!1),[c,u]=x.useState(!1),d=x.useMemo(()=>[t,t==="es"&&(a&&"accent"||c&&"diaeresis"),s!=="none"&&"shift"].filter(Boolean).join("-"),[t,s,a,c]),f=x.useCallback(p=>{r.keyboard&&n.type==="running"&&n.waitingForInput&&i("keyboard.sendChar",p)},[n,i,r.keyboard]);return r.keyboard?h.jsxs("div",{className:"absolute left-[1600px] top-[300px] z-10 h-min w-[500px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-xl text-white",children:e("computer.keyboard")}),h.jsx(bfe,{theme:re("hg-theme-vonsim",`hg-shift-${s}`,a&&"hg-accentDeadKey",c&&"hg-diaeresisDeadKey"),layoutName:d,layout:xfe,display:wfe[t],buttonTheme:[{class:"hg-accentDeadKeyButton",buttons:fT},{class:"hg-diaeresisDeadKeyButton",buttons:hT}],disableButtonHold:!0,onKeyPress:p=>{if(p==="{shiftleft}"||p==="{shiftright}"){o(m=>m==="none"?"once":"none");return}if(p==="{lock}"){o(m=>m==="none"?"lock":"none");return}if(t==="es"){if(a){fT.includes(p)&&(l(!1),s==="once"&&o("none"),f(p));return}else if(p==="́"){l(!0);return}if(c){hT.includes(p)&&(u(!1),s==="once"&&o("none"),f(p));return}else if(p==="̈"){u(!0);return}}s==="once"&&o("none"),f(p==="{bksp}"?"\b":p==="{enter}"?`
`:p==="{tab}"?"	":p==="{space}"?" ":p)}})]}):null}function kfe(){const t=cn(),{devices:e}=Kn(),n=tt(qE).toArray();return e.leds?h.jsxs("div",{className:"absolute left-[1300px] top-[810px] z-10 size-min rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block size-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.leds")}),h.jsx("div",{className:"flex flex-row-reverse gap-2 p-4",children:n.map((i,r)=>h.jsxs("div",{className:"flex w-7 flex-col items-center",children:[h.jsx("span",{className:"mb-1 w-full text-center text-xs text-white",children:r}),h.jsx("div",{className:re("relative size-7 rounded-full transition",i?"bg-mantis-400":"bg-stone-700 shadow-inner shadow-stone-900"),children:h.jsx("div",{className:re("absolute inset-0 rounded-full bg-mantis-400 blur-sm transition",i?"opacity-100":"opacity-0")})})]},r))})]}):null}function _fe(){const t=cn(),e=tt(PQ),n=tt(he.IP),i=tt(i8),r=tt(r8),s=tt(he.SP),o=tt(jb),a=tt(oE),l=tt(Bb),c=tt(cy),u=a||l;if(e.length===0)return null;const f=()=>{const y=[];for(let v=0;v<256;v+=16){const b=e.slice(v,v+16);y.push(b)}return y},p=16,m=Math.floor(Number(n.valueOf())/p),g=Number(n.valueOf())%p;return h.jsxs("div",{className:"absolute left-[800px] top-[-160px] z-10 size-auto rounded-lg border border-stone-600 bg-stone-900 shadow-2xl [&_*]:z-20","data-testid":"memory-component",children:[h.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-3xl text-white shadow",children:t("computer.memory.name")}),h.jsx("div",{className:"m-4 overflow-x-auto",children:h.jsxs("table",{className:"mx-auto w-auto min-w-[600px] border-separate text-center font-mono text-base",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{}),Array.from({length:16}).map((y,v)=>h.jsx("th",{className:re("relative size-10 border border-gray-500 bg-mantis-500",v%4===0&&v!==0?"border-l-4 border-mantis-600":""),children:h.jsxs("span",{className:"inline-flex items-center",children:[v.toString(16).toUpperCase(),v===g&&h.jsx("span",{className:"ml-0.5 align-middle text-xs text-red-500",children:"↓"})]})},v))]})}),h.jsx("tbody",{children:f().map((y,v)=>h.jsxs("tr",{className:v%4===0&&v!==0?"border-t-4 border-mantis-600":"",children:[h.jsx("th",{className:"relative size-10 border border-gray-500 bg-mantis-500",children:h.jsxs("span",{className:"inline-flex items-center",children:[v.toString(16).toUpperCase(),v===m&&h.jsx("span",{className:"ml-0.5 align-middle text-xs text-red-500",children:"→"})]})}),y.map((b,w)=>{var k,C,E;return h.jsx("td",{className:re("size-10 border border-gray-500 p-0 transition-shadow duration-200",w%4===0&&w!==0?"border-l-4 border-mantis-600":""),children:h.jsx(Cfe,{address:b.address,value:b.value,isIP:b.address.valueOf()===n.valueOf(),isSP:o&&b.address.valueOf()===s.valueOf(),isStackData:o&&b.address.valueOf()>s.valueOf(),isProgramAddress:!!i.find(_=>_.address===b.address.value),isDataAddress:!!r.find(_=>_.address===b.address.value),isInterruptVector:u&&b.address.valueOf()>=0&&b.address.valueOf()<=7,isWritten:c.has(b.address.valueOf()),label:((k=i.find(_=>_.address===b.address.value))==null?void 0:k.name)||((C=r.find(_=>_.address===b.address.value))==null?void 0:C.label)||null,length:((E=i.find(_=>_.address===b.address.value))==null?void 0:E.length)??null})},w)})]},v))})]})})]})}function Cfe({address:t,value:e,isIP:n,isSP:i,isStackData:r,isProgramAddress:s,isDataAddress:o,isInterruptVector:a,isWritten:l,label:c,length:u}){const d=cn(),f=tt(Up),[p,m]=x.useState(!1),g=x.useRef(e);x.useEffect(()=>{g.current!==e&&(m(!0),setTimeout(()=>m(!1),300),g.current=e)},[e]);const y=d("computer.memory.cell",t);return h.jsxs(Dy,{children:[h.jsx(jy,{asChild:!0,children:h.jsxs(Qe.div,{title:y,className:re("relative flex size-10 cursor-pointer select-none items-center justify-center border font-mono text-base transition-all duration-200",n?"z-10 shadow-lg shadow-red-500/50 outline outline-2 outline-red-500 ring-2 ring-red-500 ring-offset-2":i?"z-10 shadow-lg shadow-yellow-400/50 outline outline-2 outline-yellow-400 ring-2 ring-yellow-400 ring-offset-2":"","bg-stone-800",l?"underline decoration-red-400 decoration-2 underline-offset-1":"",a&&!i&&!r?"border-l-4 border-orange-500":"",s&&!i&&!r&&!a?"border-l-4 border-blue-500":"",o&&!i&&!r&&!s&&!a?"border-l-4 border-green-500":"",r&&!i?"border-l-4 border-yellow-500":"",i?"border-l-4 border-yellow-400":"","text-stone-100","hover:z-20 hover:scale-110 hover:shadow-xl",p&&"animate-pulse"),style:t.value===f.value?je("memory.operating-cell"):void 0,children:[a&&!i&&!r&&h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[10px] text-orange-400",title:"Vector de interrupción",style:{lineHeight:1},children:"⚡"}),s&&!i&&!r&&!a&&h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[10px] text-blue-400",title:"Instrucción",style:{lineHeight:1},children:"📘"}),o&&!i&&!r&&!s&&!a&&h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[10px] text-green-400",title:"Dato",style:{lineHeight:1},children:"📦"}),r&&!i&&h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[10px] text-yellow-400",title:"Dato de la pila",style:{lineHeight:1},children:"📚"}),i&&h.jsx("span",{className:"pointer-events-none absolute left-0.5 top-0.5 rounded bg-stone-900/80 px-0.5 text-[10px] text-yellow-300",title:"Stack Pointer",style:{lineHeight:1},children:"📍"}),h.jsx("span",{className:"z-10 mt-3 block font-mono text-lg font-bold",children:e.toString("hex")}),n&&h.jsx("span",{className:"absolute right-0 top-0 text-xs text-red-500",title:"IP",style:{lineHeight:1},children:"▲"}),i&&h.jsx("span",{className:"absolute right-0 top-0 text-xs text-yellow-500",title:"SP",style:{lineHeight:1},children:"▲"})]})}),h.jsxs(dm,{className:"w-60",children:[h.jsxs("p",{className:"px-4 py-2 font-medium text-white",children:[y," ",c?h.jsxs("span",{className:"font-bold text-mantis-400",children:["(",c,")",u!==null&&u!==""&&h.jsxs("span",{className:"text-xs font-normal text-white",children:[" Bytes: ",u]})]}):""]}),h.jsx("hr",{className:"border-stone-600"}),h.jsx("ul",{className:"px-4 py-2 text-sm",children:["hex","bin","uint","int","safe-ascii"].map(v=>h.jsxs("li",{children:[h.jsx("b",{className:"font-medium",children:d(`generics.byte-representation.${v}`)}),":"," ",h.jsx("span",{className:"font-mono text-mantis-400",children:e.toString(v)})]},v))})]})]})}function Efe(){const t=cn(),{devices:e}=Kn();return e.pic?h.jsxs("div",{className:"absolute left-0 top-[700px] z-10 flex h-[200px] w-[450px] flex-col rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsxs("div",{className:"flex items-start",children:[h.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.pic")}),h.jsxs("div",{className:"flex h-16 grow items-center justify-evenly",children:[h.jsx(Ar,{name:"IMR",title:t("generics.io-register","IMR",33),valueAtom:KE,springs:"pic.IMR",emphasis:!0}),h.jsx(Ar,{name:"IRR",title:t("generics.io-register","IRR",34),valueAtom:XE,springs:"pic.IRR",emphasis:!0}),h.jsx(Ar,{name:"ISR",title:t("generics.io-register","ISR",35),valueAtom:YE,springs:"pic.ISR",emphasis:!0})]})]}),h.jsx("hr",{className:"mb-2 border-stone-600"}),h.jsx("div",{className:"grid size-full grid-cols-4 items-center",children:Ey.slice(0,4).map((n,i)=>h.jsx(Ar,{name:`INT${i}`,title:t("generics.io-register",`INT${i}`,36+i),valueAtom:n,springs:`pic.INT${i}`,className:"mx-auto"},i))})]}):null}function Afe(){const t=cn(),{devices:e}=Kn();return e.pio?h.jsxs("div",{className:"absolute left-[900px] top-[700px] z-10 h-min w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"mb-2 block size-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.pio.name")}),h.jsx("hr",{className:"border-stone-600"}),h.jsxs("div",{className:"flex w-full items-center justify-evenly py-4",children:[h.jsx(Ar,{name:"PA",title:t("generics.io-register","PA",48),valueAtom:JE,springs:"pio.PA"}),h.jsx(Ar,{name:"CA",title:t("generics.io-register","CA",50),valueAtom:QE,springs:"pio.CA"})]}),h.jsx("hr",{className:"border-stone-600"}),h.jsxs("div",{className:"flex w-full items-center justify-evenly py-4",children:[h.jsx(Ar,{name:"PB",title:t("generics.io-register","PB",49),valueAtom:ZE,springs:"pio.PB"}),h.jsx(Ar,{name:"CB",title:t("generics.io-register","CB",51),valueAtom:eA,springs:"pio.CB"})]})]}):null}const Pfe="_printer_p8ve7_2",Nfe="_shadow_p8ve7_7",Mfe="_sides_p8ve7_15",Rfe="_front_p8ve7_22",Ife="_trailContainer_p8ve7_31",Tfe="_trail_p8ve7_31",Ofe="_paper_p8ve7_48",bc={printer:Pfe,shadow:Nfe,sides:Mfe,front:Rfe,trailContainer:Ife,trail:Tfe,paper:Ofe},Lfe=Array.from({length:5},(t,e)=>e);function Dfe(){const t=cn(),{devices:e}=Kn(),n=tt(Ay),i=tt(Py);return e.printer?h.jsx("div",{className:"absolute left-[1300px] top-[975px] z-10 flex h-min w-80 flex-col rounded-lg border border-stone-600 bg-stone-900 pl-16 [&_*]:z-20",children:h.jsxs("div",{className:bc.printer,title:t("computer.printer.name"),children:[h.jsx("div",{className:bc.shadow}),h.jsx("div",{className:bc.sides}),h.jsxs("div",{className:bc.front,children:[h.jsx("div",{className:bc.trailContainer,children:h.jsx("div",{className:bc.trail,children:h.jsx("pre",{className:bc.paper,children:i})})}),h.jsx("div",{className:"mt-8 grid grid-cols-5 items-center justify-center",children:Lfe.map(r=>{const s=n[r]?Uj(n[r].unsigned):null;return h.jsx("span",{className:re("flex h-6 w-full items-center justify-center border-r border-zinc-300 text-center font-mono text-base font-medium leading-none text-white first-of-type:rounded-l-xl last-of-type:rounded-r-xl last-of-type:border-r-0",s===null?"bg-zinc-400":"bg-mantis-500"),children:s},r)})}),h.jsx("div",{className:"mx-auto mt-3 h-1 w-[70%] overflow-hidden rounded-full bg-zinc-600",children:h.jsx(Qe.div,{className:"h-full bg-mantis-400",style:{width:je("printer.printing.progress").to(r=>`${r*100}%`),opacity:je("printer.printing.opacity")}})})]})]})}):null}const jfe="_container_6nvz7_2",Bfe="_text_6nvz7_22",pT={container:jfe,text:Bfe};function $fe(){const t=cn(),{devices:e}=Kn(),n=tt(tA);return e.screen?h.jsxs("div",{className:"absolute left-[1600px] top-0 z-10 h-min w-[500px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-xl text-white",children:t("computer.screen")}),h.jsx("div",{className:pT.container,children:h.jsx("pre",{className:pT.text,children:n})})]}):null}function Ffe(){const t=cn(),{dispatch:e,devices:n}=Kn(),i=tt(n1).toArray();return n.switches?h.jsxs("div",{className:"absolute left-[1300px] top-[680px] z-10 size-min rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block size-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.switches")}),h.jsx("div",{className:"flex flex-row-reverse gap-3 p-4",children:i.map((r,s)=>h.jsxs("div",{className:"flex w-8 flex-col items-center",children:[h.jsx("span",{className:"mb-1 w-full text-center text-xs text-white",children:s}),h.jsx(Ha,{checked:r,onCheckedChange:()=>e("switch.toggle",s),className:"-translate-x-3 -rotate-90 data-[state=unchecked]:!bg-stone-800"})]},s))})]}):null}function zfe(){const t=cn(),{devices:e}=Kn();return e.timer?h.jsxs("div",{className:"absolute left-[475px] top-[875px] z-10 flex h-[120px] w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[h.jsx("span",{className:"block size-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.timer")}),h.jsxs("div",{className:"flex size-full flex-col items-center justify-evenly",children:[h.jsx(Ar,{name:"CONT",title:t("generics.io-register","CONT",16),valueAtom:Ny,springs:"timer.CONT"}),h.jsx(Ar,{name:"COMP",title:t("generics.io-register","COMP",17),valueAtom:nA,springs:"timer.COMP"})]})]}):null}function bz(){const t=x.useRef(null);return x.useEffect(()=>{Tk(),Dk(),jk(),Bk();const e=setTimeout(()=>{Tk(),Dk(),jk(),Bk()},100);return()=>clearTimeout(e)},[]),h.jsx("div",{className:"relative size-full",children:h.jsxs(kde,{minScale:.3,initialScale:.75,ref:t,doubleClick:{disabled:!0},panning:{excluded:["input"]},children:[h.jsx(Ede,{wrapperClass:"!w-full !h-full",contentClass:"!p-[200px]",children:h.jsxs("div",{className:"relative h-[1300px] w-[1900px]",children:[h.jsx($de,{}),h.jsx("div",{className:"absolute left-[120px] top-[-120px] z-20",children:h.jsx(vz,{})}),h.jsx(dfe,{}),h.jsx(Ide,{}),h.jsx(_fe,{}),h.jsx(vfe,{}),h.jsx(Efe,{}),h.jsx(Afe,{}),h.jsx(zfe,{}),h.jsx(Fde,{}),h.jsx(gfe,{}),h.jsx(Sfe,{}),h.jsx(kfe,{}),h.jsx(Dfe,{}),h.jsx(Ffe,{}),h.jsx($fe,{})]})}),h.jsx(Ade,{wrapperRef:t})]})})}const Ufe=1024;let Vfe=0;class Sw{constructor(e,n){this.from=e,this.to=n}}class Et{constructor(e={}){this.id=Vfe++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=ur.match(e)),n=>{let i=e(n);return i===void 0?null:[this,i]}}}Et.closedBy=new Et({deserialize:t=>t.split(" ")});Et.openedBy=new Et({deserialize:t=>t.split(" ")});Et.group=new Et({deserialize:t=>t.split(" ")});Et.isolate=new Et({deserialize:t=>{if(t&&t!="rtl"&&t!="ltr"&&t!="auto")throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}});Et.contextHash=new Et({perNode:!0});Et.lookAhead=new Et({perNode:!0});Et.mounted=new Et({perNode:!0});class By{constructor(e,n,i){this.tree=e,this.overlay=n,this.parser=i}static get(e){return e&&e.props&&e.props[Et.mounted.id]}}const Hfe=Object.create(null);class ur{constructor(e,n,i,r=0){this.name=e,this.props=n,this.id=i,this.flags=r}static define(e){let n=e.props&&e.props.length?Object.create(null):Hfe,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new ur(e.name||"",n,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let n=this.prop(Et.group);return n?n.indexOf(e)>-1:!1}return this.id==e}static match(e){let n=Object.create(null);for(let i in e)for(let r of i.split(" "))n[r]=e[i];return i=>{for(let r=i.prop(Et.group),s=-1;s<(r?r.length:0);s++){let o=n[s<0?i.name:r[s]];if(o)return o}}}}ur.none=new ur("",Object.create(null),0,8);class EA{constructor(e){this.types=e;for(let n=0;n<e.length;n++)if(e[n].id!=n)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let n=[];for(let i of this.types){let r=null;for(let s of e){let o=s(i);o&&(r||(r=Object.assign({},i.props)),r[o[0].id]=o[1])}n.push(r?new ur(i.name,r,i.id,i.flags):i)}return new EA(n)}}const f0=new WeakMap,mT=new WeakMap;var ni;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"})(ni||(ni={}));class pn{constructor(e,n,i,r,s){if(this.type=e,this.children=n,this.positions=i,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=By.get(this);if(e&&!e.overlay)return e.tree.toString();let n="";for(let i of this.children){let r=i.toString();r&&(n&&(n+=","),n+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}cursor(e=0){return new a_(this.topNode,e)}cursorAt(e,n=0,i=0){let r=f0.get(this)||this.topNode,s=new a_(r);return s.moveTo(e,n),f0.set(this,s._tree),s}get topNode(){return new as(this,0,0,null)}resolve(e,n=0){let i=fm(f0.get(this)||this.topNode,e,n,!1);return f0.set(this,i),i}resolveInner(e,n=0){let i=fm(mT.get(this)||this.topNode,e,n,!0);return mT.set(this,i),i}resolveStack(e,n=0){return qfe(this,e,n)}iterate(e){let{enter:n,leave:i,from:r=0,to:s=this.length}=e,o=e.mode||0,a=(o&ni.IncludeAnonymous)>0;for(let l=this.cursor(o|ni.IncludeAnonymous);;){let c=!1;if(l.from<=s&&l.to>=r&&(!a&&l.type.isAnonymous||n(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&i&&(a||!l.type.isAnonymous)&&i(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let n in this.props)e.push([+n,this.props[n]]);return e}balance(e={}){return this.children.length<=8?this:NA(ur.none,this.children,this.positions,0,this.children.length,0,this.length,(n,i,r)=>new pn(this.type,n,i,r,this.propValues),e.makeTree||((n,i,r)=>new pn(ur.none,n,i,r)))}static build(e){return Kfe(e)}}pn.empty=new pn(ur.none,[],[],0);class AA{constructor(e,n){this.buffer=e,this.index=n}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new AA(this.buffer,this.index)}}class ql{constructor(e,n,i){this.buffer=e,this.length=n,this.set=i}get type(){return ur.none}toString(){let e=[];for(let n=0;n<this.buffer.length;)e.push(this.childString(n)),n=this.buffer[n+3];return e.join(",")}childString(e){let n=this.buffer[e],i=this.buffer[e+3],r=this.set.types[n],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,n,i,r,s){let{buffer:o}=this,a=-1;for(let l=e;l!=n&&!(xz(s,r,o[l+1],o[l+2])&&(a=l,i>0));l=o[l+3]);return a}slice(e,n,i){let r=this.buffer,s=new Uint16Array(n-e),o=0;for(let a=e,l=0;a<n;){s[l++]=r[a++],s[l++]=r[a++]-i;let c=s[l++]=r[a++]-i;s[l++]=r[a++]-e,o=Math.max(o,c)}return new ql(s,o,this.set)}}function xz(t,e,n,i){switch(t){case-2:return n<e;case-1:return i>=e&&n<e;case 0:return n<e&&i>e;case 1:return n<=e&&i>e;case 2:return i>e;case 4:return!0}}function fm(t,e,n,i){for(var r;t.from==t.to||(n<1?t.from>=e:t.from>e)||(n>-1?t.to<=e:t.to<e);){let o=!i&&t instanceof as&&t.index<0?null:t.parent;if(!o)return t;t=o}let s=i?0:ni.IgnoreOverlays;if(i)for(let o=t,a=o.parent;a;o=a,a=o.parent)o instanceof as&&o.index<0&&((r=a.enter(e,n,s))===null||r===void 0?void 0:r.from)!=o.from&&(t=a);for(;;){let o=t.enter(e,n,s);if(!o)return t;t=o}}class wz{cursor(e=0){return new a_(this,e)}getChild(e,n=null,i=null){let r=gT(this,e,n,i);return r.length?r[0]:null}getChildren(e,n=null,i=null){return gT(this,e,n,i)}resolve(e,n=0){return fm(this,e,n,!1)}resolveInner(e,n=0){return fm(this,e,n,!0)}matchContext(e){return o_(this.parent,e)}enterUnfinishedNodesBefore(e){let n=this.childBefore(e),i=this;for(;n;){let r=n.lastChild;if(!r||r.to!=n.to)break;r.type.isError&&r.from==r.to?(i=n,n=r.prevSibling):n=r}return i}get node(){return this}get next(){return this.parent}}class as extends wz{constructor(e,n,i,r){super(),this._tree=e,this.from=n,this.index=i,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,n,i,r,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,c=n>0?a.length:-1;e!=c;e+=n){let u=a[e],d=l[e]+o.from;if(xz(r,i,d,d+u.length)){if(u instanceof ql){if(s&ni.ExcludeBuffers)continue;let f=u.findChild(0,u.buffer.length,n,i-d,r);if(f>-1)return new fl(new Wfe(o,u,e,d),null,f)}else if(s&ni.IncludeAnonymous||!u.type.isAnonymous||PA(u)){let f;if(!(s&ni.IgnoreMounts)&&(f=By.get(u))&&!f.overlay)return new as(f.tree,d,e,o);let p=new as(u,d,e,o);return s&ni.IncludeAnonymous||!p.type.isAnonymous?p:p.nextChild(n<0?u.children.length-1:0,n,i,r)}}}if(s&ni.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+n:e=n<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,n,i=0){let r;if(!(i&ni.IgnoreOverlays)&&(r=By.get(this._tree))&&r.overlay){let s=e-this.from;for(let{from:o,to:a}of r.overlay)if((n>0?o<=s:o<s)&&(n<0?a>=s:a>s))return new as(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,n,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function gT(t,e,n,i){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(n!=null){for(let o=!1;!o;)if(o=r.type.is(n),!r.nextSibling())return s}for(;;){if(i!=null&&r.type.is(i))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return i==null?s:[]}}function o_(t,e,n=e.length-1){for(let i=t;n>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[n]&&e[n]!=i.name)return!1;n--}}return!0}class Wfe{constructor(e,n,i,r){this.parent=e,this.buffer=n,this.index=i,this.start=r}}class fl extends wz{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,n,i){super(),this.context=e,this._parent=n,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,n,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,n-this.context.start,i);return s<0?null:new fl(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,n,i=0){if(i&ni.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],n>0?1:-1,e-this.context.start,n);return s<0?null:new fl(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,n=e.buffer[this.index+3];return n<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new fl(this.context,this._parent,n):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new fl(this.context,this._parent,e.findChild(n,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],n=[],{buffer:i}=this.context,r=this.index+4,s=i.buffer[this.index+3];if(s>r){let o=i.buffer[this.index+1];e.push(i.slice(r,s,o)),n.push(0)}return new pn(this.type,e,n,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Sz(t){if(!t.length)return null;let e=0,n=t[0];for(let s=1;s<t.length;s++){let o=t[s];(o.from>n.from||o.to<n.to)&&(n=o,e=s)}let i=n instanceof as&&n.index<0?null:n.parent,r=t.slice();return i?r[e]=i:r.splice(e,1),new Gfe(r,n)}class Gfe{constructor(e,n){this.heads=e,this.node=n}get next(){return Sz(this.heads)}}function qfe(t,e,n){let i=t.resolveInner(e,n),r=null;for(let s=i instanceof as?i:i.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(r||(r=[i])).push(o.resolve(e,n)),s=o}else{let o=By.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new as(o.tree,o.overlay[0].from+s.from,-1,s);(r||(r=[i])).push(fm(a,e,n,!1))}}return r?Sz(r):i}class a_{get name(){return this.type.name}constructor(e,n=0){if(this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof as)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,n){this.index=e;let{start:i,buffer:r}=this.buffer;return this.type=n||r.set.types[r.buffer[e]],this.from=i+r.buffer[e+1],this.to=i+r.buffer[e+2],!0}yield(e){return e?e instanceof as?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,n,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,n,i,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,n-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,n,i=this.mode){return this.buffer?i&ni.ExcludeBuffers?!1:this.enterChild(1,e,n):this.yield(this._tree.enter(e,n,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ni.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&ni.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:n}=this.buffer,i=this.stack.length-1;if(e<0){let r=i<0?0:this.stack[i]+4;if(this.index!=r)return this.yieldBuf(n.findChild(r,this.index,-1,0,4))}else{let r=n.buffer[this.index+3];if(r<(i<0?n.buffer.length:n.buffer[this.stack[i]+3]))return this.yieldBuf(r)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let n,i,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:n,parent:i}=r)}else({index:n,_parent:i}=this._tree);for(;i;{index:n,_parent:i}=i)if(n>-1)for(let s=n+e,o=e<0?-1:i._tree.children.length;s!=o;s+=e){let a=i._tree.children[s];if(this.mode&ni.IncludeAnonymous||a instanceof ql||!a.type.isAnonymous||PA(a))return!1}return!0}move(e,n){if(n&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,n=0){for(;(this.from==this.to||(n<1?this.from>=e:this.from>e)||(n>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,n););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,n=null,i=0;if(e&&e.context==this.buffer)e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;n=o,i=s+1;break e}r=this.stack[--s]}for(let r=i;r<this.stack.length;r++)n=new fl(this.buffer,n,this.stack[r]);return this.bufferNode=new fl(this.buffer,n,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,n){for(let i=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(r=!0)}for(;;){if(r&&n&&n(this),r=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,r=!0}}}matchContext(e){if(!this.buffer)return o_(this.node.parent,e);let{buffer:n}=this.buffer,{types:i}=n.set;for(let r=e.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return o_(this._tree,e,r);let o=i[n.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}}function PA(t){return t.children.some(e=>e instanceof ql||!e.type.isAnonymous||PA(e))}function Kfe(t){var e;let{buffer:n,nodeSet:i,maxBufferLength:r=Ufe,reused:s=[],minRepeatType:o=i.types.length}=t,a=Array.isArray(n)?new AA(n,n.length):n,l=i.types,c=0,u=0;function d(C,E,_,A,R,L){let{id:O,start:I,end:G,size:B}=a,K=u,J=c;for(;B<0;)if(a.next(),B==-1){let _e=s[O];_.push(_e),A.push(I-C);return}else if(B==-3){c=O;return}else if(B==-4){u=O;return}else throw new RangeError(`Unrecognized record size: ${B}`);let ne=l[O],V,U,se=I-C;if(G-I<=r&&(U=y(a.pos-E,R))){let _e=new Uint16Array(U.size-U.skip),Q=a.pos-U.size,ae=_e.length;for(;a.pos>Q;)ae=v(U.start,_e,ae);V=new ql(_e,G-U.start,i),se=U.start-C}else{let _e=a.pos-B;a.next();let Q=[],ae=[],z=O>=o?O:-1,$=0,W=G;for(;a.pos>_e;)z>=0&&a.id==z&&a.size>=0?(a.end<=W-r&&(m(Q,ae,I,$,a.end,W,z,K,J),$=Q.length,W=a.end),a.next()):L>2500?f(I,_e,Q,ae):d(I,_e,Q,ae,z,L+1);if(z>=0&&$>0&&$<Q.length&&m(Q,ae,I,$,I,W,z,K,J),Q.reverse(),ae.reverse(),z>-1&&$>0){let S=p(ne,J);V=NA(ne,Q,ae,0,Q.length,0,G-I,S,S)}else V=g(ne,Q,ae,G-I,K-G,J)}_.push(V),A.push(se)}function f(C,E,_,A){let R=[],L=0,O=-1;for(;a.pos>E;){let{id:I,start:G,end:B,size:K}=a;if(K>4)a.next();else{if(O>-1&&G<O)break;O<0&&(O=B-r),R.push(I,G,B),L++,a.next()}}if(L){let I=new Uint16Array(L*4),G=R[R.length-2];for(let B=R.length-3,K=0;B>=0;B-=3)I[K++]=R[B],I[K++]=R[B+1]-G,I[K++]=R[B+2]-G,I[K++]=K;_.push(new ql(I,R[2]-G,i)),A.push(G-C)}}function p(C,E){return(_,A,R)=>{let L=0,O=_.length-1,I,G;if(O>=0&&(I=_[O])instanceof pn){if(!O&&I.type==C&&I.length==R)return I;(G=I.prop(Et.lookAhead))&&(L=A[O]+I.length+G)}return g(C,_,A,R,L,E)}}function m(C,E,_,A,R,L,O,I,G){let B=[],K=[];for(;C.length>A;)B.push(C.pop()),K.push(E.pop()+_-R);C.push(g(i.types[O],B,K,L-R,I-L,G)),E.push(R-_)}function g(C,E,_,A,R,L,O){if(L){let I=[Et.contextHash,L];O=O?[I].concat(O):[I]}if(R>25){let I=[Et.lookAhead,R];O=O?[I].concat(O):[I]}return new pn(C,E,_,A,O)}function y(C,E){let _=a.fork(),A=0,R=0,L=0,O=_.end-r,I={size:0,start:0,skip:0};e:for(let G=_.pos-C;_.pos>G;){let B=_.size;if(_.id==E&&B>=0){I.size=A,I.start=R,I.skip=L,L+=4,A+=4,_.next();continue}let K=_.pos-B;if(B<0||K<G||_.start<O)break;let J=_.id>=o?4:0,ne=_.start;for(_.next();_.pos>K;){if(_.size<0)if(_.size==-3)J+=4;else break e;else _.id>=o&&(J+=4);_.next()}R=ne,A+=B,L+=J}return(E<0||A==C)&&(I.size=A,I.start=R,I.skip=L),I.size>4?I:void 0}function v(C,E,_){let{id:A,start:R,end:L,size:O}=a;if(a.next(),O>=0&&A<o){let I=_;if(O>4){let G=a.pos-(O-4);for(;a.pos>G;)_=v(C,E,_)}E[--_]=I,E[--_]=L-C,E[--_]=R-C,E[--_]=A}else O==-3?c=A:O==-4&&(u=A);return _}let b=[],w=[];for(;a.pos>0;)d(t.start||0,t.bufferStart||0,b,w,-1,0);let k=(e=t.length)!==null&&e!==void 0?e:b.length?w[0]+b[0].length:0;return new pn(l[t.topID],b.reverse(),w.reverse(),k)}const vT=new WeakMap;function uv(t,e){if(!t.isAnonymous||e instanceof ql||e.type!=t)return 1;let n=vT.get(e);if(n==null){n=1;for(let i of e.children){if(i.type!=t||!(i instanceof pn)){n=1;break}n+=uv(t,i)}vT.set(e,n)}return n}function NA(t,e,n,i,r,s,o,a,l){let c=0;for(let m=i;m<r;m++)c+=uv(t,e[m]);let u=Math.ceil(c*1.5/8),d=[],f=[];function p(m,g,y,v,b){for(let w=y;w<v;){let k=w,C=g[w],E=uv(t,m[w]);for(w++;w<v;w++){let _=uv(t,m[w]);if(E+_>=u)break;E+=_}if(w==k+1){if(E>u){let _=m[k];p(_.children,_.positions,0,_.children.length,g[k]+b);continue}d.push(m[k])}else{let _=g[w-1]+m[w-1].length-C;d.push(NA(t,m,g,k,w,C,_,null,l))}f.push(C+b-s)}}return p(e,n,i,r,0),(a||l)(d,f,o)}class Uc{constructor(e,n,i,r,s=!1,o=!1){this.from=e,this.to=n,this.tree=i,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,n=[],i=!1){let r=[new Uc(0,e.length,e,0,!1,i)];for(let s of n)s.to>e.length&&r.push(s);return r}static applyChanges(e,n,i=128){if(!n.length)return e;let r=[],s=1,o=e.length?e[0]:null;for(let a=0,l=0,c=0;;a++){let u=a<n.length?n[a]:null,d=u?u.fromA:1e9;if(d-l>=i)for(;o&&o.from<d;){let f=o;if(l>=f.from||d<=f.to||c){let p=Math.max(f.from,l)-c,m=Math.min(f.to,d)-c;f=p>=m?null:new Uc(p,m,f.tree,f.offset+c,a>0,!!u)}if(f&&r.push(f),o.to>d)break;o=s<e.length?e[s++]:null}if(!u)break;l=u.toA,c=u.toA-u.toB}return r}}class kz{startParse(e,n,i){return typeof e=="string"&&(e=new Xfe(e)),i=i?i.length?i.map(r=>new Sw(r.from,r.to)):[new Sw(0,0)]:[new Sw(0,e.length)],this.createParse(e,n||[],i)}parse(e,n,i){let r=this.startParse(e,n,i);for(;;){let s=r.advance();if(s)return s}}}class Xfe{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,n){return this.string.slice(e,n)}}new Et({perNode:!0});let Yfe=0;class $n{constructor(e,n,i,r){this.name=e,this.set=n,this.base=i,this.modified=r,this.id=Yfe++}toString(){let{name:e}=this;for(let n of this.modified)n.name&&(e=`${n.name}(${e})`);return e}static define(e,n){let i=typeof e=="string"?e:"?";if(e instanceof $n&&(n=e),n!=null&&n.base)throw new Error("Can not derive from a modified tag");let r=new $n(i,[],null,[]);if(r.set.push(r),n)for(let s of n.set)r.set.push(s);return r}static defineModifier(e){let n=new $y(e);return i=>i.modified.indexOf(n)>-1?i:$y.get(i.base||i,i.modified.concat(n).sort((r,s)=>r.id-s.id))}}let Jfe=0;class $y{constructor(e){this.name=e,this.instances=[],this.id=Jfe++}static get(e,n){if(!n.length)return e;let i=n[0].instances.find(a=>a.base==e&&Zfe(n,a.modified));if(i)return i;let r=[],s=new $n(e.name,r,e,n);for(let a of n)a.instances.push(s);let o=Qfe(n);for(let a of e.set)if(!a.modified.length)for(let l of o)r.push($y.get(a,l));return s}}function Zfe(t,e){return t.length==e.length&&t.every((n,i)=>n==e[i])}function Qfe(t){let e=[[]];for(let n=0;n<t.length;n++)for(let i=0,r=e.length;i<r;i++)e.push(e[i].concat(t[n]));return e.sort((n,i)=>i.length-n.length)}function ehe(t){let e=Object.create(null);for(let n in t){let i=t[n];Array.isArray(i)||(i=[i]);for(let r of n.split(" "))if(r){let s=[],o=2,a=r;for(let d=0;;){if(a=="..."&&d>0&&d+3==r.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!f)throw new RangeError("Invalid path: "+r);if(s.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),d+=f[0].length,d==r.length)break;let p=r[d++];if(d==r.length&&p=="!"){o=0;break}if(p!="/")throw new RangeError("Invalid path: "+r);a=r.slice(d)}let l=s.length-1,c=s[l];if(!c)throw new RangeError("Invalid path: "+r);let u=new Fy(i,o,l>0?s.slice(0,l):null);e[c]=u.sort(e[c])}}return _z.add(e)}const _z=new Et;class Fy{constructor(e,n,i,r){this.tags=e,this.mode=n,this.context=i,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Fy.empty=new Fy([],2,null);function Cz(t,e){let n=Object.create(null);for(let s of t)if(!Array.isArray(s.tag))n[s.tag.id]=s.class;else for(let o of s.tag)n[o.id]=s.class;let{scope:i,all:r=null}=e||{};return{style:s=>{let o=r;for(let a of s)for(let l of a.set){let c=n[l.id];if(c){o=o?o+" "+c:c;break}}return o},scope:i}}function the(t,e){let n=null;for(let i of t){let r=i.style(e);r&&(n=n?n+" "+r:r)}return n}function nhe(t,e,n,i=0,r=t.length){let s=new ihe(i,Array.isArray(e)?e:[e],n);s.highlightRange(t.cursor(),i,r,"",s.highlighters),s.flush(r)}class ihe{constructor(e,n,i){this.at=e,this.highlighters=n,this.span=i,this.class=""}startSpan(e,n){n!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=n)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,n,i,r,s){let{type:o,from:a,to:l}=e;if(a>=i||l<=n)return;o.isTop&&(s=this.highlighters.filter(p=>!p.scope||p.scope(o)));let c=r,u=rhe(e)||Fy.empty,d=the(s,u.tags);if(d&&(c&&(c+=" "),c+=d,u.mode==1&&(r+=(r?" ":"")+d)),this.startSpan(Math.max(n,a),c),u.opaque)return;let f=e.tree&&e.tree.prop(Et.mounted);if(f&&f.overlay){let p=e.node.enter(f.overlay[0].from+a,1),m=this.highlighters.filter(y=>!y.scope||y.scope(f.tree.type)),g=e.firstChild();for(let y=0,v=a;;y++){let b=y<f.overlay.length?f.overlay[y]:null,w=b?b.from+a:l,k=Math.max(n,v),C=Math.min(i,w);if(k<C&&g)for(;e.from<C&&(this.highlightRange(e,k,C,r,s),this.startSpan(Math.min(C,e.to),c),!(e.to>=w||!e.nextSibling())););if(!b||w>i)break;v=b.to+a,v>n&&(this.highlightRange(p.cursor(),Math.max(n,b.from+a),Math.min(i,v),"",m),this.startSpan(Math.min(i,v),c))}g&&e.parent()}else if(e.firstChild()){f&&(r="");do if(!(e.to<=n)){if(e.from>=i)break;this.highlightRange(e,n,i,r,s),this.startSpan(Math.min(i,e.to),c)}while(e.nextSibling());e.parent()}}}function rhe(t){let e=t.type.prop(_z);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}const xe=$n.define,h0=xe(),Wa=xe(),yT=xe(Wa),bT=xe(Wa),Ga=xe(),p0=xe(Ga),kw=xe(Ga),Ys=xe(),xc=xe(Ys),Gs=xe(),qs=xe(),l_=xe(),rh=xe(l_),m0=xe(),Ze={comment:h0,lineComment:xe(h0),blockComment:xe(h0),docComment:xe(h0),name:Wa,variableName:xe(Wa),typeName:yT,tagName:xe(yT),propertyName:bT,attributeName:xe(bT),className:xe(Wa),labelName:xe(Wa),namespace:xe(Wa),macroName:xe(Wa),literal:Ga,string:p0,docString:xe(p0),character:xe(p0),attributeValue:xe(p0),number:kw,integer:xe(kw),float:xe(kw),bool:xe(Ga),regexp:xe(Ga),escape:xe(Ga),color:xe(Ga),url:xe(Ga),keyword:Gs,self:xe(Gs),null:xe(Gs),atom:xe(Gs),unit:xe(Gs),modifier:xe(Gs),operatorKeyword:xe(Gs),controlKeyword:xe(Gs),definitionKeyword:xe(Gs),moduleKeyword:xe(Gs),operator:qs,derefOperator:xe(qs),arithmeticOperator:xe(qs),logicOperator:xe(qs),bitwiseOperator:xe(qs),compareOperator:xe(qs),updateOperator:xe(qs),definitionOperator:xe(qs),typeOperator:xe(qs),controlOperator:xe(qs),punctuation:l_,separator:xe(l_),bracket:rh,angleBracket:xe(rh),squareBracket:xe(rh),paren:xe(rh),brace:xe(rh),content:Ys,heading:xc,heading1:xe(xc),heading2:xe(xc),heading3:xe(xc),heading4:xe(xc),heading5:xe(xc),heading6:xe(xc),contentSeparator:xe(Ys),list:xe(Ys),quote:xe(Ys),emphasis:xe(Ys),strong:xe(Ys),link:xe(Ys),monospace:xe(Ys),strikethrough:xe(Ys),inserted:xe(),deleted:xe(),changed:xe(),invalid:xe(),meta:m0,documentMeta:xe(m0),annotation:xe(m0),processingInstruction:xe(m0),definition:$n.defineModifier("definition"),constant:$n.defineModifier("constant"),function:$n.defineModifier("function"),standard:$n.defineModifier("standard"),local:$n.defineModifier("local"),special:$n.defineModifier("special")};for(let t in Ze){let e=Ze[t];e instanceof $n&&(e.name=t)}Cz([{tag:Ze.link,class:"tok-link"},{tag:Ze.heading,class:"tok-heading"},{tag:Ze.emphasis,class:"tok-emphasis"},{tag:Ze.strong,class:"tok-strong"},{tag:Ze.keyword,class:"tok-keyword"},{tag:Ze.atom,class:"tok-atom"},{tag:Ze.bool,class:"tok-bool"},{tag:Ze.url,class:"tok-url"},{tag:Ze.labelName,class:"tok-labelName"},{tag:Ze.inserted,class:"tok-inserted"},{tag:Ze.deleted,class:"tok-deleted"},{tag:Ze.literal,class:"tok-literal"},{tag:Ze.string,class:"tok-string"},{tag:Ze.number,class:"tok-number"},{tag:[Ze.regexp,Ze.escape,Ze.special(Ze.string)],class:"tok-string2"},{tag:Ze.variableName,class:"tok-variableName"},{tag:Ze.local(Ze.variableName),class:"tok-variableName tok-local"},{tag:Ze.definition(Ze.variableName),class:"tok-variableName tok-definition"},{tag:Ze.special(Ze.variableName),class:"tok-variableName2"},{tag:Ze.definition(Ze.propertyName),class:"tok-propertyName tok-definition"},{tag:Ze.typeName,class:"tok-typeName"},{tag:Ze.namespace,class:"tok-namespace"},{tag:Ze.className,class:"tok-className"},{tag:Ze.macroName,class:"tok-macroName"},{tag:Ze.propertyName,class:"tok-propertyName"},{tag:Ze.operator,class:"tok-operator"},{tag:Ze.comment,class:"tok-comment"},{tag:Ze.meta,class:"tok-meta"},{tag:Ze.invalid,class:"tok-invalid"},{tag:Ze.punctuation,class:"tok-punctuation"}]);var _w;const cd=new Et;function she(t){return Re.define({combine:t?e=>e.concat(t):void 0})}const ohe=new Et;class Rs{constructor(e,n,i=[],r=""){this.data=e,this.name=r,St.prototype.hasOwnProperty("tree")||Object.defineProperty(St.prototype,"tree",{get(){return To(this)}}),this.parser=n,this.extension=[yf.of(this),St.languageData.of((s,o,a)=>{let l=xT(s,o,a),c=l.type.prop(cd);if(!c)return[];let u=s.facet(c),d=l.type.prop(ohe);if(d){let f=l.resolve(o-l.from,a);for(let p of d)if(p.test(f,s)){let m=s.facet(p.facet);return p.type=="replace"?m:m.concat(u)}}return u})].concat(i)}isActiveAt(e,n,i=-1){return xT(e,n,i).type.prop(cd)==this.data}findRegions(e){let n=e.facet(yf);if((n==null?void 0:n.data)==this.data)return[{from:0,to:e.doc.length}];if(!n||!n.allowsNesting)return[];let i=[],r=(s,o)=>{if(s.prop(cd)==this.data){i.push({from:o,to:o+s.length});return}let a=s.prop(Et.mounted);if(a){if(a.tree.prop(cd)==this.data){if(a.overlay)for(let l of a.overlay)i.push({from:l.from+o,to:l.to+o});else i.push({from:o,to:o+s.length});return}else if(a.overlay){let l=i.length;if(r(a.tree,a.overlay[0].from+o),i.length>l)return}}for(let l=0;l<s.children.length;l++){let c=s.children[l];c instanceof pn&&r(c,s.positions[l]+o)}};return r(To(e),0),i}get allowsNesting(){return!0}}Rs.setState=ft.define();function xT(t,e,n){let i=t.facet(yf),r=To(t).topNode;if(!i||i.allowsNesting)for(let s=r;s;s=s.enter(e,n,ni.ExcludeBuffers))s.type.isTop&&(r=s);return r}function To(t){let e=t.field(Rs.state,!1);return e?e.tree:pn.empty}class ahe{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,n){let i=this.cursorPos-this.string.length;return e<i||n>=this.cursorPos?this.doc.sliceString(e,n):this.string.slice(e-i,n-i)}}let sh=null;class gf{constructor(e,n,i=[],r,s,o,a,l){this.parser=e,this.state=n,this.fragments=i,this.tree=r,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,n,i){return new gf(e,n,[],pn.empty,0,i,[],null)}startParse(){return this.parser.startParse(new ahe(this.state.doc),this.fragments)}work(e,n){return n!=null&&n>=this.state.doc.length&&(n=void 0),this.tree!=pn.empty&&this.isDone(n??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),n!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>n)&&n<this.state.doc.length&&this.parse.stopAt(n);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(Uc.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(n??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,n;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(n=this.parse.advance()););}),this.treeLen=e,this.tree=n,this.fragments=this.withoutTempSkipped(Uc.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let n=sh;sh=this;try{return e()}finally{sh=n}}withoutTempSkipped(e){for(let n;n=this.tempSkipped.pop();)e=wT(e,n.from,n.to);return e}changes(e,n){let{fragments:i,tree:r,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((c,u,d,f)=>l.push({fromA:c,toA:u,fromB:d,toB:f})),i=Uc.applyChanges(i,l),r=pn.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let c of this.skipped){let u=e.mapPos(c.from,1),d=e.mapPos(c.to,-1);u<d&&a.push({from:u,to:d})}}}return new gf(this.parser,n,i,r,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let n=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:r,to:s}=this.skipped[i];r<e.to&&s>e.from&&(this.fragments=wT(this.fragments,r,s),this.skipped.splice(i--,1))}return this.skipped.length>=n?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,n){this.skipped.push({from:e,to:n})}static getSkippingParser(e){return new class extends kz{createParse(n,i,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let l=sh;if(l){for(let c of r)l.tempSkipped.push(c);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new pn(ur.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let n=this.fragments;return this.treeLen>=e&&n.length&&n[0].from==0&&n[0].to>=e}static get(){return sh}}function wT(t,e,n){return Uc.applyChanges(t,[{fromA:e,toA:n,fromB:e,toB:n}])}class vf{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let n=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,i)||n.takeTree(),new vf(n)}static init(e){let n=Math.min(3e3,e.doc.length),i=gf.create(e.facet(yf).parser,e,{from:0,to:n});return i.work(20,n)||i.takeTree(),new vf(i)}}Rs.state=$i.define({create:vf.init,update(t,e){for(let n of e.effects)if(n.is(Rs.setState))return n.value;return e.startState.facet(yf)!=e.state.facet(yf)?vf.init(e.state):t.apply(e)}});let Ez=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(Ez=t=>{let e=-1,n=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(n):cancelIdleCallback(e)});const Cw=typeof navigator<"u"&&(!((_w=navigator.scheduling)===null||_w===void 0)&&_w.isInputPending)?()=>navigator.scheduling.isInputPending():null,lhe=ui.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let n=this.view.state.field(Rs.state).context;(n.updateViewport(e.view.viewport)||this.view.viewport.to>n.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(n)}scheduleWork(){if(this.working)return;let{state:e}=this.view,n=e.field(Rs.state);(n.tree!=n.context.tree||!n.context.isDone(e.doc.length))&&(this.working=Ez(this.work))}work(e){this.working=null;let n=Date.now();if(this.chunkEnd<n&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=n+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:r}}=this.view,s=i.field(Rs.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Cw?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<r&&i.doc.length>r+1e3,l=s.context.work(()=>Cw&&Cw()||Date.now()>o,r+(a?0:1e5));this.chunkBudget-=Date.now()-n,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Rs.setState.of(new vf(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(n=>Cr(this.view.state,n)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),yf=Re.define({combine(t){return t.length?t[0]:null},enables:t=>[Rs.state,lhe,De.contentAttributes.compute([t],e=>{let n=e.facet(t);return n&&n.name?{"data-language":n.name}:{}})]});class che{constructor(e,n=[]){this.language=e,this.support=n,this.extension=[e,n]}}const uhe=Re.define(),MA=Re.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(n=>n!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function cu(t){let e=t.facet(MA);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function c_(t,e){let n="",i=t.tabSize,r=t.facet(MA)[0];if(r=="	"){for(;e>=i;)n+="	",e-=i;r=" "}for(let s=0;s<e;s++)n+=r;return n}function dhe(t,e){t instanceof St&&(t=new RA(t));for(let i of t.state.facet(uhe)){let r=i(t,e);if(r!==void 0)return r}let n=To(t.state);return n.length>=e?fhe(t,n,e):null}class RA{constructor(e,n={}){this.state=e,this.options=n,this.unit=cu(e)}lineAt(e,n=1){let i=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=i.from&&r<=i.to?s&&r==e?{text:"",from:e}:(n<0?r<e:r<=e)?{text:i.text.slice(r-i.from),from:r}:{text:i.text.slice(0,r-i.from),from:i.from}:i}textAfterPos(e,n=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:r}=this.lineAt(e,n);return i.slice(e-r,Math.min(i.length,e+100-r))}column(e,n=1){let{text:i,from:r}=this.lineAt(e,n),s=this.countColumn(i,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(s+=o-this.countColumn(i,i.search(/\S|$/))),s}countColumn(e,n=e.length){return Im(e,this.state.tabSize,n)}lineIndent(e,n=1){let{text:i,from:r}=this.lineAt(e,n),s=this.options.overrideIndentation;if(s){let o=s(r);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Az=new Et;function fhe(t,e,n){let i=e.resolveStack(n),r=e.resolveInner(n,-1).resolve(n,0).enterUnfinishedNodesBefore(n);if(r!=i.node){let s=[];for(let o=r;o&&!(o.from<i.node.from||o.to>i.node.to||o.from==i.node.from&&o.type==i.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)i={node:s[o],next:i}}return Pz(i,t,n)}function Pz(t,e,n){for(let i=t;i;i=i.next){let r=phe(i.node);if(r)return r(IA.create(e,n,i))}return 0}function hhe(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function phe(t){let e=t.type.prop(Az);if(e)return e;let n=t.firstChild,i;if(n&&(i=n.type.prop(Et.closedBy))){let r=t.lastChild,s=r&&i.indexOf(r.name)>-1;return o=>yhe(o,!0,1,void 0,s&&!hhe(o)?r.from:void 0)}return t.parent==null?mhe:null}function mhe(){return 0}class IA extends RA{constructor(e,n,i){super(e.state,e.options),this.base=e,this.pos=n,this.context=i}get node(){return this.context.node}static create(e,n,i){return new IA(e,n,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let n=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(n.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(ghe(i,e))break;n=this.state.doc.lineAt(i.from)}return this.lineIndent(n.from)}continue(){return Pz(this.context.next,this.base,this.pos)}}function ghe(t,e){for(let n=e;n;n=n.parent)if(t==n)return!0;return!1}function vhe(t){let e=t.node,n=e.childAfter(e.from),i=e.lastChild;if(!n)return null;let r=t.options.simulateBreak,s=t.state.doc.lineAt(n.from),o=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let a=n.to;;){let l=e.childAfter(a);if(!l||l==i)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let c=/^ */.exec(s.text.slice(n.to-s.from))[0].length;return{from:n.from,to:n.to+c}}a=l.to}}function yhe(t,e,n,i,r){let s=t.textAfter,o=s.match(/^\s*/)[0].length,a=i&&s.slice(o,o+i.length)==i||r==t.pos+o,l=vhe(t);return l?a?t.column(l.from):t.column(l.to):t.baseIndent+(a?0:t.unit*n)}const bhe=Re.define(),xhe=new Et;function whe(t,e,n){let i=To(t);if(i.length<n)return null;let r=i.resolveStack(n,1),s=null;for(let o=r;o;o=o.next){let a=o.node;if(a.to<=n||a.from>n)continue;if(s&&a.from<e)break;let l=a.type.prop(xhe);if(l&&(a.to<i.length-50||i.length==t.doc.length||!She(a))){let c=l(a,t);c&&c.from<=n&&c.from>=e&&c.to>n&&(s=c)}}return s}function She(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function Nz(t,e,n){for(let i of t.facet(bhe)){let r=i(t,e,n);if(r)return r}return whe(t,e,n)}function Mz(t,e){let n=e.mapPos(t.from,1),i=e.mapPos(t.to,-1);return n>=i?void 0:{from:n,to:i}}const TA=ft.define({map:Mz}),b1=ft.define({map:Mz});function Rz(t){let e=[];for(let{head:n}of t.state.selection.ranges)e.some(i=>i.from<=n&&i.to>=n)||e.push(t.lineBlockAt(n));return e}const Wm=$i.define({create(){return ht.none},update(t,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((n,i)=>t=ST(t,n,i)),t=t.map(e.changes);for(let n of e.effects)if(n.is(TA)&&!khe(t,n.value.from,n.value.to)){let{preparePlaceholder:i}=e.state.facet(Lz),r=i?ht.replace({widget:new Mhe(i(e.state,n.value))}):kT;t=t.update({add:[r.range(n.value.from,n.value.to)]})}else n.is(b1)&&(t=t.update({filter:(i,r)=>n.value.from!=i||n.value.to!=r,filterFrom:n.value.from,filterTo:n.value.to}));return e.selection&&(t=ST(t,e.selection.main.head)),t},provide:t=>De.decorations.from(t),toJSON(t,e){let n=[];return t.between(0,e.doc.length,(i,r)=>{n.push(i,r)}),n},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let n=0;n<t.length;){let i=t[n++],r=t[n++];if(typeof i!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(kT.range(i,r))}return ht.set(e,!0)}});function ST(t,e,n=e){let i=!1;return t.between(e,n,(r,s)=>{r<n&&s>e&&(i=!0)}),i?t.update({filterFrom:e,filterTo:n,filter:(r,s)=>r>=n||s<=e}):t}function Iz(t,e,n){var i;let r=null;return(i=t.field(Wm,!1))===null||i===void 0||i.between(e,n,(s,o)=>{(!r||r.from>s)&&(r={from:s,to:o})}),r}function khe(t,e,n){let i=!1;return t.between(e,e,(r,s)=>{r==e&&s==n&&(i=!0)}),i}function Tz(t,e){return t.field(Wm,!1)?e:e.concat(ft.appendConfig.of(Nhe()))}const _he=t=>{for(let e of Rz(t)){let n=Nz(t.state,e.from,e.to);if(n)return t.dispatch({effects:Tz(t.state,[TA.of(n),Oz(t,n)])}),!0}return!1},Che=t=>{if(!t.state.field(Wm,!1))return!1;let e=[];for(let n of Rz(t)){let i=Iz(t.state,n.from,n.to);i&&e.push(b1.of(i),Oz(t,i,!1))}return e.length&&t.dispatch({effects:e}),e.length>0};function Oz(t,e,n=!0){let i=t.state.doc.lineAt(e.from).number,r=t.state.doc.lineAt(e.to).number;return De.announce.of(`${t.state.phrase(n?"Folded lines":"Unfolded lines")} ${i} ${t.state.phrase("to")} ${r}.`)}const Ehe=t=>{let{state:e}=t,n=[];for(let i=0;i<e.doc.length;){let r=t.lineBlockAt(i),s=Nz(e,r.from,r.to);s&&n.push(TA.of(s)),i=(s?t.lineBlockAt(s.to):r).to+1}return n.length&&t.dispatch({effects:Tz(t.state,n)}),!!n.length},Ahe=t=>{let e=t.state.field(Wm,!1);if(!e||!e.size)return!1;let n=[];return e.between(0,t.state.doc.length,(i,r)=>{n.push(b1.of({from:i,to:r}))}),t.dispatch({effects:n}),!0},Phe={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},Lz=Re.define({combine(t){return Ql(t,Phe)}});function Nhe(t){return[Wm,Rhe]}function Dz(t,e){let{state:n}=t,i=n.facet(Lz),r=o=>{let a=t.lineBlockAt(t.posAtDOM(o.target)),l=Iz(t.state,a.from,a.to);l&&t.dispatch({effects:b1.of(l)}),o.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(t,r,e);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",n.phrase("folded code")),s.title=n.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}const kT=ht.replace({widget:new class extends ec{toDOM(t){return Dz(t,null)}}});class Mhe extends ec{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return Dz(e,this.value)}}const Rhe=De.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class x1{constructor(e,n){this.specs=e;let i;function r(a){let l=Fl.newName();return(i||(i=Object.create(null)))["."+l]=a,l}const s=typeof n.all=="string"?n.all:n.all?r(n.all):void 0,o=n.scope;this.scope=o instanceof Rs?a=>a.prop(cd)==o.data:o?a=>a==o:void 0,this.style=Cz(e.map(a=>({tag:a.tag,class:a.class||r(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=i?new Fl(i):null,this.themeType=n.themeType}static define(e,n){return new x1(e,n||{})}}const u_=Re.define(),Ihe=Re.define({combine(t){return t.length?[t[0]]:null}});function Ew(t){let e=t.facet(u_);return e.length?e:t.facet(Ihe)}function The(t,e){let n=[Lhe],i;return t instanceof x1&&(t.module&&n.push(De.styleModule.of(t.module)),i=t.themeType),i?n.push(u_.computeN([De.darkTheme],r=>r.facet(De.darkTheme)==(i=="dark")?[t]:[])):n.push(u_.of(t)),n}class Ohe{constructor(e){this.markCache=Object.create(null),this.tree=To(e.state),this.decorations=this.buildDeco(e,Ew(e.state)),this.decoratedTo=e.viewport.to}update(e){let n=To(e.state),i=Ew(e.state),r=i!=Ew(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);n.length<s.to&&!r&&n.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(n!=this.tree||e.viewportChanged||r)&&(this.tree=n,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=s.to)}buildDeco(e,n){if(!n||!this.tree.length)return ht.none;let i=new $l;for(let{from:r,to:s}of e.visibleRanges)nhe(this.tree,n,(o,a,l)=>{i.add(o,a,this.markCache[l]||(this.markCache[l]=ht.mark({class:l})))},r,s);return i.finish()}}const Lhe=Mm.high(ui.fromClass(Ohe,{decorations:t=>t.decorations})),Dhe=1e4,jhe="()[]{}",Bhe=new Et;function d_(t,e,n){let i=t.prop(e<0?Et.openedBy:Et.closedBy);if(i)return i;if(t.name.length==1){let r=n.indexOf(t.name);if(r>-1&&r%2==(e<0?1:0))return[n[r+e]]}return null}function f_(t){let e=t.type.prop(Bhe);return e?e(t.node):t}function g0(t,e,n,i={}){let r=i.maxScanDistance||Dhe,s=i.brackets||jhe,o=To(t),a=o.resolveInner(e,n);for(let l=a;l;l=l.parent){let c=d_(l.type,n,s);if(c&&l.from<l.to){let u=f_(l);if(u&&(n>0?e>=u.from&&e<u.to:e>u.from&&e<=u.to))return $he(t,e,n,l,u,c,s)}}return Fhe(t,e,n,o,a.type,r,s)}function $he(t,e,n,i,r,s,o){let a=i.parent,l={from:r.from,to:r.to},c=0,u=a==null?void 0:a.cursor();if(u&&(n<0?u.childBefore(i.from):u.childAfter(i.to)))do if(n<0?u.to<=i.from:u.from>=i.to){if(c==0&&s.indexOf(u.type.name)>-1&&u.from<u.to){let d=f_(u);return{start:l,end:d?{from:d.from,to:d.to}:void 0,matched:!0}}else if(d_(u.type,n,o))c++;else if(d_(u.type,-n,o)){if(c==0){let d=f_(u);return{start:l,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1}}c--}}while(n<0?u.prevSibling():u.nextSibling());return{start:l,matched:!1}}function Fhe(t,e,n,i,r,s,o){let a=n<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=n>0)return null;let c={from:n<0?e-1:e,to:n>0?e+1:e},u=t.doc.iterRange(e,n>0?t.doc.length:0),d=0;for(let f=0;!u.next().done&&f<=s;){let p=u.value;n<0&&(f+=p.length);let m=e+f*n;for(let g=n>0?0:p.length-1,y=n>0?p.length:-1;g!=y;g+=n){let v=o.indexOf(p[g]);if(!(v<0||i.resolveInner(m+g,1).type!=r))if(v%2==0==n>0)d++;else{if(d==1)return{start:c,end:{from:m+g,to:m+g+1},matched:v>>1==l>>1};d--}}n>0&&(f+=p.length)}return u.done?{start:c,matched:!1}:null}function _T(t,e,n,i=0,r=0){e==null&&(e=t.search(/[^\s\u00a0]/),e==-1&&(e=t.length));let s=r;for(let o=i;o<e;o++)t.charCodeAt(o)==9?s+=n-s%n:s++;return s}class jz{constructor(e,n,i,r){this.string=e,this.tabSize=n,this.indentUnit=i,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let n=this.string.charAt(this.pos),i;if(typeof e=="string"?i=n==e:i=n&&(e instanceof RegExp?e.test(n):e(n)),i)return++this.pos,n}eatWhile(e){let n=this.pos;for(;this.eat(e););return this.pos>n}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let n=this.string.indexOf(e,this.pos);if(n>-1)return this.pos=n,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=_T(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:_T(this.string,null,this.tabSize)}match(e,n,i){if(typeof e=="string"){let r=o=>i?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return r(s)==r(e)?(n!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&n!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function zhe(t){return{name:t.name||"",token:t.token,blankLine:t.blankLine||(()=>{}),startState:t.startState||(()=>!0),copyState:t.copyState||Uhe,indent:t.indent||(()=>null),languageData:t.languageData||{},tokenTable:t.tokenTable||DA,mergeTokens:t.mergeTokens!==!1}}function Uhe(t){if(typeof t!="object")return t;let e={};for(let n in t){let i=t[n];e[n]=i instanceof Array?i.slice():i}return e}const CT=new WeakMap;class OA extends Rs{constructor(e){let n=she(e.languageData),i=zhe(e),r,s=new class extends kz{createParse(o,a,l){return new Hhe(r,o,a,l)}};super(n,s,[],e.name),this.topNode=qhe(n,this),r=this,this.streamParser=i,this.stateAfter=new Et({perNode:!0}),this.tokenTable=e.tokenTable?new zz(i.tokenTable):Ghe}static define(e){return new OA(e)}getIndent(e){let n,{overrideIndentation:i}=e.options;i&&(n=CT.get(e.state),n!=null&&n<e.pos-1e4&&(n=void 0));let r=LA(this,e.node.tree,e.node.from,e.node.from,n??e.pos),s,o;if(r?(o=r.state,s=r.pos+1):(o=this.streamParser.startState(e.unit),s=e.node.from),e.pos-s>1e4)return null;for(;s<e.pos;){let l=e.state.doc.lineAt(s),c=Math.min(e.pos,l.to);if(l.length){let u=i?i(l.from):-1,d=new jz(l.text,e.state.tabSize,e.unit,u<0?void 0:u);for(;d.pos<c-l.from;)$z(this.streamParser.token,d,o)}else this.streamParser.blankLine(o,e.unit);if(c==e.pos)break;s=l.to+1}let a=e.lineAt(e.pos);return i&&n==null&&CT.set(e.state,a.from),this.streamParser.indent(o,/^\s*(.*)/.exec(a.text)[1],e)}get allowsNesting(){return!1}}function LA(t,e,n,i,r){let s=n>=i&&n+e.length<=r&&e.prop(t.stateAfter);if(s)return{state:t.streamParser.copyState(s),pos:n+e.length};for(let o=e.children.length-1;o>=0;o--){let a=e.children[o],l=n+e.positions[o],c=a instanceof pn&&l<r&&LA(t,a,l,i,r);if(c)return c}return null}function Bz(t,e,n,i,r){if(r&&n<=0&&i>=e.length)return e;!r&&n==0&&e.type==t.topNode&&(r=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],a=e.children[s],l;if(o<i&&a instanceof pn){if(!(l=Bz(t,a,n-o,i-o,r)))break;return r?new pn(e.type,e.children.slice(0,s).concat(l),e.positions.slice(0,s+1),o+l.length):l}}return null}function Vhe(t,e,n,i,r){for(let s of e){let o=s.from+(s.openStart?25:0),a=s.to-(s.openEnd?25:0),l=o<=n&&a>n&&LA(t,s.tree,0-s.offset,n,a),c;if(l&&l.pos<=i&&(c=Bz(t,s.tree,n+s.offset,l.pos+s.offset,!1)))return{state:l.state,tree:c}}return{state:t.streamParser.startState(r?cu(r):4),tree:pn.empty}}class Hhe{constructor(e,n,i,r){this.lang=e,this.input=n,this.fragments=i,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let s=gf.get(),o=r[0].from,{state:a,tree:l}=Vhe(e,i,o,this.to,s==null?void 0:s.state);this.state=a,this.parsedPos=this.chunkStart=o+l.length;for(let c=0;c<l.children.length;c++)this.chunks.push(l.children[c]),this.chunkPos.push(l.positions[c]);s&&this.parsedPos<s.viewport.from-1e5&&r.some(c=>c.from<=s.viewport.from&&c.to>=s.viewport.from)&&(this.state=this.lang.streamParser.startState(cu(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=gf.get(),n=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),i=Math.min(n,this.chunkStart+2048);for(e&&(i=Math.min(i,e.viewport.to));this.parsedPos<i;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=n?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,n),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let n=this.input.chunk(e);if(this.input.lineChunks)n==`
`&&(n="");else{let i=n.indexOf(`
`);i>-1&&(n=n.slice(0,i))}return e+n.length<=this.to?n:n.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,n=this.lineAfter(e),i=e+n.length;for(let r=this.rangeIndex;;){let s=this.ranges[r].to;if(s>=i||(n=n.slice(0,s-(i-n.length)),r++,r==this.ranges.length))break;let o=this.ranges[r].from,a=this.lineAfter(o);n+=a,i=o+a.length}return{line:n,end:i}}skipGapsTo(e,n,i){for(;;){let r=this.ranges[this.rangeIndex].to,s=e+n;if(i>0?r>s:r>=s)break;let o=this.ranges[++this.rangeIndex].from;n+=o-r}return n}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,n,i,r){let s=4;if(this.ranges.length>1){r=this.skipGapsTo(n,r,1),n+=r;let a=this.chunk.length;r=this.skipGapsTo(i,r,-1),i+=r,s+=this.chunk.length-a}let o=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&s==4&&o>=0&&this.chunk[o]==e&&this.chunk[o+2]==n?this.chunk[o+2]=i:this.chunk.push(e,n,i,s),r}parseLine(e){let{line:n,end:i}=this.nextLine(),r=0,{streamParser:s}=this.lang,o=new jz(n,e?e.state.tabSize:4,e?cu(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let a=$z(s.token,o,this.state);if(a&&(r=this.emitToken(this.lang.tokenTable.resolve(a),this.parsedPos+o.start,this.parsedPos+o.pos,r)),o.start>1e4)break}this.parsedPos=i,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=pn.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Whe,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new pn(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new pn(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function $z(t,e,n){e.start=e.pos;for(let i=0;i<10;i++){let r=t(e,n);if(e.pos>e.start)return r}throw new Error("Stream parser failed to advance stream.")}const DA=Object.create(null),hm=[ur.none],Whe=new EA(hm),ET=[],AT=Object.create(null),Fz=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Fz[t]=Uz(DA,e);class zz{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),Fz)}resolve(e){return e?this.table[e]||(this.table[e]=Uz(this.extra,e)):0}}const Ghe=new zz(DA);function Aw(t,e){ET.indexOf(t)>-1||(ET.push(t),console.warn(e))}function Uz(t,e){let n=[];for(let a of e.split(" ")){let l=[];for(let c of a.split(".")){let u=t[c]||Ze[c];u?typeof u=="function"?l.length?l=l.map(u):Aw(c,`Modifier ${c} used at start of tag`):l.length?Aw(c,`Tag ${c} used as modifier`):l=Array.isArray(u)?u:[u]:Aw(c,`Unknown highlighting tag ${c}`)}for(let c of l)n.push(c)}if(!n.length)return 0;let i=e.replace(/ /g,"_"),r=i+" "+n.map(a=>a.id),s=AT[r];if(s)return s.id;let o=AT[r]=ur.define({id:hm.length,name:i,props:[ehe({[i]:n})]});return hm.push(o),o.id}function qhe(t,e){let n=ur.define({id:hm.length,name:"Document",props:[cd.add(()=>t),Az.add(()=>i=>e.getIndent(i))],top:!0});return hm.push(n),n}rn.RTL,rn.LTR;const Khe=t=>{let{state:e}=t,n=e.doc.lineAt(e.selection.main.from),i=jA(t.state,n.from);return i.line?Xhe(t):i.block?Qhe(t):!1};function Gm(t,e){return({state:n,dispatch:i})=>{if(n.readOnly)return!1;let r=t(e,n);return r?(i(n.update(r)),!0):!1}}const Xhe=Gm(BA,0),Yhe=Gm(BA,1),Jhe=Gm(BA,2),Zhe=Gm(Vz,0),Qhe=Gm((t,e)=>Vz(t,e,tpe(e)),0);function jA(t,e){let n=t.languageDataAt("commentTokens",e,1);return n.length?n[0]:{}}const oh=50;function epe(t,{open:e,close:n},i,r){let s=t.sliceDoc(i-oh,i),o=t.sliceDoc(r,r+oh),a=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(o)[0].length,c=s.length-a;if(s.slice(c-e.length,c)==e&&o.slice(l,l+n.length)==n)return{open:{pos:i-a,margin:a&&1},close:{pos:r+l,margin:l&&1}};let u,d;r-i<=2*oh?u=d=t.sliceDoc(i,r):(u=t.sliceDoc(i,i+oh),d=t.sliceDoc(r-oh,r));let f=/^\s*/.exec(u)[0].length,p=/\s*$/.exec(d)[0].length,m=d.length-p-n.length;return u.slice(f,f+e.length)==e&&d.slice(m,m+n.length)==n?{open:{pos:i+f+e.length,margin:/\s/.test(u.charAt(f+e.length))?1:0},close:{pos:r-p-n.length,margin:/\s/.test(d.charAt(m-1))?1:0}}:null}function tpe(t){let e=[];for(let n of t.selection.ranges){let i=t.doc.lineAt(n.from),r=n.to<=i.to?i:t.doc.lineAt(n.to);r.from>i.from&&r.from==n.to&&(r=n.to==i.to+1?i:t.doc.lineAt(n.to-1));let s=e.length-1;s>=0&&e[s].to>i.from?e[s].to=r.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:r.to})}return e}function Vz(t,e,n=e.selection.ranges){let i=n.map(s=>jA(e,s.from).block);if(!i.every(s=>s))return null;let r=n.map((s,o)=>epe(e,i[o],s.from,s.to));if(t!=2&&!r.every(s=>s))return{changes:e.changes(n.map((s,o)=>r[o]?[]:[{from:s.from,insert:i[o].open+" "},{from:s.to,insert:" "+i[o].close}]))};if(t!=1&&r.some(s=>s)){let s=[];for(let o=0,a;o<r.length;o++)if(a=r[o]){let l=i[o],{open:c,close:u}=a;s.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+l.close.length})}return{changes:s}}return null}function BA(t,e,n=e.selection.ranges){let i=[],r=-1;for(let{from:s,to:o}of n){let a=i.length,l=1e9,c=jA(e,s).line;if(c){for(let u=s;u<=o;){let d=e.doc.lineAt(u);if(d.from>r&&(s==o||o>d.from)){r=d.from;let f=/^\s*/.exec(d.text)[0].length,p=f==d.length,m=d.text.slice(f,f+c.length)==c?f:-1;f<d.text.length&&f<l&&(l=f),i.push({line:d,comment:m,token:c,indent:f,empty:p,single:!1})}u=d.to+1}if(l<1e9)for(let u=a;u<i.length;u++)i[u].indent<i[u].line.text.length&&(i[u].indent=l);i.length==a+1&&(i[a].single=!0)}}if(t!=2&&i.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:a,token:l,indent:c,empty:u,single:d}of i)(d||!u)&&s.push({from:a.from+c,insert:l+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(t!=1&&i.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:a,token:l}of i)if(a>=0){let c=o.from+a,u=c+l.length;o.text[u-o.from]==" "&&u++,s.push({from:c,to:u})}return{changes:s}}return null}const h_=Ca.define(),npe=Ca.define(),ipe=Re.define(),Hz=Re.define({combine(t){return Ql(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(i,r)=>e(i,r)||n(i,r)})}}),Wz=$i.define({create(){return yo.empty},update(t,e){let n=e.state.facet(Hz),i=e.annotation(h_);if(i){let l=or.fromTransaction(e,i.selection),c=i.side,u=c==0?t.undone:t.done;return l?u=zy(u,u.length,n.minDepth,l):u=Kz(u,e.startState.selection),new yo(c==0?i.rest:u,c==0?u:i.rest)}let r=e.annotation(npe);if((r=="full"||r=="before")&&(t=t.isolate()),e.annotation(zn.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let s=or.fromTransaction(e),o=e.annotation(zn.time),a=e.annotation(zn.userEvent);return s?t=t.addChanges(s,o,a,n,e):e.selection&&(t=t.addSelection(e.startState.selection,o,a,n.newGroupDelay)),(r=="full"||r=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new yo(t.done.map(or.fromJSON),t.undone.map(or.fromJSON))}});function rpe(t={}){return[Wz,Hz.of(t),De.domEventHandlers({beforeinput(e,n){let i=e.inputType=="historyUndo"?Gz:e.inputType=="historyRedo"?p_:null;return i?(e.preventDefault(),i(n)):!1}})]}function $A(t,e){return function({state:n,dispatch:i}){if(!e&&n.readOnly)return!1;let r=n.field(Wz,!1);if(!r)return!1;let s=r.pop(t,n,e);return s?(i(s),!0):!1}}const Gz=$A(0,!1),p_=$A(1,!1),spe=$A(0,!0);class or{constructor(e,n,i,r,s){this.changes=e,this.effects=n,this.mapped=i,this.startSelection=r,this.selectionsAfter=s}setSelAfter(e){return new or(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new or(e.changes&&jn.fromJSON(e.changes),[],e.mapped&&Co.fromJSON(e.mapped),e.startSelection&&le.fromJSON(e.startSelection),e.selectionsAfter.map(le.fromJSON))}static fromTransaction(e,n){let i=Qr;for(let r of e.startState.facet(ipe)){let s=r(e);s.length&&(i=i.concat(s))}return!i.length&&e.changes.empty?null:new or(e.changes.invert(e.startState.doc),i,void 0,n||e.startState.selection,Qr)}static selection(e){return new or(void 0,Qr,void 0,void 0,e)}}function zy(t,e,n,i){let r=e+1>n+20?e-n-1:0,s=t.slice(r,e);return s.push(i),s}function ope(t,e){let n=[],i=!1;return t.iterChangedRanges((r,s)=>n.push(r,s)),e.iterChangedRanges((r,s,o,a)=>{for(let l=0;l<n.length;){let c=n[l++],u=n[l++];a>=c&&o<=u&&(i=!0)}}),i}function ape(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((n,i)=>n.empty!=e.ranges[i].empty).length===0}function qz(t,e){return t.length?e.length?t.concat(e):t:e}const Qr=[],lpe=200;function Kz(t,e){if(t.length){let n=t[t.length-1],i=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-lpe));return i.length&&i[i.length-1].eq(e)?t:(i.push(e),zy(t,t.length-1,1e9,n.setSelAfter(i)))}else return[or.selection([e])]}function cpe(t){let e=t[t.length-1],n=t.slice();return n[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function Pw(t,e){if(!t.length)return t;let n=t.length,i=Qr;for(;n;){let r=upe(t[n-1],e,i);if(r.changes&&!r.changes.empty||r.effects.length){let s=t.slice(0,n);return s[n-1]=r,s}else e=r.mapped,n--,i=r.selectionsAfter}return i.length?[or.selection(i)]:Qr}function upe(t,e,n){let i=qz(t.selectionsAfter.length?t.selectionsAfter.map(a=>a.map(e)):Qr,n);if(!t.changes)return or.selection(i);let r=t.changes.map(e),s=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(s):s;return new or(r,ft.mapEffects(t.effects,e),o,t.startSelection.map(s),i)}const dpe=/^(input\.type|delete)($|\.)/;class yo{constructor(e,n,i=0,r=void 0){this.done=e,this.undone=n,this.prevTime=i,this.prevUserEvent=r}isolate(){return this.prevTime?new yo(this.done,this.undone):this}addChanges(e,n,i,r,s){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!i||dpe.test(i))&&(!a.selectionsAfter.length&&n-this.prevTime<r.newGroupDelay&&r.joinToEvent(s,ope(a.changes,e.changes))||i=="input.type.compose")?o=zy(o,o.length-1,r.minDepth,new or(e.changes.compose(a.changes),qz(ft.mapEffects(e.effects,a.changes),a.effects),a.mapped,a.startSelection,Qr)):o=zy(o,o.length,r.minDepth,e),new yo(o,Qr,n,i)}addSelection(e,n,i,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Qr;return s.length>0&&n-this.prevTime<r&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&ape(s[s.length-1],e)?this:new yo(Kz(this.done,e),this.undone,n,i)}addMapping(e){return new yo(Pw(this.done,e),Pw(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,i){let r=e==0?this.done:this.undone;if(r.length==0)return null;let s=r[r.length-1],o=s.selectionsAfter[0]||n.selection;if(i&&s.selectionsAfter.length)return n.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:h_.of({side:e,rest:cpe(r),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let a=r.length==1?Qr:r.slice(0,r.length-1);return s.mapped&&(a=Pw(a,s.mapped)),n.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:h_.of({side:e,rest:a,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}yo.empty=new yo(Qr,Qr);function qm(t,e){return le.create(t.ranges.map(e),t.mainIndex)}function sc(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function pu({state:t,dispatch:e},n){let i=qm(t.selection,n);return i.eq(t.selection,!0)?!1:(e(sc(t,i)),!0)}function w1(t,e){return le.cursor(e?t.to:t.from)}function Xz(t,e){return pu(t,n=>n.empty?t.moveByChar(n,e):w1(n,e))}function oc(t){return t.textDirectionAt(t.state.selection.main.head)==rn.LTR}const PT=t=>Xz(t,!oc(t)),NT=t=>Xz(t,oc(t));function Yz(t,e){return pu(t,n=>n.empty?t.moveByGroup(n,e):w1(n,e))}const fpe=t=>Yz(t,!oc(t)),hpe=t=>Yz(t,oc(t));function Jz(t,e){return pu(t,n=>{if(!n.empty)return w1(n,e);let i=t.moveVertically(n,e);return i.head!=n.head?i:t.moveToLineBoundary(n,e)})}const MT=t=>Jz(t,!1),RT=t=>Jz(t,!0);function Zz(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,i=0,r;if(e){for(let s of t.state.facet(De.scrollMargins)){let o=s(t);o!=null&&o.top&&(n=Math.max(o==null?void 0:o.top,n)),o!=null&&o.bottom&&(i=Math.max(o==null?void 0:o.bottom,i))}r=t.scrollDOM.clientHeight-n-i}else r=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:i,selfScroll:e,height:Math.max(t.defaultLineHeight,r-5)}}function Qz(t,e){let n=Zz(t),{state:i}=t,r=qm(i.selection,o=>o.empty?t.moveVertically(o,e,n.height):w1(o,e));if(r.eq(i.selection))return!1;let s;if(n.selfScroll){let o=t.coordsAtPos(i.selection.main.head),a=t.scrollDOM.getBoundingClientRect(),l=a.top+n.marginTop,c=a.bottom-n.marginBottom;o&&o.top>l&&o.bottom<c&&(s=De.scrollIntoView(r.main.head,{y:"start",yMargin:o.top-l}))}return t.dispatch(sc(i,r),{effects:s}),!0}const Nw=t=>Qz(t,!1),Mw=t=>Qz(t,!0);function S1(t,e,n){let i=t.lineBlockAt(e.head),r=t.moveToLineBoundary(e,n);if(r.head==e.head&&r.head!=(n?i.to:i.from)&&(r=t.moveToLineBoundary(e,n,!1)),!n&&r.head==i.from&&i.length){let s=/^\s*/.exec(t.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&e.head!=i.from+s&&(r=le.cursor(i.from+s))}return r}const IT=t=>pu(t,e=>S1(t,e,!0)),TT=t=>pu(t,e=>S1(t,e,!1)),ppe=t=>pu(t,e=>le.cursor(t.lineBlockAt(e.head).from,1)),mpe=t=>pu(t,e=>le.cursor(t.lineBlockAt(e.head).to,-1));function gpe(t,e,n){let i=!1,r=qm(t.selection,s=>{let o=g0(t,s.head,-1)||g0(t,s.head,1)||s.head>0&&g0(t,s.head-1,1)||s.head<t.doc.length&&g0(t,s.head+1,-1);if(!o||!o.end)return s;i=!0;let a=o.start.from==s.head?o.end.to:o.end.from;return le.cursor(a)});return i?(e(sc(t,r)),!0):!1}const vpe=({state:t,dispatch:e})=>gpe(t,e);function ac(t,e){let n=qm(t.state.selection,i=>{let r=e(i);return le.range(i.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return n.eq(t.state.selection)?!1:(t.dispatch(sc(t.state,n)),!0)}function e9(t,e){return ac(t,n=>t.moveByChar(n,e))}const OT=t=>e9(t,!oc(t)),LT=t=>e9(t,oc(t));function t9(t,e){return ac(t,n=>t.moveByGroup(n,e))}const ype=t=>t9(t,!oc(t)),bpe=t=>t9(t,oc(t));function n9(t,e){return ac(t,n=>t.moveVertically(n,e))}const DT=t=>n9(t,!1),jT=t=>n9(t,!0);function i9(t,e){return ac(t,n=>t.moveVertically(n,e,Zz(t).height))}const BT=t=>i9(t,!1),$T=t=>i9(t,!0),FT=t=>ac(t,e=>S1(t,e,!0)),zT=t=>ac(t,e=>S1(t,e,!1)),xpe=t=>ac(t,e=>le.cursor(t.lineBlockAt(e.head).from)),wpe=t=>ac(t,e=>le.cursor(t.lineBlockAt(e.head).to)),UT=({state:t,dispatch:e})=>(e(sc(t,{anchor:0})),!0),VT=({state:t,dispatch:e})=>(e(sc(t,{anchor:t.doc.length})),!0),HT=({state:t,dispatch:e})=>(e(sc(t,{anchor:t.selection.main.anchor,head:0})),!0),WT=({state:t,dispatch:e})=>(e(sc(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),Spe=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),kpe=({state:t,dispatch:e})=>{let n=_1(t).map(({from:i,to:r})=>le.range(i,Math.min(r+1,t.doc.length)));return e(t.update({selection:le.create(n),userEvent:"select"})),!0};function k1(t,e){if(t.state.readOnly)return!1;let n="delete.selection",{state:i}=t,r=i.changeByRange(s=>{let{from:o,to:a}=s;if(o==a){let l=e(s);l<o?(n="delete.backward",l=v0(t,l,!1)):l>o&&(n="delete.forward",l=v0(t,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=v0(t,o,!1),a=v0(t,a,!0);return o==a?{range:s}:{changes:{from:o,to:a},range:le.cursor(o,o<s.head?-1:1)}});return r.changes.empty?!1:(t.dispatch(i.update(r,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?De.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function v0(t,e,n){if(t instanceof De)for(let i of t.state.facet(De.atomicRanges).map(r=>r(t)))i.between(e,e,(r,s)=>{r<e&&s>e&&(e=n?s:r)});return e}const r9=(t,e,n)=>k1(t,i=>{let r=i.from,{state:s}=t,o=s.doc.lineAt(r),a,l;if(n&&!e&&r>o.from&&r<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,r-o.from))){if(a[a.length-1]=="	")return r-1;let c=Im(a,s.tabSize),u=c%cu(s)||cu(s);for(let d=0;d<u&&a[a.length-1-d]==" ";d++)r--;l=r}else l=si(o.text,r-o.from,e,e)+o.from,l==r&&o.number!=(e?s.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,r-o.from))&&(l=si(o.text,l-o.from,!1,!1)+o.from);return l}),Rw=t=>r9(t,!1,!0),GT=t=>r9(t,!0,!1),s9=(t,e)=>k1(t,n=>{let i=n.head,{state:r}=t,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let a=null;;){if(i==(e?s.to:s.from)){i==n.head&&s.number!=(e?r.doc.lines:1)&&(i+=e?1:-1);break}let l=si(s.text,i-s.from,e)+s.from,c=s.text.slice(Math.min(i,l)-s.from,Math.max(i,l)-s.from),u=o(c);if(a!=null&&u!=a)break;(c!=" "||i!=n.head)&&(a=u),i=l}return i}),qT=t=>s9(t,!1),_pe=t=>s9(t,!0),KT=t=>k1(t,e=>{let n=t.lineBlockAt(e.head).to;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),Cpe=t=>k1(t,e=>{let n=t.lineBlockAt(e.head).from;return e.head>n?n:Math.max(0,e.head-1)}),Epe=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:At.of(["",""])},range:le.cursor(i.from)}));return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},Ape=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(i=>{if(!i.empty||i.from==0||i.from==t.doc.length)return{range:i};let r=i.from,s=t.doc.lineAt(r),o=r==s.from?r-1:si(s.text,r-s.from,!1)+s.from,a=r==s.to?r+1:si(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:a,insert:t.doc.slice(r,a).append(t.doc.slice(o,r))},range:le.cursor(a)}});return n.changes.empty?!1:(e(t.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function _1(t){let e=[],n=-1;for(let i of t.selection.ranges){let r=t.doc.lineAt(i.from),s=t.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=t.doc.lineAt(i.to-1)),n>=r.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(i)}else e.push({from:r.from,to:s.to,ranges:[i]});n=s.number+1}return e}function o9(t,e,n){if(t.readOnly)return!1;let i=[],r=[];for(let s of _1(t)){if(n?s.to==t.doc.length:s.from==0)continue;let o=t.doc.lineAt(n?s.to+1:s.from-1),a=o.length+1;if(n){i.push({from:s.to,to:o.to},{from:s.from,insert:o.text+t.lineBreak});for(let l of s.ranges)r.push(le.range(Math.min(t.doc.length,l.anchor+a),Math.min(t.doc.length,l.head+a)))}else{i.push({from:o.from,to:s.from},{from:s.to,insert:t.lineBreak+o.text});for(let l of s.ranges)r.push(le.range(l.anchor-a,l.head-a))}}return i.length?(e(t.update({changes:i,scrollIntoView:!0,selection:le.create(r,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Ppe=({state:t,dispatch:e})=>o9(t,e,!1),Npe=({state:t,dispatch:e})=>o9(t,e,!0);function a9(t,e,n){if(t.readOnly)return!1;let i=[];for(let r of _1(t))n?i.push({from:r.from,insert:t.doc.slice(r.from,r.to)+t.lineBreak}):i.push({from:r.to,insert:t.lineBreak+t.doc.slice(r.from,r.to)});return e(t.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Mpe=({state:t,dispatch:e})=>a9(t,e,!1),Rpe=({state:t,dispatch:e})=>a9(t,e,!0),Ipe=t=>{if(t.state.readOnly)return!1;let{state:e}=t,n=e.changes(_1(e).map(({from:r,to:s})=>(r>0?r--:s<e.doc.length&&s++,{from:r,to:s}))),i=qm(e.selection,r=>{let s;if(t.lineWrapping){let o=t.lineBlockAt(r.head),a=t.coordsAtPos(r.head,r.assoc||1);a&&(s=o.bottom+t.documentTop-a.bottom+t.defaultLineHeight/2)}return t.moveVertically(r,!0,s)}).map(n);return t.dispatch({changes:n,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Tpe(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=To(t).resolveInner(e),i=n.childBefore(e),r=n.childAfter(e),s;return i&&r&&i.to<=e&&r.from>=e&&(s=i.type.prop(Et.closedBy))&&s.indexOf(r.name)>-1&&t.doc.lineAt(i.to).from==t.doc.lineAt(r.from).from&&!/\S/.test(t.sliceDoc(i.to,r.from))?{from:i.to,to:r.from}:null}const XT=Ope(!1);function Ope(t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let i=e.changeByRange(r=>{let{from:s,to:o}=r,a=e.doc.lineAt(s),l=!t&&s==o&&Tpe(e,s);t&&(s=o=(o<=a.to?a:e.doc.lineAt(o)).to);let c=new RA(e,{simulateBreak:s,simulateDoubleBreak:!!l}),u=dhe(c,s);for(u==null&&(u=Im(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:s,to:o}=l:s>a.from&&s<a.from+100&&!/\S/.test(a.text.slice(0,s))&&(s=a.from);let d=["",c_(e,u)];return l&&d.push(c_(e,c.lineIndent(a.from,-1))),{changes:{from:s,to:o,insert:At.of(d)},range:le.cursor(s+1+d[1].length)}});return n(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function l9(t,e){let n=-1;return t.changeByRange(i=>{let r=[];for(let o=i.from;o<=i.to;){let a=t.doc.lineAt(o);a.number>n&&(i.empty||i.to>a.from)&&(e(a,r,i),n=a.number),o=a.to+1}let s=t.changes(r);return{changes:r,range:le.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const m_=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(l9(t,(n,i)=>{i.push({from:n.from,insert:t.facet(MA)})}),{userEvent:"input.indent"})),!0),YT=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(l9(t,(n,i)=>{let r=/^\s*/.exec(n.text)[0];if(!r)return;let s=Im(r,t.tabSize),o=0,a=c_(t,Math.max(0,s-cu(t)));for(;o<r.length&&o<a.length&&r.charCodeAt(o)==a.charCodeAt(o);)o++;i.push({from:n.from+o,to:n.from+r.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),JT=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class pm{constructor(e,n,i=0,r=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,r),this.bufferStart=i,this.normalize=s?a=>s(JT(a)):JT,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return qr(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=lE(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=ia(e);let r=this.normalize(n);if(r.length)for(let s=0,o=i;;s++){let a=r.charCodeAt(s),l=this.match(a,o,this.bufferPos+this.bufferStart);if(s==r.length-1){if(l)return this.value=l,this;break}o==i&&s<n.length&&n.charCodeAt(s)==a&&o++}}}match(e,n,i){let r=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],a=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?r={from:this.matches[s+1],to:i}:(this.matches[s]++,a=!0)),a||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:n,to:i}:this.matches.push(1,n)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(pm.prototype[Symbol.iterator]=function(){return this});const c9={from:-1,to:-1,match:/.*/.exec("")},FA="gm"+(/x/.unicode==null?"":"u");class u9{constructor(e,n,i,r=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=c9,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new d9(e,n,i,r,s);this.re=new RegExp(n,FA+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=Uy(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let i=this.curLineStart+n.index,r=i+n[0].length;if(this.matchPos=Uy(this.text,r+(i==r?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<r||i>this.value.to)&&(!this.test||this.test(i,r,n)))return this.value={from:i,to:r,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Iw=new WeakMap;class Rd{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,i){let r=Iw.get(e);if(!r||r.from>=i||r.to<=n){let a=new Rd(n,e.sliceString(n,i));return Iw.set(e,a),a}if(r.from==n&&r.to==i)return r;let{text:s,from:o}=r;return o>n&&(s=e.sliceString(n,o)+s,o=n),r.to<i&&(s+=e.sliceString(r.to,i)),Iw.set(e,new Rd(o,s)),new Rd(n,s.slice(n-o,i-o))}}class d9{constructor(e,n,i,r,s){this.text=e,this.to=s,this.done=!1,this.value=c9,this.matchPos=Uy(e,r),this.re=new RegExp(n,FA+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=Rd.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let i=this.flat.from+n.index,r=i+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,r,n)))return this.value={from:i,to:r,match:n},this.matchPos=Uy(this.text,r+(i==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Rd.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(u9.prototype[Symbol.iterator]=d9.prototype[Symbol.iterator]=function(){return this});function Lpe(t){try{return new RegExp(t,FA),!0}catch{return!1}}function Uy(t,e){if(e>=t.length)return e;let n=t.lineAt(e),i;for(;e<n.to&&(i=n.text.charCodeAt(e-n.from))>=56320&&i<57344;)e++;return e}function g_(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),n=Vt("input",{class:"cm-textfield",name:"line",value:e}),i=Vt("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),t.dispatch({effects:op.of(!1)}),t.focus()):s.keyCode==13&&(s.preventDefault(),r())},onsubmit:s=>{s.preventDefault(),r()}},Vt("label",t.state.phrase("Go to line"),": ",n)," ",Vt("button",{class:"cm-button",type:"submit"},t.state.phrase("go")),Vt("button",{name:"close",onclick:()=>{t.dispatch({effects:op.of(!1)}),t.focus()},"aria-label":t.state.phrase("close"),type:"button"},["×"]));function r(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!s)return;let{state:o}=t,a=o.doc.lineAt(o.selection.main.head),[,l,c,u,d]=s,f=u?+u.slice(1):0,p=c?+c:a.number;if(c&&d){let y=p/100;l&&(y=y*(l=="-"?-1:1)+a.number/o.doc.lines),p=Math.round(o.doc.lines*y)}else c&&l&&(p=p*(l=="-"?-1:1)+a.number);let m=o.doc.line(Math.max(1,Math.min(o.doc.lines,p))),g=le.cursor(m.from+Math.max(0,Math.min(f,m.length)));t.dispatch({effects:[op.of(!1),De.scrollIntoView(g.from,{y:"center"})],selection:g}),t.focus()}return{dom:i}}const op=ft.define(),ZT=$i.define({create(){return!0},update(t,e){for(let n of e.effects)n.is(op)&&(t=n.value);return t},provide:t=>Jp.from(t,e=>e?g_:null)}),Dpe=t=>{let e=Yp(t,g_);if(!e){let n=[op.of(!0)];t.state.field(ZT,!1)==null&&n.push(ft.appendConfig.of([ZT,jpe])),t.dispatch({effects:n}),e=Yp(t,g_)}return e&&e.dom.querySelector("input").select(),!0},jpe=De.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),Bpe=({state:t,dispatch:e})=>{let{selection:n}=t,i=le.create(n.ranges.map(r=>t.wordAt(r.head)||le.cursor(r.head)),n.mainIndex);return i.eq(n)?!1:(e(t.update({selection:i})),!0)};function $pe(t,e){let{main:n,ranges:i}=t.selection,r=t.wordAt(n.head),s=r&&r.from==n.from&&r.to==n.to;for(let o=!1,a=new pm(t.doc,e,i[i.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new pm(t.doc,e,0,Math.max(0,i[i.length-1].from-1)),o=!0}else{if(o&&i.some(l=>l.from==a.value.from))continue;if(s){let l=t.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const Fpe=({state:t,dispatch:e})=>{let{ranges:n}=t.selection;if(n.some(s=>s.from===s.to))return Bpe({state:t,dispatch:e});let i=t.sliceDoc(n[0].from,n[0].to);if(t.selection.ranges.some(s=>t.sliceDoc(s.from,s.to)!=i))return!1;let r=$pe(t,i);return r?(e(t.update({selection:t.selection.addRange(le.range(r.from,r.to),!1),effects:De.scrollIntoView(r.to)})),!0):!1},Tf=Re.define({combine(t){return Ql(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Xpe(e),scrollToMatch:e=>De.scrollIntoView(e)})}});class f9{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||Lpe(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new Hpe(this):new Upe(this)}getCursor(e,n=0,i){let r=e.doc?e:St.create({doc:e});return i==null&&(i=r.doc.length),this.regexp?Uu(this,r,n,i):zu(this,r,n,i)}}class h9{constructor(e){this.spec=e}}function zu(t,e,n,i){return new pm(e.doc,t.unquoted,n,i,t.caseSensitive?void 0:r=>r.toLowerCase(),t.wholeWord?zpe(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function zpe(t,e){return(n,i,r,s)=>((s>n||s+r.length<i)&&(s=Math.max(0,n-2),r=t.sliceString(s,Math.min(t.length,i+2))),(e(Vy(r,n-s))!=oi.Word||e(Hy(r,n-s))!=oi.Word)&&(e(Hy(r,i-s))!=oi.Word||e(Vy(r,i-s))!=oi.Word))}class Upe extends h9{constructor(e){super(e)}nextMatch(e,n,i){let r=zu(this.spec,e,i,e.doc.length).nextOverlapping();if(r.done){let s=Math.min(e.doc.length,n+this.spec.unquoted.length);r=zu(this.spec,e,0,s).nextOverlapping()}return r.done||r.value.from==n&&r.value.to==i?null:r.value}prevMatchInRange(e,n,i){for(let r=i;;){let s=Math.max(n,r-1e4-this.spec.unquoted.length),o=zu(this.spec,e,s,r),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(s==n)return null;r-=1e4}}prevMatch(e,n,i){let r=this.prevMatchInRange(e,0,n);return r||(r=this.prevMatchInRange(e,Math.max(0,i-this.spec.unquoted.length),e.doc.length)),r&&(r.from!=n||r.to!=i)?r:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let i=zu(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=n)return null;r.push(i.value)}return r}highlight(e,n,i,r){let s=zu(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}function Uu(t,e,n,i){return new u9(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?Vpe(e.charCategorizer(e.selection.main.head)):void 0},n,i)}function Vy(t,e){return t.slice(si(t,e,!1),e)}function Hy(t,e){return t.slice(e,si(t,e))}function Vpe(t){return(e,n,i)=>!i[0].length||(t(Vy(i.input,i.index))!=oi.Word||t(Hy(i.input,i.index))!=oi.Word)&&(t(Hy(i.input,i.index+i[0].length))!=oi.Word||t(Vy(i.input,i.index+i[0].length))!=oi.Word)}class Hpe extends h9{nextMatch(e,n,i){let r=Uu(this.spec,e,i,e.doc.length).next();return r.done&&(r=Uu(this.spec,e,0,n).next()),r.done?null:r.value}prevMatchInRange(e,n,i){for(let r=1;;r++){let s=Math.max(n,i-r*1e4),o=Uu(this.spec,e,s,i),a=null;for(;!o.next().done;)a=o.value;if(a&&(s==n||a.from>s+10))return a;if(s==n)return null}}prevMatch(e,n,i){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(n,i)=>{if(i=="&")return e.match[0];if(i=="$")return"$";for(let r=i.length;r>0;r--){let s=+i.slice(0,r);if(s>0&&s<e.match.length)return e.match[s]+i.slice(r)}return n})}matchAll(e,n){let i=Uu(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=n)return null;r.push(i.value)}return r}highlight(e,n,i,r){let s=Uu(this.spec,e,Math.max(0,n-250),Math.min(i+250,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}const mm=ft.define(),zA=ft.define(),Pl=$i.define({create(t){return new Tw(v_(t).create(),null)},update(t,e){for(let n of e.effects)n.is(mm)?t=new Tw(n.value.create(),t.panel):n.is(zA)&&(t=new Tw(t.query,n.value?UA:null));return t},provide:t=>Jp.from(t,e=>e.panel)});class Tw{constructor(e,n){this.query=e,this.panel=n}}const Wpe=ht.mark({class:"cm-searchMatch"}),Gpe=ht.mark({class:"cm-searchMatch cm-searchMatch-selected"}),qpe=ui.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(Pl))}update(t){let e=t.state.field(Pl);(e!=t.startState.field(Pl)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return ht.none;let{view:n}=this,i=new $l;for(let r=0,s=n.visibleRanges,o=s.length;r<o;r++){let{from:a,to:l}=s[r];for(;r<o-1&&l>s[r+1].from-2*250;)l=s[++r].to;t.highlight(n.state,a,l,(c,u)=>{let d=n.state.selection.ranges.some(f=>f.from==c&&f.to==u);i.add(c,u,d?Gpe:Wpe)})}return i.finish()}},{decorations:t=>t.decorations});function Km(t){return e=>{let n=e.state.field(Pl,!1);return n&&n.query.spec.valid?t(e,n):y9(e)}}const QT=Km((t,{query:e})=>{let{to:n}=t.state.selection.main,i=e.nextMatch(t.state,n,n);if(!i)return!1;let r=le.single(i.from,i.to),s=t.state.facet(Tf);return t.dispatch({selection:r,effects:[VA(t,i),s.scrollToMatch(r.main,t)],userEvent:"select.search"}),v9(t),!0}),e4=Km((t,{query:e})=>{let{state:n}=t,{from:i}=n.selection.main,r=e.prevMatch(n,i,i);if(!r)return!1;let s=le.single(r.from,r.to),o=t.state.facet(Tf);return t.dispatch({selection:s,effects:[VA(t,r),o.scrollToMatch(s.main,t)],userEvent:"select.search"}),v9(t),!0}),p9=Km((t,{query:e})=>{let n=e.matchAll(t.state,1e3);return!n||!n.length?!1:(t.dispatch({selection:le.create(n.map(i=>le.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),Kpe=({state:t,dispatch:e})=>{let n=t.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:i,to:r}=n.main,s=[],o=0;for(let a=new pm(t.doc,t.sliceDoc(i,r));!a.next().done;){if(s.length>1e3)return!1;a.value.from==i&&(o=s.length),s.push(le.range(a.value.from,a.value.to))}return e(t.update({selection:le.create(s,o),userEvent:"select.search.matches"})),!0},t4=Km((t,{query:e})=>{let{state:n}=t,{from:i,to:r}=n.selection.main;if(n.readOnly)return!1;let s=e.nextMatch(n,i,i);if(!s)return!1;let o=s,a=[],l,c,u=[];o.from==i&&o.to==r&&(c=n.toText(e.getReplacement(o)),a.push({from:o.from,to:o.to,insert:c}),o=e.nextMatch(n,o.from,o.to),u.push(De.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(i).number)+".")));let d=t.state.changes(a);return o&&(l=le.single(o.from,o.to).map(d),u.push(VA(t,o)),u.push(n.facet(Tf).scrollToMatch(l.main,t))),t.dispatch({changes:d,selection:l,effects:u,userEvent:"input.replace"}),!0}),m9=Km((t,{query:e})=>{if(t.state.readOnly)return!1;let n=e.matchAll(t.state,1e9).map(r=>{let{from:s,to:o}=r;return{from:s,to:o,insert:e.getReplacement(r)}});if(!n.length)return!1;let i=t.state.phrase("replaced $ matches",n.length)+".";return t.dispatch({changes:n,effects:De.announce.of(i),userEvent:"input.replace.all"}),!0});function UA(t){return t.state.facet(Tf).createPanel(t)}function v_(t,e){var n,i,r,s,o;let a=t.selection.main,l=a.empty||a.to>a.from+100?"":t.sliceDoc(a.from,a.to);if(e&&!l)return e;let c=t.facet(Tf);return new f9({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(i=e==null?void 0:e.caseSensitive)!==null&&i!==void 0?i:c.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:c.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:c.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function g9(t){let e=Yp(t,UA);return e&&e.dom.querySelector("[main-field]")}function v9(t){let e=g9(t);e&&e==t.root.activeElement&&e.select()}const y9=t=>{let e=t.state.field(Pl,!1);if(e&&e.panel){let n=g9(t);if(n&&n!=t.root.activeElement){let i=v_(t.state,e.query.spec);i.valid&&t.dispatch({effects:mm.of(i)}),n.focus(),n.select()}}else t.dispatch({effects:[zA.of(!0),e?mm.of(v_(t.state,e.query.spec)):ft.appendConfig.of(Jpe)]});return!0},b9=t=>{let e=t.state.field(Pl,!1);if(!e||!e.panel)return!1;let n=Yp(t,UA);return n&&n.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:zA.of(!1)}),!0};class Xpe{constructor(e){this.view=e;let n=this.query=e.state.field(Pl).query.spec;this.commit=this.commit.bind(this),this.searchField=Vt("input",{value:n.search,placeholder:hr(e,"Find"),"aria-label":hr(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Vt("input",{value:n.replace,placeholder:hr(e,"Replace"),"aria-label":hr(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Vt("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=Vt("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=Vt("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function i(r,s,o){return Vt("button",{class:"cm-button",name:r,onclick:s,type:"button"},o)}this.dom=Vt("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,i("next",()=>QT(e),[hr(e,"next")]),i("prev",()=>e4(e),[hr(e,"previous")]),i("select",()=>p9(e),[hr(e,"all")]),Vt("label",null,[this.caseField,hr(e,"match case")]),Vt("label",null,[this.reField,hr(e,"regexp")]),Vt("label",null,[this.wordField,hr(e,"by word")]),...e.state.readOnly?[]:[Vt("br"),this.replaceField,i("replace",()=>t4(e),[hr(e,"replace")]),i("replaceAll",()=>m9(e),[hr(e,"replace all")])],Vt("button",{name:"close",onclick:()=>b9(e),"aria-label":hr(e,"close"),type:"button"},["×"])])}commit(){let e=new f9({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:mm.of(e)}))}keydown(e){Nte(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?e4:QT)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),t4(this.view))}update(e){for(let n of e.transactions)for(let i of n.effects)i.is(mm)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Tf).top}}function hr(t,e){return t.state.phrase(e)}const y0=30,b0=/[\s\.,:;?!]/;function VA(t,{from:e,to:n}){let i=t.state.doc.lineAt(e),r=t.state.doc.lineAt(n).to,s=Math.max(i.from,e-y0),o=Math.min(r,n+y0),a=t.state.sliceDoc(s,o);if(s!=i.from){for(let l=0;l<y0;l++)if(!b0.test(a[l+1])&&b0.test(a[l])){a=a.slice(l);break}}if(o!=r){for(let l=a.length-1;l>a.length-y0;l--)if(!b0.test(a[l-1])&&b0.test(a[l])){a=a.slice(0,l);break}}return De.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${i.number}.`)}const Ype=De.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Jpe=[Pl,Mm.low(qpe),Ype];class Zpe{constructor(e,n,i,r){this.state=e,this.pos=n,this.explicit=i,this.view=r,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let n=To(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),i=Math.max(n.from,this.pos-250),r=n.text.slice(i-n.from,this.pos-n.from),s=r.search(x9(e,!1));return s<0?null:{from:i+s,to:this.pos,text:r.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,n,i){e=="abort"&&this.abortListeners&&(this.abortListeners.push(n),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function n4(t){let e=Object.keys(t).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Qpe(t){let e=Object.create(null),n=Object.create(null);for(let{label:r}of t){e[r[0]]=!0;for(let s=1;s<r.length;s++)n[r[s]]=!0}let i=n4(e)+n4(n)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function eme(t){let e=t.map(r=>typeof r=="string"?{label:r}:r),[n,i]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:Qpe(e);return r=>{let s=r.matchBefore(i);return s||r.explicit?{from:s?s.from:r.pos,options:e,validFor:n}:null}}class i4{constructor(e,n,i,r){this.completion=e,this.source=n,this.match=i,this.score=r}}function ap(t){return t.selection.main.from}function x9(t,e){var n;let{source:i}=t,r=e&&i[0]!="^",s=i[i.length-1]!="$";return!r&&!s?t:new RegExp(`${r?"^":""}(?:${i})${s?"$":""}`,(n=t.flags)!==null&&n!==void 0?n:t.ignoreCase?"i":"")}const w9=Ca.define();function tme(t,e,n,i){let{main:r}=t.selection,s=n-r.from,o=i-r.from;return Object.assign(Object.assign({},t.changeByRange(a=>{if(a!=r&&n!=i&&t.sliceDoc(a.from+s,a.from+o)!=t.sliceDoc(n,i))return{range:a};let l=t.toText(e);return{changes:{from:a.from+s,to:i==r.from?a.to:a.from+o,insert:l},range:le.cursor(a.from+s+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const r4=new WeakMap;function nme(t){if(!Array.isArray(t))return t;let e=r4.get(t);return e||r4.set(t,e=eme(t)),e}const S9=ft.define(),HA=ft.define();class ime{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let i=qr(e,n),r=ia(i);this.chars.push(i);let s=e.slice(n,n+r),o=s.toUpperCase();this.folded.push(qr(o==s?s.toLowerCase():o,0)),n+=r}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:n,folded:i,any:r,precise:s,byWord:o}=this;if(n.length==1){let b=qr(e,0),w=ia(b),k=w==e.length?0:-100;if(b!=n[0])if(b==i[0])k+=-200;else return null;return this.ret(k,[0,w])}let a=e.indexOf(this.pattern);if(a==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=n.length,c=0;if(a<0){for(let b=0,w=Math.min(e.length,200);b<w&&c<l;){let k=qr(e,b);(k==n[c]||k==i[c])&&(r[c++]=b),b+=ia(k)}if(c<l)return null}let u=0,d=0,f=!1,p=0,m=-1,g=-1,y=/[a-z]/.test(e),v=!0;for(let b=0,w=Math.min(e.length,200),k=0;b<w&&d<l;){let C=qr(e,b);a<0&&(u<l&&C==n[u]&&(s[u++]=b),p<l&&(C==n[p]||C==i[p]?(p==0&&(m=b),g=b+1,p++):p=0));let E,_=C<255?C>=48&&C<=57||C>=97&&C<=122?2:C>=65&&C<=90?1:0:(E=lE(C))!=E.toLowerCase()?1:E!=E.toUpperCase()?2:0;(!b||_==1&&y||k==0&&_!=0)&&(n[d]==C||i[d]==C&&(f=!0)?o[d++]=b:o.length&&(v=!1)),k=_,b+=ia(C)}return d==l&&o[0]==0&&v?this.result(-100+(f?-200:0),o,e):p==l&&m==0?this.ret(-200-e.length+(g==e.length?0:-100),[0,g]):a>-1?this.ret(-700-e.length,[a,a+this.pattern.length]):p==l?this.ret(-900-e.length,[m,g]):d==l?this.result(-100+(f?-200:0)+-700+(v?0:-1100),o,e):n.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,n,i){let r=[],s=0;for(let o of n){let a=o+(this.astral?ia(qr(i,o)):1);s&&r[s-1]==o?r[s-1]=a:(r[s++]=o,r[s++]=a)}return this.ret(e-i.length,r)}}class rme{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let n=e.slice(0,this.pattern.length),i=n==this.pattern?0:n.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,n.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const uo=Re.define({combine(t){return Ql(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:sme,filterStrict:!1,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>i=>s4(e(i),n(i)),optionClass:(e,n)=>i=>s4(e(i),n(i)),addToOptions:(e,n)=>e.concat(n),filterStrict:(e,n)=>e||n})}});function s4(t,e){return t?e?t+" "+e:t:e}function sme(t,e,n,i,r,s){let o=t.textDirection==rn.RTL,a=o,l=!1,c="top",u,d,f=e.left-r.left,p=r.right-e.right,m=i.right-i.left,g=i.bottom-i.top;if(a&&f<Math.min(m,p)?a=!1:!a&&p<Math.min(m,f)&&(a=!0),m<=(a?f:p))u=Math.max(r.top,Math.min(n.top,r.bottom-g))-e.top,d=Math.min(400,a?f:p);else{l=!0,d=Math.min(400,(o?e.right:r.right-e.left)-30);let b=r.bottom-e.bottom;b>=g||b>e.top?u=n.bottom-e.top:(c="bottom",u=e.bottom-n.top)}let y=(e.bottom-e.top)/s.offsetHeight,v=(e.right-e.left)/s.offsetWidth;return{style:`${c}: ${u/y}px; max-width: ${d/v}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":a?"left":"right")}}function ome(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(n){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),n.type&&i.classList.add(...n.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(n,i,r,s){let o=document.createElement("span");o.className="cm-completionLabel";let a=n.displayLabel||n.label,l=0;for(let c=0;c<s.length;){let u=s[c++],d=s[c++];u>l&&o.appendChild(document.createTextNode(a.slice(l,u)));let f=o.appendChild(document.createElement("span"));f.appendChild(document.createTextNode(a.slice(u,d))),f.className="cm-completionMatchedText",l=d}return l<a.length&&o.appendChild(document.createTextNode(a.slice(l))),o},position:50},{render(n){if(!n.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=n.detail,i},position:80}),e.sort((n,i)=>n.position-i.position).map(n=>n.render)}function Ow(t,e,n){if(t<=n)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let r=Math.floor(e/n);return{from:r*n,to:(r+1)*n}}let i=Math.floor((t-e)/n);return{from:t-(i+1)*n,to:t-i*n}}class ame{constructor(e,n,i){this.view=e,this.stateField=n,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let r=e.state.field(n),{options:s,selected:o}=r.open,a=e.state.facet(uo);this.optionContent=ome(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=Ow(s.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=e.state.field(n).open;for(let u=l.target,d;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(d=/-(\d+)$/.exec(u.id))&&+d[1]<c.length){this.applyCompletion(e,c[+d[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(uo).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:HA.of(null)})}),this.showOptions(s,r.id)}mount(){this.updateSel()}showOptions(e,n){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,n,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var n;let i=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=r){let{options:s,selected:o,disabled:a}=i.open;(!r.open||r.open.options!=s)&&(this.range=Ow(s.length,o,e.state.facet(uo).maxRenderedOptions),this.showOptions(s,i.id)),this.updateSel(),a!=((n=r.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of n.split(" "))i&&this.dom.classList.add(i);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;if((n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=Ow(n.options.length,n.selected,this.view.state.facet(uo).maxRenderedOptions),this.showOptions(n.options,e.id)),this.updateSelectedOption(n.selected)){this.destroyInfo();let{completion:i}=n.options[n.selected],{info:r}=i;if(!r)return;let s=typeof r=="string"?document.createTextNode(r):r(i);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,i)}).catch(o=>Cr(this.view.state,o,"completion info")):this.addInfoPane(s,i)}}addInfoPane(e,n){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:s}=e;i.appendChild(r),this.infoDestroy=s||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let i=this.list.firstChild,r=this.range.from;i;i=i.nextSibling,r++)i.nodeName!="LI"||!i.id?r--:r==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),n=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return n&&cme(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return r.top>Math.min(s.bottom,n.bottom)-10||r.bottom<Math.max(s.top,n.top)+10?null:this.view.state.facet(uo).positionInfo(this.view,n,r,i,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,i){const r=document.createElement("ul");r.id=n,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions")),r.addEventListener("mousedown",o=>{o.target==r&&o.preventDefault()});let s=null;for(let o=i.from;o<i.to;o++){let{completion:a,match:l}=e[o],{section:c}=a;if(c){let f=typeof c=="string"?c:c.name;if(f!=s&&(o>i.from||i.from==0))if(s=f,typeof c!="string"&&c.header)r.appendChild(c.header(c));else{let p=r.appendChild(document.createElement("completion-section"));p.textContent=f}}const u=r.appendChild(document.createElement("li"));u.id=n+"-"+o,u.setAttribute("role","option");let d=this.optionClass(a);d&&(u.className=d);for(let f of this.optionContent){let p=f(a,this.view.state,this.view,l);p&&u.appendChild(p)}}return i.from&&r.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function lme(t,e){return n=>new ame(n,t,e)}function cme(t,e){let n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),r=n.height/t.offsetHeight;i.top<n.top?t.scrollTop-=(n.top-i.top)/r:i.bottom>n.bottom&&(t.scrollTop+=(i.bottom-n.bottom)/r)}function o4(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function ume(t,e){let n=[],i=null,r=c=>{n.push(c);let{section:u}=c.completion;if(u){i||(i=[]);let d=typeof u=="string"?u:u.name;i.some(f=>f.name==d)||i.push(typeof u=="string"?{name:d}:u)}},s=e.facet(uo);for(let c of t)if(c.hasResult()){let u=c.result.getMatch;if(c.result.filter===!1)for(let d of c.result.options)r(new i4(d,c.source,u?u(d):[],1e9-n.length));else{let d=e.sliceDoc(c.from,c.to),f,p=s.filterStrict?new rme(d):new ime(d);for(let m of c.result.options)if(f=p.match(m.label)){let g=m.displayLabel?u?u(m,f.matched):[]:f.matched;r(new i4(m,c.source,g,f.score+(m.boost||0)))}}}if(i){let c=Object.create(null),u=0,d=(f,p)=>{var m,g;return((m=f.rank)!==null&&m!==void 0?m:1e9)-((g=p.rank)!==null&&g!==void 0?g:1e9)||(f.name<p.name?-1:1)};for(let f of i.sort(d))u-=1e5,c[f.name]=u;for(let f of n){let{section:p}=f.completion;p&&(f.score+=c[typeof p=="string"?p:p.name])}}let o=[],a=null,l=s.compareCompletions;for(let c of n.sort((u,d)=>d.score-u.score||l(u.completion,d.completion))){let u=c.completion;!a||a.label!=u.label||a.detail!=u.detail||a.type!=null&&u.type!=null&&a.type!=u.type||a.apply!=u.apply||a.boost!=u.boost?o.push(c):o4(c.completion)>o4(a)&&(o[o.length-1]=c),a=c.completion}return o}class ud{constructor(e,n,i,r,s,o){this.options=e,this.attrs=n,this.tooltip=i,this.timestamp=r,this.selected=s,this.disabled=o}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new ud(this.options,a4(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,i,r,s,o){if(r&&!o&&e.some(c=>c.isPending))return r.setDisabled();let a=ume(e,n);if(!a.length)return r&&e.some(c=>c.isPending)?r.setDisabled():null;let l=n.facet(uo).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let c=r.options[r.selected].completion;for(let u=0;u<a.length;u++)if(a[u].completion==c){l=u;break}}return new ud(a,a4(i,l),{pos:e.reduce((c,u)=>u.hasResult()?Math.min(c,u.from):c,1e8),create:vme,above:s.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new ud(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new ud(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Wy{constructor(e,n,i){this.active=e,this.id=n,this.open=i}static start(){return new Wy(pme,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,i=n.facet(uo),s=(i.override||n.languageDataAt("autocomplete",ap(n)).map(nme)).map(l=>(this.active.find(u=>u.source==l)||new Is(l,this.active.some(u=>u.state!=0)?1:0)).update(e,i));s.length==this.active.length&&s.every((l,c)=>l==this.active[c])&&(s=this.active);let o=this.open,a=e.effects.some(l=>l.is(k9));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!dme(s,this.active)||a?o=ud.build(s,n,this.id,o,i,a):o&&o.disabled&&!s.some(l=>l.isPending)&&(o=null),!o&&s.every(l=>!l.isPending)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new Is(l.source,0):l));for(let l of e.effects)l.is(_9)&&(o=o&&o.setSelected(l.value,this.id));return s==this.active&&o==this.open?this:new Wy(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?fme:hme}}function dme(t,e){if(t==e)return!0;for(let n=0,i=0;;){for(;n<t.length&&!t[n].hasResult();)n++;for(;i<e.length&&!e[i].hasResult();)i++;let r=n==t.length,s=i==e.length;if(r||s)return r==s;if(t[n++].result!=e[i++].result)return!1}}const fme={"aria-autocomplete":"list"},hme={};function a4(t,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(n["aria-activedescendant"]=t+"-"+e),n}const pme=[];function mme(t,e){if(t.isUserEvent("input.complete")){let i=t.annotation(w9);if(i&&e.activateOnCompletion(i))return 12}let n=t.isUserEvent("input.type");return n&&e.activateOnTyping?5:n?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class Is{constructor(e,n,i=!1){this.source=e,this.state=n,this.explicit=i}hasResult(){return!1}get isPending(){return this.state==1}update(e,n){let i=mme(e,n),r=this;(i&8||i&16&&this.touches(e))&&(r=new Is(r.source,0)),i&4&&r.state==0&&(r=new Is(this.source,1)),r=r.updateFor(e,i);for(let s of e.effects)if(s.is(S9))r=new Is(r.source,1,s.value);else if(s.is(HA))r=new Is(r.source,0);else if(s.is(k9))for(let o of s.value)o.source==r.source&&(r=o);return r}updateFor(e,n){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(ap(e.state))}}class lp extends Is{constructor(e,n,i,r,s,o){super(e,3,n),this.limit=i,this.result=r,this.from=s,this.to=o}hasResult(){return!0}updateFor(e,n){var i;if(!(n&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=ap(e.state);if(a>o||!r||n&2&&(ap(e.startState)==this.from||a<this.limit))return new Is(this.source,n&4?1:0);let l=e.changes.mapPos(this.limit);return gme(r.validFor,e.state,s,o)?new lp(this.source,this.explicit,l,r,s,o):r.update&&(r=r.update(r,s,o,new Zpe(e.state,a,!1)))?new lp(this.source,this.explicit,l,r,r.from,(i=r.to)!==null&&i!==void 0?i:ap(e.state)):new Is(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new lp(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new Is(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function gme(t,e,n,i){if(!t)return!1;let r=e.sliceDoc(n,i);return typeof t=="function"?t(r,n,i,e):x9(t,!0).test(r)}const k9=ft.define({map(t,e){return t.map(n=>n.map(e))}}),_9=ft.define(),Of=$i.define({create(){return Wy.start()},update(t,e){return t.update(e)},provide:t=>[kE.from(t,e=>e.tooltip),De.contentAttributes.from(t,e=>e.attrs)]});function C9(t,e){const n=e.completion.apply||e.completion.label;let i=t.state.field(Of).active.find(r=>r.source==e.source);return i instanceof lp?(typeof n=="string"?t.dispatch(Object.assign(Object.assign({},tme(t.state,n,i.from,i.to)),{annotations:w9.of(e.completion)})):n(t,e.completion,i.from,i.to),!0):!1}const vme=lme(Of,C9);function x0(t,e="option"){return n=>{let i=n.state.field(Of,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<n.state.facet(uo).interactionDelay)return!1;let r=1,s;e=="page"&&(s=ane(n,i.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=i.open.options,a=i.open.selected>-1?i.open.selected+r*(t?1:-1):t?0:o-1;return a<0?a=e=="page"?0:o-1:a>=o&&(a=e=="page"?o-1:0),n.dispatch({effects:_9.of(a)}),!0}}const l4=t=>{let e=t.state.field(Of,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(uo).interactionDelay?!1:C9(t,e.open.options[e.open.selected])},yme=t=>t.state.field(Of,!1)?(t.dispatch({effects:S9.of(!0)}),!0):!1,bme=t=>{let e=t.state.field(Of,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(t.dispatch({effects:HA.of(null)}),!0)},E9={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},A9=new class extends eu{};A9.startSide=1;A9.endSide=-1;const Lw="()[]{}<>«»»«［］｛｝";function xme(t){for(let e=0;e<Lw.length;e+=2)if(Lw.charCodeAt(e)==t)return Lw.charAt(e+1);return lE(t<128?t:t+1)}function wme(t,e){return t.languageDataAt("closeBrackets",e)[0]||E9}const Sme=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=wme(t,t.selection.main.head).brackets||E9.brackets,r=null,s=t.changeByRange(o=>{if(o.empty){let a=_me(t.doc,o.head);for(let l of i)if(l==a&&kme(t.doc,o.head)==xme(qr(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:le.cursor(o.head-l.length)}}return{range:r=o}});return r||e(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!r};function kme(t,e){let n=t.sliceString(e,e+2);return n.slice(0,ia(qr(n,0)))}function _me(t,e){let n=t.sliceString(e-2,e);return ia(qr(n,0))==n.length?n:n.slice(1)}class c4{constructor(e,n,i){this.from=e,this.to=n,this.diagnostic=i}}class Nc{constructor(e,n,i){this.diagnostics=e,this.panel=n,this.selected=i}static init(e,n,i){let r=i.facet(bo).markerFilter;r&&(e=r(e,i));let s=e.slice().sort((u,d)=>u.from-d.from||u.to-d.to),o=new $l,a=[],l=0;for(let u=0;;){let d=u==s.length?null:s[u];if(!d&&!a.length)break;let f,p;for(a.length?(f=l,p=a.reduce((g,y)=>Math.min(g,y.to),d&&d.from>f?d.from:1e8)):(f=d.from,p=d.to,a.push(d),u++);u<s.length;){let g=s[u];if(g.from==f&&(g.to>g.from||g.to==f))a.push(g),u++,p=Math.min(g.to,p);else{p=Math.min(g.from,p);break}}let m=$me(a);if(a.some(g=>g.from==g.to||g.from==g.to-1&&i.doc.lineAt(g.from).to==g.from))o.add(f,f,ht.widget({widget:new Lme(m),diagnostics:a.slice()}));else{let g=a.reduce((y,v)=>v.markClass?y+" "+v.markClass:y,"");o.add(f,p,ht.mark({class:"cm-lintRange cm-lintRange-"+m+g,diagnostics:a.slice(),inclusiveEnd:a.some(y=>y.to>p)}))}l=p;for(let g=0;g<a.length;g++)a[g].to<=l&&a.splice(g--,1)}let c=o.finish();return new Nc(c,n,bf(c))}}function bf(t,e=null,n=0){let i=null;return t.between(n,1e9,(r,s,{spec:o})=>{if(!(e&&o.diagnostics.indexOf(e)<0))if(!i)i=new c4(r,s,e||o.diagnostics[0]);else{if(o.diagnostics.indexOf(i.diagnostic)<0)return!1;i=new c4(i.from,s,i.diagnostic)}}),i}function Cme(t,e){let n=e.pos,i=e.end||n,r=t.state.facet(bo).hideOn(t,n,i);if(r!=null)return r;let s=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(o=>o.is(WA))||t.changes.touchesRange(s.from,Math.max(s.to,i)))}function P9(t,e){return t.field(Pr,!1)?e:e.concat(ft.appendConfig.of(I9))}function Eme(t,e){return{effects:P9(t,[WA.of(e)])}}const WA=ft.define(),GA=ft.define(),N9=ft.define(),Pr=$i.define({create(){return new Nc(ht.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let n=t.diagnostics.map(e.changes),i=null,r=t.panel;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);i=bf(n,t.selected.diagnostic,s)||bf(n,null,s)}!n.size&&r&&e.state.facet(bo).autoPanel&&(r=null),t=new Nc(n,r,i)}for(let n of e.effects)if(n.is(WA)){let i=e.state.facet(bo).autoPanel?n.value.length?gm.open:null:t.panel;t=Nc.init(n.value,i,e.state)}else n.is(GA)?t=new Nc(t.diagnostics,n.value?gm.open:null,t.selected):n.is(N9)&&(t=new Nc(t.diagnostics,t.panel,n.value));return t},provide:t=>[Jp.from(t,e=>e.panel),De.decorations.from(t,e=>e.diagnostics)]}),Ame=ht.mark({class:"cm-lintRange cm-lintRange-active"});function Pme(t,e,n){let{diagnostics:i}=t.state.field(Pr),r,s=-1,o=-1;i.between(e-(n<0?1:0),e+(n>0?1:0),(l,c,{spec:u})=>{if(e>=l&&e<=c&&(l==c||(e>l||n>0)&&(e<c||n<0)))return r=u.diagnostics,s=l,o=c,!1});let a=t.state.facet(bo).tooltipFilter;return r&&a&&(r=a(r,t.state)),r?{pos:s,end:o,above:t.state.doc.lineAt(s).to<o,create(){return{dom:Nme(t,r)}}}:null}function Nme(t,e){return Vt("ul",{class:"cm-tooltip-lint"},e.map(n=>R9(t,n,!1)))}const Mme=t=>{let e=t.state.field(Pr,!1);(!e||!e.panel)&&t.dispatch({effects:P9(t.state,[GA.of(!0)])});let n=Yp(t,gm.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},u4=t=>{let e=t.state.field(Pr,!1);return!e||!e.panel?!1:(t.dispatch({effects:GA.of(!1)}),!0)},Rme=t=>{let e=t.state.field(Pr,!1);if(!e)return!1;let n=t.state.selection.main,i=e.diagnostics.iter(n.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==n.from&&i.to==n.to)?!1:(t.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},Ime=ui.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(bo);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);let t=Date.now();if(t<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:e}=this.view,{sources:n}=e.facet(bo);n.length&&Tme(n.map(i=>Promise.resolve(i(this.view))),i=>{this.view.state.doc==e.doc&&this.view.dispatch(Eme(this.view.state,i.reduce((r,s)=>r.concat(s))))},i=>{Cr(this.view.state,i)})}}update(t){let e=t.state.facet(bo);(t.docChanged||e!=t.startState.facet(bo)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}});function Tme(t,e,n){let i=[],r=-1;for(let s of t)s.then(o=>{i.push(o),clearTimeout(r),i.length==t.length?e(i):r=setTimeout(()=>e(i),200)},n)}const bo=Re.define({combine(t){return Object.assign({sources:t.map(e=>e.source).filter(e=>e!=null)},Ql(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,n)=>e?n?i=>e(i)||n(i):e:n}))}});function Ome(t,e={}){return[bo.of({source:t,config:e}),Ime,I9]}function M9(t){let e=[];if(t)e:for(let{name:n}of t){for(let i=0;i<n.length;i++){let r=n[i];if(/[a-zA-Z]/.test(r)&&!e.some(s=>s.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function R9(t,e,n){var i;let r=n?M9(e.actions):[];return Vt("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Vt("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((s,o)=>{let a=!1,l=f=>{if(f.preventDefault(),a)return;a=!0;let p=bf(t.state.field(Pr).diagnostics,e);p&&s.apply(t,p.from,p.to)},{name:c}=s,u=r[o]?c.indexOf(r[o]):-1,d=u<0?c:[c.slice(0,u),Vt("u",c.slice(u,u+1)),c.slice(u+1)];return Vt("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${c}${u<0?"":` (access key "${r[o]})"`}.`},d)}),e.source&&Vt("div",{class:"cm-diagnosticSource"},e.source))}class Lme extends ec{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Vt("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class d4{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=R9(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class gm{constructor(e){this.view=e,this.items=[];let n=r=>{if(r.keyCode==27)u4(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=M9(s.actions);for(let a=0;a<o.length;a++)if(o[a].toUpperCase().charCodeAt(0)==r.keyCode){let l=bf(this.view.state.field(Pr).diagnostics,s);l&&s.actions[a].apply(e,l.from,l.to)}}else return;r.preventDefault()},i=r=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(r.target)&&this.moveSelection(s)};this.list=Vt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:i}),this.dom=Vt("div",{class:"cm-panel-lint"},this.list,Vt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>u4(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(Pr).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(Pr),i=0,r=!1,s=null,o=new Set;for(e.between(0,this.view.state.doc.length,(a,l,{spec:c})=>{for(let u of c.diagnostics){if(o.has(u))continue;o.add(u);let d=-1,f;for(let p=i;p<this.items.length;p++)if(this.items[p].diagnostic==u){d=p;break}d<0?(f=new d4(this.view,u),this.items.splice(i,0,f),r=!0):(f=this.items[d],d>i&&(this.items.splice(i,d-i),r=!0)),n&&f.diagnostic==n.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),s=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),i++}});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new d4(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:a,panel:l})=>{let c=l.height/this.list.offsetHeight;a.top<l.top?this.list.scrollTop-=(l.top-a.top)/c:a.bottom>l.bottom&&(this.list.scrollTop+=(a.bottom-l.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function n(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)n();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(Pr),i=bf(n.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:N9.of(i)})}static open(e){return new gm(e)}}function Dme(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function w0(t){return Dme(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const jme=De.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:w0("#d11")},".cm-lintRange-warning":{backgroundImage:w0("orange")},".cm-lintRange-info":{backgroundImage:w0("#999")},".cm-lintRange-hint":{backgroundImage:w0("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function Bme(t){return t=="error"?4:t=="warning"?3:t=="info"?2:1}function $me(t){let e="hint",n=1;for(let i of t){let r=Bme(i.severity);r>n&&(n=r,e=i.severity)}return e}const I9=[Pr,De.decorations.compute([Pr],t=>{let{selected:e,panel:n}=t.field(Pr);return!e||!n||e.from==e.to?ht.none:ht.set([Ame.range(e.from,e.to)])}),one(Pme,{hideOn:Cme}),jme],T9=t=>e=>{const n=t==="down";let i=e.state.selection;for(const r of i.ranges)i=i.addRange(e.moveVertically(r,n));return e.dispatch({selection:i}),!0},Fme=T9("up"),zme=T9("down"),Ume=t=>{let e=null;for(const n of t.state.selection.ranges)if(!n.empty)for(let i=n.from;i<=n.to;){const r=t.state.doc.lineAt(i),s=Math.min(r.to,n.to);e?e=e.addRange(le.range(s,s)):e=le.single(s),i=r.to+1}return e?(t.dispatch({selection:e}),!0):!1},Vme=[{key:"Ctrl-Space",run:yme},{key:"Escape",run:bme},{key:"ArrowDown",run:x0(!0)},{key:"ArrowUp",run:x0(!1)},{key:"PageDown",run:x0(!0,"page")},{key:"PageUp",run:x0(!1,"page")},{key:"Enter",run:l4},{key:"Tab",run:l4},{key:"Mod-f",run:y9,scope:"editor search-panel"},{key:"Escape",run:b9,scope:"editor search-panel"},{key:"Alt-Enter",run:p9,scope:"editor search-panel"},{key:"Mod-Alt-Enter",run:m9,scope:"editor search-panel"},{key:"Ctrl-g",run:Dpe},{key:"Mod-d",run:Fpe,preventDefault:!0},{key:"Shift-Mod-l",run:Kpe},{key:"Enter",run:XT,shift:XT},{key:"ArrowLeft",run:PT,shift:OT,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:fpe,shift:ype},{key:"ArrowRight",run:NT,shift:LT,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:hpe,shift:bpe},{key:"ArrowUp",run:MT,shift:DT,preventDefault:!0},{key:"ArrowDown",run:RT,shift:jT,preventDefault:!0},{key:"Home",run:TT,shift:zT},{mac:"Cmd-ArrowLeft",run:TT,shift:zT},{key:"Mod-Home",run:UT,shift:HT},{mac:"Cmd-ArrowUp",run:UT,shift:HT},{key:"PageUp",run:Nw,shift:BT},{mac:"Ctrl-ArrowUp",run:Nw,shift:BT},{key:"PageDown",run:Mw,shift:$T},{mac:"Ctrl-ArrowDown",run:Mw,shift:$T},{key:"End",run:IT,shift:FT},{mac:"Cmd-ArrowRight",run:IT,shift:FT},{key:"Mod-Alt-ArrowUp",linux:"Shift-Alt-ArrowUp",run:Fme,preventDefault:!0},{key:"Mod-Alt-ArrowDown",linux:"Shift-Alt-ArrowDown",run:zme,preventDefault:!0},{key:"Shift-Alt-i",run:Ume},{key:"Mod-End",run:VT,shift:WT},{mac:"Cmd-ArrowDown",run:VT,shift:WT},{key:"Mod-a",run:Spe},{key:"Backspace",run:Sme},{key:"Backspace",run:Rw,shift:Rw},{key:"Delete",run:GT},{key:"Mod-Backspace",mac:"Alt-Backspace",run:qT},{key:"Mod-Delete",mac:"Alt-Delete",run:_pe},{mac:"Mod-Backspace",run:Cpe},{mac:"Mod-Delete",run:KT},{mac:"Ctrl-b",run:PT,shift:OT,preventDefault:!0},{mac:"Ctrl-f",run:NT,shift:LT},{mac:"Ctrl-p",run:MT,shift:DT},{mac:"Ctrl-n",run:RT,shift:jT},{mac:"Ctrl-a",run:ppe,shift:xpe},{mac:"Ctrl-e",run:mpe,shift:wpe},{mac:"Ctrl-d",run:GT},{mac:"Ctrl-h",run:Rw},{mac:"Ctrl-k",run:KT},{mac:"Ctrl-Alt-h",run:qT},{mac:"Ctrl-o",run:Epe},{mac:"Ctrl-t",run:Ape},{mac:"Ctrl-v",run:Mw},{mac:"Alt-v",run:Nw},{key:"Shift-Mod-k",run:Ipe},{key:"Alt-ArrowDown",run:Npe},{key:"Alt-ArrowUp",run:Ppe},{win:"Shift-Alt-ArrowDown",mac:"Shift-Alt-ArrowDown",run:Rpe},{win:"Shift-Alt-ArrowUp",mac:"Shift-Alt-ArrowUp",run:Mpe},{key:"Mod-l",run:kpe,preventDefault:!0},{key:"Shift-Mod-\\",run:vpe},{key:"Tab",run:m_,shift:YT,preventDefault:!0},{key:"Mod-[",run:YT},{key:"Mod-]",run:m_},{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:_he},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Che},{key:"Mod-k Mod-0",run:Ehe},{key:"Mod-k Mod-j",run:Ahe},{key:"Mod-k Mod-c",run:Yhe},{key:"Mod-k Mod-u",run:Jhe},{key:"Mod-/",run:Khe},{key:"Shift-Alt-a",run:Zhe},{key:"Mod-z",run:Gz,preventDefault:!0},{key:"Mod-y",run:p_,preventDefault:!0},{key:"Mod-Shift-z",run:p_,preventDefault:!0},{key:"Mod-u",run:spe,preventDefault:!0},{key:"Mod-Shift-m",run:Mme},{key:"F8",run:Rme}];var Hme=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Tu=new WeakMap,S0=new WeakMap,k0={},Dw=0,O9=function(t){return t&&(t.host||O9(t.parentNode))},Wme=function(t,e){return e.map(function(n){if(t.contains(n))return n;var i=O9(n);return i&&t.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},Gme=function(t,e,n,i){var r=Wme(e,Array.isArray(t)?t:[t]);k0[n]||(k0[n]=new WeakMap);var s=k0[n],o=[],a=new Set,l=new Set(r),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};r.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(a.has(f))u(f);else try{var p=f.getAttribute(i),m=p!==null&&p!=="false",g=(Tu.get(f)||0)+1,y=(s.get(f)||0)+1;Tu.set(f,g),s.set(f,y),o.push(f),g===1&&m&&S0.set(f,!0),y===1&&f.setAttribute(n,"true"),m||f.setAttribute(i,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return u(e),a.clear(),Dw++,function(){o.forEach(function(d){var f=Tu.get(d)-1,p=s.get(d)-1;Tu.set(d,f),s.set(d,p),f||(S0.has(d)||d.removeAttribute(i),S0.delete(d)),p||d.removeAttribute(n)}),Dw--,Dw||(Tu=new WeakMap,Tu=new WeakMap,S0=new WeakMap,k0={})}},qme=function(t,e,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(t)?t:[t]),r=Hme(t);return r?(i.push.apply(i,Array.from(r.querySelectorAll("[aria-live], script"))),Gme(i,r,n,"aria-hidden")):function(){return null}},y_=["Enter"," "],Kme=["ArrowDown","PageUp","Home"],L9=["ArrowUp","PageDown","End"],Xme=[...Kme,...L9],Yme={ltr:[...y_,"ArrowRight"],rtl:[...y_,"ArrowLeft"]},Jme={ltr:["ArrowLeft"],rtl:["ArrowRight"]},C1="Menu",[vm,Zme,Qme]=_m(C1),[mu,D9]=zs(C1,[Qme,Mf,kb]),qA=Mf(),j9=kb(),[Sve,gu]=mu(C1),[kve,Xm]=mu(C1),ege="MenuAnchor",KA=x.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t,r=qA(n);return h.jsx(a1,{...r,...i,ref:e})});KA.displayName=ege;var XA="MenuPortal",[tge,B9]=mu(XA,{forceMount:void 0}),$9=t=>{const{__scopeMenu:e,forceMount:n,children:i,container:r}=t,s=gu(XA,e);return h.jsx(tge,{scope:e,forceMount:n,children:h.jsx(Sa,{present:n||s.open,children:h.jsx(zm,{asChild:!0,container:r,children:i})})})};$9.displayName=XA;var ls="MenuContent",[nge,YA]=mu(ls),F9=x.forwardRef((t,e)=>{const n=B9(ls,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,s=gu(ls,t.__scopeMenu),o=Xm(ls,t.__scopeMenu);return h.jsx(vm.Provider,{scope:t.__scopeMenu,children:h.jsx(Sa,{present:i||s.open,children:h.jsx(vm.Slot,{scope:t.__scopeMenu,children:o.modal?h.jsx(ige,{...r,ref:e}):h.jsx(rge,{...r,ref:e})})})})}),ige=x.forwardRef((t,e)=>{const n=gu(ls,t.__scopeMenu),i=x.useRef(null),r=wt(e,i);return x.useEffect(()=>{const s=i.current;if(s)return qme(s)},[]),h.jsx(JA,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ke(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),rge=x.forwardRef((t,e)=>{const n=gu(ls,t.__scopeMenu);return h.jsx(JA,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),sge=Jd("MenuContent.ScrollLock"),JA=x.forwardRef((t,e)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,disableOutsideScroll:m,...g}=t,y=gu(ls,n),v=Xm(ls,n),b=qA(n),w=j9(n),k=Zme(n),[C,E]=x.useState(null),_=x.useRef(null),A=wt(e,_,y.onContentChange),R=x.useRef(0),L=x.useRef(""),O=x.useRef(0),I=x.useRef(null),G=x.useRef("right"),B=x.useRef(0),K=m?c1:x.Fragment,J=m?{as:sge,allowPinchZoom:!0}:void 0,ne=U=>{var S,T;const se=L.current+U,_e=k().filter(j=>!j.disabled),Q=document.activeElement,ae=(S=_e.find(j=>j.ref.current===Q))==null?void 0:S.textValue,z=_e.map(j=>j.textValue),$=vge(z,se,ae),W=(T=_e.find(j=>j.textValue===$))==null?void 0:T.ref.current;(function j(D){L.current=D,window.clearTimeout(R.current),D!==""&&(R.current=window.setTimeout(()=>j(""),1e3))})(se),W&&setTimeout(()=>W.focus())};x.useEffect(()=>()=>window.clearTimeout(R.current),[]),rA();const V=x.useCallback(U=>{var _e,Q;return G.current===((_e=I.current)==null?void 0:_e.side)&&bge(U,(Q=I.current)==null?void 0:Q.area)},[]);return h.jsx(nge,{scope:n,searchRef:L,onItemEnter:x.useCallback(U=>{V(U)&&U.preventDefault()},[V]),onItemLeave:x.useCallback(U=>{var se;V(U)||((se=_.current)==null||se.focus(),E(null))},[V]),onTriggerLeave:x.useCallback(U=>{V(U)&&U.preventDefault()},[V]),pointerGraceTimerRef:O,onPointerGraceIntentChange:x.useCallback(U=>{I.current=U},[]),children:h.jsx(K,{...J,children:h.jsx(i1,{asChild:!0,trapped:r,onMountAutoFocus:ke(s,U=>{var se;U.preventDefault(),(se=_.current)==null||se.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:h.jsx($m,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:p,children:h.jsx(sD,{asChild:!0,...w,dir:v.dir,orientation:"vertical",loop:i,currentTabStopId:C,onCurrentTabStopIdChange:E,onEntryFocus:ke(l,U=>{v.isUsingKeyboardRef.current||U.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(mA,{role:"menu","aria-orientation":"vertical","data-state":nU(y.open),"data-radix-menu-content":"",dir:v.dir,...b,...g,ref:A,style:{outline:"none",...g.style},onKeyDown:ke(g.onKeyDown,U=>{const _e=U.target.closest("[data-radix-menu-content]")===U.currentTarget,Q=U.ctrlKey||U.altKey||U.metaKey,ae=U.key.length===1;_e&&(U.key==="Tab"&&U.preventDefault(),!Q&&ae&&ne(U.key));const z=_.current;if(U.target!==z||!Xme.includes(U.key))return;U.preventDefault();const W=k().filter(S=>!S.disabled).map(S=>S.ref.current);L9.includes(U.key)&&W.reverse(),mge(W)}),onBlur:ke(t.onBlur,U=>{U.currentTarget.contains(U.target)||(window.clearTimeout(R.current),L.current="")}),onPointerMove:ke(t.onPointerMove,ym(U=>{const se=U.target,_e=B.current!==U.clientX;if(U.currentTarget.contains(se)&&_e){const Q=U.clientX>B.current?"right":"left";G.current=Q,B.current=U.clientX}}))})})})})})})});F9.displayName=ls;var oge="MenuGroup",ZA=x.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return h.jsx(et.div,{role:"group",...i,ref:e})});ZA.displayName=oge;var age="MenuLabel",z9=x.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return h.jsx(et.div,{...i,ref:e})});z9.displayName=age;var Gy="MenuItem",f4="menu.itemSelect",E1=x.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:i,...r}=t,s=x.useRef(null),o=Xm(Gy,t.__scopeMenu),a=YA(Gy,t.__scopeMenu),l=wt(e,s),c=x.useRef(!1),u=()=>{const d=s.current;if(!n&&d){const f=new CustomEvent(f4,{bubbles:!0,cancelable:!0});d.addEventListener(f4,p=>i==null?void 0:i(p),{once:!0}),RC(d,f),f.defaultPrevented?c.current=!1:o.onClose()}};return h.jsx(U9,{...r,ref:l,disabled:n,onClick:ke(t.onClick,u),onPointerDown:d=>{var f;(f=t.onPointerDown)==null||f.call(t,d),c.current=!0},onPointerUp:ke(t.onPointerUp,d=>{var f;c.current||(f=d.currentTarget)==null||f.click()}),onKeyDown:ke(t.onKeyDown,d=>{const f=a.searchRef.current!=="";n||f&&d.key===" "||y_.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});E1.displayName=Gy;var U9=x.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:i=!1,textValue:r,...s}=t,o=YA(Gy,n),a=j9(n),l=x.useRef(null),c=wt(e,l),[u,d]=x.useState(!1),[f,p]=x.useState("");return x.useEffect(()=>{const m=l.current;m&&p((m.textContent??"").trim())},[s.children]),h.jsx(vm.ItemSlot,{scope:n,disabled:i,textValue:r??f,children:h.jsx(oD,{asChild:!0,...a,focusable:!i,children:h.jsx(et.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...s,ref:c,onPointerMove:ke(t.onPointerMove,ym(m=>{i?o.onItemLeave(m):(o.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ke(t.onPointerLeave,ym(m=>o.onItemLeave(m))),onFocus:ke(t.onFocus,()=>d(!0)),onBlur:ke(t.onBlur,()=>d(!1))})})})}),lge="MenuCheckboxItem",V9=x.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:i,...r}=t;return h.jsx(K9,{scope:t.__scopeMenu,checked:n,children:h.jsx(E1,{role:"menuitemcheckbox","aria-checked":qy(n)?"mixed":n,...r,ref:e,"data-state":eP(n),onSelect:ke(r.onSelect,()=>i==null?void 0:i(qy(n)?!0:!n),{checkForDefaultPrevented:!1})})})});V9.displayName=lge;var H9="MenuRadioGroup",[cge,uge]=mu(H9,{value:void 0,onValueChange:()=>{}}),W9=x.forwardRef((t,e)=>{const{value:n,onValueChange:i,...r}=t,s=Ir(i);return h.jsx(cge,{scope:t.__scopeMenu,value:n,onValueChange:s,children:h.jsx(ZA,{...r,ref:e})})});W9.displayName=H9;var G9="MenuRadioItem",q9=x.forwardRef((t,e)=>{const{value:n,...i}=t,r=uge(G9,t.__scopeMenu),s=n===r.value;return h.jsx(K9,{scope:t.__scopeMenu,checked:s,children:h.jsx(E1,{role:"menuitemradio","aria-checked":s,...i,ref:e,"data-state":eP(s),onSelect:ke(i.onSelect,()=>{var o;return(o=r.onValueChange)==null?void 0:o.call(r,n)},{checkForDefaultPrevented:!1})})})});q9.displayName=G9;var QA="MenuItemIndicator",[K9,dge]=mu(QA,{checked:!1}),X9=x.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:i,...r}=t,s=dge(QA,n);return h.jsx(Sa,{present:i||qy(s.checked)||s.checked===!0,children:h.jsx(et.span,{...r,ref:e,"data-state":eP(s.checked)})})});X9.displayName=QA;var fge="MenuSeparator",Y9=x.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return h.jsx(et.div,{role:"separator","aria-orientation":"horizontal",...i,ref:e})});Y9.displayName=fge;var hge="MenuArrow",J9=x.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t,r=qA(n);return h.jsx(gA,{...r,...i,ref:e})});J9.displayName=hge;var pge="MenuSub",[_ve,Z9]=mu(pge),Oh="MenuSubTrigger",Q9=x.forwardRef((t,e)=>{const n=gu(Oh,t.__scopeMenu),i=Xm(Oh,t.__scopeMenu),r=Z9(Oh,t.__scopeMenu),s=YA(Oh,t.__scopeMenu),o=x.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=s,c={__scopeMenu:t.__scopeMenu},u=x.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return x.useEffect(()=>u,[u]),x.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),h.jsx(KA,{asChild:!0,...c,children:h.jsx(U9,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":nU(n.open),...t,ref:wb(e,r.onTriggerChange),onClick:d=>{var f;(f=t.onClick)==null||f.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ke(t.onPointerMove,ym(d=>{s.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(s.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ke(t.onPointerLeave,ym(d=>{var p,m;u();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const g=(m=n.content)==null?void 0:m.dataset.side,y=g==="right",v=y?-5:5,b=f[y?"left":"right"],w=f[y?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+v,y:d.clientY},{x:b,y:f.top},{x:w,y:f.top},{x:w,y:f.bottom},{x:b,y:f.bottom}],side:g}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:ke(t.onKeyDown,d=>{var p;const f=s.searchRef.current!=="";t.disabled||f&&d.key===" "||Yme[i.dir].includes(d.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),d.preventDefault())})})})});Q9.displayName=Oh;var eU="MenuSubContent",tU=x.forwardRef((t,e)=>{const n=B9(ls,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,s=gu(ls,t.__scopeMenu),o=Xm(ls,t.__scopeMenu),a=Z9(eU,t.__scopeMenu),l=x.useRef(null),c=wt(e,l);return h.jsx(vm.Provider,{scope:t.__scopeMenu,children:h.jsx(Sa,{present:i||s.open,children:h.jsx(vm.Slot,{scope:t.__scopeMenu,children:h.jsx(JA,{id:a.contentId,"aria-labelledby":a.triggerId,...r,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;o.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ke(t.onFocusOutside,u=>{u.target!==a.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:ke(t.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:ke(t.onKeyDown,u=>{var p;const d=u.currentTarget.contains(u.target),f=Jme[o.dir].includes(u.key);d&&f&&(s.onOpenChange(!1),(p=a.trigger)==null||p.focus(),u.preventDefault())})})})})})});tU.displayName=eU;function nU(t){return t?"open":"closed"}function qy(t){return t==="indeterminate"}function eP(t){return qy(t)?"indeterminate":t?"checked":"unchecked"}function mge(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function gge(t,e){return t.map((n,i)=>t[(e+i)%t.length])}function vge(t,e,n){const r=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=gge(t,Math.max(s,0));r.length===1&&(o=o.filter(c=>c!==n));const l=o.find(c=>c.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function yge(t,e){const{x:n,y:i}=t;let r=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s],l=e[o],c=a.x,u=a.y,d=l.x,f=l.y;u>i!=f>i&&n<(d-c)*(i-u)/(f-u)+c&&(r=!r)}return r}function bge(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return yge(n,e)}function ym(t){return e=>e.pointerType==="mouse"?t(e):void 0}var xge=KA,wge=$9,Sge=F9,kge=ZA,_ge=z9,Cge=E1,Ege=V9,Age=W9,Pge=q9,Nge=X9,Mge=Y9,Rge=J9,Ige=Q9,Tge=tU,iU="DropdownMenu",[Oge,Cve]=zs(iU,[D9]),dr=D9(),[Eve,rU]=Oge(iU),sU="DropdownMenuTrigger",Lge=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...r}=t,s=rU(sU,n),o=dr(n);return h.jsx(xge,{asChild:!0,...o,children:h.jsx(et.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...r,ref:wb(e,s.triggerRef),onPointerDown:ke(t.onPointerDown,a=>{!i&&a.button===0&&a.ctrlKey===!1&&(s.onOpenToggle(),s.open||a.preventDefault())}),onKeyDown:ke(t.onKeyDown,a=>{i||(["Enter"," "].includes(a.key)&&s.onOpenToggle(),a.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});Lge.displayName=sU;var Dge="DropdownMenuPortal",oU=t=>{const{__scopeDropdownMenu:e,...n}=t,i=dr(e);return h.jsx(wge,{...i,...n})};oU.displayName=Dge;var aU="DropdownMenuContent",lU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=rU(aU,n),s=dr(n),o=x.useRef(!1);return h.jsx(Sge,{id:r.contentId,"aria-labelledby":r.triggerId,...s,...i,ref:e,onCloseAutoFocus:ke(t.onCloseAutoFocus,a=>{var l;o.current||(l=r.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:ke(t.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!r.modal||u)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});lU.displayName=aU;var jge="DropdownMenuGroup",Bge=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=dr(n);return h.jsx(kge,{...r,...i,ref:e})});Bge.displayName=jge;var $ge="DropdownMenuLabel",cU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=dr(n);return h.jsx(_ge,{...r,...i,ref:e})});cU.displayName=$ge;var Fge="DropdownMenuItem",uU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=dr(n);return h.jsx(Cge,{...r,...i,ref:e})});uU.displayName=Fge;var zge="DropdownMenuCheckboxItem",dU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=dr(n);return h.jsx(Ege,{...r,...i,ref:e})});dU.displayName=zge;var Uge="DropdownMenuRadioGroup",Vge=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=dr(n);return h.jsx(Age,{...r,...i,ref:e})});Vge.displayName=Uge;var Hge="DropdownMenuRadioItem",fU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=dr(n);return h.jsx(Pge,{...r,...i,ref:e})});fU.displayName=Hge;var Wge="DropdownMenuItemIndicator",hU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=dr(n);return h.jsx(Nge,{...r,...i,ref:e})});hU.displayName=Wge;var Gge="DropdownMenuSeparator",pU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=dr(n);return h.jsx(Mge,{...r,...i,ref:e})});pU.displayName=Gge;var qge="DropdownMenuArrow",Kge=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=dr(n);return h.jsx(Rge,{...r,...i,ref:e})});Kge.displayName=qge;var Xge="DropdownMenuSubTrigger",mU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=dr(n);return h.jsx(Ige,{...r,...i,ref:e})});mU.displayName=Xge;var Yge="DropdownMenuSubContent",gU=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=dr(n);return h.jsx(Tge,{...r,...i,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});gU.displayName=Yge;var Jge=oU,vU=lU,yU=cU,bU=uU,xU=dU,wU=fU,SU=hU,kU=pU,_U=mU,CU=gU;const Zge=x.forwardRef(({className:t,inset:e,children:n,...i},r)=>h.jsxs(_U,{ref:r,className:re("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-mantis-500 data-[state=open]:bg-mantis-500",e&&"pl-8",t),...i,children:[n,h.jsx("span",{className:"icon-[lucide--chevron-right] ml-auto block size-4"})]}));Zge.displayName=_U.displayName;const Qge=x.forwardRef(({className:t,...e},n)=>h.jsx(CU,{ref:n,className:re("z-50 min-w-32 overflow-hidden rounded-md border bg-stone-900 p-1 text-white shadow-lg transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...e}));Qge.displayName=CU.displayName;const e0e=x.forwardRef(({className:t,sideOffset:e=4,...n},i)=>h.jsx(Jge,{children:h.jsx(vU,{ref:i,sideOffset:e,className:re("z-50 min-w-32 overflow-hidden rounded-md border border-stone-600 bg-stone-900 p-1 text-white shadow-md transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...n})}));e0e.displayName=vU.displayName;const t0e=x.forwardRef(({className:t,inset:e,...n},i)=>h.jsx(bU,{ref:i,className:re("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",t),...n}));t0e.displayName=bU.displayName;const n0e=x.forwardRef(({className:t,children:e,checked:n,...i},r)=>h.jsxs(xU,{ref:r,className:re("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...i,children:[h.jsx("span",{className:"absolute left-2 flex size-3.5 items-center justify-center",children:h.jsx(SU,{children:h.jsx("span",{className:"icon-[lucide--check] size-4"})})}),e]}));n0e.displayName=xU.displayName;const i0e=x.forwardRef(({className:t,children:e,...n},i)=>h.jsxs(wU,{ref:i,className:re("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[h.jsx("span",{className:"absolute left-2 flex size-3.5 items-center justify-center",children:h.jsx(SU,{children:h.jsx("span",{className:"icon-[lucide--circle-dot] block size-4"})})}),e]}));i0e.displayName=wU.displayName;const r0e=x.forwardRef(({className:t,inset:e,...n},i)=>h.jsx(yU,{ref:i,className:re("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));r0e.displayName=yU.displayName;const s0e=x.forwardRef(({className:t,...e},n)=>h.jsx(kU,{ref:n,className:re("-mx-1 my-1 h-px bg-stone-600",t),...e}));s0e.displayName=kU.displayName;const tP=jj("vonsim-program",of(nt().language,"editor.example"),void 0,{getOnInit:!0}),EU=()=>{const t=P.get(tP);return typeof t=="string"?t:""},o0e=ui.fromClass(class{constructor(t){this.view=t}update(t){t.docChanged&&(P.set(tP,this.view.state.doc.toString()),P.set(Zp,!0))}}),h4=pe(null);pe(t=>t(h4),(t,e,n)=>{e(h4,n)});const a0e=pe("");pe(t=>t(a0e)!==t(tP));const l0e=[{nombre:"Sumador simple",filename:"sumador.asm",contenido:`; Ejemplo: Sumador simple z = x + y
x DB 3
y DB 2
z DB 0
MOV AL, x
ADD AL, y
MOV z, AL
HLT`},{nombre:"Sumar Si Iguales",filename:"sumarsiiguales.asm",contenido:`; Ejemplo: Sumar Si Iguales x = y
x DB 1
y DB 2
z DB 0
         MOV AL, x
         SUB AL, y
         JZ EsIgual
         JMP Fin
EsIgual: MOV DL, x
         ADD y, DL
Fin:     HLT`},{nombre:"Sumar Si Menor",filename:"sumarsimenor.asm",contenido:`; Ejemplo: Sumar Si Menor
x DB 2
y DB 3
z DB 0
          MOV AL, x
          CMP AL, y
          JC EsMenor
          JMP Fin
EsMenor:  ADD AL, y
          MOV z, AL
Fin:      HLT`},{nombre:"Bucle con Condición",filename:"bucle_condicion.asm",contenido:`; Ejemplo: Bucle que suma números del 1 al 9
x     db 1
suma  DB 0
Condicion:  CMP x, 10
            JC Bucle
            JMP FinBucle
Bucle:      MOV BL, x
            ADD suma, BL
            ADD x, 1
            JMP Condicion
FinBucle:   hlt`},{nombre:"Máximo en Vector",filename:"maximo_vector.asm",contenido:`; Ejemplo: Encontrar el máximo en un vector
max     DB 0
vector  DB 5, 2, 10, 4, 5, 0, 4, 8, 1, 9
            MOV CL, 0
            MOV BL, OFFSET vector
Condicion:  CMP CL, 10
            JC Bucle
            JMP FinBucle
Bucle:      MOV AL, [BL]
            CMP AL, max
            JC Proximo
            MOV max, AL
Proximo:    ADD BL, 1
            ADD CL, 1
            JMP Condicion
FinBucle:   HLT`},{nombre:"Hola Mundo",filename:"holamundo.asm",contenido:`; Ejemplo: Hola Mundo
cadena DB "Hola!"
MOV BL, OFFSET cadena
MOV AL, 5
INT 7
HLT`},{nombre:"Ingresar Carácter",filename:"ingresar_caracter.asm",contenido:`; Ejemplo: Ingresar un carácter por teclado
car DB 0
MOV BL, OFFSET car
INT 6
HLT`},{nombre:"Control de LEDs",filename:"control_leds.asm",contenido:`; Enciende las luces (una sí, una no): 1010 1010b
; 31h = PB --> puerto de datos para las luces (LEDs)
; 33h = CB --> puerto de control para las luces

; Configura todos los bits de PB como salida para controlar las luces
MOV AL, 0                ; 0000 0000b: todos los bits de PB en modo salida
OUT 33h, AL              ; Escribe en CB para configurar PB como salida

; Enciende las luces alternadas: 1010 1010b (170 decimal)
MOV AL, 170              ; 1010 1010b: enciende LEDs pares, apaga impares
OUT 31h, AL              ; Escribe el valor en PB para actualizar las luces

HLT`},{nombre:"Leer Contraseña",filename:"leer_contrasena.asm",contenido:`; Leer el valor de interruptores como una contraseña hasta que el usuario la adivine
clave DB 15               ; Contraseña esperada: 00001111 (en decimal 15)
mensaje_ok DB "Bienvenido!" ; Mensaje a mostrar si la contraseña es correcta

; Configurar PA (Puerto A) como entrada
MOV AL, 15                ; 00001111b: configura los primeros 4 bits de PA como entrada
OUT 32h, AL               ; Escribe en CA para configurar PA

bucle:
    IN AL, 30h            ; Lee el valor actual de las llaves desde PA
    CMP AL, clave         ; Compara el valor leído con la contraseña
    JZ Mostrar_Mensaje    ; Si coincide, salta a Mostrar_Mensaje
    JMP bucle             ; Si no coincide, vuelve a intentar

Mostrar_Mensaje:
    MOV BL, OFFSET mensaje_ok ; BL apunta al mensaje de éxito
    MOV AL, 11                ; Longitud del mensaje (Bienvenido! tiene 11 caracteres)
    INT 7
    HLT`},{nombre:"Impresora con sondeo",filename:"impresora_sondeo.asm",contenido:`; Imprime el string "Hola" en la impresora usando sondeo

dato DB "Hola", 0         ; String a imprimir, terminado en 0 (carácter nulo)

HS_DATA   EQU 40h         ; Dirección del registro de datos del Handshake
HS_STATUS EQU 41h         ; Dirección del registro de estado del Handshake

; --- Deshabilita las interrupciones del Handshake (bit 7 en 0) ---
IN  AL, HS_STATUS
AND AL, 01111111b         ; Fuerza el bit 7 a 0 (sin interrupciones)
OUT HS_STATUS, AL

; --- Inicializa el puntero al string ---
MOV BL, OFFSET dato       ; BL apunta al primer carácter del string

; --- Bucle principal: espera espacio en el buffer e imprime ---
Sondeo:
    IN  AL, HS_STATUS
    AND AL, 00000001b     ; Lee el flag busy (bit 0): 1=lleno, 0=libre
    JZ  ImprimirCadena   ; Si busy=0, hay espacio y puede imprimir
    JMP Sondeo            ; Si busy=1, espera hasta que haya espacio

ImprimirCadena:
    MOV AL, [BL]          ; Carga el siguiente carácter del string
    CMP AL, 0             ; ¿Es el final del string? (carácter nulo)
    JZ fin                ; Si sí, termina el programa

    OUT HS_DATA, AL       ; Envía el carácter al registro de datos del Handshake

    INC BL                ; Avanza al siguiente carácter del string
    JMP Sondeo            ; Repite el proceso para el próximo carácter

fin:
    HLT                   ; Detiene la ejecución`},{nombre:"Impresora por interrupción",filename:"impresora_interrupcion.asm",contenido:`; ===============================================================================
; PROGRAMA: Impresión de string usando Handshake con interrupciones
; DESCRIPCIÓN: Imprime el string "hola" en la impresora utilizando el módulo
;              Handshake con interrupciones por hardware (INT2)
; ===============================================================================

; --- SECCIÓN DE DATOS ---
mensaje     db "Hola", 0    ; String a imprimir, terminado en carácter nulo
restantes   db 4           ; Contador de caracteres restantes por imprimir
puntero     db 0           ; Puntero al siguiente carácter (8 bits)

; --- CONSTANTES DE HANDSHAKE ---
HS_DATA     EQU 40h        ; Registro de datos del Handshake (puerto E/S)
HS_STATUS   EQU 41h        ; Registro de estado del Handshake (puerto E/S)

; --- CONSTANTES DE INTERRUPCIONES ---
ID          EQU 2          ; ID de la interrupción para Handshake (0-7)
IMR         EQU 21h        ; Registro de máscara de interrupciones del PIC
EOI         EQU 20h        ; Puerto para enviar End Of Interrupt al PIC
INT2        EQU 26h        ; Puerto para configurar la línea INT2
; ===============================================================================
; PROGRAMA PRINCIPAL
; ===============================================================================


; --- 1) CONFIGURACIÓN INICIAL ---
cli                        ; Deshabilitar interrupciones globales

; --- 2) CONFIGURACIÓN DEL HANDSHAKE ---
; Habilitar interrupciones del Handshake (bit 7 = 1)
in  al, HS_STATUS         ; Leer estado actual del Handshake
or  al, 10000000b         ; Activar bit 7 (habilitar interrupciones)
out HS_STATUS, al         ; Escribir configuración al Handshake

; --- 3) CONFIGURACIÓN DEL PIC (Controlador de Interrupciones) ---

; 3.1) Configurar máscara de interrupciones - Solo habilitar INT2
mov al, 11111011b         ; Máscara: habilita solo INT2 (bit 2=0), resto deshabilitado
out IMR, al               ; Aplicar máscara al PIC

; 3.2) Asignar ID de interrupción a la línea INT2
mov al, ID                ; Cargar ID de interrupción (2)
out INT2, al              ; Configurar línea INT2 con este ID

; 3.3) Configurar vector de interrupción en memoria
mov bl, ID                ; BL = posición en tabla de vectores (ID=2)
mov [bl], int2_handler    ; Almacenar dirección de rutina en vector[2]

; --- 4) INICIALIZACIÓN DE VARIABLES ---
mov al, offset mensaje    ; AL = dirección del primer carácter del string
mov puntero, al           ; Guardar en variable puntero

; --- 5) ENVIAR PRIMER CARÁCTER PARA INICIAR EL PROCESO ---
; Esperar que la impresora esté lista
esperar_listo:
    in al, HS_STATUS
    and al, 00000001b     ; Verificar bit busy
    jnz esperar_listo     ; Si busy=1, esperar

; Enviar primer carácter
mov bl, puntero           ; Cargar puntero
mov al, [bl]              ; Obtener primer carácter
cmp al, 0                 ; ¿Es string vacío?
jz fin                    ; Si está vacío, terminar

out HS_DATA, al           ; Enviar primer carácter
inc bl                    ; Avanzar puntero
mov puntero, bl           ; Guardar puntero actualizado
dec restantes             ; Decrementar contador

; --- 6) HABILITAR INTERRUPCIONES Y ESPERAR ---
sti                       ; Habilitar interrupciones globales

; --- 7) BUCLE DE ESPERA ---
; El programa principal espera hasta que se impriman todos los caracteres
bucle_espera:
    cmp restantes, 0      ; ¿Quedan caracteres por imprimir?
    jnz bucle_espera      ; Si quedan, seguir esperando

; --- 8) FINALIZACIÓN ---
fin:
hlt                       ; Detener ejecución del programa

; ===============================================================================
; RUTINA DE INTERRUPCIÓN INT2 - HANDSHAKE
; ===============================================================================
; DESCRIPCIÓN: Se ejecuta automáticamente cuando la impresora está lista
;              para recibir un nuevo carácter (busy = 0)
; ENTRADA: Variable puntero = dirección del siguiente carácter a imprimir
; SALIDA: Carácter enviado a la impresora, puntero actualizado
; ===============================================================================
org 80h
int2_handler:
    ; --- PRESERVAR CONTEXTO ---
    push al               ; Guardar registros que se van a modificar
    push bl

    ; --- VERIFICAR SI HAY MÁS CARACTERES ---
    cmp restantes, 0      ; ¿Quedan caracteres por imprimir?
    jz fin_interrupcion   ; Si no quedan, terminar

    ; --- OBTENER SIGUIENTE CARÁCTER ---
    mov bl, puntero       ; BL = puntero al siguiente carácter
    mov al, [bl]          ; AL = carácter apuntado por BL
    cmp al, 0             ; ¿Es el carácter nulo (fin de string)?
    jz fin_interrupcion   ; Si es 0, terminar

    ; --- ENVIAR CARÁCTER A LA IMPRESORA ---
    out HS_DATA, al       ; Escribir carácter al registro de datos del Handshake

    ; --- ACTUALIZAR PUNTEROS Y CONTADORES ---
    inc bl                ; Avanzar al siguiente carácter
    mov puntero, bl       ; Guardar puntero actualizado
    dec restantes         ; Decrementar contador de caracteres restantes

fin_interrupcion:
    ; --- ENVIAR EOI AL PIC ---
    mov al, 20h           ; Señal de fin de interrupción
    out EOI, al           ; Notificar al PIC

    ; --- RESTAURAR CONTEXTO ---
    pop bl                ; Restaurar registros preservados
    pop al

    ; --- RETORNO DE INTERRUPCIÓN ---
    iret                  ; Retorno de interrupción`},{nombre:"Contador F10",filename:"contador_f10.asm",contenido:`; Programa: Contador de pulsaciones de la tecla F10 usando interrupciones

;-----------------------------------------------
; 1) Definiciones y variables
;-----------------------------------------------

cantidad db 0          ; Variable: almacena la cantidad de veces que se presionó F10

ID   EQU 1             ; ID de la interrupción para F10 (puede ser 0-7)
IMR  EQU 21h           ; Dirección del registro IMR (máscara de interrupciones)
EOI  EQU 20h           ; Dirección para enviar End Of Interrupt al PIC
INT0 EQU 24h           ; Dirección para configurar la línea INT0 (F10)

;-----------------------------------------------
; 2) Inicialización del PIC y vector de interrupción
;-----------------------------------------------

; 2.1) Habilitar solo la interrupción de F10 (INT0)
mov al, 11111110b      ; Habilita solo INT0 (bit 0 en 0), el resto deshabilitado
out IMR, al

; 2.2) Configurar el ID de la interrupción para INT0
mov al, ID             ; Cargar el ID elegido para F10
out INT0, al

; 2.3) Asociar el vector de interrupción con la subrutina atenderf10
mov bl, ID             ; BL = ID de la interrupción
mov [bl], atenderf10   ; Vector de interrupción: dirección de la rutina

;-----------------------------------------------
; 3) Bucle principal (espera activa)
;-----------------------------------------------

loop: jmp loop         ; Espera indefinida (el programa queda esperando interrupciones)

hlt                    ; (Opcional) Detiene la CPU si sale del bucle

;-----------------------------------------------
; 4) Rutina de atención de la interrupción F10
;-----------------------------------------------

org 50h                ; Dirección de la subrutina de atención

atenderf10:
    inc cantidad       ; Incrementa el contador cada vez que se presiona F10
    mov al, 20h        ; Código de End Of Interrupt (EOI)
    out EOI, al        ; Notifica al PIC que terminó la atención
    iret               ; Retorna de la interrupción`},{nombre:"Timer con mensaje",filename:"timer_mensaje.asm",contenido:`; Programa: Imprime "Hola" a los 10 segundos de iniciado y luego termina.
; Utiliza la interrupción del TIMER (ID = 5).

mensaje db "hola"        ; Mensaje a imprimir
imprimio db 0            ; Flag para saber si ya imprimió

; Definición de direcciones de registros de dispositivos
CONT equ 10h             ; Registro de conteo del timer
COMP equ 11h             ; Registro de comparación del timer

EOI  equ 20h             ; End Of Interrupt (para PIC)
IMR  equ 21h             ; Interrupt Mask Register (PIC)
INT1 equ 25h             ; Registro de vector de interrupción 1

; --- Habilitar interrupciones del timer ---
; IMR = 1111 1101b (solo habilita interrupciones del timer y teclado)
mov al, 11111101b        ; Habilita interrupciones del timer (bit 1 en 0)
out IMR, al

; --- Configurar vector de interrupción del timer ---
mov al, 5                ; ID de interrupción del timer
out INT1, al             ; Asigna rutina de atención a la posición 5

; --- Instalar rutina de interrupción en el vector ---
mov bl, 5                ; Vector de interrupción 5
mov [bl], imp_msj        ; Apunta a la rutina imp_msj

; --- Configurar timer para 3 segundos ---
mov al, 10                ; Valor de comparación (10 segundos)
out COMP, al

mov al, 0                ; Reinicia el contador del timer
out CONT, al

; --- Esperar a que se imprima el mensaje ---
loopinf: cmp imprimio, 0 ; ¿Ya imprimió?
         jz loopinf      ; Si no, sigue esperando

hlt                      ; Termina el programa

; --- Rutina de interrupción del timer ---
org 50h
imp_msj:
         mov bl, offset mensaje ; Dirección del mensaje
         mov al, 4             ; Servicio de impresión
         int 7                 ; Llama a la interrupción de impresión
         mov imprimio, 1       ; Marca que ya imprimió
         mov al, 20h           ; Señal de fin de interrupción
         out EOI, al           ; Notifica al PIC
         iret                  ; Retorna de la interrupción`}],b_=pe(0),p4=pe(null),m4=pe(t=>t(p4),(t,e,n)=>{e(p4,n)}),AU=pe(""),c0e=pe(()=>typeof window<"u"&&window.codemirror?window.codemirror.state.doc.toString():EU()||""),u0e=pe(t=>t(AU)!==t(c0e)),jw="showSaveFilePicker"in window;function d0e(){const[t,e]=Oo(),n=tt(b_),i=tt(m4),r=Mp(m4),s=Mp(AU),o=tt(u0e),a=i&&o;x.useEffect(()=>{if(window.codemirror){const f=()=>{};return window.codemirror.dom.addEventListener("input",f),()=>{window.codemirror.dom.removeEventListener("input",f)}}},[]);const l=x.useCallback(async()=>{if(!jw){gi({title:"editor.files.unsupported",variant:"error"});return}if(!(a&&!confirm("editor.files.unsaved")))try{const[f]=await window.showOpenFilePicker({multiple:!1,excludeAcceptAllOption:!0,types:[{accept:{"text/plain":[".txt",".asm",".vonsim"]}}]});if(await f.requestPermission({mode:"readwrite"})==="granted"){r(f);const g=await(await f.getFile()).text();s(g),window.codemirror.dispatch({changes:{from:0,to:window.codemirror.state.doc.length,insert:g}})}}catch(f){console.error(f),gi({title:"editor.files.open-error",variant:"error"})}},[a,r,s]),c=x.useCallback(f=>{a&&!confirm("editor.files.unsaved")||(r(null),s(f.contenido),window.codemirror.dispatch({changes:{from:0,to:window.codemirror.state.doc.length,insert:f.contenido}}),gi({title:`Ejemplo cargado: ${f.nombre}`,variant:"info"}))},[a,r,s]),u=x.useCallback(async()=>{if(!jw){gi({title:"editor.files.unsupported",variant:"error"});return}if(!i){gi({title:"No hay archivo abierto para guardar",variant:"error"});return}if(a)try{const f=window.codemirror.state.doc.toString(),p=await i.createWritable({keepExistingData:!1});await p.write(f),await p.close(),s(f),gi({title:"Archivo guardado",variant:"info"})}catch(f){console.error(f),gi({title:"editor.files.save-error",variant:"error"})}},[i,a,s]),d=x.useCallback(async()=>{const f=window.codemirror.state.doc.toString(),p=(i==null?void 0:i.name)||`vonsim-${new Date().toISOString().slice(0,10)}.asm`;if(jw)try{const m=await window.showSaveFilePicker({suggestedName:p,excludeAcceptAllOption:!0,types:[{accept:{"text/plain":[".txt",".asm",".vonsim"]}}]});if(await m.requestPermission({mode:"readwrite"})==="granted"){r(m);const y=await m.createWritable({keepExistingData:!1});await y.write(f),await y.close(),s(f),gi({title:"Archivo guardado",variant:"info"})}}catch(m){console.error(m),gi({title:"editor.files.save-error",variant:"error"})}else{const m=new Blob([f],{type:"text/plain"}),g=URL.createObjectURL(m),y=document.createElement("a");y.style.display="none",y.href=g,y.download=p,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(g)}},[i,r,s]);return h.jsxs("div",{"data-testid":"status-bar",className:"flex items-center justify-between border-t border-stone-700 bg-gradient-to-r from-stone-800 to-stone-900 px-4 py-0.5 font-sans text-xs text-stone-300 shadow-inner",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[i&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"font-medium text-white transition-colors",children:i.name}),a&&h.jsx("span",{className:"size-2 rounded-full bg-orange-400"})]}),i&&h.jsx("div",{className:"h-4 w-px bg-stone-600"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(Dy,{children:[h.jsx(jy,{asChild:!0,children:h.jsx(Ct,{variant:"ghost",size:"sm",className:"hover-lift","aria-label":"editor.files.open",children:h.jsx("span",{className:"icon-[lucide--folder-open] size-4"})})}),h.jsx(dm,{align:"start",className:"w-80 border-stone-600/50 bg-stone-900/95 p-0 backdrop-blur-md",children:h.jsxs("div",{className:"flex flex-col",children:[h.jsxs("div",{className:"border-b border-stone-700/50 bg-gradient-to-r from-stone-800 to-stone-900 px-4 py-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"icon-[lucide--folder-open] size-5 text-mantis-400"}),h.jsx("span",{className:"font-semibold text-white",children:"Abrir Archivo"})]}),h.jsx("p",{className:"mt-1 text-xs text-stone-400",children:"Selecciona un archivo de tu PC o un ejemplo"})]}),h.jsxs("div",{className:"space-y-3 p-3",children:[h.jsx(Ct,{variant:"default",size:"sm",onClick:l,className:"h-auto w-full justify-start border-0 bg-gradient-to-r from-mantis-600 to-mantis-700 px-4 py-3 text-white shadow-sm transition-all duration-200 hover:from-mantis-500 hover:to-mantis-600",children:h.jsxs("div",{className:"flex w-full items-center gap-3",children:[h.jsx("div",{className:"rounded-lg bg-white/10 p-1.5",children:h.jsx("span",{className:"icon-[lucide--laptop] size-5"})}),h.jsxs("div",{className:"flex-1 text-left",children:[h.jsx("div",{className:"font-medium",children:"Abrir desde mi PC"}),h.jsx("div",{className:"text-xs text-mantis-100/80",children:"Archivos .asm, .txt, .vonsim"})]}),h.jsx("span",{className:"icon-[lucide--arrow-right] size-4 text-mantis-200"})]})}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 flex items-center",children:h.jsx("div",{className:"w-full border-t border-stone-700/60"})}),h.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:h.jsx("span",{className:"bg-stone-900 px-2 font-medium tracking-wider text-stone-500",children:"o selecciona un ejemplo"})})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-2 px-1",children:[h.jsx("span",{className:"icon-[lucide--lightbulb] size-4 text-amber-400"}),h.jsx("span",{className:"text-sm font-medium text-amber-200",children:"Ejemplos de Programas"})]}),h.jsx("div",{className:"custom-scrollbar grid max-h-64 gap-1 overflow-y-auto pr-1",children:l0e.map((f,p)=>h.jsx(Ct,{variant:"ghost",size:"sm",className:"group h-auto w-full justify-start rounded-lg border border-transparent px-2 py-2.5 text-left transition-all duration-200 hover:border-stone-600/30 hover:bg-stone-800/60",onClick:()=>c(f),children:h.jsxs("div",{className:"flex w-full items-center gap-3",children:[h.jsx("div",{className:"flex size-6 shrink-0 items-center justify-center rounded-full border border-amber-500/30 bg-gradient-to-br from-amber-400/20 to-orange-500/20",children:h.jsx("span",{className:"text-xs font-bold text-amber-300",children:p+1})}),h.jsx("div",{className:"min-w-0 flex-1 text-left",children:h.jsx("div",{className:"text-left font-medium text-stone-200 transition-colors group-hover:text-white",children:f.nombre})}),h.jsx("span",{className:"icon-[lucide--chevron-right] size-4 shrink-0 text-stone-500 transition-colors group-hover:text-amber-400"})]})},f.filename))})]})]}),h.jsx("div",{className:"border-t border-stone-700/50 bg-stone-800/30 px-4 py-2",children:h.jsx("p",{className:"text-center text-xs text-stone-500",children:"Los ejemplos te ayudan a aprender la sintaxis de VonSim"})})]})})]}),h.jsx(rs,{content:"editor.files.save",position:"top",children:h.jsx(Ct,{variant:"ghost",size:"sm",onClick:u,disabled:!i||!a,className:"hover-lift","aria-label":"editor.files.save",children:h.jsx("span",{className:"icon-[lucide--save] size-4"})})}),h.jsx(rs,{content:"editor.files.save-as",position:"top",children:h.jsx(Ct,{variant:"ghost",size:"sm",onClick:d,className:"hover-lift","aria-label":"editor.files.save-as",children:h.jsx("span",{className:"icon-[lucide--save-all] size-4"})})})]})]}),h.jsxs("div",{className:"flex items-center gap-6",children:[h.jsxs(Dy,{children:[h.jsx(jy,{asChild:!0,children:h.jsx("button",{className:"flex items-center justify-center rounded-lg p-1 text-stone-300 hover:bg-stone-800 focus:outline-none focus:ring-2 focus:ring-mantis-500","aria-label":"Ajustar tamaño de fuente del editor",title:"Ajustar tamaño de fuente del editor",type:"button",children:h.jsx("span",{className:"icon-[lucide--pilcrow-square] size-5"})})}),h.jsxs(dm,{align:"end",className:"w-56 p-4",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[h.jsx("span",{className:"icon-[lucide--pilcrow-square] size-5 text-mantis-400"}),h.jsx("span",{className:"text-sm font-medium text-white",children:"Tamaño de fuente del editor"}),h.jsxs("span",{className:"ml-auto text-xs text-stone-400",children:[t.editorFontSize,"px"]})]}),h.jsx(Va,{value:[t.editorFontSize],min:8,max:64,step:1,onValueChange:([f])=>e(p=>({...p,editorFontSize:f})),className:"w-full"}),h.jsxs("div",{className:"mt-2 flex justify-between text-xs text-stone-500",children:[h.jsx("span",{children:"8"}),h.jsx("span",{children:"64"})]})]})]}),h.jsxs("div",{className:re("flex items-center gap-1.5 rounded-full px-2 py-0.5 font-medium transition-colors",n>0?"border border-red-500/30 bg-red-500/20 text-red-300":"border border-green-500/30 bg-green-500/20 text-green-300"),children:[h.jsx("div",{className:re("size-2 rounded-full",n>0?"bg-red-400":"bg-green-400")}),h.jsx("span",{className:"font-mono",children:n>0?`${n} error${n>1?"es":""}`:"Sin errores"})]})]})]})}const Gi={character:Ze.character,comment:Ze.comment,"data-directive":$n.define(),identifier:Ze.variableName,instruction:$n.define(),label:Ze.labelName,number:Ze.number,operator:Ze.operator,offset:$n.define(),"ptr-size":$n.define(),punctuation:Ze.punctuation,register:$n.define(),special:$n.define(),string:Ze.string,unassigned:$n.define()},f0e=OA.define({name:"vonsim",token:t=>{if(t.eatSpace())return null;if(t.match(/[01]+b\b/i)||t.match(/\d[a-f\d]*h\b/i)||t.match(/\d+\b/))return"number";if(t.match(/'[^'\n]'/))return"character";if(t.eat('"'))return t.eatWhile(/[^"\n]/),t.eat('"'),"string";if(t.eat(/[*+-]/))return"operator";if(t.eat(/[(),[\]]/))return"punctuation";if(t.eat("?"))return"unassigned";if(t.eat(";"))return t.skipToEnd(),"comment";if(t.eat(/[a-z_.]/i)){t.eatWhile(/\w/);const e=t.current().toUpperCase();return e==="ORG"||e==="END"||e===".DATA"||e===".CODE"?"special":e==="OFFSET"?"offset":e==="BYTE"||e==="WORD"||e==="PTR"?"ptr-size":nE.includes(e)?"data-directive":iE.includes(e)?"instruction":oy.includes(e)?"register":t.eat(":")?"label":"identifier"}return t.next(),null},languageData:{commentTokens:{line:";"},closeBrackets:{brackets:["(","[",'"']}},tokenTable:Gi}),h0e=The(x1.define([{tag:Gi.character,class:"text-orange-300"},{tag:Gi.comment,class:"text-stone-500 italic"},{tag:Gi["data-directive"],class:"text-rose-400/80"},{tag:Gi.instruction,class:"text-mantis-400"},{tag:Gi.number,class:"text-cyan-300/60"},{tag:Gi.operator,class:"text-rose-300"},{tag:Gi.offset,class:"text-rose-400/80 italic"},{tag:Gi["ptr-size"],class:"text-rose-400/80 italic"},{tag:Gi.punctuation,class:"text-stone-600"},{tag:Gi.register,class:"text-emerald-400/80"},{tag:Gi.special,class:"text-yellow-300/80"},{tag:Gi.string,class:"text-orange-300"},{tag:Gi.unassigned,class:"text-rose-400/80"}])),p0e=Ome(t=>{const e=t.state.doc.toString(),n=Kj(e);if(n.success)return P.set(b_,0),[];const i=n,r=nt().language,s=i.errors.map(o=>{var c,u;const a=((c=o.position)==null?void 0:c.start)??0,l=((u=o.position)==null?void 0:u.end)??e.length;return{message:o.translate(r),severity:"error",from:a,to:l}});return P.set(b_,s.length),s},{delay:200});function m0e(){return new che(f0e,[h0e,p0e])}function PU({className:t}){const[e,n]=x.useState(),i=tZ(),r=x.useCallback(s=>{s&&n(s)},[]);return x.useEffect(()=>{if(e)return window.codemirror=new De({state:St.create({doc:EU()||"",extensions:[St.tabSize.of(2),N6.of(St.readOnly.of(!1)),o0e,vne(),Sne,xne(),Hte(),rpe(),Lte(),De.domEventHandlers({drop:s=>s.preventDefault()}),St.allowMultipleSelections.of(!0),Yte(),De.updateListener.of(s=>{s.selectionSet}),x6.of([{key:"Escape",run:s=>(s.dispatch({selection:le.create([s.state.selection.main],0)}),!0)},{key:"Tab",run:s=>s.state.selection.ranges.some(o=>!o.empty)?m_(s):(s.dispatch(s.state.update(s.state.replaceSelection(" ".repeat(s.state.tabSize)),{scrollIntoView:!0,userEvent:"input"})),!0)},...Vme]),m0e()]}),parent:e}),()=>{var s;return(s=window.codemirror)==null?void 0:s.destroy()}},[e]),h.jsxs("div",{className:re("flex flex-col rounded-lg border border-stone-700 bg-gradient-to-br from-stone-900 to-stone-800 shadow-xl",t),children:[h.jsx("div",{ref:r,className:"grow overflow-auto rounded-t-lg font-mono",style:{fontSize:`${i}px`,lineHeight:1.25}}),h.jsx(d0e,{})]})}const NU=x.memo(()=>{const t=QC(),e=wK("(max-width: 640px)");$F(),FF();const n=x.useMemo(()=>({}),[]);return h.jsxs("div",{"data-testid":"app-container",className:"flex h-screen w-screen flex-col bg-black text-white",lang:t,style:n,children:[h.jsx(zF,{}),h.jsx(LF,{"data-testid":"header"}),e?h.jsx(RU,{}):h.jsx(MU,{}),h.jsx(Wj,{"data-testid":"footer"}),h.jsx(HF,{}),h.jsx(BF,{})]})});NU.displayName="App";const MU=x.memo(()=>{const[t]=Em(m1);return h.jsxs(jD,{autoSaveId:"layout",direction:"horizontal",tagName:"main",className:"overflow-auto px-2",children:[h.jsx(U0,{id:"panel-editor",order:1,minSize:30,defaultSize:50,tagName:"section",className:"rounded-lg border border-stone-600 bg-black","data-testid":"panel-editor",children:h.jsx(PU,{className:"size-full"})}),h.jsx(h2,{className:"w-2"}),h.jsx(U0,{id:"panel-computer",order:2,minSize:20,defaultSize:50,tagName:"section",className:"computer-background rounded-lg border border-stone-600","data-testid":"panel-computer",children:h.jsx(bz,{})}),t&&h.jsxs(h.Fragment,{children:[h.jsx(h2,{className:"w-2"}),h.jsx(U0,{id:"panel-settings",order:3,minSize:30,defaultSize:30,tagName:"section",className:"rounded-lg border border-stone-600 bg-stone-800","data-testid":"panel-settings",children:h.jsx(TF,{className:"size-full"})})]})]})});MU.displayName="DesktopLayout";const RU=x.memo(()=>{const t=cn(),[e,n]=x.useState("editor"),[i,r]=Em(m1),s=tt(Hn),o=x.useMemo(()=>"metadata"in s&&s.metadata?`${s.metadata.name}${s.metadata.operands.length?" "+s.metadata.operands.join(", "):""}`:"",[s]),a=x.useMemo(()=>i?"settings":e,[i,e]),l=x.useCallback(u=>{i&&r(!1),n(u)},[i,r]),c=x.useMemo(()=>{switch(a){case"editor":return"Editor";case"computer":return"Computadora";case"settings":return"Configuración";default:return""}},[a]);return h.jsx(lD,{value:a,onValueChange:l,asChild:!0,children:h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"sticky top-0 z-30 w-full border-b border-stone-700 bg-stone-900 px-4 py-2",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-stone-500",children:"Pestaña:"}),h.jsx("span",{className:"text-sm font-medium text-white",children:c})]}),a==="computer"&&h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-xs text-stone-500",children:"Instrucción actual:"}),h.jsx("div",{className:"font-mono text-sm text-mantis-400",children:o||h.jsx("span",{className:"italic text-stone-400",children:"Sin instrucción"})})]})]})}),h.jsx(z0,{value:"editor",asChild:!0,children:h.jsx("section",{className:"mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-black data-[state=inactive]:hidden","data-testid":"panel-editor",children:h.jsx(PU,{className:"size-full"})})}),h.jsx(z0,{value:"computer",asChild:!0,children:h.jsx("section",{className:"computer-background mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden","data-testid":"panel-computer",children:h.jsx(bz,{})})}),h.jsx(z0,{value:"settings",asChild:!0,children:h.jsx("section",{className:"mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden","data-testid":"panel-settings",children:h.jsx(TF,{className:"size-full"})})}),h.jsx("div",{className:"border-t border-stone-700 bg-stone-900 p-2",children:h.jsxs(uD,{className:"grid grid-cols-3 gap-2",children:[h.jsxs(F0,{value:"editor",className:"inline-flex flex-col items-center justify-center rounded-lg py-2 text-xs font-medium text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-mantis-600 data-[state=active]:text-white",children:[h.jsx("span",{className:"icon-[lucide--file-terminal] mb-1 size-5"}),t("control.tabs.editor")]}),h.jsxs(F0,{value:"computer",className:"inline-flex flex-col items-center justify-center rounded-lg py-2 text-xs font-medium text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-mantis-600 data-[state=active]:text-white",children:[h.jsx("span",{className:"icon-[lucide--computer] mb-1 size-5"}),t("control.tabs.computer")]}),h.jsxs(F0,{value:"settings",className:"inline-flex flex-col items-center justify-center rounded-lg py-2 text-xs font-medium text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-mantis-600 data-[state=active]:text-white",children:[h.jsx("span",{className:"icon-[lucide--settings] mb-1 size-5"}),"Configuración"]})]})})]})})});RU.displayName="MobileLayout";var nP="ToastProvider",[iP,g0e,v0e]=_m("Toast"),[IU,Ave]=zs("Toast",[v0e]),[y0e,A1]=IU(nP),TU=t=>{const{__scopeToast:e,label:n="Notification",duration:i=5e3,swipeDirection:r="right",swipeThreshold:s=50,children:o}=t,[a,l]=x.useState(null),[c,u]=x.useState(0),d=x.useRef(!1),f=x.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${nP}\`. Expected non-empty \`string\`.`),h.jsx(iP.Provider,{scope:e,children:h.jsx(y0e,{scope:e,label:n,duration:i,swipeDirection:r,swipeThreshold:s,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:x.useCallback(()=>u(p=>p+1),[]),onToastRemove:x.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:o})})};TU.displayName=nP;var OU="ToastViewport",b0e=["F8"],x_="toast.viewportPause",w_="toast.viewportResume",LU=x.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:i=b0e,label:r="Notifications ({hotkey})",...s}=t,o=A1(OU,n),a=g0e(n),l=x.useRef(null),c=x.useRef(null),u=x.useRef(null),d=x.useRef(null),f=wt(e,d,o.onViewportChange),p=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),m=o.toastCount>0;x.useEffect(()=>{const y=v=>{var w;i.length!==0&&i.every(k=>v[k]||v.code===k)&&((w=d.current)==null||w.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[i]),x.useEffect(()=>{const y=l.current,v=d.current;if(m&&y&&v){const b=()=>{if(!o.isClosePausedRef.current){const E=new CustomEvent(x_);v.dispatchEvent(E),o.isClosePausedRef.current=!0}},w=()=>{if(o.isClosePausedRef.current){const E=new CustomEvent(w_);v.dispatchEvent(E),o.isClosePausedRef.current=!1}},k=E=>{!y.contains(E.relatedTarget)&&w()},C=()=>{y.contains(document.activeElement)||w()};return y.addEventListener("focusin",b),y.addEventListener("focusout",k),y.addEventListener("pointermove",b),y.addEventListener("pointerleave",C),window.addEventListener("blur",b),window.addEventListener("focus",w),()=>{y.removeEventListener("focusin",b),y.removeEventListener("focusout",k),y.removeEventListener("pointermove",b),y.removeEventListener("pointerleave",C),window.removeEventListener("blur",b),window.removeEventListener("focus",w)}}},[m,o.isClosePausedRef]);const g=x.useCallback(({tabbingDirection:y})=>{const b=a().map(w=>{const k=w.ref.current,C=[k,...I0e(k)];return y==="forwards"?C:C.reverse()});return(y==="forwards"?b.reverse():b).flat()},[a]);return x.useEffect(()=>{const y=d.current;if(y){const v=b=>{var C,E,_;const w=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!w){const A=document.activeElement,R=b.shiftKey;if(b.target===y&&R){(C=c.current)==null||C.focus();return}const I=g({tabbingDirection:R?"backwards":"forwards"}),G=I.findIndex(B=>B===A);Bw(I.slice(G+1))?b.preventDefault():R?(E=c.current)==null||E.focus():(_=u.current)==null||_.focus()}};return y.addEventListener("keydown",v),()=>y.removeEventListener("keydown",v)}},[a,g]),h.jsxs(Goe,{ref:l,role:"region","aria-label":r.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:m?void 0:"none"},children:[m&&h.jsx(S_,{ref:c,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});Bw(y)}}),h.jsx(iP.Slot,{scope:n,children:h.jsx(et.ol,{tabIndex:-1,...s,ref:f})}),m&&h.jsx(S_,{ref:u,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});Bw(y)}})]})});LU.displayName=OU;var DU="ToastFocusProxy",S_=x.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:i,...r}=t,s=A1(DU,n);return h.jsx(yA,{"aria-hidden":!0,tabIndex:0,...r,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=s.viewport)!=null&&c.contains(a))&&i()}})});S_.displayName=DU;var Ym="Toast",x0e="toast.swipeStart",w0e="toast.swipeMove",S0e="toast.swipeCancel",k0e="toast.swipeEnd",jU=x.forwardRef((t,e)=>{const{forceMount:n,open:i,defaultOpen:r,onOpenChange:s,...o}=t,[a,l]=Il({prop:i,defaultProp:r??!0,onChange:s,caller:Ym});return h.jsx(Sa,{present:n||a,children:h.jsx(E0e,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:Ir(t.onPause),onResume:Ir(t.onResume),onSwipeStart:ke(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ke(t.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:ke(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ke(t.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});jU.displayName=Ym;var[_0e,C0e]=IU(Ym,{onClose(){}}),E0e=x.forwardRef((t,e)=>{const{__scopeToast:n,type:i="foreground",duration:r,open:s,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:p,...m}=t,g=A1(Ym,n),[y,v]=x.useState(null),b=wt(e,B=>v(B)),w=x.useRef(null),k=x.useRef(null),C=r||g.duration,E=x.useRef(0),_=x.useRef(C),A=x.useRef(0),{onToastAdd:R,onToastRemove:L}=g,O=Ir(()=>{var K;(y==null?void 0:y.contains(document.activeElement))&&((K=g.viewport)==null||K.focus()),o()}),I=x.useCallback(B=>{!B||B===1/0||(window.clearTimeout(A.current),E.current=new Date().getTime(),A.current=window.setTimeout(O,B))},[O]);x.useEffect(()=>{const B=g.viewport;if(B){const K=()=>{I(_.current),c==null||c()},J=()=>{const ne=new Date().getTime()-E.current;_.current=_.current-ne,window.clearTimeout(A.current),l==null||l()};return B.addEventListener(x_,J),B.addEventListener(w_,K),()=>{B.removeEventListener(x_,J),B.removeEventListener(w_,K)}}},[g.viewport,C,l,c,I]),x.useEffect(()=>{s&&!g.isClosePausedRef.current&&I(C)},[s,C,g.isClosePausedRef,I]),x.useEffect(()=>(R(),()=>L()),[R,L]);const G=x.useMemo(()=>y?HU(y):null,[y]);return g.viewport?h.jsxs(h.Fragment,{children:[G&&h.jsx(A0e,{__scopeToast:n,role:"status","aria-live":i==="foreground"?"assertive":"polite","aria-atomic":!0,children:G}),h.jsx(_0e,{scope:n,onClose:O,children:Zl.createPortal(h.jsx(iP.ItemSlot,{scope:n,children:h.jsx(Woe,{asChild:!0,onEscapeKeyDown:ke(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||O(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:h.jsx(et.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":g.swipeDirection,...m,ref:b,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:ke(t.onKeyDown,B=>{B.key==="Escape"&&(a==null||a(B.nativeEvent),B.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,O()))}),onPointerDown:ke(t.onPointerDown,B=>{B.button===0&&(w.current={x:B.clientX,y:B.clientY})}),onPointerMove:ke(t.onPointerMove,B=>{if(!w.current)return;const K=B.clientX-w.current.x,J=B.clientY-w.current.y,ne=!!k.current,V=["left","right"].includes(g.swipeDirection),U=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,se=V?U(0,K):0,_e=V?0:U(0,J),Q=B.pointerType==="touch"?10:2,ae={x:se,y:_e},z={originalEvent:B,delta:ae};ne?(k.current=ae,_0(w0e,d,z,{discrete:!1})):g4(ae,g.swipeDirection,Q)?(k.current=ae,_0(x0e,u,z,{discrete:!1}),B.target.setPointerCapture(B.pointerId)):(Math.abs(K)>Q||Math.abs(J)>Q)&&(w.current=null)}),onPointerUp:ke(t.onPointerUp,B=>{const K=k.current,J=B.target;if(J.hasPointerCapture(B.pointerId)&&J.releasePointerCapture(B.pointerId),k.current=null,w.current=null,K){const ne=B.currentTarget,V={originalEvent:B,delta:K};g4(K,g.swipeDirection,g.swipeThreshold)?_0(k0e,p,V,{discrete:!0}):_0(S0e,f,V,{discrete:!0}),ne.addEventListener("click",U=>U.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),A0e=t=>{const{__scopeToast:e,children:n,...i}=t,r=A1(Ym,e),[s,o]=x.useState(!1),[a,l]=x.useState(!1);return M0e(()=>o(!0)),x.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:h.jsx(zm,{asChild:!0,children:h.jsx(yA,{...i,children:s&&h.jsxs(h.Fragment,{children:[r.label," ",n]})})})},P0e="ToastTitle",BU=x.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t;return h.jsx(et.div,{...i,ref:e})});BU.displayName=P0e;var N0e="ToastDescription",$U=x.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t;return h.jsx(et.div,{...i,ref:e})});$U.displayName=N0e;var FU="ToastAction",zU=x.forwardRef((t,e)=>{const{altText:n,...i}=t;return n.trim()?h.jsx(VU,{altText:n,asChild:!0,children:h.jsx(rP,{...i,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${FU}\`. Expected non-empty \`string\`.`),null)});zU.displayName=FU;var UU="ToastClose",rP=x.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t,r=C0e(UU,n);return h.jsx(VU,{asChild:!0,children:h.jsx(et.button,{type:"button",...i,ref:e,onClick:ke(t.onClick,r.onClose)})})});rP.displayName=UU;var VU=x.forwardRef((t,e)=>{const{__scopeToast:n,altText:i,...r}=t;return h.jsx(et.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":i||void 0,...r,ref:e})});function HU(t){const e=[];return Array.from(t.childNodes).forEach(i=>{if(i.nodeType===i.TEXT_NODE&&i.textContent&&e.push(i.textContent),R0e(i)){const r=i.ariaHidden||i.hidden||i.style.display==="none",s=i.dataset.radixToastAnnounceExclude==="";if(!r)if(s){const o=i.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...HU(i))}}),e}function _0(t,e,n,{discrete:i}){const r=n.originalEvent.currentTarget,s=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),i?RC(r,s):r.dispatchEvent(s)}var g4=(t,e,n=0)=>{const i=Math.abs(t.x),r=Math.abs(t.y),s=i>r;return e==="left"||e==="right"?s&&i>n:!s&&r>n};function M0e(t=()=>{}){const e=Ir(t);ci(()=>{let n=0,i=0;return n=window.requestAnimationFrame(()=>i=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(i)}},[e])}function R0e(t){return t.nodeType===t.ELEMENT_NODE}function I0e(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Bw(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var T0e=TU,WU=LU,GU=jU,qU=BU,KU=$U,XU=zU,YU=rP;const O0e=T0e,JU=x.forwardRef(({className:t,...e},n)=>h.jsx(WU,{ref:n,className:re("fixed inset-x-0 top-12 z-[100] mx-auto flex max-h-screen w-full flex-col p-4 md:max-w-[420px]",t),...e}));JU.displayName=WU.displayName;const ZU=x.forwardRef(({className:t,variant:e="default",...n},i)=>h.jsx(GU,{ref:i,"data-variant":e,className:re("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md p-6 pr-8 shadow-lg transition-all",e==="default"&&"border border-stone-600 bg-stone-900 text-white",e==="error"&&"border border-red-600 bg-red-900 text-red-50",e==="info"&&"border border-green-500 bg-stone-900 text-white",t),...n}));ZU.displayName=GU.displayName;const L0e=x.forwardRef(({className:t,...e},n)=>h.jsx(XU,{ref:n,className:re("inline-flex h-8 shrink-0 items-center justify-center rounded-md bg-mantis-500 px-3 text-sm font-medium ring-offset-stone-900 transition-colors hover:bg-mantis-400 focus:outline-none focus:ring-2 focus:ring-stone-600 focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50","group-data-[variant=error]:border group-data-[variant=error]:border-white/40 group-data-[variant=error]:hover:border-white/30  group-data-[variant=error]:hover:bg-red-700 group-data-[variant=error]:hover:text-white group-data-[variant=error]:focus:ring-white",t),...e}));L0e.displayName=XU.displayName;const QU=x.forwardRef(({className:t,...e},n)=>h.jsx(YU,{ref:n,className:re("text-current/50 absolute right-2 top-2 rounded-md p-1 opacity-0 transition-opacity hover:text-current focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100",t),"toast-close":"",...e,children:h.jsx("span",{className:"block size-4",children:"✕"})}));QU.displayName=YU.displayName;const e7=x.forwardRef(({className:t,...e},n)=>h.jsx(qU,{ref:n,className:re("text-sm font-semibold",t),...e}));e7.displayName=qU.displayName;const t7=x.forwardRef(({className:t,...e},n)=>h.jsx(KU,{ref:n,className:re("text-sm opacity-90",t),...e}));t7.displayName=KU.displayName;function D0e(){const{toastList:t}=Nne();return h.jsxs(O0e,{children:[t.map(({id:e,title:n,description:i,action:r,variant:s,otherProps:o})=>h.jsxs(ZU,{...o,variant:s,children:[h.jsxs("div",{className:"grid gap-1",children:[n&&h.jsx(e7,{children:n}),i&&h.jsx(t7,{children:i})]}),r,h.jsx(QU,{})]},e)),h.jsx(JU,{})]})}window.codemirror=null;const j0e=QL(document.getElementById("root"));j0e.render(h.jsx(x.StrictMode,{children:h.jsxs(ZH,{client:I6,children:[h.jsx(Bj,{children:h.jsx(NU,{})}),h.jsx(D0e,{})]})}));
