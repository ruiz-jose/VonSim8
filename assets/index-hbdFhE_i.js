var q3=Object.defineProperty;var TC=t=>{throw TypeError(t)};var Y3=(t,e,n)=>e in t?q3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var oe=(t,e,n)=>Y3(t,typeof e!="symbol"?e+"":e,n),c0=(t,e,n)=>e.has(t)||TC("Cannot "+n);var C=(t,e,n)=>(c0(t,e,"read from private field"),n?n.call(t):e.get(t)),Re=(t,e,n)=>e.has(t)?TC("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Y=(t,e,n,i)=>(c0(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),gt=(t,e,n)=>(c0(t,e,"access private method"),n);function J3(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var Z3=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vN={exports:{}},Yv={},yN={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $f=Symbol.for("react.element"),Q3=Symbol.for("react.portal"),e4=Symbol.for("react.fragment"),t4=Symbol.for("react.strict_mode"),n4=Symbol.for("react.profiler"),i4=Symbol.for("react.provider"),r4=Symbol.for("react.context"),s4=Symbol.for("react.forward_ref"),o4=Symbol.for("react.suspense"),a4=Symbol.for("react.memo"),l4=Symbol.for("react.lazy"),RC=Symbol.iterator;function u4(t){return t===null||typeof t!="object"?null:(t=RC&&t[RC]||t["@@iterator"],typeof t=="function"?t:null)}var wN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bN=Object.assign,xN={};function Jc(t,e,n){this.props=t,this.context=e,this.refs=xN,this.updater=n||wN}Jc.prototype.isReactComponent={};Jc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Jc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function SN(){}SN.prototype=Jc.prototype;function uS(t,e,n){this.props=t,this.context=e,this.refs=xN,this.updater=n||wN}var cS=uS.prototype=new SN;cS.constructor=uS;bN(cS,Jc.prototype);cS.isPureReactComponent=!0;var NC=Array.isArray,kN=Object.prototype.hasOwnProperty,dS={current:null},_N={key:!0,ref:!0,__self:!0,__source:!0};function CN(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)kN.call(e,i)&&!_N.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:$f,type:t,key:s,ref:o,props:r,_owner:dS.current}}function c4(t,e){return{$$typeof:$f,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function hS(t){return typeof t=="object"&&t!==null&&t.$$typeof===$f}function d4(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var MC=/\/+/g;function d0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?d4(""+t.key):e.toString(36)}function Mm(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case $f:case Q3:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+d0(o,0):i,NC(r)?(n="",t!=null&&(n=t.replace(MC,"$&/")+"/"),Mm(r,e,n,"",function(u){return u})):r!=null&&(hS(r)&&(r=c4(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(MC,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",NC(t))for(var a=0;a<t.length;a++){s=t[a];var l=i+d0(s,a);o+=Mm(s,e,n,l,r)}else if(l=u4(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=i+d0(s,a++),o+=Mm(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function gp(t,e,n){if(t==null)return t;var i=[],r=0;return Mm(t,i,"","",function(s){return e.call(n,s,r++)}),i}function h4(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var oi={current:null},Om={transition:null},f4={ReactCurrentDispatcher:oi,ReactCurrentBatchConfig:Om,ReactCurrentOwner:dS};function EN(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:gp,forEach:function(t,e,n){gp(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return gp(t,function(){e++}),e},toArray:function(t){return gp(t,function(e){return e})||[]},only:function(t){if(!hS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qe.Component=Jc;qe.Fragment=e4;qe.Profiler=n4;qe.PureComponent=uS;qe.StrictMode=t4;qe.Suspense=o4;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=f4;qe.act=EN;qe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=bN({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=dS.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)kN.call(e,l)&&!_N.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:$f,type:t.type,key:r,ref:s,props:i,_owner:o}};qe.createContext=function(t){return t={$$typeof:r4,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:i4,_context:t},t.Consumer=t};qe.createElement=CN;qe.createFactory=function(t){var e=CN.bind(null,t);return e.type=t,e};qe.createRef=function(){return{current:null}};qe.forwardRef=function(t){return{$$typeof:s4,render:t}};qe.isValidElement=hS;qe.lazy=function(t){return{$$typeof:l4,_payload:{_status:-1,_result:t},_init:h4}};qe.memo=function(t,e){return{$$typeof:a4,type:t,compare:e===void 0?null:e}};qe.startTransition=function(t){var e=Om.transition;Om.transition={};try{t()}finally{Om.transition=e}};qe.unstable_act=EN;qe.useCallback=function(t,e){return oi.current.useCallback(t,e)};qe.useContext=function(t){return oi.current.useContext(t)};qe.useDebugValue=function(){};qe.useDeferredValue=function(t){return oi.current.useDeferredValue(t)};qe.useEffect=function(t,e){return oi.current.useEffect(t,e)};qe.useId=function(){return oi.current.useId()};qe.useImperativeHandle=function(t,e,n){return oi.current.useImperativeHandle(t,e,n)};qe.useInsertionEffect=function(t,e){return oi.current.useInsertionEffect(t,e)};qe.useLayoutEffect=function(t,e){return oi.current.useLayoutEffect(t,e)};qe.useMemo=function(t,e){return oi.current.useMemo(t,e)};qe.useReducer=function(t,e,n){return oi.current.useReducer(t,e,n)};qe.useRef=function(t){return oi.current.useRef(t)};qe.useState=function(t){return oi.current.useState(t)};qe.useSyncExternalStore=function(t,e,n){return oi.current.useSyncExternalStore(t,e,n)};qe.useTransition=function(){return oi.current.useTransition()};qe.version="18.3.1";yN.exports=qe;var S=yN.exports;const fn=Yc(S),fS=J3({__proto__:null,default:fn},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p4=S,m4=Symbol.for("react.element"),g4=Symbol.for("react.fragment"),v4=Object.prototype.hasOwnProperty,y4=p4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,w4={key:!0,ref:!0,__self:!0,__source:!0};function AN(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)v4.call(e,i)&&!w4.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:m4,type:t,key:s,ref:o,props:r,_owner:y4.current}}Yv.Fragment=g4;Yv.jsx=AN;Yv.jsxs=AN;vN.exports=Yv;var g=vN.exports;function OC(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function ke(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?OC(Object(n),!0).forEach(function(i){X(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):OC(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Ah(t){return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ah(t)}function at(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IC(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function lt(t,e,n){return e&&IC(t.prototype,e),n&&IC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function X(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b4(t,e){if(t==null)return{};var n,i,r=function(o,a){if(o==null)return{};var l,u,c={},d=Object.keys(o);for(u=0;u<d.length;u++)l=d[u],a.indexOf(l)>=0||(c[l]=o[l]);return c}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Zn(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,i){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var s,o,a=[],l=!0,u=!1;try{for(r=r.call(n);!(l=(s=r.next()).done)&&(a.push(s.value),!i||a.length!==i);l=!0);}catch(c){u=!0,o=c}finally{try{l||r.return==null||r.return()}finally{if(u)throw o}}return a}}(t,e)||pS(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function yo(t){return function(e){if(Array.isArray(e))return lb(e)}(t)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(t)||pS(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function pS(t,e){if(t){if(typeof t=="string")return lb(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lb(t,e):void 0}}function lb(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Ar(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=pS(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{o||n.return==null||n.return()}finally{if(a)throw s}}}}var Vr={DEBUG:!1,LIB_VERSION:"1.150.1"},x4=Array.isArray,PN=Object.prototype,TN=PN.hasOwnProperty,Jv=PN.toString,on=x4||function(t){return Jv.call(t)==="[object Array]"},Yr=function(t){return typeof t=="function"},En=function(t){return t===Object(t)&&!on(t)},Im=function(t){if(En(t)){for(var e in t)if(TN.call(t,e))return!1;return!0}return!1},Me=function(t){return t===void 0},Un=function(t){return Jv.call(t)=="[object String]"},DC=function(t){return Un(t)&&t.trim().length===0},Io=function(t){return t===null},yr=function(t){return Me(t)||Io(t)},ur=function(t){return Jv.call(t)=="[object Number]"},Pu=function(t){return Jv.call(t)==="[object Boolean]"},S4=function(t){return t instanceof FormData},V=typeof window<"u"?window:void 0,ki=typeof globalThis<"u"?globalThis:V,RN=Array.prototype,LC=RN.forEach,jC=RN.indexOf,mo=ki==null?void 0:ki.navigator,Ee=ki==null?void 0:ki.document,vi=ki==null?void 0:ki.location,ub=ki==null?void 0:ki.fetch,cb=ki!=null&&ki.XMLHttpRequest&&"withCredentials"in new ki.XMLHttpRequest?ki.XMLHttpRequest:void 0,FC=ki==null?void 0:ki.AbortController,Ht=mo==null?void 0:mo.userAgent,Vt=V??{},BC="[PostHog.js]",re={_log:function(t){if(V&&(Vr.DEBUG||Vt.POSTHOG_DEBUG)&&!Me(V.console)&&V.console){for(var e=("__rrweb_original__"in V.console[t])?V.console[t].__rrweb_original__:V.console[t],n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.apply(void 0,[BC].concat(i))}},info:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];re._log.apply(re,["log"].concat(e))},warn:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];re._log.apply(re,["warn"].concat(e))},error:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];re._log.apply(re,["error"].concat(e))},critical:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];(t=console).error.apply(t,[BC].concat(n))},uninitializedWarning:function(t){re.error("You must initialize PostHog before calling ".concat(t))}},gg={},Zv=function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function Xu(t,e,n){if(on(t)){if(LC&&t.forEach===LC)t.forEach(e,n);else if("length"in t&&t.length===+t.length){for(var i=0,r=t.length;i<r;i++)if(i in t&&e.call(n,t[i],i)===gg)return}}}function wt(t,e,n){if(!yr(t)){if(on(t))return Xu(t,e,n);if(S4(t)){var i,r=Ar(t.entries());try{for(r.s();!(i=r.n()).done;){var s=i.value;if(e.call(n,s[1],s[0])===gg)return}}catch(a){r.e(a)}finally{r.f()}}else for(var o in t)if(TN.call(t,o)&&e.call(n,t[o],o)===gg)return}}var Qn=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Xu(n,function(r){for(var s in r)r[s]!==void 0&&(t[s]=r[s])}),t};function Ye(t,e){return t.indexOf(e)!==-1}function Dm(t){for(var e=Object.keys(t),n=e.length,i=new Array(n);n--;)i[n]=[e[n],t[e[n]]];return i}var NN=function(){return Date.now=Date.now||function(){return+new Date},Date.now()},$C=function(t){try{return t()}catch{return}},k4=function(t){return function(){try{for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,n)}catch(r){re.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),re.critical(r)}}},db=function(t){var e={};return wt(t,function(n,i){Un(n)&&n.length>0&&(e[i]=n)}),e},hb=function(t){return t.replace(/^\$/,"")};function _4(t,e){return n=t,i=function(s){return Un(s)&&!Io(e)?s.slice(0,e):s},r=new Set,function s(o,a){return o!==Object(o)?i?i(o,a):o:r.has(o)?void 0:(r.add(o),on(o)?(l=[],Xu(o,function(u){l.push(s(u))})):(l={},wt(o,function(u,c){r.has(u)||(l[c]=s(u,c))})),l);var l}(n);var n,i,r}var Hr,C4=function(t){var e,n,i,r,s="";for(e=n=0,i=(t=(t+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,r=0;r<i;r++){var o=t.charCodeAt(r),a=null;o<128?n++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),Io(a)||(n>e&&(s+=t.substring(e,n)),s+=a,e=n=r+1)}return n>e&&(s+=t.substring(e,t.length)),s},po=function(){function t(e){return e&&(e.preventDefault=t.preventDefault,e.stopPropagation=t.stopPropagation),e}return t.preventDefault=function(){this.returnValue=!1},t.stopPropagation=function(){this.cancelBubble=!0},function(e,n,i,r,s){if(e)if(e.addEventListener&&!r)e.addEventListener(n,i,!!s);else{var o="on"+n,a=e[o];e[o]=function(l,u,c){return function(d){if(d=d||t(V==null?void 0:V.event)){var h,f=!0;Yr(c)&&(h=c(d));var p=u.call(l,d);return h!==!1&&p!==!1||(f=!1),f}}}(e,i,a)}else re.error("No valid element provided to register_event")}}();function MN(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return t[n]}(function(t){t.GZipJS="gzip-js",t.Base64="base64"})(Hr||(Hr={}));var ON="$people_distinct_id",Dd="__alias",Ld="__timers",zC="$autocapture_disabled_server_side",fb="$heatmaps_enabled_server_side",UC="$exception_capture_enabled_server_side",VC="$exception_capture_endpoint",HC="$web_vitals_enabled_server_side",pb="$session_recording_enabled_server_side",WC="$console_log_recording_enabled_server_side",GC="$session_recording_network_payload_capture",KC="$session_recording_canvas_recording",XC="$replay_sample_rate",qC="$replay_minimum_duration",vg="$sesid",th="$session_is_sampled",Tu="$enabled_feature_flags",mb="$early_access_features",Ru="$stored_person_properties",Ko="$stored_group_properties",gb="$surveys",vp="$surveys_activated",yg="$flag_call_reported",qs="$user_state",vb="$client_session_props",yb="$capture_rate_limit",wb="$initial_campaign_params",bb="$initial_referrer_info",YC="$initial_person_info",wg="$epp",xb="__POSTHOG_TOOLBAR__",E4=[ON,Dd,"__cmpns",Ld,pb,fb,vg,Tu,qs,mb,Ko,Ru,gb,yg,vb,yb,wb,bb,wg],h0="$active_feature_flags",yp="$override_feature_flags",JC="$feature_flag_payloads",ZC=function(t){var e,n={},i=Ar(Dm(t||{}));try{for(i.s();!(e=i.n()).done;){var r=Zn(e.value,2),s=r[0],o=r[1];o&&(n[s]=o)}}catch(a){i.e(a)}finally{i.f()}return n},A4=function(){function t(e){at(this,t),this.instance=e,this._override_warning=!1,this.featureFlagEventHandlers=[],this.reloadFeatureFlagsQueued=!1,this.reloadFeatureFlagsInAction=!1}return lt(t,[{key:"getFlags",value:function(){return Object.keys(this.getFlagVariants())}},{key:"getFlagVariants",value:function(){var e=this.instance.get_property(Tu),n=this.instance.get_property(yp);if(!n)return e||{};for(var i=Qn({},e),r=Object.keys(n),s=0;s<r.length;s++)i[r[s]]=n[r[s]];return this._override_warning||(re.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:n,finalFlags:i}),this._override_warning=!0),i}},{key:"getFlagPayloads",value:function(){return this.instance.get_property(JC)||{}}},{key:"reloadFeatureFlags",value:function(){this.reloadFeatureFlagsQueued||(this.reloadFeatureFlagsQueued=!0,this._startReloadTimer())}},{key:"setAnonymousDistinctId",value:function(e){this.$anon_distinct_id=e}},{key:"setReloadingPaused",value:function(e){this.reloadFeatureFlagsInAction=e}},{key:"resetRequestQueue",value:function(){this.reloadFeatureFlagsQueued=!1}},{key:"_startReloadTimer",value:function(){var e=this;this.reloadFeatureFlagsQueued&&!this.reloadFeatureFlagsInAction&&setTimeout(function(){!e.reloadFeatureFlagsInAction&&e.reloadFeatureFlagsQueued&&(e.reloadFeatureFlagsQueued=!1,e._reloadFeatureFlagsRequest())},5)}},{key:"_reloadFeatureFlagsRequest",value:function(){var e=this;if(!this.instance.config.advanced_disable_feature_flags){this.setReloadingPaused(!0);var n=this.instance.config.token,i=this.instance.get_property(Ru),r=this.instance.get_property(Ko),s={token:n,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:i,group_properties:r,disable_flags:this.instance.config.advanced_disable_feature_flags||void 0};this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:s,compression:this.instance.config.disable_compression?void 0:Hr.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:function(o){var a;e.setReloadingPaused(!1);var l=!0;o.statusCode===200&&(e.$anon_distinct_id=void 0,l=!1),e.receivedFeatureFlags((a=o.json)!==null&&a!==void 0?a:{},l),e._startReloadTimer()}})}}},{key:"getFeatureFlag",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.instance.decideEndpointWasHit||this.getFlags()&&this.getFlags().length>0){var i,r=this.getFlagVariants()[e],s="".concat(r),o=this.instance.get_property(yg)||{};return(n.send_event||!("send_event"in n))&&(!(e in o)||!o[e].includes(s))&&(on(o[e])?o[e].push(s):o[e]=[s],(i=this.instance.persistence)===null||i===void 0||i.register(X({},yg,o)),this.instance.capture("$feature_flag_called",{$feature_flag:e,$feature_flag_response:r})),r}re.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}},{key:"getFeatureFlagPayload",value:function(e){return this.getFlagPayloads()[e]}},{key:"isFeatureEnabled",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.instance.decideEndpointWasHit||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(e,n);re.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}},{key:"addFeatureFlagsHandler",value:function(e){this.featureFlagEventHandlers.push(e)}},{key:"removeFeatureFlagsHandler",value:function(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(function(n){return n!==e})}},{key:"receivedFeatureFlags",value:function(e,n){if(this.instance.persistence){this.instance.decideEndpointWasHit=!0;var i=this.getFlagVariants(),r=this.getFlagPayloads();(function(s,o){var a,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},c=s.featureFlags,d=s.featureFlagPayloads;if(c)if(on(c)){var h,f={};if(c)for(var p=0;p<c.length;p++)f[c[p]]=!0;o&&o.register((X(h={},h0,c),X(h,Tu,f),h))}else{var m=c,w=d;s.errorsWhileComputingFlags&&(m=ke(ke({},l),m),w=ke(ke({},u),w)),o&&o.register((X(a={},h0,Object.keys(ZC(m))),X(a,Tu,m||{}),X(a,JC,w||{}),a))}})(e,this.instance.persistence,i,r),this._fireFeatureFlagsCallbacks(n)}}},{key:"override",value:function(e){if(!this.instance.__loaded||!this.instance.persistence)return re.uninitializedWarning("posthog.feature_flags.override");if(this._override_warning=!1,e===!1)this.instance.persistence.unregister(yp);else if(on(e)){for(var n={},i=0;i<e.length;i++)n[e[i]]=!0;this.instance.persistence.register(X({},yp,n))}else this.instance.persistence.register(X({},yp,e))}},{key:"onFeatureFlags",value:function(e){var n=this;if(this.addFeatureFlagsHandler(e),this.instance.decideEndpointWasHit){var i=this._prepareFeatureFlagsForCallbacks(),r=i.flags,s=i.flagVariants;e(r,s)}return function(){return n.removeFeatureFlagsHandler(e)}}},{key:"updateEarlyAccessFeatureEnrollment",value:function(e,n){var i,r,s=X({},"$feature_enrollment/".concat(e),n);this.instance.capture("$feature_enrollment_update",{$feature_flag:e,$feature_enrollment:n,$set:s}),this.setPersonPropertiesForFlags(s,!1);var o=ke(ke({},this.getFlagVariants()),{},X({},e,n));(i=this.instance.persistence)===null||i===void 0||i.register((X(r={},h0,Object.keys(ZC(o))),X(r,Tu,o),r)),this._fireFeatureFlagsCallbacks()}},{key:"getEarlyAccessFeatures",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=this.instance.get_property(mb);if(r&&!i)return e(r);this.instance._send_request({transport:"XHR",url:this.instance.requestRouter.endpointFor("api","/api/early_access_features/?token=".concat(this.instance.config.token)),method:"GET",callback:function(s){var o;if(s.json){var a=s.json.earlyAccessFeatures;return(o=n.instance.persistence)===null||o===void 0||o.register(X({},mb,a)),e(a)}}})}},{key:"_prepareFeatureFlagsForCallbacks",value:function(){var e=this.getFlags(),n=this.getFlagVariants();return{flags:e.filter(function(i){return n[i]}),flagVariants:Object.keys(n).filter(function(i){return n[i]}).reduce(function(i,r){return i[r]=n[r],i},{})}}},{key:"_fireFeatureFlagsCallbacks",value:function(e){var n=this._prepareFeatureFlagsForCallbacks(),i=n.flags,r=n.flagVariants;this.featureFlagEventHandlers.forEach(function(s){return s(i,r,{errorsLoading:e})})}},{key:"setPersonPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],i=this.instance.get_property(Ru)||{};this.instance.register(X({},Ru,ke(ke({},i),e))),n&&this.instance.reloadFeatureFlags()}},{key:"resetPersonPropertiesForFlags",value:function(){this.instance.unregister(Ru)}},{key:"setGroupPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],i=this.instance.get_property(Ko)||{};Object.keys(i).length!==0&&Object.keys(i).forEach(function(r){i[r]=ke(ke({},i[r]),e[r]),delete e[r]}),this.instance.register(X({},Ko,ke(ke({},i),e))),n&&this.instance.reloadFeatureFlags()}},{key:"resetGroupPropertiesForFlags",value:function(e){if(e){var n=this.instance.get_property(Ko)||{};this.instance.register(X({},Ko,ke(ke({},n),{},X({},e,{}))))}else this.instance.unregister(Ko)}}]),t}();Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Number.isInteger||(Number.isInteger=function(t){return ur(t)&&isFinite(t)&&Math.floor(t)===t});var QC="0123456789abcdef",P4=function(){function t(e){if(at(this,t),this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}return lt(t,[{key:"toString",value:function(){for(var e="",n=0;n<this.bytes.length;n++)e=e+QC.charAt(this.bytes[n]>>>4)+QC.charAt(15&this.bytes[n]),n!==3&&n!==5&&n!==7&&n!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}},{key:"clone",value:function(){return new t(this.bytes.slice(0))}},{key:"equals",value:function(e){return this.compareTo(e)===0}},{key:"compareTo",value:function(e){for(var n=0;n<16;n++){var i=this.bytes[n]-e.bytes[n];if(i!==0)return Math.sign(i)}return 0}}],[{key:"fromFieldsV7",value:function(e,n,i,r){if(!Number.isInteger(e)||!Number.isInteger(n)||!Number.isInteger(i)||!Number.isInteger(r)||e<0||n<0||i<0||r<0||e>0xffffffffffff||n>4095||i>1073741823||r>4294967295)throw new RangeError("invalid field value");var s=new Uint8Array(16);return s[0]=e/Math.pow(2,40),s[1]=e/Math.pow(2,32),s[2]=e/Math.pow(2,24),s[3]=e/Math.pow(2,16),s[4]=e/Math.pow(2,8),s[5]=e,s[6]=112|n>>>8,s[7]=n,s[8]=128|i>>>24,s[9]=i>>>16,s[10]=i>>>8,s[11]=i,s[12]=r>>>24,s[13]=r>>>16,s[14]=r>>>8,s[15]=r,new t(s)}}]),t}(),T4=function(){function t(){at(this,t),X(this,"timestamp",0),X(this,"counter",0),X(this,"random",new R4)}return lt(t,[{key:"generate",value:function(){var e=this.generateOrAbort();if(Me(e)){this.timestamp=0;var n=this.generateOrAbort();if(Me(n))throw new Error("Could not generate UUID after timestamp reset");return n}return e}},{key:"generateOrAbort",value:function(){var e=Date.now();if(e>this.timestamp)this.timestamp=e,this.resetCounter();else{if(!(e+1e4>this.timestamp))return;this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter())}return P4.fromFieldsV7(this.timestamp,Math.trunc(this.counter/Math.pow(2,30)),this.counter&Math.pow(2,30)-1,this.random.nextUint32())}},{key:"resetCounter",value:function(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}}]),t}(),IN=function(t){if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<t.length;e++)t[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return t};V&&!Me(V.crypto)&&crypto.getRandomValues&&(IN=function(t){return crypto.getRandomValues(t)});var eE,R4=function(){function t(){at(this,t),X(this,"buffer",new Uint32Array(8)),X(this,"cursor",1/0)}return lt(t,[{key:"nextUint32",value:function(){return this.cursor>=this.buffer.length&&(IN(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}]),t}(),ca=function(){return N4().toString()},N4=function(){return(eE||(eE=new T4)).generate()},M4="Thu, 01 Jan 1970 00:00:00 GMT",cd="",O4=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function I4(t,e){if(e){var n=function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ee;if(cd)return cd;if(!s||["localhost","127.0.0.1"].includes(r))return"";for(var o=r.split("."),a=Math.min(o.length,8),l="dmn_chk_"+ca(),u=new RegExp("(^|;)\\s*"+l+"=1");!cd&&a--;){var c=o.slice(a).join("."),d=l+"=1;domain=."+c;s.cookie=d,u.test(s.cookie)&&(s.cookie=d+";expires="+M4,cd=c)}return cd}(t);if(!n){var i=function(r){var s=r.match(O4);return s?s[0]:""}(t);i!==n&&re.info("Warning: cookie subdomain discovery mismatch",i,n),n=i}return n?"; domain=."+n:""}return""}var vn,wo={is_supported:function(){return!!Ee},error:function(t){re.error("cookieStore error: "+t)},get:function(t){if(Ee){try{for(var e=t+"=",n=Ee.cookie.split(";").filter(function(s){return s.length}),i=0;i<n.length;i++){for(var r=n[i];r.charAt(0)==" ";)r=r.substring(1,r.length);if(r.indexOf(e)===0)return decodeURIComponent(r.substring(e.length,r.length))}}catch{}return null}},parse:function(t){var e;try{e=JSON.parse(wo.get(t))||{}}catch{}return e},set:function(t,e,n,i,r){if(Ee)try{var s="",o="",a=I4(Ee.location.hostname,i);if(n){var l=new Date;l.setTime(l.getTime()+24*n*60*60*1e3),s="; expires="+l.toUTCString()}r&&(o="; secure");var u=t+"="+encodeURIComponent(JSON.stringify(e))+s+"; SameSite=Lax; path=/"+a+o;return u.length>3686.4&&re.warn("cookieStore warning: large cookie, len="+u.length),Ee.cookie=u,u}catch{return}},remove:function(t,e){try{wo.set(t,"",-1,e)}catch{return}}},f0=null,tn={is_supported:function(){if(!Io(f0))return f0;var t=!0;if(Me(V))t=!1;else try{var e="__mplssupport__";tn.set(e,"xyz"),tn.get(e)!=='"xyz"'&&(t=!1),tn.remove(e)}catch{t=!1}return t||re.error("localStorage unsupported; falling back to cookie store"),f0=t,t},error:function(t){re.error("localStorage error: "+t)},get:function(t){try{return V==null?void 0:V.localStorage.getItem(t)}catch(e){tn.error(e)}return null},parse:function(t){try{return JSON.parse(tn.get(t))||{}}catch{}return null},set:function(t,e){try{V==null||V.localStorage.setItem(t,JSON.stringify(e))}catch(n){tn.error(n)}},remove:function(t){try{V==null||V.localStorage.removeItem(t)}catch(e){tn.error(e)}}},D4=["distinct_id",vg,th,wg],wp=ke(ke({},tn),{},{parse:function(t){try{var e={};try{e=wo.parse(t)||{}}catch{}var n=Qn(e,JSON.parse(tn.get(t)||"{}"));return tn.set(t,n),n}catch{}return null},set:function(t,e,n,i,r){try{tn.set(t,e);var s={};D4.forEach(function(o){e[o]&&(s[o]=e[o])}),Object.keys(s).length&&wo.set(t,s,n,i,r)}catch(o){tn.error(o)}},remove:function(t,e){try{V==null||V.localStorage.removeItem(t),wo.remove(t,e)}catch(n){tn.error(n)}}}),bp={},L4={is_supported:function(){return!0},error:function(t){re.error("memoryStorage error: "+t)},get:function(t){return bp[t]||null},parse:function(t){return bp[t]||null},set:function(t,e){bp[t]=e},remove:function(t){delete bp[t]}},hl=null,bn={is_supported:function(){if(!Io(hl))return hl;if(hl=!0,Me(V))hl=!1;else try{var t="__support__";bn.set(t,"xyz"),bn.get(t)!=='"xyz"'&&(hl=!1),bn.remove(t)}catch{hl=!1}return hl},error:function(t){re.error("sessionStorage error: ",t)},get:function(t){try{return V==null?void 0:V.sessionStorage.getItem(t)}catch(e){bn.error(e)}return null},parse:function(t){try{return JSON.parse(bn.get(t))||null}catch{}return null},set:function(t,e){try{V==null||V.sessionStorage.setItem(t,JSON.stringify(e))}catch(n){bn.error(n)}},remove:function(t){try{V==null||V.sessionStorage.removeItem(t)}catch(e){bn.error(e)}}},j4=["localhost","127.0.0.1"],nh=function(t){var e=Ee==null?void 0:Ee.createElement("a");return Me(e)?null:(e.href=t,e)},bg=function(t,e){return!!function(n){try{new RegExp(n)}catch{return!1}return!0}(e)&&new RegExp(e).test(t)},F4=function(t){var e,n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"&",r=[];return wt(t,function(s,o){Me(s)||Me(o)||o==="undefined"||(e=encodeURIComponent(function(a){return a instanceof File}(s)?s.name:s.toString()),n=encodeURIComponent(o),r[r.length]=n+"="+e)}),r.join(i)},tE=function(t,e){for(var n,i=((t.split("#")[0]||"").split("?")[1]||"").split("&"),r=0;r<i.length;r++){var s=i[r].split("=");if(s[0]===e){n=s;break}}if(!on(n)||n.length<2)return"";var o=n[1];try{o=decodeURIComponent(o)}catch{re.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},xg=function(t,e){var n=t.match(new RegExp(e+"=([^&]*)"));return n?n[1]:null},wr="Mobile",Sg="iOS",Rs="Android",Ph="Tablet",DN=Rs+" "+Ph,LN="iPad",jN="Apple",FN=jN+" Watch",Th="Safari",Sc="BlackBerry",BN="Samsung",$N=BN+"Browser",zN=BN+" Internet",Sa="Chrome",B4=Sa+" OS",UN=Sa+" "+Sg,mS="Internet Explorer",VN=mS+" "+wr,gS="Opera",$4=gS+" Mini",vS="Edge",HN="Microsoft "+vS,qu="Firefox",WN=qu+" "+Sg,Rh="Nintendo",Nh="PlayStation",Yu="Xbox",GN=Rs+" "+wr,KN=wr+" "+Th,jd="Windows",Sb=jd+" Phone",nE="Nokia",kb="Ouya",XN="Generic",z4=XN+" "+wr.toLowerCase(),qN=XN+" "+Ph.toLowerCase(),_b="Konqueror",Kn="(\\d+(\\.\\d+)?)",p0=new RegExp("Version/"+Kn),U4=new RegExp(Yu,"i"),V4=new RegExp(Nh+" \\w+","i"),H4=new RegExp(Rh+" \\w+","i"),yS=new RegExp(Sc+"|PlayBook|BB10","i"),W4={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},G4=function(t,e){return e&&Ye(e,jN)||function(n){return Ye(n,Th)&&!Ye(n,Sa)&&!Ye(n,Rs)}(t)},iE=function(t,e){return e=e||"",Ye(t," OPR/")&&Ye(t,"Mini")?$4:Ye(t," OPR/")?gS:yS.test(t)?Sc:Ye(t,"IE"+wr)||Ye(t,"WPDesktop")?VN:Ye(t,$N)?zN:Ye(t,vS)||Ye(t,"Edg/")?HN:Ye(t,"FBIOS")?"Facebook "+wr:Ye(t,"UCWEB")||Ye(t,"UCBrowser")?"UC Browser":Ye(t,"CriOS")?UN:Ye(t,"CrMo")?Sa:Ye(t,Rs)&&Ye(t,Th)?GN:Ye(t,Sa)?Sa:Ye(t,"FxiOS")?WN:Ye(t.toLowerCase(),_b.toLowerCase())?_b:G4(t,e)?Ye(t,wr)?KN:Th:Ye(t,qu)?qu:Ye(t,"MSIE")||Ye(t,"Trident/")?mS:Ye(t,"Gecko")?qu:""},K4=(X(vn={},VN,[new RegExp("rv:"+Kn)]),X(vn,HN,[new RegExp(vS+"?\\/"+Kn)]),X(vn,Sa,[new RegExp("("+Sa+"|CrMo)\\/"+Kn)]),X(vn,UN,[new RegExp("CriOS\\/"+Kn)]),X(vn,"UC Browser",[new RegExp("(UCBrowser|UCWEB)\\/"+Kn)]),X(vn,Th,[p0]),X(vn,KN,[p0]),X(vn,gS,[new RegExp("(Opera|OPR)\\/"+Kn)]),X(vn,qu,[new RegExp(qu+"\\/"+Kn)]),X(vn,WN,[new RegExp("FxiOS\\/"+Kn)]),X(vn,_b,[new RegExp("Konqueror[:/]?"+Kn,"i")]),X(vn,Sc,[new RegExp(Sc+" "+Kn),p0]),X(vn,GN,[new RegExp("android\\s"+Kn,"i")]),X(vn,zN,[new RegExp($N+"\\/"+Kn)]),X(vn,mS,[new RegExp("(rv:|MSIE )"+Kn)]),X(vn,"Mozilla",[new RegExp("rv:"+Kn)]),vn),rE=[[new RegExp(Yu+"; "+Yu+" (.*?)[);]","i"),function(t){return[Yu,t&&t[1]||""]}],[new RegExp(Rh,"i"),[Rh,""]],[new RegExp(Nh,"i"),[Nh,""]],[yS,[Sc,""]],[new RegExp(jd,"i"),function(t,e){if(/Phone/.test(e)||/WPDesktop/.test(e))return[Sb,""];if(new RegExp(wr).test(e)&&!/IEMobile\b/.test(e))return[jd+" "+wr,""];var n=/Windows NT ([0-9.]+)/i.exec(e);if(n&&n[1]){var i=n[1],r=W4[i]||"";return/arm/i.test(e)&&(r="RT"),[jd,r]}return[jd,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,function(t){if(t&&t[3]){var e=[t[3],t[4],t[5]||"0"];return[Sg,e.join(".")]}return[Sg,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,function(t){var e="";return t&&t.length>=3&&(e=Me(t[2])?t[3]:t[2]),["watchOS",e]}],[new RegExp("("+Rs+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Rs+")","i"),function(t){if(t&&t[2]){var e=[t[2],t[3],t[4]||"0"];return[Rs,e.join(".")]}return[Rs,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,function(t){var e=["Mac OS X",""];if(t&&t[1]){var n=[t[1],t[2],t[3]||"0"];e[1]=n.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[B4,""]],[/Linux|debian/i,["Linux",""]]],sE=function(t){return H4.test(t)?Rh:V4.test(t)?Nh:U4.test(t)?Yu:new RegExp(kb,"i").test(t)?kb:new RegExp("("+Sb+"|WPDesktop)","i").test(t)?Sb:/iPad/.test(t)?LN:/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(t)?FN:yS.test(t)?Sc:/(kobo)\s(ereader|touch)/i.test(t)?"Kobo":new RegExp(nE,"i").test(t)?nE:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(t)||/(kf[a-z]+)( bui|\)).+silk\//i.test(t)?"Kindle Fire":/(Android|ZTE)/i.test(t)?!new RegExp(wr).test(t)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(t)?/pixel[\daxl ]{1,6}/i.test(t)&&!/pixel c/i.test(t)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(t)||/lmy47v/i.test(t)&&!/QTAQZ3/i.test(t)?Rs:DN:Rs:new RegExp("(pda|"+wr+")","i").test(t)?z4:new RegExp(Ph,"i").test(t)&&!new RegExp(Ph+" pc","i").test(t)?qN:""},xp="https?://(.*)",X4=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gclid","gad_source","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","mc_cid","igshid","ttclid","rdt_cid"],dn={campaignParams:function(t){return Ee?this._campaignParamsFromUrl(Ee.URL,t):{}},_campaignParamsFromUrl:function(t,e){var n=X4.concat(e||[]),i={};return wt(n,function(r){var s=tE(t,r);s&&(i[r]=s)}),i},_searchEngine:function(t){return t?t.search(xp+"google.([^/?]*)")===0?"google":t.search(xp+"bing.com")===0?"bing":t.search(xp+"yahoo.com")===0?"yahoo":t.search(xp+"duckduckgo.com")===0?"duckduckgo":null:null},_searchInfoFromReferrer:function(t){var e=dn._searchEngine(t),n=e!="yahoo"?"q":"p",i={};if(!Io(e)){i.$search_engine=e;var r=Ee?tE(Ee.referrer,n):"";r.length&&(i.ph_keyword=r)}return i},searchInfo:function(){var t=Ee==null?void 0:Ee.referrer;return t?this._searchInfoFromReferrer(t):{}},browser:iE,browserVersion:function(t,e){var n=iE(t,e),i=K4[n];if(Me(i))return null;for(var r=0;r<i.length;r++){var s=i[r],o=t.match(s);if(o)return parseFloat(o[o.length-2])}return null},browserLanguage:function(){return navigator.language||navigator.userLanguage},os:function(t){for(var e=0;e<rE.length;e++){var n=Zn(rE[e],2),i=n[0],r=n[1],s=i.exec(t),o=s&&(Yr(r)?r(s,t):r);if(o)return o}return["",""]},device:sE,deviceType:function(t){var e=sE(t);return e===LN||e===DN||e==="Kobo"||e==="Kindle Fire"||e===qN?Ph:e===Rh||e===Yu||e===Nh||e===kb?"Console":e===FN?"Wearable":e?wr:"Desktop"},referrer:function(){return(Ee==null?void 0:Ee.referrer)||"$direct"},referringDomain:function(){var t;return Ee!=null&&Ee.referrer&&((t=nh(Ee.referrer))===null||t===void 0?void 0:t.host)||"$direct"},referrerInfo:function(){return{$referrer:this.referrer(),$referring_domain:this.referringDomain()}},initialPersonInfo:function(){return{r:this.referrer(),u:vi==null?void 0:vi.href}},initialPersonPropsFromInfo:function(t){var e,n=t.r,i=t.u,r={$initial_referrer:n,$initial_referring_domain:n==null?void 0:n=="$direct"?"$direct":(e=nh(n))===null||e===void 0?void 0:e.host};if(i){r.$initial_current_url=i;var s=nh(i);r.$initial_host=s==null?void 0:s.host,r.$initial_pathname=s==null?void 0:s.pathname,wt(this._campaignParamsFromUrl(i),function(o,a){r["$initial_"+hb(a)]=o})}return n&&wt(this._searchInfoFromReferrer(n),function(o,a){r["$initial_"+hb(a)]=o}),r},properties:function(){if(!Ht)return{};var t=Zn(dn.os(Ht),2),e=t[0],n=t[1];return Qn(db({$os:e,$os_version:n,$browser:dn.browser(Ht,navigator.vendor),$device:dn.device(Ht),$device_type:dn.deviceType(Ht)}),{$current_url:vi==null?void 0:vi.href,$host:vi==null?void 0:vi.host,$pathname:vi==null?void 0:vi.pathname,$raw_user_agent:Ht.length>1e3?Ht.substring(0,997)+"...":Ht,$browser_version:dn.browserVersion(Ht,navigator.vendor),$browser_language:dn.browserLanguage(),$screen_height:V==null?void 0:V.screen.height,$screen_width:V==null?void 0:V.screen.width,$viewport_height:V==null?void 0:V.innerHeight,$viewport_width:V==null?void 0:V.innerWidth,$lib:"web",$lib_version:Vr.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:NN()/1e3})},people_properties:function(){if(!Ht)return{};var t=Zn(dn.os(Ht),2),e=t[0],n=t[1];return Qn(db({$os:e,$os_version:n,$browser:dn.browser(Ht,navigator.vendor)}),{$browser_version:dn.browserVersion(Ht,navigator.vendor)})}},q4=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"],m0=function(){function t(e){at(this,t),this.config=e,this.props={},this.campaign_params_saved=!1,this.name=function(n){var i="";return n.token&&(i=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+i+"_posthog"}(e),this.storage=this.buildStorage(e),this.load(),this.update_config(e,e),this.save()}return lt(t,[{key:"buildStorage",value:function(e){q4.indexOf(e.persistence.toLowerCase())===-1&&(re.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var n=e.persistence.toLowerCase();return n==="localstorage"&&tn.is_supported()?tn:n==="localstorage+cookie"&&wp.is_supported()?wp:n==="sessionstorage"&&bn.is_supported()?bn:n==="memory"?L4:n==="cookie"?wo:wp.is_supported()?wp:wo}},{key:"properties",value:function(){var e={};return wt(this.props,function(n,i){if(i===Tu&&En(n))for(var r=Object.keys(n),s=0;s<r.length;s++)e["$feature/".concat(r[s])]=n[r[s]];else a=i,l=!1,(Io(o=E4)?l:jC&&o.indexOf===jC?o.indexOf(a)!=-1:(wt(o,function(u){if(l||(l=u===a))return gg}),l))||(e[i]=n);var o,a,l}),e}},{key:"load",value:function(){if(!this.disabled){var e=this.storage.parse(this.name);e&&(this.props=Qn({},e))}}},{key:"save",value:function(){this.disabled||this.storage.set(this.name,this.props,this.expire_days,this.cross_subdomain,this.secure)}},{key:"remove",value:function(){this.storage.remove(this.name,!1),this.storage.remove(this.name,!0)}},{key:"clear",value:function(){this.remove(),this.props={}}},{key:"register_once",value:function(e,n,i){var r=this;if(En(e)){Me(n)&&(n="None"),this.expire_days=Me(i)?this.default_expiry:i;var s=!1;if(wt(e,function(o,a){r.props.hasOwnProperty(a)&&r.props[a]!==n||(r.props[a]=o,s=!0)}),s)return this.save(),!0}return!1}},{key:"register",value:function(e,n){var i=this;if(En(e)){this.expire_days=Me(n)?this.default_expiry:n;var r=!1;if(wt(e,function(s,o){e.hasOwnProperty(o)&&i.props[o]!==s&&(i.props[o]=s,r=!0)}),r)return this.save(),!0}return!1}},{key:"unregister",value:function(e){e in this.props&&(delete this.props[e],this.save())}},{key:"update_campaign_params",value:function(){this.campaign_params_saved||(this.register(dn.campaignParams(this.config.custom_campaign_params)),this.campaign_params_saved=!0)}},{key:"update_search_keyword",value:function(){this.register(dn.searchInfo())}},{key:"update_referrer_info",value:function(){this.register_once(dn.referrerInfo(),void 0)}},{key:"set_initial_person_info",value:function(){this.props[wb]||this.props[bb]||this.register_once(X({},YC,dn.initialPersonInfo()),void 0)}},{key:"get_referrer_info",value:function(){return db({$referrer:this.props.$referrer,$referring_domain:this.props.$referring_domain})}},{key:"get_initial_props",value:function(){var e=this,n={};wt([bb,wb],function(s){var o=e.props[s];o&&wt(o,function(a,l){n["$initial_"+hb(l)]=a})});var i=this.props[YC];if(i){var r=dn.initialPersonPropsFromInfo(i);Qn(n,r)}return n}},{key:"safe_merge",value:function(e){return wt(this.props,function(n,i){i in e||(e[i]=n)}),e}},{key:"update_config",value:function(e,n){if(this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==n.persistence){var i=this.buildStorage(e),r=this.props;this.clear(),this.storage=i,this.props=r,this.save()}}},{key:"set_disabled",value:function(e){this.disabled=e,this.disabled?this.remove():this.save()}},{key:"set_cross_subdomain",value:function(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())}},{key:"get_cross_subdomain",value:function(){return!!this.cross_subdomain}},{key:"set_secure",value:function(e){e!==this.secure&&(this.secure=e,this.remove(),this.save())}},{key:"set_event_timer",value:function(e,n){var i=this.props[Ld]||{};i[e]=n,this.props[Ld]=i,this.save()}},{key:"remove_event_timer",value:function(e){var n=(this.props[Ld]||{})[e];return Me(n)||(delete this.props[Ld][e],this.save()),n}},{key:"get_property",value:function(e){return this.props[e]}},{key:"set_property",value:function(e,n){this.props[e]=n,this.save()}}]),t}();function Cb(t){return JSON.stringify(t,(e=[],function(n,i){if(En(i)){for(;e.length>0&&e.at(-1)!==this;)e.pop();return e.includes(i)?"[Circular]":(e.push(i),i)}return i})).length;var e}var Y4=2,J4=4;function Eb(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:66060288e-1;if(t.size>=e&&t.data.length>1){var n=Math.floor(t.data.length/2),i=t.data.slice(0,n),r=t.data.slice(n);return[Eb({size:Cb(i),data:i,sessionId:t.sessionId,windowId:t.windowId}),Eb({size:Cb(r),data:r,sessionId:t.sessionId,windowId:t.windowId})].flatMap(function(s){return s})}return[t]}var Lm=function(t){return t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t}(Lm||{}),Ks=function(t){return t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t}(Ks||{});function wS(t){return t?Zv(t).split(/\s+/):[]}function oE(t){var e=V==null?void 0:V.location.href;return!!(e&&t&&t.some(function(n){return e.match(n)}))}function kg(t){var e="";switch(Ah(t.className)){case"string":e=t.className;break;case"object":e=("baseVal"in t.className?t.className.baseVal:null)||t.getAttribute("class")||"";break;default:e=""}return wS(e)}function YN(t){return yr(t)?null:Zv(t).split(/(\s+)/).filter(function(e){return Ju(e)}).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function _g(t){var e="";return Pb(t)&&!eM(t)&&t.childNodes&&t.childNodes.length&&wt(t.childNodes,function(n){var i;JN(n)&&n.textContent&&(e+=(i=YN(n.textContent))!==null&&i!==void 0?i:"")}),Zv(e)}function bS(t){return!!t&&t.nodeType===1}function ka(t,e){return!!t&&!!t.tagName&&t.tagName.toLowerCase()===e.toLowerCase()}function JN(t){return!!t&&t.nodeType===3}function ZN(t){return!!t&&t.nodeType===11}var Ab=["a","button","form","input","select","textarea","label"];function QN(t){var e=t.parentNode;return!(!e||!bS(e))&&e}function Z4(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(!V||!t||ka(t,"html")||!bS(t)||n!=null&&n.url_allowlist&&!oE(n.url_allowlist)||n!=null&&n.url_ignorelist&&oE(n.url_ignorelist))return!1;if(n!=null&&n.dom_event_allowlist){var s=n.dom_event_allowlist;if(s&&!s.some(function(f){return e.type===f}))return!1}for(var o=!1,a=[t],l=!0,u=t;u.parentNode&&!ka(u,"body");)if(ZN(u.parentNode))a.push(u.parentNode.host),u=u.parentNode.host;else{if(!(l=QN(u)))break;if(i||Ab.indexOf(l.tagName.toLowerCase())>-1)o=!0;else{var c=V.getComputedStyle(l);c&&c.getPropertyValue("cursor")==="pointer"&&(o=!0)}a.push(l),u=l}if(!function(f,p){var m=p==null?void 0:p.element_allowlist;if(Me(m))return!0;var w,v=Ar(f);try{var y=function(){var k=w.value;if(m.some(function(_){return k.tagName.toLowerCase()===_}))return{v:!0}};for(v.s();!(w=v.n()).done;){var b=y();if(Ah(b)==="object")return b.v}}catch(k){v.e(k)}finally{v.f()}return!1}(a,n)||!function(f,p){var m=p==null?void 0:p.css_selector_allowlist;if(Me(m))return!0;var w,v=Ar(f);try{var y=function(){var k=w.value;if(m.some(function(_){return k.matches(_)}))return{v:!0}};for(v.s();!(w=v.n()).done;){var b=y();if(Ah(b)==="object")return b.v}}catch(k){v.e(k)}finally{v.f()}return!1}(a,n))return!1;var d=V.getComputedStyle(t);if(d&&d.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var h=t.tagName.toLowerCase();switch(h){case"html":return!1;case"form":return(r||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(r||["change","click"]).indexOf(e.type)>=0;default:return o?(r||["click"]).indexOf(e.type)>=0:(r||["click"]).indexOf(e.type)>=0&&(Ab.indexOf(h)>-1||t.getAttribute("contenteditable")==="true")}}function Pb(t){for(var e=t;e.parentNode&&!ka(e,"body");e=e.parentNode){var n=kg(e);if(Ye(n,"ph-sensitive")||Ye(n,"ph-no-capture"))return!1}if(Ye(kg(t),"ph-include"))return!0;var i=t.type||"";if(Un(i))switch(i.toLowerCase()){case"hidden":case"password":return!1}var r=t.name||t.id||"";return!(Un(r)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(r.replace(/[^a-zA-Z0-9]/g,"")))}function eM(t){return!!(ka(t,"input")&&!["button","checkbox","submit","reset"].includes(t.type)||ka(t,"select")||ka(t,"textarea")||t.getAttribute("contenteditable")==="true")}var tM="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",Q4=new RegExp("^(?:".concat(tM,")$")),e5=new RegExp(tM),nM="\\d{3}-?\\d{2}-?\\d{4}",t5=new RegExp("^(".concat(nM,")$")),n5=new RegExp("(".concat(nM,")"));function Ju(t){var e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return!(yr(t)||Un(t)&&(t=Zv(t),(e?Q4:e5).test((t||"").replace(/[- ]/g,""))||(e?t5:n5).test(t)))}function aE(t){var e=_g(t);return Ju(e="".concat(e," ").concat(iM(t)).trim())?e:""}function iM(t){var e="";return t&&t.childNodes&&t.childNodes.length&&wt(t.childNodes,function(n){var i;if(n&&((i=n.tagName)===null||i===void 0?void 0:i.toLowerCase())==="span")try{var r=_g(n);e="".concat(e," ").concat(r).trim(),n.childNodes&&n.childNodes.length&&(e="".concat(e," ").concat(iM(n)).trim())}catch(s){re.error(s)}}),e}function i5(t){return function(e){var n=e.map(function(i){var r,s,o="";if(i.tag_name&&(o+=i.tag_name),i.attr_class){i.attr_class.sort();var a,l=Ar(i.attr_class);try{for(l.s();!(a=l.n()).done;){var u=a.value;o+=".".concat(u.replace(/"/g,""))}}catch(h){l.e(h)}finally{l.f()}}var c=ke(ke(ke(ke({},i.text?{text:i.text}:{}),{},{"nth-child":(r=i.nth_child)!==null&&r!==void 0?r:0,"nth-of-type":(s=i.nth_of_type)!==null&&s!==void 0?s:0},i.href?{href:i.href}:{}),i.attr_id?{attr_id:i.attr_id}:{}),i.attributes),d={};return Dm(c).sort(function(h,f){var p=Zn(h,1)[0],m=Zn(f,1)[0];return p.localeCompare(m)}).forEach(function(h){var f=Zn(h,2),p=f[0],m=f[1];return d[lE(p.toString())]=lE(m.toString())}),o+=":",o+=Dm(c).map(function(h){var f=Zn(h,2),p=f[0],m=f[1];return"".concat(p,'="').concat(m,'"')}).join("")});return n.join(";")}(function(e){return e.map(function(n){var i,r,s={text:(i=n.$el_text)===null||i===void 0?void 0:i.slice(0,400),tag_name:n.tag_name,href:(r=n.attr__href)===null||r===void 0?void 0:r.slice(0,2048),attr_class:r5(n),attr_id:n.attr__id,nth_child:n.nth_child,nth_of_type:n.nth_of_type,attributes:{}};return Dm(n).filter(function(o){return Zn(o,1)[0].indexOf("attr__")===0}).forEach(function(o){var a=Zn(o,2),l=a[0],u=a[1];return s.attributes[l]=u}),s})}(t))}function lE(t){return t.replace(/"|\\"/g,'\\"')}function r5(t){var e=t.attr__class;return e?on(e)?e:wS(e):void 0}var Tb="[SessionRecording]",Rb="redacted",Sp={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:function(t){return t},recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io"]},s5=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],o5=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],a5=["/s/","/e/","/i/"];function uE(t,e,n,i){if(yr(t))return t;var r=(e==null?void 0:e["content-length"])||function(s){return new Blob([s]).size}(t);return Un(r)&&(r=parseInt(r)),r>n?Tb+" ".concat(i," body too large to record (").concat(r," bytes)"):t}function cE(t,e){if(yr(t))return t;var n=t;return Ju(n,!1)||(n=Tb+" "+e+" body "+Rb),wt(o5,function(i){var r,s;(r=n)!==null&&r!==void 0&&r.length&&((s=n)===null||s===void 0?void 0:s.indexOf(i))!==-1&&(n=Tb+" "+e+" body "+Rb+" as might contain: "+i)}),n}var Ys,l5=function(t,e){var n,i,r,s={payloadSizeLimitBytes:Sp.payloadSizeLimitBytes,performanceEntryTypeToObserve:yo(Sp.performanceEntryTypeToObserve),payloadHostDenyList:[].concat(yo(e.payloadHostDenyList||[]),yo(Sp.payloadHostDenyList))},o=t.session_recording.recordHeaders!==!1&&e.recordHeaders,a=t.session_recording.recordBody!==!1&&e.recordBody,l=t.capture_performance!==!1&&e.recordPerformance,u=(n=s,r=Math.min(1e6,(i=n.payloadSizeLimitBytes)!==null&&i!==void 0?i:1e6),function(h){return h!=null&&h.requestBody&&(h.requestBody=uE(h.requestBody,h.requestHeaders,r,"Request")),h!=null&&h.responseBody&&(h.responseBody=uE(h.responseBody,h.responseHeaders,r,"Response")),h}),c=function(h){return u(function(m){var w=nh(m.name);if(!(w&&w.pathname&&a5.some(function(v){return w.pathname.indexOf(v)===0})))return m}((p=(f=h).requestHeaders,yr(p)||wt(Object.keys(p??{}),function(m){s5.includes(m.toLowerCase())&&(p[m]=Rb)}),f)));var f,p},d=Yr(t.session_recording.maskNetworkRequestFn);return d&&Yr(t.session_recording.maskCapturedNetworkRequestFn)&&re.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),d&&(t.session_recording.maskCapturedNetworkRequestFn=function(h){var f=t.session_recording.maskNetworkRequestFn({url:h.name});return ke(ke({},h),{},{name:f==null?void 0:f.url})}),s.maskRequestFn=Yr(t.session_recording.maskCapturedNetworkRequestFn)?function(h){var f,p,m,w=c(h);return w&&(f=(p=(m=t.session_recording).maskCapturedNetworkRequestFn)===null||p===void 0?void 0:p.call(m,w))!==null&&f!==void 0?f:void 0}:function(h){return function(f){if(!Me(f))return f.requestBody=cE(f.requestBody,"Request"),f.responseBody=cE(f.responseBody,"Response"),f}(c(h))},ke(ke(ke({},Sp),s),{},{recordHeaders:o,recordBody:a,recordPerformance:l,recordInitialRequests:l})},u5=lt(function t(e){var n,i,r=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};at(this,t),X(this,"bucketSize",100),X(this,"refillRate",10),X(this,"mutationBuckets",{}),X(this,"loggedTracker",{}),X(this,"refillBuckets",function(){Object.keys(r.mutationBuckets).forEach(function(o){r.mutationBuckets[o]=r.mutationBuckets[o]+r.refillRate,r.mutationBuckets[o]>=r.bucketSize&&delete r.mutationBuckets[o]})}),X(this,"getNodeOrRelevantParent",function(o){var a=r.rrweb.mirror.getNode(o);if((a==null?void 0:a.nodeName)!=="svg"&&a instanceof Element){var l=a.closest("svg");if(l)return[r.rrweb.mirror.getId(l),l]}return[o,a]}),X(this,"numberOfChanges",function(o){var a,l,u,c,d,h,f,p;return((a=(l=o.removes)===null||l===void 0?void 0:l.length)!==null&&a!==void 0?a:0)+((u=(c=o.attributes)===null||c===void 0?void 0:c.length)!==null&&u!==void 0?u:0)+((d=(h=o.texts)===null||h===void 0?void 0:h.length)!==null&&d!==void 0?d:0)+((f=(p=o.adds)===null||p===void 0?void 0:p.length)!==null&&f!==void 0?f:0)}),X(this,"throttleMutations",function(o){if(o.type!==3||o.data.source!==0)return o;var a=o.data,l=r.numberOfChanges(a);a.attributes&&(a.attributes=a.attributes.filter(function(c){var d,h,f,p=Zn(r.getNodeOrRelevantParent(c.id),2),m=p[0],w=p[1];return r.mutationBuckets[m]===0?!1:(r.mutationBuckets[m]=(d=r.mutationBuckets[m])!==null&&d!==void 0?d:r.bucketSize,r.mutationBuckets[m]=Math.max(r.mutationBuckets[m]-1,0),r.mutationBuckets[m]===0&&(r.loggedTracker[m]||(r.loggedTracker[m]=!0,(h=(f=r.options).onBlockedNode)===null||h===void 0||h.call(f,m,w))),c)}));var u=r.numberOfChanges(a);return u!==0||l===u?o:void 0}),this.rrweb=e,this.options=s,this.refillRate=(n=this.options.refillRate)!==null&&n!==void 0?n:this.refillRate,this.bucketSize=(i=this.options.bucketSize)!==null&&i!==void 0?i:this.bucketSize,setInterval(function(){r.refillBuckets()},1e3)}),c5=3e5,d5=[Ks.MouseMove,Ks.MouseInteraction,Ks.Scroll,Ks.ViewportResize,Ks.Input,Ks.TouchMove,Ks.MediaInteraction,Ks.Drag],dE=function(t){return{rrwebMethod:t,enqueuedAt:Date.now(),attempt:1}},Qi="[SessionRecording]",h5=function(){function t(e){var n=this;if(at(this,t),X(this,"queuedRRWebEvents",[]),X(this,"isIdle",!1),X(this,"_linkedFlagSeen",!1),X(this,"_lastActivityTimestamp",Date.now()),X(this,"_linkedFlag",null),X(this,"_forceAllowLocalhostNetworkCapture",!1),X(this,"_samplingSessionListener",null),this.instance=e,this._captureStarted=!1,this._endpoint="/s/",this.stopRrweb=void 0,this.receivedDecide=!1,V==null||V.addEventListener("beforeunload",function(){n._flushBuffer()}),V==null||V.addEventListener("offline",function(){n._tryAddCustomEvent("browser offline",{})}),V==null||V.addEventListener("online",function(){n._tryAddCustomEvent("browser online",{})}),V==null||V.addEventListener("visibilitychange",function(){if(Ee!=null&&Ee.visibilityState){var o="window "+Ee.visibilityState;n._tryAddCustomEvent(o,{})}}),!this.instance.sessionManager)throw re.error(Qi+" started without valid sessionManager"),new Error(Qi+" started without valid sessionManager. This is a bug.");var i=this.sessionManager.checkAndGetSessionAndWindowId(),r=i.sessionId,s=i.windowId;this.sessionId=r,this.windowId=s,this.buffer=this.clearBuffer(),this._setupSampling()}return lt(t,[{key:"rrwebRecord",get:function(){var e;return Vt==null||(e=Vt.rrweb)===null||e===void 0?void 0:e.record}},{key:"started",get:function(){return this._captureStarted}},{key:"sessionManager",get:function(){if(!this.instance.sessionManager)throw new Error(Qi+" must be started with a valid sessionManager.");return this.instance.sessionManager}},{key:"fullSnapshotIntervalMillis",get:function(){var e;return((e=this.instance.config.session_recording)===null||e===void 0?void 0:e.full_snapshot_interval_millis)||c5}},{key:"isSampled",get:function(){var e=this.instance.get_property(th);return Pu(e)?e:null}},{key:"sessionDuration",get:function(){var e,n,i=(e=this.buffer)===null||e===void 0?void 0:e.data[((n=this.buffer)===null||n===void 0?void 0:n.data.length)-1],r=this.sessionManager.checkAndGetSessionAndWindowId(!0).sessionStartTimestamp;return i?i.timestamp-r:null}},{key:"isRecordingEnabled",get:function(){var e=!!this.instance.get_property(pb),n=!this.instance.config.disable_session_recording;return V&&e&&n}},{key:"isConsoleLogCaptureEnabled",get:function(){var e=!!this.instance.get_property(WC),n=this.instance.config.enable_recording_console_log;return n??e}},{key:"canvasRecording",get:function(){var e=this.instance.get_property(KC);return e&&e.fps&&e.quality?{enabled:e.enabled,fps:e.fps,quality:e.quality}:void 0}},{key:"networkPayloadCapture",get:function(){var e,n,i=this.instance.get_property(GC),r={recordHeaders:(e=this.instance.config.session_recording)===null||e===void 0?void 0:e.recordHeaders,recordBody:(n=this.instance.config.session_recording)===null||n===void 0?void 0:n.recordBody},s=(r==null?void 0:r.recordHeaders)||(i==null?void 0:i.recordHeaders),o=(r==null?void 0:r.recordBody)||(i==null?void 0:i.recordBody),a=En(this.instance.config.capture_performance)?this.instance.config.capture_performance.network_timing:this.instance.config.capture_performance,l=!!(Pu(a)?a:i!=null&&i.capturePerformance);return s||o||l?{recordHeaders:s,recordBody:o,recordPerformance:l}:void 0}},{key:"sampleRate",get:function(){var e=this.instance.get_property(XC);return ur(e)?e:null}},{key:"minimumDuration",get:function(){var e=this.instance.get_property(qC);return ur(e)?e:null}},{key:"status",get:function(){return this.receivedDecide?this.isRecordingEnabled?yr(this._linkedFlag)||this._linkedFlagSeen?Pu(this.isSampled)?this.isSampled?"sampled":"disabled":"active":"buffering":"disabled":"buffering"}},{key:"startIfEnabledOrStop",value:function(){this.isRecordingEnabled?(this._startCapture(),re.info(Qi+" started")):(this.stopRecording(),this.clearBuffer())}},{key:"stopRecording",value:function(){this._captureStarted&&this.stopRrweb&&(this.stopRrweb(),this.stopRrweb=void 0,this._captureStarted=!1,re.info(Qi+" stopped"))}},{key:"makeSamplingDecision",value:function(e){var n,i=this.sessionId!==e,r=this.sampleRate;if(ur(r)){var s,o=this.isSampled,a=i||!Pu(o);a?s=Math.random()<r:s=o,!s&&a&&re.warn(Qi+" Sample rate (".concat(r,") has determined that this sessionId (").concat(e,") will not be sent to the server.")),this._tryAddCustomEvent("samplingDecisionMade",{sampleRate:r}),(n=this.instance.persistence)===null||n===void 0||n.register(X({},th,s))}else{var l;(l=this.instance.persistence)===null||l===void 0||l.register(X({},th,null))}}},{key:"afterDecideResponse",value:function(e){var n,i,r,s=this;if(this._persistDecideResponse(e),this._linkedFlag=((n=e.sessionRecording)===null||n===void 0?void 0:n.linkedFlag)||null,(i=e.sessionRecording)!==null&&i!==void 0&&i.endpoint&&(this._endpoint=(r=e.sessionRecording)===null||r===void 0?void 0:r.endpoint),this._setupSampling(),!yr(this._linkedFlag)){var o=Un(this._linkedFlag)?this._linkedFlag:this._linkedFlag.flag,a=Un(this._linkedFlag)?null:this._linkedFlag.variant;this.instance.onFeatureFlags(function(l,u){var c=En(u)&&o in u,d=a?u[o]===a:c;if(d){var h={linkedFlag:o,linkedVariant:a},f="linked flag matched";re.info(Qi+" "+f,h),s._tryAddCustomEvent(f,h)}s._linkedFlagSeen=d})}this.receivedDecide=!0,this.startIfEnabledOrStop()}},{key:"_setupSampling",value:function(){var e=this;ur(this.sampleRate)&&Io(this._samplingSessionListener)&&(this._samplingSessionListener=this.sessionManager.onSessionId(function(n){e.makeSamplingDecision(n)}))}},{key:"_persistDecideResponse",value:function(e){if(this.instance.persistence){var n=this.instance.persistence,i=function(){var r,s,o,a,l,u,c,d,h=(r=e.sessionRecording)===null||r===void 0?void 0:r.sampleRate,f=yr(h)?null:parseFloat(h),p=(s=e.sessionRecording)===null||s===void 0?void 0:s.minimumDurationMilliseconds;n.register((X(d={},pb,!!e.sessionRecording),X(d,WC,(o=e.sessionRecording)===null||o===void 0?void 0:o.consoleLogRecordingEnabled),X(d,GC,ke({capturePerformance:e.capturePerformance},(a=e.sessionRecording)===null||a===void 0?void 0:a.networkPayloadCapture)),X(d,KC,{enabled:(l=e.sessionRecording)===null||l===void 0?void 0:l.recordCanvas,fps:(u=e.sessionRecording)===null||u===void 0?void 0:u.canvasFps,quality:(c=e.sessionRecording)===null||c===void 0?void 0:c.canvasQuality}),X(d,XC,f),X(d,qC,Me(p)?null:p),d))};i(),this.sessionManager.onSessionId(i)}}},{key:"log",value:function(e){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"log";(n=this.instance.sessionRecording)===null||n===void 0||n.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:i,trace:[],payload:[JSON.stringify(e)]}},timestamp:NN()})}},{key:"_startCapture",value:function(){var e=this;Me(Object.assign)||this._captureStarted||this.instance.config.disable_session_recording||this.instance.consent.isOptedOut()||(this._captureStarted=!0,this.sessionManager.checkAndGetSessionAndWindowId(),this.rrwebRecord?this._onScriptLoaded():this.instance.requestRouter.loadScript("/static/recorder.js?v=".concat(Vr.LIB_VERSION),function(n){if(n)return re.error(Qi+" could not load recorder.js",n);e._onScriptLoaded()}))}},{key:"isInteractiveEvent",value:function(e){var n;return e.type===3&&d5.indexOf((n=e.data)===null||n===void 0?void 0:n.source)!==-1}},{key:"_updateWindowAndSessionIds",value:function(e){var n=this.isInteractiveEvent(e);n||this.isIdle||e.timestamp-this._lastActivityTimestamp>3e5&&(this.isIdle=!0,clearTimeout(this._fullSnapshotTimer),this._flushBuffer());var i=!1;if(n&&(this._lastActivityTimestamp=e.timestamp,this.isIdle&&(this.isIdle=!1,this._tryAddCustomEvent("sessionNoLongerIdle",{reason:"user activity",type:e.type}),i=!0)),!this.isIdle){var r=this.sessionManager.checkAndGetSessionAndWindowId(!n,e.timestamp),s=r.windowId,o=r.sessionId,a=this.sessionId!==o,l=this.windowId!==s;this.windowId=s,this.sessionId=o,(i||[Y4,J4].indexOf(e.type)===-1&&(l||a||Me(this._fullSnapshotTimer)))&&this._tryTakeFullSnapshot()}}},{key:"_tryRRWebMethod",value:function(e){try{return e.rrwebMethod(),!0}catch(n){return this.queuedRRWebEvents.length<10?this.queuedRRWebEvents.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}):re.warn(Qi+" could not emit queued rrweb event.",n,e),!1}}},{key:"_tryAddCustomEvent",value:function(e,n){var i=this;return this._tryRRWebMethod(dE(function(){return i.rrwebRecord.addCustomEvent(e,n)}))}},{key:"_tryTakeFullSnapshot",value:function(){var e=this;return this._tryRRWebMethod(dE(function(){return e.rrwebRecord.takeFullSnapshot()}))}},{key:"_onScriptLoaded",value:function(){for(var e,n=this,i={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},r=this.instance.config.session_recording,s=0,o=Object.entries(r||{});s<o.length;s++){var a=Zn(o[s],2),l=a[0],u=a[1];l in i&&(i[l]=u)}if(this.canvasRecording&&this.canvasRecording.enabled&&(i.recordCanvas=!0,i.sampling={canvas:this.canvasRecording.fps},i.dataURLOptions={type:"image/webp",quality:this.canvasRecording.quality}),this.rrwebRecord){this.mutationRateLimiter=(e=this.mutationRateLimiter)!==null&&e!==void 0?e:new u5(this.rrwebRecord,{onBlockedNode:function(d,h){var f="Too many mutations on node '".concat(d,"'. Rate limiting. This could be due to SVG animations or something similar");re.info(f,{node:h}),n.log(Qi+" "+f,"warn")}});var c=this._gatherRRWebPlugins();this.stopRrweb=this.rrwebRecord(ke({emit:function(d){n.onRRwebEmit(d)},plugins:c},i)),this.instance._addCaptureHook(function(d){try{if(d==="$pageview"){var h=V?n._maskUrl(V.location.href):"";if(!h)return;n._tryAddCustomEvent("$pageview",{href:h})}}catch(f){re.error("Could not add $pageview to rrweb session",f)}}),this._lastActivityTimestamp=Date.now(),this.isIdle=!1,this._tryAddCustomEvent("$session_options",{sessionRecordingOptions:i,activePlugins:c.map(function(d){return d==null?void 0:d.name})}),this._tryAddCustomEvent("$posthog_config",{config:this.instance.config})}else re.error(Qi+"onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}},{key:"_scheduleFullSnapshot",value:function(){var e=this;if(this._fullSnapshotTimer&&clearInterval(this._fullSnapshotTimer),!this.isIdle){var n=this.fullSnapshotIntervalMillis;n&&(this._fullSnapshotTimer=setInterval(function(){e._tryTakeFullSnapshot()},n))}}},{key:"_gatherRRWebPlugins",value:function(){var e=[];return Vt.rrwebConsoleRecord&&this.isConsoleLogCaptureEnabled&&e.push(Vt.rrwebConsoleRecord.getRecordConsolePlugin()),this.networkPayloadCapture&&Yr(Vt.getRecordNetworkPlugin)&&(!j4.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?e.push(Vt.getRecordNetworkPlugin(l5(this.instance.config,this.networkPayloadCapture))):re.info(Qi+" NetworkCapture not started because we are on localhost.")),e}},{key:"onRRwebEmit",value:function(e){if(this._processQueuedEvents(),e&&En(e)){if(e.type===Lm.Meta){var n=this._maskUrl(e.data.href);if(this._lastHref=n,!n)return;e.data.href=n}else this._pageViewFallBack();e.type===Lm.FullSnapshot&&this._scheduleFullSnapshot();var i=this.mutationRateLimiter?this.mutationRateLimiter.throttleMutations(e):e;if(i){var r=function(a){var l=a;if(l&&En(l)&&l.type===6&&En(l.data)&&l.data.plugin==="rrweb/console@1"){l.data.payload.payload.length>10&&(l.data.payload.payload=l.data.payload.payload.slice(0,10),l.data.payload.payload.push("...[truncated]"));for(var u=[],c=0;c<l.data.payload.payload.length;c++)l.data.payload.payload[c]&&l.data.payload.payload[c].length>2e3?u.push(l.data.payload.payload[c].slice(0,2e3)+"...[truncated]"):u.push(l.data.payload.payload[c]);return l.data.payload.payload=u,a}return a}(i),s=Cb(r);if(this._updateWindowAndSessionIds(r),!this.isIdle||r.type===Lm.Custom){var o={$snapshot_bytes:s,$snapshot_data:r,$session_id:this.sessionId,$window_id:this.windowId};this.status!=="disabled"?this._captureSnapshotBuffered(o):this.clearBuffer()}}}}},{key:"_pageViewFallBack",value:function(){if(!this.instance.config.capture_pageview&&V){var e=this._maskUrl(V.location.href);this._lastHref!==e&&(this._tryAddCustomEvent("$url_changed",{href:e}),this._lastHref=e)}}},{key:"_processQueuedEvents",value:function(){var e=this;if(this.queuedRRWebEvents.length){var n=yo(this.queuedRRWebEvents);this.queuedRRWebEvents=[],n.forEach(function(i){Date.now()-i.enqueuedAt<=2e3&&e._tryRRWebMethod(i)})}}},{key:"_maskUrl",value:function(e){var n=this.instance.config.session_recording;if(n.maskNetworkRequestFn){var i,r={url:e};return(i=r=n.maskNetworkRequestFn(r))===null||i===void 0?void 0:i.url}return e}},{key:"clearBuffer",value:function(){return this.buffer={size:0,data:[],sessionId:this.sessionId,windowId:this.windowId},this.buffer}},{key:"_flushBuffer",value:function(){var e=this;this.flushBufferTimer&&(clearTimeout(this.flushBufferTimer),this.flushBufferTimer=void 0);var n=this.minimumDuration,i=this.sessionDuration,r=ur(i)&&i>=0,s=ur(n)&&r&&i<n;return this.status==="buffering"||s?(this.flushBufferTimer=setTimeout(function(){e._flushBuffer()},2e3),this.buffer):(this.buffer.data.length>0&&Eb(this.buffer).forEach(function(o){e._captureSnapshot({$snapshot_bytes:o.size,$snapshot_data:o.data,$session_id:o.sessionId,$window_id:o.windowId})}),this.clearBuffer())}},{key:"_captureSnapshotBuffered",value:function(e){var n,i=this,r=2+(((n=this.buffer)===null||n===void 0?void 0:n.data.length)||0);(this.buffer.size+e.$snapshot_bytes+r>943718.4||this.buffer.sessionId!==this.sessionId)&&(this.buffer=this._flushBuffer()),this.buffer.size+=e.$snapshot_bytes,this.buffer.data.push(e.$snapshot_data),this.flushBufferTimer||(this.flushBufferTimer=setTimeout(function(){i._flushBuffer()},2e3))}},{key:"_captureSnapshot",value:function(e){this.instance.capture("$snapshot",e,{_url:this.instance.requestRouter.endpointFor("api",this._endpoint),_noTruncate:!0,_batchKey:"recordings"})}}]),t}(),f5=function(){function t(e){at(this,t),this.instance=e,this.instance.decideEndpointWasHit=this.instance._hasBootstrappedFeatureFlags()}return lt(t,[{key:"call",value:function(){var e=this,n={token:this.instance.config.token,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),person_properties:this.instance.get_property(Ru),group_properties:this.instance.get_property(Ko),disable_flags:this.instance.config.advanced_disable_feature_flags||this.instance.config.advanced_disable_feature_flags_on_first_load||void 0};this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:n,compression:this.instance.config.disable_compression?void 0:Hr.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:function(i){return e.parseDecideResponse(i.json)}})}},{key:"parseDecideResponse",value:function(e){var n=this;this.instance.featureFlags.setReloadingPaused(!1),this.instance.featureFlags._startReloadTimer();var i=!e;if(this.instance.config.advanced_disable_feature_flags_on_first_load||this.instance.config.advanced_disable_feature_flags||this.instance.featureFlags.receivedFeatureFlags(e??{},i),i)re.error("Failed to fetch feature flags from PostHog.");else{if(!Ee||!Ee.body)return re.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(function(){n.parseDecideResponse(e)},500);if(this.instance._afterDecideResponse(e),e.siteApps)if(this.instance.config.opt_in_site_apps){var r,s=Ar(e.siteApps);try{var o=function(){var a=r.value,l=a.id,u=a.url,c=n.instance.requestRouter.endpointFor("api",u);Vt["__$$ph_site_app_".concat(l)]=n.instance,n.instance.requestRouter.loadScript(c,function(d){if(d)return re.error("Error while initializing PostHog app with config id ".concat(l),d)})};for(s.s();!(r=s.n()).done;)o()}catch(a){s.e(a)}finally{s.f()}}else e.siteApps.length>0&&re.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}}]),t}(),p5=V!=null&&V.location?xg(V.location.hash,"__posthog")||xg(location.hash,"state"):null,hE="_postHogToolbarParams";(function(t){t[t.UNINITIALIZED=0]="UNINITIALIZED",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED"})(Ys||(Ys={}));var m5=function(){function t(e){at(this,t),this.instance=e}return lt(t,[{key:"setToolbarState",value:function(e){Vt.ph_toolbar_state=e}},{key:"getToolbarState",value:function(){var e;return(e=Vt.ph_toolbar_state)!==null&&e!==void 0?e:Ys.UNINITIALIZED}},{key:"maybeLoadToolbar",value:function(){var e,n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(!V||!Ee)return!1;i=(e=i)!==null&&e!==void 0?e:V.location,s=(n=s)!==null&&n!==void 0?n:V.history;try{if(!r){try{V.localStorage.setItem("test","test"),V.localStorage.removeItem("test")}catch{return!1}r=V==null?void 0:V.localStorage}var o,a=p5||xg(i.hash,"__posthog")||xg(i.hash,"state"),l=a?$C(function(){return JSON.parse(atob(decodeURIComponent(a)))})||$C(function(){return JSON.parse(decodeURIComponent(a))}):null;return l&&l.action==="ph_authorize"?((o=l).source="url",o&&Object.keys(o).length>0&&(l.desiredHash?i.hash=l.desiredHash:s?s.replaceState(s.state,"",i.pathname+i.search):i.hash="")):((o=JSON.parse(r.getItem(hE)||"{}")).source="localstorage",delete o.userIntent),!(!o.token||this.instance.config.token!==o.token)&&(this.loadToolbar(o),!0)}catch{return!1}}},{key:"_callLoadToolbar",value:function(e){(Vt.ph_load_toolbar||Vt.ph_load_editor)(e,this.instance)}},{key:"loadToolbar",value:function(e){var n=this,i=!(Ee==null||!Ee.getElementById(xb));if(!V||i)return!1;var r=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,s=ke(ke({token:this.instance.config.token},e),{},{apiURL:this.instance.requestRouter.endpointFor("ui")},r?{instrument:!1}:{});if(V.localStorage.setItem(hE,JSON.stringify(ke(ke({},s),{},{source:void 0}))),this.getToolbarState()===Ys.LOADED)this._callLoadToolbar(s);else if(this.getToolbarState()===Ys.UNINITIALIZED){this.setToolbarState(Ys.LOADING);var o=3e5,a=Math.floor(Date.now()/o)*o;this.instance.requestRouter.loadScript("/static/toolbar.js?t=".concat(a),function(l){if(l)return re.error("Failed to load toolbar",l),void n.setToolbarState(Ys.UNINITIALIZED);n.setToolbarState(Ys.LOADED),n._callLoadToolbar(s)}),po(V,"turbolinks:load",function(){n.setToolbarState(Ys.UNINITIALIZED),n.loadToolbar(s)})}return!0}},{key:"_loadEditor",value:function(e){return this.loadToolbar(e)}},{key:"maybeLoadEditor",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;return this.maybeLoadToolbar(e,n,i)}}]),t}(),g5=function(){function t(e){at(this,t),X(this,"isPaused",!0),X(this,"queue",[]),X(this,"flushTimeoutMs",3e3),this.sendRequest=e}return lt(t,[{key:"enqueue",value:function(e){this.queue.push(e),this.flushTimeout||this.setFlushTimeout()}},{key:"unload",value:function(){var e=this;this.clearFlushTimeout();var n=this.queue.length>0?this.formatQueue():{},i=Object.values(n);[].concat(yo(i.filter(function(r){return r.url.indexOf("/e")===0})),yo(i.filter(function(r){return r.url.indexOf("/e")!==0}))).map(function(r){e.sendRequest(ke(ke({},r),{},{transport:"sendBeacon"}))})}},{key:"enable",value:function(){this.isPaused=!1,this.setFlushTimeout()}},{key:"setFlushTimeout",value:function(){var e=this;this.isPaused||(this.flushTimeout=setTimeout(function(){if(e.clearFlushTimeout(),e.queue.length>0){var n=e.formatQueue(),i=function(s){var o=n[s],a=new Date().getTime();o.data&&on(o.data)&&wt(o.data,function(l){l.offset=Math.abs(l.timestamp-a),delete l.timestamp}),e.sendRequest(o)};for(var r in n)i(r)}},this.flushTimeoutMs))}},{key:"clearFlushTimeout",value:function(){clearTimeout(this.flushTimeout),this.flushTimeout=void 0}},{key:"formatQueue",value:function(){var e={};return wt(this.queue,function(n){var i,r=n,s=(r?r.batchKey:null)||r.url;Me(e[s])&&(e[s]=ke(ke({},r),{},{data:[]})),(i=e[s].data)===null||i===void 0||i.push(r.data)}),this.queue=[],e}}]),t}(),br=Uint8Array,_i=Uint16Array,kc=Uint32Array,xS=new br([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),SS=new br([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),fE=new br([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),rM=function(t,e){for(var n=new _i(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];var r=new kc(n[30]);for(i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)r[s]=s-n[i]<<5|i;return[n,r]},sM=rM(xS,2),v5=sM[0],Nb=sM[1];v5[28]=258,Nb[258]=28;for(var pE=rM(SS,0)[1],oM=new _i(32768),Tt=0;Tt<32768;++Tt){var fl=(43690&Tt)>>>1|(21845&Tt)<<1;fl=(61680&(fl=(52428&fl)>>>2|(13107&fl)<<2))>>>4|(3855&fl)<<4,oM[Tt]=((65280&fl)>>>8|(255&fl)<<8)>>>1}var ih=function(t,e,n){for(var i=t.length,r=0,s=new _i(e);r<i;++r)++s[t[r]-1];var o,a=new _i(e);for(r=0;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;for(o=new _i(i),r=0;r<i;++r)o[r]=oM[a[t[r]-1]++]>>>15-t[r];return o},zl=new br(288);for(Tt=0;Tt<144;++Tt)zl[Tt]=8;for(Tt=144;Tt<256;++Tt)zl[Tt]=9;for(Tt=256;Tt<280;++Tt)zl[Tt]=7;for(Tt=280;Tt<288;++Tt)zl[Tt]=8;var Cg=new br(32);for(Tt=0;Tt<32;++Tt)Cg[Tt]=5;var y5=ih(zl,9),w5=ih(Cg,5),aM=function(t){return(t/8>>0)+(7&t&&1)},lM=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var i=new(t instanceof _i?_i:t instanceof kc?kc:br)(n-e);return i.set(t.subarray(e,n)),i},Vs=function(t,e,n){n<<=7&e;var i=e/8>>0;t[i]|=n,t[i+1]|=n>>>8},dd=function(t,e,n){n<<=7&e;var i=e/8>>0;t[i]|=n,t[i+1]|=n>>>8,t[i+2]|=n>>>16},g0=function(t,e){for(var n=[],i=0;i<t.length;++i)t[i]&&n.push({s:i,f:t[i]});var r=n.length,s=n.slice();if(!r)return[new br(0),0];if(r==1){var o=new br(n[0].s+1);return o[n[0].s]=1,[o,1]}n.sort(function(_,E){return _.f-E.f}),n.push({s:-1,f:25001});var a=n[0],l=n[1],u=0,c=1,d=2;for(n[0]={s:-1,f:a.f+l.f,l:a,r:l};c!=r-1;)a=n[n[u].f<n[d].f?u++:d++],l=n[u!=c&&n[u].f<n[d].f?u++:d++],n[c++]={s:-1,f:a.f+l.f,l:a,r:l};var h=s[0].s;for(i=1;i<r;++i)s[i].s>h&&(h=s[i].s);var f=new _i(h+1),p=b5(n[c-1],f,0);if(p>e){i=0;var m=0,w=p-e,v=1<<w;for(s.sort(function(_,E){return f[E.s]-f[_.s]||_.f-E.f});i<r;++i){var y=s[i].s;if(!(f[y]>e))break;m+=v-(1<<p-f[y]),f[y]=e}for(m>>>=w;m>0;){var b=s[i].s;f[b]<e?m-=1<<e-f[b]++-1:++i}for(;i>=0&&m;--i){var k=s[i].s;f[k]==e&&(--f[k],++m)}p=e}return[new br(f),p]},b5=function t(e,n,i){return e.s==-1?Math.max(t(e.l,n,i+1),t(e.r,n,i+1)):n[e.s]=i},mE=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new _i(++e),i=0,r=t[0],s=1,o=function(l){n[i++]=l},a=1;a<=e;++a)if(t[a]==r&&a!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(r),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(r);s=1,r=t[a]}return[n.subarray(0,i),e]},hd=function(t,e){for(var n=0,i=0;i<e.length;++i)n+=t[i]*e[i];return n},Mb=function(t,e,n){var i=n.length,r=aM(e+2);t[r]=255&i,t[r+1]=i>>>8,t[r+2]=255^t[r],t[r+3]=255^t[r+1];for(var s=0;s<i;++s)t[r+s+4]=n[s];return 8*(r+4+i)},gE=function(t,e,n,i,r,s,o,a,l,u,c){Vs(e,c++,n),++r[256];for(var d=g0(r,15),h=d[0],f=d[1],p=g0(s,15),m=p[0],w=p[1],v=mE(h),y=v[0],b=v[1],k=mE(m),_=k[0],E=k[1],A=new _i(19),P=0;P<y.length;++P)A[31&y[P]]++;for(P=0;P<_.length;++P)A[31&_[P]]++;for(var I=g0(A,7),D=I[0],B=I[1],$=19;$>4&&!D[fE[$-1]];--$);var J,z,G,Q,ie=u+5<<3,H=hd(r,zl)+hd(s,Cg)+o,j=hd(r,h)+hd(s,m)+o+14+3*$+hd(A,D)+(2*A[16]+3*A[17]+7*A[18]);if(ie<=H&&ie<=j)return Mb(e,c,t.subarray(l,l+u));if(Vs(e,c,1+(j<H)),c+=2,j<H){J=ih(h,f),z=h,G=ih(m,w),Q=m;var te=ih(D,B);for(Vs(e,c,b-257),Vs(e,c+5,E-1),Vs(e,c+10,$-4),c+=14,P=0;P<$;++P)Vs(e,c+3*P,D[fE[P]]);c+=3*$;for(var pe=[y,_],q=0;q<2;++q){var ue=pe[q];for(P=0;P<ue.length;++P){var O=31&ue[P];Vs(e,c,te[O]),c+=D[O],O>15&&(Vs(e,c,ue[P]>>>5&127),c+=ue[P]>>>12)}}}else J=y5,z=zl,G=w5,Q=Cg;for(P=0;P<a;++P)if(i[P]>255){O=i[P]>>>18&31,dd(e,c,J[O+257]),c+=z[O+257],O>7&&(Vs(e,c,i[P]>>>23&31),c+=xS[O]);var M=31&i[P];dd(e,c,G[M]),c+=Q[M],M>3&&(dd(e,c,i[P]>>>5&8191),c+=SS[M])}else dd(e,c,J[i[P]]),c+=z[i[P]];return dd(e,c,J[256]),c+z[256]},x5=new kc([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),S5=function(){for(var t=new kc(256),e=0;e<256;++e){for(var n=e,i=9;--i;)n=(1&n&&3988292384)^n>>>1;t[e]=n}return t}(),k5=function(t,e,n,i,r){return function(s,o,a,l,u,c){var d=s.length,h=new br(l+d+5*(1+Math.floor(d/7e3))+u),f=h.subarray(l,h.length-u),p=0;if(!o||d<8)for(var m=0;m<=d;m+=65535){var w=m+65535;w<d?p=Mb(f,p,s.subarray(m,w)):(f[m]=c,p=Mb(f,p,s.subarray(m,d)))}else{for(var v=x5[o-1],y=v>>>13,b=8191&v,k=(1<<a)-1,_=new _i(32768),E=new _i(k+1),A=Math.ceil(a/3),P=2*A,I=function(De){return(s[De]^s[De+1]<<A^s[De+2]<<P)&k},D=new kc(25e3),B=new _i(288),$=new _i(32),J=0,z=0,G=(m=0,0),Q=0,ie=0;m<d;++m){var H=I(m),j=32767&m,te=E[H];if(_[j]=te,E[H]=j,Q<=m){var pe=d-m;if((J>7e3||G>24576)&&pe>423){p=gE(s,f,0,D,B,$,z,G,ie,m-ie,p),G=J=z=0,ie=m;for(var q=0;q<286;++q)B[q]=0;for(q=0;q<30;++q)$[q]=0}var ue=2,O=0,M=b,F=j-te&32767;if(pe>2&&H==I(m-F))for(var x=Math.min(y,pe)-1,T=Math.min(32767,m),N=Math.min(258,pe);F<=T&&--M&&j!=te;){if(s[m+ue]==s[m+ue-F]){for(var R=0;R<N&&s[m+R]==s[m+R-F];++R);if(R>ue){if(ue=R,O=F,R>x)break;var W=Math.min(F,R-2),U=0;for(q=0;q<W;++q){var Z=m-F+q+32768&32767,K=Z-_[Z]+32768&32767;K>U&&(U=K,te=Z)}}}F+=(j=te)-(te=_[j])+32768&32767}if(O){D[G++]=268435456|Nb[ue]<<18|pE[O];var Se=31&Nb[ue],Oe=31&pE[O];z+=xS[Se]+SS[Oe],++B[257+Se],++$[Oe],Q=m+ue,++J}else D[G++]=s[m],++B[s[m]]}}p=gE(s,f,c,D,B,$,z,G,ie,m-ie,p)}return lM(h,0,l+aM(p)+u)}(t,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,n,i,!r)},v0=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8};function _5(t,e){e===void 0&&(e={});var n=function(){var a=4294967295;return{p:function(l){for(var u=a,c=0;c<l.length;++c)u=S5[255&u^l[c]]^u>>>8;a=u},d:function(){return 4294967295^a}}}(),i=t.length;n.p(t);var r,s=k5(t,e,10+((r=e).filename&&r.filename.length+1||0),8),o=s.length;return function(a,l){var u=l.filename;if(a[0]=31,a[1]=139,a[2]=8,a[8]=l.level<2?4:l.level==9?2:0,a[9]=3,l.mtime!=0&&v0(a,4,Math.floor(new Date(l.mtime||Date.now())/1e3)),u){a[3]=8;for(var c=0;c<=u.length;++c)a[c+10]=u.charCodeAt(c)}}(s,e),v0(s,o-8,n.d()),v0(s,o-4,i),s}var C5=!!cb||!!ub,vE="text/plain",Eg=function(t,e){var n=Zn(t.split("?"),2),i=n[0],r=n[1],s=ke({},e);r==null||r.split("&").forEach(function(a){var l=Zn(a.split("="),1)[0];delete s[l]});var o=F4(s);return o=o?(r?r+"&":"")+o:r,"".concat(i,"?").concat(o)},E5=function(t){return"data="+encodeURIComponent(typeof t=="string"?t:JSON.stringify(t))},y0=function(t){var e=t.data,n=t.compression;if(e){if(n===Hr.GZipJS){var i=_5(function(s,o){var a=s.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(s);for(var l=new br(s.length+(s.length>>>1)),u=0,c=function(p){l[u++]=p},d=0;d<a;++d){if(u+5>l.length){var h=new br(u+8+(a-d<<1));h.set(l),l=h}var f=s.charCodeAt(d);f<128||o?c(f):f<2048?(c(192|f>>>6),c(128|63&f)):f>55295&&f<57344?(c(240|(f=65536+(1047552&f)|1023&s.charCodeAt(++d))>>>18),c(128|f>>>12&63),c(128|f>>>6&63),c(128|63&f)):(c(224|f>>>12),c(128|f>>>6&63),c(128|63&f))}return lM(l,0,u)}(JSON.stringify(e)),{mtime:0});return{contentType:vE,body:new Blob([i],{type:vE})}}if(n===Hr.Base64){var r=function(s){var o,a,l,u,c,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=0,f=0,p="",m=[];if(!s)return s;s=C4(s);do o=(c=s.charCodeAt(h++)<<16|s.charCodeAt(h++)<<8|s.charCodeAt(h++))>>18&63,a=c>>12&63,l=c>>6&63,u=63&c,m[f++]=d.charAt(o)+d.charAt(a)+d.charAt(l)+d.charAt(u);while(h<s.length);switch(p=m.join(""),s.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"="}return p}(JSON.stringify(e));return{contentType:"application/x-www-form-urlencoded",body:E5(r)}}return{contentType:"application/json",body:JSON.stringify(e)}}},rh=[];cb&&rh.push({transport:"XHR",method:function(t){var e,n=new cb;n.open(t.method||"GET",t.url,!0);var i=(e=y0(t))!==null&&e!==void 0?e:{},r=i.contentType,s=i.body;wt(t.headers,function(o,a){n.setRequestHeader(a,o)}),r&&n.setRequestHeader("Content-Type",r),t.timeout&&(n.timeout=t.timeout),n.withCredentials=!0,n.onreadystatechange=function(){if(n.readyState===4){var o,a={statusCode:n.status,text:n.responseText};if(n.status===200)try{a.json=JSON.parse(n.responseText)}catch{}(o=t.callback)===null||o===void 0||o.call(t,a)}},n.send(s)}}),ub&&rh.push({transport:"fetch",method:function(t){var e,n,i=(e=y0(t))!==null&&e!==void 0?e:{},r=i.contentType,s=i.body,o=new Headers;wt(o,function(c,d){o.append(d,c)}),r&&o.append("Content-Type",r);var a=t.url,l=null;if(FC){var u=new FC;l={signal:u.signal,timeout:setTimeout(function(){return u.abort()},t.timeout)}}ub(a,{method:(t==null?void 0:t.method)||"GET",headers:o,keepalive:t.method==="POST",body:s,signal:(n=l)===null||n===void 0?void 0:n.signal}).then(function(c){return c.text().then(function(d){var h,f={statusCode:c.status,text:d};if(c.status===200)try{f.json=JSON.parse(d)}catch(p){re.error(p)}(h=t.callback)===null||h===void 0||h.call(t,f)})}).catch(function(c){var d;re.error(c),(d=t.callback)===null||d===void 0||d.call(t,{statusCode:0,text:c})}).finally(function(){return l?clearTimeout(l.timeout):null})}}),mo!=null&&mo.sendBeacon&&rh.push({transport:"sendBeacon",method:function(t){var e=Eg(t.url,{beacon:"1"});try{var n,i=(n=y0(t))!==null&&n!==void 0?n:{},r=i.contentType,s=i.body,o=typeof s=="string"?new Blob([s],{type:r}):s;mo.sendBeacon(e,o)}catch{}}});var A5=["retriesPerformedSoFar"],Pl,P5=function(){function t(e){var n=this;at(this,t),X(this,"isPolling",!1),X(this,"pollIntervalMs",3e3),X(this,"queue",[]),this.instance=e,this.queue=[],this.areWeOnline=!0,!Me(V)&&"onLine"in V.navigator&&(this.areWeOnline=V.navigator.onLine,V.addEventListener("online",function(){n.areWeOnline=!0,n.flush()}),V.addEventListener("offline",function(){n.areWeOnline=!1}))}return lt(t,[{key:"retriableRequest",value:function(e){var n=this,i=e.retriesPerformedSoFar,r=b4(e,A5);ur(i)&&i>0&&(r.url=Eg(r.url,{retry_count:i})),this.instance._send_request(ke(ke({},r),{},{callback:function(s){var o;s.statusCode!==200&&(s.statusCode<400||s.statusCode>=500)&&(i??0)<10?n.enqueue(ke({retriesPerformedSoFar:i},r)):(o=r.callback)===null||o===void 0||o.call(r,s)}}))}},{key:"enqueue",value:function(e){var n=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=n+1;var i=function(o){var a=3e3*Math.pow(2,o),l=a/2,u=Math.min(18e5,a),c=(Math.random()-.5)*(u-l);return Math.ceil(u+c)}(n),r=Date.now()+i;this.queue.push({retryAt:r,requestOptions:e});var s="Enqueued failed request for retry in ".concat(i);navigator.onLine||(s+=" (Browser is offline)"),re.warn(s),this.isPolling||(this.isPolling=!0,this.poll())}},{key:"poll",value:function(){var e=this;this.poller&&clearTimeout(this.poller),this.poller=setTimeout(function(){e.areWeOnline&&e.queue.length>0&&e.flush(),e.poll()},this.pollIntervalMs)}},{key:"flush",value:function(){var e=Date.now(),n=[],i=this.queue.filter(function(a){return a.retryAt<e||(n.push(a),!1)});if(this.queue=n,i.length>0){var r,s=Ar(i);try{for(s.s();!(r=s.n()).done;){var o=r.value.requestOptions;this.retriableRequest(o)}}catch(a){s.e(a)}finally{s.f()}}}},{key:"unload",value:function(){this.poller&&(clearTimeout(this.poller),this.poller=void 0);var e,n=Ar(this.queue);try{for(n.s();!(e=n.n()).done;){var i=e.value.requestOptions;try{this.instance._send_request(ke(ke({},i),{},{transport:"sendBeacon"}))}catch(r){re.error(r)}}}catch(r){n.e(r)}finally{n.f()}this.queue=[]}}]),t}(),kp=1800,T5=function(){function t(e,n,i,r){var s;at(this,t),X(this,"_sessionIdChangedHandlers",[]),this.config=e,this.persistence=n,this._windowId=void 0,this._sessionId=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this._sessionIdGenerator=i||ca,this._windowIdGenerator=r||ca;var o=e.persistence_name||e.token,a=e.session_idle_timeout_seconds||kp;if(ur(a)?a>kp?re.warn("session_idle_timeout_seconds cannot be  greater than 30 minutes. Using 30 minutes instead."):a<60&&re.warn("session_idle_timeout_seconds cannot be less than 60 seconds. Using 60 seconds instead."):(re.warn("session_idle_timeout_seconds must be a number. Defaulting to 30 minutes."),a=kp),this._sessionTimeoutMs=1e3*Math.min(Math.max(a,60),kp),this._window_id_storage_key="ph_"+o+"_window_id",this._primary_window_exists_storage_key="ph_"+o+"_primary_window_exists",this._canUseSessionStorage()){var l=bn.parse(this._window_id_storage_key),u=bn.parse(this._primary_window_exists_storage_key);l&&!u?this._windowId=l:bn.remove(this._window_id_storage_key),bn.set(this._primary_window_exists_storage_key,!0)}if((s=this.config.bootstrap)!==null&&s!==void 0&&s.sessionID)try{var c=function(d){var h=d.replace(/-/g,"");if(h.length!==32)throw new Error("Not a valid UUID");if(h[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(h.substring(0,12),16)}(this.config.bootstrap.sessionID);this._setSessionId(this.config.bootstrap.sessionID,new Date().getTime(),c)}catch(d){re.error("Invalid sessionID in bootstrap",d)}this._listenToReloadWindow()}return lt(t,[{key:"onSessionId",value:function(e){var n=this;return Me(this._sessionIdChangedHandlers)&&(this._sessionIdChangedHandlers=[]),this._sessionIdChangedHandlers.push(e),this._sessionId&&e(this._sessionId,this._windowId),function(){n._sessionIdChangedHandlers=n._sessionIdChangedHandlers.filter(function(i){return i!==e})}}},{key:"_canUseSessionStorage",value:function(){return this.config.persistence!=="memory"&&!this.persistence.disabled&&bn.is_supported()}},{key:"_setWindowId",value:function(e){e!==this._windowId&&(this._windowId=e,this._canUseSessionStorage()&&bn.set(this._window_id_storage_key,e))}},{key:"_getWindowId",value:function(){return this._windowId?this._windowId:this._canUseSessionStorage()?bn.parse(this._window_id_storage_key):null}},{key:"_setSessionId",value:function(e,n,i){e===this._sessionId&&n===this._sessionActivityTimestamp&&i===this._sessionStartTimestamp||(this._sessionStartTimestamp=i,this._sessionActivityTimestamp=n,this._sessionId=e,this.persistence.register(X({},vg,[n,e,i])))}},{key:"_getSessionId",value:function(){if(this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];var e=this.persistence.props[vg];return on(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}},{key:"resetSessionId",value:function(){this._setSessionId(null,null,null)}},{key:"_listenToReloadWindow",value:function(){var e=this;V==null||V.addEventListener("beforeunload",function(){e._canUseSessionStorage()&&bn.remove(e._primary_window_exists_storage_key)})}},{key:"checkAndGetSessionAndWindowId",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:null)||new Date().getTime(),i=Zn(this._getSessionId(),3),r=i[0],s=i[1],o=i[2],a=this._getWindowId(),l=o&&o>0&&Math.abs(n-o)>864e5,u=!1,c=!s,d=!e&&Math.abs(n-r)>this._sessionTimeoutMs;c||d||l?(s=this._sessionIdGenerator(),a=this._windowIdGenerator(),re.info("[SessionId] new session ID generated",{sessionId:s,windowId:a,changeReason:{noSessionId:c,activityTimeout:d,sessionPastMaximumLength:l}}),o=n,u=!0):a||(a=this._windowIdGenerator(),u=!0);var h=r===0||!e||l?n:r,f=o===0?new Date().getTime():o;return this._setWindowId(a),this._setSessionId(s,h,f),u&&this._sessionIdChangedHandlers.forEach(function(p){return p(s,a)}),{sessionId:s,windowId:a,sessionStartTimestamp:f}}}]),t}();(function(t){t.US="us",t.EU="eu",t.CUSTOM="custom"})(Pl||(Pl={}));var yE="i.posthog.com",R5=function(){function t(e){at(this,t),X(this,"_regionCache",{}),this.instance=e}return lt(t,[{key:"apiHost",get:function(){return this.instance.config.api_host.trim().replace(/\/$/,"")}},{key:"uiHost",get:function(){var e,n=(e=this.instance.config.ui_host)===null||e===void 0?void 0:e.replace(/\/$/,"");return n==="https://app.posthog.com"?"https://us.posthog.com":n}},{key:"region",get:function(){return this._regionCache[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=Pl.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=Pl.EU:this._regionCache[this.apiHost]=Pl.CUSTOM),this._regionCache[this.apiHost]}},{key:"endpointFor",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(n&&(n=n[0]==="/"?n:"/".concat(n)),e==="ui")return(this.uiHost||this.apiHost.replace(".".concat(yE),".posthog.com"))+n;if(this.region===Pl.CUSTOM)return this.apiHost+n;var i=yE+n;switch(e){case"assets":return"https://".concat(this.region,"-assets.").concat(i);case"api":return"https://".concat(this.region,".").concat(i)}}},{key:"loadScript",value:function(e,n){if(this.instance.config.disable_external_dependency_loading)return re.warn("".concat(e," was requested but loading of external scripts is disabled.")),n("Loading of external scripts is disabled");var i=e[0]==="/"?this.endpointFor("assets",e):e,r=function(){if(!Ee)return n("document not found");var s=Ee.createElement("script");s.type="text/javascript",s.src=i,s.onload=function(l){return n(void 0,l)},s.onerror=function(l){return n(l)};var o,a=Ee.querySelectorAll("body > script");a.length>0?(o=a[0].parentNode)===null||o===void 0||o.insertBefore(s,a[0]):Ee.body.appendChild(s)};Ee!=null&&Ee.body?r():Ee==null||Ee.addEventListener("DOMContentLoaded",r)}}]),t}(),Ob="/e/",_p="[Exception Capture]",N5=function(){function t(e){var n,i,r=this;at(this,t),X(this,"originalOnUnhandledRejectionHandler",void 0),X(this,"startCapturing",function(){var s;if(V&&r.isEnabled&&!r.hasHandlers&&((s=V.onerror)===null||s===void 0||!s.__POSTHOG_INSTRUMENTED__)){var o=V.posthogErrorWrappingFunctions.wrapOnError,a=V.posthogErrorWrappingFunctions.wrapUnhandledRejection;if(o&&a)try{r.unwrapOnError=o(r.captureException.bind(r)),r.unwrapUnhandledRejection=a(r.captureException.bind(r))}catch(l){re.error(_p+" failed to start",l),r.stopCapturing()}else re.error(_p+" failed to load error wrapping functions - cannot start")}}),this.instance=e,this.remoteEnabled=!((n=this.instance.persistence)===null||n===void 0||!n.props[UC]),this._endpoint=((i=this.instance.persistence)===null||i===void 0?void 0:i.props[VC])||Ob,this.startIfEnabled()}return lt(t,[{key:"endpoint",get:function(){return this._endpoint}},{key:"isEnabled",get:function(){var e;return(e=this.remoteEnabled)!==null&&e!==void 0&&e}},{key:"isCapturing",get:function(){var e;return!(V==null||(e=V.onerror)===null||e===void 0||!e.__POSTHOG_INSTRUMENTED__)}},{key:"hasHandlers",get:function(){return this.originalOnUnhandledRejectionHandler||this.unwrapOnError}},{key:"startIfEnabled",value:function(){this.isEnabled&&!this.isCapturing&&(re.info(_p+" enabled, starting..."),this.loadScript(this.startCapturing))}},{key:"loadScript",value:function(e){this.hasHandlers&&e(),this.instance.requestRouter.loadScript(this.instance.requestRouter.endpointFor("assets","/static/exception-autocapture.js?v=".concat(Vr.LIB_VERSION)),function(n){if(n)return re.error(_p+" failed to load script",n);e()})}},{key:"stopCapturing",value:function(){var e,n;(e=this.unwrapOnError)===null||e===void 0||e.call(this),(n=this.unwrapUnhandledRejection)===null||n===void 0||n.call(this)}},{key:"afterDecideResponse",value:function(e){var n=e.autocaptureExceptions;this.remoteEnabled=!!n||!1,this._endpoint=En(n)&&n.endpoint||Ob,this.instance.persistence&&(this.instance.persistence.register(X({},UC,this.remoteEnabled)),this.instance.persistence.register(X({},VC,this._endpoint))),this.startIfEnabled()}},{key:"captureException",value:function(e){var n=this.instance.requestRouter.endpointFor("ui");e.$exception_personURL="".concat(n,"/project/").concat(this.instance.config.token,"/person/").concat(this.instance.get_distinct_id()),this.sendExceptionEvent(e)}},{key:"sendExceptionEvent",value:function(e){this.instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent",_url:this.endpoint})}}]),t}(),uM="posthog-js";function cM(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.organization,i=e.projectId,r=e.prefix,s=e.severityAllowList,o=s===void 0?["error"]:s;return function(a){var l,u,c,d,h,f;if(!(o==="*"||o.includes(a.level))||!t.__loaded)return a;a.tags||(a.tags={});var p=t.requestRouter.endpointFor("ui","/project/".concat(t.config.token,"/person/").concat(t.get_distinct_id()));a.tags["PostHog Person URL"]=p,t.sessionRecordingStarted()&&(a.tags["PostHog Recording URL"]=t.get_session_replay_url({withTimestamp:!0}));var m=((l=a.exception)===null||l===void 0?void 0:l.values)||[],w={$exception_message:((u=m[0])===null||u===void 0?void 0:u.value)||a.message,$exception_type:(c=m[0])===null||c===void 0?void 0:c.type,$exception_personURL:p,$exception_level:a.level,$sentry_event_id:a.event_id,$sentry_exception:a.exception,$sentry_exception_message:((d=m[0])===null||d===void 0?void 0:d.value)||a.message,$sentry_exception_type:(h=m[0])===null||h===void 0?void 0:h.type,$sentry_tags:a.tags,$level:a.level};return n&&i&&(w.$sentry_url=(r||"https://sentry.io/organizations/")+n+"/issues/?project="+i+"&query="+a.event_id),t.capture("$exception",w,{_url:((f=t.exceptionObserver)===null||f===void 0?void 0:f.endpoint)||Ob}),a}}var M5=lt(function t(e,n,i,r,s){at(this,t),this.name=uM,this.setupOnce=function(o){o(cM(e,{organization:n,projectId:i,prefix:r,severityAllowList:s}))}});function O5(t,e){var n=t.config.segment;if(!n)return e();(function(i,r){var s=i.config.segment;if(!s)return r();var o=function(l){var u=function(){return l.anonymousId()||ca()};i.config.get_device_id=u,l.id()&&(i.register({distinct_id:l.id(),$device_id:u()}),i.persistence.set_property(qs,"identified")),r()},a=s.user();"then"in a&&Yr(a.then)?a.then(function(l){return o(l)}):o(a)})(t,function(){n.register(function(i){Promise&&Promise.resolve||re.warn("This browser does not have Promise support, and can not use the segment integration");var r=function(s,o){var a;if(!o)return s;s.event.userId||s.event.anonymousId===i.get_distinct_id()||i.reset(),s.event.userId&&s.event.userId!==i.get_distinct_id()&&(i.register({distinct_id:s.event.userId}),i.reloadFeatureFlags());var l=i._calculate_event_properties(o,(a=s.event.properties)!==null&&a!==void 0?a:{});return s.event.properties=Object.assign({},l,s.event.properties),s};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:function(){return!0},load:function(){return Promise.resolve()},track:function(s){return r(s,s.event.event)},page:function(s){return r(s,"$pageview")},identify:function(s){return r(s,"$identify")},screen:function(s){return r(s,"$screen")}}}(t)).then(function(){e()})})}var wE,Ag,Ir,I5=function(){function t(e){at(this,t),this._instance=e}return lt(t,[{key:"doPageView",value:function(){var e,n=this._previousScrollProperties();return this._currentPath=(e=V==null?void 0:V.location.pathname)!==null&&e!==void 0?e:"",this._instance.scrollManager.resetContext(),n}},{key:"doPageLeave",value:function(){return this._previousScrollProperties()}},{key:"_previousScrollProperties",value:function(){var e=this._currentPath,n=this._instance.scrollManager.getContext();if(!e||!n)return{};var i=n.maxScrollHeight,r=n.lastScrollY,s=n.maxScrollY,o=n.maxContentHeight,a=n.lastContentY,l=n.maxContentY;return Me(i)||Me(r)||Me(s)||Me(o)||Me(a)||Me(l)?{}:(i=Math.ceil(i),r=Math.ceil(r),s=Math.ceil(s),o=Math.ceil(o),a=Math.ceil(a),l=Math.ceil(l),{$prev_pageview_pathname:e,$prev_pageview_last_scroll:r,$prev_pageview_last_scroll_percentage:i<=1?1:Cp(r/i,0,1),$prev_pageview_max_scroll:s,$prev_pageview_max_scroll_percentage:i<=1?1:Cp(s/i,0,1),$prev_pageview_last_content:a,$prev_pageview_last_content_percentage:o<=1?1:Cp(a/o,0,1),$prev_pageview_max_content:l,$prev_pageview_max_content_percentage:o<=1?1:Cp(l/o,0,1)})}}]),t}();function Cp(t,e,n){return Math.max(e,Math.min(t,n))}(function(t){t.Popover="popover",t.API="api",t.Widget="widget"})(wE||(wE={})),function(t){t.Open="open",t.MultipleChoice="multiple_choice",t.SingleChoice="single_choice",t.Rating="rating",t.Link="link"}(Ag||(Ag={})),function(t){t.NextQuestion="next_question",t.End="end",t.ResponseBased="response_based",t.SpecificQuestion="specific_question"}(Ir||(Ir={}));var dM=function(){function t(){at(this,t),X(this,"events",{}),this.events={}}return lt(t,[{key:"on",value:function(e,n){var i=this;return this.events[e]||(this.events[e]=[]),this.events[e].push(n),function(){i.events[e]=i.events[e].filter(function(r){return r!==n})}}},{key:"emit",value:function(e,n){var i,r=Ar(this.events[e]||[]);try{for(r.s();!(i=r.n()).done;)(0,i.value)(n)}catch(a){r.e(a)}finally{r.f()}var s,o=Ar(this.events["*"]||[]);try{for(o.s();!(s=o.n()).done;)(0,s.value)(e,n)}catch(a){o.e(a)}finally{o.f()}}}]),t}(),D5=function(){function t(e){var n=this;at(this,t),X(this,"_debugEventEmitter",new dM),X(this,"checkStep",function(i,r){return n.checkStepEvent(i,r)&&n.checkStepUrl(i,r)&&n.checkStepElement(i,r)}),X(this,"checkStepEvent",function(i,r){return r==null||!r.event||(i==null?void 0:i.event)===(r==null?void 0:r.event)}),this.instance=e,this.actionEvents=new Set,this.actionRegistry=new Set}return lt(t,[{key:"init",value:function(){var e,n=this;if(!Me((e=this.instance)===null||e===void 0?void 0:e._addCaptureHook)){var i;(i=this.instance)===null||i===void 0||i._addCaptureHook(function(r,s){n.on(r,s)})}}},{key:"register",value:function(e){var n,i,r=this;if(!Me((n=this.instance)===null||n===void 0?void 0:n._addCaptureHook)&&(e.forEach(function(a){var l,u;(l=r.actionRegistry)===null||l===void 0||l.add(a),(u=a.steps)===null||u===void 0||u.forEach(function(c){var d;(d=r.actionEvents)===null||d===void 0||d.add((c==null?void 0:c.event)||"")})}),(i=this.instance)!==null&&i!==void 0&&i.autocapture)){var s,o=new Set;e.forEach(function(a){var l;(l=a.steps)===null||l===void 0||l.forEach(function(u){u!=null&&u.selector&&o.add(u==null?void 0:u.selector)})}),(s=this.instance)===null||s===void 0||s.autocapture.setElementSelectors(o)}}},{key:"on",value:function(e,n){var i,r=this;n!=null&&e.length!=0&&(this.actionEvents.has(e)||this.actionEvents.has(n==null?void 0:n.event))&&this.actionRegistry&&((i=this.actionRegistry)===null||i===void 0?void 0:i.size)>0&&this.actionRegistry.forEach(function(s){r.checkAction(n,s)&&r._debugEventEmitter.emit("actionCaptured",s.name)})}},{key:"_addActionHook",value:function(e){this.onAction("actionCaptured",function(n){return e(n)})}},{key:"checkAction",value:function(e,n){if((n==null?void 0:n.steps)==null)return!1;var i,r=Ar(n.steps);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(this.checkStep(e,s))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"onAction",value:function(e,n){return this._debugEventEmitter.on(e,n)}},{key:"checkStepUrl",value:function(e,n){if(n!=null&&n.url){var i,r=e==null||(i=e.properties)===null||i===void 0?void 0:i.$current_url;if(!r||typeof r!="string"||!t.matchString(r,n==null?void 0:n.url,(n==null?void 0:n.url_matching)||"contains"))return!1}return!0}},{key:"checkStepElement",value:function(e,n){if((n!=null&&n.href||n!=null&&n.tag_name||n!=null&&n.text)&&!this.getElementsList(e).some(function(s){return!(n!=null&&n.href&&!t.matchString(s.href||"",n==null?void 0:n.href,(n==null?void 0:n.href_matching)||"exact"))&&(n==null||!n.tag_name||s.tag_name===(n==null?void 0:n.tag_name))&&!(n!=null&&n.text&&!t.matchString(s.text||"",n==null?void 0:n.text,(n==null?void 0:n.text_matching)||"exact")&&!t.matchString(s.$el_text||"",n==null?void 0:n.text,(n==null?void 0:n.text_matching)||"exact"))}))return!1;if(n!=null&&n.selector){var i,r=e==null||(i=e.properties)===null||i===void 0?void 0:i.$element_selectors;if(!r||!r.includes(n==null?void 0:n.selector))return!1}return!0}},{key:"getElementsList",value:function(e){return(e==null?void 0:e.properties.$elements)==null?[]:e==null?void 0:e.properties.$elements}}],[{key:"matchString",value:function(e,n,i){switch(i){case"regex":return!!V&&bg(e,n);case"exact":return n===e;case"contains":var r=t.escapeStringRegexp(n).replace(/_/g,".").replace(/%/g,".*");return bg(e,r);default:return!1}}},{key:"escapeStringRegexp",value:function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}}]),t}(),Ib=function(){function t(e){at(this,t),this.instance=e,this.eventToSurveys=new Map,this.actionToSurveys=new Map}return lt(t,[{key:"register",value:function(e){var n;Me((n=this.instance)===null||n===void 0?void 0:n._addCaptureHook)||(this.setupEventBasedSurveys(e),this.setupActionBasedSurveys(e))}},{key:"setupActionBasedSurveys",value:function(e){var n=this,i=e.filter(function(r){var s,o,a,l;return((s=r.conditions)===null||s===void 0?void 0:s.actions)&&((o=r.conditions)===null||o===void 0||(a=o.actions)===null||a===void 0||(l=a.values)===null||l===void 0?void 0:l.length)>0});i.length!==0&&(this.actionMatcher==null&&(this.actionMatcher=new D5(this.instance),this.actionMatcher.init(),this.actionMatcher._addActionHook(function(r){n.onAction(r)})),i.forEach(function(r){var s,o,a,l,u,c,d,h,f,p;r.conditions&&(s=r.conditions)!==null&&s!==void 0&&s.actions&&(o=r.conditions)!==null&&o!==void 0&&(a=o.actions)!==null&&a!==void 0&&a.values&&((l=r.conditions)===null||l===void 0||(u=l.actions)===null||u===void 0||(c=u.values)===null||c===void 0?void 0:c.length)>0&&((d=n.actionMatcher)===null||d===void 0||d.register(r.conditions.actions.values),(h=r.conditions)===null||h===void 0||(f=h.actions)===null||f===void 0||(p=f.values)===null||p===void 0||p.forEach(function(m){if(m&&m.name){var w=n.actionToSurveys.get(m.name);w&&w.push(r.id),n.actionToSurveys.set(m.name,w||[r.id])}}))}))}},{key:"setupEventBasedSurveys",value:function(e){var n,i=this;e.filter(function(r){var s,o,a,l;return((s=r.conditions)===null||s===void 0?void 0:s.events)&&((o=r.conditions)===null||o===void 0||(a=o.events)===null||a===void 0||(l=a.values)===null||l===void 0?void 0:l.length)>0}).length!==0&&((n=this.instance)===null||n===void 0||n._addCaptureHook(function(r){i.onEvent(r)}),e.forEach(function(r){var s,o,a;(s=r.conditions)===null||s===void 0||(o=s.events)===null||o===void 0||(a=o.values)===null||a===void 0||a.forEach(function(l){if(l&&l.name){var u=i.eventToSurveys.get(l.name);u&&u.push(r.id),i.eventToSurveys.set(l.name,u||[r.id])}})}))}},{key:"onEvent",value:function(e,n){var i,r,s=((i=this.instance)===null||i===void 0||(r=i.persistence)===null||r===void 0?void 0:r.props[vp])||[];if(t.SURVEY_SHOWN_EVENT_NAME==e&&n&&s.length>0){var o,a=n==null||(o=n.properties)===null||o===void 0?void 0:o.$survey_id;if(a){var l=s.indexOf(a);l>=0&&(s.splice(l,1),this._updateActivatedSurveys(s))}}else this.eventToSurveys.has(e)&&this._updateActivatedSurveys(s.concat(this.eventToSurveys.get(e)||[]))}},{key:"onAction",value:function(e){var n,i,r=((n=this.instance)===null||n===void 0||(i=n.persistence)===null||i===void 0?void 0:i.props[vp])||[];this.actionToSurveys.has(e)&&this._updateActivatedSurveys(r.concat(this.actionToSurveys.get(e)||[]))}},{key:"_updateActivatedSurveys",value:function(e){var n,i;(n=this.instance)===null||n===void 0||(i=n.persistence)===null||i===void 0||i.register(X({},vp,yo(new Set(e))))}},{key:"getSurveys",value:function(){var e,n,i=(e=this.instance)===null||e===void 0||(n=e.persistence)===null||n===void 0?void 0:n.props[vp];return i||[]}},{key:"getEventToSurveys",value:function(){return this.eventToSurveys}},{key:"_getActionMatcher",value:function(){return this.actionMatcher}}]),t}();X(Ib,"SURVEY_SHOWN_EVENT_NAME","survey shown");var w0="[Surveys]",L5={icontains:function(t){return!!V&&V.location.href.toLowerCase().indexOf(t.toLowerCase())>-1},not_icontains:function(t){return!!V&&V.location.href.toLowerCase().indexOf(t.toLowerCase())===-1},regex:function(t){return!!V&&bg(V.location.href,t)},not_regex:function(t){return!!V&&!bg(V.location.href,t)},exact:function(t){return(V==null?void 0:V.location.href)===t},is_not:function(t){return(V==null?void 0:V.location.href)!==t}},j5=function(){function t(e){at(this,t),this.instance=e,this._surveyEventReceiver=null}return lt(t,[{key:"afterDecideResponse",value:function(e){this._decideServerResponse=!!e.surveys,this.loadIfEnabled()}},{key:"loadIfEnabled",value:function(){var e=this,n=Vt==null?void 0:Vt.extendPostHogWithSurveys;this.instance.config.disable_surveys||!this._decideServerResponse||n||(this._surveyEventReceiver==null&&(this._surveyEventReceiver=new Ib(this.instance)),this.instance.requestRouter.loadScript("/static/surveys.js",function(i){if(i)return re.error(w0,"Could not load surveys script",i);Vt.extendPostHogWithSurveys(e.instance)}))}},{key:"getSurveys",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(this.instance.config.disable_surveys)return e([]);this._surveyEventReceiver==null&&(this._surveyEventReceiver=new Ib(this.instance));var r=this.instance.get_property(gb);if(r&&!i)return e(r);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/surveys/?token=".concat(this.instance.config.token)),method:"GET",transport:"XHR",callback:function(s){var o;if(s.statusCode!==200||!s.json)return e([]);var a,l=s.json.surveys||[],u=l.filter(function(c){var d,h,f,p,m,w,v,y,b,k,_,E;return((d=c.conditions)===null||d===void 0?void 0:d.events)&&((h=c.conditions)===null||h===void 0||(f=h.events)===null||f===void 0?void 0:f.values)&&((p=c.conditions)===null||p===void 0||(m=p.events)===null||m===void 0||(w=m.values)===null||w===void 0?void 0:w.length)>0||((v=c.conditions)===null||v===void 0?void 0:v.actions)&&((y=c.conditions)===null||y===void 0||(b=y.actions)===null||b===void 0?void 0:b.values)&&((k=c.conditions)===null||k===void 0||(_=k.actions)===null||_===void 0||(E=_.values)===null||E===void 0?void 0:E.length)>0});return u.length>0&&((a=n._surveyEventReceiver)===null||a===void 0||a.register(u)),(o=n.instance.persistence)===null||o===void 0||o.register(X({},gb,l)),e(l)}})}},{key:"getActiveMatchingSurveys",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.getSurveys(function(r){var s,o=r.filter(function(u){return!(!u.start_date||u.end_date)}).filter(function(u){var c,d,h,f;if(!u.conditions)return!0;var p=(c=u.conditions)===null||c===void 0||!c.url||L5[(d=(h=u.conditions)===null||h===void 0?void 0:h.urlMatchType)!==null&&d!==void 0?d:"icontains"](u.conditions.url),m=(f=u.conditions)===null||f===void 0||!f.selector||(Ee==null?void 0:Ee.querySelector(u.conditions.selector));return p&&m}),a=(s=n._surveyEventReceiver)===null||s===void 0?void 0:s.getSurveys(),l=o.filter(function(u){var c,d,h,f,p,m,w,v,y,b;if(!u.linked_flag_key&&!u.targeting_flag_key&&!u.internal_targeting_flag_key)return!0;var k=!u.linked_flag_key||n.instance.featureFlags.isFeatureEnabled(u.linked_flag_key),_=!u.targeting_flag_key||n.instance.featureFlags.isFeatureEnabled(u.targeting_flag_key),E=((c=u.conditions)===null||c===void 0?void 0:c.events)&&((d=u.conditions)===null||d===void 0||(h=d.events)===null||h===void 0?void 0:h.values)&&((f=u.conditions)===null||f===void 0||(p=f.events)===null||p===void 0?void 0:p.values.length)>0,A=((m=u.conditions)===null||m===void 0?void 0:m.actions)&&((w=u.conditions)===null||w===void 0||(v=w.actions)===null||v===void 0?void 0:v.values)&&((y=u.conditions)===null||y===void 0||(b=y.actions)===null||b===void 0?void 0:b.values.length)>0,P=!E&&!A||(a==null?void 0:a.includes(u.id)),I=n._canActivateRepeatedly(u),D=!(u.internal_targeting_flag_key&&!I)||n.instance.featureFlags.isFeatureEnabled(u.internal_targeting_flag_key);return k&&_&&D&&P});return e(l)},i)}},{key:"getNextSurveyStep",value:function(e,n,i){var r,s=e.questions[n],o=n+1;if((r=s.branching)===null||r===void 0||!r.type)return n===e.questions.length-1?Ir.End:o;if(s.branching.type===Ir.End)return Ir.End;if(s.branching.type===Ir.SpecificQuestion){if(Number.isInteger(s.branching.index))return s.branching.index}else if(s.branching.type===Ir.ResponseBased){if(s.type===Ag.SingleChoice){var a,l,u=s.choices.indexOf("".concat(i));if((a=s.branching)!==null&&a!==void 0&&(l=a.responseValues)!==null&&l!==void 0&&l.hasOwnProperty(u)){var c=s.branching.responseValues[u];return Number.isInteger(c)?c:c===Ir.End?Ir.End:o}}else if(s.type===Ag.Rating){var d,h;if(typeof i!="number"||!Number.isInteger(i))throw new Error("The response type must be an integer");var f=function(m,w){if(w===3){if(m<1||m>3)throw new Error("The response must be in range 1-3");return m===1?"negative":m===2?"neutral":"positive"}if(w===5){if(m<1||m>5)throw new Error("The response must be in range 1-5");return m<=2?"negative":m===3?"neutral":"positive"}if(w===10){if(m<0||m>10)throw new Error("The response must be in range 0-10");return m<=6?"detractors":m<=8?"passives":"promoters"}throw new Error("The scale must be one of: 3, 5, 10")}(i,s.scale);if((d=s.branching)!==null&&d!==void 0&&(h=d.responseValues)!==null&&h!==void 0&&h.hasOwnProperty(f)){var p=s.branching.responseValues[f];return Number.isInteger(p)?p:p===Ir.End?Ir.End:o}}return o}return re.warn(w0,"Falling back to next question index due to unexpected branching type"),o}},{key:"_canActivateRepeatedly",value:function(e){return yr(Vt.__PosthogExtensions__.canActivateRepeatedly)&&re.warn(w0,"canActivateRepeatedly is not defined, must init before calling"),Vt.__PosthogExtensions__.canActivateRepeatedly(e)}}]),t}(),F5=function(){function t(e){var n,i,r=this;at(this,t),X(this,"serverLimits",{}),X(this,"lastEventRateLimited",!1),X(this,"checkForLimiting",function(s){var o=s.text;if(o&&o.length)try{(JSON.parse(o).quota_limited||[]).forEach(function(a){re.info("[RateLimiter] ".concat(a||"events"," is quota limited.")),r.serverLimits[a]=new Date().getTime()+6e4})}catch(a){return void re.warn('[RateLimiter] could not rate limit - continuing. Error: "'.concat(a==null?void 0:a.message,'"'),{text:o})}}),this.instance=e,this.captureEventsPerSecond=((n=e.config.rate_limiting)===null||n===void 0?void 0:n.events_per_second)||10,this.captureEventsBurstLimit=Math.max(((i=e.config.rate_limiting)===null||i===void 0?void 0:i.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}return lt(t,[{key:"clientRateLimitContext",value:function(){var e,n,i,r=arguments.length>0&&arguments[0]!==void 0&&arguments[0],s=new Date().getTime(),o=(e=(n=this.instance.persistence)===null||n===void 0?void 0:n.get_property(yb))!==null&&e!==void 0?e:{tokens:this.captureEventsBurstLimit,last:s};o.tokens+=(s-o.last)/1e3*this.captureEventsPerSecond,o.last=s,o.tokens>this.captureEventsBurstLimit&&(o.tokens=this.captureEventsBurstLimit);var a=o.tokens<1;return a||r||(o.tokens=Math.max(0,o.tokens-1)),!a||this.lastEventRateLimited||r||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to ".concat(this.captureEventsPerSecond," events per second and ").concat(this.captureEventsBurstLimit," events burst limit.")},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=a,(i=this.instance.persistence)===null||i===void 0||i.set_property(yb,o),{isRateLimited:a,remainingTokens:o.tokens}}},{key:"isServerRateLimited",value:function(e){var n=this.serverLimits[e||"events"]||!1;return n!==!1&&new Date().getTime()<n}}]),t}(),B5=function(){return ke({initialPathName:(vi==null?void 0:vi.pathname)||"",referringDomain:dn.referringDomain()},dn.campaignParams())},$5=function(){function t(e,n,i){var r=this;at(this,t),X(this,"_onSessionIdCallback",function(s){var o=r._getStoredProps();if(!o||o.sessionId!==s){var a={sessionId:s,props:r._sessionSourceParamGenerator()};r._persistence.register(X({},vb,a))}}),this._sessionIdManager=e,this._persistence=n,this._sessionSourceParamGenerator=i||B5,this._sessionIdManager.onSessionId(this._onSessionIdCallback)}return lt(t,[{key:"_getStoredProps",value:function(){return this._persistence.props[vb]}},{key:"getSessionProps",value:function(){var e,n=(e=this._getStoredProps())===null||e===void 0?void 0:e.props;return n?{$client_session_initial_referring_host:n.referringDomain,$client_session_initial_pathname:n.initialPathName,$client_session_initial_utm_source:n.utm_source,$client_session_initial_utm_campaign:n.utm_campaign,$client_session_initial_utm_medium:n.utm_medium,$client_session_initial_utm_content:n.utm_content,$client_session_initial_utm_term:n.utm_term}:{}}}]),t}(),z5=["ahrefsbot","ahrefssiteaudit","applebot","baiduspider","bingbot","bingpreview","bot.htm","bot.php","crawler","deepscan","duckduckbot","facebookexternal","facebookcatalog","gptbot","http://yandex.com/bots","hubspot","ia_archiver","linkedinbot","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","semrushbot","sitebulb","slurp","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","Google-HotelAdsVerifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleweblight","mediapartners-google","storebot-google","Bytespider;"],bE=function(t,e){if(!t)return!1;var n=t.toLowerCase();return z5.concat(e||[]).some(function(i){var r=i.toLowerCase();return n.indexOf(r)!==-1})},hM=function(){function t(){at(this,t),this.clicks=[]}return lt(t,[{key:"isRageClick",value:function(e,n,i){var r=this.clicks[this.clicks.length-1];if(r&&Math.abs(e-r.x)+Math.abs(n-r.y)<30&&i-r.timestamp<1e3){if(this.clicks.push({x:e,y:n,timestamp:i}),this.clicks.length===3)return!0}else this.clicks=[{x:e,y:n,timestamp:i}];return!1}}]),t}();function xE(t){var e;return t.id===xb||!((e=t.closest)===null||e===void 0||!e.call(t,"#"+xb))}var U5=function(){function t(e){var n,i=this;at(this,t),X(this,"rageclicks",new hM),X(this,"_enabledServerSide",!1),X(this,"_initialized",!1),X(this,"_flushInterval",null),this.instance=e,this._enabledServerSide=!((n=this.instance.persistence)===null||n===void 0||!n.props[fb]),V==null||V.addEventListener("beforeunload",function(){i.flush()})}return lt(t,[{key:"flushIntervalMilliseconds",get:function(){var e=5e3;return En(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}},{key:"isEnabled",get:function(){return Me(this.instance.config.capture_heatmaps)?Me(this.instance.config.enable_heatmaps)?this._enabledServerSide:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}},{key:"startIfEnabled",value:function(){if(this.isEnabled){if(this._initialized)return;re.info("[heatmaps] starting..."),this._setupListeners(),this._flushInterval=setInterval(this.flush.bind(this),this.flushIntervalMilliseconds)}else{var e;clearInterval((e=this._flushInterval)!==null&&e!==void 0?e:void 0),this.getAndClearBuffer()}}},{key:"afterDecideResponse",value:function(e){var n=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register(X({},fb,n)),this._enabledServerSide=n,this.startIfEnabled()}},{key:"getAndClearBuffer",value:function(){var e=this.buffer;return this.buffer=void 0,e}},{key:"_setupListeners",value:function(){var e=this;V&&Ee&&(po(Ee,"click",function(n){return e._onClick(n||(V==null?void 0:V.event))},!1,!0),po(Ee,"mousemove",function(n){return e._onMouseMove(n||(V==null?void 0:V.event))},!1,!0),this._initialized=!0)}},{key:"_getProperties",value:function(e,n){var i=this.instance.scrollManager.scrollY(),r=this.instance.scrollManager.scrollX(),s=this.instance.scrollManager.scrollElement(),o=function(a,l,u){for(var c=a;c&&!ka(c,"body");){if(c===u)return!1;if(Ye(l,V==null?void 0:V.getComputedStyle(c).position))return!0;c=QN(c)}return!1}(e.target,["fixed","sticky"],s);return{x:e.clientX+(o?0:r),y:e.clientY+(o?0:i),target_fixed:o,type:n}}},{key:"_onClick",value:function(e){var n;if(!xE(e.target)){var i=this._getProperties(e,"click");(n=this.rageclicks)!==null&&n!==void 0&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this._capture(ke(ke({},i),{},{type:"rageclick"})),this._capture(i)}}},{key:"_onMouseMove",value:function(e){var n=this;xE(e.target)||(clearTimeout(this._mouseMoveTimeout),this._mouseMoveTimeout=setTimeout(function(){n._capture(n._getProperties(e,"mousemove"))},500))}},{key:"_capture",value:function(e){if(V){var n=V.location.href;this.buffer=this.buffer||{},this.buffer[n]||(this.buffer[n]=[]),this.buffer[n].push(e)}}},{key:"flush",value:function(){this.buffer&&!Im(this.buffer)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}]),t}(),V5=function(){function t(e){var n=this;at(this,t),X(this,"_updateScrollData",function(){var i,r,s,o;n.context||(n.context={});var a=n.scrollElement(),l=n.scrollY(),u=a?Math.max(0,a.scrollHeight-a.clientHeight):0,c=l+((a==null?void 0:a.clientHeight)||0),d=(a==null?void 0:a.scrollHeight)||0;n.context.lastScrollY=Math.ceil(l),n.context.maxScrollY=Math.max(l,(i=n.context.maxScrollY)!==null&&i!==void 0?i:0),n.context.maxScrollHeight=Math.max(u,(r=n.context.maxScrollHeight)!==null&&r!==void 0?r:0),n.context.lastContentY=c,n.context.maxContentY=Math.max(c,(s=n.context.maxContentY)!==null&&s!==void 0?s:0),n.context.maxContentHeight=Math.max(d,(o=n.context.maxContentHeight)!==null&&o!==void 0?o:0)}),this.instance=e}return lt(t,[{key:"getContext",value:function(){return this.context}},{key:"resetContext",value:function(){var e=this.context;return setTimeout(this._updateScrollData,0),e}},{key:"startMeasuringScrollPosition",value:function(){V==null||V.addEventListener("scroll",this._updateScrollData,!0),V==null||V.addEventListener("scrollend",this._updateScrollData,!0),V==null||V.addEventListener("resize",this._updateScrollData)}},{key:"scrollElement",value:function(){if(!this.instance.config.scroll_root_selector)return V==null?void 0:V.document.documentElement;var e,n=Ar(on(this.instance.config.scroll_root_selector)?this.instance.config.scroll_root_selector:[this.instance.config.scroll_root_selector]);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=V==null?void 0:V.document.querySelector(i);if(r)return r}}catch(s){n.e(s)}finally{n.f()}}},{key:"scrollY",value:function(){if(this.instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return V&&(V.scrollY||V.pageYOffset||V.document.documentElement.scrollTop)||0}},{key:"scrollX",value:function(){if(this.instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return V&&(V.scrollX||V.pageXOffset||V.document.documentElement.scrollLeft)||0}}]),t}(),b0="$copy_autocapture";function x0(t,e){return e.length>t?e.slice(0,t)+"...":e}var Xo,H5=function(){function t(e){at(this,t),X(this,"_initialized",!1),X(this,"_isDisabledServerSide",null),X(this,"rageclicks",new hM),X(this,"_elementsChainAsString",!1),this.instance=e,this._elementSelectors=null}return lt(t,[{key:"config",get:function(){var e,n,i=En(this.instance.config.autocapture)?this.instance.config.autocapture:{};return i.url_allowlist=(e=i.url_allowlist)===null||e===void 0?void 0:e.map(function(r){return new RegExp(r)}),i.url_ignorelist=(n=i.url_ignorelist)===null||n===void 0?void 0:n.map(function(r){return new RegExp(r)}),i}},{key:"_addDomEventHandlers",value:function(){var e=this;if(this.isBrowserSupported()){if(V&&Ee){var n=function(r){r=r||(V==null?void 0:V.event);try{e._captureEvent(r)}catch(s){re.error("Failed to capture event",s)}},i=function(r){r=r||(V==null?void 0:V.event),e._captureEvent(r,b0)};po(Ee,"submit",n,!1,!0),po(Ee,"change",n,!1,!0),po(Ee,"click",n,!1,!0),this.config.capture_copied_text&&(po(Ee,"copy",i,!1,!0),po(Ee,"cut",i,!1,!0))}}else re.info("Disabling Automatic Event Collection because this browser is not supported")}},{key:"startIfEnabled",value:function(){this.isEnabled&&!this._initialized&&(this._addDomEventHandlers(),this._initialized=!0)}},{key:"afterDecideResponse",value:function(e){e.elementsChainAsString&&(this._elementsChainAsString=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register(X({},zC,!!e.autocapture_opt_out)),this._isDisabledServerSide=!!e.autocapture_opt_out,this.startIfEnabled()}},{key:"setElementSelectors",value:function(e){this._elementSelectors=e}},{key:"getElementSelectors",value:function(e){var n,i=[];return(n=this._elementSelectors)===null||n===void 0||n.forEach(function(r){var s=Ee==null?void 0:Ee.querySelectorAll(r);s==null||s.forEach(function(o){e===o&&i.push(r)})}),i}},{key:"isEnabled",get:function(){var e,n,i=(e=this.instance.persistence)===null||e===void 0?void 0:e.props[zC],r=this._isDisabledServerSide;if(Io(r)&&!Pu(i)&&!this.instance.config.advanced_disable_decide)return!1;var s=(n=this._isDisabledServerSide)!==null&&n!==void 0?n:!!i;return!!this.instance.config.autocapture&&!s}},{key:"_previousElementSibling",value:function(e){if(e.previousElementSibling)return e.previousElementSibling;var n=e;do n=n.previousSibling;while(n&&!bS(n));return n}},{key:"_getAugmentPropertiesFromElement",value:function(e){if(!Pb(e))return{};var n={};return wt(e.attributes,function(i){if(i.name&&i.name.indexOf("data-ph-capture-attribute")===0){var r=i.name.replace("data-ph-capture-attribute-",""),s=i.value;r&&s&&Ju(s)&&(n[r]=s)}}),n}},{key:"_getPropertiesFromElement",value:function(e,n,i){var r,s=e.tagName.toLowerCase(),o={tag_name:s};Ab.indexOf(s)>-1&&!i&&(s.toLowerCase()==="a"||s.toLowerCase()==="button"?o.$el_text=x0(1024,aE(e)):o.$el_text=x0(1024,_g(e)));var a=kg(e);a.length>0&&(o.classes=a.filter(function(h){return h!==""}));var l=(r=this.config)===null||r===void 0?void 0:r.element_attribute_ignorelist;wt(e.attributes,function(h){var f;if((!eM(e)||["name","id","class","aria-label"].indexOf(h.name)!==-1)&&(l==null||!l.includes(h.name))&&!n&&Ju(h.value)&&(f=h.name,!Un(f)||f.substring(0,10)!=="_ngcontent"&&f.substring(0,7)!=="_nghost")){var p=h.value;h.name==="class"&&(p=wS(p).join(" ")),o["attr__"+h.name]=x0(1024,p)}});for(var u=1,c=1,d=e;d=this._previousElementSibling(d);)u++,d.tagName===e.tagName&&c++;return o.nth_child=u,o.nth_of_type=c,o}},{key:"_getDefaultProperties",value:function(e){return{$event_type:e,$ce_version:1}}},{key:"_getEventTarget",value:function(e){return Me(e.target)?e.srcElement||null:(n=e.target)!==null&&n!==void 0&&n.shadowRoot?e.composedPath()[0]||null:e.target||null;var n}},{key:"_captureEvent",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"$autocapture";if(this.isEnabled){var r,s=this._getEventTarget(e);JN(s)&&(s=s.parentNode||null),i==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(r=this.rageclicks)!==null&&r!==void 0&&r.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this._captureEvent(e,"$rageclick");var o=i===b0;if(s&&Z4(s,e,this.config,o,o?["copy","cut"]:void 0)){for(var a,l,u=[s],c=s;c.parentNode&&!ka(c,"body");)ZN(c.parentNode)?(u.push(c.parentNode.host),c=c.parentNode.host):(u.push(c.parentNode),c=c.parentNode);var d,h,f=[],p={},m=!1;if(wt(u,function(I){var D=Pb(I);I.tagName.toLowerCase()==="a"&&(d=I.getAttribute("href"),d=D&&Ju(d)&&d),Ye(kg(I),"ph-no-capture")&&(m=!0),f.push(n._getPropertiesFromElement(I,n.instance.config.mask_all_element_attributes,n.instance.config.mask_all_text));var B=n._getAugmentPropertiesFromElement(I);Qn(p,B)}),this.instance.config.mask_all_text||(s.tagName.toLowerCase()==="a"||s.tagName.toLowerCase()==="button"?f[0].$el_text=aE(s):f[0].$el_text=_g(s)),d){var w,v;f[0].attr__href=d;var y=(w=nh(d))===null||w===void 0?void 0:w.host,b=V==null||(v=V.location)===null||v===void 0?void 0:v.host;y&&b&&y!==b&&(h=d)}if(m)return!1;var k=Qn(this._getDefaultProperties(e.type),this._elementsChainAsString?{$elements_chain:i5(f)}:{$elements:f},(a=f[0])!==null&&a!==void 0&&a.$el_text?{$el_text:(l=f[0])===null||l===void 0?void 0:l.$el_text}:{},h&&e.type==="click"?{$external_click_url:h}:{},p),_=this.getElementSelectors(s);if(_&&_.length>0&&(k.$element_selectors=_),i===b0){var E,A=YN(V==null||(E=V.getSelection())===null||E===void 0?void 0:E.toString()),P=e.type||"clipboard";if(!A)return!1;k.$selected_content=A,k.$copy_type=P}return this.instance.capture(i,k),!0}}}},{key:"isBrowserSupported",value:function(){return Yr(Ee==null?void 0:Ee.querySelectorAll)}}]),t}(),W5=function(){function t(e){var n=this;at(this,t),X(this,"_restoreXHRPatch",void 0),X(this,"_restoreFetchPatch",void 0),X(this,"_startCapturing",function(){Me(n._restoreXHRPatch)&&Vt.postHogTracingHeadersPatchFns._patchXHR(n.instance.sessionManager),Me(n._restoreFetchPatch)&&Vt.postHogTracingHeadersPatchFns._patchFetch(n.instance.sessionManager)}),this.instance=e}return lt(t,[{key:"_loadScript",value:function(e){Vt.postHogTracingHeadersPatchFns&&e(),this.instance.requestRouter.loadScript("/static/tracing-headers.js?v=".concat(Vr.LIB_VERSION),function(n){if(n)return re.error("[TRACING-HEADERS] failed to load script",n);e()})}},{key:"startIfEnabledOrStop",value:function(){var e,n;this.instance.config.__add_tracing_headers?this._loadScript(this._startCapturing):((e=this._restoreXHRPatch)===null||e===void 0||e.call(this),(n=this._restoreFetchPatch)===null||n===void 0||n.call(this),this._restoreXHRPatch=void 0,this._restoreFetchPatch=void 0)}}]),t}();(function(t){t[t.PENDING=-1]="PENDING",t[t.DENIED=0]="DENIED",t[t.GRANTED=1]="GRANTED"})(Xo||(Xo={}));var G5=function(){function t(e){at(this,t),this.instance=e}return lt(t,[{key:"config",get:function(){return this.instance.config}},{key:"consent",get:function(){return this.getDnt()?Xo.DENIED:this.storedConsent}},{key:"isOptedOut",value:function(){return this.consent===Xo.DENIED||this.consent===Xo.PENDING&&this.config.opt_out_capturing_by_default}},{key:"isOptedIn",value:function(){return!this.isOptedOut()}},{key:"optInOut",value:function(e){this.storage.set(this.storageKey,e?1:0,this.config.cookie_expiration,this.config.cross_subdomain_cookie,this.config.secure_cookie)}},{key:"reset",value:function(){this.storage.remove(this.storageKey,this.config.cross_subdomain_cookie)}},{key:"storageKey",get:function(){var e=this.instance.config,n=e.token;return(e.opt_out_capturing_cookie_prefix||"__ph_opt_in_out_")+n}},{key:"storedConsent",get:function(){var e=this.storage.get(this.storageKey);return e==="1"?Xo.GRANTED:e==="0"?Xo.DENIED:Xo.PENDING}},{key:"storage",get:function(){if(!this._storage){var e=this.config.opt_out_capturing_persistence_type;this._storage=e==="localStorage"?tn:wo;var n=e==="localStorage"?wo:tn;n.get(this.storageKey)&&(this._storage.get(this.storageKey)||this.optInOut(n.get(this.storageKey)==="1"),n.remove(this.storageKey,this.config.cross_subdomain_cookie))}return this._storage}},{key:"getDnt",value:function(){return!!this.config.respect_dnt&&!!MN([mo==null?void 0:mo.doNotTrack,mo==null?void 0:mo.msDoNotTrack,Vt.doNotTrack],function(e){return Ye([!0,1,"1","yes"],e)})}}]),t}(),SE=9e5,pl="[Web Vitals]",K5=function(){function t(e){var n,i=this;at(this,t),X(this,"_enabledServerSide",!1),X(this,"_initialized",!1),X(this,"buffer",{url:void 0,metrics:[],firstMetricTimestamp:void 0}),X(this,"_flushToCapture",function(){clearTimeout(i._delayedFlushTimer),i.buffer.metrics.length!==0&&(i.instance.capture("$web_vitals",i.buffer.metrics.reduce(function(r,s){var o;return ke(ke({},r),{},(X(o={},"$web_vitals_".concat(s.name,"_event"),ke({},s)),X(o,"$web_vitals_".concat(s.name,"_value"),s.value),o))},{})),i.buffer={url:void 0,metrics:[],firstMetricTimestamp:void 0})}),X(this,"_addToBuffer",function(r){var s,o=(s=i.instance.sessionManager)===null||s===void 0?void 0:s.checkAndGetSessionAndWindowId(!0);if(Me(o))re.error(pl+"Could not read session ID. Dropping metrics!");else{i.buffer=i.buffer||{};var a=i._currentURL();Me(a)||(yr(r==null?void 0:r.name)||yr(r==null?void 0:r.value)?re.error(pl+"Invalid metric received",r):i._maxAllowedValue&&r.value>=i._maxAllowedValue?re.error(pl+"Ignoring metric with value >= "+i._maxAllowedValue,r):(i.buffer.url!==a&&(i._flushToCapture(),i._delayedFlushTimer=setTimeout(i._flushToCapture,8e3)),Me(i.buffer.url)&&(i.buffer.url=a),i.buffer.firstMetricTimestamp=Me(i.buffer.firstMetricTimestamp)?Date.now():i.buffer.firstMetricTimestamp,i.buffer.metrics.push(ke(ke({},r),{},{$current_url:a,$session_id:o.sessionId,$window_id:o.windowId,timestamp:Date.now()})),i.buffer.metrics.length===4&&i._flushToCapture()))}}),X(this,"_startCapturing",function(){var r=Vt.postHogWebVitalsCallbacks,s=r.onLCP,o=r.onCLS,a=r.onFCP,l=r.onINP;s&&o&&a&&l?(s(i._addToBuffer),o(i._addToBuffer),a(i._addToBuffer),l(i._addToBuffer),i._initialized=!0):re.error(pl+"web vitals callbacks not loaded - not starting")}),this.instance=e,this._enabledServerSide=!((n=this.instance.persistence)===null||n===void 0||!n.props[HC]),this.startIfEnabled()}return lt(t,[{key:"_maxAllowedValue",get:function(){var e=En(this.instance.config.capture_performance)&&ur(this.instance.config.capture_performance.__web_vitals_max_value)?this.instance.config.capture_performance.__web_vitals_max_value:SE;return 0<e&&e<=6e4?SE:e}},{key:"isEnabled",get:function(){var e=En(this.instance.config.capture_performance)?this.instance.config.capture_performance.web_vitals:void 0;return Pu(e)?e:this._enabledServerSide}},{key:"startIfEnabled",value:function(){this.isEnabled&&!this._initialized&&(re.info(pl+" enabled, starting..."),this.loadScript(this._startCapturing))}},{key:"afterDecideResponse",value:function(e){var n=En(e.capturePerformance)&&!!e.capturePerformance.web_vitals;this.instance.persistence&&this.instance.persistence.register(X({},HC,n)),this._enabledServerSide=n,this.startIfEnabled()}},{key:"loadScript",value:function(e){V.postHogWebVitalsCallbacks&&e(),this.instance.requestRouter.loadScript(this.instance.requestRouter.endpointFor("assets","/static/web-vitals.js?v=".concat(Vr.LIB_VERSION)),function(n){n?re.error(pl+" failed to load script",n):e()})}},{key:"_currentURL",value:function(){var e=V?V.location.href:void 0;return e||re.error(pl+"Could not determine current URL"),e}}]),t}(),sh={},kE=function(){},xu="posthog",fM=!C5&&(Ht==null?void 0:Ht.indexOf("MSIE"))===-1&&(Ht==null?void 0:Ht.indexOf("Mozilla"))===-1,_E=function(){var t,e,n;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:(e=Ee==null?void 0:Ee.location,n=e==null?void 0:e.hostname,!!Un(n)&&n.split(".").slice(-2).join(".")!=="herokuapp.com"),persistence:"localStorage+cookie",persistence_name:"",loaded:kE,store_google:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:!0,capture_pageleave:"if_capture_pageview",debug:vi&&Un(vi==null?void 0:vi.search)&&vi.search.indexOf("__posthog_debug=true")!==-1||!1,verbose:!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_surveys:!1,enable_recording_console_log:void 0,secure_cookie:(V==null||(t=V.location)===null||t===void 0?void 0:t.protocol)==="https:",ip:!0,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},inapp_protocol:"//",inapp_link_new_window:!1,request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,on_request_error:function(i){var r="Bad HTTP status: "+i.statusCode+" "+i.text;re.error(r)},get_device_id:function(i){return i},_onCapture:kE,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"always",__add_tracing_headers:!1}},CE=function(t){var e={};Me(t.process_person)||(e.person_profiles=t.process_person),Me(t.xhr_headers)||(e.request_headers=t.xhr_headers),Me(t.cookie_name)||(e.persistence_name=t.cookie_name),Me(t.disable_cookie)||(e.disable_persistence=t.disable_cookie);var n=Qn({},e,t);return on(t.property_blacklist)&&(Me(t.property_denylist)?n.property_denylist=t.property_blacklist:on(t.property_denylist)?n.property_denylist=[].concat(yo(t.property_blacklist),yo(t.property_denylist)):re.error("Invalid value for property_denylist config: "+t.property_denylist)),n},X5=function(){function t(){at(this,t),X(this,"__forceAllowLocalhost",!1)}return lt(t,[{key:"_forceAllowLocalhost",get:function(){return this.__forceAllowLocalhost},set:function(e){re.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}]),t}(),pM=function(){function t(){var e=this;at(this,t),X(this,"webPerformance",new X5),X(this,"_internalEventEmitter",new dM),this.config=_E(),this.decideEndpointWasHit=!1,this.SentryIntegration=M5,this.sentryIntegration=function(n){return function(i,r){var s=cM(i,r);return{name:uM,processEvent:function(o){return s(o)}}}(e,n)},this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.featureFlags=new A4(this),this.toolbar=new m5(this),this.scrollManager=new V5(this),this.pageViewManager=new I5(this),this.surveys=new j5(this),this.rateLimiter=new F5(this),this.requestRouter=new R5(this),this.consent=new G5(this),this.people={set:function(n,i,r){var s=Un(n)?X({},n,i):n;e.setPersonProperties(s),r==null||r({})},set_once:function(n,i,r){var s=Un(n)?X({},n,i):n;e.setPersonProperties(void 0,s),r==null||r({})}},this.on("eventCaptured",function(n){return re.info("send",n)})}return lt(t,[{key:"init",value:function(e,n,i){if(i&&i!==xu){var r,s=(r=sh[i])!==null&&r!==void 0?r:new t;return s._init(e,n,i),sh[i]=s,sh[xu][i]=s,s}return this._init(e,n,i)}},{key:"_init",value:function(e){var n,i,r=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;if(Me(e)||DC(e))return re.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return re.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;if(this.__loaded=!0,this.config={},this._triggered_notifs=[],this.set_config(Qn({},_E(),CE(s),{name:o,token:e})),this.config.on_xhr_error&&re.error("[posthog] on_xhr_error is deprecated. Use on_request_error instead"),this.compression=s.disable_compression?void 0:Hr.Base64,this.persistence=new m0(this.config),this.sessionPersistence=this.config.persistence==="sessionStorage"?this.persistence:new m0(ke(ke({},this.config),{},{persistence:"sessionStorage"})),this._requestQueue=new g5(function(w){return r._send_retriable_request(w)}),this._retryQueue=new P5(this),this.__request_queue=[],this.sessionManager=new T5(this.config,this.persistence),this.sessionPropsManager=new $5(this.sessionManager,this.persistence),new W5(this).startIfEnabledOrStop(),this.sessionRecording=new h5(this),this.sessionRecording.startIfEnabledOrStop(),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new H5(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new U5(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new K5(this),this.exceptionObserver=new N5(this),this.exceptionObserver.startIfEnabled(),Vr.DEBUG=Vr.DEBUG||this.config.debug,Vr.DEBUG&&console.log("[PostHog.js] Starting in debug mode",this),this._sync_opt_out_with_persistence(),((n=s.bootstrap)===null||n===void 0?void 0:n.distinctID)!==void 0){var a,l,u=this.config.get_device_id(ca()),c=(a=s.bootstrap)!==null&&a!==void 0&&a.isIdentifiedID?u:s.bootstrap.distinctID;this.persistence.set_property(qs,(l=s.bootstrap)!==null&&l!==void 0&&l.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:s.bootstrap.distinctID,$device_id:c})}if(this._hasBootstrappedFeatureFlags()){var d,h,f=Object.keys(((d=s.bootstrap)===null||d===void 0?void 0:d.featureFlags)||{}).filter(function(w){var v,y;return!((v=s.bootstrap)===null||v===void 0||(y=v.featureFlags)===null||y===void 0||!y[w])}).reduce(function(w,v){var y,b;return w[v]=((y=s.bootstrap)===null||y===void 0||(b=y.featureFlags)===null||b===void 0?void 0:b[v])||!1,w},{}),p=Object.keys(((h=s.bootstrap)===null||h===void 0?void 0:h.featureFlagPayloads)||{}).filter(function(w){return f[w]}).reduce(function(w,v){var y,b,k,_;return(y=s.bootstrap)!==null&&y!==void 0&&(b=y.featureFlagPayloads)!==null&&b!==void 0&&b[v]&&(w[v]=(k=s.bootstrap)===null||k===void 0||(_=k.featureFlagPayloads)===null||_===void 0?void 0:_[v]),w},{});this.featureFlags.receivedFeatureFlags({featureFlags:f,featureFlagPayloads:p})}if(!this.get_distinct_id()){var m=this.config.get_device_id(ca());this.register_once({distinct_id:m,$device_id:m},""),this.persistence.set_property(qs,"anonymous")}return V==null||(i=V.addEventListener)===null||i===void 0||i.call(V,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this)),this.toolbar.maybeLoadToolbar(),s.segment?O5(this,function(){return r._loaded()}):this._loaded(),Yr(this.config._onCapture)&&this.on("eventCaptured",function(w){return r.config._onCapture(w.event,w)}),this}},{key:"_afterDecideResponse",value:function(e){var n,i,r,s,o,a,l;this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=Ye(e.supportedCompression,Hr.GZipJS)?Hr.GZipJS:Ye(e.supportedCompression,Hr.Base64)?Hr.Base64:void 0),(n=e.analytics)!==null&&n!==void 0&&n.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),(i=this.sessionRecording)===null||i===void 0||i.afterDecideResponse(e),(r=this.autocapture)===null||r===void 0||r.afterDecideResponse(e),(s=this.heatmaps)===null||s===void 0||s.afterDecideResponse(e),(o=this.surveys)===null||o===void 0||o.afterDecideResponse(e),(a=this.webVitalsAutocapture)===null||a===void 0||a.afterDecideResponse(e),(l=this.exceptionObserver)===null||l===void 0||l.afterDecideResponse(e)}},{key:"_loaded",value:function(){var e=this,n=this.config.advanced_disable_decide;n||this.featureFlags.setReloadingPaused(!0);try{this.config.loaded(this)}catch(i){re.critical("`loaded` function failed",i)}this._start_queue_if_opted_in(),this.config.capture_pageview&&setTimeout(function(){Ee&&e.capture("$pageview",{title:Ee.title},{send_instantly:!0})},1),n||(new f5(this).call(),this.featureFlags.resetRequestQueue())}},{key:"_start_queue_if_opted_in",value:function(){var e;this.has_opted_out_capturing()||this.config.request_batching&&((e=this._requestQueue)===null||e===void 0||e.enable())}},{key:"_dom_loaded",value:function(){var e=this;this.has_opted_out_capturing()||Xu(this.__request_queue,function(n){return e._send_retriable_request(n)}),this.__request_queue=[],this._start_queue_if_opted_in()}},{key:"_handle_unload",value:function(){var e,n;this.config.request_batching?(this._shouldCapturePageleave()&&this.capture("$pageleave"),(e=this._requestQueue)===null||e===void 0||e.unload(),(n=this._retryQueue)===null||n===void 0||n.unload()):this._shouldCapturePageleave()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}},{key:"_send_request",value:function(e){var n=this;this.__loaded&&(fM?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=Eg(e.url,{ip:this.config.ip?1:0}),e.headers=this.config.request_headers,e.compression=e.compression==="best-available"?this.compression:e.compression,function(i){var r,s,o,a=ke({},i);a.timeout=a.timeout||6e4,a.url=Eg(a.url,{_:new Date().getTime().toString(),ver:Vr.LIB_VERSION,compression:a.compression});var l=(r=a.transport)!==null&&r!==void 0?r:"XHR",u=(s=(o=MN(rh,function(c){return c.transport===l}))===null||o===void 0?void 0:o.method)!==null&&s!==void 0?s:rh[0].method;if(!u)throw new Error("No available transport method");u(a)}(ke(ke({},e),{},{callback:function(i){var r,s,o;n.rateLimiter.checkForLimiting(i),i.statusCode>=400&&((s=(o=n.config).on_request_error)===null||s===void 0||s.call(o,i)),(r=e.callback)===null||r===void 0||r.call(e,i)}}))))}},{key:"_send_retriable_request",value:function(e){this._retryQueue?this._retryQueue.retriableRequest(e):this._send_request(e)}},{key:"_execute_array",value:function(e){var n,i=this,r=[],s=[],o=[];Xu(e,function(l){l&&(n=l[0],on(n)?o.push(l):Yr(l)?l.call(i):on(l)&&n==="alias"?r.push(l):on(l)&&n.indexOf("capture")!==-1&&Yr(i[n])?o.push(l):s.push(l))});var a=function(l,u){Xu(l,function(c){if(on(c[0])){var d=u;wt(c,function(h){d=d[h[0]].apply(d,h.slice(1))})}else this[c[0]].apply(this,c.slice(1))},u)};a(r,this),a(s,this),a(o,this)}},{key:"_hasBootstrappedFeatureFlags",value:function(){var e,n;return((e=this.config.bootstrap)===null||e===void 0?void 0:e.featureFlags)&&Object.keys((n=this.config.bootstrap)===null||n===void 0?void 0:n.featureFlags).length>0||!1}},{key:"push",value:function(e){this._execute_array([e])}},{key:"capture",value:function(e,n,i){var r;if(!(this.__loaded&&this.persistence&&this.sessionPersistence&&this._requestQueue))return re.uninitializedWarning("posthog.capture");if(!this.consent.isOptedOut())if(!Me(e)&&Un(e)){if(!Ht||this.config.opt_out_useragent_filter||!bE(Ht,this.config.custom_blocked_useragents)){var s=i!=null&&i.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(s==null||!s.isRateLimited){this.sessionPersistence.update_search_keyword(),this.config.store_google&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.store_google||this.config.save_referrer)&&this.persistence.set_initial_person_info();var o={uuid:ca(),event:e,properties:this._calculate_event_properties(e,n||{})};s&&(o.properties.$lib_rate_limit_remaining_tokens=s.remainingTokens),i!=null&&i.$set&&(o.$set=i==null?void 0:i.$set);var a=this._calculate_set_once_properties(i==null?void 0:i.$set_once);a&&(o.$set_once=a),(o=_4(o,i!=null&&i._noTruncate?null:this.config.properties_string_max_length)).timestamp=(i==null?void 0:i.timestamp)||new Date,Me(i==null?void 0:i.timestamp)||(o.properties.$event_time_override_provided=!0,o.properties.$event_time_override_system_time=new Date);var l=ke(ke({},o.properties.$set),o.$set);Im(l)||this.setPersonPropertiesForFlags(l),this._internalEventEmitter.emit("eventCaptured",o);var u={method:"POST",url:(r=i==null?void 0:i._url)!==null&&r!==void 0?r:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:o,compression:"best-available",batchKey:i==null?void 0:i._batchKey};return!this.config.request_batching||i&&(i==null||!i._batchKey)||i!=null&&i.send_instantly?this._send_retriable_request(u):this._requestQueue.enqueue(u),o}re.critical("This capture call is ignored due to client rate limiting.")}}else re.error("No event name provided to posthog.capture")}},{key:"_addCaptureHook",value:function(e){this.on("eventCaptured",function(n){return e(n.event,n)})}},{key:"_calculate_event_properties",value:function(e,n){if(!this.persistence||!this.sessionPersistence)return n;var i=this.persistence.remove_event_timer(e),r=ke({},n);if(r.token=this.config.token,e==="$snapshot"){var s=ke(ke({},this.persistence.properties()),this.sessionPersistence.properties());return r.distinct_id=s.distinct_id,(!Un(r.distinct_id)&&!ur(r.distinct_id)||DC(r.distinct_id))&&re.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),r}var o=dn.properties();if(this.sessionManager){var a=this.sessionManager.checkAndGetSessionAndWindowId(),l=a.sessionId,u=a.windowId;r.$session_id=l,r.$window_id=u}if(this.requestRouter.region===Pl.CUSTOM&&(r.$lib_custom_api_host=this.config.api_host),this.sessionPropsManager&&this.config.__preview_send_client_session_params&&(e==="$pageview"||e==="$pageleave"||e==="$autocapture")){var c=this.sessionPropsManager.getSessionProps();r=Qn(r,c)}if(!this.config.disable_scroll_properties){var d={};e==="$pageview"?d=this.pageViewManager.doPageView():e==="$pageleave"&&(d=this.pageViewManager.doPageLeave()),r=Qn(r,d)}if(e==="$pageview"&&Ee&&(r.title=Ee.title),!Me(i)){var h=new Date().getTime()-i;r.$duration=parseFloat((h/1e3).toFixed(3))}Ht&&this.config.opt_out_useragent_filter&&(r.$browser_type=bE(Ht,this.config.custom_blocked_useragents)?"bot":"browser"),(r=Qn({},o,this.persistence.properties(),this.sessionPersistence.properties(),r)).$is_identified=this._isIdentified(),on(this.config.property_denylist)?wt(this.config.property_denylist,function(p){delete r[p]}):re.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var f=this.config.sanitize_properties;return f&&(r=f(r,e)),r.$process_person_profile=this._hasPersonProcessing(),r}},{key:"_calculate_set_once_properties",value:function(e){if(!this.persistence||!this._hasPersonProcessing())return e;var n=Qn({},this.persistence.get_initial_props(),e||{});return Im(n)?void 0:n}},{key:"register",value:function(e,n){var i;(i=this.persistence)===null||i===void 0||i.register(e,n)}},{key:"register_once",value:function(e,n,i){var r;(r=this.persistence)===null||r===void 0||r.register_once(e,n,i)}},{key:"register_for_session",value:function(e){var n;(n=this.sessionPersistence)===null||n===void 0||n.register(e)}},{key:"unregister",value:function(e){var n;(n=this.persistence)===null||n===void 0||n.unregister(e)}},{key:"unregister_for_session",value:function(e){var n;(n=this.sessionPersistence)===null||n===void 0||n.unregister(e)}},{key:"_register_single",value:function(e,n){this.register(X({},e,n))}},{key:"getFeatureFlag",value:function(e,n){return this.featureFlags.getFeatureFlag(e,n)}},{key:"getFeatureFlagPayload",value:function(e){var n=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(n)}catch{return n}}},{key:"isFeatureEnabled",value:function(e,n){return this.featureFlags.isFeatureEnabled(e,n)}},{key:"reloadFeatureFlags",value:function(){this.featureFlags.reloadFeatureFlags()}},{key:"updateEarlyAccessFeatureEnrollment",value:function(e,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,n)}},{key:"getEarlyAccessFeatures",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.featureFlags.getEarlyAccessFeatures(e,n)}},{key:"on",value:function(e,n){return this._internalEventEmitter.on(e,n)}},{key:"onFeatureFlags",value:function(e){return this.featureFlags.onFeatureFlags(e)}},{key:"onSessionId",value:function(e){var n,i;return(n=(i=this.sessionManager)===null||i===void 0?void 0:i.onSessionId(e))!==null&&n!==void 0?n:function(){}}},{key:"getSurveys",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.surveys.getSurveys(e,n)}},{key:"getActiveMatchingSurveys",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.surveys.getActiveMatchingSurveys(e,n)}},{key:"getNextSurveyStep",value:function(e,n,i){return this.surveys.getNextSurveyStep(e,n,i)}},{key:"identify",value:function(e,n,i){if(!this.__loaded||!this.persistence)return re.uninitializedWarning("posthog.identify");if(ur(e)&&(e=e.toString(),re.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e){if(["distinct_id","distinctid"].includes(e.toLowerCase()))re.critical('The string "'.concat(e,'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.'));else if(this._requirePersonProcessing("posthog.identify")){var r=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var s=r;this.register_once({$had_persisted_distinct_id:!0,$device_id:s},"")}e!==r&&e!==this.get_property(Dd)&&(this.unregister(Dd),this.register({distinct_id:e}));var o=(this.persistence.get_property(qs)||"anonymous")==="anonymous";e!==r&&o?(this.persistence.set_property(qs,"identified"),this.setPersonPropertiesForFlags(n||{},!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:r},{$set:n||{},$set_once:i||{}}),this.featureFlags.setAnonymousDistinctId(r)):(n||i)&&this.setPersonProperties(n,i),e!==r&&(this.reloadFeatureFlags(),this.unregister(yg))}}else re.error("Unique user id has not been set in posthog.identify")}},{key:"setPersonProperties",value:function(e,n){(e||n)&&this._requirePersonProcessing("posthog.setPersonProperties")&&(this.setPersonPropertiesForFlags(e||{}),this.capture("$set",{$set:e||{},$set_once:n||{}}))}},{key:"group",value:function(e,n,i){if(e&&n){if(this._requirePersonProcessing("posthog.group")){var r=this.getGroups();r[e]!==n&&this.resetGroupPropertiesForFlags(e),this.register({$groups:ke(ke({},r),{},X({},e,n))}),i&&(this.capture("$groupidentify",{$group_type:e,$group_key:n,$group_set:i}),this.setGroupPropertiesForFlags(X({},e,i))),r[e]===n||i||this.reloadFeatureFlags()}}else re.error("posthog.group requires a group type and group key")}},{key:"resetGroups",value:function(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}},{key:"setPersonPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this._requirePersonProcessing("posthog.setPersonPropertiesForFlags")&&this.featureFlags.setPersonPropertiesForFlags(e,n)}},{key:"resetPersonPropertiesForFlags",value:function(){this.featureFlags.resetPersonPropertiesForFlags()}},{key:"setGroupPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this._requirePersonProcessing("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,n)}},{key:"resetGroupPropertiesForFlags",value:function(e){this.featureFlags.resetGroupPropertiesForFlags(e)}},{key:"reset",value:function(e){var n,i,r,s;if(!this.__loaded)return re.uninitializedWarning("posthog.reset");var o=this.get_property("$device_id");this.consent.reset(),(n=this.persistence)===null||n===void 0||n.clear(),(i=this.sessionPersistence)===null||i===void 0||i.clear(),(r=this.persistence)===null||r===void 0||r.set_property(qs,"anonymous"),(s=this.sessionManager)===null||s===void 0||s.resetSessionId();var a=this.config.get_device_id(ca());this.register_once({distinct_id:a,$device_id:e?a:o},"")}},{key:"get_distinct_id",value:function(){return this.get_property("distinct_id")}},{key:"getGroups",value:function(){return this.get_property("$groups")||{}}},{key:"get_session_id",value:function(){var e,n;return(e=(n=this.sessionManager)===null||n===void 0?void 0:n.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}},{key:"get_session_replay_url",value:function(e){if(!this.sessionManager)return"";var n=this.sessionManager.checkAndGetSessionAndWindowId(!0),i=n.sessionId,r=n.sessionStartTimestamp,s=this.requestRouter.endpointFor("ui","/project/".concat(this.config.token,"/replay/").concat(i));if(e!=null&&e.withTimestamp&&r){var o,a=(o=e.timestampLookBack)!==null&&o!==void 0?o:10;if(!r)return s;var l=Math.max(Math.floor((new Date().getTime()-r)/1e3)-a,0);s+="?t=".concat(l)}return s}},{key:"alias",value:function(e,n){return e===this.get_property(ON)?(re.critical("Attempting to create alias for existing People user - aborting."),-2):this._requirePersonProcessing("posthog.alias")?(Me(n)&&(n=this.get_distinct_id()),e!==n?(this._register_single(Dd,e),this.capture("$create_alias",{alias:e,distinct_id:n})):(re.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}},{key:"set_config",value:function(e){var n,i,r,s,o=ke({},this.config);En(e)&&(Qn(this.config,CE(e)),(n=this.persistence)===null||n===void 0||n.update_config(this.config,o),this.sessionPersistence=this.config.persistence==="sessionStorage"?this.persistence:new m0(ke(ke({},this.config),{},{persistence:"sessionStorage"})),tn.is_supported()&&tn.get("ph_debug")==="true"&&(this.config.debug=!0),this.config.debug&&(Vr.DEBUG=!0),(i=this.sessionRecording)===null||i===void 0||i.startIfEnabledOrStop(),(r=this.autocapture)===null||r===void 0||r.startIfEnabled(),(s=this.heatmaps)===null||s===void 0||s.startIfEnabled(),this.surveys.loadIfEnabled(),this._sync_opt_out_with_persistence())}},{key:"startSessionRecording",value:function(e){if(e!=null&&e.sampling){var n,i,r=(n=this.sessionManager)===null||n===void 0?void 0:n.checkAndGetSessionAndWindowId();(i=this.persistence)===null||i===void 0||i.register(X({},th,!0)),re.info("Session recording started with sampling override for session: ",r==null?void 0:r.sessionId)}this.set_config({disable_session_recording:!1})}},{key:"stopSessionRecording",value:function(){this.set_config({disable_session_recording:!0})}},{key:"sessionRecordingStarted",value:function(){var e;return!((e=this.sessionRecording)===null||e===void 0||!e.started)}},{key:"loadToolbar",value:function(e){return this.toolbar.loadToolbar(e)}},{key:"get_property",value:function(e){var n;return(n=this.persistence)===null||n===void 0?void 0:n.props[e]}},{key:"getSessionProperty",value:function(e){var n;return(n=this.sessionPersistence)===null||n===void 0?void 0:n.props[e]}},{key:"toString",value:function(){var e,n=(e=this.config.name)!==null&&e!==void 0?e:xu;return n!==xu&&(n=xu+"."+n),n}},{key:"_isIdentified",value:function(){var e,n;return((e=this.persistence)===null||e===void 0?void 0:e.get_property(qs))==="identified"||((n=this.sessionPersistence)===null||n===void 0?void 0:n.get_property(qs))==="identified"}},{key:"_hasPersonProcessing",value:function(){var e,n,i,r;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Im(this.getGroups())&&((e=this.persistence)===null||e===void 0||(n=e.props)===null||n===void 0||!n[Dd])&&((i=this.persistence)===null||i===void 0||(r=i.props)===null||r===void 0||!r[wg]))}},{key:"_shouldCapturePageleave",value:function(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&this.config.capture_pageview}},{key:"createPersonProfile",value:function(){this._hasPersonProcessing()||this._requirePersonProcessing("posthog.createPersonProfile")&&this.setPersonProperties({},{})}},{key:"_requirePersonProcessing",value:function(e){return this.config.person_profiles==="never"?(re.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this._register_single(wg,!0),!0)}},{key:"_sync_opt_out_with_persistence",value:function(){var e,n,i,r,s=this.consent.isOptedOut(),o=this.config.opt_out_persistence_by_default,a=this.config.disable_persistence||s&&!!o;((e=this.persistence)===null||e===void 0?void 0:e.disabled)!==a&&((i=this.persistence)===null||i===void 0||i.set_disabled(a)),((n=this.sessionPersistence)===null||n===void 0?void 0:n.disabled)!==a&&((r=this.sessionPersistence)===null||r===void 0||r.set_disabled(a))}},{key:"opt_in_capturing",value:function(e){var n;this.consent.optInOut(!0),this._sync_opt_out_with_persistence(),(Me(e==null?void 0:e.captureEventName)||e!=null&&e.captureEventName)&&this.capture((n=e==null?void 0:e.captureEventName)!==null&&n!==void 0?n:"$opt_in",e==null?void 0:e.captureProperties,{send_instantly:!0})}},{key:"opt_out_capturing",value:function(){this.consent.optInOut(!1),this._sync_opt_out_with_persistence()}},{key:"has_opted_in_capturing",value:function(){return this.consent.isOptedIn()}},{key:"has_opted_out_capturing",value:function(){return this.consent.isOptedOut()}},{key:"clear_opt_in_out_capturing",value:function(){this.consent.reset(),this._sync_opt_out_with_persistence()}},{key:"debug",value:function(e){e===!1?(V==null||V.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(V==null||V.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}}]),t}();(function(t,e){for(var n=0;n<e.length;n++)t.prototype[e[n]]=k4(t.prototype[e[n]])})(pM,["identify"]);var EE,Zu=(EE=sh[xu]=new pM,function(){function t(){t.done||(t.done=!0,fM=!1,wt(sh,function(e){e._dom_loaded()}))}Ee!=null&&Ee.addEventListener&&(Ee.readyState==="complete"?t():Ee.addEventListener("DOMContentLoaded",t,!1)),V&&po(V,"load",t,!0)}(),EE),q5=S.createContext({client:Zu});function Y5(t){var e=t.children,n=t.client,i=t.apiKey,r=t.options,s=S.useMemo(function(){return n&&i&&console.warn("[PostHog.js] You have provided both a client and an apiKey to PostHogProvider. The apiKey will be ignored in favour of the client."),n&&r&&console.warn("[PostHog.js] You have provided both a client and options to PostHogProvider. The options will be ignored in favour of the client."),n||(i&&(Zu.__loaded&&console.warn("[PostHog.js] was already loaded elsewhere. This may cause issues."),Zu.init(i,r)),Zu)},[n,i]);return fn.createElement(q5.Provider,{value:{client:s}},e)}var Db={},mM={exports:{}},Ji={},gM={exports:{}},vM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,j){var te=H.length;H.push(j);e:for(;0<te;){var pe=te-1>>>1,q=H[pe];if(0<r(q,j))H[pe]=j,H[te]=q,te=pe;else break e}}function n(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var j=H[0],te=H.pop();if(te!==j){H[0]=te;e:for(var pe=0,q=H.length,ue=q>>>1;pe<ue;){var O=2*(pe+1)-1,M=H[O],F=O+1,x=H[F];if(0>r(M,te))F<q&&0>r(x,M)?(H[pe]=x,H[F]=te,pe=F):(H[pe]=M,H[O]=te,pe=O);else if(F<q&&0>r(x,te))H[pe]=x,H[F]=te,pe=F;else break e}}return j}function r(H,j){var te=H.sortIndex-j.sortIndex;return te!==0?te:H.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,d=null,h=3,f=!1,p=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(H){for(var j=n(u);j!==null;){if(j.callback===null)i(u);else if(j.startTime<=H)i(u),j.sortIndex=j.expirationTime,e(l,j);else break;j=n(u)}}function k(H){if(m=!1,b(H),!p)if(n(l)!==null)p=!0,Q(_);else{var j=n(u);j!==null&&ie(k,j.startTime-H)}}function _(H,j){p=!1,m&&(m=!1,v(P),P=-1),f=!0;var te=h;try{for(b(j),d=n(l);d!==null&&(!(d.expirationTime>j)||H&&!B());){var pe=d.callback;if(typeof pe=="function"){d.callback=null,h=d.priorityLevel;var q=pe(d.expirationTime<=j);j=t.unstable_now(),typeof q=="function"?d.callback=q:d===n(l)&&i(l),b(j)}else i(l);d=n(l)}if(d!==null)var ue=!0;else{var O=n(u);O!==null&&ie(k,O.startTime-j),ue=!1}return ue}finally{d=null,h=te,f=!1}}var E=!1,A=null,P=-1,I=5,D=-1;function B(){return!(t.unstable_now()-D<I)}function $(){if(A!==null){var H=t.unstable_now();D=H;var j=!0;try{j=A(!0,H)}finally{j?J():(E=!1,A=null)}}else E=!1}var J;if(typeof y=="function")J=function(){y($)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,G=z.port2;z.port1.onmessage=$,J=function(){G.postMessage(null)}}else J=function(){w($,0)};function Q(H){A=H,E||(E=!0,J())}function ie(H,j){P=w(function(){H(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Q(_))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(H){switch(h){case 1:case 2:case 3:var j=3;break;default:j=h}var te=h;h=j;try{return H()}finally{h=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,j){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var te=h;h=H;try{return j()}finally{h=te}},t.unstable_scheduleCallback=function(H,j,te){var pe=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?pe+te:pe):te=pe,H){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=te+q,H={id:c++,callback:j,priorityLevel:H,startTime:te,expirationTime:q,sortIndex:-1},te>pe?(H.sortIndex=te,e(u,H),n(l)===null&&H===n(u)&&(m?(v(P),P=-1):m=!0,ie(k,te-pe))):(H.sortIndex=q,e(l,H),p||f||(p=!0,Q(_))),H},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(H){var j=h;return function(){var te=h;h=j;try{return H.apply(this,arguments)}finally{h=te}}}})(vM);gM.exports=vM;var J5=gM.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z5=S,qi=J5;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yM=new Set,Mh={};function su(t,e){_c(t,e),_c(t+"Capture",e)}function _c(t,e){for(Mh[t]=e,t=0;t<e.length;t++)yM.add(e[t])}var _o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lb=Object.prototype.hasOwnProperty,Q5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,AE={},PE={};function ez(t){return Lb.call(PE,t)?!0:Lb.call(AE,t)?!1:Q5.test(t)?PE[t]=!0:(AE[t]=!0,!1)}function tz(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function nz(t,e,n,i){if(e===null||typeof e>"u"||tz(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ai(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var On={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){On[t]=new ai(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];On[e]=new ai(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){On[t]=new ai(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){On[t]=new ai(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){On[t]=new ai(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){On[t]=new ai(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){On[t]=new ai(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){On[t]=new ai(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){On[t]=new ai(t,5,!1,t.toLowerCase(),null,!1,!1)});var kS=/[\-:]([a-z])/g;function _S(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(kS,_S);On[e]=new ai(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(kS,_S);On[e]=new ai(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(kS,_S);On[e]=new ai(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){On[t]=new ai(t,1,!1,t.toLowerCase(),null,!1,!1)});On.xlinkHref=new ai("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){On[t]=new ai(t,1,!1,t.toLowerCase(),null,!0,!0)});function CS(t,e,n,i){var r=On.hasOwnProperty(e)?On[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(nz(e,n,r,i)&&(n=null),i||r===null?ez(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var Do=Z5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ep=Symbol.for("react.element"),Nu=Symbol.for("react.portal"),Mu=Symbol.for("react.fragment"),ES=Symbol.for("react.strict_mode"),jb=Symbol.for("react.profiler"),wM=Symbol.for("react.provider"),bM=Symbol.for("react.context"),AS=Symbol.for("react.forward_ref"),Fb=Symbol.for("react.suspense"),Bb=Symbol.for("react.suspense_list"),PS=Symbol.for("react.memo"),qo=Symbol.for("react.lazy"),xM=Symbol.for("react.offscreen"),TE=Symbol.iterator;function fd(t){return t===null||typeof t!="object"?null:(t=TE&&t[TE]||t["@@iterator"],typeof t=="function"?t:null)}var $t=Object.assign,S0;function Fd(t){if(S0===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);S0=e&&e[1]||""}return`
`+S0+t}var k0=!1;function _0(t,e){if(!t||k0)return"";k0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){i=u}t.call(e.prototype)}else{try{throw Error()}catch(u){i=u}t()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{k0=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fd(t):""}function iz(t){switch(t.tag){case 5:return Fd(t.type);case 16:return Fd("Lazy");case 13:return Fd("Suspense");case 19:return Fd("SuspenseList");case 0:case 2:case 15:return t=_0(t.type,!1),t;case 11:return t=_0(t.type.render,!1),t;case 1:return t=_0(t.type,!0),t;default:return""}}function $b(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Mu:return"Fragment";case Nu:return"Portal";case jb:return"Profiler";case ES:return"StrictMode";case Fb:return"Suspense";case Bb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case bM:return(t.displayName||"Context")+".Consumer";case wM:return(t._context.displayName||"Context")+".Provider";case AS:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case PS:return e=t.displayName||null,e!==null?e:$b(t.type)||"Memo";case qo:e=t._payload,t=t._init;try{return $b(t(e))}catch{}}return null}function rz(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $b(e);case 8:return e===ES?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Da(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function SM(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function sz(t){var e=SM(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ap(t){t._valueTracker||(t._valueTracker=sz(t))}function kM(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=SM(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Pg(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zb(t,e){var n=e.checked;return $t({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function RE(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=Da(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _M(t,e){e=e.checked,e!=null&&CS(t,"checked",e,!1)}function Ub(t,e){_M(t,e);var n=Da(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vb(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vb(t,e.type,Da(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function NE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vb(t,e,n){(e!=="number"||Pg(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Bd=Array.isArray;function Qu(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Da(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Hb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return $t({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ME(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(Bd(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Da(n)}}function CM(t,e){var n=Da(e.value),i=Da(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function OE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function EM(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?EM(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Pp,AM=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Pp=Pp||document.createElement("div"),Pp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Pp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Oh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var oh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oz=["Webkit","ms","Moz","O"];Object.keys(oh).forEach(function(t){oz.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),oh[e]=oh[t]})});function PM(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||oh.hasOwnProperty(t)&&oh[t]?(""+e).trim():e+"px"}function TM(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=PM(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var az=$t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gb(t,e){if(e){if(az[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function Kb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xb=null;function TS(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var qb=null,ec=null,tc=null;function IE(t){if(t=Vf(t)){if(typeof qb!="function")throw Error(se(280));var e=t.stateNode;e&&(e=iy(e),qb(t.stateNode,t.type,e))}}function RM(t){ec?tc?tc.push(t):tc=[t]:ec=t}function NM(){if(ec){var t=ec,e=tc;if(tc=ec=null,IE(t),e)for(t=0;t<e.length;t++)IE(e[t])}}function MM(t,e){return t(e)}function OM(){}var C0=!1;function IM(t,e,n){if(C0)return t(e,n);C0=!0;try{return MM(t,e,n)}finally{C0=!1,(ec!==null||tc!==null)&&(OM(),NM())}}function Ih(t,e){var n=t.stateNode;if(n===null)return null;var i=iy(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var Yb=!1;if(_o)try{var pd={};Object.defineProperty(pd,"passive",{get:function(){Yb=!0}}),window.addEventListener("test",pd,pd),window.removeEventListener("test",pd,pd)}catch{Yb=!1}function lz(t,e,n,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var ah=!1,Tg=null,Rg=!1,Jb=null,uz={onError:function(t){ah=!0,Tg=t}};function cz(t,e,n,i,r,s,o,a,l){ah=!1,Tg=null,lz.apply(uz,arguments)}function dz(t,e,n,i,r,s,o,a,l){if(cz.apply(this,arguments),ah){if(ah){var u=Tg;ah=!1,Tg=null}else throw Error(se(198));Rg||(Rg=!0,Jb=u)}}function ou(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function DM(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function DE(t){if(ou(t)!==t)throw Error(se(188))}function hz(t){var e=t.alternate;if(!e){if(e=ou(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return DE(r),t;if(s===i)return DE(r),e;s=s.sibling}throw Error(se(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(se(189))}}if(n.alternate!==i)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function LM(t){return t=hz(t),t!==null?jM(t):null}function jM(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=jM(t);if(e!==null)return e;t=t.sibling}return null}var FM=qi.unstable_scheduleCallback,LE=qi.unstable_cancelCallback,fz=qi.unstable_shouldYield,pz=qi.unstable_requestPaint,Kt=qi.unstable_now,mz=qi.unstable_getCurrentPriorityLevel,RS=qi.unstable_ImmediatePriority,BM=qi.unstable_UserBlockingPriority,Ng=qi.unstable_NormalPriority,gz=qi.unstable_LowPriority,$M=qi.unstable_IdlePriority,Qv=null,Is=null;function vz(t){if(Is&&typeof Is.onCommitFiberRoot=="function")try{Is.onCommitFiberRoot(Qv,t,void 0,(t.current.flags&128)===128)}catch{}}var Jr=Math.clz32?Math.clz32:bz,yz=Math.log,wz=Math.LN2;function bz(t){return t>>>=0,t===0?32:31-(yz(t)/wz|0)|0}var Tp=64,Rp=4194304;function $d(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Mg(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=$d(a):(s&=o,s!==0&&(i=$d(s)))}else o=n&~r,o!==0?i=$d(o):s!==0&&(i=$d(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Jr(e),r=1<<n,i|=t[n],e&=~r;return i}function xz(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sz(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Jr(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=xz(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Zb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function zM(){var t=Tp;return Tp<<=1,!(Tp&4194240)&&(Tp=64),t}function E0(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function zf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Jr(e),t[e]=n}function kz(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Jr(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function NS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Jr(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var ht=0;function UM(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var VM,MS,HM,WM,GM,Qb=!1,Np=[],_a=null,Ca=null,Ea=null,Dh=new Map,Lh=new Map,ta=[],_z="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jE(t,e){switch(t){case"focusin":case"focusout":_a=null;break;case"dragenter":case"dragleave":Ca=null;break;case"mouseover":case"mouseout":Ea=null;break;case"pointerover":case"pointerout":Dh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lh.delete(e.pointerId)}}function md(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Vf(e),e!==null&&MS(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function Cz(t,e,n,i,r){switch(e){case"focusin":return _a=md(_a,t,e,n,i,r),!0;case"dragenter":return Ca=md(Ca,t,e,n,i,r),!0;case"mouseover":return Ea=md(Ea,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Dh.set(s,md(Dh.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Lh.set(s,md(Lh.get(s)||null,t,e,n,i,r)),!0}return!1}function KM(t){var e=Tl(t.target);if(e!==null){var n=ou(e);if(n!==null){if(e=n.tag,e===13){if(e=DM(n),e!==null){t.blockedOn=e,GM(t.priority,function(){HM(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function jm(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ex(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);Xb=i,n.target.dispatchEvent(i),Xb=null}else return e=Vf(n),e!==null&&MS(e),t.blockedOn=n,!1;e.shift()}return!0}function FE(t,e,n){jm(t)&&n.delete(e)}function Ez(){Qb=!1,_a!==null&&jm(_a)&&(_a=null),Ca!==null&&jm(Ca)&&(Ca=null),Ea!==null&&jm(Ea)&&(Ea=null),Dh.forEach(FE),Lh.forEach(FE)}function gd(t,e){t.blockedOn===e&&(t.blockedOn=null,Qb||(Qb=!0,qi.unstable_scheduleCallback(qi.unstable_NormalPriority,Ez)))}function jh(t){function e(r){return gd(r,t)}if(0<Np.length){gd(Np[0],t);for(var n=1;n<Np.length;n++){var i=Np[n];i.blockedOn===t&&(i.blockedOn=null)}}for(_a!==null&&gd(_a,t),Ca!==null&&gd(Ca,t),Ea!==null&&gd(Ea,t),Dh.forEach(e),Lh.forEach(e),n=0;n<ta.length;n++)i=ta[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<ta.length&&(n=ta[0],n.blockedOn===null);)KM(n),n.blockedOn===null&&ta.shift()}var nc=Do.ReactCurrentBatchConfig,Og=!0;function Az(t,e,n,i){var r=ht,s=nc.transition;nc.transition=null;try{ht=1,OS(t,e,n,i)}finally{ht=r,nc.transition=s}}function Pz(t,e,n,i){var r=ht,s=nc.transition;nc.transition=null;try{ht=4,OS(t,e,n,i)}finally{ht=r,nc.transition=s}}function OS(t,e,n,i){if(Og){var r=ex(t,e,n,i);if(r===null)L0(t,e,i,Ig,n),jE(t,i);else if(Cz(r,t,e,n,i))i.stopPropagation();else if(jE(t,i),e&4&&-1<_z.indexOf(t)){for(;r!==null;){var s=Vf(r);if(s!==null&&VM(s),s=ex(t,e,n,i),s===null&&L0(t,e,i,Ig,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else L0(t,e,i,null,n)}}var Ig=null;function ex(t,e,n,i){if(Ig=null,t=TS(i),t=Tl(t),t!==null)if(e=ou(t),e===null)t=null;else if(n=e.tag,n===13){if(t=DM(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ig=t,null}function XM(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mz()){case RS:return 1;case BM:return 4;case Ng:case gz:return 16;case $M:return 536870912;default:return 16}default:return 16}}var da=null,IS=null,Fm=null;function qM(){if(Fm)return Fm;var t,e=IS,n=e.length,i,r="value"in da?da.value:da.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return Fm=r.slice(t,1<i?1-i:void 0)}function Bm(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Mp(){return!0}function BE(){return!1}function Zi(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Mp:BE,this.isPropagationStopped=BE,this}return $t(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Mp)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Mp)},persist:function(){},isPersistent:Mp}),e}var Zc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},DS=Zi(Zc),Uf=$t({},Zc,{view:0,detail:0}),Tz=Zi(Uf),A0,P0,vd,ey=$t({},Uf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:LS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==vd&&(vd&&t.type==="mousemove"?(A0=t.screenX-vd.screenX,P0=t.screenY-vd.screenY):P0=A0=0,vd=t),A0)},movementY:function(t){return"movementY"in t?t.movementY:P0}}),$E=Zi(ey),Rz=$t({},ey,{dataTransfer:0}),Nz=Zi(Rz),Mz=$t({},Uf,{relatedTarget:0}),T0=Zi(Mz),Oz=$t({},Zc,{animationName:0,elapsedTime:0,pseudoElement:0}),Iz=Zi(Oz),Dz=$t({},Zc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Lz=Zi(Dz),jz=$t({},Zc,{data:0}),zE=Zi(jz),Fz={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Bz={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$z={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zz(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=$z[t])?!!e[t]:!1}function LS(){return zz}var Uz=$t({},Uf,{key:function(t){if(t.key){var e=Fz[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Bm(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Bz[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:LS,charCode:function(t){return t.type==="keypress"?Bm(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Bm(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Vz=Zi(Uz),Hz=$t({},ey,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),UE=Zi(Hz),Wz=$t({},Uf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:LS}),Gz=Zi(Wz),Kz=$t({},Zc,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xz=Zi(Kz),qz=$t({},ey,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Yz=Zi(qz),Jz=[9,13,27,32],jS=_o&&"CompositionEvent"in window,lh=null;_o&&"documentMode"in document&&(lh=document.documentMode);var Zz=_o&&"TextEvent"in window&&!lh,YM=_o&&(!jS||lh&&8<lh&&11>=lh),VE=" ",HE=!1;function JM(t,e){switch(t){case"keyup":return Jz.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ZM(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ou=!1;function Qz(t,e){switch(t){case"compositionend":return ZM(e);case"keypress":return e.which!==32?null:(HE=!0,VE);case"textInput":return t=e.data,t===VE&&HE?null:t;default:return null}}function e8(t,e){if(Ou)return t==="compositionend"||!jS&&JM(t,e)?(t=qM(),Fm=IS=da=null,Ou=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return YM&&e.locale!=="ko"?null:e.data;default:return null}}var t8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function WE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!t8[t.type]:e==="textarea"}function QM(t,e,n,i){RM(i),e=Dg(e,"onChange"),0<e.length&&(n=new DS("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var uh=null,Fh=null;function n8(t){cO(t,0)}function ty(t){var e=Lu(t);if(kM(e))return t}function i8(t,e){if(t==="change")return e}var eO=!1;if(_o){var R0;if(_o){var N0="oninput"in document;if(!N0){var GE=document.createElement("div");GE.setAttribute("oninput","return;"),N0=typeof GE.oninput=="function"}R0=N0}else R0=!1;eO=R0&&(!document.documentMode||9<document.documentMode)}function KE(){uh&&(uh.detachEvent("onpropertychange",tO),Fh=uh=null)}function tO(t){if(t.propertyName==="value"&&ty(Fh)){var e=[];QM(e,Fh,t,TS(t)),IM(n8,e)}}function r8(t,e,n){t==="focusin"?(KE(),uh=e,Fh=n,uh.attachEvent("onpropertychange",tO)):t==="focusout"&&KE()}function s8(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ty(Fh)}function o8(t,e){if(t==="click")return ty(e)}function a8(t,e){if(t==="input"||t==="change")return ty(e)}function l8(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var es=typeof Object.is=="function"?Object.is:l8;function Bh(t,e){if(es(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!Lb.call(e,r)||!es(t[r],e[r]))return!1}return!0}function XE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qE(t,e){var n=XE(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=XE(n)}}function nO(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?nO(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function iO(){for(var t=window,e=Pg();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Pg(t.document)}return e}function FS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function u8(t){var e=iO(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&nO(n.ownerDocument.documentElement,n)){if(i!==null&&FS(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=qE(n,s);var o=qE(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var c8=_o&&"documentMode"in document&&11>=document.documentMode,Iu=null,tx=null,ch=null,nx=!1;function YE(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nx||Iu==null||Iu!==Pg(i)||(i=Iu,"selectionStart"in i&&FS(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),ch&&Bh(ch,i)||(ch=i,i=Dg(tx,"onSelect"),0<i.length&&(e=new DS("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Iu)))}function Op(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Du={animationend:Op("Animation","AnimationEnd"),animationiteration:Op("Animation","AnimationIteration"),animationstart:Op("Animation","AnimationStart"),transitionend:Op("Transition","TransitionEnd")},M0={},rO={};_o&&(rO=document.createElement("div").style,"AnimationEvent"in window||(delete Du.animationend.animation,delete Du.animationiteration.animation,delete Du.animationstart.animation),"TransitionEvent"in window||delete Du.transitionend.transition);function ny(t){if(M0[t])return M0[t];if(!Du[t])return t;var e=Du[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in rO)return M0[t]=e[n];return t}var sO=ny("animationend"),oO=ny("animationiteration"),aO=ny("animationstart"),lO=ny("transitionend"),uO=new Map,JE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Za(t,e){uO.set(t,e),su(e,[t])}for(var O0=0;O0<JE.length;O0++){var I0=JE[O0],d8=I0.toLowerCase(),h8=I0[0].toUpperCase()+I0.slice(1);Za(d8,"on"+h8)}Za(sO,"onAnimationEnd");Za(oO,"onAnimationIteration");Za(aO,"onAnimationStart");Za("dblclick","onDoubleClick");Za("focusin","onFocus");Za("focusout","onBlur");Za(lO,"onTransitionEnd");_c("onMouseEnter",["mouseout","mouseover"]);_c("onMouseLeave",["mouseout","mouseover"]);_c("onPointerEnter",["pointerout","pointerover"]);_c("onPointerLeave",["pointerout","pointerover"]);su("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));su("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));su("onBeforeInput",["compositionend","keypress","textInput","paste"]);su("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));su("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));su("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f8=new Set("cancel close invalid load scroll toggle".split(" ").concat(zd));function ZE(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,dz(i,e,void 0,t),t.currentTarget=null}function cO(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;ZE(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;ZE(r,a,u),s=l}}}if(Rg)throw t=Jb,Rg=!1,Jb=null,t}function Ct(t,e){var n=e[ax];n===void 0&&(n=e[ax]=new Set);var i=t+"__bubble";n.has(i)||(dO(e,t,2,!1),n.add(i))}function D0(t,e,n){var i=0;e&&(i|=4),dO(n,t,i,e)}var Ip="_reactListening"+Math.random().toString(36).slice(2);function $h(t){if(!t[Ip]){t[Ip]=!0,yM.forEach(function(n){n!=="selectionchange"&&(f8.has(n)||D0(n,!1,t),D0(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ip]||(e[Ip]=!0,D0("selectionchange",!1,e))}}function dO(t,e,n,i){switch(XM(e)){case 1:var r=Az;break;case 4:r=Pz;break;default:r=OS}n=r.bind(null,e,n,t),r=void 0,!Yb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function L0(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Tl(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}IM(function(){var u=s,c=TS(n),d=[];e:{var h=uO.get(t);if(h!==void 0){var f=DS,p=t;switch(t){case"keypress":if(Bm(n)===0)break e;case"keydown":case"keyup":f=Vz;break;case"focusin":p="focus",f=T0;break;case"focusout":p="blur",f=T0;break;case"beforeblur":case"afterblur":f=T0;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=$E;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Nz;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Gz;break;case sO:case oO:case aO:f=Iz;break;case lO:f=Xz;break;case"scroll":f=Tz;break;case"wheel":f=Yz;break;case"copy":case"cut":case"paste":f=Lz;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=UE}var m=(e&4)!==0,w=!m&&t==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var y=u,b;y!==null;){b=y;var k=b.stateNode;if(b.tag===5&&k!==null&&(b=k,v!==null&&(k=Ih(y,v),k!=null&&m.push(zh(y,k,b)))),w)break;y=y.return}0<m.length&&(h=new f(h,p,null,n,c),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==Xb&&(p=n.relatedTarget||n.fromElement)&&(Tl(p)||p[Co]))break e;if((f||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=u,p=p?Tl(p):null,p!==null&&(w=ou(p),p!==w||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=u),f!==p)){if(m=$E,k="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=UE,k="onPointerLeave",v="onPointerEnter",y="pointer"),w=f==null?h:Lu(f),b=p==null?h:Lu(p),h=new m(k,y+"leave",f,n,c),h.target=w,h.relatedTarget=b,k=null,Tl(c)===u&&(m=new m(v,y+"enter",p,n,c),m.target=b,m.relatedTarget=w,k=m),w=k,f&&p)t:{for(m=f,v=p,y=0,b=m;b;b=du(b))y++;for(b=0,k=v;k;k=du(k))b++;for(;0<y-b;)m=du(m),y--;for(;0<b-y;)v=du(v),b--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=du(m),v=du(v)}m=null}else m=null;f!==null&&QE(d,h,f,m,!1),p!==null&&w!==null&&QE(d,w,p,m,!0)}}e:{if(h=u?Lu(u):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var _=i8;else if(WE(h))if(eO)_=a8;else{_=s8;var E=r8}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=o8);if(_&&(_=_(t,u))){QM(d,_,n,c);break e}E&&E(t,h,u),t==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&Vb(h,"number",h.value)}switch(E=u?Lu(u):window,t){case"focusin":(WE(E)||E.contentEditable==="true")&&(Iu=E,tx=u,ch=null);break;case"focusout":ch=tx=Iu=null;break;case"mousedown":nx=!0;break;case"contextmenu":case"mouseup":case"dragend":nx=!1,YE(d,n,c);break;case"selectionchange":if(c8)break;case"keydown":case"keyup":YE(d,n,c)}var A;if(jS)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Ou?JM(t,n)&&(P="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(P="onCompositionStart");P&&(YM&&n.locale!=="ko"&&(Ou||P!=="onCompositionStart"?P==="onCompositionEnd"&&Ou&&(A=qM()):(da=c,IS="value"in da?da.value:da.textContent,Ou=!0)),E=Dg(u,P),0<E.length&&(P=new zE(P,t,null,n,c),d.push({event:P,listeners:E}),A?P.data=A:(A=ZM(n),A!==null&&(P.data=A)))),(A=Zz?Qz(t,n):e8(t,n))&&(u=Dg(u,"onBeforeInput"),0<u.length&&(c=new zE("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=A))}cO(d,e)})}function zh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Dg(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Ih(t,n),s!=null&&i.unshift(zh(t,s,r)),s=Ih(t,e),s!=null&&i.push(zh(t,s,r))),t=t.return}return i}function du(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function QE(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=Ih(n,s),l!=null&&o.unshift(zh(n,l,a))):r||(l=Ih(n,s),l!=null&&o.push(zh(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var p8=/\r\n?/g,m8=/\u0000|\uFFFD/g;function eA(t){return(typeof t=="string"?t:""+t).replace(p8,`
`).replace(m8,"")}function Dp(t,e,n){if(e=eA(e),eA(t)!==e&&n)throw Error(se(425))}function Lg(){}var ix=null,rx=null;function sx(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ox=typeof setTimeout=="function"?setTimeout:void 0,g8=typeof clearTimeout=="function"?clearTimeout:void 0,tA=typeof Promise=="function"?Promise:void 0,v8=typeof queueMicrotask=="function"?queueMicrotask:typeof tA<"u"?function(t){return tA.resolve(null).then(t).catch(y8)}:ox;function y8(t){setTimeout(function(){throw t})}function j0(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),jh(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);jh(e)}function Aa(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nA(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Qc=Math.random().toString(36).slice(2),_s="__reactFiber$"+Qc,Uh="__reactProps$"+Qc,Co="__reactContainer$"+Qc,ax="__reactEvents$"+Qc,w8="__reactListeners$"+Qc,b8="__reactHandles$"+Qc;function Tl(t){var e=t[_s];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Co]||n[_s]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=nA(t);t!==null;){if(n=t[_s])return n;t=nA(t)}return e}t=n,n=t.parentNode}return null}function Vf(t){return t=t[_s]||t[Co],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Lu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function iy(t){return t[Uh]||null}var lx=[],ju=-1;function Qa(t){return{current:t}}function Rt(t){0>ju||(t.current=lx[ju],lx[ju]=null,ju--)}function _t(t,e){ju++,lx[ju]=t.current,t.current=e}var La={},Vn=Qa(La),Ai=Qa(!1),Ul=La;function Cc(t,e){var n=t.type.contextTypes;if(!n)return La;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Pi(t){return t=t.childContextTypes,t!=null}function jg(){Rt(Ai),Rt(Vn)}function iA(t,e,n){if(Vn.current!==La)throw Error(se(168));_t(Vn,e),_t(Ai,n)}function hO(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(se(108,rz(t)||"Unknown",r));return $t({},n,i)}function Fg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||La,Ul=Vn.current,_t(Vn,t),_t(Ai,Ai.current),!0}function rA(t,e,n){var i=t.stateNode;if(!i)throw Error(se(169));n?(t=hO(t,e,Ul),i.__reactInternalMemoizedMergedChildContext=t,Rt(Ai),Rt(Vn),_t(Vn,t)):Rt(Ai),_t(Ai,n)}var eo=null,ry=!1,F0=!1;function fO(t){eo===null?eo=[t]:eo.push(t)}function x8(t){ry=!0,fO(t)}function el(){if(!F0&&eo!==null){F0=!0;var t=0,e=ht;try{var n=eo;for(ht=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}eo=null,ry=!1}catch(r){throw eo!==null&&(eo=eo.slice(t+1)),FM(RS,el),r}finally{ht=e,F0=!1}}return null}var Fu=[],Bu=0,Bg=null,$g=0,cr=[],dr=0,Vl=null,go=1,vo="";function wl(t,e){Fu[Bu++]=$g,Fu[Bu++]=Bg,Bg=t,$g=e}function pO(t,e,n){cr[dr++]=go,cr[dr++]=vo,cr[dr++]=Vl,Vl=t;var i=go;t=vo;var r=32-Jr(i)-1;i&=~(1<<r),n+=1;var s=32-Jr(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,go=1<<32-Jr(e)+r|n<<r|i,vo=s+t}else go=1<<s|n<<r|i,vo=t}function BS(t){t.return!==null&&(wl(t,1),pO(t,1,0))}function $S(t){for(;t===Bg;)Bg=Fu[--Bu],Fu[Bu]=null,$g=Fu[--Bu],Fu[Bu]=null;for(;t===Vl;)Vl=cr[--dr],cr[dr]=null,vo=cr[--dr],cr[dr]=null,go=cr[--dr],cr[dr]=null}var Gi=null,Ui=null,It=!1,zr=null;function mO(t,e){var n=mr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function sA(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Gi=t,Ui=Aa(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Gi=t,Ui=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Vl!==null?{id:go,overflow:vo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=mr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Gi=t,Ui=null,!0):!1;default:return!1}}function ux(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cx(t){if(It){var e=Ui;if(e){var n=e;if(!sA(t,e)){if(ux(t))throw Error(se(418));e=Aa(n.nextSibling);var i=Gi;e&&sA(t,e)?mO(i,n):(t.flags=t.flags&-4097|2,It=!1,Gi=t)}}else{if(ux(t))throw Error(se(418));t.flags=t.flags&-4097|2,It=!1,Gi=t}}}function oA(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Gi=t}function Lp(t){if(t!==Gi)return!1;if(!It)return oA(t),It=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sx(t.type,t.memoizedProps)),e&&(e=Ui)){if(ux(t))throw gO(),Error(se(418));for(;e;)mO(t,e),e=Aa(e.nextSibling)}if(oA(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ui=Aa(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ui=null}}else Ui=Gi?Aa(t.stateNode.nextSibling):null;return!0}function gO(){for(var t=Ui;t;)t=Aa(t.nextSibling)}function Ec(){Ui=Gi=null,It=!1}function zS(t){zr===null?zr=[t]:zr.push(t)}var S8=Do.ReactCurrentBatchConfig;function yd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var i=n.stateNode}if(!i)throw Error(se(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function jp(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function aA(t){var e=t._init;return e(t._payload)}function vO(t){function e(v,y){if(t){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function n(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function i(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function r(v,y){return v=Na(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,y,b,k){return y===null||y.tag!==6?(y=W0(b,v.mode,k),y.return=v,y):(y=r(y,b),y.return=v,y)}function l(v,y,b,k){var _=b.type;return _===Mu?c(v,y,b.props.children,k,b.key):y!==null&&(y.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===qo&&aA(_)===y.type)?(k=r(y,b.props),k.ref=yd(v,y,b),k.return=v,k):(k=Gm(b.type,b.key,b.props,null,v.mode,k),k.ref=yd(v,y,b),k.return=v,k)}function u(v,y,b,k){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=G0(b,v.mode,k),y.return=v,y):(y=r(y,b.children||[]),y.return=v,y)}function c(v,y,b,k,_){return y===null||y.tag!==7?(y=Ll(b,v.mode,k,_),y.return=v,y):(y=r(y,b),y.return=v,y)}function d(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=W0(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ep:return b=Gm(y.type,y.key,y.props,null,v.mode,b),b.ref=yd(v,null,y),b.return=v,b;case Nu:return y=G0(y,v.mode,b),y.return=v,y;case qo:var k=y._init;return d(v,k(y._payload),b)}if(Bd(y)||fd(y))return y=Ll(y,v.mode,b,null),y.return=v,y;jp(v,y)}return null}function h(v,y,b,k){var _=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return _!==null?null:a(v,y,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ep:return b.key===_?l(v,y,b,k):null;case Nu:return b.key===_?u(v,y,b,k):null;case qo:return _=b._init,h(v,y,_(b._payload),k)}if(Bd(b)||fd(b))return _!==null?null:c(v,y,b,k,null);jp(v,b)}return null}function f(v,y,b,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return v=v.get(b)||null,a(y,v,""+k,_);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Ep:return v=v.get(k.key===null?b:k.key)||null,l(y,v,k,_);case Nu:return v=v.get(k.key===null?b:k.key)||null,u(y,v,k,_);case qo:var E=k._init;return f(v,y,b,E(k._payload),_)}if(Bd(k)||fd(k))return v=v.get(b)||null,c(y,v,k,_,null);jp(y,k)}return null}function p(v,y,b,k){for(var _=null,E=null,A=y,P=y=0,I=null;A!==null&&P<b.length;P++){A.index>P?(I=A,A=null):I=A.sibling;var D=h(v,A,b[P],k);if(D===null){A===null&&(A=I);break}t&&A&&D.alternate===null&&e(v,A),y=s(D,y,P),E===null?_=D:E.sibling=D,E=D,A=I}if(P===b.length)return n(v,A),It&&wl(v,P),_;if(A===null){for(;P<b.length;P++)A=d(v,b[P],k),A!==null&&(y=s(A,y,P),E===null?_=A:E.sibling=A,E=A);return It&&wl(v,P),_}for(A=i(v,A);P<b.length;P++)I=f(A,v,P,b[P],k),I!==null&&(t&&I.alternate!==null&&A.delete(I.key===null?P:I.key),y=s(I,y,P),E===null?_=I:E.sibling=I,E=I);return t&&A.forEach(function(B){return e(v,B)}),It&&wl(v,P),_}function m(v,y,b,k){var _=fd(b);if(typeof _!="function")throw Error(se(150));if(b=_.call(b),b==null)throw Error(se(151));for(var E=_=null,A=y,P=y=0,I=null,D=b.next();A!==null&&!D.done;P++,D=b.next()){A.index>P?(I=A,A=null):I=A.sibling;var B=h(v,A,D.value,k);if(B===null){A===null&&(A=I);break}t&&A&&B.alternate===null&&e(v,A),y=s(B,y,P),E===null?_=B:E.sibling=B,E=B,A=I}if(D.done)return n(v,A),It&&wl(v,P),_;if(A===null){for(;!D.done;P++,D=b.next())D=d(v,D.value,k),D!==null&&(y=s(D,y,P),E===null?_=D:E.sibling=D,E=D);return It&&wl(v,P),_}for(A=i(v,A);!D.done;P++,D=b.next())D=f(A,v,P,D.value,k),D!==null&&(t&&D.alternate!==null&&A.delete(D.key===null?P:D.key),y=s(D,y,P),E===null?_=D:E.sibling=D,E=D);return t&&A.forEach(function($){return e(v,$)}),It&&wl(v,P),_}function w(v,y,b,k){if(typeof b=="object"&&b!==null&&b.type===Mu&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ep:e:{for(var _=b.key,E=y;E!==null;){if(E.key===_){if(_=b.type,_===Mu){if(E.tag===7){n(v,E.sibling),y=r(E,b.props.children),y.return=v,v=y;break e}}else if(E.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===qo&&aA(_)===E.type){n(v,E.sibling),y=r(E,b.props),y.ref=yd(v,E,b),y.return=v,v=y;break e}n(v,E);break}else e(v,E);E=E.sibling}b.type===Mu?(y=Ll(b.props.children,v.mode,k,b.key),y.return=v,v=y):(k=Gm(b.type,b.key,b.props,null,v.mode,k),k.ref=yd(v,y,b),k.return=v,v=k)}return o(v);case Nu:e:{for(E=b.key;y!==null;){if(y.key===E)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(v,y.sibling),y=r(y,b.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else e(v,y);y=y.sibling}y=G0(b,v.mode,k),y.return=v,v=y}return o(v);case qo:return E=b._init,w(v,y,E(b._payload),k)}if(Bd(b))return p(v,y,b,k);if(fd(b))return m(v,y,b,k);jp(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(v,y.sibling),y=r(y,b),y.return=v,v=y):(n(v,y),y=W0(b,v.mode,k),y.return=v,v=y),o(v)):n(v,y)}return w}var Ac=vO(!0),yO=vO(!1),zg=Qa(null),Ug=null,$u=null,US=null;function VS(){US=$u=Ug=null}function HS(t){var e=zg.current;Rt(zg),t._currentValue=e}function dx(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function ic(t,e){Ug=t,US=$u=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ci=!0),t.firstContext=null)}function Pr(t){var e=t._currentValue;if(US!==t)if(t={context:t,memoizedValue:e,next:null},$u===null){if(Ug===null)throw Error(se(308));$u=t,Ug.dependencies={lanes:0,firstContext:t}}else $u=$u.next=t;return e}var Rl=null;function WS(t){Rl===null?Rl=[t]:Rl.push(t)}function wO(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,WS(e)):(n.next=r.next,r.next=n),e.interleaved=n,Eo(t,i)}function Eo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Yo=!1;function GS(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bO(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function bo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Pa(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,st&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Eo(t,n)}return r=i.interleaved,r===null?(e.next=e,WS(i)):(e.next=r.next,r.next=e),i.interleaved=e,Eo(t,n)}function $m(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,NS(t,n)}}function lA(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Vg(t,e,n,i){var r=t.updateQueue;Yo=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var d=r.baseState;o=0,c=u=l=null,a=s;do{var h=a.lane,f=a.eventTime;if((i&h)===h){c!==null&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=$t({},d,h);break e;case 2:Yo=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=f,l=d):c=c.next=f,o|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(c===null&&(l=d),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Wl|=o,t.lanes=o,t.memoizedState=d}}function uA(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(se(191,r));r.call(i)}}}var Hf={},Ds=Qa(Hf),Vh=Qa(Hf),Hh=Qa(Hf);function Nl(t){if(t===Hf)throw Error(se(174));return t}function KS(t,e){switch(_t(Hh,e),_t(Vh,t),_t(Ds,Hf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Wb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Wb(e,t)}Rt(Ds),_t(Ds,e)}function Pc(){Rt(Ds),Rt(Vh),Rt(Hh)}function xO(t){Nl(Hh.current);var e=Nl(Ds.current),n=Wb(e,t.type);e!==n&&(_t(Vh,t),_t(Ds,n))}function XS(t){Vh.current===t&&(Rt(Ds),Rt(Vh))}var jt=Qa(0);function Hg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var B0=[];function qS(){for(var t=0;t<B0.length;t++)B0[t]._workInProgressVersionPrimary=null;B0.length=0}var zm=Do.ReactCurrentDispatcher,$0=Do.ReactCurrentBatchConfig,Hl=0,Bt=null,en=null,hn=null,Wg=!1,dh=!1,Wh=0,k8=0;function Dn(){throw Error(se(321))}function YS(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!es(t[n],e[n]))return!1;return!0}function JS(t,e,n,i,r,s){if(Hl=s,Bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zm.current=t===null||t.memoizedState===null?A8:P8,t=n(i,r),dh){s=0;do{if(dh=!1,Wh=0,25<=s)throw Error(se(301));s+=1,hn=en=null,e.updateQueue=null,zm.current=T8,t=n(i,r)}while(dh)}if(zm.current=Gg,e=en!==null&&en.next!==null,Hl=0,hn=en=Bt=null,Wg=!1,e)throw Error(se(300));return t}function ZS(){var t=Wh!==0;return Wh=0,t}function ms(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?Bt.memoizedState=hn=t:hn=hn.next=t,hn}function Tr(){if(en===null){var t=Bt.alternate;t=t!==null?t.memoizedState:null}else t=en.next;var e=hn===null?Bt.memoizedState:hn.next;if(e!==null)hn=e,en=t;else{if(t===null)throw Error(se(310));en=t,t={memoizedState:en.memoizedState,baseState:en.baseState,baseQueue:en.baseQueue,queue:en.queue,next:null},hn===null?Bt.memoizedState=hn=t:hn=hn.next=t}return hn}function Gh(t,e){return typeof e=="function"?e(t):e}function z0(t){var e=Tr(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var i=en,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((Hl&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,o=i):l=l.next=d,Bt.lanes|=c,Wl|=c}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,es(i,e.memoizedState)||(Ci=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,Bt.lanes|=s,Wl|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function U0(t){var e=Tr(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);es(s,e.memoizedState)||(Ci=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function SO(){}function kO(t,e){var n=Bt,i=Tr(),r=e(),s=!es(i.memoizedState,r);if(s&&(i.memoizedState=r,Ci=!0),i=i.queue,QS(EO.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||hn!==null&&hn.memoizedState.tag&1){if(n.flags|=2048,Kh(9,CO.bind(null,n,i,r,e),void 0,null),pn===null)throw Error(se(349));Hl&30||_O(n,e,r)}return r}function _O(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function CO(t,e,n,i){e.value=n,e.getSnapshot=i,AO(e)&&PO(t)}function EO(t,e,n){return n(function(){AO(e)&&PO(t)})}function AO(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!es(t,n)}catch{return!0}}function PO(t){var e=Eo(t,1);e!==null&&Zr(e,t,1,-1)}function cA(t){var e=ms();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gh,lastRenderedState:t},e.queue=t,t=t.dispatch=E8.bind(null,Bt,t),[e.memoizedState,t]}function Kh(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function TO(){return Tr().memoizedState}function Um(t,e,n,i){var r=ms();Bt.flags|=t,r.memoizedState=Kh(1|e,n,void 0,i===void 0?null:i)}function sy(t,e,n,i){var r=Tr();i=i===void 0?null:i;var s=void 0;if(en!==null){var o=en.memoizedState;if(s=o.destroy,i!==null&&YS(i,o.deps)){r.memoizedState=Kh(e,n,s,i);return}}Bt.flags|=t,r.memoizedState=Kh(1|e,n,s,i)}function dA(t,e){return Um(8390656,8,t,e)}function QS(t,e){return sy(2048,8,t,e)}function RO(t,e){return sy(4,2,t,e)}function NO(t,e){return sy(4,4,t,e)}function MO(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function OO(t,e,n){return n=n!=null?n.concat([t]):null,sy(4,4,MO.bind(null,e,t),n)}function ek(){}function IO(t,e){var n=Tr();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&YS(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function DO(t,e){var n=Tr();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&YS(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function LO(t,e,n){return Hl&21?(es(n,e)||(n=zM(),Bt.lanes|=n,Wl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ci=!0),t.memoizedState=n)}function _8(t,e){var n=ht;ht=n!==0&&4>n?n:4,t(!0);var i=$0.transition;$0.transition={};try{t(!1),e()}finally{ht=n,$0.transition=i}}function jO(){return Tr().memoizedState}function C8(t,e,n){var i=Ra(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},FO(t))BO(e,n);else if(n=wO(t,e,n,i),n!==null){var r=ni();Zr(n,t,i,r),$O(n,e,i)}}function E8(t,e,n){var i=Ra(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(FO(t))BO(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,es(a,o)){var l=e.interleaved;l===null?(r.next=r,WS(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=wO(t,e,r,i),n!==null&&(r=ni(),Zr(n,t,i,r),$O(n,e,i))}}function FO(t){var e=t.alternate;return t===Bt||e!==null&&e===Bt}function BO(t,e){dh=Wg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function $O(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,NS(t,n)}}var Gg={readContext:Pr,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useInsertionEffect:Dn,useLayoutEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useMutableSource:Dn,useSyncExternalStore:Dn,useId:Dn,unstable_isNewReconciler:!1},A8={readContext:Pr,useCallback:function(t,e){return ms().memoizedState=[t,e===void 0?null:e],t},useContext:Pr,useEffect:dA,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Um(4194308,4,MO.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Um(4194308,4,t,e)},useInsertionEffect:function(t,e){return Um(4,2,t,e)},useMemo:function(t,e){var n=ms();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=ms();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=C8.bind(null,Bt,t),[i.memoizedState,t]},useRef:function(t){var e=ms();return t={current:t},e.memoizedState=t},useState:cA,useDebugValue:ek,useDeferredValue:function(t){return ms().memoizedState=t},useTransition:function(){var t=cA(!1),e=t[0];return t=_8.bind(null,t[1]),ms().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=Bt,r=ms();if(It){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),pn===null)throw Error(se(349));Hl&30||_O(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,dA(EO.bind(null,i,s,t),[t]),i.flags|=2048,Kh(9,CO.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=ms(),e=pn.identifierPrefix;if(It){var n=vo,i=go;n=(i&~(1<<32-Jr(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=Wh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=k8++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},P8={readContext:Pr,useCallback:IO,useContext:Pr,useEffect:QS,useImperativeHandle:OO,useInsertionEffect:RO,useLayoutEffect:NO,useMemo:DO,useReducer:z0,useRef:TO,useState:function(){return z0(Gh)},useDebugValue:ek,useDeferredValue:function(t){var e=Tr();return LO(e,en.memoizedState,t)},useTransition:function(){var t=z0(Gh)[0],e=Tr().memoizedState;return[t,e]},useMutableSource:SO,useSyncExternalStore:kO,useId:jO,unstable_isNewReconciler:!1},T8={readContext:Pr,useCallback:IO,useContext:Pr,useEffect:QS,useImperativeHandle:OO,useInsertionEffect:RO,useLayoutEffect:NO,useMemo:DO,useReducer:U0,useRef:TO,useState:function(){return U0(Gh)},useDebugValue:ek,useDeferredValue:function(t){var e=Tr();return en===null?e.memoizedState=t:LO(e,en.memoizedState,t)},useTransition:function(){var t=U0(Gh)[0],e=Tr().memoizedState;return[t,e]},useMutableSource:SO,useSyncExternalStore:kO,useId:jO,unstable_isNewReconciler:!1};function Dr(t,e){if(t&&t.defaultProps){e=$t({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function hx(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:$t({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var oy={isMounted:function(t){return(t=t._reactInternals)?ou(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=ni(),r=Ra(t),s=bo(i,r);s.payload=e,n!=null&&(s.callback=n),e=Pa(t,s,r),e!==null&&(Zr(e,t,r,i),$m(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=ni(),r=Ra(t),s=bo(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Pa(t,s,r),e!==null&&(Zr(e,t,r,i),$m(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ni(),i=Ra(t),r=bo(n,i);r.tag=2,e!=null&&(r.callback=e),e=Pa(t,r,i),e!==null&&(Zr(e,t,i,n),$m(e,t,i))}};function hA(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!Bh(n,i)||!Bh(r,s):!0}function zO(t,e,n){var i=!1,r=La,s=e.contextType;return typeof s=="object"&&s!==null?s=Pr(s):(r=Pi(e)?Ul:Vn.current,i=e.contextTypes,s=(i=i!=null)?Cc(t,r):La),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=oy,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function fA(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&oy.enqueueReplaceState(e,e.state,null)}function fx(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},GS(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Pr(s):(s=Pi(e)?Ul:Vn.current,r.context=Cc(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(hx(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&oy.enqueueReplaceState(r,r.state,null),Vg(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Tc(t,e){try{var n="",i=e;do n+=iz(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function V0(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function px(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var R8=typeof WeakMap=="function"?WeakMap:Map;function UO(t,e,n){n=bo(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Xg||(Xg=!0,_x=i),px(t,e)},n}function VO(t,e,n){n=bo(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){px(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){px(t,e),typeof i!="function"&&(Ta===null?Ta=new Set([this]):Ta.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function pA(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new R8;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=H8.bind(null,t,e,n),e.then(t,t))}function mA(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function gA(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=bo(-1,1),e.tag=2,Pa(n,e,1))),n.lanes|=1),t)}var N8=Do.ReactCurrentOwner,Ci=!1;function Jn(t,e,n,i){e.child=t===null?yO(e,null,n,i):Ac(e,t.child,n,i)}function vA(t,e,n,i,r){n=n.render;var s=e.ref;return ic(e,r),i=JS(t,e,n,i,s,r),n=ZS(),t!==null&&!Ci?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ao(t,e,r)):(It&&n&&BS(e),e.flags|=1,Jn(t,e,i,r),e.child)}function yA(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!lk(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,HO(t,e,s,i,r)):(t=Gm(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Bh,n(o,i)&&t.ref===e.ref)return Ao(t,e,r)}return e.flags|=1,t=Na(s,i),t.ref=e.ref,t.return=e,e.child=t}function HO(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(Bh(s,i)&&t.ref===e.ref)if(Ci=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(Ci=!0);else return e.lanes=t.lanes,Ao(t,e,r)}return mx(t,e,n,i,r)}function WO(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(Uu,Fi),Fi|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_t(Uu,Fi),Fi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,_t(Uu,Fi),Fi|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,_t(Uu,Fi),Fi|=i;return Jn(t,e,r,n),e.child}function GO(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function mx(t,e,n,i,r){var s=Pi(n)?Ul:Vn.current;return s=Cc(e,s),ic(e,r),n=JS(t,e,n,i,s,r),i=ZS(),t!==null&&!Ci?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ao(t,e,r)):(It&&i&&BS(e),e.flags|=1,Jn(t,e,n,r),e.child)}function wA(t,e,n,i,r){if(Pi(n)){var s=!0;Fg(e)}else s=!1;if(ic(e,r),e.stateNode===null)Vm(t,e),zO(e,n,i),fx(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Pr(u):(u=Pi(n)?Ul:Vn.current,u=Cc(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&fA(e,o,i,u),Yo=!1;var h=e.memoizedState;o.state=h,Vg(e,i,o,r),l=e.memoizedState,a!==i||h!==l||Ai.current||Yo?(typeof c=="function"&&(hx(e,n,c,i),l=e.memoizedState),(a=Yo||hA(e,n,a,i,h,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,bO(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Dr(e.type,a),o.props=u,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Pr(l):(l=Pi(n)?Ul:Vn.current,l=Cc(e,l));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&fA(e,o,i,l),Yo=!1,h=e.memoizedState,o.state=h,Vg(e,i,o,r);var p=e.memoizedState;a!==d||h!==p||Ai.current||Yo?(typeof f=="function"&&(hx(e,n,f,i),p=e.memoizedState),(u=Yo||hA(e,n,u,i,h,p,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),o.props=i,o.state=p,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),i=!1)}return gx(t,e,n,i,s,r)}function gx(t,e,n,i,r,s){GO(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&rA(e,n,!1),Ao(t,e,s);i=e.stateNode,N8.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=Ac(e,t.child,null,s),e.child=Ac(e,null,a,s)):Jn(t,e,a,s),e.memoizedState=i.state,r&&rA(e,n,!0),e.child}function KO(t){var e=t.stateNode;e.pendingContext?iA(t,e.pendingContext,e.pendingContext!==e.context):e.context&&iA(t,e.context,!1),KS(t,e.containerInfo)}function bA(t,e,n,i,r){return Ec(),zS(r),e.flags|=256,Jn(t,e,n,i),e.child}var vx={dehydrated:null,treeContext:null,retryLane:0};function yx(t){return{baseLanes:t,cachePool:null,transitions:null}}function XO(t,e,n){var i=e.pendingProps,r=jt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),_t(jt,r&1),t===null)return cx(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=uy(o,i,0,null),t=Ll(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=yx(n),e.memoizedState=vx,t):tk(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return M8(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Na(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Na(a,s):(s=Ll(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?yx(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=vx,i}return s=t.child,t=s.sibling,i=Na(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function tk(t,e){return e=uy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fp(t,e,n,i){return i!==null&&zS(i),Ac(e,t.child,null,n),t=tk(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function M8(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=V0(Error(se(422))),Fp(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=uy({mode:"visible",children:i.children},r,0,null),s=Ll(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Ac(e,t.child,null,o),e.child.memoizedState=yx(o),e.memoizedState=vx,s);if(!(e.mode&1))return Fp(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(se(419)),i=V0(s,i,void 0),Fp(t,e,o,i)}if(a=(o&t.childLanes)!==0,Ci||a){if(i=pn,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Eo(t,r),Zr(i,t,r,-1))}return ak(),i=V0(Error(se(421))),Fp(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=W8.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,Ui=Aa(r.nextSibling),Gi=e,It=!0,zr=null,t!==null&&(cr[dr++]=go,cr[dr++]=vo,cr[dr++]=Vl,go=t.id,vo=t.overflow,Vl=e),e=tk(e,i.children),e.flags|=4096,e)}function xA(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),dx(t.return,e,n)}function H0(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function qO(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Jn(t,e,i.children,n),i=jt.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&xA(t,n,e);else if(t.tag===19)xA(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(_t(jt,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Hg(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),H0(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Hg(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}H0(e,!0,n,null,s);break;case"together":H0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Vm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ao(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Wl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=Na(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Na(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function O8(t,e,n){switch(e.tag){case 3:KO(e),Ec();break;case 5:xO(e);break;case 1:Pi(e.type)&&Fg(e);break;case 4:KS(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;_t(zg,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(_t(jt,jt.current&1),e.flags|=128,null):n&e.child.childLanes?XO(t,e,n):(_t(jt,jt.current&1),t=Ao(t,e,n),t!==null?t.sibling:null);_t(jt,jt.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return qO(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),_t(jt,jt.current),i)break;return null;case 22:case 23:return e.lanes=0,WO(t,e,n)}return Ao(t,e,n)}var YO,wx,JO,ZO;YO=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};wx=function(){};JO=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Nl(Ds.current);var s=null;switch(n){case"input":r=zb(t,r),i=zb(t,i),s=[];break;case"select":r=$t({},r,{value:void 0}),i=$t({},i,{value:void 0}),s=[];break;case"textarea":r=Hb(t,r),i=Hb(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=Lg)}Gb(n,i);var o;n=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Mh.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Mh.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ct("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};ZO=function(t,e,n,i){n!==i&&(e.flags|=4)};function wd(t,e){if(!It)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Ln(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function I8(t,e,n){var i=e.pendingProps;switch($S(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ln(e),null;case 1:return Pi(e.type)&&jg(),Ln(e),null;case 3:return i=e.stateNode,Pc(),Rt(Ai),Rt(Vn),qS(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Lp(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zr!==null&&(Ax(zr),zr=null))),wx(t,e),Ln(e),null;case 5:XS(e);var r=Nl(Hh.current);if(n=e.type,t!==null&&e.stateNode!=null)JO(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(se(166));return Ln(e),null}if(t=Nl(Ds.current),Lp(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[_s]=e,i[Uh]=s,t=(e.mode&1)!==0,n){case"dialog":Ct("cancel",i),Ct("close",i);break;case"iframe":case"object":case"embed":Ct("load",i);break;case"video":case"audio":for(r=0;r<zd.length;r++)Ct(zd[r],i);break;case"source":Ct("error",i);break;case"img":case"image":case"link":Ct("error",i),Ct("load",i);break;case"details":Ct("toggle",i);break;case"input":RE(i,s),Ct("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Ct("invalid",i);break;case"textarea":ME(i,s),Ct("invalid",i)}Gb(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Dp(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Dp(i.textContent,a,t),r=["children",""+a]):Mh.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ct("scroll",i)}switch(n){case"input":Ap(i),NE(i,s,!0);break;case"textarea":Ap(i),OE(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Lg)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=EM(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[_s]=e,t[Uh]=i,YO(t,e,!1,!1),e.stateNode=t;e:{switch(o=Kb(n,i),n){case"dialog":Ct("cancel",t),Ct("close",t),r=i;break;case"iframe":case"object":case"embed":Ct("load",t),r=i;break;case"video":case"audio":for(r=0;r<zd.length;r++)Ct(zd[r],t);r=i;break;case"source":Ct("error",t),r=i;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),r=i;break;case"details":Ct("toggle",t),r=i;break;case"input":RE(t,i),r=zb(t,i),Ct("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=$t({},i,{value:void 0}),Ct("invalid",t);break;case"textarea":ME(t,i),r=Hb(t,i),Ct("invalid",t);break;default:r=i}Gb(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?TM(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&AM(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Oh(t,l):typeof l=="number"&&Oh(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Mh.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ct("scroll",t):l!=null&&CS(t,s,l,o))}switch(n){case"input":Ap(t),NE(t,i,!1);break;case"textarea":Ap(t),OE(t);break;case"option":i.value!=null&&t.setAttribute("value",""+Da(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?Qu(t,!!i.multiple,s,!1):i.defaultValue!=null&&Qu(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Lg)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ln(e),null;case 6:if(t&&e.stateNode!=null)ZO(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(se(166));if(n=Nl(Hh.current),Nl(Ds.current),Lp(e)){if(i=e.stateNode,n=e.memoizedProps,i[_s]=e,(s=i.nodeValue!==n)&&(t=Gi,t!==null))switch(t.tag){case 3:Dp(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Dp(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[_s]=e,e.stateNode=i}return Ln(e),null;case 13:if(Rt(jt),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(It&&Ui!==null&&e.mode&1&&!(e.flags&128))gO(),Ec(),e.flags|=98560,s=!1;else if(s=Lp(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(se(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(se(317));s[_s]=e}else Ec(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ln(e),s=!1}else zr!==null&&(Ax(zr),zr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||jt.current&1?an===0&&(an=3):ak())),e.updateQueue!==null&&(e.flags|=4),Ln(e),null);case 4:return Pc(),wx(t,e),t===null&&$h(e.stateNode.containerInfo),Ln(e),null;case 10:return HS(e.type._context),Ln(e),null;case 17:return Pi(e.type)&&jg(),Ln(e),null;case 19:if(Rt(jt),s=e.memoizedState,s===null)return Ln(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)wd(s,!1);else{if(an!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Hg(t),o!==null){for(e.flags|=128,wd(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _t(jt,jt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Kt()>Rc&&(e.flags|=128,i=!0,wd(s,!1),e.lanes=4194304)}else{if(!i)if(t=Hg(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),wd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!It)return Ln(e),null}else 2*Kt()-s.renderingStartTime>Rc&&n!==1073741824&&(e.flags|=128,i=!0,wd(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Kt(),e.sibling=null,n=jt.current,_t(jt,i?n&1|2:n&1),e):(Ln(e),null);case 22:case 23:return ok(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Fi&1073741824&&(Ln(e),e.subtreeFlags&6&&(e.flags|=8192)):Ln(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function D8(t,e){switch($S(e),e.tag){case 1:return Pi(e.type)&&jg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Pc(),Rt(Ai),Rt(Vn),qS(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return XS(e),null;case 13:if(Rt(jt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));Ec()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Rt(jt),null;case 4:return Pc(),null;case 10:return HS(e.type._context),null;case 22:case 23:return ok(),null;case 24:return null;default:return null}}var Bp=!1,$n=!1,L8=typeof WeakSet=="function"?WeakSet:Set,xe=null;function zu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Ut(t,e,i)}else n.current=null}function bx(t,e,n){try{n()}catch(i){Ut(t,e,i)}}var SA=!1;function j8(t,e){if(ix=Og,t=iO(),FS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,d=t,h=null;t:for(;;){for(var f;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(l=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++u===r&&(a=o),h===s&&++c===i&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(rx={focusedElem:t,selectionRange:n},Og=!1,xe=e;xe!==null;)if(e=xe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,xe=t;else for(;xe!==null;){e=xe;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,w=p.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:Dr(e.type,m),w);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(k){Ut(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,xe=t;break}xe=e.return}return p=SA,SA=!1,p}function hh(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&bx(e,n,s)}r=r.next}while(r!==i)}}function ay(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function xx(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function QO(t){var e=t.alternate;e!==null&&(t.alternate=null,QO(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[_s],delete e[Uh],delete e[ax],delete e[w8],delete e[b8])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function e2(t){return t.tag===5||t.tag===3||t.tag===4}function kA(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||e2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sx(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Lg));else if(i!==4&&(t=t.child,t!==null))for(Sx(t,e,n),t=t.sibling;t!==null;)Sx(t,e,n),t=t.sibling}function kx(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(kx(t,e,n),t=t.sibling;t!==null;)kx(t,e,n),t=t.sibling}var yn=null,Br=!1;function Ho(t,e,n){for(n=n.child;n!==null;)t2(t,e,n),n=n.sibling}function t2(t,e,n){if(Is&&typeof Is.onCommitFiberUnmount=="function")try{Is.onCommitFiberUnmount(Qv,n)}catch{}switch(n.tag){case 5:$n||zu(n,e);case 6:var i=yn,r=Br;yn=null,Ho(t,e,n),yn=i,Br=r,yn!==null&&(Br?(t=yn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):yn.removeChild(n.stateNode));break;case 18:yn!==null&&(Br?(t=yn,n=n.stateNode,t.nodeType===8?j0(t.parentNode,n):t.nodeType===1&&j0(t,n),jh(t)):j0(yn,n.stateNode));break;case 4:i=yn,r=Br,yn=n.stateNode.containerInfo,Br=!0,Ho(t,e,n),yn=i,Br=r;break;case 0:case 11:case 14:case 15:if(!$n&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&bx(n,e,o),r=r.next}while(r!==i)}Ho(t,e,n);break;case 1:if(!$n&&(zu(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Ut(n,e,a)}Ho(t,e,n);break;case 21:Ho(t,e,n);break;case 22:n.mode&1?($n=(i=$n)||n.memoizedState!==null,Ho(t,e,n),$n=i):Ho(t,e,n);break;default:Ho(t,e,n)}}function _A(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new L8),e.forEach(function(i){var r=G8.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function Mr(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:yn=a.stateNode,Br=!1;break e;case 3:yn=a.stateNode.containerInfo,Br=!0;break e;case 4:yn=a.stateNode.containerInfo,Br=!0;break e}a=a.return}if(yn===null)throw Error(se(160));t2(s,o,r),yn=null,Br=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Ut(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)n2(e,t),e=e.sibling}function n2(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Mr(e,t),cs(t),i&4){try{hh(3,t,t.return),ay(3,t)}catch(m){Ut(t,t.return,m)}try{hh(5,t,t.return)}catch(m){Ut(t,t.return,m)}}break;case 1:Mr(e,t),cs(t),i&512&&n!==null&&zu(n,n.return);break;case 5:if(Mr(e,t),cs(t),i&512&&n!==null&&zu(n,n.return),t.flags&32){var r=t.stateNode;try{Oh(r,"")}catch(m){Ut(t,t.return,m)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&_M(r,s),Kb(a,o);var u=Kb(a,s);for(o=0;o<l.length;o+=2){var c=l[o],d=l[o+1];c==="style"?TM(r,d):c==="dangerouslySetInnerHTML"?AM(r,d):c==="children"?Oh(r,d):CS(r,c,d,u)}switch(a){case"input":Ub(r,s);break;case"textarea":CM(r,s);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Qu(r,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?Qu(r,!!s.multiple,s.defaultValue,!0):Qu(r,!!s.multiple,s.multiple?[]:"",!1))}r[Uh]=s}catch(m){Ut(t,t.return,m)}}break;case 6:if(Mr(e,t),cs(t),i&4){if(t.stateNode===null)throw Error(se(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(m){Ut(t,t.return,m)}}break;case 3:if(Mr(e,t),cs(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{jh(e.containerInfo)}catch(m){Ut(t,t.return,m)}break;case 4:Mr(e,t),cs(t);break;case 13:Mr(e,t),cs(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(rk=Kt())),i&4&&_A(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?($n=(u=$n)||c,Mr(e,t),$n=u):Mr(e,t),cs(t),i&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(xe=t,c=t.child;c!==null;){for(d=xe=c;xe!==null;){switch(h=xe,f=h.child,h.tag){case 0:case 11:case 14:case 15:hh(4,h,h.return);break;case 1:zu(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){i=h,n=h.return;try{e=i,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Ut(i,n,m)}}break;case 5:zu(h,h.return);break;case 22:if(h.memoizedState!==null){EA(d);continue}}f!==null?(f.return=h,xe=f):EA(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{r=d.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=PM("display",o))}catch(m){Ut(t,t.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Ut(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Mr(e,t),cs(t),i&4&&_A(t);break;case 21:break;default:Mr(e,t),cs(t)}}function cs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(e2(n)){var i=n;break e}n=n.return}throw Error(se(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Oh(r,""),i.flags&=-33);var s=kA(t);kx(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=kA(t);Sx(t,a,o);break;default:throw Error(se(161))}}catch(l){Ut(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function F8(t,e,n){xe=t,i2(t)}function i2(t,e,n){for(var i=(t.mode&1)!==0;xe!==null;){var r=xe,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||Bp;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||$n;a=Bp;var u=$n;if(Bp=o,($n=l)&&!u)for(xe=r;xe!==null;)o=xe,l=o.child,o.tag===22&&o.memoizedState!==null?AA(r):l!==null?(l.return=o,xe=l):AA(r);for(;s!==null;)xe=s,i2(s),s=s.sibling;xe=r,Bp=a,$n=u}CA(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,xe=s):CA(t)}}function CA(t){for(;xe!==null;){var e=xe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$n||ay(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!$n)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Dr(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&uA(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}uA(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&jh(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}$n||e.flags&512&&xx(e)}catch(h){Ut(e,e.return,h)}}if(e===t){xe=null;break}if(n=e.sibling,n!==null){n.return=e.return,xe=n;break}xe=e.return}}function EA(t){for(;xe!==null;){var e=xe;if(e===t){xe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,xe=n;break}xe=e.return}}function AA(t){for(;xe!==null;){var e=xe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ay(4,e)}catch(l){Ut(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){Ut(e,r,l)}}var s=e.return;try{xx(e)}catch(l){Ut(e,s,l)}break;case 5:var o=e.return;try{xx(e)}catch(l){Ut(e,o,l)}}}catch(l){Ut(e,e.return,l)}if(e===t){xe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,xe=a;break}xe=e.return}}var B8=Math.ceil,Kg=Do.ReactCurrentDispatcher,nk=Do.ReactCurrentOwner,xr=Do.ReactCurrentBatchConfig,st=0,pn=null,Jt=null,Mn=0,Fi=0,Uu=Qa(0),an=0,Xh=null,Wl=0,ly=0,ik=0,fh=null,wi=null,rk=0,Rc=1/0,Js=null,Xg=!1,_x=null,Ta=null,$p=!1,ha=null,qg=0,ph=0,Cx=null,Hm=-1,Wm=0;function ni(){return st&6?Kt():Hm!==-1?Hm:Hm=Kt()}function Ra(t){return t.mode&1?st&2&&Mn!==0?Mn&-Mn:S8.transition!==null?(Wm===0&&(Wm=zM()),Wm):(t=ht,t!==0||(t=window.event,t=t===void 0?16:XM(t.type)),t):1}function Zr(t,e,n,i){if(50<ph)throw ph=0,Cx=null,Error(se(185));zf(t,n,i),(!(st&2)||t!==pn)&&(t===pn&&(!(st&2)&&(ly|=n),an===4&&na(t,Mn)),Ti(t,i),n===1&&st===0&&!(e.mode&1)&&(Rc=Kt()+500,ry&&el()))}function Ti(t,e){var n=t.callbackNode;Sz(t,e);var i=Mg(t,t===pn?Mn:0);if(i===0)n!==null&&LE(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&LE(n),e===1)t.tag===0?x8(PA.bind(null,t)):fO(PA.bind(null,t)),v8(function(){!(st&6)&&el()}),n=null;else{switch(UM(i)){case 1:n=RS;break;case 4:n=BM;break;case 16:n=Ng;break;case 536870912:n=$M;break;default:n=Ng}n=d2(n,r2.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function r2(t,e){if(Hm=-1,Wm=0,st&6)throw Error(se(327));var n=t.callbackNode;if(rc()&&t.callbackNode!==n)return null;var i=Mg(t,t===pn?Mn:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Yg(t,i);else{e=i;var r=st;st|=2;var s=o2();(pn!==t||Mn!==e)&&(Js=null,Rc=Kt()+500,Dl(t,e));do try{U8();break}catch(a){s2(t,a)}while(!0);VS(),Kg.current=s,st=r,Jt!==null?e=0:(pn=null,Mn=0,e=an)}if(e!==0){if(e===2&&(r=Zb(t),r!==0&&(i=r,e=Ex(t,r))),e===1)throw n=Xh,Dl(t,0),na(t,i),Ti(t,Kt()),n;if(e===6)na(t,i);else{if(r=t.current.alternate,!(i&30)&&!$8(r)&&(e=Yg(t,i),e===2&&(s=Zb(t),s!==0&&(i=s,e=Ex(t,s))),e===1))throw n=Xh,Dl(t,0),na(t,i),Ti(t,Kt()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(se(345));case 2:bl(t,wi,Js);break;case 3:if(na(t,i),(i&130023424)===i&&(e=rk+500-Kt(),10<e)){if(Mg(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){ni(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ox(bl.bind(null,t,wi,Js),e);break}bl(t,wi,Js);break;case 4:if(na(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Jr(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Kt()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*B8(i/1960))-i,10<i){t.timeoutHandle=ox(bl.bind(null,t,wi,Js),i);break}bl(t,wi,Js);break;case 5:bl(t,wi,Js);break;default:throw Error(se(329))}}}return Ti(t,Kt()),t.callbackNode===n?r2.bind(null,t):null}function Ex(t,e){var n=fh;return t.current.memoizedState.isDehydrated&&(Dl(t,e).flags|=256),t=Yg(t,e),t!==2&&(e=wi,wi=n,e!==null&&Ax(e)),t}function Ax(t){wi===null?wi=t:wi.push.apply(wi,t)}function $8(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!es(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function na(t,e){for(e&=~ik,e&=~ly,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Jr(e),i=1<<n;t[n]=-1,e&=~i}}function PA(t){if(st&6)throw Error(se(327));rc();var e=Mg(t,0);if(!(e&1))return Ti(t,Kt()),null;var n=Yg(t,e);if(t.tag!==0&&n===2){var i=Zb(t);i!==0&&(e=i,n=Ex(t,i))}if(n===1)throw n=Xh,Dl(t,0),na(t,e),Ti(t,Kt()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,bl(t,wi,Js),Ti(t,Kt()),null}function sk(t,e){var n=st;st|=1;try{return t(e)}finally{st=n,st===0&&(Rc=Kt()+500,ry&&el())}}function Gl(t){ha!==null&&ha.tag===0&&!(st&6)&&rc();var e=st;st|=1;var n=xr.transition,i=ht;try{if(xr.transition=null,ht=1,t)return t()}finally{ht=i,xr.transition=n,st=e,!(st&6)&&el()}}function ok(){Fi=Uu.current,Rt(Uu)}function Dl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,g8(n)),Jt!==null)for(n=Jt.return;n!==null;){var i=n;switch($S(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&jg();break;case 3:Pc(),Rt(Ai),Rt(Vn),qS();break;case 5:XS(i);break;case 4:Pc();break;case 13:Rt(jt);break;case 19:Rt(jt);break;case 10:HS(i.type._context);break;case 22:case 23:ok()}n=n.return}if(pn=t,Jt=t=Na(t.current,null),Mn=Fi=e,an=0,Xh=null,ik=ly=Wl=0,wi=fh=null,Rl!==null){for(e=0;e<Rl.length;e++)if(n=Rl[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}Rl=null}return t}function s2(t,e){do{var n=Jt;try{if(VS(),zm.current=Gg,Wg){for(var i=Bt.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Wg=!1}if(Hl=0,hn=en=Bt=null,dh=!1,Wh=0,nk.current=null,n===null||n.return===null){an=1,Xh=e,Jt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Mn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=mA(o);if(f!==null){f.flags&=-257,gA(f,o,a,s,e),f.mode&1&&pA(s,u,e),e=f,l=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){pA(s,u,e),ak();break e}l=Error(se(426))}}else if(It&&a.mode&1){var w=mA(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),gA(w,o,a,s,e),zS(Tc(l,a));break e}}s=l=Tc(l,a),an!==4&&(an=2),fh===null?fh=[s]:fh.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=UO(s,l,e);lA(s,v);break e;case 1:a=l;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ta===null||!Ta.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var k=VO(s,a,e);lA(s,k);break e}}s=s.return}while(s!==null)}l2(n)}catch(_){e=_,Jt===n&&n!==null&&(Jt=n=n.return);continue}break}while(!0)}function o2(){var t=Kg.current;return Kg.current=Gg,t===null?Gg:t}function ak(){(an===0||an===3||an===2)&&(an=4),pn===null||!(Wl&268435455)&&!(ly&268435455)||na(pn,Mn)}function Yg(t,e){var n=st;st|=2;var i=o2();(pn!==t||Mn!==e)&&(Js=null,Dl(t,e));do try{z8();break}catch(r){s2(t,r)}while(!0);if(VS(),st=n,Kg.current=i,Jt!==null)throw Error(se(261));return pn=null,Mn=0,an}function z8(){for(;Jt!==null;)a2(Jt)}function U8(){for(;Jt!==null&&!fz();)a2(Jt)}function a2(t){var e=c2(t.alternate,t,Fi);t.memoizedProps=t.pendingProps,e===null?l2(t):Jt=e,nk.current=null}function l2(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=D8(n,e),n!==null){n.flags&=32767,Jt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{an=6,Jt=null;return}}else if(n=I8(n,e,Fi),n!==null){Jt=n;return}if(e=e.sibling,e!==null){Jt=e;return}Jt=e=t}while(e!==null);an===0&&(an=5)}function bl(t,e,n){var i=ht,r=xr.transition;try{xr.transition=null,ht=1,V8(t,e,n,i)}finally{xr.transition=r,ht=i}return null}function V8(t,e,n,i){do rc();while(ha!==null);if(st&6)throw Error(se(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(kz(t,s),t===pn&&(Jt=pn=null,Mn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||$p||($p=!0,d2(Ng,function(){return rc(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=xr.transition,xr.transition=null;var o=ht;ht=1;var a=st;st|=4,nk.current=null,j8(t,n),n2(n,t),u8(rx),Og=!!ix,rx=ix=null,t.current=n,F8(n),pz(),st=a,ht=o,xr.transition=s}else t.current=n;if($p&&($p=!1,ha=t,qg=r),s=t.pendingLanes,s===0&&(Ta=null),vz(n.stateNode),Ti(t,Kt()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Xg)throw Xg=!1,t=_x,_x=null,t;return qg&1&&t.tag!==0&&rc(),s=t.pendingLanes,s&1?t===Cx?ph++:(ph=0,Cx=t):ph=0,el(),null}function rc(){if(ha!==null){var t=UM(qg),e=xr.transition,n=ht;try{if(xr.transition=null,ht=16>t?16:t,ha===null)var i=!1;else{if(t=ha,ha=null,qg=0,st&6)throw Error(se(331));var r=st;for(st|=4,xe=t.current;xe!==null;){var s=xe,o=s.child;if(xe.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(xe=u;xe!==null;){var c=xe;switch(c.tag){case 0:case 11:case 15:hh(8,c,s)}var d=c.child;if(d!==null)d.return=c,xe=d;else for(;xe!==null;){c=xe;var h=c.sibling,f=c.return;if(QO(c),c===u){xe=null;break}if(h!==null){h.return=f,xe=h;break}xe=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}xe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,xe=o;else e:for(;xe!==null;){if(s=xe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:hh(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,xe=v;break e}xe=s.return}}var y=t.current;for(xe=y;xe!==null;){o=xe;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,xe=b;else e:for(o=y;xe!==null;){if(a=xe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ay(9,a)}}catch(_){Ut(a,a.return,_)}if(a===o){xe=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,xe=k;break e}xe=a.return}}if(st=r,el(),Is&&typeof Is.onPostCommitFiberRoot=="function")try{Is.onPostCommitFiberRoot(Qv,t)}catch{}i=!0}return i}finally{ht=n,xr.transition=e}}return!1}function TA(t,e,n){e=Tc(n,e),e=UO(t,e,1),t=Pa(t,e,1),e=ni(),t!==null&&(zf(t,1,e),Ti(t,e))}function Ut(t,e,n){if(t.tag===3)TA(t,t,n);else for(;e!==null;){if(e.tag===3){TA(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Ta===null||!Ta.has(i))){t=Tc(n,t),t=VO(e,t,1),e=Pa(e,t,1),t=ni(),e!==null&&(zf(e,1,t),Ti(e,t));break}}e=e.return}}function H8(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=ni(),t.pingedLanes|=t.suspendedLanes&n,pn===t&&(Mn&n)===n&&(an===4||an===3&&(Mn&130023424)===Mn&&500>Kt()-rk?Dl(t,0):ik|=n),Ti(t,e)}function u2(t,e){e===0&&(t.mode&1?(e=Rp,Rp<<=1,!(Rp&130023424)&&(Rp=4194304)):e=1);var n=ni();t=Eo(t,e),t!==null&&(zf(t,e,n),Ti(t,n))}function W8(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),u2(t,n)}function G8(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(se(314))}i!==null&&i.delete(e),u2(t,n)}var c2;c2=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ai.current)Ci=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ci=!1,O8(t,e,n);Ci=!!(t.flags&131072)}else Ci=!1,It&&e.flags&1048576&&pO(e,$g,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Vm(t,e),t=e.pendingProps;var r=Cc(e,Vn.current);ic(e,n),r=JS(null,e,i,t,r,n);var s=ZS();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pi(i)?(s=!0,Fg(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,GS(e),r.updater=oy,e.stateNode=r,r._reactInternals=e,fx(e,i,t,n),e=gx(null,e,i,!0,s,n)):(e.tag=0,It&&s&&BS(e),Jn(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(Vm(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=X8(i),t=Dr(i,t),r){case 0:e=mx(null,e,i,t,n);break e;case 1:e=wA(null,e,i,t,n);break e;case 11:e=vA(null,e,i,t,n);break e;case 14:e=yA(null,e,i,Dr(i.type,t),n);break e}throw Error(se(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Dr(i,r),mx(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Dr(i,r),wA(t,e,i,r,n);case 3:e:{if(KO(e),t===null)throw Error(se(387));i=e.pendingProps,s=e.memoizedState,r=s.element,bO(t,e),Vg(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Tc(Error(se(423)),e),e=bA(t,e,i,n,r);break e}else if(i!==r){r=Tc(Error(se(424)),e),e=bA(t,e,i,n,r);break e}else for(Ui=Aa(e.stateNode.containerInfo.firstChild),Gi=e,It=!0,zr=null,n=yO(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ec(),i===r){e=Ao(t,e,n);break e}Jn(t,e,i,n)}e=e.child}return e;case 5:return xO(e),t===null&&cx(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,sx(i,r)?o=null:s!==null&&sx(i,s)&&(e.flags|=32),GO(t,e),Jn(t,e,o,n),e.child;case 6:return t===null&&cx(e),null;case 13:return XO(t,e,n);case 4:return KS(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=Ac(e,null,i,n):Jn(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Dr(i,r),vA(t,e,i,r,n);case 7:return Jn(t,e,e.pendingProps,n),e.child;case 8:return Jn(t,e,e.pendingProps.children,n),e.child;case 12:return Jn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,_t(zg,i._currentValue),i._currentValue=o,s!==null)if(es(s.value,o)){if(s.children===r.children&&!Ai.current){e=Ao(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=bo(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),dx(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(se(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),dx(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Jn(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,ic(e,n),r=Pr(r),i=i(r),e.flags|=1,Jn(t,e,i,n),e.child;case 14:return i=e.type,r=Dr(i,e.pendingProps),r=Dr(i.type,r),yA(t,e,i,r,n);case 15:return HO(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Dr(i,r),Vm(t,e),e.tag=1,Pi(i)?(t=!0,Fg(e)):t=!1,ic(e,n),zO(e,i,r),fx(e,i,r,n),gx(null,e,i,!0,t,n);case 19:return qO(t,e,n);case 22:return WO(t,e,n)}throw Error(se(156,e.tag))};function d2(t,e){return FM(t,e)}function K8(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mr(t,e,n,i){return new K8(t,e,n,i)}function lk(t){return t=t.prototype,!(!t||!t.isReactComponent)}function X8(t){if(typeof t=="function")return lk(t)?1:0;if(t!=null){if(t=t.$$typeof,t===AS)return 11;if(t===PS)return 14}return 2}function Na(t,e){var n=t.alternate;return n===null?(n=mr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Gm(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")lk(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Mu:return Ll(n.children,r,s,e);case ES:o=8,r|=8;break;case jb:return t=mr(12,n,e,r|2),t.elementType=jb,t.lanes=s,t;case Fb:return t=mr(13,n,e,r),t.elementType=Fb,t.lanes=s,t;case Bb:return t=mr(19,n,e,r),t.elementType=Bb,t.lanes=s,t;case xM:return uy(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case wM:o=10;break e;case bM:o=9;break e;case AS:o=11;break e;case PS:o=14;break e;case qo:o=16,i=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=mr(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function Ll(t,e,n,i){return t=mr(7,t,i,e),t.lanes=n,t}function uy(t,e,n,i){return t=mr(22,t,i,e),t.elementType=xM,t.lanes=n,t.stateNode={isHidden:!1},t}function W0(t,e,n){return t=mr(6,t,null,e),t.lanes=n,t}function G0(t,e,n){return e=mr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function q8(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=E0(0),this.expirationTimes=E0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=E0(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function uk(t,e,n,i,r,s,o,a,l){return t=new q8(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=mr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},GS(s),t}function Y8(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Nu,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function h2(t){if(!t)return La;t=t._reactInternals;e:{if(ou(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(Pi(n))return hO(t,n,e)}return e}function f2(t,e,n,i,r,s,o,a,l){return t=uk(n,i,!0,t,r,s,o,a,l),t.context=h2(null),n=t.current,i=ni(),r=Ra(n),s=bo(i,r),s.callback=e??null,Pa(n,s,r),t.current.lanes=r,zf(t,r,i),Ti(t,i),t}function cy(t,e,n,i){var r=e.current,s=ni(),o=Ra(r);return n=h2(n),e.context===null?e.context=n:e.pendingContext=n,e=bo(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Pa(r,e,o),t!==null&&(Zr(t,r,o,s),$m(t,r,o)),o}function Jg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function RA(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ck(t,e){RA(t,e),(t=t.alternate)&&RA(t,e)}function J8(){return null}var p2=typeof reportError=="function"?reportError:function(t){console.error(t)};function dk(t){this._internalRoot=t}dy.prototype.render=dk.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));cy(t,e,null,null)};dy.prototype.unmount=dk.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Gl(function(){cy(null,t,null,null)}),e[Co]=null}};function dy(t){this._internalRoot=t}dy.prototype.unstable_scheduleHydration=function(t){if(t){var e=WM();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ta.length&&e!==0&&e<ta[n].priority;n++);ta.splice(n,0,t),n===0&&KM(t)}};function hk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function NA(){}function Z8(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=Jg(o);s.call(u)}}var o=f2(e,i,t,0,null,!1,!1,"",NA);return t._reactRootContainer=o,t[Co]=o.current,$h(t.nodeType===8?t.parentNode:t),Gl(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=Jg(l);a.call(u)}}var l=uk(t,0,!1,null,null,!1,!1,"",NA);return t._reactRootContainer=l,t[Co]=l.current,$h(t.nodeType===8?t.parentNode:t),Gl(function(){cy(e,l,n,i)}),l}function fy(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=Jg(o);a.call(l)}}cy(e,o,t,r)}else o=Z8(n,e,t,r,i);return Jg(o)}VM=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=$d(e.pendingLanes);n!==0&&(NS(e,n|1),Ti(e,Kt()),!(st&6)&&(Rc=Kt()+500,el()))}break;case 13:Gl(function(){var i=Eo(t,1);if(i!==null){var r=ni();Zr(i,t,1,r)}}),ck(t,1)}};MS=function(t){if(t.tag===13){var e=Eo(t,134217728);if(e!==null){var n=ni();Zr(e,t,134217728,n)}ck(t,134217728)}};HM=function(t){if(t.tag===13){var e=Ra(t),n=Eo(t,e);if(n!==null){var i=ni();Zr(n,t,e,i)}ck(t,e)}};WM=function(){return ht};GM=function(t,e){var n=ht;try{return ht=t,e()}finally{ht=n}};qb=function(t,e,n){switch(e){case"input":if(Ub(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=iy(i);if(!r)throw Error(se(90));kM(i),Ub(i,r)}}}break;case"textarea":CM(t,n);break;case"select":e=n.value,e!=null&&Qu(t,!!n.multiple,e,!1)}};MM=sk;OM=Gl;var Q8={usingClientEntryPoint:!1,Events:[Vf,Lu,iy,RM,NM,sk]},bd={findFiberByHostInstance:Tl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},e6={bundleType:bd.bundleType,version:bd.version,rendererPackageName:bd.rendererPackageName,rendererConfig:bd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Do.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=LM(t),t===null?null:t.stateNode},findFiberByHostInstance:bd.findFiberByHostInstance||J8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zp.isDisabled&&zp.supportsFiber)try{Qv=zp.inject(e6),Is=zp}catch{}}Ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q8;Ji.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hk(e))throw Error(se(200));return Y8(t,e,null,n)};Ji.createRoot=function(t,e){if(!hk(t))throw Error(se(299));var n=!1,i="",r=p2;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=uk(t,1,!1,null,null,n,!1,i,r),t[Co]=e.current,$h(t.nodeType===8?t.parentNode:t),new dk(e)};Ji.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=LM(e),t=t===null?null:t.stateNode,t};Ji.flushSync=function(t){return Gl(t)};Ji.hydrate=function(t,e,n){if(!hy(e))throw Error(se(200));return fy(null,t,e,!0,n)};Ji.hydrateRoot=function(t,e,n){if(!hk(t))throw Error(se(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=p2;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=f2(e,null,t,1,n??null,r,!1,s,o),t[Co]=e.current,$h(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new dy(e)};Ji.render=function(t,e,n){if(!hy(e))throw Error(se(200));return fy(null,t,e,!1,n)};Ji.unmountComponentAtNode=function(t){if(!hy(t))throw Error(se(40));return t._reactRootContainer?(Gl(function(){fy(null,null,t,!1,function(){t._reactRootContainer=null,t[Co]=null})}),!0):!1};Ji.unstable_batchedUpdates=sk;Ji.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!hy(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return fy(t,e,n,!1,i)};Ji.version="18.3.1-next-f1338f8080-20240426";function m2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(m2)}catch(t){console.error(t)}}m2(),mM.exports=Ji;var Lo=mM.exports;const t6=Yc(Lo);var MA=Lo;Db.createRoot=MA.createRoot,Db.hydrateRoot=MA.hydrateRoot;function fe(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function ls(t,e=[]){let n=[];function i(s,o){const a=S.createContext(o),l=n.length;n=[...n,o];function u(d){const{scope:h,children:f,...p}=d,m=(h==null?void 0:h[t][l])||a,w=S.useMemo(()=>p,Object.values(p));return g.jsx(m.Provider,{value:w,children:f})}function c(d,h){const f=(h==null?void 0:h[t][l])||a,p=S.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return u.displayName=s+"Provider",[u,c]}const r=()=>{const s=n.map(o=>S.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return S.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[i,n6(r,...e)]}function n6(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const i=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=i.reduce((a,{useScope:l,scopeName:u})=>{const d=l(s)[`__scope${u}`];return{...a,...d}},{});return S.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function i6(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function py(...t){return e=>t.forEach(n=>i6(n,e))}function rt(...t){return S.useCallback(py(...t),t)}var Kl=S.forwardRef((t,e)=>{const{children:n,...i}=t,r=S.Children.toArray(n),s=r.find(s6);if(s){const o=s.props.children,a=r.map(l=>l===s?S.Children.count(o)>1?S.Children.only(null):S.isValidElement(o)?o.props.children:null:l);return g.jsx(Px,{...i,ref:e,children:S.isValidElement(o)?S.cloneElement(o,void 0,a):null})}return g.jsx(Px,{...i,ref:e,children:n})});Kl.displayName="Slot";var Px=S.forwardRef((t,e)=>{const{children:n,...i}=t;if(S.isValidElement(n)){const r=a6(n);return S.cloneElement(n,{...o6(i,n.props),ref:e?py(e,r):r})}return S.Children.count(n)>1?S.Children.only(null):null});Px.displayName="SlotClone";var r6=({children:t})=>g.jsx(g.Fragment,{children:t});function s6(t){return S.isValidElement(t)&&t.type===r6}function o6(t,e){const n={...e};for(const i in e){const r=t[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?n[i]=(...a)=>{s(...a),r(...a)}:r&&(n[i]=r):i==="style"?n[i]={...r,...s}:i==="className"&&(n[i]=[r,s].filter(Boolean).join(" "))}return{...t,...n}}function a6(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Wf(t){const e=t+"CollectionProvider",[n,i]=ls(e),[r,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=f=>{const{scope:p,children:m}=f,w=fn.useRef(null),v=fn.useRef(new Map).current;return g.jsx(r,{scope:p,itemMap:v,collectionRef:w,children:m})};o.displayName=e;const a=t+"CollectionSlot",l=fn.forwardRef((f,p)=>{const{scope:m,children:w}=f,v=s(a,m),y=rt(p,v.collectionRef);return g.jsx(Kl,{ref:y,children:w})});l.displayName=a;const u=t+"CollectionItemSlot",c="data-radix-collection-item",d=fn.forwardRef((f,p)=>{const{scope:m,children:w,...v}=f,y=fn.useRef(null),b=rt(p,y),k=s(u,m);return fn.useEffect(()=>(k.itemMap.set(y,{ref:y,...v}),()=>void k.itemMap.delete(y))),g.jsx(Kl,{[c]:"",ref:b,children:w})});d.displayName=u;function h(f){const p=s(t+"CollectionConsumer",f);return fn.useCallback(()=>{const w=p.collectionRef.current;if(!w)return[];const v=Array.from(w.querySelectorAll(`[${c}]`));return Array.from(p.itemMap.values()).sort((k,_)=>v.indexOf(k.ref.current)-v.indexOf(_.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:o,Slot:l,ItemSlot:d},h,i]}var Hn=globalThis!=null&&globalThis.document?S.useLayoutEffect:()=>{},l6=fS.useId||(()=>{}),u6=0;function ja(t){const[e,n]=S.useState(l6());return Hn(()=>{n(i=>i??String(u6++))},[t]),e?`radix-${e}`:""}var c6=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Fe=c6.reduce((t,e)=>{const n=S.forwardRef((i,r)=>{const{asChild:s,...o}=i,a=s?Kl:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),g.jsx(a,{...o,ref:r})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function fk(t,e){t&&Lo.flushSync(()=>t.dispatchEvent(e))}function Wn(t){const e=S.useRef(t);return S.useEffect(()=>{e.current=t}),S.useMemo(()=>(...n)=>{var i;return(i=e.current)==null?void 0:i.call(e,...n)},[])}function Po({prop:t,defaultProp:e,onChange:n=()=>{}}){const[i,r]=d6({defaultProp:e,onChange:n}),s=t!==void 0,o=s?t:i,a=Wn(n),l=S.useCallback(u=>{if(s){const d=typeof u=="function"?u(t):u;d!==t&&a(d)}else r(u)},[s,t,r,a]);return[o,l]}function d6({defaultProp:t,onChange:e}){const n=S.useState(t),[i]=n,r=S.useRef(i),s=Wn(e);return S.useEffect(()=>{r.current!==i&&(s(i),r.current=i)},[i,r,s]),n}var h6=S.createContext(void 0);function Gf(t){const e=S.useContext(h6);return t||e||"ltr"}var K0="rovingFocusGroup.onEntryFocus",f6={bubbles:!1,cancelable:!0},my="RovingFocusGroup",[Tx,g2,p6]=Wf(my),[m6,gy]=ls(my,[p6]),[g6,v6]=m6(my),v2=S.forwardRef((t,e)=>g.jsx(Tx.Provider,{scope:t.__scopeRovingFocusGroup,children:g.jsx(Tx.Slot,{scope:t.__scopeRovingFocusGroup,children:g.jsx(y6,{...t,ref:e})})}));v2.displayName=my;var y6=S.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:r=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:c=!1,...d}=t,h=S.useRef(null),f=rt(e,h),p=Gf(s),[m=null,w]=Po({prop:o,defaultProp:a,onChange:l}),[v,y]=S.useState(!1),b=Wn(u),k=g2(n),_=S.useRef(!1),[E,A]=S.useState(0);return S.useEffect(()=>{const P=h.current;if(P)return P.addEventListener(K0,b),()=>P.removeEventListener(K0,b)},[b]),g.jsx(g6,{scope:n,orientation:i,dir:p,loop:r,currentTabStopId:m,onItemFocus:S.useCallback(P=>w(P),[w]),onItemShiftTab:S.useCallback(()=>y(!0),[]),onFocusableItemAdd:S.useCallback(()=>A(P=>P+1),[]),onFocusableItemRemove:S.useCallback(()=>A(P=>P-1),[]),children:g.jsx(Fe.div,{tabIndex:v||E===0?-1:0,"data-orientation":i,...d,ref:f,style:{outline:"none",...t.style},onMouseDown:fe(t.onMouseDown,()=>{_.current=!0}),onFocus:fe(t.onFocus,P=>{const I=!_.current;if(P.target===P.currentTarget&&I&&!v){const D=new CustomEvent(K0,f6);if(P.currentTarget.dispatchEvent(D),!D.defaultPrevented){const B=k().filter(Q=>Q.focusable),$=B.find(Q=>Q.active),J=B.find(Q=>Q.id===m),G=[$,J,...B].filter(Boolean).map(Q=>Q.ref.current);b2(G,c)}}_.current=!1}),onBlur:fe(t.onBlur,()=>y(!1))})})}),y2="RovingFocusGroupItem",w2=S.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:r=!1,tabStopId:s,...o}=t,a=ja(),l=s||a,u=v6(y2,n),c=u.currentTabStopId===l,d=g2(n),{onFocusableItemAdd:h,onFocusableItemRemove:f}=u;return S.useEffect(()=>{if(i)return h(),()=>f()},[i,h,f]),g.jsx(Tx.ItemSlot,{scope:n,id:l,focusable:i,active:r,children:g.jsx(Fe.span,{tabIndex:c?0:-1,"data-orientation":u.orientation,...o,ref:e,onMouseDown:fe(t.onMouseDown,p=>{i?u.onItemFocus(l):p.preventDefault()}),onFocus:fe(t.onFocus,()=>u.onItemFocus(l)),onKeyDown:fe(t.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){u.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const m=x6(p,u.orientation,u.dir);if(m!==void 0){if(p.metaKey||p.ctrlKey||p.altKey||p.shiftKey)return;p.preventDefault();let v=d().filter(y=>y.focusable).map(y=>y.ref.current);if(m==="last")v.reverse();else if(m==="prev"||m==="next"){m==="prev"&&v.reverse();const y=v.indexOf(p.currentTarget);v=u.loop?S6(v,y+1):v.slice(y+1)}setTimeout(()=>b2(v))}})})})});w2.displayName=y2;var w6={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function b6(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function x6(t,e,n){const i=b6(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return w6[i]}function b2(t,e=!1){const n=document.activeElement;for(const i of t)if(i===n||(i.focus({preventScroll:e}),document.activeElement!==n))return}function S6(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var x2=v2,S2=w2;function k6(t,e){return S.useReducer((n,i)=>e[n][i]??n,t)}var jo=t=>{const{present:e,children:n}=t,i=_6(e),r=typeof n=="function"?n({present:i.isPresent}):S.Children.only(n),s=rt(i.ref,C6(r));return typeof n=="function"||i.isPresent?S.cloneElement(r,{ref:s}):null};jo.displayName="Presence";function _6(t){const[e,n]=S.useState(),i=S.useRef({}),r=S.useRef(t),s=S.useRef("none"),o=t?"mounted":"unmounted",[a,l]=k6(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return S.useEffect(()=>{const u=Up(i.current);s.current=a==="mounted"?u:"none"},[a]),Hn(()=>{const u=i.current,c=r.current;if(c!==t){const h=s.current,f=Up(u);t?l("MOUNT"):f==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&h!==f?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),Hn(()=>{if(e){const u=d=>{const f=Up(i.current).includes(d.animationName);d.target===e&&f&&Lo.flushSync(()=>l("ANIMATION_END"))},c=d=>{d.target===e&&(s.current=Up(i.current))};return e.addEventListener("animationstart",c),e.addEventListener("animationcancel",u),e.addEventListener("animationend",u),()=>{e.removeEventListener("animationstart",c),e.removeEventListener("animationcancel",u),e.removeEventListener("animationend",u)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:S.useCallback(u=>{u&&(i.current=getComputedStyle(u)),n(u)},[])}}function Up(t){return(t==null?void 0:t.animationName)||"none"}function C6(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var pk="Tabs",[E6,Gse]=ls(pk,[gy]),k2=gy(),[A6,mk]=E6(pk),_2=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,onValueChange:r,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...u}=t,c=Gf(a),[d,h]=Po({prop:i,onChange:r,defaultProp:s});return g.jsx(A6,{scope:n,baseId:ja(),value:d,onValueChange:h,orientation:o,dir:c,activationMode:l,children:g.jsx(Fe.div,{dir:c,"data-orientation":o,...u,ref:e})})});_2.displayName=pk;var C2="TabsList",E2=S.forwardRef((t,e)=>{const{__scopeTabs:n,loop:i=!0,...r}=t,s=mk(C2,n),o=k2(n);return g.jsx(x2,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:i,children:g.jsx(Fe.div,{role:"tablist","aria-orientation":s.orientation,...r,ref:e})})});E2.displayName=C2;var A2="TabsTrigger",Rx=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,disabled:r=!1,...s}=t,o=mk(A2,n),a=k2(n),l=T2(o.baseId,i),u=R2(o.baseId,i),c=i===o.value;return g.jsx(S2,{asChild:!0,...a,focusable:!r,active:c,children:g.jsx(Fe.button,{type:"button",role:"tab","aria-selected":c,"aria-controls":u,"data-state":c?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:l,...s,ref:e,onMouseDown:fe(t.onMouseDown,d=>{!r&&d.button===0&&d.ctrlKey===!1?o.onValueChange(i):d.preventDefault()}),onKeyDown:fe(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(i)}),onFocus:fe(t.onFocus,()=>{const d=o.activationMode!=="manual";!c&&!r&&d&&o.onValueChange(i)})})})});Rx.displayName=A2;var P2="TabsContent",Km=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,forceMount:r,children:s,...o}=t,a=mk(P2,n),l=T2(a.baseId,i),u=R2(a.baseId,i),c=i===a.value,d=S.useRef(c);return S.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),g.jsx(jo,{present:r||c,children:({present:h})=>g.jsx(Fe.div,{"data-state":c?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:h&&s})})});Km.displayName=P2;function T2(t,e){return`${t}-trigger-${e}`}function R2(t,e){return`${t}-content-${e}`}var $r={BASE_URL:"/VonSim8/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};let P6=0;function Ae(t,e){const n=`atom${++P6}`,i={toString(){return($r?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof t=="function"?i.read=t:(i.init=t,i.read=T6,i.write=R6),e&&(i.write=e),i}function T6(t){return t(this)}function R6(t,e,n){return e(this,typeof n=="function"?n(t(this)):n)}const OA=(t,e)=>t.unstable_is?t.unstable_is(e):e===t,X0=t=>"init"in t,q0=t=>!!t.write,mh=Symbol(($r?"production":void 0)!=="production"?"CONTINUE_PROMISE":""),gk="pending",N6="fulfilled",M6="rejected",O6=t=>typeof t=="object"&&t!==null&&mh in t,Vp=new WeakMap,I6=(t,e,n)=>{if(!Vp.has(t)){let i;const r=new Promise((s,o)=>{let a=t;const l=c=>d=>{a===c&&(r.status=N6,r.value=d,s(d),n())},u=c=>d=>{a===c&&(r.status=M6,r.reason=d,o(d),n())};t.then(l(t),u(t)),i=(c,d)=>{c&&(Vp.set(c,r),a=c,c.then(l(c),u(c)),e(),e=d)}});r.status=gk,r[mh]=i,Vp.set(t,r)}return Vp.get(t)},D6=t=>typeof(t==null?void 0:t.then)=="function",IA=t=>"v"in t||"e"in t,Hp=t=>{if("e"in t)throw t.e;if(($r?"production":void 0)!=="production"&&!("v"in t))throw new Error("[Bug] atom state is not initialized");return t.v},Wp=t=>{const e=t.v;return O6(e)&&e.status===gk?e:null},DA=(t,e,n)=>{n.p.has(t)||(n.p.add(t),e.then(()=>{n.p.delete(t)},()=>{n.p.delete(t)}))},hu=()=>[new Map,new Map,new Set],Y0=(t,e,n)=>{t[0].has(e)||t[0].set(e,new Set),t[1].set(e,n)},L6=(t,e,n)=>{const i=t[0].get(e);i&&i.add(n)},j6=(t,e)=>t[0].get(e),LA=(t,e)=>{t[2].add(e)},ml=t=>{for(;t[1].size||t[2].size;){t[0].clear();const e=new Set(t[1].values());t[1].clear();const n=new Set(t[2]);t[2].clear(),e.forEach(i=>{var r;return(r=i.m)==null?void 0:r.l.forEach(s=>s())}),n.forEach(i=>i())}},vk=()=>{const t=new WeakMap;let e;($r?"production":void 0)!=="production"&&(e=new Set);const n=m=>{let w=t.get(m);return w||(w={d:new Map,p:new Set,n:0},t.set(m,w)),w},i=(m,w,v,y=()=>{},b=()=>{})=>{const k="v"in w,_=w.v,E=Wp(w);if(D6(v))if(E)E!==v&&(E[mh](v,y),++w.n);else{const A=I6(v,y,b);if(A.status===gk)for(const P of w.d.keys()){const I=n(P);DA(m,A,I)}w.v=A,delete w.e}else E&&E[mh](Promise.resolve(v),y),w.v=v,delete w.e;(!k||!Object.is(_,w.v))&&++w.n},r=(m,w,v,y)=>{var b;if(($r?"production":void 0)!=="production"&&v===w)throw new Error("[Bug] atom cannot depend on itself");const k=n(w);k.d.set(v,y.n);const _=Wp(k);_&&DA(w,_,y),(b=y.m)==null||b.t.add(w),m&&L6(m,v,w)},s=(m,w,v)=>{const y=n(w);if(!(v!=null&&v(w))&&IA(y)&&(y.m||Array.from(y.d).every(([P,I])=>s(m,P,v).n===I)))return y;y.d.clear();let b=!0;const k=P=>{if(OA(w,P)){const D=n(P);if(!IA(D))if(X0(P))i(P,D,P.init);else throw new Error("no atom init");return Hp(D)}const I=s(m,P,v);if(b)r(m,w,P,I);else{const D=hu();r(D,w,P,I),c(D,w,y),ml(D)}return Hp(I)};let _,E;const A={get signal(){return _||(_=new AbortController),_.signal},get setSelf(){return($r?"production":void 0)!=="production"&&!q0(w)&&console.warn("setSelf function cannot be used with read-only atom"),!E&&q0(w)&&(E=(...P)=>{if(($r?"production":void 0)!=="production"&&b&&console.warn("setSelf function cannot be called in sync"),!b)return u(w,...P)}),E}};try{const P=w.read(k,A);return i(w,y,P,()=>_==null?void 0:_.abort(),()=>{if(y.m){const I=hu();c(I,w,y),ml(I)}}),y}catch(P){return delete y.v,y.e=P,++y.n,y}finally{b=!1}},o=m=>Hp(s(void 0,m)),a=(m,w)=>{const v=A=>{var P,I;const D=n(A),B=new Set((P=D.m)==null?void 0:P.t);for(const $ of D.p)B.add($);return(I=j6(m,A))==null||I.forEach($=>{B.add($)}),B},y=[],b=new Set,k=A=>{if(!b.has(A)){b.add(A);for(const P of v(A))A!==P&&k(P);y.push(A)}};k(w);const _=new Set([w]),E=A=>b.has(A);for(let A=y.length-1;A>=0;--A){const P=y[A],I=n(P),D=I.n;let B=!1;for(const $ of I.d.keys())if($!==P&&_.has($)){B=!0;break}B&&(s(m,P,E),c(m,P,I),D!==I.n&&(Y0(m,P,I),_.add(P))),b.delete(P)}},l=(m,w,...v)=>{const y=_=>Hp(s(m,_)),b=(_,...E)=>{let A;if(OA(w,_)){if(!X0(_))throw new Error("atom not writable");const P=n(_),I="v"in P,D=P.v,B=E[0];i(_,P,B),c(m,_,P),(!I||!Object.is(D,P.v))&&(Y0(m,_,P),a(m,_))}else A=l(m,_,...E);return ml(m),A};return w.write(y,b,...v)},u=(m,...w)=>{const v=hu(),y=l(v,m,...w);return ml(v),y},c=(m,w,v)=>{if(v.m&&!Wp(v)){for(const y of v.d.keys())v.m.d.has(y)||(d(m,y).t.add(w),v.m.d.add(y));for(const y of v.m.d||[])if(!v.d.has(y)){v.m.d.delete(y);const b=h(m,y);b==null||b.t.delete(w)}}},d=(m,w)=>{const v=n(w);if(!v.m){s(m,w);for(const y of v.d.keys())d(m,y).t.add(w);if(v.m={l:new Set,d:new Set(v.d.keys()),t:new Set},($r?"production":void 0)!=="production"&&e.add(w),q0(w)&&w.onMount){const y=v.m,{onMount:b}=w;LA(m,()=>{const k=b((..._)=>l(m,w,..._));k&&(y.u=k)})}}return v.m},h=(m,w)=>{const v=n(w);if(v.m&&!v.m.l.size&&!Array.from(v.m.t).some(y=>{var b;return(b=n(y).m)==null?void 0:b.d.has(w)})){const y=v.m.u;y&&LA(m,y),delete v.m,($r?"production":void 0)!=="production"&&e.delete(w);for(const k of v.d.keys()){const _=h(m,k);_==null||_.t.delete(w)}const b=Wp(v);b&&b[mh](void 0,()=>{});return}return v.m},p={get:o,set:u,sub:(m,w)=>{const v=hu(),y=d(v,m);ml(v);const b=y.l;return b.add(w),()=>{b.delete(w);const k=hu();h(k,m),ml(k)}}};return($r?"production":void 0)!=="production"&&Object.assign(p,{dev4_get_internal_weak_map:()=>t,dev4_get_mounted_atoms:()=>e,dev4_restore_atoms:w=>{const v=hu();for(const[y,b]of w)if(X0(y)){const k=n(y),_="v"in k,E=k.v;i(y,k,b),c(v,y,k),(!_||!Object.is(E,k.v))&&(Y0(v,y,k),a(v,y))}ml(v)}}),p};let xd;const F6=()=>(xd||(xd=vk(),($r?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=xd),globalThis.__JOTAI_DEFAULT_STORE__!==xd&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),xd);var B6={BASE_URL:"/VonSim8/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};const N2=S.createContext(void 0),M2=t=>S.useContext(N2)||F6(),$6=({children:t,store:e})=>{const n=S.useRef();return!e&&!n.current&&(n.current=vk()),S.createElement(N2.Provider,{value:e||n.current},t)},z6=t=>typeof(t==null?void 0:t.then)=="function",U6=fn.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)});function Xt(t,e){const n=M2(),[[i,r,s],o]=S.useReducer(u=>{const c=n.get(t);return Object.is(u[0],c)&&u[1]===n&&u[2]===t?u:[c,n,t]},void 0,()=>[n.get(t),n,t]);let a=i;return(r!==n||s!==t)&&(o(),a=n.get(t)),S.useEffect(()=>{const u=n.sub(t,()=>{o()});return o(),u},[n,t,void 0]),S.useDebugValue(a),z6(a)?U6(a):a}function O2(t,e){const n=M2();return S.useCallback((...r)=>{if((B6?"production":void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return n.set(t,...r)},[n,t])}function ed(t,e){return[Xt(t),O2(t)]}const{createElement:Nc,createContext:V6,createRef:Kse,forwardRef:I2,useCallback:hi,useContext:D2,useEffect:jl,useImperativeHandle:L2,useLayoutEffect:H6,useMemo:W6,useRef:$i,useState:Zg}=fS,jA=fS.useId,vy=V6(null);vy.displayName="PanelGroupContext";const qh=H6,G6=typeof jA=="function"?jA:()=>null;let K6=0;function yk(t=null){const e=G6(),n=$i(t||e||null);return n.current===null&&(n.current=""+K6++),t??n.current}function j2({children:t,className:e="",collapsedSize:n,collapsible:i,defaultSize:r,forwardedRef:s,id:o,maxSize:a,minSize:l,onCollapse:u,onExpand:c,onResize:d,order:h,style:f,tagName:p="div",...m}){const w=D2(vy);if(w===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:v,expandPanel:y,getPanelSize:b,getPanelStyle:k,groupId:_,isPanelCollapsed:E,reevaluatePanelConstraints:A,registerPanel:P,resizePanel:I,unregisterPanel:D}=w,B=yk(o),$=$i({callbacks:{onCollapse:u,onExpand:c,onResize:d},constraints:{collapsedSize:n,collapsible:i,defaultSize:r,maxSize:a,minSize:l},id:B,idIsFromProps:o!==void 0,order:h});$i({didLogMissingDefaultSizeWarning:!1}),qh(()=>{const{callbacks:z,constraints:G}=$.current,Q={...G};$.current.id=B,$.current.idIsFromProps=o!==void 0,$.current.order=h,z.onCollapse=u,z.onExpand=c,z.onResize=d,G.collapsedSize=n,G.collapsible=i,G.defaultSize=r,G.maxSize=a,G.minSize=l,(Q.collapsedSize!==G.collapsedSize||Q.collapsible!==G.collapsible||Q.maxSize!==G.maxSize||Q.minSize!==G.minSize)&&A($.current,Q)}),qh(()=>{const z=$.current;return P(z),()=>{D(z)}},[h,B,P,D]),L2(s,()=>({collapse:()=>{v($.current)},expand:()=>{y($.current)},getId(){return B},getSize(){return b($.current)},isCollapsed(){return E($.current)},isExpanded(){return!E($.current)},resize:z=>{I($.current,z)}}),[v,y,b,E,B,I]);const J=k($.current,r);return Nc(p,{...m,children:t,className:e,style:{...J,...f},"data-panel":"","data-panel-id":B,"data-panel-group-id":_,"data-panel-collapsible":void 0,"data-panel-size":void 0})}const Xm=I2((t,e)=>Nc(j2,{...t,forwardedRef:e}));j2.displayName="Panel";Xm.displayName="forwardRef(Panel)";function Ue(t,e="Assertion failed!"){if(!t)throw console.error(e),Error(e)}const F2=10;function Yh(t,e,n=F2){t=parseFloat(t.toFixed(n)),e=parseFloat(e.toFixed(n));const i=t-e;return i===0?0:i>0?1:-1}function ji(t,e,n){return Yh(t,e,n)===0}function Vu({panelConstraints:t,panelIndex:e,size:n}){const i=t[e];Ue(i!=null);let{collapsedSize:r=0,collapsible:s,maxSize:o=100,minSize:a=0}=i;if(Yh(n,a)<0)if(s){const l=(r+a)/2;Yh(n,l)<0?n=r:n=a}else n=a;return n=Math.min(o,n),n=parseFloat(n.toFixed(F2)),n}function Ud({delta:t,layout:e,panelConstraints:n,pivotIndices:i,trigger:r}){if(ji(t,0))return e;const s=[...e],[o,a]=i;Ue(o!=null),Ue(a!=null);let l=0;if(r==="keyboard"){{const c=t<0?a:o,d=n[c];if(Ue(d),d.collapsible){const h=e[c];Ue(h!=null);const f=n[c];Ue(f);const{collapsedSize:p=0,minSize:m=0}=f;if(ji(h,p)){const w=m-h;Yh(w,Math.abs(t))>0&&(t=t<0?0-w:w)}}}{const c=t<0?o:a,d=n[c];Ue(d);const{collapsible:h}=d;if(h){const f=e[c];Ue(f!=null);const p=n[c];Ue(p);const{collapsedSize:m=0,minSize:w=0}=p;if(ji(f,w)){const v=f-m;Yh(v,Math.abs(t))>0&&(t=t<0?0-v:v)}}}}{const c=t<0?1:-1;let d=t<0?a:o,h=0;for(;;){const p=e[d];Ue(p!=null);const w=Vu({panelConstraints:n,panelIndex:d,size:100})-p;if(h+=w,d+=c,d<0||d>=n.length)break}const f=Math.min(Math.abs(t),Math.abs(h));t=t<0?0-f:f}{let d=t<0?o:a;for(;d>=0&&d<n.length;){const h=Math.abs(t)-Math.abs(l),f=e[d];Ue(f!=null);const p=f-h,m=Vu({panelConstraints:n,panelIndex:d,size:p});if(!ji(f,m)&&(l+=f-m,s[d]=m,l.toPrecision(3).localeCompare(Math.abs(t).toPrecision(3),void 0,{numeric:!0})>=0))break;t<0?d--:d++}}if(ji(l,0))return e;{const c=t<0?a:o,d=e[c];Ue(d!=null);const h=d+l,f=Vu({panelConstraints:n,panelIndex:c,size:h});if(s[c]=f,!ji(f,h)){let p=h-f,w=t<0?a:o;for(;w>=0&&w<n.length;){const v=s[w];Ue(v!=null);const y=v+p,b=Vu({panelConstraints:n,panelIndex:w,size:y});if(ji(v,b)||(p-=b-v,s[w]=b),ji(p,0))break;t>0?w--:w++}}}const u=s.reduce((c,d)=>d+c,0);return ji(u,100)?s:e}function X6({layout:t,panelsArray:e,pivotIndices:n}){let i=0,r=100,s=0,o=0;const a=n[0];Ue(a!=null),e.forEach((d,h)=>{const{constraints:f}=d,{maxSize:p=100,minSize:m=0}=f;h===a?(i=m,r=p):(s+=m,o+=p)});const l=Math.min(r,100-s),u=Math.max(i,100-o),c=t[a];return{valueMax:l,valueMin:u,valueNow:c}}function Jh(t,e=document){return Array.from(e.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${t}"]`))}function B2(t,e,n=document){const r=Jh(t,n).findIndex(s=>s.getAttribute("data-panel-resize-handle-id")===e);return r??null}function $2(t,e,n){const i=B2(t,e,n);return i!=null?[i,i+1]:[-1,-1]}function z2(t,e=document){var n;if(e instanceof HTMLElement&&(e==null||(n=e.dataset)===null||n===void 0?void 0:n.panelGroupId)==t)return e;const i=e.querySelector(`[data-panel-group][data-panel-group-id="${t}"]`);return i||null}function yy(t,e=document){const n=e.querySelector(`[data-panel-resize-handle-id="${t}"]`);return n||null}function q6(t,e,n,i=document){var r,s,o,a;const l=yy(e,i),u=Jh(t,i),c=l?u.indexOf(l):-1,d=(r=(s=n[c])===null||s===void 0?void 0:s.id)!==null&&r!==void 0?r:null,h=(o=(a=n[c+1])===null||a===void 0?void 0:a.id)!==null&&o!==void 0?o:null;return[d,h]}function Y6({committedValuesRef:t,eagerValuesRef:e,groupId:n,layout:i,panelDataArray:r,panelGroupElement:s,setLayout:o}){$i({didWarnAboutMissingResizeHandle:!1}),qh(()=>{if(!s)return;const a=Jh(n,s);for(let l=0;l<r.length-1;l++){const{valueMax:u,valueMin:c,valueNow:d}=X6({layout:i,panelsArray:r,pivotIndices:[l,l+1]}),h=a[l];if(h!=null){const f=r[l];Ue(f),h.setAttribute("aria-controls",f.id),h.setAttribute("aria-valuemax",""+Math.round(u)),h.setAttribute("aria-valuemin",""+Math.round(c)),h.setAttribute("aria-valuenow",d!=null?""+Math.round(d):"")}}return()=>{a.forEach((l,u)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[n,i,r,s]),jl(()=>{if(!s)return;const a=e.current;Ue(a);const{panelDataArray:l}=a,u=z2(n,s);Ue(u!=null,`No group found for id "${n}"`);const c=Jh(n,s);Ue(c);const d=c.map(h=>{const f=h.getAttribute("data-panel-resize-handle-id");Ue(f);const[p,m]=q6(n,f,l,s);if(p==null||m==null)return()=>{};const w=v=>{if(!v.defaultPrevented)switch(v.key){case"Enter":{v.preventDefault();const y=l.findIndex(b=>b.id===p);if(y>=0){const b=l[y];Ue(b);const k=i[y],{collapsedSize:_=0,collapsible:E,minSize:A=0}=b.constraints;if(k!=null&&E){const P=Ud({delta:ji(k,_)?A-_:_-k,layout:i,panelConstraints:l.map(I=>I.constraints),pivotIndices:$2(n,f,s),trigger:"keyboard"});i!==P&&o(P)}}break}}};return h.addEventListener("keydown",w),()=>{h.removeEventListener("keydown",w)}});return()=>{d.forEach(h=>h())}},[s,t,e,n,i,r,o])}function FA(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function U2(t){return t.type==="keydown"}function V2(t){return t.type.startsWith("mouse")}function H2(t){return t.type.startsWith("touch")}function W2(t,e){const n=t==="horizontal";if(V2(e))return n?e.clientX:e.clientY;if(H2(e)){const i=e.touches[0];return Ue(i),n?i.screenX:i.screenY}else throw Error(`Unsupported event type "${e.type}"`)}function J6(t,e,n,i,r){const s=n==="horizontal",o=yy(e,r);Ue(o);const a=o.getAttribute("data-panel-group-id");Ue(a);let{initialCursorPosition:l}=i;const u=W2(n,t),c=z2(a,r);Ue(c);const d=c.getBoundingClientRect(),h=s?d.width:d.height;return(u-l)/h*100}function Z6(t,e,n,i,r,s){if(U2(t)){const o=n==="horizontal";let a=0;t.shiftKey?a=100:r!=null?a=r:a=10;let l=0;switch(t.key){case"ArrowDown":l=o?0:a;break;case"ArrowLeft":l=o?-a:0;break;case"ArrowRight":l=o?a:0;break;case"ArrowUp":l=o?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return i==null?0:J6(t,e,n,i,s)}function Q6({panelDataArray:t}){const e=Array(t.length),n=t.map(s=>s.constraints);let i=0,r=100;for(let s=0;s<t.length;s++){const o=n[s];Ue(o);const{defaultSize:a}=o;a!=null&&(i++,e[s]=a,r-=a)}for(let s=0;s<t.length;s++){const o=n[s];Ue(o);const{defaultSize:a}=o;if(a!=null)continue;const l=t.length-i,u=r/l;i++,e[s]=u,r-=u}return e}function fu(t,e,n){e.forEach((i,r)=>{const s=t[r];Ue(s);const{callbacks:o,constraints:a,id:l}=s,{collapsedSize:u=0,collapsible:c}=a,d=n[l];if(d==null||i!==d){n[l]=i;const{onCollapse:h,onExpand:f,onResize:p}=o;p&&p(i,d),c&&(h||f)&&(f&&(d==null||d===u)&&i!==u&&f(),h&&(d==null||d!==u)&&i===u&&h())}})}function Gp(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n])return!1;return!0}function eU({defaultSize:t,dragState:e,layout:n,panelData:i,panelIndex:r,precision:s=3}){const o=n[r];let a;return o==null?a=t??"1":i.length===1?a="1":a=o.toPrecision(s),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}let Nx=null,Ml=null;function G2(t){switch(t){case"horizontal":return"ew-resize";case"horizontal-max":return"w-resize";case"horizontal-min":return"e-resize";case"vertical":return"ns-resize";case"vertical-max":return"n-resize";case"vertical-min":return"s-resize"}}function tU(){Ml!==null&&(document.head.removeChild(Ml),Nx=null,Ml=null)}function J0(t){if(Nx===t)return;Nx=t;const e=G2(t);Ml===null&&(Ml=document.createElement("style"),document.head.appendChild(Ml)),Ml.innerHTML=`*{cursor: ${e}!important;}`}function nU(t,e=10){let n=null;return(...r)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{t(...r)},e)}}function BA(t){try{if(typeof localStorage<"u")t.getItem=e=>localStorage.getItem(e),t.setItem=(e,n)=>{localStorage.setItem(e,n)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),t.getItem=()=>null,t.setItem=()=>{}}}function K2(t){return`react-resizable-panels:${t}`}function X2(t){return t.map(e=>{const{constraints:n,id:i,idIsFromProps:r,order:s}=e;return r?i:s?`${s}:${JSON.stringify(n)}`:JSON.stringify(n)}).sort((e,n)=>e.localeCompare(n)).join(",")}function q2(t,e){try{const n=K2(t),i=e.getItem(n);if(i){const r=JSON.parse(i);if(typeof r=="object"&&r!=null)return r}}catch{}return null}function iU(t,e,n){var i,r;const s=(i=q2(t,n))!==null&&i!==void 0?i:{},o=X2(e);return(r=s[o])!==null&&r!==void 0?r:null}function rU(t,e,n,i,r){var s;const o=K2(t),a=X2(e),l=(s=q2(t,r))!==null&&s!==void 0?s:{};l[a]={expandToSizes:Object.fromEntries(n.entries()),layout:i};try{r.setItem(o,JSON.stringify(l))}catch(u){console.error(u)}}function $A({layout:t,panelConstraints:e}){const n=[...t],i=n.reduce((s,o)=>s+o,0);if(n.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${n.map(s=>`${s}%`).join(", ")}`);if(!ji(i,100))for(let s=0;s<e.length;s++){const o=n[s];Ue(o!=null);const a=100/i*o;n[s]=a}let r=0;for(let s=0;s<e.length;s++){const o=n[s];Ue(o!=null);const a=Vu({panelConstraints:e,panelIndex:s,size:o});o!=a&&(r+=o-a,n[s]=a)}if(!ji(r,0))for(let s=0;s<e.length;s++){const o=n[s];Ue(o!=null);const a=o+r,l=Vu({panelConstraints:e,panelIndex:s,size:a});if(o!==l&&(r-=l-o,n[s]=l,ji(r,0)))break}return n}const sU=100,Vd={getItem:t=>(BA(Vd),Vd.getItem(t)),setItem:(t,e)=>{BA(Vd),Vd.setItem(t,e)}},zA={};function Y2({autoSaveId:t=null,children:e,className:n="",direction:i,forwardedRef:r,id:s=null,onLayout:o=null,keyboardResizeBy:a=null,storage:l=Vd,style:u,tagName:c="div",...d}){const h=yk(s),f=$i(null),[p,m]=Zg(null),[w,v]=Zg([]),y=$i({}),b=$i(new Map),k=$i(0),_=$i({autoSaveId:t,direction:i,dragState:p,id:h,keyboardResizeBy:a,onLayout:o,storage:l}),E=$i({layout:w,panelDataArray:[],panelDataArrayChanged:!1});$i({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),L2(r,()=>({getId:()=>_.current.id,getLayout:()=>{const{layout:q}=E.current;return q},setLayout:q=>{const{onLayout:ue}=_.current,{layout:O,panelDataArray:M}=E.current,F=$A({layout:q,panelConstraints:M.map(x=>x.constraints)});FA(O,F)||(v(F),E.current.layout=F,ue&&ue(F),fu(M,F,y.current))}}),[]),qh(()=>{_.current.autoSaveId=t,_.current.direction=i,_.current.dragState=p,_.current.id=h,_.current.onLayout=o,_.current.storage=l}),Y6({committedValuesRef:_,eagerValuesRef:E,groupId:h,layout:w,panelDataArray:E.current.panelDataArray,setLayout:v,panelGroupElement:f.current}),jl(()=>{const{panelDataArray:q}=E.current;if(t){if(w.length===0||w.length!==q.length)return;let ue=zA[t];ue==null&&(ue=nU(rU,sU),zA[t]=ue);const O=[...q],M=new Map(b.current);ue(t,O,M,w,l)}},[t,w,l]),jl(()=>{});const A=hi(q=>{const{onLayout:ue}=_.current,{layout:O,panelDataArray:M}=E.current;if(q.constraints.collapsible){const F=M.map(R=>R.constraints),{collapsedSize:x=0,panelSize:T,pivotIndices:N}=gl(M,q,O);if(Ue(T!=null),T!==x){b.current.set(q.id,T);const W=Su(M,q)===M.length-1?T-x:x-T,U=Ud({delta:W,layout:O,panelConstraints:F,pivotIndices:N,trigger:"imperative-api"});Gp(O,U)||(v(U),E.current.layout=U,ue&&ue(U),fu(M,U,y.current))}}},[]),P=hi(q=>{const{onLayout:ue}=_.current,{layout:O,panelDataArray:M}=E.current;if(q.constraints.collapsible){const F=M.map(W=>W.constraints),{collapsedSize:x=0,panelSize:T,minSize:N=0,pivotIndices:R}=gl(M,q,O);if(T===x){const W=b.current.get(q.id),U=W!=null&&W>=N?W:N,K=Su(M,q)===M.length-1?T-U:U-T,Se=Ud({delta:K,layout:O,panelConstraints:F,pivotIndices:R,trigger:"imperative-api"});Gp(O,Se)||(v(Se),E.current.layout=Se,ue&&ue(Se),fu(M,Se,y.current))}}},[]),I=hi(q=>{const{layout:ue,panelDataArray:O}=E.current,{panelSize:M}=gl(O,q,ue);return Ue(M!=null),M},[]),D=hi((q,ue)=>{const{panelDataArray:O}=E.current,M=Su(O,q);return eU({defaultSize:ue,dragState:p,layout:w,panelData:O,panelIndex:M})},[p,w]),B=hi(q=>{const{layout:ue,panelDataArray:O}=E.current,{collapsedSize:M=0,collapsible:F,panelSize:x}=gl(O,q,ue);return F===!0&&x===M},[]),$=hi(q=>{const{layout:ue,panelDataArray:O}=E.current,{collapsedSize:M=0,collapsible:F,panelSize:x}=gl(O,q,ue);return Ue(x!=null),!F||x>M},[]),J=hi(q=>{const{panelDataArray:ue}=E.current;ue.push(q),ue.sort((O,M)=>{const F=O.order,x=M.order;return F==null&&x==null?0:F==null?-1:x==null?1:F-x}),E.current.panelDataArrayChanged=!0},[]);qh(()=>{if(E.current.panelDataArrayChanged){E.current.panelDataArrayChanged=!1;const{autoSaveId:q,onLayout:ue,storage:O}=_.current,{layout:M,panelDataArray:F}=E.current;let x=null;if(q){const N=iU(q,F,O);N&&(b.current=new Map(Object.entries(N.expandToSizes)),x=N.layout)}x==null&&(x=Q6({panelDataArray:F}));const T=$A({layout:x,panelConstraints:F.map(N=>N.constraints)});FA(M,T)||(v(T),E.current.layout=T,ue&&ue(T),fu(F,T,y.current))}});const z=hi(q=>function(O){O.preventDefault();const M=f.current;if(!M)return()=>null;const{direction:F,dragState:x,id:T,keyboardResizeBy:N,onLayout:R}=_.current,{layout:W,panelDataArray:U}=E.current,{initialLayout:Z}=x??{},K=$2(T,q,M);let Se=Z6(O,q,F,x,N,M);if(Se===0)return;const Oe=F==="horizontal";document.dir==="rtl"&&Oe&&(Se=-Se);const De=U.map(he=>he.constraints),Ne=Ud({delta:Se,layout:Z??W,panelConstraints:De,pivotIndices:K,trigger:U2(O)?"keyboard":"mouse-or-touch"}),$e=!Gp(W,Ne);(V2(O)||H2(O))&&k.current!=Se&&(k.current=Se,J0($e?Oe?"horizontal":"vertical":Oe?Se<0?"horizontal-min":"horizontal-max":Se<0?"vertical-min":"vertical-max")),$e&&(v(Ne),E.current.layout=Ne,R&&R(Ne),fu(U,Ne,y.current))},[]),G=hi((q,ue)=>{const{onLayout:O}=_.current,{layout:M,panelDataArray:F}=E.current,x=F.map(Z=>Z.constraints),{panelSize:T,pivotIndices:N}=gl(F,q,M);Ue(T!=null);const W=Su(F,q)===F.length-1?T-ue:ue-T,U=Ud({delta:W,layout:M,panelConstraints:x,pivotIndices:N,trigger:"imperative-api"});Gp(M,U)||(v(U),E.current.layout=U,O&&O(U),fu(F,U,y.current))},[]),Q=hi((q,ue)=>{const{layout:O,panelDataArray:M}=E.current,{collapsedSize:F=0,collapsible:x}=ue,{collapsedSize:T=0,collapsible:N,maxSize:R=100,minSize:W=0}=q.constraints,{panelSize:U}=gl(M,q,O);Ue(U!=null),x&&N&&U===F?F!==T&&G(q,T):U<W?G(q,W):U>R&&G(q,R)},[G]),ie=hi((q,ue)=>{const{direction:O}=_.current,{layout:M}=E.current;if(!f.current)return;const F=yy(q,f.current);Ue(F);const x=W2(O,ue);m({dragHandleId:q,dragHandleRect:F.getBoundingClientRect(),initialCursorPosition:x,initialLayout:M})},[]),H=hi(()=>{tU(),m(null)},[]),j=hi(q=>{const{panelDataArray:ue}=E.current,O=Su(ue,q);O>=0&&(ue.splice(O,1),delete y.current[q.id],E.current.panelDataArrayChanged=!0)},[]),te=W6(()=>({collapsePanel:A,direction:i,dragState:p,expandPanel:P,getPanelSize:I,getPanelStyle:D,groupId:h,isPanelCollapsed:B,isPanelExpanded:$,reevaluatePanelConstraints:Q,registerPanel:J,registerResizeHandle:z,resizePanel:G,startDragging:ie,stopDragging:H,unregisterPanel:j,panelGroupElement:f.current}),[A,p,i,P,I,D,h,B,$,Q,J,z,G,ie,H,j]),pe={display:"flex",flexDirection:i==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return Nc(vy.Provider,{value:te},Nc(c,{...d,children:e,className:n,style:{...pe,...u},ref:f,"data-panel-group":"","data-panel-group-direction":i,"data-panel-group-id":h}))}const J2=I2((t,e)=>Nc(Y2,{...t,forwardedRef:e}));Y2.displayName="PanelGroup";J2.displayName="forwardRef(PanelGroup)";function Su(t,e){return t.findIndex(n=>n===e||n.id===e.id)}function gl(t,e,n){const i=Su(t,e),s=i===t.length-1?[i-1,i]:[i,i+1],o=n[i];return{...e.constraints,panelSize:o,pivotIndices:s}}function oU({disabled:t,handleId:e,resizeHandler:n,panelGroupElement:i}){jl(()=>{if(t||n==null||i==null)return;const r=yy(e,i);if(r==null)return;const s=o=>{if(!o.defaultPrevented)switch(o.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{o.preventDefault(),n(o);break}case"F6":{o.preventDefault();const a=r.getAttribute("data-panel-group-id");Ue(a);const l=Jh(a,i),u=B2(a,e,i);Ue(u!==null);const c=o.shiftKey?u>0?u-1:l.length-1:u+1<l.length?u+1:0;l[c].focus();break}}};return r.addEventListener("keydown",s),()=>{r.removeEventListener("keydown",s)}},[i,t,e,n])}function Mx({children:t=null,className:e="",disabled:n=!1,id:i,onDragging:r,style:s={},tabIndex:o=0,tagName:a="div",...l}){const u=$i(null),c=$i({onDragging:r});jl(()=>{c.current.onDragging=r});const d=D2(vy);if(d===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:h,dragState:f,groupId:p,registerResizeHandle:m,startDragging:w,stopDragging:v,panelGroupElement:y}=d,b=yk(i),k=(f==null?void 0:f.dragHandleId)===b,[_,E]=Zg(!1),[A,P]=Zg(null),I=hi(()=>{const B=u.current;Ue(B),B.blur(),v();const{onDragging:$}=c.current;$&&$(!1)},[v]);jl(()=>{if(n)P(null);else{const B=m(b);P(()=>B)}},[n,b,m]),jl(()=>{if(n||A==null||!k)return;const B=G=>{A(G)},$=G=>{A(G)},J=u.current;Ue(J);const z=J.ownerDocument;return z.body.addEventListener("contextmenu",I),z.body.addEventListener("mousemove",B),z.body.addEventListener("touchmove",B),z.body.addEventListener("mouseleave",$),window.addEventListener("mouseup",I),window.addEventListener("touchend",I),()=>{z.body.removeEventListener("contextmenu",I),z.body.removeEventListener("mousemove",B),z.body.removeEventListener("touchmove",B),z.body.removeEventListener("mouseleave",$),window.removeEventListener("mouseup",I),window.removeEventListener("touchend",I)}},[h,n,k,A,I]),oU({disabled:n,handleId:b,resizeHandler:A,panelGroupElement:y});const D={cursor:G2(h),touchAction:"none",userSelect:"none"};return Nc(a,{...l,children:t,className:e,onBlur:()=>E(!1),onFocus:()=>E(!0),onMouseDown:B=>{w(b,B.nativeEvent);const $=c.current;Ue($);const{onDragging:J}=$;J&&J(!0)},onMouseUp:I,onTouchCancel:I,onTouchEnd:I,onTouchStart:B=>{w(b,B.nativeEvent);const $=c.current;Ue($);const{onDragging:J}=$;J&&J(!0)},ref:u,role:"separator",style:{...D,...s},tabIndex:o,"data-panel-group-direction":h,"data-panel-group-id":p,"data-resize-handle":"","data-resize-handle-active":k?"pointer":_?"keyboard":void 0,"data-panel-resize-handle-enabled":!n,"data-panel-resize-handle-id":b})}Mx.displayName="PanelResizeHandle";var Cs=function(){return Cs=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Cs.apply(this,arguments)};function Z2(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function aU(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}var lU=function(){};function uU(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.addEventListener&&t.addEventListener.apply(t,e)}function cU(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.removeEventListener&&t.removeEventListener.apply(t,e)}var Q2=typeof window<"u",dU=Q2?window:null,UA=function(t){return!!t.addEventListener},VA=function(t){return!!t.on},qm=function(t,e,n,i){n===void 0&&(n=dU),S.useEffect(function(){if(e&&n)return UA(n)?uU(n,t,e,i):VA(n)&&n.on(t,e,i),function(){UA(n)?cU(n,t,e,i):VA(n)&&n.off(t,e,i)}},[t,e,n,JSON.stringify(i)])},hU=function(t){return typeof t=="function"?t:typeof t=="string"?function(e){return e.key===t}:t?function(){return!0}:function(){return!1}},xo=function(t,e,n,i){e===void 0&&(e=lU),n===void 0&&(n={}),i===void 0&&(i=[t]);var r=n.event,s=r===void 0?"keydown":r,o=n.target,a=n.options,l=S.useMemo(function(){var u=hU(t),c=function(d){if(u(d))return e(d)};return c},i);qm(s,l,o,a)},fU=function(t,e){return Q2?window.matchMedia(t).matches:!1},pU=function(t,e){var n=S.useState(fU(t)),i=n[0],r=n[1];return S.useEffect(function(){var s=!0,o=window.matchMedia(t),a=function(){s&&r(!!o.matches)};return o.addEventListener("change",a),r(o.matches),function(){s=!1,o.removeEventListener("change",a)}},[t]),i};const mU="modulepreload",gU=function(t){return"/VonSim8/"+t},HA={},vU=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=Promise.all(n.map(a=>{if(a=gU(a),a in HA)return;HA[a]=!0;const l=a.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${u}`))return;const c=document.createElement("link");if(c.rel=l?"stylesheet":mU,l||(c.as="script",c.crossOrigin=""),c.href=a,o&&c.setAttribute("nonce",o),document.head.appendChild(c),l)return new Promise((d,h)=>{c.addEventListener("load",d),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})}))}return r.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};function yU(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:s,onRegisterError:o}=t;let a,l,u;const c=async(h=!0)=>{await l,await(u==null?void 0:u())};async function d(){if("serviceWorker"in navigator){if(a=await vU(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-D5gOYdM7.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/VonSim8/sw.js",{scope:"/VonSim8/",type:"classic"})).catch(h=>{o==null||o(h)}),!a)return;u=async()=>{await(a==null?void 0:a.messageSkipWaiting())};{let h=!1;const f=()=>{h=!0,a==null||a.addEventListener("controlling",p=>{p.isUpdate&&window.location.reload()}),n==null||n()};a.addEventListener("installed",p=>{typeof p.isUpdate>"u"?typeof p.isExternal<"u"?p.isExternal?f():!h&&(i==null||i()):p.isExternal?window.location.reload():!h&&(i==null||i()):p.isUpdate||i==null||i()}),a.addEventListener("waiting",f),a.addEventListener("externalwaiting",f)}a.register({immediate:e}).then(h=>{s?s("/VonSim8/sw.js",h):r==null||r(h)}).catch(h=>{o==null||o(h)})}}return l=d(),c}function wU(t={}){const{immediate:e=!0,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:s,onRegisterError:o}=t,[a,l]=S.useState(!1),[u,c]=S.useState(!1),[d]=S.useState(()=>yU({immediate:e,onOfflineReady(){c(!0),i==null||i()},onNeedRefresh(){l(!0),n==null||n()},onRegistered:r,onRegisteredSW:s,onRegisterError:o}));return{needRefresh:[a,l],offlineReady:[u,c],updateServiceWorker:d}}class ot{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,n,i){[e,n]=Mc(this,e,n);let r=[];return this.decompose(0,e,r,2),i.length&&i.decompose(0,i.length,r,3),this.decompose(n,this.length,r,1),Es.from(r,this.length-(n-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,n=this.length){[e,n]=Mc(this,e,n);let i=[];return this.decompose(e,n,i,0),Es.from(i,n-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let n=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),r=new gh(this),s=new gh(e);for(let o=n,a=n;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(a+=r.value.length,r.done||a>=i)return!0}}iter(e=1){return new gh(this,e)}iterRange(e,n=this.length){return new eI(this,e,n)}iterLines(e,n){let i;if(e==null)i=this.iter();else{n==null&&(n=this.lines+1);let r=this.line(e).from;i=this.iterRange(r,Math.max(r,n==this.lines+1?this.length:n<=1?0:this.line(n-1).to))}return new tI(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?ot.empty:e.length<=32?new Wt(e):Es.from(Wt.split(e,[]))}}class Wt extends ot{constructor(e,n=bU(e)){super(),this.text=e,this.length=n}get lines(){return this.text.length}get children(){return null}lineInner(e,n,i,r){for(let s=0;;s++){let o=this.text[s],a=r+o.length;if((n?i:a)>=e)return new xU(r,a,i,o);r=a+1,i++}}decompose(e,n,i,r){let s=e<=0&&n>=this.length?this:new Wt(WA(this.text,e,n),Math.min(n,this.length)-Math.max(0,e));if(r&1){let o=i.pop(),a=Ym(s.text,o.text.slice(),0,s.length);if(a.length<=32)i.push(new Wt(a,o.length+s.length));else{let l=a.length>>1;i.push(new Wt(a.slice(0,l)),new Wt(a.slice(l)))}}else i.push(s)}replace(e,n,i){if(!(i instanceof Wt))return super.replace(e,n,i);[e,n]=Mc(this,e,n);let r=Ym(this.text,Ym(i.text,WA(this.text,0,e)),n),s=this.length+i.length-(n-e);return r.length<=32?new Wt(r,s):Es.from(Wt.split(r,[]),s)}sliceString(e,n=this.length,i=`
`){[e,n]=Mc(this,e,n);let r="";for(let s=0,o=0;s<=n&&o<this.text.length;o++){let a=this.text[o],l=s+a.length;s>e&&o&&(r+=i),e<l&&n>s&&(r+=a.slice(Math.max(0,e-s),n-s)),s=l+1}return r}flatten(e){for(let n of this.text)e.push(n)}scanIdentical(){return 0}static split(e,n){let i=[],r=-1;for(let s of e)i.push(s),r+=s.length+1,i.length==32&&(n.push(new Wt(i,r)),i=[],r=-1);return r>-1&&n.push(new Wt(i,r)),n}}class Es extends ot{constructor(e,n){super(),this.children=e,this.length=n,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,n,i,r){for(let s=0;;s++){let o=this.children[s],a=r+o.length,l=i+o.lines-1;if((n?l:a)>=e)return o.lineInner(e,n,i,r);r=a+1,i=l+1}}decompose(e,n,i,r){for(let s=0,o=0;o<=n&&s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e<=l&&n>=o){let u=r&((o<=e?1:0)|(l>=n?2:0));o>=e&&l<=n&&!u?i.push(a):a.decompose(e-o,n-o,i,u)}o=l+1}}replace(e,n,i){if([e,n]=Mc(this,e,n),i.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.length;if(e>=s&&n<=a){let l=o.replace(e-s,n-s,i),u=this.lines-o.lines+l.lines;if(l.lines<u>>4&&l.lines>u>>6){let c=this.children.slice();return c[r]=l,new Es(c,this.length-(n-e)+i.length)}return super.replace(s,a,l)}s=a+1}return super.replace(e,n,i)}sliceString(e,n=this.length,i=`
`){[e,n]=Mc(this,e,n);let r="";for(let s=0,o=0;s<this.children.length&&o<=n;s++){let a=this.children[s],l=o+a.length;o>e&&s&&(r+=i),e<l&&n>o&&(r+=a.sliceString(e-o,n-o,i)),o=l+1}return r}flatten(e){for(let n of this.children)n.flatten(e)}scanIdentical(e,n){if(!(e instanceof Es))return 0;let i=0,[r,s,o,a]=n>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=n,s+=n){if(r==o||s==a)return i;let l=this.children[r],u=e.children[s];if(l!=u)return i+l.scanIdentical(u,n);i+=l.length+1}}static from(e,n=e.reduce((i,r)=>i+r.length+1,-1)){let i=0;for(let f of e)i+=f.lines;if(i<32){let f=[];for(let p of e)p.flatten(f);return new Wt(f,n)}let r=Math.max(32,i>>5),s=r<<1,o=r>>1,a=[],l=0,u=-1,c=[];function d(f){let p;if(f.lines>s&&f instanceof Es)for(let m of f.children)d(m);else f.lines>o&&(l>o||!l)?(h(),a.push(f)):f instanceof Wt&&l&&(p=c[c.length-1])instanceof Wt&&f.lines+p.lines<=32?(l+=f.lines,u+=f.length+1,c[c.length-1]=new Wt(p.text.concat(f.text),p.length+1+f.length)):(l+f.lines>r&&h(),l+=f.lines,u+=f.length+1,c.push(f))}function h(){l!=0&&(a.push(c.length==1?c[0]:Es.from(c,u)),u=-1,l=c.length=0)}for(let f of e)d(f);return h(),a.length==1?a[0]:new Es(a,n)}}ot.empty=new Wt([""],0);function bU(t){let e=-1;for(let n of t)e+=n.length+1;return e}function Ym(t,e,n=0,i=1e9){for(let r=0,s=0,o=!0;s<t.length&&r<=i;s++){let a=t[s],l=r+a.length;l>=n&&(l>i&&(a=a.slice(0,i-r)),r<n&&(a=a.slice(n-r)),o?(e[e.length-1]+=a,o=!1):e.push(a)),r=l+1}return e}function WA(t,e,n){return Ym(t,[""],e,n)}class gh{constructor(e,n=1){this.dir=n,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[n>0?1:(e instanceof Wt?e.text.length:e.children.length)<<1]}nextInner(e,n){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,r=this.nodes[i],s=this.offsets[i],o=s>>1,a=r instanceof Wt?r.text.length:r.children.length;if(o==(n>0?a:0)){if(i==0)return this.done=!0,this.value="",this;n>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(n>0?0:1)){if(this.offsets[i]+=n,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof Wt){let l=r.text[o+(n<0?-1:0)];if(this.offsets[i]+=n,l.length>Math.max(0,e))return this.value=e==0?l:n>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=r.children[o+(n<0?-1:0)];e>l.length?(e-=l.length,this.offsets[i]+=n):(n<0&&this.offsets[i]--,this.nodes.push(l),this.offsets.push(n>0?1:(l instanceof Wt?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class eI{constructor(e,n,i){this.value="",this.done=!1,this.cursor=new gh(e,n>i?-1:1),this.pos=n>i?e.length:0,this.from=Math.min(n,i),this.to=Math.max(n,i)}nextInner(e,n){if(n<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,n<0?this.pos-this.to:this.from-this.pos);let i=n<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*n,this.value=r.length<=i?r:n<0?r.slice(r.length-i):r.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class tI{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:n,lineBreak:i,value:r}=this.inner.next(e);return n&&this.afterBreak?(this.value="",this.afterBreak=!1):n?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(ot.prototype[Symbol.iterator]=function(){return this.iter()},gh.prototype[Symbol.iterator]=eI.prototype[Symbol.iterator]=tI.prototype[Symbol.iterator]=function(){return this});class xU{constructor(e,n,i,r){this.from=e,this.to=n,this.number=i,this.text=r}get length(){return this.to-this.from}}function Mc(t,e,n){return e=Math.max(0,Math.min(t.length,e)),[e,Math.max(e,Math.min(t.length,n))]}let sc="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=1;t<sc.length;t++)sc[t]+=sc[t-1];function SU(t){for(let e=1;e<sc.length;e+=2)if(sc[e]>t)return sc[e-1]<=t;return!1}function GA(t){return t>=127462&&t<=127487}const KA=8205;function Tn(t,e,n=!0,i=!0){return(n?nI:kU)(t,e,i)}function nI(t,e,n){if(e==t.length)return e;e&&iI(t.charCodeAt(e))&&rI(t.charCodeAt(e-1))&&e--;let i=ei(t,e);for(e+=Wr(i);e<t.length;){let r=ei(t,e);if(i==KA||r==KA||n&&SU(r))e+=Wr(r),i=r;else if(GA(r)){let s=0,o=e-2;for(;o>=0&&GA(ei(t,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function kU(t,e,n){for(;e>0;){let i=nI(t,e-2,n);if(i<e)return i;e--}return 0}function iI(t){return t>=56320&&t<57344}function rI(t){return t>=55296&&t<56320}function ei(t,e){let n=t.charCodeAt(e);if(!rI(n)||e+1==t.length)return n;let i=t.charCodeAt(e+1);return iI(i)?(n-55296<<10)+(i-56320)+65536:n}function wk(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}function Wr(t){return t<65536?1:2}const Ox=/\r\n?|\n/;var xi=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(xi||(xi={}));class Ls{constructor(e){this.sections=e}get length(){let e=0;for(let n=0;n<this.sections.length;n+=2)e+=this.sections[n];return e}get newLength(){let e=0;for(let n=0;n<this.sections.length;n+=2){let i=this.sections[n+1];e+=i<0?this.sections[n]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let n=0,i=0,r=0;n<this.sections.length;){let s=this.sections[n++],o=this.sections[n++];o<0?(e(i,r,s),r+=s):r+=o,i+=s}}iterChangedRanges(e,n=!1){Ix(this,e,n)}get invertedDesc(){let e=[];for(let n=0;n<this.sections.length;){let i=this.sections[n++],r=this.sections[n++];r<0?e.push(i,r):e.push(r,i)}return new Ls(e)}composeDesc(e){return this.empty?e:e.empty?this:sI(this,e)}mapDesc(e,n=!1){return e.empty?this:Dx(this,e,n)}mapPos(e,n=-1,i=xi.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],u=r+a;if(l<0){if(u>e)return s+(e-r);s+=a}else{if(i!=xi.Simple&&u>=e&&(i==xi.TrackDel&&r<e&&u>e||i==xi.TrackBefore&&r<e||i==xi.TrackAfter&&u>e))return null;if(u>e||u==e&&n<0&&!a)return e==r||n<0?s:s+l;s+=l}r=u}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,n=e){for(let i=0,r=0;i<this.sections.length&&r<=n;){let s=this.sections[i++],o=this.sections[i++],a=r+s;if(o>=0&&r<=n&&a>=e)return r<e&&a>n?"cover":!0;r=a}return!1}toString(){let e="";for(let n=0;n<this.sections.length;){let i=this.sections[n++],r=this.sections[n++];e+=(e?" ":"")+i+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(n=>typeof n!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Ls(e)}static create(e){return new Ls(e)}}class nn extends Ls{constructor(e,n){super(e),this.inserted=n}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Ix(this,(n,i,r,s,o)=>e=e.replace(r,r+(i-n),o),!1),e}mapDesc(e,n=!1){return Dx(this,e,n,!0)}invert(e){let n=this.sections.slice(),i=[];for(let r=0,s=0;r<n.length;r+=2){let o=n[r],a=n[r+1];if(a>=0){n[r]=a,n[r+1]=o;let l=r>>1;for(;i.length<l;)i.push(ot.empty);i.push(o?e.slice(s,s+o):ot.empty)}s+=o}return new nn(n,i)}compose(e){return this.empty?e:e.empty?this:sI(this,e,!0)}map(e,n=!1){return e.empty?this:Dx(this,e,n,!0)}iterChanges(e,n=!1){Ix(this,e,n)}get desc(){return Ls.create(this.sections)}filter(e){let n=[],i=[],r=[],s=new Zh(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,l-a);Bn(r,c,-1);let d=s.ins==-1?-1:s.off==0?s.ins:0;Bn(n,c,d),d>0&&fa(i,n,s.text),s.forward(c),a+=c}let u=e[o++];for(;a<u;){if(s.done)break e;let c=Math.min(s.len,u-a);Bn(n,c,-1),Bn(r,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),a+=c}}return{changes:new nn(n,i),filtered:Ls.create(r)}}toJSON(){let e=[];for(let n=0;n<this.sections.length;n+=2){let i=this.sections[n],r=this.sections[n+1];r<0?e.push(i):r==0?e.push([i]):e.push([i].concat(this.inserted[n>>1].toJSON()))}return e}static of(e,n,i){let r=[],s=[],o=0,a=null;function l(c=!1){if(!c&&!r.length)return;o<n&&Bn(r,n-o,-1);let d=new nn(r,s);a=a?a.compose(d.map(a)):d,r=[],s=[],o=0}function u(c){if(Array.isArray(c))for(let d of c)u(d);else if(c instanceof nn){if(c.length!=n)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${n})`);l(),a=a?a.compose(c.map(a)):c}else{let{from:d,to:h=d,insert:f}=c;if(d>h||d<0||h>n)throw new RangeError(`Invalid change range ${d} to ${h} (in doc of length ${n})`);let p=f?typeof f=="string"?ot.of(f.split(i||Ox)):f:ot.empty,m=p.length;if(d==h&&m==0)return;d<o&&l(),d>o&&Bn(r,d-o,-1),Bn(r,h-d,m),fa(s,r,p),o=h}}return u(e),l(!a),a}static empty(e){return new nn(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let n=[],i=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")n.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)n.push(s[0],0);else{for(;i.length<r;)i.push(ot.empty);i[r]=ot.of(s.slice(1)),n.push(s[0],i[r].length)}}}return new nn(n,i)}static createSet(e,n){return new nn(e,n)}}function Bn(t,e,n,i=!1){if(e==0&&n<=0)return;let r=t.length-2;r>=0&&n<=0&&n==t[r+1]?t[r]+=e:e==0&&t[r]==0?t[r+1]+=n:i?(t[r]+=e,t[r+1]+=n):t.push(e,n)}function fa(t,e,n){if(n.length==0)return;let i=e.length-2>>1;if(i<t.length)t[t.length-1]=t[t.length-1].append(n);else{for(;t.length<i;)t.push(ot.empty);t.push(n)}}function Ix(t,e,n){let i=t.inserted;for(let r=0,s=0,o=0;o<t.sections.length;){let a=t.sections[o++],l=t.sections[o++];if(l<0)r+=a,s+=a;else{let u=r,c=s,d=ot.empty;for(;u+=a,c+=l,l&&i&&(d=d.append(i[o-2>>1])),!(n||o==t.sections.length||t.sections[o+1]<0);)a=t.sections[o++],l=t.sections[o++];e(r,u,s,c,d),r=u,s=c}}}function Dx(t,e,n,i=!1){let r=[],s=i?[]:null,o=new Zh(t),a=new Zh(e);for(let l=-1;;)if(o.ins==-1&&a.ins==-1){let u=Math.min(o.len,a.len);Bn(r,u,-1),o.forward(u),a.forward(u)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!n))){let u=a.len;for(Bn(r,a.ins,-1);u;){let c=Math.min(o.len,u);o.ins>=0&&l<o.i&&o.len<=c&&(Bn(r,0,o.ins),s&&fa(s,r,o.text),l=o.i),o.forward(c),u-=c}a.next()}else if(o.ins>=0){let u=0,c=o.len;for(;c;)if(a.ins==-1){let d=Math.min(c,a.len);u+=d,c-=d,a.forward(d)}else if(a.ins==0&&a.len<c)c-=a.len,a.next();else break;Bn(r,u,l<o.i?o.ins:0),s&&l<o.i&&fa(s,r,o.text),l=o.i,o.forward(o.len-c)}else{if(o.done&&a.done)return s?nn.createSet(r,s):Ls.create(r);throw new Error("Mismatched change set lengths")}}function sI(t,e,n=!1){let i=[],r=n?[]:null,s=new Zh(t),o=new Zh(e);for(let a=!1;;){if(s.done&&o.done)return r?nn.createSet(i,r):Ls.create(i);if(s.ins==0)Bn(i,s.len,0,a),s.next();else if(o.len==0&&!o.done)Bn(i,0,o.ins,a),r&&fa(r,i,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,o.len),u=i.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;Bn(i,l,c,a),r&&c&&fa(r,i,o.text)}else o.ins==-1?(Bn(i,s.off?0:s.len,l,a),r&&fa(r,i,s.textBit(l))):(Bn(i,s.off?0:s.len,o.off?0:o.ins,a),r&&!o.off&&fa(r,i,o.text));a=(s.ins>l||o.ins>=0&&o.len>l)&&(a||i.length>u),s.forward2(l),o.forward(l)}}}}class Zh{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,n=this.i-2>>1;return n>=e.length?ot.empty:e[n]}textBit(e){let{inserted:n}=this.set,i=this.i-2>>1;return i>=n.length&&!e?ot.empty:n[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Ol{constructor(e,n,i){this.from=e,this.to=n,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,n=-1){let i,r;return this.empty?i=r=e.mapPos(this.from,n):(i=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),i==this.from&&r==this.to?this:new Ol(i,r,this.flags)}extend(e,n=e){if(e<=this.anchor&&n>=this.anchor)return ne.range(e,n);let i=Math.abs(e-this.anchor)>Math.abs(n-this.anchor)?e:n;return ne.range(this.anchor,i)}eq(e,n=!1){return this.anchor==e.anchor&&this.head==e.head&&(!n||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return ne.range(e.anchor,e.head)}static create(e,n,i){return new Ol(e,n,i)}}class ne{constructor(e,n){this.ranges=e,this.mainIndex=n}map(e,n=-1){return e.empty?this:ne.create(this.ranges.map(i=>i.map(e,n)),this.mainIndex)}eq(e,n=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],n))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new ne([this.main],0)}addRange(e,n=!0){return ne.create([e].concat(this.ranges),n?0:this.mainIndex+1)}replaceRange(e,n=this.mainIndex){let i=this.ranges.slice();return i[n]=e,ne.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new ne(e.ranges.map(n=>Ol.fromJSON(n)),e.main)}static single(e,n=e){return new ne([ne.range(e,n)],0)}static create(e,n=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=i:s.from<i)return ne.normalized(e.slice(),n);i=s.to}return new ne(e,n)}static cursor(e,n=0,i,r){return Ol.create(e,e,(n==0?0:n<0?8:16)|(i==null?7:Math.min(6,i))|(r??16777215)<<6)}static range(e,n,i,r){let s=(i??16777215)<<6|(r==null?7:Math.min(6,r));return n<e?Ol.create(n,e,48|s):Ol.create(e,n,(n>e?8:0)|s)}static normalized(e,n=0){let i=e[n];e.sort((r,s)=>r.from-s.from),n=e.indexOf(i);for(let r=1;r<e.length;r++){let s=e[r],o=e[r-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,l=Math.max(s.to,o.to);r<=n&&n--,e.splice(--r,2,s.anchor>s.head?ne.range(l,a):ne.range(a,l))}}return new ne(e,n)}}function oI(t,e){for(let n of t.ranges)if(n.to>e)throw new RangeError("Selection points outside of document")}let bk=0;class _e{constructor(e,n,i,r,s){this.combine=e,this.compareInput=n,this.compare=i,this.isStatic=r,this.id=bk++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new _e(e.combine||(n=>n),e.compareInput||((n,i)=>n===i),e.compare||(e.combine?(n,i)=>n===i:xk),!!e.static,e.enables)}of(e){return new Jm([],this,0,e)}compute(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new Jm(e,this,1,n)}computeN(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new Jm(e,this,2,n)}from(e,n){return n||(n=i=>i),this.compute([e],i=>n(i.field(e)))}}function xk(t,e){return t==e||t.length==e.length&&t.every((n,i)=>n===e[i])}class Jm{constructor(e,n,i,r){this.dependencies=e,this.facet=n,this.type=i,this.value=r,this.id=bk++}dynamicSlot(e){var n;let i=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,a=this.type==2,l=!1,u=!1,c=[];for(let d of this.dependencies)d=="doc"?l=!0:d=="selection"?u=!0:((n=e[d.id])!==null&&n!==void 0?n:1)&1||c.push(e[d.id]);return{create(d){return d.values[o]=i(d),1},update(d,h){if(l&&h.docChanged||u&&(h.docChanged||h.selection)||Lx(d,c)){let f=i(d);if(a?!XA(f,d.values[o],r):!r(f,d.values[o]))return d.values[o]=f,1}return 0},reconfigure:(d,h)=>{let f,p=h.config.address[s];if(p!=null){let m=ev(h,p);if(this.dependencies.every(w=>w instanceof _e?h.facet(w)===d.facet(w):w instanceof li?h.field(w,!1)==d.field(w,!1):!0)||(a?XA(f=i(d),m,r):r(f=i(d),m)))return d.values[o]=m,0}else f=i(d);return d.values[o]=f,1}}}}function XA(t,e,n){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!n(t[i],e[i]))return!1;return!0}function Lx(t,e){let n=!1;for(let i of e)vh(t,i)&1&&(n=!0);return n}function _U(t,e,n){let i=n.map(l=>t[l.id]),r=n.map(l=>l.type),s=i.filter(l=>!(l&1)),o=t[e.id]>>1;function a(l){let u=[];for(let c=0;c<i.length;c++){let d=ev(l,i[c]);if(r[c]==2)for(let h of d)u.push(h);else u.push(d)}return e.combine(u)}return{create(l){for(let u of i)vh(l,u);return l.values[o]=a(l),1},update(l,u){if(!Lx(l,s))return 0;let c=a(l);return e.compare(c,l.values[o])?0:(l.values[o]=c,1)},reconfigure(l,u){let c=Lx(l,i),d=u.config.facets[e.id],h=u.facet(e);if(d&&!c&&xk(n,d))return l.values[o]=h,0;let f=a(l);return e.compare(f,h)?(l.values[o]=h,0):(l.values[o]=f,1)}}}const qA=_e.define({static:!0});class li{constructor(e,n,i,r,s){this.id=e,this.createF=n,this.updateF=i,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let n=new li(bk++,e.create,e.update,e.compare||((i,r)=>i===r),e);return e.provide&&(n.provides=e.provide(n)),n}create(e){let n=e.facet(qA).find(i=>i.field==this);return((n==null?void 0:n.create)||this.createF)(e)}slot(e){let n=e[this.id]>>1;return{create:i=>(i.values[n]=this.create(i),1),update:(i,r)=>{let s=i.values[n],o=this.updateF(s,r);return this.compareF(s,o)?0:(i.values[n]=o,1)},reconfigure:(i,r)=>r.config.address[this.id]!=null?(i.values[n]=r.field(this),0):(i.values[n]=this.create(i),1)}}init(e){return[this,qA.of({field:this,create:e})]}get extension(){return this}}const Sl={lowest:4,low:3,default:2,high:1,highest:0};function Sd(t){return e=>new aI(e,t)}const Kf={highest:Sd(Sl.highest),high:Sd(Sl.high),default:Sd(Sl.default),low:Sd(Sl.low),lowest:Sd(Sl.lowest)};class aI{constructor(e,n){this.inner=e,this.prec=n}}class Xf{of(e){return new jx(this,e)}reconfigure(e){return Xf.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class jx{constructor(e,n){this.compartment=e,this.inner=n}}class Qg{constructor(e,n,i,r,s,o){for(this.base=e,this.compartments=n,this.dynamicSlots=i,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let n=this.address[e.id];return n==null?e.default:this.staticValues[n>>1]}static resolve(e,n,i){let r=[],s=Object.create(null),o=new Map;for(let h of CU(e,n,o))h instanceof li?r.push(h):(s[h.facet.id]||(s[h.facet.id]=[])).push(h);let a=Object.create(null),l=[],u=[];for(let h of r)a[h.id]=u.length<<1,u.push(f=>h.slot(f));let c=i==null?void 0:i.config.facets;for(let h in s){let f=s[h],p=f[0].facet,m=c&&c[h]||[];if(f.every(w=>w.type==0))if(a[p.id]=l.length<<1|1,xk(m,f))l.push(i.facet(p));else{let w=p.combine(f.map(v=>v.value));l.push(i&&p.compare(w,i.facet(p))?i.facet(p):w)}else{for(let w of f)w.type==0?(a[w.id]=l.length<<1|1,l.push(w.value)):(a[w.id]=u.length<<1,u.push(v=>w.dynamicSlot(v)));a[p.id]=u.length<<1,u.push(w=>_U(w,p,f))}}let d=u.map(h=>h(a));return new Qg(e,o,d,a,l,s)}}function CU(t,e,n){let i=[[],[],[],[],[]],r=new Map;function s(o,a){let l=r.get(o);if(l!=null){if(l<=a)return;let u=i[l].indexOf(o);u>-1&&i[l].splice(u,1),o instanceof jx&&n.delete(o.compartment)}if(r.set(o,a),Array.isArray(o))for(let u of o)s(u,a);else if(o instanceof jx){if(n.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let u=e.get(o.compartment)||o.inner;n.set(o.compartment,u),s(u,a)}else if(o instanceof aI)s(o.inner,o.prec);else if(o instanceof li)i[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof Jm)i[a].push(o),o.facet.extensions&&s(o.facet.extensions,Sl.default);else{let u=o.extension;if(!u)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(u,a)}}return s(t,Sl.default),i.reduce((o,a)=>o.concat(a))}function vh(t,e){if(e&1)return 2;let n=e>>1,i=t.status[n];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;t.status[n]=4;let r=t.computeSlot(t,t.config.dynamicSlots[n]);return t.status[n]=2|r}function ev(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}const lI=_e.define(),Fx=_e.define({combine:t=>t.some(e=>e),static:!0}),uI=_e.define({combine:t=>t.length?t[0]:void 0,static:!0}),cI=_e.define(),dI=_e.define(),hI=_e.define(),fI=_e.define({combine:t=>t.length?t[0]:!1});class Fo{constructor(e,n){this.type=e,this.value=n}static define(){return new EU}}class EU{of(e){return new Fo(this,e)}}class AU{constructor(e){this.map=e}of(e){return new Xe(this,e)}}class Xe{constructor(e,n){this.type=e,this.value=n}map(e){let n=this.type.map(this.value,e);return n===void 0?void 0:n==this.value?this:new Xe(this.type,n)}is(e){return this.type==e}static define(e={}){return new AU(e.map||(n=>n))}static mapEffects(e,n){if(!e.length)return e;let i=[];for(let r of e){let s=r.map(n);s&&i.push(s)}return i}}Xe.reconfigure=Xe.define();Xe.appendConfig=Xe.define();class ln{constructor(e,n,i,r,s,o){this.startState=e,this.changes=n,this.selection=i,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&oI(i,n.newLength),s.some(a=>a.type==ln.time)||(this.annotations=s.concat(ln.time.of(Date.now())))}static create(e,n,i,r,s,o){return new ln(e,n,i,r,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let n of this.annotations)if(n.type==e)return n.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let n=this.annotation(ln.userEvent);return!!(n&&(n==e||n.length>e.length&&n.slice(0,e.length)==e&&n[e.length]=="."))}}ln.time=Fo.define();ln.userEvent=Fo.define();ln.addToHistory=Fo.define();ln.remote=Fo.define();function PU(t,e){let n=[];for(let i=0,r=0;;){let s,o;if(i<t.length&&(r==e.length||e[r]>=t[i]))s=t[i++],o=t[i++];else if(r<e.length)s=e[r++],o=e[r++];else return n;!n.length||n[n.length-1]<s?n.push(s,o):n[n.length-1]<o&&(n[n.length-1]=o)}}function pI(t,e,n){var i;let r,s,o;return n?(r=e.changes,s=nn.empty(e.changes.length),o=t.changes.compose(e.changes)):(r=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(i=t.selection)===null||i===void 0?void 0:i.map(r),effects:Xe.mapEffects(t.effects,r).concat(Xe.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function Bx(t,e,n){let i=e.selection,r=oc(e.annotations);return e.userEvent&&(r=r.concat(ln.userEvent.of(e.userEvent))),{changes:e.changes instanceof nn?e.changes:nn.of(e.changes||[],n,t.facet(uI)),selection:i&&(i instanceof ne?i:ne.single(i.anchor,i.head)),effects:oc(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function mI(t,e,n){let i=Bx(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(n=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(n=!1);let o=!!e[s].sequential;i=pI(i,Bx(t,e[s],o?i.changes.newLength:t.doc.length),o)}let r=ln.create(t,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return RU(n?TU(r):r)}function TU(t){let e=t.startState,n=!0;for(let r of e.facet(cI)){let s=r(t);if(s===!1){n=!1;break}Array.isArray(s)&&(n=n===!0?s:PU(n,s))}if(n!==!0){let r,s;if(n===!1)s=t.changes.invertedDesc,r=nn.empty(e.doc.length);else{let o=t.changes.filter(n);r=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}t=ln.create(e,r,t.selection&&t.selection.map(s),Xe.mapEffects(t.effects,s),t.annotations,t.scrollIntoView)}let i=e.facet(dI);for(let r=i.length-1;r>=0;r--){let s=i[r](t);s instanceof ln?t=s:Array.isArray(s)&&s.length==1&&s[0]instanceof ln?t=s[0]:t=mI(e,oc(s),!1)}return t}function RU(t){let e=t.startState,n=e.facet(hI),i=t;for(let r=n.length-1;r>=0;r--){let s=n[r](t);s&&Object.keys(s).length&&(i=pI(i,Bx(e,s,t.changes.newLength),!0))}return i==t?t:ln.create(e,t.changes,t.selection,i.effects,i.annotations,i.scrollIntoView)}const NU=[];function oc(t){return t==null?NU:Array.isArray(t)?t:[t]}var Rn=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(Rn||(Rn={}));const MU=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let $x;try{$x=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function OU(t){if($x)return $x.test(t);for(let e=0;e<t.length;e++){let n=t[e];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||MU.test(n)))return!0}return!1}function IU(t){return e=>{if(!/\S/.test(e))return Rn.Space;if(OU(e))return Rn.Word;for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return Rn.Word;return Rn.Other}}class Je{constructor(e,n,i,r,s,o){this.config=e,this.doc=n,this.selection=i,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)vh(this,a<<1);this.computeSlot=null}field(e,n=!0){let i=this.config.address[e.id];if(i==null){if(n)throw new RangeError("Field is not present in this state");return}return vh(this,i),ev(this,i)}update(...e){return mI(this,e,!0)}applyTransaction(e){let n=this.config,{base:i,compartments:r}=n;for(let a of e.effects)a.is(Xf.reconfigure)?(n&&(r=new Map,n.compartments.forEach((l,u)=>r.set(u,l)),n=null),r.set(a.value.compartment,a.value.extension)):a.is(Xe.reconfigure)?(n=null,i=a.value):a.is(Xe.appendConfig)&&(n=null,i=oc(i).concat(a.value));let s;n?s=e.startState.values.slice():(n=Qg.resolve(i,r,this),s=new Je(n,this.doc,this.selection,n.dynamicSlots.map(()=>null),(l,u)=>u.reconfigure(l,this),null).values);let o=e.startState.facet(Fx)?e.newSelection:e.newSelection.asSingle();new Je(n,e.newDoc,o,s,(a,l)=>l.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:e},range:ne.cursor(n.from+e.length)}))}changeByRange(e){let n=this.selection,i=e(n.ranges[0]),r=this.changes(i.changes),s=[i.range],o=oc(i.effects);for(let a=1;a<n.ranges.length;a++){let l=e(n.ranges[a]),u=this.changes(l.changes),c=u.map(r);for(let h=0;h<a;h++)s[h]=s[h].map(c);let d=r.mapDesc(u,!0);s.push(l.range.map(d)),r=r.compose(c),o=Xe.mapEffects(o,c).concat(Xe.mapEffects(oc(l.effects),d))}return{changes:r,selection:ne.create(s,n.mainIndex),effects:o}}changes(e=[]){return e instanceof nn?e:nn.of(e,this.doc.length,this.facet(Je.lineSeparator))}toText(e){return ot.of(e.split(this.facet(Je.lineSeparator)||Ox))}sliceDoc(e=0,n=this.doc.length){return this.doc.sliceString(e,n,this.lineBreak)}facet(e){let n=this.config.address[e.id];return n==null?e.default:(vh(this,n),ev(this,n))}toJSON(e){let n={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let r=e[i];r instanceof li&&this.config.address[r.id]!=null&&(n[i]=r.spec.toJSON(this.field(e[i]),this))}return n}static fromJSON(e,n={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(i){for(let s in i)if(Object.prototype.hasOwnProperty.call(e,s)){let o=i[s],a=e[s];r.push(o.init(l=>o.spec.fromJSON(a,l)))}}return Je.create({doc:e.doc,selection:ne.fromJSON(e.selection),extensions:n.extensions?r.concat([n.extensions]):r})}static create(e={}){let n=Qg.resolve(e.extensions||[],new Map),i=e.doc instanceof ot?e.doc:ot.of((e.doc||"").split(n.staticFacet(Je.lineSeparator)||Ox)),r=e.selection?e.selection instanceof ne?e.selection:ne.single(e.selection.anchor,e.selection.head):ne.single(0);return oI(r,i.length),n.staticFacet(Fx)||(r=r.asSingle()),new Je(n,i,r,n.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(Je.tabSize)}get lineBreak(){return this.facet(Je.lineSeparator)||`
`}get readOnly(){return this.facet(fI)}phrase(e,...n){for(let i of this.facet(Je.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return n.length&&(e=e.replace(/\$(\$|\d*)/g,(i,r)=>{if(r=="$")return"$";let s=+(r||1);return!s||s>n.length?i:n[s-1]})),e}languageDataAt(e,n,i=-1){let r=[];for(let s of this.facet(lI))for(let o of s(this,n,i))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return IU(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:n,from:i,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-i,a=e-i;for(;o>0;){let l=Tn(n,o,!1);if(s(n.slice(l,o))!=Rn.Word)break;o=l}for(;a<r;){let l=Tn(n,a);if(s(n.slice(a,l))!=Rn.Word)break;a=l}return o==a?null:ne.range(o+i,a+i)}}Je.allowMultipleSelections=Fx;Je.tabSize=_e.define({combine:t=>t.length?t[0]:4});Je.lineSeparator=uI;Je.readOnly=fI;Je.phrases=_e.define({compare(t,e){let n=Object.keys(t),i=Object.keys(e);return n.length==i.length&&n.every(r=>t[r]==e[r])}});Je.languageData=lI;Je.changeFilter=cI;Je.transactionFilter=dI;Je.transactionExtender=hI;Xf.reconfigure=Xe.define();function tl(t,e,n={}){let i={};for(let r of t)for(let s of Object.keys(r)){let o=r[s],a=i[s];if(a===void 0)i[s]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(n,s))i[s]=n[s](a,o);else throw new Error("Config merge conflict for field "+s)}for(let r in e)i[r]===void 0&&(i[r]=e[r]);return i}class Xl{eq(e){return this==e}range(e,n=e){return zx.create(e,n,this)}}Xl.prototype.startSide=Xl.prototype.endSide=0;Xl.prototype.point=!1;Xl.prototype.mapMode=xi.TrackDel;let zx=class gI{constructor(e,n,i){this.from=e,this.to=n,this.value=i}static create(e,n,i){return new gI(e,n,i)}};function Ux(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class Sk{constructor(e,n,i,r){this.from=e,this.to=n,this.value=i,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,n,i,r=0){let s=i?this.to:this.from;for(let o=r,a=s.length;;){if(o==a)return o;let l=o+a>>1,u=s[l]-e||(i?this.value[l].endSide:this.value[l].startSide)-n;if(l==o)return u>=0?o:a;u>=0?a=l:o=l+1}}between(e,n,i,r){for(let s=this.findIndex(n,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,n){let i=[],r=[],s=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let u=this.value[l],c=this.from[l]+e,d=this.to[l]+e,h,f;if(c==d){let p=n.mapPos(c,u.startSide,u.mapMode);if(p==null||(h=f=p,u.startSide!=u.endSide&&(f=n.mapPos(c,u.endSide),f<h)))continue}else if(h=n.mapPos(c,u.startSide),f=n.mapPos(d,u.endSide),h>f||h==f&&u.startSide>0&&u.endSide<=0)continue;(f-h||u.endSide-u.startSide)<0||(o<0&&(o=h),u.point&&(a=Math.max(a,f-h)),i.push(u),r.push(h-o),s.push(f-o))}return{mapped:i.length?new Sk(r,s,i,a):null,pos:o}}}class ct{constructor(e,n,i,r){this.chunkPos=e,this.chunk=n,this.nextLayer=i,this.maxPoint=r}static create(e,n,i,r){return new ct(e,n,i,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let n of this.chunk)e+=n.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:n=[],sort:i=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(n.length==0&&!o)return this;if(i&&(n=n.slice().sort(Ux)),this.isEmpty)return n.length?ct.of(n):this;let a=new vI(this,null,-1).goto(0),l=0,u=[],c=new ql;for(;a.value||l<n.length;)if(l<n.length&&(a.from-n[l].from||a.startSide-n[l].value.startSide)>=0){let d=n[l++];c.addInner(d.from,d.to,d.value)||u.push(d)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==n.length||this.chunkEnd(a.chunkIndex)<n[l].from)&&(!o||r>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&c.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||r>a.to||s<a.from||o(a.from,a.to,a.value))&&(c.addInner(a.from,a.to,a.value)||u.push(zx.create(a.from,a.to,a.value))),a.next());return c.finishInner(this.nextLayer.isEmpty&&!u.length?ct.empty:this.nextLayer.update({add:u,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let n=[],i=[],r=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],u=e.touchesRange(a,a+l.length);if(u===!1)r=Math.max(r,l.maxPoint),n.push(l),i.push(e.mapPos(a));else if(u===!0){let{mapped:c,pos:d}=l.map(a,e);c&&(r=Math.max(r,c.maxPoint),n.push(c),i.push(d))}}let s=this.nextLayer.map(e);return n.length==0?s:new ct(i,n,s||ct.empty,r)}between(e,n,i){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(n>=s&&e<=s+o.length&&o.between(s,e-s,n-s,i)===!1)return}this.nextLayer.between(e,n,i)}}iter(e=0){return Qh.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,n=0){return Qh.from(e).goto(n)}static compare(e,n,i,r,s=-1){let o=e.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),a=n.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),l=YA(o,a,i),u=new kd(o,l,s),c=new kd(a,l,s);i.iterGaps((d,h,f)=>JA(u,d,c,h,f,r)),i.empty&&i.length==0&&JA(u,0,c,0,0,r)}static eq(e,n,i=0,r){r==null&&(r=999999999);let s=e.filter(c=>!c.isEmpty&&n.indexOf(c)<0),o=n.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let a=YA(s,o),l=new kd(s,a,0).goto(i),u=new kd(o,a,0).goto(i);for(;;){if(l.to!=u.to||!Vx(l.active,u.active)||l.point&&(!u.point||!l.point.eq(u.point)))return!1;if(l.to>r)return!0;l.next(),u.next()}}static spans(e,n,i,r,s=-1){let o=new kd(e,null,s).goto(n),a=n,l=o.openStart;for(;;){let u=Math.min(o.to,i);if(o.point){let c=o.activeForPoint(o.to),d=o.pointFrom<n?c.length+1:o.point.startSide<0?c.length:Math.min(c.length,l);r.point(a,u,o.point,c,d,o.pointRank),l=Math.min(o.openEnd(u),c.length)}else u>a&&(r.span(a,u,o.active,l),l=o.openEnd(u));if(o.to>i)return l+(o.point&&o.to>i?1:0);a=o.to,o.next()}}static of(e,n=!1){let i=new ql;for(let r of e instanceof zx?[e]:n?DU(e):e)i.add(r.from,r.to,r.value);return i.finish()}static join(e){if(!e.length)return ct.empty;let n=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let r=e[i];r!=ct.empty;r=r.nextLayer)n=new ct(r.chunkPos,r.chunk,n,Math.max(r.maxPoint,n.maxPoint));return n}}ct.empty=new ct([],[],null,-1);function DU(t){if(t.length>1)for(let e=t[0],n=1;n<t.length;n++){let i=t[n];if(Ux(e,i)>0)return t.slice().sort(Ux);e=i}return t}ct.empty.nextLayer=ct.empty;class ql{finishChunk(e){this.chunks.push(new Sk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,n,i){this.addInner(e,n,i)||(this.nextLayer||(this.nextLayer=new ql)).add(e,n,i)}addInner(e,n,i){let r=e-this.lastTo||i.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(n-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=n,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,n-e)),!0)}addChunk(e,n){if((e-this.lastTo||n.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,n.maxPoint),this.chunks.push(n),this.chunkPos.push(e);let i=n.value.length-1;return this.last=n.value[i],this.lastFrom=n.from[i]+e,this.lastTo=n.to[i]+e,!0}finish(){return this.finishInner(ct.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let n=ct.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,n}}function YA(t,e,n){let i=new Map;for(let s of t)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&i.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=i.get(s.chunk[o]);a!=null&&(n?n.mapPos(a):a)==s.chunkPos[o]&&!(n!=null&&n.touchesRange(a,a+s.chunk[o].length))&&r.add(s.chunk[o])}return r}class vI{constructor(e,n,i,r=0){this.layer=e,this.skip=n,this.minPoint=i,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,n=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,n,!1),this}gotoInner(e,n,i){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],n,!0);(!i||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,n){(this.to-e||this.endSide-n)<0&&this.gotoInner(e,n,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],n=this.layer.chunk[this.chunkIndex],i=e+n.from[this.rangeIndex];if(this.from=i,this.to=e+n.to[this.rangeIndex],this.value=n.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Qh{constructor(e){this.heap=e}static from(e,n=null,i=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&r.push(new vI(o,n,i,s));return r.length==1?r[0]:new Qh(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,n=-1e9){for(let i of this.heap)i.goto(e,n);for(let i=this.heap.length>>1;i>=0;i--)Z0(this.heap,i);return this.next(),this}forward(e,n){for(let i of this.heap)i.forward(e,n);for(let i=this.heap.length>>1;i>=0;i--)Z0(this.heap,i);(this.to-e||this.value.endSide-n)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Z0(this.heap,0)}}}function Z0(t,e){for(let n=t[e];;){let i=(e<<1)+1;if(i>=t.length)break;let r=t[i];if(i+1<t.length&&r.compare(t[i+1])>=0&&(r=t[i+1],i++),n.compare(r)<0)break;t[i]=n,t[e]=r,e=i}}class kd{constructor(e,n,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Qh.from(e,n,i)}goto(e,n=-1e9){return this.cursor.goto(e,n),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=n,this.openStart=-1,this.next(),this}forward(e,n){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-n)<0;)this.removeActive(this.minActive);this.cursor.forward(e,n)}removeActive(e){Kp(this.active,e),Kp(this.activeTo,e),Kp(this.activeRank,e),this.minActive=ZA(this.active,this.activeTo)}addActive(e){let n=0,{value:i,to:r,rank:s}=this.cursor;for(;n<this.activeRank.length&&(s-this.activeRank[n]||r-this.activeTo[n])>0;)n++;Xp(this.active,n,i),Xp(this.activeTo,n,r),Xp(this.activeRank,n,s),e&&Xp(e,n,this.cursor.from),this.minActive=ZA(this.active,this.activeTo)}next(){let e=this.to,n=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&Kp(i,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(i),this.cursor.next();else if(n&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let r=i.length-1;r>=0&&i[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let n=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&n.push(this.active[i]);return n.reverse()}openEnd(e){let n=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)n++;return n}}function JA(t,e,n,i,r,s){t.goto(e),n.goto(i);let o=i+r,a=i,l=i-e;for(;;){let u=t.to+l-n.to||t.endSide-n.endSide,c=u<0?t.to+l:n.to,d=Math.min(c,o);if(t.point||n.point?t.point&&n.point&&(t.point==n.point||t.point.eq(n.point))&&Vx(t.activeForPoint(t.to),n.activeForPoint(n.to))||s.comparePoint(a,d,t.point,n.point):d>a&&!Vx(t.active,n.active)&&s.compareRange(a,d,t.active,n.active),c>o)break;a=c,u<=0&&t.next(),u>=0&&n.next()}}function Vx(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n]&&!t[n].eq(e[n]))return!1;return!0}function Kp(t,e){for(let n=e,i=t.length-1;n<i;n++)t[n]=t[n+1];t.pop()}function Xp(t,e,n){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=n}function ZA(t,e){let n=-1,i=1e9;for(let r=0;r<e.length;r++)(e[r]-i||t[r].endSide-t[n].endSide)<0&&(n=r,i=e[r]);return n}function qf(t,e,n=t.length){let i=0;for(let r=0;r<n;)t.charCodeAt(r)==9?(i+=e-i%e,r++):(i++,r=Tn(t,r));return i}function LU(t,e,n,i){for(let r=0,s=0;;){if(s>=e)return r;if(r==t.length)break;s+=t.charCodeAt(r)==9?n-s%n:1,r=Tn(t,r)}return i===!0?-1:t.length}const Hx="ͼ",QA=typeof Symbol>"u"?"__"+Hx:Symbol.for(Hx),Wx=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),eP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Fa{constructor(e,n){this.rules=[];let{finish:i}=n||{};function r(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,l,u){let c=[],d=/^@(\w+)\b/.exec(o[0]),h=d&&d[1]=="keyframes";if(d&&a==null)return l.push(o[0]+";");for(let f in a){let p=a[f];if(/&/.test(f))s(f.split(/,\s*/).map(m=>o.map(w=>m.replace(/&/,w))).reduce((m,w)=>m.concat(w)),p,l);else if(p&&typeof p=="object"){if(!d)throw new RangeError("The value of a property ("+f+") should be a primitive value.");s(r(f),p,c,h)}else p!=null&&c.push(f.replace(/_.*/,"").replace(/[A-Z]/g,m=>"-"+m.toLowerCase())+": "+p+";")}(c.length||h)&&l.push((i&&!d&&!u?o.map(i):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(r(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=eP[QA]||1;return eP[QA]=e+1,Hx+e.toString(36)}static mount(e,n,i){let r=e[Wx],s=i&&i.nonce;r?s&&r.setNonce(s):r=new jU(e,s),r.mount(Array.isArray(n)?n:[n],e)}}let tP=new Map;class jU{constructor(e,n){let i=e.ownerDocument||e,r=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let s=tP.get(i);if(s)return e[Wx]=s;this.sheet=new r.CSSStyleSheet,tP.set(i,this)}else this.styleTag=i.createElement("style"),n&&this.styleTag.setAttribute("nonce",n);this.modules=[],e[Wx]=this}mount(e,n){let i=this.sheet,r=0,s=0;for(let o=0;o<e.length;o++){let a=e[o],l=this.modules.indexOf(a);if(l<s&&l>-1&&(this.modules.splice(l,1),s--,l=-1),l==-1){if(this.modules.splice(s++,0,a),i)for(let u=0;u<a.rules.length;u++)i.insertRule(a.rules[u],r++)}else{for(;s<l;)r+=this.modules[s++].rules.length;r+=a.rules.length,s++}}if(i)n.adoptedStyleSheets.indexOf(this.sheet)<0&&(n.adoptedStyleSheets=[this.sheet,...n.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=n.head||n;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Ba={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},ef={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},FU=typeof navigator<"u"&&/Mac/.test(navigator.platform),BU=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var kn=0;kn<10;kn++)Ba[48+kn]=Ba[96+kn]=String(kn);for(var kn=1;kn<=24;kn++)Ba[kn+111]="F"+kn;for(var kn=65;kn<=90;kn++)Ba[kn]=String.fromCharCode(kn+32),ef[kn]=String.fromCharCode(kn);for(var Q0 in Ba)ef.hasOwnProperty(Q0)||(ef[Q0]=Ba[Q0]);function $U(t){var e=FU&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||BU&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?ef:Ba)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}function tf(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function Gx(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function zU(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Zm(t,e){if(!e.anchorNode)return!1;try{return Gx(t,e.anchorNode)}catch{return!1}}function nf(t){return t.nodeType==3?Jl(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function yh(t,e,n,i){return n?nP(t,e,n,i,-1)||nP(t,e,n,i,1):!1}function Yl(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function tv(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function nP(t,e,n,i,r){for(;;){if(t==n&&e==i)return!0;if(e==(r<0?0:To(t))){if(t.nodeName=="DIV")return!1;let s=t.parentNode;if(!s||s.nodeType!=1)return!1;e=Yl(t)+(r<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(r<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=r<0?To(t):0}else return!1}}function To(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function kk(t,e){let n=e?t.left:t.right;return{left:n,right:n,top:t.top,bottom:t.bottom}}function UU(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function yI(t,e){let n=e.width/t.offsetWidth,i=e.height/t.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.width-t.offsetWidth)<1)&&(n=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-t.offsetHeight)<1)&&(i=1),{scaleX:n,scaleY:i}}function VU(t,e,n,i,r,s,o,a){let l=t.ownerDocument,u=l.defaultView||window;for(let c=t,d=!1;c&&!d;)if(c.nodeType==1){let h,f=c==l.body,p=1,m=1;if(f)h=UU(u);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let y=c.getBoundingClientRect();({scaleX:p,scaleY:m}=yI(c,y)),h={left:y.left,right:y.left+c.clientWidth*p,top:y.top,bottom:y.top+c.clientHeight*m}}let w=0,v=0;if(r=="nearest")e.top<h.top?(v=-(h.top-e.top+o),n>0&&e.bottom>h.bottom+v&&(v=e.bottom-h.bottom+v+o)):e.bottom>h.bottom&&(v=e.bottom-h.bottom+o,n<0&&e.top-v<h.top&&(v=-(h.top+v-e.top+o)));else{let y=e.bottom-e.top,b=h.bottom-h.top;v=(r=="center"&&y<=b?e.top+y/2-b/2:r=="start"||r=="center"&&n<0?e.top-o:e.bottom-b+o)-h.top}if(i=="nearest"?e.left<h.left?(w=-(h.left-e.left+s),n>0&&e.right>h.right+w&&(w=e.right-h.right+w+s)):e.right>h.right&&(w=e.right-h.right+s,n<0&&e.left<h.left+w&&(w=-(h.left+w-e.left+s))):w=(i=="center"?e.left+(e.right-e.left)/2-(h.right-h.left)/2:i=="start"==a?e.left-s:e.right-(h.right-h.left)+s)-h.left,w||v)if(f)u.scrollBy(w,v);else{let y=0,b=0;if(v){let k=c.scrollTop;c.scrollTop+=v/m,b=(c.scrollTop-k)*m}if(w){let k=c.scrollLeft;c.scrollLeft+=w/p,y=(c.scrollLeft-k)*p}e={left:e.left-y,top:e.top-b,right:e.right-y,bottom:e.bottom-b},y&&Math.abs(y-w)<1&&(i="nearest"),b&&Math.abs(b-v)<1&&(r="nearest")}if(f)break;c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function HU(t){let e=t.ownerDocument,n,i;for(let r=t.parentNode;r&&!(r==e.body||n&&i);)if(r.nodeType==1)!i&&r.scrollHeight>r.clientHeight&&(i=r),!n&&r.scrollWidth>r.clientWidth&&(n=r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;return{x:n,y:i}}class WU{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:n,focusNode:i}=e;this.set(n,Math.min(e.anchorOffset,n?To(n):0),i,Math.min(e.focusOffset,i?To(i):0))}set(e,n,i,r){this.anchorNode=e,this.anchorOffset=n,this.focusNode=i,this.focusOffset=r}}let pu=null;function wI(t){if(t.setActive)return t.setActive();if(pu)return t.focus(pu);let e=[];for(let n=t;n&&(e.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(t.focus(pu==null?{get preventScroll(){return pu={preventScroll:!0},!0}}:void 0),!pu){pu=!1;for(let n=0;n<e.length;){let i=e[n++],r=e[n++],s=e[n++];i.scrollTop!=r&&(i.scrollTop=r),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let iP;function Jl(t,e,n=e){let i=iP||(iP=document.createRange());return i.setEnd(t,n),i.setStart(t,e),i}function ac(t,e,n,i){let r={key:e,code:e,keyCode:n,which:n,cancelable:!0};i&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=i);let s=new KeyboardEvent("keydown",r);s.synthetic=!0,t.dispatchEvent(s);let o=new KeyboardEvent("keyup",r);return o.synthetic=!0,t.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function GU(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function bI(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function KU(t,e){let n=e.focusNode,i=e.focusOffset;if(!n||e.anchorNode!=n||e.anchorOffset!=i)return!1;for(i=Math.min(i,To(n));;)if(i){if(n.nodeType!=1)return!1;let r=n.childNodes[i-1];r.contentEditable=="false"?i--:(n=r,i=To(n))}else{if(n==t)return!0;i=Yl(n),n=n.parentNode}}function xI(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function SI(t,e){for(let n=t,i=e;;){if(n.nodeType==3&&i>0)return{node:n,offset:i};if(n.nodeType==1&&i>0){if(n.contentEditable=="false")return null;n=n.childNodes[i-1],i=To(n)}else if(n.parentNode&&!tv(n))i=Yl(n),n=n.parentNode;else return null}}function kI(t,e){for(let n=t,i=e;;){if(n.nodeType==3&&i<n.nodeValue.length)return{node:n,offset:i};if(n.nodeType==1&&i<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[i],i=0}else if(n.parentNode&&!tv(n))i=Yl(n)+1,n=n.parentNode;else return null}}class zn{constructor(e,n,i=!0){this.node=e,this.offset=n,this.precise=i}static before(e,n){return new zn(e.parentNode,Yl(e),n)}static after(e,n){return new zn(e.parentNode,Yl(e)+1,n)}}const _k=[];class xt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let n=this.posAtStart;for(let i of this.children){if(i==e)return n;n+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,n){if(this.flags&2){let i=this.dom,r=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=r?r.nextSibling:i.firstChild)){let a=xt.get(s);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,n),o.flags&=-8}if(s=r?r.nextSibling:i.firstChild,n&&!n.written&&n.node==i&&s!=o.dom&&(n.written=!0),o.dom.parentNode==i)for(;s&&s!=o.dom;)s=rP(s);else i.insertBefore(o.dom,s);r=o.dom}for(s=r?r.nextSibling:i.firstChild,s&&n&&n.node==i&&(n.written=!0);s;)s=rP(s)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,n),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,n){let i;if(e==this.dom)i=this.dom.childNodes[n];else{let r=To(e)==0?0:n==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!xt.get(i);)i=i.nextSibling;if(!i)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==i)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,n,i=0){let r=-1,s=-1,o=-1,a=-1;for(let l=0,u=i,c=i;l<this.children.length;l++){let d=this.children[l],h=u+d.length;if(u<e&&h>n)return d.domBoundsAround(e,n,u);if(h>=e&&r==-1&&(r=l,s=u),u>n&&d.dom.parentNode==this.dom){o=l,a=c;break}c=h,u=h+d.breakAfter}return{from:s,to:a<0?i+this.length:a,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let n=this.parent;n;n=n.parent){if(e&&(n.flags|=2),n.flags&1)return;n.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let n=e.parent;if(!n)return e;e=n}}replaceChildren(e,n,i=_k){this.markDirty();for(let r=e;r<n;r++){let s=this.children[r];s.parent==this&&i.indexOf(s)<0&&s.destroy()}this.children.splice(e,n-e,...i);for(let r=0;r<i.length;r++)i[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new _I(this.children,e,this.children.length)}childPos(e,n=1){return this.childCursor().findPos(e,n)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,n,i,r,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}xt.prototype.breakAfter=0;function rP(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class _I{constructor(e,n,i){this.children=e,this.pos=n,this.i=i,this.off=0}findPos(e,n=1){for(;;){if(e>this.pos||e==this.pos&&(n>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function CI(t,e,n,i,r,s,o,a,l){let{children:u}=t,c=u.length?u[e]:null,d=s.length?s[s.length-1]:null,h=d?d.breakAfter:o;if(!(e==i&&c&&!o&&!h&&s.length<2&&c.merge(n,r,s.length?d:null,n==0,a,l))){if(i<u.length){let f=u[i];f&&(r<f.length||f.breakAfter&&(d!=null&&d.breakAfter))?(e==i&&(f=f.split(r),r=0),!h&&d&&f.merge(0,r,d,!0,0,l)?s[s.length-1]=f:((r||f.children.length&&!f.children[0].length)&&f.merge(0,r,null,!1,0,l),s.push(f))):f!=null&&f.breakAfter&&(d?d.breakAfter=1:o=1),i++}for(c&&(c.breakAfter=o,n>0&&(!o&&s.length&&c.merge(n,c.length,s[0],!1,a,0)?c.breakAfter=s.shift().breakAfter:(n<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(n,c.length,null,!1,a,0),e++));e<i&&s.length;)if(u[i-1].become(s[s.length-1]))i--,s.pop(),l=s.length?0:a;else if(u[e].become(s[0]))e++,s.shift(),a=s.length?0:l;else break;!s.length&&e&&i<u.length&&!u[e-1].breakAfter&&u[i].merge(0,0,u[e-1],!1,a,l)&&e--,(e<i||s.length)&&t.replaceChildren(e,i,s)}}function EI(t,e,n,i,r,s){let o=t.childCursor(),{i:a,off:l}=o.findPos(n,1),{i:u,off:c}=o.findPos(e,-1),d=e-n;for(let h of i)d+=h.length;t.length+=d,CI(t,u,c,a,l,i,0,r,s)}let bi=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Kx=typeof document<"u"?document:{documentElement:{style:{}}};const Xx=/Edge\/(\d+)/.exec(bi.userAgent),AI=/MSIE \d/.test(bi.userAgent),qx=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(bi.userAgent),wy=!!(AI||qx||Xx),sP=!wy&&/gecko\/(\d+)/i.test(bi.userAgent),ew=!wy&&/Chrome\/(\d+)/.exec(bi.userAgent),oP="webkitFontSmoothing"in Kx.documentElement.style,PI=!wy&&/Apple Computer/.test(bi.vendor),aP=PI&&(/Mobile\/\w+/.test(bi.userAgent)||bi.maxTouchPoints>2);var be={mac:aP||/Mac/.test(bi.platform),windows:/Win/.test(bi.platform),linux:/Linux|X11/.test(bi.platform),ie:wy,ie_version:AI?Kx.documentMode||6:qx?+qx[1]:Xx?+Xx[1]:0,gecko:sP,gecko_version:sP?+(/Firefox\/(\d+)/.exec(bi.userAgent)||[0,0])[1]:0,chrome:!!ew,chrome_version:ew?+ew[1]:0,ios:aP,android:/Android\b/.test(bi.userAgent),webkit:oP,safari:PI,webkit_version:oP?+(/\bAppleWebKit\/(\d+)/.exec(bi.userAgent)||[0,0])[1]:0,tabSize:Kx.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const XU=256;class ts extends xt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,n){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(n&&n.node==this.dom&&(n.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,n,i){return this.flags&8||i&&(!(i instanceof ts)||this.length-(n-e)+i.length>XU||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(n),this.markDirty(),!0)}split(e){let n=new ts(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),n.flags|=this.flags&8,n}localPosFromDOM(e,n){return e==this.dom?n:n?this.text.length:0}domAtPos(e){return new zn(this.dom,e)}domBoundsAround(e,n,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,n){return qU(this.dom,e,n)}}class Ro extends xt{constructor(e,n=[],i=0){super(),this.mark=e,this.children=n,this.length=i;for(let r of n)r.setParent(this)}setAttrs(e){if(bI(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let n in this.mark.attrs)e.setAttribute(n,this.mark.attrs[n]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,n){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,n)}merge(e,n,i,r,s,o){return i&&(!(i instanceof Ro&&i.mark.eq(this.mark))||e&&s<=0||n<this.length&&o<=0)?!1:(EI(this,e,n,i?i.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let n=[],i=0,r=-1,s=0;for(let a of this.children){let l=i+a.length;l>e&&n.push(i<e?a.split(e-i):a),r<0&&i>=e&&(r=s),i=l,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new Ro(this.mark,n,o)}domAtPos(e){return TI(this,e)}coordsAt(e,n){return NI(this,e,n)}}function qU(t,e,n){let i=t.nodeValue.length;e>i&&(e=i);let r=e,s=e,o=0;e==0&&n<0||e==i&&n>=0?be.chrome||be.gecko||(e?(r--,o=1):s<i&&(s++,o=-1)):n<0?r--:s<i&&s++;let a=Jl(t,r,s).getClientRects();if(!a.length)return null;let l=a[(o?o<0:n>=0)?0:a.length-1];return be.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,u=>u.width)||l),o?kk(l,o<0):l||null}class pa extends xt{static create(e,n,i){return new pa(e,n,i)}constructor(e,n,i){super(),this.widget=e,this.length=n,this.side=i,this.prevWidget=null}split(e){let n=pa.create(this.widget,this.length-e,this.side);return this.length-=e,n}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,n,i,r,s,o){return i&&(!(i instanceof pa)||!this.widget.compare(i.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-n),!0)}become(e){return e instanceof pa&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return ot.empty;let e=this;for(;e.parent;)e=e.parent;let{view:n}=e,i=n&&n.state.doc,r=this.posAtStart;return i?i.slice(r,r+this.length):ot.empty}domAtPos(e){return(this.length?e==0:this.side>0)?zn.before(this.dom):zn.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,n){let i=this.widget.coordsAt(this.dom,e,n);if(i)return i;let r=this.dom.getClientRects(),s=null;if(!r.length)return null;let o=this.side?this.side<0:e>0;for(let a=o?r.length-1:0;s=r[a],!(e>0?a==0:a==r.length-1||s.top<s.bottom);a+=o?-1:1);return kk(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Oc extends xt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Oc&&e.side==this.side}split(){return new Oc(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?zn.before(this.dom):zn.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ot.empty}get isHidden(){return!0}}ts.prototype.children=pa.prototype.children=Oc.prototype.children=_k;function TI(t,e){let n=t.dom,{children:i}=t,r=0;for(let s=0;r<i.length;r++){let o=i[r],a=s+o.length;if(!(a==s&&o.getSide()<=0)){if(e>s&&e<a&&o.dom.parentNode==n)return o.domAtPos(e-s);if(e<=s)break;s=a}}for(let s=r;s>0;s--){let o=i[s-1];if(o.dom.parentNode==n)return o.domAtPos(o.length)}for(let s=r;s<i.length;s++){let o=i[s];if(o.dom.parentNode==n)return o.domAtPos(0)}return new zn(n,0)}function RI(t,e,n){let i,{children:r}=t;n>0&&e instanceof Ro&&r.length&&(i=r[r.length-1])instanceof Ro&&i.mark.eq(e.mark)?RI(i,e.children[0],n-1):(r.push(e),e.setParent(t)),t.length+=e.length}function NI(t,e,n){let i=null,r=-1,s=null,o=-1;function a(u,c){for(let d=0,h=0;d<u.children.length&&h<=c;d++){let f=u.children[d],p=h+f.length;p>=c&&(f.children.length?a(f,c-h):(!s||s.isHidden&&n>0)&&(p>c||h==p&&f.getSide()>0)?(s=f,o=c-h):(h<c||h==p&&f.getSide()<0&&!f.isHidden)&&(i=f,r=c-h)),h=p}}a(t,e);let l=(n<0?i:s)||i||s;return l?l.coordsAt(Math.max(0,l==i?r:o),n):YU(t)}function YU(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let n=nf(e);return n[n.length-1]||null}function Yx(t,e){for(let n in t)n=="class"&&e.class?e.class+=" "+t.class:n=="style"&&e.style?e.style+=";"+t.style:e[n]=t[n];return e}const lP=Object.create(null);function nv(t,e,n){if(t==e)return!0;t||(t=lP),e||(e=lP);let i=Object.keys(t),r=Object.keys(e);if(i.length-(n&&i.indexOf(n)>-1?1:0)!=r.length-(n&&r.indexOf(n)>-1?1:0))return!1;for(let s of i)if(s!=n&&(r.indexOf(s)==-1||t[s]!==e[s]))return!1;return!0}function Jx(t,e,n){let i=!1;if(e)for(let r in e)n&&r in n||(i=!0,r=="style"?t.style.cssText="":t.removeAttribute(r));if(n)for(let r in n)e&&e[r]==n[r]||(i=!0,r=="style"?t.style.cssText=n[r]:t.setAttribute(r,n[r]));return i}function JU(t){let e=Object.create(null);for(let n=0;n<t.attributes.length;n++){let i=t.attributes[n];e[i.name]=i.value}return e}class Yt extends xt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,n,i,r,s,o){if(i){if(!(i instanceof Yt))return!1;this.dom||i.transferDOM(this)}return r&&this.setDeco(i?i.attrs:null),EI(this,e,n,i?i.children.slice():[],s,o),!0}split(e){let n=new Yt;if(n.breakAfter=this.breakAfter,this.length==0)return n;let{i,off:r}=this.childPos(e);r&&(n.append(this.children[i].split(r),0),this.children[i].merge(r,this.children[i].length,null,!1,0,0),i++);for(let s=i;s<this.children.length;s++)n.append(this.children[s],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,n}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){nv(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,n){RI(this,e,n)}addLineDeco(e){let n=e.spec.attributes,i=e.spec.class;n&&(this.attrs=Yx(n,this.attrs||{})),i&&(this.attrs=Yx({class:i},this.attrs||{}))}domAtPos(e){return TI(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,n){var i;this.dom?this.flags&4&&(bI(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Jx(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,n);let r=this.dom.lastChild;for(;r&&xt.get(r)instanceof Ro;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((i=xt.get(r))===null||i===void 0?void 0:i.isEditable)==!1&&(!be.ios||!this.children.some(s=>s instanceof ts))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,n;for(let i of this.children){if(!(i instanceof ts)||/[^ -~]/.test(i.text))return null;let r=nf(i.dom);if(r.length!=1)return null;e+=r[0].width,n=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:n}:null}coordsAt(e,n){let i=NI(this,e,n);if(!this.children.length&&i&&this.parent){let{heightOracle:r}=this.parent.view.viewState,s=i.bottom-i.top;if(Math.abs(s-r.lineHeight)<2&&r.textHeight<s){let o=(s-r.textHeight)/2;return{top:i.top+o,bottom:i.bottom-o,left:i.left,right:i.left}}}return i}become(e){return e instanceof Yt&&this.children.length==0&&e.children.length==0&&nv(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,n){for(let i=0,r=0;i<e.children.length;i++){let s=e.children[i],o=r+s.length;if(o>=n){if(s instanceof Yt)return s;if(o>n)break}r=o+s.breakAfter}return null}}class So extends xt{constructor(e,n,i){super(),this.widget=e,this.length=n,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,n,i,r,s,o){return i&&(!(i instanceof So)||!this.widget.compare(i.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-n),!0)}domAtPos(e){return e==0?zn.before(this.dom):zn.after(this.dom,e==this.length)}split(e){let n=this.length-e;this.length=e;let i=new So(this.widget,n,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return _k}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ot.empty}domBoundsAround(){return null}become(e){return e instanceof So&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,n){return this.widget.coordsAt(this.dom,e,n)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:n,endSide:i}=this.deco;return n==i?!1:e<0?n<0:i>0}}class nl{eq(e){return!1}updateDOM(e,n){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,n,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var ii=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(ii||(ii={}));class Ge extends Xl{constructor(e,n,i,r){super(),this.startSide=e,this.endSide=n,this.widget=i,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Yf(e)}static widget(e){let n=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return n+=i&&!e.inlineOrder?n>0?3e8:-4e8:n>0?1e8:-1e8,new $a(e,n,n,i,e.widget||null,!1)}static replace(e){let n=!!e.block,i,r;if(e.isBlockGap)i=-5e8,r=4e8;else{let{start:s,end:o}=MI(e,n);i=(s?n?-3e8:-1:5e8)-1,r=(o?n?2e8:1:-6e8)+1}return new $a(e,i,r,n,e.widget||null,!0)}static line(e){return new Jf(e)}static set(e,n=!1){return ct.of(e,n)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ge.none=ct.empty;class Yf extends Ge{constructor(e){let{start:n,end:i}=MI(e);super(n?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var n,i;return this==e||e instanceof Yf&&this.tagName==e.tagName&&(this.class||((n=this.attrs)===null||n===void 0?void 0:n.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&nv(this.attrs,e.attrs,"class")}range(e,n=e){if(e>=n)throw new RangeError("Mark decorations may not be empty");return super.range(e,n)}}Yf.prototype.point=!1;class Jf extends Ge{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Jf&&this.spec.class==e.spec.class&&nv(this.spec.attributes,e.spec.attributes)}range(e,n=e){if(n!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,n)}}Jf.prototype.mapMode=xi.TrackBefore;Jf.prototype.point=!0;class $a extends Ge{constructor(e,n,i,r,s,o){super(n,i,s,e),this.block=r,this.isReplace=o,this.mapMode=r?n<=0?xi.TrackBefore:xi.TrackAfter:xi.TrackDel}get type(){return this.startSide!=this.endSide?ii.WidgetRange:this.startSide<=0?ii.WidgetBefore:ii.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof $a&&ZU(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,n=e){if(this.isReplace&&(e>n||e==n&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&n!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,n)}}$a.prototype.point=!0;function MI(t,e=!1){let{inclusiveStart:n,inclusiveEnd:i}=t;return n==null&&(n=t.inclusive),i==null&&(i=t.inclusive),{start:n??e,end:i??e}}function ZU(t,e){return t==e||!!(t&&e&&t.compare(e))}function Zx(t,e,n,i=0){let r=n.length-1;r>=0&&n[r]+i>=t?n[r]=Math.max(n[r],e):n.push(t,e)}class wh{constructor(e,n,i,r){this.doc=e,this.pos=n,this.end=i,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=n}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof So&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Yt),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(qp(new Oc(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof So)&&this.getLine()}buildText(e,n,i){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(n.slice(n.length-i)),this.getLine().append(qp(new ts(this.text.slice(this.textOff,this.textOff+r)),n),i),this.atCursorPos=!0,this.textOff+=r,e-=r,i=0}}span(e,n,i,r){this.buildText(n-e,i,r),this.pos=n,this.openStart<0&&(this.openStart=r)}point(e,n,i,r,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof $a){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(n>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=n-e;if(i instanceof $a)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new So(i.widget||Ic.block,a,i));else{let l=pa.create(i.widget||Ic.inline,a,a?0:i.startSide),u=this.atCursorPos&&!l.isEditable&&s<=r.length&&(e<n||i.startSide>0),c=!l.isEditable&&(e<n||s>r.length||i.startSide<=0),d=this.getLine();this.pendingBuffer==2&&!u&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),u&&(d.append(qp(new Oc(1),r),s),s=r.length+Math.max(0,s-r.length)),d.append(qp(l,r),s),this.atCursorPos=c,this.pendingBuffer=c?e<n||s>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=n),this.openStart<0&&(this.openStart=s)}static build(e,n,i,r,s){let o=new wh(e,n,i,s);return o.openEnd=ct.spans(r,n,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function qp(t,e){for(let n of e)t=new Ro(n,[t],t.length);return t}class Ic extends nl{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Ic.inline=new Ic("span");Ic.block=new Ic("div");var Nt=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(Nt||(Nt={}));const Zl=Nt.LTR,Ck=Nt.RTL;function OI(t){let e=[];for(let n=0;n<t.length;n++)e.push(1<<+t[n]);return e}const QU=OI("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),eV=OI("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Qx=Object.create(null),ds=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),n=t.charCodeAt(1);Qx[e]=n,Qx[n]=-e}function II(t){return t<=247?QU[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?eV[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const tV=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ma{get dir(){return this.level%2?Ck:Zl}constructor(e,n,i){this.from=e,this.to=n,this.level=i}side(e,n){return this.dir==n==e?this.to:this.from}forward(e,n){return e==(this.dir==n)}static find(e,n,i,r){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=n&&a.to>=n){if(a.level==i)return o;(s<0||(r!=0?r<0?a.from<n:a.to>n:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function DI(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++){let i=t[n],r=e[n];if(i.from!=r.from||i.to!=r.to||i.direction!=r.direction||!DI(i.inner,r.inner))return!1}return!0}const yt=[];function nV(t,e,n,i,r){for(let s=0;s<=i.length;s++){let o=s?i[s-1].to:e,a=s<i.length?i[s].from:n,l=s?256:r;for(let u=o,c=l,d=l;u<a;u++){let h=II(t.charCodeAt(u));h==512?h=c:h==8&&d==4&&(h=16),yt[u]=h==4?2:h,h&7&&(d=h),c=h}for(let u=o,c=l,d=l;u<a;u++){let h=yt[u];if(h==128)u<a-1&&c==yt[u+1]&&c&24?h=yt[u]=c:yt[u]=256;else if(h==64){let f=u+1;for(;f<a&&yt[f]==64;)f++;let p=u&&c==8||f<n&&yt[f]==8?d==1?1:8:256;for(let m=u;m<f;m++)yt[m]=p;u=f-1}else h==8&&d==1&&(yt[u]=1);c=h,h&7&&(d=h)}}}function iV(t,e,n,i,r){let s=r==1?2:1;for(let o=0,a=0,l=0;o<=i.length;o++){let u=o?i[o-1].to:e,c=o<i.length?i[o].from:n;for(let d=u,h,f,p;d<c;d++)if(f=Qx[h=t.charCodeAt(d)])if(f<0){for(let m=a-3;m>=0;m-=3)if(ds[m+1]==-f){let w=ds[m+2],v=w&2?r:w&4?w&1?s:r:0;v&&(yt[d]=yt[ds[m]]=v),a=m;break}}else{if(ds.length==189)break;ds[a++]=d,ds[a++]=h,ds[a++]=l}else if((p=yt[d])==2||p==1){let m=p==r;l=m?0:1;for(let w=a-3;w>=0;w-=3){let v=ds[w+2];if(v&2)break;if(m)ds[w+2]|=2;else{if(v&4)break;ds[w+2]|=4}}}}}function rV(t,e,n,i){for(let r=0,s=i;r<=n.length;r++){let o=r?n[r-1].to:t,a=r<n.length?n[r].from:e;for(let l=o;l<a;){let u=yt[l];if(u==256){let c=l+1;for(;;)if(c==a){if(r==n.length)break;c=n[r++].to,a=r<n.length?n[r].from:e}else if(yt[c]==256)c++;else break;let d=s==1,h=(c<e?yt[c]:i)==1,f=d==h?d?1:2:i;for(let p=c,m=r,w=m?n[m-1].to:t;p>l;)p==w&&(p=n[--m].from,w=m?n[m-1].to:t),yt[--p]=f;l=c}else s=u,l++}}}function e1(t,e,n,i,r,s,o){let a=i%2?2:1;if(i%2==r%2)for(let l=e,u=0;l<n;){let c=!0,d=!1;if(u==s.length||l<s[u].from){let m=yt[l];m!=a&&(c=!1,d=m==16)}let h=!c&&a==1?[]:null,f=c?i:i+1,p=l;e:for(;;)if(u<s.length&&p==s[u].from){if(d)break e;let m=s[u];if(!c)for(let w=m.to,v=u+1;;){if(w==n)break e;if(v<s.length&&s[v].from==w)w=s[v++].to;else{if(yt[w]==a)break e;break}}if(u++,h)h.push(m);else{m.from>l&&o.push(new ma(l,m.from,f));let w=m.direction==Zl!=!(f%2);t1(t,w?i+1:i,r,m.inner,m.from,m.to,o),l=m.to}p=m.to}else{if(p==n||(c?yt[p]!=a:yt[p]==a))break;p++}h?e1(t,l,p,i+1,r,h,o):l<p&&o.push(new ma(l,p,f)),l=p}else for(let l=n,u=s.length;l>e;){let c=!0,d=!1;if(!u||l>s[u-1].to){let m=yt[l-1];m!=a&&(c=!1,d=m==16)}let h=!c&&a==1?[]:null,f=c?i:i+1,p=l;e:for(;;)if(u&&p==s[u-1].to){if(d)break e;let m=s[--u];if(!c)for(let w=m.from,v=u;;){if(w==e)break e;if(v&&s[v-1].to==w)w=s[--v].from;else{if(yt[w-1]==a)break e;break}}if(h)h.push(m);else{m.to<l&&o.push(new ma(m.to,l,f));let w=m.direction==Zl!=!(f%2);t1(t,w?i+1:i,r,m.inner,m.from,m.to,o),l=m.from}p=m.from}else{if(p==e||(c?yt[p-1]!=a:yt[p-1]==a))break;p--}h?e1(t,p,l,i+1,r,h,o):p<l&&o.push(new ma(p,l,f)),l=p}}function t1(t,e,n,i,r,s,o){let a=e%2?2:1;nV(t,r,s,i,a),iV(t,r,s,i,a),rV(r,s,i,a),e1(t,r,s,e,n,i,o)}function sV(t,e,n){if(!t)return[new ma(0,0,e==Ck?1:0)];if(e==Zl&&!n.length&&!tV.test(t))return LI(t.length);if(n.length)for(;t.length>yt.length;)yt[yt.length]=256;let i=[],r=e==Zl?0:1;return t1(t,r,r,n,0,t.length,i),i}function LI(t){return[new ma(0,t,0)]}let jI="";function oV(t,e,n,i,r){var s;let o=i.head-t.from,a=ma.find(e,o,(s=i.bidiLevel)!==null&&s!==void 0?s:-1,i.assoc),l=e[a],u=l.side(r,n);if(o==u){let h=a+=r?1:-1;if(h<0||h>=e.length)return null;l=e[a=h],o=l.side(!r,n),u=l.side(r,n)}let c=Tn(t.text,o,l.forward(r,n));(c<l.from||c>l.to)&&(c=u),jI=t.text.slice(Math.min(o,c),Math.max(o,c));let d=a==(r?e.length-1:0)?null:e[a+(r?1:-1)];return d&&c==u&&d.level+(r?0:1)<l.level?ne.cursor(d.side(!r,n)+t.from,d.forward(r,n)?1:-1,d.level):ne.cursor(c+t.from,l.forward(r,n)?-1:1,l.level)}function aV(t,e,n){for(let i=e;i<n;i++){let r=II(t.charCodeAt(i));if(r==1)return Zl;if(r==2||r==4)return Ck}return Zl}const FI=_e.define(),BI=_e.define(),$I=_e.define(),zI=_e.define(),n1=_e.define(),UI=_e.define(),VI=_e.define(),HI=_e.define({combine:t=>t.some(e=>e)}),WI=_e.define({combine:t=>t.some(e=>e)}),GI=_e.define();class lc{constructor(e,n="nearest",i="nearest",r=5,s=5,o=!1){this.range=e,this.y=n,this.x=i,this.yMargin=r,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new lc(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new lc(ne.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Yp=Xe.define({map:(t,e)=>t.map(e)}),KI=Xe.define();function Vi(t,e,n){let i=t.facet(zI);i.length?i[0](e):window.onerror?window.onerror(String(e),n,void 0,void 0,e):n?console.error(n+":",e):console.error(e)}const ia=_e.define({combine:t=>t.length?t[0]:!0});let lV=0;const Hd=_e.define();class In{constructor(e,n,i,r,s){this.id=e,this.create=n,this.domEventHandlers=i,this.domEventObservers=r,this.extension=s(this)}static define(e,n){const{eventHandlers:i,eventObservers:r,provide:s,decorations:o}=n||{};return new In(lV++,e,i,r,a=>{let l=[Hd.of(a)];return o&&l.push(rf.of(u=>{let c=u.plugin(a);return c?o(c):Ge.none})),s&&l.push(s(a)),l})}static fromClass(e,n){return In.define(i=>new e(i),n)}}class tw{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let n=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(n)}catch(i){if(Vi(n.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(n){Vi(e.state,n,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var n;if(!((n=this.value)===null||n===void 0)&&n.destroy)try{this.value.destroy()}catch(i){Vi(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const XI=_e.define(),Ek=_e.define(),rf=_e.define(),qI=_e.define(),Ak=_e.define(),YI=_e.define();function uP(t,e){let n=t.state.facet(YI);if(!n.length)return n;let i=n.map(s=>s instanceof Function?s(t):s),r=[];return ct.spans(i,e.from,e.to,{point(){},span(s,o,a,l){let u=s-e.from,c=o-e.from,d=r;for(let h=a.length-1;h>=0;h--,l--){let f=a[h].spec.bidiIsolate,p;if(f==null&&(f=aV(e.text,u,c)),l>0&&d.length&&(p=d[d.length-1]).to==u&&p.direction==f)p.to=c,d=p.inner;else{let m={from:u,to:c,direction:f,inner:[]};d.push(m),d=m.inner}}}}),r}const JI=_e.define();function ZI(t){let e=0,n=0,i=0,r=0;for(let s of t.state.facet(JI)){let o=s(t);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(n=Math.max(n,o.right)),o.top!=null&&(i=Math.max(i,o.top)),o.bottom!=null&&(r=Math.max(r,o.bottom)))}return{left:e,right:n,top:i,bottom:r}}const Wd=_e.define();class Sr{constructor(e,n,i,r){this.fromA=e,this.toA=n,this.fromB=i,this.toB=r}join(e){return new Sr(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let n=e.length,i=this;for(;n>0;n--){let r=e[n-1];if(!(r.fromA>i.toA)){if(r.toA<i.fromA)break;i=i.join(r),e.splice(n-1,1)}}return e.splice(n,0,i),e}static extendWithRanges(e,n){if(n.length==0)return e;let i=[];for(let r=0,s=0,o=0,a=0;;r++){let l=r==e.length?null:e[r],u=o-a,c=l?l.fromB:1e9;for(;s<n.length&&n[s]<c;){let d=n[s],h=n[s+1],f=Math.max(a,d),p=Math.min(c,h);if(f<=p&&new Sr(f+u,p+u,f,p).addToSet(i),h>c)break;s+=2}if(!l)return i;new Sr(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,a=l.toB}}}class iv{constructor(e,n,i){this.view=e,this.state=n,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=nn.empty(this.startState.doc.length);for(let s of i)this.changes=this.changes.compose(s.changes);let r=[];this.changes.iterChangedRanges((s,o,a,l)=>r.push(new Sr(s,o,a,l))),this.changedRanges=r}static create(e,n,i){return new iv(e,n,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class cP extends xt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Ge.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Yt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Sr(0,0,0,e.state.doc.length)],0,null)}update(e){var n;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:u,toA:c})=>c<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let r=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((n=this.domChanged)===null||n===void 0)&&n.newSel?r=this.domChanged.newSel.head:!mV(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let s=r>-1?cV(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:u,to:c}=this.hasComposition;i=new Sr(u,c,e.changes.mapPos(u,-1),e.changes.mapPos(c,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(be.ie||be.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.updateDeco(),l=fV(o,a,e.changes);return i=Sr.extendWithRanges(i,l),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,n,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,n,i);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=be.chrome||be.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||r.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof So&&o.widget instanceof dP&&s.push(o.dom);r.updateGaps(s)}updateChildren(e,n,i){let r=i?i.range.addToSet(e.slice()):e,s=this.childCursor(n);for(let o=r.length-1;;o--){let a=o>=0?r[o]:null;if(!a)break;let{fromA:l,toA:u,fromB:c,toB:d}=a,h,f,p,m;if(i&&i.range.fromB<d&&i.range.toB>c){let k=wh.build(this.view.state.doc,c,i.range.fromB,this.decorations,this.dynamicDecorationMap),_=wh.build(this.view.state.doc,i.range.toB,d,this.decorations,this.dynamicDecorationMap);f=k.breakAtStart,p=k.openStart,m=_.openEnd;let E=this.compositionView(i);_.breakAtStart?E.breakAfter=1:_.content.length&&E.merge(E.length,E.length,_.content[0],!1,_.openStart,0)&&(E.breakAfter=_.content[0].breakAfter,_.content.shift()),k.content.length&&E.merge(0,0,k.content[k.content.length-1],!0,0,k.openEnd)&&k.content.pop(),h=k.content.concat(E).concat(_.content)}else({content:h,breakAtStart:f,openStart:p,openEnd:m}=wh.build(this.view.state.doc,c,d,this.decorations,this.dynamicDecorationMap));let{i:w,off:v}=s.findPos(u,1),{i:y,off:b}=s.findPos(l,-1);CI(this,y,b,w,v,h,f,p,m)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let n of e.transactions)for(let i of n.effects)i.is(KI)&&(this.editContextFormatting=i.value)}compositionView(e){let n=new ts(e.text.nodeValue);n.flags|=8;for(let{deco:r}of e.marks)n=new Ro(r,[n],n.length);let i=new Yt;return i.append(n,0),i}fixCompositionDOM(e){let n=(s,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let a=xt.get(s);a&&a!=o&&(a.dom=null),o.setDOM(s)},i=this.childPos(e.range.fromB,1),r=this.children[i.i];n(e.line,r);for(let s=e.marks.length-1;s>=-1;s--)i=r.childPos(i.off,1),r=r.children[i.i],n(s>=0?e.marks[s].node:e.text,r)}updateSelection(e=!1,n=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,r=i==this.dom,s=!r&&Zm(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(r||n||s))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),u=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(be.gecko&&a.empty&&!this.hasComposition&&uV(l)){let d=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(d,l.node.childNodes[l.offset]||null)),l=u=new zn(d,0),o=!0}let c=this.view.observer.selectionRange;(o||!c.focusNode||(!yh(l.node,l.offset,c.anchorNode,c.anchorOffset)||!yh(u.node,u.offset,c.focusNode,c.focusOffset))&&!this.suppressWidgetCursorChange(c,a))&&(this.view.observer.ignore(()=>{be.android&&be.chrome&&this.dom.contains(c.focusNode)&&pV(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let d=tf(this.view.root);if(d)if(a.empty){if(be.gecko){let h=dV(l.node,l.offset);if(h&&h!=3){let f=(h==1?SI:kI)(l.node,l.offset);f&&(l=new zn(f.node,f.offset))}}d.collapse(l.node,l.offset),a.bidiLevel!=null&&d.caretBidiLevel!==void 0&&(d.caretBidiLevel=a.bidiLevel)}else if(d.extend){d.collapse(l.node,l.offset);try{d.extend(u.node,u.offset)}catch{}}else{let h=document.createRange();a.anchor>a.head&&([l,u]=[u,l]),h.setEnd(u.node,u.offset),h.setStart(l.node,l.offset),d.removeAllRanges(),d.addRange(h)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(l,u)),this.impreciseAnchor=l.precise?null:new zn(c.anchorNode,c.anchorOffset),this.impreciseHead=u.precise?null:new zn(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(e,n){return this.hasComposition&&n.empty&&yh(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==n.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,n=e.state.selection.main,i=tf(e.root),{anchorNode:r,anchorOffset:s}=e.observer.selectionRange;if(!i||!n.empty||!n.assoc||!i.modify)return;let o=Yt.find(this,n.head);if(!o)return;let a=o.posAtStart;if(n.head==a||n.head==a+o.length)return;let l=this.coordsAt(n.head,-1),u=this.coordsAt(n.head,1);if(!l||!u||l.bottom>u.top)return;let c=this.domAtPos(n.head+n.assoc);i.collapse(c.node,c.offset),i.modify("move",n.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let d=e.observer.selectionRange;e.docView.posFromDOM(d.anchorNode,d.anchorOffset)!=n.from&&i.collapse(r,s)}moveToLine(e){let n=this.dom,i;if(e.node!=n)return e;for(let r=e.offset;!i&&r<n.childNodes.length;r++){let s=xt.get(n.childNodes[r]);s instanceof Yt&&(i=s.domAtPos(0))}for(let r=e.offset-1;!i&&r>=0;r--){let s=xt.get(n.childNodes[r]);s instanceof Yt&&(i=s.domAtPos(s.length))}return i?new zn(i.node,i.offset,!0):e}nearest(e){for(let n=e;n;){let i=xt.get(n);if(i&&i.rootView==this)return i;n=n.parentNode}return null}posFromDOM(e,n){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,n)+i.posAtStart}domAtPos(e){let{i:n,off:i}=this.childCursor().findPos(e,-1);for(;n<this.children.length-1;){let r=this.children[n];if(i<r.length||r instanceof Yt)break;n++,i=0}return this.children[n].domAtPos(i)}coordsAt(e,n){let i=null,r=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=s-a.breakAfter,u=l-a.length;if(l<e)break;if(u<=e&&(u<e||a.covers(-1))&&(l>e||a.covers(1))&&(!i||a instanceof Yt&&!(i instanceof Yt&&n>=0)))i=a,r=u;else if(i&&u==e&&l==e&&a instanceof So&&Math.abs(n)<2){if(a.deco.startSide<0)break;o&&(i=null)}s=u}return i?i.coordsAt(e-r,n):null}coordsForChar(e){let{i:n,off:i}=this.childPos(e,1),r=this.children[n];if(!(r instanceof Yt))return null;for(;r.children.length;){let{i:a,off:l}=r.childPos(i,1);for(;;a++){if(a==r.children.length)return null;if((r=r.children[a]).length)break}i=l}if(!(r instanceof ts))return null;let s=Tn(r.text,i);if(s==i)return null;let o=Jl(r.dom,i,s).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let n=[],{from:i,to:r}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==Nt.LTR;for(let u=0,c=0;c<this.children.length;c++){let d=this.children[c],h=u+d.length;if(h>r)break;if(u>=i){let f=d.dom.getBoundingClientRect();if(n.push(f.height),o){let p=d.dom.lastChild,m=p?nf(p):[];if(m.length){let w=m[m.length-1],v=l?w.right-f.left:f.right-w.left;v>a&&(a=v,this.minWidth=s,this.minWidthFrom=u,this.minWidthTo=h)}}}u=h+d.breakAfter}return n}textDirectionAt(e){let{i:n}=this.childPos(e,1);return getComputedStyle(this.children[n].dom).direction=="rtl"?Nt.RTL:Nt.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Yt){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),n,i,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=nf(e.firstChild)[0];n=e.getBoundingClientRect().height,i=s?s.width/27:7,r=s?s.height:n,e.remove()}),{lineHeight:n,charWidth:i,textHeight:r}}childCursor(e=this.length){let n=this.children.length;return n&&(e-=this.children[--n].length),new _I(this.children,e,n)}computeBlockGapDeco(){let e=[],n=this.view.viewState;for(let i=0,r=0;;r++){let s=r==n.viewports.length?null:n.viewports[r],o=s?s.from-1:this.length;if(o>i){let a=(n.lineBlockAt(o).bottom-n.lineBlockAt(i).top)/this.view.scaleY;e.push(Ge.replace({widget:new dP(a),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return Ge.set(e)}updateDeco(){let e=1,n=this.view.state.facet(rf).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),i=!1,r=this.view.state.facet(qI).map((s,o)=>{let a=typeof s=="function";return a&&(i=!0),a?s(this.view):s});for(r.length&&(this.dynamicDecorationMap[e++]=i,n.push(ct.join(r))),this.decorations=[this.editContextFormatting,...n,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let u=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=u.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let u of this.view.state.facet(GI))try{if(u(this.view,e.range,e))return!0}catch(c){Vi(this.view.state,c,"scroll handler")}let{range:n}=e,i=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1),r;if(!i)return;!n.empty&&(r=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(i={left:Math.min(i.left,r.left),top:Math.min(i.top,r.top),right:Math.max(i.right,r.right),bottom:Math.max(i.bottom,r.bottom)});let s=ZI(this.view),o={left:i.left-s.left,top:i.top-s.top,right:i.right+s.right,bottom:i.bottom+s.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;VU(this.view.scrollDOM,o,n.head<n.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==Nt.LTR)}}function uV(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}class dP extends nl{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function QI(t,e){let n=t.observer.selectionRange;if(!n.focusNode)return null;let i=SI(n.focusNode,n.focusOffset),r=kI(n.focusNode,n.focusOffset),s=i||r;if(r&&i&&r.node!=i.node){let a=xt.get(r.node);if(!a||a instanceof ts&&a.text!=r.node.nodeValue)s=r;else if(t.docView.lastCompositionAfterCursor){let l=xt.get(i.node);!l||l instanceof ts&&l.text!=i.node.nodeValue||(s=r)}}if(t.docView.lastCompositionAfterCursor=s!=i,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function cV(t,e,n){let i=QI(t,n);if(!i)return null;let{node:r,from:s,to:o}=i,a=r.nodeValue;if(/[\n\r]/.test(a)||t.state.doc.sliceString(i.from,i.to)!=a)return null;let l=e.invertedDesc,u=new Sr(l.mapPos(s),l.mapPos(o),s,o),c=[];for(let d=r.parentNode;;d=d.parentNode){let h=xt.get(d);if(h instanceof Ro)c.push({node:d,deco:h.mark});else{if(h instanceof Yt||d.nodeName=="DIV"&&d.parentNode==t.contentDOM)return{range:u,text:r,marks:c,line:d};if(d!=t.contentDOM)c.push({node:d,deco:new Yf({inclusive:!0,attributes:JU(d),tagName:d.tagName.toLowerCase()})});else return null}}}function dV(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}let hV=class{constructor(){this.changes=[]}compareRange(e,n){Zx(e,n,this.changes)}comparePoint(e,n){Zx(e,n,this.changes)}};function fV(t,e,n){let i=new hV;return ct.compare(t,e,n,i),i.changes}function pV(t,e){for(let n=t;n&&n!=e;n=n.assignedSlot||n.parentNode)if(n.nodeType==1&&n.contentEditable=="false")return!0;return!1}function mV(t,e){let n=!1;return e&&t.iterChangedRanges((i,r)=>{i<e.to&&r>e.from&&(n=!0)}),n}function gV(t,e,n=1){let i=t.charCategorizer(e),r=t.doc.lineAt(e),s=e-r.from;if(r.length==0)return ne.cursor(e);s==0?n=1:s==r.length&&(n=-1);let o=s,a=s;n<0?o=Tn(r.text,s,!1):a=Tn(r.text,s);let l=i(r.text.slice(o,a));for(;o>0;){let u=Tn(r.text,o,!1);if(i(r.text.slice(u,o))!=l)break;o=u}for(;a<r.length;){let u=Tn(r.text,a);if(i(r.text.slice(a,u))!=l)break;a=u}return ne.range(o+r.from,a+r.from)}function vV(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function yV(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function nw(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function hP(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function fP(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function i1(t,e,n){let i,r,s,o,a=!1,l,u,c,d;for(let p=t.firstChild;p;p=p.nextSibling){let m=nf(p);for(let w=0;w<m.length;w++){let v=m[w];r&&nw(r,v)&&(v=hP(fP(v,r.bottom),r.top));let y=vV(e,v),b=yV(n,v);if(y==0&&b==0)return p.nodeType==3?pP(p,e,n):i1(p,e,n);if(!i||o>b||o==b&&s>y){i=p,r=v,s=y,o=b;let k=b?n<v.top?-1:1:y?e<v.left?-1:1:0;a=!k||(k>0?w<m.length-1:w>0)}y==0?n>v.bottom&&(!c||c.bottom<v.bottom)?(l=p,c=v):n<v.top&&(!d||d.top>v.top)&&(u=p,d=v):c&&nw(c,v)?c=fP(c,v.bottom):d&&nw(d,v)&&(d=hP(d,v.top))}}if(c&&c.bottom>=n?(i=l,r=c):d&&d.top<=n&&(i=u,r=d),!i)return{node:t,offset:0};let h=Math.max(r.left,Math.min(r.right,e));if(i.nodeType==3)return pP(i,h,n);if(a&&i.contentEditable!="false")return i1(i,h,n);let f=Array.prototype.indexOf.call(t.childNodes,i)+(e>=(r.left+r.right)/2?1:0);return{node:t,offset:f}}function pP(t,e,n){let i=t.nodeValue.length,r=-1,s=1e9,o=0;for(let a=0;a<i;a++){let l=Jl(t,a,a+1).getClientRects();for(let u=0;u<l.length;u++){let c=l[u];if(c.top==c.bottom)continue;o||(o=e-c.left);let d=(c.top>n?c.top-n:n-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&d<s){let h=e>=(c.left+c.right)/2,f=h;if((be.chrome||be.gecko)&&Jl(t,a).getBoundingClientRect().left==c.right&&(f=!h),d<=0)return{node:t,offset:a+(f?1:0)};r=a+(f?1:0),s=d}}}return{node:t,offset:r>-1?r:o>0?t.nodeValue.length:0}}function eD(t,e,n,i=-1){var r,s;let o=t.contentDOM.getBoundingClientRect(),a=o.top+t.viewState.paddingTop,l,{docHeight:u}=t.viewState,{x:c,y:d}=e,h=d-a;if(h<0)return 0;if(h>u)return t.state.doc.length;for(let k=t.viewState.heightOracle.textHeight/2,_=!1;l=t.elementAtHeight(h),l.type!=ii.Text;)for(;h=i>0?l.bottom+k:l.top-k,!(h>=0&&h<=u);){if(_)return n?null:0;_=!0,i=-i}d=a+h;let f=l.from;if(f<t.viewport.from)return t.viewport.from==0?0:n?null:mP(t,o,l,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:mP(t,o,l,c,d);let p=t.dom.ownerDocument,m=t.root.elementFromPoint?t.root:p,w=m.elementFromPoint(c,d);w&&!t.contentDOM.contains(w)&&(w=null),w||(c=Math.max(o.left+1,Math.min(o.right-1,c)),w=m.elementFromPoint(c,d),w&&!t.contentDOM.contains(w)&&(w=null));let v,y=-1;if(w&&((r=t.docView.nearest(w))===null||r===void 0?void 0:r.isEditable)!=!1){if(p.caretPositionFromPoint){let k=p.caretPositionFromPoint(c,d);k&&({offsetNode:v,offset:y}=k)}else if(p.caretRangeFromPoint){let k=p.caretRangeFromPoint(c,d);k&&({startContainer:v,startOffset:y}=k,(!t.contentDOM.contains(v)||be.safari&&wV(v,y,c)||be.chrome&&bV(v,y,c))&&(v=void 0))}}if(!v||!t.docView.dom.contains(v)){let k=Yt.find(t.docView,f);if(!k)return h>l.top+l.height/2?l.to:l.from;({node:v,offset:y}=i1(k.dom,c,d))}let b=t.docView.nearest(v);if(!b)return null;if(b.isWidget&&((s=b.dom)===null||s===void 0?void 0:s.nodeType)==1){let k=b.dom.getBoundingClientRect();return e.y<k.top||e.y<=k.bottom&&e.x<=(k.left+k.right)/2?b.posAtStart:b.posAtEnd}else return b.localPosFromDOM(v,y)+b.posAtStart}function mP(t,e,n,i,r){let s=Math.round((i-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&n.height>t.defaultLineHeight*1.5){let a=t.viewState.heightOracle.textHeight,l=Math.floor((r-n.top-(t.defaultLineHeight-a)*.5)/a);s+=l*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(n.from,n.to);return n.from+LU(o,s,t.state.tabSize)}function wV(t,e,n){let i;if(t.nodeType!=3||e!=(i=t.nodeValue.length))return!1;for(let r=t.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return Jl(t,i-1,i).getBoundingClientRect().left>n}function bV(t,e,n){if(e!=0)return!1;for(let r=t;;){let s=r.parentNode;if(!s||s.nodeType!=1||s.firstChild!=r)return!1;if(s.classList.contains("cm-line"))break;r=s}let i=t.nodeType==1?t.getBoundingClientRect():Jl(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return n-i.left>5}function r1(t,e){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){for(let i of n.type)if(i.to>e||i.to==e&&(i.to==n.to||i.type==ii.Text))return i}return n}function xV(t,e,n,i){let r=r1(t,e.head),s=!i||r.type!=ii.Text||!(t.lineWrapping||r.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(s){let o=t.dom.getBoundingClientRect(),a=t.textDirectionAt(r.from),l=t.posAtCoords({x:n==(a==Nt.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(l!=null)return ne.cursor(l,n?-1:1)}return ne.cursor(n?r.to:r.from,n?-1:1)}function gP(t,e,n,i){let r=t.state.doc.lineAt(e.head),s=t.bidiSpans(r),o=t.textDirectionAt(r.from);for(let a=e,l=null;;){let u=oV(r,s,o,a,n),c=jI;if(!u){if(r.number==(n?t.state.doc.lines:1))return a;c=`
`,r=t.state.doc.line(r.number+(n?1:-1)),s=t.bidiSpans(r),u=t.visualLineSide(r,!n)}if(l){if(!l(c))return a}else{if(!i)return u;l=i(c)}a=u}}function SV(t,e,n){let i=t.state.charCategorizer(e),r=i(n);return s=>{let o=i(s);return r==Rn.Space&&(r=o),r==o}}function kV(t,e,n,i){let r=e.head,s=n?1:-1;if(r==(n?t.state.doc.length:0))return ne.cursor(r,e.assoc);let o=e.goalColumn,a,l=t.contentDOM.getBoundingClientRect(),u=t.coordsAtPos(r,e.assoc||-1),c=t.documentTop;if(u)o==null&&(o=u.left-l.left),a=s<0?u.top:u.bottom;else{let f=t.viewState.lineBlockAt(r);o==null&&(o=Math.min(l.right-l.left,t.defaultCharacterWidth*(r-f.from))),a=(s<0?f.top:f.bottom)+c}let d=l.left+o,h=i??t.viewState.heightOracle.textHeight>>1;for(let f=0;;f+=10){let p=a+(h+f)*s,m=eD(t,{x:d,y:p},!1,s);if(p<l.top||p>l.bottom||(s<0?m<r:m>r)){let w=t.docView.coordsForChar(m),v=!w||p<w.top?-1:1;return ne.cursor(m,v,void 0,o)}}}function Qm(t,e,n){for(;;){let i=0;for(let r of t)r.between(e-1,e+1,(s,o,a)=>{if(e>s&&e<o){let l=i||n||(e-s<o-e?-1:1);e=l<0?s:o,i=l}});if(!i)return e}}function iw(t,e,n){let i=Qm(t.state.facet(Ak).map(r=>r(t)),n.from,e.head>n.from?-1:1);return i==n.from?n:ne.cursor(i,i<n.from?1:-1)}class _V{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,be.safari&&e.contentDOM.addEventListener("input",()=>null),be.gecko&&$V(e.contentDOM.ownerDocument)}handleEvent(e){!MV(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,n){let i=this.handlers[e];if(i){for(let r of i.observers)r(this.view,n);for(let r of i.handlers){if(n.defaultPrevented)break;if(r(this.view,n)){n.preventDefault();break}}}}ensureHandlers(e){let n=CV(e),i=this.handlers,r=this.view.contentDOM;for(let s in n)if(s!="scroll"){let o=!n[s].handlers.length,a=i[s];a&&o!=!a.handlers.length&&(r.removeEventListener(s,this.handleEvent),a=null),a||r.addEventListener(s,this.handleEvent,{passive:o})}for(let s in i)s!="scroll"&&!n[s]&&r.removeEventListener(s,this.handleEvent);this.handlers=n}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&nD.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),be.android&&be.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let n;return be.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((n=tD.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||EV.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=n||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let n=this.pendingIOSKey;return!n||n.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,ac(this.view.contentDOM,n.key,n.keyCode,n instanceof KeyboardEvent?n:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:be.safari&&!be.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function vP(t,e){return(n,i)=>{try{return e.call(t,i,n)}catch(r){Vi(n.state,r)}}}function CV(t){let e=Object.create(null);function n(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of t){let r=i.spec;if(r&&r.domEventHandlers)for(let s in r.domEventHandlers){let o=r.domEventHandlers[s];o&&n(s).handlers.push(vP(i.value,o))}if(r&&r.domEventObservers)for(let s in r.domEventObservers){let o=r.domEventObservers[s];o&&n(s).observers.push(vP(i.value,o))}}for(let i in ns)n(i).handlers.push(ns[i]);for(let i in Rr)n(i).observers.push(Rr[i]);return e}const tD=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],EV="dthko",nD=[16,17,18,20,91,92,224,225],Jp=6;function Zp(t){return Math.max(0,t)*.7+8}function AV(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}class PV{constructor(e,n,i,r){this.view=e,this.startEvent=n,this.style=i,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=n,this.scrollParents=HU(e.contentDOM),this.atoms=e.state.facet(Ak).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=n.shiftKey,this.multiple=e.state.facet(Je.allowMultipleSelections)&&TV(e,n),this.dragging=NV(e,n)&&sD(n)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&AV(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,i=0,r=0,s=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=ZI(this.view);e.clientX-l.left<=r+Jp?n=-Zp(r-e.clientX):e.clientX+l.right>=o-Jp&&(n=Zp(e.clientX-o)),e.clientY-l.top<=s+Jp?i=-Zp(s-e.clientY):e.clientY+l.bottom>=a-Jp&&(i=Zp(e.clientY-a)),this.setScrollSpeed(n,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,n){this.scrollSpeed={x:e,y:n},e||n?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:n}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),n&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=n,n=0),(e||n)&&this.view.win.scrollBy(e,n),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let n=null;for(let i=0;i<e.ranges.length;i++){let r=e.ranges[i],s=null;if(r.empty){let o=Qm(this.atoms,r.from,0);o!=r.from&&(s=ne.cursor(o,-1))}else{let o=Qm(this.atoms,r.from,-1),a=Qm(this.atoms,r.to,1);(o!=r.from||a!=r.to)&&(s=ne.range(r.from==r.anchor?o:a,r.from==r.head?o:a))}s&&(n||(n=e.ranges.slice()),n[i]=s)}return n?ne.create(n,e.mainIndex):e}select(e){let{view:n}=this,i=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(n.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(n=>n.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function TV(t,e){let n=t.state.facet(FI);return n.length?n[0](e):be.mac?e.metaKey:e.ctrlKey}function RV(t,e){let n=t.state.facet(BI);return n.length?n[0](e):be.mac?!e.altKey:!e.ctrlKey}function NV(t,e){let{main:n}=t.state.selection;if(n.empty)return!1;let i=tf(t.root);if(!i||i.rangeCount==0)return!0;let r=i.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function MV(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target,i;n!=t.contentDOM;n=n.parentNode)if(!n||n.nodeType==11||(i=xt.get(n))&&i.ignoreEvent(e))return!1;return!0}const ns=Object.create(null),Rr=Object.create(null),iD=be.ie&&be.ie_version<15||be.ios&&be.webkit_version<604;function OV(t){let e=t.dom.parentNode;if(!e)return;let n=e.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{t.focus(),n.remove(),rD(t,n.value)},50)}function rD(t,e){let{state:n}=t,i,r=1,s=n.toText(e),o=s.lines==n.selection.ranges.length;if(s1!=null&&n.selection.ranges.every(l=>l.empty)&&s1==s.toString()){let l=-1;i=n.changeByRange(u=>{let c=n.doc.lineAt(u.from);if(c.from==l)return{range:u};l=c.from;let d=n.toText((o?s.line(r++).text:e)+n.lineBreak);return{changes:{from:c.from,insert:d},range:ne.cursor(u.from+d.length)}})}else o?i=n.changeByRange(l=>{let u=s.line(r++);return{changes:{from:l.from,to:l.to,insert:u.text},range:ne.cursor(l.from+u.length)}}):i=n.replaceSelection(s);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Rr.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft};ns.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),e.keyCode==27&&t.inputState.tabFocusMode!=0&&(t.inputState.tabFocusMode=Date.now()+2e3),!1);Rr.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};Rr.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};ns.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let i of t.state.facet($I))if(n=i(t,e),n)break;if(!n&&e.button==0&&(n=LV(t,e)),n){let i=!t.hasFocus;t.inputState.startMouseSelection(new PV(t,e,n,i)),i&&t.observer.ignore(()=>{wI(t.contentDOM);let s=t.root.activeElement;s&&!s.contains(t.contentDOM)&&s.blur()});let r=t.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function yP(t,e,n,i){if(i==1)return ne.cursor(e,n);if(i==2)return gV(t.state,e,n);{let r=Yt.find(t.docView,e),s=t.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,a=r?r.posAtEnd:s.to;return a<t.state.doc.length&&a==s.to&&a++,ne.range(o,a)}}let wP=(t,e,n)=>e>=n.top&&e<=n.bottom&&t>=n.left&&t<=n.right;function IV(t,e,n,i){let r=Yt.find(t.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&wP(n,i,o))return-1;let a=r.coordsAt(s,1);return a&&wP(n,i,a)?1:o&&o.bottom>=i?-1:1}function bP(t,e){let n=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:n,bias:IV(t,n,e.clientX,e.clientY)}}const DV=be.ie&&be.ie_version<=11;let xP=null,SP=0,kP=0;function sD(t){if(!DV)return t.detail;let e=xP,n=kP;return xP=t,kP=Date.now(),SP=!e||n>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(SP+1)%3:1}function LV(t,e){let n=bP(t,e),i=sD(e),r=t.state.selection;return{update(s){s.docChanged&&(n.pos=s.changes.mapPos(n.pos),r=r.map(s.changes))},get(s,o,a){let l=bP(t,s),u,c=yP(t,l.pos,l.bias,i);if(n.pos!=l.pos&&!o){let d=yP(t,n.pos,n.bias,i),h=Math.min(d.from,c.from),f=Math.max(d.to,c.to);c=h<c.from?ne.range(h,f):ne.range(f,h)}return o?r.replaceRange(r.main.extend(c.from,c.to)):a&&i==1&&r.ranges.length>1&&(u=jV(r,l.pos))?u:a?r.addRange(c):ne.create([c])}}}function jV(t,e){for(let n=0;n<t.ranges.length;n++){let{from:i,to:r}=t.ranges[n];if(i<=e&&r>=e)return ne.create(t.ranges.slice(0,n).concat(t.ranges.slice(n+1)),t.mainIndex==n?0:t.mainIndex-(t.mainIndex>n?1:0))}return null}ns.dragstart=(t,e)=>{let{selection:{main:n}}=t.state;if(e.target.draggable){let r=t.docView.nearest(e.target);if(r&&r.isWidget){let s=r.posAtStart,o=s+r.length;(s>=n.to||o<=n.from)&&(n=ne.range(s,o))}}let{inputState:i}=t;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=n,e.dataTransfer&&(e.dataTransfer.setData("Text",t.state.sliceDoc(n.from,n.to)),e.dataTransfer.effectAllowed="copyMove"),!1};ns.dragend=t=>(t.inputState.draggedContent=null,!1);function _P(t,e,n,i){if(!n)return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=t.inputState,o=i&&s&&RV(t,e)?{from:s.from,to:s.to}:null,a={from:r,insert:n},l=t.state.changes(o?[o,a]:a);t.focus(),t.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"}),t.inputState.draggedContent=null}ns.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let n=e.dataTransfer.files;if(n&&n.length){let i=Array(n.length),r=0,s=()=>{++r==n.length&&_P(t,e,i.filter(o=>o!=null).join(t.state.lineBreak),!1)};for(let o=0;o<n.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(i[o]=a.result),s()},a.readAsText(n[o])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return _P(t,e,i,!0),!0}return!1};ns.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let n=iD?null:e.clipboardData;return n?(rD(t,n.getData("text/plain")||n.getData("text/uri-list")),!0):(OV(t),!1)};function FV(t,e){let n=t.dom.parentNode;if(!n)return;let i=n.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),t.focus()},50)}function BV(t){let e=[],n=[],i=!1;for(let r of t.selection.ranges)r.empty||(e.push(t.sliceDoc(r.from,r.to)),n.push(r));if(!e.length){let r=-1;for(let{from:s}of t.selection.ranges){let o=t.doc.lineAt(s);o.number>r&&(e.push(o.text),n.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),r=o.number}i=!0}return{text:e.join(t.lineBreak),ranges:n,linewise:i}}let s1=null;ns.copy=ns.cut=(t,e)=>{let{text:n,ranges:i,linewise:r}=BV(t.state);if(!n&&!r)return!1;s1=r?n:null,e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let s=iD?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",n),!0):(FV(t,n),!1)};const oD=Fo.define();function aD(t,e){let n=[];for(let i of t.facet(VI)){let r=i(t,e);r&&n.push(r)}return n?t.update({effects:n,annotations:oD.of(!0)}):null}function lD(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let n=aD(t.state,e);n?t.dispatch(n):t.update([])}},10)}Rr.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),lD(t)};Rr.blur=t=>{t.observer.clearSelectionRange(),lD(t)};Rr.compositionstart=Rr.compositionupdate=t=>{t.observer.editContext||(t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))};Rr.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,be.chrome&&be.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))};Rr.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};ns.beforeinput=(t,e)=>{var n;let i;if(be.chrome&&be.android&&(i=tD.find(r=>r.inputType==e.inputType))&&(t.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let r=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>r+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return be.ios&&e.inputType=="deleteContentForward"&&t.observer.flushSoon(),be.safari&&e.inputType=="insertText"&&t.inputState.composing>=0&&setTimeout(()=>Rr.compositionend(t,e),20),!1};const CP=new Set;function $V(t){CP.has(t)||(CP.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}const EP=["pre-wrap","normal","pre-line","break-spaces"];let Dc=!1;function AP(){Dc=!1}class zV{constructor(e){this.lineWrapping=e,this.doc=ot.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,n){let i=this.doc.lineAt(n).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((n-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return EP.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let n=!1;for(let i=0;i<e.length;i++){let r=e[i];r<0?i++:this.heightSamples[Math.floor(r*10)]||(n=!0,this.heightSamples[Math.floor(r*10)]=!0)}return n}refresh(e,n,i,r,s,o){let a=EP.indexOf(e)>-1,l=Math.round(n)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=n,this.charWidth=i,this.textHeight=r,this.lineLength=s,l){this.heightSamples={};for(let u=0;u<o.length;u++){let c=o[u];c<0?u++:this.heightSamples[Math.floor(c*10)]=!0}}return l}}class UV{constructor(e,n){this.from=e,this.heights=n,this.index=0}get more(){return this.index<this.heights.length}}class As{constructor(e,n,i,r,s){this.from=e,this.length=n,this.top=i,this.height=r,this._content=s}get type(){return typeof this._content=="number"?ii.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof $a?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let n=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new As(this.from,this.length+e.length,this.top,this.height+e.height,n)}}var Pt=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(Pt||(Pt={}));const eg=.001;class ri{constructor(e,n,i=2){this.length=e,this.height=n,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>eg&&(Dc=!0),this.height=e)}replace(e,n,i){return ri.of(i)}decomposeLeft(e,n){n.push(this)}decomposeRight(e,n){n.push(this)}applyChanges(e,n,i,r){let s=this,o=i.doc;for(let a=r.length-1;a>=0;a--){let{fromA:l,toA:u,fromB:c,toB:d}=r[a],h=s.lineAt(l,Pt.ByPosNoHeight,i.setDoc(n),0,0),f=h.to>=u?h:s.lineAt(u,Pt.ByPosNoHeight,i,0,0);for(d+=f.to-u,u=f.to;a>0&&h.from<=r[a-1].toA;)l=r[a-1].fromA,c=r[a-1].fromB,a--,l<h.from&&(h=s.lineAt(l,Pt.ByPosNoHeight,i,0,0));c+=h.from-l,l=h.from;let p=Pk.build(i.setDoc(o),e,c,d);s=rv(s,s.replace(l,u,p))}return s.updateHeight(i,0)}static empty(){return new Bi(0,0)}static of(e){if(e.length==1)return e[0];let n=0,i=e.length,r=0,s=0;for(;;)if(n==i)if(r>s*2){let a=e[n-1];a.break?e.splice(--n,1,a.left,null,a.right):e.splice(--n,1,a.left,a.right),i+=1+a.break,r-=a.size}else if(s>r*2){let a=e[i];a.break?e.splice(i,1,a.left,null,a.right):e.splice(i,1,a.left,a.right),i+=2+a.break,s-=a.size}else break;else if(r<s){let a=e[n++];a&&(r+=a.size)}else{let a=e[--i];a&&(s+=a.size)}let o=0;return e[n-1]==null?(o=1,n--):e[n]==null&&(o=1,i++),new VV(ri.of(e.slice(0,n)),o,ri.of(e.slice(i)))}}function rv(t,e){return t==e?t:(t.constructor!=e.constructor&&(Dc=!0),e)}ri.prototype.size=1;class uD extends ri{constructor(e,n,i){super(e,n),this.deco=i}blockAt(e,n,i,r){return new As(r,this.length,i,this.height,this.deco||0)}lineAt(e,n,i,r,s){return this.blockAt(0,i,r,s)}forEachLine(e,n,i,r,s,o){e<=s+this.length&&n>=s&&o(this.blockAt(0,i,r,s))}updateHeight(e,n=0,i=!1,r){return r&&r.from<=n&&r.more&&this.setHeight(r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Bi extends uD{constructor(e,n){super(e,n,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,n,i,r){return new As(r,this.length,i,this.height,this.breaks)}replace(e,n,i){let r=i[0];return i.length==1&&(r instanceof Bi||r instanceof wn&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof wn?r=new Bi(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):ri.of(i)}updateHeight(e,n=0,i=!1,r){return r&&r.from<=n&&r.more?this.setHeight(r.heights[r.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class wn extends ri{constructor(e){super(e,0)}heightMetrics(e,n){let i=e.doc.lineAt(n).number,r=e.doc.lineAt(n+this.length).number,s=r-i+1,o,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);o=l/s,this.length>s+1&&(a=(this.height-l)/(this.length-s-1))}else o=this.height/s;return{firstLine:i,lastLine:r,perLine:o,perChar:a}}blockAt(e,n,i,r){let{firstLine:s,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(n,r);if(n.lineWrapping){let u=r+(e<n.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),c=n.doc.lineAt(u),d=a+c.length*l,h=Math.max(i,e-d/2);return new As(c.from,c.length,h,d,0)}else{let u=Math.max(0,Math.min(o-s,Math.floor((e-i)/a))),{from:c,length:d}=n.doc.line(s+u);return new As(c,d,i+a*u,a,0)}}lineAt(e,n,i,r,s){if(n==Pt.ByHeight)return this.blockAt(e,i,r,s);if(n==Pt.ByPosNoHeight){let{from:f,to:p}=i.doc.lineAt(e);return new As(f,p-f,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(i,s),u=i.doc.lineAt(e),c=a+u.length*l,d=u.number-o,h=r+a*d+l*(u.from-s-d);return new As(u.from,u.length,Math.max(r,Math.min(h,r+this.height-c)),c,0)}forEachLine(e,n,i,r,s,o){e=Math.max(e,s),n=Math.min(n,s+this.length);let{firstLine:a,perLine:l,perChar:u}=this.heightMetrics(i,s);for(let c=e,d=r;c<=n;){let h=i.doc.lineAt(c);if(c==e){let p=h.number-a;d+=l*p+u*(e-s-p)}let f=l+u*h.length;o(new As(h.from,h.length,d,f,0)),d+=f,c=h.to+1}}replace(e,n,i){let r=this.length-n;if(r>0){let s=i[i.length-1];s instanceof wn?i[i.length-1]=new wn(s.length+r):i.push(null,new wn(r-1))}if(e>0){let s=i[0];s instanceof wn?i[0]=new wn(e+s.length):i.unshift(new wn(e-1),null)}return ri.of(i)}decomposeLeft(e,n){n.push(new wn(e-1),null)}decomposeRight(e,n){n.push(null,new wn(this.length-e-1))}updateHeight(e,n=0,i=!1,r){let s=n+this.length;if(r&&r.from<=n+this.length&&r.more){let o=[],a=Math.max(n,r.from),l=-1;for(r.from>n&&o.push(new wn(r.from-n-1).updateHeight(e,n));a<=s&&r.more;){let c=e.doc.lineAt(a).length;o.length&&o.push(null);let d=r.heights[r.index++];l==-1?l=d:Math.abs(d-l)>=eg&&(l=-2);let h=new Bi(c,d);h.outdated=!1,o.push(h),a+=c+1}a<=s&&o.push(null,new wn(s-a).updateHeight(e,a));let u=ri.of(o);return(l<0||Math.abs(u.height-this.height)>=eg||Math.abs(l-this.heightMetrics(e,n).perLine)>=eg)&&(Dc=!0),rv(this,u)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(n,n+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class VV extends ri{constructor(e,n,i){super(e.length+n+i.length,e.height+i.height,n|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,n,i,r){let s=i+this.left.height;return e<s?this.left.blockAt(e,n,i,r):this.right.blockAt(e,n,s,r+this.left.length+this.break)}lineAt(e,n,i,r,s){let o=r+this.left.height,a=s+this.left.length+this.break,l=n==Pt.ByHeight?e<o:e<a,u=l?this.left.lineAt(e,n,i,r,s):this.right.lineAt(e,n,i,o,a);if(this.break||(l?u.to<a:u.from>a))return u;let c=n==Pt.ByPosNoHeight?Pt.ByPosNoHeight:Pt.ByPos;return l?u.join(this.right.lineAt(a,c,i,o,a)):this.left.lineAt(a,c,i,r,s).join(u)}forEachLine(e,n,i,r,s,o){let a=r+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,n,i,r,s,o),n>=l&&this.right.forEachLine(e,n,i,a,l,o);else{let u=this.lineAt(l,Pt.ByPos,i,r,s);e<u.from&&this.left.forEachLine(e,u.from-1,i,r,s,o),u.to>=e&&u.from<=n&&o(u),n>u.to&&this.right.forEachLine(u.to+1,n,i,a,l,o)}}replace(e,n,i){let r=this.left.length+this.break;if(n<r)return this.balanced(this.left.replace(e,n,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,n-r,i));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of i)s.push(a);if(e>0&&PP(s,o-1),n<this.length){let a=s.length;this.decomposeRight(n,s),PP(s,a)}return ri.of(s)}decomposeLeft(e,n){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,n);n.push(this.left),this.break&&(i++,e>=i&&n.push(null)),e>i&&this.right.decomposeLeft(e-i,n)}decomposeRight(e,n){let i=this.left.length,r=i+this.break;if(e>=r)return this.right.decomposeRight(e-r,n);e<i&&this.left.decomposeRight(e,n),this.break&&e<r&&n.push(null),n.push(this.right)}balanced(e,n){return e.size>2*n.size||n.size>2*e.size?ri.of(this.break?[e,null,n]:[e,n]):(this.left=rv(this.left,e),this.right=rv(this.right,n),this.setHeight(e.height+n.height),this.outdated=e.outdated||n.outdated,this.size=e.size+n.size,this.length=e.length+this.break+n.length,this)}updateHeight(e,n=0,i=!1,r){let{left:s,right:o}=this,a=n+s.length+this.break,l=null;return r&&r.from<=n+s.length&&r.more?l=s=s.updateHeight(e,n,i,r):s.updateHeight(e,n,i),r&&r.from<=a+o.length&&r.more?l=o=o.updateHeight(e,a,i,r):o.updateHeight(e,a,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function PP(t,e){let n,i;t[e]==null&&(n=t[e-1])instanceof wn&&(i=t[e+1])instanceof wn&&t.splice(e-1,3,new wn(n.length+1+i.length))}const HV=5;class Pk{constructor(e,n){this.pos=e,this.oracle=n,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,n){if(this.lineStart>-1){let i=Math.min(n,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Bi?r.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Bi(i-this.pos,-1)),this.writtenTo=i,n>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=n}point(e,n,i){if(e<n||i.heightRelevant){let r=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let o=n-e;i.block?this.addBlock(new uD(o,r,i)):(o||s||r>=HV)&&this.addLineDeco(r,s,o)}else n>e&&this.span(e,n);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:n}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=n,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Bi(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,n){let i=new wn(n-e);return this.oracle.doc.lineAt(e).to==n&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Bi)return e;let n=new Bi(0,-1);return this.nodes.push(n),n}addBlock(e){this.enterLine();let n=e.deco;n&&n.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,n&&n.endSide>0&&(this.covering=e)}addLineDeco(e,n,i){let r=this.ensureLine();r.length+=i,r.collapsed+=i,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=n,this.writtenTo=this.pos=this.pos+i}finish(e){let n=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(n instanceof Bi)&&!this.isCovered?this.nodes.push(new Bi(0,-1)):(this.writtenTo<this.pos||n==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let r of this.nodes)r instanceof Bi&&r.updateHeight(this.oracle,i),i+=r?r.length:1;return this.nodes}static build(e,n,i,r){let s=new Pk(i,e);return ct.spans(n,i,r,s,0),s.finish(i)}}function WV(t,e,n){let i=new GV;return ct.compare(t,e,n,i,0),i.changes}class GV{constructor(){this.changes=[]}compareRange(){}comparePoint(e,n,i,r){(e<n||i&&i.heightRelevant||r&&r.heightRelevant)&&Zx(e,n,this.changes,5)}}function KV(t,e){let n=t.getBoundingClientRect(),i=t.ownerDocument,r=i.defaultView||window,s=Math.max(0,n.left),o=Math.min(r.innerWidth,n.right),a=Math.max(0,n.top),l=Math.min(r.innerHeight,n.bottom);for(let u=t.parentNode;u&&u!=i.body;)if(u.nodeType==1){let c=u,d=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&d.overflow!="visible"){let h=c.getBoundingClientRect();s=Math.max(s,h.left),o=Math.min(o,h.right),a=Math.max(a,h.top),l=u==t.parentNode?h.bottom:Math.min(l,h.bottom)}u=d.position=="absolute"||d.position=="fixed"?c.offsetParent:c.parentNode}else if(u.nodeType==11)u=u.host;else break;return{left:s-n.left,right:Math.max(s,o)-n.left,top:a-(n.top+e),bottom:Math.max(a,l)-(n.top+e)}}function XV(t,e){let n=t.getBoundingClientRect();return{left:0,right:n.right-n.left,top:e,bottom:n.bottom-(n.top+e)}}class rw{constructor(e,n,i){this.from=e,this.to=n,this.size=i}static same(e,n){if(e.length!=n.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=n[i];if(r.from!=s.from||r.to!=s.to||r.size!=s.size)return!1}return!0}draw(e,n){return Ge.replace({widget:new qV(this.size*(n?e.scaleY:e.scaleX),n)}).range(this.from,this.to)}}class qV extends nl{constructor(e,n){super(),this.size=e,this.vertical=n}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class TP{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=RP,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Nt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let n=e.facet(Ek).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new zV(n),this.stateDeco=e.facet(rf).filter(i=>typeof i!="function"),this.heightMap=ri.empty().applyChanges(this.stateDeco,ot.empty,this.heightOracle.setDoc(e.doc),[new Sr(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ge.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:n}=this.state.selection;for(let i=0;i<=1;i++){let r=i?n.head:n.anchor;if(!e.some(({from:s,to:o})=>r>=s&&r<=o)){let{from:s,to:o}=this.lineBlockAt(r);e.push(new Qp(s,o))}}return this.viewports=e.sort((i,r)=>i.from-r.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?RP:new Tk(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Gd(e,this.scaler))})}update(e,n=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(rf).filter(c=>typeof c!="function");let r=e.changedRanges,s=Sr.extendWithRanges(r,WV(i,this.stateDeco,e?e.changes:nn.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);AP(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||Dc)&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(n&&(n.range.head<l.from||n.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,n));let u=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(u||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),n&&(this.scrollTarget=n),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(WI)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let n=e.contentDOM,i=window.getComputedStyle(n),r=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?Nt.RTL:Nt.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),a=n.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let u=0,c=0;if(a.width&&a.height){let{scaleX:k,scaleY:_}=yI(n,a);(k>.005&&Math.abs(this.scaleX-k)>.005||_>.005&&Math.abs(this.scaleY-_)>.005)&&(this.scaleX=k,this.scaleY=_,u|=8,o=l=!0)}let d=(parseInt(i.paddingTop)||0)*this.scaleY,h=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=d||this.paddingBottom!=h)&&(this.paddingTop=d,this.paddingBottom=h,u|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=8);let f=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=f&&(this.scrollAnchorHeight=-1,this.scrollTop=f),this.scrolledToBottom=xI(e.scrollDOM);let p=(this.printing?XV:KV)(n,this.paddingTop),m=p.top-this.pixelViewport.top,w=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let v=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(v!=this.inView&&(this.inView=v,v&&(l=!0)),!this.inView&&!this.scrollTarget)return 0;let y=a.width;if((this.contentDOMWidth!=y||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,u|=8),l){let k=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(k)&&(o=!0),o||r.lineWrapping&&Math.abs(y-this.contentDOMWidth)>r.charWidth){let{lineHeight:_,charWidth:E,textHeight:A}=e.docView.measureTextSize();o=_>0&&r.refresh(s,_,E,A,y/E,k),o&&(e.docView.minWidth=0,u|=8)}m>0&&w>0?c=Math.max(m,w):m<0&&w<0&&(c=Math.min(m,w)),AP();for(let _ of this.viewports){let E=_.from==this.viewport.from?k:e.docView.measureVisibleLineHeights(_);this.heightMap=(o?ri.empty().applyChanges(this.stateDeco,ot.empty,this.heightOracle,[new Sr(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,o,new UV(_.from,E))}Dc&&(u|=2)}let b=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return b&&(u&2&&(u|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),u|=this.updateForViewport()),(u&2||b)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,n){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new Qp(r.lineAt(o-i*1e3,Pt.ByHeight,s,0,0).from,r.lineAt(a+(1-i)*1e3,Pt.ByHeight,s,0,0).to);if(n){let{head:u}=n.range;if(u<l.from||u>l.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),d=r.lineAt(u,Pt.ByPos,s,0,0),h;n.y=="center"?h=(d.top+d.bottom)/2-c/2:n.y=="start"||n.y=="nearest"&&u<l.from?h=d.top:h=d.bottom-c,l=new Qp(r.lineAt(h-1e3/2,Pt.ByHeight,s,0,0).from,r.lineAt(h+c+1e3/2,Pt.ByHeight,s,0,0).to)}}return l}mapViewport(e,n){let i=n.mapPos(e.from,-1),r=n.mapPos(e.to,1);return new Qp(this.heightMap.lineAt(i,Pt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,Pt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:n},i=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,Pt.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(n,Pt.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||r<=o-Math.max(10,Math.min(-i,250)))&&(n==this.state.doc.length||s>=a+Math.max(10,Math.min(i,250)))&&r>o-2*1e3&&s<a+2*1e3}mapLineGaps(e,n){if(!e.length||n.empty)return e;let i=[];for(let r of e)n.touchesRange(r.from,r.to)||i.push(new rw(n.mapPos(r.from),n.mapPos(r.to),r.size));return i}ensureLineGaps(e,n){let i=this.heightOracle.lineWrapping,r=i?1e4:2e3,s=r>>1,o=r<<1;if(this.defaultTextDirection!=Nt.LTR&&!i)return[];let a=[],l=(c,d,h,f)=>{if(d-c<s)return;let p=this.state.selection.main,m=[p.from];p.empty||m.push(p.to);for(let v of m)if(v>c&&v<d){l(c,v-10,h,f),l(v+10,d,h,f);return}let w=JV(e,v=>v.from>=h.from&&v.to<=h.to&&Math.abs(v.from-c)<s&&Math.abs(v.to-d)<s&&!m.some(y=>v.from<y&&v.to>y));if(!w){if(d<h.to&&n&&i&&n.visibleRanges.some(v=>v.from<=d&&v.to>=d)){let v=n.moveToLineBoundary(ne.cursor(d),!1,!0).head;v>c&&(d=v)}w=new rw(c,d,this.gapSize(h,c,d,f))}a.push(w)},u=c=>{if(c.length<o||c.type!=ii.Text)return;let d=YV(c.from,c.to,this.stateDeco);if(d.total<o)return;let h=this.scrollTarget?this.scrollTarget.range.head:null,f,p;if(i){let m=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,w,v;if(h!=null){let y=tm(d,h),b=((this.visibleBottom-this.visibleTop)/2+m)/c.height;w=y-b,v=y+b}else w=(this.visibleTop-c.top-m)/c.height,v=(this.visibleBottom-c.top+m)/c.height;f=em(d,w),p=em(d,v)}else{let m=d.total*this.heightOracle.charWidth,w=r*this.heightOracle.charWidth,v,y;if(h!=null){let b=tm(d,h),k=((this.pixelViewport.right-this.pixelViewport.left)/2+w)/m;v=b-k,y=b+k}else v=(this.pixelViewport.left-w)/m,y=(this.pixelViewport.right+w)/m;f=em(d,v),p=em(d,y)}f>c.from&&l(c.from,f,c,d),p<c.to&&l(p,c.to,c,d)};for(let c of this.viewportLines)Array.isArray(c.type)?c.type.forEach(u):u(c);return a}gapSize(e,n,i,r){let s=tm(r,i)-tm(r,n);return this.heightOracle.lineWrapping?e.height*s:r.total*this.heightOracle.charWidth*s}updateLineGaps(e){rw.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ge.set(e.map(n=>n.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let n=[];ct.spans(e,this.viewport.from,this.viewport.to,{span(r,s){n.push({from:r,to:s})},point(){}},20);let i=n.length!=this.visibleRanges.length||this.visibleRanges.some((r,s)=>r.from!=n[s].from||r.to!=n[s].to);return this.visibleRanges=n,i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(n=>n.from<=e&&n.to>=e)||Gd(this.heightMap.lineAt(e,Pt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(n=>n.top<=e&&n.bottom>=e)||Gd(this.heightMap.lineAt(this.scaler.fromDOM(e),Pt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let n=this.lineBlockAtHeight(e+8);return n.from>=this.viewport.from||this.viewportLines[0].top-e>200?n:this.viewportLines[0]}elementAtHeight(e){return Gd(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}let Qp=class{constructor(e,n){this.from=e,this.to=n}};function YV(t,e,n){let i=[],r=t,s=0;return ct.spans(n,t,e,{span(){},point(o,a){o>r&&(i.push({from:r,to:o}),s+=o-r),r=a}},20),r<e&&(i.push({from:r,to:e}),s+=e-r),{total:s,ranges:i}}function em({total:t,ranges:e},n){if(n<=0)return e[0].from;if(n>=1)return e[e.length-1].to;let i=Math.floor(t*n);for(let r=0;;r++){let{from:s,to:o}=e[r],a=o-s;if(i<=a)return s+i;i-=a}}function tm(t,e){let n=0;for(let{from:i,to:r}of t.ranges){if(e<=r){n+=e-i;break}n+=r-i}return n/t.total}function JV(t,e){for(let n of t)if(e(n))return n}const RP={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class Tk{constructor(e,n,i){let r=0,s=0,o=0;this.viewports=i.map(({from:a,to:l})=>{let u=n.lineAt(a,Pt.ByPos,e,0,0).top,c=n.lineAt(l,Pt.ByPos,e,0,0).bottom;return r+=c-u,{from:a,to:l,top:u,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(n.height-r);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let n=0,i=0,r=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.top)return r+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom,r=s.domBottom}}fromDOM(e){for(let n=0,i=0,r=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.domTop)return i+(e-r)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom,r=s.domBottom}}eq(e){return e instanceof Tk?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((n,i)=>n.from==e.viewports[i].from&&n.to==e.viewports[i].to):!1}}function Gd(t,e){if(e.scale==1)return t;let n=e.toDOM(t.top),i=e.toDOM(t.bottom);return new As(t.from,t.length,n,i-n,Array.isArray(t._content)?t._content.map(r=>Gd(r,e)):t._content)}const nm=_e.define({combine:t=>t.join(" ")}),o1=_e.define({combine:t=>t.indexOf(!0)>-1}),a1=Fa.newName(),cD=Fa.newName(),dD=Fa.newName(),hD={"&light":"."+cD,"&dark":"."+dD};function l1(t,e,n){return new Fa(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,r=>{if(r=="&")return t;if(!n||!n[r])throw new RangeError(`Unsupported selector: ${r}`);return n[r]}):t+" "+i}})}const ZV=l1("."+a1,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},hD),Kd="￿";class QV{constructor(e,n){this.points=e,this.text="",this.lineSeparator=n.facet(Je.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Kd}readRange(e,n){if(!e)return this;let i=e.parentNode;for(let r=e;;){this.findPointBefore(i,r);let s=this.text.length;this.readNode(r);let o=r.nextSibling;if(o==n)break;let a=xt.get(r),l=xt.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:tv(r))||tv(o)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>s)&&this.lineBreak(),r=o}return this.findPointBefore(i,n),this}readTextNode(e){let n=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,n.length));for(let i=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,a;if(this.lineSeparator?(s=n.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(a=r.exec(n))&&(s=a.index,o=a[0].length),this.append(n.slice(i,s<0?n.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);i=s+o}}readNode(e){if(e.cmIgnore)return;let n=xt.get(e),i=n&&n.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let r=i.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,n){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==n&&(i.pos=this.text.length)}findPointInside(e,n){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(eH(e,i.node,i.offset)?n:0))}}function eH(t,e,n){for(;;){if(!e||n<To(e))return!1;if(e==t)return!0;n=Yl(e)+1,e=e.parentNode}}class NP{constructor(e,n){this.node=e,this.offset=n,this.pos=-1}}class tH{constructor(e,n,i,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=n>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&n>-1)this.newSel=null;else if(n>-1&&(this.bounds=e.docView.domBoundsAround(n,i,0))){let a=s||o?[]:rH(e),l=new QV(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=sH(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=s&&s.node==a.focusNode&&s.offset==a.focusOffset||!Gx(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),u=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!Gx(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),c=e.viewport;if((be.ios||be.chrome)&&e.state.selection.main.empty&&l!=u&&(c.from>0||c.to<e.state.doc.length)){let d=Math.min(l,u),h=Math.max(l,u),f=c.from-d,p=c.to-h;(f==0||f==1||d==0)&&(p==0||p==-1||h==e.state.doc.length)&&(l=0,u=e.state.doc.length)}this.newSel=ne.single(u,l)}}}function fD(t,e){let n,{newSel:i}=e,r=t.state.selection.main,s=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=r.from,u=null;(s===8||be.android&&e.text.length<a-o)&&(l=r.to,u="end");let c=iH(t.state.doc.sliceString(o,a,Kd),e.text,l-o,u);c&&(be.chrome&&s==13&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==Kd+Kd&&c.toB--,n={from:o+c.from,to:o+c.toA,insert:ot.of(e.text.slice(c.from,c.toB).split(Kd))})}else i&&(!t.hasFocus&&t.state.facet(ia)||i.main.eq(r))&&(i=null);if(!n&&!i)return!1;if(!n&&e.typeOver&&!r.empty&&i&&i.main.empty?n={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,r.to)}:n&&n.from>=r.from&&n.to<=r.to&&(n.from!=r.from||n.to!=r.to)&&r.to-r.from-(n.to-n.from)<=4?n={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,n.from).append(n.insert).append(t.state.doc.slice(n.to,r.to))}:(be.mac||be.android)&&n&&n.from==n.to&&n.from==r.head-1&&/^\. ?$/.test(n.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(i&&n.insert.length==2&&(i=ne.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:ot.of([" "])}):be.chrome&&n&&n.from==n.to&&n.from==r.head&&n.insert.toString()==`
 `&&t.lineWrapping&&(i&&(i=ne.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:ot.of([" "])}),n)return pD(t,n,i,s);if(i&&!i.main.eq(r)){let o=!1,a="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(o=!0),a=t.inputState.lastSelectionOrigin),t.dispatch({selection:i,scrollIntoView:o,userEvent:a}),!0}else return!1}function pD(t,e,n,i=-1){if(be.ios&&t.inputState.flushIOSKey(e))return!0;let r=t.state.selection.main;if(be.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&t.state.sliceDoc(e.from,r.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&ac(t.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>r.head)&&ac(t.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&e.insert.length==0&&ac(t.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let o,a=()=>o||(o=nH(t,e,n));return t.state.facet(UI).some(l=>l(t,e.from,e.to,s,a))||t.dispatch(a()),!0}function nH(t,e,n){let i,r=t.state,s=r.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!n||n.main.empty&&n.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let a=s.from<e.from?r.sliceDoc(s.from,e.from):"",l=s.to>e.to?r.sliceDoc(e.to,s.to):"";i=r.replaceSelection(t.state.toText(a+e.insert.sliceString(0,void 0,t.state.lineBreak)+l))}else{let a=r.changes(e),l=n&&n.main.to<=a.newLength?n.main:void 0;if(r.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let u=t.state.sliceDoc(e.from,e.to),c,d=n&&QI(t,n.main.head);if(d){let p=e.insert.length-(e.to-e.from);c={from:d.from,to:d.to-p}}else c=t.state.doc.lineAt(s.head);let h=s.to-e.to,f=s.to-s.from;i=r.changeByRange(p=>{if(p.from==s.from&&p.to==s.to)return{changes:a,range:l||p.map(a)};let m=p.to-h,w=m-u.length;if(p.to-p.from!=f||t.state.sliceDoc(w,m)!=u||p.to>=c.from&&p.from<=c.to)return{range:p};let v=r.changes({from:w,to:m,insert:e.insert}),y=p.to-s.to;return{changes:v,range:l?ne.range(Math.max(0,l.anchor+y),Math.max(0,l.head+y)):p.map(v)}})}else i={changes:a,selection:l&&r.selection.replaceRange(l)}}let o="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,o+=".compose",t.inputState.compositionFirstChange&&(o+=".start",t.inputState.compositionFirstChange=!1)),r.update(i,{userEvent:o,scrollIntoView:!0})}function iH(t,e,n,i){let r=Math.min(t.length,e.length),s=0;for(;s<r&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&t.length==e.length)return null;let o=t.length,a=e.length;for(;o>0&&a>0&&t.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(i=="end"){let l=Math.max(0,s-Math.min(o,a));n-=o+l-s}if(o<s&&t.length<e.length){let l=n<=s&&n>=o?s-n:0;s-=l,a=s+(a-o),o=s}else if(a<s){let l=n<=s&&n>=a?s-n:0;s-=l,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}function rH(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}=t.observer.selectionRange;return n&&(e.push(new NP(n,i)),(r!=n||s!=i)&&e.push(new NP(r,s))),e}function sH(t,e){if(t.length==0)return null;let n=t[0].pos,i=t.length==2?t[1].pos:n;return n>-1&&i>-1?ne.single(n+e,i+e):null}const oH={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},sw=be.ie&&be.ie_version<=11;class aH{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new WU,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(n=>{for(let i of n)this.queue.push(i);(be.ie&&be.ie_version<=11||be.ios&&e.composing)&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(be.chrome&&be.chrome_version<126)&&(this.editContext=new uH(e),e.state.facet(ia)&&(e.contentDOM.editContext=this.editContext.editContext)),sw&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var n;((n=this.view.docView)===null||n===void 0?void 0:n.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(n=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),n.length>0&&n[n.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(n=>{n.length>0&&n[n.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((n,i)=>n!=e[i]))){this.gapIntersection.disconnect();for(let n of e)this.gapIntersection.observe(n);this.gaps=e}}onSelectionChange(e){let n=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,r=this.selectionRange;if(i.state.facet(ia)?i.root.activeElement!=this.dom:!Zm(i.dom,r))return;let s=r.anchorNode&&i.docView.nearest(r.anchorNode);if(s&&s.ignoreEvent(e)){n||(this.selectionChanged=!1);return}(be.ie&&be.ie_version<=11||be.android&&be.chrome)&&!i.state.selection.main.empty&&r.focusNode&&yh(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,n=tf(e.root);if(!n)return!1;let i=be.safari&&e.root.nodeType==11&&zU(this.dom.ownerDocument)==this.dom&&lH(this.view,n)||n;if(!i||this.selectionRange.eq(i))return!1;let r=Zm(this.dom,i);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&KU(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,n){this.selectionRange.set(e.node,e.offset,n.node,n.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,n=null;for(let i=this.dom;i;)if(i.nodeType==1)!n&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:n||(n=this.scrollTargets.slice(0,e)),n&&n.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!n&&(n=this.scrollTargets.slice(0,e)),n){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=n)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,oH),sw&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),sw&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,n){var i;if(!this.delayedAndroidKey){let r=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&ac(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:n,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let n=-1,i=-1,r=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(r=!0),n==-1?{from:n,to:i}=o:(n=Math.min(o.from,n),i=Math.max(o.to,i)))}return{from:n,to:i,typeOver:r}}readChange(){let{from:e,to:n,typeOver:i}=this.processRecords(),r=this.selectionChanged&&Zm(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new tH(this.view,e,n,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let n=this.readChange();if(!n)return this.view.requestMeasure(),!1;let i=this.view.state,r=fD(this.view,n);return this.view.state==i&&(n.domChanged||n.newSel&&!n.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),r}readMutation(e){let n=this.view.docView.nearest(e.target);if(!n||n.ignoreMutation(e))return null;if(n.markDirty(e.type=="attributes"),e.type=="attributes"&&(n.flags|=4),e.type=="childList"){let i=MP(n,e.previousSibling||e.target.previousSibling,-1),r=MP(n,e.nextSibling||e.target.nextSibling,1);return{from:i?n.posAfter(i):n.posAtStart,to:r?n.posBefore(r):n.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(ia)!=e.state.facet(ia)&&(e.view.contentDOM.editContext=e.state.facet(ia)?this.editContext.editContext:null))}destroy(){var e,n,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(n=this.gapIntersection)===null||n===void 0||n.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function MP(t,e,n){for(;e;){let i=xt.get(e);if(i&&i.parent==t)return i;let r=e.parentNode;e=r!=t.dom?r:n>0?e.nextSibling:e.previousSibling}return null}function OP(t,e){let n=e.startContainer,i=e.startOffset,r=e.endContainer,s=e.endOffset,o=t.docView.domAtPos(t.state.selection.main.anchor);return yh(o.node,o.offset,r,s)&&([n,i,r,s]=[r,s,n,i]),{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}}function lH(t,e){if(e.getComposedRanges){let r=e.getComposedRanges(t.root)[0];if(r)return OP(t,r)}let n=null;function i(r){r.preventDefault(),r.stopImmediatePropagation(),n=r.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",i,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",i,!0),n?OP(t,n):null}class uH{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.resetRange(e.state);let n=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let{anchor:r}=e.state.selection.main,s={from:this.toEditorPos(i.updateRangeStart),to:this.toEditorPos(i.updateRangeEnd),insert:ot.of(i.text.split(`
`))};s.from==this.from&&r<this.from?s.from=r:s.to==this.to&&r>this.to&&(s.to=r),!(s.from==s.to&&!s.insert.length)&&(this.pendingContextChange=s,e.state.readOnly||pD(e,s,ne.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd))),this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)))},this.handlers.characterboundsupdate=i=>{let r=[],s=null;for(let o=this.toEditorPos(i.rangeStart),a=this.toEditorPos(i.rangeEnd);o<a;o++){let l=e.coordsForChar(o);s=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||s||new DOMRect,r.push(s)}n.updateCharacterBounds(i.rangeStart,r)},this.handlers.textformatupdate=i=>{let r=[];for(let s of i.getTextFormats()){let o=s.underlineStyle,a=s.underlineThickness;if(o!="None"&&a!="None"){let l=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${a=="Thin"?1:2}px`;r.push(Ge.mark({attributes:{style:l}}).range(this.toEditorPos(s.rangeStart),this.toEditorPos(s.rangeEnd)))}}e.dispatch({effects:KI.of(Ge.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{e.inputState.composing=-1,e.inputState.compositionFirstChange=null};for(let i in this.handlers)n.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let r=tf(i.root);r&&r.rangeCount&&this.editContext.updateSelectionBounds(r.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let n=0,i=!1,r=this.pendingContextChange;return e.changes.iterChanges((s,o,a,l,u)=>{if(i)return;let c=u.length-(o-s);if(r&&o>=r.to)if(r.from==s&&r.to==o&&r.insert.eq(u)){r=this.pendingContextChange=null,n+=c,this.to+=c;return}else r=null,this.revertPending(e.state);if(s+=n,o+=n,o<=this.from)this.from+=c,this.to+=c;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+u.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),u.toString()),this.to+=c}n+=c}),r&&!i&&this.revertPending(e.state),!i}update(e){let n=this.pendingContextChange;!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.resetRange(e.state),this.editContext.updateText(0,this.editContext.text.length,e.state.doc.sliceString(this.from,this.to)),this.setSelection(e.state)):(e.docChanged||e.selectionSet||n)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:n}=e.selection.main;this.from=Math.max(0,n-1e4),this.to=Math.min(e.doc.length,n+1e4)}revertPending(e){let n=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(n.from),this.toContextPos(n.from+n.insert.length),e.doc.sliceString(n.from,n.to))}setSelection(e){let{main:n}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,n.anchor))),r=this.toContextPos(n.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(i,r)}rangeIsValid(e){let{head:n}=e.selection.main;return!(this.from>0&&n-this.from<500||this.to<e.doc.length&&this.to-n<500||this.to-this.from>1e4*3)}toEditorPos(e){return e+this.from}toContextPos(e){return e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class Pe{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(i=>i.forEach(r=>n(r,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||GU(e.parent)||document,this.viewState=new TP(e.state||Je.create(e)),e.scrollTo&&e.scrollTo.is(Yp)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Hd).map(i=>new tw(i));for(let i of this.plugins)i.update(this);this.observer=new aH(this),this.inputState=new _V(this),this.inputState.ensureHandlers(this.plugins),this.docView=new cP(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...e){let n=e.length==1&&e[0]instanceof ln?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(n,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let n=!1,i=!1,r,s=this.state;for(let h of e){if(h.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=h.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,a=0,l=null;e.some(h=>h.annotation(oD))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=aD(s,o),l||(a=1));let u=this.observer.delayedAndroidKey,c=null;if(u?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(c=null)):this.observer.clear(),s.facet(Je.phrases)!=this.state.facet(Je.phrases))return this.setState(s);r=iv.create(this,s,e),r.flags|=a;let d=this.viewState.scrollTarget;try{this.updateState=2;for(let h of e){if(d&&(d=d.map(h.changes)),h.scrollIntoView){let{main:f}=h.state.selection;d=new lc(f.empty?f:ne.cursor(f.head,f.head>f.anchor?-1:1))}for(let f of h.effects)f.is(Yp)&&(d=f.value.clip(this.state))}this.viewState.update(r,d),this.bidiCache=sv.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),n=this.docView.update(r),this.state.facet(Wd)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some(h=>h.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(nm)!=r.state.facet(nm)&&(this.viewState.mustMeasureContent=!0),(n||i||d||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),n&&this.docViewUpdate(),!r.empty)for(let h of this.state.facet(n1))try{h(r)}catch(f){Vi(this.state,f,"update listener")}(l||c)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),c&&!fD(this,c)&&u.force&&ac(this.contentDOM,u.key,u.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let n=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new TP(e),this.plugins=e.facet(Hd).map(i=>new tw(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new cP(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}n&&this.focus(),this.requestMeasure()}updatePlugins(e){let n=e.startState.facet(Hd),i=e.state.facet(Hd);if(n!=i){let r=[];for(let s of i){let o=n.indexOf(s);if(o<0)r.push(new tw(s));else{let a=this.plugins[o];a.mustUpdate=e,r.push(a)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);n!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let n=e.value;if(n&&n.docViewUpdate)try{n.docViewUpdate(this)}catch(i){Vi(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let n=null,i=this.scrollDOM,r=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(xI(i))s=-1,o=this.viewState.heightMap.height;else{let f=this.viewState.scrollAnchorAt(r);s=f.from,o=f.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];l&4||([this.measureRequests,u]=[u,this.measureRequests]);let c=u.map(f=>{try{return f.read(this)}catch(p){return Vi(this.state,p),IP}}),d=iv.create(this,this.state,[]),h=!1;d.flags|=l,n?n.flags|=l:n=d,this.updateState=2,d.empty||(this.updatePlugins(d),this.inputState.update(d),this.updateAttrs(),h=this.docView.update(d),h&&this.docViewUpdate());for(let f=0;f<u.length;f++)if(c[f]!=IP)try{let p=u[f];p.write&&p.write(c[f],this)}catch(p){Vi(this.state,p)}if(h&&this.docView.updateSelection(!0),!d.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(p>1||p<-1){r=r+p,i.scrollTop=r/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(n&&!n.empty)for(let a of this.state.facet(n1))a(n)}get themeClasses(){return a1+" "+(this.state.facet(o1)?dD:cD)+" "+this.state.facet(nm)}updateAttrs(){let e=DP(this,XI,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),n={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(ia)?"true":"false",class:"cm-content",style:`${be.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(n["aria-readonly"]="true"),DP(this,Ek,n);let i=this.observer.ignore(()=>{let r=Jx(this.contentDOM,this.contentAttrs,n),s=Jx(this.dom,this.editorAttrs,e);return r||s});return this.editorAttrs=e,this.contentAttrs=n,i}showAnnouncements(e){let n=!0;for(let i of e)for(let r of i.effects)if(r.is(Pe.announce)){n&&(this.announceDOM.textContent=""),n=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(Wd);let e=this.state.facet(Pe.cspNonce);Fa.mount(this.root,this.styleModules.concat(ZV).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let n=0;n<this.measureRequests.length;n++)if(this.measureRequests[n].key===e.key){this.measureRequests[n]=e;return}}this.measureRequests.push(e)}}plugin(e){let n=this.pluginMap.get(e);return(n===void 0||n&&n.spec!=e)&&this.pluginMap.set(e,n=this.plugins.find(i=>i.spec==e)||null),n&&n.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,n,i){return iw(this,e,gP(this,e,n,i))}moveByGroup(e,n){return iw(this,e,gP(this,e,n,i=>SV(this,e.head,i)))}visualLineSide(e,n){let i=this.bidiSpans(e),r=this.textDirectionAt(e.from),s=i[n?i.length-1:0];return ne.cursor(s.side(n,r)+e.from,s.forward(!n,r)?1:-1)}moveToLineBoundary(e,n,i=!0){return xV(this,e,n,i)}moveVertically(e,n,i){return iw(this,e,kV(this,e,n,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,n=0){return this.docView.posFromDOM(e,n)}posAtCoords(e,n=!0){return this.readMeasured(),eD(this,e,n)}coordsAtPos(e,n=1){this.readMeasured();let i=this.docView.coordsAt(e,n);if(!i||i.left==i.right)return i;let r=this.state.doc.lineAt(e),s=this.bidiSpans(r),o=s[ma.find(s,e-r.from,-1,n)];return kk(i,o.dir==Nt.LTR==n>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(HI)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>cH)return LI(e.length);let n=this.textDirectionAt(e.from),i;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==n&&(s.fresh||DI(s.isolates,i=uP(this,e))))return s.order;i||(i=uP(this,e));let r=sV(e.text,n,i);return this.bidiCache.push(new sv(e.from,e.to,n,i,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||be.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{wI(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,n={}){return Yp.of(new lc(typeof e=="number"?ne.cursor(e):e,n.y,n.x,n.yMargin,n.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:n}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return Yp.of(new lc(ne.cursor(i.from),"start","start",i.top-e,n,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return In.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return In.define(()=>({}),{eventObservers:e})}static theme(e,n){let i=Fa.newName(),r=[nm.of(i),Wd.of(l1(`.${i}`,e))];return n&&n.dark&&r.push(o1.of(!0)),r}static baseTheme(e){return Kf.lowest(Wd.of(l1("."+a1,e,hD)))}static findFromDOM(e){var n;let i=e.querySelector(".cm-content"),r=i&&xt.get(i)||xt.get(e);return((n=r==null?void 0:r.rootView)===null||n===void 0?void 0:n.view)||null}}Pe.styleModule=Wd;Pe.inputHandler=UI;Pe.scrollHandler=GI;Pe.focusChangeEffect=VI;Pe.perLineTextDirection=HI;Pe.exceptionSink=zI;Pe.updateListener=n1;Pe.editable=ia;Pe.mouseSelectionStyle=$I;Pe.dragMovesSelection=BI;Pe.clickAddsSelectionRange=FI;Pe.decorations=rf;Pe.outerDecorations=qI;Pe.atomicRanges=Ak;Pe.bidiIsolatedRanges=YI;Pe.scrollMargins=JI;Pe.darkTheme=o1;Pe.cspNonce=_e.define({combine:t=>t.length?t[0]:""});Pe.contentAttributes=Ek;Pe.editorAttributes=XI;Pe.lineWrapping=Pe.contentAttributes.of({class:"cm-lineWrapping"});Pe.announce=Xe.define();const cH=4096,IP={};class sv{constructor(e,n,i,r,s,o){this.from=e,this.to=n,this.dir=i,this.isolates=r,this.fresh=s,this.order=o}static update(e,n){if(n.empty&&!e.some(s=>s.fresh))return e;let i=[],r=e.length?e[e.length-1].dir:Nt.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==r&&!n.touchesRange(o.from,o.to)&&i.push(new sv(n.mapPos(o.from,1),n.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function DP(t,e,n){for(let i=t.state.facet(e),r=i.length-1;r>=0;r--){let s=i[r],o=typeof s=="function"?s(t):s;o&&Yx(o,n)}return n}const dH=be.mac?"mac":be.windows?"win":be.linux?"linux":"key";function hH(t,e){const n=t.split(/-(?!$)/);let i=n[n.length-1];i=="Space"&&(i=" ");let r,s,o,a;for(let l=0;l<n.length-1;++l){const u=n[l];if(/^(cmd|meta|m)$/i.test(u))a=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))s=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))e=="mac"?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+u)}return r&&(i="Alt-"+i),s&&(i="Ctrl-"+i),a&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function im(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n!==!1&&e.shiftKey&&(t="Shift-"+t),t}const fH=Kf.default(Pe.domEventHandlers({keydown(t,e){return vD(gD(e.state),t,e,"editor")}})),mD=_e.define({enables:fH}),LP=new WeakMap;function gD(t){let e=t.facet(mD),n=LP.get(e);return n||LP.set(e,n=gH(e.reduce((i,r)=>i.concat(r),[]))),n}function pH(t,e,n){return vD(gD(t.state),e,t,n)}let ra=null;const mH=4e3;function gH(t,e=dH){let n=Object.create(null),i=Object.create(null),r=(o,a)=>{let l=i[o];if(l==null)i[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,l,u,c)=>{var d,h;let f=n[o]||(n[o]=Object.create(null)),p=a.split(/ (?!$)/).map(v=>hH(v,e));for(let v=1;v<p.length;v++){let y=p.slice(0,v).join(" ");r(y,!0),f[y]||(f[y]={preventDefault:!0,stopPropagation:!1,run:[b=>{let k=ra={view:b,prefix:y,scope:o};return setTimeout(()=>{ra==k&&(ra=null)},mH),!0}]})}let m=p.join(" ");r(m,!1);let w=f[m]||(f[m]={preventDefault:!1,stopPropagation:!1,run:((h=(d=f._any)===null||d===void 0?void 0:d.run)===null||h===void 0?void 0:h.slice())||[]});l&&w.run.push(l),u&&(w.preventDefault=!0),c&&(w.stopPropagation=!0)};for(let o of t){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let u of a){let c=n[u]||(n[u]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:d}=o;for(let h in c)c[h].run.push(f=>d(f,u1))}let l=o[e]||o.key;if(l)for(let u of a)s(u,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(u,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return n}let u1=null;function vD(t,e,n,i){u1=e;let r=$U(e),s=ei(r,0),o=Wr(s)==r.length&&r!=" ",a="",l=!1,u=!1,c=!1;ra&&ra.view==n&&ra.scope==i&&(a=ra.prefix+" ",nD.indexOf(e.keyCode)<0&&(u=!0,ra=null));let d=new Set,h=w=>{if(w){for(let v of w.run)if(!d.has(v)&&(d.add(v),v(n)))return w.stopPropagation&&(c=!0),!0;w.preventDefault&&(w.stopPropagation&&(c=!0),u=!0)}return!1},f=t[i],p,m;return f&&(h(f[a+im(r,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(be.windows&&e.ctrlKey&&e.altKey)&&(p=Ba[e.keyCode])&&p!=r?(h(f[a+im(p,e,!0)])||e.shiftKey&&(m=ef[e.keyCode])!=r&&m!=p&&h(f[a+im(m,e,!1)]))&&(l=!0):o&&e.shiftKey&&h(f[a+im(r,e,!0)])&&(l=!0),!l&&h(f._any)&&(l=!0)),u&&(l=!0),l&&c&&e.stopPropagation(),u1=null,l}class Zf{constructor(e,n,i,r,s){this.className=e,this.left=n,this.top=i,this.width=r,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,n){return n.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,n,i){if(i.empty){let r=e.coordsAtPos(i.head,i.assoc||1);if(!r)return[];let s=yD(e);return[new Zf(n,r.left-s.left,r.top-s.top,null,r.bottom-r.top)]}else return vH(e,n,i)}}function yD(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==Nt.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function jP(t,e,n,i){let r=t.coordsAtPos(e,n*2);if(!r)return i;let s=t.dom.getBoundingClientRect(),o=(r.top+r.bottom)/2,a=t.posAtCoords({x:s.left+1,y:o}),l=t.posAtCoords({x:s.right-1,y:o});return a==null||l==null?i:{from:Math.max(i.from,Math.min(a,l)),to:Math.min(i.to,Math.max(a,l))}}function vH(t,e,n){if(n.to<=t.viewport.from||n.from>=t.viewport.to)return[];let i=Math.max(n.from,t.viewport.from),r=Math.min(n.to,t.viewport.to),s=t.textDirection==Nt.LTR,o=t.contentDOM,a=o.getBoundingClientRect(),l=yD(t),u=o.querySelector(".cm-line"),c=u&&window.getComputedStyle(u),d=a.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),h=a.right-(c?parseInt(c.paddingRight):0),f=r1(t,i),p=r1(t,r),m=f.type==ii.Text?f:null,w=p.type==ii.Text?p:null;if(m&&(t.lineWrapping||f.widgetLineBreaks)&&(m=jP(t,i,1,m)),w&&(t.lineWrapping||p.widgetLineBreaks)&&(w=jP(t,r,-1,w)),m&&w&&m.from==w.from&&m.to==w.to)return y(b(n.from,n.to,m));{let _=m?b(n.from,null,m):k(f,!1),E=w?b(null,n.to,w):k(p,!0),A=[];return(m||f).to<(w||p).from-(m&&w?1:0)||f.widgetLineBreaks>1&&_.bottom+t.defaultLineHeight/2<E.top?A.push(v(d,_.bottom,h,E.top)):_.bottom<E.top&&t.elementAtHeight((_.bottom+E.top)/2).type==ii.Text&&(_.bottom=E.top=(_.bottom+E.top)/2),y(_).concat(A).concat(y(E))}function v(_,E,A,P){return new Zf(e,_-l.left,E-l.top-.01,A-_,P-E+.01)}function y({top:_,bottom:E,horizontal:A}){let P=[];for(let I=0;I<A.length;I+=2)P.push(v(A[I],_,A[I+1],E));return P}function b(_,E,A){let P=1e9,I=-1e9,D=[];function B(z,G,Q,ie,H){let j=t.coordsAtPos(z,z==A.to?-2:2),te=t.coordsAtPos(Q,Q==A.from?2:-2);!j||!te||(P=Math.min(j.top,te.top,P),I=Math.max(j.bottom,te.bottom,I),H==Nt.LTR?D.push(s&&G?d:j.left,s&&ie?h:te.right):D.push(!s&&ie?d:te.left,!s&&G?h:j.right))}let $=_??A.from,J=E??A.to;for(let z of t.visibleRanges)if(z.to>$&&z.from<J)for(let G=Math.max(z.from,$),Q=Math.min(z.to,J);;){let ie=t.state.doc.lineAt(G);for(let H of t.bidiSpans(ie)){let j=H.from+ie.from,te=H.to+ie.from;if(j>=Q)break;te>G&&B(Math.max(j,G),_==null&&j<=$,Math.min(te,Q),E==null&&te>=J,H.dir)}if(G=ie.to+1,G>=Q)break}return D.length==0&&B($,_==null,J,E==null,t.textDirection),{top:P,bottom:I,horizontal:D}}function k(_,E){let A=a.top+(E?_.top:_.bottom);return{top:A,bottom:A,horizontal:[]}}}function yH(t,e){return t.constructor==e.constructor&&t.eq(e)}class wH{constructor(e,n){this.view=e,this.layer=n,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),n.above&&this.dom.classList.add("cm-layer-above"),n.class&&this.dom.classList.add(n.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),n.mount&&n.mount(this.dom,e)}update(e){e.startState.facet(tg)!=e.state.facet(tg)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let n=0,i=e.facet(tg);for(;n<i.length&&i[n]!=this.layer;)n++;this.dom.style.zIndex=String((this.layer.above?150:-1)-n)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:n}=this.view;(e!=this.scaleX||n!=this.scaleY)&&(this.scaleX=e,this.scaleY=n,this.dom.style.transform=`scale(${1/e}, ${1/n})`)}draw(e){if(e.length!=this.drawn.length||e.some((n,i)=>!yH(n,this.drawn[i]))){let n=this.dom.firstChild,i=0;for(let r of e)r.update&&n&&r.constructor&&this.drawn[i].constructor&&r.update(n,this.drawn[i])?(n=n.nextSibling,i++):this.dom.insertBefore(r.draw(),n);for(;n;){let r=n.nextSibling;n.remove(),n=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const tg=_e.define();function wD(t){return[In.define(e=>new wH(e,t)),tg.of(t)]}const bD=!be.ios,sf=_e.define({combine(t){return tl(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,n)=>Math.min(e,n),drawRangeCursor:(e,n)=>e||n})}});function bH(t={}){return[sf.of(t),xH,SH,kH,WI.of(!0)]}function xD(t){return t.startState.facet(sf)!=t.state.facet(sf)}const xH=wD({above:!0,markers(t){let{state:e}=t,n=e.facet(sf),i=[];for(let r of e.selection.ranges){let s=r==e.selection.main;if(r.empty?!s||bD:n.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=r.empty?r:ne.cursor(r.head,r.head>r.anchor?-1:1);for(let l of Zf.forRange(t,o,a))i.push(l)}}return i},update(t,e){t.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let n=xD(t);return n&&FP(t.state,e),t.docChanged||t.selectionSet||n},mount(t,e){FP(e.state,t)},class:"cm-cursorLayer"});function FP(t,e){e.style.animationDuration=t.facet(sf).cursorBlinkRate+"ms"}const SH=wD({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:Zf.forRange(t,"cm-selectionBackground",e)).reduce((e,n)=>e.concat(n))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||xD(t)},class:"cm-selectionLayer"}),c1={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};bD&&(c1[".cm-line"].caretColor=c1[".cm-content"].caretColor="transparent !important");const kH=Kf.highest(Pe.theme(c1));function BP(t,e,n,i,r){e.lastIndex=0;for(let s=t.iterRange(n,i),o=n,a;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;a=e.exec(s.value);)r(o+a.index,a)}function _H(t,e){let n=t.visibleRanges;if(n.length==1&&n[0].from==t.viewport.from&&n[0].to==t.viewport.to)return n;let i=[];for(let{from:r,to:s}of n)r=Math.max(t.state.doc.lineAt(r).from,r-e),s=Math.min(t.state.doc.lineAt(s).to,s+e),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}class CH{constructor(e){const{regexp:n,decoration:i,decorate:r,boundary:s,maxLength:o=1e3}=e;if(!n.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=n,r)this.addMatch=(a,l,u,c)=>r(c,u,u+a[0].length,a,l);else if(typeof i=="function")this.addMatch=(a,l,u,c)=>{let d=i(a,l,u);d&&c(u,u+a[0].length,d)};else if(i)this.addMatch=(a,l,u,c)=>c(u,u+a[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let n=new ql,i=n.add.bind(n);for(let{from:r,to:s}of _H(e,this.maxLength))BP(e.state.doc,this.regexp,r,s,(o,a)=>this.addMatch(a,e,o,i));return n.finish()}updateDeco(e,n){let i=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((s,o,a,l)=>{l>e.view.viewport.from&&a<e.view.viewport.to&&(i=Math.min(a,i),r=Math.max(l,r))}),e.viewportChanged||r-i>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,n.map(e.changes),i,r):n}updateRange(e,n,i,r){for(let s of e.visibleRanges){let o=Math.max(s.from,i),a=Math.min(s.to,r);if(a>o){let l=e.state.doc.lineAt(o),u=l.to<a?e.state.doc.lineAt(a):l,c=Math.max(s.from,l.from),d=Math.min(s.to,u.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){c=o;break}for(;a<u.to;a++)if(this.boundary.test(u.text[a-u.from])){d=a;break}}let h=[],f,p=(m,w,v)=>h.push(v.range(m,w));if(l==u)for(this.regexp.lastIndex=c-l.from;(f=this.regexp.exec(l.text))&&f.index<d-l.from;)this.addMatch(f,e,f.index+l.from,p);else BP(e.state.doc,this.regexp,c,d,(m,w)=>this.addMatch(w,e,m,p));n=n.update({filterFrom:c,filterTo:d,filter:(m,w)=>m<c||w>d,add:h})}}return n}}const d1=/x/.unicode!=null?"gu":"g",EH=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,d1),AH={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let ow=null;function PH(){var t;if(ow==null&&typeof document<"u"&&document.body){let e=document.body.style;ow=((t=e.tabSize)!==null&&t!==void 0?t:e.MozTabSize)!=null}return ow||!1}const ng=_e.define({combine(t){let e=tl(t,{render:null,specialChars:EH,addSpecialChars:null});return(e.replaceTabs=!PH())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,d1)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,d1)),e}});function TH(t={}){return[ng.of(t),RH()]}let $P=null;function RH(){return $P||($P=In.fromClass(class{constructor(t){this.view=t,this.decorations=Ge.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(ng)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new CH({regexp:t.specialChars,decoration:(e,n,i)=>{let{doc:r}=n.state,s=ei(e[0],0);if(s==9){let o=r.lineAt(i),a=n.state.tabSize,l=qf(o.text,a,i-o.from);return Ge.replace({widget:new IH((a-l%a)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=Ge.replace({widget:new OH(t,s)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(ng);t.startState.facet(ng)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))}const NH="•";function MH(t){return t>=32?NH:t==10?"␤":String.fromCharCode(9216+t)}class OH extends nl{constructor(e,n){super(),this.options=e,this.code=n}eq(e){return e.code==this.code}toDOM(e){let n=MH(this.code),i=e.state.phrase("Control character")+" "+(AH[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,i,n);if(r)return r;let s=document.createElement("span");return s.textContent=n,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class IH extends nl{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function DH(){return jH}const LH=Ge.line({class:"cm-activeLine"}),jH=In.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,n=[];for(let i of t.state.selection.ranges){let r=t.lineBlockAt(i.head);r.from>e&&(n.push(LH.range(r.from)),e=r.from)}return Ge.set(n)}},{decorations:t=>t.decorations}),_d="-10000px";class SD{constructor(e,n,i,r){this.facet=n,this.createTooltipView=i,this.removeTooltipView=r,this.input=e.state.facet(n),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=i(o,s))}update(e,n){var i;let r=e.state.facet(this.facet),s=r.filter(l=>l);if(r===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let o=[],a=n?[]:null;for(let l=0;l<s.length;l++){let u=s[l],c=-1;if(u){for(let d=0;d<this.tooltips.length;d++){let h=this.tooltips[d];h&&h.create==u.create&&(c=d)}if(c<0)o[l]=this.createTooltipView(u,l?o[l-1]:null),a&&(a[l]=!!u.above);else{let d=o[l]=this.tooltipViews[c];a&&(a[l]=n[c]),d.update&&d.update(e)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(i=l.destroy)===null||i===void 0||i.call(l));return n&&(a.forEach((l,u)=>n[u]=l),n.length=a.length),this.input=r,this.tooltips=s,this.tooltipViews=o,!0}}function FH(t){let{win:e}=t;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const aw=_e.define({combine:t=>{var e,n,i;return{position:be.ios?"absolute":((e=t.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((n=t.find(r=>r.parent))===null||n===void 0?void 0:n.parent)||null,tooltipSpace:((i=t.find(r=>r.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||FH}}}),zP=new WeakMap,Rk=In.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(aw);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new SD(t,Nk,(n,i)=>this.createTooltip(n,i),n=>{this.resizeObserver&&this.resizeObserver.unobserve(n.dom),n.dom.remove()}),this.above=this.manager.tooltips.map(n=>!!n.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(n=>{Date.now()>this.lastTransaction-50&&n.length>0&&n[n.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let n=e||t.geometryChanged,i=t.state.facet(aw);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;n=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(t,e){let n=t.create(this.view),i=e?e.dom:null;if(n.dom.classList.add("cm-tooltip"),t.arrow&&!n.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",n.dom.appendChild(r)}return n.dom.style.position=this.position,n.dom.style.top=_d,n.dom.style.left="0px",this.container.insertBefore(n.dom,i),n.mount&&n.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(n.dom),n}destroy(){var t,e,n;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(t=i.destroy)===null||t===void 0||t.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(n=this.intersectionObserver)===null||n===void 0||n.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=this.view.dom.getBoundingClientRect(),e=1,n=1,i=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(be.gecko)i=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==_d&&r.style.left=="0px"){let s=r.getBoundingClientRect();i=Math.abs(s.top+1e4)>1||Math.abs(s.left)>1}}if(i||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(e=r.width/this.parent.offsetWidth,n=r.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:n}=this.view.viewState);return{editor:t,parent:this.parent?this.container.getBoundingClientRect():t,pos:this.manager.tooltips.map((r,s)=>{let o=this.manager.tooltipViews[s];return o.getCoords?o.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(aw).tooltipSpace(this.view),scaleX:e,scaleY:n,makeAbsolute:i}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{editor:n,space:i,scaleX:r,scaleY:s}=t,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],u=this.manager.tooltipViews[a],{dom:c}=u,d=t.pos[a],h=t.size[a];if(!d||d.bottom<=Math.max(n.top,i.top)||d.top>=Math.min(n.bottom,i.bottom)||d.right<Math.max(n.left,i.left)-.1||d.left>Math.min(n.right,i.right)+.1){c.style.top=_d;continue}let f=l.arrow?u.dom.querySelector(".cm-tooltip-arrow"):null,p=f?7:0,m=h.right-h.left,w=(e=zP.get(u))!==null&&e!==void 0?e:h.bottom-h.top,v=u.offset||$H,y=this.view.textDirection==Nt.LTR,b=h.width>i.right-i.left?y?i.left:i.right-h.width:y?Math.max(i.left,Math.min(d.left-(f?14:0)+v.x,i.right-m)):Math.min(Math.max(i.left,d.left-m+(f?14:0)-v.x),i.right-m),k=this.above[a];!l.strictSide&&(k?d.top-(h.bottom-h.top)-v.y<i.top:d.bottom+(h.bottom-h.top)+v.y>i.bottom)&&k==i.bottom-d.bottom>d.top-i.top&&(k=this.above[a]=!k);let _=(k?d.top-i.top:i.bottom-d.bottom)-p;if(_<w&&u.resize!==!1){if(_<this.view.defaultLineHeight){c.style.top=_d;continue}zP.set(u,w),c.style.height=(w=_)/s+"px"}else c.style.height&&(c.style.height="");let E=k?d.top-w-p-v.y:d.bottom+p+v.y,A=b+m;if(u.overlap!==!0)for(let P of o)P.left<A&&P.right>b&&P.top<E+w&&P.bottom>E&&(E=k?P.top-w-2-p:P.bottom+p+2);if(this.position=="absolute"?(c.style.top=(E-t.parent.top)/s+"px",c.style.left=(b-t.parent.left)/r+"px"):(c.style.top=E/s+"px",c.style.left=b/r+"px"),f){let P=d.left+(y?v.x:-v.x)-(b+14-7);f.style.left=P/r+"px"}u.overlap!==!0&&o.push({left:b,top:E,right:A,bottom:E+w}),c.classList.toggle("cm-tooltip-above",k),c.classList.toggle("cm-tooltip-below",!k),u.positioned&&u.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=_d}},{eventObservers:{scroll(){this.maybeMeasure()}}}),BH=Pe.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),$H={x:0,y:0},Nk=_e.define({enables:[Rk,BH]}),ov=_e.define({combine:t=>t.reduce((e,n)=>e.concat(n),[])});class by{static create(e){return new by(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new SD(e,ov,(n,i)=>this.createHostedView(n,i),n=>n.dom.remove())}createHostedView(e,n){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,n?n.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let n of this.manager.tooltipViews)n.mount&&n.mount(e);this.mounted=!0}positioned(e){for(let n of this.manager.tooltipViews)n.positioned&&n.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let n of this.manager.tooltipViews)(e=n.destroy)===null||e===void 0||e.call(n)}passProp(e){let n;for(let i of this.manager.tooltipViews){let r=i[e];if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}}return n}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const zH=Nk.compute([ov],t=>{let e=t.facet(ov);return e.length===0?null:{pos:Math.min(...e.map(n=>n.pos)),end:Math.max(...e.map(n=>{var i;return(i=n.end)!==null&&i!==void 0?i:n.pos})),create:by.create,above:e[0].above,arrow:e.some(n=>n.arrow)}});class UH{constructor(e,n,i,r,s){this.view=e,this.source=n,this.field=i,this.setHover=r,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:n}=this,i=e.docView.nearest(n.target);if(!i)return;let r,s=1;if(i instanceof pa)r=i.posAtStart;else{if(r=e.posAtCoords(n),r==null)return;let a=e.coordsAtPos(r);if(!a||n.y<a.top||n.y>a.bottom||n.x<a.left-e.defaultCharacterWidth||n.x>a.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(r)).find(c=>c.from<=r&&c.to>=r),u=l&&l.dir==Nt.RTL?-1:1;s=n.x<a.left?-u:u}let o=this.source(e,r,s);if(o!=null&&o.then){let a=this.pending={pos:r};o.then(l=>{this.pending==a&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>Vi(e.state,l,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(Rk),n=e?e.manager.tooltips.findIndex(i=>i.create==by.create):-1;return n>-1?e.manager.tooltipViews[n]:null}mousemove(e){var n,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:r,tooltip:s}=this;if(r.length&&s&&!VH(s.dom,e)||this.pending){let{pos:o}=r[0]||this.pending,a=(i=(n=r[0])===null||n===void 0?void 0:n.end)!==null&&i!==void 0?i:o;(o==a?this.view.posAtCoords(this.lastMove)!=o:!HH(this.view,o,a,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:n}=this;if(n.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let n=i=>{e.removeEventListener("mouseleave",n),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",n)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const rm=4;function VH(t,e){let n=t.getBoundingClientRect();return e.clientX>=n.left-rm&&e.clientX<=n.right+rm&&e.clientY>=n.top-rm&&e.clientY<=n.bottom+rm}function HH(t,e,n,i,r,s){let o=t.scrollDOM.getBoundingClientRect(),a=t.documentTop+t.documentPadding.top+t.contentHeight;if(o.left>i||o.right<i||o.top>r||Math.min(o.bottom,a)<r)return!1;let l=t.posAtCoords({x:i,y:r},!1);return l>=e&&l<=n}function WH(t,e={}){let n=Xe.define(),i=li.define({create(){return[]},update(r,s){if(r.length&&(e.hideOnChange&&(s.docChanged||s.selection)?r=[]:e.hideOn&&(r=r.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let a of r){let l=s.changes.mapPos(a.pos,-1,xi.TrackDel);if(l!=null){let u=Object.assign(Object.create(null),a);u.pos=l,u.end!=null&&(u.end=s.changes.mapPos(u.end)),o.push(u)}}r=o}for(let o of s.effects)o.is(n)&&(r=o.value),o.is(KH)&&(r=[]);return r},provide:r=>ov.from(r)});return[i,In.define(r=>new UH(r,t,i,n,e.hoverTime||300)),zH]}function GH(t,e){let n=t.plugin(Rk);if(!n)return null;let i=n.manager.tooltips.indexOf(e);return i<0?null:n.manager.tooltipViews[i]}const KH=Xe.define(),UP=_e.define({combine(t){let e,n;for(let i of t)e=e||i.topContainer,n=n||i.bottomContainer;return{topContainer:e,bottomContainer:n}}});function of(t,e){let n=t.plugin(kD),i=n?n.specs.indexOf(e):-1;return i>-1?n.panels[i]:null}const kD=In.fromClass(class{constructor(t){this.input=t.state.facet(af),this.specs=this.input.filter(n=>n),this.panels=this.specs.map(n=>n(t));let e=t.state.facet(UP);this.top=new sm(t,!0,e.topContainer),this.bottom=new sm(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(n=>n.top)),this.bottom.sync(this.panels.filter(n=>!n.top));for(let n of this.panels)n.dom.classList.add("cm-panel"),n.mount&&n.mount()}update(t){let e=t.state.facet(UP);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new sm(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new sm(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=t.state.facet(af);if(n!=this.input){let i=n.filter(l=>l),r=[],s=[],o=[],a=[];for(let l of i){let u=this.specs.indexOf(l),c;u<0?(c=l(t.view),a.push(c)):(c=this.panels[u],c.update&&c.update(t)),r.push(c),(c.top?s:o).push(c)}this.specs=i,this.panels=r,this.top.sync(s),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let i of this.panels)i.update&&i.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Pe.scrollMargins.of(e=>{let n=e.plugin(t);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}})});class sm{constructor(e,n,i){this.view=e,this.top=n,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let n of this.panels)n.destroy&&e.indexOf(n)<0&&n.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let n=this.container||this.view.dom;n.insertBefore(this.dom,this.top?n.firstChild:null)}let e=this.dom.firstChild;for(let n of this.panels)if(n.dom.parentNode==this.dom){for(;e!=n.dom;)e=VP(e);e=e.nextSibling}else this.dom.insertBefore(n.dom,e);for(;e;)e=VP(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function VP(t){let e=t.nextSibling;return t.remove(),e}const af=_e.define({enables:kD});class za extends Xl{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}za.prototype.elementClass="";za.prototype.toDOM=void 0;za.prototype.mapMode=xi.TrackBefore;za.prototype.startSide=za.prototype.endSide=-1;za.prototype.point=!0;const ig=_e.define(),rg=_e.define(),HP=_e.define({combine:t=>t.some(e=>e)});function XH(t){return[qH]}const qH=In.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(rg).map(e=>new GP(t,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!t.state.facet(HP),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,n=t.view.viewport,i=Math.min(e.to,n.to)-Math.max(e.from,n.from);this.syncGutters(i<(n.to-n.from)*.8)}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(HP)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let n=ct.iter(this.view.state.facet(ig),this.view.viewport.from),i=[],r=this.gutters.map(s=>new YH(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(s.type)){let o=!0;for(let a of s.type)if(a.type==ii.Text&&o){h1(n,i,a.from);for(let l of r)l.line(this.view,a,i);o=!1}else if(a.widget)for(let l of r)l.widget(this.view,a)}else if(s.type==ii.Text){h1(n,i,s.from);for(let o of r)o.line(this.view,s,i)}else if(s.widget)for(let o of r)o.widget(this.view,s);for(let s of r)s.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(rg),n=t.state.facet(rg),i=t.docChanged||t.heightChanged||t.viewportChanged||!ct.eq(t.startState.facet(ig),t.state.facet(ig),t.view.viewport.from,t.view.viewport.to);if(e==n)for(let r of this.gutters)r.update(t)&&(i=!0);else{i=!0;let r=[];for(let s of n){let o=e.indexOf(s);o<0?r.push(new GP(this.view,s)):(this.gutters[o].update(t),r.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),r.indexOf(s)<0&&s.destroy();for(let s of r)this.dom.appendChild(s.dom);this.gutters=r}return i}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>Pe.scrollMargins.of(e=>{let n=e.plugin(t);return!n||n.gutters.length==0||!n.fixed?null:e.textDirection==Nt.LTR?{left:n.dom.offsetWidth*e.scaleX}:{right:n.dom.offsetWidth*e.scaleX}})});function WP(t){return Array.isArray(t)?t:[t]}function h1(t,e,n){for(;t.value&&t.from<=n;)t.from==n&&e.push(t.value),t.next()}class YH{constructor(e,n,i){this.gutter=e,this.height=i,this.i=0,this.cursor=ct.iter(e.markers,n.from)}addElement(e,n,i){let{gutter:r}=this,s=(n.top-this.height)/e.scaleY,o=n.height/e.scaleY;if(this.i==r.elements.length){let a=new _D(e,o,s,i);r.elements.push(a),r.dom.appendChild(a.dom)}else r.elements[this.i].update(e,o,s,i);this.height=n.bottom,this.i++}line(e,n,i){let r=[];h1(this.cursor,r,n.from),i.length&&(r=r.concat(i));let s=this.gutter.config.lineMarker(e,n,r);s&&r.unshift(s);let o=this.gutter;r.length==0&&!o.config.renderEmptyElements||this.addElement(e,n,r)}widget(e,n){let i=this.gutter.config.widgetMarker(e,n.widget,n);i&&this.addElement(e,n,[i])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let n=e.elements.pop();e.dom.removeChild(n.dom),n.destroy()}}}class GP{constructor(e,n){this.view=e,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in n.domEventHandlers)this.dom.addEventListener(i,r=>{let s=r.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let l=s.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=r.clientY;let a=e.lineBlockAtHeight(o-e.documentTop);n.domEventHandlers[i](e,a,r)&&r.preventDefault()});this.markers=WP(n.markers(e)),n.initialSpacer&&(this.spacer=new _D(e,0,0,[n.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let n=this.markers;if(this.markers=WP(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let i=e.view.viewport;return!ct.eq(this.markers,n,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class _D{constructor(e,n,i,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,n,i,r)}update(e,n,i,r){this.height!=n&&(this.height=n,this.dom.style.height=n+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),JH(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,n){let i="cm-gutterElement",r=this.dom.firstChild;for(let s=0,o=0;;){let a=o,l=s<n.length?n[s++]:null,u=!1;if(l){let c=l.elementClass;c&&(i+=" "+c);for(let d=o;d<this.markers.length;d++)if(this.markers[d].compare(l)){a=d,u=!0;break}}else a=this.markers.length;for(;o<a;){let c=this.markers[o++];if(c.toDOM){c.destroy(r);let d=r.nextSibling;r.remove(),r=d}}if(!l)break;l.toDOM&&(u?r=r.nextSibling:this.dom.insertBefore(l.toDOM(e),r)),u&&o++}this.dom.className=i,this.markers=n}destroy(){this.setMarkers(null,[])}}function JH(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].compare(e[n]))return!1;return!0}const ZH=_e.define(),Hu=_e.define({combine(t){return tl(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,n){let i=Object.assign({},e);for(let r in n){let s=i[r],o=n[r];i[r]=s?(a,l,u)=>s(a,l,u)||o(a,l,u):o}return i}})}});class lw extends za{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function uw(t,e){return t.state.facet(Hu).formatNumber(e,t.state)}const QH=rg.compute([Hu],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(ZH)},lineMarker(e,n,i){return i.some(r=>r.toDOM)?null:new lw(uw(e,e.state.doc.lineAt(n.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(Hu)!=e.state.facet(Hu),initialSpacer(e){return new lw(uw(e,KP(e.state.doc.lines)))},updateSpacer(e,n){let i=uw(n.view,KP(n.view.state.doc.lines));return i==e.number?e:new lw(i)},domEventHandlers:t.facet(Hu).domEventHandlers}));function e9(t={}){return[Hu.of(t),XH(),QH]}function KP(t){let e=9;for(;e<t;)e=e*10+9;return e}const t9=new class extends za{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},n9=ig.compute(["selection"],t=>{let e=[],n=-1;for(let i of t.selection.ranges){let r=t.doc.lineAt(i.head).from;r>n&&(n=r,e.push(t9.range(r)))}return ct.of(e)});function i9(){return n9}function CD(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=CD(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function ze(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=CD(t))&&(i&&(i+=" "),i+=e);return i}var Mk={BASE_URL:"/VonSim8/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};const r9=Symbol((Mk?"production":void 0)!=="production"?"RESET":""),s9=t=>typeof(t==null?void 0:t.then)=="function";function o9(t=()=>{try{return window.localStorage}catch(n){(Mk?"production":void 0)!=="production"&&typeof window<"u"&&console.warn(n);return}},e){var n;let i,r;const s={getItem:(l,u)=>{var c,d;const h=p=>{if(p=p||"",i!==p){try{r=JSON.parse(p,e==null?void 0:e.reviver)}catch{return u}i=p}return r},f=(d=(c=t())==null?void 0:c.getItem(l))!=null?d:null;return s9(f)?f.then(h):h(f)},setItem:(l,u)=>{var c;return(c=t())==null?void 0:c.setItem(l,JSON.stringify(u,void 0))},removeItem:l=>{var u;return(u=t())==null?void 0:u.removeItem(l)}},o=l=>(u,c,d)=>l(u,h=>{let f;try{f=JSON.parse(h||"")}catch{f=d}c(f)});let a;try{a=(n=t())==null?void 0:n.subscribe}catch{}return!a&&typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(a=(l,u)=>{if(!(t()instanceof window.Storage))return()=>{};const c=d=>{d.storageArea===t()&&d.key===l&&u(d.newValue)};return window.addEventListener("storage",c),()=>{window.removeEventListener("storage",c)}}),a&&(s.subscribe=o(a)),s}const a9=o9();function ED(t,e,n=a9,i){const r=i==null?void 0:i.getOnInit,s=Ae(r?n.getItem(t,e):e);return(Mk?"production":void 0)!=="production"&&(s.debugPrivate=!0),s.onMount=a=>{a(n.getItem(t,e));let l;return n.subscribe&&(l=n.subscribe(t,a,e)),l},Ae(a=>a(s),(a,l,u)=>{const c=typeof u=="function"?u(a(s)):u;return c===r9?(l(s,e),n.removeItem(t)):c instanceof Promise?c.then(d=>(l(s,d),n.setItem(t,d))):(l(s,c),n.setItem(t,c))})}function l9(t,e=globalThis==null?void 0:globalThis.document){const n=Wn(t);S.useEffect(()=>{const i=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",i,{capture:!0}),()=>e.removeEventListener("keydown",i,{capture:!0})},[n,e])}var u9="DismissableLayer",f1="dismissableLayer.update",c9="dismissableLayer.pointerDownOutside",d9="dismissableLayer.focusOutside",XP,AD=S.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Qf=S.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:r,onFocusOutside:s,onInteractOutside:o,onDismiss:a,...l}=t,u=S.useContext(AD),[c,d]=S.useState(null),h=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=S.useState({}),p=rt(e,A=>d(A)),m=Array.from(u.layers),[w]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),v=m.indexOf(w),y=c?m.indexOf(c):-1,b=u.layersWithOutsidePointerEventsDisabled.size>0,k=y>=v,_=f9(A=>{const P=A.target,I=[...u.branches].some(D=>D.contains(P));!k||I||(r==null||r(A),o==null||o(A),A.defaultPrevented||a==null||a())},h),E=p9(A=>{const P=A.target;[...u.branches].some(D=>D.contains(P))||(s==null||s(A),o==null||o(A),A.defaultPrevented||a==null||a())},h);return l9(A=>{y===u.layers.size-1&&(i==null||i(A),!A.defaultPrevented&&a&&(A.preventDefault(),a()))},h),S.useEffect(()=>{if(c)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(XP=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(c)),u.layers.add(c),qP(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=XP)}},[c,h,n,u]),S.useEffect(()=>()=>{c&&(u.layers.delete(c),u.layersWithOutsidePointerEventsDisabled.delete(c),qP())},[c,u]),S.useEffect(()=>{const A=()=>f({});return document.addEventListener(f1,A),()=>document.removeEventListener(f1,A)},[]),g.jsx(Fe.div,{...l,ref:p,style:{pointerEvents:b?k?"auto":"none":void 0,...t.style},onFocusCapture:fe(t.onFocusCapture,E.onFocusCapture),onBlurCapture:fe(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:fe(t.onPointerDownCapture,_.onPointerDownCapture)})});Qf.displayName=u9;var h9="DismissableLayerBranch",PD=S.forwardRef((t,e)=>{const n=S.useContext(AD),i=S.useRef(null),r=rt(e,i);return S.useEffect(()=>{const s=i.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),g.jsx(Fe.div,{...t,ref:r})});PD.displayName=h9;function f9(t,e=globalThis==null?void 0:globalThis.document){const n=Wn(t),i=S.useRef(!1),r=S.useRef(()=>{});return S.useEffect(()=>{const s=a=>{if(a.target&&!i.current){let l=function(){TD(c9,n,u,{discrete:!0})};const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);i.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>i.current=!0}}function p9(t,e=globalThis==null?void 0:globalThis.document){const n=Wn(t),i=S.useRef(!1);return S.useEffect(()=>{const r=s=>{s.target&&!i.current&&TD(d9,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function qP(){const t=new CustomEvent(f1);document.dispatchEvent(t)}function TD(t,e,n,{discrete:i}){const r=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),i?fk(r,s):r.dispatchEvent(s)}var m9=Qf,g9=PD,cw=0;function Ok(){S.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??YP()),document.body.insertAdjacentElement("beforeend",t[1]??YP()),cw++,()=>{cw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),cw--}},[])}function YP(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}var dw="focusScope.autoFocusOnMount",hw="focusScope.autoFocusOnUnmount",JP={bubbles:!1,cancelable:!0},v9="FocusScope",xy=S.forwardRef((t,e)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:r,onUnmountAutoFocus:s,...o}=t,[a,l]=S.useState(null),u=Wn(r),c=Wn(s),d=S.useRef(null),h=rt(e,m=>l(m)),f=S.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;S.useEffect(()=>{if(i){let m=function(b){if(f.paused||!a)return;const k=b.target;a.contains(k)?d.current=k:Go(d.current,{select:!0})},w=function(b){if(f.paused||!a)return;const k=b.relatedTarget;k!==null&&(a.contains(k)||Go(d.current,{select:!0}))},v=function(b){if(document.activeElement===document.body)for(const _ of b)_.removedNodes.length>0&&Go(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",w);const y=new MutationObserver(v);return a&&y.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",w),y.disconnect()}}},[i,a,f.paused]),S.useEffect(()=>{if(a){QP.add(f);const m=document.activeElement;if(!a.contains(m)){const v=new CustomEvent(dw,JP);a.addEventListener(dw,u),a.dispatchEvent(v),v.defaultPrevented||(y9(k9(RD(a)),{select:!0}),document.activeElement===m&&Go(a))}return()=>{a.removeEventListener(dw,u),setTimeout(()=>{const v=new CustomEvent(hw,JP);a.addEventListener(hw,c),a.dispatchEvent(v),v.defaultPrevented||Go(m??document.body,{select:!0}),a.removeEventListener(hw,c),QP.remove(f)},0)}}},[a,u,c,f]);const p=S.useCallback(m=>{if(!n&&!i||f.paused)return;const w=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,v=document.activeElement;if(w&&v){const y=m.currentTarget,[b,k]=w9(y);b&&k?!m.shiftKey&&v===k?(m.preventDefault(),n&&Go(b,{select:!0})):m.shiftKey&&v===b&&(m.preventDefault(),n&&Go(k,{select:!0})):v===y&&m.preventDefault()}},[n,i,f.paused]);return g.jsx(Fe.div,{tabIndex:-1,...o,ref:h,onKeyDown:p})});xy.displayName=v9;function y9(t,{select:e=!1}={}){const n=document.activeElement;for(const i of t)if(Go(i,{select:e}),document.activeElement!==n)return}function w9(t){const e=RD(t),n=ZP(e,t),i=ZP(e.reverse(),t);return[n,i]}function RD(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function ZP(t,e){for(const n of t)if(!b9(n,{upTo:e}))return n}function b9(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function x9(t){return t instanceof HTMLInputElement&&"select"in t}function Go(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&x9(t)&&e&&t.select()}}var QP=S9();function S9(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=eT(t,e),t.unshift(e)},remove(e){var n;t=eT(t,e),(n=t[0])==null||n.resume()}}}function eT(t,e){const n=[...t],i=n.indexOf(e);return i!==-1&&n.splice(i,1),n}function k9(t){return t.filter(e=>e.tagName!=="A")}const _9=["top","right","bottom","left"],Ns=Math.min,zi=Math.max,av=Math.round,om=Math.floor,Ua=t=>({x:t,y:t}),C9={left:"right",right:"left",bottom:"top",top:"bottom"},E9={start:"end",end:"start"};function p1(t,e,n){return zi(t,Ns(e,n))}function No(t,e){return typeof t=="function"?t(e):t}function Mo(t){return t.split("-")[0]}function td(t){return t.split("-")[1]}function Ik(t){return t==="x"?"y":"x"}function Dk(t){return t==="y"?"height":"width"}function Va(t){return["top","bottom"].includes(Mo(t))?"y":"x"}function Lk(t){return Ik(Va(t))}function A9(t,e,n){n===void 0&&(n=!1);const i=td(t),r=Lk(t),s=Dk(r);let o=r==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=lv(o)),[o,lv(o)]}function P9(t){const e=lv(t);return[m1(t),e,m1(e)]}function m1(t){return t.replace(/start|end/g,e=>E9[e])}function T9(t,e,n){const i=["left","right"],r=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?r:i:e?i:r;case"left":case"right":return e?s:o;default:return[]}}function R9(t,e,n,i){const r=td(t);let s=T9(Mo(t),n==="start",i);return r&&(s=s.map(o=>o+"-"+r),e&&(s=s.concat(s.map(m1)))),s}function lv(t){return t.replace(/left|right|bottom|top/g,e=>C9[e])}function N9(t){return{top:0,right:0,bottom:0,left:0,...t}}function ND(t){return typeof t!="number"?N9(t):{top:t,right:t,bottom:t,left:t}}function uv(t){const{x:e,y:n,width:i,height:r}=t;return{width:i,height:r,top:n,left:e,right:e+i,bottom:n+r,x:e,y:n}}function tT(t,e,n){let{reference:i,floating:r}=t;const s=Va(e),o=Lk(e),a=Dk(o),l=Mo(e),u=s==="y",c=i.x+i.width/2-r.width/2,d=i.y+i.height/2-r.height/2,h=i[a]/2-r[a]/2;let f;switch(l){case"top":f={x:c,y:i.y-r.height};break;case"bottom":f={x:c,y:i.y+i.height};break;case"right":f={x:i.x+i.width,y:d};break;case"left":f={x:i.x-r.width,y:d};break;default:f={x:i.x,y:i.y}}switch(td(e)){case"start":f[o]-=h*(n&&u?-1:1);break;case"end":f[o]+=h*(n&&u?-1:1);break}return f}const M9=async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:c,y:d}=tT(u,i,l),h=i,f={},p=0;for(let m=0;m<a.length;m++){const{name:w,fn:v}=a[m],{x:y,y:b,data:k,reset:_}=await v({x:c,y:d,initialPlacement:i,placement:h,strategy:r,middlewareData:f,rects:u,platform:o,elements:{reference:t,floating:e}});c=y??c,d=b??d,f={...f,[w]:{...f[w],...k}},_&&p<=50&&(p++,typeof _=="object"&&(_.placement&&(h=_.placement),_.rects&&(u=_.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):_.rects),{x:c,y:d}=tT(u,h,l)),m=-1)}return{x:c,y:d,placement:h,strategy:r,middlewareData:f}};async function lf(t,e){var n;e===void 0&&(e={});const{x:i,y:r,platform:s,rects:o,elements:a,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=No(e,t),p=ND(f),w=a[h?d==="floating"?"reference":"floating":d],v=uv(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(w)))==null||n?w:w.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:u,rootBoundary:c,strategy:l})),y=d==="floating"?{x:i,y:r,width:o.floating.width,height:o.floating.height}:o.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),k=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},_=uv(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:b,strategy:l}):y);return{top:(v.top-_.top+p.top)/k.y,bottom:(_.bottom-v.bottom+p.bottom)/k.y,left:(v.left-_.left+p.left)/k.x,right:(_.right-v.right+p.right)/k.x}}const O9=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:r,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:u,padding:c=0}=No(t,e)||{};if(u==null)return{};const d=ND(c),h={x:n,y:i},f=Lk(r),p=Dk(f),m=await o.getDimensions(u),w=f==="y",v=w?"top":"left",y=w?"bottom":"right",b=w?"clientHeight":"clientWidth",k=s.reference[p]+s.reference[f]-h[f]-s.floating[p],_=h[f]-s.reference[f],E=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let A=E?E[b]:0;(!A||!await(o.isElement==null?void 0:o.isElement(E)))&&(A=a.floating[b]||s.floating[p]);const P=k/2-_/2,I=A/2-m[p]/2-1,D=Ns(d[v],I),B=Ns(d[y],I),$=D,J=A-m[p]-B,z=A/2-m[p]/2+P,G=p1($,z,J),Q=!l.arrow&&td(r)!=null&&z!==G&&s.reference[p]/2-(z<$?D:B)-m[p]/2<0,ie=Q?z<$?z-$:z-J:0;return{[f]:h[f]+ie,data:{[f]:G,centerOffset:z-G-ie,...Q&&{alignmentOffset:ie}},reset:Q}}}),I9=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:r,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...w}=No(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const v=Mo(r),y=Va(a),b=Mo(a)===a,k=await(l.isRTL==null?void 0:l.isRTL(u.floating)),_=h||(b||!m?[lv(a)]:P9(a)),E=p!=="none";!h&&E&&_.push(...R9(a,m,p,k));const A=[a,..._],P=await lf(e,w),I=[];let D=((i=s.flip)==null?void 0:i.overflows)||[];if(c&&I.push(P[v]),d){const z=A9(r,o,k);I.push(P[z[0]],P[z[1]])}if(D=[...D,{placement:r,overflows:I}],!I.every(z=>z<=0)){var B,$;const z=(((B=s.flip)==null?void 0:B.index)||0)+1,G=A[z];if(G)return{data:{index:z,overflows:D},reset:{placement:G}};let Q=($=D.filter(ie=>ie.overflows[0]<=0).sort((ie,H)=>ie.overflows[1]-H.overflows[1])[0])==null?void 0:$.placement;if(!Q)switch(f){case"bestFit":{var J;const ie=(J=D.filter(H=>{if(E){const j=Va(H.placement);return j===y||j==="y"}return!0}).map(H=>[H.placement,H.overflows.filter(j=>j>0).reduce((j,te)=>j+te,0)]).sort((H,j)=>H[1]-j[1])[0])==null?void 0:J[0];ie&&(Q=ie);break}case"initialPlacement":Q=a;break}if(r!==Q)return{reset:{placement:Q}}}return{}}}};function nT(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function iT(t){return _9.some(e=>t[e]>=0)}const D9=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:i="referenceHidden",...r}=No(t,e);switch(i){case"referenceHidden":{const s=await lf(e,{...r,elementContext:"reference"}),o=nT(s,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:iT(o)}}}case"escaped":{const s=await lf(e,{...r,altBoundary:!0}),o=nT(s,n.floating);return{data:{escapedOffsets:o,escaped:iT(o)}}}default:return{}}}}};async function L9(t,e){const{placement:n,platform:i,elements:r}=t,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),o=Mo(n),a=td(n),l=Va(n)==="y",u=["left","top"].includes(o)?-1:1,c=s&&l?-1:1,d=No(e,t);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*c,y:h*u}:{x:h*u,y:f*c}}const j9=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:r,y:s,placement:o,middlewareData:a}=e,l=await L9(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:{...l,placement:o}}}}},F9=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:r}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:w=>{let{x:v,y}=w;return{x:v,y}}},...l}=No(t,e),u={x:n,y:i},c=await lf(e,l),d=Va(Mo(r)),h=Ik(d);let f=u[h],p=u[d];if(s){const w=h==="y"?"top":"left",v=h==="y"?"bottom":"right",y=f+c[w],b=f-c[v];f=p1(y,f,b)}if(o){const w=d==="y"?"top":"left",v=d==="y"?"bottom":"right",y=p+c[w],b=p-c[v];p=p1(y,p,b)}const m=a.fn({...e,[h]:f,[d]:p});return{...m,data:{x:m.x-n,y:m.y-i}}}}},B9=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:i,placement:r,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:u=!0}=No(t,e),c={x:n,y:i},d=Va(r),h=Ik(d);let f=c[h],p=c[d];const m=No(a,e),w=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const b=h==="y"?"height":"width",k=s.reference[h]-s.floating[b]+w.mainAxis,_=s.reference[h]+s.reference[b]-w.mainAxis;f<k?f=k:f>_&&(f=_)}if(u){var v,y;const b=h==="y"?"width":"height",k=["top","left"].includes(Mo(r)),_=s.reference[d]-s.floating[b]+(k&&((v=o.offset)==null?void 0:v[d])||0)+(k?0:w.crossAxis),E=s.reference[d]+s.reference[b]+(k?0:((y=o.offset)==null?void 0:y[d])||0)-(k?w.crossAxis:0);p<_?p=_:p>E&&(p=E)}return{[h]:f,[d]:p}}}},$9=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){const{placement:n,rects:i,platform:r,elements:s}=e,{apply:o=()=>{},...a}=No(t,e),l=await lf(e,a),u=Mo(n),c=td(n),d=Va(n)==="y",{width:h,height:f}=i.floating;let p,m;u==="top"||u==="bottom"?(p=u,m=c===(await(r.isRTL==null?void 0:r.isRTL(s.floating))?"start":"end")?"left":"right"):(m=u,p=c==="end"?"top":"bottom");const w=f-l.top-l.bottom,v=h-l.left-l.right,y=Ns(f-l[p],w),b=Ns(h-l[m],v),k=!e.middlewareData.shift;let _=y,E=b;if(d?E=c||k?Ns(b,v):v:_=c||k?Ns(y,w):w,k&&!c){const P=zi(l.left,0),I=zi(l.right,0),D=zi(l.top,0),B=zi(l.bottom,0);d?E=h-2*(P!==0||I!==0?P+I:zi(l.left,l.right)):_=f-2*(D!==0||B!==0?D+B:zi(l.top,l.bottom))}await o({...e,availableWidth:E,availableHeight:_});const A=await r.getDimensions(s.floating);return h!==A.width||f!==A.height?{reset:{rects:!0}}:{}}}};function nd(t){return MD(t)?(t.nodeName||"").toLowerCase():"#document"}function Ki(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Bo(t){var e;return(e=(MD(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function MD(t){return t instanceof Node||t instanceof Ki(t).Node}function is(t){return t instanceof Element||t instanceof Ki(t).Element}function Bs(t){return t instanceof HTMLElement||t instanceof Ki(t).HTMLElement}function rT(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ki(t).ShadowRoot}function ep(t){const{overflow:e,overflowX:n,overflowY:i,display:r}=rs(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(r)}function z9(t){return["table","td","th"].includes(nd(t))}function Sy(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function jk(t){const e=Fk(),n=is(t)?rs(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function U9(t){let e=Ha(t);for(;Bs(e)&&!Lc(e);){if(jk(e))return e;if(Sy(e))return null;e=Ha(e)}return null}function Fk(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Lc(t){return["html","body","#document"].includes(nd(t))}function rs(t){return Ki(t).getComputedStyle(t)}function ky(t){return is(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ha(t){if(nd(t)==="html")return t;const e=t.assignedSlot||t.parentNode||rT(t)&&t.host||Bo(t);return rT(e)?e.host:e}function OD(t){const e=Ha(t);return Lc(e)?t.ownerDocument?t.ownerDocument.body:t.body:Bs(e)&&ep(e)?e:OD(e)}function uf(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=OD(t),s=r===((i=t.ownerDocument)==null?void 0:i.body),o=Ki(r);return s?e.concat(o,o.visualViewport||[],ep(r)?r:[],o.frameElement&&n?uf(o.frameElement):[]):e.concat(r,uf(r,[],n))}function ID(t){const e=rs(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=Bs(t),s=r?t.offsetWidth:n,o=r?t.offsetHeight:i,a=av(n)!==s||av(i)!==o;return a&&(n=s,i=o),{width:n,height:i,$:a}}function Bk(t){return is(t)?t:t.contextElement}function uc(t){const e=Bk(t);if(!Bs(e))return Ua(1);const n=e.getBoundingClientRect(),{width:i,height:r,$:s}=ID(e);let o=(s?av(n.width):n.width)/i,a=(s?av(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const V9=Ua(0);function DD(t){const e=Ki(t);return!Fk()||!e.visualViewport?V9:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function H9(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ki(t)?!1:e}function Ql(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=Bk(t);let o=Ua(1);e&&(i?is(i)&&(o=uc(i)):o=uc(t));const a=H9(s,n,i)?DD(s):Ua(0);let l=(r.left+a.x)/o.x,u=(r.top+a.y)/o.y,c=r.width/o.x,d=r.height/o.y;if(s){const h=Ki(s),f=i&&is(i)?Ki(i):i;let p=h,m=p.frameElement;for(;m&&i&&f!==p;){const w=uc(m),v=m.getBoundingClientRect(),y=rs(m),b=v.left+(m.clientLeft+parseFloat(y.paddingLeft))*w.x,k=v.top+(m.clientTop+parseFloat(y.paddingTop))*w.y;l*=w.x,u*=w.y,c*=w.x,d*=w.y,l+=b,u+=k,p=Ki(m),m=p.frameElement}}return uv({width:c,height:d,x:l,y:u})}function W9(t){let{elements:e,rect:n,offsetParent:i,strategy:r}=t;const s=r==="fixed",o=Bo(i),a=e?Sy(e.floating):!1;if(i===o||a&&s)return n;let l={scrollLeft:0,scrollTop:0},u=Ua(1);const c=Ua(0),d=Bs(i);if((d||!d&&!s)&&((nd(i)!=="body"||ep(o))&&(l=ky(i)),Bs(i))){const h=Ql(i);u=uc(i),c.x=h.x+i.clientLeft,c.y=h.y+i.clientTop}return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+c.x,y:n.y*u.y-l.scrollTop*u.y+c.y}}function G9(t){return Array.from(t.getClientRects())}function LD(t){return Ql(Bo(t)).left+ky(t).scrollLeft}function K9(t){const e=Bo(t),n=ky(t),i=t.ownerDocument.body,r=zi(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=zi(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let o=-n.scrollLeft+LD(t);const a=-n.scrollTop;return rs(i).direction==="rtl"&&(o+=zi(e.clientWidth,i.clientWidth)-r),{width:r,height:s,x:o,y:a}}function X9(t,e){const n=Ki(t),i=Bo(t),r=n.visualViewport;let s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;const u=Fk();(!u||u&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a,y:l}}function q9(t,e){const n=Ql(t,!0,e==="fixed"),i=n.top+t.clientTop,r=n.left+t.clientLeft,s=Bs(t)?uc(t):Ua(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,l=r*s.x,u=i*s.y;return{width:o,height:a,x:l,y:u}}function sT(t,e,n){let i;if(e==="viewport")i=X9(t,n);else if(e==="document")i=K9(Bo(t));else if(is(e))i=q9(e,n);else{const r=DD(t);i={...e,x:e.x-r.x,y:e.y-r.y}}return uv(i)}function jD(t,e){const n=Ha(t);return n===e||!is(n)||Lc(n)?!1:rs(n).position==="fixed"||jD(n,e)}function Y9(t,e){const n=e.get(t);if(n)return n;let i=uf(t,[],!1).filter(a=>is(a)&&nd(a)!=="body"),r=null;const s=rs(t).position==="fixed";let o=s?Ha(t):t;for(;is(o)&&!Lc(o);){const a=rs(o),l=jk(o);!l&&a.position==="fixed"&&(r=null),(s?!l&&!r:!l&&a.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||ep(o)&&!l&&jD(t,o))?i=i.filter(c=>c!==o):r=a,o=Ha(o)}return e.set(t,i),i}function J9(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const o=[...n==="clippingAncestors"?Sy(e)?[]:Y9(e,this._c):[].concat(n),i],a=o[0],l=o.reduce((u,c)=>{const d=sT(e,c,r);return u.top=zi(d.top,u.top),u.right=Ns(d.right,u.right),u.bottom=Ns(d.bottom,u.bottom),u.left=zi(d.left,u.left),u},sT(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Z9(t){const{width:e,height:n}=ID(t);return{width:e,height:n}}function Q9(t,e,n){const i=Bs(e),r=Bo(e),s=n==="fixed",o=Ql(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=Ua(0);if(i||!i&&!s)if((nd(e)!=="body"||ep(r))&&(a=ky(e)),i){const d=Ql(e,!0,s,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else r&&(l.x=LD(r));const u=o.left+a.scrollLeft-l.x,c=o.top+a.scrollTop-l.y;return{x:u,y:c,width:o.width,height:o.height}}function fw(t){return rs(t).position==="static"}function oT(t,e){return!Bs(t)||rs(t).position==="fixed"?null:e?e(t):t.offsetParent}function FD(t,e){const n=Ki(t);if(Sy(t))return n;if(!Bs(t)){let r=Ha(t);for(;r&&!Lc(r);){if(is(r)&&!fw(r))return r;r=Ha(r)}return n}let i=oT(t,e);for(;i&&z9(i)&&fw(i);)i=oT(i,e);return i&&Lc(i)&&fw(i)&&!jk(i)?n:i||U9(t)||n}const eW=async function(t){const e=this.getOffsetParent||FD,n=this.getDimensions,i=await n(t.floating);return{reference:Q9(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function tW(t){return rs(t).direction==="rtl"}const nW={convertOffsetParentRelativeRectToViewportRelativeRect:W9,getDocumentElement:Bo,getClippingRect:J9,getOffsetParent:FD,getElementRects:eW,getClientRects:G9,getDimensions:Z9,getScale:uc,isElement:is,isRTL:tW};function iW(t,e){let n=null,i;const r=Bo(t);function s(){var a;clearTimeout(i),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const{left:u,top:c,width:d,height:h}=t.getBoundingClientRect();if(a||e(),!d||!h)return;const f=om(c),p=om(r.clientWidth-(u+d)),m=om(r.clientHeight-(c+h)),w=om(u),y={rootMargin:-f+"px "+-p+"px "+-m+"px "+-w+"px",threshold:zi(0,Ns(1,l))||1};let b=!0;function k(_){const E=_[0].intersectionRatio;if(E!==l){if(!b)return o();E?o(!1,E):i=setTimeout(()=>{o(!1,1e-7)},1e3)}b=!1}try{n=new IntersectionObserver(k,{...y,root:r.ownerDocument})}catch{n=new IntersectionObserver(k,y)}n.observe(t)}return o(!0),s}function rW(t,e,n,i){i===void 0&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,u=Bk(t),c=r||s?[...u?uf(u):[],...uf(e)]:[];c.forEach(v=>{r&&v.addEventListener("scroll",n,{passive:!0}),s&&v.addEventListener("resize",n)});const d=u&&a?iW(u,n):null;let h=-1,f=null;o&&(f=new ResizeObserver(v=>{let[y]=v;y&&y.target===u&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(e)})),n()}),u&&!l&&f.observe(u),f.observe(e));let p,m=l?Ql(t):null;l&&w();function w(){const v=Ql(t);m&&(v.x!==m.x||v.y!==m.y||v.width!==m.width||v.height!==m.height)&&n(),m=v,p=requestAnimationFrame(w)}return n(),()=>{var v;c.forEach(y=>{r&&y.removeEventListener("scroll",n),s&&y.removeEventListener("resize",n)}),d==null||d(),(v=f)==null||v.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const sW=j9,oW=F9,aW=I9,lW=$9,uW=D9,aT=O9,cW=B9,dW=(t,e,n)=>{const i=new Map,r={platform:nW,...n},s={...r.platform,_c:i};return M9(t,e,{...r,platform:s})};var sg=typeof document<"u"?S.useLayoutEffect:S.useEffect;function cv(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,i,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(i=n;i--!==0;)if(!cv(t[i],e[i]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(e,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!(s==="_owner"&&t.$$typeof)&&!cv(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function BD(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function lT(t,e){const n=BD(t);return Math.round(e*n)/n}function uT(t){const e=S.useRef(t);return sg(()=>{e.current=t}),e}function hW(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:i=[],platform:r,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:u}=t,[c,d]=S.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,f]=S.useState(i);cv(h,i)||f(i);const[p,m]=S.useState(null),[w,v]=S.useState(null),y=S.useCallback(ie=>{ie!==E.current&&(E.current=ie,m(ie))},[]),b=S.useCallback(ie=>{ie!==A.current&&(A.current=ie,v(ie))},[]),k=s||p,_=o||w,E=S.useRef(null),A=S.useRef(null),P=S.useRef(c),I=l!=null,D=uT(l),B=uT(r),$=S.useCallback(()=>{if(!E.current||!A.current)return;const ie={placement:e,strategy:n,middleware:h};B.current&&(ie.platform=B.current),dW(E.current,A.current,ie).then(H=>{const j={...H,isPositioned:!0};J.current&&!cv(P.current,j)&&(P.current=j,Lo.flushSync(()=>{d(j)}))})},[h,e,n,B]);sg(()=>{u===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,d(ie=>({...ie,isPositioned:!1})))},[u]);const J=S.useRef(!1);sg(()=>(J.current=!0,()=>{J.current=!1}),[]),sg(()=>{if(k&&(E.current=k),_&&(A.current=_),k&&_){if(D.current)return D.current(k,_,$);$()}},[k,_,$,D,I]);const z=S.useMemo(()=>({reference:E,floating:A,setReference:y,setFloating:b}),[y,b]),G=S.useMemo(()=>({reference:k,floating:_}),[k,_]),Q=S.useMemo(()=>{const ie={position:n,left:0,top:0};if(!G.floating)return ie;const H=lT(G.floating,c.x),j=lT(G.floating,c.y);return a?{...ie,transform:"translate("+H+"px, "+j+"px)",...BD(G.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:H,top:j}},[n,a,G.floating,c.x,c.y]);return S.useMemo(()=>({...c,update:$,refs:z,elements:G,floatingStyles:Q}),[c,$,z,G,Q])}const fW=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:i,padding:r}=typeof t=="function"?t(n):t;return i&&e(i)?i.current!=null?aT({element:i.current,padding:r}).fn(n):{}:i?aT({element:i,padding:r}).fn(n):{}}}},pW=(t,e)=>({...sW(t),options:[t,e]}),mW=(t,e)=>({...oW(t),options:[t,e]}),gW=(t,e)=>({...cW(t),options:[t,e]}),vW=(t,e)=>({...aW(t),options:[t,e]}),yW=(t,e)=>({...lW(t),options:[t,e]}),wW=(t,e)=>({...uW(t),options:[t,e]}),bW=(t,e)=>({...fW(t),options:[t,e]});var xW="Arrow",$D=S.forwardRef((t,e)=>{const{children:n,width:i=10,height:r=5,...s}=t;return g.jsx(Fe.svg,{...s,ref:e,width:i,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:g.jsx("polygon",{points:"0,0 30,0 15,10"})})});$D.displayName=xW;var SW=$D;function $k(t){const[e,n]=S.useState(void 0);return Hn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const i=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const s=r[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,a=u.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return i.observe(t,{box:"border-box"}),()=>i.unobserve(t)}else n(void 0)},[t]),e}var zk="Popper",[zD,id]=ls(zk),[kW,UD]=zD(zk),VD=t=>{const{__scopePopper:e,children:n}=t,[i,r]=S.useState(null);return g.jsx(kW,{scope:e,anchor:i,onAnchorChange:r,children:n})};VD.displayName=zk;var HD="PopperAnchor",WD=S.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:i,...r}=t,s=UD(HD,n),o=S.useRef(null),a=rt(e,o);return S.useEffect(()=>{s.onAnchorChange((i==null?void 0:i.current)||o.current)}),i?null:g.jsx(Fe.div,{...r,ref:a})});WD.displayName=HD;var Uk="PopperContent",[_W,CW]=zD(Uk),GD=S.forwardRef((t,e)=>{var x,T,N,R,W,U;const{__scopePopper:n,side:i="bottom",sideOffset:r=0,align:s="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:c=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:p,...m}=t,w=UD(Uk,n),[v,y]=S.useState(null),b=rt(e,Z=>y(Z)),[k,_]=S.useState(null),E=$k(k),A=(E==null?void 0:E.width)??0,P=(E==null?void 0:E.height)??0,I=i+(s!=="center"?"-"+s:""),D=typeof c=="number"?c:{top:0,right:0,bottom:0,left:0,...c},B=Array.isArray(u)?u:[u],$=B.length>0,J={padding:D,boundary:B.filter(AW),altBoundary:$},{refs:z,floatingStyles:G,placement:Q,isPositioned:ie,middlewareData:H}=hW({strategy:"fixed",placement:I,whileElementsMounted:(...Z)=>rW(...Z,{animationFrame:f==="always"}),elements:{reference:w.anchor},middleware:[pW({mainAxis:r+P,alignmentAxis:o}),l&&mW({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?gW():void 0,...J}),l&&vW({...J}),yW({...J,apply:({elements:Z,rects:K,availableWidth:Se,availableHeight:Oe})=>{const{width:De,height:Ne}=K.reference,$e=Z.floating.style;$e.setProperty("--radix-popper-available-width",`${Se}px`),$e.setProperty("--radix-popper-available-height",`${Oe}px`),$e.setProperty("--radix-popper-anchor-width",`${De}px`),$e.setProperty("--radix-popper-anchor-height",`${Ne}px`)}}),k&&bW({element:k,padding:a}),PW({arrowWidth:A,arrowHeight:P}),h&&wW({strategy:"referenceHidden",...J})]}),[j,te]=qD(Q),pe=Wn(p);Hn(()=>{ie&&(pe==null||pe())},[ie,pe]);const q=(x=H.arrow)==null?void 0:x.x,ue=(T=H.arrow)==null?void 0:T.y,O=((N=H.arrow)==null?void 0:N.centerOffset)!==0,[M,F]=S.useState();return Hn(()=>{v&&F(window.getComputedStyle(v).zIndex)},[v]),g.jsx("div",{ref:z.setFloating,"data-radix-popper-content-wrapper":"",style:{...G,transform:ie?G.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:M,"--radix-popper-transform-origin":[(R=H.transformOrigin)==null?void 0:R.x,(W=H.transformOrigin)==null?void 0:W.y].join(" "),...((U=H.hide)==null?void 0:U.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:g.jsx(_W,{scope:n,placedSide:j,onArrowChange:_,arrowX:q,arrowY:ue,shouldHideArrow:O,children:g.jsx(Fe.div,{"data-side":j,"data-align":te,...m,ref:b,style:{...m.style,animation:ie?void 0:"none"}})})})});GD.displayName=Uk;var KD="PopperArrow",EW={top:"bottom",right:"left",bottom:"top",left:"right"},XD=S.forwardRef(function(e,n){const{__scopePopper:i,...r}=e,s=CW(KD,i),o=EW[s.placedSide];return g.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:g.jsx(SW,{...r,ref:n,style:{...r.style,display:"block"}})})});XD.displayName=KD;function AW(t){return t!==null}var PW=t=>({name:"transformOrigin",options:t,fn(e){var w,v,y;const{placement:n,rects:i,middlewareData:r}=e,o=((w=r.arrow)==null?void 0:w.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[u,c]=qD(n),d={start:"0%",center:"50%",end:"100%"}[c],h=(((v=r.arrow)==null?void 0:v.x)??0)+a/2,f=(((y=r.arrow)==null?void 0:y.y)??0)+l/2;let p="",m="";return u==="bottom"?(p=o?d:`${h}px`,m=`${-l}px`):u==="top"?(p=o?d:`${h}px`,m=`${i.floating.height+l}px`):u==="right"?(p=`${-l}px`,m=o?d:`${f}px`):u==="left"&&(p=`${i.floating.width+l}px`,m=o?d:`${f}px`),{data:{x:p,y:m}}}});function qD(t){const[e,n="center"]=t.split("-");return[e,n]}var Vk=VD,_y=WD,Hk=GD,Wk=XD,TW="Portal",tp=S.forwardRef((t,e)=>{var a;const{container:n,...i}=t,[r,s]=S.useState(!1);Hn(()=>s(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?t6.createPortal(g.jsx(Fe.div,{...i,ref:e}),o):null});tp.displayName=TW;var RW=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},mu=new WeakMap,am=new WeakMap,lm={},pw=0,YD=function(t){return t&&(t.host||YD(t.parentNode))},NW=function(t,e){return e.map(function(n){if(t.contains(n))return n;var i=YD(n);return i&&t.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},MW=function(t,e,n,i){var r=NW(e,Array.isArray(t)?t:[t]);lm[n]||(lm[n]=new WeakMap);var s=lm[n],o=[],a=new Set,l=new Set(r),u=function(d){!d||a.has(d)||(a.add(d),u(d.parentNode))};r.forEach(u);var c=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))c(h);else try{var f=h.getAttribute(i),p=f!==null&&f!=="false",m=(mu.get(h)||0)+1,w=(s.get(h)||0)+1;mu.set(h,m),s.set(h,w),o.push(h),m===1&&p&&am.set(h,!0),w===1&&h.setAttribute(n,"true"),p||h.setAttribute(i,"true")}catch(v){console.error("aria-hidden: cannot operate on ",h,v)}})};return c(e),a.clear(),pw++,function(){o.forEach(function(d){var h=mu.get(d)-1,f=s.get(d)-1;mu.set(d,h),s.set(d,f),h||(am.has(d)||d.removeAttribute(i),am.delete(d)),f||d.removeAttribute(n)}),pw--,pw||(mu=new WeakMap,mu=new WeakMap,am=new WeakMap,lm={})}},Gk=function(t,e,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(t)?t:[t]),r=RW(t);return r?(i.push.apply(i,Array.from(r.querySelectorAll("[aria-live]"))),MW(i,r,n,"aria-hidden")):function(){return null}},og="right-scroll-bar-position",ag="width-before-scroll-bar",OW="with-scroll-bars-hidden",IW="--removed-body-scroll-bar-size";function mw(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function DW(t,e){var n=S.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(i){var r=n.value;r!==i&&(n.value=i,n.callback(i,r))}}}})[0];return n.callback=e,n.facade}var LW=typeof window<"u"?S.useLayoutEffect:S.useEffect,cT=new WeakMap;function jW(t,e){var n=DW(null,function(i){return t.forEach(function(r){return mw(r,i)})});return LW(function(){var i=cT.get(n);if(i){var r=new Set(i),s=new Set(t),o=n.current;r.forEach(function(a){s.has(a)||mw(a,null)}),s.forEach(function(a){r.has(a)||mw(a,o)})}cT.set(n,t)},[t]),n}function FW(t){return t}function BW(t,e){e===void 0&&(e=FW);var n=[],i=!1,r={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,i);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(i=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){i=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var l=function(){var c=o;o=[],c.forEach(s)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(c){o.push(c),u()},filter:function(c){return o=o.filter(c),n}}}};return r}function $W(t){t===void 0&&(t={});var e=BW(null);return e.options=Cs({async:!0,ssr:!1},t),e}var JD=function(t){var e=t.sideCar,n=Z2(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=e.read();if(!i)throw new Error("Sidecar medium not found");return S.createElement(i,Cs({},n))};JD.isSideCarExport=!0;function zW(t,e){return t.useMedium(e),JD}var ZD=$W(),gw=function(){},Cy=S.forwardRef(function(t,e){var n=S.useRef(null),i=S.useState({onScrollCapture:gw,onWheelCapture:gw,onTouchMoveCapture:gw}),r=i[0],s=i[1],o=t.forwardProps,a=t.children,l=t.className,u=t.removeScrollBar,c=t.enabled,d=t.shards,h=t.sideCar,f=t.noIsolation,p=t.inert,m=t.allowPinchZoom,w=t.as,v=w===void 0?"div":w,y=t.gapMode,b=Z2(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=h,_=jW([n,e]),E=Cs(Cs({},b),r);return S.createElement(S.Fragment,null,c&&S.createElement(k,{sideCar:ZD,removeScrollBar:u,shards:d,noIsolation:f,inert:p,setCallbacks:s,allowPinchZoom:!!m,lockRef:n,gapMode:y}),o?S.cloneElement(S.Children.only(a),Cs(Cs({},E),{ref:_})):S.createElement(v,Cs({},E,{className:l,ref:_}),a))});Cy.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Cy.classNames={fullWidth:ag,zeroRight:og};var UW=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function VW(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=UW();return e&&t.setAttribute("nonce",e),t}function HW(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function WW(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var GW=function(){var t=0,e=null;return{add:function(n){t==0&&(e=VW())&&(HW(e,n),WW(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},KW=function(){var t=GW();return function(e,n){S.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},QD=function(){var t=KW(),e=function(n){var i=n.styles,r=n.dynamic;return t(i,r),null};return e},XW={left:0,top:0,right:0,gap:0},vw=function(t){return parseInt(t||"",10)||0},qW=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],i=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[vw(n),vw(i),vw(r)]},YW=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return XW;var e=qW(t),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,i-n+e[2]-e[0])}},JW=QD(),cc="data-scroll-locked",ZW=function(t,e,n,i){var r=t.left,s=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(OW,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(a,"px ").concat(i,`;
  }
  body[`).concat(cc,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(og,` {
    right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(ag,` {
    margin-right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(og," .").concat(og,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(ag," .").concat(ag,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(cc,`] {
    `).concat(IW,": ").concat(a,`px;
  }
`)},dT=function(){var t=parseInt(document.body.getAttribute(cc)||"0",10);return isFinite(t)?t:0},QW=function(){S.useEffect(function(){return document.body.setAttribute(cc,(dT()+1).toString()),function(){var t=dT()-1;t<=0?document.body.removeAttribute(cc):document.body.setAttribute(cc,t.toString())}},[])},e7=function(t){var e=t.noRelative,n=t.noImportant,i=t.gapMode,r=i===void 0?"margin":i;QW();var s=S.useMemo(function(){return YW(r)},[r]);return S.createElement(JW,{styles:ZW(s,!e,r,n?"":"!important")})},g1=!1;if(typeof window<"u")try{var um=Object.defineProperty({},"passive",{get:function(){return g1=!0,!0}});window.addEventListener("test",um,um),window.removeEventListener("test",um,um)}catch{g1=!1}var gu=g1?{passive:!1}:!1,t7=function(t){return t.tagName==="TEXTAREA"},eL=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!t7(t)&&n[e]==="visible")},n7=function(t){return eL(t,"overflowY")},i7=function(t){return eL(t,"overflowX")},hT=function(t,e){var n=e.ownerDocument,i=e;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var r=tL(t,i);if(r){var s=nL(t,i),o=s[1],a=s[2];if(o>a)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},r7=function(t){var e=t.scrollTop,n=t.scrollHeight,i=t.clientHeight;return[e,n,i]},s7=function(t){var e=t.scrollLeft,n=t.scrollWidth,i=t.clientWidth;return[e,n,i]},tL=function(t,e){return t==="v"?n7(e):i7(e)},nL=function(t,e){return t==="v"?r7(e):s7(e)},o7=function(t,e){return t==="h"&&e==="rtl"?-1:1},a7=function(t,e,n,i,r){var s=o7(t,window.getComputedStyle(e).direction),o=s*i,a=n.target,l=e.contains(a),u=!1,c=o>0,d=0,h=0;do{var f=nL(t,a),p=f[0],m=f[1],w=f[2],v=m-w-s*p;(p||v)&&tL(t,a)&&(d+=v,h+=p),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(c&&(Math.abs(d)<1||!r)||!c&&(Math.abs(h)<1||!r))&&(u=!0),u},cm=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},fT=function(t){return[t.deltaX,t.deltaY]},pT=function(t){return t&&"current"in t?t.current:t},l7=function(t,e){return t[0]===e[0]&&t[1]===e[1]},u7=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},c7=0,vu=[];function d7(t){var e=S.useRef([]),n=S.useRef([0,0]),i=S.useRef(),r=S.useState(c7++)[0],s=S.useState(QD)[0],o=S.useRef(t);S.useEffect(function(){o.current=t},[t]),S.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var m=aU([t.lockRef.current],(t.shards||[]).map(pT),!0).filter(Boolean);return m.forEach(function(w){return w.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),m.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var a=S.useCallback(function(m,w){if("touches"in m&&m.touches.length===2)return!o.current.allowPinchZoom;var v=cm(m),y=n.current,b="deltaX"in m?m.deltaX:y[0]-v[0],k="deltaY"in m?m.deltaY:y[1]-v[1],_,E=m.target,A=Math.abs(b)>Math.abs(k)?"h":"v";if("touches"in m&&A==="h"&&E.type==="range")return!1;var P=hT(A,E);if(!P)return!0;if(P?_=A:(_=A==="v"?"h":"v",P=hT(A,E)),!P)return!1;if(!i.current&&"changedTouches"in m&&(b||k)&&(i.current=_),!_)return!0;var I=i.current||_;return a7(I,w,m,I==="h"?b:k,!0)},[]),l=S.useCallback(function(m){var w=m;if(!(!vu.length||vu[vu.length-1]!==s)){var v="deltaY"in w?fT(w):cm(w),y=e.current.filter(function(_){return _.name===w.type&&(_.target===w.target||w.target===_.shadowParent)&&l7(_.delta,v)})[0];if(y&&y.should){w.cancelable&&w.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(pT).filter(Boolean).filter(function(_){return _.contains(w.target)}),k=b.length>0?a(w,b[0]):!o.current.noIsolation;k&&w.cancelable&&w.preventDefault()}}},[]),u=S.useCallback(function(m,w,v,y){var b={name:m,delta:w,target:v,should:y,shadowParent:h7(v)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(k){return k!==b})},1)},[]),c=S.useCallback(function(m){n.current=cm(m),i.current=void 0},[]),d=S.useCallback(function(m){u(m.type,fT(m),m.target,a(m,t.lockRef.current))},[]),h=S.useCallback(function(m){u(m.type,cm(m),m.target,a(m,t.lockRef.current))},[]);S.useEffect(function(){return vu.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,gu),document.addEventListener("touchmove",l,gu),document.addEventListener("touchstart",c,gu),function(){vu=vu.filter(function(m){return m!==s}),document.removeEventListener("wheel",l,gu),document.removeEventListener("touchmove",l,gu),document.removeEventListener("touchstart",c,gu)}},[]);var f=t.removeScrollBar,p=t.inert;return S.createElement(S.Fragment,null,p?S.createElement(s,{styles:u7(r)}):null,f?S.createElement(e7,{gapMode:t.gapMode}):null)}function h7(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const f7=zW(ZD,d7);var Ey=S.forwardRef(function(t,e){return S.createElement(Cy,Cs({},t,{ref:e,sideCar:f7}))});Ey.classNames=Cy.classNames;var v1=["Enter"," "],p7=["ArrowDown","PageUp","Home"],iL=["ArrowUp","PageDown","End"],m7=[...p7,...iL],g7={ltr:[...v1,"ArrowRight"],rtl:[...v1,"ArrowLeft"]},v7={ltr:["ArrowLeft"],rtl:["ArrowRight"]},np="Menu",[cf,y7,w7]=Wf(np),[au,rL]=ls(np,[w7,id,gy]),Ay=id(),sL=gy(),[b7,lu]=au(np),[x7,ip]=au(np),oL=t=>{const{__scopeMenu:e,open:n=!1,children:i,dir:r,onOpenChange:s,modal:o=!0}=t,a=Ay(e),[l,u]=S.useState(null),c=S.useRef(!1),d=Wn(s),h=Gf(r);return S.useEffect(()=>{const f=()=>{c.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>c.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),g.jsx(Vk,{...a,children:g.jsx(b7,{scope:e,open:n,onOpenChange:d,content:l,onContentChange:u,children:g.jsx(x7,{scope:e,onClose:S.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:c,dir:h,modal:o,children:i})})})};oL.displayName=np;var S7="MenuAnchor",Kk=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t,r=Ay(n);return g.jsx(_y,{...r,...i,ref:e})});Kk.displayName=S7;var Xk="MenuPortal",[k7,aL]=au(Xk,{forceMount:void 0}),lL=t=>{const{__scopeMenu:e,forceMount:n,children:i,container:r}=t,s=lu(Xk,e);return g.jsx(k7,{scope:e,forceMount:n,children:g.jsx(jo,{present:n||s.open,children:g.jsx(tp,{asChild:!0,container:r,children:i})})})};lL.displayName=Xk;var kr="MenuContent",[_7,qk]=au(kr),uL=S.forwardRef((t,e)=>{const n=aL(kr,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,s=lu(kr,t.__scopeMenu),o=ip(kr,t.__scopeMenu);return g.jsx(cf.Provider,{scope:t.__scopeMenu,children:g.jsx(jo,{present:i||s.open,children:g.jsx(cf.Slot,{scope:t.__scopeMenu,children:o.modal?g.jsx(C7,{...r,ref:e}):g.jsx(E7,{...r,ref:e})})})})}),C7=S.forwardRef((t,e)=>{const n=lu(kr,t.__scopeMenu),i=S.useRef(null),r=rt(e,i);return S.useEffect(()=>{const s=i.current;if(s)return Gk(s)},[]),g.jsx(Yk,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:fe(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),E7=S.forwardRef((t,e)=>{const n=lu(kr,t.__scopeMenu);return g.jsx(Yk,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Yk=S.forwardRef((t,e)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:u,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:h,onDismiss:f,disableOutsideScroll:p,...m}=t,w=lu(kr,n),v=ip(kr,n),y=Ay(n),b=sL(n),k=y7(n),[_,E]=S.useState(null),A=S.useRef(null),P=rt(e,A,w.onContentChange),I=S.useRef(0),D=S.useRef(""),B=S.useRef(0),$=S.useRef(null),J=S.useRef("right"),z=S.useRef(0),G=p?Ey:S.Fragment,Q=p?{as:Kl,allowPinchZoom:!0}:void 0,ie=j=>{var x,T;const te=D.current+j,pe=k().filter(N=>!N.disabled),q=document.activeElement,ue=(x=pe.find(N=>N.ref.current===q))==null?void 0:x.textValue,O=pe.map(N=>N.textValue),M=F7(O,te,ue),F=(T=pe.find(N=>N.textValue===M))==null?void 0:T.ref.current;(function N(R){D.current=R,window.clearTimeout(I.current),R!==""&&(I.current=window.setTimeout(()=>N(""),1e3))})(te),F&&setTimeout(()=>F.focus())};S.useEffect(()=>()=>window.clearTimeout(I.current),[]),Ok();const H=S.useCallback(j=>{var pe,q;return J.current===((pe=$.current)==null?void 0:pe.side)&&$7(j,(q=$.current)==null?void 0:q.area)},[]);return g.jsx(_7,{scope:n,searchRef:D,onItemEnter:S.useCallback(j=>{H(j)&&j.preventDefault()},[H]),onItemLeave:S.useCallback(j=>{var te;H(j)||((te=A.current)==null||te.focus(),E(null))},[H]),onTriggerLeave:S.useCallback(j=>{H(j)&&j.preventDefault()},[H]),pointerGraceTimerRef:B,onPointerGraceIntentChange:S.useCallback(j=>{$.current=j},[]),children:g.jsx(G,{...Q,children:g.jsx(xy,{asChild:!0,trapped:r,onMountAutoFocus:fe(s,j=>{var te;j.preventDefault(),(te=A.current)==null||te.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:g.jsx(Qf,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:u,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:h,onDismiss:f,children:g.jsx(x2,{asChild:!0,...b,dir:v.dir,orientation:"vertical",loop:i,currentTabStopId:_,onCurrentTabStopIdChange:E,onEntryFocus:fe(l,j=>{v.isUsingKeyboardRef.current||j.preventDefault()}),preventScrollOnEntryFocus:!0,children:g.jsx(Hk,{role:"menu","aria-orientation":"vertical","data-state":CL(w.open),"data-radix-menu-content":"",dir:v.dir,...y,...m,ref:P,style:{outline:"none",...m.style},onKeyDown:fe(m.onKeyDown,j=>{const pe=j.target.closest("[data-radix-menu-content]")===j.currentTarget,q=j.ctrlKey||j.altKey||j.metaKey,ue=j.key.length===1;pe&&(j.key==="Tab"&&j.preventDefault(),!q&&ue&&ie(j.key));const O=A.current;if(j.target!==O||!m7.includes(j.key))return;j.preventDefault();const F=k().filter(x=>!x.disabled).map(x=>x.ref.current);iL.includes(j.key)&&F.reverse(),L7(F)}),onBlur:fe(t.onBlur,j=>{j.currentTarget.contains(j.target)||(window.clearTimeout(I.current),D.current="")}),onPointerMove:fe(t.onPointerMove,df(j=>{const te=j.target,pe=z.current!==j.clientX;if(j.currentTarget.contains(te)&&pe){const q=j.clientX>z.current?"right":"left";J.current=q,z.current=j.clientX}}))})})})})})})});uL.displayName=kr;var A7="MenuGroup",Jk=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return g.jsx(Fe.div,{role:"group",...i,ref:e})});Jk.displayName=A7;var P7="MenuLabel",cL=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return g.jsx(Fe.div,{...i,ref:e})});cL.displayName=P7;var dv="MenuItem",mT="menu.itemSelect",Py=S.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:i,...r}=t,s=S.useRef(null),o=ip(dv,t.__scopeMenu),a=qk(dv,t.__scopeMenu),l=rt(e,s),u=S.useRef(!1),c=()=>{const d=s.current;if(!n&&d){const h=new CustomEvent(mT,{bubbles:!0,cancelable:!0});d.addEventListener(mT,f=>i==null?void 0:i(f),{once:!0}),fk(d,h),h.defaultPrevented?u.current=!1:o.onClose()}};return g.jsx(dL,{...r,ref:l,disabled:n,onClick:fe(t.onClick,c),onPointerDown:d=>{var h;(h=t.onPointerDown)==null||h.call(t,d),u.current=!0},onPointerUp:fe(t.onPointerUp,d=>{var h;u.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:fe(t.onKeyDown,d=>{const h=a.searchRef.current!=="";n||h&&d.key===" "||v1.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});Py.displayName=dv;var dL=S.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:i=!1,textValue:r,...s}=t,o=qk(dv,n),a=sL(n),l=S.useRef(null),u=rt(e,l),[c,d]=S.useState(!1),[h,f]=S.useState("");return S.useEffect(()=>{const p=l.current;p&&f((p.textContent??"").trim())},[s.children]),g.jsx(cf.ItemSlot,{scope:n,disabled:i,textValue:r??h,children:g.jsx(S2,{asChild:!0,...a,focusable:!i,children:g.jsx(Fe.div,{role:"menuitem","data-highlighted":c?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...s,ref:u,onPointerMove:fe(t.onPointerMove,df(p=>{i?o.onItemLeave(p):(o.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:fe(t.onPointerLeave,df(p=>o.onItemLeave(p))),onFocus:fe(t.onFocus,()=>d(!0)),onBlur:fe(t.onBlur,()=>d(!1))})})})}),T7="MenuCheckboxItem",hL=S.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:i,...r}=t;return g.jsx(vL,{scope:t.__scopeMenu,checked:n,children:g.jsx(Py,{role:"menuitemcheckbox","aria-checked":hv(n)?"mixed":n,...r,ref:e,"data-state":Qk(n),onSelect:fe(r.onSelect,()=>i==null?void 0:i(hv(n)?!0:!n),{checkForDefaultPrevented:!1})})})});hL.displayName=T7;var fL="MenuRadioGroup",[R7,N7]=au(fL,{value:void 0,onValueChange:()=>{}}),pL=S.forwardRef((t,e)=>{const{value:n,onValueChange:i,...r}=t,s=Wn(i);return g.jsx(R7,{scope:t.__scopeMenu,value:n,onValueChange:s,children:g.jsx(Jk,{...r,ref:e})})});pL.displayName=fL;var mL="MenuRadioItem",gL=S.forwardRef((t,e)=>{const{value:n,...i}=t,r=N7(mL,t.__scopeMenu),s=n===r.value;return g.jsx(vL,{scope:t.__scopeMenu,checked:s,children:g.jsx(Py,{role:"menuitemradio","aria-checked":s,...i,ref:e,"data-state":Qk(s),onSelect:fe(i.onSelect,()=>{var o;return(o=r.onValueChange)==null?void 0:o.call(r,n)},{checkForDefaultPrevented:!1})})})});gL.displayName=mL;var Zk="MenuItemIndicator",[vL,M7]=au(Zk,{checked:!1}),yL=S.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:i,...r}=t,s=M7(Zk,n);return g.jsx(jo,{present:i||hv(s.checked)||s.checked===!0,children:g.jsx(Fe.span,{...r,ref:e,"data-state":Qk(s.checked)})})});yL.displayName=Zk;var O7="MenuSeparator",wL=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return g.jsx(Fe.div,{role:"separator","aria-orientation":"horizontal",...i,ref:e})});wL.displayName=O7;var I7="MenuArrow",bL=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t,r=Ay(n);return g.jsx(Wk,{...r,...i,ref:e})});bL.displayName=I7;var D7="MenuSub",[Yse,xL]=au(D7),Xd="MenuSubTrigger",SL=S.forwardRef((t,e)=>{const n=lu(Xd,t.__scopeMenu),i=ip(Xd,t.__scopeMenu),r=xL(Xd,t.__scopeMenu),s=qk(Xd,t.__scopeMenu),o=S.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=s,u={__scopeMenu:t.__scopeMenu},c=S.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return S.useEffect(()=>c,[c]),S.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),g.jsx(Kk,{asChild:!0,...u,children:g.jsx(dL,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":CL(n.open),...t,ref:py(e,r.onTriggerChange),onClick:d=>{var h;(h=t.onClick)==null||h.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:fe(t.onPointerMove,df(d=>{s.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(s.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),c()},100))})),onPointerLeave:fe(t.onPointerLeave,df(d=>{var f,p;c();const h=(f=n.content)==null?void 0:f.getBoundingClientRect();if(h){const m=(p=n.content)==null?void 0:p.dataset.side,w=m==="right",v=w?-5:5,y=h[w?"left":"right"],b=h[w?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+v,y:d.clientY},{x:y,y:h.top},{x:b,y:h.top},{x:b,y:h.bottom},{x:y,y:h.bottom}],side:m}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:fe(t.onKeyDown,d=>{var f;const h=s.searchRef.current!=="";t.disabled||h&&d.key===" "||g7[i.dir].includes(d.key)&&(n.onOpenChange(!0),(f=n.content)==null||f.focus(),d.preventDefault())})})})});SL.displayName=Xd;var kL="MenuSubContent",_L=S.forwardRef((t,e)=>{const n=aL(kr,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,s=lu(kr,t.__scopeMenu),o=ip(kr,t.__scopeMenu),a=xL(kL,t.__scopeMenu),l=S.useRef(null),u=rt(e,l);return g.jsx(cf.Provider,{scope:t.__scopeMenu,children:g.jsx(jo,{present:i||s.open,children:g.jsx(cf.Slot,{scope:t.__scopeMenu,children:g.jsx(Yk,{id:a.contentId,"aria-labelledby":a.triggerId,...r,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:c=>{var d;o.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),c.preventDefault()},onCloseAutoFocus:c=>c.preventDefault(),onFocusOutside:fe(t.onFocusOutside,c=>{c.target!==a.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:fe(t.onEscapeKeyDown,c=>{o.onClose(),c.preventDefault()}),onKeyDown:fe(t.onKeyDown,c=>{var f;const d=c.currentTarget.contains(c.target),h=v7[o.dir].includes(c.key);d&&h&&(s.onOpenChange(!1),(f=a.trigger)==null||f.focus(),c.preventDefault())})})})})})});_L.displayName=kL;function CL(t){return t?"open":"closed"}function hv(t){return t==="indeterminate"}function Qk(t){return hv(t)?"indeterminate":t?"checked":"unchecked"}function L7(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function j7(t,e){return t.map((n,i)=>t[(e+i)%t.length])}function F7(t,e,n){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=j7(t,Math.max(s,0));r.length===1&&(o=o.filter(u=>u!==n));const l=o.find(u=>u.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function B7(t,e){const{x:n,y:i}=t;let r=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s].x,l=e[s].y,u=e[o].x,c=e[o].y;l>i!=c>i&&n<(u-a)*(i-l)/(c-l)+a&&(r=!r)}return r}function $7(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return B7(n,e)}function df(t){return e=>e.pointerType==="mouse"?t(e):void 0}var z7=oL,U7=Kk,V7=lL,H7=uL,W7=Jk,G7=cL,K7=Py,X7=hL,q7=pL,Y7=gL,J7=yL,Z7=wL,Q7=bL,eG=SL,tG=_L,e_="DropdownMenu",[nG,Jse]=ls(e_,[rL]),ui=rL(),[iG,EL]=nG(e_),AL=t=>{const{__scopeDropdownMenu:e,children:n,dir:i,open:r,defaultOpen:s,onOpenChange:o,modal:a=!0}=t,l=ui(e),u=S.useRef(null),[c=!1,d]=Po({prop:r,defaultProp:s,onChange:o});return g.jsx(iG,{scope:e,triggerId:ja(),triggerRef:u,contentId:ja(),open:c,onOpenChange:d,onOpenToggle:S.useCallback(()=>d(h=>!h),[d]),modal:a,children:g.jsx(z7,{...l,open:c,onOpenChange:d,dir:i,modal:a,children:n})})};AL.displayName=e_;var PL="DropdownMenuTrigger",TL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...r}=t,s=EL(PL,n),o=ui(n);return g.jsx(U7,{asChild:!0,...o,children:g.jsx(Fe.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...r,ref:py(e,s.triggerRef),onPointerDown:fe(t.onPointerDown,a=>{!i&&a.button===0&&a.ctrlKey===!1&&(s.onOpenToggle(),s.open||a.preventDefault())}),onKeyDown:fe(t.onKeyDown,a=>{i||(["Enter"," "].includes(a.key)&&s.onOpenToggle(),a.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});TL.displayName=PL;var rG="DropdownMenuPortal",RL=t=>{const{__scopeDropdownMenu:e,...n}=t,i=ui(e);return g.jsx(V7,{...i,...n})};RL.displayName=rG;var NL="DropdownMenuContent",ML=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=EL(NL,n),s=ui(n),o=S.useRef(!1);return g.jsx(H7,{id:r.contentId,"aria-labelledby":r.triggerId,...s,...i,ref:e,onCloseAutoFocus:fe(t.onCloseAutoFocus,a=>{var l;o.current||(l=r.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:fe(t.onInteractOutside,a=>{const l=a.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,c=l.button===2||u;(!r.modal||c)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});ML.displayName=NL;var sG="DropdownMenuGroup",oG=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(W7,{...r,...i,ref:e})});oG.displayName=sG;var aG="DropdownMenuLabel",OL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(G7,{...r,...i,ref:e})});OL.displayName=aG;var lG="DropdownMenuItem",IL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(K7,{...r,...i,ref:e})});IL.displayName=lG;var uG="DropdownMenuCheckboxItem",DL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(X7,{...r,...i,ref:e})});DL.displayName=uG;var cG="DropdownMenuRadioGroup",dG=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(q7,{...r,...i,ref:e})});dG.displayName=cG;var hG="DropdownMenuRadioItem",LL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(Y7,{...r,...i,ref:e})});LL.displayName=hG;var fG="DropdownMenuItemIndicator",jL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(J7,{...r,...i,ref:e})});jL.displayName=fG;var pG="DropdownMenuSeparator",FL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(Z7,{...r,...i,ref:e})});FL.displayName=pG;var mG="DropdownMenuArrow",gG=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(Q7,{...r,...i,ref:e})});gG.displayName=mG;var vG="DropdownMenuSubTrigger",BL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(eG,{...r,...i,ref:e})});BL.displayName=vG;var yG="DropdownMenuSubContent",$L=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(tG,{...r,...i,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});$L.displayName=yG;var wG=AL,bG=TL,xG=RL,zL=ML,UL=OL,VL=IL,HL=DL,WL=LL,GL=jL,KL=FL,XL=BL,qL=$L;const YL=wG,JL=bG,SG=S.forwardRef(({className:t,inset:e,children:n,...i},r)=>g.jsxs(XL,{ref:r,className:ze("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-mantis-500 data-[state=open]:bg-mantis-500",e&&"pl-8",t),...i,children:[n,g.jsx("span",{className:"icon-[lucide--chevron-right] ml-auto block h-4 w-4"})]}));SG.displayName=XL.displayName;const kG=S.forwardRef(({className:t,...e},n)=>g.jsx(qL,{ref:n,className:ze("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-stone-900 p-1 text-white shadow-lg transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...e}));kG.displayName=qL.displayName;const t_=S.forwardRef(({className:t,sideOffset:e=4,...n},i)=>g.jsx(xG,{children:g.jsx(zL,{ref:i,sideOffset:e,className:ze("z-50 min-w-[8rem] overflow-hidden rounded-md border border-stone-600 bg-stone-900 p-1 text-white shadow-md transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...n})}));t_.displayName=zL.displayName;const Fl=S.forwardRef(({className:t,inset:e,...n},i)=>g.jsx(VL,{ref:i,className:ze("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",t),...n}));Fl.displayName=VL.displayName;const _G=S.forwardRef(({className:t,children:e,checked:n,...i},r)=>g.jsxs(HL,{ref:r,className:ze("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...i,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(GL,{children:g.jsx("span",{className:"icon-[lucide--check] h-4 w-4"})})}),e]}));_G.displayName=HL.displayName;const CG=S.forwardRef(({className:t,children:e,...n},i)=>g.jsxs(WL,{ref:i,className:ze("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(GL,{children:g.jsx("span",{className:"icon-[lucide--circle-dot] block h-4 w-4"})})}),e]}));CG.displayName=WL.displayName;const EG=S.forwardRef(({className:t,inset:e,...n},i)=>g.jsx(UL,{ref:i,className:ze("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));EG.displayName=UL.displayName;const AG=S.forwardRef(({className:t,...e},n)=>g.jsx(KL,{ref:n,className:ze("-mx-1 my-1 h-px bg-stone-600",t),...e}));AG.displayName=KL.displayName;function ZL(t,e){const n=e.split(".");let i=t;for(const r of n)if(r in i)i=i[r];else throw new ReferenceError(`Couldn't find path "${e}".`);return i}const QL=["en","es"];function n_(t){return function(n,i,...r){const s=ZL(t[n],i);if(typeof s=="function")return s(...r);if(typeof s=="string")return s;throw new Error(`Missing translation for key ${i}`)}}const ee=vk();function PG(t){return g.jsx($6,{store:ee,children:t.children})}var nt;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function n(r){throw new Error}t.assertNever=n,t.arrayToEnum=r=>{const s={};for(const o of r)s[o]=o;return s},t.getValidEnumValues=r=>{const s=t.objectKeys(r).filter(a=>typeof r[r[a]]!="number"),o={};for(const a of s)o[a]=r[a];return t.objectValues(o)},t.objectValues=r=>t.objectKeys(r).map(function(s){return r[s]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const s=[];for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&s.push(o);return s},t.find=(r,s)=>{for(const o of r)if(s(o))return o},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function i(r,s=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}t.joinValues=i,t.jsonStringifyReplacer=(r,s)=>typeof s=="bigint"?s.toString():s})(nt||(nt={}));var y1;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(y1||(y1={}));const we=nt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),sa=t=>{switch(typeof t){case"undefined":return we.undefined;case"string":return we.string;case"number":return isNaN(t)?we.nan:we.number;case"boolean":return we.boolean;case"function":return we.function;case"bigint":return we.bigint;case"symbol":return we.symbol;case"object":return Array.isArray(t)?we.array:t===null?we.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?we.promise:typeof Map<"u"&&t instanceof Map?we.map:typeof Set<"u"&&t instanceof Set?we.set:typeof Date<"u"&&t instanceof Date?we.date:we.object;default:return we.unknown}},ae=nt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),TG=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Xi extends Error{constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(s){return s.message},i={_errors:[]},r=s=>{for(const o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)i._errors.push(n(o));else{let a=i,l=0;for(;l<o.path.length;){const u=o.path[l];l===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(n(o))):a[u]=a[u]||{_errors:[]},a=a[u],l++}}};return r(this),i}static assert(e){if(!(e instanceof Xi))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,nt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},i=[];for(const r of this.issues)r.path.length>0?(n[r.path[0]]=n[r.path[0]]||[],n[r.path[0]].push(e(r))):i.push(e(r));return{formErrors:i,fieldErrors:n}}get formErrors(){return this.flatten()}}Xi.create=t=>new Xi(t);const jc=(t,e)=>{let n;switch(t.code){case ae.invalid_type:t.received===we.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ae.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,nt.jsonStringifyReplacer)}`;break;case ae.unrecognized_keys:n=`Unrecognized key(s) in object: ${nt.joinValues(t.keys,", ")}`;break;case ae.invalid_union:n="Invalid input";break;case ae.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${nt.joinValues(t.options)}`;break;case ae.invalid_enum_value:n=`Invalid enum value. Expected ${nt.joinValues(t.options)}, received '${t.received}'`;break;case ae.invalid_arguments:n="Invalid function arguments";break;case ae.invalid_return_type:n="Invalid function return type";break;case ae.invalid_date:n="Invalid date";break;case ae.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:nt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ae.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ae.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ae.custom:n="Invalid input";break;case ae.invalid_intersection_types:n="Intersection results could not be merged";break;case ae.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ae.not_finite:n="Number must be finite";break;default:n=e.defaultError,nt.assertNever(t)}return{message:n}};let ej=jc;function RG(t){ej=t}function fv(){return ej}const pv=t=>{const{data:e,path:n,errorMaps:i,issueData:r}=t,s=[...n,...r.path||[]],o={...r,path:s};if(r.message!==void 0)return{...r,path:s,message:r.message};let a="";const l=i.filter(u=>!!u).slice().reverse();for(const u of l)a=u(o,{data:e,defaultError:a}).message;return{...r,path:s,message:a}},NG=[];function me(t,e){const n=fv(),i=pv({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===jc?void 0:jc].filter(r=>!!r)});t.common.issues.push(i)}class Gn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const i=[];for(const r of n){if(r.status==="aborted")return je;r.status==="dirty"&&e.dirty(),i.push(r.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,n){const i=[];for(const r of n){const s=await r.key,o=await r.value;i.push({key:s,value:o})}return Gn.mergeObjectSync(e,i)}static mergeObjectSync(e,n){const i={};for(const r of n){const{key:s,value:o}=r;if(s.status==="aborted"||o.status==="aborted")return je;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(i[s.value]=o.value)}return{status:e.value,value:i}}}const je=Object.freeze({status:"aborted"}),Wu=t=>({status:"dirty",value:t}),si=t=>({status:"valid",value:t}),w1=t=>t.status==="aborted",b1=t=>t.status==="dirty",hf=t=>t.status==="valid",ff=t=>typeof Promise<"u"&&t instanceof Promise;function mv(t,e,n,i){if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function tj(t,e,n,i,r){if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var Te;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Te||(Te={}));var qd,Yd;class $s{constructor(e,n,i,r){this._cachedPath=[],this.parent=e,this.data=n,this._path=i,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const gT=(t,e)=>{if(hf(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Xi(t.common.issues);return this._error=n,this._error}}};function Ve(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:i,description:r}=t;if(e&&(n||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,a)=>{var l,u;const{message:c}=t;return o.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:(l=c??i)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(u=c??n)!==null&&u!==void 0?u:a.defaultError}},description:r}}class Ke{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return sa(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:sa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Gn,ctx:{common:e.parent.common,data:e.data,parsedType:sa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(ff(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const i=this.safeParse(e,n);if(i.success)return i.data;throw i.error}safeParse(e,n){var i;const r={common:{issues:[],async:(i=n==null?void 0:n.async)!==null&&i!==void 0?i:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:sa(e)},s=this._parseSync({data:e,path:r.path,parent:r});return gT(r,s)}async parseAsync(e,n){const i=await this.safeParseAsync(e,n);if(i.success)return i.data;throw i.error}async safeParseAsync(e,n){const i={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:sa(e)},r=this._parse({data:e,path:i.path,parent:i}),s=await(ff(r)?r:Promise.resolve(r));return gT(i,s)}refine(e,n){const i=r=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(r):n;return this._refinement((r,s)=>{const o=e(r),a=()=>s.addIssue({code:ae.custom,...i(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((i,r)=>e(i)?!0:(r.addIssue(typeof n=="function"?n(i,r):n),!1))}_refinement(e){return new ss({schema:this,typeName:Le.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return js.create(this,this._def)}nullable(){return Xa.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Qr.create(this,this._def)}promise(){return Bc.create(this,this._def)}or(e){return vf.create([this,e],this._def)}and(e){return yf.create(this,e,this._def)}transform(e){return new ss({...Ve(this._def),schema:this,typeName:Le.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new kf({...Ve(this._def),innerType:this,defaultValue:n,typeName:Le.ZodDefault})}brand(){return new i_({typeName:Le.ZodBranded,type:this,...Ve(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new _f({...Ve(this._def),innerType:this,catchValue:n,typeName:Le.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return rp.create(this,e)}readonly(){return Cf.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const MG=/^c[^\s-]{8,}$/i,OG=/^[0-9a-z]+$/,IG=/^[0-9A-HJKMNP-TV-Z]{26}$/,DG=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,LG=/^[a-z0-9_-]{21}$/i,jG=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,FG=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,BG="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let yw;const $G=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,zG=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,UG=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nj="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",VG=new RegExp(`^${nj}$`);function ij(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function HG(t){return new RegExp(`^${ij(t)}$`)}function rj(t){let e=`${nj}T${ij(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function WG(t,e){return!!((e==="v4"||!e)&&$G.test(t)||(e==="v6"||!e)&&zG.test(t))}class Kr extends Ke{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==we.string){const s=this._getOrReturnCtx(e);return me(s,{code:ae.invalid_type,expected:we.string,received:s.parsedType}),je}const i=new Gn;let r;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:ae.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="max")e.data.length>s.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:ae.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="length"){const o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(r=this._getOrReturnCtx(e,r),o?me(r,{code:ae.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&me(r,{code:ae.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),i.dirty())}else if(s.kind==="email")FG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"email",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="emoji")yw||(yw=new RegExp(BG,"u")),yw.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"emoji",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="uuid")DG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"uuid",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="nanoid")LG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"nanoid",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid")MG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"cuid",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid2")OG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"cuid2",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="ulid")IG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"ulid",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),me(r,{validation:"url",code:ae.invalid_string,message:s.message}),i.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"regex",code:ae.invalid_string,message:s.message}),i.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),i.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:{startsWith:s.value},message:s.message}),i.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:{endsWith:s.value},message:s.message}),i.dirty()):s.kind==="datetime"?rj(s).test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:"datetime",message:s.message}),i.dirty()):s.kind==="date"?VG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:"date",message:s.message}),i.dirty()):s.kind==="time"?HG(s).test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:"time",message:s.message}),i.dirty()):s.kind==="duration"?jG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"duration",code:ae.invalid_string,message:s.message}),i.dirty()):s.kind==="ip"?WG(e.data,s.version)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"ip",code:ae.invalid_string,message:s.message}),i.dirty()):s.kind==="base64"?UG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"base64",code:ae.invalid_string,message:s.message}),i.dirty()):nt.assertNever(s);return{status:i.value,value:e.data}}_regex(e,n,i){return this.refinement(r=>e.test(r),{validation:n,code:ae.invalid_string,...Te.errToObj(i)})}_addCheck(e){return new Kr({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Te.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Te.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Te.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Te.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Te.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Te.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Te.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Te.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Te.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Te.errToObj(e)})}datetime(e){var n,i;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,local:(i=e==null?void 0:e.local)!==null&&i!==void 0?i:!1,...Te.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Te.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Te.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Te.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Te.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Te.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Te.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Te.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Te.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Te.errToObj(n)})}nonempty(e){return this.min(1,Te.errToObj(e))}trim(){return new Kr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Kr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Kr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Kr.create=t=>{var e;return new Kr({checks:[],typeName:Le.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ve(t)})};function GG(t,e){const n=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,r=n>i?n:i,s=parseInt(t.toFixed(r).replace(".","")),o=parseInt(e.toFixed(r).replace(".",""));return s%o/Math.pow(10,r)}class Wa extends Ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==we.number){const s=this._getOrReturnCtx(e);return me(s,{code:ae.invalid_type,expected:we.number,received:s.parsedType}),je}let i;const r=new Gn;for(const s of this._def.checks)s.kind==="int"?nt.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),me(i,{code:ae.invalid_type,expected:"integer",received:"float",message:s.message}),r.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):s.kind==="multipleOf"?GG(e.data,s.value)!==0&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),me(i,{code:ae.not_finite,message:s.message}),r.dirty()):nt.assertNever(s);return{status:r.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Te.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Te.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Te.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Te.toString(n))}setLimit(e,n,i,r){return new Wa({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:Te.toString(r)}]})}_addCheck(e){return new Wa({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Te.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Te.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Te.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Te.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Te.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Te.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Te.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Te.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Te.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&nt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(n===null||i.value>n)&&(n=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Wa.create=t=>new Wa({checks:[],typeName:Le.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ve(t)});class Ga extends Ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==we.bigint){const s=this._getOrReturnCtx(e);return me(s,{code:ae.invalid_type,expected:we.bigint,received:s.parsedType}),je}let i;const r=new Gn;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):nt.assertNever(s);return{status:r.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Te.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Te.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Te.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Te.toString(n))}setLimit(e,n,i,r){return new Ga({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:Te.toString(r)}]})}_addCheck(e){return new Ga({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Te.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Te.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Te.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Te.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Te.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ga.create=t=>{var e;return new Ga({checks:[],typeName:Le.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ve(t)})};class pf extends Ke{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==we.boolean){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.boolean,received:i.parsedType}),je}return si(e.data)}}pf.create=t=>new pf({typeName:Le.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ve(t)});class eu extends Ke{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==we.date){const s=this._getOrReturnCtx(e);return me(s,{code:ae.invalid_type,expected:we.date,received:s.parsedType}),je}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return me(s,{code:ae.invalid_date}),je}const i=new Gn;let r;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:ae.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),i.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:ae.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),i.dirty()):nt.assertNever(s);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new eu({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Te.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Te.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}eu.create=t=>new eu({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Le.ZodDate,...Ve(t)});class gv extends Ke{_parse(e){if(this._getType(e)!==we.symbol){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.symbol,received:i.parsedType}),je}return si(e.data)}}gv.create=t=>new gv({typeName:Le.ZodSymbol,...Ve(t)});class mf extends Ke{_parse(e){if(this._getType(e)!==we.undefined){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.undefined,received:i.parsedType}),je}return si(e.data)}}mf.create=t=>new mf({typeName:Le.ZodUndefined,...Ve(t)});class gf extends Ke{_parse(e){if(this._getType(e)!==we.null){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.null,received:i.parsedType}),je}return si(e.data)}}gf.create=t=>new gf({typeName:Le.ZodNull,...Ve(t)});class Fc extends Ke{constructor(){super(...arguments),this._any=!0}_parse(e){return si(e.data)}}Fc.create=t=>new Fc({typeName:Le.ZodAny,...Ve(t)});class Bl extends Ke{constructor(){super(...arguments),this._unknown=!0}_parse(e){return si(e.data)}}Bl.create=t=>new Bl({typeName:Le.ZodUnknown,...Ve(t)});class Oo extends Ke{_parse(e){const n=this._getOrReturnCtx(e);return me(n,{code:ae.invalid_type,expected:we.never,received:n.parsedType}),je}}Oo.create=t=>new Oo({typeName:Le.ZodNever,...Ve(t)});class vv extends Ke{_parse(e){if(this._getType(e)!==we.undefined){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.void,received:i.parsedType}),je}return si(e.data)}}vv.create=t=>new vv({typeName:Le.ZodVoid,...Ve(t)});class Qr extends Ke{_parse(e){const{ctx:n,status:i}=this._processInputParams(e),r=this._def;if(n.parsedType!==we.array)return me(n,{code:ae.invalid_type,expected:we.array,received:n.parsedType}),je;if(r.exactLength!==null){const o=n.data.length>r.exactLength.value,a=n.data.length<r.exactLength.value;(o||a)&&(me(n,{code:o?ae.too_big:ae.too_small,minimum:a?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),i.dirty())}if(r.minLength!==null&&n.data.length<r.minLength.value&&(me(n,{code:ae.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),i.dirty()),r.maxLength!==null&&n.data.length>r.maxLength.value&&(me(n,{code:ae.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),i.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>r.type._parseAsync(new $s(n,o,n.path,a)))).then(o=>Gn.mergeArray(i,o));const s=[...n.data].map((o,a)=>r.type._parseSync(new $s(n,o,n.path,a)));return Gn.mergeArray(i,s)}get element(){return this._def.type}min(e,n){return new Qr({...this._def,minLength:{value:e,message:Te.toString(n)}})}max(e,n){return new Qr({...this._def,maxLength:{value:e,message:Te.toString(n)}})}length(e,n){return new Qr({...this._def,exactLength:{value:e,message:Te.toString(n)}})}nonempty(e){return this.min(1,e)}}Qr.create=(t,e)=>new Qr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Le.ZodArray,...Ve(e)});function ku(t){if(t instanceof Lt){const e={};for(const n in t.shape){const i=t.shape[n];e[n]=js.create(ku(i))}return new Lt({...t._def,shape:()=>e})}else return t instanceof Qr?new Qr({...t._def,type:ku(t.element)}):t instanceof js?js.create(ku(t.unwrap())):t instanceof Xa?Xa.create(ku(t.unwrap())):t instanceof zs?zs.create(t.items.map(e=>ku(e))):t}class Lt extends Ke{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=nt.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==we.object){const u=this._getOrReturnCtx(e);return me(u,{code:ae.invalid_type,expected:we.object,received:u.parsedType}),je}const{status:i,ctx:r}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Oo&&this._def.unknownKeys==="strip"))for(const u in r.data)o.includes(u)||a.push(u);const l=[];for(const u of o){const c=s[u],d=r.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new $s(r,d,r.path,u)),alwaysSet:u in r.data})}if(this._def.catchall instanceof Oo){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of a)l.push({key:{status:"valid",value:c},value:{status:"valid",value:r.data[c]}});else if(u==="strict")a.length>0&&(me(r,{code:ae.unrecognized_keys,keys:a}),i.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of a){const d=r.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new $s(r,d,r.path,c)),alwaysSet:c in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const d=await c.key,h=await c.value;u.push({key:d,value:h,alwaysSet:c.alwaysSet})}return u}).then(u=>Gn.mergeObjectSync(i,u)):Gn.mergeObjectSync(i,l)}get shape(){return this._def.shape()}strict(e){return Te.errToObj,new Lt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,i)=>{var r,s,o,a;const l=(o=(s=(r=this._def).errorMap)===null||s===void 0?void 0:s.call(r,n,i).message)!==null&&o!==void 0?o:i.defaultError;return n.code==="unrecognized_keys"?{message:(a=Te.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new Lt({...this._def,unknownKeys:"strip"})}passthrough(){return new Lt({...this._def,unknownKeys:"passthrough"})}extend(e){return new Lt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Lt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Le.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Lt({...this._def,catchall:e})}pick(e){const n={};return nt.objectKeys(e).forEach(i=>{e[i]&&this.shape[i]&&(n[i]=this.shape[i])}),new Lt({...this._def,shape:()=>n})}omit(e){const n={};return nt.objectKeys(this.shape).forEach(i=>{e[i]||(n[i]=this.shape[i])}),new Lt({...this._def,shape:()=>n})}deepPartial(){return ku(this)}partial(e){const n={};return nt.objectKeys(this.shape).forEach(i=>{const r=this.shape[i];e&&!e[i]?n[i]=r:n[i]=r.optional()}),new Lt({...this._def,shape:()=>n})}required(e){const n={};return nt.objectKeys(this.shape).forEach(i=>{if(e&&!e[i])n[i]=this.shape[i];else{let s=this.shape[i];for(;s instanceof js;)s=s._def.innerType;n[i]=s}}),new Lt({...this._def,shape:()=>n})}keyof(){return sj(nt.objectKeys(this.shape))}}Lt.create=(t,e)=>new Lt({shape:()=>t,unknownKeys:"strip",catchall:Oo.create(),typeName:Le.ZodObject,...Ve(e)});Lt.strictCreate=(t,e)=>new Lt({shape:()=>t,unknownKeys:"strict",catchall:Oo.create(),typeName:Le.ZodObject,...Ve(e)});Lt.lazycreate=(t,e)=>new Lt({shape:t,unknownKeys:"strip",catchall:Oo.create(),typeName:Le.ZodObject,...Ve(e)});class vf extends Ke{_parse(e){const{ctx:n}=this._processInputParams(e),i=this._def.options;function r(s){for(const a of s)if(a.result.status==="valid")return a.result;for(const a of s)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(a=>new Xi(a.ctx.common.issues));return me(n,{code:ae.invalid_union,unionErrors:o}),je}if(n.common.async)return Promise.all(i.map(async s=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(r);{let s;const o=[];for(const l of i){const u={...n,common:{...n.common,issues:[]},parent:null},c=l._parseSync({data:n.data,path:n.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!s&&(s={result:c,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const a=o.map(l=>new Xi(l));return me(n,{code:ae.invalid_union,unionErrors:a}),je}}get options(){return this._def.options}}vf.create=(t,e)=>new vf({options:t,typeName:Le.ZodUnion,...Ve(e)});const Xs=t=>t instanceof bf?Xs(t.schema):t instanceof ss?Xs(t.innerType()):t instanceof xf?[t.value]:t instanceof Ka?t.options:t instanceof Sf?nt.objectValues(t.enum):t instanceof kf?Xs(t._def.innerType):t instanceof mf?[void 0]:t instanceof gf?[null]:t instanceof js?[void 0,...Xs(t.unwrap())]:t instanceof Xa?[null,...Xs(t.unwrap())]:t instanceof i_||t instanceof Cf?Xs(t.unwrap()):t instanceof _f?Xs(t._def.innerType):[];class Ty extends Ke{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==we.object)return me(n,{code:ae.invalid_type,expected:we.object,received:n.parsedType}),je;const i=this.discriminator,r=n.data[i],s=this.optionsMap.get(r);return s?n.common.async?s._parseAsync({data:n.data,path:n.path,parent:n}):s._parseSync({data:n.data,path:n.path,parent:n}):(me(n,{code:ae.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),je)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,i){const r=new Map;for(const s of n){const o=Xs(s.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(r.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);r.set(a,s)}}return new Ty({typeName:Le.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:r,...Ve(i)})}}function x1(t,e){const n=sa(t),i=sa(e);if(t===e)return{valid:!0,data:t};if(n===we.object&&i===we.object){const r=nt.objectKeys(e),s=nt.objectKeys(t).filter(a=>r.indexOf(a)!==-1),o={...t,...e};for(const a of s){const l=x1(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(n===we.array&&i===we.array){if(t.length!==e.length)return{valid:!1};const r=[];for(let s=0;s<t.length;s++){const o=t[s],a=e[s],l=x1(o,a);if(!l.valid)return{valid:!1};r.push(l.data)}return{valid:!0,data:r}}else return n===we.date&&i===we.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class yf extends Ke{_parse(e){const{status:n,ctx:i}=this._processInputParams(e),r=(s,o)=>{if(w1(s)||w1(o))return je;const a=x1(s.value,o.value);return a.valid?((b1(s)||b1(o))&&n.dirty(),{status:n.value,value:a.data}):(me(i,{code:ae.invalid_intersection_types}),je)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([s,o])=>r(s,o)):r(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}yf.create=(t,e,n)=>new yf({left:t,right:e,typeName:Le.ZodIntersection,...Ve(n)});class zs extends Ke{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==we.array)return me(i,{code:ae.invalid_type,expected:we.array,received:i.parsedType}),je;if(i.data.length<this._def.items.length)return me(i,{code:ae.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),je;!this._def.rest&&i.data.length>this._def.items.length&&(me(i,{code:ae.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...i.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new $s(i,o,i.path,a)):null}).filter(o=>!!o);return i.common.async?Promise.all(s).then(o=>Gn.mergeArray(n,o)):Gn.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new zs({...this._def,rest:e})}}zs.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new zs({items:t,typeName:Le.ZodTuple,rest:null,...Ve(e)})};class wf extends Ke{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==we.object)return me(i,{code:ae.invalid_type,expected:we.object,received:i.parsedType}),je;const r=[],s=this._def.keyType,o=this._def.valueType;for(const a in i.data)r.push({key:s._parse(new $s(i,a,i.path,a)),value:o._parse(new $s(i,i.data[a],i.path,a)),alwaysSet:a in i.data});return i.common.async?Gn.mergeObjectAsync(n,r):Gn.mergeObjectSync(n,r)}get element(){return this._def.valueType}static create(e,n,i){return n instanceof Ke?new wf({keyType:e,valueType:n,typeName:Le.ZodRecord,...Ve(i)}):new wf({keyType:Kr.create(),valueType:e,typeName:Le.ZodRecord,...Ve(n)})}}class yv extends Ke{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==we.map)return me(i,{code:ae.invalid_type,expected:we.map,received:i.parsedType}),je;const r=this._def.keyType,s=this._def.valueType,o=[...i.data.entries()].map(([a,l],u)=>({key:r._parse(new $s(i,a,i.path,[u,"key"])),value:s._parse(new $s(i,l,i.path,[u,"value"]))}));if(i.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return je;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),a.set(u.value,c.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const l of o){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return je;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),a.set(u.value,c.value)}return{status:n.value,value:a}}}}yv.create=(t,e,n)=>new yv({valueType:e,keyType:t,typeName:Le.ZodMap,...Ve(n)});class tu extends Ke{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==we.set)return me(i,{code:ae.invalid_type,expected:we.set,received:i.parsedType}),je;const r=this._def;r.minSize!==null&&i.data.size<r.minSize.value&&(me(i,{code:ae.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),n.dirty()),r.maxSize!==null&&i.data.size>r.maxSize.value&&(me(i,{code:ae.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),n.dirty());const s=this._def.valueType;function o(l){const u=new Set;for(const c of l){if(c.status==="aborted")return je;c.status==="dirty"&&n.dirty(),u.add(c.value)}return{status:n.value,value:u}}const a=[...i.data.values()].map((l,u)=>s._parse(new $s(i,l,i.path,u)));return i.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,n){return new tu({...this._def,minSize:{value:e,message:Te.toString(n)}})}max(e,n){return new tu({...this._def,maxSize:{value:e,message:Te.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}tu.create=(t,e)=>new tu({valueType:t,minSize:null,maxSize:null,typeName:Le.ZodSet,...Ve(e)});class dc extends Ke{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==we.function)return me(n,{code:ae.invalid_type,expected:we.function,received:n.parsedType}),je;function i(a,l){return pv({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,fv(),jc].filter(u=>!!u),issueData:{code:ae.invalid_arguments,argumentsError:l}})}function r(a,l){return pv({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,fv(),jc].filter(u=>!!u),issueData:{code:ae.invalid_return_type,returnTypeError:l}})}const s={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof Bc){const a=this;return si(async function(...l){const u=new Xi([]),c=await a._def.args.parseAsync(l,s).catch(f=>{throw u.addIssue(i(l,f)),u}),d=await Reflect.apply(o,this,c);return await a._def.returns._def.type.parseAsync(d,s).catch(f=>{throw u.addIssue(r(d,f)),u})})}else{const a=this;return si(function(...l){const u=a._def.args.safeParse(l,s);if(!u.success)throw new Xi([i(l,u.error)]);const c=Reflect.apply(o,this,u.data),d=a._def.returns.safeParse(c,s);if(!d.success)throw new Xi([r(c,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new dc({...this._def,args:zs.create(e).rest(Bl.create())})}returns(e){return new dc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,i){return new dc({args:e||zs.create([]).rest(Bl.create()),returns:n||Bl.create(),typeName:Le.ZodFunction,...Ve(i)})}}class bf extends Ke{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}bf.create=(t,e)=>new bf({getter:t,typeName:Le.ZodLazy,...Ve(e)});class xf extends Ke{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return me(n,{received:n.data,code:ae.invalid_literal,expected:this._def.value}),je}return{status:"valid",value:e.data}}get value(){return this._def.value}}xf.create=(t,e)=>new xf({value:t,typeName:Le.ZodLiteral,...Ve(e)});function sj(t,e){return new Ka({values:t,typeName:Le.ZodEnum,...Ve(e)})}class Ka extends Ke{constructor(){super(...arguments),qd.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),i=this._def.values;return me(n,{expected:nt.joinValues(i),received:n.parsedType,code:ae.invalid_type}),je}if(mv(this,qd)||tj(this,qd,new Set(this._def.values)),!mv(this,qd).has(e.data)){const n=this._getOrReturnCtx(e),i=this._def.values;return me(n,{received:n.data,code:ae.invalid_enum_value,options:i}),je}return si(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Ka.create(e,{...this._def,...n})}exclude(e,n=this._def){return Ka.create(this.options.filter(i=>!e.includes(i)),{...this._def,...n})}}qd=new WeakMap;Ka.create=sj;class Sf extends Ke{constructor(){super(...arguments),Yd.set(this,void 0)}_parse(e){const n=nt.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==we.string&&i.parsedType!==we.number){const r=nt.objectValues(n);return me(i,{expected:nt.joinValues(r),received:i.parsedType,code:ae.invalid_type}),je}if(mv(this,Yd)||tj(this,Yd,new Set(nt.getValidEnumValues(this._def.values))),!mv(this,Yd).has(e.data)){const r=nt.objectValues(n);return me(i,{received:i.data,code:ae.invalid_enum_value,options:r}),je}return si(e.data)}get enum(){return this._def.values}}Yd=new WeakMap;Sf.create=(t,e)=>new Sf({values:t,typeName:Le.ZodNativeEnum,...Ve(e)});class Bc extends Ke{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==we.promise&&n.common.async===!1)return me(n,{code:ae.invalid_type,expected:we.promise,received:n.parsedType}),je;const i=n.parsedType===we.promise?n.data:Promise.resolve(n.data);return si(i.then(r=>this._def.type.parseAsync(r,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Bc.create=(t,e)=>new Bc({type:t,typeName:Le.ZodPromise,...Ve(e)});class ss extends Ke{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Le.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:i}=this._processInputParams(e),r=this._def.effect||null,s={addIssue:o=>{me(i,o),o.fatal?n.abort():n.dirty()},get path(){return i.path}};if(s.addIssue=s.addIssue.bind(s),r.type==="preprocess"){const o=r.transform(i.data,s);if(i.common.async)return Promise.resolve(o).then(async a=>{if(n.value==="aborted")return je;const l=await this._def.schema._parseAsync({data:a,path:i.path,parent:i});return l.status==="aborted"?je:l.status==="dirty"||n.value==="dirty"?Wu(l.value):l});{if(n.value==="aborted")return je;const a=this._def.schema._parseSync({data:o,path:i.path,parent:i});return a.status==="aborted"?je:a.status==="dirty"||n.value==="dirty"?Wu(a.value):a}}if(r.type==="refinement"){const o=a=>{const l=r.refinement(a,s);if(i.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(i.common.async===!1){const a=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return a.status==="aborted"?je:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(a=>a.status==="aborted"?je:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(r.type==="transform")if(i.common.async===!1){const o=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!hf(o))return o;const a=r.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(o=>hf(o)?Promise.resolve(r.transform(o.value,s)).then(a=>({status:n.value,value:a})):o);nt.assertNever(r)}}ss.create=(t,e,n)=>new ss({schema:t,typeName:Le.ZodEffects,effect:e,...Ve(n)});ss.createWithPreprocess=(t,e,n)=>new ss({schema:e,effect:{type:"preprocess",transform:t},typeName:Le.ZodEffects,...Ve(n)});class js extends Ke{_parse(e){return this._getType(e)===we.undefined?si(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}js.create=(t,e)=>new js({innerType:t,typeName:Le.ZodOptional,...Ve(e)});class Xa extends Ke{_parse(e){return this._getType(e)===we.null?si(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Xa.create=(t,e)=>new Xa({innerType:t,typeName:Le.ZodNullable,...Ve(e)});class kf extends Ke{_parse(e){const{ctx:n}=this._processInputParams(e);let i=n.data;return n.parsedType===we.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}kf.create=(t,e)=>new kf({innerType:t,typeName:Le.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ve(e)});class _f extends Ke{_parse(e){const{ctx:n}=this._processInputParams(e),i={...n,common:{...n.common,issues:[]}},r=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return ff(r)?r.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Xi(i.common.issues)},input:i.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Xi(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}_f.create=(t,e)=>new _f({innerType:t,typeName:Le.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ve(e)});class wv extends Ke{_parse(e){if(this._getType(e)!==we.nan){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.nan,received:i.parsedType}),je}return{status:"valid",value:e.data}}}wv.create=t=>new wv({typeName:Le.ZodNaN,...Ve(t)});const KG=Symbol("zod_brand");class i_ extends Ke{_parse(e){const{ctx:n}=this._processInputParams(e),i=n.data;return this._def.type._parse({data:i,path:n.path,parent:n})}unwrap(){return this._def.type}}class rp extends Ke{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return s.status==="aborted"?je:s.status==="dirty"?(n.dirty(),Wu(s.value)):this._def.out._parseAsync({data:s.value,path:i.path,parent:i})})();{const r=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return r.status==="aborted"?je:r.status==="dirty"?(n.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:i.path,parent:i})}}static create(e,n){return new rp({in:e,out:n,typeName:Le.ZodPipeline})}}class Cf extends Ke{_parse(e){const n=this._def.innerType._parse(e),i=r=>(hf(r)&&(r.value=Object.freeze(r.value)),r);return ff(n)?n.then(r=>i(r)):i(n)}unwrap(){return this._def.innerType}}Cf.create=(t,e)=>new Cf({innerType:t,typeName:Le.ZodReadonly,...Ve(e)});function oj(t,e={},n){return t?Fc.create().superRefine((i,r)=>{var s,o;if(!t(i)){const a=typeof e=="function"?e(i):typeof e=="string"?{message:e}:e,l=(o=(s=a.fatal)!==null&&s!==void 0?s:n)!==null&&o!==void 0?o:!0,u=typeof a=="string"?{message:a}:a;r.addIssue({code:"custom",...u,fatal:l})}}):Fc.create()}const XG={object:Lt.lazycreate};var Le;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Le||(Le={}));const qG=(t,e={message:`Input not instance of ${t.name}`})=>oj(n=>n instanceof t,e),aj=Kr.create,lj=Wa.create,YG=wv.create,JG=Ga.create,uj=pf.create,ZG=eu.create,QG=gv.create,eK=mf.create,tK=gf.create,nK=Fc.create,iK=Bl.create,rK=Oo.create,sK=vv.create,oK=Qr.create,aK=Lt.create,lK=Lt.strictCreate,uK=vf.create,cK=Ty.create,dK=yf.create,hK=zs.create,fK=wf.create,pK=yv.create,mK=tu.create,gK=dc.create,vK=bf.create,yK=xf.create,wK=Ka.create,bK=Sf.create,xK=Bc.create,vT=ss.create,SK=js.create,kK=Xa.create,_K=ss.createWithPreprocess,CK=rp.create,EK=()=>aj().optional(),AK=()=>lj().optional(),PK=()=>uj().optional(),TK={string:t=>Kr.create({...t,coerce:!0}),number:t=>Wa.create({...t,coerce:!0}),boolean:t=>pf.create({...t,coerce:!0}),bigint:t=>Ga.create({...t,coerce:!0}),date:t=>eu.create({...t,coerce:!0})},RK=je;var Ni=Object.freeze({__proto__:null,defaultErrorMap:jc,setErrorMap:RG,getErrorMap:fv,makeIssue:pv,EMPTY_PATH:NG,addIssueToContext:me,ParseStatus:Gn,INVALID:je,DIRTY:Wu,OK:si,isAborted:w1,isDirty:b1,isValid:hf,isAsync:ff,get util(){return nt},get objectUtil(){return y1},ZodParsedType:we,getParsedType:sa,ZodType:Ke,datetimeRegex:rj,ZodString:Kr,ZodNumber:Wa,ZodBigInt:Ga,ZodBoolean:pf,ZodDate:eu,ZodSymbol:gv,ZodUndefined:mf,ZodNull:gf,ZodAny:Fc,ZodUnknown:Bl,ZodNever:Oo,ZodVoid:vv,ZodArray:Qr,ZodObject:Lt,ZodUnion:vf,ZodDiscriminatedUnion:Ty,ZodIntersection:yf,ZodTuple:zs,ZodRecord:wf,ZodMap:yv,ZodSet:tu,ZodFunction:dc,ZodLazy:bf,ZodLiteral:xf,ZodEnum:Ka,ZodNativeEnum:Sf,ZodPromise:Bc,ZodEffects:ss,ZodTransformer:ss,ZodOptional:js,ZodNullable:Xa,ZodDefault:kf,ZodCatch:_f,ZodNaN:wv,BRAND:KG,ZodBranded:i_,ZodPipeline:rp,ZodReadonly:Cf,custom:oj,Schema:Ke,ZodSchema:Ke,late:XG,get ZodFirstPartyTypeKind(){return Le},coerce:TK,any:nK,array:oK,bigint:JG,boolean:uj,date:ZG,discriminatedUnion:cK,effect:vT,enum:wK,function:gK,instanceof:qG,intersection:dK,lazy:vK,literal:yK,map:pK,nan:YG,nativeEnum:bK,never:rK,null:tK,nullable:kK,number:lj,object:aK,oboolean:PK,onumber:AK,optional:SK,ostring:EK,pipeline:CK,preprocess:_K,promise:xK,record:fK,set:mK,strictObject:lK,string:aj,symbol:QG,transformer:vT,tuple:hK,undefined:eK,union:uK,unknown:iK,void:sK,NEVER:RK,ZodIssueCode:ae,quotelessJson:TG,ZodError:Xi});const cj=["randomize","clean","unchanged"],dj=["no-devices","keyboard-and-screen","pio-switches-and-leds","pio-printer","handshake"],S1=Ni.object({language:Ni.enum(QL).catch(NK),editorFontSize:Ni.number().int().min(8).max(64).catch(14),dataOnLoad:Ni.enum(cj).catch("randomize"),devices:Ni.enum(dj).catch("no-devices"),animations:Ni.boolean().catch(!0),executionUnit:Ni.number().min(1).max(500).catch(150),clockSpeed:Ni.number().min(100).max(3e3).catch(1e3),printerSpeed:Ni.number().min(500).max(2e4).catch(5e3),filterBightness:Ni.number().min(0).catch(1),filterContrast:Ni.number().min(0).catch(1),filterInvert:Ni.boolean().catch(!1),filterSaturation:Ni.number().min(0).catch(1)}),_u=S1.parse({});function NK(){const t=navigator.language.toLowerCase();for(const e of QL)if(t.startsWith(e))return e;return"en"}const il=ED("vonsim-settings",_u,{getItem(t,e){try{const n=localStorage.getItem(t);return S1.parse(JSON.parse(n??""))}catch{return e}},setItem(t,e){localStorage.setItem(t,JSON.stringify(e))},removeItem(t){localStorage.removeItem(t)},subscribe(t,e,n){const i=r=>{if(r.storageArea===localStorage&&r.key===t){let s;try{s=S1.parse(JSON.parse(r.newValue??""))}catch{s=n}e(s)}};return window==null||window.addEventListener("storage",i),()=>window==null?void 0:window.removeEventListener("storage",i)}},{getOnInit:!0}),Si=()=>ee.get(il),hj=()=>ed(il),MK=Ae(t=>t(il).language),r_=()=>Xt(MK),OK=Ae(t=>t(il).editorFontSize),IK=()=>Xt(OK);Ae(t=>t(il).dataOnLoad);const DK=Ae(t=>t(il).devices),LK=()=>Xt(DK);Ae(t=>{const e=t(il);return{executionUnit:e.executionUnit,clock:e.clockSpeed,printer:e.printerSpeed}});const jK=Ae(t=>{const e=t(il);return[`brightness(${e.filterBightness})`,`contrast(${e.filterContrast})`,`invert(${e.filterInvert?1:0})`,`saturate(${e.filterSaturation})`].filter(Boolean).join(" ")}),FK=()=>Xt(jK);function Ef(t){const e=t.charCodeAt(0);return L.fitsUnsigned(e,8)?e:null}function s_(t){return L.fitsUnsigned(t,8)?String.fromCharCode(t):null}function fj(t){return BK.at(t)??null}const BK=["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","BS","HT","LF","VT","FF","CR","SO","SI","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","EM","SUB","ESC","FS","GS","RS","US","SPACE","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","DEL","XXX","XXX","BPH","NBH","IND","NEL","SSA","ESA","HTS","HTJ","VTS","PLD","PLU","RI","SS2","SS3","DCS","PU1","PU2","STS","CCH","MW","SPA","EPA","SOS","XXX","SCI","CSI","ST","OSC","PM","APC","NBSP","¡","¢","£","¤","¥","¦","§","¨","©","ª","«","¬","SHY","®","¯","°","±","²","³","´","µ","¶","·","¸","¹","º","»","¼","½","¾","¿","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","×","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","÷","ø","ù","ú","û","ü","ý","þ","ÿ"];var Mt,Dt;const et=class et{constructor(e,n){Re(this,Mt);Re(this,Dt);Y(this,Mt,e|0),Y(this,Dt,n)}get size(){return C(this,Dt)}is8bits(){return C(this,Dt)===8}is16bits(){return C(this,Dt)===16}get unsigned(){return C(this,Mt)}get signed(){return C(this,Mt)<=et.maxSignedValue(C(this,Dt))?C(this,Mt):C(this,Mt)-(et.maxValue(C(this,Dt))+1)}get low(){return this.is8bits()?this:et.fromUnsigned(C(this,Mt)&et.maxValue(8),8)}get high(){return this.is8bits()?new et(0,8):et.fromUnsigned(C(this,Mt)>>8&et.maxValue(8),8)}withLow(e){if(e.is16bits())throw new TypeError("Byte must be 8 bits");return et.fromUnsigned(C(this,Mt)&~et.maxValue(8)|e.unsigned,C(this,Dt))}withHigh(e){if(e.is16bits())throw new TypeError("Byte must be 8 bits");return et.fromUnsigned(C(this,Mt)&et.maxValue(8)|e.unsigned<<8,16)}bit(e){if(!Number.isSafeInteger(e)||e<0||e>=C(this,Dt))throw new RangeError(`Index ${e} out of bounds for byte of size ${C(this,Dt)}`);return(C(this,Mt)&1<<e)!==0}withBit(e,n){if(!Number.isSafeInteger(e)||e<0||e>=C(this,Dt))throw new RangeError(`Index ${e} out of bounds for byte of size ${C(this,Dt)}`);return n?et.fromUnsigned(C(this,Mt)|1<<e,C(this,Dt)):et.fromUnsigned(C(this,Mt)&~(1<<e),C(this,Dt))}add(e){return e=Number(e),et.fromUnsigned(C(this,Mt)+e,C(this,Dt))}isZero(){return this.unsigned===0}equals(e){return typeof e=="number"?e<0?this.signed===e:this.unsigned===e:C(this,Mt)===C(e,Mt)}toUint8Array(){return this.is8bits()?new Uint8Array([this.unsigned]):new Uint8Array([this.low.unsigned,this.high.unsigned])}toArray(){const e=new Array(C(this,Dt));for(let n=0;n<C(this,Dt);n++)e[n]=this.bit(n);return e}toString(e="int"){switch(e){case"hex":return C(this,Mt).toString(16).padStart(C(this,Dt)/4,"0").toUpperCase();case"bin":return C(this,Mt).toString(2).padStart(C(this,Dt),"0");case"int":return this.signed.toString(10);case"uint":return this.unsigned.toString(10);case"ascii":return C(this,Dt)===8?s_(C(this,Mt))??"---":this.low.toString("ascii")+this.high.toString("ascii");case"safe-ascii":return C(this,Dt)===8?fj(C(this,Mt))??"---":this.low.toString("safe-ascii")+" "+this.high.toString("safe-ascii")}}toJSON(){return C(this,Mt)}valueOf(){return C(this,Mt)}static minValue(){return 0}static maxValue(e){return 2**e-1}static minSignedValue(e){return-(2**(e-1))}static maxSignedValue(e){return 2**(e-1)-1}static fits(e,n){return Number.isSafeInteger(e)&&e>=et.minSignedValue(n)&&e<=et.maxValue(n)}static fitsUnsigned(e,n){return Number.isSafeInteger(e)&&e>=et.minValue()&&e<=et.maxValue(n)}static fitsSigned(e,n){return Number.isSafeInteger(e)&&e>=et.minSignedValue(n)&&e<=et.maxSignedValue(n)}static fromUnsigned(e,n){if(!et.fitsUnsigned(e,n))throw new RangeError(`Value ${e} does not fit in a ${n}-bit byte.`);return new et(e,n)}static fromSigned(e,n){if(!et.fitsSigned(e,n))throw new RangeError(`Value ${e} does not fit in a ${n}-bit byte.`);return e<0?new et(e+et.maxValue(n)+1,n):new et(e,n)}static fromNumber(e,n){return e<0?et.fromSigned(e,n):et.fromUnsigned(e,n)}static fromChar(e){const n=Ef(e)??-1;return et.fromUnsigned(n,8)}static random(e){const n=Math.round(Math.random()*et.maxValue(e));return new et(n,e)}static zero(e){return new et(0,e)}};Mt=new WeakMap,Dt=new WeakMap;let L=et;var to;const Qo=class Qo{constructor(e){Re(this,to);Y(this,to,e)}get value(){return C(this,to).unsigned}get byte(){return C(this,to)}toString(e=!1){let n=C(this,to).toString("hex");return e&&(n+="h"),n.slice(-2)}toJSON(){return C(this,to).toJSON()}valueOf(){return C(this,to).valueOf()}static inRange(e){return e=Number(e),Number.isSafeInteger(e)&&e>=Qo.MIN_ADDRESS&&e<=Qo.MAX_ADDRESS}static from(e){if(e=Number(e),!Qo.inRange(e))throw new RangeError(`Address ${e} is out of range.`);const n=L.fromUnsigned(e,16);return new Qo(n)}static format(e,n=!0){if(e=Number(e),!Number.isSafeInteger(e)||e<0)return"????";let i=e.toString(16).padStart(4,"0").toUpperCase();return n&&(i+="h"),i.slice(-3)}};to=new WeakMap,oe(Qo,"MIN_ADDRESS",0),oe(Qo,"MAX_ADDRESS",32767);let ye=Qo;var no;const ea=class ea{constructor(e){Re(this,no);Y(this,no,e)}get value(){return C(this,no).unsigned}get byte(){return C(this,no)}toString(e=!0){let n=C(this,no).toString("hex");return e&&(n+="h"),n}toJSON(){return C(this,no).toJSON()}valueOf(){return C(this,no).valueOf()}static inRange(e){return e=Number(e),Number.isSafeInteger(e)&&e>=ea.MIN_ADDRESS&&e<=ea.MAX_ADDRESS}static from(e){if(e=Number(e),!ea.inRange(e))throw new RangeError(`Address ${e} is out of range.`);const n=L.fromUnsigned(e,8);return new ea(n)}static format(e,n=!0){if(e=Number(e),!Number.isSafeInteger(e)||e<0)return"??";let i=e.toString(16).padStart(2,"0").toUpperCase();return n&&(i+="h"),i}};no=new WeakMap,oe(ea,"MIN_ADDRESS",0),oe(ea,"MAX_ADDRESS",127);let Yi=ea;function yT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function wT(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yT(Object(n),!0).forEach(function(i){$K(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yT(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function $K(t,e,n){return e=zK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zK(t){var e=UK(t,"string");return typeof e=="symbol"?e:String(e)}function UK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bv=pj({});function pj(t){return e.withOptions=n=>pj(wT(wT({},t),n)),e;function e(n,...i){const r=typeof n=="string"?[n]:n.raw,{escapeSpecialCharacters:s=Array.isArray(n)}=t;let o="";for(let u=0;u<r.length;u++){let c=r[u];s&&(c=c.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\\{/g,"{")),o+=c,u<i.length&&(o+=i[u])}const a=o.split(`
`);let l=null;for(const u of a){const c=u.match(/^(\s+)\S+/);if(c){const d=c[1].length;l?l=Math.min(l,d):l=d}}if(l!==null){const u=l;o=a.map(c=>c[0]===" "||c[0]==="	"?c.slice(u):c).join(`
`)}return o=o.trim(),s&&(o=o.replace(/\\n/g,`
`)),o}}const VK=ye.from(ye.MAX_ADDRESS).toString(),HK={generics:{clean:"Clean","io-register":(t,e)=>`${t} register (${Yi.format(e)})`,"byte-representation":{hex:"Hexadecimal",bin:"Binary",uint:"Unsigned integer",int:"Signed integer","safe-ascii":"ASCII"}},update:{"update-available":"There's a new version available!",reload:"Update"},messages:{"assemble-error":"Assemble error. Fix the errors and try again.","invalid-action":"Invalid action."},editor:{lintSummary:t=>t===0?"Ready to compile":t===1?"There's an error":`There're ${t} errors`,files:{unsupported:"Your browser doesn't support the FileSystem API","no-file":"No file open",open:"Open file",unsaved:"There are unsaved changes, do you want to discard them?","open-error":"Error opening file",save:"Save file","save-as":"Save file as","save-error":"Error saving file"},example:bv`
      ; Welcome to VonSim!
      ; This is an example program that calculates the first
      ; n numbers of the Fibonacci sequence, and stores them
      ; starting at memory position 1000h.
      
           n  equ 10    ; Calculate the first 10 numbers
      
              org 10h
      start   db 1
      
              org 20h
              mov bx, offset start + 1
              mov al, 0
              mov ah, start
      
      loop:   cmp bx, offset start + n
              jns finish
              mov cl, ah
              add cl, al
              mov al, ah
              mov ah, cl
              mov [bx], cl
              inc bx
              jmp loop
      finish: hlt
              end
    `},control:{action:{start:"Start",continue:"Continue",running:"Running...",run:{"cycle-change":"One cycle","end-of-instruction":"One instruction",infinity:"Until stop"},stop:"Stop"},tabs:{editor:"Editor",computer:"Computer"},zoom:{in:"Zoom in",out:"Zoom out"}},computer:{cpu:{name:"CPU",register:t=>`${t} register`,"control-unit":"Control unit",decoder:"Decoder",status:{fetching:"Fetching instruction...","fetching-operands":"Fetching operands...",executing:"Executing...",writeback:"Saving results...",interrupt:"Handling interrupt...",stopped:"Stopped","stopped-error":"Error","waiting-for-input":"Waiting for input...",int6:"Running INT 6...",int7:"Running INT 7..."}},memory:{name:"Memory",cell:t=>`Cell ${ye.format(t)}`,"fix-address":"Fix address","unfix-address":"Unfix address","address-must-be-integer":"Start address must be an hexadecimal integer.","address-out-of-range":`Start address must be less or equal to ${VK}.`,"address-increment":"Increment address (Page Up)","address-decrement":"Decrement address (Page Down)"},"chip-select":{name:"Chip select",mem:"mem",pic:"pic",timer:"timer",pio:"pio",handshake:"handshake"},f10:"F10 key",keyboard:"Keyboard",leds:"LEDs",printer:{name:"Printer",buffer:"Buffer"},screen:"Screen",switches:"Switches",handshake:{name:"Handshake",data:"Data",state:"State"},pic:"PIC",pio:{name:"PIO",port:t=>`Port ${t}`},timer:"Timer"},settings:{title:"Settings",language:{label:"Language"},editorFontSize:{label:"Editor font size",increase:"Increase font size",decrease:"Decrease font size"},dataOnLoad:{label:"Data on load",description:"What to do with the memory when loading a new program.",randomize:"Randomize",clean:"Empty",unchanged:"Unchanged"},devices:{label:"Devices",description:"Which preset of devices to use.","no-devices":"No devices","keyboard-and-screen":"Keyboard and screen","pio-switches-and-leds":"Switches and LEDs","pio-printer":"Printer (PIO)",handshake:"Printer (Handshake)"},animations:{label:"Animations",description:["Disabling animations, you get faster execution.","Only affects animations affected by the simulation speed (like the CPU).","Other animations (like the clock and the printer) will run at their own speed.","Be careful! Very high simulation speeds without animations can saturate the processor."].join(" ")},speeds:{executionUnit:"Simulation speed",clockSpeed:"Clock speed",printerSpeed:"Printer speed"},filters:{label:"Filters",description:"Filters applied to the page. Useful when you're using a projector.",revert:"Revert to default filters",brightness:"Brightness",contrast:"Contrast",invert:"Invert",saturation:"Saturation"},reset:"Reset settings"},footer:{documentation:"Documentation",copyright:"III-LIDI, FI, UNLP, UNER",issue:{report:"Report an issue",body:(t,e)=>bv`
        <!-- Please describe the problem you are having in as much detail as possible. -->
        <!-- Most importantly, add the steps to reproduce the problem. -->

        <details>
          <summary>Debug info (PLEASE, DO NOT DELETE)</summary>

          **Version**: [${"3d07799"}](https://github.com/vonsim/vonsim/commit/${"3d07799"})

          #### Program

          \`\`\`asm
          ${e.split(`
`).map(n=>n.trim()).join(`
`)}
          \`\`\`

          #### Settings

          ${Object.entries(t).map(([n,i])=>`- **${n}**: ${i}`).join(`
          `)}
          
        </details>
      `}}},WK=ye.from(ye.MAX_ADDRESS).toString(),GK={generics:{clean:"Limpiar","io-register":(t,e)=>`Registro ${t} (${Yi.format(e)})`,"byte-representation":{hex:"Hexadecimal",bin:"Binario",uint:"Entero sin signo",int:"Entero con signo","safe-ascii":"ASCII"}},update:{"update-available":"¡Hay una nueva versión disponible!",reload:"Actualizar"},messages:{"assemble-error":"Error de ensamblado. Solucione los errores y vuelva a intentar.","invalid-action":"Acción inválida."},editor:{lintSummary:t=>t===0?"Listo para compilar":t===1?"Hay un error":`Hay ${t} errores`,files:{unsupported:"Tu navegador no soporta la “FileSystem API”","no-file":"No hay ningún archivo abierto",open:"Abrir",unsaved:"Hay cambios sin guardar, ¿desea descartarlos?","open-error":"Error al abrir el archivo",save:"Guardar","save-as":"Guardar como","save-error":"Error al guardar el archivo"},example:bv`
      ; ¡Bienvenido a VonSim 8!
      ; Este es un ejemplo de código que suma dos variables z = x + y
      
      org 10h
        x  db 3
        y  db 2
        z  db 0
      org 20h
        mov al, x
        add al, y
        mov z, al
        hlt
      end
    `},control:{action:{start:"Iniciar",continue:"Continuar",running:"Ejecutando...",run:{"cycle-change":"Un ciclo","end-of-instruction":"Una instrucción",infinity:"Hasta el final"},stop:"Detener"},tabs:{editor:"Editor",computer:"Computadora"},zoom:{in:"Acercar",out:"Alejar"}},computer:{cpu:{name:"CPU",register:t=>`Registro ${t}`,"control-unit":"Unidad de control",decoder:"Decodificador",status:{fetching:"Leyendo instrucción...","fetching-operands":"Leyendo operandos...",executing:"Ejecutando...",writeback:"Escribiendo resultados...",interrupt:"Manejando interrupción...",stopped:"Detenido","stopped-error":"Error","waiting-for-input":"Esperando tecla...",int6:"Ejecutando INT 6...",int7:"Ejecutando INT 7..."}},memory:{name:"Memoria",cell:t=>`Celda ${ye.format(t)}`,"fix-address":"Fijar dirección","unfix-address":"Desfijar dirección","address-must-be-integer":"El valor de inicio debe ser un número entero hexadecimal.","address-out-of-range":`El valor de inicio debe ser menor o igual a ${WK}.`,"address-increment":"Incrementar dirección (Page Up)","address-decrement":"Decrementar dirección (Page Down)"},"chip-select":{name:"Chip select",mem:"mem",pic:"pic",timer:"timer",pio:"pio",handshake:"handshake"},f10:"Tecla F10",keyboard:"Teclado",leds:"Leds",printer:{name:"Impresora",buffer:"Buffer"},screen:"Pantalla",switches:"Llaves",handshake:{name:"Handshake",data:"Dato",state:"Estado"},pic:"PIC",pio:{name:"PIO",port:t=>`Puerto ${t}`},timer:"Timer"},settings:{title:"Configuración",language:{label:"Idioma"},editorFontSize:{label:"Tamaño de fuente del editor",increase:"Aumentar",decrease:"Disminuir"},dataOnLoad:{label:"Memoria al cargar",description:"Qué hacer con la memoria al cargar un nuevo programa.",randomize:"Aleatoria",clean:"Vaciar",unchanged:"Reusar"},devices:{label:"Dispositivos",description:"Qué conjunto de dispositivos usar.","no-devices":"Ninguno","keyboard-and-screen":"Teclado y pantalla","pio-switches-and-leds":"Llaves y luces","pio-printer":"Impresora (PIO)",handshake:"Impresora (Handshake)"},animations:{label:"Animaciones",description:["Inhabilitando las animaciones, se obtiene ejecución más rápida.","Solo afecta a las animaciones afectadas por la velocidad de simulación (como la CPU).","Otras animaciones (como el reloj y la impresora) se ejecutarán a su propia velocidad.","¡Cuidado! Velocidades de simulación muy altas sin animaciones puede saturar el procesador."].join(" ")},speeds:{executionUnit:"Velocidad de simulación",clockSpeed:"Velocidad del reloj",printerSpeed:"Velocidad de impresión"},filters:{label:"Filtros",description:"Filtros aplicados a la página. Útil cuando se usa un proyector.",revert:"Revertir a los valores por defecto",brightness:"Brillo",contrast:"Contraste",invert:"Invertir",saturation:"Saturación"},reset:"Restablecer configuración"},footer:{documentation:"Documentación",copyright:"III-LIDI, FI, UNLP, UNER",issue:{report:"Reportar un error",body:(t,e)=>bv`
        <!-- Por favor, describa el problema que está teniendo en la mayor cantidad de detalle posible. -->
        <!-- Por sobre todo, agregue los pasos para reproducir el problema. -->

        <details>
          <summary>Información extra (POR FAVOR, NO BORRAR)</summary>

          **Versión**: [${"3d07799"}](https://github.com/ruiz-jose/VonSim8/commit/${"3d07799"})

          #### Programa

          \`\`\`asm
          ${e.split(`
`).map(n=>n.trim()).join(`
`)}
          \`\`\`

          #### Configuración

          ${Object.entries(t).map(([n,i])=>`- **${n}**: ${i}`).join(`
          `)}
          
        </details>
      `}}},Ry=n_({en:HK,es:GK});function mt(){const t=r_();return S.useCallback((e,...n)=>Ry(t,e,...n),[t])}const KK=1,bT=5e3,gs=new Map,bh=[];function XK(){let t=0;for(const e of gs.keys())e>t&&(t=e);return t+1}function qK(){let t=1/0;for(const e of gs.keys())e<t&&(t=e);return t}function ga(t,e=!0){switch(t.type){case"ADD_TOAST":{const{toastId:n,toast:i}=t,r=i.duration??bT,s=Number.isFinite(r)?setTimeout(()=>ga({type:"DISMISS_TOAST",toastId:n}),r):null;gs.set(n,{...i,timeout:s,otherProps:{open:!0,onOpenChange:o=>{o||ga({type:"DISMISS_TOAST",toastId:n})}}}),gs.size>KK&&ga({type:"DISMISS_TOAST",toastId:qK()},!1);break}case"UPDATE_TOAST":{const{toastId:n,toast:i}=t,r=gs.get(n);if(!r)return;if(typeof i.duration=="number"){r.timeout!==null&&clearTimeout(r.timeout);const s=i.duration??bT,o=Number.isFinite(s)?setTimeout(()=>ga({type:"DISMISS_TOAST",toastId:n}),s):null;gs.set(n,{...r,...i,timeout:o})}else gs.set(n,{...r,...i});break}case"DISMISS_TOAST":{const{toastId:n}=t,i=gs.get(n);if(!i)return;i.timeout!==null&&clearTimeout(i.timeout),gs.delete(n);break}default:{const n=t;throw new Error(`Unhandled action: ${n}`)}}if(e&&bh.length>0){const n=Array.from(gs.entries()).map(([i,r])=>({...r,id:i})).sort((i,r)=>r.id-i.id);for(const i of bh)i(n)}}function xn(t){const e=XK(),n=r=>ga({type:"UPDATE_TOAST",toastId:e,toast:{...r}}),i=()=>ga({type:"DISMISS_TOAST",toastId:e});return ga({type:"ADD_TOAST",toastId:e,toast:t}),{id:e,dismiss:i,update:n}}function YK(){const[t,e]=S.useState([]);return S.useEffect(()=>(bh.push(e),()=>{const n=bh.indexOf(e);n>-1&&bh.splice(n,1)}),[]),{toastList:t,toast:xn,dismiss:n=>ga({type:"DISMISS_TOAST",toastId:n})}}const Ny=ED("vonsim-program",Ry(Si().language,"editor.example"),void 0,{getOnInit:!0}),JK=()=>Xt(Ny),ZK=()=>ee.get(Ny),QK=In.fromClass(class{constructor(t){this.view=t}update(t){t.docChanged&&ee.set(Ny,this.view.state.doc.toString())}}),Cd="showSaveFilePicker"in window,eX=Ae(null),mj=Ae(""),tX=Ae(t=>t(mj)!==t(Ny));function nX(){const t=mt(),[e,n]=ed(eX),i=Xt(tX),r=O2(mj),s=e&&i,o=S.useCallback(async()=>{if(!Cd){xn({title:t("editor.files.unsupported"),variant:"error"});return}if(!(s&&!confirm(t("editor.files.unsaved"))))try{const[d]=await window.showOpenFilePicker({multiple:!1,excludeAcceptAllOption:!0,types:[{accept:{"text/plain":[".txt",".asm",".vonsim"]}}]});await d.requestPermission({mode:"readwrite"})==="granted"&&n(d);const p=await(await d.getFile()).text();r(p),window.codemirror.dispatch({changes:{from:0,to:window.codemirror.state.doc.length,insert:p}})}catch(d){console.error(d),xn({title:t("editor.files.open-error"),variant:"error"})}},[t,s,n,r]);xo(d=>d.ctrlKey&&d.key==="o",d=>{d.preventDefault(),o()},void 0,[o]);const a=S.useCallback(async d=>{var f,p;if(d.stopPropagation(),d.preventDefault(),!Cd){xn({title:t("editor.files.unsupported"),variant:"error"});return}const h=(p=(f=d.dataTransfer)==null?void 0:f.items)==null?void 0:p[0];if(!(!h||h.kind!=="file")&&!(s&&!confirm(t("editor.files.unsaved"))))try{const m=await h.getAsFileSystemHandle();if(!m)throw new Error("File handle not found");await m.requestPermission({mode:"readwrite"})==="granted"&&n(m);const y=await(await m.getFile()).text();r(y),window.codemirror.dispatch({changes:{from:0,to:window.codemirror.state.doc.length,insert:y}})}catch(m){console.error(m),xn({title:t("editor.files.open-error"),variant:"error"})}},[n,r,t,s]);qm("drop",a,window),qm("dragover",d=>{d.preventDefault(),d.stopPropagation()},window);const l=S.useCallback(async()=>{if(!Cd){xn({title:t("editor.files.unsupported"),variant:"error"});return}if(s)try{const d=window.codemirror.state.doc.toString(),h=await e.createWritable({keepExistingData:!1});await h.write(d),await h.close(),r(d)}catch(d){console.error(d),xn({title:t("editor.files.save-error"),variant:"error"})}},[t,s,e,r]),u=S.useCallback(async()=>{const d=window.codemirror.state.doc.toString(),h=(e==null?void 0:e.name)||`vonsim-${new Date().toISOString().slice(0,10)}.asm`;if(Cd)try{const f=await window.showSaveFilePicker({suggestedName:h,excludeAcceptAllOption:!0,types:[{accept:{"text/plain":[".txt",".asm",".vonsim"]}}]}),p=await f.requestPermission({mode:"readwrite"});if(p!=="granted")throw new Error(`Permission denied: ${p}`);n(f);const m=await f.createWritable({keepExistingData:!1});await m.write(d),await m.close(),r(d)}catch(f){console.error(f),xn({title:t("editor.files.save-error"),variant:"error"})}else{const f=new Blob([d],{type:"text/plain"}),p=URL.createObjectURL(f),m=document.createElement("a");m.style.display="none",m.href=p,m.download=h,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(p)}},[t,e,n,r]);xo(d=>d.ctrlKey&&d.key==="s",d=>{d.preventDefault(),Cd&&(e?l():u())},void 0,[e,l,u]),xo(d=>d.ctrlKey&&d.shiftKey&&d.key==="S",d=>{d.preventDefault(),u()},void 0,[u]);const c=S.useCallback(d=>{s&&(d.preventDefault(),d.returnValue=t("editor.files.unsaved"))},[t,s]);return qm("beforeunload",c,window),g.jsxs(YL,{children:[g.jsx(JL,{asChild:!0,children:g.jsxs("button",{className:ze("flex items-center transition-colors hover:text-white",e&&"text-white"),children:[e?e.name:t("editor.files.no-file"),s&&g.jsx("span",{className:"ml-1 h-2 w-2 rounded-full bg-current"})]})}),g.jsxs(t_,{className:"w-64",align:"start",children:[g.jsxs(Fl,{onClick:o,children:[g.jsx("span",{className:"icon-[lucide--file-search-2] mr-2 h-4 w-4"}),t("editor.files.open"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"Ctrl+O"})]}),g.jsxs(Fl,{disabled:!s,onClick:l,children:[g.jsx("span",{className:"icon-[lucide--save] mr-2 h-4 w-4"}),t("editor.files.save"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"Ctrl+S"})]}),g.jsxs(Fl,{onClick:u,children:[g.jsx("span",{className:"icon-[lucide--save-all] mr-2 h-4 w-4"}),t("editor.files.save-as"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"Ctrl+Shift+S"})]})]})]})}function iX(){const t=mt(),e=rX();return g.jsxs("footer",{className:"px-2 py-1 text-center text-xs tracking-wider text-stone-500",children:[g.jsx("a",{href:"/VonSim8/docs",className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:t("footer.documentation")}),g.jsx("span",{className:"px-2",children:"·"}),g.jsx("a",{href:"https://ruiz-jose.github.io/VonSim8/",className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:"GitHub"}),g.jsx("span",{className:"px-2",children:"·"}),g.jsx("a",{href:e,className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:t("footer.issue.report")}),g.jsx("span",{className:"px-2 max-sm:hidden",children:"·"}),g.jsx("br",{className:"sm:hidden"}),g.jsxs("a",{href:"/docs#licencia",className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:["© Copyright 2017-",new Date().getFullYear()," — ",t("footer.copyright")]})]})}function rX(){const t=mt(),[e]=hj(),n=JK();return"https://github.com/ruiz-jose/VonSim8/issues/new?body="+encodeURIComponent(t("footer.issue.body",e,n))}function xv(t,e,n){const i=[];for(let r=0;r<t.length;r++)try{const s=e(t[r],r,t);s&&(Array.isArray(s)?s.forEach(o=>o&&i.push(n(o,r,t))):i.push(n(s,r,t)))}catch(s){i.push(n(s,r,t))}return i}class rn{constructor(e,n){oe(this,"start");oe(this,"end");this.start=e|0,this.end=(n??e)|0}get range(){return[this.start,this.end]}toString(){let e=`${this.start}`;return this.end!==this.start&&(e+=`:${this.end}`),e}static merge(...e){const n=e.filter(Boolean);if(n.length===0)throw new Error("Cannot merge 0 positions");let i=n[0].start,r=n[0].end;for(const s of n)s.start<i&&(i=s.start),s.end>r&&(r=s.end);return new rn(i,r)}toJSON(){return this.range}}const xT=ye.from(ye.MAX_ADDRESS).toString(),sX=Yi.from(Yi.MAX_ADDRESS).toString(),oX={"address-has-code":t=>`Memory address ${t} has instructions. It cannot be used as a data address.`,"address-out-of-range":t=>`Memory address ${ye.format(t)} is out of range (max memory address: ${xT}).`,"cannot-accept-strings":t=>`${t} can't accept strings.`,"cannot-be-indirect":"This operand can't be an indirect memory address.","cannot-be-unassinged":t=>`${t} can't be unassigned.`,"cannot-be-word":"This operand can't be of 16 bits.","circular-reference":"Circular reference detected.","constant-must-have-a-label":"Constant must have a label.","constant-must-have-one-value":"Constant must have exactly one value.","destination-cannot-be-immediate":"The destination can't be an immediate value.","double-memory-access":"Can't access to a memory location twice in the same instruction.","duplicated-label":t=>`Duplicated label "${t}".`,"empty-program":"Empty program. The program must have, at least, an END statement.","end-must-be-the-last-statement":"END must be the last statement.","equ-not-found":t=>`EQU "${t}" not found.`,"expects-ax":"This operand should be AX or AL.","expects-dx":"The only valid register is DX.","expects-immediate":"This operand should be immediate.","expects-label":"This operand should be a label.","expects-no-operands":"This instruction doesn't expect any operands.","expects-one-operand":"This instruction expects one operand.","expects-two-operands":"This instruction expects two operands.","expects-word-register":"This instruction expects a 16-bits register as its operand.","instruction-out-of-range":t=>`This instruction would be placed in address ${ye.format(t)}, which is outside the memory range (max memory address: ${xT}).`,"invalid-interrupt":t=>`Invalid interrupt number ${t}.`,"io-address-out-of-range":t=>`I/O address ${t} is out of range (max I/O address: ${sX}).`,"label-not-found":t=>`Label "${t}" has not been defined.`,"label-should-be-a-number":t=>`Label ${t} should point to a EQU declaration or to a instruction. Maybe you ment to write OFFSET ${t}.`,"label-should-be-an-instruction":t=>`Label ${t} should point to a instruction.`,"missing-org":"No ORG before this instruction — cannot determine its location in memory.","must-have-one-or-more-values":t=>`${t} must have at least one value.`,"occupied-address":t=>`This instruction would be placed in address ${t}, which is already occupied.`,"offset-only-with-data-directive":"OFFSET can only be use with data directives.","reserved-address":t=>`This instruction would be placed in address ${t}, which is reserved by the system.`,"size-mismatch":(t,e)=>`The source (${t}-bit) and destination (${e}-bit) must be the same size.`,"unexpected-error":t=>`Unexpected error: ${String(t)}`,"unknown-size":"Addressing an unknown memory address with an immediate operand requires specifying the type of pointer with WORD PTR or BYTE PTR before the address.","value-out-of-range":(t,e)=>`The number ${t} cannot be represented with ${e} bits.`,lexer:{"character-too-long":"Character literals can only have one character.","empty-character":"Character literals can't be empty.","invalid-binary":"Invalid binary number. It should only contain 0s and 1s.","invalid-decimal":"Invalid decimal number. It should only contain digits.","only-ascii":"Only ASCII character are supported for characters literals and strings.","unexpected-character":t=>`Unexpected character "${t}".`,"unterminated-character":"Unterminated character.","unterminated-string":"Unterminated string."},parser:{"ambiguous-unary":"Ambiguous unary expression detected. Use parentheses to disambiguate.","expected-address-after-org":"Expected address after ORG.","expected-argument":"Expected argument.","expected-eos":"Expected end of statement.","expected-instruction":t=>`Expected instruction, got ${t.type}.`,"expected-label-after-offset":"Expected label after OFFSET.","expected-instruction-after-label":t=>`Expected instruction after label, got ${t.type}.`,"expected-literal-after-expression":t=>`Expected "${t}" after expression.`,"expected-literal-after-literal":(t,e)=>`Expected "${t}" after "${e}".`,"expected-type":(t,e)=>`Expected ${t}, got ${e}.`,"indirect-addressing-must-be-bx":"The only register supported for indirect addressing is BX.","unclosed-parenthesis":"Unclosed parenthesis.","unexpected-identifier":"Unexpected identifier. You may have forgotten a colon (:) to make it a label."}},ST=ye.from(ye.MAX_ADDRESS).toString(),aX=Yi.from(Yi.MAX_ADDRESS).toString(),lX={"address-has-code":t=>`La dirección de memoria ${ye.format(t)} tiene instrucciones. No se puede usar como dirección de datos.`,"address-out-of-range":t=>`La dirección de memoria ${ye.format(t)} está fuera de rango (dirección máxima de memoria: ${ST}).`,"cannot-accept-strings":t=>`${t} no puede aceptar cadenas de texto.`,"cannot-be-indirect":"Este operando no puede ser una dirección de memoria indirecta.","cannot-be-unassinged":t=>`${t} no puede estar sin asignar.`,"cannot-be-word":"Este operando no puede ser de 16 bits.","circular-reference":"Se detectó una referencia circular.","constant-must-have-a-label":"La constante debe tener una etiqueta.","constant-must-have-one-value":"La constante debe tener una exactamente un valor.","destination-cannot-be-immediate":"El destino no puede ser un valor inmediato.","double-memory-access":"No se puede acceder a una memoria dos veces en la misma instrucción.","duplicated-label":t=>`Etiqueta duplicada "${t}".`,"empty-program":"Programa vacío. El programa debe tener, al menos, una instrucción END.","end-must-be-the-last-statement":"END debe ser la última instrucción.","equ-not-found":t=>`EQU "${t}" no encontrado.`,"expects-ax":"Este operando debe ser AX o AL.","expects-dx":"El único registro válido es DX.","expects-immediate":"Este operando debe ser inmediato.","expects-label":"Este operando debe ser una etiqueta.","expects-no-operands":"Esta instrucción no espera ningún operando.","expects-one-operand":"Esta instrucción espera un operando.","expects-two-operands":"Esta instrucción espera dos operandos.","expects-word-register":"Esta instrucción espera un registro de 16 bits como su operando.","instruction-out-of-range":t=>`Esta instrucción se colocaría en la dirección ${ye.format(t)}, la cual se encuentra fuera del rango de memoria (dirección máxima de memoria: ${ST}).`,"invalid-interrupt":t=>`${t} no es un número de interrupción válido.`,"io-address-out-of-range":t=>`La dirección de E/S ${t} está fuera de rango (dirección máxima de memoria E/S: ${aX}).`,"label-not-found":t=>`La etiqueta "${t}" no ha sido definida.`,"label-should-be-a-number":t=>`La etiqueta ${t} debería apuntar a una constante EQU o a una instrucción. Quizás quiso escribir OFFSET ${t}.`,"label-should-be-an-instruction":t=>`La etiqueta ${t} debería apuntar a una instrucción.`,"missing-org":"No hay ningún ORG antes de esta instrucción, por lo que no se puede determinar su ubicación en memoria.","must-have-one-or-more-values":t=>`${t} debe tener al menos un valor.`,"occupied-address":t=>`Esta instrucción sería colocada en la dirección ${ye.format(t)}, la cual ya está ocupada.`,"offset-only-with-data-directive":"OFFSET solo puede ser usado con variables.","reserved-address":t=>`Esta instrucción sería colocada en la dirección ${ye.format(t)}, la cual ya está reservada por el sistema.`,"size-mismatch":(t,e)=>`La fuente (${t} bits) y el destino (${e} bits) deben ser del mismo tamaño.`,"unexpected-error":t=>`Error inesperado: ${String(t)}`,"unknown-size":"Acceder a una dirección de memoria desconocida con un operando inmediato requiere especificar el tipo de puntero con WORD PTR o BYTE PTR antes de la dirección.","value-out-of-range":(t,e)=>`El número ${t} no puede ser representado con ${e} bits.`,lexer:{"character-too-long":"El carácter solo puede contener un carácter.","empty-character":"Los carácter no puede estar vacío.","invalid-binary":"Número binario inválido. Solo puede contener ceros y unos.","invalid-decimal":"Número decimal inválido. Solo puede contener dígitos.","only-ascii":"Solo se soportan caracteres ASCII para caracteres y cadenas de texto.","unexpected-character":t=>`Carácter inesperado "${t}".`,"unterminated-character":"Carácter sin terminar.","unterminated-string":"Cadena sin terminar."},parser:{"ambiguous-unary":"Se detectó una expresión unaria ambigua. Use paréntesis para evitar ambigüedades.","expected-address-after-org":"Se esperaba una dirección después de ORG.","expected-argument":"Se esperaba un argumento.","expected-eos":"Se esperaba que la instrucción termine.","expected-instruction":t=>`Se esperaba una instrucción, se obtuvo ${t.type}.`,"expected-label-after-offset":"Se esperaba una etiqueta después de OFFSET.","expected-instruction-after-label":t=>`Se esperaba una instrucción después de la etiqueta, se obtuvo ${t.type}.`,"expected-literal-after-expression":t=>`Se esperaba "${t}" después de la expresión.`,"expected-literal-after-literal":(t,e)=>`Se esperaba "${t}" después de "${e}".`,"expected-type":(t,e)=>`Se esperaba ${t}, se obtuvo ${e}.`,"indirect-addressing-must-be-bx":"El único registro válido para el direccionamiento indirecto es BX.","unclosed-parenthesis":"Paréntesis sin cerrar.","unexpected-identifier":"Identificador inesperado. Tal vez te olvidaste agregar dos puntos (:) para hacerlo una etiqueta."}},uX=n_({en:oX,es:lX});class le extends Error{constructor(n,...i){super();oe(this,"code");oe(this,"context");oe(this,"position");this.code=n,this.context=i,this.position=null,n==="unexpected-error"&&console.error("[Unexpected Assembler Error]",...i)}at(n){return n&&(n instanceof rn?this.position=n:"position"in n?this.position=n.position:"meta"in n&&(this.position=n.meta.position)),this}translate(n){return uX(n,this.code,...this.context)}get message(){let n=this.translate("en");return this.position&&(n+=` (${this.position})`),n}toString(){return this.message}static from(n){return n instanceof le?n:new le("unexpected-error",n)}}const o_=[[0,L.fromUnsigned(40960,16)],[3,L.fromUnsigned(41728,16)],[6,L.fromUnsigned(42496,16)],[7,L.fromUnsigned(42752,16)]],cX=new Set(...o_.map(([t])=>[t*4,t*4+1,t*4+2,t*4+3]));var oa,gc;class dX{constructor(){oe(this,"codeMemory",new Set);oe(this,"labels",new Map);Re(this,oa,!1);Re(this,gc,!1)}loadStatements(e){if(C(this,oa))throw new Error("Tried to load statements twice");Y(this,oa,!0),this.labels.clear();const n=[];for(const i of e)if("label"in i&&i.label){if(this.labels.has(i.label)){n.push(new le("duplicated-label",i.label).at(i.position));continue}i.isInstruction()?this.labels.set(i.label,{type:"instruction",address:ye.from(0)}):i.directive==="EQU"?this.labels.set(i.label,{type:"EQU",constant:i}):this.labels.set(i.label,{type:i.directive,address:ye.from(0)})}return n}computeAddresses(e){if(C(this,gc))throw new Error("Tried to compute addresses twice");Y(this,gc,!0),this.codeMemory.clear();const n=new Set;let i=null;return xv(e,s=>{if(s.isEnd()||s.isDataDirective()&&s.directive==="EQU")return;if(s.isOriginChange()){i=s.newAddress;return}if(i===null)throw new le("missing-org").at(s);const o=s.length;for(let l=0;l<o;l++){if(!ye.inRange(i+l))throw new le("instruction-out-of-range",i+l).at(s);const u=ye.from(i+l);if(n.has(u.value))throw new le("occupied-address",u).at(s);if(cX.has(u.value))throw new le("reserved-address",u).at(s);n.add(u.value),s.isInstruction()&&this.codeMemory.add(u.value)}const a=ye.from(i);s.setStart(a),s.label&&this.labels.set(s.label,{type:s.isInstruction()?"instruction":s.directive,address:a}),i+=o},le.from)}labelExists(e){if(!C(this,oa))throw new Error("Tried to check if label exists before loading statements");return this.labels.has(e)}getLabelType(e){var n;if(!C(this,oa))throw new Error("Tried to get type of label before loading statements");return(n=this.labels.get(e))==null?void 0:n.type}getLabelValue(e){if(!C(this,oa))throw new Error("Tried to get type of label before loading statements");const n=this.labels.get(e);if(n){if(n.type==="EQU")return n.constant.evaluate(this);if(!C(this,gc))throw new Error("Tried to get address of label before computing addresses");return n.address.value}}addressIsReserved(e){return e instanceof ye&&(e=e.value),this.codeMemory.has(e)}}oa=new WeakMap,gc=new WeakMap;const hX=["AL","BL","CL","DL","AH","BH","CH","DH"],gj=["AX","BX","CX","DX","SP"],Sv=[...hX,...gj],a_=["DB","DW","EQU"],l_=["MOV","PUSH","POP","IN","OUT","PUSHF","POPF","ADD","ADC","INC","SUB","SBB","DEC","NEG","CMP","NOT","AND","OR","XOR","CALL","JMP","RET","JZ","JO","JS","JC","JNZ","JNO","JNS","JNC","INT","IRET","CLI","STI","NOP","HLT"],fX=["OFFSET","ORG","BYTE","WORD","PTR","END",...Sv,...l_,...a_];class pX{constructor(e,n,i){oe(this,"type");oe(this,"lexeme");oe(this,"position");this.type=e,this.lexeme=n,this.position=i}toJSON(){return{type:this.type,lexeme:this.lexeme,position:this.position.toJSON()}}}class mX{constructor(e){oe(this,"scanned",!1);oe(this,"tokens",[]);oe(this,"position",new rn(0));this.source=e}scanTokens(){if(this.scanned)throw new Error("Scanner has already been used.");for(this.scanned=!0;!this.isAtEnd();){this.position=new rn(this.position.end);const e=this.advance();switch(e){case"(":this.addToken("LEFT_PAREN");continue;case")":this.addToken("RIGHT_PAREN");continue;case"[":this.addToken("LEFT_BRACKET");continue;case"]":this.addToken("RIGHT_BRACKET");continue;case",":this.addToken("COMMA");continue;case"?":this.addToken("QUESTION_MARK");continue;case"+":this.addToken("PLUS");continue;case"-":this.addToken("MINUS");continue;case"*":this.addToken("ASTERISK");continue;case"'":{let n=0;for(;this.peek()!=="'";){if(this.isAtEnd()||this.peek()===`
`)throw new le("lexer.unterminated-character").at(this.position);if(Ef(this.peek())===null)throw new le("lexer.only-ascii").at(new rn(this.position.end,this.position.end+1));this.advance(),n++}if(this.advance(),n===0)throw new le("lexer.empty-character").at(this.position);if(n>=2)throw new le("lexer.character-too-long").at(this.position);this.addToken("CHARACTER");continue}case'"':for(;this.peek()!=='"';){if(this.isAtEnd()||this.peek()===`
`)throw new le("lexer.unterminated-string").at(this.position);if(Ef(this.peek())===null)throw new le("lexer.only-ascii").at(new rn(this.position.end,this.position.end+1));this.advance()}this.advance(),this.addToken("STRING");continue;case";":for(;this.peek()!==`
`&&!this.isAtEnd();)this.advance();continue;case" ":case"\r":case"	":continue;case`
`:this.addToken("EOL");continue}if(this.isDigit(e)){for(;this.isDigit(this.peek())||this.peek()>="a"&&this.peek()<="f"||this.peek()>="A"&&this.peek()<="F";)this.advance();if(this.peek()==="H"||this.peek()==="h")this.advance();else{const n=this.source.slice(this.position.start,this.position.end);if(n.at(-1)==="b"||n.at(-1)==="B"){if(!/^[01]+b$/i.test(n))throw new le("lexer.invalid-binary").at(this.position)}else if(!/^\d+$/.test(n))throw new le("lexer.invalid-decimal").at(this.position)}this.addToken("NUMBER");continue}if(this.isAlpha(e)){for(;this.isAlphaNumeric(this.peek());)this.advance();const n=this.source.slice(this.position.start,this.position.end).toUpperCase();fX.includes(n)?this.addToken(n):this.peek()===":"?(this.advance(),this.addToken("LABEL")):this.addToken("IDENTIFIER");continue}throw new le("lexer.unexpected-character",e).at(this.position)}return this.position=new rn(this.position.end),this.addToken("EOF"),this.tokens}addToken(e){this.tokens.push(new pX(e,this.source.slice(this.position.start,this.position.end),this.position))}advance(){const e=this.source.charAt(this.position.end);return this.position=new rn(this.position.start,this.position.end+1),e}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}isAtEnd(){return this.position.end>=this.source.length}isDigit(e){return e>="0"&&e<="9"}peek(){return this.isAtEnd()?"\0":this.source.charAt(this.position.end)}}class _n{constructor(e){this.position=e}isNumberLiteral(){return this.type==="number-literal"}isLabel(){return this.type==="label"}isUnaryOperation(){return this.type==="unary-operation"}isBinaryOperation(){return this.type==="binary-operation"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}oe(_n,"numberLiteral",(...e)=>new gX(...e)),oe(_n,"label",(...e)=>new vX(...e)),oe(_n,"unaryOperation",(...e)=>new yX(...e)),oe(_n,"binaryOperation",(...e)=>new wX(...e));class gX extends _n{constructor(n,i){super(i);oe(this,"type","number-literal");this.value=n}evaluate(){return this.value}toJSON(){return{...super.toJSON(),value:this.value}}}let vX=class extends _n{constructor(n,i,r){super(r);oe(this,"type","label");this.value=n,this.offset=i}evaluate(n){if(!n.labelExists(this.value))throw new le("label-not-found",this.value).at(this.position);const i=n.getLabelType(this.value);if((i==="DB"||i==="DW")&&!this.offset)throw new le("label-should-be-a-number",this.value).at(this.position);if((i==="EQU"||i==="instruction")&&this.offset)throw new le("offset-only-with-data-directive").at(this.position);return n.getLabelValue(this.value)}toJSON(){return{...super.toJSON(),value:this.value,offset:this.offset}}};class yX extends _n{constructor(n,i,r){super(r);oe(this,"type","unary-operation");this.operator=n,this.right=i}evaluate(n){return this.operator==="+"?this.right.evaluate(n):-this.right.evaluate(n)}toJSON(){return{...super.toJSON(),operator:this.operator,right:this.right.toJSON()}}}class wX extends _n{constructor(n,i,r,s){super(s);oe(this,"type","binary-operation");this.left=n,this.operator=i,this.right=r}evaluate(n){return this.operator==="+"?this.left.evaluate(n)+this.right.evaluate(n):this.operator==="-"?this.left.evaluate(n)-this.right.evaluate(n):this.left.evaluate(n)*this.right.evaluate(n)}toJSON(){return{...super.toJSON(),operator:this.operator,left:this.left.toJSON(),right:this.right.toJSON()}}}class My{constructor(e){this.position=e}isOriginChange(){return this.type==="origin-change"}isEnd(){return this.type==="end"}isDataDirective(){return this.type==="data-directive"}isInstruction(){return this.type==="instruction"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}var io;class vj extends My{constructor(n,i,r){super(r);oe(this,"type","data-directive");oe(this,"label");oe(this,"values");Re(this,io,null);this.values=n,this.label=i}get start(){if(C(this,io)===null)throw new Error("Start not set");return C(this,io)}setStart(n){if(C(this,io)!==null)throw new Error("Start already set");Y(this,io,n)}toJSON(){return{...super.toJSON(),...C(this,io)?{start:C(this,io).toJSON()}:{},directive:this.directive,label:this.label}}}io=new WeakMap;var Il,aa,vc;class bX extends vj{constructor(n,i,r){super(n,i,r);oe(this,"directive","EQU");Re(this,Il,"not-processed");Re(this,aa,null);Re(this,vc,null)}toJSON(){var n;return{...super.toJSON(),value:C(this,vc)??((n=C(this,aa))==null?void 0:n.toJSON())??this.values.map(i=>i.toJSON())}}validate(){if(C(this,aa))throw new Error("Constant already validated");if(!this.label)throw new le("constant-must-have-a-label").at(this);if(this.values.length!==1)throw new le("constant-must-have-one-value").at(this);const n=this.values[0];if(n.type==="string")throw new le("cannot-accept-strings","EQU").at(n);if(n.type==="unassigned")throw new le("cannot-be-unassinged","EQU").at(n);Y(this,aa,n.value)}evaluateExpressions(n){if(!C(this,aa))throw new Error("Constant not validated");if(C(this,Il)==="processed")return C(this,vc);if(C(this,Il)==="processing")throw new le("circular-reference").at(this.position);Y(this,Il,"processed");const i=C(this,aa).evaluate(n);return Y(this,Il,"processed"),Y(this,vc,i),i}evaluate(n){return this.evaluateExpressions(n)}}Il=new WeakMap,aa=new WeakMap,vc=new WeakMap;const Jd=Symbol("unassigned");var pi,Lr;class xX extends vj{constructor(n,i,r,s){super(i,r,s);oe(this,"size");Re(this,pi,null);Re(this,Lr,null);this.directive=n,this.size=n==="DB"?8:16}get length(){if(!C(this,pi))throw new Error("Data directive not validated");return C(this,pi).length*(this.size/8)}getValues(){if(!C(this,Lr))throw new Error("Data directive not evaluated");return C(this,Lr)}toJSON(){return{...super.toJSON(),values:(C(this,Lr)??C(this,pi)??this.values).map(n=>n===Jd?"?":n.toJSON())}}validate(){if(C(this,pi))throw new Error("Data directive already validated");Y(this,pi,[]);for(const n of this.values)if(n.isUnassigned())C(this,pi).push(Jd);else if(n.isString()){if(this.directive!=="DB")throw new le("cannot-accept-strings",this.directive).at(n);const i=n.value;for(let r=0;r<i.length;r++){const s=Ef(i[r]);if(s===null)throw new Error("Invalid character, should not happen");const o=new rn(n.position.start+r,n.position.start+r+1),a=_n.numberLiteral(s,o);C(this,pi).push(a)}}else C(this,pi).push(n.value);if(C(this,pi).length===0)throw new le("must-have-one-or-more-values",this.directive).at(this)}evaluateExpressions(n){if(!C(this,pi))throw new Error("Data directive not validated");if(C(this,Lr))throw new Error("Data directive already evaluated");Y(this,Lr,[]);const i=xv(C(this,pi),r=>{if(r===Jd)C(this,Lr).push(Jd);else{const s=r.evaluate(n);if(!L.fits(s,this.size))throw new le("value-out-of-range",s,this.size).at(this);const o=L.fromNumber(s,this.size);C(this,Lr).push(o)}},le.from);return i.length>0&&Y(this,Lr,null),i}}pi=new WeakMap,Lr=new WeakMap;class u_{constructor(e){this.position=e}isString(){return this.type==="string"}isUnassigned(){return this.type==="unassigned"}isNumberExpression(){return this.type==="number-expression"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}class SX extends u_{constructor(n,i){super(i);oe(this,"type","string");this.value=n}toJSON(){return{...super.toJSON(),value:this.value}}}class kX extends u_{constructor(n){super(n);oe(this,"type","unassigned")}}class _X extends u_{constructor(n){super(n.position);oe(this,"type","number-expression");this.value=n}toJSON(){return{...super.toJSON(),value:this.value.toJSON()}}}function CX(t,e,n){const i=rn.merge(t.position,...e.map(r=>r.position));switch(t.type){case"DB":case"DW":return new xX(t.type,e,n,i);case"EQU":return new bX(e,n,i)}}class EX extends My{constructor(n){super(n);oe(this,"type","end")}}function kl(t){switch(t){case"AL":case"AX":return 0;case"CL":case"CX":return 1;case"DL":case"DX":return 2;case"BL":case"BX":return 3;case"AH":case"SP":return 4;case"CH":return 5;case"DH":return 6;case"BH":return 7}}var ro;class uu extends My{constructor(n,i,r){super(r);oe(this,"type","instruction");oe(this,"label");oe(this,"operands");Re(this,ro,null);this.operands=n,this.label=i}get start(){if(C(this,ro)===null)throw new Error("Start not set");return C(this,ro)}setStart(n){if(C(this,ro)!==null)throw new Error("Start already set");Y(this,ro,n)}toJSON(){return{...super.toJSON(),...C(this,ro)?{start:C(this,ro).toJSON()}:{},instruction:this.instruction,label:this.label}}}ro=new WeakMap;var jn,rr;class AX extends uu{constructor(n,i,r,s){super(i,r,s);Re(this,jn,null);Re(this,rr,null);this.instruction=n}get length(){if(!C(this,jn))throw new Error("Instruction not validated");const{mode:n,size:i,out:r,src:s}=C(this,jn);let o=2;return(n==="reg<-mem"&&s.mode==="direct"||(n==="mem<-reg"||n==="mem<-imd")&&r.mode==="direct")&&(o+=2),(n==="reg<-imd"||n==="mem<-imd")&&(o+=i/8),o}get operation(){if(!C(this,rr))throw new Error("Instruction not evaluated");return C(this,rr)}toBytes(){const{mode:n,size:i,out:r,src:s}=this.operation,o=[],a={MOV:128,AND:130,OR:132,XOR:134,ADD:136,ADC:138,SUB:140,SBB:142,CMP:144};switch(o[0]=a[this.instruction],i===16&&(o[0]|=1),n){case"reg<-reg":{o[1]=0,o[1]|=kl(s)<<3,o[1]|=kl(r)<<0;break}case"reg<-mem":{s.mode==="direct"?(o[1]=64,o.push(s.address.byte.low.unsigned),o.push(s.address.byte.high.unsigned)):o[1]=80,o[1]|=kl(r)<<0;break}case"reg<-imd":{o[1]=72,o[1]|=kl(r)<<0,o.push(s.low.unsigned),i===16&&o.push(s.high.unsigned);break}case"mem<-reg":{r.mode==="direct"?(o[1]=192,o.push(r.address.byte.low.unsigned),o.push(r.address.byte.high.unsigned)):o[1]=208,o[1]|=kl(s)<<0;break}case"mem<-imd":{r.mode==="direct"?(o[1]=200,o.push(r.address.byte.low.unsigned),o.push(r.address.byte.high.unsigned)):o[1]=216,o.push(s.low.unsigned),i===16&&o.push(s.high.unsigned);break}default:return n}return new Uint8Array(o)}toJSON(){return{...super.toJSON(),...C(this,rr)??C(this,jn)??{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(C(this,jn))throw new Error("Instruction already validated");if(this.operands.length!==2)throw new le("expects-two-operands").at(this);const[i,r]=this.operands;if(i.isRegister()){if(r.isRegister()){if(i.size!==r.size)throw new le("size-mismatch",r.size,i.size).at(this);Y(this,jn,{mode:"reg<-reg",size:i.size,out:i.value,src:r.value});return}if(r.isDirectAddress()){if(r.size!=="auto"&&r.size!==i.size)throw new le("size-mismatch",r.size,i.size).at(this);Y(this,jn,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"direct",address:r.value}});return}if(r.isIndirectAddress()){if(r.size!=="auto"&&r.size!==i.size)throw new le("size-mismatch",r.size,i.size).at(this);Y(this,jn,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"indirect"}});return}const s=r.getAsDirectAddress(n);if(s){if(s.size!==i.size)throw new le("size-mismatch",s.size,i.size).at(this);Y(this,jn,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"direct",address:s.expression}});return}Y(this,jn,{mode:"reg<-imd",size:i.size,out:i.value,src:r.value});return}else{let s,o;if(i.isIndirectAddress())s=i.size,o={mode:"indirect"};else if(i.isDirectAddress())s=i.size,o={mode:"direct",address:i.value};else{const a=i.getAsDirectAddress(n);if(a)s=a.size,o={mode:"direct",address:a.expression};else throw new le("destination-cannot-be-immediate").at(i)}if(r.isRegister()){if(s!=="auto"&&s!==r.size)throw new le("size-mismatch",s,r.size).at(this);Y(this,jn,{mode:"mem<-reg",size:r.size,out:o,src:r.value});return}if(r.isNumberExpression()){if(r.getAsDirectAddress(n))throw new le("double-memory-access").at(this);if(s==="auto")throw new le("unknown-size").at(i);Y(this,jn,{mode:"mem<-imd",size:s,out:o,src:r.value});return}throw new le("double-memory-access").at(this)}}evaluateExpressions(n){if(!C(this,jn))throw new Error("Instruction not validated");if(C(this,rr))throw new Error("Instruction aready evaluated");const{mode:i,size:r,out:s,src:o}=C(this,jn),a=l=>{const u=l.evaluate(n);if(!ye.inRange(u))throw new le("address-out-of-range",u).at(l);const c=ye.from(u);if(n.addressIsReserved(c))throw new le("address-has-code",c).at(l);return c};switch(i){case"reg<-reg":{Y(this,rr,{mode:i,size:r,out:s,src:o});return}case"reg<-mem":{Y(this,rr,{mode:i,size:r,out:s,src:o.mode==="direct"?{mode:"direct",address:a(o.address)}:{mode:"indirect"}});return}case"reg<-imd":{const l=o.evaluate(n);if(!L.fits(l,r))throw new le("value-out-of-range",l,r).at(o);const u=L.fromNumber(l,r);Y(this,rr,{mode:i,size:r,out:s,src:u});return}case"mem<-reg":{Y(this,rr,{mode:i,size:r,out:s.mode==="direct"?{mode:"direct",address:a(s.address)}:{mode:"indirect"},src:o});return}case"mem<-imd":{const l=o.evaluate(n);if(!L.fits(l,r))throw new le("value-out-of-range",l,r).at(o);const u=L.fromNumber(l,r);Y(this,rr,{mode:i,size:r,out:s.mode==="direct"?{mode:"direct",address:a(s.address)}:{mode:"indirect"},src:u});return}default:return i}}}jn=new WeakMap,rr=new WeakMap;var ws,so;class PX extends uu{constructor(n,i,r,s){super(i,r,s);Re(this,ws,null);Re(this,so,null);oe(this,"length",2);this.instruction=n}toBytes(){return new Uint8Array([26,this.value.unsigned])}get value(){if(!C(this,so))throw new Error("Instruction not evaluated");return C(this,so)}toJSON(){return{...super.toJSON(),...C(this,so)?{value:C(this,so).toJSON()}:C(this,ws)?{initialValue:C(this,ws).toJSON()}:{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(C(this,ws))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const n=this.operands[0];if(!n.isNumberExpression())throw new le("expects-immediate").at(n);Y(this,ws,n.value)}evaluateExpressions(n){if(!C(this,ws))throw new Error("Instruction not validated");if(C(this,so))throw new Error("Instruction aready evaluated");const i=C(this,ws).evaluate(n);if(!L.fitsUnsigned(i,8))throw new le("invalid-interrupt",i).at(C(this,ws));Y(this,so,L.fromUnsigned(i,8))}}ws=new WeakMap,so=new WeakMap;var jr,oo,aN;let TX=(aN=class extends uu{constructor(n,i,r,s){super(i,r,s);Re(this,jr,null);Re(this,oo,null);this.instruction=n}get length(){if(!C(this,jr))throw new Error("Instruction not validated");return C(this,jr).port==="fixed"?2:1}toBytes(){const n=[],i={IN:80,OUT:84};return n[0]=i[this.instruction],this.operation.size===16&&(n[0]|=1),this.operation.port==="fixed"?n[1]=this.operation.address.value:n[0]|=2,new Uint8Array(n)}get operation(){if(C(this,oo)===null)throw new Error("Operation not set");return C(this,oo)}toJSON(){return{...super.toJSON(),...C(this,oo)??C(this,jr)??{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(C(this,jr))throw new Error("Instruction already validated");if(this.operands.length!==2)throw new le("expects-two-operands").at(this);const n=this.operands[this.instruction==="IN"?0:1],i=this.operands[this.instruction==="IN"?1:0];if(!n.isRegister()||n.value!=="AL"&&n.value!=="AX")throw new le("expects-ax").at(n);const r=n.value==="AX"?16:8;if(i.isRegister()){if(i.value!=="DX")throw new le("expects-dx").at(i);Y(this,jr,{port:"variable",size:r});return}if(i.isNumberExpression()){Y(this,jr,{port:"fixed",size:r,address:i.value});return}throw new le("expects-immediate").at(i)}evaluateExpressions(n){if(!C(this,jr))throw new Error("Instruction not validated");if(C(this,oo))throw new Error("Instruction aready evaluated");const i=C(this,jr);if(i.port==="fixed"){const r=i.address.evaluate(n);if(!Yi.inRange(r))throw new le("io-address-out-of-range",r).at(this);const s=Yi.from(r);Y(this,oo,{port:"fixed",size:i.size,address:s})}else Y(this,oo,{port:"variable",size:i.size})}},jr=new WeakMap,oo=new WeakMap,aN);var ao,lo,lN;let RX=(lN=class extends uu{constructor(n,i,r,s){super(i,r,s);Re(this,ao,null);Re(this,lo,null);oe(this,"length",3);this.instruction=n}toBytes(){const n=[],i={JC:32,JNC:33,JZ:34,JNZ:35,JS:36,JNS:37,JO:38,JNO:39,JMP:48,CALL:49};return n.push(i[this.instruction]),n.push(this.address.byte.low.unsigned),n.push(this.address.byte.high.unsigned),new Uint8Array(n)}get address(){if(C(this,lo)===null)throw new Error("Instruction not evaluated");return C(this,lo)}toJSON(){return{...super.toJSON(),...C(this,lo)?{address:C(this,lo).toJSON()}:C(this,ao)?{jumpTo:C(this,ao)}:{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(C(this,ao))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const i=this.operands[0];if(!i.isNumberExpression()||!i.value.isLabel())throw new le("expects-label").at(i);const r=i.value.value,s=n.getLabelType(r);if(!s)throw new le("label-not-found",r).at(i);if(s!=="instruction")throw new le("label-should-be-an-instruction",r).at(i);Y(this,ao,r)}evaluateExpressions(n){if(!C(this,ao))throw new Error("Instruction not validated");if(C(this,lo))throw new Error("Instruction aready evaluated");const i=n.getLabelValue(C(this,ao));if(!ye.inRange(i))throw new le("address-out-of-range",i).at(this);Y(this,lo,ye.from(i))}},ao=new WeakMap,lo=new WeakMap,lN);var bs,uN;let NX=(uN=class extends uu{constructor(n,i,r,s){super(i,r,s);Re(this,bs,null);oe(this,"length",1);this.instruction=n}toBytes(){let i={PUSH:96,POP:104}[this.instruction];return i|=kl(this.register),new Uint8Array([i])}get register(){if(!C(this,bs))throw new Error("Instruction not evaluated");return C(this,bs)}toJSON(){return{...super.toJSON(),...C(this,bs)?{register:C(this,bs)}:{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(C(this,bs))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const n=this.operands[0];if(!n.isRegister()||n.size!==16)throw new le("expects-word-register").at(n);Y(this,bs,n.value)}evaluateExpressions(){if(!C(this,bs))throw new Error("Instruction not validated")}},bs=new WeakMap,uN);var Ii,xs;class MX extends uu{constructor(n,i,r,s){super(i,r,s);Re(this,Ii,null);Re(this,xs,null);this.instruction=n}get length(){if(!C(this,Ii))throw new Error("Instruction not validated");const{mode:n}=C(this,Ii);let i=2;return n==="mem-direct"&&(i+=2),i}toBytes(){const n=[],i={NOT:64,NEG:66,INC:68,DEC:70};switch(n[0]=i[this.instruction],this.operation.size===16&&(n[0]|=1),this.operation.mode){case"reg":{n[1]=0,n[1]|=kl(this.operation.reg);break}case"mem-direct":{n[1]=192;const r=this.operation.address.byte;n.push(r.low.unsigned),n.push(r.high.unsigned);break}case"mem-indirect":{n[1]=208;break}default:return this.operation}return new Uint8Array(n)}get operation(){if(!C(this,xs))throw new Error("Instruction not evaluated");return C(this,xs)}toJSON(){return{...super.toJSON(),...C(this,xs)??C(this,Ii)??{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(C(this,Ii))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const i=this.operands[0];if(i.isRegister()){Y(this,Ii,{mode:"reg",size:i.size,reg:i.value});return}if(i.isDirectAddress()){if(i.size==="auto")throw new le("unknown-size").at(i);Y(this,Ii,{mode:"mem-direct",size:i.size,address:i.value});return}if(i.isIndirectAddress()){if(i.size==="auto")throw new le("unknown-size").at(i);Y(this,Ii,{mode:"mem-indirect",size:i.size});return}const r=i.getAsDirectAddress(n);if(r){Y(this,Ii,{mode:"mem-direct",size:r.size,address:r.expression});return}throw new le("destination-cannot-be-immediate").at(i)}evaluateExpressions(n){if(!C(this,Ii))throw new Error("Instruction not validated");if(C(this,xs))throw new Error("Instruction aready evaluated");const i=C(this,Ii);switch(i.mode){case"reg":{Y(this,xs,{mode:"reg",size:i.size,reg:i.reg});return}case"mem-direct":{const r=i.address.evaluate(n);if(!ye.inRange(r))throw new le("address-out-of-range",r).at(i.address);const s=ye.from(r);if(n.addressIsReserved(s))throw new le("address-has-code",s).at(i.address);Y(this,xs,{mode:"mem-direct",size:i.size,address:s});return}case"mem-indirect":{Y(this,xs,{mode:"mem-indirect",size:i.size});return}default:return i}}}Ii=new WeakMap,xs=new WeakMap;var yc;class OX extends uu{constructor(n,i,r,s){super(i,r,s);Re(this,yc,!1);oe(this,"length",1);this.instruction=n}toBytes(){const n={PUSHF:112,POPF:120,RET:51,CLI:24,STI:25,IRET:59,NOP:16,HLT:17};return new Uint8Array([n[this.instruction]])}validate(){if(C(this,yc))throw new Error("Instruction already validated");if(this.operands.length>0)throw new le("expects-no-operands").at(this);Y(this,yc,!0)}evaluateExpressions(){if(!C(this,yc))throw new Error("Instruction not validated")}}yc=new WeakMap;class Oy{constructor(e){this.position=e}isRegister(){return this.type==="register"}isIndirectAddress(){return this.type==="indirect-address"}isDirectAddress(){return this.type==="direct-address"}isNumberExpression(){return this.type==="number-expression"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}class IX extends Oy{constructor(n){super(n.position);oe(this,"type","register");oe(this,"value");this.value=n.type}get size(){return gj.includes(this.value)?16:8}toJSON(){return{...super.toJSON(),value:this.value}}}class DX extends Oy{constructor(n,i){super(i);oe(this,"type","indirect-address");oe(this,"size");n?this.size=n==="BYTE"?8:16:this.size="auto"}toJSON(){return{...super.toJSON(),size:this.size}}}class LX extends Oy{constructor(n,i,r){super(r);oe(this,"type","direct-address");oe(this,"size");this.value=n,i?this.size=i==="BYTE"?8:16:this.size="auto"}toJSON(){return{...super.toJSON(),size:this.size,value:this.value.toJSON()}}}class kv extends Oy{constructor(n){super(n.position);oe(this,"type","number-expression");this.value=n}getAsDirectAddress(n){return kv.recursiveGetAsDirectAddress(this.value,n)}static recursiveGetAsDirectAddress(n,i){if(n.isLabel()){const r=n;if(r.offset)return!1;if(!i.labelExists(r.value))throw new le("label-not-found",r.value).at(n.position);const s=i.getLabelType(r.value),o=s==="DB"?8:s==="DW"?16:!1;return o?{size:o,expression:_n.label(r.value,!0,n.position)}:!1}else if(n.isBinaryOperation()){if(n.operator!=="+"&&n.operator!=="-")return!1;const r=kv.recursiveGetAsDirectAddress(n.left,i);return r?{size:r.size,expression:_n.binaryOperation(r.expression,n.operator,n.right,n.position)}:!1}return!1}toJSON(){return{...super.toJSON(),value:this.value.toJSON()}}}function kT(t,e,n){const i=rn.merge(t.position,...e.map(r=>r.position));switch(t.type){case"PUSHF":case"POPF":case"RET":case"IRET":case"CLI":case"STI":case"NOP":case"HLT":return new OX(t.type,e,n,i);case"MOV":case"ADD":case"ADC":case"SUB":case"SBB":case"CMP":case"AND":case"OR":case"XOR":return new AX(t.type,e,n,i);case"NEG":case"INC":case"DEC":case"NOT":return new MX(t.type,e,n,i);case"PUSH":case"POP":return new NX(t.type,e,n,i);case"CALL":case"JZ":case"JNZ":case"JS":case"JNS":case"JC":case"JNC":case"JO":case"JNO":case"JMP":return new RX(t.type,e,n,i);case"IN":case"OUT":return new TX(t.type,e,n,i);case"INT":return new PX(t.type,e,n,i)}}class jX extends My{constructor(n,i){super(i);oe(this,"type","origin-change");this.newAddress=n}toJSON(){return{...super.toJSON(),newAddress:this.newAddress}}}let FX=class{constructor(e){oe(this,"tokens");oe(this,"current",0);this.tokens=e}parse(){this.current=0;const e=[];for(;!this.isAtEnd();)this.match("EOL")||e.push(this.statement());return e}statement(){const e=this.originChangeStatement()??this.endStatement()??this.dataDirectiveStatement()??this.instructionStatement();if(!e){const n=this.peek();throw new le("parser.expected-instruction",n).at(n)}return e}originChangeStatement(){const e=this.match("ORG");if(!e)return null;const n=this.consume("NUMBER",new le("parser.expected-address-after-org")),i=this.parseNumber(n);return this.endOfStatement(),new jX(i,rn.merge(e.position,n.position))}endStatement(){const e=this.match("END");if(!e)return null;for(;!this.isAtEnd();)if(!this.match("EOL"))throw new le("end-must-be-the-last-statement").at(e);return new EX(e.position)}dataDirectiveStatement(){const e=this.match("IDENTIFIER"),n=this.match(...a_);if(e&&!n)throw new le("parser.unexpected-identifier").at(e);if(!n)return null;const i=(e==null?void 0:e.lexeme.toUpperCase())||null,r=[this.dataDirectiveValue()];for(;this.match("COMMA");)r.push(this.dataDirectiveValue());return this.endOfStatement(),CX(n,r,i)}dataDirectiveValue(){if(this.match("STRING")){const e=this.previous();return new SX(this.parseString(e),e.position)}if(this.match("QUESTION_MARK")){const e=this.previous();return new kX(e.position)}return new _X(this.numberExpression())}instructionStatement(){const e=this.match("LABEL");for(;this.match("EOL"););const n=this.match(...l_);if(e&&!n){const s=this.peek();throw new le("parser.expected-instruction-after-label",s).at(s)}if(!n)return null;const i=(e==null?void 0:e.lexeme.toUpperCase().slice(0,-1))||null;if(this.isAtEndOfStatement())return kT(n,[],i);const r=[this.instructionOperand()];for(;this.match("COMMA");)r.push(this.instructionOperand());return this.endOfStatement(),kT(n,r,i)}instructionOperand(){if(this.match(...Sv)){const n=this.previous();return new IX(n)}const e=this.match("BYTE","WORD");if(e&&this.consume("PTR",new le("parser.expected-literal-after-literal","PTR",this.previous().type)),this.match("LEFT_BRACKET")){const n=this.previous();if(this.check(...Sv)){this.consume("BX",new le("parser.indirect-addressing-must-be-bx"));const i=this.consume("RIGHT_BRACKET",new le("parser.expected-literal-after-literal","]","BX"));return new DX(e==null?void 0:e.type,rn.merge(e==null?void 0:e.position,n.position,i.position))}else{const i=this.numberExpression(),r=this.consume("RIGHT_BRACKET",new le("parser.expected-literal-after-expression","]"));return new LX(i,e==null?void 0:e.type,rn.merge(e==null?void 0:e.position,n.position,r.position))}}else if(e)throw new le("parser.expected-literal-after-literal","[","PTR");return new kv(this.numberExpression())}advance(){return this.tokens[this.current++]}check(...e){if(this.isAtEnd())return!1;for(const n of e)if(this.peek().type===n)return!0;return!1}consume(e,n){Array.isArray(e)||(e=[e]);const i=this.match(...e);if(i)return i;throw n||(n=new le("parser.expected-type",e.join(","),this.peek().type)),n.at(this.peek())}endOfStatement(){if(!this.isAtEnd()){if(this.check("EOL"))return this.advance();throw new le("parser.expected-eos").at(this.peek())}}isAtEnd(){return this.peek().type==="EOF"}isAtEndOfStatement(){return this.check("EOL")||this.isAtEnd()}match(...e){return this.check(...e)?this.advance():null}parseNumber(e){return e.lexeme.at(-1)==="h"||e.lexeme.at(-1)==="H"?parseInt(e.lexeme.slice(0,-1),16):e.lexeme.at(-1)==="b"||e.lexeme.at(-1)==="B"?parseInt(e.lexeme.slice(0,-1),2):parseInt(e.lexeme,10)}parseString(e){return e.lexeme.slice(1,-1)}peek(){return this.tokens[this.current]}previous(){return this.tokens[this.current-1]}primaryNE(){if(this.match("NUMBER")){const i=this.previous(),r=this.parseNumber(i);return _n.numberLiteral(r,i.position)}if(this.match("CHARACTER")){const i=this.previous(),r=Ef(i.lexeme.slice(1,-1));return _n.numberLiteral(r,i.position)}if(this.match("LEFT_PAREN")){const i=this.numberExpression();return this.consume("RIGHT_PAREN",new le("parser.unclosed-parenthesis")),i}const e=this.match("OFFSET"),n=this.match("IDENTIFIER");if(e&&!n)throw new le("parser.expected-label-after-offset").at(this.peek());if(!n)throw new le("parser.expected-argument").at(this.peek());return _n.label(n.lexeme.toUpperCase(),e!==null,rn.merge(e==null?void 0:e.position,n.position))}unaryNE(){if(this.match("PLUS","MINUS")){const e=this.previous();if(this.check("PLUS","MINUS"))throw new le("parser.ambiguous-unary").at(this.peek());const n=this.unaryNE();return _n.unaryOperation(e.type==="PLUS"?"+":"-",n,rn.merge(e.position,n.position))}return this.primaryNE()}factorNE(){let e=this.unaryNE();for(;this.match("ASTERISK");){const n=this.unaryNE();e=_n.binaryOperation(e,"*",n,rn.merge(e.position,n.position))}return e}termNE(){let e=this.factorNE();for(;this.match("PLUS","MINUS");){const n=this.previous(),i=this.factorNE();e=_n.binaryOperation(e,n.type==="PLUS"?"+":"-",i,rn.merge(e.position,i.position))}return e}numberExpression(){return this.termNE()}};function yj(t){try{const n=new mX(t).scanTokens(),r=new FX(n).parse(),s=r.at(-1);if(!s)throw new le("empty-program");if(!s.isEnd())throw new le("end-must-be-the-last-statement").at(s);let o=[];const a=new dX;if(o=a.loadStatements(r),o.length>0)return{success:!1,errors:o};if(o=xv(r,c=>{c.isOriginChange()||c.isEnd()||c.validate(a)},le.from),o.length>0)return{success:!1,errors:o};if(o=a.computeAddresses(r),o.length>0)return{success:!1,errors:o};const l=[],u=[];return o=xv(r,c=>{if(c.isDataDirective())if(c.directive==="EQU")c.evaluateExpressions(a);else{const d=c.evaluateExpressions(a);return l.push(c),d}else c.isInstruction()&&(c.evaluateExpressions(a),u.push(c))},le.from),o.length>0?{success:!1,errors:o}:{success:!0,data:l,instructions:u}}catch(e){return{success:!1,errors:[le.from(e)]}}}class ci{constructor(e){oe(this,"computer");this.computer=e.computer}}const BX=t=>ye.format(t).slice(-2),$X=BX(ye.MAX_ADDRESS),zX={"address-has-instruction":t=>`Memory address ${ye.format(t)} has an instruction, and cannot be written.`,"address-is-reserved":t=>`Memory address ${ye.format(t)} is reserved, and cannot be written.`,"address-out-of-range":t=>`Memory address ${ye.format(t)} is out of range (max memory address: ${$X}).`,"device-not-connected":t=>`"${t}" is not connected to the computer.`,"io-memory-not-connected":t=>`Didn't found a module connected to I/O memory address ${Yi.format(t)}.`,"no-instruction":t=>`Expected instruction at memory address ${ye.format(t)} but none was found.`,"no-program":"No program loaded. Assemble before running.","stack-overflow":"Stack overflow","stack-underflow":"Stack underflow","unexpected-error":t=>`Unexpected error: ${String(t)}`},UX=ye.from(ye.MAX_ADDRESS).toString(),VX={"address-has-instruction":t=>`La dirección de memoria ${ye.format(t)} tiene una instrucción, y no se puede escribir.`,"address-is-reserved":t=>`La dirección de memoria ${ye.format(t)} está reservada, y no se puede escribir.`,"address-out-of-range":t=>`La dirección de memoria ${ye.format(t)} está fuera de rango (dirección máxima de memoria: ${UX}).`,"device-not-connected":t=>`"${t}" no está conectado a la computadora.`,"io-memory-not-connected":t=>`No se encontró ningún módulo conectado a la dirección de memoria E/S ${Yi.format(t)}.`,"no-instruction":t=>`Se esperaba una instrucción en la dirección de memoria ${ye.format(t)} pero no se encontró ninguna.`,"no-program":"No hay ningún programa cargado. Ensamblá antes de ejecutar.","stack-overflow":"Stack overflow","stack-underflow":"Stack underflow","unexpected-error":t=>`Error inesperado: ${String(t)}`},HX=n_({en:zX,es:VX});class Ze extends Error{constructor(n,...i){super();oe(this,"code");oe(this,"context");this.code=n,this.context=i,n==="unexpected-error"&&console.error("[Unexpected Simulator Error]",...i)}translate(n){return HX(n,this.code,...this.context)}get message(){return this.translate("en")}toString(){return this.message}static from(n){return n instanceof Ze?n:new Ze("unexpected-error",n)}}class $o{constructor(e){this.statement=e}get name(){return this.statement.instruction}get start(){return this.statement.start}get position(){return this.statement.position}*consumeInstruction(e,n){if(yield*e.cpu.setMAR("IP"),!(yield*e.cpu.useBus("mem-read"))){const r=e.cpu.getRegister("IP").toString("hex");throw new Ze("unexpected-error",`Could not read instruction byte at address ${r}h`)}yield*e.cpu.updateWordRegister("IP",r=>r.add(1)),yield*e.cpu.getMBR(n)}}var Gv,wj;class WX extends $o{constructor(){super(...arguments);Re(this,Gv)}get operation(){return this.statement.operation}*execute(n){const{mode:i,size:r,out:s,src:o}=this.operation;if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:gt(this,Gv,wj).call(this),willUse:{ri:i==="reg<-mem"||i==="mem<-reg"||i==="mem<-imd"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},i==="reg<-reg"||i==="reg<-mem"||i==="reg<-imd")r===8?yield*n.cpu.copyByteRegister(s,"left.l"):yield*n.cpu.copyWordRegister(s,"left");else{if(s.mode==="direct"?(yield*this.consumeInstruction(n,"ri.l"),yield*this.consumeInstruction(n,"ri.h")):yield*n.cpu.copyWordRegister("BX","ri"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("left.l"),r===16){if(yield*n.cpu.updateWordRegister("ri",d=>d.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.h")}}if(i==="reg<-reg"||i==="mem<-reg")r===8?yield*n.cpu.copyByteRegister(o,"right.l"):yield*n.cpu.copyWordRegister(o,"right");else if(i==="reg<-imd"||i==="mem<-imd")yield*this.consumeInstruction(n,"right.l"),r===16&&(yield*this.consumeInstruction(n,"right.h"));else{if(o.mode==="direct"?(yield*this.consumeInstruction(n,"ri.l"),yield*this.consumeInstruction(n,"ri.h")):yield*n.cpu.copyWordRegister("BX","ri"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("right.l"),r===16){if(yield*n.cpu.updateWordRegister("ri",d=>d.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("right.h")}}yield{type:"cpu:cycle.update",phase:"execute"};const a=r===8?n.cpu.getRegister("left.l"):n.cpu.getRegister("left"),l=r===8?n.cpu.getRegister("right.l"):n.cpu.getRegister("right");let u;const c={};switch(this.name){case"AND":case"OR":case"XOR":{const d=this.name==="AND"?a.signed&l.signed:this.name==="OR"?a.signed|l.signed:a.signed^l.signed;u=L.fromSigned(d,r),c.CF=!1,c.OF=!1;break}case"ADD":case"ADC":{const d=this.name==="ADC"&&n.cpu.getFlag("CF")?1:0,h=a.unsigned+l.unsigned+d;h>L.maxValue(r)?(c.CF=!0,u=L.fromUnsigned(h-L.maxValue(r)-1,r)):(c.CF=!1,u=L.fromUnsigned(h,r)),c.OF=a.signed>=0&&l.signed>=0&&u.signed<0||a.signed<0&&l.signed<0&&u.signed>=0;break}case"SUB":case"SBB":case"CMP":{const d=this.name==="SBB"&&n.cpu.getFlag("CF")?1:0,h=a.unsigned-l.unsigned-d;h<0?(c.CF=!0,u=L.fromUnsigned(h+L.maxValue(r)+1,r)):(c.CF=!1,u=L.fromUnsigned(h,r)),c.OF=a.signed>=0&&l.signed<0&&u.signed<0||a.signed<0&&l.signed>=0&&u.signed>=0;break}}if(c.ZF=u.isZero(),c.SF=u.signed<0,yield*n.cpu.aluExecute(this.name==="CMP"?"SUB":this.name,u,c),this.name==="CMP")return!0;if(yield{type:"cpu:cycle.update",phase:"writeback"},i==="reg<-reg"||i==="reg<-mem"||i==="reg<-imd")r===8?yield*n.cpu.copyByteRegister("result.l",s):yield*n.cpu.copyWordRegister("result",s);else{if(r===16){if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.h"),!(yield*n.cpu.useBus("mem-write")))return!1;yield*n.cpu.updateWordRegister("ri",d=>d.add(-1))}if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.l"),!(yield*n.cpu.useBus("mem-write")))return!1}return!0}}Gv=new WeakSet,wj=function(){const{mode:n,out:i,src:r}=this.operation;switch(n){case"reg<-reg":return[i,r];case"reg<-mem":{const s=r.mode==="direct"?r.address.toString():"BX";return[i,`[${s}]`]}case"reg<-imd":return[i,`${r.toString("hex")}h`];case"mem<-reg":return[`[${i.mode==="direct"?i.address.toString():"BX"}]`,r];case"mem<-imd":return[`[${i.mode==="direct"?i.address.toString():"BX"}]`,`${r.toString("hex")}h`];default:return n}};var Kv,bj;class GX extends $o{constructor(){super(...arguments);Re(this,Kv)}get operation(){return this.statement.operation}*execute(n){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:gt(this,Kv,bj).call(this),willUse:{ri:this.operation.mode==="mem-direct"||this.operation.mode==="mem-indirect"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},this.operation.mode==="reg")this.operation.size===8?yield*n.cpu.copyByteRegister(this.operation.reg,"left.l"):yield*n.cpu.copyWordRegister(this.operation.reg,"left");else{if(this.operation.mode==="mem-direct"?(yield*this.consumeInstruction(n,"ri.l"),yield*this.consumeInstruction(n,"ri.h")):yield*n.cpu.copyWordRegister("BX","ri"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("left.l"),this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",o=>o.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.h")}}yield{type:"cpu:cycle.update",phase:"execute"};const i=this.operation.size===8?n.cpu.getRegister("left.l"):n.cpu.getRegister("left");let r;const s={};switch(this.name){case"NOT":{r=L.fromSigned(~i.signed,this.operation.size),s.CF=!1,s.OF=!1;break}case"NEG":{r=L.fromSigned(-i.signed,this.operation.size),s.CF=!i.isZero(),s.OF=i.signed===L.minSignedValue(this.operation.size);break}case"INC":{yield*n.cpu.updateWordRegister("right",L.fromSigned(1,16));const o=i.unsigned+1;o>L.maxValue(this.operation.size)?(s.CF=!0,r=L.fromUnsigned(o-L.maxValue(this.operation.size)-1,this.operation.size)):(s.CF=!1,r=L.fromUnsigned(o,this.operation.size)),s.OF=i.signed>=0&&r.signed<0;break}case"DEC":{yield*n.cpu.updateWordRegister("right",L.fromSigned(1,16));const o=i.unsigned-1;o<0?(s.CF=!0,r=L.fromUnsigned(o+L.maxValue(this.operation.size)+1,this.operation.size)):(s.CF=!1,r=L.fromUnsigned(o,this.operation.size)),s.OF=i.signed<0&&r.signed>=0;break}}if(s.ZF=r.isZero(),s.SF=r.signed<0,yield*n.cpu.aluExecute(this.name==="INC"?"ADD":this.name==="DEC"?"SUB":this.name,r,s),yield{type:"cpu:cycle.update",phase:"writeback"},this.operation.mode==="reg")this.operation.size===8?yield*n.cpu.copyByteRegister("result.l",this.operation.reg):yield*n.cpu.copyWordRegister("result",this.operation.reg);else{if(this.operation.size===16){if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.h"),!(yield*n.cpu.useBus("mem-write")))return!1;yield*n.cpu.updateWordRegister("ri",o=>o.add(-1))}if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.l"),!(yield*n.cpu.useBus("mem-write")))return!1}return!0}}Kv=new WeakSet,bj=function(){switch(this.operation.mode){case"reg":return[this.operation.reg];case"mem-direct":return[`[${this.operation.address.toString()}]`];case"mem-indirect":return["[BX]"];default:return this.operation}};class KX extends $o{get number(){return this.statement.value}*execute(e){return yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[this.number.toString("uint")],willUse:{id:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},yield*super.consumeInstruction(e,"ri.l"),yield{type:"cpu:cycle.update",phase:"execute"},yield*e.cpu.startInterrupt(this.number)}}var Xv,xj;class XX extends $o{constructor(){super(...arguments);Re(this,Xv)}get operation(){return this.statement.operation}*execute(n){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:gt(this,Xv,xj).call(this),willUse:{ri:!0}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},this.operation.port==="fixed")yield*n.cpu.updateWordRegister("ri",L.zero(16)),yield*super.consumeInstruction(n,"ri.l");else if(yield*n.cpu.copyWordRegister("DX","ri"),!n.cpu.getRegister("DX").high.isZero())return yield{type:"cpu:error",error:new Ze("io-memory-not-connected",n.cpu.getRegister("DX"))},!1;if(yield{type:"cpu:cycle.update",phase:"writeback"},this.name==="IN"){if(yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("io-read")))return!1;if(yield*n.cpu.getMBR("AL"),this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",i=>i.add(1)),yield*n.cpu.setMAR("ri"),!n.cpu.getRegister("ri.h").isZero())return yield{type:"cpu:error",error:new Ze("io-memory-not-connected",n.cpu.getRegister("ri"))},!1;if(!(yield*n.cpu.useBus("io-read")))return!1;yield*n.cpu.getMBR("AH")}}else{if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("AL"),!(yield*n.cpu.useBus("io-write")))return!1;if(this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",i=>i.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("AH"),!n.cpu.getRegister("ri.h").isZero())return yield{type:"cpu:error",error:new Ze("io-memory-not-connected",n.cpu.getRegister("ri"))},!1;if(!(yield*n.cpu.useBus("io-write")))return!1}}return!0}}Xv=new WeakSet,xj=function(){const n=[];return this.operation.port==="variable"?n.push("DX"):n.push(this.operation.address.toString()),this.operation.size===8?n.push("AL"):n.push("AX"),this.name==="IN"?n.reverse():n};class qX extends $o{get jumpTo(){return this.statement.address}*execute(e){yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[this.jumpTo.toString()],willUse:{id:this.name==="CALL",ri:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},yield*super.consumeInstruction(e,"ri.l"),yield*super.consumeInstruction(e,"ri.h"),yield{type:"cpu:cycle.update",phase:"execute"};let n;switch(this.name){case"JC":n=e.cpu.getFlag("CF");break;case"JNC":n=!e.cpu.getFlag("CF");break;case"JZ":n=e.cpu.getFlag("ZF");break;case"JNZ":n=!e.cpu.getFlag("ZF");break;case"JS":n=e.cpu.getFlag("SF");break;case"JNS":n=!e.cpu.getFlag("SF");break;case"JO":n=e.cpu.getFlag("OF");break;case"JNO":n=!e.cpu.getFlag("OF");break;case"CALL":case"JMP":n=!0;break;default:return this.name}if(n){if(this.name==="CALL"&&(yield*e.cpu.copyWordRegister("IP","id"),!(yield*e.cpu.pushToStack())))return!1;yield*e.cpu.copyWordRegister("ri","IP")}return!0}}class YX extends $o{*execute(e){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[],willUse:{}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},this.name==="CLI")yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield*e.cpu.updateFLAGS({IF:!1});else if(this.name==="STI")yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield*e.cpu.updateFLAGS({IF:!0});else if(this.name==="HLT")return yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield{type:"cpu:halt"},!1;return!0}}function _l(t){switch(t){case"AL":return["AX","low"];case"AH":return["AX","high"];case"BL":return["BX","low"];case"BH":return["BX","high"];case"CL":return["CX","low"];case"CH":return["CX","high"];case"DL":return["DX","low"];case"DH":return["DX","high"];default:{const[e,n]=t.split(".");return[e,n==="l"?"low":n==="h"?"high":null]}}}function JX(t){switch(t){case"AX":return["AL","AH"];case"BX":return["BL","BH"];case"CX":return["CL","CH"];case"DX":return["DL","DH"];case"SP":return["SP.l","SP.h"];case"IP":return["IP.l","IP.h"];case"ri":return["ri.l","ri.h"];case"id":return["id.l","id.h"];case"left":return["left.l","left.h"];case"right":return["right.l","right.h"];case"result":return["result.l","result.h"];case"FLAGS":return["FLAGS.l","FLAGS.h"];default:return[t,null]}}var qv,Sj;class ZX extends $o{constructor(){super(...arguments);Re(this,qv)}get operation(){return this.statement.operation}*execute(n){const{mode:i,size:r,out:s,src:o}=this.operation;switch(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:gt(this,qv,Sj).call(this),willUse:{ri:i==="reg<-mem"||i==="mem<-reg"||i==="mem<-imd",id:i==="reg<-mem"||i==="reg<-imd"||i==="mem<-imd"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},(this.operation.mode==="reg<-mem"||this.operation.mode==="mem<-reg"||this.operation.mode==="mem<-imd")&&((this.operation.mode==="reg<-mem"?this.operation.src.mode:this.operation.out.mode)==="direct"?(yield*super.consumeInstruction(n,"ri.l"),yield*super.consumeInstruction(n,"ri.h")):yield*n.cpu.copyWordRegister("BX","ri")),(this.operation.mode==="reg<-imd"||this.operation.mode==="mem<-imd")&&(yield*super.consumeInstruction(n,"id.l"),this.operation.size===16&&(yield*super.consumeInstruction(n,"id.h"))),yield{type:"cpu:cycle.update",phase:"writeback"},i){case"reg<-reg":return r===8?yield*n.cpu.copyByteRegister(o,s):yield*n.cpu.copyWordRegister(o,s),!0;case"reg<-mem":{if(yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("id.l"),r===16){if(yield*n.cpu.updateWordRegister("ri",a=>a.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("id.h"),yield*n.cpu.copyWordRegister("id",s)}else yield*n.cpu.copyByteRegister("id.l",s);return!0}case"reg<-imd":return r===8?yield*n.cpu.copyByteRegister("id.l",s):yield*n.cpu.copyWordRegister("id",s),!0;case"mem<-reg":{const[a,l]=JX(o);return yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR(a),!(!(yield*n.cpu.useBus("mem-write"))||l&&(yield*n.cpu.updateWordRegister("ri",u=>u.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR(l),!(yield*n.cpu.useBus("mem-write"))))}case"mem<-imd":return yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("id.l"),!(!(yield*n.cpu.useBus("mem-write"))||r===16&&(yield*n.cpu.updateWordRegister("ri",a=>a.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("id.h"),!(yield*n.cpu.useBus("mem-write"))));default:return i}}}qv=new WeakSet,Sj=function(){const{mode:n,out:i,src:r}=this.operation;switch(n){case"reg<-reg":return[i,r];case"reg<-mem":{const s=r.mode==="direct"?r.address.toString():"BX";return[i,`[${s}]`]}case"reg<-imd":return[i,`${r.toString("hex")}h`];case"mem<-reg":return[`[${i.mode==="direct"?i.address.toString():"BX"}]`,r];case"mem<-imd":return[`[${i.mode==="direct"?i.address.toString():"BX"}]`,`${r.toString("hex")}h`];default:return n}};class QX extends $o{*execute(e){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[],willUse:{id:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},!(yield*e.cpu.popFromStack()))return!1;if(yield*e.cpu.copyWordRegister("id","IP"),this.name==="IRET"){if(!(yield*e.cpu.popFromStack()))return!1;yield*e.cpu.copyWordRegister("id","FLAGS")}return!0}}class eq extends $o{*execute(e){const n=this.statement.instruction==="PUSH"||this.statement.instruction==="POP"?this.statement.register:"FLAGS";return yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:n!=="FLAGS"?[n]:[],willUse:{id:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},this.name==="PUSH"||this.name==="PUSHF"?(yield*e.cpu.copyWordRegister(n,"id"),yield*e.cpu.pushToStack()):(yield*e.cpu.popFromStack())?(yield*e.cpu.copyWordRegister("id",n),!0):!1}}function tq(t){switch(t.instruction){case"MOV":return new ZX(t);case"AND":case"OR":case"XOR":case"ADD":case"ADC":case"SUB":case"SBB":case"CMP":return new WX(t);case"NOT":case"NEG":case"INC":case"DEC":return new GX(t);case"IN":case"OUT":return new XX(t);case"PUSH":case"POP":case"PUSHF":case"POPF":return new eq(t);case"JC":case"JNC":case"JZ":case"JNZ":case"JS":case"JNS":case"JO":case"JNO":case"JMP":case"CALL":return new qX(t);case"RET":case"IRET":return new QX(t);case"INT":return new KX(t);case"CLI":case"STI":case"NOP":case"HLT":return new YX(t)}}function nq(t){for(const[e,n]of o_)if(n.unsigned===t.unsigned)return e;return null}function*iq(t,e){switch(e){case 0:return yield{type:"cpu:int.0"},!1;case 3:{yield{type:"cpu:int.3"};break}case 6:{if(yield{type:"cpu:int.6"},!("keyboard"in t.io))return yield{type:"cpu:error",error:new Ze("device-not-connected","keyboard")},!1;yield*t.cpu.copyWordRegister("BX","ri");const n=yield*t.io.keyboard.readChar();if(yield*t.cpu.updateWordRegister("id",n.withHigh(L.zero(8))),yield*t.cpu.setMAR("ri"),yield*t.cpu.setMBR("id.l"),!(yield*t.cpu.useBus("mem-write")))return!1;break}case 7:{if(yield{type:"cpu:int.7"},!("screen"in t.io))return yield{type:"cpu:error",error:new Ze("device-not-connected","screen")},!1;if(yield*t.cpu.copyWordRegister("AX","id"),!(yield*t.cpu.pushToStack())||(yield*t.cpu.copyWordRegister("BX","id"),!(yield*t.cpu.pushToStack())))return!1;yield*t.cpu.copyByteRegister("AL","left.l"),yield*t.cpu.updateByteRegister("right.l",L.zero(8));const n=t.cpu.getRegister("AL");for(yield*t.cpu.aluExecute("SUB",n,{CF:!1,OF:!1,SF:n.signed<0,ZF:n.isZero()});!t.cpu.getRegister("AL").isZero();){if(yield*t.cpu.copyWordRegister("BX","ri"),yield*t.cpu.setMAR("ri"),!(yield*t.cpu.useBus("mem-read")))return!1;yield*t.cpu.getMBR("id.l");const i=t.cpu.getRegister("id.l");yield*t.io.screen.sendChar(i),yield*t.cpu.copyWordRegister("BX","left"),yield*t.cpu.updateWordRegister("right",L.fromUnsigned(1,16));const r=t.cpu.getRegister("BX").add(1);yield*t.cpu.aluExecute("ADD",r,{CF:!1,OF:r.signed<0,SF:r.signed<0,ZF:!1}),yield*t.cpu.copyWordRegister("result","BX"),yield*t.cpu.copyByteRegister("AL","left.l"),yield*t.cpu.updateByteRegister("right.l",L.fromUnsigned(1,8));const s=t.cpu.getRegister("AL").add(-1);yield*t.cpu.aluExecute("SUB",s,{CF:!1,OF:s.signed===L.maxSignedValue(8),SF:s.signed<0,ZF:s.isZero()}),yield*t.cpu.copyByteRegister("result.l","AL")}if(!(yield*t.cpu.popFromStack())||(yield*t.cpu.copyWordRegister("id","BX"),!(yield*t.cpu.popFromStack())))return!1;yield*t.cpu.copyWordRegister("id","AX");break}default:throw new Error("Invalid interrupt number")}return!(yield*t.cpu.popFromStack())||(yield*t.cpu.copyWordRegister("id","IP"),!(yield*t.cpu.popFromStack()))?!1:(yield*t.cpu.copyWordRegister("id","FLAGS"),!0)}var wc,He,Di,Xn,qt,Cu,ir,cN;let rq=(cN=class extends ci{constructor(n){super(n);Re(this,qt);Re(this,wc);Re(this,He);Re(this,Di);Re(this,Xn);n.data==="unchanged"?(Y(this,He,C(n.previous.cpu,He)),Y(this,Di,C(n.previous.cpu,Di)),Y(this,Xn,C(n.previous.cpu,Xn))):n.data==="randomize"?(Y(this,He,{AX:L.random(16),BX:L.random(16),CX:L.random(16),DX:L.random(16),SP:L.random(16),IP:L.random(16),IR:L.random(8),ri:L.random(16),id:L.random(16),left:L.random(16),right:L.random(16),result:L.random(16),FLAGS:L.random(16)}),Y(this,Di,L.random(16)),Y(this,Xn,L.random(8))):(Y(this,He,{AX:L.zero(16),BX:L.zero(16),CX:L.zero(16),DX:L.zero(16),SP:L.zero(16),IP:L.zero(16),IR:L.zero(8),ri:L.zero(16),id:L.zero(16),left:L.zero(16),right:L.zero(16),result:L.zero(16),FLAGS:L.zero(16)}),Y(this,Di,L.zero(16)),Y(this,Xn,L.zero(8))),C(this,He).SP=L.fromUnsigned(ye.MAX_ADDRESS+1,16),C(this,He).IP=L.fromUnsigned(32,16),gt(this,qt,ir).call(this,"IF",!0),Y(this,wc,new Map);for(const i of n.program.instructions){const r=tq(i);C(this,wc).set(r.start.value,r)}}*run(){for(;;){const n=C(this,He).IP,i=nq(n);if(i!==null){if(!(yield*iq(this.computer,i)))return}else{const r=C(this,wc).get(n.unsigned);if(!r){yield{type:"cpu:error",error:new Ze("no-instruction",C(this,He).IP)};return}if(!(yield*r.execute(this.computer)))return}if(this.getFlag("IF")&&"pic"in this.computer.io&&this.computer.io.pic.isINTRActive()){yield{type:"cpu:cycle.interrupt"};const r=yield*this.computer.io.pic.handleINTR();yield*this.getMBR("ri.l"),yield*this.updateByteRegister("ri.h",L.zero(8)),yield*this.startInterrupt(r)}yield{type:"cpu:cycle.end"}}}*startInterrupt(n){if(yield*this.copyWordRegister("FLAGS","id"),!(yield*this.pushToStack())||(yield*this.updateFLAGS({IF:!1}),yield*this.copyWordRegister("IP","id"),!(yield*this.pushToStack())))return!1;let i=L.fromUnsigned(n.unsigned*4,16);return yield*this.updateWordRegister("ri",i),yield*this.setMAR("ri"),!(yield*this.useBus("mem-read"))||(yield*this.getMBR("id.l"),i=i.add(1),yield*this.updateWordRegister("ri",i),yield*this.setMAR("ri"),!(yield*this.useBus("mem-read")))?!1:(yield*this.getMBR("id.h"),yield*this.copyWordRegister("id","IP"),!0)}toJSON(){return{...Object.entries(C(this,He)).reduce((i,[r,s])=>({...i,[r]:s.toJSON()}),{}),MAR:C(this,Di).toJSON(),MBR:C(this,Xn).toJSON()}}getRegister(n){const[i,r]=_l(n);return r==="low"?C(this,He)[i].low:r==="high"?C(this,He)[i].high:C(this,He)[i]}*copyByteRegister(n,i){const r=this.getRegister(n);gt(this,qt,Cu).call(this,i,r),yield{type:"cpu:register.copy",size:8,src:n,dest:i}}*copyWordRegister(n,i){const r=this.getRegister(n);gt(this,qt,Cu).call(this,i,r),yield{type:"cpu:register.copy",size:16,src:n,dest:i}}*updateByteRegister(n,i){i=typeof i=="function"?i(this.getRegister(n)):i,gt(this,qt,Cu).call(this,n,i),yield{type:"cpu:register.update",size:8,register:n,value:i}}*updateWordRegister(n,i){i=typeof i=="function"?i(this.getRegister(n)):i,gt(this,qt,Cu).call(this,n,i),yield{type:"cpu:register.update",size:16,register:n,value:i}}getFlag(n){switch(n){case"CF":return C(this,He).FLAGS.bit(0);case"ZF":return C(this,He).FLAGS.bit(6);case"SF":return C(this,He).FLAGS.bit(7);case"IF":return C(this,He).FLAGS.bit(9);case"OF":return C(this,He).FLAGS.bit(11);default:throw new TypeError(`Invalid flag ${n}`)}}*updateFLAGS(n){typeof n.CF=="boolean"&&gt(this,qt,ir).call(this,"CF",n.CF),typeof n.ZF=="boolean"&&gt(this,qt,ir).call(this,"ZF",n.ZF),typeof n.SF=="boolean"&&gt(this,qt,ir).call(this,"SF",n.SF),typeof n.IF=="boolean"&&gt(this,qt,ir).call(this,"IF",n.IF),typeof n.OF=="boolean"&&gt(this,qt,ir).call(this,"OF",n.OF),yield{type:"cpu:register.update",size:16,register:"FLAGS",value:C(this,He).FLAGS}}*aluExecute(n,i,r){C(this,He).result=i.is8bits()?C(this,He).result.withLow(i):i,typeof r.CF=="boolean"&&gt(this,qt,ir).call(this,"CF",r.CF),typeof r.ZF=="boolean"&&gt(this,qt,ir).call(this,"ZF",r.ZF),typeof r.SF=="boolean"&&gt(this,qt,ir).call(this,"SF",r.SF),typeof r.IF=="boolean"&&gt(this,qt,ir).call(this,"IF",r.IF),typeof r.OF=="boolean"&&gt(this,qt,ir).call(this,"OF",r.OF),yield{type:"cpu:alu.execute",operation:n,size:i.size,result:C(this,He).result,flags:C(this,He).FLAGS}}*setMAR(n){const i=this.getRegister(n);Y(this,Di,i),yield{type:"cpu:mar.set",register:n}}*getMBR(n){gt(this,qt,Cu).call(this,n,C(this,Xn)),yield{type:"cpu:mbr.get",register:n}}*setMBR(n){const i=this.getRegister(n);Y(this,Xn,i),yield{type:"cpu:mbr.set",register:n}}*useBus(n){switch(n){case"mem-read":{yield{type:"cpu:rd.on"};const i=yield*this.computer.memory.read(C(this,Di));return i?(Y(this,Xn,i),yield{type:"bus:reset"},!0):!1}case"mem-write":return yield{type:"cpu:wr.on"},(yield*this.computer.memory.write(C(this,Di),C(this,Xn)))?(yield{type:"bus:reset"},!0):!1;case"io-read":{yield{type:"cpu:iom.on"};const i=yield*this.computer.io.chipSelect(C(this,Di).low);if(!i)return!1;yield{type:"cpu:rd.on"};const r=yield*this.computer.io.read(i);return r?(Y(this,Xn,r),yield{type:"bus:reset"},!0):!1}case"io-write":{yield{type:"cpu:iom.on"};const i=yield*this.computer.io.chipSelect(C(this,Di).low);return!i||(yield{type:"cpu:wr.on"},!(yield*this.computer.io.write(i,C(this,Xn))))?!1:(yield{type:"bus:reset"},!0)}case"intr-read":{if(!("pic"in this.computer.io))return!1;const i=yield*this.computer.io.pic.handleINTR();return Y(this,Xn,i),yield{type:"bus:reset"},!0}default:return n}}*pushToStack(){let n=this.getRegister("SP");return ye.inRange(n.unsigned-1)?(n=n.add(-1),yield*this.updateWordRegister("SP",n),yield*this.setMAR("SP"),yield*this.setMBR("id.h"),(yield*this.useBus("mem-write"))?ye.inRange(n.unsigned-1)?(n=n.add(-1),yield*this.updateWordRegister("SP",n),yield*this.setMAR("SP"),yield*this.setMBR("id.l"),!!(yield*this.useBus("mem-write"))):(yield{type:"cpu:error",error:new Ze("stack-overflow")},!1):!1):(yield{type:"cpu:error",error:new Ze("stack-overflow")},!1)}*popFromStack(){let n=this.getRegister("SP");return ye.inRange(n)?(yield*this.setMAR("SP"),(yield*this.useBus("mem-read"))?(yield*this.getMBR("id.l"),n=n.add(1),yield*this.updateWordRegister("SP",n),ye.inRange(n)?(yield*this.setMAR("SP"),(yield*this.useBus("mem-read"))?(yield*this.getMBR("id.h"),n=n.add(1),yield*this.updateWordRegister("SP",n),!0):!1):(yield{type:"cpu:error",error:new Ze("stack-underflow")},!0)):!1):(yield{type:"cpu:error",error:new Ze("stack-underflow")},!1)}},wc=new WeakMap,He=new WeakMap,Di=new WeakMap,Xn=new WeakMap,qt=new WeakSet,Cu=function(n,i){const[r,s]=_l(n);if(s===null){if(C(this,He)[r].size!==i.size)throw new TypeError(`Cannot set register ${n} with value ${i} of different size`);C(this,He)[r]=i}else{if(!i.is8bits())throw new TypeError(`Cannot set register ${n} with value ${i} of different size`);s==="low"?C(this,He)[r]=C(this,He)[r].withLow(i):C(this,He)[r]=C(this,He)[r].withHigh(i)}},ir=function(n,i){switch(n){case"CF":C(this,He).FLAGS=C(this,He).FLAGS.withBit(0,i);return;case"ZF":C(this,He).FLAGS=C(this,He).FLAGS.withBit(6,i);return;case"SF":C(this,He).FLAGS=C(this,He).FLAGS.withBit(7,i);return;case"IF":C(this,He).FLAGS=C(this,He).FLAGS.withBit(9,i);return;case"OF":C(this,He).FLAGS=C(this,He).FLAGS.withBit(11,i);return;default:throw new TypeError(`Invalid flag ${n}`)}},cN),c_=class extends ci{*tick(){yield{type:"clock:tick"},yield*this.computer.io.timer.tick()}toJSON(){return null}},d_=class extends ci{*press(){yield{type:"f10:press"},yield*this.computer.io.pic.interrupt(0)}toJSON(){return null}};var bc,dN;let Iy=(dN=class extends ci{constructor(){super(...arguments);Re(this,bc,null)}*readChar(){yield{type:"keyboard:listen-key"};const n=C(this,bc);if(!n)throw new Error("INT 6 was not given a valid 8-bit character!");return yield{type:"keyboard:read",char:n},Y(this,bc,null),n}setLastCharRead(n){Y(this,bc,n)}toJSON(){return null}},bc=new WeakMap,dN);var Li,hN;let Dy=(hN=class extends ci{constructor(n){super(n);Re(this,Li);n.data==="unchanged"&&"screen"in n.previous.io?Y(this,Li,C(n.previous.io.screen,Li)):Y(this,Li,"")}clear(){return this.sendChar(L.fromUnsigned(12,8))}*sendChar(n){switch(n.unsigned){case 8:Y(this,Li,C(this,Li).slice(0,-1));break;case 10:Y(this,Li,C(this,Li)+`
`);break;case 12:Y(this,Li,"");break;default:Y(this,Li,C(this,Li)+s_(n.unsigned));break}yield{type:"screen:send-char",char:n,output:C(this,Li)}}toJSON(){return C(this,Li)}},Li=new WeakMap,hN);class Ly extends ci{}var Gr,uo,mi,qn,Fr,Fs,lg,ug;let h_=(Gr=class extends Ly{constructor(n){super(n);Re(this,Fs);Re(this,uo);Re(this,mi);Re(this,qn);Re(this,Fr);Y(this,uo,L.fromUnsigned(255,8)),Y(this,mi,L.fromUnsigned(0,8)),Y(this,qn,L.fromUnsigned(0,8)),n.data==="unchanged"&&"pic"in n.previous.io?Y(this,Fr,C(n.previous.io.pic,Fr)):n.data==="randomize"?Y(this,Fr,new Array(Gr.LINES).fill(L.zero(8)).map(()=>L.random(8))):Y(this,Fr,new Array(Gr.LINES).fill(L.zero(8)))}chipSelect(n){const r=4+Gr.LINES;return n=Number(n)-32,n<0||n>=r?null:n===0?"EOI":n===1?"IMR":n===2?"IRR":n===3?"ISR":`INT${n-4}`}*read(n){yield{type:"pic:read",register:n};let i;if(n==="EOI")i=L.zero(8);else if(n==="IMR")i=C(this,uo);else if(n==="IRR")i=C(this,mi);else if(n==="ISR")i=C(this,qn);else{const r=Number(n.slice(3));i=C(this,Fr)[r]}return yield{type:"pic:read.ok",value:i},i}*write(n,i){if(yield{type:"pic:write",register:n,value:i},n==="EOI")C(this,qn).isZero()||(yield{type:"pic:intr.off"},Y(this,qn,L.zero(8)),yield{type:"pic:register.update",register:"ISR",value:C(this,qn)},yield*gt(this,Fs,ug).call(this));else if(n==="IMR")Y(this,uo,i),yield{type:"pic:register.update",register:"IMR",value:C(this,uo)},yield*gt(this,Fs,ug).call(this);else if(!(n==="IRR"||n==="ISR")){const r=Number(n.slice(3));C(this,Fr)[r]=i,yield{type:"pic:register.update",register:n,value:i}}yield{type:"pic:write.ok"}}*interrupt(n){if(n<0||n>=Gr.LINES)throw new RangeError(`Invalid interrupt line ${n}`);C(this,mi).bit(n)||(Y(this,mi,C(this,mi).withBit(n,!0)),yield{type:"pic:register.update",register:"IRR",value:C(this,mi)},yield*gt(this,Fs,ug).call(this))}isINTRActive(){return C(this,qn).isZero()&&gt(this,Fs,lg).call(this)!==null}*handleINTR(){if(yield{type:"cpu:inta.on"},!C(this,qn).isZero())throw new Error("INTR line is active but ISR is not zero");const n=gt(this,Fs,lg).call(this);if(n===null)throw new Error("INTR line is active but no interrupt is pending");Y(this,qn,C(this,qn).withBit(n,!0)),yield{type:"pic:register.update",register:"ISR",value:C(this,qn)},Y(this,mi,C(this,mi).withBit(n,!1)),yield{type:"pic:register.update",register:"IRR",value:C(this,mi)},yield{type:"cpu:inta.off"},yield{type:"cpu:inta.on"};const i=C(this,Fr)[n];return yield{type:"pic:int.send",number:i},yield{type:"cpu:inta.off"},yield{type:"pic:intr.off"},i}toJSON(){return{IMR:C(this,uo).toJSON(),IRR:C(this,mi).toJSON(),ISR:C(this,qn).toJSON(),lines:C(this,Fr).map(n=>n.toJSON())}}},uo=new WeakMap,mi=new WeakMap,qn=new WeakMap,Fr=new WeakMap,Fs=new WeakSet,lg=function(){for(let n=0;n<Gr.LINES;n++)if(C(this,mi).bit(n)&&!C(this,uo).bit(n))return n;return null},ug=function*(){C(this,qn).isZero()&&gt(this,Fs,lg).call(this)!==null&&(yield{type:"pic:intr.on"})},oe(Gr,"LINES",8),Gr);var Ss,la,fN;let f_=(fN=class extends Ly{constructor(n){super(n);Re(this,Ss);Re(this,la);Y(this,Ss,L.zero(8)),Y(this,la,L.zero(8))}chipSelect(n){return n=Number(n),n===16?"CONT":n===17?"COMP":null}*read(n){yield{type:"timer:read",register:n};let i;if(n==="CONT")i=C(this,Ss);else if(n==="COMP")i=C(this,la);else return n;return yield{type:"timer:read.ok",value:i},i}*write(n,i){if(yield{type:"timer:write",register:n,value:i},n==="CONT")Y(this,Ss,i);else if(n==="COMP")Y(this,la,i);else return n;yield{type:"timer:register.update",register:n,value:i},yield{type:"timer:write.ok"}}*tick(){const n=C(this,Ss).unsigned===L.maxValue(8)?L.zero(8):C(this,Ss).add(1);Y(this,Ss,n),yield{type:"timer:register.update",register:"CONT",value:n},C(this,la).equals(n)?(yield{type:"timer:int.on"},yield*this.computer.io.pic.interrupt(1)):yield{type:"timer:int.off"}}toJSON(){return{CONT:C(this,Ss).toJSON(),COMP:C(this,la).toJSON()}}},Ss=new WeakMap,la=new WeakMap,fN);var ks,Yn,pN;let sq=(pN=class extends Ly{constructor(n){super(n);Re(this,ks);Re(this,Yn);n.data==="unchanged"&&"handshake"in n.previous.io?Y(this,ks,L.zero(8)):n.data==="randomize"?Y(this,ks,L.random(8)):Y(this,ks,L.zero(8)),Y(this,Yn,L.zero(8))}get interrupts(){return C(this,Yn).bit(7)}get DATA(){return C(this,ks)}chipSelect(n){return n=Number(n),n===64?"DATA":n===65?"STATE":null}*read(n){yield{type:"handshake:read",register:n};let i;if(n==="DATA")i=C(this,ks);else if(n==="STATE")i=C(this,Yn);else return n;return yield{type:"handshake:read.ok",value:i},i}*write(n,i){if(yield{type:"handshake:write",register:n,value:i},n==="DATA")Y(this,ks,i),yield{type:"handshake:register.update",register:n,value:i},yield*this.computer.io.printer.setStrobe(!0),yield*this.computer.io.printer.setStrobe(!1);else if(n==="STATE")i=i.withBit(0,this.computer.io.printer.busy),Y(this,Yn,i),yield{type:"handshake:register.update",register:n,value:i},C(this,Yn).bit(1)?(yield*this.computer.io.printer.setStrobe(!0),yield*this.computer.io.printer.setStrobe(!1),Y(this,Yn,C(this,Yn).withBit(1,!1)),yield{type:"handshake:register.update",register:n,value:C(this,Yn)}):this.interrupts&&!this.computer.io.printer.busy?(yield{type:"handshake:int.on"},yield*this.computer.io.pic.interrupt(2)):yield{type:"handshake:int.off"};else return n;yield{type:"handshake:write.ok"}}*updateBusy(n){Y(this,Yn,C(this,Yn).withBit(0,n)),yield{type:"handshake:register.update",register:"STATE",value:C(this,Yn)},this.interrupts&&!n?(yield{type:"handshake:int.on"},yield*this.computer.io.pic.interrupt(2)):yield{type:"handshake:int.off"}}toJSON(){return{DATA:C(this,ks).toJSON(),STATE:C(this,Yn).toJSON()}}},ks=new WeakMap,Yn=new WeakMap,pN);var sr,co,ua;const Eh=class Eh extends ci{constructor(n){super(n);Re(this,sr);Re(this,co);Re(this,ua,!1);this.computer=n.computer,n.data==="unchanged"&&"printer"in n.previous.io?(Y(this,sr,C(n.previous.io.printer,sr)),Y(this,co,C(n.previous.io.printer,co)),Y(this,ua,C(n.previous.io.printer,ua))):(Y(this,sr,[]),Y(this,co,""),Y(this,ua,!1))}get busy(){return C(this,sr).length>=Eh.BUFFER_SIZE}*setStrobe(n){const i=C(this,ua);if(i===n)return;if(Y(this,ua,n),n?yield{type:"printer:strobe.on"}:yield{type:"printer:strobe.off"},n&&!i&&!this.busy){const s=yield*this.readData();C(this,sr).push(s),yield{type:"printer:buffer.add",char:s},yield*this.updateBusy(!0),this.busy||(yield*this.updateBusy(!1))}}*clear(){Y(this,co,""),yield{type:"printer:paper.replace"}}*print(){if(C(this,sr).length===0)return;const[n,...i]=C(this,sr);if(Y(this,sr,i),yield{type:"printer:buffer.pop",char:n},i.length===Eh.BUFFER_SIZE-1&&(yield*this.updateBusy(!1)),n.unsigned===12)yield*this.clear();else{const r=s_(n.unsigned);Y(this,co,C(this,co)+r),yield{type:"printer:paper.print",char:r}}}toJSON(){return{paper:C(this,co),buffer:[...C(this,sr).map(n=>n.unsigned)]}}};sr=new WeakMap,co=new WeakMap,ua=new WeakMap,oe(Eh,"BUFFER_SIZE",5);let _v=Eh,oq=class extends _v{*readData(){const e=this.computer.io.handshake.DATA;return yield{type:"printer:data.read",char:e},e}*updateBusy(e){e?yield{type:"printer:busy.on"}:yield{type:"printer:busy.off"},yield*this.computer.io.handshake.updateBusy(e)}},aq=class extends ci{constructor(n){super(n);oe(this,"clock");oe(this,"f10");oe(this,"keyboard");oe(this,"printer");oe(this,"screen");oe(this,"handshake");oe(this,"pic");oe(this,"timer");this.clock=new c_(n),this.f10=new d_(n),this.keyboard=new Iy(n),this.printer=new oq(n),this.screen=new Dy(n),this.handshake=new sq(n),this.pic=new h_(n),this.timer=new f_(n)}*chipSelect(n){const i=this.handshake.chipSelect(n);if(i)return yield{type:"bus:io.selected",chip:"handshake"},{chip:"handshake",register:i};const r=this.pic.chipSelect(n);if(r)return yield{type:"bus:io.selected",chip:"pic"},{chip:"pic",register:r};const s=this.timer.chipSelect(n);return s?(yield{type:"bus:io.selected",chip:"timer"},{chip:"timer",register:s}):(yield{type:"bus:io.error",error:new Ze("io-memory-not-connected",n)},null)}*read(n){const{chip:i,register:r}=n;return i==="handshake"?yield*this.handshake.read(r):i==="pic"?yield*this.pic.read(r):i==="timer"?yield*this.timer.read(r):(yield{type:"bus:io.error",error:new Ze("device-not-connected",i)},null)}*write(n,i){const{chip:r,register:s}=n;return r==="handshake"?(yield*this.handshake.write(s,i),!0):r==="pic"?(yield*this.pic.write(s,i),!0):r==="timer"?(yield*this.timer.write(s,i),!0):(yield{type:"bus:io.error",error:new Ze("device-not-connected",r)},!1)}toJSON(){return{clock:this.clock.toJSON(),f10:this.f10.toJSON(),keyboard:this.keyboard.toJSON(),printer:this.printer.toJSON(),screen:this.screen.toJSON(),handshake:this.handshake.toJSON(),pic:this.pic.toJSON(),timer:this.timer.toJSON()}}};class lq extends ci{constructor(n){super(n);oe(this,"keyboard");oe(this,"screen");this.keyboard=new Iy(n),this.screen=new Dy(n)}*chipSelect(n){return yield{type:"bus:io.error",error:new Ze("io-memory-not-connected",n)},null}*read(n){return yield{type:"bus:io.error",error:new Ze("device-not-connected",n.chip)},null}*write(n){return yield{type:"bus:io.error",error:new Ze("device-not-connected",n.chip)},!1}toJSON(){return{keyboard:this.keyboard.toJSON(),screen:this.screen.toJSON()}}}class uq extends ci{*chipSelect(e){return yield{type:"bus:io.error",error:new Ze("io-memory-not-connected",e)},null}*read(e){return yield{type:"bus:io.error",error:new Ze("device-not-connected",e.chip)},null}*write(e){return yield{type:"bus:io.error",error:new Ze("device-not-connected",e.chip)},!1}toJSON(){return{}}}class kj extends Ly{constructor(n){super(n);oe(this,"PA");oe(this,"PB");oe(this,"CA");oe(this,"CB");n.data==="unchanged"&&"pio"in n.previous.io?(this.PA=n.previous.io.pio.PA,this.PB=n.previous.io.pio.PB,this.CA=n.previous.io.pio.CA,this.CB=n.previous.io.pio.CB):n.data==="randomize"?(this.PA=L.random(8),this.PB=L.random(8),this.CA=L.random(8),this.CB=L.random(8)):(this.PA=L.zero(8),this.PB=L.zero(8),this.CA=L.zero(8),this.CB=L.zero(8))}chipSelect(n){return n=Number(n),n===48?"PA":n===49?"PB":n===50?"CA":n===51?"CB":null}*read(n){yield{type:"pio:read",register:n};let i;if(n==="PA")i=this.PA;else if(n==="PB")i=this.PB;else if(n==="CA")i=this.CA;else if(n==="CB")i=this.CB;else return n;return yield{type:"pio:read.ok",value:i},i}*write(n,i){if(yield{type:"pio:write",register:n,value:i},n==="PA")this.PA=i;else if(n==="PB")this.PB=i;else if(n==="CA")this.CA=i;else if(n==="CB")this.CB=i;else return n;yield{type:"pio:register.update",register:n,value:i},n==="PA"||n==="CA"?yield*this.updatePort("A"):yield*this.updatePort("B"),yield{type:"pio:write.ok"}}line(n,i){return n==="A"?this.CA.bit(i)?"input":"output":this.CB.bit(i)?"input":"output"}toJSON(){return{PA:this.PA.toJSON(),PB:this.PB.toJSON(),CA:this.CA.toJSON(),CB:this.CB.toJSON()}}}let cq=class extends kj{constructor(e){super(e),this.PA=this.PA.withBit(1,!1)}readData(){const e=this.PB.unsigned&~this.CB.unsigned;return L.fromUnsigned(e,8)}*updatePort(e){if(e==="B")return;let n=this.PA.unsigned;const i=this.CA.unsigned,r=this.computer.io.printer.busy;n=n&~i,this.line("A",0)==="input"&&r&&(n|=1),n!==this.PA.unsigned&&(this.PA=L.fromUnsigned(n,8),yield{type:"pio:register.update",register:"PA",value:this.PA}),this.line("A",1)==="output"&&(yield*this.computer.io.printer.setStrobe(this.PA.bit(1)))}},dq=class extends _v{*readData(){const e=this.computer.io.pio.readData();return yield{type:"printer:data.read",char:e},e}*updateBusy(e){e?yield{type:"printer:busy.on"}:yield{type:"printer:busy.off"},yield*this.computer.io.pio.updatePort("A")}};class hq extends ci{constructor(n){super(n);oe(this,"clock");oe(this,"f10");oe(this,"keyboard");oe(this,"printer");oe(this,"screen");oe(this,"pic");oe(this,"pio");oe(this,"timer");this.clock=new c_(n),this.f10=new d_(n),this.keyboard=new Iy(n),this.printer=new dq(n),this.screen=new Dy(n),this.pic=new h_(n),this.pio=new cq(n),this.timer=new f_(n)}*chipSelect(n){const i=this.pic.chipSelect(n);if(i)return yield{type:"bus:io.selected",chip:"pic"},{chip:"pic",register:i};const r=this.pio.chipSelect(n);if(r)return yield{type:"bus:io.selected",chip:"pio"},{chip:"pio",register:r};const s=this.timer.chipSelect(n);return s?(yield{type:"bus:io.selected",chip:"timer"},{chip:"timer",register:s}):(yield{type:"bus:io.error",error:new Ze("io-memory-not-connected",n)},null)}*read(n){const{chip:i,register:r}=n;return i==="pic"?yield*this.pic.read(r):i==="pio"?yield*this.pio.read(r):i==="timer"?yield*this.timer.read(r):(yield{type:"bus:io.error",error:new Ze("device-not-connected",i)},null)}*write(n,i){const{chip:r,register:s}=n;return r==="pic"?(yield*this.pic.write(s,i),!0):r==="pio"?(yield*this.pio.write(s,i),!0):r==="timer"?(yield*this.timer.write(s,i),!0):(yield{type:"bus:io.error",error:new Ze("device-not-connected",r)},!1)}toJSON(){return{clock:this.clock.toJSON(),f10:this.f10.toJSON(),keyboard:this.keyboard.toJSON(),printer:this.printer.toJSON(),screen:this.screen.toJSON(),pic:this.pic.toJSON(),pio:this.pio.toJSON(),timer:this.timer.toJSON()}}}var ho,mN;let fq=(mN=class extends ci{constructor(n){super(n);Re(this,ho);n.data==="unchanged"&&"leds"in n.previous.io?Y(this,ho,C(n.previous.io.leds,ho)):n.data==="randomize"?Y(this,ho,L.random(8)):Y(this,ho,L.zero(8))}get state(){return C(this,ho)}*update(n){yield{type:"leds:update",state:n}}toJSON(){return C(this,ho).toJSON()}},ho=new WeakMap,mN),pq=class extends kj{*updatePort(e){if(e==="A"){const n=this.computer.io.switches.state.unsigned;let i=this.PA.unsigned;const r=this.CA.unsigned;i=n&r|i&~r,i!==this.PA.unsigned&&(this.PA=L.fromUnsigned(i,8),yield{type:"pio:register.update",register:"PA",value:this.PA})}else{let n=this.PB.unsigned;const i=this.CB.unsigned;n=n&~i,yield*this.computer.io.leds.update(L.fromUnsigned(n,8))}}};var or,gN;let mq=(gN=class extends ci{constructor(n){super(n);Re(this,or);this.computer=n.computer,n.data==="unchanged"&&"switches"in n.previous.io?Y(this,or,C(n.previous.io.switches,or)):n.data==="randomize"?Y(this,or,L.random(8)):Y(this,or,L.zero(8))}get state(){return C(this,or)}*toggle(n){Y(this,or,C(this,or).withBit(n,!C(this,or).bit(n))),yield{type:"switches:toggle",index:n},yield*this.computer.io.pio.updatePort("A")}toJSON(){return C(this,or).toJSON()}},or=new WeakMap,gN);class gq extends ci{constructor(n){super(n);oe(this,"clock");oe(this,"f10");oe(this,"keyboard");oe(this,"leds");oe(this,"screen");oe(this,"switches");oe(this,"pic");oe(this,"pio");oe(this,"timer");this.clock=new c_(n),this.f10=new d_(n),this.keyboard=new Iy(n),this.leds=new fq(n),this.screen=new Dy(n),this.switches=new mq(n),this.pic=new h_(n),this.pio=new pq(n),this.timer=new f_(n)}*chipSelect(n){const i=this.pic.chipSelect(n);if(i)return yield{type:"bus:io.selected",chip:"pic"},{chip:"pic",register:i};const r=this.pio.chipSelect(n);if(r)return yield{type:"bus:io.selected",chip:"pio"},{chip:"pio",register:r};const s=this.timer.chipSelect(n);return s?(yield{type:"bus:io.selected",chip:"timer"},{chip:"timer",register:s}):(yield{type:"bus:io.error",error:new Ze("io-memory-not-connected",n)},null)}*read(n){const{chip:i,register:r}=n;return i==="pic"?yield*this.pic.read(r):i==="pio"?yield*this.pio.read(r):i==="timer"?yield*this.timer.read(r):(yield{type:"bus:io.error",error:new Ze("device-not-connected",i)},null)}*write(n,i){const{chip:r,register:s}=n;return r==="pic"?(yield*this.pic.write(s,i),!0):r==="pio"?(yield*this.pio.write(s,i),!0):r==="timer"?(yield*this.timer.write(s,i),!0):(yield{type:"bus:io.error",error:new Ze("device-not-connected",r)},!1)}toJSON(){return{clock:this.clock.toJSON(),f10:this.f10.toJSON(),keyboard:this.keyboard.toJSON(),leds:this.leds.toJSON(),screen:this.screen.toJSON(),switches:this.switches.toJSON(),pic:this.pic.toJSON(),pio:this.pio.toJSON(),timer:this.timer.toJSON()}}}var xa,gi,xc,fo;let vq=(xa=class extends ci{constructor(n){super(n);Re(this,gi);Re(this,xc);Re(this,fo);n.data==="unchanged"?Y(this,gi,C(n.previous.memory,gi)):n.data==="randomize"?Y(this,gi,new Uint8Array(xa.SIZE).map(()=>L.random(8).unsigned)):Y(this,gi,new Uint8Array(xa.SIZE)),Y(this,fo,new Set);for(const[i,r]of o_){const s=i*4;C(this,gi).set(r.toUint8Array(),s),C(this,gi).set(L.zero(16).toUint8Array(),s+2),C(this,fo).add(s),C(this,fo).add(s+1),C(this,fo).add(s+2),C(this,fo).add(s+3)}for(const i of n.program.data){let r=i.start.value;for(const s of i.getValues())s!==Jd&&C(this,gi).set(s.toUint8Array(),r),r+=i.size/8}Y(this,xc,new Set);for(const i of n.program.instructions){C(this,gi).set(i.toBytes(),i.start.value);for(let r=0;r<i.length;r++)C(this,xc).add(i.start.value+r)}}*read(n){if(n=Number(n),yield{type:"memory:read",address:n},!ye.inRange(n))return yield{type:"memory:read.error",error:new Ze("address-out-of-range",n)},null;const i=L.fromUnsigned(C(this,gi).at(n),8);return yield{type:"memory:read.ok",address:ye.from(n),value:i},i}*write(n,i){return n=Number(n),yield{type:"memory:write",address:n,value:i},ye.inRange(n)?C(this,xc).has(n)?(yield{type:"memory:write.error",error:new Ze("address-has-instruction",n)},!1):C(this,fo).has(n)?(yield{type:"memory:write.error",error:new Ze("address-is-reserved",n)},!1):(C(this,gi).set([i.unsigned],n),yield{type:"memory:write.ok",address:ye.from(n),value:i},!0):(yield{type:"memory:write.error",error:new Ze("address-out-of-range",n)},!1)}toJSON(){return[...C(this,gi)]}},gi=new WeakMap,xc=new WeakMap,fo=new WeakMap,oe(xa,"SIZE",ye.MAX_ADDRESS+1),xa);class _T{constructor(e){oe(this,"cpu");oe(this,"memory");oe(this,"io");const n={computer:this,...e};switch(this.cpu=new rq(n),this.memory=new vq(n),e.devices){case"no-devices":{this.io=new uq(n);break}case"keyboard-and-screen":{this.io=new lq(n);break}case"pio-switches-and-leds":{this.io=new gq(n);break}case"pio-printer":{this.io=new hq(n);break}case"handshake":{this.io=new aq(n);break}default:{const i=e.devices;throw new Error(`Unknown devices configuration: ${i}`)}}}toJSON(){return{cpu:this.cpu.toJSON(),memory:this.memory.toJSON(),io:this.io.toJSON()}}}var ut;class yq{constructor(){Re(this,ut,new _T({program:{data:[],instructions:[]},devices:"pio-switches-and-leds",data:"clean"}))}loadProgram(e){Y(this,ut,new _T({...e,previous:C(this,ut)}))}getComputerState(){var e;return((e=C(this,ut))==null?void 0:e.toJSON())||null}startCPU(){if(!C(this,ut))throw new Ze("no-program");return C(this,ut).cpu.run()}get devices(){if(!C(this,ut))throw new Error("No computer loaded!");return{clock:{connected:()=>"clock"in C(this,ut).io,tick:()=>{if("clock"in C(this,ut).io)return C(this,ut).io.clock.tick();console.warn("Called clock.tick() when no clock was connected to the computer")}},f10:{connected:()=>"f10"in C(this,ut).io,press:()=>{if("f10"in C(this,ut).io)return C(this,ut).io.f10.press();console.warn("Called f10.press() when no f10 was connected to the computer")}},keyboard:{connected:()=>"keyboard"in C(this,ut).io,readChar:e=>{if("keyboard"in C(this,ut).io)return C(this,ut).io.keyboard.setLastCharRead(e);console.warn("Called keyboard.press() when no keyboard was connected to the computer")}},leds:{connected:()=>"leds"in C(this,ut).io},printer:{connected:()=>"printer"in C(this,ut).io,clear:()=>{if("printer"in C(this,ut).io)return C(this,ut).io.printer.clear();console.warn("No printer connected to the computer!")},print:()=>{if("printer"in C(this,ut).io)return C(this,ut).io.printer.print();console.warn("No printer connected to the computer!")}},screen:{connected:()=>"screen"in C(this,ut).io,clear:()=>{if("screen"in C(this,ut).io)return C(this,ut).io.screen.clear();console.warn("Called screen.clear() when no screen was connected to the computer")}},switches:{connected:()=>"switches"in C(this,ut).io,toggle:e=>{if("switches"in C(this,ut).io)return C(this,ut).io.switches.toggle(e);console.warn("Called switches.toggle() when no switches were connected to the computer")}}}}}ut=new WeakMap;const _j=new Xf;function Cj(t){window.codemirror&&window.codemirror.dispatch({effects:_j.reconfigure(Je.readOnly.of(t))})}const k1=Xe.define(),wq=li.define({create(){return Ge.none},update(t,e){let n=t.map(e.changes);for(const i of e.effects)i.is(k1)&&(n=Ge.none,i.value!==null&&(n=n.update({add:[bq.range(i.value)]})));return n},provide:t=>Pe.decorations.from(t)}),bq=Ge.line({class:"!bg-mantis-400/10"});function Ej(t){if(window.codemirror)if(t===null)window.codemirror.dispatch({effects:k1.of(null)});else{const e=window.codemirror.state.doc.lineAt(t).from;window.codemirror.dispatch({effects:k1.of(e)})}}const Aj=Zu.init("phc_Iq0zy6d8IRJY2ts0uHNWlSbectCsUgQK77MLj3ypSdM",{api_host:"https://us.posthog.com",autocapture:!1,capture_pageview:!0,persistence:"memory"})||Zu,ww=Ae(L.zero(16)),bw=Ae(L.zero(16)),xw=Ae(L.zero(16)),Sw=Ae(L.zero(16)),kw=Ae(L.zero(16)),_w=Ae(L.zero(16)),xq=Ae(L.zero(8)),Cw=Ae(L.zero(16)),Ew=Ae(L.zero(16)),Aw=Ae(L.zero(16)),Pw=Ae(L.zero(16)),Tw=Ae(L.zero(16)),Rw=Ae(L.zero(16)),Pj=Ae(L.zero(16)),Cv=Ae(L.zero(8)),er=t=>Ae(e=>e(t).low,(e,n,i)=>{const r=e(t),s=typeof i=="function"?i(r.low):i;n(t,r.withLow(s))}),tr=t=>Ae(e=>e(t).high,(e,n,i)=>{const r=e(t),s=typeof i=="function"?i(r.high):i;n(t,r.withHigh(s))}),At={AX:ww,AL:er(ww),AH:tr(ww),BX:bw,BL:er(bw),BH:tr(bw),CX:xw,CL:er(xw),CH:tr(xw),DX:Sw,DL:er(Sw),DH:tr(Sw),SP:kw,"SP.l":er(kw),"SP.h":tr(kw),IP:_w,"IP.l":er(_w),"IP.h":tr(_w),IR:xq,ri:Cw,"ri.l":er(Cw),"ri.h":tr(Cw),id:Ew,"id.l":er(Ew),"id.h":tr(Ew),left:Aw,"left.l":er(Aw),"left.h":tr(Aw),right:Pw,"right.l":er(Pw),"right.h":tr(Pw),result:Tw,"result.l":er(Tw),"result.h":tr(Tw),FLAGS:Rw,"FLAGS.l":er(Rw),"FLAGS.h":tr(Rw),MAR:Pj,MBR:Cv},vs=Ae({phase:"stopped"}),Tj=Ae("ADD");function Sq(t){ee.set(At.AX,L.fromUnsigned(t.cpu.AX,16)),ee.set(At.BX,L.fromUnsigned(t.cpu.BX,16)),ee.set(At.CX,L.fromUnsigned(t.cpu.CX,16)),ee.set(At.DX,L.fromUnsigned(t.cpu.DX,16)),ee.set(At.SP,L.fromUnsigned(t.cpu.SP,16)),ee.set(At.IP,L.fromUnsigned(t.cpu.IP,16)),ee.set(At.IR,L.fromUnsigned(t.cpu.IR,8)),ee.set(At.ri,L.fromUnsigned(t.cpu.ri,16)),ee.set(At.id,L.fromUnsigned(t.cpu.id,16)),ee.set(At.left,L.fromUnsigned(t.cpu.left,16)),ee.set(At.right,L.fromUnsigned(t.cpu.right,16)),ee.set(At.result,L.fromUnsigned(t.cpu.result,16)),ee.set(At.FLAGS,L.fromUnsigned(t.cpu.FLAGS,16)),ee.set(At.MAR,L.fromUnsigned(t.cpu.MAR,16)),ee.set(At.MBR,L.fromUnsigned(t.cpu.MBR,8)),ee.set(vs,{phase:"stopped"})}var p_=op(),We=t=>sp(t,p_),m_=op();We.write=t=>sp(t,m_);var jy=op();We.onStart=t=>sp(t,jy);var g_=op();We.onFrame=t=>sp(t,g_);var v_=op();We.onFinish=t=>sp(t,v_);var hc=[];We.setTimeout=(t,e)=>{const n=We.now()+e,i=()=>{const s=hc.findIndex(o=>o.cancel==i);~s&&hc.splice(s,1),ya-=~s?1:0},r={time:n,handler:t,cancel:i};return hc.splice(Rj(n),0,r),ya+=1,Nj(),r};var Rj=t=>~(~hc.findIndex(e=>e.time>t)||~hc.length);We.cancel=t=>{jy.delete(t),g_.delete(t),v_.delete(t),p_.delete(t),m_.delete(t)};We.sync=t=>{_1=!0,We.batchedUpdates(t),_1=!1};We.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function i(...r){e=r,We.onStart(n)}return i.handler=t,i.cancel=()=>{jy.delete(n),e=null},i};var y_=typeof window<"u"?window.requestAnimationFrame:()=>{};We.use=t=>y_=t;We.now=typeof performance<"u"?()=>performance.now():Date.now;We.batchedUpdates=t=>t();We.catch=console.error;We.frameLoop="always";We.advance=()=>{We.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):Oj()};var va=-1,ya=0,_1=!1;function sp(t,e){_1?(e.delete(t),t(0)):(e.add(t),Nj())}function Nj(){va<0&&(va=0,We.frameLoop!=="demand"&&y_(Mj))}function kq(){va=-1}function Mj(){~va&&(y_(Mj),We.batchedUpdates(Oj))}function Oj(){const t=va;va=We.now();const e=Rj(va);if(e&&(Ij(hc.splice(0,e),n=>n.handler()),ya-=e),!ya){kq();return}jy.flush(),p_.flush(t?Math.min(64,va-t):16.667),g_.flush(),m_.flush(),v_.flush()}function op(){let t=new Set,e=t;return{add(n){ya+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return ya-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,ya-=e.size,Ij(e,i=>i(n)&&t.add(i)),ya+=t.size,e=t)}}}function Ij(t,e){t.forEach(n=>{try{e(n)}catch(i){We.catch(i)}})}var _q=Object.defineProperty,Cq=(t,e)=>{for(var n in e)_q(t,n,{get:e[n],enumerable:!0})},os={};Cq(os,{assign:()=>Pq,colors:()=>Ma,createStringInterpolator:()=>b_,skipAnimation:()=>jj,to:()=>Lj,willAdvance:()=>x_});function Eq(){}var Aq=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),ve={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function Zs(t,e){if(ve.arr(t)){if(!ve.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}var An=(t,e)=>t.forEach(e);function qa(t,e,n){if(ve.arr(t)){for(let i=0;i<t.length;i++)e.call(n,t[i],`${i}`);return}for(const i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i)}var wa=t=>ve.und(t)?[]:ve.arr(t)?t:[t];function Dj(t,e){if(t.size){const n=Array.from(t);t.clear(),An(n,e)}}var dm=(t,...e)=>Dj(t,n=>n(...e)),w_=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),b_,Lj,Ma=null,jj=!1,x_=Eq,Pq=t=>{t.to&&(Lj=t.to),t.now&&(We.now=t.now),t.colors!==void 0&&(Ma=t.colors),t.skipAnimation!=null&&(jj=t.skipAnimation),t.createStringInterpolator&&(b_=t.createStringInterpolator),t.requestAnimationFrame&&We.use(t.requestAnimationFrame),t.batchedUpdates&&(We.batchedUpdates=t.batchedUpdates),t.willAdvance&&(x_=t.willAdvance),t.frameLoop&&(We.frameLoop=t.frameLoop)},xh=new Set,fr=[],Nw=[],Ev=0,Fy={get idle(){return!xh.size&&!fr.length},start(t){Ev>t.priority?(xh.add(t),We.onStart(Tq)):(Fj(t),We(C1))},advance:C1,sort(t){if(Ev)We.onFrame(()=>Fy.sort(t));else{const e=fr.indexOf(t);~e&&(fr.splice(e,1),Bj(t))}},clear(){fr=[],xh.clear()}};function Tq(){xh.forEach(Fj),xh.clear(),We(C1)}function Fj(t){fr.includes(t)||Bj(t)}function Bj(t){fr.splice(Rq(fr,e=>e.priority>t.priority),0,t)}function C1(t){const e=Nw;for(let n=0;n<fr.length;n++){const i=fr[n];Ev=i.priority,i.idle||(x_(i),i.advance(t),i.idle||e.push(i))}return Ev=0,Nw=fr,Nw.length=0,fr=e,fr.length>0}function Rq(t,e){const n=t.findIndex(e);return n<0?t.length:n}var Nq=(t,e,n)=>Math.min(Math.max(n,t),e),Mq={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},Xr="[-+]?\\d*\\.?\\d+",Av=Xr+"%";function By(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var Oq=new RegExp("rgb"+By(Xr,Xr,Xr)),Iq=new RegExp("rgba"+By(Xr,Xr,Xr,Xr)),Dq=new RegExp("hsl"+By(Xr,Av,Av)),Lq=new RegExp("hsla"+By(Xr,Av,Av,Xr)),jq=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Fq=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Bq=/^#([0-9a-fA-F]{6})$/,$q=/^#([0-9a-fA-F]{8})$/;function zq(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=Bq.exec(t))?parseInt(e[1]+"ff",16)>>>0:Ma&&Ma[t]!==void 0?Ma[t]:(e=Oq.exec(t))?(yu(e[1])<<24|yu(e[2])<<16|yu(e[3])<<8|255)>>>0:(e=Iq.exec(t))?(yu(e[1])<<24|yu(e[2])<<16|yu(e[3])<<8|AT(e[4]))>>>0:(e=jq.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=$q.exec(t))?parseInt(e[1],16)>>>0:(e=Fq.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=Dq.exec(t))?(CT(ET(e[1]),hm(e[2]),hm(e[3]))|255)>>>0:(e=Lq.exec(t))?(CT(ET(e[1]),hm(e[2]),hm(e[3]))|AT(e[4]))>>>0:null}function Mw(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function CT(t,e,n){const i=n<.5?n*(1+e):n+e-n*e,r=2*n-i,s=Mw(r,i,t+1/3),o=Mw(r,i,t),a=Mw(r,i,t-1/3);return Math.round(s*255)<<24|Math.round(o*255)<<16|Math.round(a*255)<<8}function yu(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function ET(t){return(parseFloat(t)%360+360)%360/360}function AT(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function hm(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function PT(t){let e=zq(t);if(e===null)return t;e=e||0;const n=(e&4278190080)>>>24,i=(e&16711680)>>>16,r=(e&65280)>>>8,s=(e&255)/255;return`rgba(${n}, ${i}, ${r}, ${s})`}var Af=(t,e,n)=>{if(ve.fun(t))return t;if(ve.arr(t))return Af({range:t,output:e,extrapolate:n});if(ve.str(t.output[0]))return b_(t);const i=t,r=i.output,s=i.range||[0,1],o=i.extrapolateLeft||i.extrapolate||"extend",a=i.extrapolateRight||i.extrapolate||"extend",l=i.easing||(u=>u);return u=>{const c=Vq(u,s);return Uq(u,s[c],s[c+1],r[c],r[c+1],l,o,a,i.map)}};function Uq(t,e,n,i,r,s,o,a,l){let u=l?l(t):t;if(u<e){if(o==="identity")return u;o==="clamp"&&(u=e)}if(u>n){if(a==="identity")return u;a==="clamp"&&(u=n)}return i===r?i:e===n?t<=e?i:r:(e===-1/0?u=-u:n===1/0?u=u-e:u=(u-e)/(n-e),u=s(u),i===-1/0?u=-u:r===1/0?u=u+i:u=u*(r-i)+i,u)}function Vq(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}var Hq=(t,e="end")=>n=>{n=e==="end"?Math.min(n,.999):Math.max(n,.001);const i=n*t,r=e==="end"?Math.floor(i):Math.ceil(i);return Nq(0,1,r/t)},Pv=1.70158,fm=Pv*1.525,TT=Pv+1,RT=2*Math.PI/3,NT=2*Math.PI/4.5,pm=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,$j={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>TT*t*t*t-Pv*t*t,easeOutBack:t=>1+TT*Math.pow(t-1,3)+Pv*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((fm+1)*2*t-fm)/2:(Math.pow(2*t-2,2)*((fm+1)*(t*2-2)+fm)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*RT),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*RT)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*NT))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*NT)/2+1,easeInBounce:t=>1-pm(1-t),easeOutBounce:pm,easeInOutBounce:t=>t<.5?(1-pm(1-2*t))/2:(1+pm(2*t-1))/2,steps:Hq},Pf=Symbol.for("FluidValue.get"),$c=Symbol.for("FluidValue.observers"),hr=t=>!!(t&&t[Pf]),yi=t=>t&&t[Pf]?t[Pf]():t,MT=t=>t[$c]||null;function Wq(t,e){t.eventObserved?t.eventObserved(e):t(e)}function Tf(t,e){const n=t[$c];n&&n.forEach(i=>{Wq(i,e)})}var zj=class{constructor(t){if(!t&&!(t=this.get))throw Error("Unknown getter");Gq(this,t)}},Gq=(t,e)=>Uj(t,Pf,e);function $y(t,e){if(t[Pf]){let n=t[$c];n||Uj(t,$c,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function Rf(t,e){const n=t[$c];if(n&&n.has(e)){const i=n.size-1;i?n.delete(e):t[$c]=null,t.observerRemoved&&t.observerRemoved(i,e)}}var Uj=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),cg=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Kq=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,OT=new RegExp(`(${cg.source})(%|[a-z]+)`,"i"),Xq=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,zy=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,Vj=t=>{const[e,n]=qq(t);if(!e||w_())return t;const i=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(i)return i.trim();if(n&&n.startsWith("--")){const r=window.getComputedStyle(document.documentElement).getPropertyValue(n);return r||t}else{if(n&&zy.test(n))return Vj(n);if(n)return n}return t},qq=t=>{const e=zy.exec(t);if(!e)return[,];const[,n,i]=e;return[n,i]},Ow,Yq=(t,e,n,i,r)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(i)}, ${r})`,Hj=t=>{Ow||(Ow=Ma?new RegExp(`(${Object.keys(Ma).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(s=>yi(s).replace(zy,Vj).replace(Kq,PT).replace(Ow,PT)),n=e.map(s=>s.match(cg).map(Number)),r=n[0].map((s,o)=>n.map(a=>{if(!(o in a))throw Error('The arity of each "output" value must be equal');return a[o]})).map(s=>Af({...t,output:s}));return s=>{var l;const o=!OT.test(e[0])&&((l=e.find(u=>OT.test(u)))==null?void 0:l.replace(cg,""));let a=0;return e[0].replace(cg,()=>`${r[a++](s)}${o||""}`).replace(Xq,Yq)}},Wj="react-spring: ",Gj=t=>{const e=t;let n=!1;if(typeof e!="function")throw new TypeError(`${Wj}once requires a function parameter`);return(...i)=>{n||(e(...i),n=!0)}},Jq=Gj(console.warn);function Zq(){Jq(`${Wj}The "interpolate" function is deprecated in v9 (use "to" instead)`)}Gj(console.warn);function Uy(t){return ve.str(t)&&(t[0]=="#"||/\d/.test(t)||!w_()&&zy.test(t)||t in(Ma||{}))}var Kj=w_()?S.useEffect:S.useLayoutEffect,Qq=()=>{const t=S.useRef(!1);return Kj(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function eY(){const t=S.useState()[1],e=Qq();return()=>{e.current&&t(Math.random())}}function tY(t,e){const[n]=S.useState(()=>({inputs:e,result:t()})),i=S.useRef(),r=i.current;let s=r;return s?e&&s.inputs&&nY(e,s.inputs)||(s={inputs:e,result:t()}):s=n,S.useEffect(()=>{i.current=s,r==n&&(n.inputs=n.result=void 0)},[s]),s.result}function nY(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var iY=t=>S.useEffect(t,rY),rY=[],Nf=Symbol.for("Animated:node"),sY=t=>!!t&&t[Nf]===t,ys=t=>t&&t[Nf],S_=(t,e)=>Aq(t,Nf,e),Vy=t=>t&&t[Nf]&&t[Nf].getPayload(),Xj=class{constructor(){S_(this,this)}getPayload(){return this.payload||[]}},ap=class extends Xj{constructor(t){super(),this._value=t,this.done=!0,this.durationProgress=0,ve.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new ap(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,e){return ve.num(t)&&(this.lastPosition=t,e&&(t=Math.round(t/e)*e,this.done&&(this.lastPosition=t))),this._value===t?!1:(this._value=t,!0)}reset(){const{done:t}=this;this.done=!1,ve.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}},Mf=class extends ap{constructor(t){super(0),this._string=null,this._toString=Af({output:[t,t]})}static create(t){return new Mf(t)}getValue(){const t=this._string;return t??(this._string=this._toString(this._value))}setValue(t){if(ve.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else if(super.setValue(t))this._string=null;else return!1;return!0}reset(t){t&&(this._toString=Af({output:[this.getValue(),t]})),this._value=0,super.reset()}},Tv={dependencies:null},Hy=class extends Xj{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const e={};return qa(this.source,(n,i)=>{sY(n)?e[i]=n.getValue(t):hr(n)?e[i]=yi(n):t||(e[i]=n)}),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&An(this.payload,t=>t.reset())}_makePayload(t){if(t){const e=new Set;return qa(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){Tv.dependencies&&hr(t)&&Tv.dependencies.add(t);const e=Vy(t);e&&An(e,n=>this.add(n))}},qj=class extends Hy{constructor(t){super(t)}static create(t){return new qj(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){const e=this.getPayload();return t.length==e.length?e.map((n,i)=>n.setValue(t[i])).some(Boolean):(super.setValue(t.map(oY)),!0)}};function oY(t){return(Uy(t)?Mf:ap).create(t)}function E1(t){const e=ys(t);return e?e.constructor:ve.arr(t)?qj:Uy(t)?Mf:ap}var IT=(t,e)=>{const n=!ve.fun(t)||t.prototype&&t.prototype.isReactComponent;return S.forwardRef((i,r)=>{const s=S.useRef(null),o=n&&S.useCallback(p=>{s.current=uY(r,p)},[r]),[a,l]=lY(i,e),u=eY(),c=()=>{const p=s.current;if(n&&!p)return;(p?e.applyAnimatedValues(p,a.getValue(!0)):!1)===!1&&u()},d=new aY(c,l),h=S.useRef();Kj(()=>(h.current=d,An(l,p=>$y(p,d)),()=>{h.current&&(An(h.current.deps,p=>Rf(p,h.current)),We.cancel(h.current.update))})),S.useEffect(c,[]),iY(()=>()=>{const p=h.current;An(p.deps,m=>Rf(m,p))});const f=e.getComponentProps(a.getValue());return S.createElement(t,{...f,ref:o})})},aY=class{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){t.type=="change"&&We.write(this.update)}};function lY(t,e){const n=new Set;return Tv.dependencies=n,t.style&&(t={...t,style:e.createAnimatedStyle(t.style)}),t=new Hy(t),Tv.dependencies=null,[t,n]}function uY(t,e){return t&&(ve.fun(t)?t(e):t.current=e),e}var DT=Symbol.for("AnimatedComponent"),cY=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=r=>new Hy(r),getComponentProps:i=r=>r}={})=>{const r={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:i},s=o=>{const a=LT(o)||"Anonymous";return ve.str(o)?o=s[o]||(s[o]=IT(o,r)):o=o[DT]||(o[DT]=IT(o,r)),o.displayName=`Animated(${a})`,o};return qa(t,(o,a)=>{ve.arr(t)&&(a=LT(o)),s[a]=s(o)}),{animated:s}},LT=t=>ve.str(t)?t:t&&ve.str(t.displayName)?t.displayName:ve.fun(t)&&t.name||null;function Cl(t,...e){return ve.fun(t)?t(...e):t}var Sh=(t,e)=>t===!0||!!(e&&t&&(ve.fun(t)?t(e):wa(t).includes(e))),Yj=(t,e)=>ve.obj(t)?e&&t[e]:t,dY=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,hY=t=>t,Jj=(t,e=hY)=>{let n=fY;t.default&&t.default!==!0&&(t=t.default,n=Object.keys(t));const i={};for(const r of n){const s=e(t[r],r);ve.und(s)||(i[r]=s)}return i},fY=["config","onProps","onStart","onChange","onPause","onResume","onRest"],pY={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function mY(t){const e={};let n=0;if(qa(t,(i,r)=>{pY[r]||(e[r]=i,n++)}),n)return e}function Zj(t){const e=mY(t);if(e){const n={to:e};return qa(t,(i,r)=>r in e||(n[r]=i)),n}return{...t}}function Of(t){return t=yi(t),ve.arr(t)?t.map(Of):Uy(t)?os.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function A1(t){return ve.fun(t)||ve.arr(t)&&ve.obj(t[0])}var gY={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},P1={...gY.default,mass:1,damping:1,easing:$j.linear,clamp:!1},vY=class{constructor(){this.velocity=0,Object.assign(this,P1)}};function yY(t,e,n){n&&(n={...n},jT(n,e),e={...n,...e}),jT(t,e),Object.assign(t,e);for(const o in P1)t[o]==null&&(t[o]=P1[o]);let{frequency:i,damping:r}=t;const{mass:s}=t;return ve.und(i)||(i<.01&&(i=.01),r<0&&(r=0),t.tension=Math.pow(2*Math.PI/i,2)*s,t.friction=4*Math.PI*r*s/i),t}function jT(t,e){if(!ve.und(e.decay))t.duration=void 0;else{const n=!ve.und(e.tension)||!ve.und(e.friction);(n||!ve.und(e.frequency)||!ve.und(e.damping)||!ve.und(e.mass))&&(t.duration=void 0,t.decay=void 0),n&&(t.frequency=void 0)}}var FT=[],wY=class{constructor(){this.changed=!1,this.values=FT,this.toValues=null,this.fromValues=FT,this.config=new vY,this.immediate=!1}};function bY(t,{key:e,props:n,defaultProps:i,state:r,actions:s}){return new Promise((o,a)=>{let l,u,c=Sh(n.cancel??(i==null?void 0:i.cancel),e);if(c)f();else{ve.und(n.pause)||(r.paused=Sh(n.pause,e));let p=i==null?void 0:i.pause;p!==!0&&(p=r.paused||Sh(p,e)),l=Cl(n.delay||0,e),p?(r.resumeQueue.add(h),s.pause()):(s.resume(),h())}function d(){r.resumeQueue.add(h),r.timeouts.delete(u),u.cancel(),l=u.time-We.now()}function h(){l>0&&!os.skipAnimation?(r.delayed=!0,u=We.setTimeout(f,l),r.pauseQueue.add(d),r.timeouts.add(u)):f()}function f(){r.delayed&&(r.delayed=!1),r.pauseQueue.delete(d),r.timeouts.delete(u),t<=(r.cancelId||0)&&(c=!0);try{s.start({...n,callId:t,cancel:c},o)}catch(p){a(p)}}})}var xY=(t,e)=>e.length==1?e[0]:e.some(n=>n.cancelled)?kh(t.get()):e.every(n=>n.noop)?Qj(t.get()):Ur(t.get(),e.every(n=>n.finished)),Qj=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),Ur=(t,e,n=!1)=>({value:t,finished:e,cancelled:n}),kh=t=>({value:t,cancelled:!0,finished:!1});function SY(t,e,n,i){const{callId:r,parentId:s,onRest:o}=e,{asyncTo:a,promise:l}=n;return!s&&t===a&&!e.reset?l:n.promise=(async()=>{n.asyncId=r,n.asyncTo=t;const u=Jj(e,(w,v)=>v==="onRest"?void 0:w);let c,d;const h=new Promise((w,v)=>(c=w,d=v)),f=w=>{const v=r<=(n.cancelId||0)&&kh(i)||r!==n.asyncId&&Ur(i,!1);if(v)throw w.result=v,d(w),w},p=(w,v)=>{const y=new BT,b=new $T;return(async()=>{if(os.skipAnimation)throw T1(n),b.result=Ur(i,!1),d(b),b;f(y);const k=ve.obj(w)?{...w}:{...v,to:w};k.parentId=r,qa(u,(E,A)=>{ve.und(k[A])&&(k[A]=E)});const _=await i.start(k);return f(y),n.paused&&await new Promise(E=>{n.resumeQueue.add(E)}),_})()};let m;if(os.skipAnimation)return T1(n),Ur(i,!1);try{let w;ve.arr(t)?w=(async v=>{for(const y of v)await p(y)})(t):w=Promise.resolve(t(p,i.stop.bind(i))),await Promise.all([w.then(c),h]),m=Ur(i.get(),!0,!1)}catch(w){if(w instanceof BT)m=w.result;else if(w instanceof $T)m=w.result;else throw w}finally{r==n.asyncId&&(n.asyncId=s,n.asyncTo=s?a:void 0,n.promise=s?l:void 0)}return ve.fun(o)&&We.batchedUpdates(()=>{o(m,i,i.item)}),m})()}function T1(t,e){Dj(t.timeouts,n=>n.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}var BT=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},$T=class extends Error{constructor(){super("SkipAnimationSignal")}},R1=t=>t instanceof k_,kY=1,k_=class extends zj{constructor(){super(...arguments),this.id=kY++,this._priority=0}get priority(){return this._priority}set priority(t){this._priority!=t&&(this._priority=t,this._onPriorityChange(t))}get(){const t=ys(this);return t&&t.getValue()}to(...t){return os.to(this,t)}interpolate(...t){return Zq(),os.to(this,t)}toJSON(){return this.get()}observerAdded(t){t==1&&this._attach()}observerRemoved(t){t==0&&this._detach()}_attach(){}_detach(){}_onChange(t,e=!1){Tf(this,{type:"change",parent:this,value:t,idle:e})}_onPriorityChange(t){this.idle||Fy.sort(this),Tf(this,{type:"priority",parent:this,priority:t})}},nu=Symbol.for("SpringPhase"),eF=1,N1=2,M1=4,Iw=t=>(t[nu]&eF)>0,Wo=t=>(t[nu]&N1)>0,Ed=t=>(t[nu]&M1)>0,zT=(t,e)=>e?t[nu]|=N1|eF:t[nu]&=~N1,UT=(t,e)=>e?t[nu]|=M1:t[nu]&=~M1,Et=class extends k_{constructor(t,e){if(super(),this.animation=new wY,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!ve.und(t)||!ve.und(e)){const n=ve.obj(t)?{...t}:{...e,from:t};ve.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(Wo(this)||this._state.asyncTo)||Ed(this)}get goal(){return yi(this.animation.to)}get velocity(){const t=ys(this);return t instanceof ap?t.lastVelocity||0:t.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return Iw(this)}get isAnimating(){return Wo(this)}get isPaused(){return Ed(this)}get isDelayed(){return this._state.delayed}advance(t){let e=!0,n=!1;const i=this.animation;let{toValues:r}=i;const{config:s}=i,o=Vy(i.to);!o&&hr(i.to)&&(r=wa(yi(i.to))),i.values.forEach((u,c)=>{if(u.done)return;const d=u.constructor==Mf?1:o?o[c].lastPosition:r[c];let h=i.immediate,f=d;if(!h){if(f=u.lastPosition,s.tension<=0){u.done=!0;return}let p=u.elapsedTime+=t;const m=i.fromValues[c],w=u.v0!=null?u.v0:u.v0=ve.arr(s.velocity)?s.velocity[c]:s.velocity;let v;const y=s.precision||(m==d?.005:Math.min(1,Math.abs(d-m)*.001));if(ve.und(s.duration))if(s.decay){const b=s.decay===!0?.998:s.decay,k=Math.exp(-(1-b)*p);f=m+w/(1-b)*(1-k),h=Math.abs(u.lastPosition-f)<=y,v=w*k}else{v=u.lastVelocity==null?w:u.lastVelocity;const b=s.restVelocity||y/10,k=s.clamp?0:s.bounce,_=!ve.und(k),E=m==d?u.v0>0:m<d;let A,P=!1;const I=1,D=Math.ceil(t/I);for(let B=0;B<D&&(A=Math.abs(v)>b,!(!A&&(h=Math.abs(d-f)<=y,h)));++B){_&&(P=f==d||f>d==E,P&&(v=-v*k,f=d));const $=-s.tension*1e-6*(f-d),J=-s.friction*.001*v,z=($+J)/s.mass;v=v+z*I,f=f+v*I}}else{let b=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,u.durationProgress>0&&(u.elapsedTime=s.duration*u.durationProgress,p=u.elapsedTime+=t)),b=(s.progress||0)+p/this._memoizedDuration,b=b>1?1:b<0?0:b,u.durationProgress=b),f=m+s.easing(b)*(d-m),v=(f-u.lastPosition)/t,h=b==1}u.lastVelocity=v,Number.isNaN(f)&&(console.warn("Got NaN while animating:",this),h=!0)}o&&!o[c].done&&(h=!1),h?u.done=!0:e=!1,u.setValue(f,s.round)&&(n=!0)});const a=ys(this),l=a.getValue();if(e){const u=yi(i.to);(l!==u||n)&&!s.decay?(a.setValue(u),this._onChange(u)):n&&s.decay&&this._onChange(l),this._stop()}else n&&this._onChange(l)}set(t){return We.batchedUpdates(()=>{this._stop(),this._focus(t),this._set(t)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Wo(this)){const{to:t,config:e}=this.animation;We.batchedUpdates(()=>{this._onStart(),e.decay||this._set(t,!1),this._stop()})}return this}update(t){return(this.queue||(this.queue=[])).push(t),this}start(t,e){let n;return ve.und(t)?(n=this.queue||[],this.queue=[]):n=[ve.obj(t)?t:{...e,to:t}],Promise.all(n.map(i=>this._update(i))).then(i=>xY(this,i))}stop(t){const{to:e}=this.animation;return this._focus(this.get()),T1(this._state,t&&this._lastCallId),We.batchedUpdates(()=>this._stop(e,t)),this}reset(){this._update({reset:!0})}eventObserved(t){t.type=="change"?this._start():t.type=="priority"&&(this.priority=t.priority+1)}_prepareNode(t){const e=this.key||"";let{to:n,from:i}=t;n=ve.obj(n)?n[e]:n,(n==null||A1(n))&&(n=void 0),i=ve.obj(i)?i[e]:i,i==null&&(i=void 0);const r={to:n,from:i};return Iw(this)||(t.reverse&&([n,i]=[i,n]),i=yi(i),ve.und(i)?ys(this)||this._set(n):this._set(i)),r}_update({...t},e){const{key:n,defaultProps:i}=this;t.default&&Object.assign(i,Jj(t,(o,a)=>/^on/.test(a)?Yj(o,n):o)),HT(this,t,"onProps"),Pd(this,"onProps",t,this);const r=this._prepareNode(t);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return bY(++this._lastCallId,{key:n,props:t,defaultProps:i,state:s,actions:{pause:()=>{Ed(this)||(UT(this,!0),dm(s.pauseQueue),Pd(this,"onPause",Ur(this,Ad(this,this.animation.to)),this))},resume:()=>{Ed(this)&&(UT(this,!1),Wo(this)&&this._resume(),dm(s.resumeQueue),Pd(this,"onResume",Ur(this,Ad(this,this.animation.to)),this))},start:this._merge.bind(this,r)}}).then(o=>{if(t.loop&&o.finished&&!(e&&o.noop)){const a=_Y(t);if(a)return this._update(a,!0)}return o})}_merge(t,e,n){if(e.cancel)return this.stop(!0),n(kh(this));const i=!ve.und(t.to),r=!ve.und(t.from);if(i||r)if(e.callId>this._lastToId)this._lastToId=e.callId;else return n(kh(this));const{key:s,defaultProps:o,animation:a}=this,{to:l,from:u}=a;let{to:c=l,from:d=u}=t;r&&!i&&(!e.default||ve.und(c))&&(c=d),e.reverse&&([c,d]=[d,c]);const h=!Zs(d,u);h&&(a.from=d),d=yi(d);const f=!Zs(c,l);f&&this._focus(c);const p=A1(e.to),{config:m}=a,{decay:w,velocity:v}=m;(i||r)&&(m.velocity=0),e.config&&!p&&yY(m,Cl(e.config,s),e.config!==o.config?Cl(o.config,s):void 0);let y=ys(this);if(!y||ve.und(c))return n(Ur(this,!0));const b=ve.und(e.reset)?r&&!e.default:!ve.und(d)&&Sh(e.reset,s),k=b?d:this.get(),_=Of(c),E=ve.num(_)||ve.arr(_)||Uy(_),A=!p&&(!E||Sh(o.immediate||e.immediate,s));if(f){const B=E1(c);if(B!==y.constructor)if(A)y=this._set(_);else throw Error(`Cannot animate between ${y.constructor.name} and ${B.name}, as the "to" prop suggests`)}const P=y.constructor;let I=hr(c),D=!1;if(!I){const B=b||!Iw(this)&&h;(f||B)&&(D=Zs(Of(k),_),I=!D),(!Zs(a.immediate,A)&&!A||!Zs(m.decay,w)||!Zs(m.velocity,v))&&(I=!0)}if(D&&Wo(this)&&(a.changed&&!b?I=!0:I||this._stop(l)),!p&&((I||hr(l))&&(a.values=y.getPayload(),a.toValues=hr(c)?null:P==Mf?[1]:wa(_)),a.immediate!=A&&(a.immediate=A,!A&&!b&&this._set(l)),I)){const{onRest:B}=a;An(EY,J=>HT(this,e,J));const $=Ur(this,Ad(this,l));dm(this._pendingCalls,$),this._pendingCalls.add(n),a.changed&&We.batchedUpdates(()=>{var J;a.changed=!b,B==null||B($,this),b?Cl(o.onRest,$):(J=a.onStart)==null||J.call(a,$,this)})}b&&this._set(k),p?n(SY(e.to,e,this._state,this)):I?this._start():Wo(this)&&!f?this._pendingCalls.add(n):n(Qj(k))}_focus(t){const e=this.animation;t!==e.to&&(MT(this)&&this._detach(),e.to=t,MT(this)&&this._attach())}_attach(){let t=0;const{to:e}=this.animation;hr(e)&&($y(e,this),R1(e)&&(t=e.priority+1)),this.priority=t}_detach(){const{to:t}=this.animation;hr(t)&&Rf(t,this)}_set(t,e=!0){const n=yi(t);if(!ve.und(n)){const i=ys(this);if(!i||!Zs(n,i.getValue())){const r=E1(n);!i||i.constructor!=r?S_(this,r.create(n)):i.setValue(n),i&&We.batchedUpdates(()=>{this._onChange(n,e)})}}return ys(this)}_onStart(){const t=this.animation;t.changed||(t.changed=!0,Pd(this,"onStart",Ur(this,Ad(this,t.to)),this))}_onChange(t,e){e||(this._onStart(),Cl(this.animation.onChange,t,this)),Cl(this.defaultProps.onChange,t,this),super._onChange(t,e)}_start(){const t=this.animation;ys(this).reset(yi(t.to)),t.immediate||(t.fromValues=t.values.map(e=>e.lastPosition)),Wo(this)||(zT(this,!0),Ed(this)||this._resume())}_resume(){os.skipAnimation?this.finish():Fy.start(this)}_stop(t,e){if(Wo(this)){zT(this,!1);const n=this.animation;An(n.values,r=>{r.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),Tf(this,{type:"idle",parent:this});const i=e?kh(this.get()):Ur(this.get(),Ad(this,t??n.to));dm(this._pendingCalls,i),n.changed&&(n.changed=!1,Pd(this,"onRest",i,this))}}};function Ad(t,e){const n=Of(e),i=Of(t.get());return Zs(i,n)}function _Y(t,e=t.loop,n=t.to){const i=Cl(e);if(i){const r=i!==!0&&Zj(i),s=(r||t).reverse,o=!r||r.reset;return CY({...t,loop:e,default:!1,pause:void 0,to:!s||A1(n)?n:void 0,from:o?t.from:void 0,reset:o,...r})}}function CY(t){const{to:e,from:n}=t=Zj(t),i=new Set;return ve.obj(e)&&VT(e,i),ve.obj(n)&&VT(n,i),t.keys=i.size?Array.from(i):null,t}function VT(t,e){qa(t,(n,i)=>n!=null&&e.add(i))}var EY=["onStart","onRest","onChange","onPause","onResume"];function HT(t,e,n){t.animation[n]=e[n]!==dY(e,n)?Yj(e[n],t.key):void 0}function Pd(t,e,...n){var i,r,s,o;(r=(i=t.animation)[e])==null||r.call(i,...n),(o=(s=t.defaultProps)[e])==null||o.call(s,...n)}var __=({children:t,...e})=>{const n=S.useContext(Rv),i=e.pause||!!n.pause,r=e.immediate||!!n.immediate;e=tY(()=>({pause:i,immediate:r}),[i,r]);const{Provider:s}=Rv;return S.createElement(s,{value:e},t)},Rv=AY(__,{});__.Provider=Rv.Provider;__.Consumer=Rv.Consumer;function AY(t,e){return Object.assign(t,S.createContext(e)),t.Provider._context=t,t.Consumer._context=t,t}var PY=class extends k_{constructor(t,e){super(),this.source=t,this.idle=!0,this._active=new Set,this.calc=Af(...e);const n=this._get(),i=E1(n);S_(this,i.create(n))}advance(t){const e=this._get(),n=this.get();Zs(e,n)||(ys(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&WT(this._active)&&Dw(this)}_get(){const t=ve.arr(this.source)?this.source.map(yi):wa(yi(this.source));return this.calc(...t)}_start(){this.idle&&!WT(this._active)&&(this.idle=!1,An(Vy(this),t=>{t.done=!1}),os.skipAnimation?(We.batchedUpdates(()=>this.advance()),Dw(this)):Fy.start(this))}_attach(){let t=1;An(wa(this.source),e=>{hr(e)&&$y(e,this),R1(e)&&(e.idle||this._active.add(e),t=Math.max(t,e.priority+1))}),this.priority=t,this._start()}_detach(){An(wa(this.source),t=>{hr(t)&&Rf(t,this)}),this._active.clear(),Dw(this)}eventObserved(t){t.type=="change"?t.idle?this.advance():(this._active.add(t.parent),this._start()):t.type=="idle"?this._active.delete(t.parent):t.type=="priority"&&(this.priority=wa(this.source).reduce((e,n)=>Math.max(e,(R1(n)?n.priority:0)+1),0))}};function TY(t){return t.idle!==!1}function WT(t){return!t.size||Array.from(t).every(TY)}function Dw(t){t.idle||(t.idle=!0,An(Vy(t),e=>{e.done=!0}),Tf(t,{type:"idle",parent:t}))}os.assign({createStringInterpolator:Hj,to:(t,e)=>new PY(t,e)});var tF=/^--/;function RY(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!tF.test(t)&&!(_h.hasOwnProperty(t)&&_h[t])?e+"px":(""+e).trim()}var GT={};function NY(t,e){if(!t.nodeType||!t.setAttribute)return!1;const n=t.nodeName==="filter"||t.parentNode&&t.parentNode.nodeName==="filter",{style:i,children:r,scrollTop:s,scrollLeft:o,viewBox:a,...l}=e,u=Object.values(l),c=Object.keys(l).map(d=>n||t.hasAttribute(d)?d:GT[d]||(GT[d]=d.replace(/([A-Z])/g,h=>"-"+h.toLowerCase())));r!==void 0&&(t.textContent=r);for(const d in i)if(i.hasOwnProperty(d)){const h=RY(d,i[d]);tF.test(d)?t.style.setProperty(d,h):t.style[d]=h}c.forEach((d,h)=>{t.setAttribute(d,u[h])}),s!==void 0&&(t.scrollTop=s),o!==void 0&&(t.scrollLeft=o),a!==void 0&&t.setAttribute("viewBox",a)}var _h={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MY=(t,e)=>t+e.charAt(0).toUpperCase()+e.substring(1),OY=["Webkit","Ms","Moz","O"];_h=Object.keys(_h).reduce((t,e)=>(OY.forEach(n=>t[MY(n,e)]=t[e]),t),_h);var IY=/^(matrix|translate|scale|rotate|skew)/,DY=/^(translate)/,LY=/^(rotate|skew)/,Lw=(t,e)=>ve.num(t)&&t!==0?t+e:t,dg=(t,e)=>ve.arr(t)?t.every(n=>dg(n,e)):ve.num(t)?t===e:parseFloat(t)===e,jY=class extends Hy{constructor({x:t,y:e,z:n,...i}){const r=[],s=[];(t||e||n)&&(r.push([t||0,e||0,n||0]),s.push(o=>[`translate3d(${o.map(a=>Lw(a,"px")).join(",")})`,dg(o,0)])),qa(i,(o,a)=>{if(a==="transform")r.push([o||""]),s.push(l=>[l,l===""]);else if(IY.test(a)){if(delete i[a],ve.und(o))return;const l=DY.test(a)?"px":LY.test(a)?"deg":"";r.push(wa(o)),s.push(a==="rotate3d"?([u,c,d,h])=>[`rotate3d(${u},${c},${d},${Lw(h,l)})`,dg(h,0)]:u=>[`${a}(${u.map(c=>Lw(c,l)).join(",")})`,dg(u,a.startsWith("scale")?1:0)])}}),r.length&&(i.transform=new FY(r,s)),super(i)}},FY=class extends zj{constructor(t,e){super(),this.inputs=t,this.transforms=e,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let t="",e=!0;return An(this.inputs,(n,i)=>{const r=yi(n[0]),[s,o]=this.transforms[i](ve.arr(r)?r:n.map(yi));t+=" "+s,e=e&&o}),e?"none":t}observerAdded(t){t==1&&An(this.inputs,e=>An(e,n=>hr(n)&&$y(n,this)))}observerRemoved(t){t==0&&An(this.inputs,e=>An(e,n=>hr(n)&&Rf(n,this)))}eventObserved(t){t.type=="change"&&(this._value=null),Tf(this,t)}},BY=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];os.assign({batchedUpdates:Lo.unstable_batchedUpdates,createStringInterpolator:Hj,colors:Mq});var $Y=cY(BY,{applyAnimatedValues:NY,createAnimatedStyle:t=>new jY(t),getComponentProps:({scrollTop:t,scrollLeft:e,...n})=>n}),Gt=$Y.animated;const bt={blue:{500:"#3b82f6"},mantis:{400:"#82bd69"},red:{500:"#ef4444"},stone:{600:"#57534e",700:"#44403c",800:"#292524"},white:"#ffffff"},Qe=(t=bt.stone[800])=>({backgroundColor:new Et(t),opacity:new Et(1)}),un=()=>({strokeDashoffset:new Et(1),opacity:new Et(1)}),C_={bus:{address:{stroke:new Et(bt.stone[700])},data:{stroke:new Et(bt.stone[700])},rd:{stroke:new Et(bt.stone[700])},wr:{stroke:new Et(bt.stone[700])},iom:un(),mem:{stroke:new Et(bt.red[500])},handshake:un(),pic:un(),pio:un(),timer:un(),intr:un(),inta:un(),int0:un(),int1:un(),int2:un(),"switches->pio":un(),"pio->leds":un(),printer:{data:un(),strobe:un(),busy:un()}},clock:{angle:new Et(0)},cpu:{internalBus:{address:{strokeDashoffset:new Et(1),opacity:new Et(1),path:new Et("")},data:{strokeDashoffset:new Et(1),opacity:new Et(1),path:new Et("")}},alu:{operands:un(),results:un(),cog:{rot:new Et(0)},operation:{backgroundColor:new Et(bt.stone[800])}},decoder:{path:un(),progress:{progress:new Et(0),opacity:new Et(1)}},AX:Qe(),BX:Qe(),CX:Qe(),DX:Qe(),SP:Qe(),IP:Qe(),IR:Qe(),ri:Qe(),id:Qe(),left:Qe(),right:Qe(),result:Qe(),FLAGS:Qe(),MAR:Qe(),MBR:Qe()},handshake:{DATA:Qe(),STATE:Qe()},memory:{"operating-cell":{color:new Et(bt.white)}},pic:{IMR:Qe(),IRR:Qe(),ISR:Qe(),INT0:Qe(),INT1:Qe(),INT2:Qe(),INT3:Qe(),INT4:Qe(),INT5:Qe(),INT6:Qe(),INT7:Qe()},pio:{PA:Qe(),PB:Qe(),CA:Qe(),CB:Qe()},printer:{printing:{progress:new Et(0),opacity:new Et(1)}},timer:{CONT:Qe(),COMP:Qe()}};function ft(t){return ZL(C_,t)}function nF(t){const e={};for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];i instanceof Et?e[n]=i.get():e[n]=nF(i)}return e}const zY=nF(C_);function iF(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];i instanceof Et?i.set(e[n]):iF(t[n],e[n])}}const UY=()=>iF(C_,zY),If=new Set;async function tt(t,e){const n=ee.get(Nn);if(n.type==="stopped")return null;if(n.type==="paused")return await new Promise(s=>{const o=ee.sub(Nn,()=>{ee.get(Nn).type!=="paused"&&(o(),s())})}),await tt(t,e);const i=Si();if(!i.animations&&!e.forceMs)return null;const r={duration:e.forceMs?e.duration:e.duration*i.executionUnit,easing:$j[e.easing]};return Array.isArray(t)||(t=[t]),await Promise.all(t.map(async({key:s,from:o,to:a})=>{if(a===void 0&&o===void 0)return null;const l=ft(s);if(a===void 0)return l.set(o);{If.add(s);const u=await ft(s).start({from:o,to:a,config:r});return If.delete(s),u}}))}const VY=()=>If.forEach(t=>ft(t).pause()),HY=()=>If.forEach(t=>ft(t).resume());function rF(){If.forEach(t=>{const e=ft(t);e.stop(!0),e.isPaused&&e.resume()}),setTimeout(()=>UY(),10)}async function ar(t,e=bt.mantis[400]){return await tt({key:`${t}.backgroundColor`,to:e},{duration:1,easing:"easeOutQuart"})}async function lr(t){return await tt({key:`${t}.backgroundColor`,to:bt.stone[800]},{duration:1,easing:"easeOutQuart"})}async function zc(t){await tt({key:"bus.data.stroke",to:bt.mantis[400]},{duration:5,easing:"easeOutSine"}),await ar("cpu.MBR"),ee.set(Cv,t),await lr("cpu.MBR")}async function _r(t,e){return await tt([{key:`${t}.strokeDashoffset`,from:1,to:0},{key:`${t}.opacity`,from:1}],{duration:e,easing:"easeInOutSine"})}async function ti(t){return await tt({key:`${t}.opacity`,to:0},{duration:1,easing:"easeInSine"})}async function WY(t){switch(t.type){case"bus:io.selected":{await Promise.all([tt({key:"bus.mem.stroke",to:bt.stone[700]},{duration:1,easing:"easeInSine"}),_r(`bus.${t.chip}`,15)]);return}case"bus:io.error":{Vc(t.error);return}case"bus:reset":{await Promise.all([tt([{key:"bus.address.stroke",to:bt.stone[700]},{key:"bus.data.stroke",to:bt.stone[700]},{key:"bus.rd.stroke",to:bt.stone[700]},{key:"bus.wr.stroke",to:bt.stone[700]}],{duration:1,easing:"easeInSine"}),tt({key:"bus.mem.stroke",to:bt.red[500]},{duration:1,easing:"easeOutSine"}),ti("bus.iom"),ti("bus.handshake"),ti("bus.pio"),ti("bus.pic"),ti("bus.timer")]);return}default:return t}}async function GY(t){switch(t.type){case"clock:tick":return;default:return t.type}}function KY(t){switch(t){case"IP":return"M 451 309 H 575 V 349 H 698";case"SP":return"M 451 349 H 698";case"ri":return"M 454 388 H 575 V 349 H 698";default:throw new Error(`Invalid register ${t}`)}}function XY(){const{path:t,...e}=ft("cpu.internalBus.address");return g.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[g.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:["M 451 309 H 575 V 349","M 451 349 H 575","M 444 388 H 575 V 349","M 451 349 H 698"].join(" ")}),g.jsx(Gt.path,{d:t,className:"fill-none stroke-blue-500 stroke-bus",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:e})]})}var E_={exports:{}},fc=typeof Reflect=="object"?Reflect:null,KT=fc&&typeof fc.apply=="function"?fc.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},hg;fc&&typeof fc.ownKeys=="function"?hg=fc.ownKeys:Object.getOwnPropertySymbols?hg=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:hg=function(e){return Object.getOwnPropertyNames(e)};function qY(t){console&&console.warn&&console.warn(t)}var sF=Number.isNaN||function(e){return e!==e};function pt(){pt.init.call(this)}E_.exports=pt;E_.exports.once=QY;pt.EventEmitter=pt;pt.prototype._events=void 0;pt.prototype._eventsCount=0;pt.prototype._maxListeners=void 0;var XT=10;function Wy(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(pt,"defaultMaxListeners",{enumerable:!0,get:function(){return XT},set:function(t){if(typeof t!="number"||t<0||sF(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");XT=t}});pt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};pt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||sF(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function oF(t){return t._maxListeners===void 0?pt.defaultMaxListeners:t._maxListeners}pt.prototype.getMaxListeners=function(){return oF(this)};pt.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")KT(l,this,n);else for(var u=l.length,c=dF(l,u),i=0;i<u;++i)KT(c[i],this,n);return!0};function aF(t,e,n,i){var r,s,o;if(Wy(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),r=oF(t),r>0&&o.length>r&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,qY(a)}return t}pt.prototype.addListener=function(e,n){return aF(this,e,n,!1)};pt.prototype.on=pt.prototype.addListener;pt.prototype.prependListener=function(e,n){return aF(this,e,n,!0)};function YY(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function lF(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=YY.bind(i);return r.listener=n,i.wrapFn=r,r}pt.prototype.once=function(e,n){return Wy(n),this.on(e,lF(this,e,n)),this};pt.prototype.prependOnceListener=function(e,n){return Wy(n),this.prependListener(e,lF(this,e,n)),this};pt.prototype.removeListener=function(e,n){var i,r,s,o,a;if(Wy(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===n||i[o].listener===n){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():JY(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};pt.prototype.off=pt.prototype.removeListener;pt.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(r=0;r<s.length;++r)o=s[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function uF(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?ZY(r):dF(r,r.length)}pt.prototype.listeners=function(e){return uF(this,e,!0)};pt.prototype.rawListeners=function(e){return uF(this,e,!1)};pt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):cF.call(t,e)};pt.prototype.listenerCount=cF;function cF(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}pt.prototype.eventNames=function(){return this._eventsCount>0?hg(this._events):[]};function dF(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function JY(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function ZY(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function QY(t,e){return new Promise(function(n,i){function r(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}hF(t,e,s,{once:!0}),e!=="error"&&eJ(t,r,{once:!0})})}function eJ(t,e,n){typeof t.on=="function"&&hF(t,"error",e,n)}function hF(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var tJ=E_.exports;function Us(t){if(typeof t!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=t}typeof Symbol<"u"&&(Us.prototype[Symbol.iterator]=function(){return this});Us.of=function(){var t=arguments,e=t.length,n=0;return new Us(function(){return n>=e?{done:!0}:{done:!1,value:t[n++]}})};Us.empty=function(){var t=new Us(function(){return{done:!0}});return t};Us.fromSequence=function(t){var e=0,n=t.length;return new Us(function(){return e>=n?{done:!0}:{done:!1,value:t[e++]}})};Us.is=function(t){return t instanceof Us?!0:typeof t=="object"&&t!==null&&typeof t.next=="function"};var Gy=Us;const Nr=Yc(Gy);var Ky={};Ky.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";Ky.SYMBOL_SUPPORT=typeof Symbol<"u";var nJ=Gy,fF=Ky,iJ=fF.ARRAY_BUFFER_SUPPORT,rJ=fF.SYMBOL_SUPPORT;function sJ(t){return typeof t=="string"||Array.isArray(t)||iJ&&ArrayBuffer.isView(t)?nJ.fromSequence(t):typeof t!="object"||t===null?null:rJ&&typeof t[Symbol.iterator]=="function"?t[Symbol.iterator]():typeof t.next=="function"?t:null}var pF=function(e){var n=sJ(e);if(!n)throw new Error("obliterator: target is not iterable nor a valid iterator.");return n},oJ=pF,aJ=function(e,n){for(var i=arguments.length>1?n:1/0,r=i!==1/0?new Array(i):[],s,o=0,a=oJ(e);;){if(o===i)return r;if(s=a.next(),s.done)return o!==n&&(r.length=o),r;r[o++]=s.value}};const mF=Yc(aJ);var lJ=Gy,uJ=pF,cJ=function(){var e=arguments,n=null,i=-1;return new lJ(function(){var s=null;do{if(n===null){if(i++,i>=e.length)return{done:!0};n=uJ(e[i])}if(s=n.next(),s.done===!0){n=null;continue}break}while(!0);return s})};const ko=Yc(cJ);function dJ(){const t=arguments[0];for(let e=1,n=arguments.length;e<n;e++)if(arguments[e])for(const i in arguments[e])t[i]=arguments[e][i];return t}let sn=dJ;typeof Object.assign=="function"&&(sn=Object.assign);function Cr(t,e,n,i){const r=t._nodes.get(e);let s=null;return r&&(i==="mixed"?s=r.out&&r.out[n]||r.undirected&&r.undirected[n]:i==="directed"?s=r.out&&r.out[n]:s=r.undirected&&r.undirected[n]),s}function Pn(t){return typeof t=="object"&&t!==null}function gF(t){let e;for(e in t)return!1;return!0}function nr(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,writable:!0,value:n})}function Or(t,e,n){const i={enumerable:!0,configurable:!0};typeof n=="function"?i.get=n:(i.value=n,i.writable=!1),Object.defineProperty(t,e,i)}function qT(t){return!(!Pn(t)||t.attributes&&!Array.isArray(t.attributes))}function hJ(){let t=Math.floor(Math.random()*256)&255;return()=>t++}class A_ extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class ge extends A_{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ge.prototype.constructor)}}class ce extends A_{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ce.prototype.constructor)}}class Ie extends A_{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ie.prototype.constructor)}}function vF(t,e){this.key=t,this.attributes=e,this.clear()}vF.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function yF(t,e){this.key=t,this.attributes=e,this.clear()}yF.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function wF(t,e){this.key=t,this.attributes=e,this.clear()}wF.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function rd(t,e,n,i,r){this.key=e,this.attributes=r,this.undirected=t,this.source=n,this.target=i}rd.prototype.attach=function(){let t="out",e="in";this.undirected&&(t=e="undirected");const n=this.source.key,i=this.target.key;this.source[t][i]=this,!(this.undirected&&n===i)&&(this.target[e][n]=this)};rd.prototype.attachMulti=function(){let t="out",e="in";const n=this.source.key,i=this.target.key;this.undirected&&(t=e="undirected");const r=this.source[t],s=r[i];if(typeof s>"u"){r[i]=this,this.undirected&&n===i||(this.target[e][n]=this);return}s.previous=this,this.next=s,r[i]=this,this.target[e][n]=this};rd.prototype.detach=function(){const t=this.source.key,e=this.target.key;let n="out",i="in";this.undirected&&(n=i="undirected"),delete this.source[n][e],delete this.target[i][t]};rd.prototype.detachMulti=function(){const t=this.source.key,e=this.target.key;let n="out",i="in";this.undirected&&(n=i="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[n][e],delete this.target[i][t]):(this.next.previous=void 0,this.source[n][e]=this.next,this.target[i][t]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const bF=0,xF=1,fJ=2,SF=3;function zo(t,e,n,i,r,s,o){let a,l,u,c;if(i=""+i,n===bF){if(a=t._nodes.get(i),!a)throw new ce(`Graph.${e}: could not find the "${i}" node in the graph.`);u=r,c=s}else if(n===SF){if(r=""+r,l=t._edges.get(r),!l)throw new ce(`Graph.${e}: could not find the "${r}" edge in the graph.`);const d=l.source.key,h=l.target.key;if(i===d)a=l.target;else if(i===h)a=l.source;else throw new ce(`Graph.${e}: the "${i}" node is not attached to the "${r}" edge (${d}, ${h}).`);u=s,c=o}else{if(l=t._edges.get(i),!l)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`);n===xF?a=l.source:a=l.target,u=r,c=s}return[a,u,c]}function pJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=zo(this,e,n,i,r,s);return o.attributes[a]}}function mJ(t,e,n){t.prototype[e]=function(i,r){const[s]=zo(this,e,n,i,r);return s.attributes}}function gJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=zo(this,e,n,i,r,s);return o.attributes.hasOwnProperty(a)}}function vJ(t,e,n){t.prototype[e]=function(i,r,s,o){const[a,l,u]=zo(this,e,n,i,r,s,o);return a.attributes[l]=u,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:l}),this}}function yJ(t,e,n){t.prototype[e]=function(i,r,s,o){const[a,l,u]=zo(this,e,n,i,r,s,o);if(typeof u!="function")throw new ge(`Graph.${e}: updater should be a function.`);const c=a.attributes,d=u(c[l]);return c[l]=d,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:l}),this}}function wJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=zo(this,e,n,i,r,s);return delete o.attributes[a],this.emit("nodeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:a}),this}}function bJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=zo(this,e,n,i,r,s);if(!Pn(a))throw new ge(`Graph.${e}: provided attributes are not a plain object.`);return o.attributes=a,this.emit("nodeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function xJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=zo(this,e,n,i,r,s);if(!Pn(a))throw new ge(`Graph.${e}: provided attributes are not a plain object.`);return sn(o.attributes,a),this.emit("nodeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:a}),this}}function SJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=zo(this,e,n,i,r,s);if(typeof a!="function")throw new ge(`Graph.${e}: provided updater is not a function.`);return o.attributes=a(o.attributes),this.emit("nodeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const kJ=[{name:t=>`get${t}Attribute`,attacher:pJ},{name:t=>`get${t}Attributes`,attacher:mJ},{name:t=>`has${t}Attribute`,attacher:gJ},{name:t=>`set${t}Attribute`,attacher:vJ},{name:t=>`update${t}Attribute`,attacher:yJ},{name:t=>`remove${t}Attribute`,attacher:wJ},{name:t=>`replace${t}Attributes`,attacher:bJ},{name:t=>`merge${t}Attributes`,attacher:xJ},{name:t=>`update${t}Attributes`,attacher:SJ}];function _J(t){kJ.forEach(function({name:e,attacher:n}){n(t,e("Node"),bF),n(t,e("Source"),xF),n(t,e("Target"),fJ),n(t,e("Opposite"),SF)})}function CJ(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ie(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ie(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ie(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return s.attributes[r]}}function EJ(t,e,n){t.prototype[e]=function(i){let r;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ie(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new Ie(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+i,o=""+arguments[1];if(r=Cr(this,s,o,n),!r)throw new ce(`Graph.${e}: could not find an edge for the given path ("${s}" - "${o}").`)}else{if(n!=="mixed")throw new Ie(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,r=this._edges.get(i),!r)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return r.attributes}}function AJ(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ie(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ie(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ie(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return s.attributes.hasOwnProperty(r)}}function PJ(t,e,n){t.prototype[e]=function(i,r,s){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ie(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Ie(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,l=""+r;if(r=arguments[2],s=arguments[3],o=Cr(this,a,l,n),!o)throw new ce(`Graph.${e}: could not find an edge for the given path ("${a}" - "${l}").`)}else{if(n!=="mixed")throw new Ie(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return o.attributes[r]=s,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}function TJ(t,e,n){t.prototype[e]=function(i,r,s){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ie(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Ie(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,l=""+r;if(r=arguments[2],s=arguments[3],o=Cr(this,a,l,n),!o)throw new ce(`Graph.${e}: could not find an edge for the given path ("${a}" - "${l}").`)}else{if(n!=="mixed")throw new Ie(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(typeof s!="function")throw new ge(`Graph.${e}: updater should be a function.`);return o.attributes[r]=s(o.attributes[r]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}function RJ(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ie(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ie(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ie(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return delete s.attributes[r],this.emit("edgeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:r}),this}}function NJ(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ie(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ie(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ie(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(!Pn(r))throw new ge(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=r,this.emit("edgeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function MJ(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ie(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ie(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ie(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(!Pn(r))throw new ge(`Graph.${e}: provided attributes are not a plain object.`);return sn(s.attributes,r),this.emit("edgeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:r}),this}}function OJ(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Ie(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Ie(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Ie(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(typeof r!="function")throw new ge(`Graph.${e}: provided updater is not a function.`);return s.attributes=r(s.attributes),this.emit("edgeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}const IJ=[{name:t=>`get${t}Attribute`,attacher:CJ},{name:t=>`get${t}Attributes`,attacher:EJ},{name:t=>`has${t}Attribute`,attacher:AJ},{name:t=>`set${t}Attribute`,attacher:PJ},{name:t=>`update${t}Attribute`,attacher:TJ},{name:t=>`remove${t}Attribute`,attacher:RJ},{name:t=>`replace${t}Attributes`,attacher:NJ},{name:t=>`merge${t}Attributes`,attacher:MJ},{name:t=>`update${t}Attributes`,attacher:OJ}];function DJ(t){IJ.forEach(function({name:e,attacher:n}){n(t,e("Edge"),"mixed"),n(t,e("DirectedEdge"),"directed"),n(t,e("UndirectedEdge"),"undirected")})}const LJ=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function jJ(t,e,n,i){let r=!1;for(const s in e){if(s===i)continue;const o=e[s];if(r=n(o.key,o.attributes,o.source.key,o.target.key,o.source.attributes,o.target.attributes,o.undirected),t&&r)return o.key}}function FJ(t,e,n,i){let r,s,o,a=!1;for(const l in e)if(l!==i){r=e[l];do{if(s=r.source,o=r.target,a=n(r.key,r.attributes,s.key,o.key,s.attributes,o.attributes,r.undirected),t&&a)return r.key;r=r.next}while(r!==void 0)}}function jw(t,e){const n=Object.keys(t),i=n.length;let r,s=0;return new Nr(function(){do if(r)r=r.next;else{if(s>=i)return{done:!0};const a=n[s++];if(a===e){r=void 0;continue}r=t[a]}while(!r);return{done:!1,value:{edge:r.key,attributes:r.attributes,source:r.source.key,target:r.target.key,sourceAttributes:r.source.attributes,targetAttributes:r.target.attributes,undirected:r.undirected}}})}function BJ(t,e,n,i){const r=e[n];if(!r)return;const s=r.source,o=r.target;if(i(r.key,r.attributes,s.key,o.key,s.attributes,o.attributes,r.undirected)&&t)return r.key}function $J(t,e,n,i){let r=e[n];if(!r)return;let s=!1;do{if(s=i(r.key,r.attributes,r.source.key,r.target.key,r.source.attributes,r.target.attributes,r.undirected),t&&s)return r.key;r=r.next}while(r!==void 0)}function Fw(t,e){let n=t[e];return n.next!==void 0?new Nr(function(){if(!n)return{done:!0};const i={edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected};return n=n.next,{done:!1,value:i}}):Nr.of({edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected})}function zJ(t,e){if(t.size===0)return[];if(e==="mixed"||e===t.type)return typeof Array.from=="function"?Array.from(t._edges.keys()):mF(t._edges.keys(),t._edges.size);const n=e==="undirected"?t.undirectedSize:t.directedSize,i=new Array(n),r=e==="undirected",s=t._edges.values();let o=0,a,l;for(;a=s.next(),a.done!==!0;)l=a.value,l.undirected===r&&(i[o++]=l.key);return i}function kF(t,e,n,i){if(e.size===0)return;const r=n!=="mixed"&&n!==e.type,s=n==="undirected";let o,a,l=!1;const u=e._edges.values();for(;o=u.next(),o.done!==!0;){if(a=o.value,r&&a.undirected!==s)continue;const{key:c,attributes:d,source:h,target:f}=a;if(l=i(c,d,h.key,f.key,h.attributes,f.attributes,a.undirected),t&&l)return c}}function UJ(t,e){if(t.size===0)return Nr.empty();const n=e!=="mixed"&&e!==t.type,i=e==="undirected",r=t._edges.values();return new Nr(function(){let o,a;for(;;){if(o=r.next(),o.done)return o;if(a=o.value,!(n&&a.undirected!==i))break}return{value:{edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected},done:!1}})}function P_(t,e,n,i,r,s){const o=e?FJ:jJ;let a;if(n!=="undirected"&&(i!=="out"&&(a=o(t,r.in,s),t&&a)||i!=="in"&&(a=o(t,r.out,s,i?void 0:r.key),t&&a))||n!=="directed"&&(a=o(t,r.undirected,s),t&&a))return a}function VJ(t,e,n,i){const r=[];return P_(!1,t,e,n,i,function(s){r.push(s)}),r}function HJ(t,e,n){let i=Nr.empty();return t!=="undirected"&&(e!=="out"&&typeof n.in<"u"&&(i=ko(i,jw(n.in))),e!=="in"&&typeof n.out<"u"&&(i=ko(i,jw(n.out,e?void 0:n.key)))),t!=="directed"&&typeof n.undirected<"u"&&(i=ko(i,jw(n.undirected))),i}function T_(t,e,n,i,r,s,o){const a=n?$J:BJ;let l;if(e!=="undirected"&&(typeof r.in<"u"&&i!=="out"&&(l=a(t,r.in,s,o),t&&l)||typeof r.out<"u"&&i!=="in"&&(i||r.key!==s)&&(l=a(t,r.out,s,o),t&&l))||e!=="directed"&&typeof r.undirected<"u"&&(l=a(t,r.undirected,s,o),t&&l))return l}function WJ(t,e,n,i,r){const s=[];return T_(!1,t,e,n,i,r,function(o){s.push(o)}),s}function GJ(t,e,n,i){let r=Nr.empty();return t!=="undirected"&&(typeof n.in<"u"&&e!=="out"&&i in n.in&&(r=ko(r,Fw(n.in,i))),typeof n.out<"u"&&e!=="in"&&i in n.out&&(e||n.key!==i)&&(r=ko(r,Fw(n.out,i)))),t!=="directed"&&typeof n.undirected<"u"&&i in n.undirected&&(r=ko(r,Fw(n.undirected,i))),r}function KJ(t,e){const{name:n,type:i,direction:r}=e;t.prototype[n]=function(s,o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];if(!arguments.length)return zJ(this,i);if(arguments.length===1){s=""+s;const a=this._nodes.get(s);if(typeof a>"u")throw new ce(`Graph.${n}: could not find the "${s}" node in the graph.`);return VJ(this.multi,i==="mixed"?this.type:i,r,a)}if(arguments.length===2){s=""+s,o=""+o;const a=this._nodes.get(s);if(!a)throw new ce(`Graph.${n}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(o))throw new ce(`Graph.${n}:  could not find the "${o}" target node in the graph.`);return WJ(i,this.multi,r,a,o)}throw new ge(`Graph.${n}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function XJ(t,e){const{name:n,type:i,direction:r}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(u,c,d){if(!(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)){if(arguments.length===1)return d=u,kF(!1,this,i,d);if(arguments.length===2){u=""+u,d=c;const h=this._nodes.get(u);if(typeof h>"u")throw new ce(`Graph.${s}: could not find the "${u}" node in the graph.`);return P_(!1,this.multi,i==="mixed"?this.type:i,r,h,d)}if(arguments.length===3){u=""+u,c=""+c;const h=this._nodes.get(u);if(!h)throw new ce(`Graph.${s}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(c))throw new ce(`Graph.${s}:  could not find the "${c}" target node in the graph.`);return T_(!1,i,this.multi,r,h,c,d)}throw new ge(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop();let d;if(u.length===0){let h=0;i!=="directed"&&(h+=this.undirectedSize),i!=="undirected"&&(h+=this.directedSize),d=new Array(h);let f=0;u.push((p,m,w,v,y,b,k)=>{d[f++]=c(p,m,w,v,y,b,k)})}else d=[],u.push((h,f,p,m,w,v,y)=>{d.push(c(h,f,p,m,w,v,y))});return this[s].apply(this,u),d};const a="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop(),d=[];return u.push((h,f,p,m,w,v,y)=>{c(h,f,p,m,w,v,y)&&d.push(h)}),this[s].apply(this,u),d};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(){let u=Array.prototype.slice.call(arguments);if(u.length<2||u.length>4)throw new ge(`Graph.${l}: invalid number of arguments (expecting 2, 3 or 4 and got ${u.length}).`);if(typeof u[u.length-1]=="function"&&typeof u[u.length-2]!="function")throw new ge(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let c,d;u.length===2?(c=u[0],d=u[1],u=[]):u.length===3?(c=u[1],d=u[2],u=[u[0]]):u.length===4&&(c=u[2],d=u[3],u=[u[0],u[1]]);let h=d;return u.push((f,p,m,w,v,y,b)=>{h=c(h,f,p,m,w,v,y,b)}),this[s].apply(this,u),h}}function qJ(t,e){const{name:n,type:i,direction:r}=e,s="find"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(l,u,c){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return!1;if(arguments.length===1)return c=l,kF(!0,this,i,c);if(arguments.length===2){l=""+l,c=u;const d=this._nodes.get(l);if(typeof d>"u")throw new ce(`Graph.${s}: could not find the "${l}" node in the graph.`);return P_(!0,this.multi,i==="mixed"?this.type:i,r,d,c)}if(arguments.length===3){l=""+l,u=""+u;const d=this._nodes.get(l);if(!d)throw new ce(`Graph.${s}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(u))throw new ce(`Graph.${s}:  could not find the "${u}" target node in the graph.`);return T_(!0,i,this.multi,r,d,u,c)}throw new ge(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const o="some"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[o]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((d,h,f,p,m,w,v)=>u(d,h,f,p,m,w,v)),!!this[s].apply(this,l)};const a="every"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[a]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((d,h,f,p,m,w,v)=>!u(d,h,f,p,m,w,v)),!this[s].apply(this,l)}}function YJ(t,e){const{name:n,type:i,direction:r}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(o,a){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return Nr.empty();if(!arguments.length)return UJ(this,i);if(arguments.length===1){o=""+o;const l=this._nodes.get(o);if(!l)throw new ce(`Graph.${s}: could not find the "${o}" node in the graph.`);return HJ(i,r,l)}if(arguments.length===2){o=""+o,a=""+a;const l=this._nodes.get(o);if(!l)throw new ce(`Graph.${s}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new ce(`Graph.${s}:  could not find the "${a}" target node in the graph.`);return GJ(i,r,l,a)}throw new ge(`Graph.${s}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function JJ(t){LJ.forEach(e=>{KJ(t,e),XJ(t,e),qJ(t,e),YJ(t,e)})}const ZJ=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Xy(){this.A=null,this.B=null}Xy.prototype.wrap=function(t){this.A===null?this.A=t:this.B===null&&(this.B=t)};Xy.prototype.has=function(t){return this.A!==null&&t in this.A||this.B!==null&&t in this.B};function Td(t,e,n,i,r){for(const s in i){const o=i[s],a=o.source,l=o.target,u=a===n?l:a;if(e&&e.has(u.key))continue;const c=r(u.key,u.attributes);if(t&&c)return u.key}}function R_(t,e,n,i,r){if(e!=="mixed"){if(e==="undirected")return Td(t,null,i,i.undirected,r);if(typeof n=="string")return Td(t,null,i,i[n],r)}const s=new Xy;let o;if(e!=="undirected"){if(n!=="out"){if(o=Td(t,null,i,i.in,r),t&&o)return o;s.wrap(i.in)}if(n!=="in"){if(o=Td(t,s,i,i.out,r),t&&o)return o;s.wrap(i.out)}}if(e!=="directed"&&(o=Td(t,s,i,i.undirected,r),t&&o))return o}function QJ(t,e,n){if(t!=="mixed"){if(t==="undirected")return Object.keys(n.undirected);if(typeof e=="string")return Object.keys(n[e])}const i=[];return R_(!1,t,e,n,function(r){i.push(r)}),i}function Rd(t,e,n){const i=Object.keys(n),r=i.length;let s=0;return new Nr(function(){let a=null;do{if(s>=r)return t&&t.wrap(n),{done:!0};const l=n[i[s++]],u=l.source,c=l.target;if(a=u===e?c:u,t&&t.has(a.key)){a=null;continue}}while(a===null);return{done:!1,value:{neighbor:a.key,attributes:a.attributes}}})}function eZ(t,e,n){if(t!=="mixed"){if(t==="undirected")return Rd(null,n,n.undirected);if(typeof e=="string")return Rd(null,n,n[e])}let i=Nr.empty();const r=new Xy;return t!=="undirected"&&(e!=="out"&&(i=ko(i,Rd(r,n,n.in))),e!=="in"&&(i=ko(i,Rd(r,n,n.out)))),t!=="directed"&&(i=ko(i,Rd(r,n,n.undirected))),i}function tZ(t,e){const{name:n,type:i,direction:r}=e;t.prototype[n]=function(s){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];s=""+s;const o=this._nodes.get(s);if(typeof o>"u")throw new ce(`Graph.${n}: could not find the "${s}" node in the graph.`);return QJ(i==="mixed"?this.type:i,r,o)}}function nZ(t,e){const{name:n,type:i,direction:r}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(u,c){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;u=""+u;const d=this._nodes.get(u);if(typeof d>"u")throw new ce(`Graph.${s}: could not find the "${u}" node in the graph.`);R_(!1,i==="mixed"?this.type:i,r,d,c)};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(u,c){const d=[];return this[s](u,(h,f)=>{d.push(c(h,f))}),d};const a="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(u,c){const d=[];return this[s](u,(h,f)=>{c(h,f)&&d.push(h)}),d};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(u,c,d){if(arguments.length<3)throw new ge(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let h=d;return this[s](u,(f,p)=>{h=c(h,f,p)}),h}}function iZ(t,e){const{name:n,type:i,direction:r}=e,s=n[0].toUpperCase()+n.slice(1,-1),o="find"+s;t.prototype[o]=function(u,c){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;u=""+u;const d=this._nodes.get(u);if(typeof d>"u")throw new ce(`Graph.${o}: could not find the "${u}" node in the graph.`);return R_(!0,i==="mixed"?this.type:i,r,d,c)};const a="some"+s;t.prototype[a]=function(u,c){return!!this[o](u,c)};const l="every"+s;t.prototype[l]=function(u,c){return!this[o](u,(h,f)=>!c(h,f))}}function rZ(t,e){const{name:n,type:i,direction:r}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return Nr.empty();o=""+o;const a=this._nodes.get(o);if(typeof a>"u")throw new ce(`Graph.${s}: could not find the "${o}" node in the graph.`);return eZ(i==="mixed"?this.type:i,r,a)}}function sZ(t){ZJ.forEach(e=>{tZ(t,e),nZ(t,e),iZ(t,e),rZ(t,e)})}function mm(t,e,n,i,r){const s=i._nodes.values(),o=i.type;let a,l,u,c,d,h;for(;a=s.next(),a.done!==!0;){let f=!1;if(l=a.value,o!=="undirected"){c=l.out;for(u in c){d=c[u];do h=d.target,f=!0,r(l.key,h.key,l.attributes,h.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}if(o!=="directed"){c=l.undirected;for(u in c)if(!(e&&l.key>u)){d=c[u];do h=d.target,h.key!==u&&(h=d.source),f=!0,r(l.key,h.key,l.attributes,h.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}n&&!f&&r(l.key,null,l.attributes,null,null,null,null)}}function oZ(t,e){const n={key:t};return gF(e.attributes)||(n.attributes=sn({},e.attributes)),n}function aZ(t,e,n){const i={key:e,source:n.source.key,target:n.target.key};return gF(n.attributes)||(i.attributes=sn({},n.attributes)),t==="mixed"&&n.undirected&&(i.undirected=!0),i}function lZ(t){if(!Pn(t))throw new ge('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in t))throw new ge("Graph.import: serialized node is missing its key.");if("attributes"in t&&(!Pn(t.attributes)||t.attributes===null))throw new ge("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function uZ(t){if(!Pn(t))throw new ge('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in t))throw new ge("Graph.import: serialized edge is missing its source.");if(!("target"in t))throw new ge("Graph.import: serialized edge is missing its target.");if("attributes"in t&&(!Pn(t.attributes)||t.attributes===null))throw new ge("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in t&&typeof t.undirected!="boolean")throw new ge("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const cZ=hJ(),dZ=new Set(["directed","undirected","mixed"]),YT=new Set(["domain","_events","_eventsCount","_maxListeners"]),hZ=[{name:t=>`${t}Edge`,generateKey:!0},{name:t=>`${t}DirectedEdge`,generateKey:!0,type:"directed"},{name:t=>`${t}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:t=>`${t}EdgeWithKey`},{name:t=>`${t}DirectedEdgeWithKey`,type:"directed"},{name:t=>`${t}UndirectedEdgeWithKey`,type:"undirected"}],fZ={allowSelfLoops:!0,multi:!1,type:"mixed"};function pZ(t,e,n){if(n&&!Pn(n))throw new ge(`Graph.addNode: invalid attributes. Expecting an object but got "${n}"`);if(e=""+e,n=n||{},t._nodes.has(e))throw new Ie(`Graph.addNode: the "${e}" node already exist in the graph.`);const i=new t.NodeDataClass(e,n);return t._nodes.set(e,i),t.emit("nodeAdded",{key:e,attributes:n}),i}function JT(t,e,n){const i=new t.NodeDataClass(e,n);return t._nodes.set(e,i),t.emit("nodeAdded",{key:e,attributes:n}),i}function _F(t,e,n,i,r,s,o,a){if(!i&&t.type==="undirected")throw new Ie(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(i&&t.type==="directed")throw new Ie(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(a&&!Pn(a))throw new ge(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`);if(s=""+s,o=""+o,a=a||{},!t.allowSelfLoops&&s===o)throw new Ie(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const l=t._nodes.get(s),u=t._nodes.get(o);if(!l)throw new ce(`Graph.${e}: source node "${s}" not found.`);if(!u)throw new ce(`Graph.${e}: target node "${o}" not found.`);const c={key:null,undirected:i,source:s,target:o,attributes:a};if(n)r=t._edgeKeyGenerator();else if(r=""+r,t._edges.has(r))throw new Ie(`Graph.${e}: the "${r}" edge already exists in the graph.`);if(!t.multi&&(i?typeof l.undirected[o]<"u":typeof l.out[o]<"u"))throw new Ie(`Graph.${e}: an edge linking "${s}" to "${o}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const d=new rd(i,r,l,u,a);t._edges.set(r,d);const h=s===o;return i?(l.undirectedDegree++,u.undirectedDegree++,h&&(l.undirectedLoops++,t._undirectedSelfLoopCount++)):(l.outDegree++,u.inDegree++,h&&(l.directedLoops++,t._directedSelfLoopCount++)),t.multi?d.attachMulti():d.attach(),i?t._undirectedSize++:t._directedSize++,c.key=r,t.emit("edgeAdded",c),r}function mZ(t,e,n,i,r,s,o,a,l){if(!i&&t.type==="undirected")throw new Ie(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(i&&t.type==="directed")throw new Ie(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(a){if(l){if(typeof a!="function")throw new ge(`Graph.${e}: invalid updater function. Expecting a function but got "${a}"`)}else if(!Pn(a))throw new ge(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`)}s=""+s,o=""+o;let u;if(l&&(u=a,a=void 0),!t.allowSelfLoops&&s===o)throw new Ie(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let c=t._nodes.get(s),d=t._nodes.get(o),h,f;if(!n&&(h=t._edges.get(r),h)){if((h.source.key!==s||h.target.key!==o)&&(!i||h.source.key!==o||h.target.key!==s))throw new Ie(`Graph.${e}: inconsistency detected when attempting to merge the "${r}" edge with "${s}" source & "${o}" target vs. ("${h.source.key}", "${h.target.key}").`);f=h}if(!f&&!t.multi&&c&&(f=i?c.undirected[o]:c.out[o]),f){const y=[f.key,!1,!1,!1];if(l?!u:!a)return y;if(l){const b=f.attributes;f.attributes=u(b),t.emit("edgeAttributesUpdated",{type:"replace",key:f.key,attributes:f.attributes})}else sn(f.attributes,a),t.emit("edgeAttributesUpdated",{type:"merge",key:f.key,attributes:f.attributes,data:a});return y}a=a||{},l&&u&&(a=u(a));const p={key:null,undirected:i,source:s,target:o,attributes:a};if(n)r=t._edgeKeyGenerator();else if(r=""+r,t._edges.has(r))throw new Ie(`Graph.${e}: the "${r}" edge already exists in the graph.`);let m=!1,w=!1;c||(c=JT(t,s,{}),m=!0,s===o&&(d=c,w=!0)),d||(d=JT(t,o,{}),w=!0),h=new rd(i,r,c,d,a),t._edges.set(r,h);const v=s===o;return i?(c.undirectedDegree++,d.undirectedDegree++,v&&(c.undirectedLoops++,t._undirectedSelfLoopCount++)):(c.outDegree++,d.inDegree++,v&&(c.directedLoops++,t._directedSelfLoopCount++)),t.multi?h.attachMulti():h.attach(),i?t._undirectedSize++:t._directedSize++,p.key=r,t.emit("edgeAdded",p),[r,!0,m,w]}function wu(t,e){t._edges.delete(e.key);const{source:n,target:i,attributes:r}=e,s=e.undirected,o=n===i;s?(n.undirectedDegree--,i.undirectedDegree--,o&&(n.undirectedLoops--,t._undirectedSelfLoopCount--)):(n.outDegree--,i.inDegree--,o&&(n.directedLoops--,t._directedSelfLoopCount--)),t.multi?e.detachMulti():e.detach(),s?t._undirectedSize--:t._directedSize--,t.emit("edgeDropped",{key:e.key,attributes:r,source:n.key,target:i.key,undirected:s})}class St extends tJ.EventEmitter{constructor(e){if(super(),e=sn({},fZ,e),typeof e.multi!="boolean")throw new ge(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!dZ.has(e.type))throw new ge(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new ge(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const n=e.type==="mixed"?vF:e.type==="directed"?yF:wF;nr(this,"NodeDataClass",n);const i="geid_"+cZ()+"_";let r=0;const s=()=>{let o;do o=i+r++;while(this._edges.has(o));return o};nr(this,"_attributes",{}),nr(this,"_nodes",new Map),nr(this,"_edges",new Map),nr(this,"_directedSize",0),nr(this,"_undirectedSize",0),nr(this,"_directedSelfLoopCount",0),nr(this,"_undirectedSelfLoopCount",0),nr(this,"_edgeKeyGenerator",s),nr(this,"_options",e),YT.forEach(o=>nr(this,o,this[o])),Or(this,"order",()=>this._nodes.size),Or(this,"size",()=>this._edges.size),Or(this,"directedSize",()=>this._directedSize),Or(this,"undirectedSize",()=>this._undirectedSize),Or(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),Or(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),Or(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),Or(this,"multi",this._options.multi),Or(this,"type",this._options.type),Or(this,"allowSelfLoops",this._options.allowSelfLoops),Or(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,n){if(this.type==="undirected")return!1;if(arguments.length===1){const i=""+e,r=this._edges.get(i);return!!r&&!r.undirected}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?i.out.hasOwnProperty(n):!1}throw new ge(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,n){if(this.type==="directed")return!1;if(arguments.length===1){const i=""+e,r=this._edges.get(i);return!!r&&r.undirected}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?i.undirected.hasOwnProperty(n):!1}throw new ge(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,n){if(arguments.length===1){const i=""+e;return this._edges.has(i)}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?typeof i.out<"u"&&i.out.hasOwnProperty(n)||typeof i.undirected<"u"&&i.undirected.hasOwnProperty(n):!1}throw new ge(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,n){if(this.type==="undirected")return;if(e=""+e,n=""+n,this.multi)throw new Ie("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const i=this._nodes.get(e);if(!i)throw new ce(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ce(`Graph.directedEdge: could not find the "${n}" target node in the graph.`);const r=i.out&&i.out[n]||void 0;if(r)return r.key}undirectedEdge(e,n){if(this.type==="directed")return;if(e=""+e,n=""+n,this.multi)throw new Ie("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const i=this._nodes.get(e);if(!i)throw new ce(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ce(`Graph.undirectedEdge: could not find the "${n}" target node in the graph.`);const r=i.undirected&&i.undirected[n]||void 0;if(r)return r.key}edge(e,n){if(this.multi)throw new Ie("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ce(`Graph.edge: could not find the "${n}" target node in the graph.`);const r=i.out&&i.out[n]||i.undirected&&i.undirected[n]||void 0;if(r)return r.key}areDirectedNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.in||n in i.out}areOutNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.out}areInNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.in}areUndirectedNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:n in i.undirected}areNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(n in i.in||n in i.out)||this.type!=="directed"&&n in i.undirected}areInboundNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in i.in||this.type!=="directed"&&n in i.undirected}areOutboundNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in i.out||this.type!=="directed"&&n in i.undirected}inDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree}outDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree}directedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree}undirectedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree}inboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.inDegree),i}outboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.outDegree),i}degree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.degree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.inDegree+n.outDegree),i}inDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree-n.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree-n.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree-n.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree-n.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.inDegree,r+=n.directedLoops),i-r}outboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.outDegree,r+=n.directedLoops),i-r}degreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.inDegree+n.outDegree,r+=n.directedLoops*2),i-r}source(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.source: could not find the "${e}" edge in the graph.`);return n.source.key}target(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.target: could not find the "${e}" edge in the graph.`);return n.target.key}extremities(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[n.source.key,n.target.key]}opposite(e,n){e=""+e,n=""+n;const i=this._edges.get(n);if(!i)throw new ce(`Graph.opposite: could not find the "${n}" edge in the graph.`);const r=i.source.key,s=i.target.key;if(e===r)return s;if(e===s)return r;throw new ce(`Graph.opposite: the "${e}" node is not attached to the "${n}" edge (${r}, ${s}).`)}hasExtremity(e,n){e=""+e,n=""+n;const i=this._edges.get(e);if(!i)throw new ce(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return i.source.key===n||i.target.key===n}isUndirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return n.undirected}isDirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!n.undirected}isSelfLoop(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return n.source===n.target}addNode(e,n){return pZ(this,e,n).key}mergeNode(e,n){if(n&&!Pn(n))throw new ge(`Graph.mergeNode: invalid attributes. Expecting an object but got "${n}"`);e=""+e,n=n||{};let i=this._nodes.get(e);return i?(n&&(sn(i.attributes,n),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:i.attributes,data:n})),[e,!1]):(i=new this.NodeDataClass(e,n),this._nodes.set(e,i),this.emit("nodeAdded",{key:e,attributes:n}),[e,!0])}updateNode(e,n){if(n&&typeof n!="function")throw new ge(`Graph.updateNode: invalid updater function. Expecting a function but got "${n}"`);e=""+e;let i=this._nodes.get(e);if(i){if(n){const s=i.attributes;i.attributes=n(s),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:i.attributes})}return[e,!1]}const r=n?n({}):{};return i=new this.NodeDataClass(e,r),this._nodes.set(e,i),this.emit("nodeAdded",{key:e,attributes:r}),[e,!0]}dropNode(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.dropNode: could not find the "${e}" node in the graph.`);let i;if(this.type!=="undirected"){for(const r in n.out){i=n.out[r];do wu(this,i),i=i.next;while(i)}for(const r in n.in){i=n.in[r];do wu(this,i),i=i.next;while(i)}}if(this.type!=="directed")for(const r in n.undirected){i=n.undirected[r];do wu(this,i),i=i.next;while(i)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:n.attributes})}dropEdge(e){let n;if(arguments.length>1){const i=""+arguments[0],r=""+arguments[1];if(n=Cr(this,i,r,this.type),!n)throw new ce(`Graph.dropEdge: could not find the "${i}" -> "${r}" edge in the graph.`)}else if(e=""+e,n=this._edges.get(e),!n)throw new ce(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return wu(this,n),this}dropDirectedEdge(e,n){if(arguments.length<2)throw new Ie("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Ie("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,n=""+n;const i=Cr(this,e,n,"directed");if(!i)throw new ce(`Graph.dropDirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return wu(this,i),this}dropUndirectedEdge(e,n){if(arguments.length<2)throw new Ie("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Ie("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const i=Cr(this,e,n,"undirected");if(!i)throw new ce(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return wu(this,i),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let n;for(;n=e.next(),n.done!==!0;)n.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,n){return this._attributes[e]=n,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,n){if(typeof n!="function")throw new ge("Graph.updateAttribute: updater should be a function.");const i=this._attributes[e];return this._attributes[e]=n(i),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!Pn(e))throw new ge("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!Pn(e))throw new ge("Graph.mergeAttributes: provided attributes are not a plain object.");return sn(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new ge("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,n){if(typeof e!="function")throw new ge("Graph.updateEachNodeAttributes: expecting an updater function.");if(n&&!qT(n))throw new ge("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._nodes.values();let r,s;for(;r=i.next(),r.done!==!0;)s=r.value,s.attributes=e(s.key,s.attributes);this.emit("eachNodeAttributesUpdated",{hints:n||null})}updateEachEdgeAttributes(e,n){if(typeof e!="function")throw new ge("Graph.updateEachEdgeAttributes: expecting an updater function.");if(n&&!qT(n))throw new ge("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._edges.values();let r,s,o,a;for(;r=i.next(),r.done!==!0;)s=r.value,o=s.source,a=s.target,s.attributes=e(s.key,s.attributes,o.key,a.key,o.attributes,a.attributes,s.undirected);this.emit("eachEdgeAttributesUpdated",{hints:n||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new ge("Graph.forEachAdjacencyEntry: expecting a callback.");mm(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new ge("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");mm(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new ge("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");mm(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new ge("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");mm(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):mF(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new ge("Graph.forEachNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)r=i.value,e(r.key,r.attributes)}findNode(e){if(typeof e!="function")throw new ge("Graph.findNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,e(r.key,r.attributes))return r.key}mapNodes(e){if(typeof e!="function")throw new ge("Graph.mapNode: expecting a callback.");const n=this._nodes.values();let i,r;const s=new Array(this.order);let o=0;for(;i=n.next(),i.done!==!0;)r=i.value,s[o++]=e(r.key,r.attributes);return s}someNode(e){if(typeof e!="function")throw new ge("Graph.someNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,e(r.key,r.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new ge("Graph.everyNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,!e(r.key,r.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new ge("Graph.filterNodes: expecting a callback.");const n=this._nodes.values();let i,r;const s=[];for(;i=n.next(),i.done!==!0;)r=i.value,e(r.key,r.attributes)&&s.push(r.key);return s}reduceNodes(e,n){if(typeof e!="function")throw new ge("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new ge("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let i=n;const r=this._nodes.values();let s,o;for(;s=r.next(),s.done!==!0;)o=s.value,i=e(i,o.key,o.attributes);return i}nodeEntries(){const e=this._nodes.values();return new Nr(()=>{const n=e.next();if(n.done)return n;const i=n.value;return{value:{node:i.key,attributes:i.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let n=0;this._nodes.forEach((r,s)=>{e[n++]=oZ(s,r)});const i=new Array(this._edges.size);return n=0,this._edges.forEach((r,s)=>{i[n++]=aZ(this.type,s,r)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:i}}import(e,n=!1){if(e instanceof St)return e.forEachNode((l,u)=>{n?this.mergeNode(l,u):this.addNode(l,u)}),e.forEachEdge((l,u,c,d,h,f,p)=>{n?p?this.mergeUndirectedEdgeWithKey(l,c,d,u):this.mergeDirectedEdgeWithKey(l,c,d,u):p?this.addUndirectedEdgeWithKey(l,c,d,u):this.addDirectedEdgeWithKey(l,c,d,u)}),this;if(!Pn(e))throw new ge("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!Pn(e.attributes))throw new ge("Graph.import: invalid attributes. Expecting a plain object.");n?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let i,r,s,o,a;if(e.nodes){if(s=e.nodes,!Array.isArray(s))throw new ge("Graph.import: invalid nodes. Expecting an array.");for(i=0,r=s.length;i<r;i++){o=s[i],lZ(o);const{key:l,attributes:u}=o;n?this.mergeNode(l,u):this.addNode(l,u)}}if(e.edges){let l=!1;if(this.type==="undirected"&&(l=!0),s=e.edges,!Array.isArray(s))throw new ge("Graph.import: invalid edges. Expecting an array.");for(i=0,r=s.length;i<r;i++){a=s[i],uZ(a);const{source:u,target:c,attributes:d,undirected:h=l}=a;let f;"key"in a?(f=n?h?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:h?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,f.call(this,a.key,u,c,d)):(f=n?h?this.mergeUndirectedEdge:this.mergeDirectedEdge:h?this.addUndirectedEdge:this.addDirectedEdge,f.call(this,u,c,d))}}return this}nullCopy(e){const n=new St(sn({},this._options,e));return n.replaceAttributes(sn({},this.getAttributes())),n}emptyCopy(e){const n=this.nullCopy(e);return this._nodes.forEach((i,r)=>{const s=sn({},i.attributes);i=new n.NodeDataClass(r,s),n._nodes.set(r,i)}),n}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new Ie(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new Ie("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new Ie("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const n=this.emptyCopy(e),i=this._edges.values();let r,s;for(;r=i.next(),r.done!==!0;)s=r.value,_F(n,"copy",!1,s.undirected,s.key,s.source.key,s.target.key,sn({},s.attributes));return n}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((s,o)=>{e[o]=s.attributes});const n={},i={};this._edges.forEach((s,o)=>{const a=s.undirected?"--":"->";let l="",u=s.source.key,c=s.target.key,d;s.undirected&&u>c&&(d=u,u=c,c=d);const h=`(${u})${a}(${c})`;o.startsWith("geid_")?this.multi&&(typeof i[h]>"u"?i[h]=0:i[h]++,l+=`${i[h]}. `):l+=`[${o}]: `,l+=h,n[l]=s.attributes});const r={};for(const s in this)this.hasOwnProperty(s)&&!YT.has(s)&&typeof this[s]!="function"&&typeof s!="symbol"&&(r[s]=this[s]);return r.attributes=this._attributes,r.nodes=e,r.edges=n,nr(r,"constructor",this.constructor),r}}typeof Symbol<"u"&&(St.prototype[Symbol.for("nodejs.util.inspect.custom")]=St.prototype.inspect);hZ.forEach(t=>{["add","merge","update"].forEach(e=>{const n=t.name(e),i=e==="add"?_F:mZ;t.generateKey?St.prototype[n]=function(r,s,o){return i(this,n,!0,(t.type||this.type)==="undirected",null,r,s,o,e==="update")}:St.prototype[n]=function(r,s,o,a){return i(this,n,!1,(t.type||this.type)==="undirected",r,s,o,a,e==="update")}})});_J(St);DJ(St);JJ(St);sZ(St);class CF extends St{constructor(e){const n=sn({type:"directed"},e);if("multi"in n&&n.multi!==!1)throw new ge("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="directed")throw new ge('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class N_ extends St{constructor(e){const n=sn({type:"undirected"},e);if("multi"in n&&n.multi!==!1)throw new ge("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="undirected")throw new ge('UndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class EF extends St{constructor(e){const n=sn({multi:!0},e);if("multi"in n&&n.multi!==!0)throw new ge("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(n)}}class AF extends St{constructor(e){const n=sn({type:"directed",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new ge("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="directed")throw new ge('MultiDirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class PF extends St{constructor(e){const n=sn({type:"undirected",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new ge("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="undirected")throw new ge('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}function sd(t){t.from=function(e,n){const i=sn({},e.options,n),r=new t(i);return r.import(e),r}}sd(St);sd(CF);sd(N_);sd(EF);sd(AF);sd(PF);St.Graph=St;St.DirectedGraph=CF;St.UndirectedGraph=N_;St.MultiGraph=EF;St.MultiDirectedGraph=AF;St.MultiUndirectedGraph=PF;St.InvalidArgumentsGraphError=ge;St.NotFoundGraphError=ce;St.UsageGraphError=Ie;var gZ=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"},TF=Ky,vZ=TF.ARRAY_BUFFER_SUPPORT,yZ=TF.SYMBOL_SUPPORT,wZ=function(e,n){var i,r,s,o,a;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if(typeof n!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||vZ&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(s=0,o=e.length;s<o;s++)n(e[s],s);return}if(typeof e.forEach=="function"){e.forEach(n);return}if(yZ&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(i=e,s=0;a=i.next(),a.done!==!0;)n(a.value,s),s++;return}for(r in e)e.hasOwnProperty(r)&&n(e[r],r)},RF=Gy,bZ=wZ;function Zt(){this.clear()}Zt.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};Zt.prototype.enqueue=function(t){return this.items.push(t),++this.size};Zt.prototype.dequeue=function(){if(this.size){var t=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,t}};Zt.prototype.peek=function(){if(this.size)return this.items[this.offset]};Zt.prototype.forEach=function(t,e){e=arguments.length>1?e:this;for(var n=this.offset,i=0,r=this.items.length;n<r;n++,i++)t.call(e,this.items[n],i,this)};Zt.prototype.toArray=function(){return this.items.slice(this.offset)};Zt.prototype.values=function(){var t=this.items,e=this.offset;return new RF(function(){if(e>=t.length)return{done:!0};var n=t[e];return e++,{value:n,done:!1}})};Zt.prototype.entries=function(){var t=this.items,e=this.offset,n=0;return new RF(function(){if(e>=t.length)return{done:!0};var i=t[e];return e++,{value:[n++,i],done:!1}})};typeof Symbol<"u"&&(Zt.prototype[Symbol.iterator]=Zt.prototype.values);Zt.prototype.toString=function(){return this.toArray().join(",")};Zt.prototype.toJSON=function(){return this.toArray()};Zt.prototype.inspect=function(){var t=this.toArray();return Object.defineProperty(t,"constructor",{value:Zt,enumerable:!1}),t};typeof Symbol<"u"&&(Zt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Zt.prototype.inspect);Zt.from=function(t){var e=new Zt;return bZ(t,function(n){e.enqueue(n)}),e};Zt.of=function(){return Zt.from(arguments)};var xZ=function(e,n){var i=n.length;if(i!==0){var r=e.length;e.length+=i;for(var s=0;s<i;s++)e[r+s]=n[s]}},NF=gZ,SZ=xZ;function kZ(t,e,n){if(!NF(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');if(!t.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" target node does not exist in the given graph.');if(e=""+e,n=""+n,e===n)return[e];var i=t.inboundNeighbors.bind(t),r=t.outboundNeighbors.bind(t),s={},o={};s[e]=null,o[n]=null;var a=[e],l=[n],u,c,d,h,f,p,m,w,v=!1;e:for(;a.length&&l.length;)if(a.length<=l.length){for(u=a,a=[],f=0,m=u.length;f<m;f++)for(c=u[f],d=r(c),p=0,w=d.length;p<w;p++)if(h=d[p],h in s||(a.push(h),s[h]=c),h in o){v=!0;break e}}else for(u=l,l=[],f=0,m=u.length;f<m;f++)for(c=u[f],d=i(c),p=0,w=d.length;p<w;p++)if(h=d[p],h in o||(l.push(h),o[h]=c),h in s){v=!0;break e}if(!v)return null;for(var y=[];h;)y.unshift(h),h=s[h];for(h=o[y[y.length-1]];h;)y.push(h),h=o[h];return y.length?y:null}function MF(t,e,n){if(!NF(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!e.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" source node does not exist in the given graph.');n=""+n;var i=new Set,r={},s=0;r[n]=0;for(var o=[n],a,l,u;o.length!==0;){var c=[];for(a=0,l=o.length;a<l;a++)u=o[a],!i.has(u)&&(i.add(u),SZ(c,e[t](u)),r[u]=s);s++,o=c}return r}MF.bind(null,"outboundNeighbors");MF.bind(null,"neighbors");var _Z=kZ;const Ce=new N_({allowSelfLoops:!1});Ce.addNode("MBR",{position:[610,250]});Ce.addNode("AX",{position:[522,45]});Ce.addNode("BX",{position:[522,85]});Ce.addNode("CX",{position:[522,125]});Ce.addNode("DX",{position:[522,165]});Ce.addNode("id",{position:[522,205]});Ce.addNode("IP",{position:[451,309]});Ce.addNode("SP",{position:[451,349]});Ce.addNode("ri",{position:[451,388]});Ce.addNode("result",{position:[370,130]});Ce.addNode("FLAGS",{position:[250,225]});Ce.addNode("IR",{position:[205,272]});Ce.addNode("left",{position:[60,85]});Ce.addNode("right",{position:[60,145]});Ce.addNode("AX join",{position:[492,45]});Ce.addNode("BX join",{position:[492,85]});Ce.addNode("CX join",{position:[492,125]});Ce.addNode("DX join",{position:[492,165]});Ce.addNode("id join",{position:[492,205]});Ce.addNode("data mbr join",{position:[492,250]});Ce.addNode("IP join",{position:[421,309]});Ce.addNode("SP join",{position:[421,349]});Ce.addNode("ri join",{position:[421,388]});Ce.addNode("addresses mbr join",{position:[421,250]});Ce.addNode("result mbr join",{position:[370,250]});Ce.addNode("FLAGS mbr join",{position:[250,250]});Ce.addNode("IR mbr join",{position:[205,250]});Ce.addNode("left join",{position:[30,85]});Ce.addNode("right join",{position:[30,145]});Ce.addNode("operands mbr join",{position:[30,250]});Ce.addUndirectedEdge("AX","AX join");Ce.addUndirectedEdge("BX","BX join");Ce.addUndirectedEdge("CX","CX join");Ce.addUndirectedEdge("DX","DX join");Ce.addUndirectedEdge("id","id join");Ce.addUndirectedEdge("AX join","BX join");Ce.addUndirectedEdge("BX join","CX join");Ce.addUndirectedEdge("CX join","DX join");Ce.addUndirectedEdge("DX join","id join");Ce.addUndirectedEdge("id join","data mbr join");Ce.addUndirectedEdge("data mbr join","MBR");Ce.addUndirectedEdge("IP","IP join");Ce.addUndirectedEdge("SP","SP join");Ce.addUndirectedEdge("ri","ri join");Ce.addUndirectedEdge("IP join","SP join");Ce.addUndirectedEdge("SP join","ri join");Ce.addUndirectedEdge("IP join","addresses mbr join");Ce.addUndirectedEdge("addresses mbr join","data mbr join");Ce.addUndirectedEdge("result","result mbr join");Ce.addUndirectedEdge("result mbr join","addresses mbr join");Ce.addUndirectedEdge("FLAGS","FLAGS mbr join");Ce.addUndirectedEdge("FLAGS mbr join","result mbr join");Ce.addUndirectedEdge("IR","IR mbr join");Ce.addUndirectedEdge("IR mbr join","FLAGS mbr join");Ce.addUndirectedEdge("left","left join");Ce.addUndirectedEdge("right","right join");Ce.addUndirectedEdge("left join","right join");Ce.addUndirectedEdge("right join","operands mbr join");Ce.addUndirectedEdge("operands mbr join","IR mbr join");function CZ(t,e){const n=_Z(Ce,t,e);if(!n)throw new Error(`No path from ${t} to ${e}`);const i=Ce.getNodeAttribute(n[0],"position");let r=`M ${i[0]} ${i[1]}`;for(let s=1;s<n.length;s++){const[o,a]=Ce.getNodeAttribute(n[s],"position");r+=` L ${o} ${a}`}return r}function EZ(){const{path:t,...e}=ft("cpu.internalBus.data");return g.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[g.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:["M 60 85 H 30","V 250 H 610","M 60 145 H 30","M 370 130 V 250","M 250 225 V 250","M 33 85 H 220","M 32 145 H 220","M 272 115 h 28","M 250 145 v 46","M 205 250 V 272","M 205 300 V 320","M 451 388 H 421","V 250","M 451 349 H 421","M 451 309 H 421","M 522 45 H 492","V 250","M 522 85 H 492","M 522 125 H 492","M 522 165 H 492","M 522 205 H 492"].join(" ")}),g.jsx(Gt.path,{d:t,className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:e})]})}const Bw=(t,e)=>{const n=CZ(t,e);return tt([{key:"cpu.internalBus.data.path",from:n},{key:"cpu.internalBus.data.opacity",from:1},{key:"cpu.internalBus.data.strokeDashoffset",from:1,to:0}],{duration:5,easing:"easeInOutSine"})},$w=()=>tt({key:"cpu.internalBus.data.opacity",to:0},{duration:1,easing:"easeInSine"});let zw=!1;async function O1(t){switch(t.type){case"cpu:alu.execute":{const e={duration:3,easing:"easeInOutSine"};await tt([{key:"cpu.alu.operands.opacity",from:1},{key:"cpu.alu.operands.strokeDashoffset",from:1,to:0}],e),ee.set(Tj,t.operation),await Promise.all([tt({key:"cpu.alu.operation.backgroundColor",to:bt.mantis[400]},{duration:1,easing:"easeOutQuart"}),tt({key:"cpu.alu.cog.rot",to:6},{duration:10,easing:"easeInOutCubic"})]),await Promise.all([tt({key:"cpu.alu.operation.backgroundColor",to:bt.stone[800]},{duration:1,easing:"easeOutQuart"}),tt([{key:"cpu.alu.results.opacity",from:1},{key:"cpu.alu.results.strokeDashoffset",from:1,to:0}],e)]),await Promise.all([ar("cpu.result"),ar("cpu.FLAGS")]),ee.set(At.FLAGS,t.flags),ee.set(At.result,t.result),await Promise.all([lr("cpu.result"),lr("cpu.FLAGS")]),await tt([{key:"cpu.alu.operands.opacity",to:0},{key:"cpu.alu.results.opacity",to:0}],{duration:1,easing:"easeInSine"});return}case"cpu:cycle.end":return;case"cpu:cycle.interrupt":{ee.set(vs,e=>"metadata"in e?{...e,phase:"interrupt"}:e),await tt([{key:"cpu.id.opacity",to:1},{key:"cpu.ri.opacity",to:1}],{duration:.5,easing:"easeInOutQuad"});return}case"cpu:cycle.start":{Ej(t.instruction.position.start),ee.set(vs,{phase:"fetching",metadata:t.instruction}),await tt([{key:"cpu.id.opacity",to:t.instruction.willUse.id?1:.4},{key:"cpu.ri.opacity",to:t.instruction.willUse.ri?1:.4}],{duration:.5,easing:"easeInOutQuad"}),await O1({type:"cpu:mar.set",register:"IP"}),zw=!0;return}case"cpu:cycle.update":{ee.set(vs,e=>"metadata"in e?{...e,phase:t.phase==="execute"?"executing":t.phase==="writeback"?"writeback":t.next==="fetch-operands"?"fetching-operands":t.next==="execute"?"executing":t.next==="writeback"?"writeback":e.phase}:e);return}case"cpu:decode":{await tt([{key:"cpu.decoder.path.opacity",from:1},{key:"cpu.decoder.path.strokeDashoffset",from:1,to:0}],{duration:3,easing:"easeInOutSine"}),await tt([{key:"cpu.decoder.progress.opacity",from:1},{key:"cpu.decoder.progress.progress",from:0,to:1}],{duration:3,easing:"easeInOutSine"}),await tt([{key:"cpu.decoder.path.opacity",to:0},{key:"cpu.decoder.progress.opacity",to:0}],{duration:1,easing:"easeInSine"});return}case"cpu:error":{ee.set(vs,{phase:"stopped",error:t.error}),Vc(t.error);return}case"cpu:halt":case"cpu:int.0":{ee.set(vs,{phase:"stopped"}),Vc();return}case"cpu:int.3":{Zd();return}case"cpu:int.6":{ee.set(vs,{phase:"int6"});return}case"cpu:int.7":{ee.set(vs,{phase:"int7"});return}case"cpu:inta.off":{await ti("bus.inta");return}case"cpu:inta.on":{await _r("bus.inta",10);return}case"cpu:rd.on":case"cpu:wr.on":{const e=t.type.slice(4,6);await tt({key:"bus.address.stroke",to:bt.blue[500]},{duration:5,easing:"easeInOutSine"}),await tt({key:`bus.${e}.stroke`,to:bt.red[500]},{duration:5,easing:"easeOutSine"});return}case"cpu:iom.on":{await _r("bus.iom",15);return}case"cpu:mar.set":{if(zw){zw=!1,await O1({type:"cpu:rd.on"});return}await tt([{key:"cpu.internalBus.address.path",from:KY(t.register)},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:5,easing:"easeInOutSine"}),await ar("cpu.MAR",bt.blue[500]),ee.set(Pj,ee.get(At[t.register])),await Promise.all([lr("cpu.MAR"),tt({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]);return}case"cpu:mbr.get":{const[e]=_l(t.register);await Bw("MBR",e),await ar(`cpu.${e}`),ee.set(At[t.register],ee.get(Cv)),await Promise.all([lr(`cpu.${e}`),$w()]);return}case"cpu:mbr.set":{const[e]=_l(t.register);await Bw(e,"MBR"),await ar("cpu.MBR"),ee.set(Cv,ee.get(At[t.register])),await tt({key:"bus.data.stroke",to:bt.mantis[400]},{duration:5,easing:"easeOutSine"}),await Promise.all([lr("cpu.MBR"),$w()]);return}case"cpu:register.copy":{const[e]=_l(t.src),[n]=_l(t.dest);e!==n&&await Bw(e,n),await ar(`cpu.${n}`),ee.set(At[t.dest],ee.get(At[t.src])),await Promise.all([lr(`cpu.${n}`),e!==n&&$w()]);return}case"cpu:register.update":{const[e]=_l(t.register);await ar(`cpu.${e}`),ee.set(At[t.register],t.value),await lr(`cpu.${e}`);return}default:return t}}async function AZ(t){switch(t.type){case"f10:press":await _r("bus.int0",2),await ti("bus.int0");return;default:return t.type}}const M_=Ae(L.zero(8)),O_=Ae(L.zero(8));function PZ(t){"handshake"in t.io&&(ee.set(M_,L.fromUnsigned(t.io.handshake.DATA,8)),ee.set(O_,L.fromUnsigned(t.io.handshake.STATE,8)))}async function TZ(t){switch(t.type){case"handshake:read":return;case"handshake:read.ok":{await zc(t.value);return}case"handshake:write":case"handshake:register.update":{switch(await ar(`handshake.${t.register}`),t.register){case"DATA":{ee.set(M_,t.value);break}case"STATE":{ee.set(O_,t.value);break}default:return t.register}await lr(`handshake.${t.register}`);return}case"handshake:write.ok":return;case"handshake:int.off":{await ti("bus.int2");return}case"handshake:int.on":{await _r("bus.int2",10);return}default:return t}}async function RZ(t){switch(t.type){case"keyboard:listen-key":{ee.set(Nn,e=>e.type!=="running"||e.waitingForInput?e:{...e,waitingForInput:!0}),await new Promise(e=>{ee.sub(Nn,()=>{const n=ee.get(Nn);(n.type!=="running"||!n.waitingForInput)&&e()})});return}case"keyboard:read":return;default:return t}}const I_=Ae(L.zero(8));function NZ(t){"leds"in t.io&&ee.set(I_,L.fromUnsigned(t.io.leds,8))}async function MZ(t){switch(t.type){case"leds:update":{await _r("bus.pio->leds",2),ee.set(I_,t.state),await ti("bus.pio->leds");return}default:return t.type}}const D_=Ae(new Array(ye.MAX_ADDRESS+1).fill(L.zero(8))),Uc=Ae(ye.from(32)),OF=Ae(null),gm=16,OZ=Ae(t=>{const e=t(OF)??t(Uc);let n=e.value-e.value%gm,i=n+gm-1;i>ye.MAX_ADDRESS&&(i=ye.MAX_ADDRESS,n=i-gm+1);const r=t(D_),s=[];for(let o=0;o<gm;o++)s.push({address:ye.from(n+o),value:r[n+o]});return s});function IZ(t){ee.set(D_,t.memory.map(e=>L.fromUnsigned(e,8))),ee.set(Uc,ye.from(32))}async function DZ(t){switch(t.type){case"memory:read":return;case"memory:read.ok":{ee.set(Uc,ye.from(t.address)),await tt({key:"memory.operating-cell.color",to:bt.mantis[400]},{duration:1,easing:"easeOutQuart"}),await zc(t.value),await tt({key:"memory.operating-cell.color",to:bt.white},{duration:1,easing:"easeOutQuart"});return}case"memory:write":return;case"memory:write.ok":{ee.set(Uc,ye.from(t.address)),await tt({key:"memory.operating-cell.color",to:bt.mantis[400]},{duration:1,easing:"easeOutQuart"}),ee.set(D_,e=>[...e.slice(0,t.address.value),t.value,...e.slice(t.address.value+1)]),await tt({key:"memory.operating-cell.color",to:bt.white},{duration:1,easing:"easeOutQuart"});return}case"memory:read.error":case"memory:write.error":{Vc(t.error);return}default:return t}}const L_=Ae(L.fromUnsigned(255,8)),j_=Ae(L.fromUnsigned(0,8)),F_=Ae(L.fromUnsigned(0,8)),Nv=[Ae(L.zero(8)),Ae(L.zero(8)),Ae(L.zero(8)),Ae(L.zero(8)),Ae(L.zero(8)),Ae(L.zero(8)),Ae(L.zero(8)),Ae(L.zero(8))];function LZ(t){if("pic"in t.io){ee.set(L_,L.fromUnsigned(t.io.pic.IMR,8)),ee.set(j_,L.fromUnsigned(t.io.pic.IRR,8)),ee.set(F_,L.fromUnsigned(t.io.pic.ISR,8));for(let e=0;e<Nv.length;e++)ee.set(Nv[e],L.fromUnsigned(t.io.pic.lines[e],8))}}async function jZ(t){switch(t.type){case"pic:read":return;case"pic:read.ok":{await zc(t.value);return}case"pic:write":return;case"pic:register.update":{switch(await ar(`pic.${t.register}`),t.register){case"IMR":{ee.set(L_,t.value);break}case"IRR":{ee.set(j_,t.value);break}case"ISR":{ee.set(F_,t.value);break}case"INT0":case"INT1":case"INT2":case"INT3":case"INT4":case"INT5":case"INT6":case"INT7":{const e=Number(t.register.slice(3));ee.set(Nv[e],t.value);break}default:return t}await lr(`pic.${t.register}`);return}case"pic:write.ok":return;case"pic:intr.off":{await ti("bus.intr");return}case"pic:intr.on":{await _r("bus.intr",10);return}case"pic:int.send":{await zc(t.number);return}default:return t}}const B_=Ae(L.zero(8)),$_=Ae(L.zero(8)),z_=Ae(L.zero(8)),U_=Ae(L.zero(8));function FZ(t){"pio"in t.io&&(ee.set(B_,L.fromUnsigned(t.io.pio.PA,8)),ee.set($_,L.fromUnsigned(t.io.pio.PB,8)),ee.set(z_,L.fromUnsigned(t.io.pio.CA,8)),ee.set(U_,L.fromUnsigned(t.io.pio.CB,8)))}async function BZ(t){switch(t.type){case"pio:read":return;case"pio:read.ok":{await zc(t.value);return}case"pio:write":return;case"pio:register.update":{switch(await ar(`pio.${t.register}`),t.register){case"PA":{ee.set(B_,t.value);break}case"PB":{ee.set($_,t.value);break}case"CA":{ee.set(z_,t.value);break}case"CB":{ee.set(U_,t.value);break}default:return t.register}await lr(`pio.${t.register}`);return}case"pio:write.ok":return;default:return t}}const Mv=Ae([]),Ov=Ae("");function $Z(t){"printer"in t.io&&(ee.set(Mv,t.io.printer.buffer.map(e=>L.fromUnsigned(e,8))),ee.set(Ov,t.io.printer.paper))}async function zZ(t){switch(t.type){case"printer:buffer.add":{ee.set(Mv,e=>[...e,t.char]);return}case"printer:buffer.pop":{ee.set(Mv,e=>e.slice(1));return}case"printer:busy.off":{await ti("bus.printer.busy");return}case"printer:busy.on":{await _r("bus.printer.busy",15);return}case"printer:data.read":{await _r("bus.printer.data",15),await ti("bus.printer.data");return}case"printer:paper.print":{ee.set(Ov,e=>e+t.char);return}case"printer:paper.replace":{ee.set(Ov,"");return}case"printer:strobe.off":{await ti("bus.printer.strobe");return}case"printer:strobe.on":{await _r("bus.printer.strobe",15);return}default:return t}}const V_=Ae("");function UZ(t){"screen"in t.io&&ee.set(V_,t.io.screen)}async function VZ(t){switch(t.type){case"screen:send-char":{ee.set(V_,t.output);return}default:return t.type}}const H_=Ae(L.zero(8));function HZ(t){"switches"in t.io&&ee.set(H_,L.fromUnsigned(t.io.switches,8))}async function WZ(t){switch(t.type){case"switches:toggle":{ee.set(H_,e=>e.withBit(t.index,!e.bit(t.index))),await _r("bus.switches->pio",2),await ti("bus.switches->pio");return}default:return t.type}}const W_=Ae(L.zero(8)),G_=Ae(L.zero(8));function GZ(t){"timer"in t.io&&(ee.set(W_,L.fromUnsigned(t.io.timer.CONT,8)),ee.set(G_,L.fromUnsigned(t.io.timer.COMP,8)))}async function KZ(t){switch(t.type){case"timer:read":return;case"timer:read.ok":{await zc(t.value);return}case"timer:write":return;case"timer:register.update":{switch(await ar(`timer.${t.register}`),t.register){case"CONT":{ee.set(W_,t.value);break}case"COMP":{ee.set(G_,t.value);break}default:return t.register}await lr(`timer.${t.register}`);return}case"timer:write.ok":return;case"timer:int.off":{await ti("bus.int1");return}case"timer:int.on":{await _r("bus.int1",10);return}default:return t}}const I1=new Set;async function XZ(t){YZ(t);const[e]=t.type.split(":",2);switch(I1.add(t.type),e){case"bus":{await WY(t);break}case"clock":{await GY(t);break}case"cpu":{await O1(t);break}case"f10":{await AZ(t);break}case"handshake":{await TZ(t);break}case"keyboard":{await RZ(t);break}case"leds":{await MZ(t);break}case"memory":{await DZ(t);break}case"pic":{await jZ(t);break}case"pio":{await BZ(t);break}case"printer":{await zZ(t);break}case"screen":{await VZ(t);break}case"switches":{await WZ(t);break}case"timer":{await KZ(t);break}default:return e}I1.delete(t.type)}function ZT(...t){for(const e of t)if(I1.has(e))return!0;return!1}const qZ={bus:"#2563eb",clock:"#65a30d",cpu:"#dc2626",f10:"#65a30d",handshake:"#2563eb",keyboard:"#65a30d",leds:"#65a30d",memory:"#f59e0b",pic:"#2563eb",pio:"#2563eb",printer:"#65a30d",screen:"#65a30d",switches:"#65a30d",timer:"#2563eb"};function YZ(t){const[e,n]=t.type.split(":",2);console.group(`%c ${e} %c ${n}`,`background: ${qZ[e]}; color: #fff; font-weight: bold;`,"background: unset; color: unset; font-weight: normal;");for(const i in t)if(i!=="type"&&Object.prototype.hasOwnProperty.call(t,i)){const r=t[i];r instanceof L?console.log(`${i}: %c${r.toString("hex")}h %c(Byte)`,"color: #8b5cf6;","color: #737373;"):r instanceof ye?console.log(`${i}: %c${r.toString()} %c(MemoryAddress)`,"color: #8b5cf6;","color: #737373;"):r instanceof Yi?console.log(`${i}: %c${r.toString()} %c(IOAddress)`,"color: #8b5cf6;","color: #737373;"):typeof r=="number"?console.log(`${i}: %c${r.toString(16)}h %c(number)`,"color: #8b5cf6;","color: #737373;"):typeof r=="string"?console.log(`${i}: %c"${r}" %c(string)`,"color: #f97316;","color: #737373;"):typeof r=="boolean"?console.log(`${i}: %c${r}`,"color: #06b6d4;"):r===null?console.log(`${i}: %cnull`,"color: #b91c1c;"):console.log(`${i}:`,r)}console.groupEnd()}const Fn=new yq,Nn=Ae({type:"stopped"});function JZ(t){const e=t.translate(Si().language);xn({title:e,variant:"error"})}function Vc(t){t&&JZ(t),Ej(null),Cj(!1),ee.set(Nn,{type:"stopped",error:t}),ee.set(vs,{phase:"stopped",error:t}),rF()}function Zd(){ee.set(Nn,{type:"paused"}),VY()}function ZZ(){xn({title:Ry(Si().language,"messages.assemble-error"),variant:"error"})}function bu(){xn({title:Ry(Si().language,"messages.invalid-action"),variant:"error"})}function QZ(t){Sq(t),IZ(t),PZ(t),LZ(t),FZ(t),GZ(t),NZ(t),$Z(t),UZ(t),HZ(t)}async function El(t){try{for(;;){const e=ee.get(Nn),n=Si();if(e.type==="stopped")break;if(e.type==="paused"){await new Promise(r=>{const s=ee.sub(Nn,()=>{s(),r()})});continue}const i=t.next();if(i.done)break;await XZ(i.value),e.until==="cycle-change"&&(i.value.type==="cpu:cycle.start"?(xn({title:"Etapa de captación (fetch):",description:"Paso 1: MAR ← IP",variant:"info"}),Zd()):i.value.type==="cpu:register.update"?(xn({title:"Etapa de captación (fetch):",description:"Paso 2: MDR ← read(Memoria[MAR]); IP ← IP + 1",variant:"info"}),Zd()):i.value.type==="cpu:mbr.get"&&(xn({title:"Etapa de captación (fetch):",description:"Paso 3: IR ← MBR",variant:"info"}),Zd())),i.value.type==="cpu:cycle.update"||i.value.type==="cpu:cycle.interrupt"?e.until==="cycle-change"||n.animations||await new Promise(r=>setTimeout(r,n.executionUnit)):i.value.type==="cpu:cycle.end"&&(e.until==="cycle-change"||e.until==="end-of-instruction"?Zd():n.animations||await new Promise(r=>setTimeout(r,n.executionUnit)))}t.return()}catch(e){const n=Ze.from(e);Vc(n)}}async function eQ(...t){const e=t[0],n=ee.get(Nn);switch(e){case"cpu.run":{if(n.type==="running")return bu();const i=t[1];if(n.type==="stopped"){if(!window.codemirror)return;const r=window.codemirror.state.doc.toString(),s=yj(r);if(!s.success)return ZZ();Cj(!0),Fn.loadProgram({program:s,data:Si().dataOnLoad,devices:Si().devices}),QZ(Fn.getComputerState());const o=["Start CPU",{until:i,devices:Si().devices,language:Si().language,animations:Si().animations?"yes":"no"}];Aj.capture(...o),ee.set(Nn,{type:"running",until:i,waitingForInput:!1}),El(Fn.startCPU()),tQ(),nQ()}else ee.set(Nn,{type:"running",until:i,waitingForInput:!1}),HY();return}case"cpu.stop":{Vc();return}case"f10.press":{if(!Fn.devices.f10.connected()||n.type!=="running")return bu();if(ZT("f10:press"))return;El(Fn.devices.f10.press());return}case"switch.toggle":{if(n.type!=="running"||!Fn.devices.switches.connected())return bu();if(ZT("switches:toggle"))return;const i=t[1];El(Fn.devices.switches.toggle(i));return}case"keyboard.sendChar":{if(n.type!=="running"||!n.waitingForInput)return bu();Fn.devices.keyboard.readChar(L.fromChar(t[1])),ee.set(Nn,{...n,waitingForInput:!1});return}case"screen.clean":{if(!Fn.devices.screen.connected())return bu();El(Fn.devices.screen.clear());return}case"printer.clean":{if(!Fn.devices.printer.connected())return bu();El(Fn.devices.printer.clear());return}default:return e}}async function tQ(){if(Fn.devices.clock.connected())for(;ee.get(Nn).type!=="stopped";){const t=Si().clockSpeed;await tt({key:"clock.angle",from:0,to:360},{duration:t,forceMs:!0,easing:"linear"}),El(Fn.devices.clock.tick())}}async function nQ(){if(Fn.devices.printer.connected())for(;ee.get(Nn).type!=="stopped";){const t=Si().printerSpeed;await tt([{key:"printer.printing.opacity",from:1},{key:"printer.printing.progress",from:0,to:1}],{duration:t,forceMs:!0,easing:"easeInOutSine"}),await tt({key:"printer.printing.opacity",to:0},{duration:1,easing:"easeInSine"}),El(Fn.devices.printer.print())}}function mn(){const t=Xt(Nn),e=LK(),n=S.useMemo(()=>({preset:e,hasIOBus:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",clock:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",f10:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",keyboard:e==="keyboard-and-screen"||e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",handshake:e==="handshake",leds:e==="pio-switches-and-leds",pic:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",pio:e==="pio-switches-and-leds"||e==="pio-printer",printer:e==="pio-printer"||e==="handshake",screen:e==="keyboard-and-screen"||e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",switches:e==="pio-switches-and-leds",timer:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake"}),[e]);return{status:t,dispatch:eQ,devices:n}}function iQ({className:t}){const e=mt(),{status:n,dispatch:i}=mn(),r=S.useCallback(()=>{n.type!=="running"&&i("cpu.run","cycle-change")},[n.type,i]);xo("F7",a=>{a.preventDefault(),r()},void 0,[r]);const s=S.useCallback(()=>{n.type!=="running"&&i("cpu.run","end-of-instruction")},[n.type,i]);xo("F8",a=>{a.preventDefault(),s()},void 0,[s]);const o=S.useCallback(()=>{n.type!=="running"&&i("cpu.run","infinity")},[n.type,i]);return xo("F4",a=>{a.preventDefault(),o()},void 0,[o]),g.jsxs("div",{className:ze("flex items-center justify-center gap-4",t),children:[g.jsxs(YL,{children:[g.jsx(JL,{asChild:!0,children:g.jsx("button",{disabled:n.type==="running",className:"inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-mantis-500 px-3 text-sm text-white ring-offset-stone-900 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mantis-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",children:n.type==="stopped"?g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"icon-[lucide--play] mr-2 h-4 w-4"}),e("control.action.start")]}):n.type==="paused"?g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"icon-[lucide--play] mr-2 h-4 w-4"}),e("control.action.continue")]}):g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"icon-[lucide--refresh-cw] mr-2 h-4 w-4 animate-spin"}),e("control.action.running")]})})}),g.jsxs(t_,{className:"w-56",align:"start",children:[g.jsxs(Fl,{disabled:n.type==="running",onClick:r,children:[g.jsx("span",{className:"icon-[lucide--chevron-right] mr-2 h-4 w-4"}),e("control.action.run.cycle-change"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"F7"})]}),g.jsxs(Fl,{disabled:n.type==="running",onClick:s,children:[g.jsx("span",{className:"icon-[lucide--chevrons-right] mr-2 h-4 w-4"}),e("control.action.run.end-of-instruction"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"F8"})]}),g.jsxs(Fl,{disabled:n.type==="running",onClick:o,children:[g.jsx("span",{className:"icon-[lucide--infinity] mr-2 h-4 w-4"}),e("control.action.run.infinity"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"F4"})]})]})]}),g.jsxs("button",{disabled:n.type==="stopped",onClick:()=>i("cpu.stop"),className:"inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-mantis-500 px-3 text-sm text-white ring-offset-stone-900 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mantis-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",children:[g.jsx("span",{className:"icon-[lucide--stop-circle] mr-2 h-4 w-4"}),e("control.action.stop")]})]})}function Iv(t,[e,n]){return Math.min(n,Math.max(e,t))}function K_(t){const e=S.useRef({value:t,previous:t});return S.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var rQ="VisuallyHidden",qy=S.forwardRef((t,e)=>g.jsx(Fe.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));qy.displayName=rQ;var sQ=[" ","Enter","ArrowUp","ArrowDown"],oQ=[" ","Enter"],lp="Select",[Yy,Jy,aQ]=Wf(lp),[od,voe]=ls(lp,[aQ,id]),Zy=id(),[lQ,rl]=od(lp),[uQ,cQ]=od(lp),IF=t=>{const{__scopeSelect:e,children:n,open:i,defaultOpen:r,onOpenChange:s,value:o,defaultValue:a,onValueChange:l,dir:u,name:c,autoComplete:d,disabled:h,required:f}=t,p=Zy(e),[m,w]=S.useState(null),[v,y]=S.useState(null),[b,k]=S.useState(!1),_=Gf(u),[E=!1,A]=Po({prop:i,defaultProp:r,onChange:s}),[P,I]=Po({prop:o,defaultProp:a,onChange:l}),D=S.useRef(null),B=m?!!m.closest("form"):!0,[$,J]=S.useState(new Set),z=Array.from($).map(G=>G.props.value).join(";");return g.jsx(Vk,{...p,children:g.jsxs(lQ,{required:f,scope:e,trigger:m,onTriggerChange:w,valueNode:v,onValueNodeChange:y,valueNodeHasChildren:b,onValueNodeHasChildrenChange:k,contentId:ja(),value:P,onValueChange:I,open:E,onOpenChange:A,dir:_,triggerPointerDownPosRef:D,disabled:h,children:[g.jsx(Yy.Provider,{scope:e,children:g.jsx(uQ,{scope:t.__scopeSelect,onNativeOptionAdd:S.useCallback(G=>{J(Q=>new Set(Q).add(G))},[]),onNativeOptionRemove:S.useCallback(G=>{J(Q=>{const ie=new Set(Q);return ie.delete(G),ie})},[]),children:n})}),B?g.jsxs(eB,{"aria-hidden":!0,required:f,tabIndex:-1,name:c,autoComplete:d,value:P,onChange:G=>I(G.target.value),disabled:h,children:[P===void 0?g.jsx("option",{value:""}):null,Array.from($)]},z):null]})})};IF.displayName=lp;var DF="SelectTrigger",LF=S.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:i=!1,...r}=t,s=Zy(n),o=rl(DF,n),a=o.disabled||i,l=rt(e,o.onTriggerChange),u=Jy(n),[c,d,h]=tB(p=>{const m=u().filter(y=>!y.disabled),w=m.find(y=>y.value===o.value),v=nB(m,p,w);v!==void 0&&o.onValueChange(v.value)}),f=()=>{a||(o.onOpenChange(!0),h())};return g.jsx(_y,{asChild:!0,...s,children:g.jsx(Fe.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":QF(o.value)?"":void 0,...r,ref:l,onClick:fe(r.onClick,p=>{p.currentTarget.focus()}),onPointerDown:fe(r.onPointerDown,p=>{const m=p.target;m.hasPointerCapture(p.pointerId)&&m.releasePointerCapture(p.pointerId),p.button===0&&p.ctrlKey===!1&&(f(),o.triggerPointerDownPosRef.current={x:Math.round(p.pageX),y:Math.round(p.pageY)},p.preventDefault())}),onKeyDown:fe(r.onKeyDown,p=>{const m=c.current!=="";!(p.ctrlKey||p.altKey||p.metaKey)&&p.key.length===1&&d(p.key),!(m&&p.key===" ")&&sQ.includes(p.key)&&(f(),p.preventDefault())})})})});LF.displayName=DF;var jF="SelectValue",FF=S.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,children:s,placeholder:o="",...a}=t,l=rl(jF,n),{onValueNodeHasChildrenChange:u}=l,c=s!==void 0,d=rt(e,l.onValueNodeChange);return Hn(()=>{u(c)},[u,c]),g.jsx(Fe.span,{...a,ref:d,style:{pointerEvents:"none"},children:QF(l.value)?g.jsx(g.Fragment,{children:o}):s})});FF.displayName=jF;var dQ="SelectIcon",BF=S.forwardRef((t,e)=>{const{__scopeSelect:n,children:i,...r}=t;return g.jsx(Fe.span,{"aria-hidden":!0,...r,ref:e,children:i||"▼"})});BF.displayName=dQ;var hQ="SelectPortal",$F=t=>g.jsx(tp,{asChild:!0,...t});$F.displayName=hQ;var iu="SelectContent",zF=S.forwardRef((t,e)=>{const n=rl(iu,t.__scopeSelect),[i,r]=S.useState();if(Hn(()=>{r(new DocumentFragment)},[]),!n.open){const s=i;return s?Lo.createPortal(g.jsx(UF,{scope:t.__scopeSelect,children:g.jsx(Yy.Slot,{scope:t.__scopeSelect,children:g.jsx("div",{children:t.children})})}),s):null}return g.jsx(VF,{...t,ref:e})});zF.displayName=iu;var Qs=10,[UF,sl]=od(iu),fQ="SelectContentImpl",VF=S.forwardRef((t,e)=>{const{__scopeSelect:n,position:i="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:s,onPointerDownOutside:o,side:a,sideOffset:l,align:u,alignOffset:c,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:m,avoidCollisions:w,...v}=t,y=rl(iu,n),[b,k]=S.useState(null),[_,E]=S.useState(null),A=rt(e,x=>k(x)),[P,I]=S.useState(null),[D,B]=S.useState(null),$=Jy(n),[J,z]=S.useState(!1),G=S.useRef(!1);S.useEffect(()=>{if(b)return Gk(b)},[b]),Ok();const Q=S.useCallback(x=>{const[T,...N]=$().map(U=>U.ref.current),[R]=N.slice(-1),W=document.activeElement;for(const U of x)if(U===W||(U==null||U.scrollIntoView({block:"nearest"}),U===T&&_&&(_.scrollTop=0),U===R&&_&&(_.scrollTop=_.scrollHeight),U==null||U.focus(),document.activeElement!==W))return},[$,_]),ie=S.useCallback(()=>Q([P,b]),[Q,P,b]);S.useEffect(()=>{J&&ie()},[J,ie]);const{onOpenChange:H,triggerPointerDownPosRef:j}=y;S.useEffect(()=>{if(b){let x={x:0,y:0};const T=R=>{var W,U;x={x:Math.abs(Math.round(R.pageX)-(((W=j.current)==null?void 0:W.x)??0)),y:Math.abs(Math.round(R.pageY)-(((U=j.current)==null?void 0:U.y)??0))}},N=R=>{x.x<=10&&x.y<=10?R.preventDefault():b.contains(R.target)||H(!1),document.removeEventListener("pointermove",T),j.current=null};return j.current!==null&&(document.addEventListener("pointermove",T),document.addEventListener("pointerup",N,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",T),document.removeEventListener("pointerup",N,{capture:!0})}}},[b,H,j]),S.useEffect(()=>{const x=()=>H(!1);return window.addEventListener("blur",x),window.addEventListener("resize",x),()=>{window.removeEventListener("blur",x),window.removeEventListener("resize",x)}},[H]);const[te,pe]=tB(x=>{const T=$().filter(W=>!W.disabled),N=T.find(W=>W.ref.current===document.activeElement),R=nB(T,x,N);R&&setTimeout(()=>R.ref.current.focus())}),q=S.useCallback((x,T,N)=>{const R=!G.current&&!N;(y.value!==void 0&&y.value===T||R)&&(I(x),R&&(G.current=!0))},[y.value]),ue=S.useCallback(()=>b==null?void 0:b.focus(),[b]),O=S.useCallback((x,T,N)=>{const R=!G.current&&!N;(y.value!==void 0&&y.value===T||R)&&B(x)},[y.value]),M=i==="popper"?D1:HF,F=M===D1?{side:a,sideOffset:l,align:u,alignOffset:c,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:m,avoidCollisions:w}:{};return g.jsx(UF,{scope:n,content:b,viewport:_,onViewportChange:E,itemRefCallback:q,selectedItem:P,onItemLeave:ue,itemTextRefCallback:O,focusSelectedItem:ie,selectedItemText:D,position:i,isPositioned:J,searchRef:te,children:g.jsx(Ey,{as:Kl,allowPinchZoom:!0,children:g.jsx(xy,{asChild:!0,trapped:y.open,onMountAutoFocus:x=>{x.preventDefault()},onUnmountAutoFocus:fe(r,x=>{var T;(T=y.trigger)==null||T.focus({preventScroll:!0}),x.preventDefault()}),children:g.jsx(Qf,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:x=>x.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:g.jsx(M,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:x=>x.preventDefault(),...v,...F,onPlaced:()=>z(!0),ref:A,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:fe(v.onKeyDown,x=>{const T=x.ctrlKey||x.altKey||x.metaKey;if(x.key==="Tab"&&x.preventDefault(),!T&&x.key.length===1&&pe(x.key),["ArrowUp","ArrowDown","Home","End"].includes(x.key)){let R=$().filter(W=>!W.disabled).map(W=>W.ref.current);if(["ArrowUp","End"].includes(x.key)&&(R=R.slice().reverse()),["ArrowUp","ArrowDown"].includes(x.key)){const W=x.target,U=R.indexOf(W);R=R.slice(U+1)}setTimeout(()=>Q(R)),x.preventDefault()}})})})})})})});VF.displayName=fQ;var pQ="SelectItemAlignedPosition",HF=S.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:i,...r}=t,s=rl(iu,n),o=sl(iu,n),[a,l]=S.useState(null),[u,c]=S.useState(null),d=rt(e,A=>c(A)),h=Jy(n),f=S.useRef(!1),p=S.useRef(!0),{viewport:m,selectedItem:w,selectedItemText:v,focusSelectedItem:y}=o,b=S.useCallback(()=>{if(s.trigger&&s.valueNode&&a&&u&&m&&w&&v){const A=s.trigger.getBoundingClientRect(),P=u.getBoundingClientRect(),I=s.valueNode.getBoundingClientRect(),D=v.getBoundingClientRect();if(s.dir!=="rtl"){const W=D.left-P.left,U=I.left-W,Z=A.left-U,K=A.width+Z,Se=Math.max(K,P.width),Oe=window.innerWidth-Qs,De=Iv(U,[Qs,Oe-Se]);a.style.minWidth=K+"px",a.style.left=De+"px"}else{const W=P.right-D.right,U=window.innerWidth-I.right-W,Z=window.innerWidth-A.right-U,K=A.width+Z,Se=Math.max(K,P.width),Oe=window.innerWidth-Qs,De=Iv(U,[Qs,Oe-Se]);a.style.minWidth=K+"px",a.style.right=De+"px"}const B=h(),$=window.innerHeight-Qs*2,J=m.scrollHeight,z=window.getComputedStyle(u),G=parseInt(z.borderTopWidth,10),Q=parseInt(z.paddingTop,10),ie=parseInt(z.borderBottomWidth,10),H=parseInt(z.paddingBottom,10),j=G+Q+J+H+ie,te=Math.min(w.offsetHeight*5,j),pe=window.getComputedStyle(m),q=parseInt(pe.paddingTop,10),ue=parseInt(pe.paddingBottom,10),O=A.top+A.height/2-Qs,M=$-O,F=w.offsetHeight/2,x=w.offsetTop+F,T=G+Q+x,N=j-T;if(T<=O){const W=w===B[B.length-1].ref.current;a.style.bottom="0px";const U=u.clientHeight-m.offsetTop-m.offsetHeight,Z=Math.max(M,F+(W?ue:0)+U+ie),K=T+Z;a.style.height=K+"px"}else{const W=w===B[0].ref.current;a.style.top="0px";const Z=Math.max(O,G+m.offsetTop+(W?q:0)+F)+N;a.style.height=Z+"px",m.scrollTop=T-O+m.offsetTop}a.style.margin=`${Qs}px 0`,a.style.minHeight=te+"px",a.style.maxHeight=$+"px",i==null||i(),requestAnimationFrame(()=>f.current=!0)}},[h,s.trigger,s.valueNode,a,u,m,w,v,s.dir,i]);Hn(()=>b(),[b]);const[k,_]=S.useState();Hn(()=>{u&&_(window.getComputedStyle(u).zIndex)},[u]);const E=S.useCallback(A=>{A&&p.current===!0&&(b(),y==null||y(),p.current=!1)},[b,y]);return g.jsx(gQ,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:f,onScrollButtonChange:E,children:g.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:k},children:g.jsx(Fe.div,{...r,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});HF.displayName=pQ;var mQ="SelectPopperPosition",D1=S.forwardRef((t,e)=>{const{__scopeSelect:n,align:i="start",collisionPadding:r=Qs,...s}=t,o=Zy(n);return g.jsx(Hk,{...o,...s,ref:e,align:i,collisionPadding:r,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});D1.displayName=mQ;var[gQ,X_]=od(iu,{}),L1="SelectViewport",WF=S.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:i,...r}=t,s=sl(L1,n),o=X_(L1,n),a=rt(e,s.onViewportChange),l=S.useRef(0);return g.jsxs(g.Fragment,{children:[g.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),g.jsx(Yy.Slot,{scope:n,children:g.jsx(Fe.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:a,style:{position:"relative",flex:1,overflow:"auto",...r.style},onScroll:fe(r.onScroll,u=>{const c=u.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=o;if(h!=null&&h.current&&d){const f=Math.abs(l.current-c.scrollTop);if(f>0){const p=window.innerHeight-Qs*2,m=parseFloat(d.style.minHeight),w=parseFloat(d.style.height),v=Math.max(m,w);if(v<p){const y=v+f,b=Math.min(p,y),k=y-b;d.style.height=b+"px",d.style.bottom==="0px"&&(c.scrollTop=k>0?k:0,d.style.justifyContent="flex-end")}}}l.current=c.scrollTop})})})]})});WF.displayName=L1;var GF="SelectGroup",[vQ,yQ]=od(GF),wQ=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=ja();return g.jsx(vQ,{scope:n,id:r,children:g.jsx(Fe.div,{role:"group","aria-labelledby":r,...i,ref:e})})});wQ.displayName=GF;var KF="SelectLabel",bQ=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=yQ(KF,n);return g.jsx(Fe.div,{id:r.id,...i,ref:e})});bQ.displayName=KF;var Dv="SelectItem",[xQ,XF]=od(Dv),qF=S.forwardRef((t,e)=>{const{__scopeSelect:n,value:i,disabled:r=!1,textValue:s,...o}=t,a=rl(Dv,n),l=sl(Dv,n),u=a.value===i,[c,d]=S.useState(s??""),[h,f]=S.useState(!1),p=rt(e,v=>{var y;return(y=l.itemRefCallback)==null?void 0:y.call(l,v,i,r)}),m=ja(),w=()=>{r||(a.onValueChange(i),a.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return g.jsx(xQ,{scope:n,value:i,disabled:r,textId:m,isSelected:u,onItemTextChange:S.useCallback(v=>{d(y=>y||((v==null?void 0:v.textContent)??"").trim())},[]),children:g.jsx(Yy.ItemSlot,{scope:n,value:i,disabled:r,textValue:c,children:g.jsx(Fe.div,{role:"option","aria-labelledby":m,"data-highlighted":h?"":void 0,"aria-selected":u&&h,"data-state":u?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...o,ref:p,onFocus:fe(o.onFocus,()=>f(!0)),onBlur:fe(o.onBlur,()=>f(!1)),onPointerUp:fe(o.onPointerUp,w),onPointerMove:fe(o.onPointerMove,v=>{var y;r?(y=l.onItemLeave)==null||y.call(l):v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:fe(o.onPointerLeave,v=>{var y;v.currentTarget===document.activeElement&&((y=l.onItemLeave)==null||y.call(l))}),onKeyDown:fe(o.onKeyDown,v=>{var b;((b=l.searchRef)==null?void 0:b.current)!==""&&v.key===" "||(oQ.includes(v.key)&&w(),v.key===" "&&v.preventDefault())})})})})});qF.displayName=Dv;var Qd="SelectItemText",YF=S.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,...s}=t,o=rl(Qd,n),a=sl(Qd,n),l=XF(Qd,n),u=cQ(Qd,n),[c,d]=S.useState(null),h=rt(e,v=>d(v),l.onItemTextChange,v=>{var y;return(y=a.itemTextRefCallback)==null?void 0:y.call(a,v,l.value,l.disabled)}),f=c==null?void 0:c.textContent,p=S.useMemo(()=>g.jsx("option",{value:l.value,disabled:l.disabled,children:f},l.value),[l.disabled,l.value,f]),{onNativeOptionAdd:m,onNativeOptionRemove:w}=u;return Hn(()=>(m(p),()=>w(p)),[m,w,p]),g.jsxs(g.Fragment,{children:[g.jsx(Fe.span,{id:l.textId,...s,ref:h}),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Lo.createPortal(s.children,o.valueNode):null]})});YF.displayName=Qd;var JF="SelectItemIndicator",SQ=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return XF(JF,n).isSelected?g.jsx(Fe.span,{"aria-hidden":!0,...i,ref:e}):null});SQ.displayName=JF;var j1="SelectScrollUpButton",kQ=S.forwardRef((t,e)=>{const n=sl(j1,t.__scopeSelect),i=X_(j1,t.__scopeSelect),[r,s]=S.useState(!1),o=rt(e,i.onScrollButtonChange);return Hn(()=>{if(n.viewport&&n.isPositioned){let a=function(){const u=l.scrollTop>0;s(u)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?g.jsx(ZF,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});kQ.displayName=j1;var F1="SelectScrollDownButton",_Q=S.forwardRef((t,e)=>{const n=sl(F1,t.__scopeSelect),i=X_(F1,t.__scopeSelect),[r,s]=S.useState(!1),o=rt(e,i.onScrollButtonChange);return Hn(()=>{if(n.viewport&&n.isPositioned){let a=function(){const u=l.scrollHeight-l.clientHeight,c=Math.ceil(l.scrollTop)<u;s(c)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?g.jsx(ZF,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});_Q.displayName=F1;var ZF=S.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:i,...r}=t,s=sl("SelectScrollButton",n),o=S.useRef(null),a=Jy(n),l=S.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return S.useEffect(()=>()=>l(),[l]),Hn(()=>{var c;const u=a().find(d=>d.ref.current===document.activeElement);(c=u==null?void 0:u.ref.current)==null||c.scrollIntoView({block:"nearest"})},[a]),g.jsx(Fe.div,{"aria-hidden":!0,...r,ref:e,style:{flexShrink:0,...r.style},onPointerDown:fe(r.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(i,50))}),onPointerMove:fe(r.onPointerMove,()=>{var u;(u=s.onItemLeave)==null||u.call(s),o.current===null&&(o.current=window.setInterval(i,50))}),onPointerLeave:fe(r.onPointerLeave,()=>{l()})})}),CQ="SelectSeparator",EQ=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return g.jsx(Fe.div,{"aria-hidden":!0,...i,ref:e})});EQ.displayName=CQ;var B1="SelectArrow",AQ=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=Zy(n),s=rl(B1,n),o=sl(B1,n);return s.open&&o.position==="popper"?g.jsx(Wk,{...r,...i,ref:e}):null});AQ.displayName=B1;function QF(t){return t===""||t===void 0}var eB=S.forwardRef((t,e)=>{const{value:n,...i}=t,r=S.useRef(null),s=rt(e,r),o=K_(n);return S.useEffect(()=>{const a=r.current,l=window.HTMLSelectElement.prototype,c=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==n&&c){const d=new Event("change",{bubbles:!0});c.call(a,n),a.dispatchEvent(d)}},[o,n]),g.jsx(qy,{asChild:!0,children:g.jsx("select",{...i,ref:s,defaultValue:n})})});eB.displayName="BubbleSelect";function tB(t){const e=Wn(t),n=S.useRef(""),i=S.useRef(0),r=S.useCallback(o=>{const a=n.current+o;e(a),function l(u){n.current=u,window.clearTimeout(i.current),u!==""&&(i.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),s=S.useCallback(()=>{n.current="",window.clearTimeout(i.current)},[]);return S.useEffect(()=>()=>window.clearTimeout(i.current),[]),[n,r,s]}function nB(t,e,n){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=PQ(t,Math.max(s,0));r.length===1&&(o=o.filter(u=>u!==n));const l=o.find(u=>u.textValue.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function PQ(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var TQ=IF,iB=LF,RQ=FF,NQ=BF,MQ=$F,rB=zF,OQ=WF,sB=qF,IQ=YF;const Uw=TQ,Vw=RQ,fg=S.forwardRef(({className:t,children:e,...n},i)=>g.jsxs(iB,{ref:i,className:ze("flex h-10 items-center justify-between rounded-md border border-stone-600 bg-stone-900 px-3 py-2 text-sm ring-offset-stone-800 placeholder:text-stone-500 focus:outline-none focus:ring-2 focus:ring-stone-600 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:[e,g.jsx(NQ,{asChild:!0,children:g.jsx("span",{className:"icon-[lucide--chevron-down] h-4 w-4 opacity-50"})})]}));fg.displayName=iB.displayName;const pg=S.forwardRef(({className:t,children:e,position:n="popper",...i},r)=>g.jsx(MQ,{children:g.jsx(rB,{ref:r,className:ze("relative z-50 min-w-[8rem] overflow-hidden rounded-md border border-stone-600 bg-stone-900 text-white shadow-md",t),position:n,...i,children:g.jsx(OQ,{className:"p-1",children:e})})}));pg.displayName=rB.displayName;const eh=S.forwardRef(({className:t,children:e,...n},i)=>g.jsx(sB,{ref:i,className:ze("w-full cursor-default select-none rounded-sm px-2 py-1.5 text-sm outline-none transition-colors duration-75 focus:bg-stone-800 focus:text-mantis-400 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:g.jsx(IQ,{children:e})}));eh.displayName=sB.displayName;var oB=["PageUp","PageDown"],aB=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],lB={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ad="Slider",[$1,DQ,LQ]=Wf(ad),[uB,yoe]=ls(ad,[LQ]),[jQ,Qy]=uB(ad),cB=S.forwardRef((t,e)=>{const{name:n,min:i=0,max:r=100,step:s=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:u=[i],value:c,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:f=!1,...p}=t,m=S.useRef(new Set),w=S.useRef(0),y=o==="horizontal"?FQ:BQ,[b=[],k]=Po({prop:c,defaultProp:u,onChange:D=>{var $;($=[...m.current][w.current])==null||$.focus(),d(D)}}),_=S.useRef(b);function E(D){const B=HQ(b,D);I(D,B)}function A(D){I(D,w.current)}function P(){const D=_.current[w.current];b[w.current]!==D&&h(b)}function I(D,B,{commit:$}={commit:!1}){const J=XQ(s),z=qQ(Math.round((D-i)/s)*s+i,J),G=Iv(z,[i,r]);k((Q=[])=>{const ie=UQ(Q,G,B);if(KQ(ie,l*s)){w.current=ie.indexOf(G);const H=String(ie)!==String(Q);return H&&$&&h(ie),H?ie:Q}else return Q})}return g.jsx(jQ,{scope:t.__scopeSlider,name:n,disabled:a,min:i,max:r,valueIndexToChangeRef:w,thumbs:m.current,values:b,orientation:o,children:g.jsx($1.Provider,{scope:t.__scopeSlider,children:g.jsx($1.Slot,{scope:t.__scopeSlider,children:g.jsx(y,{"aria-disabled":a,"data-disabled":a?"":void 0,...p,ref:e,onPointerDown:fe(p.onPointerDown,()=>{a||(_.current=b)}),min:i,max:r,inverted:f,onSlideStart:a?void 0:E,onSlideMove:a?void 0:A,onSlideEnd:a?void 0:P,onHomeKeyDown:()=>!a&&I(i,0,{commit:!0}),onEndKeyDown:()=>!a&&I(r,b.length-1,{commit:!0}),onStepKeyDown:({event:D,direction:B})=>{if(!a){const z=oB.includes(D.key)||D.shiftKey&&aB.includes(D.key)?10:1,G=w.current,Q=b[G],ie=s*z*B;I(Q+ie,G,{commit:!0})}}})})})})});cB.displayName=ad;var[dB,hB]=uB(ad,{startEdge:"left",endEdge:"right",size:"width",direction:1}),FQ=S.forwardRef((t,e)=>{const{min:n,max:i,dir:r,inverted:s,onSlideStart:o,onSlideMove:a,onSlideEnd:l,onStepKeyDown:u,...c}=t,[d,h]=S.useState(null),f=rt(e,b=>h(b)),p=S.useRef(),m=Gf(r),w=m==="ltr",v=w&&!s||!w&&s;function y(b){const k=p.current||d.getBoundingClientRect(),_=[0,k.width],A=q_(_,v?[n,i]:[i,n]);return p.current=k,A(b-k.left)}return g.jsx(dB,{scope:t.__scopeSlider,startEdge:v?"left":"right",endEdge:v?"right":"left",direction:v?1:-1,size:"width",children:g.jsx(fB,{dir:m,"data-orientation":"horizontal",...c,ref:f,style:{...c.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:b=>{const k=y(b.clientX);o==null||o(k)},onSlideMove:b=>{const k=y(b.clientX);a==null||a(k)},onSlideEnd:()=>{p.current=void 0,l==null||l()},onStepKeyDown:b=>{const _=lB[v?"from-left":"from-right"].includes(b.key);u==null||u({event:b,direction:_?-1:1})}})})}),BQ=S.forwardRef((t,e)=>{const{min:n,max:i,inverted:r,onSlideStart:s,onSlideMove:o,onSlideEnd:a,onStepKeyDown:l,...u}=t,c=S.useRef(null),d=rt(e,c),h=S.useRef(),f=!r;function p(m){const w=h.current||c.current.getBoundingClientRect(),v=[0,w.height],b=q_(v,f?[i,n]:[n,i]);return h.current=w,b(m-w.top)}return g.jsx(dB,{scope:t.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:g.jsx(fB,{"data-orientation":"vertical",...u,ref:d,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:m=>{const w=p(m.clientY);s==null||s(w)},onSlideMove:m=>{const w=p(m.clientY);o==null||o(w)},onSlideEnd:()=>{h.current=void 0,a==null||a()},onStepKeyDown:m=>{const v=lB[f?"from-bottom":"from-top"].includes(m.key);l==null||l({event:m,direction:v?-1:1})}})})}),fB=S.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:i,onSlideMove:r,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:l,...u}=t,c=Qy(ad,n);return g.jsx(Fe.span,{...u,ref:e,onKeyDown:fe(t.onKeyDown,d=>{d.key==="Home"?(o(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):oB.concat(aB).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:fe(t.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),c.thumbs.has(h)?h.focus():i(d)}),onPointerMove:fe(t.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&r(d)}),onPointerUp:fe(t.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),s(d))})})}),pB="SliderTrack",mB=S.forwardRef((t,e)=>{const{__scopeSlider:n,...i}=t,r=Qy(pB,n);return g.jsx(Fe.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...i,ref:e})});mB.displayName=pB;var z1="SliderRange",gB=S.forwardRef((t,e)=>{const{__scopeSlider:n,...i}=t,r=Qy(z1,n),s=hB(z1,n),o=S.useRef(null),a=rt(e,o),l=r.values.length,u=r.values.map(h=>yB(h,r.min,r.max)),c=l>1?Math.min(...u):0,d=100-Math.max(...u);return g.jsx(Fe.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...i,ref:a,style:{...t.style,[s.startEdge]:c+"%",[s.endEdge]:d+"%"}})});gB.displayName=z1;var U1="SliderThumb",vB=S.forwardRef((t,e)=>{const n=DQ(t.__scopeSlider),[i,r]=S.useState(null),s=rt(e,a=>r(a)),o=S.useMemo(()=>i?n().findIndex(a=>a.ref.current===i):-1,[n,i]);return g.jsx($Q,{...t,ref:s,index:o})}),$Q=S.forwardRef((t,e)=>{const{__scopeSlider:n,index:i,name:r,...s}=t,o=Qy(U1,n),a=hB(U1,n),[l,u]=S.useState(null),c=rt(e,y=>u(y)),d=l?!!l.closest("form"):!0,h=$k(l),f=o.values[i],p=f===void 0?0:yB(f,o.min,o.max),m=VQ(i,o.values.length),w=h==null?void 0:h[a.size],v=w?WQ(w,p,a.direction):0;return S.useEffect(()=>{if(l)return o.thumbs.add(l),()=>{o.thumbs.delete(l)}},[l,o.thumbs]),g.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${p}% + ${v}px)`},children:[g.jsx($1.ItemSlot,{scope:t.__scopeSlider,children:g.jsx(Fe.span,{role:"slider","aria-label":t["aria-label"]||m,"aria-valuemin":o.min,"aria-valuenow":f,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...s,ref:c,style:f===void 0?{display:"none"}:t.style,onFocus:fe(t.onFocus,()=>{o.valueIndexToChangeRef.current=i})})}),d&&g.jsx(zQ,{name:r??(o.name?o.name+(o.values.length>1?"[]":""):void 0),value:f},i)]})});vB.displayName=U1;var zQ=t=>{const{value:e,...n}=t,i=S.useRef(null),r=K_(e);return S.useEffect(()=>{const s=i.current,o=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(o,"value").set;if(r!==e&&l){const u=new Event("input",{bubbles:!0});l.call(s,e),s.dispatchEvent(u)}},[r,e]),g.jsx("input",{style:{display:"none"},...n,ref:i,defaultValue:e})};function UQ(t=[],e,n){const i=[...t];return i[n]=e,i.sort((r,s)=>r-s)}function yB(t,e,n){const s=100/(n-e)*(t-e);return Iv(s,[0,100])}function VQ(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function HQ(t,e){if(t.length===1)return 0;const n=t.map(r=>Math.abs(r-e)),i=Math.min(...n);return n.indexOf(i)}function WQ(t,e,n){const i=t/2,s=q_([0,50],[0,i]);return(i-s(e)*n)*n}function GQ(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function KQ(t,e){if(e>0){const n=GQ(t);return Math.min(...n)>=e}return!0}function q_(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const i=(e[1]-e[0])/(t[1]-t[0]);return e[0]+i*(n-t[0])}}function XQ(t){return(String(t).split(".")[1]||"").length}function qQ(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}var wB=cB,YQ=mB,JQ=gB,ZQ=vB;const xl=S.forwardRef(({className:t,...e},n)=>g.jsxs(wB,{ref:n,className:ze("relative flex touch-none select-none items-center",t),...e,children:[g.jsx(YQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-stone-900",children:g.jsx(JQ,{className:"absolute h-full bg-mantis-400"})}),g.jsx(ZQ,{className:"block h-5 w-5 rounded-full border-2 border-stone-900 bg-mantis-400 ring-offset-stone-800 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));xl.displayName=wB.displayName;var Y_="Switch",[QQ,woe]=ls(Y_),[eee,tee]=QQ(Y_),bB=S.forwardRef((t,e)=>{const{__scopeSwitch:n,name:i,checked:r,defaultChecked:s,required:o,disabled:a,value:l="on",onCheckedChange:u,...c}=t,[d,h]=S.useState(null),f=rt(e,y=>h(y)),p=S.useRef(!1),m=d?!!d.closest("form"):!0,[w=!1,v]=Po({prop:r,defaultProp:s,onChange:u});return g.jsxs(eee,{scope:n,checked:w,disabled:a,children:[g.jsx(Fe.button,{type:"button",role:"switch","aria-checked":w,"aria-required":o,"data-state":kB(w),"data-disabled":a?"":void 0,disabled:a,value:l,...c,ref:f,onClick:fe(t.onClick,y=>{v(b=>!b),m&&(p.current=y.isPropagationStopped(),p.current||y.stopPropagation())})}),m&&g.jsx(nee,{control:d,bubbles:!p.current,name:i,value:l,checked:w,required:o,disabled:a,style:{transform:"translateX(-100%)"}})]})});bB.displayName=Y_;var xB="SwitchThumb",SB=S.forwardRef((t,e)=>{const{__scopeSwitch:n,...i}=t,r=tee(xB,n);return g.jsx(Fe.span,{"data-state":kB(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:e})});SB.displayName=xB;var nee=t=>{const{control:e,checked:n,bubbles:i=!0,...r}=t,s=S.useRef(null),o=K_(n),a=$k(e);return S.useEffect(()=>{const l=s.current,u=window.HTMLInputElement.prototype,d=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==n&&d){const h=new Event("click",{bubbles:i});d.call(l,n),l.dispatchEvent(h)}},[o,n,i]),g.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...r,tabIndex:-1,ref:s,style:{...t.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function kB(t){return t?"checked":"unchecked"}var _B=bB,iee=SB;const Lv=S.forwardRef(({className:t,...e},n)=>g.jsx(_B,{className:ze("peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-mantis-400 data-[state=unchecked]:bg-stone-900",t),...e,ref:n,children:g.jsx(iee,{className:ze("pointer-events-none block h-5 w-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Lv.displayName=_B.displayName;const J_=Ae(!1);function CB({className:t}){const e=mt(),[n,i]=hj(),{status:r}=mn();return g.jsxs("div",{className:ze("overflow-auto scrollbar-stone-700",t),children:[g.jsxs("h3",{className:"flex items-center gap-2 border-b border-stone-600 py-2 pl-4 text-xl font-semibold",children:[g.jsx("span",{className:"icon-[lucide--settings] h-6 w-6"})," ",e("settings.title")]}),g.jsxs(Hs,{children:[g.jsx(Ws,{children:g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--languages] h-6 w-6"}),e("settings.language.label")]})}),g.jsxs(Uw,{value:n.language,onValueChange:s=>i(o=>({...o,language:s})),children:[g.jsx(fg,{className:"w-32",children:g.jsx(Vw,{})}),g.jsxs(pg,{children:[g.jsx(eh,{value:"en",children:g.jsxs("span",{className:"inline-flex items-center gap-2",children:[g.jsx("span",{className:"icon-[circle-flags--uk] h-4 w-4"})," English"]})}),g.jsx(eh,{value:"es",children:g.jsxs("span",{className:"inline-flex items-center gap-2",children:[g.jsx("span",{className:"icon-[circle-flags--ar] h-4 w-4"})," Español"]})})]})]})]}),g.jsxs(Hs,{children:[g.jsx(Ws,{children:g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--pilcrow-square] h-6 w-6"}),e("settings.editorFontSize.label")]})}),g.jsxs("div",{className:"flex items-center rounded-lg border border-stone-600 bg-stone-900",children:[g.jsx("button",{className:"m-0.5 flex h-8 w-8 items-center justify-center rounded-lg text-white transition-colors hover:enabled:bg-stone-800 disabled:cursor-not-allowed",disabled:n.editorFontSize<=8,onClick:()=>i(s=>({...s,editorFontSize:s.editorFontSize-1})),title:e("settings.editorFontSize.decrease"),children:g.jsx("span",{className:"icon-[lucide--minus] h-4 w-4"})}),g.jsx("span",{className:"w-8 text-center text-sm font-normal",children:n.editorFontSize}),g.jsx("button",{className:"m-0.5 flex h-8 w-8 items-center justify-center rounded-lg text-white transition-colors hover:enabled:bg-stone-800 disabled:cursor-not-allowed",disabled:n.editorFontSize>=64,onClick:()=>i(s=>({...s,editorFontSize:s.editorFontSize+1})),title:e("settings.editorFontSize.increase"),children:g.jsx("span",{className:"icon-[lucide--plus] h-4 w-4"})})]})]}),g.jsx("hr",{className:"border-stone-600"}),g.jsxs(Hs,{children:[g.jsxs(Ws,{children:[g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--memory-stick] h-6 w-6"}),e("settings.dataOnLoad.label")]}),g.jsx(vm,{children:e("settings.dataOnLoad.description")})]}),g.jsxs(Uw,{value:n.dataOnLoad,onValueChange:s=>i(o=>({...o,dataOnLoad:s})),children:[g.jsx(fg,{className:"w-32 min-w-[theme(width.32)]",children:g.jsx(Vw,{})}),g.jsx(pg,{children:cj.map(s=>g.jsx(eh,{value:s,children:e(`settings.dataOnLoad.${s}`)},s))})]})]}),g.jsxs(Hs,{children:[g.jsxs(Ws,{children:[g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--monitor-smartphone] h-6 w-6"}),e("settings.devices.label")]}),g.jsx(vm,{children:e("settings.devices.description")})]}),g.jsxs(Uw,{value:n.devices,onValueChange:s=>i(o=>({...o,devices:s})),disabled:r.type!=="stopped",children:[g.jsx(fg,{className:"w-52 min-w-[theme(width.52)]",children:g.jsx(Vw,{})}),g.jsx(pg,{children:dj.map(s=>g.jsx(eh,{value:s,children:e(`settings.devices.${s}`)},s))})]})]}),g.jsx("hr",{className:"border-stone-600"}),g.jsxs(Hs,{children:[g.jsxs(Ws,{children:[g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--rotate-3d] h-6 w-6"}),e("settings.animations.label")]}),g.jsx(vm,{children:e("settings.animations.description")})]}),g.jsx(Lv,{className:"ml-8",checked:n.animations,onCheckedChange:s=>{i(o=>({...o,animations:s})),s===!1&&rF()}})]}),g.jsxs(Hs,{children:[g.jsx(Ws,{children:g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--gauge] h-6 w-6"}),e("settings.speeds.executionUnit")]})}),g.jsx(xl,{className:"w-44",...Hw({value:n.executionUnit,onValueChange:s=>i(o=>({...o,executionUnit:s})),min:500,max:1})})]}),g.jsxs(Hs,{children:[g.jsx(Ws,{children:g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--clock] h-6 w-6"}),e("settings.speeds.clockSpeed")]})}),g.jsx(xl,{className:"w-44",...Hw({value:n.clockSpeed,onValueChange:s=>i(o=>({...o,clockSpeed:s})),min:3e3,max:100})})]}),g.jsxs(Hs,{children:[g.jsx(Ws,{children:g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--printer] h-6 w-6"}),e("settings.speeds.printerSpeed")]})}),g.jsx(xl,{className:"w-44",...Hw({value:n.printerSpeed,onValueChange:s=>i(o=>({...o,printerSpeed:s})),min:2e4,max:500})})]}),g.jsx("hr",{className:"border-stone-600"}),g.jsxs(Hs,{children:[g.jsxs(Ws,{children:[g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--contrast] h-6 w-6"}),e("settings.filters.label")]}),g.jsxs(vm,{children:[e("settings.filters.description"),g.jsx("button",{className:"mt-1 block text-mantis-400 transition-colors hover:text-mantis-300",onClick:()=>i(s=>({...s,filterBightness:_u.filterBightness,filterContrast:_u.filterContrast,filterInvert:_u.filterInvert,filterSaturation:_u.filterSaturation})),children:e("settings.filters.revert")})]})]}),g.jsxs("div",{className:"ml-8 grid w-64 grid-cols-[min-content,auto] items-center gap-2",children:[g.jsx("span",{className:"text-xs",children:e("settings.filters.brightness")}),g.jsx(xl,{value:[n.filterBightness],onValueChange:([s])=>i(o=>({...o,filterBightness:s})),min:0,max:5,step:.05}),g.jsx("span",{className:"text-xs",children:e("settings.filters.contrast")}),g.jsx(xl,{value:[n.filterContrast],onValueChange:([s])=>i(o=>({...o,filterContrast:s})),min:0,max:5,step:.05}),g.jsx("span",{className:"text-xs",children:e("settings.filters.invert")}),g.jsx(Lv,{checked:n.filterInvert,onCheckedChange:s=>i(o=>({...o,filterInvert:s}))}),g.jsx("span",{className:"text-xs",children:e("settings.filters.saturation")}),g.jsx(xl,{value:[n.filterSaturation],onValueChange:([s])=>i(o=>({...o,filterSaturation:s})),min:0,max:5,step:.05})]})]}),g.jsx("hr",{className:"border-stone-600"}),g.jsx("div",{className:"flex justify-end p-4",children:g.jsxs("button",{className:"inline-flex items-center gap-1 text-sm text-red-500 transition-colors hover:text-red-400",onClick:()=>i(s=>({..._u,language:s.language,devices:s.devices})),children:[g.jsx("span",{className:"icon-[lucide--trash-2] h-4 w-4"}),e("settings.reset")]})})]})}function Hs({children:t}){return g.jsx("div",{className:"m-4 flex items-center justify-between gap-4",children:t})}function Ws({children:t}){return g.jsx("div",{className:"grow",children:t})}function Gs({children:t}){return g.jsx("p",{className:"flex items-center gap-2 font-medium",children:t})}function vm({children:t}){return g.jsx("p",{className:"mt-1 text-xs text-stone-400",children:t})}function Hw({value:t,onValueChange:e,min:n,max:i}){const r=Math.log(n),o=(Math.log(i)-r)/100;return{value:[(Math.log(t)-r)/o],onValueChange:a=>e(Math.exp(r+o*a[0])),min:0,max:100}}function ree(){const t=mt(),[e,n]=ed(J_);return g.jsxs("header",{className:"relative p-2 text-sm text-white",children:[g.jsx(iQ,{className:" absolute inset-0"}),g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex select-none items-center justify-center",children:[g.jsx("img",{src:"/VonSim8/favicon.svg",className:"mr-2 h-10 w-10"}),g.jsxs("h1",{className:"text-xl font-bold max-sm:hidden",children:["Von",g.jsx("span",{className:"text-mantis-400",children:"Sim"}),"8"]})]}),g.jsx("button",{className:ze("h-min w-min rounded-full p-2 transition-colors focus:outline-stone-400",e?"bg-stone-700 hover:bg-stone-600 focus:bg-stone-600":"hover:bg-stone-800 focus:bg-stone-800"),title:t("settings.title"),onClick:()=>n(!e),children:g.jsx("span",{className:"icon-[lucide--settings] block h-6 w-6"})})]})]})}var Z_="ToastProvider",[Q_,see,oee]=Wf("Toast"),[EB,boe]=ls("Toast",[oee]),[aee,e0]=EB(Z_),AB=t=>{const{__scopeToast:e,label:n="Notification",duration:i=5e3,swipeDirection:r="right",swipeThreshold:s=50,children:o}=t,[a,l]=S.useState(null),[u,c]=S.useState(0),d=S.useRef(!1),h=S.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Z_}\`. Expected non-empty \`string\`.`),g.jsx(Q_.Provider,{scope:e,children:g.jsx(aee,{scope:e,label:n,duration:i,swipeDirection:r,swipeThreshold:s,toastCount:u,viewport:a,onViewportChange:l,onToastAdd:S.useCallback(()=>c(f=>f+1),[]),onToastRemove:S.useCallback(()=>c(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:o})})};AB.displayName=Z_;var PB="ToastViewport",lee=["F8"],V1="toast.viewportPause",H1="toast.viewportResume",TB=S.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:i=lee,label:r="Notifications ({hotkey})",...s}=t,o=e0(PB,n),a=see(n),l=S.useRef(null),u=S.useRef(null),c=S.useRef(null),d=S.useRef(null),h=rt(e,d,o.onViewportChange),f=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;S.useEffect(()=>{const w=v=>{var b;i.every(k=>v[k]||v.code===k)&&((b=d.current)==null||b.focus())};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[i]),S.useEffect(()=>{const w=l.current,v=d.current;if(p&&w&&v){const y=()=>{if(!o.isClosePausedRef.current){const E=new CustomEvent(V1);v.dispatchEvent(E),o.isClosePausedRef.current=!0}},b=()=>{if(o.isClosePausedRef.current){const E=new CustomEvent(H1);v.dispatchEvent(E),o.isClosePausedRef.current=!1}},k=E=>{!w.contains(E.relatedTarget)&&b()},_=()=>{w.contains(document.activeElement)||b()};return w.addEventListener("focusin",y),w.addEventListener("focusout",k),w.addEventListener("pointermove",y),w.addEventListener("pointerleave",_),window.addEventListener("blur",y),window.addEventListener("focus",b),()=>{w.removeEventListener("focusin",y),w.removeEventListener("focusout",k),w.removeEventListener("pointermove",y),w.removeEventListener("pointerleave",_),window.removeEventListener("blur",y),window.removeEventListener("focus",b)}}},[p,o.isClosePausedRef]);const m=S.useCallback(({tabbingDirection:w})=>{const y=a().map(b=>{const k=b.ref.current,_=[k,...xee(k)];return w==="forwards"?_:_.reverse()});return(w==="forwards"?y.reverse():y).flat()},[a]);return S.useEffect(()=>{const w=d.current;if(w){const v=y=>{var _,E,A;const b=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!b){const P=document.activeElement,I=y.shiftKey;if(y.target===w&&I){(_=u.current)==null||_.focus();return}const $=m({tabbingDirection:I?"backwards":"forwards"}),J=$.findIndex(z=>z===P);Ww($.slice(J+1))?y.preventDefault():I?(E=u.current)==null||E.focus():(A=c.current)==null||A.focus()}};return w.addEventListener("keydown",v),()=>w.removeEventListener("keydown",v)}},[a,m]),g.jsxs(g9,{ref:l,role:"region","aria-label":r.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&g.jsx(W1,{ref:u,onFocusFromOutsideViewport:()=>{const w=m({tabbingDirection:"forwards"});Ww(w)}}),g.jsx(Q_.Slot,{scope:n,children:g.jsx(Fe.ol,{tabIndex:-1,...s,ref:h})}),p&&g.jsx(W1,{ref:c,onFocusFromOutsideViewport:()=>{const w=m({tabbingDirection:"backwards"});Ww(w)}})]})});TB.displayName=PB;var RB="ToastFocusProxy",W1=S.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:i,...r}=t,s=e0(RB,n);return g.jsx(qy,{"aria-hidden":!0,tabIndex:0,...r,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const a=o.relatedTarget;!((u=s.viewport)!=null&&u.contains(a))&&i()}})});W1.displayName=RB;var t0="Toast",uee="toast.swipeStart",cee="toast.swipeMove",dee="toast.swipeCancel",hee="toast.swipeEnd",NB=S.forwardRef((t,e)=>{const{forceMount:n,open:i,defaultOpen:r,onOpenChange:s,...o}=t,[a=!0,l]=Po({prop:i,defaultProp:r,onChange:s});return g.jsx(jo,{present:n||a,children:g.jsx(mee,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:Wn(t.onPause),onResume:Wn(t.onResume),onSwipeStart:fe(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:fe(t.onSwipeMove,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:fe(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:fe(t.onSwipeEnd,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});NB.displayName=t0;var[fee,pee]=EB(t0,{onClose(){}}),mee=S.forwardRef((t,e)=>{const{__scopeToast:n,type:i="foreground",duration:r,open:s,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:u,onSwipeStart:c,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...p}=t,m=e0(t0,n),[w,v]=S.useState(null),y=rt(e,z=>v(z)),b=S.useRef(null),k=S.useRef(null),_=r||m.duration,E=S.useRef(0),A=S.useRef(_),P=S.useRef(0),{onToastAdd:I,onToastRemove:D}=m,B=Wn(()=>{var G;(w==null?void 0:w.contains(document.activeElement))&&((G=m.viewport)==null||G.focus()),o()}),$=S.useCallback(z=>{!z||z===1/0||(window.clearTimeout(P.current),E.current=new Date().getTime(),P.current=window.setTimeout(B,z))},[B]);S.useEffect(()=>{const z=m.viewport;if(z){const G=()=>{$(A.current),u==null||u()},Q=()=>{const ie=new Date().getTime()-E.current;A.current=A.current-ie,window.clearTimeout(P.current),l==null||l()};return z.addEventListener(V1,Q),z.addEventListener(H1,G),()=>{z.removeEventListener(V1,Q),z.removeEventListener(H1,G)}}},[m.viewport,_,l,u,$]),S.useEffect(()=>{s&&!m.isClosePausedRef.current&&$(_)},[s,_,m.isClosePausedRef,$]),S.useEffect(()=>(I(),()=>D()),[I,D]);const J=S.useMemo(()=>w?FB(w):null,[w]);return m.viewport?g.jsxs(g.Fragment,{children:[J&&g.jsx(gee,{__scopeToast:n,role:"status","aria-live":i==="foreground"?"assertive":"polite","aria-atomic":!0,children:J}),g.jsx(fee,{scope:n,onClose:B,children:Lo.createPortal(g.jsx(Q_.ItemSlot,{scope:n,children:g.jsx(m9,{asChild:!0,onEscapeKeyDown:fe(a,()=>{m.isFocusedToastEscapeKeyDownRef.current||B(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:g.jsx(Fe.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":m.swipeDirection,...p,ref:y,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:fe(t.onKeyDown,z=>{z.key==="Escape"&&(a==null||a(z.nativeEvent),z.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,B()))}),onPointerDown:fe(t.onPointerDown,z=>{z.button===0&&(b.current={x:z.clientX,y:z.clientY})}),onPointerMove:fe(t.onPointerMove,z=>{if(!b.current)return;const G=z.clientX-b.current.x,Q=z.clientY-b.current.y,ie=!!k.current,H=["left","right"].includes(m.swipeDirection),j=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,te=H?j(0,G):0,pe=H?0:j(0,Q),q=z.pointerType==="touch"?10:2,ue={x:te,y:pe},O={originalEvent:z,delta:ue};ie?(k.current=ue,ym(cee,d,O,{discrete:!1})):QT(ue,m.swipeDirection,q)?(k.current=ue,ym(uee,c,O,{discrete:!1}),z.target.setPointerCapture(z.pointerId)):(Math.abs(G)>q||Math.abs(Q)>q)&&(b.current=null)}),onPointerUp:fe(t.onPointerUp,z=>{const G=k.current,Q=z.target;if(Q.hasPointerCapture(z.pointerId)&&Q.releasePointerCapture(z.pointerId),k.current=null,b.current=null,G){const ie=z.currentTarget,H={originalEvent:z,delta:G};QT(G,m.swipeDirection,m.swipeThreshold)?ym(hee,f,H,{discrete:!0}):ym(dee,h,H,{discrete:!0}),ie.addEventListener("click",j=>j.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),gee=t=>{const{__scopeToast:e,children:n,...i}=t,r=e0(t0,e),[s,o]=S.useState(!1),[a,l]=S.useState(!1);return wee(()=>o(!0)),S.useEffect(()=>{const u=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(u)},[]),a?null:g.jsx(tp,{asChild:!0,children:g.jsx(qy,{...i,children:s&&g.jsxs(g.Fragment,{children:[r.label," ",n]})})})},vee="ToastTitle",MB=S.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t;return g.jsx(Fe.div,{...i,ref:e})});MB.displayName=vee;var yee="ToastDescription",OB=S.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t;return g.jsx(Fe.div,{...i,ref:e})});OB.displayName=yee;var IB="ToastAction",DB=S.forwardRef((t,e)=>{const{altText:n,...i}=t;return n.trim()?g.jsx(jB,{altText:n,asChild:!0,children:g.jsx(eC,{...i,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${IB}\`. Expected non-empty \`string\`.`),null)});DB.displayName=IB;var LB="ToastClose",eC=S.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t,r=pee(LB,n);return g.jsx(jB,{asChild:!0,children:g.jsx(Fe.button,{type:"button",...i,ref:e,onClick:fe(t.onClick,r.onClose)})})});eC.displayName=LB;var jB=S.forwardRef((t,e)=>{const{__scopeToast:n,altText:i,...r}=t;return g.jsx(Fe.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":i||void 0,...r,ref:e})});function FB(t){const e=[];return Array.from(t.childNodes).forEach(i=>{if(i.nodeType===i.TEXT_NODE&&i.textContent&&e.push(i.textContent),bee(i)){const r=i.ariaHidden||i.hidden||i.style.display==="none",s=i.dataset.radixToastAnnounceExclude==="";if(!r)if(s){const o=i.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...FB(i))}}),e}function ym(t,e,n,{discrete:i}){const r=n.originalEvent.currentTarget,s=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),i?fk(r,s):r.dispatchEvent(s)}var QT=(t,e,n=0)=>{const i=Math.abs(t.x),r=Math.abs(t.y),s=i>r;return e==="left"||e==="right"?s&&i>n:!s&&r>n};function wee(t=()=>{}){const e=Wn(t);Hn(()=>{let n=0,i=0;return n=window.requestAnimationFrame(()=>i=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(i)}},[e])}function bee(t){return t.nodeType===t.ELEMENT_NODE}function xee(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Ww(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var See=AB,BB=TB,$B=NB,zB=MB,UB=OB,VB=DB,HB=eC;const kee=See,WB=S.forwardRef(({className:t,...e},n)=>g.jsx(BB,{ref:n,className:ze("fixed inset-x-0 top-12 z-[100] mx-auto flex max-h-screen w-full flex-col p-4 md:max-w-[420px]",t),...e}));WB.displayName=BB.displayName;const GB=S.forwardRef(({className:t,variant:e="default",...n},i)=>g.jsx($B,{ref:i,"data-variant":e,className:ze("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-bottom-full data-[state=open]:slide-in-from-top-full",e==="default"&&"border border-stone-600 bg-stone-900 text-white",e==="error"&&"group bg-red-900 text-red-50",e==="info"&&"border border-green-500 border-stone-600 bg-stone-900 text-white",t),...n}));GB.displayName=$B.displayName;const KB=S.forwardRef(({className:t,...e},n)=>g.jsx(VB,{ref:n,className:ze("inline-flex h-8 shrink-0 items-center justify-center rounded-md bg-mantis-500 px-3 text-sm font-medium ring-offset-stone-900 transition-colors hover:bg-mantis-400 focus:outline-none focus:ring-2 focus:ring-stone-600 focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50","group-data-[variant=error]:border group-data-[variant=error]:border-white/40 group-data-[variant=error]:hover:border-white/30  group-data-[variant=error]:hover:bg-red-700 group-data-[variant=error]:hover:text-white group-data-[variant=error]:focus:ring-white",t),...e}));KB.displayName=VB.displayName;const XB=S.forwardRef(({className:t,...e},n)=>g.jsx(HB,{ref:n,className:ze("text-current/50 absolute right-2 top-2 rounded-md p-1 opacity-0 transition-opacity hover:text-current focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-data-[variant=error]:text-red-300 group-data-[variant=error]:hover:text-red-50 group-data-[variant=error]:focus:ring-red-400 group-data-[variant=error]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:g.jsx("span",{className:"icon-[lucide--x] block h-4 w-4"})}));XB.displayName=HB.displayName;const qB=S.forwardRef(({className:t,...e},n)=>g.jsx(zB,{ref:n,className:ze("text-sm font-semibold",t),...e}));qB.displayName=zB.displayName;const YB=S.forwardRef(({className:t,...e},n)=>g.jsx(UB,{ref:n,className:ze("text-sm opacity-90",t),...e}));YB.displayName=UB.displayName;var gr=function(t,e){return Number(t.toFixed(e))},_ee=function(t,e){return e},Ot=function(t,e,n){n&&typeof n=="function"&&n(t,e)},Cee=function(t){return-Math.cos(t*Math.PI)/2+.5},Eee=function(t){return t},Aee=function(t){return t*t},Pee=function(t){return t*(2-t)},Tee=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},Ree=function(t){return t*t*t},Nee=function(t){return--t*t*t+1},Mee=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},Oee=function(t){return t*t*t*t},Iee=function(t){return 1- --t*t*t*t},Dee=function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},Lee=function(t){return t*t*t*t*t},jee=function(t){return 1+--t*t*t*t*t},Fee=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},JB={easeOut:Cee,linear:Eee,easeInQuad:Aee,easeOutQuad:Pee,easeInOutQuad:Tee,easeInCubic:Ree,easeOutCubic:Nee,easeInOutCubic:Mee,easeInQuart:Oee,easeOutQuart:Iee,easeInOutQuart:Dee,easeInQuint:Lee,easeOutQuint:jee,easeInOutQuint:Fee},ZB=function(t){typeof t=="number"&&cancelAnimationFrame(t)},Ps=function(t){t.mounted&&(ZB(t.animation),t.animate=!1,t.animation=null,t.velocity=null)};function QB(t,e,n,i){if(t.mounted){var r=new Date().getTime(),s=1;Ps(t),t.animation=function(){if(!t.mounted)return ZB(t.animation);var o=new Date().getTime()-r,a=o/n,l=JB[e],u=l(a);o>=n?(i(s),t.animation=null):t.animation&&(i(u),requestAnimationFrame(t.animation))},requestAnimationFrame(t.animation)}}function Bee(t){var e=t.scale,n=t.positionX,i=t.positionY;return!(Number.isNaN(e)||Number.isNaN(n)||Number.isNaN(i))}function ol(t,e,n,i){var r=Bee(e);if(!(!t.mounted||!r)){var s=t.setTransformState,o=t.transformState,a=o.scale,l=o.positionX,u=o.positionY,c=e.scale-a,d=e.positionX-l,h=e.positionY-u;n===0?s(e.scale,e.positionX,e.positionY):QB(t,i,n,function(f){var p=a+c*f,m=l+d*f,w=u+h*f;s(p,m,w)})}}function $ee(t,e,n){var i=t.offsetWidth,r=t.offsetHeight,s=e.offsetWidth,o=e.offsetHeight,a=s*n,l=o*n,u=i-a,c=r-l;return{wrapperWidth:i,wrapperHeight:r,newContentWidth:a,newDiffWidth:u,newContentHeight:l,newDiffHeight:c}}var zee=function(t,e,n,i,r,s,o){var a=t>e?n*(o?1:.5):0,l=i>r?s*(o?1:.5):0,u=t-e-a,c=a,d=i-r-l,h=l;return{minPositionX:u,maxPositionX:c,minPositionY:d,maxPositionY:h}},tC=function(t,e){var n=t.wrapperComponent,i=t.contentComponent,r=t.setup.centerZoomedOut;if(!n||!i)throw new Error("Components are not mounted");var s=$ee(n,i,e),o=s.wrapperWidth,a=s.wrapperHeight,l=s.newContentWidth,u=s.newDiffWidth,c=s.newContentHeight,d=s.newDiffHeight,h=zee(o,l,u,a,c,d,!!r);return h},G1=function(t,e,n,i){return i?t<e?gr(e,2):t>n?gr(n,2):gr(t,2):gr(t,2)},Hc=function(t,e){var n=tC(t,e);return t.bounds=n,n};function up(t,e,n,i,r,s,o){var a=n.minPositionX,l=n.minPositionY,u=n.maxPositionX,c=n.maxPositionY,d=0,h=0;o&&(d=r,h=s);var f=G1(t,a-d,u+d,i),p=G1(e,l-h,c+h,i);return{x:f,y:p}}function n0(t,e,n,i,r,s){var o=t.transformState,a=o.scale,l=o.positionX,u=o.positionY,c=i-a;if(typeof e!="number"||typeof n!="number")return console.error("Mouse X and Y position were not provided!"),{x:l,y:u};var d=l-e*c,h=u-n*c,f=up(d,h,r,s,0,0,null);return f}function cp(t,e,n,i,r){var s=r?i:0,o=e-s;return!Number.isNaN(n)&&t>=n?n:!Number.isNaN(e)&&t<=o?o:t}var eR=function(t,e){var n=t.setup.panning.excluded,i=t.isInitialized,r=t.wrapperComponent,s=e.target,o="shadowRoot"in s&&"composedPath"in e,a=o?e.composedPath().some(function(c){return c instanceof Element?r==null?void 0:r.contains(c):!1}):r==null?void 0:r.contains(s),l=i&&s&&a;if(!l)return!1;var u=i0(s,n);return!u},tR=function(t){var e=t.isInitialized,n=t.isPanning,i=t.setup,r=i.panning.disabled,s=e&&n&&!r;return!!s},Uee=function(t,e){var n=t.transformState,i=n.positionX,r=n.positionY;t.isPanning=!0;var s=e.clientX,o=e.clientY;t.startCoords={x:s-i,y:o-r}},Vee=function(t,e){var n=e.touches,i=t.transformState,r=i.positionX,s=i.positionY;t.isPanning=!0;var o=n.length===1;if(o){var a=n[0].clientX,l=n[0].clientY;t.startCoords={x:a-r,y:l-s}}};function Hee(t){var e=t.transformState,n=e.positionX,i=e.positionY,r=e.scale,s=t.setup,o=s.disabled,a=s.limitToBounds,l=s.centerZoomedOut,u=t.wrapperComponent;if(!(o||!u||!t.bounds)){var c=t.bounds,d=c.maxPositionX,h=c.minPositionX,f=c.maxPositionY,p=c.minPositionY,m=n>d||n<h,w=i>f||i<p,v=n>d?u.offsetWidth:t.setup.minPositionX||0,y=i>f?u.offsetHeight:t.setup.minPositionY||0,b=n0(t,v,y,r,t.bounds,a||l),k=b.x,_=b.y;return{scale:r,positionX:m?k:n,positionY:w?_:i}}}function e$(t,e,n,i,r){var s=t.setup.limitToBounds,o=t.wrapperComponent,a=t.bounds,l=t.transformState,u=l.scale,c=l.positionX,d=l.positionY;if(!(o===null||a===null||e===c&&n===d)){var h=up(e,n,a,s,i,r,o),f=h.x,p=h.y;t.setTransformState(u,f,p)}}var Wee=function(t,e,n){var i=t.startCoords,r=t.transformState,s=t.setup.panning,o=s.lockAxisX,a=s.lockAxisY,l=r.positionX,u=r.positionY;if(!i)return{x:l,y:u};var c=e-i.x,d=n-i.y,h=o?l:c,f=a?u:d;return{x:h,y:f}},Ya=function(t,e){var n=t.setup,i=t.transformState,r=i.scale,s=n.minScale,o=n.disablePadding;return e>0&&r>=s&&!o?e:0},Gee=function(t){var e=t.mounted,n=t.setup,i=n.disabled,r=n.velocityAnimation,s=t.transformState.scale,o=r.disabled,a=!o||s>1||!i||e;return!!a},Kee=function(t){var e=t.mounted,n=t.velocity,i=t.bounds,r=t.setup,s=r.disabled,o=r.velocityAnimation,a=t.transformState.scale,l=o.disabled,u=!l||a>1||!s||e;return!(!u||!n||!i)};function Xee(t,e){var n=t.setup.velocityAnimation,i=n.equalToMove,r=n.animationTime,s=n.sensitivity;return i?r*e*s:r}function nR(t,e,n,i,r,s,o,a,l,u){if(r){if(e>o&&n>o){var c=o+(t-o)*u;return c>l?l:c<o?o:c}if(e<s&&n<s){var c=s+(t-s)*u;return c<a?a:c>s?s:c}}return i?e:G1(t,s,o,r)}function qee(t,e){var n=1;return e?Math.min(n,t.offsetWidth/window.innerWidth):n}function Yee(t,e){var n=Gee(t);if(n){var i=t.lastMousePosition,r=t.velocityTime,s=t.setup,o=t.wrapperComponent,a=s.velocityAnimation.equalToMove,l=Date.now();if(i&&r&&o){var u=qee(o,a),c=e.x-i.x,d=e.y-i.y,h=c/u,f=d/u,p=l-r,m=c*c+d*d,w=Math.sqrt(m)/p;t.velocity={velocityX:h,velocityY:f,total:w}}t.lastMousePosition=e,t.velocityTime=l}}function Jee(t){var e=t.velocity,n=t.bounds,i=t.setup,r=t.wrapperComponent,s=Kee(t);if(!(!s||!e||!n||!r)){var o=e.velocityX,a=e.velocityY,l=e.total,u=n.maxPositionX,c=n.minPositionX,d=n.maxPositionY,h=n.minPositionY,f=i.limitToBounds,p=i.alignmentAnimation,m=i.zoomAnimation,w=i.panning,v=w.lockAxisY,y=w.lockAxisX,b=m.animationType,k=p.sizeX,_=p.sizeY,E=p.velocityAlignmentTime,A=E,P=Xee(t,l),I=Math.max(P,A),D=Ya(t,k),B=Ya(t,_),$=D*r.offsetWidth/100,J=B*r.offsetHeight/100,z=u+$,G=c-$,Q=d+J,ie=h-J,H=t.transformState,j=new Date().getTime();QB(t,b,I,function(te){var pe=t.transformState,q=pe.scale,ue=pe.positionX,O=pe.positionY,M=new Date().getTime()-j,F=M/A,x=JB[p.animationType],T=1-x(Math.min(1,F)),N=1-te,R=ue+o*N,W=O+a*N,U=nR(R,H.positionX,ue,y,f,c,u,G,z,T),Z=nR(W,H.positionY,O,v,f,h,d,ie,Q,T);(ue!==R||O!==W)&&t.setTransformState(q,U,Z)})}}function iR(t,e){var n=t.transformState.scale;Ps(t),Hc(t,n),window.TouchEvent!==void 0&&e instanceof TouchEvent?Vee(t,e):Uee(t,e)}function t$(t){var e=t.transformState.scale,n=t.setup,i=n.minScale,r=n.alignmentAnimation,s=r.disabled,o=r.sizeX,a=r.sizeY,l=r.animationTime,u=r.animationType,c=s||e<i||!o&&!a;if(!c){var d=Hee(t);d&&ol(t,d,l,u)}}function rR(t,e,n){var i=t.startCoords,r=t.setup,s=r.alignmentAnimation,o=s.sizeX,a=s.sizeY;if(i){var l=Wee(t,e,n),u=l.x,c=l.y,d=Ya(t,o),h=Ya(t,a);Yee(t,{x:u,y:c}),e$(t,u,c,d,h)}}function Zee(t){if(t.isPanning){var e=t.setup.panning.velocityDisabled,n=t.velocity,i=t.wrapperComponent,r=t.contentComponent;t.isPanning=!1,t.animate=!1,t.animation=null;var s=i==null?void 0:i.getBoundingClientRect(),o=r==null?void 0:r.getBoundingClientRect(),a=(s==null?void 0:s.width)||0,l=(s==null?void 0:s.height)||0,u=(o==null?void 0:o.width)||0,c=(o==null?void 0:o.height)||0,d=a<u||l<c,h=!e&&n&&(n==null?void 0:n.total)>.1&&d;h?Jee(t):t$(t)}}function nC(t,e,n,i){var r=t.setup,s=r.minScale,o=r.maxScale,a=r.limitToBounds,l=cp(gr(e,2),s,o,0,!1),u=Hc(t,l),c=n0(t,n,i,l,u,a),d=c.x,h=c.y;return{scale:l,positionX:d,positionY:h}}function n$(t,e,n){var i=t.transformState.scale,r=t.wrapperComponent,s=t.setup,o=s.minScale,a=s.limitToBounds,l=s.zoomAnimation,u=l.disabled,c=l.animationTime,d=l.animationType,h=u||i>=o;if((i>=1||a)&&t$(t),!(h||!r||!t.mounted)){var f=e||r.offsetWidth/2,p=n||r.offsetHeight/2,m=nC(t,o,f,p);m&&ol(t,m,c,d)}}var Oa=function(){return Oa=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Oa.apply(this,arguments)};function sR(t,e,n){for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}var wm={previousScale:1,scale:1,positionX:0,positionY:0},Nd={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},K1={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},i$=function(t){var e,n,i,r;return{previousScale:(e=t.initialScale)!==null&&e!==void 0?e:wm.scale,scale:(n=t.initialScale)!==null&&n!==void 0?n:wm.scale,positionX:(i=t.initialPositionX)!==null&&i!==void 0?i:wm.positionX,positionY:(r=t.initialPositionY)!==null&&r!==void 0?r:wm.positionY}},oR=function(t){var e=Oa({},Nd);return Object.keys(t).forEach(function(n){var i=typeof t[n]<"u",r=typeof Nd[n]<"u";if(r&&i){var s=Object.prototype.toString.call(Nd[n]),o=s==="[object Object]",a=s==="[object Array]";o?e[n]=Oa(Oa({},Nd[n]),t[n]):a?e[n]=sR(sR([],Nd[n],!0),t[n]):e[n]=t[n]}}),e},r$=function(t,e,n){var i=t.transformState.scale,r=t.wrapperComponent,s=t.setup,o=s.maxScale,a=s.minScale,l=s.zoomAnimation,u=s.smooth,c=l.size;if(!r)throw new Error("Wrapper is not mounted");var d=u?i*Math.exp(e*n):i+e*n,h=cp(gr(d,3),a,o,c,!1);return h};function s$(t,e,n,i,r){var s=t.wrapperComponent,o=t.transformState,a=o.scale,l=o.positionX,u=o.positionY;if(!s)return console.error("No WrapperComponent found");var c=s.offsetWidth,d=s.offsetHeight,h=(c/2-l)/a,f=(d/2-u)/a,p=r$(t,e,n),m=nC(t,p,h,f);if(!m)return console.error("Error during zoom event. New transformation state was not calculated.");ol(t,m,i,r)}function o$(t,e,n,i){var r=t.setup,s=t.wrapperComponent,o=r.limitToBounds,a=i$(t.props),l=t.transformState,u=l.scale,c=l.positionX,d=l.positionY;if(s){var h=tC(t,a.scale),f=up(a.positionX,a.positionY,h,o,0,0,s),p={scale:a.scale,positionX:f.x,positionY:f.y};u===a.scale&&c===a.positionX&&d===a.positionY||(i==null||i(),ol(t,p,e,n))}}function Qee(t,e,n,i){var r=t.getBoundingClientRect(),s=e.getBoundingClientRect(),o=n.getBoundingClientRect(),a=s.x*i.scale,l=s.y*i.scale;return{x:(r.x-o.x+a)/i.scale,y:(r.y-o.y+l)/i.scale}}function ete(t,e,n){var i=t.wrapperComponent,r=t.contentComponent,s=t.transformState,o=t.setup,a=o.limitToBounds,l=o.minScale,u=o.maxScale;if(!i||!r)return s;var c=i.getBoundingClientRect(),d=e.getBoundingClientRect(),h=Qee(e,i,r,s),f=h.x,p=h.y,m=d.width/s.scale,w=d.height/s.scale,v=i.offsetWidth/m,y=i.offsetHeight/w,b=cp(n||Math.min(v,y),l,u,0,!1),k=(c.width-m*b)/2,_=(c.height-w*b)/2,E=(c.left-f)*b+k,A=(c.top-p)*b+_,P=tC(t,b),I=up(E,A,P,a,0,0,i),D=I.x,B=I.y;return{positionX:D,positionY:B,scale:b}}var tte=function(t){return function(e,n,i){e===void 0&&(e=.5),n===void 0&&(n=300),i===void 0&&(i="easeOut"),s$(t,1,e,n,i)}},nte=function(t){return function(e,n,i){e===void 0&&(e=.5),n===void 0&&(n=300),i===void 0&&(i="easeOut"),s$(t,-1,e,n,i)}},ite=function(t){return function(e,n,i,r,s){r===void 0&&(r=300),s===void 0&&(s="easeOut");var o=t.transformState,a=o.positionX,l=o.positionY,u=o.scale,c=t.wrapperComponent,d=t.contentComponent,h=t.setup.disabled;if(!(h||!c||!d)){var f={positionX:Number.isNaN(e)?a:e,positionY:Number.isNaN(n)?l:n,scale:Number.isNaN(i)?u:i};ol(t,f,r,s)}}},rte=function(t){return function(e,n){e===void 0&&(e=200),n===void 0&&(n="easeOut"),o$(t,e,n)}},ste=function(t){return function(e,n,i){n===void 0&&(n=200),i===void 0&&(i="easeOut");var r=t.transformState,s=t.wrapperComponent,o=t.contentComponent;if(s&&o){var a=a$(e||r.scale,s,o);ol(t,a,n,i)}}},ote=function(t){return function(e,n,i,r){i===void 0&&(i=600),r===void 0&&(r="easeOut"),Ps(t);var s=t.wrapperComponent,o=typeof e=="string"?document.getElementById(e):e;if(s&&o&&s.contains(o)){var a=ete(t,o,n);ol(t,a,i,r)}}},X1=function(t){return{instance:t,zoomIn:tte(t),zoomOut:nte(t),setTransform:ite(t),resetTransform:rte(t),centerView:ste(t),zoomToElement:ote(t)}},ate=function(t){return{instance:t,state:t.transformState}},vt=function(t){var e={};return Object.assign(e,ate(t)),Object.assign(e,X1(t)),e},Gw=!1;function Kw(){try{var t={get passive(){return Gw=!0,!1}};return t}catch{return Gw=!1,Gw}}var bm=".".concat(K1.wrapperClass),i0=function(t,e){return e.some(function(n){return t.matches("".concat(bm," ").concat(n,", ").concat(bm," .").concat(n,", ").concat(bm," ").concat(n," *, ").concat(bm," .").concat(n," *"))})},q1=function(t){t&&clearTimeout(t)},lte=function(t,e,n){return"translate(".concat(t,"px, ").concat(e,"px) scale(").concat(n,")")},a$=function(t,e,n){var i=n.offsetWidth*t,r=n.offsetHeight*t,s=(e.offsetWidth-i)/2,o=(e.offsetHeight-r)/2;return{scale:t,positionX:s,positionY:o}};function ute(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var cte=function(t,e){var n=t.setup.wheel,i=n.disabled,r=n.wheelDisabled,s=n.touchPadDisabled,o=n.excluded,a=t.isInitialized,l=t.isPanning,u=e.target,c=a&&!l&&!i&&u;if(!c||r&&!e.ctrlKey||s&&e.ctrlKey)return!1;var d=i0(u,o);return!d},dte=function(t){return t?t.deltaY<0?1:-1:0};function hte(t,e){var n=dte(t),i=_ee(e,n);return i}function l$(t,e,n){var i=e.getBoundingClientRect(),r=0,s=0;if("clientX"in t)r=(t.clientX-i.left)/n,s=(t.clientY-i.top)/n;else{var o=t.touches[0];r=(o.clientX-i.left)/n,s=(o.clientY-i.top)/n}return(Number.isNaN(r)||Number.isNaN(s))&&console.error("No mouse or touch offset found"),{x:r,y:s}}var fte=function(t,e,n,i,r){var s=t.transformState.scale,o=t.wrapperComponent,a=t.setup,l=a.maxScale,u=a.minScale,c=a.zoomAnimation,d=a.disablePadding,h=c.size,f=c.disabled;if(!o)throw new Error("Wrapper is not mounted");var p=s+e*n,m=i?!1:!f,w=cp(gr(p,3),u,l,h,m&&!d);return w},pte=function(t,e){var n=t.previousWheelEvent,i=t.transformState.scale,r=t.setup,s=r.maxScale,o=r.minScale;return n?i<s||i>o||Math.sign(n.deltaY)!==Math.sign(e.deltaY)||n.deltaY>0&&n.deltaY<e.deltaY||n.deltaY<0&&n.deltaY>e.deltaY||Math.sign(n.deltaY)!==Math.sign(e.deltaY):!1},mte=function(t,e){var n=t.setup.pinch,i=n.disabled,r=n.excluded,s=t.isInitialized,o=e.target,a=s&&!i&&o;if(!a)return!1;var l=i0(o,r);return!l},gte=function(t){var e=t.setup.pinch.disabled,n=t.isInitialized,i=t.pinchStartDistance,r=n&&!e&&i;return!!r},vte=function(t,e,n){var i=n.getBoundingClientRect(),r=t.touches,s=gr(r[0].clientX-i.left,5),o=gr(r[0].clientY-i.top,5),a=gr(r[1].clientX-i.left,5),l=gr(r[1].clientY-i.top,5);return{x:(s+a)/2/e,y:(o+l)/2/e}},u$=function(t){return Math.sqrt(Math.pow(t.touches[0].pageX-t.touches[1].pageX,2)+Math.pow(t.touches[0].pageY-t.touches[1].pageY,2))},yte=function(t,e){var n=t.pinchStartScale,i=t.pinchStartDistance,r=t.setup,s=r.maxScale,o=r.minScale,a=r.zoomAnimation,l=r.disablePadding,u=a.size,c=a.disabled;if(!n||i===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return t.transformState.scale;var d=e/i,h=d*n;return cp(gr(h,2),o,s,u,!c&&!l)},wte=160,bte=100,xte=function(t,e){var n=t.props,i=n.onWheelStart,r=n.onZoomStart;t.wheelStopEventTimer||(Ps(t),Ot(vt(t),e,i),Ot(vt(t),e,r))},Ste=function(t,e){var n=t.props,i=n.onWheel,r=n.onZoom,s=t.contentComponent,o=t.setup,a=t.transformState,l=a.scale,u=o.limitToBounds,c=o.centerZoomedOut,d=o.zoomAnimation,h=o.wheel,f=o.disablePadding,p=o.smooth,m=d.size,w=d.disabled,v=h.step,y=h.smoothStep;if(!s)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var b=hte(e,null),k=p?y*Math.abs(e.deltaY):v,_=fte(t,b,k,!e.ctrlKey);if(l!==_){var E=Hc(t,_),A=l$(e,s,l),P=w||m===0||c||f,I=u&&P,D=n0(t,A.x,A.y,_,E,I),B=D.x,$=D.y;t.previousWheelEvent=e,t.setTransformState(_,B,$),Ot(vt(t),e,i),Ot(vt(t),e,r)}},kte=function(t,e){var n=t.props,i=n.onWheelStop,r=n.onZoomStop;q1(t.wheelAnimationTimer),t.wheelAnimationTimer=setTimeout(function(){t.mounted&&(n$(t,e.x,e.y),t.wheelAnimationTimer=null)},bte);var s=pte(t,e);s&&(q1(t.wheelStopEventTimer),t.wheelStopEventTimer=setTimeout(function(){t.mounted&&(t.wheelStopEventTimer=null,Ot(vt(t),e,i),Ot(vt(t),e,r))},wte))},c$=function(t){for(var e=0,n=0,i=0;i<2;i+=1)e+=t.touches[i].clientX,n+=t.touches[i].clientY;var r=e/2,s=n/2;return{x:r,y:s}},_te=function(t,e){var n=u$(e);t.pinchStartDistance=n,t.lastDistance=n,t.pinchStartScale=t.transformState.scale,t.isPanning=!1;var i=c$(e);t.pinchLastCenterX=i.x,t.pinchLastCenterY=i.y,Ps(t)},Cte=function(t,e){var n=t.contentComponent,i=t.pinchStartDistance,r=t.wrapperComponent,s=t.transformState.scale,o=t.setup,a=o.limitToBounds,l=o.centerZoomedOut,u=o.zoomAnimation,c=o.alignmentAnimation,d=u.disabled,h=u.size;if(!(i===null||!n)){var f=vte(e,s,n);if(!(!Number.isFinite(f.x)||!Number.isFinite(f.y))){var p=u$(e),m=yte(t,p),w=c$(e),v=w.x-(t.pinchLastCenterX||0),y=w.y-(t.pinchLastCenterY||0);if(!(m===s&&v===0&&y===0)){t.pinchLastCenterX=w.x,t.pinchLastCenterY=w.y;var b=Hc(t,m),k=d||h===0||l,_=a&&k,E=n0(t,f.x,f.y,m,b,_),A=E.x,P=E.y;t.pinchMidpoint=f,t.lastDistance=p;var I=c.sizeX,D=c.sizeY,B=Ya(t,I),$=Ya(t,D),J=A+v,z=P+y,G=up(J,z,b,a,B,$,r),Q=G.x,ie=G.y;t.setTransformState(m,Q,ie)}}}},Ete=function(t){var e=t.pinchMidpoint;t.velocity=null,t.lastDistance=null,t.pinchMidpoint=null,t.pinchStartScale=null,t.pinchStartDistance=null,n$(t,e==null?void 0:e.x,e==null?void 0:e.y)},d$=function(t,e){var n=t.props.onZoomStop,i=t.setup.doubleClick.animationTime;q1(t.doubleClickStopEventTimer),t.doubleClickStopEventTimer=setTimeout(function(){t.doubleClickStopEventTimer=null,Ot(vt(t),e,n)},i)},Ate=function(t,e){var n=t.props,i=n.onZoomStart,r=n.onZoom,s=t.setup.doubleClick,o=s.animationTime,a=s.animationType;Ot(vt(t),e,i),o$(t,o,a,function(){return Ot(vt(t),e,r)}),d$(t,e)};function Pte(t,e){return t==="toggle"?e===1?1:-1:t==="zoomOut"?-1:1}function Tte(t,e){var n=t.setup,i=t.doubleClickStopEventTimer,r=t.transformState,s=t.contentComponent,o=r.scale,a=t.props,l=a.onZoomStart,u=a.onZoom,c=n.doubleClick,d=c.disabled,h=c.mode,f=c.step,p=c.animationTime,m=c.animationType;if(!d&&!i){if(h==="reset")return Ate(t,e);if(!s)return console.error("No ContentComponent found");var w=Pte(h,t.transformState.scale),v=r$(t,w,f);if(o!==v){Ot(vt(t),e,l);var y=l$(e,s,o),b=nC(t,v,y.x,y.y);if(!b)return console.error("Error during zoom event. New transformation state was not calculated.");Ot(vt(t),e,u),ol(t,b,p,m),d$(t,e)}}}var Rte=function(t,e){var n=t.isInitialized,i=t.setup,r=t.wrapperComponent,s=i.doubleClick,o=s.disabled,a=s.excluded,l=e.target,u=r==null?void 0:r.contains(l),c=n&&l&&u&&!o;if(!c)return!1;var d=i0(l,a);return!d},Nte=function(){function t(e){var n=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){n.initializeWindowEvents()},this.unmount=function(){n.cleanupWindowEvents()},this.update=function(i){n.props=i,Hc(n,n.transformState.scale),n.setup=oR(i)},this.initializeWindowEvents=function(){var i,r,s=Kw(),o=(i=n.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,a=o==null?void 0:o.defaultView;(r=n.wrapperComponent)===null||r===void 0||r.addEventListener("wheel",n.onWheelPanning,s),a==null||a.addEventListener("mousedown",n.onPanningStart,s),a==null||a.addEventListener("mousemove",n.onPanning,s),a==null||a.addEventListener("mouseup",n.onPanningStop,s),o==null||o.addEventListener("mouseleave",n.clearPanning,s),a==null||a.addEventListener("keyup",n.setKeyUnPressed,s),a==null||a.addEventListener("keydown",n.setKeyPressed,s)},this.cleanupWindowEvents=function(){var i,r,s=Kw(),o=(i=n.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,a=o==null?void 0:o.defaultView;a==null||a.removeEventListener("mousedown",n.onPanningStart,s),a==null||a.removeEventListener("mousemove",n.onPanning,s),a==null||a.removeEventListener("mouseup",n.onPanningStop,s),o==null||o.removeEventListener("mouseleave",n.clearPanning,s),a==null||a.removeEventListener("keyup",n.setKeyUnPressed,s),a==null||a.removeEventListener("keydown",n.setKeyPressed,s),document.removeEventListener("mouseleave",n.clearPanning,s),Ps(n),(r=n.observer)===null||r===void 0||r.disconnect()},this.handleInitializeWrapperEvents=function(i){var r=Kw();i.addEventListener("wheel",n.onWheelZoom,r),i.addEventListener("dblclick",n.onDoubleClick,r),i.addEventListener("touchstart",n.onTouchPanningStart,r),i.addEventListener("touchmove",n.onTouchPanning,r),i.addEventListener("touchend",n.onTouchPanningStop,r)},this.handleInitialize=function(i){var r=n.setup.centerOnInit;n.applyTransformation(),n.onInitCallbacks.forEach(function(s){return s(vt(n))}),r&&(n.setCenter(),n.observer=new ResizeObserver(function(){var s,o=i.offsetWidth,a=i.offsetHeight;(o>0||a>0)&&(n.onInitCallbacks.forEach(function(l){return l(vt(n))}),n.setCenter(),(s=n.observer)===null||s===void 0||s.disconnect())}),setTimeout(function(){var s;(s=n.observer)===null||s===void 0||s.disconnect()},5e3),n.observer.observe(i))},this.onWheelZoom=function(i){var r=n.setup.disabled;if(!r){var s=cte(n,i);if(s){var o=n.isPressingKeys(n.setup.wheel.activationKeys);o&&(xte(n,i),Ste(n,i),kte(n,i))}}},this.onWheelPanning=function(i){var r=n.setup,s=r.disabled,o=r.wheel,a=r.panning;if(!(!n.wrapperComponent||!n.contentComponent||s||!o.wheelDisabled||a.disabled||!a.wheelPanning||i.ctrlKey)){i.preventDefault(),i.stopPropagation();var l=n.transformState,u=l.positionX,c=l.positionY,d=u-i.deltaX,h=c-i.deltaY,f=a.lockAxisX?u:d,p=a.lockAxisY?c:h,m=n.setup.alignmentAnimation,w=m.sizeX,v=m.sizeY,y=Ya(n,w),b=Ya(n,v);f===u&&p===c||e$(n,f,p,y,b)}},this.onPanningStart=function(i){var r=n.setup.disabled,s=n.props.onPanningStart;if(!r){var o=eR(n,i);if(o){var a=n.isPressingKeys(n.setup.panning.activationKeys);a&&(i.button===0&&!n.setup.panning.allowLeftClickPan||i.button===1&&!n.setup.panning.allowMiddleClickPan||i.button===2&&!n.setup.panning.allowRightClickPan||(i.preventDefault(),i.stopPropagation(),Ps(n),iR(n,i),Ot(vt(n),i,s)))}}},this.onPanning=function(i){var r=n.setup.disabled,s=n.props.onPanning;if(!r){var o=tR(n);if(o){var a=n.isPressingKeys(n.setup.panning.activationKeys);a&&(i.preventDefault(),i.stopPropagation(),rR(n,i.clientX,i.clientY),Ot(vt(n),i,s))}}},this.onPanningStop=function(i){var r=n.props.onPanningStop;n.isPanning&&(Zee(n),Ot(vt(n),i,r))},this.onPinchStart=function(i){var r=n.setup.disabled,s=n.props,o=s.onPinchingStart,a=s.onZoomStart;if(!r){var l=mte(n,i);l&&(_te(n,i),Ps(n),Ot(vt(n),i,o),Ot(vt(n),i,a))}},this.onPinch=function(i){var r=n.setup.disabled,s=n.props,o=s.onPinching,a=s.onZoom;if(!r){var l=gte(n);l&&(i.preventDefault(),i.stopPropagation(),Cte(n,i),Ot(vt(n),i,o),Ot(vt(n),i,a))}},this.onPinchStop=function(i){var r=n.props,s=r.onPinchingStop,o=r.onZoomStop;n.pinchStartScale&&(Ete(n),Ot(vt(n),i,s),Ot(vt(n),i,o))},this.onTouchPanningStart=function(i){var r=n.setup.disabled,s=n.props.onPanningStart;if(!r){var o=eR(n,i);if(o){var a=n.lastTouch&&+new Date-n.lastTouch<200;if(!a){n.lastTouch=+new Date,Ps(n);var l=i.touches,u=l.length===1,c=l.length===2;u&&(Ps(n),iR(n,i),Ot(vt(n),i,s)),c&&n.onPinchStart(i)}}}},this.onTouchPanning=function(i){var r=n.setup.disabled,s=n.props.onPanning;if(n.isPanning&&i.touches.length===1){if(r)return;var o=tR(n);if(!o)return;i.preventDefault(),i.stopPropagation();var a=i.touches[0];rR(n,a.clientX,a.clientY),Ot(vt(n),i,s)}else i.touches.length>1&&n.onPinch(i)},this.onTouchPanningStop=function(i){n.onPanningStop(i),n.onPinchStop(i)},this.onDoubleClick=function(i){var r=n.setup.disabled;if(!r){var s=Rte(n,i);s&&Tte(n,i)}},this.clearPanning=function(i){n.isPanning&&n.onPanningStop(i)},this.setKeyPressed=function(i){n.pressedKeys[i.key]=!0},this.setKeyUnPressed=function(i){n.pressedKeys[i.key]=!1},this.isPressingKeys=function(i){return i.length?!!i.find(function(r){return n.pressedKeys[r]}):!0},this.setTransformState=function(i,r,s){var o=n.props.onTransformed;if(!Number.isNaN(i)&&!Number.isNaN(r)&&!Number.isNaN(s)){i!==n.transformState.scale&&(n.transformState.previousScale=n.transformState.scale,n.transformState.scale=i),n.transformState.positionX=r,n.transformState.positionY=s,n.applyTransformation();var a=vt(n);n.onChangeCallbacks.forEach(function(l){return l(a)}),Ot(a,{scale:i,positionX:r,positionY:s},o)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(n.wrapperComponent&&n.contentComponent){var i=a$(n.transformState.scale,n.wrapperComponent,n.contentComponent);n.setTransformState(i.scale,i.positionX,i.positionY)}},this.handleTransformStyles=function(i,r,s){return n.props.customTransform?n.props.customTransform(i,r,s):lte(i,r,s)},this.applyTransformation=function(){if(!(!n.mounted||!n.contentComponent)){var i=n.transformState,r=i.scale,s=i.positionX,o=i.positionY,a=n.handleTransformStyles(s,o,r);n.contentComponent.style.transform=a}},this.getContext=function(){return vt(n)},this.onChange=function(i){return n.onChangeCallbacks.has(i)||n.onChangeCallbacks.add(i),function(){n.onChangeCallbacks.delete(i)}},this.onInit=function(i){return n.onInitCallbacks.has(i)||n.onInitCallbacks.add(i),function(){n.onInitCallbacks.delete(i)}},this.init=function(i,r){n.cleanupWindowEvents(),n.wrapperComponent=i,n.contentComponent=r,Hc(n,n.transformState.scale),n.handleInitializeWrapperEvents(i),n.handleInitialize(r),n.initializeWindowEvents(),n.isInitialized=!0;var s=vt(n);Ot(s,void 0,n.props.onInit)},this.props=e,this.setup=oR(this.props),this.transformState=i$(this.props)}return t}(),iC=fn.createContext(null),Mte=function(t,e){return typeof t=="function"?t(e):t},Ote=fn.forwardRef(function(t,e){var n=S.useRef(new Nte(t)).current,i=Mte(t.children,X1(n));return S.useImperativeHandle(e,function(){return X1(n)},[n]),S.useEffect(function(){n.update(t)},[n,t]),fn.createElement(iC.Provider,{value:n},i)});fn.forwardRef(function(t,e){var n=S.useRef(null),i=S.useContext(iC);return S.useEffect(function(){return i.onChange(function(r){if(n.current){var s=0,o=0;n.current.style.transform=i.handleTransformStyles(s,o,1/r.instance.transformState.scale)}})},[i]),fn.createElement("div",Oa({},t,{ref:ute([n,e])}))});function Ite(t,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n==="top"&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}var Dte=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,aR={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};Ite(Dte);var Lte=function(t){var e=t.children,n=t.wrapperClass,i=n===void 0?"":n,r=t.contentClass,s=r===void 0?"":r,o=t.wrapperStyle,a=t.contentStyle,l=t.wrapperProps,u=l===void 0?{}:l,c=t.contentProps,d=c===void 0?{}:c,h=S.useContext(iC),f=h.init,p=h.cleanupWindowEvents,m=S.useRef(null),w=S.useRef(null);return S.useEffect(function(){var v=m.current,y=w.current;return v!==null&&y!==null&&f&&(f==null||f(v,y)),function(){p==null||p()}},[]),fn.createElement("div",Oa({},u,{ref:m,className:"".concat(K1.wrapperClass," ").concat(aR.wrapper," ").concat(i),style:o}),fn.createElement("div",Oa({},d,{ref:w,className:"".concat(K1.contentClass," ").concat(aR.content," ").concat(s),style:a}),e))};function jte({wrapperRef:t}){const e=mt();return g.jsxs("div",{className:"absolute right-2 top-2 flex flex-col rounded-lg border border-stone-600 bg-stone-900 shadow",children:[g.jsx("button",{className:"m-0.5 flex h-8 w-8 items-center justify-center rounded-t-lg text-white transition-colors hover:enabled:bg-stone-800",onClick:()=>{var n;return(n=t.current)==null?void 0:n.zoomIn()},title:e("control.zoom.in"),children:g.jsx("span",{className:"icon-[lucide--zoom-in] h-4 w-4"})}),g.jsx("hr",{className:"border-stone-600"}),g.jsx("button",{className:"m-0.5 flex h-8 w-8 items-center justify-center rounded-b-lg text-white transition-colors hover:enabled:bg-stone-800",onClick:()=>{var n;return(n=t.current)==null?void 0:n.zoomOut()},title:e("control.zoom.out"),children:g.jsx("span",{className:"icon-[lucide--zoom-out] h-4 w-4"})})]})}function Fte(){const t=mt(),{devices:e}=mn();return e.hasIOBus?g.jsx("div",{className:"absolute left-[500px] top-[525px] z-10 h-[70px] w-[250px] rounded-lg border border-stone-600 bg-stone-900",children:g.jsx("span",{className:"block w-min whitespace-nowrap rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-lg text-white",children:t("computer.chip-select.name")})}):null}function Bte(){const{devices:t}=mn(),e=["M 380 420 H 800",t.hasIOBus&&"M 780 420 V 805",t.hasIOBus&&"M 450 805 H 900",t.hasIOBus&&"M 583 805 V 875"].filter(Boolean).join(" "),n=["M 380 440 H 800",t.hasIOBus&&"M 790 440 V 815",t.hasIOBus&&"M 450 815 H 900",t.hasIOBus&&"M 573 815 V 875"].filter(Boolean).join(" "),i="M 750 545 H 860 V 460";return g.jsxs("svg",{className:"pointer-events-none absolute inset-0 z-[15] h-full w-full",children:[g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:e}),g.jsx(Gt.path,{className:"fill-none stroke-[4px]",strokeLinejoin:"round",d:e,style:ft("bus.rd")}),g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:n}),g.jsx(Gt.path,{className:"fill-none stroke-[4px]",strokeLinejoin:"round",d:n,style:ft("bus.wr")}),t.hasIOBus&&g.jsxs(g.Fragment,{children:[g.jsx(cn,{springs:"bus.iom",d:"M 380 460 H 675 V 525"}),g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:i}),g.jsx(Gt.path,{className:"fill-none stroke-[4px]",strokeLinejoin:"round",d:i,style:ft("bus.mem")})]}),t.pic&&g.jsx(cn,{springs:"bus.pic",d:"M 521 595 V 730 H 450"}),t.timer&&g.jsx(cn,{springs:"bus.timer",d:"M 563 595 V 875"}),t.pio&&g.jsx(cn,{springs:"bus.pio",d:"M 612 595 V 730 H 900"}),t.handshake&&g.jsx(cn,{springs:"bus.handshake",d:"M 635 595 V 730 H 900"}),t.pic&&g.jsxs(g.Fragment,{children:[g.jsx(cn,{springs:"bus.intr",d:"M 110 700 V 470"}),g.jsx(cn,{springs:"bus.inta",d:"M 160 470 V 700"})]}),t.pic&&t.f10&&g.jsx(cn,{springs:"bus.int0",d:"M 145 950 V 900"}),t.pic&&t.timer&&g.jsx(cn,{springs:"bus.int1",d:"M 500 955 H 400 V 900"}),t.pic&&t.handshake&&g.jsx(cn,{springs:"bus.int2",d:"M 930 866 V 1050 H 300 V 900"}),t.preset==="pio-switches-and-leds"&&g.jsxs(g.Fragment,{children:[g.jsx(cn,{springs:"bus.switches->pio",d:"M 1300 768 H 1120"}),g.jsx(cn,{springs:"bus.pio->leds",d:"M 1120 858 H 1300"})]}),t.preset==="pio-printer"&&g.jsxs(g.Fragment,{children:[g.jsx(cn,{springs:"bus.printer.strobe",d:"M 1120 767 H 1250"}),g.jsx(cn,{springs:"bus.printer.busy",d:"M 1250 782 H 1120"}),g.jsx(cn,{springs:"bus.printer.data",d:"M 1120 837 H 1250"})]}),t.preset==="handshake"&&g.jsxs(g.Fragment,{children:[g.jsx(cn,{springs:"bus.printer.strobe",d:"M 1120 767 H 1250"}),g.jsx(cn,{springs:"bus.printer.busy",d:"M 1250 782 H 1120"}),g.jsx(cn,{springs:"bus.printer.data",d:"M 1120 837 H 1250"})]})]})}function cn({d:t,springs:e}){return g.jsxs(g.Fragment,{children:[g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:t}),g.jsx("path",{className:"fill-none stroke-stone-700 stroke-[4px]",strokeLinejoin:"round",d:t}),g.jsx(Gt.path,{d:t,className:"fill-none stroke-red-500 stroke-[4px]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:ft(e)})]})}function $te(){const t=mt(),{devices:e}=mn();return g.jsxs(g.Fragment,{children:[g.jsx(Mi,{className:"left-[384px] top-[403px]",children:"rd"}),g.jsx(Mi,{className:"left-[384px] top-[423px]",children:"wr"}),e.hasIOBus&&g.jsxs(g.Fragment,{children:[g.jsx(Mi,{className:"left-[384px] top-[443px]",children:"io/m"}),g.jsx(Mi,{className:"left-[715px] top-[538px]",children:t("computer.chip-select.mem")})]}),e.pic&&g.jsx(Mi,{className:"left-[510px] top-[573px]",children:t("computer.chip-select.pic")}),e.timer&&g.jsx(Mi,{className:"left-[545px] top-[573px]",children:t("computer.chip-select.timer")}),e.pio&&g.jsx(Mi,{className:"left-[600px] top-[573px]",children:t("computer.chip-select.pio")}),e.handshake&&g.jsx(Mi,{className:"left-[600px] top-[573px]",children:t("computer.chip-select.handshake")}),e.pic&&g.jsxs(g.Fragment,{children:[g.jsx(Mi,{className:"left-[75px] top-[478px]",children:"intr"}),g.jsx(Mi,{className:"left-[125px] top-[478px]",children:"inta"})]}),e.printer&&g.jsxs(g.Fragment,{children:[g.jsx(Mi,{className:"left-[1260px] top-[758px]",children:"strobe"}),g.jsx(Mi,{className:"left-[1260px] top-[773px]",children:"busy"}),g.jsx(Mi,{className:"left-[1260px] top-[828px]",children:"data"})]})]})}function Mi({className:t,children:e}){return g.jsx("span",{className:ze("pointer-events-none absolute z-[15] block font-mono text-xs font-bold tracking-wider text-stone-400",t),children:e})}function zte(){const{devices:t}=mn(),e=["M 699 349 H 800",t.hasIOBus&&"M 725 349 V 770",t.hasIOBus&&"M 450 770 H 900",t.hasIOBus&&"M 618 770 V 875"].filter(Boolean).join(" "),n=["M 687 249 H 800",t.hasIOBus&&"M 765 249 V 790",t.hasIOBus&&"M 450 790 H 900",t.hasIOBus&&"M 598 790 V 875"].filter(Boolean).join(" ");return g.jsxs("svg",{className:"pointer-events-none absolute inset-0 z-[5] h-full w-full",children:[g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[14px]",strokeLinejoin:"round",d:n}),g.jsx(Gt.path,{className:"fill-none stroke-[12px]",strokeLinejoin:"round",d:n,style:ft("bus.data")}),g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[14px]",strokeLinejoin:"round",d:e}),g.jsx(Gt.path,{className:"fill-none stroke-[12px]",strokeLinejoin:"round",d:e,style:ft("bus.address")})]})}function Ute(){return g.jsxs(g.Fragment,{children:[g.jsx(zte,{}),g.jsx(Bte,{}),g.jsx($te,{}),g.jsx(Fte,{})]})}function Vte(){const{devices:t}=mn();if(!t.clock)return null;const e=ft("clock.angle");return g.jsx("div",{className:"absolute left-[520px] top-[930px] z-10 h-12 w-12 rounded-full border border-stone-600 bg-stone-800 p-1 [&_*]:z-20",children:g.jsxs("svg",{viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-full w-full fill-none stroke-white stroke-2",children:[g.jsx("circle",{cx:"12",cy:"12",r:"10"}),g.jsx(Gt.line,{x1:e.to(n=>12+6*Math.sin(n*Math.PI/180)),y1:e.to(n=>12-6*Math.cos(n*Math.PI/180)),x2:12,y2:12})]})})}var rC="Popover",[h$,xoe]=ls(rC,[id]),dp=id(),[Hte,al]=h$(rC),f$=t=>{const{__scopePopover:e,children:n,open:i,defaultOpen:r,onOpenChange:s,modal:o=!1}=t,a=dp(e),l=S.useRef(null),[u,c]=S.useState(!1),[d=!1,h]=Po({prop:i,defaultProp:r,onChange:s});return g.jsx(Vk,{...a,children:g.jsx(Hte,{scope:e,contentId:ja(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:S.useCallback(()=>h(f=>!f),[h]),hasCustomAnchor:u,onCustomAnchorAdd:S.useCallback(()=>c(!0),[]),onCustomAnchorRemove:S.useCallback(()=>c(!1),[]),modal:o,children:n})})};f$.displayName=rC;var p$="PopoverAnchor",Wte=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=al(p$,n),s=dp(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=r;return S.useEffect(()=>(o(),()=>a()),[o,a]),g.jsx(_y,{...s,...i,ref:e})});Wte.displayName=p$;var m$="PopoverTrigger",g$=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=al(m$,n),s=dp(n),o=rt(e,r.triggerRef),a=g.jsx(Fe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":x$(r.open),...i,ref:o,onClick:fe(t.onClick,r.onOpenToggle)});return r.hasCustomAnchor?a:g.jsx(_y,{asChild:!0,...s,children:a})});g$.displayName=m$;var sC="PopoverPortal",[Gte,Kte]=h$(sC,{forceMount:void 0}),v$=t=>{const{__scopePopover:e,forceMount:n,children:i,container:r}=t,s=al(sC,e);return g.jsx(Gte,{scope:e,forceMount:n,children:g.jsx(jo,{present:n||s.open,children:g.jsx(tp,{asChild:!0,container:r,children:i})})})};v$.displayName=sC;var Wc="PopoverContent",y$=S.forwardRef((t,e)=>{const n=Kte(Wc,t.__scopePopover),{forceMount:i=n.forceMount,...r}=t,s=al(Wc,t.__scopePopover);return g.jsx(jo,{present:i||s.open,children:s.modal?g.jsx(Xte,{...r,ref:e}):g.jsx(qte,{...r,ref:e})})});y$.displayName=Wc;var Xte=S.forwardRef((t,e)=>{const n=al(Wc,t.__scopePopover),i=S.useRef(null),r=rt(e,i),s=S.useRef(!1);return S.useEffect(()=>{const o=i.current;if(o)return Gk(o)},[]),g.jsx(Ey,{as:Kl,allowPinchZoom:!0,children:g.jsx(w$,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:fe(t.onCloseAutoFocus,o=>{var a;o.preventDefault(),s.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:fe(t.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,u=a.button===2||l;s.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:fe(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),qte=S.forwardRef((t,e)=>{const n=al(Wc,t.__scopePopover),i=S.useRef(!1),r=S.useRef(!1);return g.jsx(w$,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,s),s.defaultPrevented||(i.current||(a=n.triggerRef.current)==null||a.focus(),s.preventDefault()),i.current=!1,r.current=!1},onInteractOutside:s=>{var l,u;(l=t.onInteractOutside)==null||l.call(t,s),s.defaultPrevented||(i.current=!0,s.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=s.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&r.current&&s.preventDefault()}})}),w$=S.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:r,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:u,onInteractOutside:c,...d}=t,h=al(Wc,n),f=dp(n);return Ok(),g.jsx(xy,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:r,onUnmountAutoFocus:s,children:g.jsx(Qf,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:c,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:u,onDismiss:()=>h.onOpenChange(!1),children:g.jsx(Hk,{"data-state":x$(h.open),role:"dialog",id:h.contentId,...f,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),b$="PopoverClose",Yte=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=al(b$,n);return g.jsx(Fe.button,{type:"button",...i,ref:e,onClick:fe(t.onClick,()=>r.onOpenChange(!1))})});Yte.displayName=b$;var Jte="PopoverArrow",Zte=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=dp(n);return g.jsx(Wk,{...r,...i,ref:e})});Zte.displayName=Jte;function x$(t){return t?"open":"closed"}var Qte=f$,ene=g$,tne=v$,S$=y$;const k$=Qte,_$=ene,oC=S.forwardRef(({className:t,align:e="center",sideOffset:n=4,...i},r)=>g.jsx(tne,{children:g.jsx(S$,{ref:r,align:e,sideOffset:n,className:ze("z-50 w-72 rounded-md border border-stone-600 bg-stone-900 text-white shadow-md outline-none transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...i})}));oC.displayName=S$.displayName;function Hi({name:t,title:e,valueAtom:n,springs:i,emphasis:r=!1,className:s}){const o=mt(),a=Xt(n),l=a.low,c={AX:"AL",BX:"BL",CX:"CL",DX:"DL"}[t]||t;return g.jsxs(k$,{children:[g.jsx(_$,{asChild:!0,children:g.jsxs(Gt.button,{title:e,className:ze("flex w-min cursor-pointer items-center rounded-md border bg-stone-800 px-2 py-1 font-mono leading-none transition-opacity",r?"border-mantis-400 text-lg":"border-stone-600 text-base",s),style:ft(i),children:[g.jsx("span",{className:"mr-2 font-bold",children:c}),g.jsx("span",{className:"rounded bg-stone-900 p-0.5 font-light",children:l.toString("hex")})]})}),g.jsxs(oC,{className:"w-60",children:[g.jsx("p",{className:"px-4 py-2 font-medium text-white",children:e}),g.jsx("hr",{className:"border-stone-600"}),g.jsx("ul",{className:"px-4 py-2 text-sm",children:["hex","bin","uint","int","safe-ascii"].map(d=>g.jsxs("li",{children:[g.jsx("b",{className:"font-medium",children:o(`generics.byte-representation.${d}`)}),":"," ",g.jsx("span",{className:"font-mono text-mantis-400",children:a.toString(d)})]},d))})]})]})}function nne(){const t=Xt(At.FLAGS),e=Xt(Tj),n=t.bit(0),i=t.bit(6),r=t.bit(7),s=t.bit(9),o=t.bit(11);return g.jsxs(g.Fragment,{children:[g.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[g.jsx(Gt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 150 85 H 220",pathLength:1,strokeDasharray:1,style:ft("cpu.alu.operands")}),g.jsx(Gt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 159 145 H 220",pathLength:1,strokeDasharray:1,style:ft("cpu.alu.operands")}),g.jsx(Gt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 272 115 h 28",pathLength:1,strokeDasharray:1,style:ft("cpu.alu.results")}),g.jsx(Gt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 250 145 v 46",pathLength:1,strokeDasharray:1,style:ft("cpu.alu.results")}),g.jsx("path",{d:"M 220 65 v 40 l 17.32 10 l -17.32 10 v 40 l 51.96 -30 v -40 Z",className:"fill-stone-800 stroke-stone-600",strokeLinejoin:"round"})]}),g.jsx(Gt.span,{className:"icon-[lucide--settings] absolute left-[242px] top-[103px] block h-6 w-6 text-stone-300",style:{transform:ft("cpu.alu.cog").rot.to(a=>`rotate(${a*60}deg)`)}}),g.jsx(Gt.span,{className:"absolute left-[260px] top-[50px] flex w-min items-center rounded-md border border-stone-600 px-2 py-1 font-mono leading-none",style:ft("cpu.alu.operation"),children:e}),g.jsxs(Gt.div,{className:"absolute left-[165px] top-[190px] flex w-min items-center gap-1 rounded-md border border-mantis-400 bg-stone-800 px-2 py-1 font-mono leading-none",style:ft("cpu.FLAGS"),children:[g.jsx("span",{className:ze("rounded p-1 font-light",n?"bg-mantis-400":"bg-stone-900"),children:"CF"}),g.jsx("span",{className:ze("rounded p-1 font-light",i?"bg-mantis-400":"bg-stone-900"),children:"ZF"}),g.jsx("span",{className:ze("rounded p-1 font-light",r?"bg-mantis-400":"bg-stone-900"),children:"SF"}),g.jsx("span",{className:ze("rounded p-1 font-light",s?"bg-mantis-400":"bg-stone-900"),children:"IF"}),g.jsx("span",{className:ze("rounded p-1 font-light",o?"bg-mantis-400":"bg-stone-900"),children:"OF"})]})]})}function ine(){const t=mt(),{status:e}=mn(),n=Xt(vs),i=S.useMemo(()=>{if(!("metadata"in n)||n.metadata.operands.length===0)return"";if(n.phase==="fetching-operands"){let s=" __";for(let o=1;o<n.metadata.operands.length;o++)s+=", __";return s}else return" "+n.metadata.operands.join(", ")},[n]),r=S.useMemo(()=>e.type==="running"&&e.waitingForInput?"waiting-for-input":e.type==="stopped"?e.error?"stopped-error":"stopped":n.phase==="stopped"&&n.error?"stopped-error":n.phase,[e,n]);return g.jsxs(g.Fragment,{children:[g.jsx("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:g.jsx(Gt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 205 300 V 320",pathLength:1,strokeDasharray:1,style:ft("cpu.decoder.path")})}),g.jsx("div",{className:"absolute bottom-[172px] left-[30px] flex w-full items-start",children:g.jsx("span",{className:"block w-min whitespace-nowrap rounded-t-lg border border-b-0 border-stone-600 bg-mantis-500 px-2 pb-3 pt-1 text-xs tracking-wide text-white",children:t("computer.cpu.control-unit")})}),g.jsxs("div",{className:"absolute bottom-[30px] left-[30px] flex h-[150px] w-[350px] flex-col items-center rounded-lg border border-stone-600 bg-stone-800",children:[g.jsxs("div",{className:"overflow-hidden rounded-b-lg border border-t-0 border-stone-600 bg-stone-900 px-4",children:[g.jsx("span",{className:"text-sm leading-none",children:t("computer.cpu.decoder")}),g.jsx("div",{className:"my-1 h-1 w-full overflow-hidden rounded-full bg-stone-600",children:g.jsx(Gt.div,{className:"h-full bg-mantis-400",style:{width:ft("cpu.decoder.progress.progress").to(s=>`${s*100}%`),opacity:ft("cpu.decoder.progress.opacity")}})})]}),g.jsx("span",{className:ze("mt-4 w-48 rounded-lg border border-stone-600 py-2 text-center text-sm leading-none transition-colors",r==="stopped-error"?"bg-red-500":r==="waiting-for-input"?"bg-amber-600":r==="int6"||r==="int7"?"bg-blue-600":"bg-stone-900"),children:t(`computer.cpu.status.${r}`)}),g.jsx("div",{className:"mt-4 w-64 overflow-hidden rounded-lg border border-stone-600 bg-stone-900 py-2",children:g.jsx("p",{className:"text-center font-mono",children:!("metadata"in n)||n.phase==="fetching"?g.jsx("span",{className:"italic text-stone-400",children:"???"}):g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"text-mantis-400",children:n.metadata.name}),g.jsx("span",{className:"text-white",children:i})]})})})]})]})}function rne(){const t=mt();return g.jsxs("div",{className:"absolute left-0 top-0 z-10 h-[500px] w-[650px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-3xl text-white",children:t("computer.cpu.name")}),g.jsx(XY,{}),g.jsx(EZ,{}),g.jsx(di,{name:"left",className:"left-[60px] top-[70px]"}),g.jsx(di,{name:"right",className:"left-[60px] top-[130px]"}),g.jsx(di,{name:"result",className:"left-[300px] top-[100px]"}),g.jsx(nne,{}),g.jsx(di,{name:"AX",emphasis:!0,className:"left-[520px] top-[30px]"}),g.jsx(di,{name:"BX",emphasis:!0,className:"left-[520px] top-[70px]"}),g.jsx(di,{name:"CX",emphasis:!0,className:"left-[520px] top-[110px]"}),g.jsx(di,{name:"DX",emphasis:!0,className:"left-[520px] top-[150px]"}),g.jsx(di,{name:"id",className:"left-[520px] top-[190px]"}),g.jsx(di,{name:"MBR",className:"right-[-38px] top-[233px]"}),g.jsx(di,{name:"IR",className:"left-[171px] top-[270px]"}),g.jsx(ine,{}),g.jsx(di,{name:"IP",emphasis:!0,className:"left-[450px] top-[292px]"}),g.jsx(di,{name:"SP",emphasis:!0,className:"left-[450px] top-[332px]"}),g.jsx(di,{name:"ri",className:"left-[450px] top-[372px]"}),g.jsx(di,{name:"MAR",className:"right-[-51px] top-[333px]"})]})}function di({name:t,emphasis:e,className:n}){const i=mt();return g.jsx(Hi,{name:t,valueAtom:At[t],springs:`cpu.${t}`,emphasis:e,title:i("computer.cpu.register",t),className:ze("absolute",n)})}const sne="_pushable_1q0ek_2",one="_front_1q0ek_15",ane="_shadow_1q0ek_20",lne="_edge_1q0ek_52",xm={pushable:sne,front:one,shadow:ane,edge:lne};function une(){const t=mt(),{status:e,dispatch:n,devices:i}=mn();return xo("F10",r=>{r.preventDefault(),i.f10&&n("f10.press")},void 0,[n,i.f10]),i.f10?g.jsx("div",{className:"absolute left-[50px] top-[950px] z-10 flex h-min w-48 flex-col rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:g.jsxs("button",{className:xm.pushable,disabled:e.type!=="running",onClick:()=>n("f10.press"),children:[g.jsx("div",{className:xm.shadow}),g.jsx("div",{className:xm.edge}),g.jsx("span",{className:xm.front,children:t("computer.f10")})]})}):null}function cne(){const t=mt(),{devices:e}=mn();return e.handshake?g.jsxs("div",{className:"absolute left-[900px] top-[700px] z-10 h-min w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.handshake.name")}),g.jsx(Hi,{name:t("computer.handshake.state"),title:t("generics.io-register","STATE",65),valueAtom:O_,springs:"handshake.STATE",className:"mx-auto my-4"}),g.jsx("hr",{className:"border-stone-600"}),g.jsx(Hi,{name:t("computer.handshake.data"),title:t("generics.io-register","DATA",64),valueAtom:M_,springs:"handshake.DATA",className:"mx-auto my-4"})]}):null}var C$={exports:{}};/*!
 * 
 *   react-simple-keyboard v3.7.139 (index.modern.js - Modern Browsers bundle)
 *   https://github.com/hodgef/react-simple-keyboard
 *
 *   NOTE: This modern browsers bundle (index.modern.js) removes all polyfills
 *   included in the standard version. Use this if you are supporting
 *   modern browsers only. Otherwise, use the standard version (index.js).
 *
 *   Copyright (c) Francisco Hodge (https://github.com/hodgef) and project contributors.
 *
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */(function(t,e){(function(n,i){t.exports=i(S)})(Z3,function(n){return function(){var i={651:function(a){a.exports=function(){var l={d:function(O,M){for(var F in M)l.o(M,F)&&!l.o(O,F)&&Object.defineProperty(O,F,{enumerable:!0,get:M[F]})},o:function(O,M){return Object.prototype.hasOwnProperty.call(O,M)},r:function(O){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(O,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(O,"__esModule",{value:!0})}},u={};function c(O){return function(M){if(Array.isArray(M))return h(M)}(O)||function(M){if(typeof Symbol<"u"&&M[Symbol.iterator]!=null||M["@@iterator"]!=null)return Array.from(M)}(O)||d(O)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function d(O,M){if(O){if(typeof O=="string")return h(O,M);var F={}.toString.call(O).slice(8,-1);return F==="Object"&&O.constructor&&(F=O.constructor.name),F==="Map"||F==="Set"?Array.from(O):F==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(F)?h(O,M):void 0}}function h(O,M){(M==null||M>O.length)&&(M=O.length);for(var F=0,x=Array(M);F<M;F++)x[F]=O[F];return x}function f(O){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},f(O)}function p(O,M){for(var F=0;F<M.length;F++){var x=M[F];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(O,w(x.key),x)}}function m(O,M,F){return(M=w(M))in O?Object.defineProperty(O,M,{value:F,enumerable:!0,configurable:!0,writable:!0}):O[M]=F,O}function w(O){var M=function(F,x){if(f(F)!="object"||!F)return F;var T=F[Symbol.toPrimitive];if(T!==void 0){var N=T.call(F,x||"default");if(f(N)!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(F)}(O,"string");return f(M)=="symbol"?M:M+""}l.r(u),l.d(u,{SimpleKeyboard:function(){return q},default:function(){return ue}});var v=function(){return O=function x(T){var N=T.getOptions,R=T.getCaretPosition,W=T.getCaretPositionEnd,U=T.dispatch;(function(Z,K){if(!(Z instanceof K))throw new TypeError("Cannot call a class as a function")})(this,x),m(this,"getOptions",void 0),m(this,"getCaretPosition",void 0),m(this,"getCaretPositionEnd",void 0),m(this,"dispatch",void 0),m(this,"maxLengthReached",void 0),m(this,"isStandardButton",function(Z){return Z&&!(Z[0]==="{"&&Z[Z.length-1]==="}")}),this.getOptions=N,this.getCaretPosition=R,this.getCaretPositionEnd=W,this.dispatch=U,x.bindMethods(x,this)},M=[{key:"getButtonType",value:function(x){return x.includes("{")&&x.includes("}")&&x!=="{//}"?"functionBtn":"standardBtn"}},{key:"getButtonClass",value:function(x){var T=this.getButtonType(x),N=x.replace("{","").replace("}",""),R="";return T!=="standardBtn"&&(R=" hg-button-".concat(N)),"hg-".concat(T).concat(R)}},{key:"getDefaultDiplay",value:function(){return{"{bksp}":"backspace","{backspace}":"backspace","{enter}":"< enter","{shift}":"shift","{shiftleft}":"shift","{shiftright}":"shift","{alt}":"alt","{s}":"shift","{tab}":"tab","{lock}":"caps","{capslock}":"caps","{accept}":"Submit","{space}":" ","{//}":" ","{esc}":"esc","{escape}":"esc","{f1}":"f1","{f2}":"f2","{f3}":"f3","{f4}":"f4","{f5}":"f5","{f6}":"f6","{f7}":"f7","{f8}":"f8","{f9}":"f9","{f10}":"f10","{f11}":"f11","{f12}":"f12","{numpaddivide}":"/","{numlock}":"lock","{arrowup}":"↑","{arrowleft}":"←","{arrowdown}":"↓","{arrowright}":"→","{prtscr}":"print","{scrolllock}":"scroll","{pause}":"pause","{insert}":"ins","{home}":"home","{pageup}":"up","{delete}":"del","{forwarddelete}":"del","{end}":"end","{pagedown}":"down","{numpadmultiply}":"*","{numpadsubtract}":"-","{numpadadd}":"+","{numpadenter}":"enter","{period}":".","{numpaddecimal}":".","{numpad0}":"0","{numpad1}":"1","{numpad2}":"2","{numpad3}":"3","{numpad4}":"4","{numpad5}":"5","{numpad6}":"6","{numpad7}":"7","{numpad8}":"8","{numpad9}":"9"}}},{key:"getButtonDisplayName",value:function(x,T){return(T=arguments.length>2&&arguments[2]!==void 0&&arguments[2]?Object.assign({},this.getDefaultDiplay(),T):T||this.getDefaultDiplay())[x]||x}},{key:"getUpdatedInput",value:function(x,T,N){var R=arguments.length>3&&arguments[3]!==void 0?arguments[3]:N,W=arguments.length>4&&arguments[4]!==void 0&&arguments[4],U=this.getOptions(),Z=[N,R,W],K=T;return(x==="{bksp}"||x==="{backspace}")&&K.length>0?K=this.removeAt.apply(this,[K].concat(Z)):(x==="{delete}"||x==="{forwarddelete}")&&K.length>0?K=this.removeForwardsAt.apply(this,[K].concat(Z)):x==="{space}"?K=this.addStringAt.apply(this,[K," "].concat(Z)):x!=="{tab}"||typeof U.tabCharOnTab=="boolean"&&U.tabCharOnTab===!1?x!=="{enter}"&&x!=="{numpadenter}"||!U.newLineOnEnter?x.includes("numpad")&&Number.isInteger(Number(x[x.length-2]))?K=this.addStringAt.apply(this,[K,x[x.length-2]].concat(Z)):x==="{numpaddivide}"?K=this.addStringAt.apply(this,[K,"/"].concat(Z)):x==="{numpadmultiply}"?K=this.addStringAt.apply(this,[K,"*"].concat(Z)):x==="{numpadsubtract}"?K=this.addStringAt.apply(this,[K,"-"].concat(Z)):x==="{numpadadd}"?K=this.addStringAt.apply(this,[K,"+"].concat(Z)):x==="{numpaddecimal}"?K=this.addStringAt.apply(this,[K,"."].concat(Z)):x==="{"||x==="}"?K=this.addStringAt.apply(this,[K,x].concat(Z)):x.includes("{")||x.includes("}")||(K=this.addStringAt.apply(this,[K,x].concat(Z))):K=this.addStringAt.apply(this,[K,`
`].concat(Z)):K=this.addStringAt.apply(this,[K,"	"].concat(Z)),U.debug&&console.log("Input will be: "+K),K}},{key:"updateCaretPos",value:function(x){var T=arguments.length>1&&arguments[1]!==void 0&&arguments[1],N=this.updateCaretPosAction(x,T);this.dispatch(function(R){R.setCaretPosition(N)})}},{key:"updateCaretPosAction",value:function(x){var T=arguments.length>1&&arguments[1]!==void 0&&arguments[1],N=this.getOptions(),R=this.getCaretPosition();return R!=null&&(T?R>0&&(R-=x):R+=x),N.debug&&console.log("Caret at:",R),R}},{key:"addStringAt",value:function(x,T){var N,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.length,W=arguments.length>3&&arguments[3]!==void 0?arguments[3]:x.length,U=arguments.length>4&&arguments[4]!==void 0&&arguments[4];return R||R===0?(N=[x.slice(0,R),T,x.slice(W)].join(""),this.isMaxLengthReached()||U&&this.updateCaretPos(T.length)):N=x+T,N}},{key:"removeAt",value:function(x){var T,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x.length,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.length,W=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(N===0&&R===0)return x;if(N===R){var U=/([\uD800-\uDBFF][\uDC00-\uDFFF])/g;N&&N>=0?x.substring(N-2,N).match(U)?(T=x.substr(0,N-2)+x.substr(N),W&&this.updateCaretPos(2,!0)):(T=x.substr(0,N-1)+x.substr(N),W&&this.updateCaretPos(1,!0)):x.slice(-2).match(U)?(T=x.slice(0,-2),W&&this.updateCaretPos(2,!0)):(T=x.slice(0,-1),W&&this.updateCaretPos(1,!0))}else T=x.slice(0,N)+x.slice(R),W&&this.dispatch(function(Z){Z.setCaretPosition(N)});return T}},{key:"removeForwardsAt",value:function(x){var T,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x.length,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.length,W=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return x!=null&&x.length&&N!==null?(N===R?T=x.substring(N,N+2).match(/([\uD800-\uDBFF][\uDC00-\uDFFF])/g)?x.substr(0,N)+x.substr(N+2):x.substr(0,N)+x.substr(N+1):(T=x.slice(0,N)+x.slice(R),W&&this.dispatch(function(U){U.setCaretPosition(N)})),T):x}},{key:"handleMaxLength",value:function(x,T){var N=this.getOptions(),R=N.maxLength,W=x[N.inputName||"default"],U=T.length-1>=R;if(T.length<=W.length)return!1;if(Number.isInteger(R))return N.debug&&console.log("maxLength (num) reached:",U),U?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1);if(f(R)==="object"){var Z=T.length-1>=R[N.inputName||"default"];return N.debug&&console.log("maxLength (obj) reached:",Z),Z?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1)}}},{key:"isMaxLengthReached",value:function(){return!!this.maxLengthReached}},{key:"isTouchDevice",value:function(){return"ontouchstart"in window||navigator.maxTouchPoints}},{key:"pointerEventsSupported",value:function(){return!!window.PointerEvent}},{key:"camelCase",value:function(x){return x?x.toLowerCase().trim().split(/[.\-_\s]/g).reduce(function(T,N){return N.length?T+N[0].toUpperCase()+N.slice(1):T}):""}},{key:"chunkArray",value:function(x,T){return c(Array(Math.ceil(x.length/T))).map(function(N,R){return x.slice(T*R,T+T*R)})}},{key:"escapeRegex",value:function(x){return x.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},{key:"getRtlOffset",value:function(x,T){var N=x,R=T.indexOf("‫");return R<x&&R!=-1&&N--,T.indexOf("‬")<x&&R!=-1&&N--,N<0?0:N}}],F=[{key:"bindMethods",value:function(x,T){var N,R=function(U,Z){var K=typeof Symbol<"u"&&U[Symbol.iterator]||U["@@iterator"];if(!K){if(Array.isArray(U)||(K=d(U))||Z){K&&(U=K);var Se=0,Oe=function(){};return{s:Oe,n:function(){return Se>=U.length?{done:!0}:{done:!1,value:U[Se++]}},e:function(he){throw he},f:Oe}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var De,Ne=!0,$e=!1;return{s:function(){K=K.call(U)},n:function(){var he=K.next();return Ne=he.done,he},e:function(he){$e=!0,De=he},f:function(){try{Ne||K.return==null||K.return()}finally{if($e)throw De}}}}(Object.getOwnPropertyNames(x.prototype));try{for(R.s();!(N=R.n()).done;){var W=N.value;W==="constructor"||W==="bindMethods"||(T[W]=T[W].bind(T))}}catch(U){R.e(U)}finally{R.f()}}}],M&&p(O.prototype,M),F&&p(O,F),Object.defineProperty(O,"prototype",{writable:!1}),O;var O,M,F}();m(v,"noop",function(){});var y=v;function b(O){return b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},b(O)}function k(O,M){for(var F=0;F<M.length;F++){var x=M[F];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(O,E(x.key),x)}}function _(O,M,F){return(M=E(M))in O?Object.defineProperty(O,M,{value:F,enumerable:!0,configurable:!0,writable:!0}):O[M]=F,O}function E(O){var M=function(F,x){if(b(F)!="object"||!F)return F;var T=F[Symbol.toPrimitive];if(T!==void 0){var N=T.call(F,x);if(b(N)!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(O,"string");return b(M)=="symbol"?M:M+""}var A=function(){return O=function x(T){var N=this,R=T.dispatch,W=T.getOptions;(function(U,Z){if(!(U instanceof Z))throw new TypeError("Cannot call a class as a function")})(this,x),_(this,"getOptions",void 0),_(this,"dispatch",void 0),_(this,"isModifierKey",function(U){return U.altKey||U.ctrlKey||U.shiftKey||["Tab","CapsLock","Esc","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(U.code||U.key||N.keyCodeToKey(U==null?void 0:U.keyCode))}),this.dispatch=R,this.getOptions=W,y.bindMethods(x,this)},M=[{key:"handleHighlightKeyDown",value:function(x){var T=this.getOptions();T.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(x)&&(x.preventDefault(),x.stopImmediatePropagation());var N=this.getSimpleKeyboardLayoutKey(x);this.dispatch(function(R){var W,U,Z=R.getButtonElement(N),K=R.getButtonElement("{".concat(N,"}"));if(Z)W=Z,U=N;else{if(!K)return;W=K,U="{".concat(N,"}")}var Se,Oe,De,Ne,$e=function(dt){dt.style.background=T.physicalKeyboardHighlightBgColor||"#dadce4",dt.style.color=T.physicalKeyboardHighlightTextColor||"black"};if(W)if(Array.isArray(W)){if(W.forEach(function(dt){return $e(dt)}),T.physicalKeyboardHighlightPress)if(T.physicalKeyboardHighlightPressUsePointerEvents)(Se=W[0])===null||Se===void 0||(Oe=Se.onpointerdown)===null||Oe===void 0||Oe.call(Se,x);else if(T.physicalKeyboardHighlightPressUseClick){var he;(he=W[0])===null||he===void 0||he.click()}else R.handleButtonClicked(U,x)}else $e(W),T.physicalKeyboardHighlightPress&&(T.physicalKeyboardHighlightPressUsePointerEvents?(De=W)===null||De===void 0||(Ne=De.onpointerdown)===null||Ne===void 0||Ne.call(De,x):T.physicalKeyboardHighlightPressUseClick?W.click():R.handleButtonClicked(U,x))})}},{key:"handleHighlightKeyUp",value:function(x){var T=this.getOptions();T.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(x)&&(x.preventDefault(),x.stopImmediatePropagation());var N=this.getSimpleKeyboardLayoutKey(x);this.dispatch(function(R){var W,U,Z,K=R.getButtonElement(N)||R.getButtonElement("{".concat(N,"}")),Se=function(Oe){Oe.removeAttribute&&Oe.removeAttribute("style")};K&&(Array.isArray(K)?(K.forEach(function(Oe){return Se(Oe)}),T.physicalKeyboardHighlightPressUsePointerEvents&&((W=K[0])===null||W===void 0||(U=W.onpointerup)===null||U===void 0||U.call(W,x))):(Se(K),T.physicalKeyboardHighlightPressUsePointerEvents&&(K==null||(Z=K.onpointerup)===null||Z===void 0||Z.call(K,x))))})}},{key:"getSimpleKeyboardLayoutKey",value:function(x){var T,N="",R=x.code||x.key||this.keyCodeToKey(x==null?void 0:x.keyCode);return(N=R!=null&&R.includes("Numpad")||R!=null&&R.includes("Shift")||R!=null&&R.includes("Space")||R!=null&&R.includes("Backspace")||R!=null&&R.includes("Control")||R!=null&&R.includes("Alt")||R!=null&&R.includes("Meta")?x.code||"":x.key||this.keyCodeToKey(x==null?void 0:x.keyCode)||"").length>1?(T=N)===null||T===void 0?void 0:T.toLowerCase():N}},{key:"keyCodeToKey",value:function(x){return{8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Meta",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"NumpadMultiply",107:"NumpadAdd",109:"NumpadSubtract",110:"NumpadDecimal",111:"NumpadDivide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[x]||""}}],M&&k(O.prototype,M),F&&k(O,F),Object.defineProperty(O,"prototype",{writable:!1}),O;var O,M,F}();function P(O){return P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},P(O)}function I(O,M){for(var F=0;F<M.length;F++){var x=M[F];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(O,B(x.key),x)}}function D(O,M,F){return(M=B(M))in O?Object.defineProperty(O,M,{value:F,enumerable:!0,configurable:!0,writable:!0}):O[M]=F,O}function B(O){var M=function(F,x){if(P(F)!="object"||!F)return F;var T=F[Symbol.toPrimitive];if(T!==void 0){var N=T.call(F,x);if(P(N)!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(O,"string");return P(M)=="symbol"?M:M+""}var $=function(){return O=function x(T){var N=T.utilities,R=T.options;(function(W,U){if(!(W instanceof U))throw new TypeError("Cannot call a class as a function")})(this,x),D(this,"utilities",void 0),D(this,"options",void 0),D(this,"candidateBoxElement",void 0),D(this,"pageIndex",0),D(this,"pageSize",void 0),this.utilities=N,this.options=R,y.bindMethods(x,this),this.pageSize=this.utilities.getOptions().layoutCandidatesPageSize||5},M=[{key:"destroy",value:function(){this.candidateBoxElement&&(this.candidateBoxElement.remove(),this.pageIndex=0)}},{key:"show",value:function(x){var T=this,N=x.candidateValue,R=x.targetElement,W=x.onSelect;if(N&&N.length){var U=this.utilities.chunkArray(N.split(" "),this.pageSize);this.renderPage({candidateListPages:U,targetElement:R,pageIndex:this.pageIndex,nbPages:U.length,onItemSelected:function(Z,K){W(Z,K),T.destroy()}})}}},{key:"renderPage",value:function(x){var T,N=this,R=x.candidateListPages,W=x.targetElement,U=x.pageIndex,Z=x.nbPages,K=x.onItemSelected;(T=this.candidateBoxElement)===null||T===void 0||T.remove(),this.candidateBoxElement=document.createElement("div"),this.candidateBoxElement.className="hg-candidate-box";var Se=document.createElement("ul");Se.className="hg-candidate-box-list",R[U].forEach(function(Qt){var dl,us=document.createElement("li"),Uo=function(){var Vo=new(N.options.useTouchEvents?TouchEvent:MouseEvent)("click");return Object.defineProperty(Vo,"target",{value:us}),Vo};us.className="hg-candidate-box-list-item",us.innerHTML=((dl=N.options.display)===null||dl===void 0?void 0:dl[Qt])||Qt,N.options.useTouchEvents?us.ontouchstart=function(Vo){return K(Qt,Vo||Uo())}:us.onclick=function(){var Vo=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Uo();return K(Qt,Vo)},Se.appendChild(us)});var Oe=U>0,De=document.createElement("div");De.classList.add("hg-candidate-box-prev"),Oe&&De.classList.add("hg-candidate-box-btn-active");var Ne=function(){Oe&&N.renderPage({candidateListPages:R,targetElement:W,pageIndex:U-1,nbPages:Z,onItemSelected:K})};this.options.useTouchEvents?De.ontouchstart=Ne:De.onclick=Ne,this.candidateBoxElement.appendChild(De),this.candidateBoxElement.appendChild(Se);var $e=U<Z-1,he=document.createElement("div");he.classList.add("hg-candidate-box-next"),$e&&he.classList.add("hg-candidate-box-btn-active");var dt=function(){$e&&N.renderPage({candidateListPages:R,targetElement:W,pageIndex:U+1,nbPages:Z,onItemSelected:K})};this.options.useTouchEvents?he.ontouchstart=dt:he.onclick=dt,this.candidateBoxElement.appendChild(he),W.prepend(this.candidateBoxElement)}}],M&&I(O.prototype,M),F&&I(O,F),Object.defineProperty(O,"prototype",{writable:!1}),O;var O,M,F}(),J=$;function z(O){return function(M){if(Array.isArray(M))return G(M)}(O)||function(M){if(typeof Symbol<"u"&&M[Symbol.iterator]!=null||M["@@iterator"]!=null)return Array.from(M)}(O)||function(M,F){if(M){if(typeof M=="string")return G(M,F);var x={}.toString.call(M).slice(8,-1);return x==="Object"&&M.constructor&&(x=M.constructor.name),x==="Map"||x==="Set"?Array.from(M):x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x)?G(M,F):void 0}}(O)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function G(O,M){(M==null||M>O.length)&&(M=O.length);for(var F=0,x=Array(M);F<M;F++)x[F]=O[F];return x}function Q(O){return Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},Q(O)}function ie(O,M){var F=Object.keys(O);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(O);M&&(x=x.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),F.push.apply(F,x)}return F}function H(O,M){for(var F=0;F<M.length;F++){var x=M[F];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(O,te(x.key),x)}}function j(O,M,F){return(M=te(M))in O?Object.defineProperty(O,M,{value:F,enumerable:!0,configurable:!0,writable:!0}):O[M]=F,O}function te(O){var M=function(F,x){if(Q(F)!="object"||!F)return F;var T=F[Symbol.toPrimitive];if(T!==void 0){var N=T.call(F,x);if(Q(N)!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(O,"string");return Q(M)=="symbol"?M:M+""}var pe=function(){return O=function x(T,N){var R=this;if(function(Ne,$e){if(!(Ne instanceof $e))throw new TypeError("Cannot call a class as a function")}(this,x),j(this,"input",void 0),j(this,"options",void 0),j(this,"utilities",void 0),j(this,"caretPosition",void 0),j(this,"caretPositionEnd",void 0),j(this,"keyboardDOM",void 0),j(this,"keyboardPluginClasses",void 0),j(this,"keyboardDOMClass",void 0),j(this,"buttonElements",void 0),j(this,"currentInstanceName",void 0),j(this,"allKeyboardInstances",void 0),j(this,"keyboardInstanceNames",void 0),j(this,"isFirstKeyboardInstance",void 0),j(this,"physicalKeyboard",void 0),j(this,"modules",void 0),j(this,"activeButtonClass",void 0),j(this,"holdInteractionTimeout",void 0),j(this,"holdTimeout",void 0),j(this,"isMouseHold",void 0),j(this,"initialized",void 0),j(this,"candidateBox",void 0),j(this,"keyboardRowsDOM",void 0),j(this,"defaultName","default"),j(this,"activeInputElement",null),j(this,"handleParams",function(Ne,$e){var he,dt,Qt;if(typeof Ne=="string")he=Ne.split(".").join(""),dt=document.querySelector(".".concat(he)),Qt=$e;else if(Ne instanceof HTMLDivElement){if(!Ne.className)throw console.warn("Any DOM element passed as parameter must have a class."),new Error("KEYBOARD_DOM_CLASS_ERROR");he=Ne.className.split(" ")[0],dt=Ne,Qt=$e}else he="simple-keyboard",dt=document.querySelector(".".concat(he)),Qt=Ne;return{keyboardDOMClass:he,keyboardDOM:dt,options:Qt}}),j(this,"getOptions",function(){return R.options}),j(this,"getCaretPosition",function(){return R.caretPosition}),j(this,"getCaretPositionEnd",function(){return R.caretPositionEnd}),j(this,"registerModule",function(Ne,$e){R.modules[Ne]||(R.modules[Ne]={}),$e(R.modules[Ne])}),j(this,"getKeyboardClassString",function(){for(var Ne=arguments.length,$e=new Array(Ne),he=0;he<Ne;he++)$e[he]=arguments[he];return[R.keyboardDOMClass].concat($e).filter(function(dt){return!!dt}).join(" ")}),typeof window<"u"){var W=this.handleParams(T,N),U=W.keyboardDOMClass,Z=W.keyboardDOM,K=W.options,Se=K===void 0?{}:K;this.utilities=new y({getOptions:this.getOptions,getCaretPosition:this.getCaretPosition,getCaretPositionEnd:this.getCaretPositionEnd,dispatch:this.dispatch}),this.caretPosition=null,this.caretPositionEnd=null,this.keyboardDOM=Z,this.options=function(Ne){for(var $e=1;$e<arguments.length;$e++){var he=arguments[$e]!=null?arguments[$e]:{};$e%2?ie(Object(he),!0).forEach(function(dt){j(Ne,dt,he[dt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ne,Object.getOwnPropertyDescriptors(he)):ie(Object(he)).forEach(function(dt){Object.defineProperty(Ne,dt,Object.getOwnPropertyDescriptor(he,dt))})}return Ne}({layoutName:"default",theme:"hg-theme-default",inputName:"default",preventMouseDownDefault:!1,enableLayoutCandidates:!0,excludeFromLayout:{}},Se),this.keyboardPluginClasses="",y.bindMethods(x,this);var Oe=this.options.inputName,De=Oe===void 0?this.defaultName:Oe;if(this.input={},this.input[De]="",this.keyboardDOMClass=U,this.buttonElements={},window.SimpleKeyboardInstances||(window.SimpleKeyboardInstances={}),this.currentInstanceName=this.utilities.camelCase(this.keyboardDOMClass),window.SimpleKeyboardInstances[this.currentInstanceName]=this,this.allKeyboardInstances=window.SimpleKeyboardInstances,this.keyboardInstanceNames=Object.keys(window.SimpleKeyboardInstances),this.isFirstKeyboardInstance=this.keyboardInstanceNames[0]===this.currentInstanceName,this.physicalKeyboard=new A({dispatch:this.dispatch,getOptions:this.getOptions}),this.candidateBox=this.options.enableLayoutCandidates?new J({utilities:this.utilities,options:this.options}):null,!this.keyboardDOM)throw console.warn('".'.concat(U,'" was not found in the DOM.')),new Error("KEYBOARD_DOM_ERROR");this.render(),this.modules={},this.loadModules()}},M=[{key:"setCaretPosition",value:function(x){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x;this.caretPosition=x,this.caretPositionEnd=T}},{key:"getInputCandidates",value:function(x){var T=this,N=this.options,R=N.layoutCandidates,W=N.layoutCandidatesCaseSensitiveMatch;if(!R||Q(R)!=="object")return{};var U=Object.keys(R).filter(function(Se){var Oe=x.substring(0,T.getCaretPositionEnd()||0)||x,De=new RegExp("".concat(T.utilities.escapeRegex(Se),"$"),W?"g":"gi");return!!z(Oe.matchAll(De)).length});if(U.length>1){var Z=U.sort(function(Se,Oe){return Oe.length-Se.length})[0];return{candidateKey:Z,candidateValue:R[Z]}}if(U.length){var K=U[0];return{candidateKey:K,candidateValue:R[K]}}return{}}},{key:"showCandidatesBox",value:function(x,T,N){var R=this;this.candidateBox&&this.candidateBox.show({candidateValue:T,targetElement:N,onSelect:function(W,U){var Z=R.options,K=Z.layoutCandidatesCaseSensitiveMatch,Se=Z.disableCandidateNormalization,Oe=Z.enableLayoutCandidatesKeyPress,De=W;Se||(De=W.normalize("NFD")),typeof R.options.beforeInputUpdate=="function"&&R.options.beforeInputUpdate(R);var Ne=R.getInput(R.options.inputName,!0),$e=R.getCaretPositionEnd()||0,he=Ne.substring(0,$e||0)||Ne,dt=new RegExp("".concat(R.utilities.escapeRegex(x),"$"),K?"g":"gi"),Qt=he.replace(dt,De),dl=Ne.replace(he,Qt),us=Qt.length-he.length,Uo=($e||Ne.length)+us;Uo<0&&(Uo=0),R.setInput(dl,R.options.inputName,!0),R.setCaretPosition(Uo),Oe&&typeof R.options.onKeyPress=="function"&&R.options.onKeyPress(W,U),typeof R.options.onChange=="function"&&R.options.onChange(R.getInput(R.options.inputName,!0),U),typeof R.options.onChangeAll=="function"&&R.options.onChangeAll(R.getAllInputs(),U)}})}},{key:"handleButtonClicked",value:function(x,T){var N=this.options,R=N.inputName,W=R===void 0?this.defaultName:R,U=N.debug;if(x!=="{//}"){this.input[W]||(this.input[W]=""),typeof this.options.beforeInputUpdate=="function"&&this.options.beforeInputUpdate(this);var Z=this.utilities.getUpdatedInput(x,this.input[W],this.caretPosition,this.caretPositionEnd);if(this.utilities.isStandardButton(x)&&this.activeInputElement&&this.input[W]&&this.input[W]===Z&&this.caretPosition===0&&this.caretPositionEnd===Z.length)return this.setInput("",this.options.inputName,!0),this.setCaretPosition(0),this.activeInputElement.value="",this.activeInputElement.setSelectionRange(0,0),void this.handleButtonClicked(x,T);if(typeof this.options.onKeyPress=="function"&&this.options.onKeyPress(x,T),this.input[W]!==Z&&(!this.options.inputPattern||this.options.inputPattern&&this.inputPatternIsValid(Z))){if(this.options.maxLength&&this.utilities.handleMaxLength(this.input,Z))return;var K=this.utilities.getUpdatedInput(x,this.input[W],this.caretPosition,this.caretPositionEnd,!0);if(this.setInput(K,this.options.inputName,!0),U&&console.log("Input changed:",this.getAllInputs()),this.options.debug&&console.log("Caret at: ",this.getCaretPosition(),this.getCaretPositionEnd(),"(".concat(this.keyboardDOMClass,")"),T==null?void 0:T.type),this.options.syncInstanceInputs&&this.syncInstanceInputs(),typeof this.options.onChange=="function"&&this.options.onChange(this.getInput(this.options.inputName,!0),T),typeof this.options.onChangeAll=="function"&&this.options.onChangeAll(this.getAllInputs(),T),T!=null&&T.target&&this.options.enableLayoutCandidates){var Se,Oe=this.getInputCandidates(Z),De=Oe.candidateKey,Ne=Oe.candidateValue;De&&Ne?this.showCandidatesBox(De,Ne,this.keyboardDOM):(Se=this.candidateBox)===null||Se===void 0||Se.destroy()}}this.caretPositionEnd&&this.caretPosition!==this.caretPositionEnd&&(this.setCaretPosition(this.caretPositionEnd,this.caretPositionEnd),this.activeInputElement&&this.activeInputElement.setSelectionRange(this.caretPositionEnd,this.caretPositionEnd),this.options.debug&&console.log("Caret position aligned",this.caretPosition)),U&&console.log("Key pressed:",x)}}},{key:"getMouseHold",value:function(){return this.isMouseHold}},{key:"setMouseHold",value:function(x){this.options.syncInstanceInputs?this.dispatch(function(T){T.isMouseHold=x}):this.isMouseHold=x}},{key:"handleButtonMouseDown",value:function(x,T){var N=this;T&&(this.options.preventMouseDownDefault&&T.preventDefault(),this.options.stopMouseDownPropagation&&T.stopPropagation(),T.target.classList.add(this.activeButtonClass)),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdTimeout&&clearTimeout(this.holdTimeout),this.setMouseHold(!0),this.options.disableButtonHold||(this.holdTimeout=window.setTimeout(function(){(N.getMouseHold()&&(!x.includes("{")&&!x.includes("}")||x==="{delete}"||x==="{backspace}"||x==="{bksp}"||x==="{space}"||x==="{tab}")||x==="{arrowright}"||x==="{arrowleft}"||x==="{arrowup}"||x==="{arrowdown}")&&(N.options.debug&&console.log("Button held:",x),N.handleButtonHold(x)),clearTimeout(N.holdTimeout)},500))}},{key:"handleButtonMouseUp",value:function(x,T){var N=this;T&&(this.options.preventMouseUpDefault&&T.preventDefault&&T.preventDefault(),this.options.stopMouseUpPropagation&&T.stopPropagation&&T.stopPropagation(),!(T.target===this.keyboardDOM||T.target&&this.keyboardDOM.contains(T.target)||this.candidateBox&&this.candidateBox.candidateBoxElement&&(T.target===this.candidateBox.candidateBoxElement||T.target&&this.candidateBox.candidateBoxElement.contains(T.target)))&&this.candidateBox&&this.candidateBox.destroy()),this.recurseButtons(function(R){R.classList.remove(N.activeButtonClass)}),this.setMouseHold(!1),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),x&&typeof this.options.onKeyReleased=="function"&&this.options.onKeyReleased(x,T)}},{key:"handleKeyboardContainerMouseDown",value:function(x){this.options.preventMouseDownDefault&&x.preventDefault()}},{key:"handleButtonHold",value:function(x){var T=this;this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdInteractionTimeout=window.setTimeout(function(){T.getMouseHold()?(T.handleButtonClicked(x),T.handleButtonHold(x)):clearTimeout(T.holdInteractionTimeout)},100)}},{key:"syncInstanceInputs",value:function(){var x=this;this.dispatch(function(T){T.replaceInput(x.input),T.setCaretPosition(x.caretPosition,x.caretPositionEnd)})}},{key:"clearInput",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName;this.input[x]="",this.setCaretPosition(0),this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"getInput",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName,T=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.options.syncInstanceInputs&&!T&&this.syncInstanceInputs(),this.options.rtl?"‫"+this.input[x].replace("‫","").replace("‬","")+"‬":this.input[x]}},{key:"getAllInputs",value:function(){var x=this,T={};return Object.keys(this.input).forEach(function(N){T[N]=x.getInput(N,!0)}),T}},{key:"setInput",value:function(x){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.inputName||this.defaultName,N=arguments.length>2?arguments[2]:void 0;this.input[T]=x,!N&&this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"replaceInput",value:function(x){this.input=x}},{key:"setOptions",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},T=this.changedOptions(x);this.options=Object.assign(this.options,x),T.length&&(this.options.debug&&console.log("changedOptions",T),this.onSetOptions(T),this.render())}},{key:"changedOptions",value:function(x){var T=this;return Object.keys(x).filter(function(N){return JSON.stringify(x[N])!==JSON.stringify(T.options[N])})}},{key:"onSetOptions",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];x.includes("layoutName")&&this.candidateBox&&this.candidateBox.destroy(),(x.includes("layoutCandidatesPageSize")||x.includes("layoutCandidates"))&&this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=new J({utilities:this.utilities,options:this.options}))}},{key:"resetRows",value:function(){this.keyboardRowsDOM&&this.keyboardRowsDOM.remove(),this.keyboardDOM.className=this.keyboardDOMClass,this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.buttonElements={}}},{key:"dispatch",value:function(x){if(!window.SimpleKeyboardInstances)throw console.warn("SimpleKeyboardInstances is not defined. Dispatch cannot be called."),new Error("INSTANCES_VAR_ERROR");return Object.keys(window.SimpleKeyboardInstances).forEach(function(T){x(window.SimpleKeyboardInstances[T],T)})}},{key:"addButtonTheme",value:function(x,T){var N=this;T&&x&&(x.split(" ").forEach(function(R){T.split(" ").forEach(function(W){N.options.buttonTheme||(N.options.buttonTheme=[]);var U=!1;N.options.buttonTheme.map(function(Z){if(Z!=null&&Z.class.split(" ").includes(W)){U=!0;var K=Z.buttons.split(" ");K.includes(R)||(U=!0,K.push(R),Z.buttons=K.join(" "))}return Z}),U||N.options.buttonTheme.push({class:W,buttons:x})})}),this.render())}},{key:"removeButtonTheme",value:function(x,T){var N=this;if(!x&&!T)return this.options.buttonTheme=[],void this.render();x&&Array.isArray(this.options.buttonTheme)&&this.options.buttonTheme.length&&(x.split(" ").forEach(function(R){var W;(W=N.options)===null||W===void 0||(W=W.buttonTheme)===null||W===void 0||W.map(function(U,Z){if(U&&T&&T.includes(U.class)||!T){var K,Se,Oe=(K=U)===null||K===void 0?void 0:K.buttons.split(" ").filter(function(De){return De!==R});U&&Oe!=null&&Oe.length?U.buttons=Oe.join(" "):((Se=N.options.buttonTheme)===null||Se===void 0||Se.splice(Z,1),U=null)}return U})}),this.render())}},{key:"getButtonElement",value:function(x){var T,N=this.buttonElements[x];return N&&(T=N.length>1?N:N[0]),T}},{key:"inputPatternIsValid",value:function(x){var T,N=this.options.inputPattern;if((T=N instanceof RegExp?N:N[this.options.inputName||this.defaultName])&&x){var R=T.test(x);return this.options.debug&&console.log('inputPattern ("'.concat(T,'"): ').concat(R?"passed":"did not pass!")),R}return!0}},{key:"setEventListeners",value:function(){if(this.isFirstKeyboardInstance||!this.allKeyboardInstances){this.options.debug&&console.log("Caret handling started (".concat(this.keyboardDOMClass,")"));var x=this.options.physicalKeyboardHighlightPreventDefault,T=x!==void 0&&x;document.addEventListener("keyup",this.handleKeyUp,T),document.addEventListener("keydown",this.handleKeyDown,T),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchend",this.handleTouchEnd),document.addEventListener("selectionchange",this.handleSelectionChange),document.addEventListener("select",this.handleSelect)}}},{key:"handleKeyUp",value:function(x){this.caretEventHandler(x),this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyUp(x)}},{key:"handleKeyDown",value:function(x){this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyDown(x)}},{key:"handleMouseUp",value:function(x){this.caretEventHandler(x)}},{key:"handleTouchEnd",value:function(x){this.caretEventHandler(x)}},{key:"handleSelect",value:function(x){this.caretEventHandler(x)}},{key:"handleSelectionChange",value:function(x){navigator.userAgent.includes("Firefox")||this.caretEventHandler(x)}},{key:"caretEventHandler",value:function(x){var T,N=this;x.target.tagName&&(T=x.target.tagName.toLowerCase()),this.dispatch(function(R){var W=x.target===R.keyboardDOM||x.target&&R.keyboardDOM.contains(x.target);if(N.options.syncInstanceInputs&&Array.isArray(x.path)&&(W=x.path.some(function(K){var Se;return K==null||(Se=K.hasAttribute)===null||Se===void 0?void 0:Se.call(K,"data-skInstance")})),(T==="textarea"||T==="input"&&["text","search","url","tel","password"].includes(x.target.type))&&!R.options.disableCaretPositioning){var U=x.target.selectionStart,Z=x.target.selectionEnd;R.options.rtl&&(U=R.utilities.getRtlOffset(U,R.getInput()),Z=R.utilities.getRtlOffset(Z,R.getInput())),R.setCaretPosition(U,Z),R.activeInputElement=x.target,R.options.debug&&console.log("Caret at: ",R.getCaretPosition(),R.getCaretPositionEnd(),x&&x.target.tagName.toLowerCase(),"(".concat(R.keyboardDOMClass,")"),x==null?void 0:x.type)}else!R.options.disableCaretPositioning&&W||(x==null?void 0:x.type)==="selectionchange"||(R.setCaretPosition(null),R.activeInputElement=null,R.options.debug&&console.log('Caret position reset due to "'.concat(x==null?void 0:x.type,'" event'),x))})}},{key:"recurseButtons",value:function(x){var T=this;x&&Object.keys(this.buttonElements).forEach(function(N){return T.buttonElements[N].forEach(x)})}},{key:"destroy",value:function(){this.options.debug&&console.log("Destroying simple-keyboard instance: ".concat(this.currentInstanceName));var x=this.options.physicalKeyboardHighlightPreventDefault,T=x!==void 0&&x;document.removeEventListener("keyup",this.handleKeyUp,T),document.removeEventListener("keydown",this.handleKeyDown,T),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchend",this.handleTouchEnd),document.removeEventListener("select",this.handleSelect),document.removeEventListener("selectionchange",this.handleSelectionChange),document.onpointerup=null,document.ontouchend=null,document.ontouchcancel=null,document.onmouseup=null,this.recurseButtons(function(N){N&&(N.onpointerdown=null,N.onpointerup=null,N.onpointercancel=null,N.ontouchstart=null,N.ontouchend=null,N.ontouchcancel=null,N.onclick=null,N.onmousedown=null,N.onmouseup=null,N.remove(),N=null)}),this.keyboardDOM.onpointerdown=null,this.keyboardDOM.ontouchstart=null,this.keyboardDOM.onmousedown=null,this.resetRows(),this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=null),this.activeInputElement=null,this.keyboardDOM.removeAttribute("data-skInstance"),this.keyboardDOM.innerHTML="",window.SimpleKeyboardInstances[this.currentInstanceName]=null,delete window.SimpleKeyboardInstances[this.currentInstanceName],this.initialized=!1}},{key:"getButtonThemeClasses",value:function(x){var T=this.options.buttonTheme,N=[];return Array.isArray(T)&&T.forEach(function(R){if(R&&R.class&&typeof R.class=="string"&&R.buttons&&typeof R.buttons=="string"){var W=R.class.split(" ");R.buttons.split(" ").includes(x)&&(N=[].concat(z(N),z(W)))}else console.warn('Incorrect "buttonTheme". Please check the documentation.',R)}),N}},{key:"setDOMButtonAttributes",value:function(x,T){var N=this.options.buttonAttributes;Array.isArray(N)&&N.forEach(function(R){R.attribute&&typeof R.attribute=="string"&&R.value&&typeof R.value=="string"&&R.buttons&&typeof R.buttons=="string"?R.buttons.split(" ").includes(x)&&T(R.attribute,R.value):console.warn('Incorrect "buttonAttributes". Please check the documentation.',R)})}},{key:"onTouchDeviceDetected",value:function(){this.processAutoTouchEvents(),this.disableContextualWindow()}},{key:"disableContextualWindow",value:function(){window.oncontextmenu=function(x){if(x.target.classList.contains("hg-button"))return x.preventDefault(),x.stopPropagation(),!1}}},{key:"processAutoTouchEvents",value:function(){this.options.autoUseTouchEvents&&(this.options.useTouchEvents=!0,this.options.debug&&console.log("autoUseTouchEvents: Touch device detected, useTouchEvents enabled."))}},{key:"onInit",value:function(){this.options.debug&&console.log("".concat(this.keyboardDOMClass," Initialized")),this.setEventListeners(),typeof this.options.onInit=="function"&&this.options.onInit(this)}},{key:"beforeFirstRender",value:function(){this.utilities.isTouchDevice()&&this.onTouchDeviceDetected(),typeof this.options.beforeFirstRender=="function"&&this.options.beforeFirstRender(this),this.isFirstKeyboardInstance&&this.utilities.pointerEventsSupported()&&!this.options.useTouchEvents&&!this.options.useMouseEvents&&this.options.debug&&console.log("Using PointerEvents as it is supported by this browser"),this.options.useTouchEvents&&this.options.debug&&console.log("useTouchEvents has been enabled. Only touch events will be used.")}},{key:"beforeRender",value:function(){typeof this.options.beforeRender=="function"&&this.options.beforeRender(this)}},{key:"onRender",value:function(){typeof this.options.onRender=="function"&&this.options.onRender(this)}},{key:"onModulesLoaded",value:function(){typeof this.options.onModulesLoaded=="function"&&this.options.onModulesLoaded(this)}},{key:"loadModules",value:function(){var x=this;Array.isArray(this.options.modules)&&(this.options.modules.forEach(function(T){var N=new T(x);N.init&&N.init(x)}),this.keyboardPluginClasses="modules-loaded",this.render(),this.onModulesLoaded())}},{key:"getModuleProp",value:function(x,T){return!!this.modules[x]&&this.modules[x][T]}},{key:"getModulesList",value:function(){return Object.keys(this.modules)}},{key:"parseRowDOMContainers",value:function(x,T,N,R){var W=this,U=Array.from(x.children),Z=0;return U.length&&N.forEach(function(K,Se){var Oe=R[Se];if(!(Oe&&Oe>K))return!1;var De=K-Z,Ne=Oe-Z,$e=document.createElement("div");$e.className+="hg-button-container";var he="".concat(W.options.layoutName,"-r").concat(T,"c").concat(Se);$e.setAttribute("data-skUID",he);var dt=U.splice(De,Ne-De+1);Z=Ne-De,dt.forEach(function(Qt){return $e.appendChild(Qt)}),U.splice(De,0,$e),x.innerHTML="",U.forEach(function(Qt){return x.appendChild(Qt)}),W.options.debug&&console.log("rowDOMContainer",dt,De,Ne,Z+1)}),x}},{key:"render",value:function(){var x=this;this.resetRows(),this.initialized||this.beforeFirstRender(),this.beforeRender();var T="hg-layout-".concat(this.options.layoutName),N=this.options.layout||{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]},R=this.options.useTouchEvents||!1,W=R?"hg-touch-events":"",U=this.options.useMouseEvents||!1,Z=this.options.disableRowButtonContainers;this.keyboardDOM.className=this.getKeyboardClassString(this.options.theme,T,this.keyboardPluginClasses,W),this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.keyboardRowsDOM=document.createElement("div"),this.keyboardRowsDOM.className="hg-rows",N[this.options.layoutName||this.defaultName].forEach(function(K,Se){var Oe=K.split(" ");x.options.excludeFromLayout&&x.options.excludeFromLayout[x.options.layoutName||x.defaultName]&&(Oe=Oe.filter(function(he){return x.options.excludeFromLayout&&!x.options.excludeFromLayout[x.options.layoutName||x.defaultName].includes(he)}));var De=document.createElement("div");De.className+="hg-row";var Ne=[],$e=[];Oe.forEach(function(he,dt){var Qt,dl=!Z&&typeof he=="string"&&he.length>1&&he.indexOf("[")===0,us=!Z&&typeof he=="string"&&he.length>1&&he.indexOf("]")===he.length-1;dl&&(Ne.push(dt),he=he.replace(/\[/g,"")),us&&($e.push(dt),he=he.replace(/\]/g,""));var Uo=x.utilities.getButtonClass(he),Vo=x.utilities.getButtonDisplayName(he,x.options.display,x.options.mergeDisplay),G3=x.options.useButtonTag?"button":"div",gn=document.createElement(G3);gn.className+="hg-button ".concat(Uo),(Qt=gn.classList).add.apply(Qt,z(x.getButtonThemeClasses(he))),x.setDOMButtonAttributes(he,function(zt,X3){gn.setAttribute(zt,X3)}),x.activeButtonClass="hg-activeButton",!x.utilities.pointerEventsSupported()||R||U?R?(gn.ontouchstart=function(zt){x.handleButtonClicked(he,zt),x.handleButtonMouseDown(he,zt)},gn.ontouchend=function(zt){x.handleButtonMouseUp(he,zt)},gn.ontouchcancel=function(zt){x.handleButtonMouseUp(he,zt)}):(gn.onclick=function(zt){x.setMouseHold(!1),typeof x.options.onKeyReleased!="function"&&x.handleButtonClicked(he,zt)},gn.onmousedown=function(zt){typeof x.options.onKeyReleased!="function"||x.isMouseHold||x.handleButtonClicked(he,zt),x.handleButtonMouseDown(he,zt)},gn.onmouseup=function(zt){x.handleButtonMouseUp(he,zt)}):(gn.onpointerdown=function(zt){x.handleButtonClicked(he,zt),x.handleButtonMouseDown(he,zt)},gn.onpointerup=function(zt){x.handleButtonMouseUp(he,zt)},gn.onpointercancel=function(zt){x.handleButtonMouseUp(he,zt)}),gn.setAttribute("data-skBtn",he);var K3="".concat(x.options.layoutName,"-r").concat(Se,"b").concat(dt);gn.setAttribute("data-skBtnUID",K3);var PC=document.createElement("span");PC.innerHTML=Vo,gn.appendChild(PC),x.buttonElements[he]||(x.buttonElements[he]=[]),x.buttonElements[he].push(gn),De.appendChild(gn)}),De=x.parseRowDOMContainers(De,Se,Ne,$e),x.keyboardRowsDOM.appendChild(De)}),this.keyboardDOM.appendChild(this.keyboardRowsDOM),this.onRender(),this.initialized||(this.initialized=!0,!this.utilities.pointerEventsSupported()||R||U?R?(document.ontouchend=function(K){return x.handleButtonMouseUp(void 0,K)},document.ontouchcancel=function(K){return x.handleButtonMouseUp(void 0,K)},this.keyboardDOM.ontouchstart=function(K){return x.handleKeyboardContainerMouseDown(K)}):R||(document.onmouseup=function(K){return x.handleButtonMouseUp(void 0,K)},this.keyboardDOM.onmousedown=function(K){return x.handleKeyboardContainerMouseDown(K)}):(document.onpointerup=function(K){return x.handleButtonMouseUp(void 0,K)},this.keyboardDOM.onpointerdown=function(K){return x.handleKeyboardContainerMouseDown(K)}),this.onInit())}}],M&&H(O.prototype,M),F&&H(O,F),Object.defineProperty(O,"prototype",{writable:!1}),O;var O,M,F}(),q=pe,ue=q;return u}()},442:function(a){a.exports=n}},r={};function s(a){var l=r[a];if(l!==void 0)return l.exports;var u=r[a]={exports:{}};return i[a].call(u.exports,u,u.exports,s),u.exports}s.n=function(a){var l=a&&a.__esModule?function(){return a.default}:function(){return a};return s.d(l,{a:l}),l},s.d=function(a,l){for(var u in l)s.o(l,u)&&!s.o(a,u)&&Object.defineProperty(a,u,{enumerable:!0,get:l[u]})},s.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)},s.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var o={};return function(){s.r(o),s.d(o,{KeyboardReact:function(){return m},default:function(){return w}});var a=s(442);function l(v){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},l(v)}function u(v,y){var b=Object.keys(v);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(v);y&&(k=k.filter(function(_){return Object.getOwnPropertyDescriptor(v,_).enumerable})),b.push.apply(b,k)}return b}function c(v){for(var y=1;y<arguments.length;y++){var b=arguments[y]!=null?arguments[y]:{};y%2?u(Object(b),!0).forEach(function(k){d(v,k,b[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(b)):u(Object(b)).forEach(function(k){Object.defineProperty(v,k,Object.getOwnPropertyDescriptor(b,k))})}return v}function d(v,y,b){return(y=function(k){var _=function(E,A){if(l(E)!="object"||!E)return E;var P=E[Symbol.toPrimitive];if(P!==void 0){var I=P.call(E,A||"default");if(l(I)!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(E)}(k,"string");return l(_)=="symbol"?_:_+""}(y))in v?Object.defineProperty(v,y,{value:b,enumerable:!0,configurable:!0,writable:!0}):v[y]=b,v}var h=function(v){return c(c({},v),{},{keyboardRef:null})},f=s(651),p=s.n(f),m=function(v){var y=v.baseClass||"react-simple-keyboard",b=a.useRef(null),k=a.useRef(null),_=a.useRef(null),E=a.useRef(v);return a.useEffect(function(){return function(){_.current&&_.current.destroy(),b.current=!1}},[]),a.useEffect(function(){var A=function($){return c(c({},$),{},{theme:"simple-keyboard ".concat($.theme||"hg-theme-default")})}(v);if(!b.current){b.current=!0,A.debug&&console.log("ReactSimpleKeyboard: Init");var P=k.current,I=".".concat(y);_.current=new(p())(P||I,A),A.keyboardRef&&A.keyboardRef(_.current)}var D=function($,J){var z=h(J),G=h($);return Object.keys(z).filter(function(Q){return z[Q]!==G[Q]})}(E.current,A);if(D.length){var B=_.current;E.current=A,B==null||B.setOptions(A),A.debug&&console.log("ReactSimpleKeyboard - setOptions called due to updated props:",D)}},[b,y,E,v]),a.createElement("div",{className:y,ref:k})},w=m}(),o}()})})(C$);var dne=C$.exports;const hne=Yc(dne),fne={en:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shiftleft} z x c v b n m , . / {shiftright}","{space}"],"en-shift":["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shiftleft} Z X C V B N M < > ? {shiftright}","{space}"],es:["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w e r t y u i o p ́ +","{lock} a s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W E R T Y U I O P ̈ *","{lock} A S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"],"es-accent":["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w é r t y ú í ó p ́ +","{lock} á s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-accent-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W É R T Y Ú Í Ó P ̈ *","{lock} Á S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"],"es-diaeresis-default":["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w e r t y ü i o p ́ +","{lock} a s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-diaeresis-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W E R T Y Ü I O P ̈ *","{lock} A S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"]},pne={en:{"{bksp}":"Backspace ⌫","{enter}":"Enter ↵","{shiftleft}":"Shift ⇧","{shiftright}":"Shift ⇧","{tab}":"Tab ⇥","{lock}":"Caps Lock ⇪","{space}":"Space"},es:{"{bksp}":"⌫","{enter}":"Intro ↵","{shiftleft}":"Shift ⇧","{shiftright}":"Shift ⇧","{tab}":"Tab ⇥","{lock}":"Bloq Mayús ⇪","{space}":"Espacio"}},lR="Á É Í Ó Ú á é í ó ú ́",uR="Ü ü ̈";function mne(){const t=r_(),e=mt(),{status:n,dispatch:i,devices:r}=mn(),[s,o]=S.useState("none"),[a,l]=S.useState(!1),[u,c]=S.useState(!1),d=S.useMemo(()=>[t,t==="es"&&(a&&"accent"||u&&"diaeresis"),s!=="none"&&"shift"].filter(Boolean).join("-"),[t,s,a,u]),h=S.useCallback(f=>{r.keyboard&&n.type==="running"&&n.waitingForInput&&i("keyboard.sendChar",f)},[n,i,r.keyboard]);return r.keyboard?g.jsxs("div",{className:"absolute left-[1200px] top-[300px] z-10 h-min w-[500px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-xl text-white",children:e("computer.keyboard")}),g.jsx(hne,{theme:ze("hg-theme-vonsim",`hg-shift-${s}`,a&&"hg-accentDeadKey",u&&"hg-diaeresisDeadKey"),layoutName:d,layout:fne,display:pne[t],buttonTheme:[{class:"hg-accentDeadKeyButton",buttons:lR},{class:"hg-diaeresisDeadKeyButton",buttons:uR}],disableButtonHold:!0,onKeyPress:f=>{if(f==="{shiftleft}"||f==="{shiftright}"){o(p=>p==="none"?"once":"none");return}if(f==="{lock}"){o(p=>p==="none"?"lock":"none");return}if(t==="es"){if(a){lR.includes(f)&&(l(!1),s==="once"&&o("none"),h(f));return}else if(f==="́"){l(!0);return}if(u){uR.includes(f)&&(c(!1),s==="once"&&o("none"),h(f));return}else if(f==="̈"){c(!0);return}}s==="once"&&o("none"),h(f==="{bksp}"?"\b":f==="{enter}"?`
`:f==="{tab}"?"	":f==="{space}"?" ":f)}})]}):null}function gne(){const t=mt(),{devices:e}=mn(),n=Xt(I_).toArray();return e.leds?g.jsxs("div",{className:"absolute left-[1300px] top-[828px] z-10 h-min w-min rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.leds")}),g.jsx("div",{className:"flex flex-row-reverse gap-2 p-4",children:n.map((i,r)=>g.jsx("div",{className:ze("relative h-7 w-7 rounded-full transition",i?"bg-mantis-400":"bg-stone-700 shadow-inner shadow-stone-900"),children:g.jsx("div",{className:ze("absolute inset-0 rounded-full bg-mantis-400 blur-sm transition",i?"opacity-100":"opacity-0")})},r))})]}):null}const E$=S.forwardRef(({className:t,type:e,...n},i)=>g.jsx("input",{type:e,className:ze("flex h-10 w-full rounded-md border border-stone-600 bg-stone-900 px-3 py-2 text-sm ring-offset-stone-900 file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-stone-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:i,...n}));E$.displayName="Input";var vne="Label",A$=S.forwardRef((t,e)=>g.jsx(Fe.label,{...t,ref:e,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=t.onMouseDown)==null||r.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));A$.displayName=vne;var P$=A$;const T$=S.forwardRef(({className:t,...e},n)=>g.jsx(P$,{ref:n,className:ze("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...e}));T$.displayName=P$.displayName;function yne(){const t=mt(),e=Xt(OZ),n=Math.ceil(e.length/2),i=Xt(Uc),[r,s]=ed(OF),o=S.useId(),[a,l]=S.useState(""),u=S.useCallback(()=>{const h=/^([\da-f]+)h?$/i.exec(a);if(!h||!h[1]){xn({title:t("computer.memory.address-must-be-integer"),variant:"error"});return}let f=parseInt(h[1],16);if(f===ye.MAX_ADDRESS+1)f-=1;else if(!ye.inRange(f)){xn({title:t("computer.memory.address-out-of-range"),variant:"error"});return}s(ye.from(f))},[t,a,s]),c=S.useCallback(()=>{try{let f=(r??i).value+e.length;f===ye.MAX_ADDRESS+1&&(f-=1);const p=ye.from(f);l(p.toString()),s(p)}catch{console.error("Invalid PageUp")}},[i,r,s,e.length]);xo("PageUp",h=>{h.preventDefault(),c()},void 0,[c]);const d=S.useCallback(()=>{try{const h=r??i,f=ye.from(h.value-e.length);l(f.toString()),s(f)}catch{console.error("Invalid PageUp")}},[i,r,s,e.length]);return xo("PageDown",h=>{h.preventDefault(),d()},void 0,[c]),g.jsxs("div",{className:"absolute left-[800px] top-0 z-10 h-[460px] w-[250px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-3xl text-white",children:t("computer.memory.name")}),g.jsxs("div",{className:"mx-4 my-2",children:[g.jsx(T$,{htmlFor:o,children:t("computer.memory.fix-address")}),g.jsxs("div",{className:"mt-1 flex items-center gap-1",children:[g.jsx("button",{className:"inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-mantis-500 px-2 text-sm text-white ring-offset-stone-900 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mantis-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",disabled:e.at(0).address.value===ye.MIN_ADDRESS,title:t("computer.memory.address-decrement"),onClick:d,children:g.jsx("span",{className:"icon-[lucide--chevron-left] h-4 w-4"})}),g.jsxs("div",{className:"relative",children:[g.jsx(E$,{className:"font-mono",placeholder:"20h",type:"text",enterKeyHint:"go",id:o,value:a,onChange:h=>l(h.currentTarget.value),onKeyDown:h=>{h.key==="Enter"&&u()}}),g.jsx("button",{title:t("computer.memory.unfix-address"),className:ze("absolute right-2 top-3",!r&&"hidden"),onClick:()=>{l(""),s(null)},children:g.jsx("span",{className:"icon-[lucide--x] h-4 w-4 text-stone-500 transition-colors hover:text-stone-300"})})]}),g.jsx("button",{className:"inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-mantis-500 px-2 text-sm text-white ring-offset-stone-900 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mantis-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",disabled:e.at(-1).address.value===ye.MAX_ADDRESS,title:t("computer.memory.address-decrement"),onClick:c,children:g.jsx("span",{className:"icon-[lucide--chevron-right] h-4 w-4"})})]})]}),g.jsxs("div",{className:"m-4 flex w-min items-start overflow-hidden rounded-lg border border-stone-600",children:[g.jsx("table",{className:"border-r border-stone-600 font-mono text-lg",children:g.jsx("tbody",{children:e.slice(0,n).map((h,f)=>S.createElement(cR,{...h,key:f}))})}),g.jsx("table",{className:"font-mono text-lg",children:g.jsx("tbody",{children:e.slice(n).map((h,f)=>S.createElement(cR,{...h,key:f}))})})]})]})}function cR({address:t,value:e}){const n=mt(),i=Xt(Uc),r=n("computer.memory.cell",t);return g.jsxs(k$,{children:[g.jsx(_$,{asChild:!0,children:g.jsxs(Gt.tr,{title:r,className:"cursor-pointer border-b border-stone-600 odd:bg-stone-900 even:bg-stone-800 last-of-type:border-b-0",style:t.value===i.value?ft("memory.operating-cell"):void 0,children:[g.jsx("td",{className:"border-r border-stone-600 px-2 py-1 font-thin",children:t.toString()}),g.jsx("td",{className:"border-r border-stone-600 px-2 py-1 last-of-type:border-r-0",children:e.toString("hex")})]})}),g.jsxs(oC,{className:"w-60",children:[g.jsx("p",{className:"px-4 py-2 font-medium text-white",children:r}),g.jsx("hr",{className:"border-stone-600"}),g.jsx("ul",{className:"px-4 py-2 text-sm",children:["hex","bin","uint","int","safe-ascii"].map(s=>g.jsxs("li",{children:[g.jsx("b",{className:"font-medium",children:n(`generics.byte-representation.${s}`)}),":"," ",g.jsx("span",{className:"font-mono text-mantis-400",children:e.toString(s)})]},s))})]})]})}function wne(){const t=mt(),{devices:e}=mn();return e.pic?g.jsxs("div",{className:"absolute left-0 top-[700px] z-10 flex h-[200px] w-[450px] flex-col rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsxs("div",{className:"flex items-start",children:[g.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.pic")}),g.jsxs("div",{className:"flex h-16 grow items-center justify-evenly",children:[g.jsx(Hi,{name:"IMR",title:t("generics.io-register","IMR",33),valueAtom:L_,springs:"pic.IMR",emphasis:!0}),g.jsx(Hi,{name:"IRR",title:t("generics.io-register","IRR",34),valueAtom:j_,springs:"pic.IRR",emphasis:!0}),g.jsx(Hi,{name:"ISR",title:t("generics.io-register","ISR",35),valueAtom:F_,springs:"pic.ISR",emphasis:!0})]})]}),g.jsx("hr",{className:"mb-2 border-stone-600"}),g.jsx("div",{className:"grid h-full w-full grid-cols-4 items-center",children:Nv.map((n,i)=>g.jsx(Hi,{name:`INT${i}`,title:t("generics.io-register",`INT${i}`,36+i),valueAtom:n,springs:`pic.INT${i}`,className:"mx-auto"},i))})]}):null}function bne(){const t=mt(),{devices:e}=mn();return e.pio?g.jsxs("div",{className:"absolute left-[900px] top-[700px] z-10 h-min w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"mb-2 block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.pio.name")}),g.jsx("hr",{className:"border-stone-600"}),g.jsxs("div",{className:"flex w-full items-center justify-evenly py-4",children:[g.jsx(Hi,{name:"PA",title:t("generics.io-register","PA",48),valueAtom:B_,springs:"pio.PA"}),g.jsx(Hi,{name:"CA",title:t("generics.io-register","CA",50),valueAtom:z_,springs:"pio.CA"})]}),g.jsx("hr",{className:"border-stone-600"}),g.jsxs("div",{className:"flex w-full items-center justify-evenly py-4",children:[g.jsx(Hi,{name:"PB",title:t("generics.io-register","PB",49),valueAtom:$_,springs:"pio.PB"}),g.jsx(Hi,{name:"CB",title:t("generics.io-register","CB",51),valueAtom:U_,springs:"pio.CB"})]})]}):null}const xne="_printer_fbkny_2",Sne="_shadow_fbkny_6",kne="_sides_fbkny_11",_ne="_front_fbkny_22",Cne="_trailContainer_fbkny_27",Ene="_trail_fbkny_27",Ane="_paper_fbkny_33",vl={printer:xne,shadow:Sne,sides:kne,front:_ne,trailContainer:Cne,trail:Ene,paper:Ane},Pne=Array.from({length:5},(t,e)=>e);function Tne(){const t=mt(),{devices:e}=mn(),n=Xt(Mv),i=Xt(Ov);return e.printer?g.jsx("div",{className:"absolute left-[1250px] top-[750px] z-10 flex h-min w-80 flex-col rounded-lg border border-stone-600 bg-stone-900 pl-16 [&_*]:z-20",children:g.jsxs("div",{className:vl.printer,title:t("computer.printer.name"),children:[g.jsx("div",{className:vl.shadow}),g.jsx("div",{className:vl.sides}),g.jsxs("div",{className:vl.front,children:[g.jsx("div",{className:vl.trailContainer,children:g.jsx("div",{className:vl.trail,children:g.jsx("pre",{className:vl.paper,children:i})})}),g.jsx("div",{className:"grid grid-cols-5 items-center justify-center",children:Pne.map(r=>{const s=n[r]?fj(n[r].unsigned):null;return g.jsx("span",{className:ze("flex h-6 w-full items-center justify-center border-r border-zinc-300 text-center font-mono text-base font-medium leading-none text-white first-of-type:rounded-l-xl last-of-type:rounded-r-xl last-of-type:border-r-0",s===null?"bg-zinc-400":"bg-mantis-500"),children:s},r)})}),g.jsx("div",{className:"mx-auto mt-4 h-1 w-[70%] overflow-hidden rounded-full bg-zinc-600",children:g.jsx(Gt.div,{className:"h-full bg-mantis-400",style:{width:ft("printer.printing.progress").to(r=>`${r*100}%`),opacity:ft("printer.printing.opacity")}})})]})]})}):null}const Rne="_container_6nvz7_2",Nne="_text_6nvz7_22",dR={container:Rne,text:Nne};function Mne(){const t=mt(),{devices:e}=mn(),n=Xt(V_);return e.screen?g.jsxs("div",{className:"absolute left-[1200px] top-0 z-10 h-min w-[500px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-xl text-white",children:t("computer.screen")}),g.jsx("div",{className:dR.container,children:g.jsx("pre",{className:dR.text,children:n})})]}):null}function One(){const t=mt(),{status:e,dispatch:n,devices:i}=mn(),r=Xt(H_).toArray();return i.switches?g.jsxs("div",{className:"absolute left-[1300px] top-[698px] z-10 h-min w-min rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.switches")}),g.jsx("div",{className:"flex flex-row-reverse gap-3 p-4",children:r.map((s,o)=>g.jsx("div",{className:"w-6",children:g.jsx(Lv,{checked:s,onCheckedChange:()=>n("switch.toggle",o),className:"-translate-x-3 -rotate-90 data-[state=unchecked]:!bg-stone-800",disabled:e.type!=="running"})},o))})]}):null}function Ine(){const t=mt(),{devices:e}=mn();return e.timer?g.jsxs("div",{className:"absolute left-[500px] top-[875px] z-10 flex h-[120px] w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.timer")}),g.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-evenly",children:[g.jsx(Hi,{name:"CONT",title:t("generics.io-register","CONT",16),valueAtom:W_,springs:"timer.CONT"}),g.jsx(Hi,{name:"COMP",title:t("generics.io-register","COMP",17),valueAtom:G_,springs:"timer.COMP"})]})]}):null}function R$(){const t=S.useRef(null);return g.jsx("div",{className:"relative h-full w-full",children:g.jsxs(Ote,{minScale:.3,initialScale:.75,ref:t,doubleClick:{disabled:!0},panning:{excluded:["input"]},children:[g.jsx(Lte,{wrapperClass:"!w-full !h-full",contentClass:"!p-[200px]",children:g.jsxs("div",{className:"relative h-[1300px] w-[1900px]",children:[g.jsx(Ute,{}),g.jsx(rne,{}),g.jsx(yne,{}),g.jsx(cne,{}),g.jsx(wne,{}),g.jsx(bne,{}),g.jsx(Ine,{}),g.jsx(Vte,{}),g.jsx(une,{}),g.jsx(mne,{}),g.jsx(gne,{}),g.jsx(Tne,{}),g.jsx(One,{}),g.jsx(Mne,{})]})}),g.jsx(jte,{wrapperRef:t})]})})}const Dne=1024;let Lne=0;class Xw{constructor(e,n){this.from=e,this.to=n}}class it{constructor(e={}){this.id=Lne++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Ri.match(e)),n=>{let i=e(n);return i===void 0?null:[this,i]}}}it.closedBy=new it({deserialize:t=>t.split(" ")});it.openedBy=new it({deserialize:t=>t.split(" ")});it.group=new it({deserialize:t=>t.split(" ")});it.isolate=new it({deserialize:t=>{if(t&&t!="rtl"&&t!="ltr"&&t!="auto")throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}});it.contextHash=new it({perNode:!0});it.lookAhead=new it({perNode:!0});it.mounted=new it({perNode:!0});class jv{constructor(e,n,i){this.tree=e,this.overlay=n,this.parser=i}static get(e){return e&&e.props&&e.props[it.mounted.id]}}const jne=Object.create(null);class Ri{constructor(e,n,i,r=0){this.name=e,this.props=n,this.id=i,this.flags=r}static define(e){let n=e.props&&e.props.length?Object.create(null):jne,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new Ri(e.name||"",n,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let n=this.prop(it.group);return n?n.indexOf(e)>-1:!1}return this.id==e}static match(e){let n=Object.create(null);for(let i in e)for(let r of i.split(" "))n[r]=e[i];return i=>{for(let r=i.prop(it.group),s=-1;s<(r?r.length:0);s++){let o=n[s<0?i.name:r[s]];if(o)return o}}}}Ri.none=new Ri("",Object.create(null),0,8);class aC{constructor(e){this.types=e;for(let n=0;n<e.length;n++)if(e[n].id!=n)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let n=[];for(let i of this.types){let r=null;for(let s of e){let o=s(i);o&&(r||(r=Object.assign({},i.props)),r[o[0].id]=o[1])}n.push(r?new Ri(i.name,r,i.id,i.flags):i)}return new aC(n)}}const Sm=new WeakMap,hR=new WeakMap;var Cn;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"})(Cn||(Cn={}));class Ft{constructor(e,n,i,r,s){if(this.type=e,this.children=n,this.positions=i,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=jv.get(this);if(e&&!e.overlay)return e.tree.toString();let n="";for(let i of this.children){let r=i.toString();r&&(n&&(n+=","),n+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}cursor(e=0){return new J1(this.topNode,e)}cursorAt(e,n=0,i=0){let r=Sm.get(this)||this.topNode,s=new J1(r);return s.moveTo(e,n),Sm.set(this,s._tree),s}get topNode(){return new Er(this,0,0,null)}resolve(e,n=0){let i=Df(Sm.get(this)||this.topNode,e,n,!1);return Sm.set(this,i),i}resolveInner(e,n=0){let i=Df(hR.get(this)||this.topNode,e,n,!0);return hR.set(this,i),i}resolveStack(e,n=0){return $ne(this,e,n)}iterate(e){let{enter:n,leave:i,from:r=0,to:s=this.length}=e,o=e.mode||0,a=(o&Cn.IncludeAnonymous)>0;for(let l=this.cursor(o|Cn.IncludeAnonymous);;){let u=!1;if(l.from<=s&&l.to>=r&&(!a&&l.type.isAnonymous||n(l)!==!1)){if(l.firstChild())continue;u=!0}for(;u&&i&&(a||!l.type.isAnonymous)&&i(l),!l.nextSibling();){if(!l.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let n in this.props)e.push([+n,this.props[n]]);return e}balance(e={}){return this.children.length<=8?this:cC(Ri.none,this.children,this.positions,0,this.children.length,0,this.length,(n,i,r)=>new Ft(this.type,n,i,r,this.propValues),e.makeTree||((n,i,r)=>new Ft(Ri.none,n,i,r)))}static build(e){return zne(e)}}Ft.empty=new Ft(Ri.none,[],[],0);class lC{constructor(e,n){this.buffer=e,this.index=n}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new lC(this.buffer,this.index)}}class Ja{constructor(e,n,i){this.buffer=e,this.length=n,this.set=i}get type(){return Ri.none}toString(){let e=[];for(let n=0;n<this.buffer.length;)e.push(this.childString(n)),n=this.buffer[n+3];return e.join(",")}childString(e){let n=this.buffer[e],i=this.buffer[e+3],r=this.set.types[n],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,n,i,r,s){let{buffer:o}=this,a=-1;for(let l=e;l!=n&&!(N$(s,r,o[l+1],o[l+2])&&(a=l,i>0));l=o[l+3]);return a}slice(e,n,i){let r=this.buffer,s=new Uint16Array(n-e),o=0;for(let a=e,l=0;a<n;){s[l++]=r[a++],s[l++]=r[a++]-i;let u=s[l++]=r[a++]-i;s[l++]=r[a++]-e,o=Math.max(o,u)}return new Ja(s,o,this.set)}}function N$(t,e,n,i){switch(t){case-2:return n<e;case-1:return i>=e&&n<e;case 0:return n<e&&i>e;case 1:return n<=e&&i>e;case 2:return i>e;case 4:return!0}}function Df(t,e,n,i){for(var r;t.from==t.to||(n<1?t.from>=e:t.from>e)||(n>-1?t.to<=e:t.to<e);){let o=!i&&t instanceof Er&&t.index<0?null:t.parent;if(!o)return t;t=o}let s=i?0:Cn.IgnoreOverlays;if(i)for(let o=t,a=o.parent;a;o=a,a=o.parent)o instanceof Er&&o.index<0&&((r=a.enter(e,n,s))===null||r===void 0?void 0:r.from)!=o.from&&(t=a);for(;;){let o=t.enter(e,n,s);if(!o)return t;t=o}}class M${cursor(e=0){return new J1(this,e)}getChild(e,n=null,i=null){let r=fR(this,e,n,i);return r.length?r[0]:null}getChildren(e,n=null,i=null){return fR(this,e,n,i)}resolve(e,n=0){return Df(this,e,n,!1)}resolveInner(e,n=0){return Df(this,e,n,!0)}matchContext(e){return Y1(this,e)}enterUnfinishedNodesBefore(e){let n=this.childBefore(e),i=this;for(;n;){let r=n.lastChild;if(!r||r.to!=n.to)break;r.type.isError&&r.from==r.to?(i=n,n=r.prevSibling):n=r}return i}get node(){return this}get next(){return this.parent}}class Er extends M${constructor(e,n,i,r){super(),this._tree=e,this.from=n,this.index=i,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,n,i,r,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,u=n>0?a.length:-1;e!=u;e+=n){let c=a[e],d=l[e]+o.from;if(N$(r,i,d,d+c.length)){if(c instanceof Ja){if(s&Cn.ExcludeBuffers)continue;let h=c.findChild(0,c.buffer.length,n,i-d,r);if(h>-1)return new ba(new Fne(o,c,e,d),null,h)}else if(s&Cn.IncludeAnonymous||!c.type.isAnonymous||uC(c)){let h;if(!(s&Cn.IgnoreMounts)&&(h=jv.get(c))&&!h.overlay)return new Er(h.tree,d,e,o);let f=new Er(c,d,e,o);return s&Cn.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(n<0?c.children.length-1:0,n,i,r)}}}if(s&Cn.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+n:e=n<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,n,i=0){let r;if(!(i&Cn.IgnoreOverlays)&&(r=jv.get(this._tree))&&r.overlay){let s=e-this.from;for(let{from:o,to:a}of r.overlay)if((n>0?o<=s:o<s)&&(n<0?a>=s:a>s))return new Er(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,n,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function fR(t,e,n,i){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(n!=null){for(let o=!1;!o;)if(o=r.type.is(n),!r.nextSibling())return s}for(;;){if(i!=null&&r.type.is(i))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return i==null?s:[]}}function Y1(t,e,n=e.length-1){for(let i=t.parent;n>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[n]&&e[n]!=i.name)return!1;n--}}return!0}class Fne{constructor(e,n,i,r){this.parent=e,this.buffer=n,this.index=i,this.start=r}}class ba extends M${get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,n,i){super(),this.context=e,this._parent=n,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,n,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,n-this.context.start,i);return s<0?null:new ba(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,n,i=0){if(i&Cn.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],n>0?1:-1,e-this.context.start,n);return s<0?null:new ba(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,n=e.buffer[this.index+3];return n<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new ba(this.context,this._parent,n):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new ba(this.context,this._parent,e.findChild(n,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],n=[],{buffer:i}=this.context,r=this.index+4,s=i.buffer[this.index+3];if(s>r){let o=i.buffer[this.index+1];e.push(i.slice(r,s,o)),n.push(0)}return new Ft(this.type,e,n,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function O$(t){if(!t.length)return null;let e=0,n=t[0];for(let s=1;s<t.length;s++){let o=t[s];(o.from>n.from||o.to<n.to)&&(n=o,e=s)}let i=n instanceof Er&&n.index<0?null:n.parent,r=t.slice();return i?r[e]=i:r.splice(e,1),new Bne(r,n)}class Bne{constructor(e,n){this.heads=e,this.node=n}get next(){return O$(this.heads)}}function $ne(t,e,n){let i=t.resolveInner(e,n),r=null;for(let s=i instanceof Er?i:i.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(r||(r=[i])).push(o.resolve(e,n)),s=o}else{let o=jv.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new Er(o.tree,o.overlay[0].from+s.from,-1,s);(r||(r=[i])).push(Df(a,e,n,!1))}}return r?O$(r):i}class J1{get name(){return this.type.name}constructor(e,n=0){if(this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Er)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,n){this.index=e;let{start:i,buffer:r}=this.buffer;return this.type=n||r.set.types[r.buffer[e]],this.from=i+r.buffer[e+1],this.to=i+r.buffer[e+2],!0}yield(e){return e?e instanceof Er?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,n,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,n,i,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,n-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,n,i=this.mode){return this.buffer?i&Cn.ExcludeBuffers?!1:this.enterChild(1,e,n):this.yield(this._tree.enter(e,n,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Cn.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Cn.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:n}=this.buffer,i=this.stack.length-1;if(e<0){let r=i<0?0:this.stack[i]+4;if(this.index!=r)return this.yieldBuf(n.findChild(r,this.index,-1,0,4))}else{let r=n.buffer[this.index+3];if(r<(i<0?n.buffer.length:n.buffer[this.stack[i]+3]))return this.yieldBuf(r)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let n,i,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:n,parent:i}=r)}else({index:n,_parent:i}=this._tree);for(;i;{index:n,_parent:i}=i)if(n>-1)for(let s=n+e,o=e<0?-1:i._tree.children.length;s!=o;s+=e){let a=i._tree.children[s];if(this.mode&Cn.IncludeAnonymous||a instanceof Ja||!a.type.isAnonymous||uC(a))return!1}return!0}move(e,n){if(n&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,n=0){for(;(this.from==this.to||(n<1?this.from>=e:this.from>e)||(n>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,n););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,n=null,i=0;if(e&&e.context==this.buffer)e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;n=o,i=s+1;break e}r=this.stack[--s]}for(let r=i;r<this.stack.length;r++)n=new ba(this.buffer,n,this.stack[r]);return this.bufferNode=new ba(this.buffer,n,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,n){for(let i=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(r=!0)}for(;r&&n&&n(this),r=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,r=!0}}}matchContext(e){if(!this.buffer)return Y1(this.node,e);let{buffer:n}=this.buffer,{types:i}=n.set;for(let r=e.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return Y1(this.node,e,r);let o=i[n.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}}function uC(t){return t.children.some(e=>e instanceof Ja||!e.type.isAnonymous||uC(e))}function zne(t){var e;let{buffer:n,nodeSet:i,maxBufferLength:r=Dne,reused:s=[],minRepeatType:o=i.types.length}=t,a=Array.isArray(n)?new lC(n,n.length):n,l=i.types,u=0,c=0;function d(_,E,A,P,I,D){let{id:B,start:$,end:J,size:z}=a,G=c;for(;z<0;)if(a.next(),z==-1){let te=s[B];A.push(te),P.push($-_);return}else if(z==-3){u=B;return}else if(z==-4){c=B;return}else throw new RangeError(`Unrecognized record size: ${z}`);let Q=l[B],ie,H,j=$-_;if(J-$<=r&&(H=w(a.pos-E,I))){let te=new Uint16Array(H.size-H.skip),pe=a.pos-H.size,q=te.length;for(;a.pos>pe;)q=v(H.start,te,q);ie=new Ja(te,J-H.start,i),j=H.start-_}else{let te=a.pos-z;a.next();let pe=[],q=[],ue=B>=o?B:-1,O=0,M=J;for(;a.pos>te;)ue>=0&&a.id==ue&&a.size>=0?(a.end<=M-r&&(p(pe,q,$,O,a.end,M,ue,G),O=pe.length,M=a.end),a.next()):D>2500?h($,te,pe,q):d($,te,pe,q,ue,D+1);if(ue>=0&&O>0&&O<pe.length&&p(pe,q,$,O,$,M,ue,G),pe.reverse(),q.reverse(),ue>-1&&O>0){let F=f(Q);ie=cC(Q,pe,q,0,pe.length,0,J-$,F,F)}else ie=m(Q,pe,q,J-$,G-J)}A.push(ie),P.push(j)}function h(_,E,A,P){let I=[],D=0,B=-1;for(;a.pos>E;){let{id:$,start:J,end:z,size:G}=a;if(G>4)a.next();else{if(B>-1&&J<B)break;B<0&&(B=z-r),I.push($,J,z),D++,a.next()}}if(D){let $=new Uint16Array(D*4),J=I[I.length-2];for(let z=I.length-3,G=0;z>=0;z-=3)$[G++]=I[z],$[G++]=I[z+1]-J,$[G++]=I[z+2]-J,$[G++]=G;A.push(new Ja($,I[2]-J,i)),P.push(J-_)}}function f(_){return(E,A,P)=>{let I=0,D=E.length-1,B,$;if(D>=0&&(B=E[D])instanceof Ft){if(!D&&B.type==_&&B.length==P)return B;($=B.prop(it.lookAhead))&&(I=A[D]+B.length+$)}return m(_,E,A,P,I)}}function p(_,E,A,P,I,D,B,$){let J=[],z=[];for(;_.length>P;)J.push(_.pop()),z.push(E.pop()+A-I);_.push(m(i.types[B],J,z,D-I,$-D)),E.push(I-A)}function m(_,E,A,P,I=0,D){if(u){let B=[it.contextHash,u];D=D?[B].concat(D):[B]}if(I>25){let B=[it.lookAhead,I];D=D?[B].concat(D):[B]}return new Ft(_,E,A,P,D)}function w(_,E){let A=a.fork(),P=0,I=0,D=0,B=A.end-r,$={size:0,start:0,skip:0};e:for(let J=A.pos-_;A.pos>J;){let z=A.size;if(A.id==E&&z>=0){$.size=P,$.start=I,$.skip=D,D+=4,P+=4,A.next();continue}let G=A.pos-z;if(z<0||G<J||A.start<B)break;let Q=A.id>=o?4:0,ie=A.start;for(A.next();A.pos>G;){if(A.size<0)if(A.size==-3)Q+=4;else break e;else A.id>=o&&(Q+=4);A.next()}I=ie,P+=z,D+=Q}return(E<0||P==_)&&($.size=P,$.start=I,$.skip=D),$.size>4?$:void 0}function v(_,E,A){let{id:P,start:I,end:D,size:B}=a;if(a.next(),B>=0&&P<o){let $=A;if(B>4){let J=a.pos-(B-4);for(;a.pos>J;)A=v(_,E,A)}E[--A]=$,E[--A]=D-_,E[--A]=I-_,E[--A]=P}else B==-3?u=P:B==-4&&(c=P);return A}let y=[],b=[];for(;a.pos>0;)d(t.start||0,t.bufferStart||0,y,b,-1,0);let k=(e=t.length)!==null&&e!==void 0?e:y.length?b[0]+y[0].length:0;return new Ft(l[t.topID],y.reverse(),b.reverse(),k)}const pR=new WeakMap;function mg(t,e){if(!t.isAnonymous||e instanceof Ja||e.type!=t)return 1;let n=pR.get(e);if(n==null){n=1;for(let i of e.children){if(i.type!=t||!(i instanceof Ft)){n=1;break}n+=mg(t,i)}pR.set(e,n)}return n}function cC(t,e,n,i,r,s,o,a,l){let u=0;for(let p=i;p<r;p++)u+=mg(t,e[p]);let c=Math.ceil(u*1.5/8),d=[],h=[];function f(p,m,w,v,y){for(let b=w;b<v;){let k=b,_=m[b],E=mg(t,p[b]);for(b++;b<v;b++){let A=mg(t,p[b]);if(E+A>=c)break;E+=A}if(b==k+1){if(E>c){let A=p[k];f(A.children,A.positions,0,A.children.length,m[k]+y);continue}d.push(p[k])}else{let A=m[b-1]+p[b-1].length-_;d.push(cC(t,p,m,k,b,_,A,null,l))}h.push(_+y-s)}}return f(e,n,i,r,0),(a||l)(d,h,o)}class $l{constructor(e,n,i,r,s=!1,o=!1){this.from=e,this.to=n,this.tree=i,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,n=[],i=!1){let r=[new $l(0,e.length,e,0,!1,i)];for(let s of n)s.to>e.length&&r.push(s);return r}static applyChanges(e,n,i=128){if(!n.length)return e;let r=[],s=1,o=e.length?e[0]:null;for(let a=0,l=0,u=0;;a++){let c=a<n.length?n[a]:null,d=c?c.fromA:1e9;if(d-l>=i)for(;o&&o.from<d;){let h=o;if(l>=h.from||d<=h.to||u){let f=Math.max(h.from,l)-u,p=Math.min(h.to,d)-u;h=f>=p?null:new $l(f,p,h.tree,h.offset+u,a>0,!!c)}if(h&&r.push(h),o.to>d)break;o=s<e.length?e[s++]:null}if(!c)break;l=c.toA,u=c.toA-c.toB}return r}}class I${startParse(e,n,i){return typeof e=="string"&&(e=new Une(e)),i=i?i.length?i.map(r=>new Xw(r.from,r.to)):[new Xw(0,0)]:[new Xw(0,e.length)],this.createParse(e,n||[],i)}parse(e,n,i){let r=this.startParse(e,n,i);for(;;){let s=r.advance();if(s)return s}}}class Une{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,n){return this.string.slice(e,n)}}new it({perNode:!0});let Vne=0;class Sn{constructor(e,n,i){this.set=e,this.base=n,this.modified=i,this.id=Vne++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let n=new Sn([],null,[]);if(n.set.push(n),e)for(let i of e.set)n.set.push(i);return n}static defineModifier(){let e=new Fv;return n=>n.modified.indexOf(e)>-1?n:Fv.get(n.base||n,n.modified.concat(e).sort((i,r)=>i.id-r.id))}}let Hne=0;class Fv{constructor(){this.instances=[],this.id=Hne++}static get(e,n){if(!n.length)return e;let i=n[0].instances.find(a=>a.base==e&&Wne(n,a.modified));if(i)return i;let r=[],s=new Sn(r,e,n);for(let a of n)a.instances.push(s);let o=Gne(n);for(let a of e.set)if(!a.modified.length)for(let l of o)r.push(Fv.get(a,l));return s}}function Wne(t,e){return t.length==e.length&&t.every((n,i)=>n==e[i])}function Gne(t){let e=[[]];for(let n=0;n<t.length;n++)for(let i=0,r=e.length;i<r;i++)e.push(e[i].concat(t[n]));return e.sort((n,i)=>i.length-n.length)}function Kne(t){let e=Object.create(null);for(let n in t){let i=t[n];Array.isArray(i)||(i=[i]);for(let r of n.split(" "))if(r){let s=[],o=2,a=r;for(let d=0;;){if(a=="..."&&d>0&&d+3==r.length){o=1;break}let h=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!h)throw new RangeError("Invalid path: "+r);if(s.push(h[0]=="*"?"":h[0][0]=='"'?JSON.parse(h[0]):h[0]),d+=h[0].length,d==r.length)break;let f=r[d++];if(d==r.length&&f=="!"){o=0;break}if(f!="/")throw new RangeError("Invalid path: "+r);a=r.slice(d)}let l=s.length-1,u=s[l];if(!u)throw new RangeError("Invalid path: "+r);let c=new Bv(i,o,l>0?s.slice(0,l):null);e[u]=c.sort(e[u])}}return D$.add(e)}const D$=new it;class Bv{constructor(e,n,i,r){this.tags=e,this.mode=n,this.context=i,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Bv.empty=new Bv([],2,null);function L$(t,e){let n=Object.create(null);for(let s of t)if(!Array.isArray(s.tag))n[s.tag.id]=s.class;else for(let o of s.tag)n[o.id]=s.class;let{scope:i,all:r=null}=e||{};return{style:s=>{let o=r;for(let a of s)for(let l of a.set){let u=n[l.id];if(u){o=o?o+" "+u:u;break}}return o},scope:i}}function Xne(t,e){let n=null;for(let i of t){let r=i.style(e);r&&(n=n?n+" "+r:r)}return n}function qne(t,e,n,i=0,r=t.length){let s=new Yne(i,Array.isArray(e)?e:[e],n);s.highlightRange(t.cursor(),i,r,"",s.highlighters),s.flush(r)}class Yne{constructor(e,n,i){this.at=e,this.highlighters=n,this.span=i,this.class=""}startSpan(e,n){n!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=n)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,n,i,r,s){let{type:o,from:a,to:l}=e;if(a>=i||l<=n)return;o.isTop&&(s=this.highlighters.filter(f=>!f.scope||f.scope(o)));let u=r,c=Jne(e)||Bv.empty,d=Xne(s,c.tags);if(d&&(u&&(u+=" "),u+=d,c.mode==1&&(r+=(r?" ":"")+d)),this.startSpan(Math.max(n,a),u),c.opaque)return;let h=e.tree&&e.tree.prop(it.mounted);if(h&&h.overlay){let f=e.node.enter(h.overlay[0].from+a,1),p=this.highlighters.filter(w=>!w.scope||w.scope(h.tree.type)),m=e.firstChild();for(let w=0,v=a;;w++){let y=w<h.overlay.length?h.overlay[w]:null,b=y?y.from+a:l,k=Math.max(n,v),_=Math.min(i,b);if(k<_&&m)for(;e.from<_&&(this.highlightRange(e,k,_,r,s),this.startSpan(Math.min(_,e.to),u),!(e.to>=b||!e.nextSibling())););if(!y||b>i)break;v=y.to+a,v>n&&(this.highlightRange(f.cursor(),Math.max(n,y.from+a),Math.min(i,v),"",p),this.startSpan(Math.min(i,v),u))}m&&e.parent()}else if(e.firstChild()){h&&(r="");do if(!(e.to<=n)){if(e.from>=i)break;this.highlightRange(e,n,i,r,s),this.startSpan(Math.min(i,e.to),u)}while(e.nextSibling());e.parent()}}}function Jne(t){let e=t.type.prop(D$);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}const de=Sn.define,km=de(),Jo=de(),mR=de(Jo),gR=de(Jo),Zo=de(),_m=de(Zo),qw=de(Zo),ps=de(),yl=de(ps),hs=de(),fs=de(),Z1=de(),Md=de(Z1),Cm=de(),Be={comment:km,lineComment:de(km),blockComment:de(km),docComment:de(km),name:Jo,variableName:de(Jo),typeName:mR,tagName:de(mR),propertyName:gR,attributeName:de(gR),className:de(Jo),labelName:de(Jo),namespace:de(Jo),macroName:de(Jo),literal:Zo,string:_m,docString:de(_m),character:de(_m),attributeValue:de(_m),number:qw,integer:de(qw),float:de(qw),bool:de(Zo),regexp:de(Zo),escape:de(Zo),color:de(Zo),url:de(Zo),keyword:hs,self:de(hs),null:de(hs),atom:de(hs),unit:de(hs),modifier:de(hs),operatorKeyword:de(hs),controlKeyword:de(hs),definitionKeyword:de(hs),moduleKeyword:de(hs),operator:fs,derefOperator:de(fs),arithmeticOperator:de(fs),logicOperator:de(fs),bitwiseOperator:de(fs),compareOperator:de(fs),updateOperator:de(fs),definitionOperator:de(fs),typeOperator:de(fs),controlOperator:de(fs),punctuation:Z1,separator:de(Z1),bracket:Md,angleBracket:de(Md),squareBracket:de(Md),paren:de(Md),brace:de(Md),content:ps,heading:yl,heading1:de(yl),heading2:de(yl),heading3:de(yl),heading4:de(yl),heading5:de(yl),heading6:de(yl),contentSeparator:de(ps),list:de(ps),quote:de(ps),emphasis:de(ps),strong:de(ps),link:de(ps),monospace:de(ps),strikethrough:de(ps),inserted:de(),deleted:de(),changed:de(),invalid:de(),meta:Cm,documentMeta:de(Cm),annotation:de(Cm),processingInstruction:de(Cm),definition:Sn.defineModifier(),constant:Sn.defineModifier(),function:Sn.defineModifier(),standard:Sn.defineModifier(),local:Sn.defineModifier(),special:Sn.defineModifier()};L$([{tag:Be.link,class:"tok-link"},{tag:Be.heading,class:"tok-heading"},{tag:Be.emphasis,class:"tok-emphasis"},{tag:Be.strong,class:"tok-strong"},{tag:Be.keyword,class:"tok-keyword"},{tag:Be.atom,class:"tok-atom"},{tag:Be.bool,class:"tok-bool"},{tag:Be.url,class:"tok-url"},{tag:Be.labelName,class:"tok-labelName"},{tag:Be.inserted,class:"tok-inserted"},{tag:Be.deleted,class:"tok-deleted"},{tag:Be.literal,class:"tok-literal"},{tag:Be.string,class:"tok-string"},{tag:Be.number,class:"tok-number"},{tag:[Be.regexp,Be.escape,Be.special(Be.string)],class:"tok-string2"},{tag:Be.variableName,class:"tok-variableName"},{tag:Be.local(Be.variableName),class:"tok-variableName tok-local"},{tag:Be.definition(Be.variableName),class:"tok-variableName tok-definition"},{tag:Be.special(Be.variableName),class:"tok-variableName2"},{tag:Be.definition(Be.propertyName),class:"tok-propertyName tok-definition"},{tag:Be.typeName,class:"tok-typeName"},{tag:Be.namespace,class:"tok-namespace"},{tag:Be.className,class:"tok-className"},{tag:Be.macroName,class:"tok-macroName"},{tag:Be.propertyName,class:"tok-propertyName"},{tag:Be.operator,class:"tok-operator"},{tag:Be.comment,class:"tok-comment"},{tag:Be.meta,class:"tok-meta"},{tag:Be.invalid,class:"tok-invalid"},{tag:Be.punctuation,class:"tok-punctuation"}]);var Yw;const Gu=new it;function Zne(t){return _e.define({combine:t?e=>e.concat(t):void 0})}const Qne=new it;class qr{constructor(e,n,i=[],r=""){this.data=e,this.name=r,Je.prototype.hasOwnProperty("tree")||Object.defineProperty(Je.prototype,"tree",{get(){return as(this)}}),this.parser=n,this.extension=[Xc.of(this),Je.languageData.of((s,o,a)=>{let l=vR(s,o,a),u=l.type.prop(Gu);if(!u)return[];let c=s.facet(u),d=l.type.prop(Qne);if(d){let h=l.resolve(o-l.from,a);for(let f of d)if(f.test(h,s)){let p=s.facet(f.facet);return f.type=="replace"?p:p.concat(c)}}return c})].concat(i)}isActiveAt(e,n,i=-1){return vR(e,n,i).type.prop(Gu)==this.data}findRegions(e){let n=e.facet(Xc);if((n==null?void 0:n.data)==this.data)return[{from:0,to:e.doc.length}];if(!n||!n.allowsNesting)return[];let i=[],r=(s,o)=>{if(s.prop(Gu)==this.data){i.push({from:o,to:o+s.length});return}let a=s.prop(it.mounted);if(a){if(a.tree.prop(Gu)==this.data){if(a.overlay)for(let l of a.overlay)i.push({from:l.from+o,to:l.to+o});else i.push({from:o,to:o+s.length});return}else if(a.overlay){let l=i.length;if(r(a.tree,a.overlay[0].from+o),i.length>l)return}}for(let l=0;l<s.children.length;l++){let u=s.children[l];u instanceof Ft&&r(u,s.positions[l]+o)}};return r(as(e),0),i}get allowsNesting(){return!0}}qr.setState=Xe.define();function vR(t,e,n){let i=t.facet(Xc),r=as(t).topNode;if(!i||i.allowsNesting)for(let s=r;s;s=s.enter(e,n,Cn.ExcludeBuffers))s.type.isTop&&(r=s);return r}function as(t){let e=t.field(qr.state,!1);return e?e.tree:Ft.empty}class eie{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,n){let i=this.cursorPos-this.string.length;return e<i||n>=this.cursorPos?this.doc.sliceString(e,n):this.string.slice(e-i,n-i)}}let Od=null;class Gc{constructor(e,n,i=[],r,s,o,a,l){this.parser=e,this.state=n,this.fragments=i,this.tree=r,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,n,i){return new Gc(e,n,[],Ft.empty,0,i,[],null)}startParse(){return this.parser.startParse(new eie(this.state.doc),this.fragments)}work(e,n){return n!=null&&n>=this.state.doc.length&&(n=void 0),this.tree!=Ft.empty&&this.isDone(n??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),n!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>n)&&n<this.state.doc.length&&this.parse.stopAt(n);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped($l.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(n??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,n;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(n=this.parse.advance()););}),this.treeLen=e,this.tree=n,this.fragments=this.withoutTempSkipped($l.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let n=Od;Od=this;try{return e()}finally{Od=n}}withoutTempSkipped(e){for(let n;n=this.tempSkipped.pop();)e=yR(e,n.from,n.to);return e}changes(e,n){let{fragments:i,tree:r,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((u,c,d,h)=>l.push({fromA:u,toA:c,fromB:d,toB:h})),i=$l.applyChanges(i,l),r=Ft.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let u of this.skipped){let c=e.mapPos(u.from,1),d=e.mapPos(u.to,-1);c<d&&a.push({from:c,to:d})}}}return new Gc(this.parser,n,i,r,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let n=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:r,to:s}=this.skipped[i];r<e.to&&s>e.from&&(this.fragments=yR(this.fragments,r,s),this.skipped.splice(i--,1))}return this.skipped.length>=n?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,n){this.skipped.push({from:e,to:n})}static getSkippingParser(e){return new class extends I${createParse(n,i,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let l=Od;if(l){for(let u of r)l.tempSkipped.push(u);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new Ft(Ri.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let n=this.fragments;return this.treeLen>=e&&n.length&&n[0].from==0&&n[0].to>=e}static get(){return Od}}function yR(t,e,n){return $l.applyChanges(t,[{fromA:e,toA:n,fromB:e,toB:n}])}class Kc{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let n=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,i)||n.takeTree(),new Kc(n)}static init(e){let n=Math.min(3e3,e.doc.length),i=Gc.create(e.facet(Xc).parser,e,{from:0,to:n});return i.work(20,n)||i.takeTree(),new Kc(i)}}qr.state=li.define({create:Kc.init,update(t,e){for(let n of e.effects)if(n.is(qr.setState))return n.value;return e.startState.facet(Xc)!=e.state.facet(Xc)?Kc.init(e.state):t.apply(e)}});let j$=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(j$=t=>{let e=-1,n=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(n):cancelIdleCallback(e)});const Jw=typeof navigator<"u"&&(!((Yw=navigator.scheduling)===null||Yw===void 0)&&Yw.isInputPending)?()=>navigator.scheduling.isInputPending():null,tie=In.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let n=this.view.state.field(qr.state).context;(n.updateViewport(e.view.viewport)||this.view.viewport.to>n.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(n)}scheduleWork(){if(this.working)return;let{state:e}=this.view,n=e.field(qr.state);(n.tree!=n.context.tree||!n.context.isDone(e.doc.length))&&(this.working=j$(this.work))}work(e){this.working=null;let n=Date.now();if(this.chunkEnd<n&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=n+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:r}}=this.view,s=i.field(qr.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Jw?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<r&&i.doc.length>r+1e3,l=s.context.work(()=>Jw&&Jw()||Date.now()>o,r+(a?0:1e5));this.chunkBudget-=Date.now()-n,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:qr.setState.of(new Kc(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(n=>Vi(this.view.state,n)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Xc=_e.define({combine(t){return t.length?t[0]:null},enables:t=>[qr.state,tie,Pe.contentAttributes.compute([t],e=>{let n=e.facet(t);return n&&n.name?{"data-language":n.name}:{}})]});class nie{constructor(e,n=[]){this.language=e,this.support=n,this.extension=[e,n]}}const F$=_e.define(),dC=_e.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(n=>n!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function ru(t){let e=t.facet(dC);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function Q1(t,e){let n="",i=t.tabSize,r=t.facet(dC)[0];if(r=="	"){for(;e>=i;)n+="	",e-=i;r=" "}for(let s=0;s<e;s++)n+=r;return n}function iie(t,e){t instanceof Je&&(t=new hC(t));for(let i of t.state.facet(F$)){let r=i(t,e);if(r!==void 0)return r}let n=as(t.state);return n.length>=e?sie(t,n,e):null}class hC{constructor(e,n={}){this.state=e,this.options=n,this.unit=ru(e)}lineAt(e,n=1){let i=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=i.from&&r<=i.to?s&&r==e?{text:"",from:e}:(n<0?r<e:r<=e)?{text:i.text.slice(r-i.from),from:r}:{text:i.text.slice(0,r-i.from),from:i.from}:i}textAfterPos(e,n=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:r}=this.lineAt(e,n);return i.slice(e-r,Math.min(i.length,e+100-r))}column(e,n=1){let{text:i,from:r}=this.lineAt(e,n),s=this.countColumn(i,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(s+=o-this.countColumn(i,i.search(/\S|$/))),s}countColumn(e,n=e.length){return qf(e,this.state.tabSize,n)}lineIndent(e,n=1){let{text:i,from:r}=this.lineAt(e,n),s=this.options.overrideIndentation;if(s){let o=s(r);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const rie=new it;function sie(t,e,n){let i=e.resolveStack(n),r=i.node.enterUnfinishedNodesBefore(n);if(r!=i.node){let s=[];for(let o=r;o!=i.node;o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)i={node:s[o],next:i}}return B$(i,t,n)}function B$(t,e,n){for(let i=t;i;i=i.next){let r=aie(i.node);if(r)return r(fC.create(e,n,i))}return 0}function oie(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function aie(t){let e=t.type.prop(rie);if(e)return e;let n=t.firstChild,i;if(n&&(i=n.type.prop(it.closedBy))){let r=t.lastChild,s=r&&i.indexOf(r.name)>-1;return o=>die(o,!0,1,void 0,s&&!oie(o)?r.from:void 0)}return t.parent==null?lie:null}function lie(){return 0}class fC extends hC{constructor(e,n,i){super(e.state,e.options),this.base=e,this.pos=n,this.context=i}get node(){return this.context.node}static create(e,n,i){return new fC(e,n,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let n=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(n.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(uie(i,e))break;n=this.state.doc.lineAt(i.from)}return this.lineIndent(n.from)}continue(){return B$(this.context.next,this.base,this.pos)}}function uie(t,e){for(let n=e;n;n=n.parent)if(t==n)return!0;return!1}function cie(t){let e=t.node,n=e.childAfter(e.from),i=e.lastChild;if(!n)return null;let r=t.options.simulateBreak,s=t.state.doc.lineAt(n.from),o=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let a=n.to;;){let l=e.childAfter(a);if(!l||l==i)return null;if(!l.type.isSkipped)return l.from<o?n:null;a=l.to}}function die(t,e,n,i,r){let s=t.textAfter,o=s.match(/^\s*/)[0].length,a=r==t.pos+o,l=cie(t);return l?a?t.column(l.from):t.column(l.to):t.baseIndent+(a?0:t.unit*n)}const hie=_e.define(),fie=new it;function pie(t,e,n){let i=as(t);if(i.length<n)return null;let r=i.resolveStack(n,1),s=null;for(let o=r;o;o=o.next){let a=o.node;if(a.to<=n||a.from>n)continue;if(s&&a.from<e)break;let l=a.type.prop(fie);if(l&&(a.to<i.length-50||i.length==t.doc.length||!mie(a))){let u=l(a,t);u&&u.from<=n&&u.from>=e&&u.to>n&&(s=u)}}return s}function mie(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function $$(t,e,n){for(let i of t.facet(hie)){let r=i(t,e,n);if(r)return r}return pie(t,e,n)}function z$(t,e){let n=e.mapPos(t.from,1),i=e.mapPos(t.to,-1);return n>=i?void 0:{from:n,to:i}}const pC=Xe.define({map:z$}),r0=Xe.define({map:z$});function U$(t){let e=[];for(let{head:n}of t.state.selection.ranges)e.some(i=>i.from<=n&&i.to>=n)||e.push(t.lineBlockAt(n));return e}const hp=li.define({create(){return Ge.none},update(t,e){t=t.map(e.changes);for(let n of e.effects)if(n.is(pC)&&!gie(t,n.value.from,n.value.to)){let{preparePlaceholder:i}=e.state.facet(G$),r=i?Ge.replace({widget:new kie(i(e.state,n.value))}):wR;t=t.update({add:[r.range(n.value.from,n.value.to)]})}else n.is(r0)&&(t=t.update({filter:(i,r)=>n.value.from!=i||n.value.to!=r,filterFrom:n.value.from,filterTo:n.value.to}));if(e.selection){let n=!1,{head:i}=e.selection.main;t.between(i,i,(r,s)=>{r<i&&s>i&&(n=!0)}),n&&(t=t.update({filterFrom:i,filterTo:i,filter:(r,s)=>s<=i||r>=i}))}return t},provide:t=>Pe.decorations.from(t),toJSON(t,e){let n=[];return t.between(0,e.doc.length,(i,r)=>{n.push(i,r)}),n},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let n=0;n<t.length;){let i=t[n++],r=t[n++];if(typeof i!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(wR.range(i,r))}return Ge.set(e,!0)}});function V$(t,e,n){var i;let r=null;return(i=t.field(hp,!1))===null||i===void 0||i.between(e,n,(s,o)=>{(!r||r.from>s)&&(r={from:s,to:o})}),r}function gie(t,e,n){let i=!1;return t.between(e,e,(r,s)=>{r==e&&s==n&&(i=!0)}),i}function H$(t,e){return t.field(hp,!1)?e:e.concat(Xe.appendConfig.of(Sie()))}const vie=t=>{for(let e of U$(t)){let n=$$(t.state,e.from,e.to);if(n)return t.dispatch({effects:H$(t.state,[pC.of(n),W$(t,n)])}),!0}return!1},yie=t=>{if(!t.state.field(hp,!1))return!1;let e=[];for(let n of U$(t)){let i=V$(t.state,n.from,n.to);i&&e.push(r0.of(i),W$(t,i,!1))}return e.length&&t.dispatch({effects:e}),e.length>0};function W$(t,e,n=!0){let i=t.state.doc.lineAt(e.from).number,r=t.state.doc.lineAt(e.to).number;return Pe.announce.of(`${t.state.phrase(n?"Folded lines":"Unfolded lines")} ${i} ${t.state.phrase("to")} ${r}.`)}const wie=t=>{let{state:e}=t,n=[];for(let i=0;i<e.doc.length;){let r=t.lineBlockAt(i),s=$$(e,r.from,r.to);s&&n.push(pC.of(s)),i=(s?t.lineBlockAt(s.to):r).to+1}return n.length&&t.dispatch({effects:H$(t.state,n)}),!!n.length},bie=t=>{let e=t.state.field(hp,!1);if(!e||!e.size)return!1;let n=[];return e.between(0,t.state.doc.length,(i,r)=>{n.push(r0.of({from:i,to:r}))}),t.dispatch({effects:n}),!0},xie={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},G$=_e.define({combine(t){return tl(t,xie)}});function Sie(t){return[hp,_ie]}function K$(t,e){let{state:n}=t,i=n.facet(G$),r=o=>{let a=t.lineBlockAt(t.posAtDOM(o.target)),l=V$(t.state,a.from,a.to);l&&t.dispatch({effects:r0.of(l)}),o.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(t,r,e);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",n.phrase("folded code")),s.title=n.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}const wR=Ge.replace({widget:new class extends nl{toDOM(t){return K$(t,null)}}});class kie extends nl{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return K$(e,this.value)}}const _ie=Pe.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class s0{constructor(e,n){this.specs=e;let i;function r(a){let l=Fa.newName();return(i||(i=Object.create(null)))["."+l]=a,l}const s=typeof n.all=="string"?n.all:n.all?r(n.all):void 0,o=n.scope;this.scope=o instanceof qr?a=>a.prop(Gu)==o.data:o?a=>a==o:void 0,this.style=L$(e.map(a=>({tag:a.tag,class:a.class||r(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=i?new Fa(i):null,this.themeType=n.themeType}static define(e,n){return new s0(e,n||{})}}const eS=_e.define(),Cie=_e.define({combine(t){return t.length?[t[0]]:null}});function Zw(t){let e=t.facet(eS);return e.length?e:t.facet(Cie)}function Eie(t,e){let n=[Pie],i;return t instanceof s0&&(t.module&&n.push(Pe.styleModule.of(t.module)),i=t.themeType),i?n.push(eS.computeN([Pe.darkTheme],r=>r.facet(Pe.darkTheme)==(i=="dark")?[t]:[])):n.push(eS.of(t)),n}class Aie{constructor(e){this.markCache=Object.create(null),this.tree=as(e.state),this.decorations=this.buildDeco(e,Zw(e.state)),this.decoratedTo=e.viewport.to}update(e){let n=as(e.state),i=Zw(e.state),r=i!=Zw(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);n.length<s.to&&!r&&n.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(n!=this.tree||e.viewportChanged||r)&&(this.tree=n,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=s.to)}buildDeco(e,n){if(!n||!this.tree.length)return Ge.none;let i=new ql;for(let{from:r,to:s}of e.visibleRanges)qne(this.tree,n,(o,a,l)=>{i.add(o,a,this.markCache[l]||(this.markCache[l]=Ge.mark({class:l})))},r,s);return i.finish()}}const Pie=Kf.high(In.fromClass(Aie,{decorations:t=>t.decorations})),Tie=1e4,Rie="()[]{}",Nie=new it;function tS(t,e,n){let i=t.prop(e<0?it.openedBy:it.closedBy);if(i)return i;if(t.name.length==1){let r=n.indexOf(t.name);if(r>-1&&r%2==(e<0?1:0))return[n[r+e]]}return null}function nS(t){let e=t.type.prop(Nie);return e?e(t.node):t}function Em(t,e,n,i={}){let r=i.maxScanDistance||Tie,s=i.brackets||Rie,o=as(t),a=o.resolveInner(e,n);for(let l=a;l;l=l.parent){let u=tS(l.type,n,s);if(u&&l.from<l.to){let c=nS(l);if(c&&(n>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return Mie(t,e,n,l,c,u,s)}}return Oie(t,e,n,o,a.type,r,s)}function Mie(t,e,n,i,r,s,o){let a=i.parent,l={from:r.from,to:r.to},u=0,c=a==null?void 0:a.cursor();if(c&&(n<0?c.childBefore(i.from):c.childAfter(i.to)))do if(n<0?c.to<=i.from:c.from>=i.to){if(u==0&&s.indexOf(c.type.name)>-1&&c.from<c.to){let d=nS(c);return{start:l,end:d?{from:d.from,to:d.to}:void 0,matched:!0}}else if(tS(c.type,n,o))u++;else if(tS(c.type,-n,o)){if(u==0){let d=nS(c);return{start:l,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1}}u--}}while(n<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function Oie(t,e,n,i,r,s,o){let a=n<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=n>0)return null;let u={from:n<0?e-1:e,to:n>0?e+1:e},c=t.doc.iterRange(e,n>0?t.doc.length:0),d=0;for(let h=0;!c.next().done&&h<=s;){let f=c.value;n<0&&(h+=f.length);let p=e+h*n;for(let m=n>0?0:f.length-1,w=n>0?f.length:-1;m!=w;m+=n){let v=o.indexOf(f[m]);if(!(v<0||i.resolveInner(p+m,1).type!=r))if(v%2==0==n>0)d++;else{if(d==1)return{start:u,end:{from:p+m,to:p+m+1},matched:v>>1==l>>1};d--}}n>0&&(h+=f.length)}return c.done?{start:u,matched:!1}:null}function bR(t,e,n,i=0,r=0){e==null&&(e=t.search(/[^\s\u00a0]/),e==-1&&(e=t.length));let s=r;for(let o=i;o<e;o++)t.charCodeAt(o)==9?s+=n-s%n:s++;return s}class X${constructor(e,n,i,r){this.string=e,this.tabSize=n,this.indentUnit=i,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let n=this.string.charAt(this.pos),i;if(typeof e=="string"?i=n==e:i=n&&(e instanceof RegExp?e.test(n):e(n)),i)return++this.pos,n}eatWhile(e){let n=this.pos;for(;this.eat(e););return this.pos>n}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let n=this.string.indexOf(e,this.pos);if(n>-1)return this.pos=n,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=bR(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:bR(this.string,null,this.tabSize)}match(e,n,i){if(typeof e=="string"){let r=o=>i?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return r(s)==r(e)?(n!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&n!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function Iie(t){return{name:t.name||"",token:t.token,blankLine:t.blankLine||(()=>{}),startState:t.startState||(()=>!0),copyState:t.copyState||Die,indent:t.indent||(()=>null),languageData:t.languageData||{},tokenTable:t.tokenTable||vC}}function Die(t){if(typeof t!="object")return t;let e={};for(let n in t){let i=t[n];e[n]=i instanceof Array?i.slice():i}return e}const xR=new WeakMap;class mC extends qr{constructor(e){let n=Zne(e.languageData),i=Iie(e),r,s=new class extends I${createParse(o,a,l){return new jie(r,o,a,l)}};super(n,s,[F$.of((o,a)=>this.getIndent(o,a))],e.name),this.topNode=$ie(n),r=this,this.streamParser=i,this.stateAfter=new it({perNode:!0}),this.tokenTable=e.tokenTable?new Z$(i.tokenTable):Bie}static define(e){return new mC(e)}getIndent(e,n){let i=as(e.state),r=i.resolve(n);for(;r&&r.type!=this.topNode;)r=r.parent;if(!r)return null;let s,{overrideIndentation:o}=e.options;o&&(s=xR.get(e.state),s!=null&&s<n-1e4&&(s=void 0));let a=gC(this,i,0,r.from,s??n),l,u;if(a?(u=a.state,l=a.pos+1):(u=this.streamParser.startState(e.unit),l=0),n-l>1e4)return null;for(;l<n;){let d=e.state.doc.lineAt(l),h=Math.min(n,d.to);if(d.length){let f=o?o(d.from):-1,p=new X$(d.text,e.state.tabSize,e.unit,f<0?void 0:f);for(;p.pos<h-d.from;)Y$(this.streamParser.token,p,u)}else this.streamParser.blankLine(u,e.unit);if(h==n)break;l=d.to+1}let c=e.lineAt(n);return o&&s==null&&xR.set(e.state,c.from),this.streamParser.indent(u,/^\s*(.*)/.exec(c.text)[1],e)}get allowsNesting(){return!1}}function gC(t,e,n,i,r){let s=n>=i&&n+e.length<=r&&e.prop(t.stateAfter);if(s)return{state:t.streamParser.copyState(s),pos:n+e.length};for(let o=e.children.length-1;o>=0;o--){let a=e.children[o],l=n+e.positions[o],u=a instanceof Ft&&l<r&&gC(t,a,l,i,r);if(u)return u}return null}function q$(t,e,n,i,r){if(r&&n<=0&&i>=e.length)return e;!r&&e.type==t.topNode&&(r=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],a=e.children[s],l;if(o<i&&a instanceof Ft){if(!(l=q$(t,a,n-o,i-o,r)))break;return r?new Ft(e.type,e.children.slice(0,s).concat(l),e.positions.slice(0,s+1),o+l.length):l}}return null}function Lie(t,e,n,i){for(let r of e){let s=r.from+(r.openStart?25:0),o=r.to-(r.openEnd?25:0),a=s<=n&&o>n&&gC(t,r.tree,0-r.offset,n,o),l;if(a&&(l=q$(t,r.tree,n+r.offset,a.pos+r.offset,!1)))return{state:a.state,tree:l}}return{state:t.streamParser.startState(i?ru(i):4),tree:Ft.empty}}class jie{constructor(e,n,i,r){this.lang=e,this.input=n,this.fragments=i,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let s=Gc.get(),o=r[0].from,{state:a,tree:l}=Lie(e,i,o,s==null?void 0:s.state);this.state=a,this.parsedPos=this.chunkStart=o+l.length;for(let u=0;u<l.children.length;u++)this.chunks.push(l.children[u]),this.chunkPos.push(l.positions[u]);s&&this.parsedPos<s.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(ru(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=Gc.get(),n=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),i=Math.min(n,this.chunkStart+2048);for(e&&(i=Math.min(i,e.viewport.to));this.parsedPos<i;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=n?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,n),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let n=this.input.chunk(e);if(this.input.lineChunks)n==`
`&&(n="");else{let i=n.indexOf(`
`);i>-1&&(n=n.slice(0,i))}return e+n.length<=this.to?n:n.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,n=this.lineAfter(e),i=e+n.length;for(let r=this.rangeIndex;;){let s=this.ranges[r].to;if(s>=i||(n=n.slice(0,s-(i-n.length)),r++,r==this.ranges.length))break;let o=this.ranges[r].from,a=this.lineAfter(o);n+=a,i=o+a.length}return{line:n,end:i}}skipGapsTo(e,n,i){for(;;){let r=this.ranges[this.rangeIndex].to,s=e+n;if(i>0?r>s:r>=s)break;let o=this.ranges[++this.rangeIndex].from;n+=o-r}return n}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,n,i,r,s){if(this.ranges.length>1){s=this.skipGapsTo(n,s,1),n+=s;let o=this.chunk.length;s=this.skipGapsTo(i,s,-1),i+=s,r+=this.chunk.length-o}return this.chunk.push(e,n,i,r),s}parseLine(e){let{line:n,end:i}=this.nextLine(),r=0,{streamParser:s}=this.lang,o=new X$(n,e?e.state.tabSize:4,e?ru(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let a=Y$(s.token,o,this.state);if(a&&(r=this.emitToken(this.lang.tokenTable.resolve(a),this.parsedPos+o.start,this.parsedPos+o.pos,4,r)),o.start>1e4)break}this.parsedPos=i,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Ft.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Fie,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Ft(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Ft(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function Y$(t,e,n){e.start=e.pos;for(let i=0;i<10;i++){let r=t(e,n);if(e.pos>e.start)return r}throw new Error("Stream parser failed to advance stream.")}const vC=Object.create(null),Lf=[Ri.none],Fie=new aC(Lf),SR=[],kR=Object.create(null),J$=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])J$[t]=Q$(vC,e);class Z${constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),J$)}resolve(e){return e?this.table[e]||(this.table[e]=Q$(this.extra,e)):0}}const Bie=new Z$(vC);function Qw(t,e){SR.indexOf(t)>-1||(SR.push(t),console.warn(e))}function Q$(t,e){let n=[];for(let a of e.split(" ")){let l=[];for(let u of a.split(".")){let c=t[u]||Be[u];c?typeof c=="function"?l.length?l=l.map(c):Qw(u,`Modifier ${u} used at start of tag`):l.length?Qw(u,`Tag ${u} used as modifier`):l=Array.isArray(c)?c:[c]:Qw(u,`Unknown highlighting tag ${u}`)}for(let u of l)n.push(u)}if(!n.length)return 0;let i=e.replace(/ /g,"_"),r=i+" "+n.map(a=>a.id),s=kR[r];if(s)return s.id;let o=kR[r]=Ri.define({id:Lf.length,name:i,props:[Kne({[i]:n})]});return Lf.push(o),o.id}function $ie(t){let e=Ri.define({id:Lf.length,name:"Document",props:[Gu.add(()=>t)],top:!0});return Lf.push(e),e}Nt.RTL,Nt.LTR;const zie=t=>{let{state:e}=t,n=e.doc.lineAt(e.selection.main.from),i=yC(t.state,n.from);return i.line?Uie(t):i.block?Gie(t):!1};function fp(t,e){return({state:n,dispatch:i})=>{if(n.readOnly)return!1;let r=t(e,n);return r?(i(n.update(r)),!0):!1}}const Uie=fp(wC,0),Vie=fp(wC,1),Hie=fp(wC,2),Wie=fp(e3,0),Gie=fp((t,e)=>e3(t,e,Xie(e)),0);function yC(t,e){let n=t.languageDataAt("commentTokens",e);return n.length?n[0]:{}}const Id=50;function Kie(t,{open:e,close:n},i,r){let s=t.sliceDoc(i-Id,i),o=t.sliceDoc(r,r+Id),a=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(o)[0].length,u=s.length-a;if(s.slice(u-e.length,u)==e&&o.slice(l,l+n.length)==n)return{open:{pos:i-a,margin:a&&1},close:{pos:r+l,margin:l&&1}};let c,d;r-i<=2*Id?c=d=t.sliceDoc(i,r):(c=t.sliceDoc(i,i+Id),d=t.sliceDoc(r-Id,r));let h=/^\s*/.exec(c)[0].length,f=/\s*$/.exec(d)[0].length,p=d.length-f-n.length;return c.slice(h,h+e.length)==e&&d.slice(p,p+n.length)==n?{open:{pos:i+h+e.length,margin:/\s/.test(c.charAt(h+e.length))?1:0},close:{pos:r-f-n.length,margin:/\s/.test(d.charAt(p-1))?1:0}}:null}function Xie(t){let e=[];for(let n of t.selection.ranges){let i=t.doc.lineAt(n.from),r=n.to<=i.to?i:t.doc.lineAt(n.to),s=e.length-1;s>=0&&e[s].to>i.from?e[s].to=r.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:r.to})}return e}function e3(t,e,n=e.selection.ranges){let i=n.map(s=>yC(e,s.from).block);if(!i.every(s=>s))return null;let r=n.map((s,o)=>Kie(e,i[o],s.from,s.to));if(t!=2&&!r.every(s=>s))return{changes:e.changes(n.map((s,o)=>r[o]?[]:[{from:s.from,insert:i[o].open+" "},{from:s.to,insert:" "+i[o].close}]))};if(t!=1&&r.some(s=>s)){let s=[];for(let o=0,a;o<r.length;o++)if(a=r[o]){let l=i[o],{open:u,close:c}=a;s.push({from:u.pos-l.open.length,to:u.pos+u.margin},{from:c.pos-c.margin,to:c.pos+l.close.length})}return{changes:s}}return null}function wC(t,e,n=e.selection.ranges){let i=[],r=-1;for(let{from:s,to:o}of n){let a=i.length,l=1e9,u=yC(e,s).line;if(u){for(let c=s;c<=o;){let d=e.doc.lineAt(c);if(d.from>r&&(s==o||o>d.from)){r=d.from;let h=/^\s*/.exec(d.text)[0].length,f=h==d.length,p=d.text.slice(h,h+u.length)==u?h:-1;h<d.text.length&&h<l&&(l=h),i.push({line:d,comment:p,token:u,indent:h,empty:f,single:!1})}c=d.to+1}if(l<1e9)for(let c=a;c<i.length;c++)i[c].indent<i[c].line.text.length&&(i[c].indent=l);i.length==a+1&&(i[a].single=!0)}}if(t!=2&&i.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:a,token:l,indent:u,empty:c,single:d}of i)(d||!c)&&s.push({from:a.from+u,insert:l+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(t!=1&&i.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:a,token:l}of i)if(a>=0){let u=o.from+a,c=u+l.length;o.text[c-o.from]==" "&&c++,s.push({from:u,to:c})}return{changes:s}}return null}const iS=Fo.define(),qie=Fo.define(),Yie=_e.define(),t3=_e.define({combine(t){return tl(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(i,r)=>e(i,r)||n(i,r)})}}),n3=li.define({create(){return Ms.empty},update(t,e){let n=e.state.facet(t3),i=e.annotation(iS);if(i){let l=Ei.fromTransaction(e,i.selection),u=i.side,c=u==0?t.undone:t.done;return l?c=$v(c,c.length,n.minDepth,l):c=s3(c,e.startState.selection),new Ms(u==0?i.rest:c,u==0?c:i.rest)}let r=e.annotation(qie);if((r=="full"||r=="before")&&(t=t.isolate()),e.annotation(ln.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let s=Ei.fromTransaction(e),o=e.annotation(ln.time),a=e.annotation(ln.userEvent);return s?t=t.addChanges(s,o,a,n,e):e.selection&&(t=t.addSelection(e.startState.selection,o,a,n.newGroupDelay)),(r=="full"||r=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new Ms(t.done.map(Ei.fromJSON),t.undone.map(Ei.fromJSON))}});function Jie(t={}){return[n3,t3.of(t),Pe.domEventHandlers({beforeinput(e,n){let i=e.inputType=="historyUndo"?i3:e.inputType=="historyRedo"?rS:null;return i?(e.preventDefault(),i(n)):!1}})]}function bC(t,e){return function({state:n,dispatch:i}){if(!e&&n.readOnly)return!1;let r=n.field(n3,!1);if(!r)return!1;let s=r.pop(t,n,e);return s?(i(s),!0):!1}}const i3=bC(0,!1),rS=bC(1,!1),Zie=bC(0,!0);class Ei{constructor(e,n,i,r,s){this.changes=e,this.effects=n,this.mapped=i,this.startSelection=r,this.selectionsAfter=s}setSelAfter(e){return new Ei(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new Ei(e.changes&&nn.fromJSON(e.changes),[],e.mapped&&Ls.fromJSON(e.mapped),e.startSelection&&ne.fromJSON(e.startSelection),e.selectionsAfter.map(ne.fromJSON))}static fromTransaction(e,n){let i=vr;for(let r of e.startState.facet(Yie)){let s=r(e);s.length&&(i=i.concat(s))}return!i.length&&e.changes.empty?null:new Ei(e.changes.invert(e.startState.doc),i,void 0,n||e.startState.selection,vr)}static selection(e){return new Ei(void 0,vr,void 0,void 0,e)}}function $v(t,e,n,i){let r=e+1>n+20?e-n-1:0,s=t.slice(r,e);return s.push(i),s}function Qie(t,e){let n=[],i=!1;return t.iterChangedRanges((r,s)=>n.push(r,s)),e.iterChangedRanges((r,s,o,a)=>{for(let l=0;l<n.length;){let u=n[l++],c=n[l++];a>=u&&o<=c&&(i=!0)}}),i}function ere(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((n,i)=>n.empty!=e.ranges[i].empty).length===0}function r3(t,e){return t.length?e.length?t.concat(e):t:e}const vr=[],tre=200;function s3(t,e){if(t.length){let n=t[t.length-1],i=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-tre));return i.length&&i[i.length-1].eq(e)?t:(i.push(e),$v(t,t.length-1,1e9,n.setSelAfter(i)))}else return[Ei.selection([e])]}function nre(t){let e=t[t.length-1],n=t.slice();return n[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function eb(t,e){if(!t.length)return t;let n=t.length,i=vr;for(;n;){let r=ire(t[n-1],e,i);if(r.changes&&!r.changes.empty||r.effects.length){let s=t.slice(0,n);return s[n-1]=r,s}else e=r.mapped,n--,i=r.selectionsAfter}return i.length?[Ei.selection(i)]:vr}function ire(t,e,n){let i=r3(t.selectionsAfter.length?t.selectionsAfter.map(a=>a.map(e)):vr,n);if(!t.changes)return Ei.selection(i);let r=t.changes.map(e),s=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(s):s;return new Ei(r,Xe.mapEffects(t.effects,e),o,t.startSelection.map(s),i)}const rre=/^(input\.type|delete)($|\.)/;class Ms{constructor(e,n,i=0,r=void 0){this.done=e,this.undone=n,this.prevTime=i,this.prevUserEvent=r}isolate(){return this.prevTime?new Ms(this.done,this.undone):this}addChanges(e,n,i,r,s){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!i||rre.test(i))&&(!a.selectionsAfter.length&&n-this.prevTime<r.newGroupDelay&&r.joinToEvent(s,Qie(a.changes,e.changes))||i=="input.type.compose")?o=$v(o,o.length-1,r.minDepth,new Ei(e.changes.compose(a.changes),r3(e.effects,a.effects),a.mapped,a.startSelection,vr)):o=$v(o,o.length,r.minDepth,e),new Ms(o,vr,n,i)}addSelection(e,n,i,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:vr;return s.length>0&&n-this.prevTime<r&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&ere(s[s.length-1],e)?this:new Ms(s3(this.done,e),this.undone,n,i)}addMapping(e){return new Ms(eb(this.done,e),eb(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,i){let r=e==0?this.done:this.undone;if(r.length==0)return null;let s=r[r.length-1],o=s.selectionsAfter[0]||n.selection;if(i&&s.selectionsAfter.length)return n.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:iS.of({side:e,rest:nre(r),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let a=r.length==1?vr:r.slice(0,r.length-1);return s.mapped&&(a=eb(a,s.mapped)),n.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:iS.of({side:e,rest:a,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Ms.empty=new Ms(vr,vr);function pp(t,e){return ne.create(t.ranges.map(e),t.mainIndex)}function ll(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function cu({state:t,dispatch:e},n){let i=pp(t.selection,n);return i.eq(t.selection,!0)?!1:(e(ll(t,i)),!0)}function o0(t,e){return ne.cursor(e?t.to:t.from)}function o3(t,e){return cu(t,n=>n.empty?t.moveByChar(n,e):o0(n,e))}function ul(t){return t.textDirectionAt(t.state.selection.main.head)==Nt.LTR}const _R=t=>o3(t,!ul(t)),CR=t=>o3(t,ul(t));function a3(t,e){return cu(t,n=>n.empty?t.moveByGroup(n,e):o0(n,e))}const sre=t=>a3(t,!ul(t)),ore=t=>a3(t,ul(t));function l3(t,e){return cu(t,n=>{if(!n.empty)return o0(n,e);let i=t.moveVertically(n,e);return i.head!=n.head?i:t.moveToLineBoundary(n,e)})}const ER=t=>l3(t,!1),AR=t=>l3(t,!0);function u3(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,i=0,r;if(e){for(let s of t.state.facet(Pe.scrollMargins)){let o=s(t);o!=null&&o.top&&(n=Math.max(o==null?void 0:o.top,n)),o!=null&&o.bottom&&(i=Math.max(o==null?void 0:o.bottom,i))}r=t.scrollDOM.clientHeight-n-i}else r=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:i,selfScroll:e,height:Math.max(t.defaultLineHeight,r-5)}}function c3(t,e){let n=u3(t),{state:i}=t,r=pp(i.selection,o=>o.empty?t.moveVertically(o,e,n.height):o0(o,e));if(r.eq(i.selection))return!1;let s;if(n.selfScroll){let o=t.coordsAtPos(i.selection.main.head),a=t.scrollDOM.getBoundingClientRect(),l=a.top+n.marginTop,u=a.bottom-n.marginBottom;o&&o.top>l&&o.bottom<u&&(s=Pe.scrollIntoView(r.main.head,{y:"start",yMargin:o.top-l}))}return t.dispatch(ll(i,r),{effects:s}),!0}const tb=t=>c3(t,!1),nb=t=>c3(t,!0);function a0(t,e,n){let i=t.lineBlockAt(e.head),r=t.moveToLineBoundary(e,n);if(r.head==e.head&&r.head!=(n?i.to:i.from)&&(r=t.moveToLineBoundary(e,n,!1)),!n&&r.head==i.from&&i.length){let s=/^\s*/.exec(t.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&e.head!=i.from+s&&(r=ne.cursor(i.from+s))}return r}const PR=t=>cu(t,e=>a0(t,e,!0)),TR=t=>cu(t,e=>a0(t,e,!1)),are=t=>cu(t,e=>ne.cursor(t.lineBlockAt(e.head).from,1)),lre=t=>cu(t,e=>ne.cursor(t.lineBlockAt(e.head).to,-1));function ure(t,e,n){let i=!1,r=pp(t.selection,s=>{let o=Em(t,s.head,-1)||Em(t,s.head,1)||s.head>0&&Em(t,s.head-1,1)||s.head<t.doc.length&&Em(t,s.head+1,-1);if(!o||!o.end)return s;i=!0;let a=o.start.from==s.head?o.end.to:o.end.from;return ne.cursor(a)});return i?(e(ll(t,r)),!0):!1}const cre=({state:t,dispatch:e})=>ure(t,e);function cl(t,e){let n=pp(t.state.selection,i=>{let r=e(i);return ne.range(i.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return n.eq(t.state.selection)?!1:(t.dispatch(ll(t.state,n)),!0)}function d3(t,e){return cl(t,n=>t.moveByChar(n,e))}const RR=t=>d3(t,!ul(t)),NR=t=>d3(t,ul(t));function h3(t,e){return cl(t,n=>t.moveByGroup(n,e))}const dre=t=>h3(t,!ul(t)),hre=t=>h3(t,ul(t));function f3(t,e){return cl(t,n=>t.moveVertically(n,e))}const MR=t=>f3(t,!1),OR=t=>f3(t,!0);function p3(t,e){return cl(t,n=>t.moveVertically(n,e,u3(t).height))}const IR=t=>p3(t,!1),DR=t=>p3(t,!0),LR=t=>cl(t,e=>a0(t,e,!0)),jR=t=>cl(t,e=>a0(t,e,!1)),fre=t=>cl(t,e=>ne.cursor(t.lineBlockAt(e.head).from)),pre=t=>cl(t,e=>ne.cursor(t.lineBlockAt(e.head).to)),FR=({state:t,dispatch:e})=>(e(ll(t,{anchor:0})),!0),BR=({state:t,dispatch:e})=>(e(ll(t,{anchor:t.doc.length})),!0),$R=({state:t,dispatch:e})=>(e(ll(t,{anchor:t.selection.main.anchor,head:0})),!0),zR=({state:t,dispatch:e})=>(e(ll(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),mre=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),gre=({state:t,dispatch:e})=>{let n=u0(t).map(({from:i,to:r})=>ne.range(i,Math.min(r+1,t.doc.length)));return e(t.update({selection:ne.create(n),userEvent:"select"})),!0};function l0(t,e){if(t.state.readOnly)return!1;let n="delete.selection",{state:i}=t,r=i.changeByRange(s=>{let{from:o,to:a}=s;if(o==a){let l=e(s);l<o?(n="delete.backward",l=Am(t,l,!1)):l>o&&(n="delete.forward",l=Am(t,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=Am(t,o,!1),a=Am(t,a,!0);return o==a?{range:s}:{changes:{from:o,to:a},range:ne.cursor(o,o<s.head?-1:1)}});return r.changes.empty?!1:(t.dispatch(i.update(r,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?Pe.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function Am(t,e,n){if(t instanceof Pe)for(let i of t.state.facet(Pe.atomicRanges).map(r=>r(t)))i.between(e,e,(r,s)=>{r<e&&s>e&&(e=n?s:r)});return e}const m3=(t,e,n)=>l0(t,i=>{let r=i.from,{state:s}=t,o=s.doc.lineAt(r),a,l;if(n&&!e&&r>o.from&&r<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,r-o.from))){if(a[a.length-1]=="	")return r-1;let u=qf(a,s.tabSize),c=u%ru(s)||ru(s);for(let d=0;d<c&&a[a.length-1-d]==" ";d++)r--;l=r}else l=Tn(o.text,r-o.from,e,e)+o.from,l==r&&o.number!=(e?s.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,r-o.from))&&(l=Tn(o.text,l-o.from,!1,!1)+o.from);return l}),ib=t=>m3(t,!1,!0),UR=t=>m3(t,!0,!1),g3=(t,e)=>l0(t,n=>{let i=n.head,{state:r}=t,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let a=null;;){if(i==(e?s.to:s.from)){i==n.head&&s.number!=(e?r.doc.lines:1)&&(i+=e?1:-1);break}let l=Tn(s.text,i-s.from,e)+s.from,u=s.text.slice(Math.min(i,l)-s.from,Math.max(i,l)-s.from),c=o(u);if(a!=null&&c!=a)break;(u!=" "||i!=n.head)&&(a=c),i=l}return i}),VR=t=>g3(t,!1),vre=t=>g3(t,!0),HR=t=>l0(t,e=>{let n=t.lineBlockAt(e.head).to;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),yre=t=>l0(t,e=>{let n=t.lineBlockAt(e.head).from;return e.head>n?n:Math.max(0,e.head-1)}),wre=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:ot.of(["",""])},range:ne.cursor(i.from)}));return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},bre=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(i=>{if(!i.empty||i.from==0||i.from==t.doc.length)return{range:i};let r=i.from,s=t.doc.lineAt(r),o=r==s.from?r-1:Tn(s.text,r-s.from,!1)+s.from,a=r==s.to?r+1:Tn(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:a,insert:t.doc.slice(r,a).append(t.doc.slice(o,r))},range:ne.cursor(a)}});return n.changes.empty?!1:(e(t.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function u0(t){let e=[],n=-1;for(let i of t.selection.ranges){let r=t.doc.lineAt(i.from),s=t.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=t.doc.lineAt(i.to-1)),n>=r.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(i)}else e.push({from:r.from,to:s.to,ranges:[i]});n=s.number+1}return e}function v3(t,e,n){if(t.readOnly)return!1;let i=[],r=[];for(let s of u0(t)){if(n?s.to==t.doc.length:s.from==0)continue;let o=t.doc.lineAt(n?s.to+1:s.from-1),a=o.length+1;if(n){i.push({from:s.to,to:o.to},{from:s.from,insert:o.text+t.lineBreak});for(let l of s.ranges)r.push(ne.range(Math.min(t.doc.length,l.anchor+a),Math.min(t.doc.length,l.head+a)))}else{i.push({from:o.from,to:s.from},{from:s.to,insert:t.lineBreak+o.text});for(let l of s.ranges)r.push(ne.range(l.anchor-a,l.head-a))}}return i.length?(e(t.update({changes:i,scrollIntoView:!0,selection:ne.create(r,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const xre=({state:t,dispatch:e})=>v3(t,e,!1),Sre=({state:t,dispatch:e})=>v3(t,e,!0);function y3(t,e,n){if(t.readOnly)return!1;let i=[];for(let r of u0(t))n?i.push({from:r.from,insert:t.doc.slice(r.from,r.to)+t.lineBreak}):i.push({from:r.to,insert:t.lineBreak+t.doc.slice(r.from,r.to)});return e(t.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const kre=({state:t,dispatch:e})=>y3(t,e,!1),_re=({state:t,dispatch:e})=>y3(t,e,!0),Cre=t=>{if(t.state.readOnly)return!1;let{state:e}=t,n=e.changes(u0(e).map(({from:r,to:s})=>(r>0?r--:s<e.doc.length&&s++,{from:r,to:s}))),i=pp(e.selection,r=>{let s;if(t.lineWrapping){let o=t.lineBlockAt(r.head),a=t.coordsAtPos(r.head,r.assoc||1);a&&(s=o.bottom+t.documentTop-a.bottom+t.defaultLineHeight/2)}return t.moveVertically(r,!0,s)}).map(n);return t.dispatch({changes:n,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Ere(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=as(t).resolveInner(e),i=n.childBefore(e),r=n.childAfter(e),s;return i&&r&&i.to<=e&&r.from>=e&&(s=i.type.prop(it.closedBy))&&s.indexOf(r.name)>-1&&t.doc.lineAt(i.to).from==t.doc.lineAt(r.from).from&&!/\S/.test(t.sliceDoc(i.to,r.from))?{from:i.to,to:r.from}:null}const WR=Are(!1);function Are(t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let i=e.changeByRange(r=>{let{from:s,to:o}=r,a=e.doc.lineAt(s),l=!t&&s==o&&Ere(e,s);t&&(s=o=(o<=a.to?a:e.doc.lineAt(o)).to);let u=new hC(e,{simulateBreak:s,simulateDoubleBreak:!!l}),c=iie(u,s);for(c==null&&(c=qf(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:s,to:o}=l:s>a.from&&s<a.from+100&&!/\S/.test(a.text.slice(0,s))&&(s=a.from);let d=["",Q1(e,c)];return l&&d.push(Q1(e,u.lineIndent(a.from,-1))),{changes:{from:s,to:o,insert:ot.of(d)},range:ne.cursor(s+1+d[1].length)}});return n(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function w3(t,e){let n=-1;return t.changeByRange(i=>{let r=[];for(let o=i.from;o<=i.to;){let a=t.doc.lineAt(o);a.number>n&&(i.empty||i.to>a.from)&&(e(a,r,i),n=a.number),o=a.to+1}let s=t.changes(r);return{changes:r,range:ne.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const sS=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(w3(t,(n,i)=>{i.push({from:n.from,insert:t.facet(dC)})}),{userEvent:"input.indent"})),!0),GR=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(w3(t,(n,i)=>{let r=/^\s*/.exec(n.text)[0];if(!r)return;let s=qf(r,t.tabSize),o=0,a=Q1(t,Math.max(0,s-ru(t)));for(;o<r.length&&o<a.length&&r.charCodeAt(o)==a.charCodeAt(o);)o++;i.push({from:n.from+o,to:n.from+r.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0);function kt(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var r=n[i];typeof r=="string"?t.setAttribute(i,r):r!=null&&(t[i]=r)}e++}for(;e<arguments.length;e++)b3(t,arguments[e]);return t}function b3(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)b3(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}const KR=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class jf{constructor(e,n,i=0,r=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,r),this.bufferStart=i,this.normalize=s?a=>s(KR(a)):KR,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ei(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=wk(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Wr(e);let r=this.normalize(n);for(let s=0,o=i;;s++){let a=r.charCodeAt(s),l=this.match(a,o,this.bufferPos+this.bufferStart);if(s==r.length-1){if(l)return this.value=l,this;break}o==i&&s<n.length&&n.charCodeAt(s)==a&&o++}}}match(e,n,i){let r=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],a=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?r={from:this.matches[s+1],to:i}:(this.matches[s]++,a=!0)),a||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:n,to:i}:this.matches.push(1,n)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(jf.prototype[Symbol.iterator]=function(){return this});const x3={from:-1,to:-1,match:/.*/.exec("")},xC="gm"+(/x/.unicode==null?"":"u");class S3{constructor(e,n,i,r=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=x3,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new k3(e,n,i,r,s);this.re=new RegExp(n,xC+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=zv(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let i=this.curLineStart+n.index,r=i+n[0].length;if(this.matchPos=zv(this.text,r+(i==r?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<r||i>this.value.to)&&(!this.test||this.test(i,r,n)))return this.value={from:i,to:r,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const rb=new WeakMap;class pc{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,i){let r=rb.get(e);if(!r||r.from>=i||r.to<=n){let a=new pc(n,e.sliceString(n,i));return rb.set(e,a),a}if(r.from==n&&r.to==i)return r;let{text:s,from:o}=r;return o>n&&(s=e.sliceString(n,o)+s,o=n),r.to<i&&(s+=e.sliceString(r.to,i)),rb.set(e,new pc(o,s)),new pc(n,s.slice(n-o,i-o))}}class k3{constructor(e,n,i,r,s){this.text=e,this.to=s,this.done=!1,this.value=x3,this.matchPos=zv(e,r),this.re=new RegExp(n,xC+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=pc.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let i=this.flat.from+n.index,r=i+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,r,n)))return this.value={from:i,to:r,match:n},this.matchPos=zv(this.text,r+(i==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=pc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(S3.prototype[Symbol.iterator]=k3.prototype[Symbol.iterator]=function(){return this});function Pre(t){try{return new RegExp(t,xC),!0}catch{return!1}}function zv(t,e){if(e>=t.length)return e;let n=t.lineAt(e),i;for(;e<n.to&&(i=n.text.charCodeAt(e-n.from))>=56320&&i<57344;)e++;return e}function oS(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),n=kt("input",{class:"cm-textfield",name:"line",value:e}),i=kt("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),t.dispatch({effects:Uv.of(!1)}),t.focus()):s.keyCode==13&&(s.preventDefault(),r())},onsubmit:s=>{s.preventDefault(),r()}},kt("label",t.state.phrase("Go to line"),": ",n)," ",kt("button",{class:"cm-button",type:"submit"},t.state.phrase("go")));function r(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!s)return;let{state:o}=t,a=o.doc.lineAt(o.selection.main.head),[,l,u,c,d]=s,h=c?+c.slice(1):0,f=u?+u:a.number;if(u&&d){let w=f/100;l&&(w=w*(l=="-"?-1:1)+a.number/o.doc.lines),f=Math.round(o.doc.lines*w)}else u&&l&&(f=f*(l=="-"?-1:1)+a.number);let p=o.doc.line(Math.max(1,Math.min(o.doc.lines,f))),m=ne.cursor(p.from+Math.max(0,Math.min(h,p.length)));t.dispatch({effects:[Uv.of(!1),Pe.scrollIntoView(m.from,{y:"center"})],selection:m}),t.focus()}return{dom:i}}const Uv=Xe.define(),XR=li.define({create(){return!0},update(t,e){for(let n of e.effects)n.is(Uv)&&(t=n.value);return t},provide:t=>af.from(t,e=>e?oS:null)}),Tre=t=>{let e=of(t,oS);if(!e){let n=[Uv.of(!0)];t.state.field(XR,!1)==null&&n.push(Xe.appendConfig.of([XR,Rre])),t.dispatch({effects:n}),e=of(t,oS)}return e&&e.dom.querySelector("input").select(),!0},Rre=Pe.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Nre=({state:t,dispatch:e})=>{let{selection:n}=t,i=ne.create(n.ranges.map(r=>t.wordAt(r.head)||ne.cursor(r.head)),n.mainIndex);return i.eq(n)?!1:(e(t.update({selection:i})),!0)};function Mre(t,e){let{main:n,ranges:i}=t.selection,r=t.wordAt(n.head),s=r&&r.from==n.from&&r.to==n.to;for(let o=!1,a=new jf(t.doc,e,i[i.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new jf(t.doc,e,0,Math.max(0,i[i.length-1].from-1)),o=!0}else{if(o&&i.some(l=>l.from==a.value.from))continue;if(s){let l=t.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const Ore=({state:t,dispatch:e})=>{let{ranges:n}=t.selection;if(n.some(s=>s.from===s.to))return Nre({state:t,dispatch:e});let i=t.sliceDoc(n[0].from,n[0].to);if(t.selection.ranges.some(s=>t.sliceDoc(s.from,s.to)!=i))return!1;let r=Mre(t,i);return r?(e(t.update({selection:t.selection.addRange(ne.range(r.from,r.to),!1),effects:Pe.scrollIntoView(r.to)})),!0):!1},ld=_e.define({combine(t){return tl(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Ure(e),scrollToMatch:e=>Pe.scrollIntoView(e)})}});class _3{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||Pre(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new jre(this):new Dre(this)}getCursor(e,n=0,i){let r=e.doc?e:Je.create({doc:e});return i==null&&(i=r.doc.length),this.regexp?Au(this,r,n,i):Eu(this,r,n,i)}}class C3{constructor(e){this.spec=e}}function Eu(t,e,n,i){return new jf(e.doc,t.unquoted,n,i,t.caseSensitive?void 0:r=>r.toLowerCase(),t.wholeWord?Ire(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function Ire(t,e){return(n,i,r,s)=>((s>n||s+r.length<i)&&(s=Math.max(0,n-2),r=t.sliceString(s,Math.min(t.length,i+2))),(e(Vv(r,n-s))!=Rn.Word||e(Hv(r,n-s))!=Rn.Word)&&(e(Hv(r,i-s))!=Rn.Word||e(Vv(r,i-s))!=Rn.Word))}class Dre extends C3{constructor(e){super(e)}nextMatch(e,n,i){let r=Eu(this.spec,e,i,e.doc.length).nextOverlapping();return r.done&&(r=Eu(this.spec,e,0,n).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,n,i){for(let r=i;;){let s=Math.max(n,r-1e4-this.spec.unquoted.length),o=Eu(this.spec,e,s,r),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(s==n)return null;r-=1e4}}prevMatch(e,n,i){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let i=Eu(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=n)return null;r.push(i.value)}return r}highlight(e,n,i,r){let s=Eu(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}function Au(t,e,n,i){return new S3(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?Lre(e.charCategorizer(e.selection.main.head)):void 0},n,i)}function Vv(t,e){return t.slice(Tn(t,e,!1),e)}function Hv(t,e){return t.slice(e,Tn(t,e))}function Lre(t){return(e,n,i)=>!i[0].length||(t(Vv(i.input,i.index))!=Rn.Word||t(Hv(i.input,i.index))!=Rn.Word)&&(t(Hv(i.input,i.index+i[0].length))!=Rn.Word||t(Vv(i.input,i.index+i[0].length))!=Rn.Word)}class jre extends C3{nextMatch(e,n,i){let r=Au(this.spec,e,i,e.doc.length).next();return r.done&&(r=Au(this.spec,e,0,n).next()),r.done?null:r.value}prevMatchInRange(e,n,i){for(let r=1;;r++){let s=Math.max(n,i-r*1e4),o=Au(this.spec,e,s,i),a=null;for(;!o.next().done;)a=o.value;if(a&&(s==n||a.from>s+10))return a;if(s==n)return null}}prevMatch(e,n,i){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(n,i)=>i=="$"?"$":i=="&"?e.match[0]:i!="0"&&+i<e.match.length?e.match[i]:n)}matchAll(e,n){let i=Au(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=n)return null;r.push(i.value)}return r}highlight(e,n,i,r){let s=Au(this.spec,e,Math.max(0,n-250),Math.min(i+250,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}const Ff=Xe.define(),SC=Xe.define(),Ia=li.define({create(t){return new sb(aS(t).create(),null)},update(t,e){for(let n of e.effects)n.is(Ff)?t=new sb(n.value.create(),t.panel):n.is(SC)&&(t=new sb(t.query,n.value?kC:null));return t},provide:t=>af.from(t,e=>e.panel)});class sb{constructor(e,n){this.query=e,this.panel=n}}const Fre=Ge.mark({class:"cm-searchMatch"}),Bre=Ge.mark({class:"cm-searchMatch cm-searchMatch-selected"}),$re=In.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(Ia))}update(t){let e=t.state.field(Ia);(e!=t.startState.field(Ia)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return Ge.none;let{view:n}=this,i=new ql;for(let r=0,s=n.visibleRanges,o=s.length;r<o;r++){let{from:a,to:l}=s[r];for(;r<o-1&&l>s[r+1].from-2*250;)l=s[++r].to;t.highlight(n.state,a,l,(u,c)=>{let d=n.state.selection.ranges.some(h=>h.from==u&&h.to==c);i.add(u,c,d?Bre:Fre)})}return i.finish()}},{decorations:t=>t.decorations});function mp(t){return e=>{let n=e.state.field(Ia,!1);return n&&n.query.spec.valid?t(e,n):R3(e)}}const qR=mp((t,{query:e})=>{let{to:n}=t.state.selection.main,i=e.nextMatch(t.state,n,n);if(!i)return!1;let r=ne.single(i.from,i.to),s=t.state.facet(ld);return t.dispatch({selection:r,effects:[_C(t,i),s.scrollToMatch(r.main,t)],userEvent:"select.search"}),T3(t),!0}),YR=mp((t,{query:e})=>{let{state:n}=t,{from:i}=n.selection.main,r=e.prevMatch(n,i,i);if(!r)return!1;let s=ne.single(r.from,r.to),o=t.state.facet(ld);return t.dispatch({selection:s,effects:[_C(t,r),o.scrollToMatch(s.main,t)],userEvent:"select.search"}),T3(t),!0}),E3=mp((t,{query:e})=>{let n=e.matchAll(t.state,1e3);return!n||!n.length?!1:(t.dispatch({selection:ne.create(n.map(i=>ne.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),zre=({state:t,dispatch:e})=>{let n=t.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:i,to:r}=n.main,s=[],o=0;for(let a=new jf(t.doc,t.sliceDoc(i,r));!a.next().done;){if(s.length>1e3)return!1;a.value.from==i&&(o=s.length),s.push(ne.range(a.value.from,a.value.to))}return e(t.update({selection:ne.create(s,o),userEvent:"select.search.matches"})),!0},JR=mp((t,{query:e})=>{let{state:n}=t,{from:i,to:r}=n.selection.main;if(n.readOnly)return!1;let s=e.nextMatch(n,i,i);if(!s)return!1;let o=[],a,l,u=[];if(s.from==i&&s.to==r&&(l=n.toText(e.getReplacement(s)),o.push({from:s.from,to:s.to,insert:l}),s=e.nextMatch(n,s.from,s.to),u.push(Pe.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(i).number)+"."))),s){let c=o.length==0||o[0].from>=s.to?0:s.to-s.from-l.length;a=ne.single(s.from-c,s.to-c),u.push(_C(t,s)),u.push(n.facet(ld).scrollToMatch(a.main,t))}return t.dispatch({changes:o,selection:a,effects:u,userEvent:"input.replace"}),!0}),A3=mp((t,{query:e})=>{if(t.state.readOnly)return!1;let n=e.matchAll(t.state,1e9).map(r=>{let{from:s,to:o}=r;return{from:s,to:o,insert:e.getReplacement(r)}});if(!n.length)return!1;let i=t.state.phrase("replaced $ matches",n.length)+".";return t.dispatch({changes:n,effects:Pe.announce.of(i),userEvent:"input.replace.all"}),!0});function kC(t){return t.state.facet(ld).createPanel(t)}function aS(t,e){var n,i,r,s,o;let a=t.selection.main,l=a.empty||a.to>a.from+100?"":t.sliceDoc(a.from,a.to);if(e&&!l)return e;let u=t.facet(ld);return new _3({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:u.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(i=e==null?void 0:e.caseSensitive)!==null&&i!==void 0?i:u.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:u.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:u.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:u.wholeWord})}function P3(t){let e=of(t,kC);return e&&e.dom.querySelector("[main-field]")}function T3(t){let e=P3(t);e&&e==t.root.activeElement&&e.select()}const R3=t=>{let e=t.state.field(Ia,!1);if(e&&e.panel){let n=P3(t);if(n&&n!=t.root.activeElement){let i=aS(t.state,e.query.spec);i.valid&&t.dispatch({effects:Ff.of(i)}),n.focus(),n.select()}}else t.dispatch({effects:[SC.of(!0),e?Ff.of(aS(t.state,e.query.spec)):Xe.appendConfig.of(Hre)]});return!0},N3=t=>{let e=t.state.field(Ia,!1);if(!e||!e.panel)return!1;let n=of(t,kC);return n&&n.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:SC.of(!1)}),!0};class Ure{constructor(e){this.view=e;let n=this.query=e.state.field(Ia).query.spec;this.commit=this.commit.bind(this),this.searchField=kt("input",{value:n.search,placeholder:Oi(e,"Find"),"aria-label":Oi(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=kt("input",{value:n.replace,placeholder:Oi(e,"Replace"),"aria-label":Oi(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=kt("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=kt("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=kt("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function i(r,s,o){return kt("button",{class:"cm-button",name:r,onclick:s,type:"button"},o)}this.dom=kt("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,i("next",()=>qR(e),[Oi(e,"next")]),i("prev",()=>YR(e),[Oi(e,"previous")]),i("select",()=>E3(e),[Oi(e,"all")]),kt("label",null,[this.caseField,Oi(e,"match case")]),kt("label",null,[this.reField,Oi(e,"regexp")]),kt("label",null,[this.wordField,Oi(e,"by word")]),...e.state.readOnly?[]:[kt("br"),this.replaceField,i("replace",()=>JR(e),[Oi(e,"replace")]),i("replaceAll",()=>A3(e),[Oi(e,"replace all")])],kt("button",{name:"close",onclick:()=>N3(e),"aria-label":Oi(e,"close"),type:"button"},["×"])])}commit(){let e=new _3({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Ff.of(e)}))}keydown(e){pH(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?YR:qR)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),JR(this.view))}update(e){for(let n of e.transactions)for(let i of n.effects)i.is(Ff)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(ld).top}}function Oi(t,e){return t.state.phrase(e)}const Pm=30,Tm=/[\s\.,:;?!]/;function _C(t,{from:e,to:n}){let i=t.state.doc.lineAt(e),r=t.state.doc.lineAt(n).to,s=Math.max(i.from,e-Pm),o=Math.min(r,n+Pm),a=t.state.sliceDoc(s,o);if(s!=i.from){for(let l=0;l<Pm;l++)if(!Tm.test(a[l+1])&&Tm.test(a[l])){a=a.slice(l);break}}if(o!=r){for(let l=a.length-1;l>a.length-Pm;l--)if(!Tm.test(a[l-1])&&Tm.test(a[l])){a=a.slice(0,l);break}}return Pe.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${i.number}.`)}const Vre=Pe.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Hre=[Ia,Kf.low($re),Vre];class Wre{constructor(e,n,i,r){this.state=e,this.pos=n,this.explicit=i,this.view=r,this.abortListeners=[]}tokenBefore(e){let n=as(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),i=Math.max(n.from,this.pos-250),r=n.text.slice(i-n.from,this.pos-n.from),s=r.search(M3(e,!1));return s<0?null:{from:i+s,to:this.pos,text:r.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,n){e=="abort"&&this.abortListeners&&this.abortListeners.push(n)}}function ZR(t){let e=Object.keys(t).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Gre(t){let e=Object.create(null),n=Object.create(null);for(let{label:r}of t){e[r[0]]=!0;for(let s=1;s<r.length;s++)n[r[s]]=!0}let i=ZR(e)+ZR(n)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function Kre(t){let e=t.map(r=>typeof r=="string"?{label:r}:r),[n,i]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:Gre(e);return r=>{let s=r.matchBefore(i);return s||r.explicit?{from:s?s.from:r.pos,options:e,validFor:n}:null}}class QR{constructor(e,n,i,r){this.completion=e,this.source=n,this.match=i,this.score=r}}function mc(t){return t.selection.main.from}function M3(t,e){var n;let{source:i}=t,r=e&&i[0]!="^",s=i[i.length-1]!="$";return!r&&!s?t:new RegExp(`${r?"^":""}(?:${i})${s?"$":""}`,(n=t.flags)!==null&&n!==void 0?n:t.ignoreCase?"i":"")}const O3=Fo.define();function Xre(t,e,n,i){let{main:r}=t.selection,s=n-r.from,o=i-r.from;return Object.assign(Object.assign({},t.changeByRange(a=>a!=r&&n!=i&&t.sliceDoc(a.from+s,a.from+o)!=t.sliceDoc(n,i)?{range:a}:{changes:{from:a.from+s,to:i==r.from?a.to:a.from+o,insert:e},range:ne.cursor(a.from+s+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const eN=new WeakMap;function qre(t){if(!Array.isArray(t))return t;let e=eN.get(t);return e||eN.set(t,e=Kre(t)),e}const I3=Xe.define(),CC=Xe.define();class Yre{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let i=ei(e,n),r=Wr(i);this.chars.push(i);let s=e.slice(n,n+r),o=s.toUpperCase();this.folded.push(ei(o==s?s.toLowerCase():o,0)),n+=r}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:n,folded:i,any:r,precise:s,byWord:o}=this;if(n.length==1){let y=ei(e,0),b=Wr(y),k=b==e.length?0:-100;if(y!=n[0])if(y==i[0])k+=-200;else return null;return this.ret(k,[0,b])}let a=e.indexOf(this.pattern);if(a==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=n.length,u=0;if(a<0){for(let y=0,b=Math.min(e.length,200);y<b&&u<l;){let k=ei(e,y);(k==n[u]||k==i[u])&&(r[u++]=y),y+=Wr(k)}if(u<l)return null}let c=0,d=0,h=!1,f=0,p=-1,m=-1,w=/[a-z]/.test(e),v=!0;for(let y=0,b=Math.min(e.length,200),k=0;y<b&&d<l;){let _=ei(e,y);a<0&&(c<l&&_==n[c]&&(s[c++]=y),f<l&&(_==n[f]||_==i[f]?(f==0&&(p=y),m=y+1,f++):f=0));let E,A=_<255?_>=48&&_<=57||_>=97&&_<=122?2:_>=65&&_<=90?1:0:(E=wk(_))!=E.toLowerCase()?1:E!=E.toUpperCase()?2:0;(!y||A==1&&w||k==0&&A!=0)&&(n[d]==_||i[d]==_&&(h=!0)?o[d++]=y:o.length&&(v=!1)),k=A,y+=Wr(_)}return d==l&&o[0]==0&&v?this.result(-100+(h?-200:0),o,e):f==l&&p==0?this.ret(-200-e.length+(m==e.length?0:-100),[0,m]):a>-1?this.ret(-700-e.length,[a,a+this.pattern.length]):f==l?this.ret(-900-e.length,[p,m]):d==l?this.result(-100+(h?-200:0)+-700+(v?0:-1100),o,e):n.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,n,i){let r=[],s=0;for(let o of n){let a=o+(this.astral?Wr(ei(i,o)):1);s&&r[s-1]==o?r[s-1]=a:(r[s++]=o,r[s++]=a)}return this.ret(e-i.length,r)}}class Jre{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let n=e.slice(0,this.pattern.length),i=n==this.pattern?0:n.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,n.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const Ts=_e.define({combine(t){return tl(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Zre,filterStrict:!1,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>i=>tN(e(i),n(i)),optionClass:(e,n)=>i=>tN(e(i),n(i)),addToOptions:(e,n)=>e.concat(n),filterStrict:(e,n)=>e||n})}});function tN(t,e){return t?e?t+" "+e:t:e}function Zre(t,e,n,i,r,s){let o=t.textDirection==Nt.RTL,a=o,l=!1,u="top",c,d,h=e.left-r.left,f=r.right-e.right,p=i.right-i.left,m=i.bottom-i.top;if(a&&h<Math.min(p,f)?a=!1:!a&&f<Math.min(p,h)&&(a=!0),p<=(a?h:f))c=Math.max(r.top,Math.min(n.top,r.bottom-m))-e.top,d=Math.min(400,a?h:f);else{l=!0,d=Math.min(400,(o?e.right:r.right-e.left)-30);let y=r.bottom-e.bottom;y>=m||y>e.top?c=n.bottom-e.top:(u="bottom",c=e.bottom-n.top)}let w=(e.bottom-e.top)/s.offsetHeight,v=(e.right-e.left)/s.offsetWidth;return{style:`${u}: ${c/w}px; max-width: ${d/v}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":a?"left":"right")}}function Qre(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(n){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),n.type&&i.classList.add(...n.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(n,i,r,s){let o=document.createElement("span");o.className="cm-completionLabel";let a=n.displayLabel||n.label,l=0;for(let u=0;u<s.length;){let c=s[u++],d=s[u++];c>l&&o.appendChild(document.createTextNode(a.slice(l,c)));let h=o.appendChild(document.createElement("span"));h.appendChild(document.createTextNode(a.slice(c,d))),h.className="cm-completionMatchedText",l=d}return l<a.length&&o.appendChild(document.createTextNode(a.slice(l))),o},position:50},{render(n){if(!n.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=n.detail,i},position:80}),e.sort((n,i)=>n.position-i.position).map(n=>n.render)}function ob(t,e,n){if(t<=n)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let r=Math.floor(e/n);return{from:r*n,to:(r+1)*n}}let i=Math.floor((t-e)/n);return{from:t-(i+1)*n,to:t-i*n}}class ese{constructor(e,n,i){this.view=e,this.stateField=n,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let r=e.state.field(n),{options:s,selected:o}=r.open,a=e.state.facet(Ts);this.optionContent=Qre(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=ob(s.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:u}=e.state.field(n).open;for(let c=l.target,d;c&&c!=this.dom;c=c.parentNode)if(c.nodeName=="LI"&&(d=/-(\d+)$/.exec(c.id))&&+d[1]<u.length){this.applyCompletion(e,u[+d[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let u=e.state.field(this.stateField,!1);u&&u.tooltip&&e.state.facet(Ts).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:CC.of(null)})}),this.showOptions(s,r.id)}mount(){this.updateSel()}showOptions(e,n){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,n,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var n;let i=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=r){let{options:s,selected:o,disabled:a}=i.open;(!r.open||r.open.options!=s)&&(this.range=ob(s.length,o,e.state.facet(Ts).maxRenderedOptions),this.showOptions(s,i.id)),this.updateSel(),a!=((n=r.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of n.split(" "))i&&this.dom.classList.add(i);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;if((n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=ob(n.options.length,n.selected,this.view.state.facet(Ts).maxRenderedOptions),this.showOptions(n.options,e.id)),this.updateSelectedOption(n.selected)){this.destroyInfo();let{completion:i}=n.options[n.selected],{info:r}=i;if(!r)return;let s=typeof r=="string"?document.createTextNode(r):r(i);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,i)}).catch(o=>Vi(this.view.state,o,"completion info")):this.addInfoPane(s,i)}}addInfoPane(e,n){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:s}=e;i.appendChild(r),this.infoDestroy=s||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let i=this.list.firstChild,r=this.range.from;i;i=i.nextSibling,r++)i.nodeName!="LI"||!i.id?r--:r==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),n=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return n&&nse(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.defaultView||window;s={left:0,top:0,right:o.innerWidth,bottom:o.innerHeight}}return r.top>Math.min(s.bottom,n.bottom)-10||r.bottom<Math.max(s.top,n.top)+10?null:this.view.state.facet(Ts).positionInfo(this.view,n,r,i,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,i){const r=document.createElement("ul");r.id=n,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));let s=null;for(let o=i.from;o<i.to;o++){let{completion:a,match:l}=e[o],{section:u}=a;if(u){let h=typeof u=="string"?u:u.name;if(h!=s&&(o>i.from||i.from==0))if(s=h,typeof u!="string"&&u.header)r.appendChild(u.header(u));else{let f=r.appendChild(document.createElement("completion-section"));f.textContent=h}}const c=r.appendChild(document.createElement("li"));c.id=n+"-"+o,c.setAttribute("role","option");let d=this.optionClass(a);d&&(c.className=d);for(let h of this.optionContent){let f=h(a,this.view.state,this.view,l);f&&c.appendChild(f)}}return i.from&&r.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function tse(t,e){return n=>new ese(n,t,e)}function nse(t,e){let n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),r=n.height/t.offsetHeight;i.top<n.top?t.scrollTop-=(n.top-i.top)/r:i.bottom>n.bottom&&(t.scrollTop+=(i.bottom-n.bottom)/r)}function nN(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function ise(t,e){let n=[],i=null,r=u=>{n.push(u);let{section:c}=u.completion;if(c){i||(i=[]);let d=typeof c=="string"?c:c.name;i.some(h=>h.name==d)||i.push(typeof c=="string"?{name:d}:c)}},s=e.facet(Ts);for(let u of t)if(u.hasResult()){let c=u.result.getMatch;if(u.result.filter===!1)for(let d of u.result.options)r(new QR(d,u.source,c?c(d):[],1e9-n.length));else{let d=e.sliceDoc(u.from,u.to),h,f=s.filterStrict?new Jre(d):new Yre(d);for(let p of u.result.options)if(h=f.match(p.label)){let m=p.displayLabel?c?c(p,h.matched):[]:h.matched;r(new QR(p,u.source,m,h.score+(p.boost||0)))}}}if(i){let u=Object.create(null),c=0,d=(h,f)=>{var p,m;return((p=h.rank)!==null&&p!==void 0?p:1e9)-((m=f.rank)!==null&&m!==void 0?m:1e9)||(h.name<f.name?-1:1)};for(let h of i.sort(d))c-=1e5,u[h.name]=c;for(let h of n){let{section:f}=h.completion;f&&(h.score+=u[typeof f=="string"?f:f.name])}}let o=[],a=null,l=s.compareCompletions;for(let u of n.sort((c,d)=>d.score-c.score||l(c.completion,d.completion))){let c=u.completion;!a||a.label!=c.label||a.detail!=c.detail||a.type!=null&&c.type!=null&&a.type!=c.type||a.apply!=c.apply||a.boost!=c.boost?o.push(u):nN(u.completion)>nN(a)&&(o[o.length-1]=u),a=u.completion}return o}class Ku{constructor(e,n,i,r,s,o){this.options=e,this.attrs=n,this.tooltip=i,this.timestamp=r,this.selected=s,this.disabled=o}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new Ku(this.options,iN(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,i,r,s){let o=ise(e,n);if(!o.length)return r&&e.some(l=>l.state==1)?new Ku(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;let a=n.facet(Ts).selectOnOpen?0:-1;if(r&&r.selected!=a&&r.selected!=-1){let l=r.options[r.selected].completion;for(let u=0;u<o.length;u++)if(o[u].completion==l){a=u;break}}return new Ku(o,iN(i,a),{pos:e.reduce((l,u)=>u.hasResult()?Math.min(l,u.from):l,1e8),create:dse,above:s.aboveCursor},r?r.timestamp:Date.now(),a,!1)}map(e){return new Ku(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Wv{constructor(e,n,i){this.active=e,this.id=n,this.open=i}static start(){return new Wv(ase,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,i=n.facet(Ts),s=(i.override||n.languageDataAt("autocomplete",mc(n)).map(qre)).map(a=>(this.active.find(u=>u.source==a)||new pr(a,this.active.some(u=>u.state!=0)?1:0)).update(e,i));s.length==this.active.length&&s.every((a,l)=>a==this.active[l])&&(s=this.active);let o=this.open;o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(a=>a.hasResult()&&e.changes.touchesRange(a.from,a.to))||!rse(s,this.active)?o=Ku.build(s,n,this.id,o,i):o&&o.disabled&&!s.some(a=>a.state==1)&&(o=null),!o&&s.every(a=>a.state!=1)&&s.some(a=>a.hasResult())&&(s=s.map(a=>a.hasResult()?new pr(a.source,0):a));for(let a of e.effects)a.is(D3)&&(o=o&&o.setSelected(a.value,this.id));return s==this.active&&o==this.open?this:new Wv(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?sse:ose}}function rse(t,e){if(t==e)return!0;for(let n=0,i=0;;){for(;n<t.length&&!t[n].hasResult;)n++;for(;i<e.length&&!e[i].hasResult;)i++;let r=n==t.length,s=i==e.length;if(r||s)return r==s;if(t[n++].result!=e[i++].result)return!1}}const sse={"aria-autocomplete":"list"},ose={};function iN(t,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(n["aria-activedescendant"]=t+"-"+e),n}const ase=[];function lse(t,e){if(t.isUserEvent("input.complete")){let i=t.annotation(O3);if(i&&e.activateOnCompletion(i))return 12}let n=t.isUserEvent("input.type");return n&&e.activateOnTyping?5:n?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class pr{constructor(e,n,i=-1){this.source=e,this.state=n,this.explicitPos=i}hasResult(){return!1}update(e,n){let i=lse(e,n),r=this;(i&8||i&16&&this.touches(e))&&(r=new pr(r.source,0)),i&4&&r.state==0&&(r=new pr(this.source,1)),r=r.updateFor(e,i);for(let s of e.effects)if(s.is(I3))r=new pr(r.source,1,s.value?mc(e.state):-1);else if(s.is(CC))r=new pr(r.source,0);else if(s.is(cse))for(let o of s.value)o.source==r.source&&(r=o);return r}updateFor(e,n){return this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new pr(this.source,this.state,e.mapPos(this.explicitPos))}touches(e){return e.changes.touchesRange(mc(e.state))}}class Ch extends pr{constructor(e,n,i,r,s){super(e,2,n),this.result=i,this.from=r,this.to=s}hasResult(){return!0}updateFor(e,n){var i;if(!(n&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=mc(e.state);if((this.explicitPos<0?a<=s:a<this.from)||a>o||!r||n&2&&mc(e.startState)==this.from)return new pr(this.source,n&4?1:0);let l=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return use(r.validFor,e.state,s,o)?new Ch(this.source,l,r,s,o):r.update&&(r=r.update(r,s,o,new Wre(e.state,a,l>=0)))?new Ch(this.source,l,r,r.from,(i=r.to)!==null&&i!==void 0?i:mc(e.state)):new pr(this.source,1,l)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Ch(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new pr(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function use(t,e,n,i){if(!t)return!1;let r=e.sliceDoc(n,i);return typeof t=="function"?t(r,n,i,e):M3(t,!0).test(r)}const cse=Xe.define({map(t,e){return t.map(n=>n.map(e))}}),D3=Xe.define(),ud=li.define({create(){return Wv.start()},update(t,e){return t.update(e)},provide:t=>[Nk.from(t,e=>e.tooltip),Pe.contentAttributes.from(t,e=>e.attrs)]});function L3(t,e){const n=e.completion.apply||e.completion.label;let i=t.state.field(ud).active.find(r=>r.source==e.source);return i instanceof Ch?(typeof n=="string"?t.dispatch(Object.assign(Object.assign({},Xre(t.state,n,i.from,i.to)),{annotations:O3.of(e.completion)})):n(t,e.completion,i.from,i.to),!0):!1}const dse=tse(ud,L3);function Rm(t,e="option"){return n=>{let i=n.state.field(ud,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<n.state.facet(Ts).interactionDelay)return!1;let r=1,s;e=="page"&&(s=GH(n,i.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=i.open.options,a=i.open.selected>-1?i.open.selected+r*(t?1:-1):t?0:o-1;return a<0?a=e=="page"?0:o-1:a>=o&&(a=e=="page"?o-1:0),n.dispatch({effects:D3.of(a)}),!0}}const rN=t=>{let e=t.state.field(ud,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(Ts).interactionDelay?!1:L3(t,e.open.options[e.open.selected])},hse=t=>t.state.field(ud,!1)?(t.dispatch({effects:I3.of(!0)}),!0):!1,fse=t=>{let e=t.state.field(ud,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(t.dispatch({effects:CC.of(null)}),!0)},j3={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},F3=new class extends Xl{};F3.startSide=1;F3.endSide=-1;const ab="()[]{}<>";function pse(t){for(let e=0;e<ab.length;e+=2)if(ab.charCodeAt(e)==t)return ab.charAt(e+1);return wk(t<128?t:t+1)}function mse(t,e){return t.languageDataAt("closeBrackets",e)[0]||j3}const gse=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=mse(t,t.selection.main.head).brackets||j3.brackets,r=null,s=t.changeByRange(o=>{if(o.empty){let a=yse(t.doc,o.head);for(let l of i)if(l==a&&vse(t.doc,o.head)==pse(ei(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:ne.cursor(o.head-l.length)}}return{range:r=o}});return r||e(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!r};function vse(t,e){let n=t.sliceString(e,e+2);return n.slice(0,Wr(ei(n,0)))}function yse(t,e){let n=t.sliceString(e-2,e);return Wr(ei(n,0))==n.length?n:n.slice(1)}class wse{constructor(e,n,i){this.from=e,this.to=n,this.diagnostic=i}}class Al{constructor(e,n,i){this.diagnostics=e,this.panel=n,this.selected=i}static init(e,n,i){let r=e,s=i.facet(Os).markerFilter;s&&(r=s(r,i));let o=Ge.set(r.map(a=>a.from==a.to||a.from==a.to-1&&i.doc.lineAt(a.from).to==a.from?Ge.widget({widget:new Tse(a),diagnostic:a}).range(a.from):Ge.mark({attributes:{class:"cm-lintRange cm-lintRange-"+a.severity+(a.markClass?" "+a.markClass:"")},diagnostic:a}).range(a.from,a.to)),!0);return new Al(o,n,qc(o))}}function qc(t,e=null,n=0){let i=null;return t.between(n,1e9,(r,s,{spec:o})=>{if(!(e&&o.diagnostic!=e))return i=new wse(r,s,o.diagnostic),!1}),i}function bse(t,e){let n=e.pos,i=e.end||n,r=t.state.facet(Os).hideOn(t,n,i);if(r!=null)return r;let s=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(o=>o.is(EC))||t.changes.touchesRange(s.from,Math.max(s.to,i)))}function B3(t,e){return t.field(Wi,!1)?e:e.concat(Xe.appendConfig.of(V3))}function xse(t,e){return{effects:B3(t,[EC.of(e)])}}const EC=Xe.define(),AC=Xe.define(),$3=Xe.define(),Wi=li.define({create(){return new Al(Ge.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let n=t.diagnostics.map(e.changes),i=null,r=t.panel;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);i=qc(n,t.selected.diagnostic,s)||qc(n,null,s)}!n.size&&r&&e.state.facet(Os).autoPanel&&(r=null),t=new Al(n,r,i)}for(let n of e.effects)if(n.is(EC)){let i=e.state.facet(Os).autoPanel?n.value.length?Bf.open:null:t.panel;t=Al.init(n.value,i,e.state)}else n.is(AC)?t=new Al(t.diagnostics,n.value?Bf.open:null,t.selected):n.is($3)&&(t=new Al(t.diagnostics,t.panel,n.value));return t},provide:t=>[af.from(t,e=>e.panel),Pe.decorations.from(t,e=>e.diagnostics)]}),Sse=Ge.mark({class:"cm-lintRange cm-lintRange-active"});function kse(t,e,n){let{diagnostics:i}=t.state.field(Wi),r=[],s=2e8,o=0;i.between(e-(n<0?1:0),e+(n>0?1:0),(l,u,{spec:c})=>{e>=l&&e<=u&&(l==u||(e>l||n>0)&&(e<u||n<0))&&(r.push(c.diagnostic),s=Math.min(l,s),o=Math.max(u,o))});let a=t.state.facet(Os).tooltipFilter;return a&&(r=a(r,t.state)),r.length?{pos:s,end:o,above:t.state.doc.lineAt(s).to<o,create(){return{dom:_se(t,r)}}}:null}function _se(t,e){return kt("ul",{class:"cm-tooltip-lint"},e.map(n=>U3(t,n,!1)))}const Cse=t=>{let e=t.state.field(Wi,!1);(!e||!e.panel)&&t.dispatch({effects:B3(t.state,[AC.of(!0)])});let n=of(t,Bf.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},sN=t=>{let e=t.state.field(Wi,!1);return!e||!e.panel?!1:(t.dispatch({effects:AC.of(!1)}),!0)},Ese=t=>{let e=t.state.field(Wi,!1);if(!e)return!1;let n=t.state.selection.main,i=e.diagnostics.iter(n.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==n.from&&i.to==n.to)?!1:(t.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},Ase=In.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(Os);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);let t=Date.now();if(t<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:e}=this.view,{sources:n}=e.facet(Os);n.length&&Promise.all(n.map(i=>Promise.resolve(i(this.view)))).then(i=>{let r=i.reduce((s,o)=>s.concat(o));this.view.state.doc==e.doc&&this.view.dispatch(xse(this.view.state,r))},i=>{Vi(this.view.state,i)})}}update(t){let e=t.state.facet(Os);(t.docChanged||e!=t.startState.facet(Os)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),Os=_e.define({combine(t){return Object.assign({sources:t.map(e=>e.source).filter(e=>e!=null)},tl(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,n)=>e?n?i=>e(i)||n(i):e:n}))}});function Pse(t,e={}){return[Os.of({source:t,config:e}),Ase,V3]}function z3(t){let e=[];if(t)e:for(let{name:n}of t){for(let i=0;i<n.length;i++){let r=n[i];if(/[a-zA-Z]/.test(r)&&!e.some(s=>s.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function U3(t,e,n){var i;let r=n?z3(e.actions):[];return kt("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},kt("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((s,o)=>{let a=!1,l=h=>{if(h.preventDefault(),a)return;a=!0;let f=qc(t.state.field(Wi).diagnostics,e);f&&s.apply(t,f.from,f.to)},{name:u}=s,c=r[o]?u.indexOf(r[o]):-1,d=c<0?u:[u.slice(0,c),kt("u",u.slice(c,c+1)),u.slice(c+1)];return kt("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${u}${c<0?"":` (access key "${r[o]})"`}.`},d)}),e.source&&kt("div",{class:"cm-diagnosticSource"},e.source))}class Tse extends nl{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return kt("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class oN{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=U3(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Bf{constructor(e){this.view=e,this.items=[];let n=r=>{if(r.keyCode==27)sN(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=z3(s.actions);for(let a=0;a<o.length;a++)if(o[a].toUpperCase().charCodeAt(0)==r.keyCode){let l=qc(this.view.state.field(Wi).diagnostics,s);l&&s.actions[a].apply(e,l.from,l.to)}}else return;r.preventDefault()},i=r=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(r.target)&&this.moveSelection(s)};this.list=kt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:i}),this.dom=kt("div",{class:"cm-panel-lint"},this.list,kt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>sN(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(Wi).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(Wi),i=0,r=!1,s=null;for(e.between(0,this.view.state.doc.length,(o,a,{spec:l})=>{let u=-1,c;for(let d=i;d<this.items.length;d++)if(this.items[d].diagnostic==l.diagnostic){u=d;break}u<0?(c=new oN(this.view,l.diagnostic),this.items.splice(i,0,c),r=!0):(c=this.items[u],u>i&&(this.items.splice(i,u-i),r=!0)),n&&c.diagnostic==n.diagnostic?c.dom.hasAttribute("aria-selected")||(c.dom.setAttribute("aria-selected","true"),s=c):c.dom.hasAttribute("aria-selected")&&c.dom.removeAttribute("aria-selected"),i++});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new oN(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:a})=>{let l=a.height/this.list.offsetHeight;o.top<a.top?this.list.scrollTop-=(a.top-o.top)/l:o.bottom>a.bottom&&(this.list.scrollTop+=(o.bottom-a.bottom)/l)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function n(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)n();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(Wi),i=qc(n.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:$3.of(i)})}static open(e){return new Bf(e)}}function Rse(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function Nm(t){return Rse(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const Nse=Pe.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Nm("#d11")},".cm-lintRange-warning":{backgroundImage:Nm("orange")},".cm-lintRange-info":{backgroundImage:Nm("#999")},".cm-lintRange-hint":{backgroundImage:Nm("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),V3=[Wi,Pe.decorations.compute([Wi],t=>{let{selected:e,panel:n}=t.field(Wi);return!e||!n||e.from==e.to?Ge.none:Ge.set([Sse.range(e.from,e.to)])}),WH(kse,{hideOn:bse}),Nse],H3=t=>e=>{const n=t==="down";let i=e.state.selection;for(const r of i.ranges)i=i.addRange(e.moveVertically(r,n));return e.dispatch({selection:i}),!0},Mse=H3("up"),Ose=H3("down"),Ise=t=>{let e=null;for(const n of t.state.selection.ranges)if(!n.empty)for(let i=n.from;i<=n.to;){const r=t.state.doc.lineAt(i),s=Math.min(r.to,n.to);e?e=e.addRange(ne.range(s,s)):e=ne.single(s),i=r.to+1}return e?(t.dispatch({selection:e}),!0):!1},Dse=[{key:"Ctrl-Space",run:hse},{key:"Escape",run:fse},{key:"ArrowDown",run:Rm(!0)},{key:"ArrowUp",run:Rm(!1)},{key:"PageDown",run:Rm(!0,"page")},{key:"PageUp",run:Rm(!1,"page")},{key:"Enter",run:rN},{key:"Tab",run:rN},{key:"Mod-f",run:R3,scope:"editor search-panel"},{key:"Escape",run:N3,scope:"editor search-panel"},{key:"Alt-Enter",run:E3,scope:"editor search-panel"},{key:"Mod-Alt-Enter",run:A3,scope:"editor search-panel"},{key:"Ctrl-g",run:Tre},{key:"Mod-d",run:Ore,preventDefault:!0},{key:"Shift-Mod-l",run:zre},{key:"Enter",run:WR,shift:WR},{key:"ArrowLeft",run:_R,shift:RR,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:sre,shift:dre},{key:"ArrowRight",run:CR,shift:NR,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:ore,shift:hre},{key:"ArrowUp",run:ER,shift:MR,preventDefault:!0},{key:"ArrowDown",run:AR,shift:OR,preventDefault:!0},{key:"Home",run:TR,shift:jR},{mac:"Cmd-ArrowLeft",run:TR,shift:jR},{key:"Mod-Home",run:FR,shift:$R},{mac:"Cmd-ArrowUp",run:FR,shift:$R},{key:"PageUp",run:tb,shift:IR},{mac:"Ctrl-ArrowUp",run:tb,shift:IR},{key:"PageDown",run:nb,shift:DR},{mac:"Ctrl-ArrowDown",run:nb,shift:DR},{key:"End",run:PR,shift:LR},{mac:"Cmd-ArrowRight",run:PR,shift:LR},{key:"Mod-Alt-ArrowUp",linux:"Shift-Alt-ArrowUp",run:Mse,preventDefault:!0},{key:"Mod-Alt-ArrowDown",linux:"Shift-Alt-ArrowDown",run:Ose,preventDefault:!0},{key:"Shift-Alt-i",run:Ise},{key:"Mod-End",run:BR,shift:zR},{mac:"Cmd-ArrowDown",run:BR,shift:zR},{key:"Mod-a",run:mre},{key:"Backspace",run:gse},{key:"Backspace",run:ib,shift:ib},{key:"Delete",run:UR},{key:"Mod-Backspace",mac:"Alt-Backspace",run:VR},{key:"Mod-Delete",mac:"Alt-Delete",run:vre},{mac:"Mod-Backspace",run:yre},{mac:"Mod-Delete",run:HR},{mac:"Ctrl-b",run:_R,shift:RR,preventDefault:!0},{mac:"Ctrl-f",run:CR,shift:NR},{mac:"Ctrl-p",run:ER,shift:MR},{mac:"Ctrl-n",run:AR,shift:OR},{mac:"Ctrl-a",run:are,shift:fre},{mac:"Ctrl-e",run:lre,shift:pre},{mac:"Ctrl-d",run:UR},{mac:"Ctrl-h",run:ib},{mac:"Ctrl-k",run:HR},{mac:"Ctrl-Alt-h",run:VR},{mac:"Ctrl-o",run:wre},{mac:"Ctrl-t",run:bre},{mac:"Ctrl-v",run:nb},{mac:"Alt-v",run:tb},{key:"Shift-Mod-k",run:Cre},{key:"Alt-ArrowDown",run:Sre},{key:"Alt-ArrowUp",run:xre},{win:"Shift-Alt-ArrowDown",mac:"Shift-Alt-ArrowDown",run:_re},{win:"Shift-Alt-ArrowUp",mac:"Shift-Alt-ArrowUp",run:kre},{key:"Mod-l",run:gre,preventDefault:!0},{key:"Shift-Mod-\\",run:cre},{key:"Tab",run:sS,shift:GR,preventDefault:!0},{key:"Mod-[",run:GR},{key:"Mod-]",run:sS},{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:vie},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:yie},{key:"Mod-k Mod-0",run:wie},{key:"Mod-k Mod-j",run:bie},{key:"Mod-k Mod-c",run:Vie},{key:"Mod-k Mod-u",run:Hie},{key:"Mod-/",run:zie},{key:"Shift-Alt-a",run:Wie},{key:"Mod-z",run:i3,preventDefault:!0},{key:"Mod-y",run:rS,preventDefault:!0},{key:"Mod-Shift-z",run:rS,preventDefault:!0},{key:"Mod-u",run:Zie,preventDefault:!0},{key:"Mod-Shift-m",run:Cse},{key:"F8",run:Ese}],lS=Ae(0);function Lse(){const t=mt(),e=Xt(lS);return g.jsxs("div",{className:"flex items-center justify-between border-t border-stone-600 bg-stone-800 px-3 font-sans text-xs tracking-wider text-stone-400",children:[g.jsx(nX,{}),g.jsx("span",{className:ze(e>0&&"font-semibold text-red-400"),children:t("editor.lintSummary",e)})]})}const fi={character:Be.character,comment:Be.comment,"data-directive":Sn.define(),identifier:Be.variableName,instruction:Sn.define(),label:Be.labelName,number:Be.number,operator:Be.operator,offset:Sn.define(),"ptr-size":Sn.define(),punctuation:Be.punctuation,register:Sn.define(),special:Sn.define(),string:Be.string,unassigned:Sn.define()},jse=mC.define({name:"vonsim",token:t=>{if(t.eatSpace())return null;if(t.match(/[01]+b\b/i)||t.match(/\d[a-f\d]*h\b/i)||t.match(/\d+\b/))return"number";if(t.match(/'[^'\n]'/))return"character";if(t.eat('"'))return t.eatWhile(/[^"\n]/),t.eat('"'),"string";if(t.eat(/[*+-]/))return"operator";if(t.eat(/[(),[\]]/))return"punctuation";if(t.eat("?"))return"unassigned";if(t.eat(";"))return t.skipToEnd(),"comment";if(t.eat(/[a-z_]/i)){t.eatWhile(/\w/);const e=t.current().toUpperCase();return e==="ORG"||e==="END"?"special":e==="OFFSET"?"offset":e==="BYTE"||e==="WORD"||e==="PTR"?"ptr-size":a_.includes(e)?"data-directive":l_.includes(e)?"instruction":Sv.includes(e)?"register":t.eat(":")?"label":"identifier"}return t.next(),null},languageData:{commentTokens:{line:";"},closeBrackets:{brackets:["(","[",'"']}},tokenTable:fi}),Fse=Eie(s0.define([{tag:fi.character,class:"text-orange-300"},{tag:fi.comment,class:"text-stone-500 italic"},{tag:fi["data-directive"],class:"text-rose-400/80"},{tag:fi.instruction,class:"text-mantis-400"},{tag:fi.number,class:"text-cyan-300/60"},{tag:fi.operator,class:"text-rose-300"},{tag:fi.offset,class:"text-rose-400/80 italic"},{tag:fi["ptr-size"],class:"text-rose-400/80 italic"},{tag:fi.punctuation,class:"text-stone-600"},{tag:fi.register,class:"text-emerald-400/80"},{tag:fi.special,class:"text-yellow-300/80"},{tag:fi.string,class:"text-orange-300"},{tag:fi.unassigned,class:"text-rose-400/80"}])),Bse=Pse(t=>{const e=t.state.doc.toString(),n=yj(e);if(n.success)return ee.set(lS,0),[];const i=Si().language,r=n.errors.map(s=>{var l,u;const o=((l=s.position)==null?void 0:l.start)??0,a=((u=s.position)==null?void 0:u.end)??e.length;return{message:s.translate(i),severity:"error",from:o,to:a}});return ee.set(lS,r.length),r},{delay:200});function $se(){return new nie(jse,[Fse,Bse])}function W3({className:t}){const[e,n]=S.useState(),i=IK(),r=S.useCallback(s=>{s&&n(s)},[]);return S.useEffect(()=>{if(e)return window.codemirror=new Pe({state:Je.create({doc:ZK(),extensions:[Je.tabSize.of(2),_j.of(Je.readOnly.of(!1)),QK,e9(),wq,i9(),TH(),Jie(),bH(),Pe.domEventHandlers({drop:s=>s.preventDefault()}),Je.allowMultipleSelections.of(!0),DH(),mD.of([{key:"Escape",run:s=>(s.dispatch({selection:ne.create([s.state.selection.main],0)}),!0)},{key:"Tab",run:s=>s.state.selection.ranges.some(o=>!o.empty)?sS(s):(s.dispatch(s.state.update(s.state.replaceSelection(" ".repeat(s.state.tabSize)),{scrollIntoView:!0,userEvent:"input"})),!0)},...Dse]),$se()]}),parent:e}),()=>{var s;return(s=window.codemirror)==null?void 0:s.destroy()}},[e]),g.jsxs("div",{className:ze("flex flex-col",t),children:[g.jsx("div",{ref:r,className:"grow overflow-auto font-mono",style:{fontSize:`${i}px`,lineHeight:1.25}}),g.jsx(Lse,{})]})}function zse(){const t=r_(),e=mt(),n=FK(),i=pU("(max-width: 640px)"),{updateServiceWorker:r}=wU({onNeedRefresh(){xn({title:e("update.update-available"),action:g.jsx(KB,{altText:e("update.reload"),onClick:()=>r(!0),children:e("update.reload")}),duration:1/0})}});return g.jsxs("div",{className:"flex h-screen w-screen flex-col bg-stone-900 text-white",lang:t,style:{filter:n},children:[g.jsx(ree,{}),i?g.jsx(Vse,{}):g.jsx(Use,{}),g.jsx(iX,{})]})}function Use(){const[t]=ed(J_);return g.jsxs(J2,{autoSaveId:"layout",direction:"horizontal",tagName:"main",className:"overflow-auto px-2",children:[g.jsx(Xm,{id:"panel-editor",order:1,minSize:30,tagName:"section",className:"rounded-lg border border-stone-600 bg-stone-800",children:g.jsx(W3,{className:"h-full w-full"})}),g.jsx(Mx,{className:"w-2"}),g.jsx(Xm,{id:"panel-computer",order:2,minSize:20,tagName:"section",className:"computer-background rounded-lg border border-stone-600",children:g.jsx(R$,{})}),t&&g.jsxs(g.Fragment,{children:[g.jsx(Mx,{className:"w-2"}),g.jsx(Xm,{id:"panel-settings",order:3,minSize:30,tagName:"section",className:"rounded-lg border border-stone-600 bg-stone-800",children:g.jsx(CB,{className:"h-full w-full"})})]})]})}function Vse(){const t=mt(),[e,n]=S.useState("editor"),[i,r]=ed(J_),s=i?"settings":e,o=a=>{i&&r(!1),n(a)};return g.jsx(_2,{value:s,onValueChange:o,asChild:!0,children:g.jsxs(g.Fragment,{children:[g.jsx(Km,{value:"editor",asChild:!0,children:g.jsx("section",{className:"mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden",children:g.jsx(W3,{className:"h-full w-full"})})}),g.jsx(Km,{value:"computer",asChild:!0,children:g.jsx("section",{className:"computer-background mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden",children:g.jsx(R$,{})})}),g.jsx(Km,{value:"settings",asChild:!0,children:g.jsx("section",{className:"mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden",children:g.jsx(CB,{className:"h-full w-full"})})}),g.jsxs(E2,{className:"grid grid-cols-2 gap-2 p-2",children:[g.jsxs(Rx,{value:"editor",className:"inline-flex items-center justify-center rounded-lg py-2 text-sm font-semibold text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-stone-700 data-[state=active]:text-white",children:[g.jsx("span",{className:"icon-[lucide--file-terminal] mr-2 h-4 w-4"}),t("control.tabs.editor")]}),g.jsxs(Rx,{value:"computer",className:"inline-flex items-center justify-center rounded-lg py-2 text-sm font-semibold text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-stone-700 data-[state=active]:text-white",children:[g.jsx("span",{className:"icon-[lucide--computer] mr-2 h-4 w-4"}),t("control.tabs.computer")]})]})]})})}function Hse(){const{toastList:t}=YK();return g.jsxs(kee,{children:[t.map(({id:e,title:n,description:i,action:r,variant:s,otherProps:o})=>g.jsxs(GB,{...o,variant:s,children:[g.jsxs("div",{className:"grid gap-1",children:[n&&g.jsx(qB,{children:n}),i&&g.jsx(YB,{children:i})]}),r,g.jsx(XB,{})]},e)),g.jsx(WB,{})]})}window.codemirror=null;Db.createRoot(document.getElementById("root")).render(g.jsx(fn.StrictMode,{children:g.jsxs(Y5,{client:Aj,children:[g.jsx(PG,{children:g.jsx(zse,{})}),g.jsx(Hse,{})]})}));
