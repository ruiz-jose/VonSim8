var X3=Object.defineProperty;var PC=t=>{throw TypeError(t)};var q3=(t,e,n)=>e in t?X3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var oe=(t,e,n)=>q3(t,typeof e!="symbol"?e+"":e,n),d0=(t,e,n)=>e.has(t)||PC("Cannot "+n);var C=(t,e,n)=>(d0(t,e,"read from private field"),n?n.call(t):e.get(t)),Re=(t,e,n)=>e.has(t)?PC("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Y=(t,e,n,i)=>(d0(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),gt=(t,e,n)=>(d0(t,e,"access private method"),n);function Y3(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var J3=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var gN={exports:{}},Jv={},vN={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zf=Symbol.for("react.element"),Z3=Symbol.for("react.portal"),Q3=Symbol.for("react.fragment"),e4=Symbol.for("react.strict_mode"),t4=Symbol.for("react.profiler"),n4=Symbol.for("react.provider"),i4=Symbol.for("react.context"),r4=Symbol.for("react.forward_ref"),s4=Symbol.for("react.suspense"),o4=Symbol.for("react.memo"),a4=Symbol.for("react.lazy"),TC=Symbol.iterator;function l4(t){return t===null||typeof t!="object"?null:(t=TC&&t[TC]||t["@@iterator"],typeof t=="function"?t:null)}var yN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wN=Object.assign,bN={};function Zc(t,e,n){this.props=t,this.context=e,this.refs=bN,this.updater=n||yN}Zc.prototype.isReactComponent={};Zc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Zc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function xN(){}xN.prototype=Zc.prototype;function lS(t,e,n){this.props=t,this.context=e,this.refs=bN,this.updater=n||yN}var uS=lS.prototype=new xN;uS.constructor=lS;wN(uS,Zc.prototype);uS.isPureReactComponent=!0;var RC=Array.isArray,SN=Object.prototype.hasOwnProperty,cS={current:null},kN={key:!0,ref:!0,__self:!0,__source:!0};function _N(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)SN.call(e,i)&&!kN.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:zf,type:t,key:s,ref:o,props:r,_owner:cS.current}}function u4(t,e){return{$$typeof:zf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function dS(t){return typeof t=="object"&&t!==null&&t.$$typeof===zf}function c4(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var NC=/\/+/g;function h0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?c4(""+t.key):e.toString(36)}function Om(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case zf:case Z3:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+h0(o,0):i,RC(r)?(n="",t!=null&&(n=t.replace(NC,"$&/")+"/"),Om(r,e,n,"",function(u){return u})):r!=null&&(dS(r)&&(r=u4(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(NC,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",RC(t))for(var a=0;a<t.length;a++){s=t[a];var l=i+h0(s,a);o+=Om(s,e,n,l,r)}else if(l=l4(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=i+h0(s,a++),o+=Om(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function vp(t,e,n){if(t==null)return t;var i=[],r=0;return Om(t,i,"","",function(s){return e.call(n,s,r++)}),i}function d4(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var oi={current:null},Dm={transition:null},h4={ReactCurrentDispatcher:oi,ReactCurrentBatchConfig:Dm,ReactCurrentOwner:cS};function CN(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:vp,forEach:function(t,e,n){vp(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return vp(t,function(){e++}),e},toArray:function(t){return vp(t,function(e){return e})||[]},only:function(t){if(!dS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qe.Component=Zc;qe.Fragment=Q3;qe.Profiler=t4;qe.PureComponent=lS;qe.StrictMode=e4;qe.Suspense=s4;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=h4;qe.act=CN;qe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=wN({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=cS.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)SN.call(e,l)&&!kN.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:zf,type:t.type,key:r,ref:s,props:i,_owner:o}};qe.createContext=function(t){return t={$$typeof:i4,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:n4,_context:t},t.Consumer=t};qe.createElement=_N;qe.createFactory=function(t){var e=_N.bind(null,t);return e.type=t,e};qe.createRef=function(){return{current:null}};qe.forwardRef=function(t){return{$$typeof:r4,render:t}};qe.isValidElement=dS;qe.lazy=function(t){return{$$typeof:a4,_payload:{_status:-1,_result:t},_init:d4}};qe.memo=function(t,e){return{$$typeof:o4,type:t,compare:e===void 0?null:e}};qe.startTransition=function(t){var e=Dm.transition;Dm.transition={};try{t()}finally{Dm.transition=e}};qe.unstable_act=CN;qe.useCallback=function(t,e){return oi.current.useCallback(t,e)};qe.useContext=function(t){return oi.current.useContext(t)};qe.useDebugValue=function(){};qe.useDeferredValue=function(t){return oi.current.useDeferredValue(t)};qe.useEffect=function(t,e){return oi.current.useEffect(t,e)};qe.useId=function(){return oi.current.useId()};qe.useImperativeHandle=function(t,e,n){return oi.current.useImperativeHandle(t,e,n)};qe.useInsertionEffect=function(t,e){return oi.current.useInsertionEffect(t,e)};qe.useLayoutEffect=function(t,e){return oi.current.useLayoutEffect(t,e)};qe.useMemo=function(t,e){return oi.current.useMemo(t,e)};qe.useReducer=function(t,e,n){return oi.current.useReducer(t,e,n)};qe.useRef=function(t){return oi.current.useRef(t)};qe.useState=function(t){return oi.current.useState(t)};qe.useSyncExternalStore=function(t,e,n){return oi.current.useSyncExternalStore(t,e,n)};qe.useTransition=function(){return oi.current.useTransition()};qe.version="18.3.1";vN.exports=qe;var S=vN.exports;const pn=Jc(S),hS=Y3({__proto__:null,default:pn},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f4=S,p4=Symbol.for("react.element"),m4=Symbol.for("react.fragment"),g4=Object.prototype.hasOwnProperty,v4=f4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y4={key:!0,ref:!0,__self:!0,__source:!0};function EN(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)g4.call(e,i)&&!y4.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:p4,type:t,key:s,ref:o,props:r,_owner:v4.current}}Jv.Fragment=m4;Jv.jsx=EN;Jv.jsxs=EN;gN.exports=Jv;var g=gN.exports;function MC(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function ke(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?MC(Object(n),!0).forEach(function(i){X(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):MC(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Ph(t){return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ph(t)}function at(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OC(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function lt(t,e,n){return e&&OC(t.prototype,e),n&&OC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function X(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w4(t,e){if(t==null)return{};var n,i,r=function(o,a){if(o==null)return{};var l,u,c={},d=Object.keys(o);for(u=0;u<d.length;u++)l=d[u],a.indexOf(l)>=0||(c[l]=o[l]);return c}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Zn(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,i){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var s,o,a=[],l=!0,u=!1;try{for(r=r.call(n);!(l=(s=r.next()).done)&&(a.push(s.value),!i||a.length!==i);l=!0);}catch(c){u=!0,o=c}finally{try{l||r.return==null||r.return()}finally{if(u)throw o}}return a}}(t,e)||fS(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function wo(t){return function(e){if(Array.isArray(e))return lb(e)}(t)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(t)||fS(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function fS(t,e){if(t){if(typeof t=="string")return lb(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lb(t,e):void 0}}function lb(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Ar(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=fS(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{o||n.return==null||n.return()}finally{if(a)throw s}}}}var Vr={DEBUG:!1,LIB_VERSION:"1.150.1"},b4=Array.isArray,AN=Object.prototype,PN=AN.hasOwnProperty,Zv=AN.toString,an=b4||function(t){return Zv.call(t)==="[object Array]"},Yr=function(t){return typeof t=="function"},En=function(t){return t===Object(t)&&!an(t)},Im=function(t){if(En(t)){for(var e in t)if(PN.call(t,e))return!1;return!0}return!1},Me=function(t){return t===void 0},Un=function(t){return Zv.call(t)=="[object String]"},DC=function(t){return Un(t)&&t.trim().length===0},Io=function(t){return t===null},yr=function(t){return Me(t)||Io(t)},ur=function(t){return Zv.call(t)=="[object Number]"},Tu=function(t){return Zv.call(t)==="[object Boolean]"},x4=function(t){return t instanceof FormData},V=typeof window<"u"?window:void 0,ki=typeof globalThis<"u"?globalThis:V,TN=Array.prototype,IC=TN.forEach,LC=TN.indexOf,go=ki==null?void 0:ki.navigator,Ee=ki==null?void 0:ki.document,vi=ki==null?void 0:ki.location,ub=ki==null?void 0:ki.fetch,cb=ki!=null&&ki.XMLHttpRequest&&"withCredentials"in new ki.XMLHttpRequest?ki.XMLHttpRequest:void 0,jC=ki==null?void 0:ki.AbortController,Ht=go==null?void 0:go.userAgent,Vt=V??{},FC="[PostHog.js]",re={_log:function(t){if(V&&(Vr.DEBUG||Vt.POSTHOG_DEBUG)&&!Me(V.console)&&V.console){for(var e=("__rrweb_original__"in V.console[t])?V.console[t].__rrweb_original__:V.console[t],n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.apply(void 0,[FC].concat(i))}},info:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];re._log.apply(re,["log"].concat(e))},warn:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];re._log.apply(re,["warn"].concat(e))},error:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];re._log.apply(re,["error"].concat(e))},critical:function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];(t=console).error.apply(t,[FC].concat(n))},uninitializedWarning:function(t){re.error("You must initialize PostHog before calling ".concat(t))}},vg={},Qv=function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function qu(t,e,n){if(an(t)){if(IC&&t.forEach===IC)t.forEach(e,n);else if("length"in t&&t.length===+t.length){for(var i=0,r=t.length;i<r;i++)if(i in t&&e.call(n,t[i],i)===vg)return}}}function wt(t,e,n){if(!yr(t)){if(an(t))return qu(t,e,n);if(x4(t)){var i,r=Ar(t.entries());try{for(r.s();!(i=r.n()).done;){var s=i.value;if(e.call(n,s[1],s[0])===vg)return}}catch(a){r.e(a)}finally{r.f()}}else for(var o in t)if(PN.call(t,o)&&e.call(n,t[o],o)===vg)return}}var Qn=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return qu(n,function(r){for(var s in r)r[s]!==void 0&&(t[s]=r[s])}),t};function Ye(t,e){return t.indexOf(e)!==-1}function Lm(t){for(var e=Object.keys(t),n=e.length,i=new Array(n);n--;)i[n]=[e[n],t[e[n]]];return i}var RN=function(){return Date.now=Date.now||function(){return+new Date},Date.now()},BC=function(t){try{return t()}catch{return}},S4=function(t){return function(){try{for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,n)}catch(r){re.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),re.critical(r)}}},db=function(t){var e={};return wt(t,function(n,i){Un(n)&&n.length>0&&(e[i]=n)}),e},hb=function(t){return t.replace(/^\$/,"")};function k4(t,e){return n=t,i=function(s){return Un(s)&&!Io(e)?s.slice(0,e):s},r=new Set,function s(o,a){return o!==Object(o)?i?i(o,a):o:r.has(o)?void 0:(r.add(o),an(o)?(l=[],qu(o,function(u){l.push(s(u))})):(l={},wt(o,function(u,c){r.has(u)||(l[c]=s(u,c))})),l);var l}(n);var n,i,r}var Hr,_4=function(t){var e,n,i,r,s="";for(e=n=0,i=(t=(t+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,r=0;r<i;r++){var o=t.charCodeAt(r),a=null;o<128?n++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),Io(a)||(n>e&&(s+=t.substring(e,n)),s+=a,e=n=r+1)}return n>e&&(s+=t.substring(e,t.length)),s},mo=function(){function t(e){return e&&(e.preventDefault=t.preventDefault,e.stopPropagation=t.stopPropagation),e}return t.preventDefault=function(){this.returnValue=!1},t.stopPropagation=function(){this.cancelBubble=!0},function(e,n,i,r,s){if(e)if(e.addEventListener&&!r)e.addEventListener(n,i,!!s);else{var o="on"+n,a=e[o];e[o]=function(l,u,c){return function(d){if(d=d||t(V==null?void 0:V.event)){var h,f=!0;Yr(c)&&(h=c(d));var p=u.call(l,d);return h!==!1&&p!==!1||(f=!1),f}}}(e,i,a)}else re.error("No valid element provided to register_event")}}();function NN(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return t[n]}(function(t){t.GZipJS="gzip-js",t.Base64="base64"})(Hr||(Hr={}));var MN="$people_distinct_id",jd="__alias",Fd="__timers",$C="$autocapture_disabled_server_side",fb="$heatmaps_enabled_server_side",zC="$exception_capture_enabled_server_side",UC="$exception_capture_endpoint",VC="$web_vitals_enabled_server_side",pb="$session_recording_enabled_server_side",HC="$console_log_recording_enabled_server_side",WC="$session_recording_network_payload_capture",GC="$session_recording_canvas_recording",KC="$replay_sample_rate",XC="$replay_minimum_duration",yg="$sesid",nh="$session_is_sampled",Ru="$enabled_feature_flags",mb="$early_access_features",Nu="$stored_person_properties",Xo="$stored_group_properties",gb="$surveys",yp="$surveys_activated",wg="$flag_call_reported",Ys="$user_state",vb="$client_session_props",yb="$capture_rate_limit",wb="$initial_campaign_params",bb="$initial_referrer_info",qC="$initial_person_info",bg="$epp",xb="__POSTHOG_TOOLBAR__",C4=[MN,jd,"__cmpns",Fd,pb,fb,yg,Ru,Ys,mb,Xo,Nu,gb,wg,vb,yb,wb,bb,bg],f0="$active_feature_flags",wp="$override_feature_flags",YC="$feature_flag_payloads",JC=function(t){var e,n={},i=Ar(Lm(t||{}));try{for(i.s();!(e=i.n()).done;){var r=Zn(e.value,2),s=r[0],o=r[1];o&&(n[s]=o)}}catch(a){i.e(a)}finally{i.f()}return n},E4=function(){function t(e){at(this,t),this.instance=e,this._override_warning=!1,this.featureFlagEventHandlers=[],this.reloadFeatureFlagsQueued=!1,this.reloadFeatureFlagsInAction=!1}return lt(t,[{key:"getFlags",value:function(){return Object.keys(this.getFlagVariants())}},{key:"getFlagVariants",value:function(){var e=this.instance.get_property(Ru),n=this.instance.get_property(wp);if(!n)return e||{};for(var i=Qn({},e),r=Object.keys(n),s=0;s<r.length;s++)i[r[s]]=n[r[s]];return this._override_warning||(re.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:n,finalFlags:i}),this._override_warning=!0),i}},{key:"getFlagPayloads",value:function(){return this.instance.get_property(YC)||{}}},{key:"reloadFeatureFlags",value:function(){this.reloadFeatureFlagsQueued||(this.reloadFeatureFlagsQueued=!0,this._startReloadTimer())}},{key:"setAnonymousDistinctId",value:function(e){this.$anon_distinct_id=e}},{key:"setReloadingPaused",value:function(e){this.reloadFeatureFlagsInAction=e}},{key:"resetRequestQueue",value:function(){this.reloadFeatureFlagsQueued=!1}},{key:"_startReloadTimer",value:function(){var e=this;this.reloadFeatureFlagsQueued&&!this.reloadFeatureFlagsInAction&&setTimeout(function(){!e.reloadFeatureFlagsInAction&&e.reloadFeatureFlagsQueued&&(e.reloadFeatureFlagsQueued=!1,e._reloadFeatureFlagsRequest())},5)}},{key:"_reloadFeatureFlagsRequest",value:function(){var e=this;if(!this.instance.config.advanced_disable_feature_flags){this.setReloadingPaused(!0);var n=this.instance.config.token,i=this.instance.get_property(Nu),r=this.instance.get_property(Xo),s={token:n,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:i,group_properties:r,disable_flags:this.instance.config.advanced_disable_feature_flags||void 0};this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:s,compression:this.instance.config.disable_compression?void 0:Hr.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:function(o){var a;e.setReloadingPaused(!1);var l=!0;o.statusCode===200&&(e.$anon_distinct_id=void 0,l=!1),e.receivedFeatureFlags((a=o.json)!==null&&a!==void 0?a:{},l),e._startReloadTimer()}})}}},{key:"getFeatureFlag",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.instance.decideEndpointWasHit||this.getFlags()&&this.getFlags().length>0){var i,r=this.getFlagVariants()[e],s="".concat(r),o=this.instance.get_property(wg)||{};return(n.send_event||!("send_event"in n))&&(!(e in o)||!o[e].includes(s))&&(an(o[e])?o[e].push(s):o[e]=[s],(i=this.instance.persistence)===null||i===void 0||i.register(X({},wg,o)),this.instance.capture("$feature_flag_called",{$feature_flag:e,$feature_flag_response:r})),r}re.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}},{key:"getFeatureFlagPayload",value:function(e){return this.getFlagPayloads()[e]}},{key:"isFeatureEnabled",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.instance.decideEndpointWasHit||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(e,n);re.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}},{key:"addFeatureFlagsHandler",value:function(e){this.featureFlagEventHandlers.push(e)}},{key:"removeFeatureFlagsHandler",value:function(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(function(n){return n!==e})}},{key:"receivedFeatureFlags",value:function(e,n){if(this.instance.persistence){this.instance.decideEndpointWasHit=!0;var i=this.getFlagVariants(),r=this.getFlagPayloads();(function(s,o){var a,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},c=s.featureFlags,d=s.featureFlagPayloads;if(c)if(an(c)){var h,f={};if(c)for(var p=0;p<c.length;p++)f[c[p]]=!0;o&&o.register((X(h={},f0,c),X(h,Ru,f),h))}else{var m=c,w=d;s.errorsWhileComputingFlags&&(m=ke(ke({},l),m),w=ke(ke({},u),w)),o&&o.register((X(a={},f0,Object.keys(JC(m))),X(a,Ru,m||{}),X(a,YC,w||{}),a))}})(e,this.instance.persistence,i,r),this._fireFeatureFlagsCallbacks(n)}}},{key:"override",value:function(e){if(!this.instance.__loaded||!this.instance.persistence)return re.uninitializedWarning("posthog.feature_flags.override");if(this._override_warning=!1,e===!1)this.instance.persistence.unregister(wp);else if(an(e)){for(var n={},i=0;i<e.length;i++)n[e[i]]=!0;this.instance.persistence.register(X({},wp,n))}else this.instance.persistence.register(X({},wp,e))}},{key:"onFeatureFlags",value:function(e){var n=this;if(this.addFeatureFlagsHandler(e),this.instance.decideEndpointWasHit){var i=this._prepareFeatureFlagsForCallbacks(),r=i.flags,s=i.flagVariants;e(r,s)}return function(){return n.removeFeatureFlagsHandler(e)}}},{key:"updateEarlyAccessFeatureEnrollment",value:function(e,n){var i,r,s=X({},"$feature_enrollment/".concat(e),n);this.instance.capture("$feature_enrollment_update",{$feature_flag:e,$feature_enrollment:n,$set:s}),this.setPersonPropertiesForFlags(s,!1);var o=ke(ke({},this.getFlagVariants()),{},X({},e,n));(i=this.instance.persistence)===null||i===void 0||i.register((X(r={},f0,Object.keys(JC(o))),X(r,Ru,o),r)),this._fireFeatureFlagsCallbacks()}},{key:"getEarlyAccessFeatures",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=this.instance.get_property(mb);if(r&&!i)return e(r);this.instance._send_request({transport:"XHR",url:this.instance.requestRouter.endpointFor("api","/api/early_access_features/?token=".concat(this.instance.config.token)),method:"GET",callback:function(s){var o;if(s.json){var a=s.json.earlyAccessFeatures;return(o=n.instance.persistence)===null||o===void 0||o.register(X({},mb,a)),e(a)}}})}},{key:"_prepareFeatureFlagsForCallbacks",value:function(){var e=this.getFlags(),n=this.getFlagVariants();return{flags:e.filter(function(i){return n[i]}),flagVariants:Object.keys(n).filter(function(i){return n[i]}).reduce(function(i,r){return i[r]=n[r],i},{})}}},{key:"_fireFeatureFlagsCallbacks",value:function(e){var n=this._prepareFeatureFlagsForCallbacks(),i=n.flags,r=n.flagVariants;this.featureFlagEventHandlers.forEach(function(s){return s(i,r,{errorsLoading:e})})}},{key:"setPersonPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],i=this.instance.get_property(Nu)||{};this.instance.register(X({},Nu,ke(ke({},i),e))),n&&this.instance.reloadFeatureFlags()}},{key:"resetPersonPropertiesForFlags",value:function(){this.instance.unregister(Nu)}},{key:"setGroupPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],i=this.instance.get_property(Xo)||{};Object.keys(i).length!==0&&Object.keys(i).forEach(function(r){i[r]=ke(ke({},i[r]),e[r]),delete e[r]}),this.instance.register(X({},Xo,ke(ke({},i),e))),n&&this.instance.reloadFeatureFlags()}},{key:"resetGroupPropertiesForFlags",value:function(e){if(e){var n=this.instance.get_property(Xo)||{};this.instance.register(X({},Xo,ke(ke({},n),{},X({},e,{}))))}else this.instance.unregister(Xo)}}]),t}();Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Number.isInteger||(Number.isInteger=function(t){return ur(t)&&isFinite(t)&&Math.floor(t)===t});var ZC="0123456789abcdef",A4=function(){function t(e){if(at(this,t),this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}return lt(t,[{key:"toString",value:function(){for(var e="",n=0;n<this.bytes.length;n++)e=e+ZC.charAt(this.bytes[n]>>>4)+ZC.charAt(15&this.bytes[n]),n!==3&&n!==5&&n!==7&&n!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}},{key:"clone",value:function(){return new t(this.bytes.slice(0))}},{key:"equals",value:function(e){return this.compareTo(e)===0}},{key:"compareTo",value:function(e){for(var n=0;n<16;n++){var i=this.bytes[n]-e.bytes[n];if(i!==0)return Math.sign(i)}return 0}}],[{key:"fromFieldsV7",value:function(e,n,i,r){if(!Number.isInteger(e)||!Number.isInteger(n)||!Number.isInteger(i)||!Number.isInteger(r)||e<0||n<0||i<0||r<0||e>0xffffffffffff||n>4095||i>1073741823||r>4294967295)throw new RangeError("invalid field value");var s=new Uint8Array(16);return s[0]=e/Math.pow(2,40),s[1]=e/Math.pow(2,32),s[2]=e/Math.pow(2,24),s[3]=e/Math.pow(2,16),s[4]=e/Math.pow(2,8),s[5]=e,s[6]=112|n>>>8,s[7]=n,s[8]=128|i>>>24,s[9]=i>>>16,s[10]=i>>>8,s[11]=i,s[12]=r>>>24,s[13]=r>>>16,s[14]=r>>>8,s[15]=r,new t(s)}}]),t}(),P4=function(){function t(){at(this,t),X(this,"timestamp",0),X(this,"counter",0),X(this,"random",new T4)}return lt(t,[{key:"generate",value:function(){var e=this.generateOrAbort();if(Me(e)){this.timestamp=0;var n=this.generateOrAbort();if(Me(n))throw new Error("Could not generate UUID after timestamp reset");return n}return e}},{key:"generateOrAbort",value:function(){var e=Date.now();if(e>this.timestamp)this.timestamp=e,this.resetCounter();else{if(!(e+1e4>this.timestamp))return;this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter())}return A4.fromFieldsV7(this.timestamp,Math.trunc(this.counter/Math.pow(2,30)),this.counter&Math.pow(2,30)-1,this.random.nextUint32())}},{key:"resetCounter",value:function(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}}]),t}(),ON=function(t){if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<t.length;e++)t[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return t};V&&!Me(V.crypto)&&crypto.getRandomValues&&(ON=function(t){return crypto.getRandomValues(t)});var QC,T4=function(){function t(){at(this,t),X(this,"buffer",new Uint32Array(8)),X(this,"cursor",1/0)}return lt(t,[{key:"nextUint32",value:function(){return this.cursor>=this.buffer.length&&(ON(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}]),t}(),da=function(){return R4().toString()},R4=function(){return(QC||(QC=new P4)).generate()},N4="Thu, 01 Jan 1970 00:00:00 GMT",dd="",M4=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function O4(t,e){if(e){var n=function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ee;if(dd)return dd;if(!s||["localhost","127.0.0.1"].includes(r))return"";for(var o=r.split("."),a=Math.min(o.length,8),l="dmn_chk_"+da(),u=new RegExp("(^|;)\\s*"+l+"=1");!dd&&a--;){var c=o.slice(a).join("."),d=l+"=1;domain=."+c;s.cookie=d,u.test(s.cookie)&&(s.cookie=d+";expires="+N4,dd=c)}return dd}(t);if(!n){var i=function(r){var s=r.match(M4);return s?s[0]:""}(t);i!==n&&re.info("Warning: cookie subdomain discovery mismatch",i,n),n=i}return n?"; domain=."+n:""}return""}var yn,bo={is_supported:function(){return!!Ee},error:function(t){re.error("cookieStore error: "+t)},get:function(t){if(Ee){try{for(var e=t+"=",n=Ee.cookie.split(";").filter(function(s){return s.length}),i=0;i<n.length;i++){for(var r=n[i];r.charAt(0)==" ";)r=r.substring(1,r.length);if(r.indexOf(e)===0)return decodeURIComponent(r.substring(e.length,r.length))}}catch{}return null}},parse:function(t){var e;try{e=JSON.parse(bo.get(t))||{}}catch{}return e},set:function(t,e,n,i,r){if(Ee)try{var s="",o="",a=O4(Ee.location.hostname,i);if(n){var l=new Date;l.setTime(l.getTime()+24*n*60*60*1e3),s="; expires="+l.toUTCString()}r&&(o="; secure");var u=t+"="+encodeURIComponent(JSON.stringify(e))+s+"; SameSite=Lax; path=/"+a+o;return u.length>3686.4&&re.warn("cookieStore warning: large cookie, len="+u.length),Ee.cookie=u,u}catch{return}},remove:function(t,e){try{bo.set(t,"",-1,e)}catch{return}}},p0=null,nn={is_supported:function(){if(!Io(p0))return p0;var t=!0;if(Me(V))t=!1;else try{var e="__mplssupport__";nn.set(e,"xyz"),nn.get(e)!=='"xyz"'&&(t=!1),nn.remove(e)}catch{t=!1}return t||re.error("localStorage unsupported; falling back to cookie store"),p0=t,t},error:function(t){re.error("localStorage error: "+t)},get:function(t){try{return V==null?void 0:V.localStorage.getItem(t)}catch(e){nn.error(e)}return null},parse:function(t){try{return JSON.parse(nn.get(t))||{}}catch{}return null},set:function(t,e){try{V==null||V.localStorage.setItem(t,JSON.stringify(e))}catch(n){nn.error(n)}},remove:function(t){try{V==null||V.localStorage.removeItem(t)}catch(e){nn.error(e)}}},D4=["distinct_id",yg,nh,bg],bp=ke(ke({},nn),{},{parse:function(t){try{var e={};try{e=bo.parse(t)||{}}catch{}var n=Qn(e,JSON.parse(nn.get(t)||"{}"));return nn.set(t,n),n}catch{}return null},set:function(t,e,n,i,r){try{nn.set(t,e);var s={};D4.forEach(function(o){e[o]&&(s[o]=e[o])}),Object.keys(s).length&&bo.set(t,s,n,i,r)}catch(o){nn.error(o)}},remove:function(t,e){try{V==null||V.localStorage.removeItem(t),bo.remove(t,e)}catch(n){nn.error(n)}}}),xp={},I4={is_supported:function(){return!0},error:function(t){re.error("memoryStorage error: "+t)},get:function(t){return xp[t]||null},parse:function(t){return xp[t]||null},set:function(t,e){xp[t]=e},remove:function(t){delete xp[t]}},fl=null,xn={is_supported:function(){if(!Io(fl))return fl;if(fl=!0,Me(V))fl=!1;else try{var t="__support__";xn.set(t,"xyz"),xn.get(t)!=='"xyz"'&&(fl=!1),xn.remove(t)}catch{fl=!1}return fl},error:function(t){re.error("sessionStorage error: ",t)},get:function(t){try{return V==null?void 0:V.sessionStorage.getItem(t)}catch(e){xn.error(e)}return null},parse:function(t){try{return JSON.parse(xn.get(t))||null}catch{}return null},set:function(t,e){try{V==null||V.sessionStorage.setItem(t,JSON.stringify(e))}catch(n){xn.error(n)}},remove:function(t){try{V==null||V.sessionStorage.removeItem(t)}catch(e){xn.error(e)}}},L4=["localhost","127.0.0.1"],ih=function(t){var e=Ee==null?void 0:Ee.createElement("a");return Me(e)?null:(e.href=t,e)},xg=function(t,e){return!!function(n){try{new RegExp(n)}catch{return!1}return!0}(e)&&new RegExp(e).test(t)},j4=function(t){var e,n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"&",r=[];return wt(t,function(s,o){Me(s)||Me(o)||o==="undefined"||(e=encodeURIComponent(function(a){return a instanceof File}(s)?s.name:s.toString()),n=encodeURIComponent(o),r[r.length]=n+"="+e)}),r.join(i)},eE=function(t,e){for(var n,i=((t.split("#")[0]||"").split("?")[1]||"").split("&"),r=0;r<i.length;r++){var s=i[r].split("=");if(s[0]===e){n=s;break}}if(!an(n)||n.length<2)return"";var o=n[1];try{o=decodeURIComponent(o)}catch{re.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},Sg=function(t,e){var n=t.match(new RegExp(e+"=([^&]*)"));return n?n[1]:null},wr="Mobile",kg="iOS",Rs="Android",Th="Tablet",DN=Rs+" "+Th,IN="iPad",LN="Apple",jN=LN+" Watch",Rh="Safari",kc="BlackBerry",FN="Samsung",BN=FN+"Browser",$N=FN+" Internet",ka="Chrome",F4=ka+" OS",zN=ka+" "+kg,pS="Internet Explorer",UN=pS+" "+wr,mS="Opera",B4=mS+" Mini",gS="Edge",VN="Microsoft "+gS,Yu="Firefox",HN=Yu+" "+kg,Nh="Nintendo",Mh="PlayStation",Ju="Xbox",WN=Rs+" "+wr,GN=wr+" "+Rh,Bd="Windows",Sb=Bd+" Phone",tE="Nokia",kb="Ouya",KN="Generic",$4=KN+" "+wr.toLowerCase(),XN=KN+" "+Th.toLowerCase(),_b="Konqueror",Kn="(\\d+(\\.\\d+)?)",m0=new RegExp("Version/"+Kn),z4=new RegExp(Ju,"i"),U4=new RegExp(Mh+" \\w+","i"),V4=new RegExp(Nh+" \\w+","i"),vS=new RegExp(kc+"|PlayBook|BB10","i"),H4={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},W4=function(t,e){return e&&Ye(e,LN)||function(n){return Ye(n,Rh)&&!Ye(n,ka)&&!Ye(n,Rs)}(t)},nE=function(t,e){return e=e||"",Ye(t," OPR/")&&Ye(t,"Mini")?B4:Ye(t," OPR/")?mS:vS.test(t)?kc:Ye(t,"IE"+wr)||Ye(t,"WPDesktop")?UN:Ye(t,BN)?$N:Ye(t,gS)||Ye(t,"Edg/")?VN:Ye(t,"FBIOS")?"Facebook "+wr:Ye(t,"UCWEB")||Ye(t,"UCBrowser")?"UC Browser":Ye(t,"CriOS")?zN:Ye(t,"CrMo")?ka:Ye(t,Rs)&&Ye(t,Rh)?WN:Ye(t,ka)?ka:Ye(t,"FxiOS")?HN:Ye(t.toLowerCase(),_b.toLowerCase())?_b:W4(t,e)?Ye(t,wr)?GN:Rh:Ye(t,Yu)?Yu:Ye(t,"MSIE")||Ye(t,"Trident/")?pS:Ye(t,"Gecko")?Yu:""},G4=(X(yn={},UN,[new RegExp("rv:"+Kn)]),X(yn,VN,[new RegExp(gS+"?\\/"+Kn)]),X(yn,ka,[new RegExp("("+ka+"|CrMo)\\/"+Kn)]),X(yn,zN,[new RegExp("CriOS\\/"+Kn)]),X(yn,"UC Browser",[new RegExp("(UCBrowser|UCWEB)\\/"+Kn)]),X(yn,Rh,[m0]),X(yn,GN,[m0]),X(yn,mS,[new RegExp("(Opera|OPR)\\/"+Kn)]),X(yn,Yu,[new RegExp(Yu+"\\/"+Kn)]),X(yn,HN,[new RegExp("FxiOS\\/"+Kn)]),X(yn,_b,[new RegExp("Konqueror[:/]?"+Kn,"i")]),X(yn,kc,[new RegExp(kc+" "+Kn),m0]),X(yn,WN,[new RegExp("android\\s"+Kn,"i")]),X(yn,$N,[new RegExp(BN+"\\/"+Kn)]),X(yn,pS,[new RegExp("(rv:|MSIE )"+Kn)]),X(yn,"Mozilla",[new RegExp("rv:"+Kn)]),yn),iE=[[new RegExp(Ju+"; "+Ju+" (.*?)[);]","i"),function(t){return[Ju,t&&t[1]||""]}],[new RegExp(Nh,"i"),[Nh,""]],[new RegExp(Mh,"i"),[Mh,""]],[vS,[kc,""]],[new RegExp(Bd,"i"),function(t,e){if(/Phone/.test(e)||/WPDesktop/.test(e))return[Sb,""];if(new RegExp(wr).test(e)&&!/IEMobile\b/.test(e))return[Bd+" "+wr,""];var n=/Windows NT ([0-9.]+)/i.exec(e);if(n&&n[1]){var i=n[1],r=H4[i]||"";return/arm/i.test(e)&&(r="RT"),[Bd,r]}return[Bd,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,function(t){if(t&&t[3]){var e=[t[3],t[4],t[5]||"0"];return[kg,e.join(".")]}return[kg,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,function(t){var e="";return t&&t.length>=3&&(e=Me(t[2])?t[3]:t[2]),["watchOS",e]}],[new RegExp("("+Rs+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Rs+")","i"),function(t){if(t&&t[2]){var e=[t[2],t[3],t[4]||"0"];return[Rs,e.join(".")]}return[Rs,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,function(t){var e=["Mac OS X",""];if(t&&t[1]){var n=[t[1],t[2],t[3]||"0"];e[1]=n.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[F4,""]],[/Linux|debian/i,["Linux",""]]],rE=function(t){return V4.test(t)?Nh:U4.test(t)?Mh:z4.test(t)?Ju:new RegExp(kb,"i").test(t)?kb:new RegExp("("+Sb+"|WPDesktop)","i").test(t)?Sb:/iPad/.test(t)?IN:/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(t)?jN:vS.test(t)?kc:/(kobo)\s(ereader|touch)/i.test(t)?"Kobo":new RegExp(tE,"i").test(t)?tE:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(t)||/(kf[a-z]+)( bui|\)).+silk\//i.test(t)?"Kindle Fire":/(Android|ZTE)/i.test(t)?!new RegExp(wr).test(t)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(t)?/pixel[\daxl ]{1,6}/i.test(t)&&!/pixel c/i.test(t)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(t)||/lmy47v/i.test(t)&&!/QTAQZ3/i.test(t)?Rs:DN:Rs:new RegExp("(pda|"+wr+")","i").test(t)?$4:new RegExp(Th,"i").test(t)&&!new RegExp(Th+" pc","i").test(t)?XN:""},Sp="https?://(.*)",K4=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gclid","gad_source","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","mc_cid","igshid","ttclid","rdt_cid"],hn={campaignParams:function(t){return Ee?this._campaignParamsFromUrl(Ee.URL,t):{}},_campaignParamsFromUrl:function(t,e){var n=K4.concat(e||[]),i={};return wt(n,function(r){var s=eE(t,r);s&&(i[r]=s)}),i},_searchEngine:function(t){return t?t.search(Sp+"google.([^/?]*)")===0?"google":t.search(Sp+"bing.com")===0?"bing":t.search(Sp+"yahoo.com")===0?"yahoo":t.search(Sp+"duckduckgo.com")===0?"duckduckgo":null:null},_searchInfoFromReferrer:function(t){var e=hn._searchEngine(t),n=e!="yahoo"?"q":"p",i={};if(!Io(e)){i.$search_engine=e;var r=Ee?eE(Ee.referrer,n):"";r.length&&(i.ph_keyword=r)}return i},searchInfo:function(){var t=Ee==null?void 0:Ee.referrer;return t?this._searchInfoFromReferrer(t):{}},browser:nE,browserVersion:function(t,e){var n=nE(t,e),i=G4[n];if(Me(i))return null;for(var r=0;r<i.length;r++){var s=i[r],o=t.match(s);if(o)return parseFloat(o[o.length-2])}return null},browserLanguage:function(){return navigator.language||navigator.userLanguage},os:function(t){for(var e=0;e<iE.length;e++){var n=Zn(iE[e],2),i=n[0],r=n[1],s=i.exec(t),o=s&&(Yr(r)?r(s,t):r);if(o)return o}return["",""]},device:rE,deviceType:function(t){var e=rE(t);return e===IN||e===DN||e==="Kobo"||e==="Kindle Fire"||e===XN?Th:e===Nh||e===Ju||e===Mh||e===kb?"Console":e===jN?"Wearable":e?wr:"Desktop"},referrer:function(){return(Ee==null?void 0:Ee.referrer)||"$direct"},referringDomain:function(){var t;return Ee!=null&&Ee.referrer&&((t=ih(Ee.referrer))===null||t===void 0?void 0:t.host)||"$direct"},referrerInfo:function(){return{$referrer:this.referrer(),$referring_domain:this.referringDomain()}},initialPersonInfo:function(){return{r:this.referrer(),u:vi==null?void 0:vi.href}},initialPersonPropsFromInfo:function(t){var e,n=t.r,i=t.u,r={$initial_referrer:n,$initial_referring_domain:n==null?void 0:n=="$direct"?"$direct":(e=ih(n))===null||e===void 0?void 0:e.host};if(i){r.$initial_current_url=i;var s=ih(i);r.$initial_host=s==null?void 0:s.host,r.$initial_pathname=s==null?void 0:s.pathname,wt(this._campaignParamsFromUrl(i),function(o,a){r["$initial_"+hb(a)]=o})}return n&&wt(this._searchInfoFromReferrer(n),function(o,a){r["$initial_"+hb(a)]=o}),r},properties:function(){if(!Ht)return{};var t=Zn(hn.os(Ht),2),e=t[0],n=t[1];return Qn(db({$os:e,$os_version:n,$browser:hn.browser(Ht,navigator.vendor),$device:hn.device(Ht),$device_type:hn.deviceType(Ht)}),{$current_url:vi==null?void 0:vi.href,$host:vi==null?void 0:vi.host,$pathname:vi==null?void 0:vi.pathname,$raw_user_agent:Ht.length>1e3?Ht.substring(0,997)+"...":Ht,$browser_version:hn.browserVersion(Ht,navigator.vendor),$browser_language:hn.browserLanguage(),$screen_height:V==null?void 0:V.screen.height,$screen_width:V==null?void 0:V.screen.width,$viewport_height:V==null?void 0:V.innerHeight,$viewport_width:V==null?void 0:V.innerWidth,$lib:"web",$lib_version:Vr.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:RN()/1e3})},people_properties:function(){if(!Ht)return{};var t=Zn(hn.os(Ht),2),e=t[0],n=t[1];return Qn(db({$os:e,$os_version:n,$browser:hn.browser(Ht,navigator.vendor)}),{$browser_version:hn.browserVersion(Ht,navigator.vendor)})}},X4=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"],g0=function(){function t(e){at(this,t),this.config=e,this.props={},this.campaign_params_saved=!1,this.name=function(n){var i="";return n.token&&(i=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+i+"_posthog"}(e),this.storage=this.buildStorage(e),this.load(),this.update_config(e,e),this.save()}return lt(t,[{key:"buildStorage",value:function(e){X4.indexOf(e.persistence.toLowerCase())===-1&&(re.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var n=e.persistence.toLowerCase();return n==="localstorage"&&nn.is_supported()?nn:n==="localstorage+cookie"&&bp.is_supported()?bp:n==="sessionstorage"&&xn.is_supported()?xn:n==="memory"?I4:n==="cookie"?bo:bp.is_supported()?bp:bo}},{key:"properties",value:function(){var e={};return wt(this.props,function(n,i){if(i===Ru&&En(n))for(var r=Object.keys(n),s=0;s<r.length;s++)e["$feature/".concat(r[s])]=n[r[s]];else a=i,l=!1,(Io(o=C4)?l:LC&&o.indexOf===LC?o.indexOf(a)!=-1:(wt(o,function(u){if(l||(l=u===a))return vg}),l))||(e[i]=n);var o,a,l}),e}},{key:"load",value:function(){if(!this.disabled){var e=this.storage.parse(this.name);e&&(this.props=Qn({},e))}}},{key:"save",value:function(){this.disabled||this.storage.set(this.name,this.props,this.expire_days,this.cross_subdomain,this.secure)}},{key:"remove",value:function(){this.storage.remove(this.name,!1),this.storage.remove(this.name,!0)}},{key:"clear",value:function(){this.remove(),this.props={}}},{key:"register_once",value:function(e,n,i){var r=this;if(En(e)){Me(n)&&(n="None"),this.expire_days=Me(i)?this.default_expiry:i;var s=!1;if(wt(e,function(o,a){r.props.hasOwnProperty(a)&&r.props[a]!==n||(r.props[a]=o,s=!0)}),s)return this.save(),!0}return!1}},{key:"register",value:function(e,n){var i=this;if(En(e)){this.expire_days=Me(n)?this.default_expiry:n;var r=!1;if(wt(e,function(s,o){e.hasOwnProperty(o)&&i.props[o]!==s&&(i.props[o]=s,r=!0)}),r)return this.save(),!0}return!1}},{key:"unregister",value:function(e){e in this.props&&(delete this.props[e],this.save())}},{key:"update_campaign_params",value:function(){this.campaign_params_saved||(this.register(hn.campaignParams(this.config.custom_campaign_params)),this.campaign_params_saved=!0)}},{key:"update_search_keyword",value:function(){this.register(hn.searchInfo())}},{key:"update_referrer_info",value:function(){this.register_once(hn.referrerInfo(),void 0)}},{key:"set_initial_person_info",value:function(){this.props[wb]||this.props[bb]||this.register_once(X({},qC,hn.initialPersonInfo()),void 0)}},{key:"get_referrer_info",value:function(){return db({$referrer:this.props.$referrer,$referring_domain:this.props.$referring_domain})}},{key:"get_initial_props",value:function(){var e=this,n={};wt([bb,wb],function(s){var o=e.props[s];o&&wt(o,function(a,l){n["$initial_"+hb(l)]=a})});var i=this.props[qC];if(i){var r=hn.initialPersonPropsFromInfo(i);Qn(n,r)}return n}},{key:"safe_merge",value:function(e){return wt(this.props,function(n,i){i in e||(e[i]=n)}),e}},{key:"update_config",value:function(e,n){if(this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==n.persistence){var i=this.buildStorage(e),r=this.props;this.clear(),this.storage=i,this.props=r,this.save()}}},{key:"set_disabled",value:function(e){this.disabled=e,this.disabled?this.remove():this.save()}},{key:"set_cross_subdomain",value:function(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())}},{key:"get_cross_subdomain",value:function(){return!!this.cross_subdomain}},{key:"set_secure",value:function(e){e!==this.secure&&(this.secure=e,this.remove(),this.save())}},{key:"set_event_timer",value:function(e,n){var i=this.props[Fd]||{};i[e]=n,this.props[Fd]=i,this.save()}},{key:"remove_event_timer",value:function(e){var n=(this.props[Fd]||{})[e];return Me(n)||(delete this.props[Fd][e],this.save()),n}},{key:"get_property",value:function(e){return this.props[e]}},{key:"set_property",value:function(e,n){this.props[e]=n,this.save()}}]),t}();function Cb(t){return JSON.stringify(t,(e=[],function(n,i){if(En(i)){for(;e.length>0&&e.at(-1)!==this;)e.pop();return e.includes(i)?"[Circular]":(e.push(i),i)}return i})).length;var e}var q4=2,Y4=4;function Eb(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:66060288e-1;if(t.size>=e&&t.data.length>1){var n=Math.floor(t.data.length/2),i=t.data.slice(0,n),r=t.data.slice(n);return[Eb({size:Cb(i),data:i,sessionId:t.sessionId,windowId:t.windowId}),Eb({size:Cb(r),data:r,sessionId:t.sessionId,windowId:t.windowId})].flatMap(function(s){return s})}return[t]}var jm=function(t){return t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t}(jm||{}),Ks=function(t){return t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t}(Ks||{});function yS(t){return t?Qv(t).split(/\s+/):[]}function sE(t){var e=V==null?void 0:V.location.href;return!!(e&&t&&t.some(function(n){return e.match(n)}))}function _g(t){var e="";switch(Ph(t.className)){case"string":e=t.className;break;case"object":e=("baseVal"in t.className?t.className.baseVal:null)||t.getAttribute("class")||"";break;default:e=""}return yS(e)}function qN(t){return yr(t)?null:Qv(t).split(/(\s+)/).filter(function(e){return Zu(e)}).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function Cg(t){var e="";return Pb(t)&&!QN(t)&&t.childNodes&&t.childNodes.length&&wt(t.childNodes,function(n){var i;YN(n)&&n.textContent&&(e+=(i=qN(n.textContent))!==null&&i!==void 0?i:"")}),Qv(e)}function wS(t){return!!t&&t.nodeType===1}function _a(t,e){return!!t&&!!t.tagName&&t.tagName.toLowerCase()===e.toLowerCase()}function YN(t){return!!t&&t.nodeType===3}function JN(t){return!!t&&t.nodeType===11}var Ab=["a","button","form","input","select","textarea","label"];function ZN(t){var e=t.parentNode;return!(!e||!wS(e))&&e}function J4(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(!V||!t||_a(t,"html")||!wS(t)||n!=null&&n.url_allowlist&&!sE(n.url_allowlist)||n!=null&&n.url_ignorelist&&sE(n.url_ignorelist))return!1;if(n!=null&&n.dom_event_allowlist){var s=n.dom_event_allowlist;if(s&&!s.some(function(f){return e.type===f}))return!1}for(var o=!1,a=[t],l=!0,u=t;u.parentNode&&!_a(u,"body");)if(JN(u.parentNode))a.push(u.parentNode.host),u=u.parentNode.host;else{if(!(l=ZN(u)))break;if(i||Ab.indexOf(l.tagName.toLowerCase())>-1)o=!0;else{var c=V.getComputedStyle(l);c&&c.getPropertyValue("cursor")==="pointer"&&(o=!0)}a.push(l),u=l}if(!function(f,p){var m=p==null?void 0:p.element_allowlist;if(Me(m))return!0;var w,v=Ar(f);try{var y=function(){var k=w.value;if(m.some(function(_){return k.tagName.toLowerCase()===_}))return{v:!0}};for(v.s();!(w=v.n()).done;){var b=y();if(Ph(b)==="object")return b.v}}catch(k){v.e(k)}finally{v.f()}return!1}(a,n)||!function(f,p){var m=p==null?void 0:p.css_selector_allowlist;if(Me(m))return!0;var w,v=Ar(f);try{var y=function(){var k=w.value;if(m.some(function(_){return k.matches(_)}))return{v:!0}};for(v.s();!(w=v.n()).done;){var b=y();if(Ph(b)==="object")return b.v}}catch(k){v.e(k)}finally{v.f()}return!1}(a,n))return!1;var d=V.getComputedStyle(t);if(d&&d.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var h=t.tagName.toLowerCase();switch(h){case"html":return!1;case"form":return(r||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(r||["change","click"]).indexOf(e.type)>=0;default:return o?(r||["click"]).indexOf(e.type)>=0:(r||["click"]).indexOf(e.type)>=0&&(Ab.indexOf(h)>-1||t.getAttribute("contenteditable")==="true")}}function Pb(t){for(var e=t;e.parentNode&&!_a(e,"body");e=e.parentNode){var n=_g(e);if(Ye(n,"ph-sensitive")||Ye(n,"ph-no-capture"))return!1}if(Ye(_g(t),"ph-include"))return!0;var i=t.type||"";if(Un(i))switch(i.toLowerCase()){case"hidden":case"password":return!1}var r=t.name||t.id||"";return!(Un(r)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(r.replace(/[^a-zA-Z0-9]/g,"")))}function QN(t){return!!(_a(t,"input")&&!["button","checkbox","submit","reset"].includes(t.type)||_a(t,"select")||_a(t,"textarea")||t.getAttribute("contenteditable")==="true")}var eM="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",Z4=new RegExp("^(?:".concat(eM,")$")),Q4=new RegExp(eM),tM="\\d{3}-?\\d{2}-?\\d{4}",e5=new RegExp("^(".concat(tM,")$")),t5=new RegExp("(".concat(tM,")"));function Zu(t){var e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return!(yr(t)||Un(t)&&(t=Qv(t),(e?Z4:Q4).test((t||"").replace(/[- ]/g,""))||(e?e5:t5).test(t)))}function oE(t){var e=Cg(t);return Zu(e="".concat(e," ").concat(nM(t)).trim())?e:""}function nM(t){var e="";return t&&t.childNodes&&t.childNodes.length&&wt(t.childNodes,function(n){var i;if(n&&((i=n.tagName)===null||i===void 0?void 0:i.toLowerCase())==="span")try{var r=Cg(n);e="".concat(e," ").concat(r).trim(),n.childNodes&&n.childNodes.length&&(e="".concat(e," ").concat(nM(n)).trim())}catch(s){re.error(s)}}),e}function n5(t){return function(e){var n=e.map(function(i){var r,s,o="";if(i.tag_name&&(o+=i.tag_name),i.attr_class){i.attr_class.sort();var a,l=Ar(i.attr_class);try{for(l.s();!(a=l.n()).done;){var u=a.value;o+=".".concat(u.replace(/"/g,""))}}catch(h){l.e(h)}finally{l.f()}}var c=ke(ke(ke(ke({},i.text?{text:i.text}:{}),{},{"nth-child":(r=i.nth_child)!==null&&r!==void 0?r:0,"nth-of-type":(s=i.nth_of_type)!==null&&s!==void 0?s:0},i.href?{href:i.href}:{}),i.attr_id?{attr_id:i.attr_id}:{}),i.attributes),d={};return Lm(c).sort(function(h,f){var p=Zn(h,1)[0],m=Zn(f,1)[0];return p.localeCompare(m)}).forEach(function(h){var f=Zn(h,2),p=f[0],m=f[1];return d[aE(p.toString())]=aE(m.toString())}),o+=":",o+=Lm(c).map(function(h){var f=Zn(h,2),p=f[0],m=f[1];return"".concat(p,'="').concat(m,'"')}).join("")});return n.join(";")}(function(e){return e.map(function(n){var i,r,s={text:(i=n.$el_text)===null||i===void 0?void 0:i.slice(0,400),tag_name:n.tag_name,href:(r=n.attr__href)===null||r===void 0?void 0:r.slice(0,2048),attr_class:i5(n),attr_id:n.attr__id,nth_child:n.nth_child,nth_of_type:n.nth_of_type,attributes:{}};return Lm(n).filter(function(o){return Zn(o,1)[0].indexOf("attr__")===0}).forEach(function(o){var a=Zn(o,2),l=a[0],u=a[1];return s.attributes[l]=u}),s})}(t))}function aE(t){return t.replace(/"|\\"/g,'\\"')}function i5(t){var e=t.attr__class;return e?an(e)?e:yS(e):void 0}var Tb="[SessionRecording]",Rb="redacted",kp={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:function(t){return t},recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io"]},r5=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],s5=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],o5=["/s/","/e/","/i/"];function lE(t,e,n,i){if(yr(t))return t;var r=(e==null?void 0:e["content-length"])||function(s){return new Blob([s]).size}(t);return Un(r)&&(r=parseInt(r)),r>n?Tb+" ".concat(i," body too large to record (").concat(r," bytes)"):t}function uE(t,e){if(yr(t))return t;var n=t;return Zu(n,!1)||(n=Tb+" "+e+" body "+Rb),wt(s5,function(i){var r,s;(r=n)!==null&&r!==void 0&&r.length&&((s=n)===null||s===void 0?void 0:s.indexOf(i))!==-1&&(n=Tb+" "+e+" body "+Rb+" as might contain: "+i)}),n}var Js,a5=function(t,e){var n,i,r,s={payloadSizeLimitBytes:kp.payloadSizeLimitBytes,performanceEntryTypeToObserve:wo(kp.performanceEntryTypeToObserve),payloadHostDenyList:[].concat(wo(e.payloadHostDenyList||[]),wo(kp.payloadHostDenyList))},o=t.session_recording.recordHeaders!==!1&&e.recordHeaders,a=t.session_recording.recordBody!==!1&&e.recordBody,l=t.capture_performance!==!1&&e.recordPerformance,u=(n=s,r=Math.min(1e6,(i=n.payloadSizeLimitBytes)!==null&&i!==void 0?i:1e6),function(h){return h!=null&&h.requestBody&&(h.requestBody=lE(h.requestBody,h.requestHeaders,r,"Request")),h!=null&&h.responseBody&&(h.responseBody=lE(h.responseBody,h.responseHeaders,r,"Response")),h}),c=function(h){return u(function(m){var w=ih(m.name);if(!(w&&w.pathname&&o5.some(function(v){return w.pathname.indexOf(v)===0})))return m}((p=(f=h).requestHeaders,yr(p)||wt(Object.keys(p??{}),function(m){r5.includes(m.toLowerCase())&&(p[m]=Rb)}),f)));var f,p},d=Yr(t.session_recording.maskNetworkRequestFn);return d&&Yr(t.session_recording.maskCapturedNetworkRequestFn)&&re.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),d&&(t.session_recording.maskCapturedNetworkRequestFn=function(h){var f=t.session_recording.maskNetworkRequestFn({url:h.name});return ke(ke({},h),{},{name:f==null?void 0:f.url})}),s.maskRequestFn=Yr(t.session_recording.maskCapturedNetworkRequestFn)?function(h){var f,p,m,w=c(h);return w&&(f=(p=(m=t.session_recording).maskCapturedNetworkRequestFn)===null||p===void 0?void 0:p.call(m,w))!==null&&f!==void 0?f:void 0}:function(h){return function(f){if(!Me(f))return f.requestBody=uE(f.requestBody,"Request"),f.responseBody=uE(f.responseBody,"Response"),f}(c(h))},ke(ke(ke({},kp),s),{},{recordHeaders:o,recordBody:a,recordPerformance:l,recordInitialRequests:l})},l5=lt(function t(e){var n,i,r=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};at(this,t),X(this,"bucketSize",100),X(this,"refillRate",10),X(this,"mutationBuckets",{}),X(this,"loggedTracker",{}),X(this,"refillBuckets",function(){Object.keys(r.mutationBuckets).forEach(function(o){r.mutationBuckets[o]=r.mutationBuckets[o]+r.refillRate,r.mutationBuckets[o]>=r.bucketSize&&delete r.mutationBuckets[o]})}),X(this,"getNodeOrRelevantParent",function(o){var a=r.rrweb.mirror.getNode(o);if((a==null?void 0:a.nodeName)!=="svg"&&a instanceof Element){var l=a.closest("svg");if(l)return[r.rrweb.mirror.getId(l),l]}return[o,a]}),X(this,"numberOfChanges",function(o){var a,l,u,c,d,h,f,p;return((a=(l=o.removes)===null||l===void 0?void 0:l.length)!==null&&a!==void 0?a:0)+((u=(c=o.attributes)===null||c===void 0?void 0:c.length)!==null&&u!==void 0?u:0)+((d=(h=o.texts)===null||h===void 0?void 0:h.length)!==null&&d!==void 0?d:0)+((f=(p=o.adds)===null||p===void 0?void 0:p.length)!==null&&f!==void 0?f:0)}),X(this,"throttleMutations",function(o){if(o.type!==3||o.data.source!==0)return o;var a=o.data,l=r.numberOfChanges(a);a.attributes&&(a.attributes=a.attributes.filter(function(c){var d,h,f,p=Zn(r.getNodeOrRelevantParent(c.id),2),m=p[0],w=p[1];return r.mutationBuckets[m]===0?!1:(r.mutationBuckets[m]=(d=r.mutationBuckets[m])!==null&&d!==void 0?d:r.bucketSize,r.mutationBuckets[m]=Math.max(r.mutationBuckets[m]-1,0),r.mutationBuckets[m]===0&&(r.loggedTracker[m]||(r.loggedTracker[m]=!0,(h=(f=r.options).onBlockedNode)===null||h===void 0||h.call(f,m,w))),c)}));var u=r.numberOfChanges(a);return u!==0||l===u?o:void 0}),this.rrweb=e,this.options=s,this.refillRate=(n=this.options.refillRate)!==null&&n!==void 0?n:this.refillRate,this.bucketSize=(i=this.options.bucketSize)!==null&&i!==void 0?i:this.bucketSize,setInterval(function(){r.refillBuckets()},1e3)}),u5=3e5,c5=[Ks.MouseMove,Ks.MouseInteraction,Ks.Scroll,Ks.ViewportResize,Ks.Input,Ks.TouchMove,Ks.MediaInteraction,Ks.Drag],cE=function(t){return{rrwebMethod:t,enqueuedAt:Date.now(),attempt:1}},Qi="[SessionRecording]",d5=function(){function t(e){var n=this;if(at(this,t),X(this,"queuedRRWebEvents",[]),X(this,"isIdle",!1),X(this,"_linkedFlagSeen",!1),X(this,"_lastActivityTimestamp",Date.now()),X(this,"_linkedFlag",null),X(this,"_forceAllowLocalhostNetworkCapture",!1),X(this,"_samplingSessionListener",null),this.instance=e,this._captureStarted=!1,this._endpoint="/s/",this.stopRrweb=void 0,this.receivedDecide=!1,V==null||V.addEventListener("beforeunload",function(){n._flushBuffer()}),V==null||V.addEventListener("offline",function(){n._tryAddCustomEvent("browser offline",{})}),V==null||V.addEventListener("online",function(){n._tryAddCustomEvent("browser online",{})}),V==null||V.addEventListener("visibilitychange",function(){if(Ee!=null&&Ee.visibilityState){var o="window "+Ee.visibilityState;n._tryAddCustomEvent(o,{})}}),!this.instance.sessionManager)throw re.error(Qi+" started without valid sessionManager"),new Error(Qi+" started without valid sessionManager. This is a bug.");var i=this.sessionManager.checkAndGetSessionAndWindowId(),r=i.sessionId,s=i.windowId;this.sessionId=r,this.windowId=s,this.buffer=this.clearBuffer(),this._setupSampling()}return lt(t,[{key:"rrwebRecord",get:function(){var e;return Vt==null||(e=Vt.rrweb)===null||e===void 0?void 0:e.record}},{key:"started",get:function(){return this._captureStarted}},{key:"sessionManager",get:function(){if(!this.instance.sessionManager)throw new Error(Qi+" must be started with a valid sessionManager.");return this.instance.sessionManager}},{key:"fullSnapshotIntervalMillis",get:function(){var e;return((e=this.instance.config.session_recording)===null||e===void 0?void 0:e.full_snapshot_interval_millis)||u5}},{key:"isSampled",get:function(){var e=this.instance.get_property(nh);return Tu(e)?e:null}},{key:"sessionDuration",get:function(){var e,n,i=(e=this.buffer)===null||e===void 0?void 0:e.data[((n=this.buffer)===null||n===void 0?void 0:n.data.length)-1],r=this.sessionManager.checkAndGetSessionAndWindowId(!0).sessionStartTimestamp;return i?i.timestamp-r:null}},{key:"isRecordingEnabled",get:function(){var e=!!this.instance.get_property(pb),n=!this.instance.config.disable_session_recording;return V&&e&&n}},{key:"isConsoleLogCaptureEnabled",get:function(){var e=!!this.instance.get_property(HC),n=this.instance.config.enable_recording_console_log;return n??e}},{key:"canvasRecording",get:function(){var e=this.instance.get_property(GC);return e&&e.fps&&e.quality?{enabled:e.enabled,fps:e.fps,quality:e.quality}:void 0}},{key:"networkPayloadCapture",get:function(){var e,n,i=this.instance.get_property(WC),r={recordHeaders:(e=this.instance.config.session_recording)===null||e===void 0?void 0:e.recordHeaders,recordBody:(n=this.instance.config.session_recording)===null||n===void 0?void 0:n.recordBody},s=(r==null?void 0:r.recordHeaders)||(i==null?void 0:i.recordHeaders),o=(r==null?void 0:r.recordBody)||(i==null?void 0:i.recordBody),a=En(this.instance.config.capture_performance)?this.instance.config.capture_performance.network_timing:this.instance.config.capture_performance,l=!!(Tu(a)?a:i!=null&&i.capturePerformance);return s||o||l?{recordHeaders:s,recordBody:o,recordPerformance:l}:void 0}},{key:"sampleRate",get:function(){var e=this.instance.get_property(KC);return ur(e)?e:null}},{key:"minimumDuration",get:function(){var e=this.instance.get_property(XC);return ur(e)?e:null}},{key:"status",get:function(){return this.receivedDecide?this.isRecordingEnabled?yr(this._linkedFlag)||this._linkedFlagSeen?Tu(this.isSampled)?this.isSampled?"sampled":"disabled":"active":"buffering":"disabled":"buffering"}},{key:"startIfEnabledOrStop",value:function(){this.isRecordingEnabled?(this._startCapture(),re.info(Qi+" started")):(this.stopRecording(),this.clearBuffer())}},{key:"stopRecording",value:function(){this._captureStarted&&this.stopRrweb&&(this.stopRrweb(),this.stopRrweb=void 0,this._captureStarted=!1,re.info(Qi+" stopped"))}},{key:"makeSamplingDecision",value:function(e){var n,i=this.sessionId!==e,r=this.sampleRate;if(ur(r)){var s,o=this.isSampled,a=i||!Tu(o);a?s=Math.random()<r:s=o,!s&&a&&re.warn(Qi+" Sample rate (".concat(r,") has determined that this sessionId (").concat(e,") will not be sent to the server.")),this._tryAddCustomEvent("samplingDecisionMade",{sampleRate:r}),(n=this.instance.persistence)===null||n===void 0||n.register(X({},nh,s))}else{var l;(l=this.instance.persistence)===null||l===void 0||l.register(X({},nh,null))}}},{key:"afterDecideResponse",value:function(e){var n,i,r,s=this;if(this._persistDecideResponse(e),this._linkedFlag=((n=e.sessionRecording)===null||n===void 0?void 0:n.linkedFlag)||null,(i=e.sessionRecording)!==null&&i!==void 0&&i.endpoint&&(this._endpoint=(r=e.sessionRecording)===null||r===void 0?void 0:r.endpoint),this._setupSampling(),!yr(this._linkedFlag)){var o=Un(this._linkedFlag)?this._linkedFlag:this._linkedFlag.flag,a=Un(this._linkedFlag)?null:this._linkedFlag.variant;this.instance.onFeatureFlags(function(l,u){var c=En(u)&&o in u,d=a?u[o]===a:c;if(d){var h={linkedFlag:o,linkedVariant:a},f="linked flag matched";re.info(Qi+" "+f,h),s._tryAddCustomEvent(f,h)}s._linkedFlagSeen=d})}this.receivedDecide=!0,this.startIfEnabledOrStop()}},{key:"_setupSampling",value:function(){var e=this;ur(this.sampleRate)&&Io(this._samplingSessionListener)&&(this._samplingSessionListener=this.sessionManager.onSessionId(function(n){e.makeSamplingDecision(n)}))}},{key:"_persistDecideResponse",value:function(e){if(this.instance.persistence){var n=this.instance.persistence,i=function(){var r,s,o,a,l,u,c,d,h=(r=e.sessionRecording)===null||r===void 0?void 0:r.sampleRate,f=yr(h)?null:parseFloat(h),p=(s=e.sessionRecording)===null||s===void 0?void 0:s.minimumDurationMilliseconds;n.register((X(d={},pb,!!e.sessionRecording),X(d,HC,(o=e.sessionRecording)===null||o===void 0?void 0:o.consoleLogRecordingEnabled),X(d,WC,ke({capturePerformance:e.capturePerformance},(a=e.sessionRecording)===null||a===void 0?void 0:a.networkPayloadCapture)),X(d,GC,{enabled:(l=e.sessionRecording)===null||l===void 0?void 0:l.recordCanvas,fps:(u=e.sessionRecording)===null||u===void 0?void 0:u.canvasFps,quality:(c=e.sessionRecording)===null||c===void 0?void 0:c.canvasQuality}),X(d,KC,f),X(d,XC,Me(p)?null:p),d))};i(),this.sessionManager.onSessionId(i)}}},{key:"log",value:function(e){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"log";(n=this.instance.sessionRecording)===null||n===void 0||n.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:i,trace:[],payload:[JSON.stringify(e)]}},timestamp:RN()})}},{key:"_startCapture",value:function(){var e=this;Me(Object.assign)||this._captureStarted||this.instance.config.disable_session_recording||this.instance.consent.isOptedOut()||(this._captureStarted=!0,this.sessionManager.checkAndGetSessionAndWindowId(),this.rrwebRecord?this._onScriptLoaded():this.instance.requestRouter.loadScript("/static/recorder.js?v=".concat(Vr.LIB_VERSION),function(n){if(n)return re.error(Qi+" could not load recorder.js",n);e._onScriptLoaded()}))}},{key:"isInteractiveEvent",value:function(e){var n;return e.type===3&&c5.indexOf((n=e.data)===null||n===void 0?void 0:n.source)!==-1}},{key:"_updateWindowAndSessionIds",value:function(e){var n=this.isInteractiveEvent(e);n||this.isIdle||e.timestamp-this._lastActivityTimestamp>3e5&&(this.isIdle=!0,clearTimeout(this._fullSnapshotTimer),this._flushBuffer());var i=!1;if(n&&(this._lastActivityTimestamp=e.timestamp,this.isIdle&&(this.isIdle=!1,this._tryAddCustomEvent("sessionNoLongerIdle",{reason:"user activity",type:e.type}),i=!0)),!this.isIdle){var r=this.sessionManager.checkAndGetSessionAndWindowId(!n,e.timestamp),s=r.windowId,o=r.sessionId,a=this.sessionId!==o,l=this.windowId!==s;this.windowId=s,this.sessionId=o,(i||[q4,Y4].indexOf(e.type)===-1&&(l||a||Me(this._fullSnapshotTimer)))&&this._tryTakeFullSnapshot()}}},{key:"_tryRRWebMethod",value:function(e){try{return e.rrwebMethod(),!0}catch(n){return this.queuedRRWebEvents.length<10?this.queuedRRWebEvents.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}):re.warn(Qi+" could not emit queued rrweb event.",n,e),!1}}},{key:"_tryAddCustomEvent",value:function(e,n){var i=this;return this._tryRRWebMethod(cE(function(){return i.rrwebRecord.addCustomEvent(e,n)}))}},{key:"_tryTakeFullSnapshot",value:function(){var e=this;return this._tryRRWebMethod(cE(function(){return e.rrwebRecord.takeFullSnapshot()}))}},{key:"_onScriptLoaded",value:function(){for(var e,n=this,i={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},r=this.instance.config.session_recording,s=0,o=Object.entries(r||{});s<o.length;s++){var a=Zn(o[s],2),l=a[0],u=a[1];l in i&&(i[l]=u)}if(this.canvasRecording&&this.canvasRecording.enabled&&(i.recordCanvas=!0,i.sampling={canvas:this.canvasRecording.fps},i.dataURLOptions={type:"image/webp",quality:this.canvasRecording.quality}),this.rrwebRecord){this.mutationRateLimiter=(e=this.mutationRateLimiter)!==null&&e!==void 0?e:new l5(this.rrwebRecord,{onBlockedNode:function(d,h){var f="Too many mutations on node '".concat(d,"'. Rate limiting. This could be due to SVG animations or something similar");re.info(f,{node:h}),n.log(Qi+" "+f,"warn")}});var c=this._gatherRRWebPlugins();this.stopRrweb=this.rrwebRecord(ke({emit:function(d){n.onRRwebEmit(d)},plugins:c},i)),this.instance._addCaptureHook(function(d){try{if(d==="$pageview"){var h=V?n._maskUrl(V.location.href):"";if(!h)return;n._tryAddCustomEvent("$pageview",{href:h})}}catch(f){re.error("Could not add $pageview to rrweb session",f)}}),this._lastActivityTimestamp=Date.now(),this.isIdle=!1,this._tryAddCustomEvent("$session_options",{sessionRecordingOptions:i,activePlugins:c.map(function(d){return d==null?void 0:d.name})}),this._tryAddCustomEvent("$posthog_config",{config:this.instance.config})}else re.error(Qi+"onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}},{key:"_scheduleFullSnapshot",value:function(){var e=this;if(this._fullSnapshotTimer&&clearInterval(this._fullSnapshotTimer),!this.isIdle){var n=this.fullSnapshotIntervalMillis;n&&(this._fullSnapshotTimer=setInterval(function(){e._tryTakeFullSnapshot()},n))}}},{key:"_gatherRRWebPlugins",value:function(){var e=[];return Vt.rrwebConsoleRecord&&this.isConsoleLogCaptureEnabled&&e.push(Vt.rrwebConsoleRecord.getRecordConsolePlugin()),this.networkPayloadCapture&&Yr(Vt.getRecordNetworkPlugin)&&(!L4.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?e.push(Vt.getRecordNetworkPlugin(a5(this.instance.config,this.networkPayloadCapture))):re.info(Qi+" NetworkCapture not started because we are on localhost.")),e}},{key:"onRRwebEmit",value:function(e){if(this._processQueuedEvents(),e&&En(e)){if(e.type===jm.Meta){var n=this._maskUrl(e.data.href);if(this._lastHref=n,!n)return;e.data.href=n}else this._pageViewFallBack();e.type===jm.FullSnapshot&&this._scheduleFullSnapshot();var i=this.mutationRateLimiter?this.mutationRateLimiter.throttleMutations(e):e;if(i){var r=function(a){var l=a;if(l&&En(l)&&l.type===6&&En(l.data)&&l.data.plugin==="rrweb/console@1"){l.data.payload.payload.length>10&&(l.data.payload.payload=l.data.payload.payload.slice(0,10),l.data.payload.payload.push("...[truncated]"));for(var u=[],c=0;c<l.data.payload.payload.length;c++)l.data.payload.payload[c]&&l.data.payload.payload[c].length>2e3?u.push(l.data.payload.payload[c].slice(0,2e3)+"...[truncated]"):u.push(l.data.payload.payload[c]);return l.data.payload.payload=u,a}return a}(i),s=Cb(r);if(this._updateWindowAndSessionIds(r),!this.isIdle||r.type===jm.Custom){var o={$snapshot_bytes:s,$snapshot_data:r,$session_id:this.sessionId,$window_id:this.windowId};this.status!=="disabled"?this._captureSnapshotBuffered(o):this.clearBuffer()}}}}},{key:"_pageViewFallBack",value:function(){if(!this.instance.config.capture_pageview&&V){var e=this._maskUrl(V.location.href);this._lastHref!==e&&(this._tryAddCustomEvent("$url_changed",{href:e}),this._lastHref=e)}}},{key:"_processQueuedEvents",value:function(){var e=this;if(this.queuedRRWebEvents.length){var n=wo(this.queuedRRWebEvents);this.queuedRRWebEvents=[],n.forEach(function(i){Date.now()-i.enqueuedAt<=2e3&&e._tryRRWebMethod(i)})}}},{key:"_maskUrl",value:function(e){var n=this.instance.config.session_recording;if(n.maskNetworkRequestFn){var i,r={url:e};return(i=r=n.maskNetworkRequestFn(r))===null||i===void 0?void 0:i.url}return e}},{key:"clearBuffer",value:function(){return this.buffer={size:0,data:[],sessionId:this.sessionId,windowId:this.windowId},this.buffer}},{key:"_flushBuffer",value:function(){var e=this;this.flushBufferTimer&&(clearTimeout(this.flushBufferTimer),this.flushBufferTimer=void 0);var n=this.minimumDuration,i=this.sessionDuration,r=ur(i)&&i>=0,s=ur(n)&&r&&i<n;return this.status==="buffering"||s?(this.flushBufferTimer=setTimeout(function(){e._flushBuffer()},2e3),this.buffer):(this.buffer.data.length>0&&Eb(this.buffer).forEach(function(o){e._captureSnapshot({$snapshot_bytes:o.size,$snapshot_data:o.data,$session_id:o.sessionId,$window_id:o.windowId})}),this.clearBuffer())}},{key:"_captureSnapshotBuffered",value:function(e){var n,i=this,r=2+(((n=this.buffer)===null||n===void 0?void 0:n.data.length)||0);(this.buffer.size+e.$snapshot_bytes+r>943718.4||this.buffer.sessionId!==this.sessionId)&&(this.buffer=this._flushBuffer()),this.buffer.size+=e.$snapshot_bytes,this.buffer.data.push(e.$snapshot_data),this.flushBufferTimer||(this.flushBufferTimer=setTimeout(function(){i._flushBuffer()},2e3))}},{key:"_captureSnapshot",value:function(e){this.instance.capture("$snapshot",e,{_url:this.instance.requestRouter.endpointFor("api",this._endpoint),_noTruncate:!0,_batchKey:"recordings"})}}]),t}(),h5=function(){function t(e){at(this,t),this.instance=e,this.instance.decideEndpointWasHit=this.instance._hasBootstrappedFeatureFlags()}return lt(t,[{key:"call",value:function(){var e=this,n={token:this.instance.config.token,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),person_properties:this.instance.get_property(Nu),group_properties:this.instance.get_property(Xo),disable_flags:this.instance.config.advanced_disable_feature_flags||this.instance.config.advanced_disable_feature_flags_on_first_load||void 0};this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:n,compression:this.instance.config.disable_compression?void 0:Hr.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:function(i){return e.parseDecideResponse(i.json)}})}},{key:"parseDecideResponse",value:function(e){var n=this;this.instance.featureFlags.setReloadingPaused(!1),this.instance.featureFlags._startReloadTimer();var i=!e;if(this.instance.config.advanced_disable_feature_flags_on_first_load||this.instance.config.advanced_disable_feature_flags||this.instance.featureFlags.receivedFeatureFlags(e??{},i),i)re.error("Failed to fetch feature flags from PostHog.");else{if(!Ee||!Ee.body)return re.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(function(){n.parseDecideResponse(e)},500);if(this.instance._afterDecideResponse(e),e.siteApps)if(this.instance.config.opt_in_site_apps){var r,s=Ar(e.siteApps);try{var o=function(){var a=r.value,l=a.id,u=a.url,c=n.instance.requestRouter.endpointFor("api",u);Vt["__$$ph_site_app_".concat(l)]=n.instance,n.instance.requestRouter.loadScript(c,function(d){if(d)return re.error("Error while initializing PostHog app with config id ".concat(l),d)})};for(s.s();!(r=s.n()).done;)o()}catch(a){s.e(a)}finally{s.f()}}else e.siteApps.length>0&&re.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}}]),t}(),f5=V!=null&&V.location?Sg(V.location.hash,"__posthog")||Sg(location.hash,"state"):null,dE="_postHogToolbarParams";(function(t){t[t.UNINITIALIZED=0]="UNINITIALIZED",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED"})(Js||(Js={}));var p5=function(){function t(e){at(this,t),this.instance=e}return lt(t,[{key:"setToolbarState",value:function(e){Vt.ph_toolbar_state=e}},{key:"getToolbarState",value:function(){var e;return(e=Vt.ph_toolbar_state)!==null&&e!==void 0?e:Js.UNINITIALIZED}},{key:"maybeLoadToolbar",value:function(){var e,n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(!V||!Ee)return!1;i=(e=i)!==null&&e!==void 0?e:V.location,s=(n=s)!==null&&n!==void 0?n:V.history;try{if(!r){try{V.localStorage.setItem("test","test"),V.localStorage.removeItem("test")}catch{return!1}r=V==null?void 0:V.localStorage}var o,a=f5||Sg(i.hash,"__posthog")||Sg(i.hash,"state"),l=a?BC(function(){return JSON.parse(atob(decodeURIComponent(a)))})||BC(function(){return JSON.parse(decodeURIComponent(a))}):null;return l&&l.action==="ph_authorize"?((o=l).source="url",o&&Object.keys(o).length>0&&(l.desiredHash?i.hash=l.desiredHash:s?s.replaceState(s.state,"",i.pathname+i.search):i.hash="")):((o=JSON.parse(r.getItem(dE)||"{}")).source="localstorage",delete o.userIntent),!(!o.token||this.instance.config.token!==o.token)&&(this.loadToolbar(o),!0)}catch{return!1}}},{key:"_callLoadToolbar",value:function(e){(Vt.ph_load_toolbar||Vt.ph_load_editor)(e,this.instance)}},{key:"loadToolbar",value:function(e){var n=this,i=!(Ee==null||!Ee.getElementById(xb));if(!V||i)return!1;var r=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,s=ke(ke({token:this.instance.config.token},e),{},{apiURL:this.instance.requestRouter.endpointFor("ui")},r?{instrument:!1}:{});if(V.localStorage.setItem(dE,JSON.stringify(ke(ke({},s),{},{source:void 0}))),this.getToolbarState()===Js.LOADED)this._callLoadToolbar(s);else if(this.getToolbarState()===Js.UNINITIALIZED){this.setToolbarState(Js.LOADING);var o=3e5,a=Math.floor(Date.now()/o)*o;this.instance.requestRouter.loadScript("/static/toolbar.js?t=".concat(a),function(l){if(l)return re.error("Failed to load toolbar",l),void n.setToolbarState(Js.UNINITIALIZED);n.setToolbarState(Js.LOADED),n._callLoadToolbar(s)}),mo(V,"turbolinks:load",function(){n.setToolbarState(Js.UNINITIALIZED),n.loadToolbar(s)})}return!0}},{key:"_loadEditor",value:function(e){return this.loadToolbar(e)}},{key:"maybeLoadEditor",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;return this.maybeLoadToolbar(e,n,i)}}]),t}(),m5=function(){function t(e){at(this,t),X(this,"isPaused",!0),X(this,"queue",[]),X(this,"flushTimeoutMs",3e3),this.sendRequest=e}return lt(t,[{key:"enqueue",value:function(e){this.queue.push(e),this.flushTimeout||this.setFlushTimeout()}},{key:"unload",value:function(){var e=this;this.clearFlushTimeout();var n=this.queue.length>0?this.formatQueue():{},i=Object.values(n);[].concat(wo(i.filter(function(r){return r.url.indexOf("/e")===0})),wo(i.filter(function(r){return r.url.indexOf("/e")!==0}))).map(function(r){e.sendRequest(ke(ke({},r),{},{transport:"sendBeacon"}))})}},{key:"enable",value:function(){this.isPaused=!1,this.setFlushTimeout()}},{key:"setFlushTimeout",value:function(){var e=this;this.isPaused||(this.flushTimeout=setTimeout(function(){if(e.clearFlushTimeout(),e.queue.length>0){var n=e.formatQueue(),i=function(s){var o=n[s],a=new Date().getTime();o.data&&an(o.data)&&wt(o.data,function(l){l.offset=Math.abs(l.timestamp-a),delete l.timestamp}),e.sendRequest(o)};for(var r in n)i(r)}},this.flushTimeoutMs))}},{key:"clearFlushTimeout",value:function(){clearTimeout(this.flushTimeout),this.flushTimeout=void 0}},{key:"formatQueue",value:function(){var e={};return wt(this.queue,function(n){var i,r=n,s=(r?r.batchKey:null)||r.url;Me(e[s])&&(e[s]=ke(ke({},r),{},{data:[]})),(i=e[s].data)===null||i===void 0||i.push(r.data)}),this.queue=[],e}}]),t}(),br=Uint8Array,_i=Uint16Array,_c=Uint32Array,bS=new br([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),xS=new br([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),hE=new br([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),iM=function(t,e){for(var n=new _i(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];var r=new _c(n[30]);for(i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)r[s]=s-n[i]<<5|i;return[n,r]},rM=iM(bS,2),g5=rM[0],Nb=rM[1];g5[28]=258,Nb[258]=28;for(var fE=iM(xS,0)[1],sM=new _i(32768),Tt=0;Tt<32768;++Tt){var pl=(43690&Tt)>>>1|(21845&Tt)<<1;pl=(61680&(pl=(52428&pl)>>>2|(13107&pl)<<2))>>>4|(3855&pl)<<4,sM[Tt]=((65280&pl)>>>8|(255&pl)<<8)>>>1}var rh=function(t,e,n){for(var i=t.length,r=0,s=new _i(e);r<i;++r)++s[t[r]-1];var o,a=new _i(e);for(r=0;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;for(o=new _i(i),r=0;r<i;++r)o[r]=sM[a[t[r]-1]++]>>>15-t[r];return o},Ul=new br(288);for(Tt=0;Tt<144;++Tt)Ul[Tt]=8;for(Tt=144;Tt<256;++Tt)Ul[Tt]=9;for(Tt=256;Tt<280;++Tt)Ul[Tt]=7;for(Tt=280;Tt<288;++Tt)Ul[Tt]=8;var Eg=new br(32);for(Tt=0;Tt<32;++Tt)Eg[Tt]=5;var v5=rh(Ul,9),y5=rh(Eg,5),oM=function(t){return(t/8>>0)+(7&t&&1)},aM=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var i=new(t instanceof _i?_i:t instanceof _c?_c:br)(n-e);return i.set(t.subarray(e,n)),i},Vs=function(t,e,n){n<<=7&e;var i=e/8>>0;t[i]|=n,t[i+1]|=n>>>8},hd=function(t,e,n){n<<=7&e;var i=e/8>>0;t[i]|=n,t[i+1]|=n>>>8,t[i+2]|=n>>>16},v0=function(t,e){for(var n=[],i=0;i<t.length;++i)t[i]&&n.push({s:i,f:t[i]});var r=n.length,s=n.slice();if(!r)return[new br(0),0];if(r==1){var o=new br(n[0].s+1);return o[n[0].s]=1,[o,1]}n.sort(function(_,E){return _.f-E.f}),n.push({s:-1,f:25001});var a=n[0],l=n[1],u=0,c=1,d=2;for(n[0]={s:-1,f:a.f+l.f,l:a,r:l};c!=r-1;)a=n[n[u].f<n[d].f?u++:d++],l=n[u!=c&&n[u].f<n[d].f?u++:d++],n[c++]={s:-1,f:a.f+l.f,l:a,r:l};var h=s[0].s;for(i=1;i<r;++i)s[i].s>h&&(h=s[i].s);var f=new _i(h+1),p=w5(n[c-1],f,0);if(p>e){i=0;var m=0,w=p-e,v=1<<w;for(s.sort(function(_,E){return f[E.s]-f[_.s]||_.f-E.f});i<r;++i){var y=s[i].s;if(!(f[y]>e))break;m+=v-(1<<p-f[y]),f[y]=e}for(m>>>=w;m>0;){var b=s[i].s;f[b]<e?m-=1<<e-f[b]++-1:++i}for(;i>=0&&m;--i){var k=s[i].s;f[k]==e&&(--f[k],++m)}p=e}return[new br(f),p]},w5=function t(e,n,i){return e.s==-1?Math.max(t(e.l,n,i+1),t(e.r,n,i+1)):n[e.s]=i},pE=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new _i(++e),i=0,r=t[0],s=1,o=function(l){n[i++]=l},a=1;a<=e;++a)if(t[a]==r&&a!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(r),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(r);s=1,r=t[a]}return[n.subarray(0,i),e]},fd=function(t,e){for(var n=0,i=0;i<e.length;++i)n+=t[i]*e[i];return n},Mb=function(t,e,n){var i=n.length,r=oM(e+2);t[r]=255&i,t[r+1]=i>>>8,t[r+2]=255^t[r],t[r+3]=255^t[r+1];for(var s=0;s<i;++s)t[r+s+4]=n[s];return 8*(r+4+i)},mE=function(t,e,n,i,r,s,o,a,l,u,c){Vs(e,c++,n),++r[256];for(var d=v0(r,15),h=d[0],f=d[1],p=v0(s,15),m=p[0],w=p[1],v=pE(h),y=v[0],b=v[1],k=pE(m),_=k[0],E=k[1],A=new _i(19),P=0;P<y.length;++P)A[31&y[P]]++;for(P=0;P<_.length;++P)A[31&_[P]]++;for(var D=v0(A,7),L=D[0],B=D[1],$=19;$>4&&!L[hE[$-1]];--$);var J,z,G,Q,ie=u+5<<3,H=fd(r,Ul)+fd(s,Eg)+o,j=fd(r,h)+fd(s,m)+o+14+3*$+fd(A,L)+(2*A[16]+3*A[17]+7*A[18]);if(ie<=H&&ie<=j)return Mb(e,c,t.subarray(l,l+u));if(Vs(e,c,1+(j<H)),c+=2,j<H){J=rh(h,f),z=h,G=rh(m,w),Q=m;var te=rh(L,B);for(Vs(e,c,b-257),Vs(e,c+5,E-1),Vs(e,c+10,$-4),c+=14,P=0;P<$;++P)Vs(e,c+3*P,L[hE[P]]);c+=3*$;for(var pe=[y,_],q=0;q<2;++q){var ue=pe[q];for(P=0;P<ue.length;++P){var O=31&ue[P];Vs(e,c,te[O]),c+=L[O],O>15&&(Vs(e,c,ue[P]>>>5&127),c+=ue[P]>>>12)}}}else J=v5,z=Ul,G=y5,Q=Eg;for(P=0;P<a;++P)if(i[P]>255){O=i[P]>>>18&31,hd(e,c,J[O+257]),c+=z[O+257],O>7&&(Vs(e,c,i[P]>>>23&31),c+=bS[O]);var M=31&i[P];hd(e,c,G[M]),c+=Q[M],M>3&&(hd(e,c,i[P]>>>5&8191),c+=xS[M])}else hd(e,c,J[i[P]]),c+=z[i[P]];return hd(e,c,J[256]),c+z[256]},b5=new _c([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),x5=function(){for(var t=new _c(256),e=0;e<256;++e){for(var n=e,i=9;--i;)n=(1&n&&3988292384)^n>>>1;t[e]=n}return t}(),S5=function(t,e,n,i,r){return function(s,o,a,l,u,c){var d=s.length,h=new br(l+d+5*(1+Math.floor(d/7e3))+u),f=h.subarray(l,h.length-u),p=0;if(!o||d<8)for(var m=0;m<=d;m+=65535){var w=m+65535;w<d?p=Mb(f,p,s.subarray(m,w)):(f[m]=c,p=Mb(f,p,s.subarray(m,d)))}else{for(var v=b5[o-1],y=v>>>13,b=8191&v,k=(1<<a)-1,_=new _i(32768),E=new _i(k+1),A=Math.ceil(a/3),P=2*A,D=function(Ie){return(s[Ie]^s[Ie+1]<<A^s[Ie+2]<<P)&k},L=new _c(25e3),B=new _i(288),$=new _i(32),J=0,z=0,G=(m=0,0),Q=0,ie=0;m<d;++m){var H=D(m),j=32767&m,te=E[H];if(_[j]=te,E[H]=j,Q<=m){var pe=d-m;if((J>7e3||G>24576)&&pe>423){p=mE(s,f,0,L,B,$,z,G,ie,m-ie,p),G=J=z=0,ie=m;for(var q=0;q<286;++q)B[q]=0;for(q=0;q<30;++q)$[q]=0}var ue=2,O=0,M=b,F=j-te&32767;if(pe>2&&H==D(m-F))for(var x=Math.min(y,pe)-1,T=Math.min(32767,m),N=Math.min(258,pe);F<=T&&--M&&j!=te;){if(s[m+ue]==s[m+ue-F]){for(var R=0;R<N&&s[m+R]==s[m+R-F];++R);if(R>ue){if(ue=R,O=F,R>x)break;var W=Math.min(F,R-2),U=0;for(q=0;q<W;++q){var Z=m-F+q+32768&32767,K=Z-_[Z]+32768&32767;K>U&&(U=K,te=Z)}}}F+=(j=te)-(te=_[j])+32768&32767}if(O){L[G++]=268435456|Nb[ue]<<18|fE[O];var Se=31&Nb[ue],Oe=31&fE[O];z+=bS[Se]+xS[Oe],++B[257+Se],++$[Oe],Q=m+ue,++J}else L[G++]=s[m],++B[s[m]]}}p=mE(s,f,c,L,B,$,z,G,ie,m-ie,p)}return aM(h,0,l+oM(p)+u)}(t,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,n,i,!r)},y0=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8};function k5(t,e){e===void 0&&(e={});var n=function(){var a=4294967295;return{p:function(l){for(var u=a,c=0;c<l.length;++c)u=x5[255&u^l[c]]^u>>>8;a=u},d:function(){return 4294967295^a}}}(),i=t.length;n.p(t);var r,s=S5(t,e,10+((r=e).filename&&r.filename.length+1||0),8),o=s.length;return function(a,l){var u=l.filename;if(a[0]=31,a[1]=139,a[2]=8,a[8]=l.level<2?4:l.level==9?2:0,a[9]=3,l.mtime!=0&&y0(a,4,Math.floor(new Date(l.mtime||Date.now())/1e3)),u){a[3]=8;for(var c=0;c<=u.length;++c)a[c+10]=u.charCodeAt(c)}}(s,e),y0(s,o-8,n.d()),y0(s,o-4,i),s}var _5=!!cb||!!ub,gE="text/plain",Ag=function(t,e){var n=Zn(t.split("?"),2),i=n[0],r=n[1],s=ke({},e);r==null||r.split("&").forEach(function(a){var l=Zn(a.split("="),1)[0];delete s[l]});var o=j4(s);return o=o?(r?r+"&":"")+o:r,"".concat(i,"?").concat(o)},C5=function(t){return"data="+encodeURIComponent(typeof t=="string"?t:JSON.stringify(t))},w0=function(t){var e=t.data,n=t.compression;if(e){if(n===Hr.GZipJS){var i=k5(function(s,o){var a=s.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(s);for(var l=new br(s.length+(s.length>>>1)),u=0,c=function(p){l[u++]=p},d=0;d<a;++d){if(u+5>l.length){var h=new br(u+8+(a-d<<1));h.set(l),l=h}var f=s.charCodeAt(d);f<128||o?c(f):f<2048?(c(192|f>>>6),c(128|63&f)):f>55295&&f<57344?(c(240|(f=65536+(1047552&f)|1023&s.charCodeAt(++d))>>>18),c(128|f>>>12&63),c(128|f>>>6&63),c(128|63&f)):(c(224|f>>>12),c(128|f>>>6&63),c(128|63&f))}return aM(l,0,u)}(JSON.stringify(e)),{mtime:0});return{contentType:gE,body:new Blob([i],{type:gE})}}if(n===Hr.Base64){var r=function(s){var o,a,l,u,c,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=0,f=0,p="",m=[];if(!s)return s;s=_4(s);do o=(c=s.charCodeAt(h++)<<16|s.charCodeAt(h++)<<8|s.charCodeAt(h++))>>18&63,a=c>>12&63,l=c>>6&63,u=63&c,m[f++]=d.charAt(o)+d.charAt(a)+d.charAt(l)+d.charAt(u);while(h<s.length);switch(p=m.join(""),s.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"="}return p}(JSON.stringify(e));return{contentType:"application/x-www-form-urlencoded",body:C5(r)}}return{contentType:"application/json",body:JSON.stringify(e)}}},sh=[];cb&&sh.push({transport:"XHR",method:function(t){var e,n=new cb;n.open(t.method||"GET",t.url,!0);var i=(e=w0(t))!==null&&e!==void 0?e:{},r=i.contentType,s=i.body;wt(t.headers,function(o,a){n.setRequestHeader(a,o)}),r&&n.setRequestHeader("Content-Type",r),t.timeout&&(n.timeout=t.timeout),n.withCredentials=!0,n.onreadystatechange=function(){if(n.readyState===4){var o,a={statusCode:n.status,text:n.responseText};if(n.status===200)try{a.json=JSON.parse(n.responseText)}catch{}(o=t.callback)===null||o===void 0||o.call(t,a)}},n.send(s)}}),ub&&sh.push({transport:"fetch",method:function(t){var e,n,i=(e=w0(t))!==null&&e!==void 0?e:{},r=i.contentType,s=i.body,o=new Headers;wt(o,function(c,d){o.append(d,c)}),r&&o.append("Content-Type",r);var a=t.url,l=null;if(jC){var u=new jC;l={signal:u.signal,timeout:setTimeout(function(){return u.abort()},t.timeout)}}ub(a,{method:(t==null?void 0:t.method)||"GET",headers:o,keepalive:t.method==="POST",body:s,signal:(n=l)===null||n===void 0?void 0:n.signal}).then(function(c){return c.text().then(function(d){var h,f={statusCode:c.status,text:d};if(c.status===200)try{f.json=JSON.parse(d)}catch(p){re.error(p)}(h=t.callback)===null||h===void 0||h.call(t,f)})}).catch(function(c){var d;re.error(c),(d=t.callback)===null||d===void 0||d.call(t,{statusCode:0,text:c})}).finally(function(){return l?clearTimeout(l.timeout):null})}}),go!=null&&go.sendBeacon&&sh.push({transport:"sendBeacon",method:function(t){var e=Ag(t.url,{beacon:"1"});try{var n,i=(n=w0(t))!==null&&n!==void 0?n:{},r=i.contentType,s=i.body,o=typeof s=="string"?new Blob([s],{type:r}):s;go.sendBeacon(e,o)}catch{}}});var E5=["retriesPerformedSoFar"],Tl,A5=function(){function t(e){var n=this;at(this,t),X(this,"isPolling",!1),X(this,"pollIntervalMs",3e3),X(this,"queue",[]),this.instance=e,this.queue=[],this.areWeOnline=!0,!Me(V)&&"onLine"in V.navigator&&(this.areWeOnline=V.navigator.onLine,V.addEventListener("online",function(){n.areWeOnline=!0,n.flush()}),V.addEventListener("offline",function(){n.areWeOnline=!1}))}return lt(t,[{key:"retriableRequest",value:function(e){var n=this,i=e.retriesPerformedSoFar,r=w4(e,E5);ur(i)&&i>0&&(r.url=Ag(r.url,{retry_count:i})),this.instance._send_request(ke(ke({},r),{},{callback:function(s){var o;s.statusCode!==200&&(s.statusCode<400||s.statusCode>=500)&&(i??0)<10?n.enqueue(ke({retriesPerformedSoFar:i},r)):(o=r.callback)===null||o===void 0||o.call(r,s)}}))}},{key:"enqueue",value:function(e){var n=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=n+1;var i=function(o){var a=3e3*Math.pow(2,o),l=a/2,u=Math.min(18e5,a),c=(Math.random()-.5)*(u-l);return Math.ceil(u+c)}(n),r=Date.now()+i;this.queue.push({retryAt:r,requestOptions:e});var s="Enqueued failed request for retry in ".concat(i);navigator.onLine||(s+=" (Browser is offline)"),re.warn(s),this.isPolling||(this.isPolling=!0,this.poll())}},{key:"poll",value:function(){var e=this;this.poller&&clearTimeout(this.poller),this.poller=setTimeout(function(){e.areWeOnline&&e.queue.length>0&&e.flush(),e.poll()},this.pollIntervalMs)}},{key:"flush",value:function(){var e=Date.now(),n=[],i=this.queue.filter(function(a){return a.retryAt<e||(n.push(a),!1)});if(this.queue=n,i.length>0){var r,s=Ar(i);try{for(s.s();!(r=s.n()).done;){var o=r.value.requestOptions;this.retriableRequest(o)}}catch(a){s.e(a)}finally{s.f()}}}},{key:"unload",value:function(){this.poller&&(clearTimeout(this.poller),this.poller=void 0);var e,n=Ar(this.queue);try{for(n.s();!(e=n.n()).done;){var i=e.value.requestOptions;try{this.instance._send_request(ke(ke({},i),{},{transport:"sendBeacon"}))}catch(r){re.error(r)}}}catch(r){n.e(r)}finally{n.f()}this.queue=[]}}]),t}(),_p=1800,P5=function(){function t(e,n,i,r){var s;at(this,t),X(this,"_sessionIdChangedHandlers",[]),this.config=e,this.persistence=n,this._windowId=void 0,this._sessionId=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this._sessionIdGenerator=i||da,this._windowIdGenerator=r||da;var o=e.persistence_name||e.token,a=e.session_idle_timeout_seconds||_p;if(ur(a)?a>_p?re.warn("session_idle_timeout_seconds cannot be  greater than 30 minutes. Using 30 minutes instead."):a<60&&re.warn("session_idle_timeout_seconds cannot be less than 60 seconds. Using 60 seconds instead."):(re.warn("session_idle_timeout_seconds must be a number. Defaulting to 30 minutes."),a=_p),this._sessionTimeoutMs=1e3*Math.min(Math.max(a,60),_p),this._window_id_storage_key="ph_"+o+"_window_id",this._primary_window_exists_storage_key="ph_"+o+"_primary_window_exists",this._canUseSessionStorage()){var l=xn.parse(this._window_id_storage_key),u=xn.parse(this._primary_window_exists_storage_key);l&&!u?this._windowId=l:xn.remove(this._window_id_storage_key),xn.set(this._primary_window_exists_storage_key,!0)}if((s=this.config.bootstrap)!==null&&s!==void 0&&s.sessionID)try{var c=function(d){var h=d.replace(/-/g,"");if(h.length!==32)throw new Error("Not a valid UUID");if(h[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(h.substring(0,12),16)}(this.config.bootstrap.sessionID);this._setSessionId(this.config.bootstrap.sessionID,new Date().getTime(),c)}catch(d){re.error("Invalid sessionID in bootstrap",d)}this._listenToReloadWindow()}return lt(t,[{key:"onSessionId",value:function(e){var n=this;return Me(this._sessionIdChangedHandlers)&&(this._sessionIdChangedHandlers=[]),this._sessionIdChangedHandlers.push(e),this._sessionId&&e(this._sessionId,this._windowId),function(){n._sessionIdChangedHandlers=n._sessionIdChangedHandlers.filter(function(i){return i!==e})}}},{key:"_canUseSessionStorage",value:function(){return this.config.persistence!=="memory"&&!this.persistence.disabled&&xn.is_supported()}},{key:"_setWindowId",value:function(e){e!==this._windowId&&(this._windowId=e,this._canUseSessionStorage()&&xn.set(this._window_id_storage_key,e))}},{key:"_getWindowId",value:function(){return this._windowId?this._windowId:this._canUseSessionStorage()?xn.parse(this._window_id_storage_key):null}},{key:"_setSessionId",value:function(e,n,i){e===this._sessionId&&n===this._sessionActivityTimestamp&&i===this._sessionStartTimestamp||(this._sessionStartTimestamp=i,this._sessionActivityTimestamp=n,this._sessionId=e,this.persistence.register(X({},yg,[n,e,i])))}},{key:"_getSessionId",value:function(){if(this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];var e=this.persistence.props[yg];return an(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}},{key:"resetSessionId",value:function(){this._setSessionId(null,null,null)}},{key:"_listenToReloadWindow",value:function(){var e=this;V==null||V.addEventListener("beforeunload",function(){e._canUseSessionStorage()&&xn.remove(e._primary_window_exists_storage_key)})}},{key:"checkAndGetSessionAndWindowId",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:null)||new Date().getTime(),i=Zn(this._getSessionId(),3),r=i[0],s=i[1],o=i[2],a=this._getWindowId(),l=o&&o>0&&Math.abs(n-o)>864e5,u=!1,c=!s,d=!e&&Math.abs(n-r)>this._sessionTimeoutMs;c||d||l?(s=this._sessionIdGenerator(),a=this._windowIdGenerator(),re.info("[SessionId] new session ID generated",{sessionId:s,windowId:a,changeReason:{noSessionId:c,activityTimeout:d,sessionPastMaximumLength:l}}),o=n,u=!0):a||(a=this._windowIdGenerator(),u=!0);var h=r===0||!e||l?n:r,f=o===0?new Date().getTime():o;return this._setWindowId(a),this._setSessionId(s,h,f),u&&this._sessionIdChangedHandlers.forEach(function(p){return p(s,a)}),{sessionId:s,windowId:a,sessionStartTimestamp:f}}}]),t}();(function(t){t.US="us",t.EU="eu",t.CUSTOM="custom"})(Tl||(Tl={}));var vE="i.posthog.com",T5=function(){function t(e){at(this,t),X(this,"_regionCache",{}),this.instance=e}return lt(t,[{key:"apiHost",get:function(){return this.instance.config.api_host.trim().replace(/\/$/,"")}},{key:"uiHost",get:function(){var e,n=(e=this.instance.config.ui_host)===null||e===void 0?void 0:e.replace(/\/$/,"");return n==="https://app.posthog.com"?"https://us.posthog.com":n}},{key:"region",get:function(){return this._regionCache[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=Tl.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=Tl.EU:this._regionCache[this.apiHost]=Tl.CUSTOM),this._regionCache[this.apiHost]}},{key:"endpointFor",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(n&&(n=n[0]==="/"?n:"/".concat(n)),e==="ui")return(this.uiHost||this.apiHost.replace(".".concat(vE),".posthog.com"))+n;if(this.region===Tl.CUSTOM)return this.apiHost+n;var i=vE+n;switch(e){case"assets":return"https://".concat(this.region,"-assets.").concat(i);case"api":return"https://".concat(this.region,".").concat(i)}}},{key:"loadScript",value:function(e,n){if(this.instance.config.disable_external_dependency_loading)return re.warn("".concat(e," was requested but loading of external scripts is disabled.")),n("Loading of external scripts is disabled");var i=e[0]==="/"?this.endpointFor("assets",e):e,r=function(){if(!Ee)return n("document not found");var s=Ee.createElement("script");s.type="text/javascript",s.src=i,s.onload=function(l){return n(void 0,l)},s.onerror=function(l){return n(l)};var o,a=Ee.querySelectorAll("body > script");a.length>0?(o=a[0].parentNode)===null||o===void 0||o.insertBefore(s,a[0]):Ee.body.appendChild(s)};Ee!=null&&Ee.body?r():Ee==null||Ee.addEventListener("DOMContentLoaded",r)}}]),t}(),Ob="/e/",Cp="[Exception Capture]",R5=function(){function t(e){var n,i,r=this;at(this,t),X(this,"originalOnUnhandledRejectionHandler",void 0),X(this,"startCapturing",function(){var s;if(V&&r.isEnabled&&!r.hasHandlers&&((s=V.onerror)===null||s===void 0||!s.__POSTHOG_INSTRUMENTED__)){var o=V.posthogErrorWrappingFunctions.wrapOnError,a=V.posthogErrorWrappingFunctions.wrapUnhandledRejection;if(o&&a)try{r.unwrapOnError=o(r.captureException.bind(r)),r.unwrapUnhandledRejection=a(r.captureException.bind(r))}catch(l){re.error(Cp+" failed to start",l),r.stopCapturing()}else re.error(Cp+" failed to load error wrapping functions - cannot start")}}),this.instance=e,this.remoteEnabled=!((n=this.instance.persistence)===null||n===void 0||!n.props[zC]),this._endpoint=((i=this.instance.persistence)===null||i===void 0?void 0:i.props[UC])||Ob,this.startIfEnabled()}return lt(t,[{key:"endpoint",get:function(){return this._endpoint}},{key:"isEnabled",get:function(){var e;return(e=this.remoteEnabled)!==null&&e!==void 0&&e}},{key:"isCapturing",get:function(){var e;return!(V==null||(e=V.onerror)===null||e===void 0||!e.__POSTHOG_INSTRUMENTED__)}},{key:"hasHandlers",get:function(){return this.originalOnUnhandledRejectionHandler||this.unwrapOnError}},{key:"startIfEnabled",value:function(){this.isEnabled&&!this.isCapturing&&(re.info(Cp+" enabled, starting..."),this.loadScript(this.startCapturing))}},{key:"loadScript",value:function(e){this.hasHandlers&&e(),this.instance.requestRouter.loadScript(this.instance.requestRouter.endpointFor("assets","/static/exception-autocapture.js?v=".concat(Vr.LIB_VERSION)),function(n){if(n)return re.error(Cp+" failed to load script",n);e()})}},{key:"stopCapturing",value:function(){var e,n;(e=this.unwrapOnError)===null||e===void 0||e.call(this),(n=this.unwrapUnhandledRejection)===null||n===void 0||n.call(this)}},{key:"afterDecideResponse",value:function(e){var n=e.autocaptureExceptions;this.remoteEnabled=!!n||!1,this._endpoint=En(n)&&n.endpoint||Ob,this.instance.persistence&&(this.instance.persistence.register(X({},zC,this.remoteEnabled)),this.instance.persistence.register(X({},UC,this._endpoint))),this.startIfEnabled()}},{key:"captureException",value:function(e){var n=this.instance.requestRouter.endpointFor("ui");e.$exception_personURL="".concat(n,"/project/").concat(this.instance.config.token,"/person/").concat(this.instance.get_distinct_id()),this.sendExceptionEvent(e)}},{key:"sendExceptionEvent",value:function(e){this.instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent",_url:this.endpoint})}}]),t}(),lM="posthog-js";function uM(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.organization,i=e.projectId,r=e.prefix,s=e.severityAllowList,o=s===void 0?["error"]:s;return function(a){var l,u,c,d,h,f;if(!(o==="*"||o.includes(a.level))||!t.__loaded)return a;a.tags||(a.tags={});var p=t.requestRouter.endpointFor("ui","/project/".concat(t.config.token,"/person/").concat(t.get_distinct_id()));a.tags["PostHog Person URL"]=p,t.sessionRecordingStarted()&&(a.tags["PostHog Recording URL"]=t.get_session_replay_url({withTimestamp:!0}));var m=((l=a.exception)===null||l===void 0?void 0:l.values)||[],w={$exception_message:((u=m[0])===null||u===void 0?void 0:u.value)||a.message,$exception_type:(c=m[0])===null||c===void 0?void 0:c.type,$exception_personURL:p,$exception_level:a.level,$sentry_event_id:a.event_id,$sentry_exception:a.exception,$sentry_exception_message:((d=m[0])===null||d===void 0?void 0:d.value)||a.message,$sentry_exception_type:(h=m[0])===null||h===void 0?void 0:h.type,$sentry_tags:a.tags,$level:a.level};return n&&i&&(w.$sentry_url=(r||"https://sentry.io/organizations/")+n+"/issues/?project="+i+"&query="+a.event_id),t.capture("$exception",w,{_url:((f=t.exceptionObserver)===null||f===void 0?void 0:f.endpoint)||Ob}),a}}var N5=lt(function t(e,n,i,r,s){at(this,t),this.name=lM,this.setupOnce=function(o){o(uM(e,{organization:n,projectId:i,prefix:r,severityAllowList:s}))}});function M5(t,e){var n=t.config.segment;if(!n)return e();(function(i,r){var s=i.config.segment;if(!s)return r();var o=function(l){var u=function(){return l.anonymousId()||da()};i.config.get_device_id=u,l.id()&&(i.register({distinct_id:l.id(),$device_id:u()}),i.persistence.set_property(Ys,"identified")),r()},a=s.user();"then"in a&&Yr(a.then)?a.then(function(l){return o(l)}):o(a)})(t,function(){n.register(function(i){Promise&&Promise.resolve||re.warn("This browser does not have Promise support, and can not use the segment integration");var r=function(s,o){var a;if(!o)return s;s.event.userId||s.event.anonymousId===i.get_distinct_id()||i.reset(),s.event.userId&&s.event.userId!==i.get_distinct_id()&&(i.register({distinct_id:s.event.userId}),i.reloadFeatureFlags());var l=i._calculate_event_properties(o,(a=s.event.properties)!==null&&a!==void 0?a:{});return s.event.properties=Object.assign({},l,s.event.properties),s};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:function(){return!0},load:function(){return Promise.resolve()},track:function(s){return r(s,s.event.event)},page:function(s){return r(s,"$pageview")},identify:function(s){return r(s,"$identify")},screen:function(s){return r(s,"$screen")}}}(t)).then(function(){e()})})}var yE,Pg,Dr,O5=function(){function t(e){at(this,t),this._instance=e}return lt(t,[{key:"doPageView",value:function(){var e,n=this._previousScrollProperties();return this._currentPath=(e=V==null?void 0:V.location.pathname)!==null&&e!==void 0?e:"",this._instance.scrollManager.resetContext(),n}},{key:"doPageLeave",value:function(){return this._previousScrollProperties()}},{key:"_previousScrollProperties",value:function(){var e=this._currentPath,n=this._instance.scrollManager.getContext();if(!e||!n)return{};var i=n.maxScrollHeight,r=n.lastScrollY,s=n.maxScrollY,o=n.maxContentHeight,a=n.lastContentY,l=n.maxContentY;return Me(i)||Me(r)||Me(s)||Me(o)||Me(a)||Me(l)?{}:(i=Math.ceil(i),r=Math.ceil(r),s=Math.ceil(s),o=Math.ceil(o),a=Math.ceil(a),l=Math.ceil(l),{$prev_pageview_pathname:e,$prev_pageview_last_scroll:r,$prev_pageview_last_scroll_percentage:i<=1?1:Ep(r/i,0,1),$prev_pageview_max_scroll:s,$prev_pageview_max_scroll_percentage:i<=1?1:Ep(s/i,0,1),$prev_pageview_last_content:a,$prev_pageview_last_content_percentage:o<=1?1:Ep(a/o,0,1),$prev_pageview_max_content:l,$prev_pageview_max_content_percentage:o<=1?1:Ep(l/o,0,1)})}}]),t}();function Ep(t,e,n){return Math.max(e,Math.min(t,n))}(function(t){t.Popover="popover",t.API="api",t.Widget="widget"})(yE||(yE={})),function(t){t.Open="open",t.MultipleChoice="multiple_choice",t.SingleChoice="single_choice",t.Rating="rating",t.Link="link"}(Pg||(Pg={})),function(t){t.NextQuestion="next_question",t.End="end",t.ResponseBased="response_based",t.SpecificQuestion="specific_question"}(Dr||(Dr={}));var cM=function(){function t(){at(this,t),X(this,"events",{}),this.events={}}return lt(t,[{key:"on",value:function(e,n){var i=this;return this.events[e]||(this.events[e]=[]),this.events[e].push(n),function(){i.events[e]=i.events[e].filter(function(r){return r!==n})}}},{key:"emit",value:function(e,n){var i,r=Ar(this.events[e]||[]);try{for(r.s();!(i=r.n()).done;)(0,i.value)(n)}catch(a){r.e(a)}finally{r.f()}var s,o=Ar(this.events["*"]||[]);try{for(o.s();!(s=o.n()).done;)(0,s.value)(e,n)}catch(a){o.e(a)}finally{o.f()}}}]),t}(),D5=function(){function t(e){var n=this;at(this,t),X(this,"_debugEventEmitter",new cM),X(this,"checkStep",function(i,r){return n.checkStepEvent(i,r)&&n.checkStepUrl(i,r)&&n.checkStepElement(i,r)}),X(this,"checkStepEvent",function(i,r){return r==null||!r.event||(i==null?void 0:i.event)===(r==null?void 0:r.event)}),this.instance=e,this.actionEvents=new Set,this.actionRegistry=new Set}return lt(t,[{key:"init",value:function(){var e,n=this;if(!Me((e=this.instance)===null||e===void 0?void 0:e._addCaptureHook)){var i;(i=this.instance)===null||i===void 0||i._addCaptureHook(function(r,s){n.on(r,s)})}}},{key:"register",value:function(e){var n,i,r=this;if(!Me((n=this.instance)===null||n===void 0?void 0:n._addCaptureHook)&&(e.forEach(function(a){var l,u;(l=r.actionRegistry)===null||l===void 0||l.add(a),(u=a.steps)===null||u===void 0||u.forEach(function(c){var d;(d=r.actionEvents)===null||d===void 0||d.add((c==null?void 0:c.event)||"")})}),(i=this.instance)!==null&&i!==void 0&&i.autocapture)){var s,o=new Set;e.forEach(function(a){var l;(l=a.steps)===null||l===void 0||l.forEach(function(u){u!=null&&u.selector&&o.add(u==null?void 0:u.selector)})}),(s=this.instance)===null||s===void 0||s.autocapture.setElementSelectors(o)}}},{key:"on",value:function(e,n){var i,r=this;n!=null&&e.length!=0&&(this.actionEvents.has(e)||this.actionEvents.has(n==null?void 0:n.event))&&this.actionRegistry&&((i=this.actionRegistry)===null||i===void 0?void 0:i.size)>0&&this.actionRegistry.forEach(function(s){r.checkAction(n,s)&&r._debugEventEmitter.emit("actionCaptured",s.name)})}},{key:"_addActionHook",value:function(e){this.onAction("actionCaptured",function(n){return e(n)})}},{key:"checkAction",value:function(e,n){if((n==null?void 0:n.steps)==null)return!1;var i,r=Ar(n.steps);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(this.checkStep(e,s))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"onAction",value:function(e,n){return this._debugEventEmitter.on(e,n)}},{key:"checkStepUrl",value:function(e,n){if(n!=null&&n.url){var i,r=e==null||(i=e.properties)===null||i===void 0?void 0:i.$current_url;if(!r||typeof r!="string"||!t.matchString(r,n==null?void 0:n.url,(n==null?void 0:n.url_matching)||"contains"))return!1}return!0}},{key:"checkStepElement",value:function(e,n){if((n!=null&&n.href||n!=null&&n.tag_name||n!=null&&n.text)&&!this.getElementsList(e).some(function(s){return!(n!=null&&n.href&&!t.matchString(s.href||"",n==null?void 0:n.href,(n==null?void 0:n.href_matching)||"exact"))&&(n==null||!n.tag_name||s.tag_name===(n==null?void 0:n.tag_name))&&!(n!=null&&n.text&&!t.matchString(s.text||"",n==null?void 0:n.text,(n==null?void 0:n.text_matching)||"exact")&&!t.matchString(s.$el_text||"",n==null?void 0:n.text,(n==null?void 0:n.text_matching)||"exact"))}))return!1;if(n!=null&&n.selector){var i,r=e==null||(i=e.properties)===null||i===void 0?void 0:i.$element_selectors;if(!r||!r.includes(n==null?void 0:n.selector))return!1}return!0}},{key:"getElementsList",value:function(e){return(e==null?void 0:e.properties.$elements)==null?[]:e==null?void 0:e.properties.$elements}}],[{key:"matchString",value:function(e,n,i){switch(i){case"regex":return!!V&&xg(e,n);case"exact":return n===e;case"contains":var r=t.escapeStringRegexp(n).replace(/_/g,".").replace(/%/g,".*");return xg(e,r);default:return!1}}},{key:"escapeStringRegexp",value:function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}}]),t}(),Db=function(){function t(e){at(this,t),this.instance=e,this.eventToSurveys=new Map,this.actionToSurveys=new Map}return lt(t,[{key:"register",value:function(e){var n;Me((n=this.instance)===null||n===void 0?void 0:n._addCaptureHook)||(this.setupEventBasedSurveys(e),this.setupActionBasedSurveys(e))}},{key:"setupActionBasedSurveys",value:function(e){var n=this,i=e.filter(function(r){var s,o,a,l;return((s=r.conditions)===null||s===void 0?void 0:s.actions)&&((o=r.conditions)===null||o===void 0||(a=o.actions)===null||a===void 0||(l=a.values)===null||l===void 0?void 0:l.length)>0});i.length!==0&&(this.actionMatcher==null&&(this.actionMatcher=new D5(this.instance),this.actionMatcher.init(),this.actionMatcher._addActionHook(function(r){n.onAction(r)})),i.forEach(function(r){var s,o,a,l,u,c,d,h,f,p;r.conditions&&(s=r.conditions)!==null&&s!==void 0&&s.actions&&(o=r.conditions)!==null&&o!==void 0&&(a=o.actions)!==null&&a!==void 0&&a.values&&((l=r.conditions)===null||l===void 0||(u=l.actions)===null||u===void 0||(c=u.values)===null||c===void 0?void 0:c.length)>0&&((d=n.actionMatcher)===null||d===void 0||d.register(r.conditions.actions.values),(h=r.conditions)===null||h===void 0||(f=h.actions)===null||f===void 0||(p=f.values)===null||p===void 0||p.forEach(function(m){if(m&&m.name){var w=n.actionToSurveys.get(m.name);w&&w.push(r.id),n.actionToSurveys.set(m.name,w||[r.id])}}))}))}},{key:"setupEventBasedSurveys",value:function(e){var n,i=this;e.filter(function(r){var s,o,a,l;return((s=r.conditions)===null||s===void 0?void 0:s.events)&&((o=r.conditions)===null||o===void 0||(a=o.events)===null||a===void 0||(l=a.values)===null||l===void 0?void 0:l.length)>0}).length!==0&&((n=this.instance)===null||n===void 0||n._addCaptureHook(function(r){i.onEvent(r)}),e.forEach(function(r){var s,o,a;(s=r.conditions)===null||s===void 0||(o=s.events)===null||o===void 0||(a=o.values)===null||a===void 0||a.forEach(function(l){if(l&&l.name){var u=i.eventToSurveys.get(l.name);u&&u.push(r.id),i.eventToSurveys.set(l.name,u||[r.id])}})}))}},{key:"onEvent",value:function(e,n){var i,r,s=((i=this.instance)===null||i===void 0||(r=i.persistence)===null||r===void 0?void 0:r.props[yp])||[];if(t.SURVEY_SHOWN_EVENT_NAME==e&&n&&s.length>0){var o,a=n==null||(o=n.properties)===null||o===void 0?void 0:o.$survey_id;if(a){var l=s.indexOf(a);l>=0&&(s.splice(l,1),this._updateActivatedSurveys(s))}}else this.eventToSurveys.has(e)&&this._updateActivatedSurveys(s.concat(this.eventToSurveys.get(e)||[]))}},{key:"onAction",value:function(e){var n,i,r=((n=this.instance)===null||n===void 0||(i=n.persistence)===null||i===void 0?void 0:i.props[yp])||[];this.actionToSurveys.has(e)&&this._updateActivatedSurveys(r.concat(this.actionToSurveys.get(e)||[]))}},{key:"_updateActivatedSurveys",value:function(e){var n,i;(n=this.instance)===null||n===void 0||(i=n.persistence)===null||i===void 0||i.register(X({},yp,wo(new Set(e))))}},{key:"getSurveys",value:function(){var e,n,i=(e=this.instance)===null||e===void 0||(n=e.persistence)===null||n===void 0?void 0:n.props[yp];return i||[]}},{key:"getEventToSurveys",value:function(){return this.eventToSurveys}},{key:"_getActionMatcher",value:function(){return this.actionMatcher}}]),t}();X(Db,"SURVEY_SHOWN_EVENT_NAME","survey shown");var b0="[Surveys]",I5={icontains:function(t){return!!V&&V.location.href.toLowerCase().indexOf(t.toLowerCase())>-1},not_icontains:function(t){return!!V&&V.location.href.toLowerCase().indexOf(t.toLowerCase())===-1},regex:function(t){return!!V&&xg(V.location.href,t)},not_regex:function(t){return!!V&&!xg(V.location.href,t)},exact:function(t){return(V==null?void 0:V.location.href)===t},is_not:function(t){return(V==null?void 0:V.location.href)!==t}},L5=function(){function t(e){at(this,t),this.instance=e,this._surveyEventReceiver=null}return lt(t,[{key:"afterDecideResponse",value:function(e){this._decideServerResponse=!!e.surveys,this.loadIfEnabled()}},{key:"loadIfEnabled",value:function(){var e=this,n=Vt==null?void 0:Vt.extendPostHogWithSurveys;this.instance.config.disable_surveys||!this._decideServerResponse||n||(this._surveyEventReceiver==null&&(this._surveyEventReceiver=new Db(this.instance)),this.instance.requestRouter.loadScript("/static/surveys.js",function(i){if(i)return re.error(b0,"Could not load surveys script",i);Vt.extendPostHogWithSurveys(e.instance)}))}},{key:"getSurveys",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(this.instance.config.disable_surveys)return e([]);this._surveyEventReceiver==null&&(this._surveyEventReceiver=new Db(this.instance));var r=this.instance.get_property(gb);if(r&&!i)return e(r);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/surveys/?token=".concat(this.instance.config.token)),method:"GET",transport:"XHR",callback:function(s){var o;if(s.statusCode!==200||!s.json)return e([]);var a,l=s.json.surveys||[],u=l.filter(function(c){var d,h,f,p,m,w,v,y,b,k,_,E;return((d=c.conditions)===null||d===void 0?void 0:d.events)&&((h=c.conditions)===null||h===void 0||(f=h.events)===null||f===void 0?void 0:f.values)&&((p=c.conditions)===null||p===void 0||(m=p.events)===null||m===void 0||(w=m.values)===null||w===void 0?void 0:w.length)>0||((v=c.conditions)===null||v===void 0?void 0:v.actions)&&((y=c.conditions)===null||y===void 0||(b=y.actions)===null||b===void 0?void 0:b.values)&&((k=c.conditions)===null||k===void 0||(_=k.actions)===null||_===void 0||(E=_.values)===null||E===void 0?void 0:E.length)>0});return u.length>0&&((a=n._surveyEventReceiver)===null||a===void 0||a.register(u)),(o=n.instance.persistence)===null||o===void 0||o.register(X({},gb,l)),e(l)}})}},{key:"getActiveMatchingSurveys",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.getSurveys(function(r){var s,o=r.filter(function(u){return!(!u.start_date||u.end_date)}).filter(function(u){var c,d,h,f;if(!u.conditions)return!0;var p=(c=u.conditions)===null||c===void 0||!c.url||I5[(d=(h=u.conditions)===null||h===void 0?void 0:h.urlMatchType)!==null&&d!==void 0?d:"icontains"](u.conditions.url),m=(f=u.conditions)===null||f===void 0||!f.selector||(Ee==null?void 0:Ee.querySelector(u.conditions.selector));return p&&m}),a=(s=n._surveyEventReceiver)===null||s===void 0?void 0:s.getSurveys(),l=o.filter(function(u){var c,d,h,f,p,m,w,v,y,b;if(!u.linked_flag_key&&!u.targeting_flag_key&&!u.internal_targeting_flag_key)return!0;var k=!u.linked_flag_key||n.instance.featureFlags.isFeatureEnabled(u.linked_flag_key),_=!u.targeting_flag_key||n.instance.featureFlags.isFeatureEnabled(u.targeting_flag_key),E=((c=u.conditions)===null||c===void 0?void 0:c.events)&&((d=u.conditions)===null||d===void 0||(h=d.events)===null||h===void 0?void 0:h.values)&&((f=u.conditions)===null||f===void 0||(p=f.events)===null||p===void 0?void 0:p.values.length)>0,A=((m=u.conditions)===null||m===void 0?void 0:m.actions)&&((w=u.conditions)===null||w===void 0||(v=w.actions)===null||v===void 0?void 0:v.values)&&((y=u.conditions)===null||y===void 0||(b=y.actions)===null||b===void 0?void 0:b.values.length)>0,P=!E&&!A||(a==null?void 0:a.includes(u.id)),D=n._canActivateRepeatedly(u),L=!(u.internal_targeting_flag_key&&!D)||n.instance.featureFlags.isFeatureEnabled(u.internal_targeting_flag_key);return k&&_&&L&&P});return e(l)},i)}},{key:"getNextSurveyStep",value:function(e,n,i){var r,s=e.questions[n],o=n+1;if((r=s.branching)===null||r===void 0||!r.type)return n===e.questions.length-1?Dr.End:o;if(s.branching.type===Dr.End)return Dr.End;if(s.branching.type===Dr.SpecificQuestion){if(Number.isInteger(s.branching.index))return s.branching.index}else if(s.branching.type===Dr.ResponseBased){if(s.type===Pg.SingleChoice){var a,l,u=s.choices.indexOf("".concat(i));if((a=s.branching)!==null&&a!==void 0&&(l=a.responseValues)!==null&&l!==void 0&&l.hasOwnProperty(u)){var c=s.branching.responseValues[u];return Number.isInteger(c)?c:c===Dr.End?Dr.End:o}}else if(s.type===Pg.Rating){var d,h;if(typeof i!="number"||!Number.isInteger(i))throw new Error("The response type must be an integer");var f=function(m,w){if(w===3){if(m<1||m>3)throw new Error("The response must be in range 1-3");return m===1?"negative":m===2?"neutral":"positive"}if(w===5){if(m<1||m>5)throw new Error("The response must be in range 1-5");return m<=2?"negative":m===3?"neutral":"positive"}if(w===10){if(m<0||m>10)throw new Error("The response must be in range 0-10");return m<=6?"detractors":m<=8?"passives":"promoters"}throw new Error("The scale must be one of: 3, 5, 10")}(i,s.scale);if((d=s.branching)!==null&&d!==void 0&&(h=d.responseValues)!==null&&h!==void 0&&h.hasOwnProperty(f)){var p=s.branching.responseValues[f];return Number.isInteger(p)?p:p===Dr.End?Dr.End:o}}return o}return re.warn(b0,"Falling back to next question index due to unexpected branching type"),o}},{key:"_canActivateRepeatedly",value:function(e){return yr(Vt.__PosthogExtensions__.canActivateRepeatedly)&&re.warn(b0,"canActivateRepeatedly is not defined, must init before calling"),Vt.__PosthogExtensions__.canActivateRepeatedly(e)}}]),t}(),j5=function(){function t(e){var n,i,r=this;at(this,t),X(this,"serverLimits",{}),X(this,"lastEventRateLimited",!1),X(this,"checkForLimiting",function(s){var o=s.text;if(o&&o.length)try{(JSON.parse(o).quota_limited||[]).forEach(function(a){re.info("[RateLimiter] ".concat(a||"events"," is quota limited.")),r.serverLimits[a]=new Date().getTime()+6e4})}catch(a){return void re.warn('[RateLimiter] could not rate limit - continuing. Error: "'.concat(a==null?void 0:a.message,'"'),{text:o})}}),this.instance=e,this.captureEventsPerSecond=((n=e.config.rate_limiting)===null||n===void 0?void 0:n.events_per_second)||10,this.captureEventsBurstLimit=Math.max(((i=e.config.rate_limiting)===null||i===void 0?void 0:i.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}return lt(t,[{key:"clientRateLimitContext",value:function(){var e,n,i,r=arguments.length>0&&arguments[0]!==void 0&&arguments[0],s=new Date().getTime(),o=(e=(n=this.instance.persistence)===null||n===void 0?void 0:n.get_property(yb))!==null&&e!==void 0?e:{tokens:this.captureEventsBurstLimit,last:s};o.tokens+=(s-o.last)/1e3*this.captureEventsPerSecond,o.last=s,o.tokens>this.captureEventsBurstLimit&&(o.tokens=this.captureEventsBurstLimit);var a=o.tokens<1;return a||r||(o.tokens=Math.max(0,o.tokens-1)),!a||this.lastEventRateLimited||r||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to ".concat(this.captureEventsPerSecond," events per second and ").concat(this.captureEventsBurstLimit," events burst limit.")},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=a,(i=this.instance.persistence)===null||i===void 0||i.set_property(yb,o),{isRateLimited:a,remainingTokens:o.tokens}}},{key:"isServerRateLimited",value:function(e){var n=this.serverLimits[e||"events"]||!1;return n!==!1&&new Date().getTime()<n}}]),t}(),F5=function(){return ke({initialPathName:(vi==null?void 0:vi.pathname)||"",referringDomain:hn.referringDomain()},hn.campaignParams())},B5=function(){function t(e,n,i){var r=this;at(this,t),X(this,"_onSessionIdCallback",function(s){var o=r._getStoredProps();if(!o||o.sessionId!==s){var a={sessionId:s,props:r._sessionSourceParamGenerator()};r._persistence.register(X({},vb,a))}}),this._sessionIdManager=e,this._persistence=n,this._sessionSourceParamGenerator=i||F5,this._sessionIdManager.onSessionId(this._onSessionIdCallback)}return lt(t,[{key:"_getStoredProps",value:function(){return this._persistence.props[vb]}},{key:"getSessionProps",value:function(){var e,n=(e=this._getStoredProps())===null||e===void 0?void 0:e.props;return n?{$client_session_initial_referring_host:n.referringDomain,$client_session_initial_pathname:n.initialPathName,$client_session_initial_utm_source:n.utm_source,$client_session_initial_utm_campaign:n.utm_campaign,$client_session_initial_utm_medium:n.utm_medium,$client_session_initial_utm_content:n.utm_content,$client_session_initial_utm_term:n.utm_term}:{}}}]),t}(),$5=["ahrefsbot","ahrefssiteaudit","applebot","baiduspider","bingbot","bingpreview","bot.htm","bot.php","crawler","deepscan","duckduckbot","facebookexternal","facebookcatalog","gptbot","http://yandex.com/bots","hubspot","ia_archiver","linkedinbot","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","semrushbot","sitebulb","slurp","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","Google-HotelAdsVerifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleweblight","mediapartners-google","storebot-google","Bytespider;"],wE=function(t,e){if(!t)return!1;var n=t.toLowerCase();return $5.concat(e||[]).some(function(i){var r=i.toLowerCase();return n.indexOf(r)!==-1})},dM=function(){function t(){at(this,t),this.clicks=[]}return lt(t,[{key:"isRageClick",value:function(e,n,i){var r=this.clicks[this.clicks.length-1];if(r&&Math.abs(e-r.x)+Math.abs(n-r.y)<30&&i-r.timestamp<1e3){if(this.clicks.push({x:e,y:n,timestamp:i}),this.clicks.length===3)return!0}else this.clicks=[{x:e,y:n,timestamp:i}];return!1}}]),t}();function bE(t){var e;return t.id===xb||!((e=t.closest)===null||e===void 0||!e.call(t,"#"+xb))}var z5=function(){function t(e){var n,i=this;at(this,t),X(this,"rageclicks",new dM),X(this,"_enabledServerSide",!1),X(this,"_initialized",!1),X(this,"_flushInterval",null),this.instance=e,this._enabledServerSide=!((n=this.instance.persistence)===null||n===void 0||!n.props[fb]),V==null||V.addEventListener("beforeunload",function(){i.flush()})}return lt(t,[{key:"flushIntervalMilliseconds",get:function(){var e=5e3;return En(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}},{key:"isEnabled",get:function(){return Me(this.instance.config.capture_heatmaps)?Me(this.instance.config.enable_heatmaps)?this._enabledServerSide:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}},{key:"startIfEnabled",value:function(){if(this.isEnabled){if(this._initialized)return;re.info("[heatmaps] starting..."),this._setupListeners(),this._flushInterval=setInterval(this.flush.bind(this),this.flushIntervalMilliseconds)}else{var e;clearInterval((e=this._flushInterval)!==null&&e!==void 0?e:void 0),this.getAndClearBuffer()}}},{key:"afterDecideResponse",value:function(e){var n=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register(X({},fb,n)),this._enabledServerSide=n,this.startIfEnabled()}},{key:"getAndClearBuffer",value:function(){var e=this.buffer;return this.buffer=void 0,e}},{key:"_setupListeners",value:function(){var e=this;V&&Ee&&(mo(Ee,"click",function(n){return e._onClick(n||(V==null?void 0:V.event))},!1,!0),mo(Ee,"mousemove",function(n){return e._onMouseMove(n||(V==null?void 0:V.event))},!1,!0),this._initialized=!0)}},{key:"_getProperties",value:function(e,n){var i=this.instance.scrollManager.scrollY(),r=this.instance.scrollManager.scrollX(),s=this.instance.scrollManager.scrollElement(),o=function(a,l,u){for(var c=a;c&&!_a(c,"body");){if(c===u)return!1;if(Ye(l,V==null?void 0:V.getComputedStyle(c).position))return!0;c=ZN(c)}return!1}(e.target,["fixed","sticky"],s);return{x:e.clientX+(o?0:r),y:e.clientY+(o?0:i),target_fixed:o,type:n}}},{key:"_onClick",value:function(e){var n;if(!bE(e.target)){var i=this._getProperties(e,"click");(n=this.rageclicks)!==null&&n!==void 0&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this._capture(ke(ke({},i),{},{type:"rageclick"})),this._capture(i)}}},{key:"_onMouseMove",value:function(e){var n=this;bE(e.target)||(clearTimeout(this._mouseMoveTimeout),this._mouseMoveTimeout=setTimeout(function(){n._capture(n._getProperties(e,"mousemove"))},500))}},{key:"_capture",value:function(e){if(V){var n=V.location.href;this.buffer=this.buffer||{},this.buffer[n]||(this.buffer[n]=[]),this.buffer[n].push(e)}}},{key:"flush",value:function(){this.buffer&&!Im(this.buffer)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}]),t}(),U5=function(){function t(e){var n=this;at(this,t),X(this,"_updateScrollData",function(){var i,r,s,o;n.context||(n.context={});var a=n.scrollElement(),l=n.scrollY(),u=a?Math.max(0,a.scrollHeight-a.clientHeight):0,c=l+((a==null?void 0:a.clientHeight)||0),d=(a==null?void 0:a.scrollHeight)||0;n.context.lastScrollY=Math.ceil(l),n.context.maxScrollY=Math.max(l,(i=n.context.maxScrollY)!==null&&i!==void 0?i:0),n.context.maxScrollHeight=Math.max(u,(r=n.context.maxScrollHeight)!==null&&r!==void 0?r:0),n.context.lastContentY=c,n.context.maxContentY=Math.max(c,(s=n.context.maxContentY)!==null&&s!==void 0?s:0),n.context.maxContentHeight=Math.max(d,(o=n.context.maxContentHeight)!==null&&o!==void 0?o:0)}),this.instance=e}return lt(t,[{key:"getContext",value:function(){return this.context}},{key:"resetContext",value:function(){var e=this.context;return setTimeout(this._updateScrollData,0),e}},{key:"startMeasuringScrollPosition",value:function(){V==null||V.addEventListener("scroll",this._updateScrollData,!0),V==null||V.addEventListener("scrollend",this._updateScrollData,!0),V==null||V.addEventListener("resize",this._updateScrollData)}},{key:"scrollElement",value:function(){if(!this.instance.config.scroll_root_selector)return V==null?void 0:V.document.documentElement;var e,n=Ar(an(this.instance.config.scroll_root_selector)?this.instance.config.scroll_root_selector:[this.instance.config.scroll_root_selector]);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=V==null?void 0:V.document.querySelector(i);if(r)return r}}catch(s){n.e(s)}finally{n.f()}}},{key:"scrollY",value:function(){if(this.instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return V&&(V.scrollY||V.pageYOffset||V.document.documentElement.scrollTop)||0}},{key:"scrollX",value:function(){if(this.instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return V&&(V.scrollX||V.pageXOffset||V.document.documentElement.scrollLeft)||0}}]),t}(),x0="$copy_autocapture";function S0(t,e){return e.length>t?e.slice(0,t)+"...":e}var qo,V5=function(){function t(e){at(this,t),X(this,"_initialized",!1),X(this,"_isDisabledServerSide",null),X(this,"rageclicks",new dM),X(this,"_elementsChainAsString",!1),this.instance=e,this._elementSelectors=null}return lt(t,[{key:"config",get:function(){var e,n,i=En(this.instance.config.autocapture)?this.instance.config.autocapture:{};return i.url_allowlist=(e=i.url_allowlist)===null||e===void 0?void 0:e.map(function(r){return new RegExp(r)}),i.url_ignorelist=(n=i.url_ignorelist)===null||n===void 0?void 0:n.map(function(r){return new RegExp(r)}),i}},{key:"_addDomEventHandlers",value:function(){var e=this;if(this.isBrowserSupported()){if(V&&Ee){var n=function(r){r=r||(V==null?void 0:V.event);try{e._captureEvent(r)}catch(s){re.error("Failed to capture event",s)}},i=function(r){r=r||(V==null?void 0:V.event),e._captureEvent(r,x0)};mo(Ee,"submit",n,!1,!0),mo(Ee,"change",n,!1,!0),mo(Ee,"click",n,!1,!0),this.config.capture_copied_text&&(mo(Ee,"copy",i,!1,!0),mo(Ee,"cut",i,!1,!0))}}else re.info("Disabling Automatic Event Collection because this browser is not supported")}},{key:"startIfEnabled",value:function(){this.isEnabled&&!this._initialized&&(this._addDomEventHandlers(),this._initialized=!0)}},{key:"afterDecideResponse",value:function(e){e.elementsChainAsString&&(this._elementsChainAsString=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register(X({},$C,!!e.autocapture_opt_out)),this._isDisabledServerSide=!!e.autocapture_opt_out,this.startIfEnabled()}},{key:"setElementSelectors",value:function(e){this._elementSelectors=e}},{key:"getElementSelectors",value:function(e){var n,i=[];return(n=this._elementSelectors)===null||n===void 0||n.forEach(function(r){var s=Ee==null?void 0:Ee.querySelectorAll(r);s==null||s.forEach(function(o){e===o&&i.push(r)})}),i}},{key:"isEnabled",get:function(){var e,n,i=(e=this.instance.persistence)===null||e===void 0?void 0:e.props[$C],r=this._isDisabledServerSide;if(Io(r)&&!Tu(i)&&!this.instance.config.advanced_disable_decide)return!1;var s=(n=this._isDisabledServerSide)!==null&&n!==void 0?n:!!i;return!!this.instance.config.autocapture&&!s}},{key:"_previousElementSibling",value:function(e){if(e.previousElementSibling)return e.previousElementSibling;var n=e;do n=n.previousSibling;while(n&&!wS(n));return n}},{key:"_getAugmentPropertiesFromElement",value:function(e){if(!Pb(e))return{};var n={};return wt(e.attributes,function(i){if(i.name&&i.name.indexOf("data-ph-capture-attribute")===0){var r=i.name.replace("data-ph-capture-attribute-",""),s=i.value;r&&s&&Zu(s)&&(n[r]=s)}}),n}},{key:"_getPropertiesFromElement",value:function(e,n,i){var r,s=e.tagName.toLowerCase(),o={tag_name:s};Ab.indexOf(s)>-1&&!i&&(s.toLowerCase()==="a"||s.toLowerCase()==="button"?o.$el_text=S0(1024,oE(e)):o.$el_text=S0(1024,Cg(e)));var a=_g(e);a.length>0&&(o.classes=a.filter(function(h){return h!==""}));var l=(r=this.config)===null||r===void 0?void 0:r.element_attribute_ignorelist;wt(e.attributes,function(h){var f;if((!QN(e)||["name","id","class","aria-label"].indexOf(h.name)!==-1)&&(l==null||!l.includes(h.name))&&!n&&Zu(h.value)&&(f=h.name,!Un(f)||f.substring(0,10)!=="_ngcontent"&&f.substring(0,7)!=="_nghost")){var p=h.value;h.name==="class"&&(p=yS(p).join(" ")),o["attr__"+h.name]=S0(1024,p)}});for(var u=1,c=1,d=e;d=this._previousElementSibling(d);)u++,d.tagName===e.tagName&&c++;return o.nth_child=u,o.nth_of_type=c,o}},{key:"_getDefaultProperties",value:function(e){return{$event_type:e,$ce_version:1}}},{key:"_getEventTarget",value:function(e){return Me(e.target)?e.srcElement||null:(n=e.target)!==null&&n!==void 0&&n.shadowRoot?e.composedPath()[0]||null:e.target||null;var n}},{key:"_captureEvent",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"$autocapture";if(this.isEnabled){var r,s=this._getEventTarget(e);YN(s)&&(s=s.parentNode||null),i==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(r=this.rageclicks)!==null&&r!==void 0&&r.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this._captureEvent(e,"$rageclick");var o=i===x0;if(s&&J4(s,e,this.config,o,o?["copy","cut"]:void 0)){for(var a,l,u=[s],c=s;c.parentNode&&!_a(c,"body");)JN(c.parentNode)?(u.push(c.parentNode.host),c=c.parentNode.host):(u.push(c.parentNode),c=c.parentNode);var d,h,f=[],p={},m=!1;if(wt(u,function(D){var L=Pb(D);D.tagName.toLowerCase()==="a"&&(d=D.getAttribute("href"),d=L&&Zu(d)&&d),Ye(_g(D),"ph-no-capture")&&(m=!0),f.push(n._getPropertiesFromElement(D,n.instance.config.mask_all_element_attributes,n.instance.config.mask_all_text));var B=n._getAugmentPropertiesFromElement(D);Qn(p,B)}),this.instance.config.mask_all_text||(s.tagName.toLowerCase()==="a"||s.tagName.toLowerCase()==="button"?f[0].$el_text=oE(s):f[0].$el_text=Cg(s)),d){var w,v;f[0].attr__href=d;var y=(w=ih(d))===null||w===void 0?void 0:w.host,b=V==null||(v=V.location)===null||v===void 0?void 0:v.host;y&&b&&y!==b&&(h=d)}if(m)return!1;var k=Qn(this._getDefaultProperties(e.type),this._elementsChainAsString?{$elements_chain:n5(f)}:{$elements:f},(a=f[0])!==null&&a!==void 0&&a.$el_text?{$el_text:(l=f[0])===null||l===void 0?void 0:l.$el_text}:{},h&&e.type==="click"?{$external_click_url:h}:{},p),_=this.getElementSelectors(s);if(_&&_.length>0&&(k.$element_selectors=_),i===x0){var E,A=qN(V==null||(E=V.getSelection())===null||E===void 0?void 0:E.toString()),P=e.type||"clipboard";if(!A)return!1;k.$selected_content=A,k.$copy_type=P}return this.instance.capture(i,k),!0}}}},{key:"isBrowserSupported",value:function(){return Yr(Ee==null?void 0:Ee.querySelectorAll)}}]),t}(),H5=function(){function t(e){var n=this;at(this,t),X(this,"_restoreXHRPatch",void 0),X(this,"_restoreFetchPatch",void 0),X(this,"_startCapturing",function(){Me(n._restoreXHRPatch)&&Vt.postHogTracingHeadersPatchFns._patchXHR(n.instance.sessionManager),Me(n._restoreFetchPatch)&&Vt.postHogTracingHeadersPatchFns._patchFetch(n.instance.sessionManager)}),this.instance=e}return lt(t,[{key:"_loadScript",value:function(e){Vt.postHogTracingHeadersPatchFns&&e(),this.instance.requestRouter.loadScript("/static/tracing-headers.js?v=".concat(Vr.LIB_VERSION),function(n){if(n)return re.error("[TRACING-HEADERS] failed to load script",n);e()})}},{key:"startIfEnabledOrStop",value:function(){var e,n;this.instance.config.__add_tracing_headers?this._loadScript(this._startCapturing):((e=this._restoreXHRPatch)===null||e===void 0||e.call(this),(n=this._restoreFetchPatch)===null||n===void 0||n.call(this),this._restoreXHRPatch=void 0,this._restoreFetchPatch=void 0)}}]),t}();(function(t){t[t.PENDING=-1]="PENDING",t[t.DENIED=0]="DENIED",t[t.GRANTED=1]="GRANTED"})(qo||(qo={}));var W5=function(){function t(e){at(this,t),this.instance=e}return lt(t,[{key:"config",get:function(){return this.instance.config}},{key:"consent",get:function(){return this.getDnt()?qo.DENIED:this.storedConsent}},{key:"isOptedOut",value:function(){return this.consent===qo.DENIED||this.consent===qo.PENDING&&this.config.opt_out_capturing_by_default}},{key:"isOptedIn",value:function(){return!this.isOptedOut()}},{key:"optInOut",value:function(e){this.storage.set(this.storageKey,e?1:0,this.config.cookie_expiration,this.config.cross_subdomain_cookie,this.config.secure_cookie)}},{key:"reset",value:function(){this.storage.remove(this.storageKey,this.config.cross_subdomain_cookie)}},{key:"storageKey",get:function(){var e=this.instance.config,n=e.token;return(e.opt_out_capturing_cookie_prefix||"__ph_opt_in_out_")+n}},{key:"storedConsent",get:function(){var e=this.storage.get(this.storageKey);return e==="1"?qo.GRANTED:e==="0"?qo.DENIED:qo.PENDING}},{key:"storage",get:function(){if(!this._storage){var e=this.config.opt_out_capturing_persistence_type;this._storage=e==="localStorage"?nn:bo;var n=e==="localStorage"?bo:nn;n.get(this.storageKey)&&(this._storage.get(this.storageKey)||this.optInOut(n.get(this.storageKey)==="1"),n.remove(this.storageKey,this.config.cross_subdomain_cookie))}return this._storage}},{key:"getDnt",value:function(){return!!this.config.respect_dnt&&!!NN([go==null?void 0:go.doNotTrack,go==null?void 0:go.msDoNotTrack,Vt.doNotTrack],function(e){return Ye([!0,1,"1","yes"],e)})}}]),t}(),xE=9e5,ml="[Web Vitals]",G5=function(){function t(e){var n,i=this;at(this,t),X(this,"_enabledServerSide",!1),X(this,"_initialized",!1),X(this,"buffer",{url:void 0,metrics:[],firstMetricTimestamp:void 0}),X(this,"_flushToCapture",function(){clearTimeout(i._delayedFlushTimer),i.buffer.metrics.length!==0&&(i.instance.capture("$web_vitals",i.buffer.metrics.reduce(function(r,s){var o;return ke(ke({},r),{},(X(o={},"$web_vitals_".concat(s.name,"_event"),ke({},s)),X(o,"$web_vitals_".concat(s.name,"_value"),s.value),o))},{})),i.buffer={url:void 0,metrics:[],firstMetricTimestamp:void 0})}),X(this,"_addToBuffer",function(r){var s,o=(s=i.instance.sessionManager)===null||s===void 0?void 0:s.checkAndGetSessionAndWindowId(!0);if(Me(o))re.error(ml+"Could not read session ID. Dropping metrics!");else{i.buffer=i.buffer||{};var a=i._currentURL();Me(a)||(yr(r==null?void 0:r.name)||yr(r==null?void 0:r.value)?re.error(ml+"Invalid metric received",r):i._maxAllowedValue&&r.value>=i._maxAllowedValue?re.error(ml+"Ignoring metric with value >= "+i._maxAllowedValue,r):(i.buffer.url!==a&&(i._flushToCapture(),i._delayedFlushTimer=setTimeout(i._flushToCapture,8e3)),Me(i.buffer.url)&&(i.buffer.url=a),i.buffer.firstMetricTimestamp=Me(i.buffer.firstMetricTimestamp)?Date.now():i.buffer.firstMetricTimestamp,i.buffer.metrics.push(ke(ke({},r),{},{$current_url:a,$session_id:o.sessionId,$window_id:o.windowId,timestamp:Date.now()})),i.buffer.metrics.length===4&&i._flushToCapture()))}}),X(this,"_startCapturing",function(){var r=Vt.postHogWebVitalsCallbacks,s=r.onLCP,o=r.onCLS,a=r.onFCP,l=r.onINP;s&&o&&a&&l?(s(i._addToBuffer),o(i._addToBuffer),a(i._addToBuffer),l(i._addToBuffer),i._initialized=!0):re.error(ml+"web vitals callbacks not loaded - not starting")}),this.instance=e,this._enabledServerSide=!((n=this.instance.persistence)===null||n===void 0||!n.props[VC]),this.startIfEnabled()}return lt(t,[{key:"_maxAllowedValue",get:function(){var e=En(this.instance.config.capture_performance)&&ur(this.instance.config.capture_performance.__web_vitals_max_value)?this.instance.config.capture_performance.__web_vitals_max_value:xE;return 0<e&&e<=6e4?xE:e}},{key:"isEnabled",get:function(){var e=En(this.instance.config.capture_performance)?this.instance.config.capture_performance.web_vitals:void 0;return Tu(e)?e:this._enabledServerSide}},{key:"startIfEnabled",value:function(){this.isEnabled&&!this._initialized&&(re.info(ml+" enabled, starting..."),this.loadScript(this._startCapturing))}},{key:"afterDecideResponse",value:function(e){var n=En(e.capturePerformance)&&!!e.capturePerformance.web_vitals;this.instance.persistence&&this.instance.persistence.register(X({},VC,n)),this._enabledServerSide=n,this.startIfEnabled()}},{key:"loadScript",value:function(e){V.postHogWebVitalsCallbacks&&e(),this.instance.requestRouter.loadScript(this.instance.requestRouter.endpointFor("assets","/static/web-vitals.js?v=".concat(Vr.LIB_VERSION)),function(n){n?re.error(ml+" failed to load script",n):e()})}},{key:"_currentURL",value:function(){var e=V?V.location.href:void 0;return e||re.error(ml+"Could not determine current URL"),e}}]),t}(),oh={},SE=function(){},Su="posthog",hM=!_5&&(Ht==null?void 0:Ht.indexOf("MSIE"))===-1&&(Ht==null?void 0:Ht.indexOf("Mozilla"))===-1,kE=function(){var t,e,n;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:(e=Ee==null?void 0:Ee.location,n=e==null?void 0:e.hostname,!!Un(n)&&n.split(".").slice(-2).join(".")!=="herokuapp.com"),persistence:"localStorage+cookie",persistence_name:"",loaded:SE,store_google:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:!0,capture_pageleave:"if_capture_pageview",debug:vi&&Un(vi==null?void 0:vi.search)&&vi.search.indexOf("__posthog_debug=true")!==-1||!1,verbose:!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_surveys:!1,enable_recording_console_log:void 0,secure_cookie:(V==null||(t=V.location)===null||t===void 0?void 0:t.protocol)==="https:",ip:!0,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},inapp_protocol:"//",inapp_link_new_window:!1,request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,on_request_error:function(i){var r="Bad HTTP status: "+i.statusCode+" "+i.text;re.error(r)},get_device_id:function(i){return i},_onCapture:SE,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"always",__add_tracing_headers:!1}},_E=function(t){var e={};Me(t.process_person)||(e.person_profiles=t.process_person),Me(t.xhr_headers)||(e.request_headers=t.xhr_headers),Me(t.cookie_name)||(e.persistence_name=t.cookie_name),Me(t.disable_cookie)||(e.disable_persistence=t.disable_cookie);var n=Qn({},e,t);return an(t.property_blacklist)&&(Me(t.property_denylist)?n.property_denylist=t.property_blacklist:an(t.property_denylist)?n.property_denylist=[].concat(wo(t.property_blacklist),wo(t.property_denylist)):re.error("Invalid value for property_denylist config: "+t.property_denylist)),n},K5=function(){function t(){at(this,t),X(this,"__forceAllowLocalhost",!1)}return lt(t,[{key:"_forceAllowLocalhost",get:function(){return this.__forceAllowLocalhost},set:function(e){re.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}]),t}(),fM=function(){function t(){var e=this;at(this,t),X(this,"webPerformance",new K5),X(this,"_internalEventEmitter",new cM),this.config=kE(),this.decideEndpointWasHit=!1,this.SentryIntegration=N5,this.sentryIntegration=function(n){return function(i,r){var s=uM(i,r);return{name:lM,processEvent:function(o){return s(o)}}}(e,n)},this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.featureFlags=new E4(this),this.toolbar=new p5(this),this.scrollManager=new U5(this),this.pageViewManager=new O5(this),this.surveys=new L5(this),this.rateLimiter=new j5(this),this.requestRouter=new T5(this),this.consent=new W5(this),this.people={set:function(n,i,r){var s=Un(n)?X({},n,i):n;e.setPersonProperties(s),r==null||r({})},set_once:function(n,i,r){var s=Un(n)?X({},n,i):n;e.setPersonProperties(void 0,s),r==null||r({})}},this.on("eventCaptured",function(n){return re.info("send",n)})}return lt(t,[{key:"init",value:function(e,n,i){if(i&&i!==Su){var r,s=(r=oh[i])!==null&&r!==void 0?r:new t;return s._init(e,n,i),oh[i]=s,oh[Su][i]=s,s}return this._init(e,n,i)}},{key:"_init",value:function(e){var n,i,r=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;if(Me(e)||DC(e))return re.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return re.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;if(this.__loaded=!0,this.config={},this._triggered_notifs=[],this.set_config(Qn({},kE(),_E(s),{name:o,token:e})),this.config.on_xhr_error&&re.error("[posthog] on_xhr_error is deprecated. Use on_request_error instead"),this.compression=s.disable_compression?void 0:Hr.Base64,this.persistence=new g0(this.config),this.sessionPersistence=this.config.persistence==="sessionStorage"?this.persistence:new g0(ke(ke({},this.config),{},{persistence:"sessionStorage"})),this._requestQueue=new m5(function(w){return r._send_retriable_request(w)}),this._retryQueue=new A5(this),this.__request_queue=[],this.sessionManager=new P5(this.config,this.persistence),this.sessionPropsManager=new B5(this.sessionManager,this.persistence),new H5(this).startIfEnabledOrStop(),this.sessionRecording=new d5(this),this.sessionRecording.startIfEnabledOrStop(),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new V5(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new z5(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new G5(this),this.exceptionObserver=new R5(this),this.exceptionObserver.startIfEnabled(),Vr.DEBUG=Vr.DEBUG||this.config.debug,Vr.DEBUG&&console.log("[PostHog.js] Starting in debug mode",this),this._sync_opt_out_with_persistence(),((n=s.bootstrap)===null||n===void 0?void 0:n.distinctID)!==void 0){var a,l,u=this.config.get_device_id(da()),c=(a=s.bootstrap)!==null&&a!==void 0&&a.isIdentifiedID?u:s.bootstrap.distinctID;this.persistence.set_property(Ys,(l=s.bootstrap)!==null&&l!==void 0&&l.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:s.bootstrap.distinctID,$device_id:c})}if(this._hasBootstrappedFeatureFlags()){var d,h,f=Object.keys(((d=s.bootstrap)===null||d===void 0?void 0:d.featureFlags)||{}).filter(function(w){var v,y;return!((v=s.bootstrap)===null||v===void 0||(y=v.featureFlags)===null||y===void 0||!y[w])}).reduce(function(w,v){var y,b;return w[v]=((y=s.bootstrap)===null||y===void 0||(b=y.featureFlags)===null||b===void 0?void 0:b[v])||!1,w},{}),p=Object.keys(((h=s.bootstrap)===null||h===void 0?void 0:h.featureFlagPayloads)||{}).filter(function(w){return f[w]}).reduce(function(w,v){var y,b,k,_;return(y=s.bootstrap)!==null&&y!==void 0&&(b=y.featureFlagPayloads)!==null&&b!==void 0&&b[v]&&(w[v]=(k=s.bootstrap)===null||k===void 0||(_=k.featureFlagPayloads)===null||_===void 0?void 0:_[v]),w},{});this.featureFlags.receivedFeatureFlags({featureFlags:f,featureFlagPayloads:p})}if(!this.get_distinct_id()){var m=this.config.get_device_id(da());this.register_once({distinct_id:m,$device_id:m},""),this.persistence.set_property(Ys,"anonymous")}return V==null||(i=V.addEventListener)===null||i===void 0||i.call(V,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this)),this.toolbar.maybeLoadToolbar(),s.segment?M5(this,function(){return r._loaded()}):this._loaded(),Yr(this.config._onCapture)&&this.on("eventCaptured",function(w){return r.config._onCapture(w.event,w)}),this}},{key:"_afterDecideResponse",value:function(e){var n,i,r,s,o,a,l;this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=Ye(e.supportedCompression,Hr.GZipJS)?Hr.GZipJS:Ye(e.supportedCompression,Hr.Base64)?Hr.Base64:void 0),(n=e.analytics)!==null&&n!==void 0&&n.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),(i=this.sessionRecording)===null||i===void 0||i.afterDecideResponse(e),(r=this.autocapture)===null||r===void 0||r.afterDecideResponse(e),(s=this.heatmaps)===null||s===void 0||s.afterDecideResponse(e),(o=this.surveys)===null||o===void 0||o.afterDecideResponse(e),(a=this.webVitalsAutocapture)===null||a===void 0||a.afterDecideResponse(e),(l=this.exceptionObserver)===null||l===void 0||l.afterDecideResponse(e)}},{key:"_loaded",value:function(){var e=this,n=this.config.advanced_disable_decide;n||this.featureFlags.setReloadingPaused(!0);try{this.config.loaded(this)}catch(i){re.critical("`loaded` function failed",i)}this._start_queue_if_opted_in(),this.config.capture_pageview&&setTimeout(function(){Ee&&e.capture("$pageview",{title:Ee.title},{send_instantly:!0})},1),n||(new h5(this).call(),this.featureFlags.resetRequestQueue())}},{key:"_start_queue_if_opted_in",value:function(){var e;this.has_opted_out_capturing()||this.config.request_batching&&((e=this._requestQueue)===null||e===void 0||e.enable())}},{key:"_dom_loaded",value:function(){var e=this;this.has_opted_out_capturing()||qu(this.__request_queue,function(n){return e._send_retriable_request(n)}),this.__request_queue=[],this._start_queue_if_opted_in()}},{key:"_handle_unload",value:function(){var e,n;this.config.request_batching?(this._shouldCapturePageleave()&&this.capture("$pageleave"),(e=this._requestQueue)===null||e===void 0||e.unload(),(n=this._retryQueue)===null||n===void 0||n.unload()):this._shouldCapturePageleave()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}},{key:"_send_request",value:function(e){var n=this;this.__loaded&&(hM?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=Ag(e.url,{ip:this.config.ip?1:0}),e.headers=this.config.request_headers,e.compression=e.compression==="best-available"?this.compression:e.compression,function(i){var r,s,o,a=ke({},i);a.timeout=a.timeout||6e4,a.url=Ag(a.url,{_:new Date().getTime().toString(),ver:Vr.LIB_VERSION,compression:a.compression});var l=(r=a.transport)!==null&&r!==void 0?r:"XHR",u=(s=(o=NN(sh,function(c){return c.transport===l}))===null||o===void 0?void 0:o.method)!==null&&s!==void 0?s:sh[0].method;if(!u)throw new Error("No available transport method");u(a)}(ke(ke({},e),{},{callback:function(i){var r,s,o;n.rateLimiter.checkForLimiting(i),i.statusCode>=400&&((s=(o=n.config).on_request_error)===null||s===void 0||s.call(o,i)),(r=e.callback)===null||r===void 0||r.call(e,i)}}))))}},{key:"_send_retriable_request",value:function(e){this._retryQueue?this._retryQueue.retriableRequest(e):this._send_request(e)}},{key:"_execute_array",value:function(e){var n,i=this,r=[],s=[],o=[];qu(e,function(l){l&&(n=l[0],an(n)?o.push(l):Yr(l)?l.call(i):an(l)&&n==="alias"?r.push(l):an(l)&&n.indexOf("capture")!==-1&&Yr(i[n])?o.push(l):s.push(l))});var a=function(l,u){qu(l,function(c){if(an(c[0])){var d=u;wt(c,function(h){d=d[h[0]].apply(d,h.slice(1))})}else this[c[0]].apply(this,c.slice(1))},u)};a(r,this),a(s,this),a(o,this)}},{key:"_hasBootstrappedFeatureFlags",value:function(){var e,n;return((e=this.config.bootstrap)===null||e===void 0?void 0:e.featureFlags)&&Object.keys((n=this.config.bootstrap)===null||n===void 0?void 0:n.featureFlags).length>0||!1}},{key:"push",value:function(e){this._execute_array([e])}},{key:"capture",value:function(e,n,i){var r;if(!(this.__loaded&&this.persistence&&this.sessionPersistence&&this._requestQueue))return re.uninitializedWarning("posthog.capture");if(!this.consent.isOptedOut())if(!Me(e)&&Un(e)){if(!Ht||this.config.opt_out_useragent_filter||!wE(Ht,this.config.custom_blocked_useragents)){var s=i!=null&&i.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(s==null||!s.isRateLimited){this.sessionPersistence.update_search_keyword(),this.config.store_google&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.store_google||this.config.save_referrer)&&this.persistence.set_initial_person_info();var o={uuid:da(),event:e,properties:this._calculate_event_properties(e,n||{})};s&&(o.properties.$lib_rate_limit_remaining_tokens=s.remainingTokens),i!=null&&i.$set&&(o.$set=i==null?void 0:i.$set);var a=this._calculate_set_once_properties(i==null?void 0:i.$set_once);a&&(o.$set_once=a),(o=k4(o,i!=null&&i._noTruncate?null:this.config.properties_string_max_length)).timestamp=(i==null?void 0:i.timestamp)||new Date,Me(i==null?void 0:i.timestamp)||(o.properties.$event_time_override_provided=!0,o.properties.$event_time_override_system_time=new Date);var l=ke(ke({},o.properties.$set),o.$set);Im(l)||this.setPersonPropertiesForFlags(l),this._internalEventEmitter.emit("eventCaptured",o);var u={method:"POST",url:(r=i==null?void 0:i._url)!==null&&r!==void 0?r:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:o,compression:"best-available",batchKey:i==null?void 0:i._batchKey};return!this.config.request_batching||i&&(i==null||!i._batchKey)||i!=null&&i.send_instantly?this._send_retriable_request(u):this._requestQueue.enqueue(u),o}re.critical("This capture call is ignored due to client rate limiting.")}}else re.error("No event name provided to posthog.capture")}},{key:"_addCaptureHook",value:function(e){this.on("eventCaptured",function(n){return e(n.event,n)})}},{key:"_calculate_event_properties",value:function(e,n){if(!this.persistence||!this.sessionPersistence)return n;var i=this.persistence.remove_event_timer(e),r=ke({},n);if(r.token=this.config.token,e==="$snapshot"){var s=ke(ke({},this.persistence.properties()),this.sessionPersistence.properties());return r.distinct_id=s.distinct_id,(!Un(r.distinct_id)&&!ur(r.distinct_id)||DC(r.distinct_id))&&re.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),r}var o=hn.properties();if(this.sessionManager){var a=this.sessionManager.checkAndGetSessionAndWindowId(),l=a.sessionId,u=a.windowId;r.$session_id=l,r.$window_id=u}if(this.requestRouter.region===Tl.CUSTOM&&(r.$lib_custom_api_host=this.config.api_host),this.sessionPropsManager&&this.config.__preview_send_client_session_params&&(e==="$pageview"||e==="$pageleave"||e==="$autocapture")){var c=this.sessionPropsManager.getSessionProps();r=Qn(r,c)}if(!this.config.disable_scroll_properties){var d={};e==="$pageview"?d=this.pageViewManager.doPageView():e==="$pageleave"&&(d=this.pageViewManager.doPageLeave()),r=Qn(r,d)}if(e==="$pageview"&&Ee&&(r.title=Ee.title),!Me(i)){var h=new Date().getTime()-i;r.$duration=parseFloat((h/1e3).toFixed(3))}Ht&&this.config.opt_out_useragent_filter&&(r.$browser_type=wE(Ht,this.config.custom_blocked_useragents)?"bot":"browser"),(r=Qn({},o,this.persistence.properties(),this.sessionPersistence.properties(),r)).$is_identified=this._isIdentified(),an(this.config.property_denylist)?wt(this.config.property_denylist,function(p){delete r[p]}):re.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var f=this.config.sanitize_properties;return f&&(r=f(r,e)),r.$process_person_profile=this._hasPersonProcessing(),r}},{key:"_calculate_set_once_properties",value:function(e){if(!this.persistence||!this._hasPersonProcessing())return e;var n=Qn({},this.persistence.get_initial_props(),e||{});return Im(n)?void 0:n}},{key:"register",value:function(e,n){var i;(i=this.persistence)===null||i===void 0||i.register(e,n)}},{key:"register_once",value:function(e,n,i){var r;(r=this.persistence)===null||r===void 0||r.register_once(e,n,i)}},{key:"register_for_session",value:function(e){var n;(n=this.sessionPersistence)===null||n===void 0||n.register(e)}},{key:"unregister",value:function(e){var n;(n=this.persistence)===null||n===void 0||n.unregister(e)}},{key:"unregister_for_session",value:function(e){var n;(n=this.sessionPersistence)===null||n===void 0||n.unregister(e)}},{key:"_register_single",value:function(e,n){this.register(X({},e,n))}},{key:"getFeatureFlag",value:function(e,n){return this.featureFlags.getFeatureFlag(e,n)}},{key:"getFeatureFlagPayload",value:function(e){var n=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(n)}catch{return n}}},{key:"isFeatureEnabled",value:function(e,n){return this.featureFlags.isFeatureEnabled(e,n)}},{key:"reloadFeatureFlags",value:function(){this.featureFlags.reloadFeatureFlags()}},{key:"updateEarlyAccessFeatureEnrollment",value:function(e,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,n)}},{key:"getEarlyAccessFeatures",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.featureFlags.getEarlyAccessFeatures(e,n)}},{key:"on",value:function(e,n){return this._internalEventEmitter.on(e,n)}},{key:"onFeatureFlags",value:function(e){return this.featureFlags.onFeatureFlags(e)}},{key:"onSessionId",value:function(e){var n,i;return(n=(i=this.sessionManager)===null||i===void 0?void 0:i.onSessionId(e))!==null&&n!==void 0?n:function(){}}},{key:"getSurveys",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.surveys.getSurveys(e,n)}},{key:"getActiveMatchingSurveys",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.surveys.getActiveMatchingSurveys(e,n)}},{key:"getNextSurveyStep",value:function(e,n,i){return this.surveys.getNextSurveyStep(e,n,i)}},{key:"identify",value:function(e,n,i){if(!this.__loaded||!this.persistence)return re.uninitializedWarning("posthog.identify");if(ur(e)&&(e=e.toString(),re.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e){if(["distinct_id","distinctid"].includes(e.toLowerCase()))re.critical('The string "'.concat(e,'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.'));else if(this._requirePersonProcessing("posthog.identify")){var r=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var s=r;this.register_once({$had_persisted_distinct_id:!0,$device_id:s},"")}e!==r&&e!==this.get_property(jd)&&(this.unregister(jd),this.register({distinct_id:e}));var o=(this.persistence.get_property(Ys)||"anonymous")==="anonymous";e!==r&&o?(this.persistence.set_property(Ys,"identified"),this.setPersonPropertiesForFlags(n||{},!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:r},{$set:n||{},$set_once:i||{}}),this.featureFlags.setAnonymousDistinctId(r)):(n||i)&&this.setPersonProperties(n,i),e!==r&&(this.reloadFeatureFlags(),this.unregister(wg))}}else re.error("Unique user id has not been set in posthog.identify")}},{key:"setPersonProperties",value:function(e,n){(e||n)&&this._requirePersonProcessing("posthog.setPersonProperties")&&(this.setPersonPropertiesForFlags(e||{}),this.capture("$set",{$set:e||{},$set_once:n||{}}))}},{key:"group",value:function(e,n,i){if(e&&n){if(this._requirePersonProcessing("posthog.group")){var r=this.getGroups();r[e]!==n&&this.resetGroupPropertiesForFlags(e),this.register({$groups:ke(ke({},r),{},X({},e,n))}),i&&(this.capture("$groupidentify",{$group_type:e,$group_key:n,$group_set:i}),this.setGroupPropertiesForFlags(X({},e,i))),r[e]===n||i||this.reloadFeatureFlags()}}else re.error("posthog.group requires a group type and group key")}},{key:"resetGroups",value:function(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}},{key:"setPersonPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this._requirePersonProcessing("posthog.setPersonPropertiesForFlags")&&this.featureFlags.setPersonPropertiesForFlags(e,n)}},{key:"resetPersonPropertiesForFlags",value:function(){this.featureFlags.resetPersonPropertiesForFlags()}},{key:"setGroupPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this._requirePersonProcessing("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,n)}},{key:"resetGroupPropertiesForFlags",value:function(e){this.featureFlags.resetGroupPropertiesForFlags(e)}},{key:"reset",value:function(e){var n,i,r,s;if(!this.__loaded)return re.uninitializedWarning("posthog.reset");var o=this.get_property("$device_id");this.consent.reset(),(n=this.persistence)===null||n===void 0||n.clear(),(i=this.sessionPersistence)===null||i===void 0||i.clear(),(r=this.persistence)===null||r===void 0||r.set_property(Ys,"anonymous"),(s=this.sessionManager)===null||s===void 0||s.resetSessionId();var a=this.config.get_device_id(da());this.register_once({distinct_id:a,$device_id:e?a:o},"")}},{key:"get_distinct_id",value:function(){return this.get_property("distinct_id")}},{key:"getGroups",value:function(){return this.get_property("$groups")||{}}},{key:"get_session_id",value:function(){var e,n;return(e=(n=this.sessionManager)===null||n===void 0?void 0:n.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}},{key:"get_session_replay_url",value:function(e){if(!this.sessionManager)return"";var n=this.sessionManager.checkAndGetSessionAndWindowId(!0),i=n.sessionId,r=n.sessionStartTimestamp,s=this.requestRouter.endpointFor("ui","/project/".concat(this.config.token,"/replay/").concat(i));if(e!=null&&e.withTimestamp&&r){var o,a=(o=e.timestampLookBack)!==null&&o!==void 0?o:10;if(!r)return s;var l=Math.max(Math.floor((new Date().getTime()-r)/1e3)-a,0);s+="?t=".concat(l)}return s}},{key:"alias",value:function(e,n){return e===this.get_property(MN)?(re.critical("Attempting to create alias for existing People user - aborting."),-2):this._requirePersonProcessing("posthog.alias")?(Me(n)&&(n=this.get_distinct_id()),e!==n?(this._register_single(jd,e),this.capture("$create_alias",{alias:e,distinct_id:n})):(re.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}},{key:"set_config",value:function(e){var n,i,r,s,o=ke({},this.config);En(e)&&(Qn(this.config,_E(e)),(n=this.persistence)===null||n===void 0||n.update_config(this.config,o),this.sessionPersistence=this.config.persistence==="sessionStorage"?this.persistence:new g0(ke(ke({},this.config),{},{persistence:"sessionStorage"})),nn.is_supported()&&nn.get("ph_debug")==="true"&&(this.config.debug=!0),this.config.debug&&(Vr.DEBUG=!0),(i=this.sessionRecording)===null||i===void 0||i.startIfEnabledOrStop(),(r=this.autocapture)===null||r===void 0||r.startIfEnabled(),(s=this.heatmaps)===null||s===void 0||s.startIfEnabled(),this.surveys.loadIfEnabled(),this._sync_opt_out_with_persistence())}},{key:"startSessionRecording",value:function(e){if(e!=null&&e.sampling){var n,i,r=(n=this.sessionManager)===null||n===void 0?void 0:n.checkAndGetSessionAndWindowId();(i=this.persistence)===null||i===void 0||i.register(X({},nh,!0)),re.info("Session recording started with sampling override for session: ",r==null?void 0:r.sessionId)}this.set_config({disable_session_recording:!1})}},{key:"stopSessionRecording",value:function(){this.set_config({disable_session_recording:!0})}},{key:"sessionRecordingStarted",value:function(){var e;return!((e=this.sessionRecording)===null||e===void 0||!e.started)}},{key:"loadToolbar",value:function(e){return this.toolbar.loadToolbar(e)}},{key:"get_property",value:function(e){var n;return(n=this.persistence)===null||n===void 0?void 0:n.props[e]}},{key:"getSessionProperty",value:function(e){var n;return(n=this.sessionPersistence)===null||n===void 0?void 0:n.props[e]}},{key:"toString",value:function(){var e,n=(e=this.config.name)!==null&&e!==void 0?e:Su;return n!==Su&&(n=Su+"."+n),n}},{key:"_isIdentified",value:function(){var e,n;return((e=this.persistence)===null||e===void 0?void 0:e.get_property(Ys))==="identified"||((n=this.sessionPersistence)===null||n===void 0?void 0:n.get_property(Ys))==="identified"}},{key:"_hasPersonProcessing",value:function(){var e,n,i,r;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Im(this.getGroups())&&((e=this.persistence)===null||e===void 0||(n=e.props)===null||n===void 0||!n[jd])&&((i=this.persistence)===null||i===void 0||(r=i.props)===null||r===void 0||!r[bg]))}},{key:"_shouldCapturePageleave",value:function(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&this.config.capture_pageview}},{key:"createPersonProfile",value:function(){this._hasPersonProcessing()||this._requirePersonProcessing("posthog.createPersonProfile")&&this.setPersonProperties({},{})}},{key:"_requirePersonProcessing",value:function(e){return this.config.person_profiles==="never"?(re.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this._register_single(bg,!0),!0)}},{key:"_sync_opt_out_with_persistence",value:function(){var e,n,i,r,s=this.consent.isOptedOut(),o=this.config.opt_out_persistence_by_default,a=this.config.disable_persistence||s&&!!o;((e=this.persistence)===null||e===void 0?void 0:e.disabled)!==a&&((i=this.persistence)===null||i===void 0||i.set_disabled(a)),((n=this.sessionPersistence)===null||n===void 0?void 0:n.disabled)!==a&&((r=this.sessionPersistence)===null||r===void 0||r.set_disabled(a))}},{key:"opt_in_capturing",value:function(e){var n;this.consent.optInOut(!0),this._sync_opt_out_with_persistence(),(Me(e==null?void 0:e.captureEventName)||e!=null&&e.captureEventName)&&this.capture((n=e==null?void 0:e.captureEventName)!==null&&n!==void 0?n:"$opt_in",e==null?void 0:e.captureProperties,{send_instantly:!0})}},{key:"opt_out_capturing",value:function(){this.consent.optInOut(!1),this._sync_opt_out_with_persistence()}},{key:"has_opted_in_capturing",value:function(){return this.consent.isOptedIn()}},{key:"has_opted_out_capturing",value:function(){return this.consent.isOptedOut()}},{key:"clear_opt_in_out_capturing",value:function(){this.consent.reset(),this._sync_opt_out_with_persistence()}},{key:"debug",value:function(e){e===!1?(V==null||V.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(V==null||V.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}}]),t}();(function(t,e){for(var n=0;n<e.length;n++)t.prototype[e[n]]=S4(t.prototype[e[n]])})(fM,["identify"]);var CE,Qu=(CE=oh[Su]=new fM,function(){function t(){t.done||(t.done=!0,hM=!1,wt(oh,function(e){e._dom_loaded()}))}Ee!=null&&Ee.addEventListener&&(Ee.readyState==="complete"?t():Ee.addEventListener("DOMContentLoaded",t,!1)),V&&mo(V,"load",t,!0)}(),CE),X5=S.createContext({client:Qu});function q5(t){var e=t.children,n=t.client,i=t.apiKey,r=t.options,s=S.useMemo(function(){return n&&i&&console.warn("[PostHog.js] You have provided both a client and an apiKey to PostHogProvider. The apiKey will be ignored in favour of the client."),n&&r&&console.warn("[PostHog.js] You have provided both a client and options to PostHogProvider. The options will be ignored in favour of the client."),n||(i&&(Qu.__loaded&&console.warn("[PostHog.js] was already loaded elsewhere. This may cause issues."),Qu.init(i,r)),Qu)},[n,i]);return pn.createElement(X5.Provider,{value:{client:s}},e)}var Ib={},pM={exports:{}},Ji={},mM={exports:{}},gM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,j){var te=H.length;H.push(j);e:for(;0<te;){var pe=te-1>>>1,q=H[pe];if(0<r(q,j))H[pe]=j,H[te]=q,te=pe;else break e}}function n(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var j=H[0],te=H.pop();if(te!==j){H[0]=te;e:for(var pe=0,q=H.length,ue=q>>>1;pe<ue;){var O=2*(pe+1)-1,M=H[O],F=O+1,x=H[F];if(0>r(M,te))F<q&&0>r(x,M)?(H[pe]=x,H[F]=te,pe=F):(H[pe]=M,H[O]=te,pe=O);else if(F<q&&0>r(x,te))H[pe]=x,H[F]=te,pe=F;else break e}}return j}function r(H,j){var te=H.sortIndex-j.sortIndex;return te!==0?te:H.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,d=null,h=3,f=!1,p=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(H){for(var j=n(u);j!==null;){if(j.callback===null)i(u);else if(j.startTime<=H)i(u),j.sortIndex=j.expirationTime,e(l,j);else break;j=n(u)}}function k(H){if(m=!1,b(H),!p)if(n(l)!==null)p=!0,Q(_);else{var j=n(u);j!==null&&ie(k,j.startTime-H)}}function _(H,j){p=!1,m&&(m=!1,v(P),P=-1),f=!0;var te=h;try{for(b(j),d=n(l);d!==null&&(!(d.expirationTime>j)||H&&!B());){var pe=d.callback;if(typeof pe=="function"){d.callback=null,h=d.priorityLevel;var q=pe(d.expirationTime<=j);j=t.unstable_now(),typeof q=="function"?d.callback=q:d===n(l)&&i(l),b(j)}else i(l);d=n(l)}if(d!==null)var ue=!0;else{var O=n(u);O!==null&&ie(k,O.startTime-j),ue=!1}return ue}finally{d=null,h=te,f=!1}}var E=!1,A=null,P=-1,D=5,L=-1;function B(){return!(t.unstable_now()-L<D)}function $(){if(A!==null){var H=t.unstable_now();L=H;var j=!0;try{j=A(!0,H)}finally{j?J():(E=!1,A=null)}}else E=!1}var J;if(typeof y=="function")J=function(){y($)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,G=z.port2;z.port1.onmessage=$,J=function(){G.postMessage(null)}}else J=function(){w($,0)};function Q(H){A=H,E||(E=!0,J())}function ie(H,j){P=w(function(){H(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Q(_))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(H){switch(h){case 1:case 2:case 3:var j=3;break;default:j=h}var te=h;h=j;try{return H()}finally{h=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,j){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var te=h;h=H;try{return j()}finally{h=te}},t.unstable_scheduleCallback=function(H,j,te){var pe=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?pe+te:pe):te=pe,H){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=te+q,H={id:c++,callback:j,priorityLevel:H,startTime:te,expirationTime:q,sortIndex:-1},te>pe?(H.sortIndex=te,e(u,H),n(l)===null&&H===n(u)&&(m?(v(P),P=-1):m=!0,ie(k,te-pe))):(H.sortIndex=q,e(l,H),p||f||(p=!0,Q(_))),H},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(H){var j=h;return function(){var te=h;h=j;try{return H.apply(this,arguments)}finally{h=te}}}})(gM);mM.exports=gM;var Y5=mM.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J5=S,qi=Y5;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var vM=new Set,Oh={};function ou(t,e){Cc(t,e),Cc(t+"Capture",e)}function Cc(t,e){for(Oh[t]=e,t=0;t<e.length;t++)vM.add(e[t])}var Co=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lb=Object.prototype.hasOwnProperty,Z5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,EE={},AE={};function Q5(t){return Lb.call(AE,t)?!0:Lb.call(EE,t)?!1:Z5.test(t)?AE[t]=!0:(EE[t]=!0,!1)}function ez(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function tz(t,e,n,i){if(e===null||typeof e>"u"||ez(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ai(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var On={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){On[t]=new ai(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];On[e]=new ai(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){On[t]=new ai(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){On[t]=new ai(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){On[t]=new ai(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){On[t]=new ai(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){On[t]=new ai(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){On[t]=new ai(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){On[t]=new ai(t,5,!1,t.toLowerCase(),null,!1,!1)});var SS=/[\-:]([a-z])/g;function kS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(SS,kS);On[e]=new ai(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(SS,kS);On[e]=new ai(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(SS,kS);On[e]=new ai(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){On[t]=new ai(t,1,!1,t.toLowerCase(),null,!1,!1)});On.xlinkHref=new ai("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){On[t]=new ai(t,1,!1,t.toLowerCase(),null,!0,!0)});function _S(t,e,n,i){var r=On.hasOwnProperty(e)?On[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(tz(e,n,r,i)&&(n=null),i||r===null?Q5(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var Lo=J5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ap=Symbol.for("react.element"),Mu=Symbol.for("react.portal"),Ou=Symbol.for("react.fragment"),CS=Symbol.for("react.strict_mode"),jb=Symbol.for("react.profiler"),yM=Symbol.for("react.provider"),wM=Symbol.for("react.context"),ES=Symbol.for("react.forward_ref"),Fb=Symbol.for("react.suspense"),Bb=Symbol.for("react.suspense_list"),AS=Symbol.for("react.memo"),Yo=Symbol.for("react.lazy"),bM=Symbol.for("react.offscreen"),PE=Symbol.iterator;function pd(t){return t===null||typeof t!="object"?null:(t=PE&&t[PE]||t["@@iterator"],typeof t=="function"?t:null)}var $t=Object.assign,k0;function $d(t){if(k0===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);k0=e&&e[1]||""}return`
`+k0+t}var _0=!1;function C0(t,e){if(!t||_0)return"";_0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){i=u}t.call(e.prototype)}else{try{throw Error()}catch(u){i=u}t()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{_0=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?$d(t):""}function nz(t){switch(t.tag){case 5:return $d(t.type);case 16:return $d("Lazy");case 13:return $d("Suspense");case 19:return $d("SuspenseList");case 0:case 2:case 15:return t=C0(t.type,!1),t;case 11:return t=C0(t.type.render,!1),t;case 1:return t=C0(t.type,!0),t;default:return""}}function $b(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ou:return"Fragment";case Mu:return"Portal";case jb:return"Profiler";case CS:return"StrictMode";case Fb:return"Suspense";case Bb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case wM:return(t.displayName||"Context")+".Consumer";case yM:return(t._context.displayName||"Context")+".Provider";case ES:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case AS:return e=t.displayName||null,e!==null?e:$b(t.type)||"Memo";case Yo:e=t._payload,t=t._init;try{return $b(t(e))}catch{}}return null}function iz(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $b(e);case 8:return e===CS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function La(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function xM(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function rz(t){var e=xM(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Pp(t){t._valueTracker||(t._valueTracker=rz(t))}function SM(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=xM(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Tg(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zb(t,e){var n=e.checked;return $t({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function TE(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=La(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function kM(t,e){e=e.checked,e!=null&&_S(t,"checked",e,!1)}function Ub(t,e){kM(t,e);var n=La(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vb(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vb(t,e.type,La(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function RE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vb(t,e,n){(e!=="number"||Tg(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var zd=Array.isArray;function ec(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+La(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Hb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return $t({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function NE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(zd(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:La(n)}}function _M(t,e){var n=La(e.value),i=La(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function ME(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function CM(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?CM(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Tp,EM=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Tp=Tp||document.createElement("div"),Tp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Tp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Dh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ah={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sz=["Webkit","ms","Moz","O"];Object.keys(ah).forEach(function(t){sz.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ah[e]=ah[t]})});function AM(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ah.hasOwnProperty(t)&&ah[t]?(""+e).trim():e+"px"}function PM(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=AM(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var oz=$t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gb(t,e){if(e){if(oz[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function Kb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xb=null;function PS(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var qb=null,tc=null,nc=null;function OE(t){if(t=Hf(t)){if(typeof qb!="function")throw Error(se(280));var e=t.stateNode;e&&(e=ry(e),qb(t.stateNode,t.type,e))}}function TM(t){tc?nc?nc.push(t):nc=[t]:tc=t}function RM(){if(tc){var t=tc,e=nc;if(nc=tc=null,OE(t),e)for(t=0;t<e.length;t++)OE(e[t])}}function NM(t,e){return t(e)}function MM(){}var E0=!1;function OM(t,e,n){if(E0)return t(e,n);E0=!0;try{return NM(t,e,n)}finally{E0=!1,(tc!==null||nc!==null)&&(MM(),RM())}}function Ih(t,e){var n=t.stateNode;if(n===null)return null;var i=ry(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var Yb=!1;if(Co)try{var md={};Object.defineProperty(md,"passive",{get:function(){Yb=!0}}),window.addEventListener("test",md,md),window.removeEventListener("test",md,md)}catch{Yb=!1}function az(t,e,n,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var lh=!1,Rg=null,Ng=!1,Jb=null,lz={onError:function(t){lh=!0,Rg=t}};function uz(t,e,n,i,r,s,o,a,l){lh=!1,Rg=null,az.apply(lz,arguments)}function cz(t,e,n,i,r,s,o,a,l){if(uz.apply(this,arguments),lh){if(lh){var u=Rg;lh=!1,Rg=null}else throw Error(se(198));Ng||(Ng=!0,Jb=u)}}function au(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function DM(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function DE(t){if(au(t)!==t)throw Error(se(188))}function dz(t){var e=t.alternate;if(!e){if(e=au(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return DE(r),t;if(s===i)return DE(r),e;s=s.sibling}throw Error(se(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(se(189))}}if(n.alternate!==i)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function IM(t){return t=dz(t),t!==null?LM(t):null}function LM(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=LM(t);if(e!==null)return e;t=t.sibling}return null}var jM=qi.unstable_scheduleCallback,IE=qi.unstable_cancelCallback,hz=qi.unstable_shouldYield,fz=qi.unstable_requestPaint,Xt=qi.unstable_now,pz=qi.unstable_getCurrentPriorityLevel,TS=qi.unstable_ImmediatePriority,FM=qi.unstable_UserBlockingPriority,Mg=qi.unstable_NormalPriority,mz=qi.unstable_LowPriority,BM=qi.unstable_IdlePriority,ey=null,Ds=null;function gz(t){if(Ds&&typeof Ds.onCommitFiberRoot=="function")try{Ds.onCommitFiberRoot(ey,t,void 0,(t.current.flags&128)===128)}catch{}}var Jr=Math.clz32?Math.clz32:wz,vz=Math.log,yz=Math.LN2;function wz(t){return t>>>=0,t===0?32:31-(vz(t)/yz|0)|0}var Rp=64,Np=4194304;function Ud(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Og(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=Ud(a):(s&=o,s!==0&&(i=Ud(s)))}else o=n&~r,o!==0?i=Ud(o):s!==0&&(i=Ud(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Jr(e),r=1<<n,i|=t[n],e&=~r;return i}function bz(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xz(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Jr(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=bz(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Zb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $M(){var t=Rp;return Rp<<=1,!(Rp&4194240)&&(Rp=64),t}function A0(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Uf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Jr(e),t[e]=n}function Sz(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Jr(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function RS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Jr(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var ht=0;function zM(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var UM,NS,VM,HM,WM,Qb=!1,Mp=[],Ca=null,Ea=null,Aa=null,Lh=new Map,jh=new Map,na=[],kz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function LE(t,e){switch(t){case"focusin":case"focusout":Ca=null;break;case"dragenter":case"dragleave":Ea=null;break;case"mouseover":case"mouseout":Aa=null;break;case"pointerover":case"pointerout":Lh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":jh.delete(e.pointerId)}}function gd(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Hf(e),e!==null&&NS(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function _z(t,e,n,i,r){switch(e){case"focusin":return Ca=gd(Ca,t,e,n,i,r),!0;case"dragenter":return Ea=gd(Ea,t,e,n,i,r),!0;case"mouseover":return Aa=gd(Aa,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Lh.set(s,gd(Lh.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,jh.set(s,gd(jh.get(s)||null,t,e,n,i,r)),!0}return!1}function GM(t){var e=Rl(t.target);if(e!==null){var n=au(e);if(n!==null){if(e=n.tag,e===13){if(e=DM(n),e!==null){t.blockedOn=e,WM(t.priority,function(){VM(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Fm(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ex(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);Xb=i,n.target.dispatchEvent(i),Xb=null}else return e=Hf(n),e!==null&&NS(e),t.blockedOn=n,!1;e.shift()}return!0}function jE(t,e,n){Fm(t)&&n.delete(e)}function Cz(){Qb=!1,Ca!==null&&Fm(Ca)&&(Ca=null),Ea!==null&&Fm(Ea)&&(Ea=null),Aa!==null&&Fm(Aa)&&(Aa=null),Lh.forEach(jE),jh.forEach(jE)}function vd(t,e){t.blockedOn===e&&(t.blockedOn=null,Qb||(Qb=!0,qi.unstable_scheduleCallback(qi.unstable_NormalPriority,Cz)))}function Fh(t){function e(r){return vd(r,t)}if(0<Mp.length){vd(Mp[0],t);for(var n=1;n<Mp.length;n++){var i=Mp[n];i.blockedOn===t&&(i.blockedOn=null)}}for(Ca!==null&&vd(Ca,t),Ea!==null&&vd(Ea,t),Aa!==null&&vd(Aa,t),Lh.forEach(e),jh.forEach(e),n=0;n<na.length;n++)i=na[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<na.length&&(n=na[0],n.blockedOn===null);)GM(n),n.blockedOn===null&&na.shift()}var ic=Lo.ReactCurrentBatchConfig,Dg=!0;function Ez(t,e,n,i){var r=ht,s=ic.transition;ic.transition=null;try{ht=1,MS(t,e,n,i)}finally{ht=r,ic.transition=s}}function Az(t,e,n,i){var r=ht,s=ic.transition;ic.transition=null;try{ht=4,MS(t,e,n,i)}finally{ht=r,ic.transition=s}}function MS(t,e,n,i){if(Dg){var r=ex(t,e,n,i);if(r===null)j0(t,e,i,Ig,n),LE(t,i);else if(_z(r,t,e,n,i))i.stopPropagation();else if(LE(t,i),e&4&&-1<kz.indexOf(t)){for(;r!==null;){var s=Hf(r);if(s!==null&&UM(s),s=ex(t,e,n,i),s===null&&j0(t,e,i,Ig,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else j0(t,e,i,null,n)}}var Ig=null;function ex(t,e,n,i){if(Ig=null,t=PS(i),t=Rl(t),t!==null)if(e=au(t),e===null)t=null;else if(n=e.tag,n===13){if(t=DM(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ig=t,null}function KM(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pz()){case TS:return 1;case FM:return 4;case Mg:case mz:return 16;case BM:return 536870912;default:return 16}default:return 16}}var ha=null,OS=null,Bm=null;function XM(){if(Bm)return Bm;var t,e=OS,n=e.length,i,r="value"in ha?ha.value:ha.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return Bm=r.slice(t,1<i?1-i:void 0)}function $m(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Op(){return!0}function FE(){return!1}function Zi(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Op:FE,this.isPropagationStopped=FE,this}return $t(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Op)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Op)},persist:function(){},isPersistent:Op}),e}var Qc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},DS=Zi(Qc),Vf=$t({},Qc,{view:0,detail:0}),Pz=Zi(Vf),P0,T0,yd,ty=$t({},Vf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:IS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==yd&&(yd&&t.type==="mousemove"?(P0=t.screenX-yd.screenX,T0=t.screenY-yd.screenY):T0=P0=0,yd=t),P0)},movementY:function(t){return"movementY"in t?t.movementY:T0}}),BE=Zi(ty),Tz=$t({},ty,{dataTransfer:0}),Rz=Zi(Tz),Nz=$t({},Vf,{relatedTarget:0}),R0=Zi(Nz),Mz=$t({},Qc,{animationName:0,elapsedTime:0,pseudoElement:0}),Oz=Zi(Mz),Dz=$t({},Qc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Iz=Zi(Dz),Lz=$t({},Qc,{data:0}),$E=Zi(Lz),jz={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fz={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bz={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $z(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Bz[t])?!!e[t]:!1}function IS(){return $z}var zz=$t({},Vf,{key:function(t){if(t.key){var e=jz[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=$m(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Fz[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:IS,charCode:function(t){return t.type==="keypress"?$m(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?$m(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Uz=Zi(zz),Vz=$t({},ty,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zE=Zi(Vz),Hz=$t({},Vf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:IS}),Wz=Zi(Hz),Gz=$t({},Qc,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kz=Zi(Gz),Xz=$t({},ty,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),qz=Zi(Xz),Yz=[9,13,27,32],LS=Co&&"CompositionEvent"in window,uh=null;Co&&"documentMode"in document&&(uh=document.documentMode);var Jz=Co&&"TextEvent"in window&&!uh,qM=Co&&(!LS||uh&&8<uh&&11>=uh),UE=" ",VE=!1;function YM(t,e){switch(t){case"keyup":return Yz.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function JM(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Du=!1;function Zz(t,e){switch(t){case"compositionend":return JM(e);case"keypress":return e.which!==32?null:(VE=!0,UE);case"textInput":return t=e.data,t===UE&&VE?null:t;default:return null}}function Qz(t,e){if(Du)return t==="compositionend"||!LS&&YM(t,e)?(t=XM(),Bm=OS=ha=null,Du=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return qM&&e.locale!=="ko"?null:e.data;default:return null}}var e8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function HE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!e8[t.type]:e==="textarea"}function ZM(t,e,n,i){TM(i),e=Lg(e,"onChange"),0<e.length&&(n=new DS("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var ch=null,Bh=null;function t8(t){uO(t,0)}function ny(t){var e=ju(t);if(SM(e))return t}function n8(t,e){if(t==="change")return e}var QM=!1;if(Co){var N0;if(Co){var M0="oninput"in document;if(!M0){var WE=document.createElement("div");WE.setAttribute("oninput","return;"),M0=typeof WE.oninput=="function"}N0=M0}else N0=!1;QM=N0&&(!document.documentMode||9<document.documentMode)}function GE(){ch&&(ch.detachEvent("onpropertychange",eO),Bh=ch=null)}function eO(t){if(t.propertyName==="value"&&ny(Bh)){var e=[];ZM(e,Bh,t,PS(t)),OM(t8,e)}}function i8(t,e,n){t==="focusin"?(GE(),ch=e,Bh=n,ch.attachEvent("onpropertychange",eO)):t==="focusout"&&GE()}function r8(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ny(Bh)}function s8(t,e){if(t==="click")return ny(e)}function o8(t,e){if(t==="input"||t==="change")return ny(e)}function a8(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var es=typeof Object.is=="function"?Object.is:a8;function $h(t,e){if(es(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!Lb.call(e,r)||!es(t[r],e[r]))return!1}return!0}function KE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function XE(t,e){var n=KE(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=KE(n)}}function tO(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?tO(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function nO(){for(var t=window,e=Tg();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Tg(t.document)}return e}function jS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function l8(t){var e=nO(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&tO(n.ownerDocument.documentElement,n)){if(i!==null&&jS(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=XE(n,s);var o=XE(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var u8=Co&&"documentMode"in document&&11>=document.documentMode,Iu=null,tx=null,dh=null,nx=!1;function qE(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nx||Iu==null||Iu!==Tg(i)||(i=Iu,"selectionStart"in i&&jS(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),dh&&$h(dh,i)||(dh=i,i=Lg(tx,"onSelect"),0<i.length&&(e=new DS("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Iu)))}function Dp(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Lu={animationend:Dp("Animation","AnimationEnd"),animationiteration:Dp("Animation","AnimationIteration"),animationstart:Dp("Animation","AnimationStart"),transitionend:Dp("Transition","TransitionEnd")},O0={},iO={};Co&&(iO=document.createElement("div").style,"AnimationEvent"in window||(delete Lu.animationend.animation,delete Lu.animationiteration.animation,delete Lu.animationstart.animation),"TransitionEvent"in window||delete Lu.transitionend.transition);function iy(t){if(O0[t])return O0[t];if(!Lu[t])return t;var e=Lu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in iO)return O0[t]=e[n];return t}var rO=iy("animationend"),sO=iy("animationiteration"),oO=iy("animationstart"),aO=iy("transitionend"),lO=new Map,YE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qa(t,e){lO.set(t,e),ou(e,[t])}for(var D0=0;D0<YE.length;D0++){var I0=YE[D0],c8=I0.toLowerCase(),d8=I0[0].toUpperCase()+I0.slice(1);Qa(c8,"on"+d8)}Qa(rO,"onAnimationEnd");Qa(sO,"onAnimationIteration");Qa(oO,"onAnimationStart");Qa("dblclick","onDoubleClick");Qa("focusin","onFocus");Qa("focusout","onBlur");Qa(aO,"onTransitionEnd");Cc("onMouseEnter",["mouseout","mouseover"]);Cc("onMouseLeave",["mouseout","mouseover"]);Cc("onPointerEnter",["pointerout","pointerover"]);Cc("onPointerLeave",["pointerout","pointerover"]);ou("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ou("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ou("onBeforeInput",["compositionend","keypress","textInput","paste"]);ou("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ou("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ou("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),h8=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vd));function JE(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,cz(i,e,void 0,t),t.currentTarget=null}function uO(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;JE(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;JE(r,a,u),s=l}}}if(Ng)throw t=Jb,Ng=!1,Jb=null,t}function Ct(t,e){var n=e[ax];n===void 0&&(n=e[ax]=new Set);var i=t+"__bubble";n.has(i)||(cO(e,t,2,!1),n.add(i))}function L0(t,e,n){var i=0;e&&(i|=4),cO(n,t,i,e)}var Ip="_reactListening"+Math.random().toString(36).slice(2);function zh(t){if(!t[Ip]){t[Ip]=!0,vM.forEach(function(n){n!=="selectionchange"&&(h8.has(n)||L0(n,!1,t),L0(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ip]||(e[Ip]=!0,L0("selectionchange",!1,e))}}function cO(t,e,n,i){switch(KM(e)){case 1:var r=Ez;break;case 4:r=Az;break;default:r=MS}n=r.bind(null,e,n,t),r=void 0,!Yb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function j0(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Rl(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}OM(function(){var u=s,c=PS(n),d=[];e:{var h=lO.get(t);if(h!==void 0){var f=DS,p=t;switch(t){case"keypress":if($m(n)===0)break e;case"keydown":case"keyup":f=Uz;break;case"focusin":p="focus",f=R0;break;case"focusout":p="blur",f=R0;break;case"beforeblur":case"afterblur":f=R0;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=BE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Rz;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Wz;break;case rO:case sO:case oO:f=Oz;break;case aO:f=Kz;break;case"scroll":f=Pz;break;case"wheel":f=qz;break;case"copy":case"cut":case"paste":f=Iz;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=zE}var m=(e&4)!==0,w=!m&&t==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var y=u,b;y!==null;){b=y;var k=b.stateNode;if(b.tag===5&&k!==null&&(b=k,v!==null&&(k=Ih(y,v),k!=null&&m.push(Uh(y,k,b)))),w)break;y=y.return}0<m.length&&(h=new f(h,p,null,n,c),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==Xb&&(p=n.relatedTarget||n.fromElement)&&(Rl(p)||p[Eo]))break e;if((f||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=u,p=p?Rl(p):null,p!==null&&(w=au(p),p!==w||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=u),f!==p)){if(m=BE,k="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=zE,k="onPointerLeave",v="onPointerEnter",y="pointer"),w=f==null?h:ju(f),b=p==null?h:ju(p),h=new m(k,y+"leave",f,n,c),h.target=w,h.relatedTarget=b,k=null,Rl(c)===u&&(m=new m(v,y+"enter",p,n,c),m.target=b,m.relatedTarget=w,k=m),w=k,f&&p)t:{for(m=f,v=p,y=0,b=m;b;b=hu(b))y++;for(b=0,k=v;k;k=hu(k))b++;for(;0<y-b;)m=hu(m),y--;for(;0<b-y;)v=hu(v),b--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=hu(m),v=hu(v)}m=null}else m=null;f!==null&&ZE(d,h,f,m,!1),p!==null&&w!==null&&ZE(d,w,p,m,!0)}}e:{if(h=u?ju(u):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var _=n8;else if(HE(h))if(QM)_=o8;else{_=r8;var E=i8}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=s8);if(_&&(_=_(t,u))){ZM(d,_,n,c);break e}E&&E(t,h,u),t==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&Vb(h,"number",h.value)}switch(E=u?ju(u):window,t){case"focusin":(HE(E)||E.contentEditable==="true")&&(Iu=E,tx=u,dh=null);break;case"focusout":dh=tx=Iu=null;break;case"mousedown":nx=!0;break;case"contextmenu":case"mouseup":case"dragend":nx=!1,qE(d,n,c);break;case"selectionchange":if(u8)break;case"keydown":case"keyup":qE(d,n,c)}var A;if(LS)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Du?YM(t,n)&&(P="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(P="onCompositionStart");P&&(qM&&n.locale!=="ko"&&(Du||P!=="onCompositionStart"?P==="onCompositionEnd"&&Du&&(A=XM()):(ha=c,OS="value"in ha?ha.value:ha.textContent,Du=!0)),E=Lg(u,P),0<E.length&&(P=new $E(P,t,null,n,c),d.push({event:P,listeners:E}),A?P.data=A:(A=JM(n),A!==null&&(P.data=A)))),(A=Jz?Zz(t,n):Qz(t,n))&&(u=Lg(u,"onBeforeInput"),0<u.length&&(c=new $E("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=A))}uO(d,e)})}function Uh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Lg(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Ih(t,n),s!=null&&i.unshift(Uh(t,s,r)),s=Ih(t,e),s!=null&&i.push(Uh(t,s,r))),t=t.return}return i}function hu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ZE(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=Ih(n,s),l!=null&&o.unshift(Uh(n,l,a))):r||(l=Ih(n,s),l!=null&&o.push(Uh(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var f8=/\r\n?/g,p8=/\u0000|\uFFFD/g;function QE(t){return(typeof t=="string"?t:""+t).replace(f8,`
`).replace(p8,"")}function Lp(t,e,n){if(e=QE(e),QE(t)!==e&&n)throw Error(se(425))}function jg(){}var ix=null,rx=null;function sx(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ox=typeof setTimeout=="function"?setTimeout:void 0,m8=typeof clearTimeout=="function"?clearTimeout:void 0,eA=typeof Promise=="function"?Promise:void 0,g8=typeof queueMicrotask=="function"?queueMicrotask:typeof eA<"u"?function(t){return eA.resolve(null).then(t).catch(v8)}:ox;function v8(t){setTimeout(function(){throw t})}function F0(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),Fh(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);Fh(e)}function Pa(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function tA(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ed=Math.random().toString(36).slice(2),_s="__reactFiber$"+ed,Vh="__reactProps$"+ed,Eo="__reactContainer$"+ed,ax="__reactEvents$"+ed,y8="__reactListeners$"+ed,w8="__reactHandles$"+ed;function Rl(t){var e=t[_s];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Eo]||n[_s]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=tA(t);t!==null;){if(n=t[_s])return n;t=tA(t)}return e}t=n,n=t.parentNode}return null}function Hf(t){return t=t[_s]||t[Eo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ju(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function ry(t){return t[Vh]||null}var lx=[],Fu=-1;function el(t){return{current:t}}function Rt(t){0>Fu||(t.current=lx[Fu],lx[Fu]=null,Fu--)}function _t(t,e){Fu++,lx[Fu]=t.current,t.current=e}var ja={},Vn=el(ja),Ai=el(!1),Vl=ja;function Ec(t,e){var n=t.type.contextTypes;if(!n)return ja;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Pi(t){return t=t.childContextTypes,t!=null}function Fg(){Rt(Ai),Rt(Vn)}function nA(t,e,n){if(Vn.current!==ja)throw Error(se(168));_t(Vn,e),_t(Ai,n)}function dO(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(se(108,iz(t)||"Unknown",r));return $t({},n,i)}function Bg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ja,Vl=Vn.current,_t(Vn,t),_t(Ai,Ai.current),!0}function iA(t,e,n){var i=t.stateNode;if(!i)throw Error(se(169));n?(t=dO(t,e,Vl),i.__reactInternalMemoizedMergedChildContext=t,Rt(Ai),Rt(Vn),_t(Vn,t)):Rt(Ai),_t(Ai,n)}var to=null,sy=!1,B0=!1;function hO(t){to===null?to=[t]:to.push(t)}function b8(t){sy=!0,hO(t)}function tl(){if(!B0&&to!==null){B0=!0;var t=0,e=ht;try{var n=to;for(ht=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}to=null,sy=!1}catch(r){throw to!==null&&(to=to.slice(t+1)),jM(TS,tl),r}finally{ht=e,B0=!1}}return null}var Bu=[],$u=0,$g=null,zg=0,cr=[],dr=0,Hl=null,vo=1,yo="";function bl(t,e){Bu[$u++]=zg,Bu[$u++]=$g,$g=t,zg=e}function fO(t,e,n){cr[dr++]=vo,cr[dr++]=yo,cr[dr++]=Hl,Hl=t;var i=vo;t=yo;var r=32-Jr(i)-1;i&=~(1<<r),n+=1;var s=32-Jr(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,vo=1<<32-Jr(e)+r|n<<r|i,yo=s+t}else vo=1<<s|n<<r|i,yo=t}function FS(t){t.return!==null&&(bl(t,1),fO(t,1,0))}function BS(t){for(;t===$g;)$g=Bu[--$u],Bu[$u]=null,zg=Bu[--$u],Bu[$u]=null;for(;t===Hl;)Hl=cr[--dr],cr[dr]=null,yo=cr[--dr],cr[dr]=null,vo=cr[--dr],cr[dr]=null}var Gi=null,Ui=null,Dt=!1,zr=null;function pO(t,e){var n=mr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function rA(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Gi=t,Ui=Pa(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Gi=t,Ui=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Hl!==null?{id:vo,overflow:yo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=mr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Gi=t,Ui=null,!0):!1;default:return!1}}function ux(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cx(t){if(Dt){var e=Ui;if(e){var n=e;if(!rA(t,e)){if(ux(t))throw Error(se(418));e=Pa(n.nextSibling);var i=Gi;e&&rA(t,e)?pO(i,n):(t.flags=t.flags&-4097|2,Dt=!1,Gi=t)}}else{if(ux(t))throw Error(se(418));t.flags=t.flags&-4097|2,Dt=!1,Gi=t}}}function sA(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Gi=t}function jp(t){if(t!==Gi)return!1;if(!Dt)return sA(t),Dt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sx(t.type,t.memoizedProps)),e&&(e=Ui)){if(ux(t))throw mO(),Error(se(418));for(;e;)pO(t,e),e=Pa(e.nextSibling)}if(sA(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ui=Pa(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ui=null}}else Ui=Gi?Pa(t.stateNode.nextSibling):null;return!0}function mO(){for(var t=Ui;t;)t=Pa(t.nextSibling)}function Ac(){Ui=Gi=null,Dt=!1}function $S(t){zr===null?zr=[t]:zr.push(t)}var x8=Lo.ReactCurrentBatchConfig;function wd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var i=n.stateNode}if(!i)throw Error(se(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function Fp(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function oA(t){var e=t._init;return e(t._payload)}function gO(t){function e(v,y){if(t){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function n(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function i(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function r(v,y){return v=Ma(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,y,b,k){return y===null||y.tag!==6?(y=G0(b,v.mode,k),y.return=v,y):(y=r(y,b),y.return=v,y)}function l(v,y,b,k){var _=b.type;return _===Ou?c(v,y,b.props.children,k,b.key):y!==null&&(y.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Yo&&oA(_)===y.type)?(k=r(y,b.props),k.ref=wd(v,y,b),k.return=v,k):(k=Km(b.type,b.key,b.props,null,v.mode,k),k.ref=wd(v,y,b),k.return=v,k)}function u(v,y,b,k){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=K0(b,v.mode,k),y.return=v,y):(y=r(y,b.children||[]),y.return=v,y)}function c(v,y,b,k,_){return y===null||y.tag!==7?(y=jl(b,v.mode,k,_),y.return=v,y):(y=r(y,b),y.return=v,y)}function d(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=G0(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ap:return b=Km(y.type,y.key,y.props,null,v.mode,b),b.ref=wd(v,null,y),b.return=v,b;case Mu:return y=K0(y,v.mode,b),y.return=v,y;case Yo:var k=y._init;return d(v,k(y._payload),b)}if(zd(y)||pd(y))return y=jl(y,v.mode,b,null),y.return=v,y;Fp(v,y)}return null}function h(v,y,b,k){var _=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return _!==null?null:a(v,y,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ap:return b.key===_?l(v,y,b,k):null;case Mu:return b.key===_?u(v,y,b,k):null;case Yo:return _=b._init,h(v,y,_(b._payload),k)}if(zd(b)||pd(b))return _!==null?null:c(v,y,b,k,null);Fp(v,b)}return null}function f(v,y,b,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return v=v.get(b)||null,a(y,v,""+k,_);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Ap:return v=v.get(k.key===null?b:k.key)||null,l(y,v,k,_);case Mu:return v=v.get(k.key===null?b:k.key)||null,u(y,v,k,_);case Yo:var E=k._init;return f(v,y,b,E(k._payload),_)}if(zd(k)||pd(k))return v=v.get(b)||null,c(y,v,k,_,null);Fp(y,k)}return null}function p(v,y,b,k){for(var _=null,E=null,A=y,P=y=0,D=null;A!==null&&P<b.length;P++){A.index>P?(D=A,A=null):D=A.sibling;var L=h(v,A,b[P],k);if(L===null){A===null&&(A=D);break}t&&A&&L.alternate===null&&e(v,A),y=s(L,y,P),E===null?_=L:E.sibling=L,E=L,A=D}if(P===b.length)return n(v,A),Dt&&bl(v,P),_;if(A===null){for(;P<b.length;P++)A=d(v,b[P],k),A!==null&&(y=s(A,y,P),E===null?_=A:E.sibling=A,E=A);return Dt&&bl(v,P),_}for(A=i(v,A);P<b.length;P++)D=f(A,v,P,b[P],k),D!==null&&(t&&D.alternate!==null&&A.delete(D.key===null?P:D.key),y=s(D,y,P),E===null?_=D:E.sibling=D,E=D);return t&&A.forEach(function(B){return e(v,B)}),Dt&&bl(v,P),_}function m(v,y,b,k){var _=pd(b);if(typeof _!="function")throw Error(se(150));if(b=_.call(b),b==null)throw Error(se(151));for(var E=_=null,A=y,P=y=0,D=null,L=b.next();A!==null&&!L.done;P++,L=b.next()){A.index>P?(D=A,A=null):D=A.sibling;var B=h(v,A,L.value,k);if(B===null){A===null&&(A=D);break}t&&A&&B.alternate===null&&e(v,A),y=s(B,y,P),E===null?_=B:E.sibling=B,E=B,A=D}if(L.done)return n(v,A),Dt&&bl(v,P),_;if(A===null){for(;!L.done;P++,L=b.next())L=d(v,L.value,k),L!==null&&(y=s(L,y,P),E===null?_=L:E.sibling=L,E=L);return Dt&&bl(v,P),_}for(A=i(v,A);!L.done;P++,L=b.next())L=f(A,v,P,L.value,k),L!==null&&(t&&L.alternate!==null&&A.delete(L.key===null?P:L.key),y=s(L,y,P),E===null?_=L:E.sibling=L,E=L);return t&&A.forEach(function($){return e(v,$)}),Dt&&bl(v,P),_}function w(v,y,b,k){if(typeof b=="object"&&b!==null&&b.type===Ou&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ap:e:{for(var _=b.key,E=y;E!==null;){if(E.key===_){if(_=b.type,_===Ou){if(E.tag===7){n(v,E.sibling),y=r(E,b.props.children),y.return=v,v=y;break e}}else if(E.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Yo&&oA(_)===E.type){n(v,E.sibling),y=r(E,b.props),y.ref=wd(v,E,b),y.return=v,v=y;break e}n(v,E);break}else e(v,E);E=E.sibling}b.type===Ou?(y=jl(b.props.children,v.mode,k,b.key),y.return=v,v=y):(k=Km(b.type,b.key,b.props,null,v.mode,k),k.ref=wd(v,y,b),k.return=v,v=k)}return o(v);case Mu:e:{for(E=b.key;y!==null;){if(y.key===E)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(v,y.sibling),y=r(y,b.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else e(v,y);y=y.sibling}y=K0(b,v.mode,k),y.return=v,v=y}return o(v);case Yo:return E=b._init,w(v,y,E(b._payload),k)}if(zd(b))return p(v,y,b,k);if(pd(b))return m(v,y,b,k);Fp(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(v,y.sibling),y=r(y,b),y.return=v,v=y):(n(v,y),y=G0(b,v.mode,k),y.return=v,v=y),o(v)):n(v,y)}return w}var Pc=gO(!0),vO=gO(!1),Ug=el(null),Vg=null,zu=null,zS=null;function US(){zS=zu=Vg=null}function VS(t){var e=Ug.current;Rt(Ug),t._currentValue=e}function dx(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function rc(t,e){Vg=t,zS=zu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ci=!0),t.firstContext=null)}function Pr(t){var e=t._currentValue;if(zS!==t)if(t={context:t,memoizedValue:e,next:null},zu===null){if(Vg===null)throw Error(se(308));zu=t,Vg.dependencies={lanes:0,firstContext:t}}else zu=zu.next=t;return e}var Nl=null;function HS(t){Nl===null?Nl=[t]:Nl.push(t)}function yO(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,HS(e)):(n.next=r.next,r.next=n),e.interleaved=n,Ao(t,i)}function Ao(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Jo=!1;function WS(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wO(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ta(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,st&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Ao(t,n)}return r=i.interleaved,r===null?(e.next=e,HS(i)):(e.next=r.next,r.next=e),i.interleaved=e,Ao(t,n)}function zm(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,RS(t,n)}}function aA(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Hg(t,e,n,i){var r=t.updateQueue;Jo=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var d=r.baseState;o=0,c=u=l=null,a=s;do{var h=a.lane,f=a.eventTime;if((i&h)===h){c!==null&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=$t({},d,h);break e;case 2:Jo=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=f,l=d):c=c.next=f,o|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(c===null&&(l=d),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Gl|=o,t.lanes=o,t.memoizedState=d}}function lA(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(se(191,r));r.call(i)}}}var Wf={},Is=el(Wf),Hh=el(Wf),Wh=el(Wf);function Ml(t){if(t===Wf)throw Error(se(174));return t}function GS(t,e){switch(_t(Wh,e),_t(Hh,t),_t(Is,Wf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Wb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Wb(e,t)}Rt(Is),_t(Is,e)}function Tc(){Rt(Is),Rt(Hh),Rt(Wh)}function bO(t){Ml(Wh.current);var e=Ml(Is.current),n=Wb(e,t.type);e!==n&&(_t(Hh,t),_t(Is,n))}function KS(t){Hh.current===t&&(Rt(Is),Rt(Hh))}var jt=el(0);function Wg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var $0=[];function XS(){for(var t=0;t<$0.length;t++)$0[t]._workInProgressVersionPrimary=null;$0.length=0}var Um=Lo.ReactCurrentDispatcher,z0=Lo.ReactCurrentBatchConfig,Wl=0,Bt=null,tn=null,fn=null,Gg=!1,hh=!1,Gh=0,S8=0;function In(){throw Error(se(321))}function qS(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!es(t[n],e[n]))return!1;return!0}function YS(t,e,n,i,r,s){if(Wl=s,Bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Um.current=t===null||t.memoizedState===null?E8:A8,t=n(i,r),hh){s=0;do{if(hh=!1,Gh=0,25<=s)throw Error(se(301));s+=1,fn=tn=null,e.updateQueue=null,Um.current=P8,t=n(i,r)}while(hh)}if(Um.current=Kg,e=tn!==null&&tn.next!==null,Wl=0,fn=tn=Bt=null,Gg=!1,e)throw Error(se(300));return t}function JS(){var t=Gh!==0;return Gh=0,t}function ms(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fn===null?Bt.memoizedState=fn=t:fn=fn.next=t,fn}function Tr(){if(tn===null){var t=Bt.alternate;t=t!==null?t.memoizedState:null}else t=tn.next;var e=fn===null?Bt.memoizedState:fn.next;if(e!==null)fn=e,tn=t;else{if(t===null)throw Error(se(310));tn=t,t={memoizedState:tn.memoizedState,baseState:tn.baseState,baseQueue:tn.baseQueue,queue:tn.queue,next:null},fn===null?Bt.memoizedState=fn=t:fn=fn.next=t}return fn}function Kh(t,e){return typeof e=="function"?e(t):e}function U0(t){var e=Tr(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var i=tn,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((Wl&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,o=i):l=l.next=d,Bt.lanes|=c,Gl|=c}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,es(i,e.memoizedState)||(Ci=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,Bt.lanes|=s,Gl|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function V0(t){var e=Tr(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);es(s,e.memoizedState)||(Ci=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function xO(){}function SO(t,e){var n=Bt,i=Tr(),r=e(),s=!es(i.memoizedState,r);if(s&&(i.memoizedState=r,Ci=!0),i=i.queue,ZS(CO.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||fn!==null&&fn.memoizedState.tag&1){if(n.flags|=2048,Xh(9,_O.bind(null,n,i,r,e),void 0,null),mn===null)throw Error(se(349));Wl&30||kO(n,e,r)}return r}function kO(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function _O(t,e,n,i){e.value=n,e.getSnapshot=i,EO(e)&&AO(t)}function CO(t,e,n){return n(function(){EO(e)&&AO(t)})}function EO(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!es(t,n)}catch{return!0}}function AO(t){var e=Ao(t,1);e!==null&&Zr(e,t,1,-1)}function uA(t){var e=ms();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kh,lastRenderedState:t},e.queue=t,t=t.dispatch=C8.bind(null,Bt,t),[e.memoizedState,t]}function Xh(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function PO(){return Tr().memoizedState}function Vm(t,e,n,i){var r=ms();Bt.flags|=t,r.memoizedState=Xh(1|e,n,void 0,i===void 0?null:i)}function oy(t,e,n,i){var r=Tr();i=i===void 0?null:i;var s=void 0;if(tn!==null){var o=tn.memoizedState;if(s=o.destroy,i!==null&&qS(i,o.deps)){r.memoizedState=Xh(e,n,s,i);return}}Bt.flags|=t,r.memoizedState=Xh(1|e,n,s,i)}function cA(t,e){return Vm(8390656,8,t,e)}function ZS(t,e){return oy(2048,8,t,e)}function TO(t,e){return oy(4,2,t,e)}function RO(t,e){return oy(4,4,t,e)}function NO(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function MO(t,e,n){return n=n!=null?n.concat([t]):null,oy(4,4,NO.bind(null,e,t),n)}function QS(){}function OO(t,e){var n=Tr();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&qS(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function DO(t,e){var n=Tr();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&qS(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function IO(t,e,n){return Wl&21?(es(n,e)||(n=$M(),Bt.lanes|=n,Gl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ci=!0),t.memoizedState=n)}function k8(t,e){var n=ht;ht=n!==0&&4>n?n:4,t(!0);var i=z0.transition;z0.transition={};try{t(!1),e()}finally{ht=n,z0.transition=i}}function LO(){return Tr().memoizedState}function _8(t,e,n){var i=Na(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},jO(t))FO(e,n);else if(n=yO(t,e,n,i),n!==null){var r=ni();Zr(n,t,i,r),BO(n,e,i)}}function C8(t,e,n){var i=Na(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(jO(t))FO(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,es(a,o)){var l=e.interleaved;l===null?(r.next=r,HS(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=yO(t,e,r,i),n!==null&&(r=ni(),Zr(n,t,i,r),BO(n,e,i))}}function jO(t){var e=t.alternate;return t===Bt||e!==null&&e===Bt}function FO(t,e){hh=Gg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function BO(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,RS(t,n)}}var Kg={readContext:Pr,useCallback:In,useContext:In,useEffect:In,useImperativeHandle:In,useInsertionEffect:In,useLayoutEffect:In,useMemo:In,useReducer:In,useRef:In,useState:In,useDebugValue:In,useDeferredValue:In,useTransition:In,useMutableSource:In,useSyncExternalStore:In,useId:In,unstable_isNewReconciler:!1},E8={readContext:Pr,useCallback:function(t,e){return ms().memoizedState=[t,e===void 0?null:e],t},useContext:Pr,useEffect:cA,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Vm(4194308,4,NO.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Vm(4194308,4,t,e)},useInsertionEffect:function(t,e){return Vm(4,2,t,e)},useMemo:function(t,e){var n=ms();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=ms();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=_8.bind(null,Bt,t),[i.memoizedState,t]},useRef:function(t){var e=ms();return t={current:t},e.memoizedState=t},useState:uA,useDebugValue:QS,useDeferredValue:function(t){return ms().memoizedState=t},useTransition:function(){var t=uA(!1),e=t[0];return t=k8.bind(null,t[1]),ms().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=Bt,r=ms();if(Dt){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),mn===null)throw Error(se(349));Wl&30||kO(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,cA(CO.bind(null,i,s,t),[t]),i.flags|=2048,Xh(9,_O.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=ms(),e=mn.identifierPrefix;if(Dt){var n=yo,i=vo;n=(i&~(1<<32-Jr(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=Gh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=S8++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},A8={readContext:Pr,useCallback:OO,useContext:Pr,useEffect:ZS,useImperativeHandle:MO,useInsertionEffect:TO,useLayoutEffect:RO,useMemo:DO,useReducer:U0,useRef:PO,useState:function(){return U0(Kh)},useDebugValue:QS,useDeferredValue:function(t){var e=Tr();return IO(e,tn.memoizedState,t)},useTransition:function(){var t=U0(Kh)[0],e=Tr().memoizedState;return[t,e]},useMutableSource:xO,useSyncExternalStore:SO,useId:LO,unstable_isNewReconciler:!1},P8={readContext:Pr,useCallback:OO,useContext:Pr,useEffect:ZS,useImperativeHandle:MO,useInsertionEffect:TO,useLayoutEffect:RO,useMemo:DO,useReducer:V0,useRef:PO,useState:function(){return V0(Kh)},useDebugValue:QS,useDeferredValue:function(t){var e=Tr();return tn===null?e.memoizedState=t:IO(e,tn.memoizedState,t)},useTransition:function(){var t=V0(Kh)[0],e=Tr().memoizedState;return[t,e]},useMutableSource:xO,useSyncExternalStore:SO,useId:LO,unstable_isNewReconciler:!1};function Ir(t,e){if(t&&t.defaultProps){e=$t({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function hx(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:$t({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ay={isMounted:function(t){return(t=t._reactInternals)?au(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=ni(),r=Na(t),s=xo(i,r);s.payload=e,n!=null&&(s.callback=n),e=Ta(t,s,r),e!==null&&(Zr(e,t,r,i),zm(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=ni(),r=Na(t),s=xo(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ta(t,s,r),e!==null&&(Zr(e,t,r,i),zm(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ni(),i=Na(t),r=xo(n,i);r.tag=2,e!=null&&(r.callback=e),e=Ta(t,r,i),e!==null&&(Zr(e,t,i,n),zm(e,t,i))}};function dA(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!$h(n,i)||!$h(r,s):!0}function $O(t,e,n){var i=!1,r=ja,s=e.contextType;return typeof s=="object"&&s!==null?s=Pr(s):(r=Pi(e)?Vl:Vn.current,i=e.contextTypes,s=(i=i!=null)?Ec(t,r):ja),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ay,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function hA(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&ay.enqueueReplaceState(e,e.state,null)}function fx(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},WS(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Pr(s):(s=Pi(e)?Vl:Vn.current,r.context=Ec(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(hx(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&ay.enqueueReplaceState(r,r.state,null),Hg(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Rc(t,e){try{var n="",i=e;do n+=nz(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function H0(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function px(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var T8=typeof WeakMap=="function"?WeakMap:Map;function zO(t,e,n){n=xo(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){qg||(qg=!0,_x=i),px(t,e)},n}function UO(t,e,n){n=xo(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){px(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){px(t,e),typeof i!="function"&&(Ra===null?Ra=new Set([this]):Ra.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function fA(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new T8;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=V8.bind(null,t,e,n),e.then(t,t))}function pA(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function mA(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xo(-1,1),e.tag=2,Ta(n,e,1))),n.lanes|=1),t)}var R8=Lo.ReactCurrentOwner,Ci=!1;function Jn(t,e,n,i){e.child=t===null?vO(e,null,n,i):Pc(e,t.child,n,i)}function gA(t,e,n,i,r){n=n.render;var s=e.ref;return rc(e,r),i=YS(t,e,n,i,s,r),n=JS(),t!==null&&!Ci?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Po(t,e,r)):(Dt&&n&&FS(e),e.flags|=1,Jn(t,e,i,r),e.child)}function vA(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!ak(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,VO(t,e,s,i,r)):(t=Km(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:$h,n(o,i)&&t.ref===e.ref)return Po(t,e,r)}return e.flags|=1,t=Ma(s,i),t.ref=e.ref,t.return=e,e.child=t}function VO(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if($h(s,i)&&t.ref===e.ref)if(Ci=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(Ci=!0);else return e.lanes=t.lanes,Po(t,e,r)}return mx(t,e,n,i,r)}function HO(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(Vu,Fi),Fi|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_t(Vu,Fi),Fi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,_t(Vu,Fi),Fi|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,_t(Vu,Fi),Fi|=i;return Jn(t,e,r,n),e.child}function WO(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function mx(t,e,n,i,r){var s=Pi(n)?Vl:Vn.current;return s=Ec(e,s),rc(e,r),n=YS(t,e,n,i,s,r),i=JS(),t!==null&&!Ci?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Po(t,e,r)):(Dt&&i&&FS(e),e.flags|=1,Jn(t,e,n,r),e.child)}function yA(t,e,n,i,r){if(Pi(n)){var s=!0;Bg(e)}else s=!1;if(rc(e,r),e.stateNode===null)Hm(t,e),$O(e,n,i),fx(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Pr(u):(u=Pi(n)?Vl:Vn.current,u=Ec(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&hA(e,o,i,u),Jo=!1;var h=e.memoizedState;o.state=h,Hg(e,i,o,r),l=e.memoizedState,a!==i||h!==l||Ai.current||Jo?(typeof c=="function"&&(hx(e,n,c,i),l=e.memoizedState),(a=Jo||dA(e,n,a,i,h,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,wO(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ir(e.type,a),o.props=u,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Pr(l):(l=Pi(n)?Vl:Vn.current,l=Ec(e,l));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&hA(e,o,i,l),Jo=!1,h=e.memoizedState,o.state=h,Hg(e,i,o,r);var p=e.memoizedState;a!==d||h!==p||Ai.current||Jo?(typeof f=="function"&&(hx(e,n,f,i),p=e.memoizedState),(u=Jo||dA(e,n,u,i,h,p,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),o.props=i,o.state=p,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),i=!1)}return gx(t,e,n,i,s,r)}function gx(t,e,n,i,r,s){WO(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&iA(e,n,!1),Po(t,e,s);i=e.stateNode,R8.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=Pc(e,t.child,null,s),e.child=Pc(e,null,a,s)):Jn(t,e,a,s),e.memoizedState=i.state,r&&iA(e,n,!0),e.child}function GO(t){var e=t.stateNode;e.pendingContext?nA(t,e.pendingContext,e.pendingContext!==e.context):e.context&&nA(t,e.context,!1),GS(t,e.containerInfo)}function wA(t,e,n,i,r){return Ac(),$S(r),e.flags|=256,Jn(t,e,n,i),e.child}var vx={dehydrated:null,treeContext:null,retryLane:0};function yx(t){return{baseLanes:t,cachePool:null,transitions:null}}function KO(t,e,n){var i=e.pendingProps,r=jt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),_t(jt,r&1),t===null)return cx(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=cy(o,i,0,null),t=jl(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=yx(n),e.memoizedState=vx,t):ek(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return N8(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Ma(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Ma(a,s):(s=jl(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?yx(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=vx,i}return s=t.child,t=s.sibling,i=Ma(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function ek(t,e){return e=cy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Bp(t,e,n,i){return i!==null&&$S(i),Pc(e,t.child,null,n),t=ek(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function N8(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=H0(Error(se(422))),Bp(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=cy({mode:"visible",children:i.children},r,0,null),s=jl(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Pc(e,t.child,null,o),e.child.memoizedState=yx(o),e.memoizedState=vx,s);if(!(e.mode&1))return Bp(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(se(419)),i=H0(s,i,void 0),Bp(t,e,o,i)}if(a=(o&t.childLanes)!==0,Ci||a){if(i=mn,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Ao(t,r),Zr(i,t,r,-1))}return ok(),i=H0(Error(se(421))),Bp(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=H8.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,Ui=Pa(r.nextSibling),Gi=e,Dt=!0,zr=null,t!==null&&(cr[dr++]=vo,cr[dr++]=yo,cr[dr++]=Hl,vo=t.id,yo=t.overflow,Hl=e),e=ek(e,i.children),e.flags|=4096,e)}function bA(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),dx(t.return,e,n)}function W0(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function XO(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Jn(t,e,i.children,n),i=jt.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bA(t,n,e);else if(t.tag===19)bA(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(_t(jt,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Wg(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),W0(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Wg(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}W0(e,!0,n,null,s);break;case"together":W0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Hm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Po(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Gl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=Ma(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ma(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function M8(t,e,n){switch(e.tag){case 3:GO(e),Ac();break;case 5:bO(e);break;case 1:Pi(e.type)&&Bg(e);break;case 4:GS(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;_t(Ug,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(_t(jt,jt.current&1),e.flags|=128,null):n&e.child.childLanes?KO(t,e,n):(_t(jt,jt.current&1),t=Po(t,e,n),t!==null?t.sibling:null);_t(jt,jt.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return XO(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),_t(jt,jt.current),i)break;return null;case 22:case 23:return e.lanes=0,HO(t,e,n)}return Po(t,e,n)}var qO,wx,YO,JO;qO=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};wx=function(){};YO=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Ml(Is.current);var s=null;switch(n){case"input":r=zb(t,r),i=zb(t,i),s=[];break;case"select":r=$t({},r,{value:void 0}),i=$t({},i,{value:void 0}),s=[];break;case"textarea":r=Hb(t,r),i=Hb(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=jg)}Gb(n,i);var o;n=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Oh.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Oh.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ct("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};JO=function(t,e,n,i){n!==i&&(e.flags|=4)};function bd(t,e){if(!Dt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Ln(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function O8(t,e,n){var i=e.pendingProps;switch(BS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ln(e),null;case 1:return Pi(e.type)&&Fg(),Ln(e),null;case 3:return i=e.stateNode,Tc(),Rt(Ai),Rt(Vn),XS(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(jp(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zr!==null&&(Ax(zr),zr=null))),wx(t,e),Ln(e),null;case 5:KS(e);var r=Ml(Wh.current);if(n=e.type,t!==null&&e.stateNode!=null)YO(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(se(166));return Ln(e),null}if(t=Ml(Is.current),jp(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[_s]=e,i[Vh]=s,t=(e.mode&1)!==0,n){case"dialog":Ct("cancel",i),Ct("close",i);break;case"iframe":case"object":case"embed":Ct("load",i);break;case"video":case"audio":for(r=0;r<Vd.length;r++)Ct(Vd[r],i);break;case"source":Ct("error",i);break;case"img":case"image":case"link":Ct("error",i),Ct("load",i);break;case"details":Ct("toggle",i);break;case"input":TE(i,s),Ct("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Ct("invalid",i);break;case"textarea":NE(i,s),Ct("invalid",i)}Gb(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Lp(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Lp(i.textContent,a,t),r=["children",""+a]):Oh.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ct("scroll",i)}switch(n){case"input":Pp(i),RE(i,s,!0);break;case"textarea":Pp(i),ME(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=jg)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=CM(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[_s]=e,t[Vh]=i,qO(t,e,!1,!1),e.stateNode=t;e:{switch(o=Kb(n,i),n){case"dialog":Ct("cancel",t),Ct("close",t),r=i;break;case"iframe":case"object":case"embed":Ct("load",t),r=i;break;case"video":case"audio":for(r=0;r<Vd.length;r++)Ct(Vd[r],t);r=i;break;case"source":Ct("error",t),r=i;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),r=i;break;case"details":Ct("toggle",t),r=i;break;case"input":TE(t,i),r=zb(t,i),Ct("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=$t({},i,{value:void 0}),Ct("invalid",t);break;case"textarea":NE(t,i),r=Hb(t,i),Ct("invalid",t);break;default:r=i}Gb(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?PM(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&EM(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Dh(t,l):typeof l=="number"&&Dh(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Oh.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ct("scroll",t):l!=null&&_S(t,s,l,o))}switch(n){case"input":Pp(t),RE(t,i,!1);break;case"textarea":Pp(t),ME(t);break;case"option":i.value!=null&&t.setAttribute("value",""+La(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?ec(t,!!i.multiple,s,!1):i.defaultValue!=null&&ec(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=jg)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ln(e),null;case 6:if(t&&e.stateNode!=null)JO(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(se(166));if(n=Ml(Wh.current),Ml(Is.current),jp(e)){if(i=e.stateNode,n=e.memoizedProps,i[_s]=e,(s=i.nodeValue!==n)&&(t=Gi,t!==null))switch(t.tag){case 3:Lp(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Lp(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[_s]=e,e.stateNode=i}return Ln(e),null;case 13:if(Rt(jt),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Dt&&Ui!==null&&e.mode&1&&!(e.flags&128))mO(),Ac(),e.flags|=98560,s=!1;else if(s=jp(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(se(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(se(317));s[_s]=e}else Ac(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ln(e),s=!1}else zr!==null&&(Ax(zr),zr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||jt.current&1?ln===0&&(ln=3):ok())),e.updateQueue!==null&&(e.flags|=4),Ln(e),null);case 4:return Tc(),wx(t,e),t===null&&zh(e.stateNode.containerInfo),Ln(e),null;case 10:return VS(e.type._context),Ln(e),null;case 17:return Pi(e.type)&&Fg(),Ln(e),null;case 19:if(Rt(jt),s=e.memoizedState,s===null)return Ln(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)bd(s,!1);else{if(ln!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Wg(t),o!==null){for(e.flags|=128,bd(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _t(jt,jt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Xt()>Nc&&(e.flags|=128,i=!0,bd(s,!1),e.lanes=4194304)}else{if(!i)if(t=Wg(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),bd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Dt)return Ln(e),null}else 2*Xt()-s.renderingStartTime>Nc&&n!==1073741824&&(e.flags|=128,i=!0,bd(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Xt(),e.sibling=null,n=jt.current,_t(jt,i?n&1|2:n&1),e):(Ln(e),null);case 22:case 23:return sk(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Fi&1073741824&&(Ln(e),e.subtreeFlags&6&&(e.flags|=8192)):Ln(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function D8(t,e){switch(BS(e),e.tag){case 1:return Pi(e.type)&&Fg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Tc(),Rt(Ai),Rt(Vn),XS(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return KS(e),null;case 13:if(Rt(jt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));Ac()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Rt(jt),null;case 4:return Tc(),null;case 10:return VS(e.type._context),null;case 22:case 23:return sk(),null;case 24:return null;default:return null}}var $p=!1,$n=!1,I8=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Uu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Ut(t,e,i)}else n.current=null}function bx(t,e,n){try{n()}catch(i){Ut(t,e,i)}}var xA=!1;function L8(t,e){if(ix=Dg,t=nO(),jS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,d=t,h=null;t:for(;;){for(var f;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(l=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++u===r&&(a=o),h===s&&++c===i&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(rx={focusedElem:t,selectionRange:n},Dg=!1,xe=e;xe!==null;)if(e=xe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,xe=t;else for(;xe!==null;){e=xe;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,w=p.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:Ir(e.type,m),w);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(k){Ut(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,xe=t;break}xe=e.return}return p=xA,xA=!1,p}function fh(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&bx(e,n,s)}r=r.next}while(r!==i)}}function ly(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function xx(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ZO(t){var e=t.alternate;e!==null&&(t.alternate=null,ZO(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[_s],delete e[Vh],delete e[ax],delete e[y8],delete e[w8])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function QO(t){return t.tag===5||t.tag===3||t.tag===4}function SA(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||QO(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sx(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=jg));else if(i!==4&&(t=t.child,t!==null))for(Sx(t,e,n),t=t.sibling;t!==null;)Sx(t,e,n),t=t.sibling}function kx(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(kx(t,e,n),t=t.sibling;t!==null;)kx(t,e,n),t=t.sibling}var wn=null,Br=!1;function Wo(t,e,n){for(n=n.child;n!==null;)e2(t,e,n),n=n.sibling}function e2(t,e,n){if(Ds&&typeof Ds.onCommitFiberUnmount=="function")try{Ds.onCommitFiberUnmount(ey,n)}catch{}switch(n.tag){case 5:$n||Uu(n,e);case 6:var i=wn,r=Br;wn=null,Wo(t,e,n),wn=i,Br=r,wn!==null&&(Br?(t=wn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):wn.removeChild(n.stateNode));break;case 18:wn!==null&&(Br?(t=wn,n=n.stateNode,t.nodeType===8?F0(t.parentNode,n):t.nodeType===1&&F0(t,n),Fh(t)):F0(wn,n.stateNode));break;case 4:i=wn,r=Br,wn=n.stateNode.containerInfo,Br=!0,Wo(t,e,n),wn=i,Br=r;break;case 0:case 11:case 14:case 15:if(!$n&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&bx(n,e,o),r=r.next}while(r!==i)}Wo(t,e,n);break;case 1:if(!$n&&(Uu(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Ut(n,e,a)}Wo(t,e,n);break;case 21:Wo(t,e,n);break;case 22:n.mode&1?($n=(i=$n)||n.memoizedState!==null,Wo(t,e,n),$n=i):Wo(t,e,n);break;default:Wo(t,e,n)}}function kA(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new I8),e.forEach(function(i){var r=W8.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function Mr(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:wn=a.stateNode,Br=!1;break e;case 3:wn=a.stateNode.containerInfo,Br=!0;break e;case 4:wn=a.stateNode.containerInfo,Br=!0;break e}a=a.return}if(wn===null)throw Error(se(160));e2(s,o,r),wn=null,Br=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Ut(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)t2(e,t),e=e.sibling}function t2(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Mr(e,t),cs(t),i&4){try{fh(3,t,t.return),ly(3,t)}catch(m){Ut(t,t.return,m)}try{fh(5,t,t.return)}catch(m){Ut(t,t.return,m)}}break;case 1:Mr(e,t),cs(t),i&512&&n!==null&&Uu(n,n.return);break;case 5:if(Mr(e,t),cs(t),i&512&&n!==null&&Uu(n,n.return),t.flags&32){var r=t.stateNode;try{Dh(r,"")}catch(m){Ut(t,t.return,m)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&kM(r,s),Kb(a,o);var u=Kb(a,s);for(o=0;o<l.length;o+=2){var c=l[o],d=l[o+1];c==="style"?PM(r,d):c==="dangerouslySetInnerHTML"?EM(r,d):c==="children"?Dh(r,d):_S(r,c,d,u)}switch(a){case"input":Ub(r,s);break;case"textarea":_M(r,s);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?ec(r,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?ec(r,!!s.multiple,s.defaultValue,!0):ec(r,!!s.multiple,s.multiple?[]:"",!1))}r[Vh]=s}catch(m){Ut(t,t.return,m)}}break;case 6:if(Mr(e,t),cs(t),i&4){if(t.stateNode===null)throw Error(se(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(m){Ut(t,t.return,m)}}break;case 3:if(Mr(e,t),cs(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Fh(e.containerInfo)}catch(m){Ut(t,t.return,m)}break;case 4:Mr(e,t),cs(t);break;case 13:Mr(e,t),cs(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(ik=Xt())),i&4&&kA(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?($n=(u=$n)||c,Mr(e,t),$n=u):Mr(e,t),cs(t),i&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(xe=t,c=t.child;c!==null;){for(d=xe=c;xe!==null;){switch(h=xe,f=h.child,h.tag){case 0:case 11:case 14:case 15:fh(4,h,h.return);break;case 1:Uu(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){i=h,n=h.return;try{e=i,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Ut(i,n,m)}}break;case 5:Uu(h,h.return);break;case 22:if(h.memoizedState!==null){CA(d);continue}}f!==null?(f.return=h,xe=f):CA(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{r=d.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=AM("display",o))}catch(m){Ut(t,t.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Ut(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Mr(e,t),cs(t),i&4&&kA(t);break;case 21:break;default:Mr(e,t),cs(t)}}function cs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(QO(n)){var i=n;break e}n=n.return}throw Error(se(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Dh(r,""),i.flags&=-33);var s=SA(t);kx(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=SA(t);Sx(t,a,o);break;default:throw Error(se(161))}}catch(l){Ut(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function j8(t,e,n){xe=t,n2(t)}function n2(t,e,n){for(var i=(t.mode&1)!==0;xe!==null;){var r=xe,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||$p;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||$n;a=$p;var u=$n;if($p=o,($n=l)&&!u)for(xe=r;xe!==null;)o=xe,l=o.child,o.tag===22&&o.memoizedState!==null?EA(r):l!==null?(l.return=o,xe=l):EA(r);for(;s!==null;)xe=s,n2(s),s=s.sibling;xe=r,$p=a,$n=u}_A(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,xe=s):_A(t)}}function _A(t){for(;xe!==null;){var e=xe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$n||ly(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!$n)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Ir(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&lA(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}lA(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Fh(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}$n||e.flags&512&&xx(e)}catch(h){Ut(e,e.return,h)}}if(e===t){xe=null;break}if(n=e.sibling,n!==null){n.return=e.return,xe=n;break}xe=e.return}}function CA(t){for(;xe!==null;){var e=xe;if(e===t){xe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,xe=n;break}xe=e.return}}function EA(t){for(;xe!==null;){var e=xe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ly(4,e)}catch(l){Ut(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){Ut(e,r,l)}}var s=e.return;try{xx(e)}catch(l){Ut(e,s,l)}break;case 5:var o=e.return;try{xx(e)}catch(l){Ut(e,o,l)}}}catch(l){Ut(e,e.return,l)}if(e===t){xe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,xe=a;break}xe=e.return}}var F8=Math.ceil,Xg=Lo.ReactCurrentDispatcher,tk=Lo.ReactCurrentOwner,xr=Lo.ReactCurrentBatchConfig,st=0,mn=null,Zt=null,Mn=0,Fi=0,Vu=el(0),ln=0,qh=null,Gl=0,uy=0,nk=0,ph=null,wi=null,ik=0,Nc=1/0,Zs=null,qg=!1,_x=null,Ra=null,zp=!1,fa=null,Yg=0,mh=0,Cx=null,Wm=-1,Gm=0;function ni(){return st&6?Xt():Wm!==-1?Wm:Wm=Xt()}function Na(t){return t.mode&1?st&2&&Mn!==0?Mn&-Mn:x8.transition!==null?(Gm===0&&(Gm=$M()),Gm):(t=ht,t!==0||(t=window.event,t=t===void 0?16:KM(t.type)),t):1}function Zr(t,e,n,i){if(50<mh)throw mh=0,Cx=null,Error(se(185));Uf(t,n,i),(!(st&2)||t!==mn)&&(t===mn&&(!(st&2)&&(uy|=n),ln===4&&ia(t,Mn)),Ti(t,i),n===1&&st===0&&!(e.mode&1)&&(Nc=Xt()+500,sy&&tl()))}function Ti(t,e){var n=t.callbackNode;xz(t,e);var i=Og(t,t===mn?Mn:0);if(i===0)n!==null&&IE(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&IE(n),e===1)t.tag===0?b8(AA.bind(null,t)):hO(AA.bind(null,t)),g8(function(){!(st&6)&&tl()}),n=null;else{switch(zM(i)){case 1:n=TS;break;case 4:n=FM;break;case 16:n=Mg;break;case 536870912:n=BM;break;default:n=Mg}n=c2(n,i2.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function i2(t,e){if(Wm=-1,Gm=0,st&6)throw Error(se(327));var n=t.callbackNode;if(sc()&&t.callbackNode!==n)return null;var i=Og(t,t===mn?Mn:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Jg(t,i);else{e=i;var r=st;st|=2;var s=s2();(mn!==t||Mn!==e)&&(Zs=null,Nc=Xt()+500,Ll(t,e));do try{z8();break}catch(a){r2(t,a)}while(!0);US(),Xg.current=s,st=r,Zt!==null?e=0:(mn=null,Mn=0,e=ln)}if(e!==0){if(e===2&&(r=Zb(t),r!==0&&(i=r,e=Ex(t,r))),e===1)throw n=qh,Ll(t,0),ia(t,i),Ti(t,Xt()),n;if(e===6)ia(t,i);else{if(r=t.current.alternate,!(i&30)&&!B8(r)&&(e=Jg(t,i),e===2&&(s=Zb(t),s!==0&&(i=s,e=Ex(t,s))),e===1))throw n=qh,Ll(t,0),ia(t,i),Ti(t,Xt()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(se(345));case 2:xl(t,wi,Zs);break;case 3:if(ia(t,i),(i&130023424)===i&&(e=ik+500-Xt(),10<e)){if(Og(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){ni(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ox(xl.bind(null,t,wi,Zs),e);break}xl(t,wi,Zs);break;case 4:if(ia(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Jr(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Xt()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*F8(i/1960))-i,10<i){t.timeoutHandle=ox(xl.bind(null,t,wi,Zs),i);break}xl(t,wi,Zs);break;case 5:xl(t,wi,Zs);break;default:throw Error(se(329))}}}return Ti(t,Xt()),t.callbackNode===n?i2.bind(null,t):null}function Ex(t,e){var n=ph;return t.current.memoizedState.isDehydrated&&(Ll(t,e).flags|=256),t=Jg(t,e),t!==2&&(e=wi,wi=n,e!==null&&Ax(e)),t}function Ax(t){wi===null?wi=t:wi.push.apply(wi,t)}function B8(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!es(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ia(t,e){for(e&=~nk,e&=~uy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Jr(e),i=1<<n;t[n]=-1,e&=~i}}function AA(t){if(st&6)throw Error(se(327));sc();var e=Og(t,0);if(!(e&1))return Ti(t,Xt()),null;var n=Jg(t,e);if(t.tag!==0&&n===2){var i=Zb(t);i!==0&&(e=i,n=Ex(t,i))}if(n===1)throw n=qh,Ll(t,0),ia(t,e),Ti(t,Xt()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xl(t,wi,Zs),Ti(t,Xt()),null}function rk(t,e){var n=st;st|=1;try{return t(e)}finally{st=n,st===0&&(Nc=Xt()+500,sy&&tl())}}function Kl(t){fa!==null&&fa.tag===0&&!(st&6)&&sc();var e=st;st|=1;var n=xr.transition,i=ht;try{if(xr.transition=null,ht=1,t)return t()}finally{ht=i,xr.transition=n,st=e,!(st&6)&&tl()}}function sk(){Fi=Vu.current,Rt(Vu)}function Ll(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,m8(n)),Zt!==null)for(n=Zt.return;n!==null;){var i=n;switch(BS(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Fg();break;case 3:Tc(),Rt(Ai),Rt(Vn),XS();break;case 5:KS(i);break;case 4:Tc();break;case 13:Rt(jt);break;case 19:Rt(jt);break;case 10:VS(i.type._context);break;case 22:case 23:sk()}n=n.return}if(mn=t,Zt=t=Ma(t.current,null),Mn=Fi=e,ln=0,qh=null,nk=uy=Gl=0,wi=ph=null,Nl!==null){for(e=0;e<Nl.length;e++)if(n=Nl[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}Nl=null}return t}function r2(t,e){do{var n=Zt;try{if(US(),Um.current=Kg,Gg){for(var i=Bt.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Gg=!1}if(Wl=0,fn=tn=Bt=null,hh=!1,Gh=0,tk.current=null,n===null||n.return===null){ln=1,qh=e,Zt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Mn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=pA(o);if(f!==null){f.flags&=-257,mA(f,o,a,s,e),f.mode&1&&fA(s,u,e),e=f,l=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){fA(s,u,e),ok();break e}l=Error(se(426))}}else if(Dt&&a.mode&1){var w=pA(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),mA(w,o,a,s,e),$S(Rc(l,a));break e}}s=l=Rc(l,a),ln!==4&&(ln=2),ph===null?ph=[s]:ph.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=zO(s,l,e);aA(s,v);break e;case 1:a=l;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ra===null||!Ra.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var k=UO(s,a,e);aA(s,k);break e}}s=s.return}while(s!==null)}a2(n)}catch(_){e=_,Zt===n&&n!==null&&(Zt=n=n.return);continue}break}while(!0)}function s2(){var t=Xg.current;return Xg.current=Kg,t===null?Kg:t}function ok(){(ln===0||ln===3||ln===2)&&(ln=4),mn===null||!(Gl&268435455)&&!(uy&268435455)||ia(mn,Mn)}function Jg(t,e){var n=st;st|=2;var i=s2();(mn!==t||Mn!==e)&&(Zs=null,Ll(t,e));do try{$8();break}catch(r){r2(t,r)}while(!0);if(US(),st=n,Xg.current=i,Zt!==null)throw Error(se(261));return mn=null,Mn=0,ln}function $8(){for(;Zt!==null;)o2(Zt)}function z8(){for(;Zt!==null&&!hz();)o2(Zt)}function o2(t){var e=u2(t.alternate,t,Fi);t.memoizedProps=t.pendingProps,e===null?a2(t):Zt=e,tk.current=null}function a2(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=D8(n,e),n!==null){n.flags&=32767,Zt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ln=6,Zt=null;return}}else if(n=O8(n,e,Fi),n!==null){Zt=n;return}if(e=e.sibling,e!==null){Zt=e;return}Zt=e=t}while(e!==null);ln===0&&(ln=5)}function xl(t,e,n){var i=ht,r=xr.transition;try{xr.transition=null,ht=1,U8(t,e,n,i)}finally{xr.transition=r,ht=i}return null}function U8(t,e,n,i){do sc();while(fa!==null);if(st&6)throw Error(se(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Sz(t,s),t===mn&&(Zt=mn=null,Mn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zp||(zp=!0,c2(Mg,function(){return sc(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=xr.transition,xr.transition=null;var o=ht;ht=1;var a=st;st|=4,tk.current=null,L8(t,n),t2(n,t),l8(rx),Dg=!!ix,rx=ix=null,t.current=n,j8(n),fz(),st=a,ht=o,xr.transition=s}else t.current=n;if(zp&&(zp=!1,fa=t,Yg=r),s=t.pendingLanes,s===0&&(Ra=null),gz(n.stateNode),Ti(t,Xt()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(qg)throw qg=!1,t=_x,_x=null,t;return Yg&1&&t.tag!==0&&sc(),s=t.pendingLanes,s&1?t===Cx?mh++:(mh=0,Cx=t):mh=0,tl(),null}function sc(){if(fa!==null){var t=zM(Yg),e=xr.transition,n=ht;try{if(xr.transition=null,ht=16>t?16:t,fa===null)var i=!1;else{if(t=fa,fa=null,Yg=0,st&6)throw Error(se(331));var r=st;for(st|=4,xe=t.current;xe!==null;){var s=xe,o=s.child;if(xe.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(xe=u;xe!==null;){var c=xe;switch(c.tag){case 0:case 11:case 15:fh(8,c,s)}var d=c.child;if(d!==null)d.return=c,xe=d;else for(;xe!==null;){c=xe;var h=c.sibling,f=c.return;if(ZO(c),c===u){xe=null;break}if(h!==null){h.return=f,xe=h;break}xe=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}xe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,xe=o;else e:for(;xe!==null;){if(s=xe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:fh(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,xe=v;break e}xe=s.return}}var y=t.current;for(xe=y;xe!==null;){o=xe;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,xe=b;else e:for(o=y;xe!==null;){if(a=xe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ly(9,a)}}catch(_){Ut(a,a.return,_)}if(a===o){xe=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,xe=k;break e}xe=a.return}}if(st=r,tl(),Ds&&typeof Ds.onPostCommitFiberRoot=="function")try{Ds.onPostCommitFiberRoot(ey,t)}catch{}i=!0}return i}finally{ht=n,xr.transition=e}}return!1}function PA(t,e,n){e=Rc(n,e),e=zO(t,e,1),t=Ta(t,e,1),e=ni(),t!==null&&(Uf(t,1,e),Ti(t,e))}function Ut(t,e,n){if(t.tag===3)PA(t,t,n);else for(;e!==null;){if(e.tag===3){PA(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Ra===null||!Ra.has(i))){t=Rc(n,t),t=UO(e,t,1),e=Ta(e,t,1),t=ni(),e!==null&&(Uf(e,1,t),Ti(e,t));break}}e=e.return}}function V8(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=ni(),t.pingedLanes|=t.suspendedLanes&n,mn===t&&(Mn&n)===n&&(ln===4||ln===3&&(Mn&130023424)===Mn&&500>Xt()-ik?Ll(t,0):nk|=n),Ti(t,e)}function l2(t,e){e===0&&(t.mode&1?(e=Np,Np<<=1,!(Np&130023424)&&(Np=4194304)):e=1);var n=ni();t=Ao(t,e),t!==null&&(Uf(t,e,n),Ti(t,n))}function H8(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),l2(t,n)}function W8(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(se(314))}i!==null&&i.delete(e),l2(t,n)}var u2;u2=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ai.current)Ci=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ci=!1,M8(t,e,n);Ci=!!(t.flags&131072)}else Ci=!1,Dt&&e.flags&1048576&&fO(e,zg,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Hm(t,e),t=e.pendingProps;var r=Ec(e,Vn.current);rc(e,n),r=YS(null,e,i,t,r,n);var s=JS();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pi(i)?(s=!0,Bg(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,WS(e),r.updater=ay,e.stateNode=r,r._reactInternals=e,fx(e,i,t,n),e=gx(null,e,i,!0,s,n)):(e.tag=0,Dt&&s&&FS(e),Jn(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(Hm(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=K8(i),t=Ir(i,t),r){case 0:e=mx(null,e,i,t,n);break e;case 1:e=yA(null,e,i,t,n);break e;case 11:e=gA(null,e,i,t,n);break e;case 14:e=vA(null,e,i,Ir(i.type,t),n);break e}throw Error(se(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ir(i,r),mx(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ir(i,r),yA(t,e,i,r,n);case 3:e:{if(GO(e),t===null)throw Error(se(387));i=e.pendingProps,s=e.memoizedState,r=s.element,wO(t,e),Hg(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Rc(Error(se(423)),e),e=wA(t,e,i,n,r);break e}else if(i!==r){r=Rc(Error(se(424)),e),e=wA(t,e,i,n,r);break e}else for(Ui=Pa(e.stateNode.containerInfo.firstChild),Gi=e,Dt=!0,zr=null,n=vO(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ac(),i===r){e=Po(t,e,n);break e}Jn(t,e,i,n)}e=e.child}return e;case 5:return bO(e),t===null&&cx(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,sx(i,r)?o=null:s!==null&&sx(i,s)&&(e.flags|=32),WO(t,e),Jn(t,e,o,n),e.child;case 6:return t===null&&cx(e),null;case 13:return KO(t,e,n);case 4:return GS(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=Pc(e,null,i,n):Jn(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ir(i,r),gA(t,e,i,r,n);case 7:return Jn(t,e,e.pendingProps,n),e.child;case 8:return Jn(t,e,e.pendingProps.children,n),e.child;case 12:return Jn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,_t(Ug,i._currentValue),i._currentValue=o,s!==null)if(es(s.value,o)){if(s.children===r.children&&!Ai.current){e=Po(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=xo(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),dx(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(se(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),dx(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Jn(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,rc(e,n),r=Pr(r),i=i(r),e.flags|=1,Jn(t,e,i,n),e.child;case 14:return i=e.type,r=Ir(i,e.pendingProps),r=Ir(i.type,r),vA(t,e,i,r,n);case 15:return VO(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ir(i,r),Hm(t,e),e.tag=1,Pi(i)?(t=!0,Bg(e)):t=!1,rc(e,n),$O(e,i,r),fx(e,i,r,n),gx(null,e,i,!0,t,n);case 19:return XO(t,e,n);case 22:return HO(t,e,n)}throw Error(se(156,e.tag))};function c2(t,e){return jM(t,e)}function G8(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mr(t,e,n,i){return new G8(t,e,n,i)}function ak(t){return t=t.prototype,!(!t||!t.isReactComponent)}function K8(t){if(typeof t=="function")return ak(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ES)return 11;if(t===AS)return 14}return 2}function Ma(t,e){var n=t.alternate;return n===null?(n=mr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Km(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")ak(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ou:return jl(n.children,r,s,e);case CS:o=8,r|=8;break;case jb:return t=mr(12,n,e,r|2),t.elementType=jb,t.lanes=s,t;case Fb:return t=mr(13,n,e,r),t.elementType=Fb,t.lanes=s,t;case Bb:return t=mr(19,n,e,r),t.elementType=Bb,t.lanes=s,t;case bM:return cy(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case yM:o=10;break e;case wM:o=9;break e;case ES:o=11;break e;case AS:o=14;break e;case Yo:o=16,i=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=mr(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function jl(t,e,n,i){return t=mr(7,t,i,e),t.lanes=n,t}function cy(t,e,n,i){return t=mr(22,t,i,e),t.elementType=bM,t.lanes=n,t.stateNode={isHidden:!1},t}function G0(t,e,n){return t=mr(6,t,null,e),t.lanes=n,t}function K0(t,e,n){return e=mr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function X8(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=A0(0),this.expirationTimes=A0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=A0(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function lk(t,e,n,i,r,s,o,a,l){return t=new X8(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=mr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},WS(s),t}function q8(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mu,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function d2(t){if(!t)return ja;t=t._reactInternals;e:{if(au(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(Pi(n))return dO(t,n,e)}return e}function h2(t,e,n,i,r,s,o,a,l){return t=lk(n,i,!0,t,r,s,o,a,l),t.context=d2(null),n=t.current,i=ni(),r=Na(n),s=xo(i,r),s.callback=e??null,Ta(n,s,r),t.current.lanes=r,Uf(t,r,i),Ti(t,i),t}function dy(t,e,n,i){var r=e.current,s=ni(),o=Na(r);return n=d2(n),e.context===null?e.context=n:e.pendingContext=n,e=xo(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Ta(r,e,o),t!==null&&(Zr(t,r,o,s),zm(t,r,o)),o}function Zg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function TA(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function uk(t,e){TA(t,e),(t=t.alternate)&&TA(t,e)}function Y8(){return null}var f2=typeof reportError=="function"?reportError:function(t){console.error(t)};function ck(t){this._internalRoot=t}hy.prototype.render=ck.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));dy(t,e,null,null)};hy.prototype.unmount=ck.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Kl(function(){dy(null,t,null,null)}),e[Eo]=null}};function hy(t){this._internalRoot=t}hy.prototype.unstable_scheduleHydration=function(t){if(t){var e=HM();t={blockedOn:null,target:t,priority:e};for(var n=0;n<na.length&&e!==0&&e<na[n].priority;n++);na.splice(n,0,t),n===0&&GM(t)}};function dk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function fy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function RA(){}function J8(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=Zg(o);s.call(u)}}var o=h2(e,i,t,0,null,!1,!1,"",RA);return t._reactRootContainer=o,t[Eo]=o.current,zh(t.nodeType===8?t.parentNode:t),Kl(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=Zg(l);a.call(u)}}var l=lk(t,0,!1,null,null,!1,!1,"",RA);return t._reactRootContainer=l,t[Eo]=l.current,zh(t.nodeType===8?t.parentNode:t),Kl(function(){dy(e,l,n,i)}),l}function py(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=Zg(o);a.call(l)}}dy(e,o,t,r)}else o=J8(n,e,t,r,i);return Zg(o)}UM=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ud(e.pendingLanes);n!==0&&(RS(e,n|1),Ti(e,Xt()),!(st&6)&&(Nc=Xt()+500,tl()))}break;case 13:Kl(function(){var i=Ao(t,1);if(i!==null){var r=ni();Zr(i,t,1,r)}}),uk(t,1)}};NS=function(t){if(t.tag===13){var e=Ao(t,134217728);if(e!==null){var n=ni();Zr(e,t,134217728,n)}uk(t,134217728)}};VM=function(t){if(t.tag===13){var e=Na(t),n=Ao(t,e);if(n!==null){var i=ni();Zr(n,t,e,i)}uk(t,e)}};HM=function(){return ht};WM=function(t,e){var n=ht;try{return ht=t,e()}finally{ht=n}};qb=function(t,e,n){switch(e){case"input":if(Ub(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=ry(i);if(!r)throw Error(se(90));SM(i),Ub(i,r)}}}break;case"textarea":_M(t,n);break;case"select":e=n.value,e!=null&&ec(t,!!n.multiple,e,!1)}};NM=rk;MM=Kl;var Z8={usingClientEntryPoint:!1,Events:[Hf,ju,ry,TM,RM,rk]},xd={findFiberByHostInstance:Rl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Q8={bundleType:xd.bundleType,version:xd.version,rendererPackageName:xd.rendererPackageName,rendererConfig:xd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=IM(t),t===null?null:t.stateNode},findFiberByHostInstance:xd.findFiberByHostInstance||Y8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Up=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Up.isDisabled&&Up.supportsFiber)try{ey=Up.inject(Q8),Ds=Up}catch{}}Ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z8;Ji.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dk(e))throw Error(se(200));return q8(t,e,null,n)};Ji.createRoot=function(t,e){if(!dk(t))throw Error(se(299));var n=!1,i="",r=f2;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=lk(t,1,!1,null,null,n,!1,i,r),t[Eo]=e.current,zh(t.nodeType===8?t.parentNode:t),new ck(e)};Ji.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=IM(e),t=t===null?null:t.stateNode,t};Ji.flushSync=function(t){return Kl(t)};Ji.hydrate=function(t,e,n){if(!fy(e))throw Error(se(200));return py(null,t,e,!0,n)};Ji.hydrateRoot=function(t,e,n){if(!dk(t))throw Error(se(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=f2;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=h2(e,null,t,1,n??null,r,!1,s,o),t[Eo]=e.current,zh(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new hy(e)};Ji.render=function(t,e,n){if(!fy(e))throw Error(se(200));return py(null,t,e,!1,n)};Ji.unmountComponentAtNode=function(t){if(!fy(t))throw Error(se(40));return t._reactRootContainer?(Kl(function(){py(null,null,t,!1,function(){t._reactRootContainer=null,t[Eo]=null})}),!0):!1};Ji.unstable_batchedUpdates=rk;Ji.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!fy(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return py(t,e,n,!1,i)};Ji.version="18.3.1-next-f1338f8080-20240426";function p2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p2)}catch(t){console.error(t)}}p2(),pM.exports=Ji;var jo=pM.exports;const e6=Jc(jo);var NA=jo;Ib.createRoot=NA.createRoot,Ib.hydrateRoot=NA.hydrateRoot;function fe(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function ls(t,e=[]){let n=[];function i(s,o){const a=S.createContext(o),l=n.length;n=[...n,o];function u(d){const{scope:h,children:f,...p}=d,m=(h==null?void 0:h[t][l])||a,w=S.useMemo(()=>p,Object.values(p));return g.jsx(m.Provider,{value:w,children:f})}function c(d,h){const f=(h==null?void 0:h[t][l])||a,p=S.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return u.displayName=s+"Provider",[u,c]}const r=()=>{const s=n.map(o=>S.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return S.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[i,t6(r,...e)]}function t6(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const i=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=i.reduce((a,{useScope:l,scopeName:u})=>{const d=l(s)[`__scope${u}`];return{...a,...d}},{});return S.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function n6(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function my(...t){return e=>t.forEach(n=>n6(n,e))}function rt(...t){return S.useCallback(my(...t),t)}var Xl=S.forwardRef((t,e)=>{const{children:n,...i}=t,r=S.Children.toArray(n),s=r.find(r6);if(s){const o=s.props.children,a=r.map(l=>l===s?S.Children.count(o)>1?S.Children.only(null):S.isValidElement(o)?o.props.children:null:l);return g.jsx(Px,{...i,ref:e,children:S.isValidElement(o)?S.cloneElement(o,void 0,a):null})}return g.jsx(Px,{...i,ref:e,children:n})});Xl.displayName="Slot";var Px=S.forwardRef((t,e)=>{const{children:n,...i}=t;if(S.isValidElement(n)){const r=o6(n);return S.cloneElement(n,{...s6(i,n.props),ref:e?my(e,r):r})}return S.Children.count(n)>1?S.Children.only(null):null});Px.displayName="SlotClone";var i6=({children:t})=>g.jsx(g.Fragment,{children:t});function r6(t){return S.isValidElement(t)&&t.type===i6}function s6(t,e){const n={...e};for(const i in e){const r=t[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?n[i]=(...a)=>{s(...a),r(...a)}:r&&(n[i]=r):i==="style"?n[i]={...r,...s}:i==="className"&&(n[i]=[r,s].filter(Boolean).join(" "))}return{...t,...n}}function o6(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Gf(t){const e=t+"CollectionProvider",[n,i]=ls(e),[r,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=f=>{const{scope:p,children:m}=f,w=pn.useRef(null),v=pn.useRef(new Map).current;return g.jsx(r,{scope:p,itemMap:v,collectionRef:w,children:m})};o.displayName=e;const a=t+"CollectionSlot",l=pn.forwardRef((f,p)=>{const{scope:m,children:w}=f,v=s(a,m),y=rt(p,v.collectionRef);return g.jsx(Xl,{ref:y,children:w})});l.displayName=a;const u=t+"CollectionItemSlot",c="data-radix-collection-item",d=pn.forwardRef((f,p)=>{const{scope:m,children:w,...v}=f,y=pn.useRef(null),b=rt(p,y),k=s(u,m);return pn.useEffect(()=>(k.itemMap.set(y,{ref:y,...v}),()=>void k.itemMap.delete(y))),g.jsx(Xl,{[c]:"",ref:b,children:w})});d.displayName=u;function h(f){const p=s(t+"CollectionConsumer",f);return pn.useCallback(()=>{const w=p.collectionRef.current;if(!w)return[];const v=Array.from(w.querySelectorAll(`[${c}]`));return Array.from(p.itemMap.values()).sort((k,_)=>v.indexOf(k.ref.current)-v.indexOf(_.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:o,Slot:l,ItemSlot:d},h,i]}var Hn=globalThis!=null&&globalThis.document?S.useLayoutEffect:()=>{},a6=hS.useId||(()=>{}),l6=0;function Fa(t){const[e,n]=S.useState(a6());return Hn(()=>{n(i=>i??String(l6++))},[t]),e?`radix-${e}`:""}var u6=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Fe=u6.reduce((t,e)=>{const n=S.forwardRef((i,r)=>{const{asChild:s,...o}=i,a=s?Xl:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),g.jsx(a,{...o,ref:r})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function hk(t,e){t&&jo.flushSync(()=>t.dispatchEvent(e))}function Wn(t){const e=S.useRef(t);return S.useEffect(()=>{e.current=t}),S.useMemo(()=>(...n)=>{var i;return(i=e.current)==null?void 0:i.call(e,...n)},[])}function To({prop:t,defaultProp:e,onChange:n=()=>{}}){const[i,r]=c6({defaultProp:e,onChange:n}),s=t!==void 0,o=s?t:i,a=Wn(n),l=S.useCallback(u=>{if(s){const d=typeof u=="function"?u(t):u;d!==t&&a(d)}else r(u)},[s,t,r,a]);return[o,l]}function c6({defaultProp:t,onChange:e}){const n=S.useState(t),[i]=n,r=S.useRef(i),s=Wn(e);return S.useEffect(()=>{r.current!==i&&(s(i),r.current=i)},[i,r,s]),n}var d6=S.createContext(void 0);function Kf(t){const e=S.useContext(d6);return t||e||"ltr"}var X0="rovingFocusGroup.onEntryFocus",h6={bubbles:!1,cancelable:!0},gy="RovingFocusGroup",[Tx,m2,f6]=Gf(gy),[p6,vy]=ls(gy,[f6]),[m6,g6]=p6(gy),g2=S.forwardRef((t,e)=>g.jsx(Tx.Provider,{scope:t.__scopeRovingFocusGroup,children:g.jsx(Tx.Slot,{scope:t.__scopeRovingFocusGroup,children:g.jsx(v6,{...t,ref:e})})}));g2.displayName=gy;var v6=S.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:r=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:c=!1,...d}=t,h=S.useRef(null),f=rt(e,h),p=Kf(s),[m=null,w]=To({prop:o,defaultProp:a,onChange:l}),[v,y]=S.useState(!1),b=Wn(u),k=m2(n),_=S.useRef(!1),[E,A]=S.useState(0);return S.useEffect(()=>{const P=h.current;if(P)return P.addEventListener(X0,b),()=>P.removeEventListener(X0,b)},[b]),g.jsx(m6,{scope:n,orientation:i,dir:p,loop:r,currentTabStopId:m,onItemFocus:S.useCallback(P=>w(P),[w]),onItemShiftTab:S.useCallback(()=>y(!0),[]),onFocusableItemAdd:S.useCallback(()=>A(P=>P+1),[]),onFocusableItemRemove:S.useCallback(()=>A(P=>P-1),[]),children:g.jsx(Fe.div,{tabIndex:v||E===0?-1:0,"data-orientation":i,...d,ref:f,style:{outline:"none",...t.style},onMouseDown:fe(t.onMouseDown,()=>{_.current=!0}),onFocus:fe(t.onFocus,P=>{const D=!_.current;if(P.target===P.currentTarget&&D&&!v){const L=new CustomEvent(X0,h6);if(P.currentTarget.dispatchEvent(L),!L.defaultPrevented){const B=k().filter(Q=>Q.focusable),$=B.find(Q=>Q.active),J=B.find(Q=>Q.id===m),G=[$,J,...B].filter(Boolean).map(Q=>Q.ref.current);w2(G,c)}}_.current=!1}),onBlur:fe(t.onBlur,()=>y(!1))})})}),v2="RovingFocusGroupItem",y2=S.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:r=!1,tabStopId:s,...o}=t,a=Fa(),l=s||a,u=g6(v2,n),c=u.currentTabStopId===l,d=m2(n),{onFocusableItemAdd:h,onFocusableItemRemove:f}=u;return S.useEffect(()=>{if(i)return h(),()=>f()},[i,h,f]),g.jsx(Tx.ItemSlot,{scope:n,id:l,focusable:i,active:r,children:g.jsx(Fe.span,{tabIndex:c?0:-1,"data-orientation":u.orientation,...o,ref:e,onMouseDown:fe(t.onMouseDown,p=>{i?u.onItemFocus(l):p.preventDefault()}),onFocus:fe(t.onFocus,()=>u.onItemFocus(l)),onKeyDown:fe(t.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){u.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const m=b6(p,u.orientation,u.dir);if(m!==void 0){if(p.metaKey||p.ctrlKey||p.altKey||p.shiftKey)return;p.preventDefault();let v=d().filter(y=>y.focusable).map(y=>y.ref.current);if(m==="last")v.reverse();else if(m==="prev"||m==="next"){m==="prev"&&v.reverse();const y=v.indexOf(p.currentTarget);v=u.loop?x6(v,y+1):v.slice(y+1)}setTimeout(()=>w2(v))}})})})});y2.displayName=v2;var y6={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function w6(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function b6(t,e,n){const i=w6(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return y6[i]}function w2(t,e=!1){const n=document.activeElement;for(const i of t)if(i===n||(i.focus({preventScroll:e}),document.activeElement!==n))return}function x6(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var b2=g2,x2=y2;function S6(t,e){return S.useReducer((n,i)=>e[n][i]??n,t)}var Fo=t=>{const{present:e,children:n}=t,i=k6(e),r=typeof n=="function"?n({present:i.isPresent}):S.Children.only(n),s=rt(i.ref,_6(r));return typeof n=="function"||i.isPresent?S.cloneElement(r,{ref:s}):null};Fo.displayName="Presence";function k6(t){const[e,n]=S.useState(),i=S.useRef({}),r=S.useRef(t),s=S.useRef("none"),o=t?"mounted":"unmounted",[a,l]=S6(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return S.useEffect(()=>{const u=Vp(i.current);s.current=a==="mounted"?u:"none"},[a]),Hn(()=>{const u=i.current,c=r.current;if(c!==t){const h=s.current,f=Vp(u);t?l("MOUNT"):f==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&h!==f?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),Hn(()=>{if(e){const u=d=>{const f=Vp(i.current).includes(d.animationName);d.target===e&&f&&jo.flushSync(()=>l("ANIMATION_END"))},c=d=>{d.target===e&&(s.current=Vp(i.current))};return e.addEventListener("animationstart",c),e.addEventListener("animationcancel",u),e.addEventListener("animationend",u),()=>{e.removeEventListener("animationstart",c),e.removeEventListener("animationcancel",u),e.removeEventListener("animationend",u)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:S.useCallback(u=>{u&&(i.current=getComputedStyle(u)),n(u)},[])}}function Vp(t){return(t==null?void 0:t.animationName)||"none"}function _6(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var fk="Tabs",[C6,Gse]=ls(fk,[vy]),S2=vy(),[E6,pk]=C6(fk),k2=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,onValueChange:r,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...u}=t,c=Kf(a),[d,h]=To({prop:i,onChange:r,defaultProp:s});return g.jsx(E6,{scope:n,baseId:Fa(),value:d,onValueChange:h,orientation:o,dir:c,activationMode:l,children:g.jsx(Fe.div,{dir:c,"data-orientation":o,...u,ref:e})})});k2.displayName=fk;var _2="TabsList",C2=S.forwardRef((t,e)=>{const{__scopeTabs:n,loop:i=!0,...r}=t,s=pk(_2,n),o=S2(n);return g.jsx(b2,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:i,children:g.jsx(Fe.div,{role:"tablist","aria-orientation":s.orientation,...r,ref:e})})});C2.displayName=_2;var E2="TabsTrigger",Rx=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,disabled:r=!1,...s}=t,o=pk(E2,n),a=S2(n),l=P2(o.baseId,i),u=T2(o.baseId,i),c=i===o.value;return g.jsx(x2,{asChild:!0,...a,focusable:!r,active:c,children:g.jsx(Fe.button,{type:"button",role:"tab","aria-selected":c,"aria-controls":u,"data-state":c?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:l,...s,ref:e,onMouseDown:fe(t.onMouseDown,d=>{!r&&d.button===0&&d.ctrlKey===!1?o.onValueChange(i):d.preventDefault()}),onKeyDown:fe(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(i)}),onFocus:fe(t.onFocus,()=>{const d=o.activationMode!=="manual";!c&&!r&&d&&o.onValueChange(i)})})})});Rx.displayName=E2;var A2="TabsContent",Xm=S.forwardRef((t,e)=>{const{__scopeTabs:n,value:i,forceMount:r,children:s,...o}=t,a=pk(A2,n),l=P2(a.baseId,i),u=T2(a.baseId,i),c=i===a.value,d=S.useRef(c);return S.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),g.jsx(Fo,{present:r||c,children:({present:h})=>g.jsx(Fe.div,{"data-state":c?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:h&&s})})});Xm.displayName=A2;function P2(t,e){return`${t}-trigger-${e}`}function T2(t,e){return`${t}-content-${e}`}var $r={BASE_URL:"/VonSim8/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};let A6=0;function Ae(t,e){const n=`atom${++A6}`,i={toString(){return($r?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof t=="function"?i.read=t:(i.init=t,i.read=P6,i.write=T6),e&&(i.write=e),i}function P6(t){return t(this)}function T6(t,e,n){return e(this,typeof n=="function"?n(t(this)):n)}const MA=(t,e)=>t.unstable_is?t.unstable_is(e):e===t,q0=t=>"init"in t,Y0=t=>!!t.write,gh=Symbol(($r?"production":void 0)!=="production"?"CONTINUE_PROMISE":""),mk="pending",R6="fulfilled",N6="rejected",M6=t=>typeof t=="object"&&t!==null&&gh in t,Hp=new WeakMap,O6=(t,e,n)=>{if(!Hp.has(t)){let i;const r=new Promise((s,o)=>{let a=t;const l=c=>d=>{a===c&&(r.status=R6,r.value=d,s(d),n())},u=c=>d=>{a===c&&(r.status=N6,r.reason=d,o(d),n())};t.then(l(t),u(t)),i=(c,d)=>{c&&(Hp.set(c,r),a=c,c.then(l(c),u(c)),e(),e=d)}});r.status=mk,r[gh]=i,Hp.set(t,r)}return Hp.get(t)},D6=t=>typeof(t==null?void 0:t.then)=="function",OA=t=>"v"in t||"e"in t,Wp=t=>{if("e"in t)throw t.e;if(($r?"production":void 0)!=="production"&&!("v"in t))throw new Error("[Bug] atom state is not initialized");return t.v},Gp=t=>{const e=t.v;return M6(e)&&e.status===mk?e:null},DA=(t,e,n)=>{n.p.has(t)||(n.p.add(t),e.then(()=>{n.p.delete(t)},()=>{n.p.delete(t)}))},fu=()=>[new Map,new Map,new Set],J0=(t,e,n)=>{t[0].has(e)||t[0].set(e,new Set),t[1].set(e,n)},I6=(t,e,n)=>{const i=t[0].get(e);i&&i.add(n)},L6=(t,e)=>t[0].get(e),IA=(t,e)=>{t[2].add(e)},gl=t=>{for(;t[1].size||t[2].size;){t[0].clear();const e=new Set(t[1].values());t[1].clear();const n=new Set(t[2]);t[2].clear(),e.forEach(i=>{var r;return(r=i.m)==null?void 0:r.l.forEach(s=>s())}),n.forEach(i=>i())}},gk=()=>{const t=new WeakMap;let e;($r?"production":void 0)!=="production"&&(e=new Set);const n=m=>{let w=t.get(m);return w||(w={d:new Map,p:new Set,n:0},t.set(m,w)),w},i=(m,w,v,y=()=>{},b=()=>{})=>{const k="v"in w,_=w.v,E=Gp(w);if(D6(v))if(E)E!==v&&(E[gh](v,y),++w.n);else{const A=O6(v,y,b);if(A.status===mk)for(const P of w.d.keys()){const D=n(P);DA(m,A,D)}w.v=A,delete w.e}else E&&E[gh](Promise.resolve(v),y),w.v=v,delete w.e;(!k||!Object.is(_,w.v))&&++w.n},r=(m,w,v,y)=>{var b;if(($r?"production":void 0)!=="production"&&v===w)throw new Error("[Bug] atom cannot depend on itself");const k=n(w);k.d.set(v,y.n);const _=Gp(k);_&&DA(w,_,y),(b=y.m)==null||b.t.add(w),m&&I6(m,v,w)},s=(m,w,v)=>{const y=n(w);if(!(v!=null&&v(w))&&OA(y)&&(y.m||Array.from(y.d).every(([P,D])=>s(m,P,v).n===D)))return y;y.d.clear();let b=!0;const k=P=>{if(MA(w,P)){const L=n(P);if(!OA(L))if(q0(P))i(P,L,P.init);else throw new Error("no atom init");return Wp(L)}const D=s(m,P,v);if(b)r(m,w,P,D);else{const L=fu();r(L,w,P,D),c(L,w,y),gl(L)}return Wp(D)};let _,E;const A={get signal(){return _||(_=new AbortController),_.signal},get setSelf(){return($r?"production":void 0)!=="production"&&!Y0(w)&&console.warn("setSelf function cannot be used with read-only atom"),!E&&Y0(w)&&(E=(...P)=>{if(($r?"production":void 0)!=="production"&&b&&console.warn("setSelf function cannot be called in sync"),!b)return u(w,...P)}),E}};try{const P=w.read(k,A);return i(w,y,P,()=>_==null?void 0:_.abort(),()=>{if(y.m){const D=fu();c(D,w,y),gl(D)}}),y}catch(P){return delete y.v,y.e=P,++y.n,y}finally{b=!1}},o=m=>Wp(s(void 0,m)),a=(m,w)=>{const v=A=>{var P,D;const L=n(A),B=new Set((P=L.m)==null?void 0:P.t);for(const $ of L.p)B.add($);return(D=L6(m,A))==null||D.forEach($=>{B.add($)}),B},y=[],b=new Set,k=A=>{if(!b.has(A)){b.add(A);for(const P of v(A))A!==P&&k(P);y.push(A)}};k(w);const _=new Set([w]),E=A=>b.has(A);for(let A=y.length-1;A>=0;--A){const P=y[A],D=n(P),L=D.n;let B=!1;for(const $ of D.d.keys())if($!==P&&_.has($)){B=!0;break}B&&(s(m,P,E),c(m,P,D),L!==D.n&&(J0(m,P,D),_.add(P))),b.delete(P)}},l=(m,w,...v)=>{const y=_=>Wp(s(m,_)),b=(_,...E)=>{let A;if(MA(w,_)){if(!q0(_))throw new Error("atom not writable");const P=n(_),D="v"in P,L=P.v,B=E[0];i(_,P,B),c(m,_,P),(!D||!Object.is(L,P.v))&&(J0(m,_,P),a(m,_))}else A=l(m,_,...E);return gl(m),A};return w.write(y,b,...v)},u=(m,...w)=>{const v=fu(),y=l(v,m,...w);return gl(v),y},c=(m,w,v)=>{if(v.m&&!Gp(v)){for(const y of v.d.keys())v.m.d.has(y)||(d(m,y).t.add(w),v.m.d.add(y));for(const y of v.m.d||[])if(!v.d.has(y)){v.m.d.delete(y);const b=h(m,y);b==null||b.t.delete(w)}}},d=(m,w)=>{const v=n(w);if(!v.m){s(m,w);for(const y of v.d.keys())d(m,y).t.add(w);if(v.m={l:new Set,d:new Set(v.d.keys()),t:new Set},($r?"production":void 0)!=="production"&&e.add(w),Y0(w)&&w.onMount){const y=v.m,{onMount:b}=w;IA(m,()=>{const k=b((..._)=>l(m,w,..._));k&&(y.u=k)})}}return v.m},h=(m,w)=>{const v=n(w);if(v.m&&!v.m.l.size&&!Array.from(v.m.t).some(y=>{var b;return(b=n(y).m)==null?void 0:b.d.has(w)})){const y=v.m.u;y&&IA(m,y),delete v.m,($r?"production":void 0)!=="production"&&e.delete(w);for(const k of v.d.keys()){const _=h(m,k);_==null||_.t.delete(w)}const b=Gp(v);b&&b[gh](void 0,()=>{});return}return v.m},p={get:o,set:u,sub:(m,w)=>{const v=fu(),y=d(v,m);gl(v);const b=y.l;return b.add(w),()=>{b.delete(w);const k=fu();h(k,m),gl(k)}}};return($r?"production":void 0)!=="production"&&Object.assign(p,{dev4_get_internal_weak_map:()=>t,dev4_get_mounted_atoms:()=>e,dev4_restore_atoms:w=>{const v=fu();for(const[y,b]of w)if(q0(y)){const k=n(y),_="v"in k,E=k.v;i(y,k,b),c(v,y,k),(!_||!Object.is(E,k.v))&&(J0(v,y,k),a(v,y))}gl(v)}}),p};let Sd;const j6=()=>(Sd||(Sd=gk(),($r?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=Sd),globalThis.__JOTAI_DEFAULT_STORE__!==Sd&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),Sd);var F6={BASE_URL:"/VonSim8/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};const R2=S.createContext(void 0),N2=t=>S.useContext(R2)||j6(),B6=({children:t,store:e})=>{const n=S.useRef();return!e&&!n.current&&(n.current=gk()),S.createElement(R2.Provider,{value:e||n.current},t)},$6=t=>typeof(t==null?void 0:t.then)=="function",z6=pn.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)});function qt(t,e){const n=N2(),[[i,r,s],o]=S.useReducer(u=>{const c=n.get(t);return Object.is(u[0],c)&&u[1]===n&&u[2]===t?u:[c,n,t]},void 0,()=>[n.get(t),n,t]);let a=i;return(r!==n||s!==t)&&(o(),a=n.get(t)),S.useEffect(()=>{const u=n.sub(t,()=>{o()});return o(),u},[n,t,void 0]),S.useDebugValue(a),$6(a)?z6(a):a}function M2(t,e){const n=N2();return S.useCallback((...r)=>{if((F6?"production":void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return n.set(t,...r)},[n,t])}function td(t,e){return[qt(t),M2(t)]}const{createElement:Mc,createContext:U6,createRef:Kse,forwardRef:O2,useCallback:hi,useContext:D2,useEffect:Fl,useImperativeHandle:I2,useLayoutEffect:V6,useMemo:H6,useRef:$i,useState:Qg}=hS,LA=hS.useId,yy=U6(null);yy.displayName="PanelGroupContext";const Yh=V6,W6=typeof LA=="function"?LA:()=>null;let G6=0;function vk(t=null){const e=W6(),n=$i(t||e||null);return n.current===null&&(n.current=""+G6++),t??n.current}function L2({children:t,className:e="",collapsedSize:n,collapsible:i,defaultSize:r,forwardedRef:s,id:o,maxSize:a,minSize:l,onCollapse:u,onExpand:c,onResize:d,order:h,style:f,tagName:p="div",...m}){const w=D2(yy);if(w===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:v,expandPanel:y,getPanelSize:b,getPanelStyle:k,groupId:_,isPanelCollapsed:E,reevaluatePanelConstraints:A,registerPanel:P,resizePanel:D,unregisterPanel:L}=w,B=vk(o),$=$i({callbacks:{onCollapse:u,onExpand:c,onResize:d},constraints:{collapsedSize:n,collapsible:i,defaultSize:r,maxSize:a,minSize:l},id:B,idIsFromProps:o!==void 0,order:h});$i({didLogMissingDefaultSizeWarning:!1}),Yh(()=>{const{callbacks:z,constraints:G}=$.current,Q={...G};$.current.id=B,$.current.idIsFromProps=o!==void 0,$.current.order=h,z.onCollapse=u,z.onExpand=c,z.onResize=d,G.collapsedSize=n,G.collapsible=i,G.defaultSize=r,G.maxSize=a,G.minSize=l,(Q.collapsedSize!==G.collapsedSize||Q.collapsible!==G.collapsible||Q.maxSize!==G.maxSize||Q.minSize!==G.minSize)&&A($.current,Q)}),Yh(()=>{const z=$.current;return P(z),()=>{L(z)}},[h,B,P,L]),I2(s,()=>({collapse:()=>{v($.current)},expand:()=>{y($.current)},getId(){return B},getSize(){return b($.current)},isCollapsed(){return E($.current)},isExpanded(){return!E($.current)},resize:z=>{D($.current,z)}}),[v,y,b,E,B,D]);const J=k($.current,r);return Mc(p,{...m,children:t,className:e,style:{...J,...f},"data-panel":"","data-panel-id":B,"data-panel-group-id":_,"data-panel-collapsible":void 0,"data-panel-size":void 0})}const qm=O2((t,e)=>Mc(L2,{...t,forwardedRef:e}));L2.displayName="Panel";qm.displayName="forwardRef(Panel)";function Ve(t,e="Assertion failed!"){if(!t)throw console.error(e),Error(e)}const j2=10;function Jh(t,e,n=j2){t=parseFloat(t.toFixed(n)),e=parseFloat(e.toFixed(n));const i=t-e;return i===0?0:i>0?1:-1}function ji(t,e,n){return Jh(t,e,n)===0}function Hu({panelConstraints:t,panelIndex:e,size:n}){const i=t[e];Ve(i!=null);let{collapsedSize:r=0,collapsible:s,maxSize:o=100,minSize:a=0}=i;if(Jh(n,a)<0)if(s){const l=(r+a)/2;Jh(n,l)<0?n=r:n=a}else n=a;return n=Math.min(o,n),n=parseFloat(n.toFixed(j2)),n}function Hd({delta:t,layout:e,panelConstraints:n,pivotIndices:i,trigger:r}){if(ji(t,0))return e;const s=[...e],[o,a]=i;Ve(o!=null),Ve(a!=null);let l=0;if(r==="keyboard"){{const c=t<0?a:o,d=n[c];if(Ve(d),d.collapsible){const h=e[c];Ve(h!=null);const f=n[c];Ve(f);const{collapsedSize:p=0,minSize:m=0}=f;if(ji(h,p)){const w=m-h;Jh(w,Math.abs(t))>0&&(t=t<0?0-w:w)}}}{const c=t<0?o:a,d=n[c];Ve(d);const{collapsible:h}=d;if(h){const f=e[c];Ve(f!=null);const p=n[c];Ve(p);const{collapsedSize:m=0,minSize:w=0}=p;if(ji(f,w)){const v=f-m;Jh(v,Math.abs(t))>0&&(t=t<0?0-v:v)}}}}{const c=t<0?1:-1;let d=t<0?a:o,h=0;for(;;){const p=e[d];Ve(p!=null);const w=Hu({panelConstraints:n,panelIndex:d,size:100})-p;if(h+=w,d+=c,d<0||d>=n.length)break}const f=Math.min(Math.abs(t),Math.abs(h));t=t<0?0-f:f}{let d=t<0?o:a;for(;d>=0&&d<n.length;){const h=Math.abs(t)-Math.abs(l),f=e[d];Ve(f!=null);const p=f-h,m=Hu({panelConstraints:n,panelIndex:d,size:p});if(!ji(f,m)&&(l+=f-m,s[d]=m,l.toPrecision(3).localeCompare(Math.abs(t).toPrecision(3),void 0,{numeric:!0})>=0))break;t<0?d--:d++}}if(ji(l,0))return e;{const c=t<0?a:o,d=e[c];Ve(d!=null);const h=d+l,f=Hu({panelConstraints:n,panelIndex:c,size:h});if(s[c]=f,!ji(f,h)){let p=h-f,w=t<0?a:o;for(;w>=0&&w<n.length;){const v=s[w];Ve(v!=null);const y=v+p,b=Hu({panelConstraints:n,panelIndex:w,size:y});if(ji(v,b)||(p-=b-v,s[w]=b),ji(p,0))break;t>0?w--:w++}}}const u=s.reduce((c,d)=>d+c,0);return ji(u,100)?s:e}function K6({layout:t,panelsArray:e,pivotIndices:n}){let i=0,r=100,s=0,o=0;const a=n[0];Ve(a!=null),e.forEach((d,h)=>{const{constraints:f}=d,{maxSize:p=100,minSize:m=0}=f;h===a?(i=m,r=p):(s+=m,o+=p)});const l=Math.min(r,100-s),u=Math.max(i,100-o),c=t[a];return{valueMax:l,valueMin:u,valueNow:c}}function Zh(t,e=document){return Array.from(e.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${t}"]`))}function F2(t,e,n=document){const r=Zh(t,n).findIndex(s=>s.getAttribute("data-panel-resize-handle-id")===e);return r??null}function B2(t,e,n){const i=F2(t,e,n);return i!=null?[i,i+1]:[-1,-1]}function $2(t,e=document){var n;if(e instanceof HTMLElement&&(e==null||(n=e.dataset)===null||n===void 0?void 0:n.panelGroupId)==t)return e;const i=e.querySelector(`[data-panel-group][data-panel-group-id="${t}"]`);return i||null}function wy(t,e=document){const n=e.querySelector(`[data-panel-resize-handle-id="${t}"]`);return n||null}function X6(t,e,n,i=document){var r,s,o,a;const l=wy(e,i),u=Zh(t,i),c=l?u.indexOf(l):-1,d=(r=(s=n[c])===null||s===void 0?void 0:s.id)!==null&&r!==void 0?r:null,h=(o=(a=n[c+1])===null||a===void 0?void 0:a.id)!==null&&o!==void 0?o:null;return[d,h]}function q6({committedValuesRef:t,eagerValuesRef:e,groupId:n,layout:i,panelDataArray:r,panelGroupElement:s,setLayout:o}){$i({didWarnAboutMissingResizeHandle:!1}),Yh(()=>{if(!s)return;const a=Zh(n,s);for(let l=0;l<r.length-1;l++){const{valueMax:u,valueMin:c,valueNow:d}=K6({layout:i,panelsArray:r,pivotIndices:[l,l+1]}),h=a[l];if(h!=null){const f=r[l];Ve(f),h.setAttribute("aria-controls",f.id),h.setAttribute("aria-valuemax",""+Math.round(u)),h.setAttribute("aria-valuemin",""+Math.round(c)),h.setAttribute("aria-valuenow",d!=null?""+Math.round(d):"")}}return()=>{a.forEach((l,u)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[n,i,r,s]),Fl(()=>{if(!s)return;const a=e.current;Ve(a);const{panelDataArray:l}=a,u=$2(n,s);Ve(u!=null,`No group found for id "${n}"`);const c=Zh(n,s);Ve(c);const d=c.map(h=>{const f=h.getAttribute("data-panel-resize-handle-id");Ve(f);const[p,m]=X6(n,f,l,s);if(p==null||m==null)return()=>{};const w=v=>{if(!v.defaultPrevented)switch(v.key){case"Enter":{v.preventDefault();const y=l.findIndex(b=>b.id===p);if(y>=0){const b=l[y];Ve(b);const k=i[y],{collapsedSize:_=0,collapsible:E,minSize:A=0}=b.constraints;if(k!=null&&E){const P=Hd({delta:ji(k,_)?A-_:_-k,layout:i,panelConstraints:l.map(D=>D.constraints),pivotIndices:B2(n,f,s),trigger:"keyboard"});i!==P&&o(P)}}break}}};return h.addEventListener("keydown",w),()=>{h.removeEventListener("keydown",w)}});return()=>{d.forEach(h=>h())}},[s,t,e,n,i,r,o])}function jA(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function z2(t){return t.type==="keydown"}function U2(t){return t.type.startsWith("mouse")}function V2(t){return t.type.startsWith("touch")}function H2(t,e){const n=t==="horizontal";if(U2(e))return n?e.clientX:e.clientY;if(V2(e)){const i=e.touches[0];return Ve(i),n?i.screenX:i.screenY}else throw Error(`Unsupported event type "${e.type}"`)}function Y6(t,e,n,i,r){const s=n==="horizontal",o=wy(e,r);Ve(o);const a=o.getAttribute("data-panel-group-id");Ve(a);let{initialCursorPosition:l}=i;const u=H2(n,t),c=$2(a,r);Ve(c);const d=c.getBoundingClientRect(),h=s?d.width:d.height;return(u-l)/h*100}function J6(t,e,n,i,r,s){if(z2(t)){const o=n==="horizontal";let a=0;t.shiftKey?a=100:r!=null?a=r:a=10;let l=0;switch(t.key){case"ArrowDown":l=o?0:a;break;case"ArrowLeft":l=o?-a:0;break;case"ArrowRight":l=o?a:0;break;case"ArrowUp":l=o?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return i==null?0:Y6(t,e,n,i,s)}function Z6({panelDataArray:t}){const e=Array(t.length),n=t.map(s=>s.constraints);let i=0,r=100;for(let s=0;s<t.length;s++){const o=n[s];Ve(o);const{defaultSize:a}=o;a!=null&&(i++,e[s]=a,r-=a)}for(let s=0;s<t.length;s++){const o=n[s];Ve(o);const{defaultSize:a}=o;if(a!=null)continue;const l=t.length-i,u=r/l;i++,e[s]=u,r-=u}return e}function pu(t,e,n){e.forEach((i,r)=>{const s=t[r];Ve(s);const{callbacks:o,constraints:a,id:l}=s,{collapsedSize:u=0,collapsible:c}=a,d=n[l];if(d==null||i!==d){n[l]=i;const{onCollapse:h,onExpand:f,onResize:p}=o;p&&p(i,d),c&&(h||f)&&(f&&(d==null||d===u)&&i!==u&&f(),h&&(d==null||d!==u)&&i===u&&h())}})}function Kp(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n])return!1;return!0}function Q6({defaultSize:t,dragState:e,layout:n,panelData:i,panelIndex:r,precision:s=3}){const o=n[r];let a;return o==null?a=t??"1":i.length===1?a="1":a=o.toPrecision(s),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}let Nx=null,Ol=null;function W2(t){switch(t){case"horizontal":return"ew-resize";case"horizontal-max":return"w-resize";case"horizontal-min":return"e-resize";case"vertical":return"ns-resize";case"vertical-max":return"n-resize";case"vertical-min":return"s-resize"}}function eU(){Ol!==null&&(document.head.removeChild(Ol),Nx=null,Ol=null)}function Z0(t){if(Nx===t)return;Nx=t;const e=W2(t);Ol===null&&(Ol=document.createElement("style"),document.head.appendChild(Ol)),Ol.innerHTML=`*{cursor: ${e}!important;}`}function tU(t,e=10){let n=null;return(...r)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{t(...r)},e)}}function FA(t){try{if(typeof localStorage<"u")t.getItem=e=>localStorage.getItem(e),t.setItem=(e,n)=>{localStorage.setItem(e,n)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),t.getItem=()=>null,t.setItem=()=>{}}}function G2(t){return`react-resizable-panels:${t}`}function K2(t){return t.map(e=>{const{constraints:n,id:i,idIsFromProps:r,order:s}=e;return r?i:s?`${s}:${JSON.stringify(n)}`:JSON.stringify(n)}).sort((e,n)=>e.localeCompare(n)).join(",")}function X2(t,e){try{const n=G2(t),i=e.getItem(n);if(i){const r=JSON.parse(i);if(typeof r=="object"&&r!=null)return r}}catch{}return null}function nU(t,e,n){var i,r;const s=(i=X2(t,n))!==null&&i!==void 0?i:{},o=K2(e);return(r=s[o])!==null&&r!==void 0?r:null}function iU(t,e,n,i,r){var s;const o=G2(t),a=K2(e),l=(s=X2(t,r))!==null&&s!==void 0?s:{};l[a]={expandToSizes:Object.fromEntries(n.entries()),layout:i};try{r.setItem(o,JSON.stringify(l))}catch(u){console.error(u)}}function BA({layout:t,panelConstraints:e}){const n=[...t],i=n.reduce((s,o)=>s+o,0);if(n.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${n.map(s=>`${s}%`).join(", ")}`);if(!ji(i,100))for(let s=0;s<e.length;s++){const o=n[s];Ve(o!=null);const a=100/i*o;n[s]=a}let r=0;for(let s=0;s<e.length;s++){const o=n[s];Ve(o!=null);const a=Hu({panelConstraints:e,panelIndex:s,size:o});o!=a&&(r+=o-a,n[s]=a)}if(!ji(r,0))for(let s=0;s<e.length;s++){const o=n[s];Ve(o!=null);const a=o+r,l=Hu({panelConstraints:e,panelIndex:s,size:a});if(o!==l&&(r-=l-o,n[s]=l,ji(r,0)))break}return n}const rU=100,Wd={getItem:t=>(FA(Wd),Wd.getItem(t)),setItem:(t,e)=>{FA(Wd),Wd.setItem(t,e)}},$A={};function q2({autoSaveId:t=null,children:e,className:n="",direction:i,forwardedRef:r,id:s=null,onLayout:o=null,keyboardResizeBy:a=null,storage:l=Wd,style:u,tagName:c="div",...d}){const h=vk(s),f=$i(null),[p,m]=Qg(null),[w,v]=Qg([]),y=$i({}),b=$i(new Map),k=$i(0),_=$i({autoSaveId:t,direction:i,dragState:p,id:h,keyboardResizeBy:a,onLayout:o,storage:l}),E=$i({layout:w,panelDataArray:[],panelDataArrayChanged:!1});$i({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),I2(r,()=>({getId:()=>_.current.id,getLayout:()=>{const{layout:q}=E.current;return q},setLayout:q=>{const{onLayout:ue}=_.current,{layout:O,panelDataArray:M}=E.current,F=BA({layout:q,panelConstraints:M.map(x=>x.constraints)});jA(O,F)||(v(F),E.current.layout=F,ue&&ue(F),pu(M,F,y.current))}}),[]),Yh(()=>{_.current.autoSaveId=t,_.current.direction=i,_.current.dragState=p,_.current.id=h,_.current.onLayout=o,_.current.storage=l}),q6({committedValuesRef:_,eagerValuesRef:E,groupId:h,layout:w,panelDataArray:E.current.panelDataArray,setLayout:v,panelGroupElement:f.current}),Fl(()=>{const{panelDataArray:q}=E.current;if(t){if(w.length===0||w.length!==q.length)return;let ue=$A[t];ue==null&&(ue=tU(iU,rU),$A[t]=ue);const O=[...q],M=new Map(b.current);ue(t,O,M,w,l)}},[t,w,l]),Fl(()=>{});const A=hi(q=>{const{onLayout:ue}=_.current,{layout:O,panelDataArray:M}=E.current;if(q.constraints.collapsible){const F=M.map(R=>R.constraints),{collapsedSize:x=0,panelSize:T,pivotIndices:N}=vl(M,q,O);if(Ve(T!=null),T!==x){b.current.set(q.id,T);const W=ku(M,q)===M.length-1?T-x:x-T,U=Hd({delta:W,layout:O,panelConstraints:F,pivotIndices:N,trigger:"imperative-api"});Kp(O,U)||(v(U),E.current.layout=U,ue&&ue(U),pu(M,U,y.current))}}},[]),P=hi(q=>{const{onLayout:ue}=_.current,{layout:O,panelDataArray:M}=E.current;if(q.constraints.collapsible){const F=M.map(W=>W.constraints),{collapsedSize:x=0,panelSize:T,minSize:N=0,pivotIndices:R}=vl(M,q,O);if(T===x){const W=b.current.get(q.id),U=W!=null&&W>=N?W:N,K=ku(M,q)===M.length-1?T-U:U-T,Se=Hd({delta:K,layout:O,panelConstraints:F,pivotIndices:R,trigger:"imperative-api"});Kp(O,Se)||(v(Se),E.current.layout=Se,ue&&ue(Se),pu(M,Se,y.current))}}},[]),D=hi(q=>{const{layout:ue,panelDataArray:O}=E.current,{panelSize:M}=vl(O,q,ue);return Ve(M!=null),M},[]),L=hi((q,ue)=>{const{panelDataArray:O}=E.current,M=ku(O,q);return Q6({defaultSize:ue,dragState:p,layout:w,panelData:O,panelIndex:M})},[p,w]),B=hi(q=>{const{layout:ue,panelDataArray:O}=E.current,{collapsedSize:M=0,collapsible:F,panelSize:x}=vl(O,q,ue);return F===!0&&x===M},[]),$=hi(q=>{const{layout:ue,panelDataArray:O}=E.current,{collapsedSize:M=0,collapsible:F,panelSize:x}=vl(O,q,ue);return Ve(x!=null),!F||x>M},[]),J=hi(q=>{const{panelDataArray:ue}=E.current;ue.push(q),ue.sort((O,M)=>{const F=O.order,x=M.order;return F==null&&x==null?0:F==null?-1:x==null?1:F-x}),E.current.panelDataArrayChanged=!0},[]);Yh(()=>{if(E.current.panelDataArrayChanged){E.current.panelDataArrayChanged=!1;const{autoSaveId:q,onLayout:ue,storage:O}=_.current,{layout:M,panelDataArray:F}=E.current;let x=null;if(q){const N=nU(q,F,O);N&&(b.current=new Map(Object.entries(N.expandToSizes)),x=N.layout)}x==null&&(x=Z6({panelDataArray:F}));const T=BA({layout:x,panelConstraints:F.map(N=>N.constraints)});jA(M,T)||(v(T),E.current.layout=T,ue&&ue(T),pu(F,T,y.current))}});const z=hi(q=>function(O){O.preventDefault();const M=f.current;if(!M)return()=>null;const{direction:F,dragState:x,id:T,keyboardResizeBy:N,onLayout:R}=_.current,{layout:W,panelDataArray:U}=E.current,{initialLayout:Z}=x??{},K=B2(T,q,M);let Se=J6(O,q,F,x,N,M);if(Se===0)return;const Oe=F==="horizontal";document.dir==="rtl"&&Oe&&(Se=-Se);const Ie=U.map(he=>he.constraints),Ne=Hd({delta:Se,layout:Z??W,panelConstraints:Ie,pivotIndices:K,trigger:z2(O)?"keyboard":"mouse-or-touch"}),$e=!Kp(W,Ne);(U2(O)||V2(O))&&k.current!=Se&&(k.current=Se,Z0($e?Oe?"horizontal":"vertical":Oe?Se<0?"horizontal-min":"horizontal-max":Se<0?"vertical-min":"vertical-max")),$e&&(v(Ne),E.current.layout=Ne,R&&R(Ne),pu(U,Ne,y.current))},[]),G=hi((q,ue)=>{const{onLayout:O}=_.current,{layout:M,panelDataArray:F}=E.current,x=F.map(Z=>Z.constraints),{panelSize:T,pivotIndices:N}=vl(F,q,M);Ve(T!=null);const W=ku(F,q)===F.length-1?T-ue:ue-T,U=Hd({delta:W,layout:M,panelConstraints:x,pivotIndices:N,trigger:"imperative-api"});Kp(M,U)||(v(U),E.current.layout=U,O&&O(U),pu(F,U,y.current))},[]),Q=hi((q,ue)=>{const{layout:O,panelDataArray:M}=E.current,{collapsedSize:F=0,collapsible:x}=ue,{collapsedSize:T=0,collapsible:N,maxSize:R=100,minSize:W=0}=q.constraints,{panelSize:U}=vl(M,q,O);Ve(U!=null),x&&N&&U===F?F!==T&&G(q,T):U<W?G(q,W):U>R&&G(q,R)},[G]),ie=hi((q,ue)=>{const{direction:O}=_.current,{layout:M}=E.current;if(!f.current)return;const F=wy(q,f.current);Ve(F);const x=H2(O,ue);m({dragHandleId:q,dragHandleRect:F.getBoundingClientRect(),initialCursorPosition:x,initialLayout:M})},[]),H=hi(()=>{eU(),m(null)},[]),j=hi(q=>{const{panelDataArray:ue}=E.current,O=ku(ue,q);O>=0&&(ue.splice(O,1),delete y.current[q.id],E.current.panelDataArrayChanged=!0)},[]),te=H6(()=>({collapsePanel:A,direction:i,dragState:p,expandPanel:P,getPanelSize:D,getPanelStyle:L,groupId:h,isPanelCollapsed:B,isPanelExpanded:$,reevaluatePanelConstraints:Q,registerPanel:J,registerResizeHandle:z,resizePanel:G,startDragging:ie,stopDragging:H,unregisterPanel:j,panelGroupElement:f.current}),[A,p,i,P,D,L,h,B,$,Q,J,z,G,ie,H,j]),pe={display:"flex",flexDirection:i==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return Mc(yy.Provider,{value:te},Mc(c,{...d,children:e,className:n,style:{...pe,...u},ref:f,"data-panel-group":"","data-panel-group-direction":i,"data-panel-group-id":h}))}const Y2=O2((t,e)=>Mc(q2,{...t,forwardedRef:e}));q2.displayName="PanelGroup";Y2.displayName="forwardRef(PanelGroup)";function ku(t,e){return t.findIndex(n=>n===e||n.id===e.id)}function vl(t,e,n){const i=ku(t,e),s=i===t.length-1?[i-1,i]:[i,i+1],o=n[i];return{...e.constraints,panelSize:o,pivotIndices:s}}function sU({disabled:t,handleId:e,resizeHandler:n,panelGroupElement:i}){Fl(()=>{if(t||n==null||i==null)return;const r=wy(e,i);if(r==null)return;const s=o=>{if(!o.defaultPrevented)switch(o.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{o.preventDefault(),n(o);break}case"F6":{o.preventDefault();const a=r.getAttribute("data-panel-group-id");Ve(a);const l=Zh(a,i),u=F2(a,e,i);Ve(u!==null);const c=o.shiftKey?u>0?u-1:l.length-1:u+1<l.length?u+1:0;l[c].focus();break}}};return r.addEventListener("keydown",s),()=>{r.removeEventListener("keydown",s)}},[i,t,e,n])}function Mx({children:t=null,className:e="",disabled:n=!1,id:i,onDragging:r,style:s={},tabIndex:o=0,tagName:a="div",...l}){const u=$i(null),c=$i({onDragging:r});Fl(()=>{c.current.onDragging=r});const d=D2(yy);if(d===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:h,dragState:f,groupId:p,registerResizeHandle:m,startDragging:w,stopDragging:v,panelGroupElement:y}=d,b=vk(i),k=(f==null?void 0:f.dragHandleId)===b,[_,E]=Qg(!1),[A,P]=Qg(null),D=hi(()=>{const B=u.current;Ve(B),B.blur(),v();const{onDragging:$}=c.current;$&&$(!1)},[v]);Fl(()=>{if(n)P(null);else{const B=m(b);P(()=>B)}},[n,b,m]),Fl(()=>{if(n||A==null||!k)return;const B=G=>{A(G)},$=G=>{A(G)},J=u.current;Ve(J);const z=J.ownerDocument;return z.body.addEventListener("contextmenu",D),z.body.addEventListener("mousemove",B),z.body.addEventListener("touchmove",B),z.body.addEventListener("mouseleave",$),window.addEventListener("mouseup",D),window.addEventListener("touchend",D),()=>{z.body.removeEventListener("contextmenu",D),z.body.removeEventListener("mousemove",B),z.body.removeEventListener("touchmove",B),z.body.removeEventListener("mouseleave",$),window.removeEventListener("mouseup",D),window.removeEventListener("touchend",D)}},[h,n,k,A,D]),sU({disabled:n,handleId:b,resizeHandler:A,panelGroupElement:y});const L={cursor:W2(h),touchAction:"none",userSelect:"none"};return Mc(a,{...l,children:t,className:e,onBlur:()=>E(!1),onFocus:()=>E(!0),onMouseDown:B=>{w(b,B.nativeEvent);const $=c.current;Ve($);const{onDragging:J}=$;J&&J(!0)},onMouseUp:D,onTouchCancel:D,onTouchEnd:D,onTouchStart:B=>{w(b,B.nativeEvent);const $=c.current;Ve($);const{onDragging:J}=$;J&&J(!0)},ref:u,role:"separator",style:{...L,...s},tabIndex:o,"data-panel-group-direction":h,"data-panel-group-id":p,"data-resize-handle":"","data-resize-handle-active":k?"pointer":_?"keyboard":void 0,"data-panel-resize-handle-enabled":!n,"data-panel-resize-handle-id":b})}Mx.displayName="PanelResizeHandle";var Cs=function(){return Cs=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Cs.apply(this,arguments)};function J2(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function oU(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}var aU=function(){};function lU(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.addEventListener&&t.addEventListener.apply(t,e)}function uU(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.removeEventListener&&t.removeEventListener.apply(t,e)}var Z2=typeof window<"u",cU=Z2?window:null,zA=function(t){return!!t.addEventListener},UA=function(t){return!!t.on},Ym=function(t,e,n,i){n===void 0&&(n=cU),S.useEffect(function(){if(e&&n)return zA(n)?lU(n,t,e,i):UA(n)&&n.on(t,e,i),function(){zA(n)?uU(n,t,e,i):UA(n)&&n.off(t,e,i)}},[t,e,n,JSON.stringify(i)])},dU=function(t){return typeof t=="function"?t:typeof t=="string"?function(e){return e.key===t}:t?function(){return!0}:function(){return!1}},So=function(t,e,n,i){e===void 0&&(e=aU),n===void 0&&(n={}),i===void 0&&(i=[t]);var r=n.event,s=r===void 0?"keydown":r,o=n.target,a=n.options,l=S.useMemo(function(){var u=dU(t),c=function(d){if(u(d))return e(d)};return c},i);Ym(s,l,o,a)},hU=function(t,e){return Z2?window.matchMedia(t).matches:!1},fU=function(t,e){var n=S.useState(hU(t)),i=n[0],r=n[1];return S.useEffect(function(){var s=!0,o=window.matchMedia(t),a=function(){s&&r(!!o.matches)};return o.addEventListener("change",a),r(o.matches),function(){s=!1,o.removeEventListener("change",a)}},[t]),i};const pU="modulepreload",mU=function(t){return"/VonSim8/"+t},VA={},gU=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=Promise.all(n.map(a=>{if(a=mU(a),a in VA)return;VA[a]=!0;const l=a.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${u}`))return;const c=document.createElement("link");if(c.rel=l?"stylesheet":pU,l||(c.as="script",c.crossOrigin=""),c.href=a,o&&c.setAttribute("nonce",o),document.head.appendChild(c),l)return new Promise((d,h)=>{c.addEventListener("load",d),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})}))}return r.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};function vU(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:s,onRegisterError:o}=t;let a,l,u;const c=async(h=!0)=>{await l,await(u==null?void 0:u())};async function d(){if("serviceWorker"in navigator){if(a=await gU(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-D5gOYdM7.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/VonSim8/sw.js",{scope:"/VonSim8/",type:"classic"})).catch(h=>{o==null||o(h)}),!a)return;u=async()=>{await(a==null?void 0:a.messageSkipWaiting())};{let h=!1;const f=()=>{h=!0,a==null||a.addEventListener("controlling",p=>{p.isUpdate&&window.location.reload()}),n==null||n()};a.addEventListener("installed",p=>{typeof p.isUpdate>"u"?typeof p.isExternal<"u"?p.isExternal?f():!h&&(i==null||i()):p.isExternal?window.location.reload():!h&&(i==null||i()):p.isUpdate||i==null||i()}),a.addEventListener("waiting",f),a.addEventListener("externalwaiting",f)}a.register({immediate:e}).then(h=>{s?s("/VonSim8/sw.js",h):r==null||r(h)}).catch(h=>{o==null||o(h)})}}return l=d(),c}function yU(t={}){const{immediate:e=!0,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisteredSW:s,onRegisterError:o}=t,[a,l]=S.useState(!1),[u,c]=S.useState(!1),[d]=S.useState(()=>vU({immediate:e,onOfflineReady(){c(!0),i==null||i()},onNeedRefresh(){l(!0),n==null||n()},onRegistered:r,onRegisteredSW:s,onRegisterError:o}));return{needRefresh:[a,l],offlineReady:[u,c],updateServiceWorker:d}}class ot{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,n,i){[e,n]=Oc(this,e,n);let r=[];return this.decompose(0,e,r,2),i.length&&i.decompose(0,i.length,r,3),this.decompose(n,this.length,r,1),Es.from(r,this.length-(n-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,n=this.length){[e,n]=Oc(this,e,n);let i=[];return this.decompose(e,n,i,0),Es.from(i,n-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let n=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),r=new vh(this),s=new vh(e);for(let o=n,a=n;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(a+=r.value.length,r.done||a>=i)return!0}}iter(e=1){return new vh(this,e)}iterRange(e,n=this.length){return new Q2(this,e,n)}iterLines(e,n){let i;if(e==null)i=this.iter();else{n==null&&(n=this.lines+1);let r=this.line(e).from;i=this.iterRange(r,Math.max(r,n==this.lines+1?this.length:n<=1?0:this.line(n-1).to))}return new eD(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?ot.empty:e.length<=32?new Wt(e):Es.from(Wt.split(e,[]))}}class Wt extends ot{constructor(e,n=wU(e)){super(),this.text=e,this.length=n}get lines(){return this.text.length}get children(){return null}lineInner(e,n,i,r){for(let s=0;;s++){let o=this.text[s],a=r+o.length;if((n?i:a)>=e)return new bU(r,a,i,o);r=a+1,i++}}decompose(e,n,i,r){let s=e<=0&&n>=this.length?this:new Wt(HA(this.text,e,n),Math.min(n,this.length)-Math.max(0,e));if(r&1){let o=i.pop(),a=Jm(s.text,o.text.slice(),0,s.length);if(a.length<=32)i.push(new Wt(a,o.length+s.length));else{let l=a.length>>1;i.push(new Wt(a.slice(0,l)),new Wt(a.slice(l)))}}else i.push(s)}replace(e,n,i){if(!(i instanceof Wt))return super.replace(e,n,i);[e,n]=Oc(this,e,n);let r=Jm(this.text,Jm(i.text,HA(this.text,0,e)),n),s=this.length+i.length-(n-e);return r.length<=32?new Wt(r,s):Es.from(Wt.split(r,[]),s)}sliceString(e,n=this.length,i=`
`){[e,n]=Oc(this,e,n);let r="";for(let s=0,o=0;s<=n&&o<this.text.length;o++){let a=this.text[o],l=s+a.length;s>e&&o&&(r+=i),e<l&&n>s&&(r+=a.slice(Math.max(0,e-s),n-s)),s=l+1}return r}flatten(e){for(let n of this.text)e.push(n)}scanIdentical(){return 0}static split(e,n){let i=[],r=-1;for(let s of e)i.push(s),r+=s.length+1,i.length==32&&(n.push(new Wt(i,r)),i=[],r=-1);return r>-1&&n.push(new Wt(i,r)),n}}class Es extends ot{constructor(e,n){super(),this.children=e,this.length=n,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,n,i,r){for(let s=0;;s++){let o=this.children[s],a=r+o.length,l=i+o.lines-1;if((n?l:a)>=e)return o.lineInner(e,n,i,r);r=a+1,i=l+1}}decompose(e,n,i,r){for(let s=0,o=0;o<=n&&s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e<=l&&n>=o){let u=r&((o<=e?1:0)|(l>=n?2:0));o>=e&&l<=n&&!u?i.push(a):a.decompose(e-o,n-o,i,u)}o=l+1}}replace(e,n,i){if([e,n]=Oc(this,e,n),i.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.length;if(e>=s&&n<=a){let l=o.replace(e-s,n-s,i),u=this.lines-o.lines+l.lines;if(l.lines<u>>4&&l.lines>u>>6){let c=this.children.slice();return c[r]=l,new Es(c,this.length-(n-e)+i.length)}return super.replace(s,a,l)}s=a+1}return super.replace(e,n,i)}sliceString(e,n=this.length,i=`
`){[e,n]=Oc(this,e,n);let r="";for(let s=0,o=0;s<this.children.length&&o<=n;s++){let a=this.children[s],l=o+a.length;o>e&&s&&(r+=i),e<l&&n>o&&(r+=a.sliceString(e-o,n-o,i)),o=l+1}return r}flatten(e){for(let n of this.children)n.flatten(e)}scanIdentical(e,n){if(!(e instanceof Es))return 0;let i=0,[r,s,o,a]=n>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=n,s+=n){if(r==o||s==a)return i;let l=this.children[r],u=e.children[s];if(l!=u)return i+l.scanIdentical(u,n);i+=l.length+1}}static from(e,n=e.reduce((i,r)=>i+r.length+1,-1)){let i=0;for(let f of e)i+=f.lines;if(i<32){let f=[];for(let p of e)p.flatten(f);return new Wt(f,n)}let r=Math.max(32,i>>5),s=r<<1,o=r>>1,a=[],l=0,u=-1,c=[];function d(f){let p;if(f.lines>s&&f instanceof Es)for(let m of f.children)d(m);else f.lines>o&&(l>o||!l)?(h(),a.push(f)):f instanceof Wt&&l&&(p=c[c.length-1])instanceof Wt&&f.lines+p.lines<=32?(l+=f.lines,u+=f.length+1,c[c.length-1]=new Wt(p.text.concat(f.text),p.length+1+f.length)):(l+f.lines>r&&h(),l+=f.lines,u+=f.length+1,c.push(f))}function h(){l!=0&&(a.push(c.length==1?c[0]:Es.from(c,u)),u=-1,l=c.length=0)}for(let f of e)d(f);return h(),a.length==1?a[0]:new Es(a,n)}}ot.empty=new Wt([""],0);function wU(t){let e=-1;for(let n of t)e+=n.length+1;return e}function Jm(t,e,n=0,i=1e9){for(let r=0,s=0,o=!0;s<t.length&&r<=i;s++){let a=t[s],l=r+a.length;l>=n&&(l>i&&(a=a.slice(0,i-r)),r<n&&(a=a.slice(n-r)),o?(e[e.length-1]+=a,o=!1):e.push(a)),r=l+1}return e}function HA(t,e,n){return Jm(t,[""],e,n)}class vh{constructor(e,n=1){this.dir=n,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[n>0?1:(e instanceof Wt?e.text.length:e.children.length)<<1]}nextInner(e,n){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,r=this.nodes[i],s=this.offsets[i],o=s>>1,a=r instanceof Wt?r.text.length:r.children.length;if(o==(n>0?a:0)){if(i==0)return this.done=!0,this.value="",this;n>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(n>0?0:1)){if(this.offsets[i]+=n,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof Wt){let l=r.text[o+(n<0?-1:0)];if(this.offsets[i]+=n,l.length>Math.max(0,e))return this.value=e==0?l:n>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=r.children[o+(n<0?-1:0)];e>l.length?(e-=l.length,this.offsets[i]+=n):(n<0&&this.offsets[i]--,this.nodes.push(l),this.offsets.push(n>0?1:(l instanceof Wt?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class Q2{constructor(e,n,i){this.value="",this.done=!1,this.cursor=new vh(e,n>i?-1:1),this.pos=n>i?e.length:0,this.from=Math.min(n,i),this.to=Math.max(n,i)}nextInner(e,n){if(n<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,n<0?this.pos-this.to:this.from-this.pos);let i=n<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*n,this.value=r.length<=i?r:n<0?r.slice(r.length-i):r.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class eD{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:n,lineBreak:i,value:r}=this.inner.next(e);return n&&this.afterBreak?(this.value="",this.afterBreak=!1):n?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(ot.prototype[Symbol.iterator]=function(){return this.iter()},vh.prototype[Symbol.iterator]=Q2.prototype[Symbol.iterator]=eD.prototype[Symbol.iterator]=function(){return this});class bU{constructor(e,n,i,r){this.from=e,this.to=n,this.number=i,this.text=r}get length(){return this.to-this.from}}function Oc(t,e,n){return e=Math.max(0,Math.min(t.length,e)),[e,Math.max(e,Math.min(t.length,n))]}let oc="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=1;t<oc.length;t++)oc[t]+=oc[t-1];function xU(t){for(let e=1;e<oc.length;e+=2)if(oc[e]>t)return oc[e-1]<=t;return!1}function WA(t){return t>=127462&&t<=127487}const GA=8205;function Tn(t,e,n=!0,i=!0){return(n?tD:SU)(t,e,i)}function tD(t,e,n){if(e==t.length)return e;e&&nD(t.charCodeAt(e))&&iD(t.charCodeAt(e-1))&&e--;let i=ei(t,e);for(e+=Wr(i);e<t.length;){let r=ei(t,e);if(i==GA||r==GA||n&&xU(r))e+=Wr(r),i=r;else if(WA(r)){let s=0,o=e-2;for(;o>=0&&WA(ei(t,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function SU(t,e,n){for(;e>0;){let i=tD(t,e-2,n);if(i<e)return i;e--}return 0}function nD(t){return t>=56320&&t<57344}function iD(t){return t>=55296&&t<56320}function ei(t,e){let n=t.charCodeAt(e);if(!iD(n)||e+1==t.length)return n;let i=t.charCodeAt(e+1);return nD(i)?(n-55296<<10)+(i-56320)+65536:n}function yk(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}function Wr(t){return t<65536?1:2}const Ox=/\r\n?|\n/;var xi=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(xi||(xi={}));class Ls{constructor(e){this.sections=e}get length(){let e=0;for(let n=0;n<this.sections.length;n+=2)e+=this.sections[n];return e}get newLength(){let e=0;for(let n=0;n<this.sections.length;n+=2){let i=this.sections[n+1];e+=i<0?this.sections[n]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let n=0,i=0,r=0;n<this.sections.length;){let s=this.sections[n++],o=this.sections[n++];o<0?(e(i,r,s),r+=s):r+=o,i+=s}}iterChangedRanges(e,n=!1){Dx(this,e,n)}get invertedDesc(){let e=[];for(let n=0;n<this.sections.length;){let i=this.sections[n++],r=this.sections[n++];r<0?e.push(i,r):e.push(r,i)}return new Ls(e)}composeDesc(e){return this.empty?e:e.empty?this:rD(this,e)}mapDesc(e,n=!1){return e.empty?this:Ix(this,e,n)}mapPos(e,n=-1,i=xi.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],u=r+a;if(l<0){if(u>e)return s+(e-r);s+=a}else{if(i!=xi.Simple&&u>=e&&(i==xi.TrackDel&&r<e&&u>e||i==xi.TrackBefore&&r<e||i==xi.TrackAfter&&u>e))return null;if(u>e||u==e&&n<0&&!a)return e==r||n<0?s:s+l;s+=l}r=u}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,n=e){for(let i=0,r=0;i<this.sections.length&&r<=n;){let s=this.sections[i++],o=this.sections[i++],a=r+s;if(o>=0&&r<=n&&a>=e)return r<e&&a>n?"cover":!0;r=a}return!1}toString(){let e="";for(let n=0;n<this.sections.length;){let i=this.sections[n++],r=this.sections[n++];e+=(e?" ":"")+i+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(n=>typeof n!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Ls(e)}static create(e){return new Ls(e)}}class rn extends Ls{constructor(e,n){super(e),this.inserted=n}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Dx(this,(n,i,r,s,o)=>e=e.replace(r,r+(i-n),o),!1),e}mapDesc(e,n=!1){return Ix(this,e,n,!0)}invert(e){let n=this.sections.slice(),i=[];for(let r=0,s=0;r<n.length;r+=2){let o=n[r],a=n[r+1];if(a>=0){n[r]=a,n[r+1]=o;let l=r>>1;for(;i.length<l;)i.push(ot.empty);i.push(o?e.slice(s,s+o):ot.empty)}s+=o}return new rn(n,i)}compose(e){return this.empty?e:e.empty?this:rD(this,e,!0)}map(e,n=!1){return e.empty?this:Ix(this,e,n,!0)}iterChanges(e,n=!1){Dx(this,e,n)}get desc(){return Ls.create(this.sections)}filter(e){let n=[],i=[],r=[],s=new Qh(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,l-a);Bn(r,c,-1);let d=s.ins==-1?-1:s.off==0?s.ins:0;Bn(n,c,d),d>0&&pa(i,n,s.text),s.forward(c),a+=c}let u=e[o++];for(;a<u;){if(s.done)break e;let c=Math.min(s.len,u-a);Bn(n,c,-1),Bn(r,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),a+=c}}return{changes:new rn(n,i),filtered:Ls.create(r)}}toJSON(){let e=[];for(let n=0;n<this.sections.length;n+=2){let i=this.sections[n],r=this.sections[n+1];r<0?e.push(i):r==0?e.push([i]):e.push([i].concat(this.inserted[n>>1].toJSON()))}return e}static of(e,n,i){let r=[],s=[],o=0,a=null;function l(c=!1){if(!c&&!r.length)return;o<n&&Bn(r,n-o,-1);let d=new rn(r,s);a=a?a.compose(d.map(a)):d,r=[],s=[],o=0}function u(c){if(Array.isArray(c))for(let d of c)u(d);else if(c instanceof rn){if(c.length!=n)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${n})`);l(),a=a?a.compose(c.map(a)):c}else{let{from:d,to:h=d,insert:f}=c;if(d>h||d<0||h>n)throw new RangeError(`Invalid change range ${d} to ${h} (in doc of length ${n})`);let p=f?typeof f=="string"?ot.of(f.split(i||Ox)):f:ot.empty,m=p.length;if(d==h&&m==0)return;d<o&&l(),d>o&&Bn(r,d-o,-1),Bn(r,h-d,m),pa(s,r,p),o=h}}return u(e),l(!a),a}static empty(e){return new rn(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let n=[],i=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")n.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)n.push(s[0],0);else{for(;i.length<r;)i.push(ot.empty);i[r]=ot.of(s.slice(1)),n.push(s[0],i[r].length)}}}return new rn(n,i)}static createSet(e,n){return new rn(e,n)}}function Bn(t,e,n,i=!1){if(e==0&&n<=0)return;let r=t.length-2;r>=0&&n<=0&&n==t[r+1]?t[r]+=e:e==0&&t[r]==0?t[r+1]+=n:i?(t[r]+=e,t[r+1]+=n):t.push(e,n)}function pa(t,e,n){if(n.length==0)return;let i=e.length-2>>1;if(i<t.length)t[t.length-1]=t[t.length-1].append(n);else{for(;t.length<i;)t.push(ot.empty);t.push(n)}}function Dx(t,e,n){let i=t.inserted;for(let r=0,s=0,o=0;o<t.sections.length;){let a=t.sections[o++],l=t.sections[o++];if(l<0)r+=a,s+=a;else{let u=r,c=s,d=ot.empty;for(;u+=a,c+=l,l&&i&&(d=d.append(i[o-2>>1])),!(n||o==t.sections.length||t.sections[o+1]<0);)a=t.sections[o++],l=t.sections[o++];e(r,u,s,c,d),r=u,s=c}}}function Ix(t,e,n,i=!1){let r=[],s=i?[]:null,o=new Qh(t),a=new Qh(e);for(let l=-1;;)if(o.ins==-1&&a.ins==-1){let u=Math.min(o.len,a.len);Bn(r,u,-1),o.forward(u),a.forward(u)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!n))){let u=a.len;for(Bn(r,a.ins,-1);u;){let c=Math.min(o.len,u);o.ins>=0&&l<o.i&&o.len<=c&&(Bn(r,0,o.ins),s&&pa(s,r,o.text),l=o.i),o.forward(c),u-=c}a.next()}else if(o.ins>=0){let u=0,c=o.len;for(;c;)if(a.ins==-1){let d=Math.min(c,a.len);u+=d,c-=d,a.forward(d)}else if(a.ins==0&&a.len<c)c-=a.len,a.next();else break;Bn(r,u,l<o.i?o.ins:0),s&&l<o.i&&pa(s,r,o.text),l=o.i,o.forward(o.len-c)}else{if(o.done&&a.done)return s?rn.createSet(r,s):Ls.create(r);throw new Error("Mismatched change set lengths")}}function rD(t,e,n=!1){let i=[],r=n?[]:null,s=new Qh(t),o=new Qh(e);for(let a=!1;;){if(s.done&&o.done)return r?rn.createSet(i,r):Ls.create(i);if(s.ins==0)Bn(i,s.len,0,a),s.next();else if(o.len==0&&!o.done)Bn(i,0,o.ins,a),r&&pa(r,i,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,o.len),u=i.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;Bn(i,l,c,a),r&&c&&pa(r,i,o.text)}else o.ins==-1?(Bn(i,s.off?0:s.len,l,a),r&&pa(r,i,s.textBit(l))):(Bn(i,s.off?0:s.len,o.off?0:o.ins,a),r&&!o.off&&pa(r,i,o.text));a=(s.ins>l||o.ins>=0&&o.len>l)&&(a||i.length>u),s.forward2(l),o.forward(l)}}}}class Qh{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,n=this.i-2>>1;return n>=e.length?ot.empty:e[n]}textBit(e){let{inserted:n}=this.set,i=this.i-2>>1;return i>=n.length&&!e?ot.empty:n[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Dl{constructor(e,n,i){this.from=e,this.to=n,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,n=-1){let i,r;return this.empty?i=r=e.mapPos(this.from,n):(i=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),i==this.from&&r==this.to?this:new Dl(i,r,this.flags)}extend(e,n=e){if(e<=this.anchor&&n>=this.anchor)return ne.range(e,n);let i=Math.abs(e-this.anchor)>Math.abs(n-this.anchor)?e:n;return ne.range(this.anchor,i)}eq(e,n=!1){return this.anchor==e.anchor&&this.head==e.head&&(!n||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return ne.range(e.anchor,e.head)}static create(e,n,i){return new Dl(e,n,i)}}class ne{constructor(e,n){this.ranges=e,this.mainIndex=n}map(e,n=-1){return e.empty?this:ne.create(this.ranges.map(i=>i.map(e,n)),this.mainIndex)}eq(e,n=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],n))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new ne([this.main],0)}addRange(e,n=!0){return ne.create([e].concat(this.ranges),n?0:this.mainIndex+1)}replaceRange(e,n=this.mainIndex){let i=this.ranges.slice();return i[n]=e,ne.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new ne(e.ranges.map(n=>Dl.fromJSON(n)),e.main)}static single(e,n=e){return new ne([ne.range(e,n)],0)}static create(e,n=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=i:s.from<i)return ne.normalized(e.slice(),n);i=s.to}return new ne(e,n)}static cursor(e,n=0,i,r){return Dl.create(e,e,(n==0?0:n<0?8:16)|(i==null?7:Math.min(6,i))|(r??16777215)<<6)}static range(e,n,i,r){let s=(i??16777215)<<6|(r==null?7:Math.min(6,r));return n<e?Dl.create(n,e,48|s):Dl.create(e,n,(n>e?8:0)|s)}static normalized(e,n=0){let i=e[n];e.sort((r,s)=>r.from-s.from),n=e.indexOf(i);for(let r=1;r<e.length;r++){let s=e[r],o=e[r-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,l=Math.max(s.to,o.to);r<=n&&n--,e.splice(--r,2,s.anchor>s.head?ne.range(l,a):ne.range(a,l))}}return new ne(e,n)}}function sD(t,e){for(let n of t.ranges)if(n.to>e)throw new RangeError("Selection points outside of document")}let wk=0;class _e{constructor(e,n,i,r,s){this.combine=e,this.compareInput=n,this.compare=i,this.isStatic=r,this.id=wk++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new _e(e.combine||(n=>n),e.compareInput||((n,i)=>n===i),e.compare||(e.combine?(n,i)=>n===i:bk),!!e.static,e.enables)}of(e){return new Zm([],this,0,e)}compute(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new Zm(e,this,1,n)}computeN(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new Zm(e,this,2,n)}from(e,n){return n||(n=i=>i),this.compute([e],i=>n(i.field(e)))}}function bk(t,e){return t==e||t.length==e.length&&t.every((n,i)=>n===e[i])}class Zm{constructor(e,n,i,r){this.dependencies=e,this.facet=n,this.type=i,this.value=r,this.id=wk++}dynamicSlot(e){var n;let i=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,a=this.type==2,l=!1,u=!1,c=[];for(let d of this.dependencies)d=="doc"?l=!0:d=="selection"?u=!0:((n=e[d.id])!==null&&n!==void 0?n:1)&1||c.push(e[d.id]);return{create(d){return d.values[o]=i(d),1},update(d,h){if(l&&h.docChanged||u&&(h.docChanged||h.selection)||Lx(d,c)){let f=i(d);if(a?!KA(f,d.values[o],r):!r(f,d.values[o]))return d.values[o]=f,1}return 0},reconfigure:(d,h)=>{let f,p=h.config.address[s];if(p!=null){let m=tv(h,p);if(this.dependencies.every(w=>w instanceof _e?h.facet(w)===d.facet(w):w instanceof li?h.field(w,!1)==d.field(w,!1):!0)||(a?KA(f=i(d),m,r):r(f=i(d),m)))return d.values[o]=m,0}else f=i(d);return d.values[o]=f,1}}}}function KA(t,e,n){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!n(t[i],e[i]))return!1;return!0}function Lx(t,e){let n=!1;for(let i of e)yh(t,i)&1&&(n=!0);return n}function kU(t,e,n){let i=n.map(l=>t[l.id]),r=n.map(l=>l.type),s=i.filter(l=>!(l&1)),o=t[e.id]>>1;function a(l){let u=[];for(let c=0;c<i.length;c++){let d=tv(l,i[c]);if(r[c]==2)for(let h of d)u.push(h);else u.push(d)}return e.combine(u)}return{create(l){for(let u of i)yh(l,u);return l.values[o]=a(l),1},update(l,u){if(!Lx(l,s))return 0;let c=a(l);return e.compare(c,l.values[o])?0:(l.values[o]=c,1)},reconfigure(l,u){let c=Lx(l,i),d=u.config.facets[e.id],h=u.facet(e);if(d&&!c&&bk(n,d))return l.values[o]=h,0;let f=a(l);return e.compare(f,h)?(l.values[o]=h,0):(l.values[o]=f,1)}}}const XA=_e.define({static:!0});class li{constructor(e,n,i,r,s){this.id=e,this.createF=n,this.updateF=i,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let n=new li(wk++,e.create,e.update,e.compare||((i,r)=>i===r),e);return e.provide&&(n.provides=e.provide(n)),n}create(e){let n=e.facet(XA).find(i=>i.field==this);return((n==null?void 0:n.create)||this.createF)(e)}slot(e){let n=e[this.id]>>1;return{create:i=>(i.values[n]=this.create(i),1),update:(i,r)=>{let s=i.values[n],o=this.updateF(s,r);return this.compareF(s,o)?0:(i.values[n]=o,1)},reconfigure:(i,r)=>r.config.address[this.id]!=null?(i.values[n]=r.field(this),0):(i.values[n]=this.create(i),1)}}init(e){return[this,XA.of({field:this,create:e})]}get extension(){return this}}const kl={lowest:4,low:3,default:2,high:1,highest:0};function kd(t){return e=>new oD(e,t)}const Xf={highest:kd(kl.highest),high:kd(kl.high),default:kd(kl.default),low:kd(kl.low),lowest:kd(kl.lowest)};class oD{constructor(e,n){this.inner=e,this.prec=n}}class qf{of(e){return new jx(this,e)}reconfigure(e){return qf.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class jx{constructor(e,n){this.compartment=e,this.inner=n}}class ev{constructor(e,n,i,r,s,o){for(this.base=e,this.compartments=n,this.dynamicSlots=i,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let n=this.address[e.id];return n==null?e.default:this.staticValues[n>>1]}static resolve(e,n,i){let r=[],s=Object.create(null),o=new Map;for(let h of _U(e,n,o))h instanceof li?r.push(h):(s[h.facet.id]||(s[h.facet.id]=[])).push(h);let a=Object.create(null),l=[],u=[];for(let h of r)a[h.id]=u.length<<1,u.push(f=>h.slot(f));let c=i==null?void 0:i.config.facets;for(let h in s){let f=s[h],p=f[0].facet,m=c&&c[h]||[];if(f.every(w=>w.type==0))if(a[p.id]=l.length<<1|1,bk(m,f))l.push(i.facet(p));else{let w=p.combine(f.map(v=>v.value));l.push(i&&p.compare(w,i.facet(p))?i.facet(p):w)}else{for(let w of f)w.type==0?(a[w.id]=l.length<<1|1,l.push(w.value)):(a[w.id]=u.length<<1,u.push(v=>w.dynamicSlot(v)));a[p.id]=u.length<<1,u.push(w=>kU(w,p,f))}}let d=u.map(h=>h(a));return new ev(e,o,d,a,l,s)}}function _U(t,e,n){let i=[[],[],[],[],[]],r=new Map;function s(o,a){let l=r.get(o);if(l!=null){if(l<=a)return;let u=i[l].indexOf(o);u>-1&&i[l].splice(u,1),o instanceof jx&&n.delete(o.compartment)}if(r.set(o,a),Array.isArray(o))for(let u of o)s(u,a);else if(o instanceof jx){if(n.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let u=e.get(o.compartment)||o.inner;n.set(o.compartment,u),s(u,a)}else if(o instanceof oD)s(o.inner,o.prec);else if(o instanceof li)i[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof Zm)i[a].push(o),o.facet.extensions&&s(o.facet.extensions,kl.default);else{let u=o.extension;if(!u)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(u,a)}}return s(t,kl.default),i.reduce((o,a)=>o.concat(a))}function yh(t,e){if(e&1)return 2;let n=e>>1,i=t.status[n];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;t.status[n]=4;let r=t.computeSlot(t,t.config.dynamicSlots[n]);return t.status[n]=2|r}function tv(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}const aD=_e.define(),Fx=_e.define({combine:t=>t.some(e=>e),static:!0}),lD=_e.define({combine:t=>t.length?t[0]:void 0,static:!0}),uD=_e.define(),cD=_e.define(),dD=_e.define(),hD=_e.define({combine:t=>t.length?t[0]:!1});class Bo{constructor(e,n){this.type=e,this.value=n}static define(){return new CU}}class CU{of(e){return new Bo(this,e)}}class EU{constructor(e){this.map=e}of(e){return new Xe(this,e)}}class Xe{constructor(e,n){this.type=e,this.value=n}map(e){let n=this.type.map(this.value,e);return n===void 0?void 0:n==this.value?this:new Xe(this.type,n)}is(e){return this.type==e}static define(e={}){return new EU(e.map||(n=>n))}static mapEffects(e,n){if(!e.length)return e;let i=[];for(let r of e){let s=r.map(n);s&&i.push(s)}return i}}Xe.reconfigure=Xe.define();Xe.appendConfig=Xe.define();class un{constructor(e,n,i,r,s,o){this.startState=e,this.changes=n,this.selection=i,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&sD(i,n.newLength),s.some(a=>a.type==un.time)||(this.annotations=s.concat(un.time.of(Date.now())))}static create(e,n,i,r,s,o){return new un(e,n,i,r,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let n of this.annotations)if(n.type==e)return n.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let n=this.annotation(un.userEvent);return!!(n&&(n==e||n.length>e.length&&n.slice(0,e.length)==e&&n[e.length]=="."))}}un.time=Bo.define();un.userEvent=Bo.define();un.addToHistory=Bo.define();un.remote=Bo.define();function AU(t,e){let n=[];for(let i=0,r=0;;){let s,o;if(i<t.length&&(r==e.length||e[r]>=t[i]))s=t[i++],o=t[i++];else if(r<e.length)s=e[r++],o=e[r++];else return n;!n.length||n[n.length-1]<s?n.push(s,o):n[n.length-1]<o&&(n[n.length-1]=o)}}function fD(t,e,n){var i;let r,s,o;return n?(r=e.changes,s=rn.empty(e.changes.length),o=t.changes.compose(e.changes)):(r=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(i=t.selection)===null||i===void 0?void 0:i.map(r),effects:Xe.mapEffects(t.effects,r).concat(Xe.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function Bx(t,e,n){let i=e.selection,r=ac(e.annotations);return e.userEvent&&(r=r.concat(un.userEvent.of(e.userEvent))),{changes:e.changes instanceof rn?e.changes:rn.of(e.changes||[],n,t.facet(lD)),selection:i&&(i instanceof ne?i:ne.single(i.anchor,i.head)),effects:ac(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function pD(t,e,n){let i=Bx(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(n=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(n=!1);let o=!!e[s].sequential;i=fD(i,Bx(t,e[s],o?i.changes.newLength:t.doc.length),o)}let r=un.create(t,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return TU(n?PU(r):r)}function PU(t){let e=t.startState,n=!0;for(let r of e.facet(uD)){let s=r(t);if(s===!1){n=!1;break}Array.isArray(s)&&(n=n===!0?s:AU(n,s))}if(n!==!0){let r,s;if(n===!1)s=t.changes.invertedDesc,r=rn.empty(e.doc.length);else{let o=t.changes.filter(n);r=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}t=un.create(e,r,t.selection&&t.selection.map(s),Xe.mapEffects(t.effects,s),t.annotations,t.scrollIntoView)}let i=e.facet(cD);for(let r=i.length-1;r>=0;r--){let s=i[r](t);s instanceof un?t=s:Array.isArray(s)&&s.length==1&&s[0]instanceof un?t=s[0]:t=pD(e,ac(s),!1)}return t}function TU(t){let e=t.startState,n=e.facet(dD),i=t;for(let r=n.length-1;r>=0;r--){let s=n[r](t);s&&Object.keys(s).length&&(i=fD(i,Bx(e,s,t.changes.newLength),!0))}return i==t?t:un.create(e,t.changes,t.selection,i.effects,i.annotations,i.scrollIntoView)}const RU=[];function ac(t){return t==null?RU:Array.isArray(t)?t:[t]}var Rn=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(Rn||(Rn={}));const NU=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let $x;try{$x=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function MU(t){if($x)return $x.test(t);for(let e=0;e<t.length;e++){let n=t[e];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||NU.test(n)))return!0}return!1}function OU(t){return e=>{if(!/\S/.test(e))return Rn.Space;if(MU(e))return Rn.Word;for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return Rn.Word;return Rn.Other}}class Je{constructor(e,n,i,r,s,o){this.config=e,this.doc=n,this.selection=i,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)yh(this,a<<1);this.computeSlot=null}field(e,n=!0){let i=this.config.address[e.id];if(i==null){if(n)throw new RangeError("Field is not present in this state");return}return yh(this,i),tv(this,i)}update(...e){return pD(this,e,!0)}applyTransaction(e){let n=this.config,{base:i,compartments:r}=n;for(let a of e.effects)a.is(qf.reconfigure)?(n&&(r=new Map,n.compartments.forEach((l,u)=>r.set(u,l)),n=null),r.set(a.value.compartment,a.value.extension)):a.is(Xe.reconfigure)?(n=null,i=a.value):a.is(Xe.appendConfig)&&(n=null,i=ac(i).concat(a.value));let s;n?s=e.startState.values.slice():(n=ev.resolve(i,r,this),s=new Je(n,this.doc,this.selection,n.dynamicSlots.map(()=>null),(l,u)=>u.reconfigure(l,this),null).values);let o=e.startState.facet(Fx)?e.newSelection:e.newSelection.asSingle();new Je(n,e.newDoc,o,s,(a,l)=>l.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:e},range:ne.cursor(n.from+e.length)}))}changeByRange(e){let n=this.selection,i=e(n.ranges[0]),r=this.changes(i.changes),s=[i.range],o=ac(i.effects);for(let a=1;a<n.ranges.length;a++){let l=e(n.ranges[a]),u=this.changes(l.changes),c=u.map(r);for(let h=0;h<a;h++)s[h]=s[h].map(c);let d=r.mapDesc(u,!0);s.push(l.range.map(d)),r=r.compose(c),o=Xe.mapEffects(o,c).concat(Xe.mapEffects(ac(l.effects),d))}return{changes:r,selection:ne.create(s,n.mainIndex),effects:o}}changes(e=[]){return e instanceof rn?e:rn.of(e,this.doc.length,this.facet(Je.lineSeparator))}toText(e){return ot.of(e.split(this.facet(Je.lineSeparator)||Ox))}sliceDoc(e=0,n=this.doc.length){return this.doc.sliceString(e,n,this.lineBreak)}facet(e){let n=this.config.address[e.id];return n==null?e.default:(yh(this,n),tv(this,n))}toJSON(e){let n={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let r=e[i];r instanceof li&&this.config.address[r.id]!=null&&(n[i]=r.spec.toJSON(this.field(e[i]),this))}return n}static fromJSON(e,n={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(i){for(let s in i)if(Object.prototype.hasOwnProperty.call(e,s)){let o=i[s],a=e[s];r.push(o.init(l=>o.spec.fromJSON(a,l)))}}return Je.create({doc:e.doc,selection:ne.fromJSON(e.selection),extensions:n.extensions?r.concat([n.extensions]):r})}static create(e={}){let n=ev.resolve(e.extensions||[],new Map),i=e.doc instanceof ot?e.doc:ot.of((e.doc||"").split(n.staticFacet(Je.lineSeparator)||Ox)),r=e.selection?e.selection instanceof ne?e.selection:ne.single(e.selection.anchor,e.selection.head):ne.single(0);return sD(r,i.length),n.staticFacet(Fx)||(r=r.asSingle()),new Je(n,i,r,n.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(Je.tabSize)}get lineBreak(){return this.facet(Je.lineSeparator)||`
`}get readOnly(){return this.facet(hD)}phrase(e,...n){for(let i of this.facet(Je.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return n.length&&(e=e.replace(/\$(\$|\d*)/g,(i,r)=>{if(r=="$")return"$";let s=+(r||1);return!s||s>n.length?i:n[s-1]})),e}languageDataAt(e,n,i=-1){let r=[];for(let s of this.facet(aD))for(let o of s(this,n,i))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return OU(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:n,from:i,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-i,a=e-i;for(;o>0;){let l=Tn(n,o,!1);if(s(n.slice(l,o))!=Rn.Word)break;o=l}for(;a<r;){let l=Tn(n,a);if(s(n.slice(a,l))!=Rn.Word)break;a=l}return o==a?null:ne.range(o+i,a+i)}}Je.allowMultipleSelections=Fx;Je.tabSize=_e.define({combine:t=>t.length?t[0]:4});Je.lineSeparator=lD;Je.readOnly=hD;Je.phrases=_e.define({compare(t,e){let n=Object.keys(t),i=Object.keys(e);return n.length==i.length&&n.every(r=>t[r]==e[r])}});Je.languageData=aD;Je.changeFilter=uD;Je.transactionFilter=cD;Je.transactionExtender=dD;qf.reconfigure=Xe.define();function nl(t,e,n={}){let i={};for(let r of t)for(let s of Object.keys(r)){let o=r[s],a=i[s];if(a===void 0)i[s]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(n,s))i[s]=n[s](a,o);else throw new Error("Config merge conflict for field "+s)}for(let r in e)i[r]===void 0&&(i[r]=e[r]);return i}class ql{eq(e){return this==e}range(e,n=e){return zx.create(e,n,this)}}ql.prototype.startSide=ql.prototype.endSide=0;ql.prototype.point=!1;ql.prototype.mapMode=xi.TrackDel;let zx=class mD{constructor(e,n,i){this.from=e,this.to=n,this.value=i}static create(e,n,i){return new mD(e,n,i)}};function Ux(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class xk{constructor(e,n,i,r){this.from=e,this.to=n,this.value=i,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,n,i,r=0){let s=i?this.to:this.from;for(let o=r,a=s.length;;){if(o==a)return o;let l=o+a>>1,u=s[l]-e||(i?this.value[l].endSide:this.value[l].startSide)-n;if(l==o)return u>=0?o:a;u>=0?a=l:o=l+1}}between(e,n,i,r){for(let s=this.findIndex(n,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,n){let i=[],r=[],s=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let u=this.value[l],c=this.from[l]+e,d=this.to[l]+e,h,f;if(c==d){let p=n.mapPos(c,u.startSide,u.mapMode);if(p==null||(h=f=p,u.startSide!=u.endSide&&(f=n.mapPos(c,u.endSide),f<h)))continue}else if(h=n.mapPos(c,u.startSide),f=n.mapPos(d,u.endSide),h>f||h==f&&u.startSide>0&&u.endSide<=0)continue;(f-h||u.endSide-u.startSide)<0||(o<0&&(o=h),u.point&&(a=Math.max(a,f-h)),i.push(u),r.push(h-o),s.push(f-o))}return{mapped:i.length?new xk(r,s,i,a):null,pos:o}}}class ct{constructor(e,n,i,r){this.chunkPos=e,this.chunk=n,this.nextLayer=i,this.maxPoint=r}static create(e,n,i,r){return new ct(e,n,i,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let n of this.chunk)e+=n.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:n=[],sort:i=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(n.length==0&&!o)return this;if(i&&(n=n.slice().sort(Ux)),this.isEmpty)return n.length?ct.of(n):this;let a=new gD(this,null,-1).goto(0),l=0,u=[],c=new Yl;for(;a.value||l<n.length;)if(l<n.length&&(a.from-n[l].from||a.startSide-n[l].value.startSide)>=0){let d=n[l++];c.addInner(d.from,d.to,d.value)||u.push(d)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==n.length||this.chunkEnd(a.chunkIndex)<n[l].from)&&(!o||r>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&c.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||r>a.to||s<a.from||o(a.from,a.to,a.value))&&(c.addInner(a.from,a.to,a.value)||u.push(zx.create(a.from,a.to,a.value))),a.next());return c.finishInner(this.nextLayer.isEmpty&&!u.length?ct.empty:this.nextLayer.update({add:u,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let n=[],i=[],r=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],u=e.touchesRange(a,a+l.length);if(u===!1)r=Math.max(r,l.maxPoint),n.push(l),i.push(e.mapPos(a));else if(u===!0){let{mapped:c,pos:d}=l.map(a,e);c&&(r=Math.max(r,c.maxPoint),n.push(c),i.push(d))}}let s=this.nextLayer.map(e);return n.length==0?s:new ct(i,n,s||ct.empty,r)}between(e,n,i){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(n>=s&&e<=s+o.length&&o.between(s,e-s,n-s,i)===!1)return}this.nextLayer.between(e,n,i)}}iter(e=0){return ef.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,n=0){return ef.from(e).goto(n)}static compare(e,n,i,r,s=-1){let o=e.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),a=n.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),l=qA(o,a,i),u=new _d(o,l,s),c=new _d(a,l,s);i.iterGaps((d,h,f)=>YA(u,d,c,h,f,r)),i.empty&&i.length==0&&YA(u,0,c,0,0,r)}static eq(e,n,i=0,r){r==null&&(r=999999999);let s=e.filter(c=>!c.isEmpty&&n.indexOf(c)<0),o=n.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let a=qA(s,o),l=new _d(s,a,0).goto(i),u=new _d(o,a,0).goto(i);for(;;){if(l.to!=u.to||!Vx(l.active,u.active)||l.point&&(!u.point||!l.point.eq(u.point)))return!1;if(l.to>r)return!0;l.next(),u.next()}}static spans(e,n,i,r,s=-1){let o=new _d(e,null,s).goto(n),a=n,l=o.openStart;for(;;){let u=Math.min(o.to,i);if(o.point){let c=o.activeForPoint(o.to),d=o.pointFrom<n?c.length+1:o.point.startSide<0?c.length:Math.min(c.length,l);r.point(a,u,o.point,c,d,o.pointRank),l=Math.min(o.openEnd(u),c.length)}else u>a&&(r.span(a,u,o.active,l),l=o.openEnd(u));if(o.to>i)return l+(o.point&&o.to>i?1:0);a=o.to,o.next()}}static of(e,n=!1){let i=new Yl;for(let r of e instanceof zx?[e]:n?DU(e):e)i.add(r.from,r.to,r.value);return i.finish()}static join(e){if(!e.length)return ct.empty;let n=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let r=e[i];r!=ct.empty;r=r.nextLayer)n=new ct(r.chunkPos,r.chunk,n,Math.max(r.maxPoint,n.maxPoint));return n}}ct.empty=new ct([],[],null,-1);function DU(t){if(t.length>1)for(let e=t[0],n=1;n<t.length;n++){let i=t[n];if(Ux(e,i)>0)return t.slice().sort(Ux);e=i}return t}ct.empty.nextLayer=ct.empty;class Yl{finishChunk(e){this.chunks.push(new xk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,n,i){this.addInner(e,n,i)||(this.nextLayer||(this.nextLayer=new Yl)).add(e,n,i)}addInner(e,n,i){let r=e-this.lastTo||i.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(n-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=n,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,n-e)),!0)}addChunk(e,n){if((e-this.lastTo||n.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,n.maxPoint),this.chunks.push(n),this.chunkPos.push(e);let i=n.value.length-1;return this.last=n.value[i],this.lastFrom=n.from[i]+e,this.lastTo=n.to[i]+e,!0}finish(){return this.finishInner(ct.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let n=ct.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,n}}function qA(t,e,n){let i=new Map;for(let s of t)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&i.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=i.get(s.chunk[o]);a!=null&&(n?n.mapPos(a):a)==s.chunkPos[o]&&!(n!=null&&n.touchesRange(a,a+s.chunk[o].length))&&r.add(s.chunk[o])}return r}class gD{constructor(e,n,i,r=0){this.layer=e,this.skip=n,this.minPoint=i,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,n=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,n,!1),this}gotoInner(e,n,i){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],n,!0);(!i||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,n){(this.to-e||this.endSide-n)<0&&this.gotoInner(e,n,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],n=this.layer.chunk[this.chunkIndex],i=e+n.from[this.rangeIndex];if(this.from=i,this.to=e+n.to[this.rangeIndex],this.value=n.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class ef{constructor(e){this.heap=e}static from(e,n=null,i=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&r.push(new gD(o,n,i,s));return r.length==1?r[0]:new ef(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,n=-1e9){for(let i of this.heap)i.goto(e,n);for(let i=this.heap.length>>1;i>=0;i--)Q0(this.heap,i);return this.next(),this}forward(e,n){for(let i of this.heap)i.forward(e,n);for(let i=this.heap.length>>1;i>=0;i--)Q0(this.heap,i);(this.to-e||this.value.endSide-n)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Q0(this.heap,0)}}}function Q0(t,e){for(let n=t[e];;){let i=(e<<1)+1;if(i>=t.length)break;let r=t[i];if(i+1<t.length&&r.compare(t[i+1])>=0&&(r=t[i+1],i++),n.compare(r)<0)break;t[i]=n,t[e]=r,e=i}}class _d{constructor(e,n,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=ef.from(e,n,i)}goto(e,n=-1e9){return this.cursor.goto(e,n),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=n,this.openStart=-1,this.next(),this}forward(e,n){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-n)<0;)this.removeActive(this.minActive);this.cursor.forward(e,n)}removeActive(e){Xp(this.active,e),Xp(this.activeTo,e),Xp(this.activeRank,e),this.minActive=JA(this.active,this.activeTo)}addActive(e){let n=0,{value:i,to:r,rank:s}=this.cursor;for(;n<this.activeRank.length&&(s-this.activeRank[n]||r-this.activeTo[n])>0;)n++;qp(this.active,n,i),qp(this.activeTo,n,r),qp(this.activeRank,n,s),e&&qp(e,n,this.cursor.from),this.minActive=JA(this.active,this.activeTo)}next(){let e=this.to,n=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&Xp(i,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(i),this.cursor.next();else if(n&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let r=i.length-1;r>=0&&i[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let n=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&n.push(this.active[i]);return n.reverse()}openEnd(e){let n=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)n++;return n}}function YA(t,e,n,i,r,s){t.goto(e),n.goto(i);let o=i+r,a=i,l=i-e;for(;;){let u=t.to+l-n.to||t.endSide-n.endSide,c=u<0?t.to+l:n.to,d=Math.min(c,o);if(t.point||n.point?t.point&&n.point&&(t.point==n.point||t.point.eq(n.point))&&Vx(t.activeForPoint(t.to),n.activeForPoint(n.to))||s.comparePoint(a,d,t.point,n.point):d>a&&!Vx(t.active,n.active)&&s.compareRange(a,d,t.active,n.active),c>o)break;a=c,u<=0&&t.next(),u>=0&&n.next()}}function Vx(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n]&&!t[n].eq(e[n]))return!1;return!0}function Xp(t,e){for(let n=e,i=t.length-1;n<i;n++)t[n]=t[n+1];t.pop()}function qp(t,e,n){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=n}function JA(t,e){let n=-1,i=1e9;for(let r=0;r<e.length;r++)(e[r]-i||t[r].endSide-t[n].endSide)<0&&(n=r,i=e[r]);return n}function Yf(t,e,n=t.length){let i=0;for(let r=0;r<n;)t.charCodeAt(r)==9?(i+=e-i%e,r++):(i++,r=Tn(t,r));return i}function IU(t,e,n,i){for(let r=0,s=0;;){if(s>=e)return r;if(r==t.length)break;s+=t.charCodeAt(r)==9?n-s%n:1,r=Tn(t,r)}return i===!0?-1:t.length}const Hx="ͼ",ZA=typeof Symbol>"u"?"__"+Hx:Symbol.for(Hx),Wx=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),QA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Ba{constructor(e,n){this.rules=[];let{finish:i}=n||{};function r(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,l,u){let c=[],d=/^@(\w+)\b/.exec(o[0]),h=d&&d[1]=="keyframes";if(d&&a==null)return l.push(o[0]+";");for(let f in a){let p=a[f];if(/&/.test(f))s(f.split(/,\s*/).map(m=>o.map(w=>m.replace(/&/,w))).reduce((m,w)=>m.concat(w)),p,l);else if(p&&typeof p=="object"){if(!d)throw new RangeError("The value of a property ("+f+") should be a primitive value.");s(r(f),p,c,h)}else p!=null&&c.push(f.replace(/_.*/,"").replace(/[A-Z]/g,m=>"-"+m.toLowerCase())+": "+p+";")}(c.length||h)&&l.push((i&&!d&&!u?o.map(i):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(r(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=QA[ZA]||1;return QA[ZA]=e+1,Hx+e.toString(36)}static mount(e,n,i){let r=e[Wx],s=i&&i.nonce;r?s&&r.setNonce(s):r=new LU(e,s),r.mount(Array.isArray(n)?n:[n],e)}}let eP=new Map;class LU{constructor(e,n){let i=e.ownerDocument||e,r=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let s=eP.get(i);if(s)return e[Wx]=s;this.sheet=new r.CSSStyleSheet,eP.set(i,this)}else this.styleTag=i.createElement("style"),n&&this.styleTag.setAttribute("nonce",n);this.modules=[],e[Wx]=this}mount(e,n){let i=this.sheet,r=0,s=0;for(let o=0;o<e.length;o++){let a=e[o],l=this.modules.indexOf(a);if(l<s&&l>-1&&(this.modules.splice(l,1),s--,l=-1),l==-1){if(this.modules.splice(s++,0,a),i)for(let u=0;u<a.rules.length;u++)i.insertRule(a.rules[u],r++)}else{for(;s<l;)r+=this.modules[s++].rules.length;r+=a.rules.length,s++}}if(i)n.adoptedStyleSheets.indexOf(this.sheet)<0&&(n.adoptedStyleSheets=[this.sheet,...n.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=n.head||n;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var $a={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},tf={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},jU=typeof navigator<"u"&&/Mac/.test(navigator.platform),FU=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var kn=0;kn<10;kn++)$a[48+kn]=$a[96+kn]=String(kn);for(var kn=1;kn<=24;kn++)$a[kn+111]="F"+kn;for(var kn=65;kn<=90;kn++)$a[kn]=String.fromCharCode(kn+32),tf[kn]=String.fromCharCode(kn);for(var ew in $a)tf.hasOwnProperty(ew)||(tf[ew]=$a[ew]);function BU(t){var e=jU&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||FU&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?tf:$a)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}function nf(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function Gx(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function $U(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Qm(t,e){if(!e.anchorNode)return!1;try{return Gx(t,e.anchorNode)}catch{return!1}}function rf(t){return t.nodeType==3?Zl(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function wh(t,e,n,i){return n?tP(t,e,n,i,-1)||tP(t,e,n,i,1):!1}function Jl(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function nv(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function tP(t,e,n,i,r){for(;;){if(t==n&&e==i)return!0;if(e==(r<0?0:Ro(t))){if(t.nodeName=="DIV")return!1;let s=t.parentNode;if(!s||s.nodeType!=1)return!1;e=Jl(t)+(r<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(r<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=r<0?Ro(t):0}else return!1}}function Ro(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Sk(t,e){let n=e?t.left:t.right;return{left:n,right:n,top:t.top,bottom:t.bottom}}function zU(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function vD(t,e){let n=e.width/t.offsetWidth,i=e.height/t.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.width-t.offsetWidth)<1)&&(n=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-t.offsetHeight)<1)&&(i=1),{scaleX:n,scaleY:i}}function UU(t,e,n,i,r,s,o,a){let l=t.ownerDocument,u=l.defaultView||window;for(let c=t,d=!1;c&&!d;)if(c.nodeType==1){let h,f=c==l.body,p=1,m=1;if(f)h=zU(u);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let y=c.getBoundingClientRect();({scaleX:p,scaleY:m}=vD(c,y)),h={left:y.left,right:y.left+c.clientWidth*p,top:y.top,bottom:y.top+c.clientHeight*m}}let w=0,v=0;if(r=="nearest")e.top<h.top?(v=-(h.top-e.top+o),n>0&&e.bottom>h.bottom+v&&(v=e.bottom-h.bottom+v+o)):e.bottom>h.bottom&&(v=e.bottom-h.bottom+o,n<0&&e.top-v<h.top&&(v=-(h.top+v-e.top+o)));else{let y=e.bottom-e.top,b=h.bottom-h.top;v=(r=="center"&&y<=b?e.top+y/2-b/2:r=="start"||r=="center"&&n<0?e.top-o:e.bottom-b+o)-h.top}if(i=="nearest"?e.left<h.left?(w=-(h.left-e.left+s),n>0&&e.right>h.right+w&&(w=e.right-h.right+w+s)):e.right>h.right&&(w=e.right-h.right+s,n<0&&e.left<h.left+w&&(w=-(h.left+w-e.left+s))):w=(i=="center"?e.left+(e.right-e.left)/2-(h.right-h.left)/2:i=="start"==a?e.left-s:e.right-(h.right-h.left)+s)-h.left,w||v)if(f)u.scrollBy(w,v);else{let y=0,b=0;if(v){let k=c.scrollTop;c.scrollTop+=v/m,b=(c.scrollTop-k)*m}if(w){let k=c.scrollLeft;c.scrollLeft+=w/p,y=(c.scrollLeft-k)*p}e={left:e.left-y,top:e.top-b,right:e.right-y,bottom:e.bottom-b},y&&Math.abs(y-w)<1&&(i="nearest"),b&&Math.abs(b-v)<1&&(r="nearest")}if(f)break;c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function VU(t){let e=t.ownerDocument,n,i;for(let r=t.parentNode;r&&!(r==e.body||n&&i);)if(r.nodeType==1)!i&&r.scrollHeight>r.clientHeight&&(i=r),!n&&r.scrollWidth>r.clientWidth&&(n=r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;return{x:n,y:i}}class HU{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:n,focusNode:i}=e;this.set(n,Math.min(e.anchorOffset,n?Ro(n):0),i,Math.min(e.focusOffset,i?Ro(i):0))}set(e,n,i,r){this.anchorNode=e,this.anchorOffset=n,this.focusNode=i,this.focusOffset=r}}let mu=null;function yD(t){if(t.setActive)return t.setActive();if(mu)return t.focus(mu);let e=[];for(let n=t;n&&(e.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(t.focus(mu==null?{get preventScroll(){return mu={preventScroll:!0},!0}}:void 0),!mu){mu=!1;for(let n=0;n<e.length;){let i=e[n++],r=e[n++],s=e[n++];i.scrollTop!=r&&(i.scrollTop=r),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let nP;function Zl(t,e,n=e){let i=nP||(nP=document.createRange());return i.setEnd(t,n),i.setStart(t,e),i}function lc(t,e,n,i){let r={key:e,code:e,keyCode:n,which:n,cancelable:!0};i&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=i);let s=new KeyboardEvent("keydown",r);s.synthetic=!0,t.dispatchEvent(s);let o=new KeyboardEvent("keyup",r);return o.synthetic=!0,t.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function WU(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function wD(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function GU(t,e){let n=e.focusNode,i=e.focusOffset;if(!n||e.anchorNode!=n||e.anchorOffset!=i)return!1;for(i=Math.min(i,Ro(n));;)if(i){if(n.nodeType!=1)return!1;let r=n.childNodes[i-1];r.contentEditable=="false"?i--:(n=r,i=Ro(n))}else{if(n==t)return!0;i=Jl(n),n=n.parentNode}}function bD(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function xD(t,e){for(let n=t,i=e;;){if(n.nodeType==3&&i>0)return{node:n,offset:i};if(n.nodeType==1&&i>0){if(n.contentEditable=="false")return null;n=n.childNodes[i-1],i=Ro(n)}else if(n.parentNode&&!nv(n))i=Jl(n),n=n.parentNode;else return null}}function SD(t,e){for(let n=t,i=e;;){if(n.nodeType==3&&i<n.nodeValue.length)return{node:n,offset:i};if(n.nodeType==1&&i<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[i],i=0}else if(n.parentNode&&!nv(n))i=Jl(n)+1,n=n.parentNode;else return null}}class zn{constructor(e,n,i=!0){this.node=e,this.offset=n,this.precise=i}static before(e,n){return new zn(e.parentNode,Jl(e),n)}static after(e,n){return new zn(e.parentNode,Jl(e)+1,n)}}const kk=[];class xt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let n=this.posAtStart;for(let i of this.children){if(i==e)return n;n+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,n){if(this.flags&2){let i=this.dom,r=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=r?r.nextSibling:i.firstChild)){let a=xt.get(s);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,n),o.flags&=-8}if(s=r?r.nextSibling:i.firstChild,n&&!n.written&&n.node==i&&s!=o.dom&&(n.written=!0),o.dom.parentNode==i)for(;s&&s!=o.dom;)s=iP(s);else i.insertBefore(o.dom,s);r=o.dom}for(s=r?r.nextSibling:i.firstChild,s&&n&&n.node==i&&(n.written=!0);s;)s=iP(s)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,n),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,n){let i;if(e==this.dom)i=this.dom.childNodes[n];else{let r=Ro(e)==0?0:n==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!xt.get(i);)i=i.nextSibling;if(!i)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==i)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,n,i=0){let r=-1,s=-1,o=-1,a=-1;for(let l=0,u=i,c=i;l<this.children.length;l++){let d=this.children[l],h=u+d.length;if(u<e&&h>n)return d.domBoundsAround(e,n,u);if(h>=e&&r==-1&&(r=l,s=u),u>n&&d.dom.parentNode==this.dom){o=l,a=c;break}c=h,u=h+d.breakAfter}return{from:s,to:a<0?i+this.length:a,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let n=this.parent;n;n=n.parent){if(e&&(n.flags|=2),n.flags&1)return;n.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let n=e.parent;if(!n)return e;e=n}}replaceChildren(e,n,i=kk){this.markDirty();for(let r=e;r<n;r++){let s=this.children[r];s.parent==this&&i.indexOf(s)<0&&s.destroy()}this.children.splice(e,n-e,...i);for(let r=0;r<i.length;r++)i[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new kD(this.children,e,this.children.length)}childPos(e,n=1){return this.childCursor().findPos(e,n)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,n,i,r,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}xt.prototype.breakAfter=0;function iP(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class kD{constructor(e,n,i){this.children=e,this.pos=n,this.i=i,this.off=0}findPos(e,n=1){for(;;){if(e>this.pos||e==this.pos&&(n>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function _D(t,e,n,i,r,s,o,a,l){let{children:u}=t,c=u.length?u[e]:null,d=s.length?s[s.length-1]:null,h=d?d.breakAfter:o;if(!(e==i&&c&&!o&&!h&&s.length<2&&c.merge(n,r,s.length?d:null,n==0,a,l))){if(i<u.length){let f=u[i];f&&(r<f.length||f.breakAfter&&(d!=null&&d.breakAfter))?(e==i&&(f=f.split(r),r=0),!h&&d&&f.merge(0,r,d,!0,0,l)?s[s.length-1]=f:((r||f.children.length&&!f.children[0].length)&&f.merge(0,r,null,!1,0,l),s.push(f))):f!=null&&f.breakAfter&&(d?d.breakAfter=1:o=1),i++}for(c&&(c.breakAfter=o,n>0&&(!o&&s.length&&c.merge(n,c.length,s[0],!1,a,0)?c.breakAfter=s.shift().breakAfter:(n<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(n,c.length,null,!1,a,0),e++));e<i&&s.length;)if(u[i-1].become(s[s.length-1]))i--,s.pop(),l=s.length?0:a;else if(u[e].become(s[0]))e++,s.shift(),a=s.length?0:l;else break;!s.length&&e&&i<u.length&&!u[e-1].breakAfter&&u[i].merge(0,0,u[e-1],!1,a,l)&&e--,(e<i||s.length)&&t.replaceChildren(e,i,s)}}function CD(t,e,n,i,r,s){let o=t.childCursor(),{i:a,off:l}=o.findPos(n,1),{i:u,off:c}=o.findPos(e,-1),d=e-n;for(let h of i)d+=h.length;t.length+=d,_D(t,u,c,a,l,i,0,r,s)}let bi=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Kx=typeof document<"u"?document:{documentElement:{style:{}}};const Xx=/Edge\/(\d+)/.exec(bi.userAgent),ED=/MSIE \d/.test(bi.userAgent),qx=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(bi.userAgent),by=!!(ED||qx||Xx),rP=!by&&/gecko\/(\d+)/i.test(bi.userAgent),tw=!by&&/Chrome\/(\d+)/.exec(bi.userAgent),sP="webkitFontSmoothing"in Kx.documentElement.style,AD=!by&&/Apple Computer/.test(bi.vendor),oP=AD&&(/Mobile\/\w+/.test(bi.userAgent)||bi.maxTouchPoints>2);var be={mac:oP||/Mac/.test(bi.platform),windows:/Win/.test(bi.platform),linux:/Linux|X11/.test(bi.platform),ie:by,ie_version:ED?Kx.documentMode||6:qx?+qx[1]:Xx?+Xx[1]:0,gecko:rP,gecko_version:rP?+(/Firefox\/(\d+)/.exec(bi.userAgent)||[0,0])[1]:0,chrome:!!tw,chrome_version:tw?+tw[1]:0,ios:oP,android:/Android\b/.test(bi.userAgent),webkit:sP,safari:AD,webkit_version:sP?+(/\bAppleWebKit\/(\d+)/.exec(bi.userAgent)||[0,0])[1]:0,tabSize:Kx.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const KU=256;class ts extends xt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,n){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(n&&n.node==this.dom&&(n.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,n,i){return this.flags&8||i&&(!(i instanceof ts)||this.length-(n-e)+i.length>KU||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(n),this.markDirty(),!0)}split(e){let n=new ts(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),n.flags|=this.flags&8,n}localPosFromDOM(e,n){return e==this.dom?n:n?this.text.length:0}domAtPos(e){return new zn(this.dom,e)}domBoundsAround(e,n,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,n){return XU(this.dom,e,n)}}class No extends xt{constructor(e,n=[],i=0){super(),this.mark=e,this.children=n,this.length=i;for(let r of n)r.setParent(this)}setAttrs(e){if(wD(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let n in this.mark.attrs)e.setAttribute(n,this.mark.attrs[n]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,n){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,n)}merge(e,n,i,r,s,o){return i&&(!(i instanceof No&&i.mark.eq(this.mark))||e&&s<=0||n<this.length&&o<=0)?!1:(CD(this,e,n,i?i.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let n=[],i=0,r=-1,s=0;for(let a of this.children){let l=i+a.length;l>e&&n.push(i<e?a.split(e-i):a),r<0&&i>=e&&(r=s),i=l,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new No(this.mark,n,o)}domAtPos(e){return PD(this,e)}coordsAt(e,n){return RD(this,e,n)}}function XU(t,e,n){let i=t.nodeValue.length;e>i&&(e=i);let r=e,s=e,o=0;e==0&&n<0||e==i&&n>=0?be.chrome||be.gecko||(e?(r--,o=1):s<i&&(s++,o=-1)):n<0?r--:s<i&&s++;let a=Zl(t,r,s).getClientRects();if(!a.length)return null;let l=a[(o?o<0:n>=0)?0:a.length-1];return be.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,u=>u.width)||l),o?Sk(l,o<0):l||null}class ma extends xt{static create(e,n,i){return new ma(e,n,i)}constructor(e,n,i){super(),this.widget=e,this.length=n,this.side=i,this.prevWidget=null}split(e){let n=ma.create(this.widget,this.length-e,this.side);return this.length-=e,n}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,n,i,r,s,o){return i&&(!(i instanceof ma)||!this.widget.compare(i.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-n),!0)}become(e){return e instanceof ma&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return ot.empty;let e=this;for(;e.parent;)e=e.parent;let{view:n}=e,i=n&&n.state.doc,r=this.posAtStart;return i?i.slice(r,r+this.length):ot.empty}domAtPos(e){return(this.length?e==0:this.side>0)?zn.before(this.dom):zn.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,n){let i=this.widget.coordsAt(this.dom,e,n);if(i)return i;let r=this.dom.getClientRects(),s=null;if(!r.length)return null;let o=this.side?this.side<0:e>0;for(let a=o?r.length-1:0;s=r[a],!(e>0?a==0:a==r.length-1||s.top<s.bottom);a+=o?-1:1);return Sk(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Dc extends xt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Dc&&e.side==this.side}split(){return new Dc(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?zn.before(this.dom):zn.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ot.empty}get isHidden(){return!0}}ts.prototype.children=ma.prototype.children=Dc.prototype.children=kk;function PD(t,e){let n=t.dom,{children:i}=t,r=0;for(let s=0;r<i.length;r++){let o=i[r],a=s+o.length;if(!(a==s&&o.getSide()<=0)){if(e>s&&e<a&&o.dom.parentNode==n)return o.domAtPos(e-s);if(e<=s)break;s=a}}for(let s=r;s>0;s--){let o=i[s-1];if(o.dom.parentNode==n)return o.domAtPos(o.length)}for(let s=r;s<i.length;s++){let o=i[s];if(o.dom.parentNode==n)return o.domAtPos(0)}return new zn(n,0)}function TD(t,e,n){let i,{children:r}=t;n>0&&e instanceof No&&r.length&&(i=r[r.length-1])instanceof No&&i.mark.eq(e.mark)?TD(i,e.children[0],n-1):(r.push(e),e.setParent(t)),t.length+=e.length}function RD(t,e,n){let i=null,r=-1,s=null,o=-1;function a(u,c){for(let d=0,h=0;d<u.children.length&&h<=c;d++){let f=u.children[d],p=h+f.length;p>=c&&(f.children.length?a(f,c-h):(!s||s.isHidden&&n>0)&&(p>c||h==p&&f.getSide()>0)?(s=f,o=c-h):(h<c||h==p&&f.getSide()<0&&!f.isHidden)&&(i=f,r=c-h)),h=p}}a(t,e);let l=(n<0?i:s)||i||s;return l?l.coordsAt(Math.max(0,l==i?r:o),n):qU(t)}function qU(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let n=rf(e);return n[n.length-1]||null}function Yx(t,e){for(let n in t)n=="class"&&e.class?e.class+=" "+t.class:n=="style"&&e.style?e.style+=";"+t.style:e[n]=t[n];return e}const aP=Object.create(null);function iv(t,e,n){if(t==e)return!0;t||(t=aP),e||(e=aP);let i=Object.keys(t),r=Object.keys(e);if(i.length-(n&&i.indexOf(n)>-1?1:0)!=r.length-(n&&r.indexOf(n)>-1?1:0))return!1;for(let s of i)if(s!=n&&(r.indexOf(s)==-1||t[s]!==e[s]))return!1;return!0}function Jx(t,e,n){let i=!1;if(e)for(let r in e)n&&r in n||(i=!0,r=="style"?t.style.cssText="":t.removeAttribute(r));if(n)for(let r in n)e&&e[r]==n[r]||(i=!0,r=="style"?t.style.cssText=n[r]:t.setAttribute(r,n[r]));return i}function YU(t){let e=Object.create(null);for(let n=0;n<t.attributes.length;n++){let i=t.attributes[n];e[i.name]=i.value}return e}class Jt extends xt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,n,i,r,s,o){if(i){if(!(i instanceof Jt))return!1;this.dom||i.transferDOM(this)}return r&&this.setDeco(i?i.attrs:null),CD(this,e,n,i?i.children.slice():[],s,o),!0}split(e){let n=new Jt;if(n.breakAfter=this.breakAfter,this.length==0)return n;let{i,off:r}=this.childPos(e);r&&(n.append(this.children[i].split(r),0),this.children[i].merge(r,this.children[i].length,null,!1,0,0),i++);for(let s=i;s<this.children.length;s++)n.append(this.children[s],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,n}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){iv(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,n){TD(this,e,n)}addLineDeco(e){let n=e.spec.attributes,i=e.spec.class;n&&(this.attrs=Yx(n,this.attrs||{})),i&&(this.attrs=Yx({class:i},this.attrs||{}))}domAtPos(e){return PD(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,n){var i;this.dom?this.flags&4&&(wD(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Jx(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,n);let r=this.dom.lastChild;for(;r&&xt.get(r)instanceof No;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((i=xt.get(r))===null||i===void 0?void 0:i.isEditable)==!1&&(!be.ios||!this.children.some(s=>s instanceof ts))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,n;for(let i of this.children){if(!(i instanceof ts)||/[^ -~]/.test(i.text))return null;let r=rf(i.dom);if(r.length!=1)return null;e+=r[0].width,n=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:n}:null}coordsAt(e,n){let i=RD(this,e,n);if(!this.children.length&&i&&this.parent){let{heightOracle:r}=this.parent.view.viewState,s=i.bottom-i.top;if(Math.abs(s-r.lineHeight)<2&&r.textHeight<s){let o=(s-r.textHeight)/2;return{top:i.top+o,bottom:i.bottom-o,left:i.left,right:i.left}}}return i}become(e){return e instanceof Jt&&this.children.length==0&&e.children.length==0&&iv(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,n){for(let i=0,r=0;i<e.children.length;i++){let s=e.children[i],o=r+s.length;if(o>=n){if(s instanceof Jt)return s;if(o>n)break}r=o+s.breakAfter}return null}}class ko extends xt{constructor(e,n,i){super(),this.widget=e,this.length=n,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,n,i,r,s,o){return i&&(!(i instanceof ko)||!this.widget.compare(i.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-n),!0)}domAtPos(e){return e==0?zn.before(this.dom):zn.after(this.dom,e==this.length)}split(e){let n=this.length-e;this.length=e;let i=new ko(this.widget,n,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return kk}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ot.empty}domBoundsAround(){return null}become(e){return e instanceof ko&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,n){return this.widget.coordsAt(this.dom,e,n)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:n,endSide:i}=this.deco;return n==i?!1:e<0?n<0:i>0}}class il{eq(e){return!1}updateDOM(e,n){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,n,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var ii=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(ii||(ii={}));class Ge extends ql{constructor(e,n,i,r){super(),this.startSide=e,this.endSide=n,this.widget=i,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Jf(e)}static widget(e){let n=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return n+=i&&!e.inlineOrder?n>0?3e8:-4e8:n>0?1e8:-1e8,new za(e,n,n,i,e.widget||null,!1)}static replace(e){let n=!!e.block,i,r;if(e.isBlockGap)i=-5e8,r=4e8;else{let{start:s,end:o}=ND(e,n);i=(s?n?-3e8:-1:5e8)-1,r=(o?n?2e8:1:-6e8)+1}return new za(e,i,r,n,e.widget||null,!0)}static line(e){return new Zf(e)}static set(e,n=!1){return ct.of(e,n)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ge.none=ct.empty;class Jf extends Ge{constructor(e){let{start:n,end:i}=ND(e);super(n?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var n,i;return this==e||e instanceof Jf&&this.tagName==e.tagName&&(this.class||((n=this.attrs)===null||n===void 0?void 0:n.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&iv(this.attrs,e.attrs,"class")}range(e,n=e){if(e>=n)throw new RangeError("Mark decorations may not be empty");return super.range(e,n)}}Jf.prototype.point=!1;class Zf extends Ge{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Zf&&this.spec.class==e.spec.class&&iv(this.spec.attributes,e.spec.attributes)}range(e,n=e){if(n!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,n)}}Zf.prototype.mapMode=xi.TrackBefore;Zf.prototype.point=!0;class za extends Ge{constructor(e,n,i,r,s,o){super(n,i,s,e),this.block=r,this.isReplace=o,this.mapMode=r?n<=0?xi.TrackBefore:xi.TrackAfter:xi.TrackDel}get type(){return this.startSide!=this.endSide?ii.WidgetRange:this.startSide<=0?ii.WidgetBefore:ii.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof za&&JU(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,n=e){if(this.isReplace&&(e>n||e==n&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&n!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,n)}}za.prototype.point=!0;function ND(t,e=!1){let{inclusiveStart:n,inclusiveEnd:i}=t;return n==null&&(n=t.inclusive),i==null&&(i=t.inclusive),{start:n??e,end:i??e}}function JU(t,e){return t==e||!!(t&&e&&t.compare(e))}function Zx(t,e,n,i=0){let r=n.length-1;r>=0&&n[r]+i>=t?n[r]=Math.max(n[r],e):n.push(t,e)}class bh{constructor(e,n,i,r){this.doc=e,this.pos=n,this.end=i,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=n}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof ko&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Jt),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Yp(new Dc(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof ko)&&this.getLine()}buildText(e,n,i){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(n.slice(n.length-i)),this.getLine().append(Yp(new ts(this.text.slice(this.textOff,this.textOff+r)),n),i),this.atCursorPos=!0,this.textOff+=r,e-=r,i=0}}span(e,n,i,r){this.buildText(n-e,i,r),this.pos=n,this.openStart<0&&(this.openStart=r)}point(e,n,i,r,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof za){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(n>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=n-e;if(i instanceof za)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new ko(i.widget||Ic.block,a,i));else{let l=ma.create(i.widget||Ic.inline,a,a?0:i.startSide),u=this.atCursorPos&&!l.isEditable&&s<=r.length&&(e<n||i.startSide>0),c=!l.isEditable&&(e<n||s>r.length||i.startSide<=0),d=this.getLine();this.pendingBuffer==2&&!u&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),u&&(d.append(Yp(new Dc(1),r),s),s=r.length+Math.max(0,s-r.length)),d.append(Yp(l,r),s),this.atCursorPos=c,this.pendingBuffer=c?e<n||s>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=n),this.openStart<0&&(this.openStart=s)}static build(e,n,i,r,s){let o=new bh(e,n,i,s);return o.openEnd=ct.spans(r,n,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function Yp(t,e){for(let n of e)t=new No(n,[t],t.length);return t}class Ic extends il{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Ic.inline=new Ic("span");Ic.block=new Ic("div");var Nt=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(Nt||(Nt={}));const Ql=Nt.LTR,_k=Nt.RTL;function MD(t){let e=[];for(let n=0;n<t.length;n++)e.push(1<<+t[n]);return e}const ZU=MD("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),QU=MD("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Qx=Object.create(null),ds=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),n=t.charCodeAt(1);Qx[e]=n,Qx[n]=-e}function OD(t){return t<=247?ZU[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?QU[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const eV=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ga{get dir(){return this.level%2?_k:Ql}constructor(e,n,i){this.from=e,this.to=n,this.level=i}side(e,n){return this.dir==n==e?this.to:this.from}forward(e,n){return e==(this.dir==n)}static find(e,n,i,r){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=n&&a.to>=n){if(a.level==i)return o;(s<0||(r!=0?r<0?a.from<n:a.to>n:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function DD(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++){let i=t[n],r=e[n];if(i.from!=r.from||i.to!=r.to||i.direction!=r.direction||!DD(i.inner,r.inner))return!1}return!0}const yt=[];function tV(t,e,n,i,r){for(let s=0;s<=i.length;s++){let o=s?i[s-1].to:e,a=s<i.length?i[s].from:n,l=s?256:r;for(let u=o,c=l,d=l;u<a;u++){let h=OD(t.charCodeAt(u));h==512?h=c:h==8&&d==4&&(h=16),yt[u]=h==4?2:h,h&7&&(d=h),c=h}for(let u=o,c=l,d=l;u<a;u++){let h=yt[u];if(h==128)u<a-1&&c==yt[u+1]&&c&24?h=yt[u]=c:yt[u]=256;else if(h==64){let f=u+1;for(;f<a&&yt[f]==64;)f++;let p=u&&c==8||f<n&&yt[f]==8?d==1?1:8:256;for(let m=u;m<f;m++)yt[m]=p;u=f-1}else h==8&&d==1&&(yt[u]=1);c=h,h&7&&(d=h)}}}function nV(t,e,n,i,r){let s=r==1?2:1;for(let o=0,a=0,l=0;o<=i.length;o++){let u=o?i[o-1].to:e,c=o<i.length?i[o].from:n;for(let d=u,h,f,p;d<c;d++)if(f=Qx[h=t.charCodeAt(d)])if(f<0){for(let m=a-3;m>=0;m-=3)if(ds[m+1]==-f){let w=ds[m+2],v=w&2?r:w&4?w&1?s:r:0;v&&(yt[d]=yt[ds[m]]=v),a=m;break}}else{if(ds.length==189)break;ds[a++]=d,ds[a++]=h,ds[a++]=l}else if((p=yt[d])==2||p==1){let m=p==r;l=m?0:1;for(let w=a-3;w>=0;w-=3){let v=ds[w+2];if(v&2)break;if(m)ds[w+2]|=2;else{if(v&4)break;ds[w+2]|=4}}}}}function iV(t,e,n,i){for(let r=0,s=i;r<=n.length;r++){let o=r?n[r-1].to:t,a=r<n.length?n[r].from:e;for(let l=o;l<a;){let u=yt[l];if(u==256){let c=l+1;for(;;)if(c==a){if(r==n.length)break;c=n[r++].to,a=r<n.length?n[r].from:e}else if(yt[c]==256)c++;else break;let d=s==1,h=(c<e?yt[c]:i)==1,f=d==h?d?1:2:i;for(let p=c,m=r,w=m?n[m-1].to:t;p>l;)p==w&&(p=n[--m].from,w=m?n[m-1].to:t),yt[--p]=f;l=c}else s=u,l++}}}function e1(t,e,n,i,r,s,o){let a=i%2?2:1;if(i%2==r%2)for(let l=e,u=0;l<n;){let c=!0,d=!1;if(u==s.length||l<s[u].from){let m=yt[l];m!=a&&(c=!1,d=m==16)}let h=!c&&a==1?[]:null,f=c?i:i+1,p=l;e:for(;;)if(u<s.length&&p==s[u].from){if(d)break e;let m=s[u];if(!c)for(let w=m.to,v=u+1;;){if(w==n)break e;if(v<s.length&&s[v].from==w)w=s[v++].to;else{if(yt[w]==a)break e;break}}if(u++,h)h.push(m);else{m.from>l&&o.push(new ga(l,m.from,f));let w=m.direction==Ql!=!(f%2);t1(t,w?i+1:i,r,m.inner,m.from,m.to,o),l=m.to}p=m.to}else{if(p==n||(c?yt[p]!=a:yt[p]==a))break;p++}h?e1(t,l,p,i+1,r,h,o):l<p&&o.push(new ga(l,p,f)),l=p}else for(let l=n,u=s.length;l>e;){let c=!0,d=!1;if(!u||l>s[u-1].to){let m=yt[l-1];m!=a&&(c=!1,d=m==16)}let h=!c&&a==1?[]:null,f=c?i:i+1,p=l;e:for(;;)if(u&&p==s[u-1].to){if(d)break e;let m=s[--u];if(!c)for(let w=m.from,v=u;;){if(w==e)break e;if(v&&s[v-1].to==w)w=s[--v].from;else{if(yt[w-1]==a)break e;break}}if(h)h.push(m);else{m.to<l&&o.push(new ga(m.to,l,f));let w=m.direction==Ql!=!(f%2);t1(t,w?i+1:i,r,m.inner,m.from,m.to,o),l=m.from}p=m.from}else{if(p==e||(c?yt[p-1]!=a:yt[p-1]==a))break;p--}h?e1(t,p,l,i+1,r,h,o):p<l&&o.push(new ga(p,l,f)),l=p}}function t1(t,e,n,i,r,s,o){let a=e%2?2:1;tV(t,r,s,i,a),nV(t,r,s,i,a),iV(r,s,i,a),e1(t,r,s,e,n,i,o)}function rV(t,e,n){if(!t)return[new ga(0,0,e==_k?1:0)];if(e==Ql&&!n.length&&!eV.test(t))return ID(t.length);if(n.length)for(;t.length>yt.length;)yt[yt.length]=256;let i=[],r=e==Ql?0:1;return t1(t,r,r,n,0,t.length,i),i}function ID(t){return[new ga(0,t,0)]}let LD="";function sV(t,e,n,i,r){var s;let o=i.head-t.from,a=ga.find(e,o,(s=i.bidiLevel)!==null&&s!==void 0?s:-1,i.assoc),l=e[a],u=l.side(r,n);if(o==u){let h=a+=r?1:-1;if(h<0||h>=e.length)return null;l=e[a=h],o=l.side(!r,n),u=l.side(r,n)}let c=Tn(t.text,o,l.forward(r,n));(c<l.from||c>l.to)&&(c=u),LD=t.text.slice(Math.min(o,c),Math.max(o,c));let d=a==(r?e.length-1:0)?null:e[a+(r?1:-1)];return d&&c==u&&d.level+(r?0:1)<l.level?ne.cursor(d.side(!r,n)+t.from,d.forward(r,n)?1:-1,d.level):ne.cursor(c+t.from,l.forward(r,n)?-1:1,l.level)}function oV(t,e,n){for(let i=e;i<n;i++){let r=OD(t.charCodeAt(i));if(r==1)return Ql;if(r==2||r==4)return _k}return Ql}const jD=_e.define(),FD=_e.define(),BD=_e.define(),$D=_e.define(),n1=_e.define(),zD=_e.define(),UD=_e.define(),VD=_e.define({combine:t=>t.some(e=>e)}),HD=_e.define({combine:t=>t.some(e=>e)}),WD=_e.define();class uc{constructor(e,n="nearest",i="nearest",r=5,s=5,o=!1){this.range=e,this.y=n,this.x=i,this.yMargin=r,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new uc(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new uc(ne.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Jp=Xe.define({map:(t,e)=>t.map(e)}),GD=Xe.define();function Vi(t,e,n){let i=t.facet($D);i.length?i[0](e):window.onerror?window.onerror(String(e),n,void 0,void 0,e):n?console.error(n+":",e):console.error(e)}const ra=_e.define({combine:t=>t.length?t[0]:!0});let aV=0;const Gd=_e.define();class Dn{constructor(e,n,i,r,s){this.id=e,this.create=n,this.domEventHandlers=i,this.domEventObservers=r,this.extension=s(this)}static define(e,n){const{eventHandlers:i,eventObservers:r,provide:s,decorations:o}=n||{};return new Dn(aV++,e,i,r,a=>{let l=[Gd.of(a)];return o&&l.push(sf.of(u=>{let c=u.plugin(a);return c?o(c):Ge.none})),s&&l.push(s(a)),l})}static fromClass(e,n){return Dn.define(i=>new e(i),n)}}class nw{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let n=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(n)}catch(i){if(Vi(n.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(n){Vi(e.state,n,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var n;if(!((n=this.value)===null||n===void 0)&&n.destroy)try{this.value.destroy()}catch(i){Vi(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const KD=_e.define(),Ck=_e.define(),sf=_e.define(),XD=_e.define(),Ek=_e.define(),qD=_e.define();function lP(t,e){let n=t.state.facet(qD);if(!n.length)return n;let i=n.map(s=>s instanceof Function?s(t):s),r=[];return ct.spans(i,e.from,e.to,{point(){},span(s,o,a,l){let u=s-e.from,c=o-e.from,d=r;for(let h=a.length-1;h>=0;h--,l--){let f=a[h].spec.bidiIsolate,p;if(f==null&&(f=oV(e.text,u,c)),l>0&&d.length&&(p=d[d.length-1]).to==u&&p.direction==f)p.to=c,d=p.inner;else{let m={from:u,to:c,direction:f,inner:[]};d.push(m),d=m.inner}}}}),r}const YD=_e.define();function JD(t){let e=0,n=0,i=0,r=0;for(let s of t.state.facet(YD)){let o=s(t);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(n=Math.max(n,o.right)),o.top!=null&&(i=Math.max(i,o.top)),o.bottom!=null&&(r=Math.max(r,o.bottom)))}return{left:e,right:n,top:i,bottom:r}}const Kd=_e.define();class Sr{constructor(e,n,i,r){this.fromA=e,this.toA=n,this.fromB=i,this.toB=r}join(e){return new Sr(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let n=e.length,i=this;for(;n>0;n--){let r=e[n-1];if(!(r.fromA>i.toA)){if(r.toA<i.fromA)break;i=i.join(r),e.splice(n-1,1)}}return e.splice(n,0,i),e}static extendWithRanges(e,n){if(n.length==0)return e;let i=[];for(let r=0,s=0,o=0,a=0;;r++){let l=r==e.length?null:e[r],u=o-a,c=l?l.fromB:1e9;for(;s<n.length&&n[s]<c;){let d=n[s],h=n[s+1],f=Math.max(a,d),p=Math.min(c,h);if(f<=p&&new Sr(f+u,p+u,f,p).addToSet(i),h>c)break;s+=2}if(!l)return i;new Sr(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,a=l.toB}}}class rv{constructor(e,n,i){this.view=e,this.state=n,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=rn.empty(this.startState.doc.length);for(let s of i)this.changes=this.changes.compose(s.changes);let r=[];this.changes.iterChangedRanges((s,o,a,l)=>r.push(new Sr(s,o,a,l))),this.changedRanges=r}static create(e,n,i){return new rv(e,n,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class uP extends xt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Ge.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Jt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Sr(0,0,0,e.state.doc.length)],0,null)}update(e){var n;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:u,toA:c})=>c<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let r=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((n=this.domChanged)===null||n===void 0)&&n.newSel?r=this.domChanged.newSel.head:!pV(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let s=r>-1?uV(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:u,to:c}=this.hasComposition;i=new Sr(u,c,e.changes.mapPos(u,-1),e.changes.mapPos(c,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(be.ie||be.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.updateDeco(),l=hV(o,a,e.changes);return i=Sr.extendWithRanges(i,l),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,n,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,n,i);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=be.chrome||be.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||r.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof ko&&o.widget instanceof cP&&s.push(o.dom);r.updateGaps(s)}updateChildren(e,n,i){let r=i?i.range.addToSet(e.slice()):e,s=this.childCursor(n);for(let o=r.length-1;;o--){let a=o>=0?r[o]:null;if(!a)break;let{fromA:l,toA:u,fromB:c,toB:d}=a,h,f,p,m;if(i&&i.range.fromB<d&&i.range.toB>c){let k=bh.build(this.view.state.doc,c,i.range.fromB,this.decorations,this.dynamicDecorationMap),_=bh.build(this.view.state.doc,i.range.toB,d,this.decorations,this.dynamicDecorationMap);f=k.breakAtStart,p=k.openStart,m=_.openEnd;let E=this.compositionView(i);_.breakAtStart?E.breakAfter=1:_.content.length&&E.merge(E.length,E.length,_.content[0],!1,_.openStart,0)&&(E.breakAfter=_.content[0].breakAfter,_.content.shift()),k.content.length&&E.merge(0,0,k.content[k.content.length-1],!0,0,k.openEnd)&&k.content.pop(),h=k.content.concat(E).concat(_.content)}else({content:h,breakAtStart:f,openStart:p,openEnd:m}=bh.build(this.view.state.doc,c,d,this.decorations,this.dynamicDecorationMap));let{i:w,off:v}=s.findPos(u,1),{i:y,off:b}=s.findPos(l,-1);_D(this,y,b,w,v,h,f,p,m)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let n of e.transactions)for(let i of n.effects)i.is(GD)&&(this.editContextFormatting=i.value)}compositionView(e){let n=new ts(e.text.nodeValue);n.flags|=8;for(let{deco:r}of e.marks)n=new No(r,[n],n.length);let i=new Jt;return i.append(n,0),i}fixCompositionDOM(e){let n=(s,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let a=xt.get(s);a&&a!=o&&(a.dom=null),o.setDOM(s)},i=this.childPos(e.range.fromB,1),r=this.children[i.i];n(e.line,r);for(let s=e.marks.length-1;s>=-1;s--)i=r.childPos(i.off,1),r=r.children[i.i],n(s>=0?e.marks[s].node:e.text,r)}updateSelection(e=!1,n=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,r=i==this.dom,s=!r&&Qm(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(r||n||s))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),u=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(be.gecko&&a.empty&&!this.hasComposition&&lV(l)){let d=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(d,l.node.childNodes[l.offset]||null)),l=u=new zn(d,0),o=!0}let c=this.view.observer.selectionRange;(o||!c.focusNode||(!wh(l.node,l.offset,c.anchorNode,c.anchorOffset)||!wh(u.node,u.offset,c.focusNode,c.focusOffset))&&!this.suppressWidgetCursorChange(c,a))&&(this.view.observer.ignore(()=>{be.android&&be.chrome&&this.dom.contains(c.focusNode)&&fV(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let d=nf(this.view.root);if(d)if(a.empty){if(be.gecko){let h=cV(l.node,l.offset);if(h&&h!=3){let f=(h==1?xD:SD)(l.node,l.offset);f&&(l=new zn(f.node,f.offset))}}d.collapse(l.node,l.offset),a.bidiLevel!=null&&d.caretBidiLevel!==void 0&&(d.caretBidiLevel=a.bidiLevel)}else if(d.extend){d.collapse(l.node,l.offset);try{d.extend(u.node,u.offset)}catch{}}else{let h=document.createRange();a.anchor>a.head&&([l,u]=[u,l]),h.setEnd(u.node,u.offset),h.setStart(l.node,l.offset),d.removeAllRanges(),d.addRange(h)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(l,u)),this.impreciseAnchor=l.precise?null:new zn(c.anchorNode,c.anchorOffset),this.impreciseHead=u.precise?null:new zn(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(e,n){return this.hasComposition&&n.empty&&wh(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==n.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,n=e.state.selection.main,i=nf(e.root),{anchorNode:r,anchorOffset:s}=e.observer.selectionRange;if(!i||!n.empty||!n.assoc||!i.modify)return;let o=Jt.find(this,n.head);if(!o)return;let a=o.posAtStart;if(n.head==a||n.head==a+o.length)return;let l=this.coordsAt(n.head,-1),u=this.coordsAt(n.head,1);if(!l||!u||l.bottom>u.top)return;let c=this.domAtPos(n.head+n.assoc);i.collapse(c.node,c.offset),i.modify("move",n.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let d=e.observer.selectionRange;e.docView.posFromDOM(d.anchorNode,d.anchorOffset)!=n.from&&i.collapse(r,s)}moveToLine(e){let n=this.dom,i;if(e.node!=n)return e;for(let r=e.offset;!i&&r<n.childNodes.length;r++){let s=xt.get(n.childNodes[r]);s instanceof Jt&&(i=s.domAtPos(0))}for(let r=e.offset-1;!i&&r>=0;r--){let s=xt.get(n.childNodes[r]);s instanceof Jt&&(i=s.domAtPos(s.length))}return i?new zn(i.node,i.offset,!0):e}nearest(e){for(let n=e;n;){let i=xt.get(n);if(i&&i.rootView==this)return i;n=n.parentNode}return null}posFromDOM(e,n){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,n)+i.posAtStart}domAtPos(e){let{i:n,off:i}=this.childCursor().findPos(e,-1);for(;n<this.children.length-1;){let r=this.children[n];if(i<r.length||r instanceof Jt)break;n++,i=0}return this.children[n].domAtPos(i)}coordsAt(e,n){let i=null,r=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=s-a.breakAfter,u=l-a.length;if(l<e)break;if(u<=e&&(u<e||a.covers(-1))&&(l>e||a.covers(1))&&(!i||a instanceof Jt&&!(i instanceof Jt&&n>=0)))i=a,r=u;else if(i&&u==e&&l==e&&a instanceof ko&&Math.abs(n)<2){if(a.deco.startSide<0)break;o&&(i=null)}s=u}return i?i.coordsAt(e-r,n):null}coordsForChar(e){let{i:n,off:i}=this.childPos(e,1),r=this.children[n];if(!(r instanceof Jt))return null;for(;r.children.length;){let{i:a,off:l}=r.childPos(i,1);for(;;a++){if(a==r.children.length)return null;if((r=r.children[a]).length)break}i=l}if(!(r instanceof ts))return null;let s=Tn(r.text,i);if(s==i)return null;let o=Zl(r.dom,i,s).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let n=[],{from:i,to:r}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==Nt.LTR;for(let u=0,c=0;c<this.children.length;c++){let d=this.children[c],h=u+d.length;if(h>r)break;if(u>=i){let f=d.dom.getBoundingClientRect();if(n.push(f.height),o){let p=d.dom.lastChild,m=p?rf(p):[];if(m.length){let w=m[m.length-1],v=l?w.right-f.left:f.right-w.left;v>a&&(a=v,this.minWidth=s,this.minWidthFrom=u,this.minWidthTo=h)}}}u=h+d.breakAfter}return n}textDirectionAt(e){let{i:n}=this.childPos(e,1);return getComputedStyle(this.children[n].dom).direction=="rtl"?Nt.RTL:Nt.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Jt){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),n,i,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=rf(e.firstChild)[0];n=e.getBoundingClientRect().height,i=s?s.width/27:7,r=s?s.height:n,e.remove()}),{lineHeight:n,charWidth:i,textHeight:r}}childCursor(e=this.length){let n=this.children.length;return n&&(e-=this.children[--n].length),new kD(this.children,e,n)}computeBlockGapDeco(){let e=[],n=this.view.viewState;for(let i=0,r=0;;r++){let s=r==n.viewports.length?null:n.viewports[r],o=s?s.from-1:this.length;if(o>i){let a=(n.lineBlockAt(o).bottom-n.lineBlockAt(i).top)/this.view.scaleY;e.push(Ge.replace({widget:new cP(a),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return Ge.set(e)}updateDeco(){let e=1,n=this.view.state.facet(sf).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),i=!1,r=this.view.state.facet(XD).map((s,o)=>{let a=typeof s=="function";return a&&(i=!0),a?s(this.view):s});for(r.length&&(this.dynamicDecorationMap[e++]=i,n.push(ct.join(r))),this.decorations=[this.editContextFormatting,...n,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let u=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=u.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let u of this.view.state.facet(WD))try{if(u(this.view,e.range,e))return!0}catch(c){Vi(this.view.state,c,"scroll handler")}let{range:n}=e,i=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1),r;if(!i)return;!n.empty&&(r=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(i={left:Math.min(i.left,r.left),top:Math.min(i.top,r.top),right:Math.max(i.right,r.right),bottom:Math.max(i.bottom,r.bottom)});let s=JD(this.view),o={left:i.left-s.left,top:i.top-s.top,right:i.right+s.right,bottom:i.bottom+s.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;UU(this.view.scrollDOM,o,n.head<n.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==Nt.LTR)}}function lV(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}class cP extends il{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function ZD(t,e){let n=t.observer.selectionRange;if(!n.focusNode)return null;let i=xD(n.focusNode,n.focusOffset),r=SD(n.focusNode,n.focusOffset),s=i||r;if(r&&i&&r.node!=i.node){let a=xt.get(r.node);if(!a||a instanceof ts&&a.text!=r.node.nodeValue)s=r;else if(t.docView.lastCompositionAfterCursor){let l=xt.get(i.node);!l||l instanceof ts&&l.text!=i.node.nodeValue||(s=r)}}if(t.docView.lastCompositionAfterCursor=s!=i,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function uV(t,e,n){let i=ZD(t,n);if(!i)return null;let{node:r,from:s,to:o}=i,a=r.nodeValue;if(/[\n\r]/.test(a)||t.state.doc.sliceString(i.from,i.to)!=a)return null;let l=e.invertedDesc,u=new Sr(l.mapPos(s),l.mapPos(o),s,o),c=[];for(let d=r.parentNode;;d=d.parentNode){let h=xt.get(d);if(h instanceof No)c.push({node:d,deco:h.mark});else{if(h instanceof Jt||d.nodeName=="DIV"&&d.parentNode==t.contentDOM)return{range:u,text:r,marks:c,line:d};if(d!=t.contentDOM)c.push({node:d,deco:new Jf({inclusive:!0,attributes:YU(d),tagName:d.tagName.toLowerCase()})});else return null}}}function cV(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}let dV=class{constructor(){this.changes=[]}compareRange(e,n){Zx(e,n,this.changes)}comparePoint(e,n){Zx(e,n,this.changes)}};function hV(t,e,n){let i=new dV;return ct.compare(t,e,n,i),i.changes}function fV(t,e){for(let n=t;n&&n!=e;n=n.assignedSlot||n.parentNode)if(n.nodeType==1&&n.contentEditable=="false")return!0;return!1}function pV(t,e){let n=!1;return e&&t.iterChangedRanges((i,r)=>{i<e.to&&r>e.from&&(n=!0)}),n}function mV(t,e,n=1){let i=t.charCategorizer(e),r=t.doc.lineAt(e),s=e-r.from;if(r.length==0)return ne.cursor(e);s==0?n=1:s==r.length&&(n=-1);let o=s,a=s;n<0?o=Tn(r.text,s,!1):a=Tn(r.text,s);let l=i(r.text.slice(o,a));for(;o>0;){let u=Tn(r.text,o,!1);if(i(r.text.slice(u,o))!=l)break;o=u}for(;a<r.length;){let u=Tn(r.text,a);if(i(r.text.slice(a,u))!=l)break;a=u}return ne.range(o+r.from,a+r.from)}function gV(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function vV(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function iw(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function dP(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function hP(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function i1(t,e,n){let i,r,s,o,a=!1,l,u,c,d;for(let p=t.firstChild;p;p=p.nextSibling){let m=rf(p);for(let w=0;w<m.length;w++){let v=m[w];r&&iw(r,v)&&(v=dP(hP(v,r.bottom),r.top));let y=gV(e,v),b=vV(n,v);if(y==0&&b==0)return p.nodeType==3?fP(p,e,n):i1(p,e,n);if(!i||o>b||o==b&&s>y){i=p,r=v,s=y,o=b;let k=b?n<v.top?-1:1:y?e<v.left?-1:1:0;a=!k||(k>0?w<m.length-1:w>0)}y==0?n>v.bottom&&(!c||c.bottom<v.bottom)?(l=p,c=v):n<v.top&&(!d||d.top>v.top)&&(u=p,d=v):c&&iw(c,v)?c=hP(c,v.bottom):d&&iw(d,v)&&(d=dP(d,v.top))}}if(c&&c.bottom>=n?(i=l,r=c):d&&d.top<=n&&(i=u,r=d),!i)return{node:t,offset:0};let h=Math.max(r.left,Math.min(r.right,e));if(i.nodeType==3)return fP(i,h,n);if(a&&i.contentEditable!="false")return i1(i,h,n);let f=Array.prototype.indexOf.call(t.childNodes,i)+(e>=(r.left+r.right)/2?1:0);return{node:t,offset:f}}function fP(t,e,n){let i=t.nodeValue.length,r=-1,s=1e9,o=0;for(let a=0;a<i;a++){let l=Zl(t,a,a+1).getClientRects();for(let u=0;u<l.length;u++){let c=l[u];if(c.top==c.bottom)continue;o||(o=e-c.left);let d=(c.top>n?c.top-n:n-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&d<s){let h=e>=(c.left+c.right)/2,f=h;if((be.chrome||be.gecko)&&Zl(t,a).getBoundingClientRect().left==c.right&&(f=!h),d<=0)return{node:t,offset:a+(f?1:0)};r=a+(f?1:0),s=d}}}return{node:t,offset:r>-1?r:o>0?t.nodeValue.length:0}}function QD(t,e,n,i=-1){var r,s;let o=t.contentDOM.getBoundingClientRect(),a=o.top+t.viewState.paddingTop,l,{docHeight:u}=t.viewState,{x:c,y:d}=e,h=d-a;if(h<0)return 0;if(h>u)return t.state.doc.length;for(let k=t.viewState.heightOracle.textHeight/2,_=!1;l=t.elementAtHeight(h),l.type!=ii.Text;)for(;h=i>0?l.bottom+k:l.top-k,!(h>=0&&h<=u);){if(_)return n?null:0;_=!0,i=-i}d=a+h;let f=l.from;if(f<t.viewport.from)return t.viewport.from==0?0:n?null:pP(t,o,l,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:pP(t,o,l,c,d);let p=t.dom.ownerDocument,m=t.root.elementFromPoint?t.root:p,w=m.elementFromPoint(c,d);w&&!t.contentDOM.contains(w)&&(w=null),w||(c=Math.max(o.left+1,Math.min(o.right-1,c)),w=m.elementFromPoint(c,d),w&&!t.contentDOM.contains(w)&&(w=null));let v,y=-1;if(w&&((r=t.docView.nearest(w))===null||r===void 0?void 0:r.isEditable)!=!1){if(p.caretPositionFromPoint){let k=p.caretPositionFromPoint(c,d);k&&({offsetNode:v,offset:y}=k)}else if(p.caretRangeFromPoint){let k=p.caretRangeFromPoint(c,d);k&&({startContainer:v,startOffset:y}=k,(!t.contentDOM.contains(v)||be.safari&&yV(v,y,c)||be.chrome&&wV(v,y,c))&&(v=void 0))}}if(!v||!t.docView.dom.contains(v)){let k=Jt.find(t.docView,f);if(!k)return h>l.top+l.height/2?l.to:l.from;({node:v,offset:y}=i1(k.dom,c,d))}let b=t.docView.nearest(v);if(!b)return null;if(b.isWidget&&((s=b.dom)===null||s===void 0?void 0:s.nodeType)==1){let k=b.dom.getBoundingClientRect();return e.y<k.top||e.y<=k.bottom&&e.x<=(k.left+k.right)/2?b.posAtStart:b.posAtEnd}else return b.localPosFromDOM(v,y)+b.posAtStart}function pP(t,e,n,i,r){let s=Math.round((i-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&n.height>t.defaultLineHeight*1.5){let a=t.viewState.heightOracle.textHeight,l=Math.floor((r-n.top-(t.defaultLineHeight-a)*.5)/a);s+=l*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(n.from,n.to);return n.from+IU(o,s,t.state.tabSize)}function yV(t,e,n){let i;if(t.nodeType!=3||e!=(i=t.nodeValue.length))return!1;for(let r=t.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return Zl(t,i-1,i).getBoundingClientRect().left>n}function wV(t,e,n){if(e!=0)return!1;for(let r=t;;){let s=r.parentNode;if(!s||s.nodeType!=1||s.firstChild!=r)return!1;if(s.classList.contains("cm-line"))break;r=s}let i=t.nodeType==1?t.getBoundingClientRect():Zl(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return n-i.left>5}function r1(t,e){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){for(let i of n.type)if(i.to>e||i.to==e&&(i.to==n.to||i.type==ii.Text))return i}return n}function bV(t,e,n,i){let r=r1(t,e.head),s=!i||r.type!=ii.Text||!(t.lineWrapping||r.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(s){let o=t.dom.getBoundingClientRect(),a=t.textDirectionAt(r.from),l=t.posAtCoords({x:n==(a==Nt.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(l!=null)return ne.cursor(l,n?-1:1)}return ne.cursor(n?r.to:r.from,n?-1:1)}function mP(t,e,n,i){let r=t.state.doc.lineAt(e.head),s=t.bidiSpans(r),o=t.textDirectionAt(r.from);for(let a=e,l=null;;){let u=sV(r,s,o,a,n),c=LD;if(!u){if(r.number==(n?t.state.doc.lines:1))return a;c=`
`,r=t.state.doc.line(r.number+(n?1:-1)),s=t.bidiSpans(r),u=t.visualLineSide(r,!n)}if(l){if(!l(c))return a}else{if(!i)return u;l=i(c)}a=u}}function xV(t,e,n){let i=t.state.charCategorizer(e),r=i(n);return s=>{let o=i(s);return r==Rn.Space&&(r=o),r==o}}function SV(t,e,n,i){let r=e.head,s=n?1:-1;if(r==(n?t.state.doc.length:0))return ne.cursor(r,e.assoc);let o=e.goalColumn,a,l=t.contentDOM.getBoundingClientRect(),u=t.coordsAtPos(r,e.assoc||-1),c=t.documentTop;if(u)o==null&&(o=u.left-l.left),a=s<0?u.top:u.bottom;else{let f=t.viewState.lineBlockAt(r);o==null&&(o=Math.min(l.right-l.left,t.defaultCharacterWidth*(r-f.from))),a=(s<0?f.top:f.bottom)+c}let d=l.left+o,h=i??t.viewState.heightOracle.textHeight>>1;for(let f=0;;f+=10){let p=a+(h+f)*s,m=QD(t,{x:d,y:p},!1,s);if(p<l.top||p>l.bottom||(s<0?m<r:m>r)){let w=t.docView.coordsForChar(m),v=!w||p<w.top?-1:1;return ne.cursor(m,v,void 0,o)}}}function eg(t,e,n){for(;;){let i=0;for(let r of t)r.between(e-1,e+1,(s,o,a)=>{if(e>s&&e<o){let l=i||n||(e-s<o-e?-1:1);e=l<0?s:o,i=l}});if(!i)return e}}function rw(t,e,n){let i=eg(t.state.facet(Ek).map(r=>r(t)),n.from,e.head>n.from?-1:1);return i==n.from?n:ne.cursor(i,i<n.from?1:-1)}class kV{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,be.safari&&e.contentDOM.addEventListener("input",()=>null),be.gecko&&BV(e.contentDOM.ownerDocument)}handleEvent(e){!NV(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,n){let i=this.handlers[e];if(i){for(let r of i.observers)r(this.view,n);for(let r of i.handlers){if(n.defaultPrevented)break;if(r(this.view,n)){n.preventDefault();break}}}}ensureHandlers(e){let n=_V(e),i=this.handlers,r=this.view.contentDOM;for(let s in n)if(s!="scroll"){let o=!n[s].handlers.length,a=i[s];a&&o!=!a.handlers.length&&(r.removeEventListener(s,this.handleEvent),a=null),a||r.addEventListener(s,this.handleEvent,{passive:o})}for(let s in i)s!="scroll"&&!n[s]&&r.removeEventListener(s,this.handleEvent);this.handlers=n}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&tI.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),be.android&&be.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let n;return be.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((n=eI.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||CV.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=n||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let n=this.pendingIOSKey;return!n||n.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,lc(this.view.contentDOM,n.key,n.keyCode,n instanceof KeyboardEvent?n:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:be.safari&&!be.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function gP(t,e){return(n,i)=>{try{return e.call(t,i,n)}catch(r){Vi(n.state,r)}}}function _V(t){let e=Object.create(null);function n(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of t){let r=i.spec;if(r&&r.domEventHandlers)for(let s in r.domEventHandlers){let o=r.domEventHandlers[s];o&&n(s).handlers.push(gP(i.value,o))}if(r&&r.domEventObservers)for(let s in r.domEventObservers){let o=r.domEventObservers[s];o&&n(s).observers.push(gP(i.value,o))}}for(let i in ns)n(i).handlers.push(ns[i]);for(let i in Rr)n(i).observers.push(Rr[i]);return e}const eI=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],CV="dthko",tI=[16,17,18,20,91,92,224,225],Zp=6;function Qp(t){return Math.max(0,t)*.7+8}function EV(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}class AV{constructor(e,n,i,r){this.view=e,this.startEvent=n,this.style=i,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=n,this.scrollParents=VU(e.contentDOM),this.atoms=e.state.facet(Ek).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=n.shiftKey,this.multiple=e.state.facet(Je.allowMultipleSelections)&&PV(e,n),this.dragging=RV(e,n)&&rI(n)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&EV(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,i=0,r=0,s=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=JD(this.view);e.clientX-l.left<=r+Zp?n=-Qp(r-e.clientX):e.clientX+l.right>=o-Zp&&(n=Qp(e.clientX-o)),e.clientY-l.top<=s+Zp?i=-Qp(s-e.clientY):e.clientY+l.bottom>=a-Zp&&(i=Qp(e.clientY-a)),this.setScrollSpeed(n,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,n){this.scrollSpeed={x:e,y:n},e||n?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:n}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),n&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=n,n=0),(e||n)&&this.view.win.scrollBy(e,n),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let n=null;for(let i=0;i<e.ranges.length;i++){let r=e.ranges[i],s=null;if(r.empty){let o=eg(this.atoms,r.from,0);o!=r.from&&(s=ne.cursor(o,-1))}else{let o=eg(this.atoms,r.from,-1),a=eg(this.atoms,r.to,1);(o!=r.from||a!=r.to)&&(s=ne.range(r.from==r.anchor?o:a,r.from==r.head?o:a))}s&&(n||(n=e.ranges.slice()),n[i]=s)}return n?ne.create(n,e.mainIndex):e}select(e){let{view:n}=this,i=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(n.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(n=>n.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function PV(t,e){let n=t.state.facet(jD);return n.length?n[0](e):be.mac?e.metaKey:e.ctrlKey}function TV(t,e){let n=t.state.facet(FD);return n.length?n[0](e):be.mac?!e.altKey:!e.ctrlKey}function RV(t,e){let{main:n}=t.state.selection;if(n.empty)return!1;let i=nf(t.root);if(!i||i.rangeCount==0)return!0;let r=i.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function NV(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target,i;n!=t.contentDOM;n=n.parentNode)if(!n||n.nodeType==11||(i=xt.get(n))&&i.ignoreEvent(e))return!1;return!0}const ns=Object.create(null),Rr=Object.create(null),nI=be.ie&&be.ie_version<15||be.ios&&be.webkit_version<604;function MV(t){let e=t.dom.parentNode;if(!e)return;let n=e.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{t.focus(),n.remove(),iI(t,n.value)},50)}function iI(t,e){let{state:n}=t,i,r=1,s=n.toText(e),o=s.lines==n.selection.ranges.length;if(s1!=null&&n.selection.ranges.every(l=>l.empty)&&s1==s.toString()){let l=-1;i=n.changeByRange(u=>{let c=n.doc.lineAt(u.from);if(c.from==l)return{range:u};l=c.from;let d=n.toText((o?s.line(r++).text:e)+n.lineBreak);return{changes:{from:c.from,insert:d},range:ne.cursor(u.from+d.length)}})}else o?i=n.changeByRange(l=>{let u=s.line(r++);return{changes:{from:l.from,to:l.to,insert:u.text},range:ne.cursor(l.from+u.length)}}):i=n.replaceSelection(s);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Rr.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft};ns.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),e.keyCode==27&&t.inputState.tabFocusMode!=0&&(t.inputState.tabFocusMode=Date.now()+2e3),!1);Rr.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};Rr.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};ns.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let i of t.state.facet(BD))if(n=i(t,e),n)break;if(!n&&e.button==0&&(n=IV(t,e)),n){let i=!t.hasFocus;t.inputState.startMouseSelection(new AV(t,e,n,i)),i&&t.observer.ignore(()=>{yD(t.contentDOM);let s=t.root.activeElement;s&&!s.contains(t.contentDOM)&&s.blur()});let r=t.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function vP(t,e,n,i){if(i==1)return ne.cursor(e,n);if(i==2)return mV(t.state,e,n);{let r=Jt.find(t.docView,e),s=t.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,a=r?r.posAtEnd:s.to;return a<t.state.doc.length&&a==s.to&&a++,ne.range(o,a)}}let yP=(t,e,n)=>e>=n.top&&e<=n.bottom&&t>=n.left&&t<=n.right;function OV(t,e,n,i){let r=Jt.find(t.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&yP(n,i,o))return-1;let a=r.coordsAt(s,1);return a&&yP(n,i,a)?1:o&&o.bottom>=i?-1:1}function wP(t,e){let n=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:n,bias:OV(t,n,e.clientX,e.clientY)}}const DV=be.ie&&be.ie_version<=11;let bP=null,xP=0,SP=0;function rI(t){if(!DV)return t.detail;let e=bP,n=SP;return bP=t,SP=Date.now(),xP=!e||n>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(xP+1)%3:1}function IV(t,e){let n=wP(t,e),i=rI(e),r=t.state.selection;return{update(s){s.docChanged&&(n.pos=s.changes.mapPos(n.pos),r=r.map(s.changes))},get(s,o,a){let l=wP(t,s),u,c=vP(t,l.pos,l.bias,i);if(n.pos!=l.pos&&!o){let d=vP(t,n.pos,n.bias,i),h=Math.min(d.from,c.from),f=Math.max(d.to,c.to);c=h<c.from?ne.range(h,f):ne.range(f,h)}return o?r.replaceRange(r.main.extend(c.from,c.to)):a&&i==1&&r.ranges.length>1&&(u=LV(r,l.pos))?u:a?r.addRange(c):ne.create([c])}}}function LV(t,e){for(let n=0;n<t.ranges.length;n++){let{from:i,to:r}=t.ranges[n];if(i<=e&&r>=e)return ne.create(t.ranges.slice(0,n).concat(t.ranges.slice(n+1)),t.mainIndex==n?0:t.mainIndex-(t.mainIndex>n?1:0))}return null}ns.dragstart=(t,e)=>{let{selection:{main:n}}=t.state;if(e.target.draggable){let r=t.docView.nearest(e.target);if(r&&r.isWidget){let s=r.posAtStart,o=s+r.length;(s>=n.to||o<=n.from)&&(n=ne.range(s,o))}}let{inputState:i}=t;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=n,e.dataTransfer&&(e.dataTransfer.setData("Text",t.state.sliceDoc(n.from,n.to)),e.dataTransfer.effectAllowed="copyMove"),!1};ns.dragend=t=>(t.inputState.draggedContent=null,!1);function kP(t,e,n,i){if(!n)return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=t.inputState,o=i&&s&&TV(t,e)?{from:s.from,to:s.to}:null,a={from:r,insert:n},l=t.state.changes(o?[o,a]:a);t.focus(),t.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"}),t.inputState.draggedContent=null}ns.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let n=e.dataTransfer.files;if(n&&n.length){let i=Array(n.length),r=0,s=()=>{++r==n.length&&kP(t,e,i.filter(o=>o!=null).join(t.state.lineBreak),!1)};for(let o=0;o<n.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(i[o]=a.result),s()},a.readAsText(n[o])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return kP(t,e,i,!0),!0}return!1};ns.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let n=nI?null:e.clipboardData;return n?(iI(t,n.getData("text/plain")||n.getData("text/uri-list")),!0):(MV(t),!1)};function jV(t,e){let n=t.dom.parentNode;if(!n)return;let i=n.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),t.focus()},50)}function FV(t){let e=[],n=[],i=!1;for(let r of t.selection.ranges)r.empty||(e.push(t.sliceDoc(r.from,r.to)),n.push(r));if(!e.length){let r=-1;for(let{from:s}of t.selection.ranges){let o=t.doc.lineAt(s);o.number>r&&(e.push(o.text),n.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),r=o.number}i=!0}return{text:e.join(t.lineBreak),ranges:n,linewise:i}}let s1=null;ns.copy=ns.cut=(t,e)=>{let{text:n,ranges:i,linewise:r}=FV(t.state);if(!n&&!r)return!1;s1=r?n:null,e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let s=nI?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",n),!0):(jV(t,n),!1)};const sI=Bo.define();function oI(t,e){let n=[];for(let i of t.facet(UD)){let r=i(t,e);r&&n.push(r)}return n?t.update({effects:n,annotations:sI.of(!0)}):null}function aI(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let n=oI(t.state,e);n?t.dispatch(n):t.update([])}},10)}Rr.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),aI(t)};Rr.blur=t=>{t.observer.clearSelectionRange(),aI(t)};Rr.compositionstart=Rr.compositionupdate=t=>{t.observer.editContext||(t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))};Rr.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,be.chrome&&be.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))};Rr.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};ns.beforeinput=(t,e)=>{var n;let i;if(be.chrome&&be.android&&(i=eI.find(r=>r.inputType==e.inputType))&&(t.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let r=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>r+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return be.ios&&e.inputType=="deleteContentForward"&&t.observer.flushSoon(),be.safari&&e.inputType=="insertText"&&t.inputState.composing>=0&&setTimeout(()=>Rr.compositionend(t,e),20),!1};const _P=new Set;function BV(t){_P.has(t)||(_P.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}const CP=["pre-wrap","normal","pre-line","break-spaces"];let Lc=!1;function EP(){Lc=!1}class $V{constructor(e){this.lineWrapping=e,this.doc=ot.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,n){let i=this.doc.lineAt(n).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((n-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return CP.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let n=!1;for(let i=0;i<e.length;i++){let r=e[i];r<0?i++:this.heightSamples[Math.floor(r*10)]||(n=!0,this.heightSamples[Math.floor(r*10)]=!0)}return n}refresh(e,n,i,r,s,o){let a=CP.indexOf(e)>-1,l=Math.round(n)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=n,this.charWidth=i,this.textHeight=r,this.lineLength=s,l){this.heightSamples={};for(let u=0;u<o.length;u++){let c=o[u];c<0?u++:this.heightSamples[Math.floor(c*10)]=!0}}return l}}class zV{constructor(e,n){this.from=e,this.heights=n,this.index=0}get more(){return this.index<this.heights.length}}class As{constructor(e,n,i,r,s){this.from=e,this.length=n,this.top=i,this.height=r,this._content=s}get type(){return typeof this._content=="number"?ii.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof za?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let n=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new As(this.from,this.length+e.length,this.top,this.height+e.height,n)}}var Pt=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(Pt||(Pt={}));const tg=.001;class ri{constructor(e,n,i=2){this.length=e,this.height=n,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>tg&&(Lc=!0),this.height=e)}replace(e,n,i){return ri.of(i)}decomposeLeft(e,n){n.push(this)}decomposeRight(e,n){n.push(this)}applyChanges(e,n,i,r){let s=this,o=i.doc;for(let a=r.length-1;a>=0;a--){let{fromA:l,toA:u,fromB:c,toB:d}=r[a],h=s.lineAt(l,Pt.ByPosNoHeight,i.setDoc(n),0,0),f=h.to>=u?h:s.lineAt(u,Pt.ByPosNoHeight,i,0,0);for(d+=f.to-u,u=f.to;a>0&&h.from<=r[a-1].toA;)l=r[a-1].fromA,c=r[a-1].fromB,a--,l<h.from&&(h=s.lineAt(l,Pt.ByPosNoHeight,i,0,0));c+=h.from-l,l=h.from;let p=Ak.build(i.setDoc(o),e,c,d);s=sv(s,s.replace(l,u,p))}return s.updateHeight(i,0)}static empty(){return new Bi(0,0)}static of(e){if(e.length==1)return e[0];let n=0,i=e.length,r=0,s=0;for(;;)if(n==i)if(r>s*2){let a=e[n-1];a.break?e.splice(--n,1,a.left,null,a.right):e.splice(--n,1,a.left,a.right),i+=1+a.break,r-=a.size}else if(s>r*2){let a=e[i];a.break?e.splice(i,1,a.left,null,a.right):e.splice(i,1,a.left,a.right),i+=2+a.break,s-=a.size}else break;else if(r<s){let a=e[n++];a&&(r+=a.size)}else{let a=e[--i];a&&(s+=a.size)}let o=0;return e[n-1]==null?(o=1,n--):e[n]==null&&(o=1,i++),new UV(ri.of(e.slice(0,n)),o,ri.of(e.slice(i)))}}function sv(t,e){return t==e?t:(t.constructor!=e.constructor&&(Lc=!0),e)}ri.prototype.size=1;class lI extends ri{constructor(e,n,i){super(e,n),this.deco=i}blockAt(e,n,i,r){return new As(r,this.length,i,this.height,this.deco||0)}lineAt(e,n,i,r,s){return this.blockAt(0,i,r,s)}forEachLine(e,n,i,r,s,o){e<=s+this.length&&n>=s&&o(this.blockAt(0,i,r,s))}updateHeight(e,n=0,i=!1,r){return r&&r.from<=n&&r.more&&this.setHeight(r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Bi extends lI{constructor(e,n){super(e,n,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,n,i,r){return new As(r,this.length,i,this.height,this.breaks)}replace(e,n,i){let r=i[0];return i.length==1&&(r instanceof Bi||r instanceof bn&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof bn?r=new Bi(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):ri.of(i)}updateHeight(e,n=0,i=!1,r){return r&&r.from<=n&&r.more?this.setHeight(r.heights[r.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class bn extends ri{constructor(e){super(e,0)}heightMetrics(e,n){let i=e.doc.lineAt(n).number,r=e.doc.lineAt(n+this.length).number,s=r-i+1,o,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);o=l/s,this.length>s+1&&(a=(this.height-l)/(this.length-s-1))}else o=this.height/s;return{firstLine:i,lastLine:r,perLine:o,perChar:a}}blockAt(e,n,i,r){let{firstLine:s,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(n,r);if(n.lineWrapping){let u=r+(e<n.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),c=n.doc.lineAt(u),d=a+c.length*l,h=Math.max(i,e-d/2);return new As(c.from,c.length,h,d,0)}else{let u=Math.max(0,Math.min(o-s,Math.floor((e-i)/a))),{from:c,length:d}=n.doc.line(s+u);return new As(c,d,i+a*u,a,0)}}lineAt(e,n,i,r,s){if(n==Pt.ByHeight)return this.blockAt(e,i,r,s);if(n==Pt.ByPosNoHeight){let{from:f,to:p}=i.doc.lineAt(e);return new As(f,p-f,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(i,s),u=i.doc.lineAt(e),c=a+u.length*l,d=u.number-o,h=r+a*d+l*(u.from-s-d);return new As(u.from,u.length,Math.max(r,Math.min(h,r+this.height-c)),c,0)}forEachLine(e,n,i,r,s,o){e=Math.max(e,s),n=Math.min(n,s+this.length);let{firstLine:a,perLine:l,perChar:u}=this.heightMetrics(i,s);for(let c=e,d=r;c<=n;){let h=i.doc.lineAt(c);if(c==e){let p=h.number-a;d+=l*p+u*(e-s-p)}let f=l+u*h.length;o(new As(h.from,h.length,d,f,0)),d+=f,c=h.to+1}}replace(e,n,i){let r=this.length-n;if(r>0){let s=i[i.length-1];s instanceof bn?i[i.length-1]=new bn(s.length+r):i.push(null,new bn(r-1))}if(e>0){let s=i[0];s instanceof bn?i[0]=new bn(e+s.length):i.unshift(new bn(e-1),null)}return ri.of(i)}decomposeLeft(e,n){n.push(new bn(e-1),null)}decomposeRight(e,n){n.push(null,new bn(this.length-e-1))}updateHeight(e,n=0,i=!1,r){let s=n+this.length;if(r&&r.from<=n+this.length&&r.more){let o=[],a=Math.max(n,r.from),l=-1;for(r.from>n&&o.push(new bn(r.from-n-1).updateHeight(e,n));a<=s&&r.more;){let c=e.doc.lineAt(a).length;o.length&&o.push(null);let d=r.heights[r.index++];l==-1?l=d:Math.abs(d-l)>=tg&&(l=-2);let h=new Bi(c,d);h.outdated=!1,o.push(h),a+=c+1}a<=s&&o.push(null,new bn(s-a).updateHeight(e,a));let u=ri.of(o);return(l<0||Math.abs(u.height-this.height)>=tg||Math.abs(l-this.heightMetrics(e,n).perLine)>=tg)&&(Lc=!0),sv(this,u)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(n,n+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class UV extends ri{constructor(e,n,i){super(e.length+n+i.length,e.height+i.height,n|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,n,i,r){let s=i+this.left.height;return e<s?this.left.blockAt(e,n,i,r):this.right.blockAt(e,n,s,r+this.left.length+this.break)}lineAt(e,n,i,r,s){let o=r+this.left.height,a=s+this.left.length+this.break,l=n==Pt.ByHeight?e<o:e<a,u=l?this.left.lineAt(e,n,i,r,s):this.right.lineAt(e,n,i,o,a);if(this.break||(l?u.to<a:u.from>a))return u;let c=n==Pt.ByPosNoHeight?Pt.ByPosNoHeight:Pt.ByPos;return l?u.join(this.right.lineAt(a,c,i,o,a)):this.left.lineAt(a,c,i,r,s).join(u)}forEachLine(e,n,i,r,s,o){let a=r+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,n,i,r,s,o),n>=l&&this.right.forEachLine(e,n,i,a,l,o);else{let u=this.lineAt(l,Pt.ByPos,i,r,s);e<u.from&&this.left.forEachLine(e,u.from-1,i,r,s,o),u.to>=e&&u.from<=n&&o(u),n>u.to&&this.right.forEachLine(u.to+1,n,i,a,l,o)}}replace(e,n,i){let r=this.left.length+this.break;if(n<r)return this.balanced(this.left.replace(e,n,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,n-r,i));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of i)s.push(a);if(e>0&&AP(s,o-1),n<this.length){let a=s.length;this.decomposeRight(n,s),AP(s,a)}return ri.of(s)}decomposeLeft(e,n){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,n);n.push(this.left),this.break&&(i++,e>=i&&n.push(null)),e>i&&this.right.decomposeLeft(e-i,n)}decomposeRight(e,n){let i=this.left.length,r=i+this.break;if(e>=r)return this.right.decomposeRight(e-r,n);e<i&&this.left.decomposeRight(e,n),this.break&&e<r&&n.push(null),n.push(this.right)}balanced(e,n){return e.size>2*n.size||n.size>2*e.size?ri.of(this.break?[e,null,n]:[e,n]):(this.left=sv(this.left,e),this.right=sv(this.right,n),this.setHeight(e.height+n.height),this.outdated=e.outdated||n.outdated,this.size=e.size+n.size,this.length=e.length+this.break+n.length,this)}updateHeight(e,n=0,i=!1,r){let{left:s,right:o}=this,a=n+s.length+this.break,l=null;return r&&r.from<=n+s.length&&r.more?l=s=s.updateHeight(e,n,i,r):s.updateHeight(e,n,i),r&&r.from<=a+o.length&&r.more?l=o=o.updateHeight(e,a,i,r):o.updateHeight(e,a,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function AP(t,e){let n,i;t[e]==null&&(n=t[e-1])instanceof bn&&(i=t[e+1])instanceof bn&&t.splice(e-1,3,new bn(n.length+1+i.length))}const VV=5;class Ak{constructor(e,n){this.pos=e,this.oracle=n,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,n){if(this.lineStart>-1){let i=Math.min(n,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Bi?r.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Bi(i-this.pos,-1)),this.writtenTo=i,n>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=n}point(e,n,i){if(e<n||i.heightRelevant){let r=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let o=n-e;i.block?this.addBlock(new lI(o,r,i)):(o||s||r>=VV)&&this.addLineDeco(r,s,o)}else n>e&&this.span(e,n);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:n}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=n,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Bi(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,n){let i=new bn(n-e);return this.oracle.doc.lineAt(e).to==n&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Bi)return e;let n=new Bi(0,-1);return this.nodes.push(n),n}addBlock(e){this.enterLine();let n=e.deco;n&&n.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,n&&n.endSide>0&&(this.covering=e)}addLineDeco(e,n,i){let r=this.ensureLine();r.length+=i,r.collapsed+=i,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=n,this.writtenTo=this.pos=this.pos+i}finish(e){let n=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(n instanceof Bi)&&!this.isCovered?this.nodes.push(new Bi(0,-1)):(this.writtenTo<this.pos||n==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let r of this.nodes)r instanceof Bi&&r.updateHeight(this.oracle,i),i+=r?r.length:1;return this.nodes}static build(e,n,i,r){let s=new Ak(i,e);return ct.spans(n,i,r,s,0),s.finish(i)}}function HV(t,e,n){let i=new WV;return ct.compare(t,e,n,i,0),i.changes}class WV{constructor(){this.changes=[]}compareRange(){}comparePoint(e,n,i,r){(e<n||i&&i.heightRelevant||r&&r.heightRelevant)&&Zx(e,n,this.changes,5)}}function GV(t,e){let n=t.getBoundingClientRect(),i=t.ownerDocument,r=i.defaultView||window,s=Math.max(0,n.left),o=Math.min(r.innerWidth,n.right),a=Math.max(0,n.top),l=Math.min(r.innerHeight,n.bottom);for(let u=t.parentNode;u&&u!=i.body;)if(u.nodeType==1){let c=u,d=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&d.overflow!="visible"){let h=c.getBoundingClientRect();s=Math.max(s,h.left),o=Math.min(o,h.right),a=Math.max(a,h.top),l=u==t.parentNode?h.bottom:Math.min(l,h.bottom)}u=d.position=="absolute"||d.position=="fixed"?c.offsetParent:c.parentNode}else if(u.nodeType==11)u=u.host;else break;return{left:s-n.left,right:Math.max(s,o)-n.left,top:a-(n.top+e),bottom:Math.max(a,l)-(n.top+e)}}function KV(t,e){let n=t.getBoundingClientRect();return{left:0,right:n.right-n.left,top:e,bottom:n.bottom-(n.top+e)}}class sw{constructor(e,n,i){this.from=e,this.to=n,this.size=i}static same(e,n){if(e.length!=n.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=n[i];if(r.from!=s.from||r.to!=s.to||r.size!=s.size)return!1}return!0}draw(e,n){return Ge.replace({widget:new XV(this.size*(n?e.scaleY:e.scaleX),n)}).range(this.from,this.to)}}class XV extends il{constructor(e,n){super(),this.size=e,this.vertical=n}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class PP{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=TP,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Nt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let n=e.facet(Ck).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new $V(n),this.stateDeco=e.facet(sf).filter(i=>typeof i!="function"),this.heightMap=ri.empty().applyChanges(this.stateDeco,ot.empty,this.heightOracle.setDoc(e.doc),[new Sr(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ge.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:n}=this.state.selection;for(let i=0;i<=1;i++){let r=i?n.head:n.anchor;if(!e.some(({from:s,to:o})=>r>=s&&r<=o)){let{from:s,to:o}=this.lineBlockAt(r);e.push(new em(s,o))}}return this.viewports=e.sort((i,r)=>i.from-r.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?TP:new Pk(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Xd(e,this.scaler))})}update(e,n=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(sf).filter(c=>typeof c!="function");let r=e.changedRanges,s=Sr.extendWithRanges(r,HV(i,this.stateDeco,e?e.changes:rn.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);EP(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||Lc)&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(n&&(n.range.head<l.from||n.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,n));let u=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(u||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),n&&(this.scrollTarget=n),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(HD)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let n=e.contentDOM,i=window.getComputedStyle(n),r=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?Nt.RTL:Nt.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),a=n.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let u=0,c=0;if(a.width&&a.height){let{scaleX:k,scaleY:_}=vD(n,a);(k>.005&&Math.abs(this.scaleX-k)>.005||_>.005&&Math.abs(this.scaleY-_)>.005)&&(this.scaleX=k,this.scaleY=_,u|=8,o=l=!0)}let d=(parseInt(i.paddingTop)||0)*this.scaleY,h=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=d||this.paddingBottom!=h)&&(this.paddingTop=d,this.paddingBottom=h,u|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=8);let f=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=f&&(this.scrollAnchorHeight=-1,this.scrollTop=f),this.scrolledToBottom=bD(e.scrollDOM);let p=(this.printing?KV:GV)(n,this.paddingTop),m=p.top-this.pixelViewport.top,w=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let v=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(v!=this.inView&&(this.inView=v,v&&(l=!0)),!this.inView&&!this.scrollTarget)return 0;let y=a.width;if((this.contentDOMWidth!=y||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,u|=8),l){let k=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(k)&&(o=!0),o||r.lineWrapping&&Math.abs(y-this.contentDOMWidth)>r.charWidth){let{lineHeight:_,charWidth:E,textHeight:A}=e.docView.measureTextSize();o=_>0&&r.refresh(s,_,E,A,y/E,k),o&&(e.docView.minWidth=0,u|=8)}m>0&&w>0?c=Math.max(m,w):m<0&&w<0&&(c=Math.min(m,w)),EP();for(let _ of this.viewports){let E=_.from==this.viewport.from?k:e.docView.measureVisibleLineHeights(_);this.heightMap=(o?ri.empty().applyChanges(this.stateDeco,ot.empty,this.heightOracle,[new Sr(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,o,new zV(_.from,E))}Lc&&(u|=2)}let b=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return b&&(u&2&&(u|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),u|=this.updateForViewport()),(u&2||b)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,n){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new em(r.lineAt(o-i*1e3,Pt.ByHeight,s,0,0).from,r.lineAt(a+(1-i)*1e3,Pt.ByHeight,s,0,0).to);if(n){let{head:u}=n.range;if(u<l.from||u>l.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),d=r.lineAt(u,Pt.ByPos,s,0,0),h;n.y=="center"?h=(d.top+d.bottom)/2-c/2:n.y=="start"||n.y=="nearest"&&u<l.from?h=d.top:h=d.bottom-c,l=new em(r.lineAt(h-1e3/2,Pt.ByHeight,s,0,0).from,r.lineAt(h+c+1e3/2,Pt.ByHeight,s,0,0).to)}}return l}mapViewport(e,n){let i=n.mapPos(e.from,-1),r=n.mapPos(e.to,1);return new em(this.heightMap.lineAt(i,Pt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,Pt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:n},i=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,Pt.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(n,Pt.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||r<=o-Math.max(10,Math.min(-i,250)))&&(n==this.state.doc.length||s>=a+Math.max(10,Math.min(i,250)))&&r>o-2*1e3&&s<a+2*1e3}mapLineGaps(e,n){if(!e.length||n.empty)return e;let i=[];for(let r of e)n.touchesRange(r.from,r.to)||i.push(new sw(n.mapPos(r.from),n.mapPos(r.to),r.size));return i}ensureLineGaps(e,n){let i=this.heightOracle.lineWrapping,r=i?1e4:2e3,s=r>>1,o=r<<1;if(this.defaultTextDirection!=Nt.LTR&&!i)return[];let a=[],l=(c,d,h,f)=>{if(d-c<s)return;let p=this.state.selection.main,m=[p.from];p.empty||m.push(p.to);for(let v of m)if(v>c&&v<d){l(c,v-10,h,f),l(v+10,d,h,f);return}let w=YV(e,v=>v.from>=h.from&&v.to<=h.to&&Math.abs(v.from-c)<s&&Math.abs(v.to-d)<s&&!m.some(y=>v.from<y&&v.to>y));if(!w){if(d<h.to&&n&&i&&n.visibleRanges.some(v=>v.from<=d&&v.to>=d)){let v=n.moveToLineBoundary(ne.cursor(d),!1,!0).head;v>c&&(d=v)}w=new sw(c,d,this.gapSize(h,c,d,f))}a.push(w)},u=c=>{if(c.length<o||c.type!=ii.Text)return;let d=qV(c.from,c.to,this.stateDeco);if(d.total<o)return;let h=this.scrollTarget?this.scrollTarget.range.head:null,f,p;if(i){let m=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,w,v;if(h!=null){let y=nm(d,h),b=((this.visibleBottom-this.visibleTop)/2+m)/c.height;w=y-b,v=y+b}else w=(this.visibleTop-c.top-m)/c.height,v=(this.visibleBottom-c.top+m)/c.height;f=tm(d,w),p=tm(d,v)}else{let m=d.total*this.heightOracle.charWidth,w=r*this.heightOracle.charWidth,v,y;if(h!=null){let b=nm(d,h),k=((this.pixelViewport.right-this.pixelViewport.left)/2+w)/m;v=b-k,y=b+k}else v=(this.pixelViewport.left-w)/m,y=(this.pixelViewport.right+w)/m;f=tm(d,v),p=tm(d,y)}f>c.from&&l(c.from,f,c,d),p<c.to&&l(p,c.to,c,d)};for(let c of this.viewportLines)Array.isArray(c.type)?c.type.forEach(u):u(c);return a}gapSize(e,n,i,r){let s=nm(r,i)-nm(r,n);return this.heightOracle.lineWrapping?e.height*s:r.total*this.heightOracle.charWidth*s}updateLineGaps(e){sw.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ge.set(e.map(n=>n.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let n=[];ct.spans(e,this.viewport.from,this.viewport.to,{span(r,s){n.push({from:r,to:s})},point(){}},20);let i=n.length!=this.visibleRanges.length||this.visibleRanges.some((r,s)=>r.from!=n[s].from||r.to!=n[s].to);return this.visibleRanges=n,i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(n=>n.from<=e&&n.to>=e)||Xd(this.heightMap.lineAt(e,Pt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(n=>n.top<=e&&n.bottom>=e)||Xd(this.heightMap.lineAt(this.scaler.fromDOM(e),Pt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let n=this.lineBlockAtHeight(e+8);return n.from>=this.viewport.from||this.viewportLines[0].top-e>200?n:this.viewportLines[0]}elementAtHeight(e){return Xd(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}let em=class{constructor(e,n){this.from=e,this.to=n}};function qV(t,e,n){let i=[],r=t,s=0;return ct.spans(n,t,e,{span(){},point(o,a){o>r&&(i.push({from:r,to:o}),s+=o-r),r=a}},20),r<e&&(i.push({from:r,to:e}),s+=e-r),{total:s,ranges:i}}function tm({total:t,ranges:e},n){if(n<=0)return e[0].from;if(n>=1)return e[e.length-1].to;let i=Math.floor(t*n);for(let r=0;;r++){let{from:s,to:o}=e[r],a=o-s;if(i<=a)return s+i;i-=a}}function nm(t,e){let n=0;for(let{from:i,to:r}of t.ranges){if(e<=r){n+=e-i;break}n+=r-i}return n/t.total}function YV(t,e){for(let n of t)if(e(n))return n}const TP={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class Pk{constructor(e,n,i){let r=0,s=0,o=0;this.viewports=i.map(({from:a,to:l})=>{let u=n.lineAt(a,Pt.ByPos,e,0,0).top,c=n.lineAt(l,Pt.ByPos,e,0,0).bottom;return r+=c-u,{from:a,to:l,top:u,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(n.height-r);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let n=0,i=0,r=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.top)return r+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom,r=s.domBottom}}fromDOM(e){for(let n=0,i=0,r=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.domTop)return i+(e-r)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom,r=s.domBottom}}eq(e){return e instanceof Pk?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((n,i)=>n.from==e.viewports[i].from&&n.to==e.viewports[i].to):!1}}function Xd(t,e){if(e.scale==1)return t;let n=e.toDOM(t.top),i=e.toDOM(t.bottom);return new As(t.from,t.length,n,i-n,Array.isArray(t._content)?t._content.map(r=>Xd(r,e)):t._content)}const im=_e.define({combine:t=>t.join(" ")}),o1=_e.define({combine:t=>t.indexOf(!0)>-1}),a1=Ba.newName(),uI=Ba.newName(),cI=Ba.newName(),dI={"&light":"."+uI,"&dark":"."+cI};function l1(t,e,n){return new Ba(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,r=>{if(r=="&")return t;if(!n||!n[r])throw new RangeError(`Unsupported selector: ${r}`);return n[r]}):t+" "+i}})}const JV=l1("."+a1,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},dI),qd="￿";class ZV{constructor(e,n){this.points=e,this.text="",this.lineSeparator=n.facet(Je.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=qd}readRange(e,n){if(!e)return this;let i=e.parentNode;for(let r=e;;){this.findPointBefore(i,r);let s=this.text.length;this.readNode(r);let o=r.nextSibling;if(o==n)break;let a=xt.get(r),l=xt.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:nv(r))||nv(o)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>s)&&this.lineBreak(),r=o}return this.findPointBefore(i,n),this}readTextNode(e){let n=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,n.length));for(let i=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,a;if(this.lineSeparator?(s=n.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(a=r.exec(n))&&(s=a.index,o=a[0].length),this.append(n.slice(i,s<0?n.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);i=s+o}}readNode(e){if(e.cmIgnore)return;let n=xt.get(e),i=n&&n.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let r=i.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,n){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==n&&(i.pos=this.text.length)}findPointInside(e,n){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(QV(e,i.node,i.offset)?n:0))}}function QV(t,e,n){for(;;){if(!e||n<Ro(e))return!1;if(e==t)return!0;n=Jl(e)+1,e=e.parentNode}}class RP{constructor(e,n){this.node=e,this.offset=n,this.pos=-1}}class eH{constructor(e,n,i,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=n>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&n>-1)this.newSel=null;else if(n>-1&&(this.bounds=e.docView.domBoundsAround(n,i,0))){let a=s||o?[]:iH(e),l=new ZV(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=rH(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=s&&s.node==a.focusNode&&s.offset==a.focusOffset||!Gx(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),u=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!Gx(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),c=e.viewport;if((be.ios||be.chrome)&&e.state.selection.main.empty&&l!=u&&(c.from>0||c.to<e.state.doc.length)){let d=Math.min(l,u),h=Math.max(l,u),f=c.from-d,p=c.to-h;(f==0||f==1||d==0)&&(p==0||p==-1||h==e.state.doc.length)&&(l=0,u=e.state.doc.length)}this.newSel=ne.single(u,l)}}}function hI(t,e){let n,{newSel:i}=e,r=t.state.selection.main,s=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=r.from,u=null;(s===8||be.android&&e.text.length<a-o)&&(l=r.to,u="end");let c=nH(t.state.doc.sliceString(o,a,qd),e.text,l-o,u);c&&(be.chrome&&s==13&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==qd+qd&&c.toB--,n={from:o+c.from,to:o+c.toA,insert:ot.of(e.text.slice(c.from,c.toB).split(qd))})}else i&&(!t.hasFocus&&t.state.facet(ra)||i.main.eq(r))&&(i=null);if(!n&&!i)return!1;if(!n&&e.typeOver&&!r.empty&&i&&i.main.empty?n={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,r.to)}:n&&n.from>=r.from&&n.to<=r.to&&(n.from!=r.from||n.to!=r.to)&&r.to-r.from-(n.to-n.from)<=4?n={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,n.from).append(n.insert).append(t.state.doc.slice(n.to,r.to))}:(be.mac||be.android)&&n&&n.from==n.to&&n.from==r.head-1&&/^\. ?$/.test(n.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(i&&n.insert.length==2&&(i=ne.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:ot.of([" "])}):be.chrome&&n&&n.from==n.to&&n.from==r.head&&n.insert.toString()==`
 `&&t.lineWrapping&&(i&&(i=ne.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:ot.of([" "])}),n)return fI(t,n,i,s);if(i&&!i.main.eq(r)){let o=!1,a="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(o=!0),a=t.inputState.lastSelectionOrigin),t.dispatch({selection:i,scrollIntoView:o,userEvent:a}),!0}else return!1}function fI(t,e,n,i=-1){if(be.ios&&t.inputState.flushIOSKey(e))return!0;let r=t.state.selection.main;if(be.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&t.state.sliceDoc(e.from,r.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&lc(t.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>r.head)&&lc(t.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&e.insert.length==0&&lc(t.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let o,a=()=>o||(o=tH(t,e,n));return t.state.facet(zD).some(l=>l(t,e.from,e.to,s,a))||t.dispatch(a()),!0}function tH(t,e,n){let i,r=t.state,s=r.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!n||n.main.empty&&n.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let a=s.from<e.from?r.sliceDoc(s.from,e.from):"",l=s.to>e.to?r.sliceDoc(e.to,s.to):"";i=r.replaceSelection(t.state.toText(a+e.insert.sliceString(0,void 0,t.state.lineBreak)+l))}else{let a=r.changes(e),l=n&&n.main.to<=a.newLength?n.main:void 0;if(r.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let u=t.state.sliceDoc(e.from,e.to),c,d=n&&ZD(t,n.main.head);if(d){let p=e.insert.length-(e.to-e.from);c={from:d.from,to:d.to-p}}else c=t.state.doc.lineAt(s.head);let h=s.to-e.to,f=s.to-s.from;i=r.changeByRange(p=>{if(p.from==s.from&&p.to==s.to)return{changes:a,range:l||p.map(a)};let m=p.to-h,w=m-u.length;if(p.to-p.from!=f||t.state.sliceDoc(w,m)!=u||p.to>=c.from&&p.from<=c.to)return{range:p};let v=r.changes({from:w,to:m,insert:e.insert}),y=p.to-s.to;return{changes:v,range:l?ne.range(Math.max(0,l.anchor+y),Math.max(0,l.head+y)):p.map(v)}})}else i={changes:a,selection:l&&r.selection.replaceRange(l)}}let o="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,o+=".compose",t.inputState.compositionFirstChange&&(o+=".start",t.inputState.compositionFirstChange=!1)),r.update(i,{userEvent:o,scrollIntoView:!0})}function nH(t,e,n,i){let r=Math.min(t.length,e.length),s=0;for(;s<r&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&t.length==e.length)return null;let o=t.length,a=e.length;for(;o>0&&a>0&&t.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(i=="end"){let l=Math.max(0,s-Math.min(o,a));n-=o+l-s}if(o<s&&t.length<e.length){let l=n<=s&&n>=o?s-n:0;s-=l,a=s+(a-o),o=s}else if(a<s){let l=n<=s&&n>=a?s-n:0;s-=l,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}function iH(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}=t.observer.selectionRange;return n&&(e.push(new RP(n,i)),(r!=n||s!=i)&&e.push(new RP(r,s))),e}function rH(t,e){if(t.length==0)return null;let n=t[0].pos,i=t.length==2?t[1].pos:n;return n>-1&&i>-1?ne.single(n+e,i+e):null}const sH={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},ow=be.ie&&be.ie_version<=11;class oH{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new HU,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(n=>{for(let i of n)this.queue.push(i);(be.ie&&be.ie_version<=11||be.ios&&e.composing)&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(be.chrome&&be.chrome_version<126)&&(this.editContext=new lH(e),e.state.facet(ra)&&(e.contentDOM.editContext=this.editContext.editContext)),ow&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var n;((n=this.view.docView)===null||n===void 0?void 0:n.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(n=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),n.length>0&&n[n.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(n=>{n.length>0&&n[n.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((n,i)=>n!=e[i]))){this.gapIntersection.disconnect();for(let n of e)this.gapIntersection.observe(n);this.gaps=e}}onSelectionChange(e){let n=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,r=this.selectionRange;if(i.state.facet(ra)?i.root.activeElement!=this.dom:!Qm(i.dom,r))return;let s=r.anchorNode&&i.docView.nearest(r.anchorNode);if(s&&s.ignoreEvent(e)){n||(this.selectionChanged=!1);return}(be.ie&&be.ie_version<=11||be.android&&be.chrome)&&!i.state.selection.main.empty&&r.focusNode&&wh(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,n=nf(e.root);if(!n)return!1;let i=be.safari&&e.root.nodeType==11&&$U(this.dom.ownerDocument)==this.dom&&aH(this.view,n)||n;if(!i||this.selectionRange.eq(i))return!1;let r=Qm(this.dom,i);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&GU(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,n){this.selectionRange.set(e.node,e.offset,n.node,n.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,n=null;for(let i=this.dom;i;)if(i.nodeType==1)!n&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:n||(n=this.scrollTargets.slice(0,e)),n&&n.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!n&&(n=this.scrollTargets.slice(0,e)),n){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=n)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,sH),ow&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),ow&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,n){var i;if(!this.delayedAndroidKey){let r=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&lc(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:n,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let n=-1,i=-1,r=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(r=!0),n==-1?{from:n,to:i}=o:(n=Math.min(o.from,n),i=Math.max(o.to,i)))}return{from:n,to:i,typeOver:r}}readChange(){let{from:e,to:n,typeOver:i}=this.processRecords(),r=this.selectionChanged&&Qm(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new eH(this.view,e,n,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let n=this.readChange();if(!n)return this.view.requestMeasure(),!1;let i=this.view.state,r=hI(this.view,n);return this.view.state==i&&(n.domChanged||n.newSel&&!n.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),r}readMutation(e){let n=this.view.docView.nearest(e.target);if(!n||n.ignoreMutation(e))return null;if(n.markDirty(e.type=="attributes"),e.type=="attributes"&&(n.flags|=4),e.type=="childList"){let i=NP(n,e.previousSibling||e.target.previousSibling,-1),r=NP(n,e.nextSibling||e.target.nextSibling,1);return{from:i?n.posAfter(i):n.posAtStart,to:r?n.posBefore(r):n.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(ra)!=e.state.facet(ra)&&(e.view.contentDOM.editContext=e.state.facet(ra)?this.editContext.editContext:null))}destroy(){var e,n,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(n=this.gapIntersection)===null||n===void 0||n.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function NP(t,e,n){for(;e;){let i=xt.get(e);if(i&&i.parent==t)return i;let r=e.parentNode;e=r!=t.dom?r:n>0?e.nextSibling:e.previousSibling}return null}function MP(t,e){let n=e.startContainer,i=e.startOffset,r=e.endContainer,s=e.endOffset,o=t.docView.domAtPos(t.state.selection.main.anchor);return wh(o.node,o.offset,r,s)&&([n,i,r,s]=[r,s,n,i]),{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}}function aH(t,e){if(e.getComposedRanges){let r=e.getComposedRanges(t.root)[0];if(r)return MP(t,r)}let n=null;function i(r){r.preventDefault(),r.stopImmediatePropagation(),n=r.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",i,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",i,!0),n?MP(t,n):null}class lH{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.resetRange(e.state);let n=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let{anchor:r}=e.state.selection.main,s={from:this.toEditorPos(i.updateRangeStart),to:this.toEditorPos(i.updateRangeEnd),insert:ot.of(i.text.split(`
`))};s.from==this.from&&r<this.from?s.from=r:s.to==this.to&&r>this.to&&(s.to=r),!(s.from==s.to&&!s.insert.length)&&(this.pendingContextChange=s,e.state.readOnly||fI(e,s,ne.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd))),this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)))},this.handlers.characterboundsupdate=i=>{let r=[],s=null;for(let o=this.toEditorPos(i.rangeStart),a=this.toEditorPos(i.rangeEnd);o<a;o++){let l=e.coordsForChar(o);s=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||s||new DOMRect,r.push(s)}n.updateCharacterBounds(i.rangeStart,r)},this.handlers.textformatupdate=i=>{let r=[];for(let s of i.getTextFormats()){let o=s.underlineStyle,a=s.underlineThickness;if(o!="None"&&a!="None"){let l=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${a=="Thin"?1:2}px`;r.push(Ge.mark({attributes:{style:l}}).range(this.toEditorPos(s.rangeStart),this.toEditorPos(s.rangeEnd)))}}e.dispatch({effects:GD.of(Ge.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{e.inputState.composing=-1,e.inputState.compositionFirstChange=null};for(let i in this.handlers)n.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let r=nf(i.root);r&&r.rangeCount&&this.editContext.updateSelectionBounds(r.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let n=0,i=!1,r=this.pendingContextChange;return e.changes.iterChanges((s,o,a,l,u)=>{if(i)return;let c=u.length-(o-s);if(r&&o>=r.to)if(r.from==s&&r.to==o&&r.insert.eq(u)){r=this.pendingContextChange=null,n+=c,this.to+=c;return}else r=null,this.revertPending(e.state);if(s+=n,o+=n,o<=this.from)this.from+=c,this.to+=c;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+u.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),u.toString()),this.to+=c}n+=c}),r&&!i&&this.revertPending(e.state),!i}update(e){let n=this.pendingContextChange;!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.resetRange(e.state),this.editContext.updateText(0,this.editContext.text.length,e.state.doc.sliceString(this.from,this.to)),this.setSelection(e.state)):(e.docChanged||e.selectionSet||n)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:n}=e.selection.main;this.from=Math.max(0,n-1e4),this.to=Math.min(e.doc.length,n+1e4)}revertPending(e){let n=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(n.from),this.toContextPos(n.from+n.insert.length),e.doc.sliceString(n.from,n.to))}setSelection(e){let{main:n}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,n.anchor))),r=this.toContextPos(n.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(i,r)}rangeIsValid(e){let{head:n}=e.selection.main;return!(this.from>0&&n-this.from<500||this.to<e.doc.length&&this.to-n<500||this.to-this.from>1e4*3)}toEditorPos(e){return e+this.from}toContextPos(e){return e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class Pe{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(i=>i.forEach(r=>n(r,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||WU(e.parent)||document,this.viewState=new PP(e.state||Je.create(e)),e.scrollTo&&e.scrollTo.is(Jp)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Gd).map(i=>new nw(i));for(let i of this.plugins)i.update(this);this.observer=new oH(this),this.inputState=new kV(this),this.inputState.ensureHandlers(this.plugins),this.docView=new uP(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...e){let n=e.length==1&&e[0]instanceof un?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(n,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let n=!1,i=!1,r,s=this.state;for(let h of e){if(h.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=h.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,a=0,l=null;e.some(h=>h.annotation(sI))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=oI(s,o),l||(a=1));let u=this.observer.delayedAndroidKey,c=null;if(u?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(c=null)):this.observer.clear(),s.facet(Je.phrases)!=this.state.facet(Je.phrases))return this.setState(s);r=rv.create(this,s,e),r.flags|=a;let d=this.viewState.scrollTarget;try{this.updateState=2;for(let h of e){if(d&&(d=d.map(h.changes)),h.scrollIntoView){let{main:f}=h.state.selection;d=new uc(f.empty?f:ne.cursor(f.head,f.head>f.anchor?-1:1))}for(let f of h.effects)f.is(Jp)&&(d=f.value.clip(this.state))}this.viewState.update(r,d),this.bidiCache=ov.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),n=this.docView.update(r),this.state.facet(Kd)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some(h=>h.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(im)!=r.state.facet(im)&&(this.viewState.mustMeasureContent=!0),(n||i||d||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),n&&this.docViewUpdate(),!r.empty)for(let h of this.state.facet(n1))try{h(r)}catch(f){Vi(this.state,f,"update listener")}(l||c)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),c&&!hI(this,c)&&u.force&&lc(this.contentDOM,u.key,u.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let n=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new PP(e),this.plugins=e.facet(Gd).map(i=>new nw(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new uP(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}n&&this.focus(),this.requestMeasure()}updatePlugins(e){let n=e.startState.facet(Gd),i=e.state.facet(Gd);if(n!=i){let r=[];for(let s of i){let o=n.indexOf(s);if(o<0)r.push(new nw(s));else{let a=this.plugins[o];a.mustUpdate=e,r.push(a)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);n!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let n=e.value;if(n&&n.docViewUpdate)try{n.docViewUpdate(this)}catch(i){Vi(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let n=null,i=this.scrollDOM,r=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(bD(i))s=-1,o=this.viewState.heightMap.height;else{let f=this.viewState.scrollAnchorAt(r);s=f.from,o=f.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];l&4||([this.measureRequests,u]=[u,this.measureRequests]);let c=u.map(f=>{try{return f.read(this)}catch(p){return Vi(this.state,p),OP}}),d=rv.create(this,this.state,[]),h=!1;d.flags|=l,n?n.flags|=l:n=d,this.updateState=2,d.empty||(this.updatePlugins(d),this.inputState.update(d),this.updateAttrs(),h=this.docView.update(d),h&&this.docViewUpdate());for(let f=0;f<u.length;f++)if(c[f]!=OP)try{let p=u[f];p.write&&p.write(c[f],this)}catch(p){Vi(this.state,p)}if(h&&this.docView.updateSelection(!0),!d.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(p>1||p<-1){r=r+p,i.scrollTop=r/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(n&&!n.empty)for(let a of this.state.facet(n1))a(n)}get themeClasses(){return a1+" "+(this.state.facet(o1)?cI:uI)+" "+this.state.facet(im)}updateAttrs(){let e=DP(this,KD,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),n={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(ra)?"true":"false",class:"cm-content",style:`${be.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(n["aria-readonly"]="true"),DP(this,Ck,n);let i=this.observer.ignore(()=>{let r=Jx(this.contentDOM,this.contentAttrs,n),s=Jx(this.dom,this.editorAttrs,e);return r||s});return this.editorAttrs=e,this.contentAttrs=n,i}showAnnouncements(e){let n=!0;for(let i of e)for(let r of i.effects)if(r.is(Pe.announce)){n&&(this.announceDOM.textContent=""),n=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(Kd);let e=this.state.facet(Pe.cspNonce);Ba.mount(this.root,this.styleModules.concat(JV).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let n=0;n<this.measureRequests.length;n++)if(this.measureRequests[n].key===e.key){this.measureRequests[n]=e;return}}this.measureRequests.push(e)}}plugin(e){let n=this.pluginMap.get(e);return(n===void 0||n&&n.spec!=e)&&this.pluginMap.set(e,n=this.plugins.find(i=>i.spec==e)||null),n&&n.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,n,i){return rw(this,e,mP(this,e,n,i))}moveByGroup(e,n){return rw(this,e,mP(this,e,n,i=>xV(this,e.head,i)))}visualLineSide(e,n){let i=this.bidiSpans(e),r=this.textDirectionAt(e.from),s=i[n?i.length-1:0];return ne.cursor(s.side(n,r)+e.from,s.forward(!n,r)?1:-1)}moveToLineBoundary(e,n,i=!0){return bV(this,e,n,i)}moveVertically(e,n,i){return rw(this,e,SV(this,e,n,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,n=0){return this.docView.posFromDOM(e,n)}posAtCoords(e,n=!0){return this.readMeasured(),QD(this,e,n)}coordsAtPos(e,n=1){this.readMeasured();let i=this.docView.coordsAt(e,n);if(!i||i.left==i.right)return i;let r=this.state.doc.lineAt(e),s=this.bidiSpans(r),o=s[ga.find(s,e-r.from,-1,n)];return Sk(i,o.dir==Nt.LTR==n>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(VD)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>uH)return ID(e.length);let n=this.textDirectionAt(e.from),i;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==n&&(s.fresh||DD(s.isolates,i=lP(this,e))))return s.order;i||(i=lP(this,e));let r=rV(e.text,n,i);return this.bidiCache.push(new ov(e.from,e.to,n,i,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||be.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{yD(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,n={}){return Jp.of(new uc(typeof e=="number"?ne.cursor(e):e,n.y,n.x,n.yMargin,n.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:n}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return Jp.of(new uc(ne.cursor(i.from),"start","start",i.top-e,n,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Dn.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Dn.define(()=>({}),{eventObservers:e})}static theme(e,n){let i=Ba.newName(),r=[im.of(i),Kd.of(l1(`.${i}`,e))];return n&&n.dark&&r.push(o1.of(!0)),r}static baseTheme(e){return Xf.lowest(Kd.of(l1("."+a1,e,dI)))}static findFromDOM(e){var n;let i=e.querySelector(".cm-content"),r=i&&xt.get(i)||xt.get(e);return((n=r==null?void 0:r.rootView)===null||n===void 0?void 0:n.view)||null}}Pe.styleModule=Kd;Pe.inputHandler=zD;Pe.scrollHandler=WD;Pe.focusChangeEffect=UD;Pe.perLineTextDirection=VD;Pe.exceptionSink=$D;Pe.updateListener=n1;Pe.editable=ra;Pe.mouseSelectionStyle=BD;Pe.dragMovesSelection=FD;Pe.clickAddsSelectionRange=jD;Pe.decorations=sf;Pe.outerDecorations=XD;Pe.atomicRanges=Ek;Pe.bidiIsolatedRanges=qD;Pe.scrollMargins=YD;Pe.darkTheme=o1;Pe.cspNonce=_e.define({combine:t=>t.length?t[0]:""});Pe.contentAttributes=Ck;Pe.editorAttributes=KD;Pe.lineWrapping=Pe.contentAttributes.of({class:"cm-lineWrapping"});Pe.announce=Xe.define();const uH=4096,OP={};class ov{constructor(e,n,i,r,s,o){this.from=e,this.to=n,this.dir=i,this.isolates=r,this.fresh=s,this.order=o}static update(e,n){if(n.empty&&!e.some(s=>s.fresh))return e;let i=[],r=e.length?e[e.length-1].dir:Nt.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==r&&!n.touchesRange(o.from,o.to)&&i.push(new ov(n.mapPos(o.from,1),n.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function DP(t,e,n){for(let i=t.state.facet(e),r=i.length-1;r>=0;r--){let s=i[r],o=typeof s=="function"?s(t):s;o&&Yx(o,n)}return n}const cH=be.mac?"mac":be.windows?"win":be.linux?"linux":"key";function dH(t,e){const n=t.split(/-(?!$)/);let i=n[n.length-1];i=="Space"&&(i=" ");let r,s,o,a;for(let l=0;l<n.length-1;++l){const u=n[l];if(/^(cmd|meta|m)$/i.test(u))a=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))s=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))e=="mac"?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+u)}return r&&(i="Alt-"+i),s&&(i="Ctrl-"+i),a&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function rm(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n!==!1&&e.shiftKey&&(t="Shift-"+t),t}const hH=Xf.default(Pe.domEventHandlers({keydown(t,e){return gI(mI(e.state),t,e,"editor")}})),pI=_e.define({enables:hH}),IP=new WeakMap;function mI(t){let e=t.facet(pI),n=IP.get(e);return n||IP.set(e,n=mH(e.reduce((i,r)=>i.concat(r),[]))),n}function fH(t,e,n){return gI(mI(t.state),e,t,n)}let sa=null;const pH=4e3;function mH(t,e=cH){let n=Object.create(null),i=Object.create(null),r=(o,a)=>{let l=i[o];if(l==null)i[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,l,u,c)=>{var d,h;let f=n[o]||(n[o]=Object.create(null)),p=a.split(/ (?!$)/).map(v=>dH(v,e));for(let v=1;v<p.length;v++){let y=p.slice(0,v).join(" ");r(y,!0),f[y]||(f[y]={preventDefault:!0,stopPropagation:!1,run:[b=>{let k=sa={view:b,prefix:y,scope:o};return setTimeout(()=>{sa==k&&(sa=null)},pH),!0}]})}let m=p.join(" ");r(m,!1);let w=f[m]||(f[m]={preventDefault:!1,stopPropagation:!1,run:((h=(d=f._any)===null||d===void 0?void 0:d.run)===null||h===void 0?void 0:h.slice())||[]});l&&w.run.push(l),u&&(w.preventDefault=!0),c&&(w.stopPropagation=!0)};for(let o of t){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let u of a){let c=n[u]||(n[u]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:d}=o;for(let h in c)c[h].run.push(f=>d(f,u1))}let l=o[e]||o.key;if(l)for(let u of a)s(u,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(u,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return n}let u1=null;function gI(t,e,n,i){u1=e;let r=BU(e),s=ei(r,0),o=Wr(s)==r.length&&r!=" ",a="",l=!1,u=!1,c=!1;sa&&sa.view==n&&sa.scope==i&&(a=sa.prefix+" ",tI.indexOf(e.keyCode)<0&&(u=!0,sa=null));let d=new Set,h=w=>{if(w){for(let v of w.run)if(!d.has(v)&&(d.add(v),v(n)))return w.stopPropagation&&(c=!0),!0;w.preventDefault&&(w.stopPropagation&&(c=!0),u=!0)}return!1},f=t[i],p,m;return f&&(h(f[a+rm(r,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(be.windows&&e.ctrlKey&&e.altKey)&&(p=$a[e.keyCode])&&p!=r?(h(f[a+rm(p,e,!0)])||e.shiftKey&&(m=tf[e.keyCode])!=r&&m!=p&&h(f[a+rm(m,e,!1)]))&&(l=!0):o&&e.shiftKey&&h(f[a+rm(r,e,!0)])&&(l=!0),!l&&h(f._any)&&(l=!0)),u&&(l=!0),l&&c&&e.stopPropagation(),u1=null,l}class Qf{constructor(e,n,i,r,s){this.className=e,this.left=n,this.top=i,this.width=r,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,n){return n.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,n,i){if(i.empty){let r=e.coordsAtPos(i.head,i.assoc||1);if(!r)return[];let s=vI(e);return[new Qf(n,r.left-s.left,r.top-s.top,null,r.bottom-r.top)]}else return gH(e,n,i)}}function vI(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==Nt.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function LP(t,e,n,i){let r=t.coordsAtPos(e,n*2);if(!r)return i;let s=t.dom.getBoundingClientRect(),o=(r.top+r.bottom)/2,a=t.posAtCoords({x:s.left+1,y:o}),l=t.posAtCoords({x:s.right-1,y:o});return a==null||l==null?i:{from:Math.max(i.from,Math.min(a,l)),to:Math.min(i.to,Math.max(a,l))}}function gH(t,e,n){if(n.to<=t.viewport.from||n.from>=t.viewport.to)return[];let i=Math.max(n.from,t.viewport.from),r=Math.min(n.to,t.viewport.to),s=t.textDirection==Nt.LTR,o=t.contentDOM,a=o.getBoundingClientRect(),l=vI(t),u=o.querySelector(".cm-line"),c=u&&window.getComputedStyle(u),d=a.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),h=a.right-(c?parseInt(c.paddingRight):0),f=r1(t,i),p=r1(t,r),m=f.type==ii.Text?f:null,w=p.type==ii.Text?p:null;if(m&&(t.lineWrapping||f.widgetLineBreaks)&&(m=LP(t,i,1,m)),w&&(t.lineWrapping||p.widgetLineBreaks)&&(w=LP(t,r,-1,w)),m&&w&&m.from==w.from&&m.to==w.to)return y(b(n.from,n.to,m));{let _=m?b(n.from,null,m):k(f,!1),E=w?b(null,n.to,w):k(p,!0),A=[];return(m||f).to<(w||p).from-(m&&w?1:0)||f.widgetLineBreaks>1&&_.bottom+t.defaultLineHeight/2<E.top?A.push(v(d,_.bottom,h,E.top)):_.bottom<E.top&&t.elementAtHeight((_.bottom+E.top)/2).type==ii.Text&&(_.bottom=E.top=(_.bottom+E.top)/2),y(_).concat(A).concat(y(E))}function v(_,E,A,P){return new Qf(e,_-l.left,E-l.top-.01,A-_,P-E+.01)}function y({top:_,bottom:E,horizontal:A}){let P=[];for(let D=0;D<A.length;D+=2)P.push(v(A[D],_,A[D+1],E));return P}function b(_,E,A){let P=1e9,D=-1e9,L=[];function B(z,G,Q,ie,H){let j=t.coordsAtPos(z,z==A.to?-2:2),te=t.coordsAtPos(Q,Q==A.from?2:-2);!j||!te||(P=Math.min(j.top,te.top,P),D=Math.max(j.bottom,te.bottom,D),H==Nt.LTR?L.push(s&&G?d:j.left,s&&ie?h:te.right):L.push(!s&&ie?d:te.left,!s&&G?h:j.right))}let $=_??A.from,J=E??A.to;for(let z of t.visibleRanges)if(z.to>$&&z.from<J)for(let G=Math.max(z.from,$),Q=Math.min(z.to,J);;){let ie=t.state.doc.lineAt(G);for(let H of t.bidiSpans(ie)){let j=H.from+ie.from,te=H.to+ie.from;if(j>=Q)break;te>G&&B(Math.max(j,G),_==null&&j<=$,Math.min(te,Q),E==null&&te>=J,H.dir)}if(G=ie.to+1,G>=Q)break}return L.length==0&&B($,_==null,J,E==null,t.textDirection),{top:P,bottom:D,horizontal:L}}function k(_,E){let A=a.top+(E?_.top:_.bottom);return{top:A,bottom:A,horizontal:[]}}}function vH(t,e){return t.constructor==e.constructor&&t.eq(e)}class yH{constructor(e,n){this.view=e,this.layer=n,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),n.above&&this.dom.classList.add("cm-layer-above"),n.class&&this.dom.classList.add(n.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),n.mount&&n.mount(this.dom,e)}update(e){e.startState.facet(ng)!=e.state.facet(ng)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let n=0,i=e.facet(ng);for(;n<i.length&&i[n]!=this.layer;)n++;this.dom.style.zIndex=String((this.layer.above?150:-1)-n)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:n}=this.view;(e!=this.scaleX||n!=this.scaleY)&&(this.scaleX=e,this.scaleY=n,this.dom.style.transform=`scale(${1/e}, ${1/n})`)}draw(e){if(e.length!=this.drawn.length||e.some((n,i)=>!vH(n,this.drawn[i]))){let n=this.dom.firstChild,i=0;for(let r of e)r.update&&n&&r.constructor&&this.drawn[i].constructor&&r.update(n,this.drawn[i])?(n=n.nextSibling,i++):this.dom.insertBefore(r.draw(),n);for(;n;){let r=n.nextSibling;n.remove(),n=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const ng=_e.define();function yI(t){return[Dn.define(e=>new yH(e,t)),ng.of(t)]}const wI=!be.ios,of=_e.define({combine(t){return nl(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,n)=>Math.min(e,n),drawRangeCursor:(e,n)=>e||n})}});function wH(t={}){return[of.of(t),bH,xH,SH,HD.of(!0)]}function bI(t){return t.startState.facet(of)!=t.state.facet(of)}const bH=yI({above:!0,markers(t){let{state:e}=t,n=e.facet(of),i=[];for(let r of e.selection.ranges){let s=r==e.selection.main;if(r.empty?!s||wI:n.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=r.empty?r:ne.cursor(r.head,r.head>r.anchor?-1:1);for(let l of Qf.forRange(t,o,a))i.push(l)}}return i},update(t,e){t.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let n=bI(t);return n&&jP(t.state,e),t.docChanged||t.selectionSet||n},mount(t,e){jP(e.state,t)},class:"cm-cursorLayer"});function jP(t,e){e.style.animationDuration=t.facet(of).cursorBlinkRate+"ms"}const xH=yI({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:Qf.forRange(t,"cm-selectionBackground",e)).reduce((e,n)=>e.concat(n))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||bI(t)},class:"cm-selectionLayer"}),c1={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};wI&&(c1[".cm-line"].caretColor=c1[".cm-content"].caretColor="transparent !important");const SH=Xf.highest(Pe.theme(c1));function FP(t,e,n,i,r){e.lastIndex=0;for(let s=t.iterRange(n,i),o=n,a;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;a=e.exec(s.value);)r(o+a.index,a)}function kH(t,e){let n=t.visibleRanges;if(n.length==1&&n[0].from==t.viewport.from&&n[0].to==t.viewport.to)return n;let i=[];for(let{from:r,to:s}of n)r=Math.max(t.state.doc.lineAt(r).from,r-e),s=Math.min(t.state.doc.lineAt(s).to,s+e),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}class _H{constructor(e){const{regexp:n,decoration:i,decorate:r,boundary:s,maxLength:o=1e3}=e;if(!n.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=n,r)this.addMatch=(a,l,u,c)=>r(c,u,u+a[0].length,a,l);else if(typeof i=="function")this.addMatch=(a,l,u,c)=>{let d=i(a,l,u);d&&c(u,u+a[0].length,d)};else if(i)this.addMatch=(a,l,u,c)=>c(u,u+a[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let n=new Yl,i=n.add.bind(n);for(let{from:r,to:s}of kH(e,this.maxLength))FP(e.state.doc,this.regexp,r,s,(o,a)=>this.addMatch(a,e,o,i));return n.finish()}updateDeco(e,n){let i=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((s,o,a,l)=>{l>e.view.viewport.from&&a<e.view.viewport.to&&(i=Math.min(a,i),r=Math.max(l,r))}),e.viewportChanged||r-i>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,n.map(e.changes),i,r):n}updateRange(e,n,i,r){for(let s of e.visibleRanges){let o=Math.max(s.from,i),a=Math.min(s.to,r);if(a>o){let l=e.state.doc.lineAt(o),u=l.to<a?e.state.doc.lineAt(a):l,c=Math.max(s.from,l.from),d=Math.min(s.to,u.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){c=o;break}for(;a<u.to;a++)if(this.boundary.test(u.text[a-u.from])){d=a;break}}let h=[],f,p=(m,w,v)=>h.push(v.range(m,w));if(l==u)for(this.regexp.lastIndex=c-l.from;(f=this.regexp.exec(l.text))&&f.index<d-l.from;)this.addMatch(f,e,f.index+l.from,p);else FP(e.state.doc,this.regexp,c,d,(m,w)=>this.addMatch(w,e,m,p));n=n.update({filterFrom:c,filterTo:d,filter:(m,w)=>m<c||w>d,add:h})}}return n}}const d1=/x/.unicode!=null?"gu":"g",CH=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,d1),EH={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let aw=null;function AH(){var t;if(aw==null&&typeof document<"u"&&document.body){let e=document.body.style;aw=((t=e.tabSize)!==null&&t!==void 0?t:e.MozTabSize)!=null}return aw||!1}const ig=_e.define({combine(t){let e=nl(t,{render:null,specialChars:CH,addSpecialChars:null});return(e.replaceTabs=!AH())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,d1)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,d1)),e}});function PH(t={}){return[ig.of(t),TH()]}let BP=null;function TH(){return BP||(BP=Dn.fromClass(class{constructor(t){this.view=t,this.decorations=Ge.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(ig)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new _H({regexp:t.specialChars,decoration:(e,n,i)=>{let{doc:r}=n.state,s=ei(e[0],0);if(s==9){let o=r.lineAt(i),a=n.state.tabSize,l=Yf(o.text,a,i-o.from);return Ge.replace({widget:new OH((a-l%a)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=Ge.replace({widget:new MH(t,s)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(ig);t.startState.facet(ig)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))}const RH="•";function NH(t){return t>=32?RH:t==10?"␤":String.fromCharCode(9216+t)}class MH extends il{constructor(e,n){super(),this.options=e,this.code=n}eq(e){return e.code==this.code}toDOM(e){let n=NH(this.code),i=e.state.phrase("Control character")+" "+(EH[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,i,n);if(r)return r;let s=document.createElement("span");return s.textContent=n,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class OH extends il{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function DH(){return LH}const IH=Ge.line({class:"cm-activeLine"}),LH=Dn.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,n=[];for(let i of t.state.selection.ranges){let r=t.lineBlockAt(i.head);r.from>e&&(n.push(IH.range(r.from)),e=r.from)}return Ge.set(n)}},{decorations:t=>t.decorations}),Cd="-10000px";class xI{constructor(e,n,i,r){this.facet=n,this.createTooltipView=i,this.removeTooltipView=r,this.input=e.state.facet(n),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=i(o,s))}update(e,n){var i;let r=e.state.facet(this.facet),s=r.filter(l=>l);if(r===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let o=[],a=n?[]:null;for(let l=0;l<s.length;l++){let u=s[l],c=-1;if(u){for(let d=0;d<this.tooltips.length;d++){let h=this.tooltips[d];h&&h.create==u.create&&(c=d)}if(c<0)o[l]=this.createTooltipView(u,l?o[l-1]:null),a&&(a[l]=!!u.above);else{let d=o[l]=this.tooltipViews[c];a&&(a[l]=n[c]),d.update&&d.update(e)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(i=l.destroy)===null||i===void 0||i.call(l));return n&&(a.forEach((l,u)=>n[u]=l),n.length=a.length),this.input=r,this.tooltips=s,this.tooltipViews=o,!0}}function jH(t){let{win:e}=t;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const lw=_e.define({combine:t=>{var e,n,i;return{position:be.ios?"absolute":((e=t.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((n=t.find(r=>r.parent))===null||n===void 0?void 0:n.parent)||null,tooltipSpace:((i=t.find(r=>r.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||jH}}}),$P=new WeakMap,Tk=Dn.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(lw);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new xI(t,Rk,(n,i)=>this.createTooltip(n,i),n=>{this.resizeObserver&&this.resizeObserver.unobserve(n.dom),n.dom.remove()}),this.above=this.manager.tooltips.map(n=>!!n.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(n=>{Date.now()>this.lastTransaction-50&&n.length>0&&n[n.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let n=e||t.geometryChanged,i=t.state.facet(lw);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;n=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(t,e){let n=t.create(this.view),i=e?e.dom:null;if(n.dom.classList.add("cm-tooltip"),t.arrow&&!n.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",n.dom.appendChild(r)}return n.dom.style.position=this.position,n.dom.style.top=Cd,n.dom.style.left="0px",this.container.insertBefore(n.dom,i),n.mount&&n.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(n.dom),n}destroy(){var t,e,n;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(t=i.destroy)===null||t===void 0||t.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(n=this.intersectionObserver)===null||n===void 0||n.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=this.view.dom.getBoundingClientRect(),e=1,n=1,i=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(be.gecko)i=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==Cd&&r.style.left=="0px"){let s=r.getBoundingClientRect();i=Math.abs(s.top+1e4)>1||Math.abs(s.left)>1}}if(i||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(e=r.width/this.parent.offsetWidth,n=r.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:n}=this.view.viewState);return{editor:t,parent:this.parent?this.container.getBoundingClientRect():t,pos:this.manager.tooltips.map((r,s)=>{let o=this.manager.tooltipViews[s];return o.getCoords?o.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(lw).tooltipSpace(this.view),scaleX:e,scaleY:n,makeAbsolute:i}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{editor:n,space:i,scaleX:r,scaleY:s}=t,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],u=this.manager.tooltipViews[a],{dom:c}=u,d=t.pos[a],h=t.size[a];if(!d||d.bottom<=Math.max(n.top,i.top)||d.top>=Math.min(n.bottom,i.bottom)||d.right<Math.max(n.left,i.left)-.1||d.left>Math.min(n.right,i.right)+.1){c.style.top=Cd;continue}let f=l.arrow?u.dom.querySelector(".cm-tooltip-arrow"):null,p=f?7:0,m=h.right-h.left,w=(e=$P.get(u))!==null&&e!==void 0?e:h.bottom-h.top,v=u.offset||BH,y=this.view.textDirection==Nt.LTR,b=h.width>i.right-i.left?y?i.left:i.right-h.width:y?Math.max(i.left,Math.min(d.left-(f?14:0)+v.x,i.right-m)):Math.min(Math.max(i.left,d.left-m+(f?14:0)-v.x),i.right-m),k=this.above[a];!l.strictSide&&(k?d.top-(h.bottom-h.top)-v.y<i.top:d.bottom+(h.bottom-h.top)+v.y>i.bottom)&&k==i.bottom-d.bottom>d.top-i.top&&(k=this.above[a]=!k);let _=(k?d.top-i.top:i.bottom-d.bottom)-p;if(_<w&&u.resize!==!1){if(_<this.view.defaultLineHeight){c.style.top=Cd;continue}$P.set(u,w),c.style.height=(w=_)/s+"px"}else c.style.height&&(c.style.height="");let E=k?d.top-w-p-v.y:d.bottom+p+v.y,A=b+m;if(u.overlap!==!0)for(let P of o)P.left<A&&P.right>b&&P.top<E+w&&P.bottom>E&&(E=k?P.top-w-2-p:P.bottom+p+2);if(this.position=="absolute"?(c.style.top=(E-t.parent.top)/s+"px",c.style.left=(b-t.parent.left)/r+"px"):(c.style.top=E/s+"px",c.style.left=b/r+"px"),f){let P=d.left+(y?v.x:-v.x)-(b+14-7);f.style.left=P/r+"px"}u.overlap!==!0&&o.push({left:b,top:E,right:A,bottom:E+w}),c.classList.toggle("cm-tooltip-above",k),c.classList.toggle("cm-tooltip-below",!k),u.positioned&&u.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=Cd}},{eventObservers:{scroll(){this.maybeMeasure()}}}),FH=Pe.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),BH={x:0,y:0},Rk=_e.define({enables:[Tk,FH]}),av=_e.define({combine:t=>t.reduce((e,n)=>e.concat(n),[])});class xy{static create(e){return new xy(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new xI(e,av,(n,i)=>this.createHostedView(n,i),n=>n.dom.remove())}createHostedView(e,n){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,n?n.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let n of this.manager.tooltipViews)n.mount&&n.mount(e);this.mounted=!0}positioned(e){for(let n of this.manager.tooltipViews)n.positioned&&n.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let n of this.manager.tooltipViews)(e=n.destroy)===null||e===void 0||e.call(n)}passProp(e){let n;for(let i of this.manager.tooltipViews){let r=i[e];if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}}return n}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const $H=Rk.compute([av],t=>{let e=t.facet(av);return e.length===0?null:{pos:Math.min(...e.map(n=>n.pos)),end:Math.max(...e.map(n=>{var i;return(i=n.end)!==null&&i!==void 0?i:n.pos})),create:xy.create,above:e[0].above,arrow:e.some(n=>n.arrow)}});class zH{constructor(e,n,i,r,s){this.view=e,this.source=n,this.field=i,this.setHover=r,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:n}=this,i=e.docView.nearest(n.target);if(!i)return;let r,s=1;if(i instanceof ma)r=i.posAtStart;else{if(r=e.posAtCoords(n),r==null)return;let a=e.coordsAtPos(r);if(!a||n.y<a.top||n.y>a.bottom||n.x<a.left-e.defaultCharacterWidth||n.x>a.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(r)).find(c=>c.from<=r&&c.to>=r),u=l&&l.dir==Nt.RTL?-1:1;s=n.x<a.left?-u:u}let o=this.source(e,r,s);if(o!=null&&o.then){let a=this.pending={pos:r};o.then(l=>{this.pending==a&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>Vi(e.state,l,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(Tk),n=e?e.manager.tooltips.findIndex(i=>i.create==xy.create):-1;return n>-1?e.manager.tooltipViews[n]:null}mousemove(e){var n,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:r,tooltip:s}=this;if(r.length&&s&&!UH(s.dom,e)||this.pending){let{pos:o}=r[0]||this.pending,a=(i=(n=r[0])===null||n===void 0?void 0:n.end)!==null&&i!==void 0?i:o;(o==a?this.view.posAtCoords(this.lastMove)!=o:!VH(this.view,o,a,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:n}=this;if(n.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let n=i=>{e.removeEventListener("mouseleave",n),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",n)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const sm=4;function UH(t,e){let n=t.getBoundingClientRect();return e.clientX>=n.left-sm&&e.clientX<=n.right+sm&&e.clientY>=n.top-sm&&e.clientY<=n.bottom+sm}function VH(t,e,n,i,r,s){let o=t.scrollDOM.getBoundingClientRect(),a=t.documentTop+t.documentPadding.top+t.contentHeight;if(o.left>i||o.right<i||o.top>r||Math.min(o.bottom,a)<r)return!1;let l=t.posAtCoords({x:i,y:r},!1);return l>=e&&l<=n}function HH(t,e={}){let n=Xe.define(),i=li.define({create(){return[]},update(r,s){if(r.length&&(e.hideOnChange&&(s.docChanged||s.selection)?r=[]:e.hideOn&&(r=r.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let a of r){let l=s.changes.mapPos(a.pos,-1,xi.TrackDel);if(l!=null){let u=Object.assign(Object.create(null),a);u.pos=l,u.end!=null&&(u.end=s.changes.mapPos(u.end)),o.push(u)}}r=o}for(let o of s.effects)o.is(n)&&(r=o.value),o.is(GH)&&(r=[]);return r},provide:r=>av.from(r)});return[i,Dn.define(r=>new zH(r,t,i,n,e.hoverTime||300)),$H]}function WH(t,e){let n=t.plugin(Tk);if(!n)return null;let i=n.manager.tooltips.indexOf(e);return i<0?null:n.manager.tooltipViews[i]}const GH=Xe.define(),zP=_e.define({combine(t){let e,n;for(let i of t)e=e||i.topContainer,n=n||i.bottomContainer;return{topContainer:e,bottomContainer:n}}});function af(t,e){let n=t.plugin(SI),i=n?n.specs.indexOf(e):-1;return i>-1?n.panels[i]:null}const SI=Dn.fromClass(class{constructor(t){this.input=t.state.facet(lf),this.specs=this.input.filter(n=>n),this.panels=this.specs.map(n=>n(t));let e=t.state.facet(zP);this.top=new om(t,!0,e.topContainer),this.bottom=new om(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(n=>n.top)),this.bottom.sync(this.panels.filter(n=>!n.top));for(let n of this.panels)n.dom.classList.add("cm-panel"),n.mount&&n.mount()}update(t){let e=t.state.facet(zP);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new om(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new om(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=t.state.facet(lf);if(n!=this.input){let i=n.filter(l=>l),r=[],s=[],o=[],a=[];for(let l of i){let u=this.specs.indexOf(l),c;u<0?(c=l(t.view),a.push(c)):(c=this.panels[u],c.update&&c.update(t)),r.push(c),(c.top?s:o).push(c)}this.specs=i,this.panels=r,this.top.sync(s),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let i of this.panels)i.update&&i.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Pe.scrollMargins.of(e=>{let n=e.plugin(t);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}})});class om{constructor(e,n,i){this.view=e,this.top=n,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let n of this.panels)n.destroy&&e.indexOf(n)<0&&n.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let n=this.container||this.view.dom;n.insertBefore(this.dom,this.top?n.firstChild:null)}let e=this.dom.firstChild;for(let n of this.panels)if(n.dom.parentNode==this.dom){for(;e!=n.dom;)e=UP(e);e=e.nextSibling}else this.dom.insertBefore(n.dom,e);for(;e;)e=UP(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function UP(t){let e=t.nextSibling;return t.remove(),e}const lf=_e.define({enables:SI});class Ua extends ql{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ua.prototype.elementClass="";Ua.prototype.toDOM=void 0;Ua.prototype.mapMode=xi.TrackBefore;Ua.prototype.startSide=Ua.prototype.endSide=-1;Ua.prototype.point=!0;const rg=_e.define(),sg=_e.define(),VP=_e.define({combine:t=>t.some(e=>e)});function KH(t){return[XH]}const XH=Dn.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(sg).map(e=>new WP(t,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!t.state.facet(VP),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,n=t.view.viewport,i=Math.min(e.to,n.to)-Math.max(e.from,n.from);this.syncGutters(i<(n.to-n.from)*.8)}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(VP)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let n=ct.iter(this.view.state.facet(rg),this.view.viewport.from),i=[],r=this.gutters.map(s=>new qH(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(s.type)){let o=!0;for(let a of s.type)if(a.type==ii.Text&&o){h1(n,i,a.from);for(let l of r)l.line(this.view,a,i);o=!1}else if(a.widget)for(let l of r)l.widget(this.view,a)}else if(s.type==ii.Text){h1(n,i,s.from);for(let o of r)o.line(this.view,s,i)}else if(s.widget)for(let o of r)o.widget(this.view,s);for(let s of r)s.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(sg),n=t.state.facet(sg),i=t.docChanged||t.heightChanged||t.viewportChanged||!ct.eq(t.startState.facet(rg),t.state.facet(rg),t.view.viewport.from,t.view.viewport.to);if(e==n)for(let r of this.gutters)r.update(t)&&(i=!0);else{i=!0;let r=[];for(let s of n){let o=e.indexOf(s);o<0?r.push(new WP(this.view,s)):(this.gutters[o].update(t),r.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),r.indexOf(s)<0&&s.destroy();for(let s of r)this.dom.appendChild(s.dom);this.gutters=r}return i}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>Pe.scrollMargins.of(e=>{let n=e.plugin(t);return!n||n.gutters.length==0||!n.fixed?null:e.textDirection==Nt.LTR?{left:n.dom.offsetWidth*e.scaleX}:{right:n.dom.offsetWidth*e.scaleX}})});function HP(t){return Array.isArray(t)?t:[t]}function h1(t,e,n){for(;t.value&&t.from<=n;)t.from==n&&e.push(t.value),t.next()}class qH{constructor(e,n,i){this.gutter=e,this.height=i,this.i=0,this.cursor=ct.iter(e.markers,n.from)}addElement(e,n,i){let{gutter:r}=this,s=(n.top-this.height)/e.scaleY,o=n.height/e.scaleY;if(this.i==r.elements.length){let a=new kI(e,o,s,i);r.elements.push(a),r.dom.appendChild(a.dom)}else r.elements[this.i].update(e,o,s,i);this.height=n.bottom,this.i++}line(e,n,i){let r=[];h1(this.cursor,r,n.from),i.length&&(r=r.concat(i));let s=this.gutter.config.lineMarker(e,n,r);s&&r.unshift(s);let o=this.gutter;r.length==0&&!o.config.renderEmptyElements||this.addElement(e,n,r)}widget(e,n){let i=this.gutter.config.widgetMarker(e,n.widget,n);i&&this.addElement(e,n,[i])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let n=e.elements.pop();e.dom.removeChild(n.dom),n.destroy()}}}class WP{constructor(e,n){this.view=e,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in n.domEventHandlers)this.dom.addEventListener(i,r=>{let s=r.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let l=s.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=r.clientY;let a=e.lineBlockAtHeight(o-e.documentTop);n.domEventHandlers[i](e,a,r)&&r.preventDefault()});this.markers=HP(n.markers(e)),n.initialSpacer&&(this.spacer=new kI(e,0,0,[n.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let n=this.markers;if(this.markers=HP(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let i=e.view.viewport;return!ct.eq(this.markers,n,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class kI{constructor(e,n,i,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,n,i,r)}update(e,n,i,r){this.height!=n&&(this.height=n,this.dom.style.height=n+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),YH(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,n){let i="cm-gutterElement",r=this.dom.firstChild;for(let s=0,o=0;;){let a=o,l=s<n.length?n[s++]:null,u=!1;if(l){let c=l.elementClass;c&&(i+=" "+c);for(let d=o;d<this.markers.length;d++)if(this.markers[d].compare(l)){a=d,u=!0;break}}else a=this.markers.length;for(;o<a;){let c=this.markers[o++];if(c.toDOM){c.destroy(r);let d=r.nextSibling;r.remove(),r=d}}if(!l)break;l.toDOM&&(u?r=r.nextSibling:this.dom.insertBefore(l.toDOM(e),r)),u&&o++}this.dom.className=i,this.markers=n}destroy(){this.setMarkers(null,[])}}function YH(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].compare(e[n]))return!1;return!0}const JH=_e.define(),Wu=_e.define({combine(t){return nl(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,n){let i=Object.assign({},e);for(let r in n){let s=i[r],o=n[r];i[r]=s?(a,l,u)=>s(a,l,u)||o(a,l,u):o}return i}})}});class uw extends Ua{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function cw(t,e){return t.state.facet(Wu).formatNumber(e,t.state)}const ZH=sg.compute([Wu],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(JH)},lineMarker(e,n,i){return i.some(r=>r.toDOM)?null:new uw(cw(e,e.state.doc.lineAt(n.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(Wu)!=e.state.facet(Wu),initialSpacer(e){return new uw(cw(e,GP(e.state.doc.lines)))},updateSpacer(e,n){let i=cw(n.view,GP(n.view.state.doc.lines));return i==e.number?e:new uw(i)},domEventHandlers:t.facet(Wu).domEventHandlers}));function QH(t={}){return[Wu.of(t),KH(),ZH]}function GP(t){let e=9;for(;e<t;)e=e*10+9;return e}const e9=new class extends Ua{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},t9=rg.compute(["selection"],t=>{let e=[],n=-1;for(let i of t.selection.ranges){let r=t.doc.lineAt(i.head).from;r>n&&(n=r,e.push(e9.range(r)))}return ct.of(e)});function n9(){return t9}function _I(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=_I(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function Ue(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=_I(t))&&(i&&(i+=" "),i+=e);return i}var Nk={BASE_URL:"/VonSim8/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};const i9=Symbol((Nk?"production":void 0)!=="production"?"RESET":""),r9=t=>typeof(t==null?void 0:t.then)=="function";function s9(t=()=>{try{return window.localStorage}catch(n){(Nk?"production":void 0)!=="production"&&typeof window<"u"&&console.warn(n);return}},e){var n;let i,r;const s={getItem:(l,u)=>{var c,d;const h=p=>{if(p=p||"",i!==p){try{r=JSON.parse(p,e==null?void 0:e.reviver)}catch{return u}i=p}return r},f=(d=(c=t())==null?void 0:c.getItem(l))!=null?d:null;return r9(f)?f.then(h):h(f)},setItem:(l,u)=>{var c;return(c=t())==null?void 0:c.setItem(l,JSON.stringify(u,void 0))},removeItem:l=>{var u;return(u=t())==null?void 0:u.removeItem(l)}},o=l=>(u,c,d)=>l(u,h=>{let f;try{f=JSON.parse(h||"")}catch{f=d}c(f)});let a;try{a=(n=t())==null?void 0:n.subscribe}catch{}return!a&&typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(a=(l,u)=>{if(!(t()instanceof window.Storage))return()=>{};const c=d=>{d.storageArea===t()&&d.key===l&&u(d.newValue)};return window.addEventListener("storage",c),()=>{window.removeEventListener("storage",c)}}),a&&(s.subscribe=o(a)),s}const o9=s9();function CI(t,e,n=o9,i){const r=i==null?void 0:i.getOnInit,s=Ae(r?n.getItem(t,e):e);return(Nk?"production":void 0)!=="production"&&(s.debugPrivate=!0),s.onMount=a=>{a(n.getItem(t,e));let l;return n.subscribe&&(l=n.subscribe(t,a,e)),l},Ae(a=>a(s),(a,l,u)=>{const c=typeof u=="function"?u(a(s)):u;return c===i9?(l(s,e),n.removeItem(t)):c instanceof Promise?c.then(d=>(l(s,d),n.setItem(t,d))):(l(s,c),n.setItem(t,c))})}function a9(t,e=globalThis==null?void 0:globalThis.document){const n=Wn(t);S.useEffect(()=>{const i=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",i,{capture:!0}),()=>e.removeEventListener("keydown",i,{capture:!0})},[n,e])}var l9="DismissableLayer",f1="dismissableLayer.update",u9="dismissableLayer.pointerDownOutside",c9="dismissableLayer.focusOutside",KP,EI=S.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ep=S.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:r,onFocusOutside:s,onInteractOutside:o,onDismiss:a,...l}=t,u=S.useContext(EI),[c,d]=S.useState(null),h=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=S.useState({}),p=rt(e,A=>d(A)),m=Array.from(u.layers),[w]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),v=m.indexOf(w),y=c?m.indexOf(c):-1,b=u.layersWithOutsidePointerEventsDisabled.size>0,k=y>=v,_=h9(A=>{const P=A.target,D=[...u.branches].some(L=>L.contains(P));!k||D||(r==null||r(A),o==null||o(A),A.defaultPrevented||a==null||a())},h),E=f9(A=>{const P=A.target;[...u.branches].some(L=>L.contains(P))||(s==null||s(A),o==null||o(A),A.defaultPrevented||a==null||a())},h);return a9(A=>{y===u.layers.size-1&&(i==null||i(A),!A.defaultPrevented&&a&&(A.preventDefault(),a()))},h),S.useEffect(()=>{if(c)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(KP=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(c)),u.layers.add(c),XP(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=KP)}},[c,h,n,u]),S.useEffect(()=>()=>{c&&(u.layers.delete(c),u.layersWithOutsidePointerEventsDisabled.delete(c),XP())},[c,u]),S.useEffect(()=>{const A=()=>f({});return document.addEventListener(f1,A),()=>document.removeEventListener(f1,A)},[]),g.jsx(Fe.div,{...l,ref:p,style:{pointerEvents:b?k?"auto":"none":void 0,...t.style},onFocusCapture:fe(t.onFocusCapture,E.onFocusCapture),onBlurCapture:fe(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:fe(t.onPointerDownCapture,_.onPointerDownCapture)})});ep.displayName=l9;var d9="DismissableLayerBranch",AI=S.forwardRef((t,e)=>{const n=S.useContext(EI),i=S.useRef(null),r=rt(e,i);return S.useEffect(()=>{const s=i.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),g.jsx(Fe.div,{...t,ref:r})});AI.displayName=d9;function h9(t,e=globalThis==null?void 0:globalThis.document){const n=Wn(t),i=S.useRef(!1),r=S.useRef(()=>{});return S.useEffect(()=>{const s=a=>{if(a.target&&!i.current){let l=function(){PI(u9,n,u,{discrete:!0})};const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);i.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>i.current=!0}}function f9(t,e=globalThis==null?void 0:globalThis.document){const n=Wn(t),i=S.useRef(!1);return S.useEffect(()=>{const r=s=>{s.target&&!i.current&&PI(c9,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function XP(){const t=new CustomEvent(f1);document.dispatchEvent(t)}function PI(t,e,n,{discrete:i}){const r=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),i?hk(r,s):r.dispatchEvent(s)}var p9=ep,m9=AI,dw=0;function Mk(){S.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??qP()),document.body.insertAdjacentElement("beforeend",t[1]??qP()),dw++,()=>{dw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),dw--}},[])}function qP(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}var hw="focusScope.autoFocusOnMount",fw="focusScope.autoFocusOnUnmount",YP={bubbles:!1,cancelable:!0},g9="FocusScope",Sy=S.forwardRef((t,e)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:r,onUnmountAutoFocus:s,...o}=t,[a,l]=S.useState(null),u=Wn(r),c=Wn(s),d=S.useRef(null),h=rt(e,m=>l(m)),f=S.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;S.useEffect(()=>{if(i){let m=function(b){if(f.paused||!a)return;const k=b.target;a.contains(k)?d.current=k:Ko(d.current,{select:!0})},w=function(b){if(f.paused||!a)return;const k=b.relatedTarget;k!==null&&(a.contains(k)||Ko(d.current,{select:!0}))},v=function(b){if(document.activeElement===document.body)for(const _ of b)_.removedNodes.length>0&&Ko(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",w);const y=new MutationObserver(v);return a&&y.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",w),y.disconnect()}}},[i,a,f.paused]),S.useEffect(()=>{if(a){ZP.add(f);const m=document.activeElement;if(!a.contains(m)){const v=new CustomEvent(hw,YP);a.addEventListener(hw,u),a.dispatchEvent(v),v.defaultPrevented||(v9(S9(TI(a)),{select:!0}),document.activeElement===m&&Ko(a))}return()=>{a.removeEventListener(hw,u),setTimeout(()=>{const v=new CustomEvent(fw,YP);a.addEventListener(fw,c),a.dispatchEvent(v),v.defaultPrevented||Ko(m??document.body,{select:!0}),a.removeEventListener(fw,c),ZP.remove(f)},0)}}},[a,u,c,f]);const p=S.useCallback(m=>{if(!n&&!i||f.paused)return;const w=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,v=document.activeElement;if(w&&v){const y=m.currentTarget,[b,k]=y9(y);b&&k?!m.shiftKey&&v===k?(m.preventDefault(),n&&Ko(b,{select:!0})):m.shiftKey&&v===b&&(m.preventDefault(),n&&Ko(k,{select:!0})):v===y&&m.preventDefault()}},[n,i,f.paused]);return g.jsx(Fe.div,{tabIndex:-1,...o,ref:h,onKeyDown:p})});Sy.displayName=g9;function v9(t,{select:e=!1}={}){const n=document.activeElement;for(const i of t)if(Ko(i,{select:e}),document.activeElement!==n)return}function y9(t){const e=TI(t),n=JP(e,t),i=JP(e.reverse(),t);return[n,i]}function TI(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function JP(t,e){for(const n of t)if(!w9(n,{upTo:e}))return n}function w9(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function b9(t){return t instanceof HTMLInputElement&&"select"in t}function Ko(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&b9(t)&&e&&t.select()}}var ZP=x9();function x9(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=QP(t,e),t.unshift(e)},remove(e){var n;t=QP(t,e),(n=t[0])==null||n.resume()}}}function QP(t,e){const n=[...t],i=n.indexOf(e);return i!==-1&&n.splice(i,1),n}function S9(t){return t.filter(e=>e.tagName!=="A")}const k9=["top","right","bottom","left"],Ns=Math.min,zi=Math.max,lv=Math.round,am=Math.floor,Va=t=>({x:t,y:t}),_9={left:"right",right:"left",bottom:"top",top:"bottom"},C9={start:"end",end:"start"};function p1(t,e,n){return zi(t,Ns(e,n))}function Mo(t,e){return typeof t=="function"?t(e):t}function Oo(t){return t.split("-")[0]}function nd(t){return t.split("-")[1]}function Ok(t){return t==="x"?"y":"x"}function Dk(t){return t==="y"?"height":"width"}function Ha(t){return["top","bottom"].includes(Oo(t))?"y":"x"}function Ik(t){return Ok(Ha(t))}function E9(t,e,n){n===void 0&&(n=!1);const i=nd(t),r=Ik(t),s=Dk(r);let o=r==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=uv(o)),[o,uv(o)]}function A9(t){const e=uv(t);return[m1(t),e,m1(e)]}function m1(t){return t.replace(/start|end/g,e=>C9[e])}function P9(t,e,n){const i=["left","right"],r=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?r:i:e?i:r;case"left":case"right":return e?s:o;default:return[]}}function T9(t,e,n,i){const r=nd(t);let s=P9(Oo(t),n==="start",i);return r&&(s=s.map(o=>o+"-"+r),e&&(s=s.concat(s.map(m1)))),s}function uv(t){return t.replace(/left|right|bottom|top/g,e=>_9[e])}function R9(t){return{top:0,right:0,bottom:0,left:0,...t}}function RI(t){return typeof t!="number"?R9(t):{top:t,right:t,bottom:t,left:t}}function cv(t){const{x:e,y:n,width:i,height:r}=t;return{width:i,height:r,top:n,left:e,right:e+i,bottom:n+r,x:e,y:n}}function eT(t,e,n){let{reference:i,floating:r}=t;const s=Ha(e),o=Ik(e),a=Dk(o),l=Oo(e),u=s==="y",c=i.x+i.width/2-r.width/2,d=i.y+i.height/2-r.height/2,h=i[a]/2-r[a]/2;let f;switch(l){case"top":f={x:c,y:i.y-r.height};break;case"bottom":f={x:c,y:i.y+i.height};break;case"right":f={x:i.x+i.width,y:d};break;case"left":f={x:i.x-r.width,y:d};break;default:f={x:i.x,y:i.y}}switch(nd(e)){case"start":f[o]-=h*(n&&u?-1:1);break;case"end":f[o]+=h*(n&&u?-1:1);break}return f}const N9=async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:c,y:d}=eT(u,i,l),h=i,f={},p=0;for(let m=0;m<a.length;m++){const{name:w,fn:v}=a[m],{x:y,y:b,data:k,reset:_}=await v({x:c,y:d,initialPlacement:i,placement:h,strategy:r,middlewareData:f,rects:u,platform:o,elements:{reference:t,floating:e}});c=y??c,d=b??d,f={...f,[w]:{...f[w],...k}},_&&p<=50&&(p++,typeof _=="object"&&(_.placement&&(h=_.placement),_.rects&&(u=_.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):_.rects),{x:c,y:d}=eT(u,h,l)),m=-1)}return{x:c,y:d,placement:h,strategy:r,middlewareData:f}};async function uf(t,e){var n;e===void 0&&(e={});const{x:i,y:r,platform:s,rects:o,elements:a,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=Mo(e,t),p=RI(f),w=a[h?d==="floating"?"reference":"floating":d],v=cv(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(w)))==null||n?w:w.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:u,rootBoundary:c,strategy:l})),y=d==="floating"?{x:i,y:r,width:o.floating.width,height:o.floating.height}:o.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),k=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},_=cv(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:b,strategy:l}):y);return{top:(v.top-_.top+p.top)/k.y,bottom:(_.bottom-v.bottom+p.bottom)/k.y,left:(v.left-_.left+p.left)/k.x,right:(_.right-v.right+p.right)/k.x}}const M9=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:r,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:u,padding:c=0}=Mo(t,e)||{};if(u==null)return{};const d=RI(c),h={x:n,y:i},f=Ik(r),p=Dk(f),m=await o.getDimensions(u),w=f==="y",v=w?"top":"left",y=w?"bottom":"right",b=w?"clientHeight":"clientWidth",k=s.reference[p]+s.reference[f]-h[f]-s.floating[p],_=h[f]-s.reference[f],E=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let A=E?E[b]:0;(!A||!await(o.isElement==null?void 0:o.isElement(E)))&&(A=a.floating[b]||s.floating[p]);const P=k/2-_/2,D=A/2-m[p]/2-1,L=Ns(d[v],D),B=Ns(d[y],D),$=L,J=A-m[p]-B,z=A/2-m[p]/2+P,G=p1($,z,J),Q=!l.arrow&&nd(r)!=null&&z!==G&&s.reference[p]/2-(z<$?L:B)-m[p]/2<0,ie=Q?z<$?z-$:z-J:0;return{[f]:h[f]+ie,data:{[f]:G,centerOffset:z-G-ie,...Q&&{alignmentOffset:ie}},reset:Q}}}),O9=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:r,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...w}=Mo(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const v=Oo(r),y=Ha(a),b=Oo(a)===a,k=await(l.isRTL==null?void 0:l.isRTL(u.floating)),_=h||(b||!m?[uv(a)]:A9(a)),E=p!=="none";!h&&E&&_.push(...T9(a,m,p,k));const A=[a,..._],P=await uf(e,w),D=[];let L=((i=s.flip)==null?void 0:i.overflows)||[];if(c&&D.push(P[v]),d){const z=E9(r,o,k);D.push(P[z[0]],P[z[1]])}if(L=[...L,{placement:r,overflows:D}],!D.every(z=>z<=0)){var B,$;const z=(((B=s.flip)==null?void 0:B.index)||0)+1,G=A[z];if(G)return{data:{index:z,overflows:L},reset:{placement:G}};let Q=($=L.filter(ie=>ie.overflows[0]<=0).sort((ie,H)=>ie.overflows[1]-H.overflows[1])[0])==null?void 0:$.placement;if(!Q)switch(f){case"bestFit":{var J;const ie=(J=L.filter(H=>{if(E){const j=Ha(H.placement);return j===y||j==="y"}return!0}).map(H=>[H.placement,H.overflows.filter(j=>j>0).reduce((j,te)=>j+te,0)]).sort((H,j)=>H[1]-j[1])[0])==null?void 0:J[0];ie&&(Q=ie);break}case"initialPlacement":Q=a;break}if(r!==Q)return{reset:{placement:Q}}}return{}}}};function tT(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function nT(t){return k9.some(e=>t[e]>=0)}const D9=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:i="referenceHidden",...r}=Mo(t,e);switch(i){case"referenceHidden":{const s=await uf(e,{...r,elementContext:"reference"}),o=tT(s,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:nT(o)}}}case"escaped":{const s=await uf(e,{...r,altBoundary:!0}),o=tT(s,n.floating);return{data:{escapedOffsets:o,escaped:nT(o)}}}default:return{}}}}};async function I9(t,e){const{placement:n,platform:i,elements:r}=t,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),o=Oo(n),a=nd(n),l=Ha(n)==="y",u=["left","top"].includes(o)?-1:1,c=s&&l?-1:1,d=Mo(e,t);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*c,y:h*u}:{x:h*u,y:f*c}}const L9=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:r,y:s,placement:o,middlewareData:a}=e,l=await I9(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:{...l,placement:o}}}}},j9=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:r}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:w=>{let{x:v,y}=w;return{x:v,y}}},...l}=Mo(t,e),u={x:n,y:i},c=await uf(e,l),d=Ha(Oo(r)),h=Ok(d);let f=u[h],p=u[d];if(s){const w=h==="y"?"top":"left",v=h==="y"?"bottom":"right",y=f+c[w],b=f-c[v];f=p1(y,f,b)}if(o){const w=d==="y"?"top":"left",v=d==="y"?"bottom":"right",y=p+c[w],b=p-c[v];p=p1(y,p,b)}const m=a.fn({...e,[h]:f,[d]:p});return{...m,data:{x:m.x-n,y:m.y-i}}}}},F9=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:i,placement:r,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:u=!0}=Mo(t,e),c={x:n,y:i},d=Ha(r),h=Ok(d);let f=c[h],p=c[d];const m=Mo(a,e),w=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const b=h==="y"?"height":"width",k=s.reference[h]-s.floating[b]+w.mainAxis,_=s.reference[h]+s.reference[b]-w.mainAxis;f<k?f=k:f>_&&(f=_)}if(u){var v,y;const b=h==="y"?"width":"height",k=["top","left"].includes(Oo(r)),_=s.reference[d]-s.floating[b]+(k&&((v=o.offset)==null?void 0:v[d])||0)+(k?0:w.crossAxis),E=s.reference[d]+s.reference[b]+(k?0:((y=o.offset)==null?void 0:y[d])||0)-(k?w.crossAxis:0);p<_?p=_:p>E&&(p=E)}return{[h]:f,[d]:p}}}},B9=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){const{placement:n,rects:i,platform:r,elements:s}=e,{apply:o=()=>{},...a}=Mo(t,e),l=await uf(e,a),u=Oo(n),c=nd(n),d=Ha(n)==="y",{width:h,height:f}=i.floating;let p,m;u==="top"||u==="bottom"?(p=u,m=c===(await(r.isRTL==null?void 0:r.isRTL(s.floating))?"start":"end")?"left":"right"):(m=u,p=c==="end"?"top":"bottom");const w=f-l.top-l.bottom,v=h-l.left-l.right,y=Ns(f-l[p],w),b=Ns(h-l[m],v),k=!e.middlewareData.shift;let _=y,E=b;if(d?E=c||k?Ns(b,v):v:_=c||k?Ns(y,w):w,k&&!c){const P=zi(l.left,0),D=zi(l.right,0),L=zi(l.top,0),B=zi(l.bottom,0);d?E=h-2*(P!==0||D!==0?P+D:zi(l.left,l.right)):_=f-2*(L!==0||B!==0?L+B:zi(l.top,l.bottom))}await o({...e,availableWidth:E,availableHeight:_});const A=await r.getDimensions(s.floating);return h!==A.width||f!==A.height?{reset:{rects:!0}}:{}}}};function id(t){return NI(t)?(t.nodeName||"").toLowerCase():"#document"}function Ki(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function $o(t){var e;return(e=(NI(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function NI(t){return t instanceof Node||t instanceof Ki(t).Node}function is(t){return t instanceof Element||t instanceof Ki(t).Element}function Bs(t){return t instanceof HTMLElement||t instanceof Ki(t).HTMLElement}function iT(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ki(t).ShadowRoot}function tp(t){const{overflow:e,overflowX:n,overflowY:i,display:r}=rs(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(r)}function $9(t){return["table","td","th"].includes(id(t))}function ky(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Lk(t){const e=jk(),n=is(t)?rs(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function z9(t){let e=Wa(t);for(;Bs(e)&&!jc(e);){if(Lk(e))return e;if(ky(e))return null;e=Wa(e)}return null}function jk(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function jc(t){return["html","body","#document"].includes(id(t))}function rs(t){return Ki(t).getComputedStyle(t)}function _y(t){return is(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Wa(t){if(id(t)==="html")return t;const e=t.assignedSlot||t.parentNode||iT(t)&&t.host||$o(t);return iT(e)?e.host:e}function MI(t){const e=Wa(t);return jc(e)?t.ownerDocument?t.ownerDocument.body:t.body:Bs(e)&&tp(e)?e:MI(e)}function cf(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=MI(t),s=r===((i=t.ownerDocument)==null?void 0:i.body),o=Ki(r);return s?e.concat(o,o.visualViewport||[],tp(r)?r:[],o.frameElement&&n?cf(o.frameElement):[]):e.concat(r,cf(r,[],n))}function OI(t){const e=rs(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=Bs(t),s=r?t.offsetWidth:n,o=r?t.offsetHeight:i,a=lv(n)!==s||lv(i)!==o;return a&&(n=s,i=o),{width:n,height:i,$:a}}function Fk(t){return is(t)?t:t.contextElement}function cc(t){const e=Fk(t);if(!Bs(e))return Va(1);const n=e.getBoundingClientRect(),{width:i,height:r,$:s}=OI(e);let o=(s?lv(n.width):n.width)/i,a=(s?lv(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const U9=Va(0);function DI(t){const e=Ki(t);return!jk()||!e.visualViewport?U9:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function V9(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ki(t)?!1:e}function eu(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=Fk(t);let o=Va(1);e&&(i?is(i)&&(o=cc(i)):o=cc(t));const a=V9(s,n,i)?DI(s):Va(0);let l=(r.left+a.x)/o.x,u=(r.top+a.y)/o.y,c=r.width/o.x,d=r.height/o.y;if(s){const h=Ki(s),f=i&&is(i)?Ki(i):i;let p=h,m=p.frameElement;for(;m&&i&&f!==p;){const w=cc(m),v=m.getBoundingClientRect(),y=rs(m),b=v.left+(m.clientLeft+parseFloat(y.paddingLeft))*w.x,k=v.top+(m.clientTop+parseFloat(y.paddingTop))*w.y;l*=w.x,u*=w.y,c*=w.x,d*=w.y,l+=b,u+=k,p=Ki(m),m=p.frameElement}}return cv({width:c,height:d,x:l,y:u})}function H9(t){let{elements:e,rect:n,offsetParent:i,strategy:r}=t;const s=r==="fixed",o=$o(i),a=e?ky(e.floating):!1;if(i===o||a&&s)return n;let l={scrollLeft:0,scrollTop:0},u=Va(1);const c=Va(0),d=Bs(i);if((d||!d&&!s)&&((id(i)!=="body"||tp(o))&&(l=_y(i)),Bs(i))){const h=eu(i);u=cc(i),c.x=h.x+i.clientLeft,c.y=h.y+i.clientTop}return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+c.x,y:n.y*u.y-l.scrollTop*u.y+c.y}}function W9(t){return Array.from(t.getClientRects())}function II(t){return eu($o(t)).left+_y(t).scrollLeft}function G9(t){const e=$o(t),n=_y(t),i=t.ownerDocument.body,r=zi(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=zi(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let o=-n.scrollLeft+II(t);const a=-n.scrollTop;return rs(i).direction==="rtl"&&(o+=zi(e.clientWidth,i.clientWidth)-r),{width:r,height:s,x:o,y:a}}function K9(t,e){const n=Ki(t),i=$o(t),r=n.visualViewport;let s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;const u=jk();(!u||u&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a,y:l}}function X9(t,e){const n=eu(t,!0,e==="fixed"),i=n.top+t.clientTop,r=n.left+t.clientLeft,s=Bs(t)?cc(t):Va(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,l=r*s.x,u=i*s.y;return{width:o,height:a,x:l,y:u}}function rT(t,e,n){let i;if(e==="viewport")i=K9(t,n);else if(e==="document")i=G9($o(t));else if(is(e))i=X9(e,n);else{const r=DI(t);i={...e,x:e.x-r.x,y:e.y-r.y}}return cv(i)}function LI(t,e){const n=Wa(t);return n===e||!is(n)||jc(n)?!1:rs(n).position==="fixed"||LI(n,e)}function q9(t,e){const n=e.get(t);if(n)return n;let i=cf(t,[],!1).filter(a=>is(a)&&id(a)!=="body"),r=null;const s=rs(t).position==="fixed";let o=s?Wa(t):t;for(;is(o)&&!jc(o);){const a=rs(o),l=Lk(o);!l&&a.position==="fixed"&&(r=null),(s?!l&&!r:!l&&a.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||tp(o)&&!l&&LI(t,o))?i=i.filter(c=>c!==o):r=a,o=Wa(o)}return e.set(t,i),i}function Y9(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const o=[...n==="clippingAncestors"?ky(e)?[]:q9(e,this._c):[].concat(n),i],a=o[0],l=o.reduce((u,c)=>{const d=rT(e,c,r);return u.top=zi(d.top,u.top),u.right=Ns(d.right,u.right),u.bottom=Ns(d.bottom,u.bottom),u.left=zi(d.left,u.left),u},rT(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function J9(t){const{width:e,height:n}=OI(t);return{width:e,height:n}}function Z9(t,e,n){const i=Bs(e),r=$o(e),s=n==="fixed",o=eu(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=Va(0);if(i||!i&&!s)if((id(e)!=="body"||tp(r))&&(a=_y(e)),i){const d=eu(e,!0,s,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else r&&(l.x=II(r));const u=o.left+a.scrollLeft-l.x,c=o.top+a.scrollTop-l.y;return{x:u,y:c,width:o.width,height:o.height}}function pw(t){return rs(t).position==="static"}function sT(t,e){return!Bs(t)||rs(t).position==="fixed"?null:e?e(t):t.offsetParent}function jI(t,e){const n=Ki(t);if(ky(t))return n;if(!Bs(t)){let r=Wa(t);for(;r&&!jc(r);){if(is(r)&&!pw(r))return r;r=Wa(r)}return n}let i=sT(t,e);for(;i&&$9(i)&&pw(i);)i=sT(i,e);return i&&jc(i)&&pw(i)&&!Lk(i)?n:i||z9(t)||n}const Q9=async function(t){const e=this.getOffsetParent||jI,n=this.getDimensions,i=await n(t.floating);return{reference:Z9(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function eW(t){return rs(t).direction==="rtl"}const tW={convertOffsetParentRelativeRectToViewportRelativeRect:H9,getDocumentElement:$o,getClippingRect:Y9,getOffsetParent:jI,getElementRects:Q9,getClientRects:W9,getDimensions:J9,getScale:cc,isElement:is,isRTL:eW};function nW(t,e){let n=null,i;const r=$o(t);function s(){var a;clearTimeout(i),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const{left:u,top:c,width:d,height:h}=t.getBoundingClientRect();if(a||e(),!d||!h)return;const f=am(c),p=am(r.clientWidth-(u+d)),m=am(r.clientHeight-(c+h)),w=am(u),y={rootMargin:-f+"px "+-p+"px "+-m+"px "+-w+"px",threshold:zi(0,Ns(1,l))||1};let b=!0;function k(_){const E=_[0].intersectionRatio;if(E!==l){if(!b)return o();E?o(!1,E):i=setTimeout(()=>{o(!1,1e-7)},1e3)}b=!1}try{n=new IntersectionObserver(k,{...y,root:r.ownerDocument})}catch{n=new IntersectionObserver(k,y)}n.observe(t)}return o(!0),s}function iW(t,e,n,i){i===void 0&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,u=Fk(t),c=r||s?[...u?cf(u):[],...cf(e)]:[];c.forEach(v=>{r&&v.addEventListener("scroll",n,{passive:!0}),s&&v.addEventListener("resize",n)});const d=u&&a?nW(u,n):null;let h=-1,f=null;o&&(f=new ResizeObserver(v=>{let[y]=v;y&&y.target===u&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(e)})),n()}),u&&!l&&f.observe(u),f.observe(e));let p,m=l?eu(t):null;l&&w();function w(){const v=eu(t);m&&(v.x!==m.x||v.y!==m.y||v.width!==m.width||v.height!==m.height)&&n(),m=v,p=requestAnimationFrame(w)}return n(),()=>{var v;c.forEach(y=>{r&&y.removeEventListener("scroll",n),s&&y.removeEventListener("resize",n)}),d==null||d(),(v=f)==null||v.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const rW=L9,sW=j9,oW=O9,aW=B9,lW=D9,oT=M9,uW=F9,cW=(t,e,n)=>{const i=new Map,r={platform:tW,...n},s={...r.platform,_c:i};return N9(t,e,{...r,platform:s})};var og=typeof document<"u"?S.useLayoutEffect:S.useEffect;function dv(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,i,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(i=n;i--!==0;)if(!dv(t[i],e[i]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(e,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!(s==="_owner"&&t.$$typeof)&&!dv(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function FI(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function aT(t,e){const n=FI(t);return Math.round(e*n)/n}function lT(t){const e=S.useRef(t);return og(()=>{e.current=t}),e}function dW(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:i=[],platform:r,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:u}=t,[c,d]=S.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,f]=S.useState(i);dv(h,i)||f(i);const[p,m]=S.useState(null),[w,v]=S.useState(null),y=S.useCallback(ie=>{ie!==E.current&&(E.current=ie,m(ie))},[]),b=S.useCallback(ie=>{ie!==A.current&&(A.current=ie,v(ie))},[]),k=s||p,_=o||w,E=S.useRef(null),A=S.useRef(null),P=S.useRef(c),D=l!=null,L=lT(l),B=lT(r),$=S.useCallback(()=>{if(!E.current||!A.current)return;const ie={placement:e,strategy:n,middleware:h};B.current&&(ie.platform=B.current),cW(E.current,A.current,ie).then(H=>{const j={...H,isPositioned:!0};J.current&&!dv(P.current,j)&&(P.current=j,jo.flushSync(()=>{d(j)}))})},[h,e,n,B]);og(()=>{u===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,d(ie=>({...ie,isPositioned:!1})))},[u]);const J=S.useRef(!1);og(()=>(J.current=!0,()=>{J.current=!1}),[]),og(()=>{if(k&&(E.current=k),_&&(A.current=_),k&&_){if(L.current)return L.current(k,_,$);$()}},[k,_,$,L,D]);const z=S.useMemo(()=>({reference:E,floating:A,setReference:y,setFloating:b}),[y,b]),G=S.useMemo(()=>({reference:k,floating:_}),[k,_]),Q=S.useMemo(()=>{const ie={position:n,left:0,top:0};if(!G.floating)return ie;const H=aT(G.floating,c.x),j=aT(G.floating,c.y);return a?{...ie,transform:"translate("+H+"px, "+j+"px)",...FI(G.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:H,top:j}},[n,a,G.floating,c.x,c.y]);return S.useMemo(()=>({...c,update:$,refs:z,elements:G,floatingStyles:Q}),[c,$,z,G,Q])}const hW=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:i,padding:r}=typeof t=="function"?t(n):t;return i&&e(i)?i.current!=null?oT({element:i.current,padding:r}).fn(n):{}:i?oT({element:i,padding:r}).fn(n):{}}}},fW=(t,e)=>({...rW(t),options:[t,e]}),pW=(t,e)=>({...sW(t),options:[t,e]}),mW=(t,e)=>({...uW(t),options:[t,e]}),gW=(t,e)=>({...oW(t),options:[t,e]}),vW=(t,e)=>({...aW(t),options:[t,e]}),yW=(t,e)=>({...lW(t),options:[t,e]}),wW=(t,e)=>({...hW(t),options:[t,e]});var bW="Arrow",BI=S.forwardRef((t,e)=>{const{children:n,width:i=10,height:r=5,...s}=t;return g.jsx(Fe.svg,{...s,ref:e,width:i,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:g.jsx("polygon",{points:"0,0 30,0 15,10"})})});BI.displayName=bW;var xW=BI;function Bk(t){const[e,n]=S.useState(void 0);return Hn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const i=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const s=r[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,a=u.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return i.observe(t,{box:"border-box"}),()=>i.unobserve(t)}else n(void 0)},[t]),e}var $k="Popper",[$I,rd]=ls($k),[SW,zI]=$I($k),UI=t=>{const{__scopePopper:e,children:n}=t,[i,r]=S.useState(null);return g.jsx(SW,{scope:e,anchor:i,onAnchorChange:r,children:n})};UI.displayName=$k;var VI="PopperAnchor",HI=S.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:i,...r}=t,s=zI(VI,n),o=S.useRef(null),a=rt(e,o);return S.useEffect(()=>{s.onAnchorChange((i==null?void 0:i.current)||o.current)}),i?null:g.jsx(Fe.div,{...r,ref:a})});HI.displayName=VI;var zk="PopperContent",[kW,_W]=$I(zk),WI=S.forwardRef((t,e)=>{var x,T,N,R,W,U;const{__scopePopper:n,side:i="bottom",sideOffset:r=0,align:s="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:c=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:p,...m}=t,w=zI(zk,n),[v,y]=S.useState(null),b=rt(e,Z=>y(Z)),[k,_]=S.useState(null),E=Bk(k),A=(E==null?void 0:E.width)??0,P=(E==null?void 0:E.height)??0,D=i+(s!=="center"?"-"+s:""),L=typeof c=="number"?c:{top:0,right:0,bottom:0,left:0,...c},B=Array.isArray(u)?u:[u],$=B.length>0,J={padding:L,boundary:B.filter(EW),altBoundary:$},{refs:z,floatingStyles:G,placement:Q,isPositioned:ie,middlewareData:H}=dW({strategy:"fixed",placement:D,whileElementsMounted:(...Z)=>iW(...Z,{animationFrame:f==="always"}),elements:{reference:w.anchor},middleware:[fW({mainAxis:r+P,alignmentAxis:o}),l&&pW({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?mW():void 0,...J}),l&&gW({...J}),vW({...J,apply:({elements:Z,rects:K,availableWidth:Se,availableHeight:Oe})=>{const{width:Ie,height:Ne}=K.reference,$e=Z.floating.style;$e.setProperty("--radix-popper-available-width",`${Se}px`),$e.setProperty("--radix-popper-available-height",`${Oe}px`),$e.setProperty("--radix-popper-anchor-width",`${Ie}px`),$e.setProperty("--radix-popper-anchor-height",`${Ne}px`)}}),k&&wW({element:k,padding:a}),AW({arrowWidth:A,arrowHeight:P}),h&&yW({strategy:"referenceHidden",...J})]}),[j,te]=XI(Q),pe=Wn(p);Hn(()=>{ie&&(pe==null||pe())},[ie,pe]);const q=(x=H.arrow)==null?void 0:x.x,ue=(T=H.arrow)==null?void 0:T.y,O=((N=H.arrow)==null?void 0:N.centerOffset)!==0,[M,F]=S.useState();return Hn(()=>{v&&F(window.getComputedStyle(v).zIndex)},[v]),g.jsx("div",{ref:z.setFloating,"data-radix-popper-content-wrapper":"",style:{...G,transform:ie?G.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:M,"--radix-popper-transform-origin":[(R=H.transformOrigin)==null?void 0:R.x,(W=H.transformOrigin)==null?void 0:W.y].join(" "),...((U=H.hide)==null?void 0:U.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:g.jsx(kW,{scope:n,placedSide:j,onArrowChange:_,arrowX:q,arrowY:ue,shouldHideArrow:O,children:g.jsx(Fe.div,{"data-side":j,"data-align":te,...m,ref:b,style:{...m.style,animation:ie?void 0:"none"}})})})});WI.displayName=zk;var GI="PopperArrow",CW={top:"bottom",right:"left",bottom:"top",left:"right"},KI=S.forwardRef(function(e,n){const{__scopePopper:i,...r}=e,s=_W(GI,i),o=CW[s.placedSide];return g.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:g.jsx(xW,{...r,ref:n,style:{...r.style,display:"block"}})})});KI.displayName=GI;function EW(t){return t!==null}var AW=t=>({name:"transformOrigin",options:t,fn(e){var w,v,y;const{placement:n,rects:i,middlewareData:r}=e,o=((w=r.arrow)==null?void 0:w.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[u,c]=XI(n),d={start:"0%",center:"50%",end:"100%"}[c],h=(((v=r.arrow)==null?void 0:v.x)??0)+a/2,f=(((y=r.arrow)==null?void 0:y.y)??0)+l/2;let p="",m="";return u==="bottom"?(p=o?d:`${h}px`,m=`${-l}px`):u==="top"?(p=o?d:`${h}px`,m=`${i.floating.height+l}px`):u==="right"?(p=`${-l}px`,m=o?d:`${f}px`):u==="left"&&(p=`${i.floating.width+l}px`,m=o?d:`${f}px`),{data:{x:p,y:m}}}});function XI(t){const[e,n="center"]=t.split("-");return[e,n]}var Uk=UI,Cy=HI,Vk=WI,Hk=KI,PW="Portal",np=S.forwardRef((t,e)=>{var a;const{container:n,...i}=t,[r,s]=S.useState(!1);Hn(()=>s(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?e6.createPortal(g.jsx(Fe.div,{...i,ref:e}),o):null});np.displayName=PW;var TW=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},gu=new WeakMap,lm=new WeakMap,um={},mw=0,qI=function(t){return t&&(t.host||qI(t.parentNode))},RW=function(t,e){return e.map(function(n){if(t.contains(n))return n;var i=qI(n);return i&&t.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},NW=function(t,e,n,i){var r=RW(e,Array.isArray(t)?t:[t]);um[n]||(um[n]=new WeakMap);var s=um[n],o=[],a=new Set,l=new Set(r),u=function(d){!d||a.has(d)||(a.add(d),u(d.parentNode))};r.forEach(u);var c=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))c(h);else try{var f=h.getAttribute(i),p=f!==null&&f!=="false",m=(gu.get(h)||0)+1,w=(s.get(h)||0)+1;gu.set(h,m),s.set(h,w),o.push(h),m===1&&p&&lm.set(h,!0),w===1&&h.setAttribute(n,"true"),p||h.setAttribute(i,"true")}catch(v){console.error("aria-hidden: cannot operate on ",h,v)}})};return c(e),a.clear(),mw++,function(){o.forEach(function(d){var h=gu.get(d)-1,f=s.get(d)-1;gu.set(d,h),s.set(d,f),h||(lm.has(d)||d.removeAttribute(i),lm.delete(d)),f||d.removeAttribute(n)}),mw--,mw||(gu=new WeakMap,gu=new WeakMap,lm=new WeakMap,um={})}},Wk=function(t,e,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(t)?t:[t]),r=TW(t);return r?(i.push.apply(i,Array.from(r.querySelectorAll("[aria-live]"))),NW(i,r,n,"aria-hidden")):function(){return null}},ag="right-scroll-bar-position",lg="width-before-scroll-bar",MW="with-scroll-bars-hidden",OW="--removed-body-scroll-bar-size";function gw(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function DW(t,e){var n=S.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(i){var r=n.value;r!==i&&(n.value=i,n.callback(i,r))}}}})[0];return n.callback=e,n.facade}var IW=typeof window<"u"?S.useLayoutEffect:S.useEffect,uT=new WeakMap;function LW(t,e){var n=DW(null,function(i){return t.forEach(function(r){return gw(r,i)})});return IW(function(){var i=uT.get(n);if(i){var r=new Set(i),s=new Set(t),o=n.current;r.forEach(function(a){s.has(a)||gw(a,null)}),s.forEach(function(a){r.has(a)||gw(a,o)})}uT.set(n,t)},[t]),n}function jW(t){return t}function FW(t,e){e===void 0&&(e=jW);var n=[],i=!1,r={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,i);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(i=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){i=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var l=function(){var c=o;o=[],c.forEach(s)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(c){o.push(c),u()},filter:function(c){return o=o.filter(c),n}}}};return r}function BW(t){t===void 0&&(t={});var e=FW(null);return e.options=Cs({async:!0,ssr:!1},t),e}var YI=function(t){var e=t.sideCar,n=J2(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=e.read();if(!i)throw new Error("Sidecar medium not found");return S.createElement(i,Cs({},n))};YI.isSideCarExport=!0;function $W(t,e){return t.useMedium(e),YI}var JI=BW(),vw=function(){},Ey=S.forwardRef(function(t,e){var n=S.useRef(null),i=S.useState({onScrollCapture:vw,onWheelCapture:vw,onTouchMoveCapture:vw}),r=i[0],s=i[1],o=t.forwardProps,a=t.children,l=t.className,u=t.removeScrollBar,c=t.enabled,d=t.shards,h=t.sideCar,f=t.noIsolation,p=t.inert,m=t.allowPinchZoom,w=t.as,v=w===void 0?"div":w,y=t.gapMode,b=J2(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=h,_=LW([n,e]),E=Cs(Cs({},b),r);return S.createElement(S.Fragment,null,c&&S.createElement(k,{sideCar:JI,removeScrollBar:u,shards:d,noIsolation:f,inert:p,setCallbacks:s,allowPinchZoom:!!m,lockRef:n,gapMode:y}),o?S.cloneElement(S.Children.only(a),Cs(Cs({},E),{ref:_})):S.createElement(v,Cs({},E,{className:l,ref:_}),a))});Ey.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ey.classNames={fullWidth:lg,zeroRight:ag};var zW=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function UW(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=zW();return e&&t.setAttribute("nonce",e),t}function VW(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function HW(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var WW=function(){var t=0,e=null;return{add:function(n){t==0&&(e=UW())&&(VW(e,n),HW(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},GW=function(){var t=WW();return function(e,n){S.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},ZI=function(){var t=GW(),e=function(n){var i=n.styles,r=n.dynamic;return t(i,r),null};return e},KW={left:0,top:0,right:0,gap:0},yw=function(t){return parseInt(t||"",10)||0},XW=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],i=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[yw(n),yw(i),yw(r)]},qW=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return KW;var e=XW(t),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,i-n+e[2]-e[0])}},YW=ZI(),dc="data-scroll-locked",JW=function(t,e,n,i){var r=t.left,s=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(MW,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(a,"px ").concat(i,`;
  }
  body[`).concat(dc,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(ag,` {
    right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(lg,` {
    margin-right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(ag," .").concat(ag,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(lg," .").concat(lg,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(dc,`] {
    `).concat(OW,": ").concat(a,`px;
  }
`)},cT=function(){var t=parseInt(document.body.getAttribute(dc)||"0",10);return isFinite(t)?t:0},ZW=function(){S.useEffect(function(){return document.body.setAttribute(dc,(cT()+1).toString()),function(){var t=cT()-1;t<=0?document.body.removeAttribute(dc):document.body.setAttribute(dc,t.toString())}},[])},QW=function(t){var e=t.noRelative,n=t.noImportant,i=t.gapMode,r=i===void 0?"margin":i;ZW();var s=S.useMemo(function(){return qW(r)},[r]);return S.createElement(YW,{styles:JW(s,!e,r,n?"":"!important")})},g1=!1;if(typeof window<"u")try{var cm=Object.defineProperty({},"passive",{get:function(){return g1=!0,!0}});window.addEventListener("test",cm,cm),window.removeEventListener("test",cm,cm)}catch{g1=!1}var vu=g1?{passive:!1}:!1,e7=function(t){return t.tagName==="TEXTAREA"},QI=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!e7(t)&&n[e]==="visible")},t7=function(t){return QI(t,"overflowY")},n7=function(t){return QI(t,"overflowX")},dT=function(t,e){var n=e.ownerDocument,i=e;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var r=eL(t,i);if(r){var s=tL(t,i),o=s[1],a=s[2];if(o>a)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},i7=function(t){var e=t.scrollTop,n=t.scrollHeight,i=t.clientHeight;return[e,n,i]},r7=function(t){var e=t.scrollLeft,n=t.scrollWidth,i=t.clientWidth;return[e,n,i]},eL=function(t,e){return t==="v"?t7(e):n7(e)},tL=function(t,e){return t==="v"?i7(e):r7(e)},s7=function(t,e){return t==="h"&&e==="rtl"?-1:1},o7=function(t,e,n,i,r){var s=s7(t,window.getComputedStyle(e).direction),o=s*i,a=n.target,l=e.contains(a),u=!1,c=o>0,d=0,h=0;do{var f=tL(t,a),p=f[0],m=f[1],w=f[2],v=m-w-s*p;(p||v)&&eL(t,a)&&(d+=v,h+=p),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(c&&(Math.abs(d)<1||!r)||!c&&(Math.abs(h)<1||!r))&&(u=!0),u},dm=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},hT=function(t){return[t.deltaX,t.deltaY]},fT=function(t){return t&&"current"in t?t.current:t},a7=function(t,e){return t[0]===e[0]&&t[1]===e[1]},l7=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},u7=0,yu=[];function c7(t){var e=S.useRef([]),n=S.useRef([0,0]),i=S.useRef(),r=S.useState(u7++)[0],s=S.useState(ZI)[0],o=S.useRef(t);S.useEffect(function(){o.current=t},[t]),S.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var m=oU([t.lockRef.current],(t.shards||[]).map(fT),!0).filter(Boolean);return m.forEach(function(w){return w.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),m.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var a=S.useCallback(function(m,w){if("touches"in m&&m.touches.length===2)return!o.current.allowPinchZoom;var v=dm(m),y=n.current,b="deltaX"in m?m.deltaX:y[0]-v[0],k="deltaY"in m?m.deltaY:y[1]-v[1],_,E=m.target,A=Math.abs(b)>Math.abs(k)?"h":"v";if("touches"in m&&A==="h"&&E.type==="range")return!1;var P=dT(A,E);if(!P)return!0;if(P?_=A:(_=A==="v"?"h":"v",P=dT(A,E)),!P)return!1;if(!i.current&&"changedTouches"in m&&(b||k)&&(i.current=_),!_)return!0;var D=i.current||_;return o7(D,w,m,D==="h"?b:k,!0)},[]),l=S.useCallback(function(m){var w=m;if(!(!yu.length||yu[yu.length-1]!==s)){var v="deltaY"in w?hT(w):dm(w),y=e.current.filter(function(_){return _.name===w.type&&(_.target===w.target||w.target===_.shadowParent)&&a7(_.delta,v)})[0];if(y&&y.should){w.cancelable&&w.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(fT).filter(Boolean).filter(function(_){return _.contains(w.target)}),k=b.length>0?a(w,b[0]):!o.current.noIsolation;k&&w.cancelable&&w.preventDefault()}}},[]),u=S.useCallback(function(m,w,v,y){var b={name:m,delta:w,target:v,should:y,shadowParent:d7(v)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(k){return k!==b})},1)},[]),c=S.useCallback(function(m){n.current=dm(m),i.current=void 0},[]),d=S.useCallback(function(m){u(m.type,hT(m),m.target,a(m,t.lockRef.current))},[]),h=S.useCallback(function(m){u(m.type,dm(m),m.target,a(m,t.lockRef.current))},[]);S.useEffect(function(){return yu.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,vu),document.addEventListener("touchmove",l,vu),document.addEventListener("touchstart",c,vu),function(){yu=yu.filter(function(m){return m!==s}),document.removeEventListener("wheel",l,vu),document.removeEventListener("touchmove",l,vu),document.removeEventListener("touchstart",c,vu)}},[]);var f=t.removeScrollBar,p=t.inert;return S.createElement(S.Fragment,null,p?S.createElement(s,{styles:l7(r)}):null,f?S.createElement(QW,{gapMode:t.gapMode}):null)}function d7(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const h7=$W(JI,c7);var Ay=S.forwardRef(function(t,e){return S.createElement(Ey,Cs({},t,{ref:e,sideCar:h7}))});Ay.classNames=Ey.classNames;var v1=["Enter"," "],f7=["ArrowDown","PageUp","Home"],nL=["ArrowUp","PageDown","End"],p7=[...f7,...nL],m7={ltr:[...v1,"ArrowRight"],rtl:[...v1,"ArrowLeft"]},g7={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ip="Menu",[df,v7,y7]=Gf(ip),[lu,iL]=ls(ip,[y7,rd,vy]),Py=rd(),rL=vy(),[w7,uu]=lu(ip),[b7,rp]=lu(ip),sL=t=>{const{__scopeMenu:e,open:n=!1,children:i,dir:r,onOpenChange:s,modal:o=!0}=t,a=Py(e),[l,u]=S.useState(null),c=S.useRef(!1),d=Wn(s),h=Kf(r);return S.useEffect(()=>{const f=()=>{c.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>c.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),g.jsx(Uk,{...a,children:g.jsx(w7,{scope:e,open:n,onOpenChange:d,content:l,onContentChange:u,children:g.jsx(b7,{scope:e,onClose:S.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:c,dir:h,modal:o,children:i})})})};sL.displayName=ip;var x7="MenuAnchor",Gk=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t,r=Py(n);return g.jsx(Cy,{...r,...i,ref:e})});Gk.displayName=x7;var Kk="MenuPortal",[S7,oL]=lu(Kk,{forceMount:void 0}),aL=t=>{const{__scopeMenu:e,forceMount:n,children:i,container:r}=t,s=uu(Kk,e);return g.jsx(S7,{scope:e,forceMount:n,children:g.jsx(Fo,{present:n||s.open,children:g.jsx(np,{asChild:!0,container:r,children:i})})})};aL.displayName=Kk;var kr="MenuContent",[k7,Xk]=lu(kr),lL=S.forwardRef((t,e)=>{const n=oL(kr,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,s=uu(kr,t.__scopeMenu),o=rp(kr,t.__scopeMenu);return g.jsx(df.Provider,{scope:t.__scopeMenu,children:g.jsx(Fo,{present:i||s.open,children:g.jsx(df.Slot,{scope:t.__scopeMenu,children:o.modal?g.jsx(_7,{...r,ref:e}):g.jsx(C7,{...r,ref:e})})})})}),_7=S.forwardRef((t,e)=>{const n=uu(kr,t.__scopeMenu),i=S.useRef(null),r=rt(e,i);return S.useEffect(()=>{const s=i.current;if(s)return Wk(s)},[]),g.jsx(qk,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:fe(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),C7=S.forwardRef((t,e)=>{const n=uu(kr,t.__scopeMenu);return g.jsx(qk,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),qk=S.forwardRef((t,e)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:u,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:h,onDismiss:f,disableOutsideScroll:p,...m}=t,w=uu(kr,n),v=rp(kr,n),y=Py(n),b=rL(n),k=v7(n),[_,E]=S.useState(null),A=S.useRef(null),P=rt(e,A,w.onContentChange),D=S.useRef(0),L=S.useRef(""),B=S.useRef(0),$=S.useRef(null),J=S.useRef("right"),z=S.useRef(0),G=p?Ay:S.Fragment,Q=p?{as:Xl,allowPinchZoom:!0}:void 0,ie=j=>{var x,T;const te=L.current+j,pe=k().filter(N=>!N.disabled),q=document.activeElement,ue=(x=pe.find(N=>N.ref.current===q))==null?void 0:x.textValue,O=pe.map(N=>N.textValue),M=j7(O,te,ue),F=(T=pe.find(N=>N.textValue===M))==null?void 0:T.ref.current;(function N(R){L.current=R,window.clearTimeout(D.current),R!==""&&(D.current=window.setTimeout(()=>N(""),1e3))})(te),F&&setTimeout(()=>F.focus())};S.useEffect(()=>()=>window.clearTimeout(D.current),[]),Mk();const H=S.useCallback(j=>{var pe,q;return J.current===((pe=$.current)==null?void 0:pe.side)&&B7(j,(q=$.current)==null?void 0:q.area)},[]);return g.jsx(k7,{scope:n,searchRef:L,onItemEnter:S.useCallback(j=>{H(j)&&j.preventDefault()},[H]),onItemLeave:S.useCallback(j=>{var te;H(j)||((te=A.current)==null||te.focus(),E(null))},[H]),onTriggerLeave:S.useCallback(j=>{H(j)&&j.preventDefault()},[H]),pointerGraceTimerRef:B,onPointerGraceIntentChange:S.useCallback(j=>{$.current=j},[]),children:g.jsx(G,{...Q,children:g.jsx(Sy,{asChild:!0,trapped:r,onMountAutoFocus:fe(s,j=>{var te;j.preventDefault(),(te=A.current)==null||te.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:g.jsx(ep,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:u,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:h,onDismiss:f,children:g.jsx(b2,{asChild:!0,...b,dir:v.dir,orientation:"vertical",loop:i,currentTabStopId:_,onCurrentTabStopIdChange:E,onEntryFocus:fe(l,j=>{v.isUsingKeyboardRef.current||j.preventDefault()}),preventScrollOnEntryFocus:!0,children:g.jsx(Vk,{role:"menu","aria-orientation":"vertical","data-state":_L(w.open),"data-radix-menu-content":"",dir:v.dir,...y,...m,ref:P,style:{outline:"none",...m.style},onKeyDown:fe(m.onKeyDown,j=>{const pe=j.target.closest("[data-radix-menu-content]")===j.currentTarget,q=j.ctrlKey||j.altKey||j.metaKey,ue=j.key.length===1;pe&&(j.key==="Tab"&&j.preventDefault(),!q&&ue&&ie(j.key));const O=A.current;if(j.target!==O||!p7.includes(j.key))return;j.preventDefault();const F=k().filter(x=>!x.disabled).map(x=>x.ref.current);nL.includes(j.key)&&F.reverse(),I7(F)}),onBlur:fe(t.onBlur,j=>{j.currentTarget.contains(j.target)||(window.clearTimeout(D.current),L.current="")}),onPointerMove:fe(t.onPointerMove,hf(j=>{const te=j.target,pe=z.current!==j.clientX;if(j.currentTarget.contains(te)&&pe){const q=j.clientX>z.current?"right":"left";J.current=q,z.current=j.clientX}}))})})})})})})});lL.displayName=kr;var E7="MenuGroup",Yk=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return g.jsx(Fe.div,{role:"group",...i,ref:e})});Yk.displayName=E7;var A7="MenuLabel",uL=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return g.jsx(Fe.div,{...i,ref:e})});uL.displayName=A7;var hv="MenuItem",pT="menu.itemSelect",Ty=S.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:i,...r}=t,s=S.useRef(null),o=rp(hv,t.__scopeMenu),a=Xk(hv,t.__scopeMenu),l=rt(e,s),u=S.useRef(!1),c=()=>{const d=s.current;if(!n&&d){const h=new CustomEvent(pT,{bubbles:!0,cancelable:!0});d.addEventListener(pT,f=>i==null?void 0:i(f),{once:!0}),hk(d,h),h.defaultPrevented?u.current=!1:o.onClose()}};return g.jsx(cL,{...r,ref:l,disabled:n,onClick:fe(t.onClick,c),onPointerDown:d=>{var h;(h=t.onPointerDown)==null||h.call(t,d),u.current=!0},onPointerUp:fe(t.onPointerUp,d=>{var h;u.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:fe(t.onKeyDown,d=>{const h=a.searchRef.current!=="";n||h&&d.key===" "||v1.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});Ty.displayName=hv;var cL=S.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:i=!1,textValue:r,...s}=t,o=Xk(hv,n),a=rL(n),l=S.useRef(null),u=rt(e,l),[c,d]=S.useState(!1),[h,f]=S.useState("");return S.useEffect(()=>{const p=l.current;p&&f((p.textContent??"").trim())},[s.children]),g.jsx(df.ItemSlot,{scope:n,disabled:i,textValue:r??h,children:g.jsx(x2,{asChild:!0,...a,focusable:!i,children:g.jsx(Fe.div,{role:"menuitem","data-highlighted":c?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...s,ref:u,onPointerMove:fe(t.onPointerMove,hf(p=>{i?o.onItemLeave(p):(o.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:fe(t.onPointerLeave,hf(p=>o.onItemLeave(p))),onFocus:fe(t.onFocus,()=>d(!0)),onBlur:fe(t.onBlur,()=>d(!1))})})})}),P7="MenuCheckboxItem",dL=S.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:i,...r}=t;return g.jsx(gL,{scope:t.__scopeMenu,checked:n,children:g.jsx(Ty,{role:"menuitemcheckbox","aria-checked":fv(n)?"mixed":n,...r,ref:e,"data-state":Zk(n),onSelect:fe(r.onSelect,()=>i==null?void 0:i(fv(n)?!0:!n),{checkForDefaultPrevented:!1})})})});dL.displayName=P7;var hL="MenuRadioGroup",[T7,R7]=lu(hL,{value:void 0,onValueChange:()=>{}}),fL=S.forwardRef((t,e)=>{const{value:n,onValueChange:i,...r}=t,s=Wn(i);return g.jsx(T7,{scope:t.__scopeMenu,value:n,onValueChange:s,children:g.jsx(Yk,{...r,ref:e})})});fL.displayName=hL;var pL="MenuRadioItem",mL=S.forwardRef((t,e)=>{const{value:n,...i}=t,r=R7(pL,t.__scopeMenu),s=n===r.value;return g.jsx(gL,{scope:t.__scopeMenu,checked:s,children:g.jsx(Ty,{role:"menuitemradio","aria-checked":s,...i,ref:e,"data-state":Zk(s),onSelect:fe(i.onSelect,()=>{var o;return(o=r.onValueChange)==null?void 0:o.call(r,n)},{checkForDefaultPrevented:!1})})})});mL.displayName=pL;var Jk="MenuItemIndicator",[gL,N7]=lu(Jk,{checked:!1}),vL=S.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:i,...r}=t,s=N7(Jk,n);return g.jsx(Fo,{present:i||fv(s.checked)||s.checked===!0,children:g.jsx(Fe.span,{...r,ref:e,"data-state":Zk(s.checked)})})});vL.displayName=Jk;var M7="MenuSeparator",yL=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t;return g.jsx(Fe.div,{role:"separator","aria-orientation":"horizontal",...i,ref:e})});yL.displayName=M7;var O7="MenuArrow",wL=S.forwardRef((t,e)=>{const{__scopeMenu:n,...i}=t,r=Py(n);return g.jsx(Hk,{...r,...i,ref:e})});wL.displayName=O7;var D7="MenuSub",[Yse,bL]=lu(D7),Yd="MenuSubTrigger",xL=S.forwardRef((t,e)=>{const n=uu(Yd,t.__scopeMenu),i=rp(Yd,t.__scopeMenu),r=bL(Yd,t.__scopeMenu),s=Xk(Yd,t.__scopeMenu),o=S.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=s,u={__scopeMenu:t.__scopeMenu},c=S.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return S.useEffect(()=>c,[c]),S.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),g.jsx(Gk,{asChild:!0,...u,children:g.jsx(cL,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":_L(n.open),...t,ref:my(e,r.onTriggerChange),onClick:d=>{var h;(h=t.onClick)==null||h.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:fe(t.onPointerMove,hf(d=>{s.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(s.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),c()},100))})),onPointerLeave:fe(t.onPointerLeave,hf(d=>{var f,p;c();const h=(f=n.content)==null?void 0:f.getBoundingClientRect();if(h){const m=(p=n.content)==null?void 0:p.dataset.side,w=m==="right",v=w?-5:5,y=h[w?"left":"right"],b=h[w?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+v,y:d.clientY},{x:y,y:h.top},{x:b,y:h.top},{x:b,y:h.bottom},{x:y,y:h.bottom}],side:m}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:fe(t.onKeyDown,d=>{var f;const h=s.searchRef.current!=="";t.disabled||h&&d.key===" "||m7[i.dir].includes(d.key)&&(n.onOpenChange(!0),(f=n.content)==null||f.focus(),d.preventDefault())})})})});xL.displayName=Yd;var SL="MenuSubContent",kL=S.forwardRef((t,e)=>{const n=oL(kr,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,s=uu(kr,t.__scopeMenu),o=rp(kr,t.__scopeMenu),a=bL(SL,t.__scopeMenu),l=S.useRef(null),u=rt(e,l);return g.jsx(df.Provider,{scope:t.__scopeMenu,children:g.jsx(Fo,{present:i||s.open,children:g.jsx(df.Slot,{scope:t.__scopeMenu,children:g.jsx(qk,{id:a.contentId,"aria-labelledby":a.triggerId,...r,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:c=>{var d;o.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),c.preventDefault()},onCloseAutoFocus:c=>c.preventDefault(),onFocusOutside:fe(t.onFocusOutside,c=>{c.target!==a.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:fe(t.onEscapeKeyDown,c=>{o.onClose(),c.preventDefault()}),onKeyDown:fe(t.onKeyDown,c=>{var f;const d=c.currentTarget.contains(c.target),h=g7[o.dir].includes(c.key);d&&h&&(s.onOpenChange(!1),(f=a.trigger)==null||f.focus(),c.preventDefault())})})})})})});kL.displayName=SL;function _L(t){return t?"open":"closed"}function fv(t){return t==="indeterminate"}function Zk(t){return fv(t)?"indeterminate":t?"checked":"unchecked"}function I7(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function L7(t,e){return t.map((n,i)=>t[(e+i)%t.length])}function j7(t,e,n){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=L7(t,Math.max(s,0));r.length===1&&(o=o.filter(u=>u!==n));const l=o.find(u=>u.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function F7(t,e){const{x:n,y:i}=t;let r=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s].x,l=e[s].y,u=e[o].x,c=e[o].y;l>i!=c>i&&n<(u-a)*(i-l)/(c-l)+a&&(r=!r)}return r}function B7(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return F7(n,e)}function hf(t){return e=>e.pointerType==="mouse"?t(e):void 0}var $7=sL,z7=Gk,U7=aL,V7=lL,H7=Yk,W7=uL,G7=Ty,K7=dL,X7=fL,q7=mL,Y7=vL,J7=yL,Z7=wL,Q7=xL,eG=kL,Qk="DropdownMenu",[tG,Jse]=ls(Qk,[iL]),ui=iL(),[nG,CL]=tG(Qk),EL=t=>{const{__scopeDropdownMenu:e,children:n,dir:i,open:r,defaultOpen:s,onOpenChange:o,modal:a=!0}=t,l=ui(e),u=S.useRef(null),[c=!1,d]=To({prop:r,defaultProp:s,onChange:o});return g.jsx(nG,{scope:e,triggerId:Fa(),triggerRef:u,contentId:Fa(),open:c,onOpenChange:d,onOpenToggle:S.useCallback(()=>d(h=>!h),[d]),modal:a,children:g.jsx($7,{...l,open:c,onOpenChange:d,dir:i,modal:a,children:n})})};EL.displayName=Qk;var AL="DropdownMenuTrigger",PL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...r}=t,s=CL(AL,n),o=ui(n);return g.jsx(z7,{asChild:!0,...o,children:g.jsx(Fe.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...r,ref:my(e,s.triggerRef),onPointerDown:fe(t.onPointerDown,a=>{!i&&a.button===0&&a.ctrlKey===!1&&(s.onOpenToggle(),s.open||a.preventDefault())}),onKeyDown:fe(t.onKeyDown,a=>{i||(["Enter"," "].includes(a.key)&&s.onOpenToggle(),a.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});PL.displayName=AL;var iG="DropdownMenuPortal",TL=t=>{const{__scopeDropdownMenu:e,...n}=t,i=ui(e);return g.jsx(U7,{...i,...n})};TL.displayName=iG;var RL="DropdownMenuContent",NL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=CL(RL,n),s=ui(n),o=S.useRef(!1);return g.jsx(V7,{id:r.contentId,"aria-labelledby":r.triggerId,...s,...i,ref:e,onCloseAutoFocus:fe(t.onCloseAutoFocus,a=>{var l;o.current||(l=r.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:fe(t.onInteractOutside,a=>{const l=a.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,c=l.button===2||u;(!r.modal||c)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});NL.displayName=RL;var rG="DropdownMenuGroup",sG=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(H7,{...r,...i,ref:e})});sG.displayName=rG;var oG="DropdownMenuLabel",ML=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(W7,{...r,...i,ref:e})});ML.displayName=oG;var aG="DropdownMenuItem",OL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(G7,{...r,...i,ref:e})});OL.displayName=aG;var lG="DropdownMenuCheckboxItem",DL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(K7,{...r,...i,ref:e})});DL.displayName=lG;var uG="DropdownMenuRadioGroup",cG=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(X7,{...r,...i,ref:e})});cG.displayName=uG;var dG="DropdownMenuRadioItem",IL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(q7,{...r,...i,ref:e})});IL.displayName=dG;var hG="DropdownMenuItemIndicator",LL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(Y7,{...r,...i,ref:e})});LL.displayName=hG;var fG="DropdownMenuSeparator",jL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(J7,{...r,...i,ref:e})});jL.displayName=fG;var pG="DropdownMenuArrow",mG=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(Z7,{...r,...i,ref:e})});mG.displayName=pG;var gG="DropdownMenuSubTrigger",FL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(Q7,{...r,...i,ref:e})});FL.displayName=gG;var vG="DropdownMenuSubContent",BL=S.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...i}=t,r=ui(n);return g.jsx(eG,{...r,...i,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});BL.displayName=vG;var yG=EL,wG=PL,bG=TL,$L=NL,zL=ML,UL=OL,VL=DL,HL=IL,WL=LL,GL=jL,KL=FL,XL=BL;const qL=yG,YL=wG,xG=S.forwardRef(({className:t,inset:e,children:n,...i},r)=>g.jsxs(KL,{ref:r,className:Ue("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-mantis-500 data-[state=open]:bg-mantis-500",e&&"pl-8",t),...i,children:[n,g.jsx("span",{className:"icon-[lucide--chevron-right] ml-auto block h-4 w-4"})]}));xG.displayName=KL.displayName;const SG=S.forwardRef(({className:t,...e},n)=>g.jsx(XL,{ref:n,className:Ue("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-stone-900 p-1 text-white shadow-lg transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...e}));SG.displayName=XL.displayName;const e_=S.forwardRef(({className:t,sideOffset:e=4,...n},i)=>g.jsx(bG,{children:g.jsx($L,{ref:i,sideOffset:e,className:Ue("z-50 min-w-[8rem] overflow-hidden rounded-md border border-stone-600 bg-stone-900 p-1 text-white shadow-md transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...n})}));e_.displayName=$L.displayName;const Bl=S.forwardRef(({className:t,inset:e,...n},i)=>g.jsx(UL,{ref:i,className:Ue("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",t),...n}));Bl.displayName=UL.displayName;const kG=S.forwardRef(({className:t,children:e,checked:n,...i},r)=>g.jsxs(VL,{ref:r,className:Ue("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...i,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(WL,{children:g.jsx("span",{className:"icon-[lucide--check] h-4 w-4"})})}),e]}));kG.displayName=VL.displayName;const _G=S.forwardRef(({className:t,children:e,...n},i)=>g.jsxs(HL,{ref:i,className:Ue("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(WL,{children:g.jsx("span",{className:"icon-[lucide--circle-dot] block h-4 w-4"})})}),e]}));_G.displayName=HL.displayName;const CG=S.forwardRef(({className:t,inset:e,...n},i)=>g.jsx(zL,{ref:i,className:Ue("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));CG.displayName=zL.displayName;const EG=S.forwardRef(({className:t,...e},n)=>g.jsx(GL,{ref:n,className:Ue("-mx-1 my-1 h-px bg-stone-600",t),...e}));EG.displayName=GL.displayName;function JL(t,e){const n=e.split(".");let i=t;for(const r of n)if(r in i)i=i[r];else throw new ReferenceError(`Couldn't find path "${e}".`);return i}const ZL=["en","es"];function t_(t){return function(n,i,...r){const s=JL(t[n],i);if(typeof s=="function")return s(...r);if(typeof s=="string")return s;throw new Error(`Missing translation for key ${i}`)}}const ee=gk();function AG(t){return g.jsx(B6,{store:ee,children:t.children})}var nt;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function n(r){throw new Error}t.assertNever=n,t.arrayToEnum=r=>{const s={};for(const o of r)s[o]=o;return s},t.getValidEnumValues=r=>{const s=t.objectKeys(r).filter(a=>typeof r[r[a]]!="number"),o={};for(const a of s)o[a]=r[a];return t.objectValues(o)},t.objectValues=r=>t.objectKeys(r).map(function(s){return r[s]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const s=[];for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&s.push(o);return s},t.find=(r,s)=>{for(const o of r)if(s(o))return o},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function i(r,s=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}t.joinValues=i,t.jsonStringifyReplacer=(r,s)=>typeof s=="bigint"?s.toString():s})(nt||(nt={}));var y1;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(y1||(y1={}));const we=nt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),oa=t=>{switch(typeof t){case"undefined":return we.undefined;case"string":return we.string;case"number":return isNaN(t)?we.nan:we.number;case"boolean":return we.boolean;case"function":return we.function;case"bigint":return we.bigint;case"symbol":return we.symbol;case"object":return Array.isArray(t)?we.array:t===null?we.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?we.promise:typeof Map<"u"&&t instanceof Map?we.map:typeof Set<"u"&&t instanceof Set?we.set:typeof Date<"u"&&t instanceof Date?we.date:we.object;default:return we.unknown}},ae=nt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),PG=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Xi extends Error{constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(s){return s.message},i={_errors:[]},r=s=>{for(const o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)i._errors.push(n(o));else{let a=i,l=0;for(;l<o.path.length;){const u=o.path[l];l===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(n(o))):a[u]=a[u]||{_errors:[]},a=a[u],l++}}};return r(this),i}static assert(e){if(!(e instanceof Xi))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,nt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},i=[];for(const r of this.issues)r.path.length>0?(n[r.path[0]]=n[r.path[0]]||[],n[r.path[0]].push(e(r))):i.push(e(r));return{formErrors:i,fieldErrors:n}}get formErrors(){return this.flatten()}}Xi.create=t=>new Xi(t);const Fc=(t,e)=>{let n;switch(t.code){case ae.invalid_type:t.received===we.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ae.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,nt.jsonStringifyReplacer)}`;break;case ae.unrecognized_keys:n=`Unrecognized key(s) in object: ${nt.joinValues(t.keys,", ")}`;break;case ae.invalid_union:n="Invalid input";break;case ae.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${nt.joinValues(t.options)}`;break;case ae.invalid_enum_value:n=`Invalid enum value. Expected ${nt.joinValues(t.options)}, received '${t.received}'`;break;case ae.invalid_arguments:n="Invalid function arguments";break;case ae.invalid_return_type:n="Invalid function return type";break;case ae.invalid_date:n="Invalid date";break;case ae.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:nt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ae.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ae.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ae.custom:n="Invalid input";break;case ae.invalid_intersection_types:n="Intersection results could not be merged";break;case ae.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ae.not_finite:n="Number must be finite";break;default:n=e.defaultError,nt.assertNever(t)}return{message:n}};let QL=Fc;function TG(t){QL=t}function pv(){return QL}const mv=t=>{const{data:e,path:n,errorMaps:i,issueData:r}=t,s=[...n,...r.path||[]],o={...r,path:s};if(r.message!==void 0)return{...r,path:s,message:r.message};let a="";const l=i.filter(u=>!!u).slice().reverse();for(const u of l)a=u(o,{data:e,defaultError:a}).message;return{...r,path:s,message:a}},RG=[];function me(t,e){const n=pv(),i=mv({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Fc?void 0:Fc].filter(r=>!!r)});t.common.issues.push(i)}class Gn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const i=[];for(const r of n){if(r.status==="aborted")return je;r.status==="dirty"&&e.dirty(),i.push(r.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,n){const i=[];for(const r of n){const s=await r.key,o=await r.value;i.push({key:s,value:o})}return Gn.mergeObjectSync(e,i)}static mergeObjectSync(e,n){const i={};for(const r of n){const{key:s,value:o}=r;if(s.status==="aborted"||o.status==="aborted")return je;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(i[s.value]=o.value)}return{status:e.value,value:i}}}const je=Object.freeze({status:"aborted"}),Gu=t=>({status:"dirty",value:t}),si=t=>({status:"valid",value:t}),w1=t=>t.status==="aborted",b1=t=>t.status==="dirty",ff=t=>t.status==="valid",pf=t=>typeof Promise<"u"&&t instanceof Promise;function gv(t,e,n,i){if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function ej(t,e,n,i,r){if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var Te;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Te||(Te={}));var Jd,Zd;class $s{constructor(e,n,i,r){this._cachedPath=[],this.parent=e,this.data=n,this._path=i,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const mT=(t,e)=>{if(ff(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Xi(t.common.issues);return this._error=n,this._error}}};function He(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:i,description:r}=t;if(e&&(n||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,a)=>{var l,u;const{message:c}=t;return o.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:(l=c??i)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(u=c??n)!==null&&u!==void 0?u:a.defaultError}},description:r}}class Ke{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return oa(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:oa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Gn,ctx:{common:e.parent.common,data:e.data,parsedType:oa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(pf(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const i=this.safeParse(e,n);if(i.success)return i.data;throw i.error}safeParse(e,n){var i;const r={common:{issues:[],async:(i=n==null?void 0:n.async)!==null&&i!==void 0?i:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:oa(e)},s=this._parseSync({data:e,path:r.path,parent:r});return mT(r,s)}async parseAsync(e,n){const i=await this.safeParseAsync(e,n);if(i.success)return i.data;throw i.error}async safeParseAsync(e,n){const i={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:oa(e)},r=this._parse({data:e,path:i.path,parent:i}),s=await(pf(r)?r:Promise.resolve(r));return mT(i,s)}refine(e,n){const i=r=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(r):n;return this._refinement((r,s)=>{const o=e(r),a=()=>s.addIssue({code:ae.custom,...i(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((i,r)=>e(i)?!0:(r.addIssue(typeof n=="function"?n(i,r):n),!1))}_refinement(e){return new ss({schema:this,typeName:Le.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return js.create(this,this._def)}nullable(){return qa.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Qr.create(this,this._def)}promise(){return $c.create(this,this._def)}or(e){return yf.create([this,e],this._def)}and(e){return wf.create(this,e,this._def)}transform(e){return new ss({...He(this._def),schema:this,typeName:Le.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new _f({...He(this._def),innerType:this,defaultValue:n,typeName:Le.ZodDefault})}brand(){return new n_({typeName:Le.ZodBranded,type:this,...He(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Cf({...He(this._def),innerType:this,catchValue:n,typeName:Le.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return sp.create(this,e)}readonly(){return Ef.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const NG=/^c[^\s-]{8,}$/i,MG=/^[0-9a-z]+$/,OG=/^[0-9A-HJKMNP-TV-Z]{26}$/,DG=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,IG=/^[a-z0-9_-]{21}$/i,LG=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,jG=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,FG="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ww;const BG=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,$G=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,zG=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,tj="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",UG=new RegExp(`^${tj}$`);function nj(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function VG(t){return new RegExp(`^${nj(t)}$`)}function ij(t){let e=`${tj}T${nj(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function HG(t,e){return!!((e==="v4"||!e)&&BG.test(t)||(e==="v6"||!e)&&$G.test(t))}class Kr extends Ke{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==we.string){const s=this._getOrReturnCtx(e);return me(s,{code:ae.invalid_type,expected:we.string,received:s.parsedType}),je}const i=new Gn;let r;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:ae.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="max")e.data.length>s.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:ae.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="length"){const o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(r=this._getOrReturnCtx(e,r),o?me(r,{code:ae.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&me(r,{code:ae.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),i.dirty())}else if(s.kind==="email")jG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"email",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="emoji")ww||(ww=new RegExp(FG,"u")),ww.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"emoji",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="uuid")DG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"uuid",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="nanoid")IG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"nanoid",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid")NG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"cuid",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid2")MG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"cuid2",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="ulid")OG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"ulid",code:ae.invalid_string,message:s.message}),i.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),me(r,{validation:"url",code:ae.invalid_string,message:s.message}),i.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"regex",code:ae.invalid_string,message:s.message}),i.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),i.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:{startsWith:s.value},message:s.message}),i.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:{endsWith:s.value},message:s.message}),i.dirty()):s.kind==="datetime"?ij(s).test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:"datetime",message:s.message}),i.dirty()):s.kind==="date"?UG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:"date",message:s.message}),i.dirty()):s.kind==="time"?VG(s).test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{code:ae.invalid_string,validation:"time",message:s.message}),i.dirty()):s.kind==="duration"?LG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"duration",code:ae.invalid_string,message:s.message}),i.dirty()):s.kind==="ip"?HG(e.data,s.version)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"ip",code:ae.invalid_string,message:s.message}),i.dirty()):s.kind==="base64"?zG.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"base64",code:ae.invalid_string,message:s.message}),i.dirty()):nt.assertNever(s);return{status:i.value,value:e.data}}_regex(e,n,i){return this.refinement(r=>e.test(r),{validation:n,code:ae.invalid_string,...Te.errToObj(i)})}_addCheck(e){return new Kr({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Te.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Te.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Te.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Te.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Te.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Te.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Te.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Te.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Te.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Te.errToObj(e)})}datetime(e){var n,i;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,local:(i=e==null?void 0:e.local)!==null&&i!==void 0?i:!1,...Te.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Te.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Te.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Te.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Te.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Te.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Te.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Te.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Te.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Te.errToObj(n)})}nonempty(e){return this.min(1,Te.errToObj(e))}trim(){return new Kr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Kr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Kr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Kr.create=t=>{var e;return new Kr({checks:[],typeName:Le.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...He(t)})};function WG(t,e){const n=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,r=n>i?n:i,s=parseInt(t.toFixed(r).replace(".","")),o=parseInt(e.toFixed(r).replace(".",""));return s%o/Math.pow(10,r)}class Ga extends Ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==we.number){const s=this._getOrReturnCtx(e);return me(s,{code:ae.invalid_type,expected:we.number,received:s.parsedType}),je}let i;const r=new Gn;for(const s of this._def.checks)s.kind==="int"?nt.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),me(i,{code:ae.invalid_type,expected:"integer",received:"float",message:s.message}),r.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):s.kind==="multipleOf"?WG(e.data,s.value)!==0&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),me(i,{code:ae.not_finite,message:s.message}),r.dirty()):nt.assertNever(s);return{status:r.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Te.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Te.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Te.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Te.toString(n))}setLimit(e,n,i,r){return new Ga({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:Te.toString(r)}]})}_addCheck(e){return new Ga({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Te.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Te.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Te.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Te.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Te.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Te.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Te.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Te.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Te.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&nt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(n===null||i.value>n)&&(n=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Ga.create=t=>new Ga({checks:[],typeName:Le.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...He(t)});class Ka extends Ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==we.bigint){const s=this._getOrReturnCtx(e);return me(s,{code:ae.invalid_type,expected:we.bigint,received:s.parsedType}),je}let i;const r=new Gn;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),me(i,{code:ae.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):nt.assertNever(s);return{status:r.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Te.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Te.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Te.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Te.toString(n))}setLimit(e,n,i,r){return new Ka({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:i,message:Te.toString(r)}]})}_addCheck(e){return new Ka({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Te.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Te.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Te.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Te.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Te.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ka.create=t=>{var e;return new Ka({checks:[],typeName:Le.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...He(t)})};class mf extends Ke{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==we.boolean){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.boolean,received:i.parsedType}),je}return si(e.data)}}mf.create=t=>new mf({typeName:Le.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...He(t)});class tu extends Ke{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==we.date){const s=this._getOrReturnCtx(e);return me(s,{code:ae.invalid_type,expected:we.date,received:s.parsedType}),je}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return me(s,{code:ae.invalid_date}),je}const i=new Gn;let r;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:ae.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),i.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:ae.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),i.dirty()):nt.assertNever(s);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new tu({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Te.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Te.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}tu.create=t=>new tu({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Le.ZodDate,...He(t)});class vv extends Ke{_parse(e){if(this._getType(e)!==we.symbol){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.symbol,received:i.parsedType}),je}return si(e.data)}}vv.create=t=>new vv({typeName:Le.ZodSymbol,...He(t)});class gf extends Ke{_parse(e){if(this._getType(e)!==we.undefined){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.undefined,received:i.parsedType}),je}return si(e.data)}}gf.create=t=>new gf({typeName:Le.ZodUndefined,...He(t)});class vf extends Ke{_parse(e){if(this._getType(e)!==we.null){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.null,received:i.parsedType}),je}return si(e.data)}}vf.create=t=>new vf({typeName:Le.ZodNull,...He(t)});class Bc extends Ke{constructor(){super(...arguments),this._any=!0}_parse(e){return si(e.data)}}Bc.create=t=>new Bc({typeName:Le.ZodAny,...He(t)});class $l extends Ke{constructor(){super(...arguments),this._unknown=!0}_parse(e){return si(e.data)}}$l.create=t=>new $l({typeName:Le.ZodUnknown,...He(t)});class Do extends Ke{_parse(e){const n=this._getOrReturnCtx(e);return me(n,{code:ae.invalid_type,expected:we.never,received:n.parsedType}),je}}Do.create=t=>new Do({typeName:Le.ZodNever,...He(t)});class yv extends Ke{_parse(e){if(this._getType(e)!==we.undefined){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.void,received:i.parsedType}),je}return si(e.data)}}yv.create=t=>new yv({typeName:Le.ZodVoid,...He(t)});class Qr extends Ke{_parse(e){const{ctx:n,status:i}=this._processInputParams(e),r=this._def;if(n.parsedType!==we.array)return me(n,{code:ae.invalid_type,expected:we.array,received:n.parsedType}),je;if(r.exactLength!==null){const o=n.data.length>r.exactLength.value,a=n.data.length<r.exactLength.value;(o||a)&&(me(n,{code:o?ae.too_big:ae.too_small,minimum:a?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),i.dirty())}if(r.minLength!==null&&n.data.length<r.minLength.value&&(me(n,{code:ae.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),i.dirty()),r.maxLength!==null&&n.data.length>r.maxLength.value&&(me(n,{code:ae.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),i.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>r.type._parseAsync(new $s(n,o,n.path,a)))).then(o=>Gn.mergeArray(i,o));const s=[...n.data].map((o,a)=>r.type._parseSync(new $s(n,o,n.path,a)));return Gn.mergeArray(i,s)}get element(){return this._def.type}min(e,n){return new Qr({...this._def,minLength:{value:e,message:Te.toString(n)}})}max(e,n){return new Qr({...this._def,maxLength:{value:e,message:Te.toString(n)}})}length(e,n){return new Qr({...this._def,exactLength:{value:e,message:Te.toString(n)}})}nonempty(e){return this.min(1,e)}}Qr.create=(t,e)=>new Qr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Le.ZodArray,...He(e)});function _u(t){if(t instanceof Lt){const e={};for(const n in t.shape){const i=t.shape[n];e[n]=js.create(_u(i))}return new Lt({...t._def,shape:()=>e})}else return t instanceof Qr?new Qr({...t._def,type:_u(t.element)}):t instanceof js?js.create(_u(t.unwrap())):t instanceof qa?qa.create(_u(t.unwrap())):t instanceof zs?zs.create(t.items.map(e=>_u(e))):t}class Lt extends Ke{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=nt.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==we.object){const u=this._getOrReturnCtx(e);return me(u,{code:ae.invalid_type,expected:we.object,received:u.parsedType}),je}const{status:i,ctx:r}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Do&&this._def.unknownKeys==="strip"))for(const u in r.data)o.includes(u)||a.push(u);const l=[];for(const u of o){const c=s[u],d=r.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new $s(r,d,r.path,u)),alwaysSet:u in r.data})}if(this._def.catchall instanceof Do){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of a)l.push({key:{status:"valid",value:c},value:{status:"valid",value:r.data[c]}});else if(u==="strict")a.length>0&&(me(r,{code:ae.unrecognized_keys,keys:a}),i.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of a){const d=r.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new $s(r,d,r.path,c)),alwaysSet:c in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const d=await c.key,h=await c.value;u.push({key:d,value:h,alwaysSet:c.alwaysSet})}return u}).then(u=>Gn.mergeObjectSync(i,u)):Gn.mergeObjectSync(i,l)}get shape(){return this._def.shape()}strict(e){return Te.errToObj,new Lt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,i)=>{var r,s,o,a;const l=(o=(s=(r=this._def).errorMap)===null||s===void 0?void 0:s.call(r,n,i).message)!==null&&o!==void 0?o:i.defaultError;return n.code==="unrecognized_keys"?{message:(a=Te.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new Lt({...this._def,unknownKeys:"strip"})}passthrough(){return new Lt({...this._def,unknownKeys:"passthrough"})}extend(e){return new Lt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Lt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Le.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Lt({...this._def,catchall:e})}pick(e){const n={};return nt.objectKeys(e).forEach(i=>{e[i]&&this.shape[i]&&(n[i]=this.shape[i])}),new Lt({...this._def,shape:()=>n})}omit(e){const n={};return nt.objectKeys(this.shape).forEach(i=>{e[i]||(n[i]=this.shape[i])}),new Lt({...this._def,shape:()=>n})}deepPartial(){return _u(this)}partial(e){const n={};return nt.objectKeys(this.shape).forEach(i=>{const r=this.shape[i];e&&!e[i]?n[i]=r:n[i]=r.optional()}),new Lt({...this._def,shape:()=>n})}required(e){const n={};return nt.objectKeys(this.shape).forEach(i=>{if(e&&!e[i])n[i]=this.shape[i];else{let s=this.shape[i];for(;s instanceof js;)s=s._def.innerType;n[i]=s}}),new Lt({...this._def,shape:()=>n})}keyof(){return rj(nt.objectKeys(this.shape))}}Lt.create=(t,e)=>new Lt({shape:()=>t,unknownKeys:"strip",catchall:Do.create(),typeName:Le.ZodObject,...He(e)});Lt.strictCreate=(t,e)=>new Lt({shape:()=>t,unknownKeys:"strict",catchall:Do.create(),typeName:Le.ZodObject,...He(e)});Lt.lazycreate=(t,e)=>new Lt({shape:t,unknownKeys:"strip",catchall:Do.create(),typeName:Le.ZodObject,...He(e)});class yf extends Ke{_parse(e){const{ctx:n}=this._processInputParams(e),i=this._def.options;function r(s){for(const a of s)if(a.result.status==="valid")return a.result;for(const a of s)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(a=>new Xi(a.ctx.common.issues));return me(n,{code:ae.invalid_union,unionErrors:o}),je}if(n.common.async)return Promise.all(i.map(async s=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(r);{let s;const o=[];for(const l of i){const u={...n,common:{...n.common,issues:[]},parent:null},c=l._parseSync({data:n.data,path:n.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!s&&(s={result:c,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const a=o.map(l=>new Xi(l));return me(n,{code:ae.invalid_union,unionErrors:a}),je}}get options(){return this._def.options}}yf.create=(t,e)=>new yf({options:t,typeName:Le.ZodUnion,...He(e)});const Xs=t=>t instanceof xf?Xs(t.schema):t instanceof ss?Xs(t.innerType()):t instanceof Sf?[t.value]:t instanceof Xa?t.options:t instanceof kf?nt.objectValues(t.enum):t instanceof _f?Xs(t._def.innerType):t instanceof gf?[void 0]:t instanceof vf?[null]:t instanceof js?[void 0,...Xs(t.unwrap())]:t instanceof qa?[null,...Xs(t.unwrap())]:t instanceof n_||t instanceof Ef?Xs(t.unwrap()):t instanceof Cf?Xs(t._def.innerType):[];class Ry extends Ke{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==we.object)return me(n,{code:ae.invalid_type,expected:we.object,received:n.parsedType}),je;const i=this.discriminator,r=n.data[i],s=this.optionsMap.get(r);return s?n.common.async?s._parseAsync({data:n.data,path:n.path,parent:n}):s._parseSync({data:n.data,path:n.path,parent:n}):(me(n,{code:ae.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),je)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,i){const r=new Map;for(const s of n){const o=Xs(s.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(r.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);r.set(a,s)}}return new Ry({typeName:Le.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:r,...He(i)})}}function x1(t,e){const n=oa(t),i=oa(e);if(t===e)return{valid:!0,data:t};if(n===we.object&&i===we.object){const r=nt.objectKeys(e),s=nt.objectKeys(t).filter(a=>r.indexOf(a)!==-1),o={...t,...e};for(const a of s){const l=x1(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(n===we.array&&i===we.array){if(t.length!==e.length)return{valid:!1};const r=[];for(let s=0;s<t.length;s++){const o=t[s],a=e[s],l=x1(o,a);if(!l.valid)return{valid:!1};r.push(l.data)}return{valid:!0,data:r}}else return n===we.date&&i===we.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class wf extends Ke{_parse(e){const{status:n,ctx:i}=this._processInputParams(e),r=(s,o)=>{if(w1(s)||w1(o))return je;const a=x1(s.value,o.value);return a.valid?((b1(s)||b1(o))&&n.dirty(),{status:n.value,value:a.data}):(me(i,{code:ae.invalid_intersection_types}),je)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([s,o])=>r(s,o)):r(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}wf.create=(t,e,n)=>new wf({left:t,right:e,typeName:Le.ZodIntersection,...He(n)});class zs extends Ke{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==we.array)return me(i,{code:ae.invalid_type,expected:we.array,received:i.parsedType}),je;if(i.data.length<this._def.items.length)return me(i,{code:ae.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),je;!this._def.rest&&i.data.length>this._def.items.length&&(me(i,{code:ae.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...i.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new $s(i,o,i.path,a)):null}).filter(o=>!!o);return i.common.async?Promise.all(s).then(o=>Gn.mergeArray(n,o)):Gn.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new zs({...this._def,rest:e})}}zs.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new zs({items:t,typeName:Le.ZodTuple,rest:null,...He(e)})};class bf extends Ke{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==we.object)return me(i,{code:ae.invalid_type,expected:we.object,received:i.parsedType}),je;const r=[],s=this._def.keyType,o=this._def.valueType;for(const a in i.data)r.push({key:s._parse(new $s(i,a,i.path,a)),value:o._parse(new $s(i,i.data[a],i.path,a)),alwaysSet:a in i.data});return i.common.async?Gn.mergeObjectAsync(n,r):Gn.mergeObjectSync(n,r)}get element(){return this._def.valueType}static create(e,n,i){return n instanceof Ke?new bf({keyType:e,valueType:n,typeName:Le.ZodRecord,...He(i)}):new bf({keyType:Kr.create(),valueType:e,typeName:Le.ZodRecord,...He(n)})}}class wv extends Ke{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==we.map)return me(i,{code:ae.invalid_type,expected:we.map,received:i.parsedType}),je;const r=this._def.keyType,s=this._def.valueType,o=[...i.data.entries()].map(([a,l],u)=>({key:r._parse(new $s(i,a,i.path,[u,"key"])),value:s._parse(new $s(i,l,i.path,[u,"value"]))}));if(i.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return je;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),a.set(u.value,c.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const l of o){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return je;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),a.set(u.value,c.value)}return{status:n.value,value:a}}}}wv.create=(t,e,n)=>new wv({valueType:e,keyType:t,typeName:Le.ZodMap,...He(n)});class nu extends Ke{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.parsedType!==we.set)return me(i,{code:ae.invalid_type,expected:we.set,received:i.parsedType}),je;const r=this._def;r.minSize!==null&&i.data.size<r.minSize.value&&(me(i,{code:ae.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),n.dirty()),r.maxSize!==null&&i.data.size>r.maxSize.value&&(me(i,{code:ae.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),n.dirty());const s=this._def.valueType;function o(l){const u=new Set;for(const c of l){if(c.status==="aborted")return je;c.status==="dirty"&&n.dirty(),u.add(c.value)}return{status:n.value,value:u}}const a=[...i.data.values()].map((l,u)=>s._parse(new $s(i,l,i.path,u)));return i.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,n){return new nu({...this._def,minSize:{value:e,message:Te.toString(n)}})}max(e,n){return new nu({...this._def,maxSize:{value:e,message:Te.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}nu.create=(t,e)=>new nu({valueType:t,minSize:null,maxSize:null,typeName:Le.ZodSet,...He(e)});class hc extends Ke{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==we.function)return me(n,{code:ae.invalid_type,expected:we.function,received:n.parsedType}),je;function i(a,l){return mv({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,pv(),Fc].filter(u=>!!u),issueData:{code:ae.invalid_arguments,argumentsError:l}})}function r(a,l){return mv({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,pv(),Fc].filter(u=>!!u),issueData:{code:ae.invalid_return_type,returnTypeError:l}})}const s={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof $c){const a=this;return si(async function(...l){const u=new Xi([]),c=await a._def.args.parseAsync(l,s).catch(f=>{throw u.addIssue(i(l,f)),u}),d=await Reflect.apply(o,this,c);return await a._def.returns._def.type.parseAsync(d,s).catch(f=>{throw u.addIssue(r(d,f)),u})})}else{const a=this;return si(function(...l){const u=a._def.args.safeParse(l,s);if(!u.success)throw new Xi([i(l,u.error)]);const c=Reflect.apply(o,this,u.data),d=a._def.returns.safeParse(c,s);if(!d.success)throw new Xi([r(c,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new hc({...this._def,args:zs.create(e).rest($l.create())})}returns(e){return new hc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,i){return new hc({args:e||zs.create([]).rest($l.create()),returns:n||$l.create(),typeName:Le.ZodFunction,...He(i)})}}class xf extends Ke{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}xf.create=(t,e)=>new xf({getter:t,typeName:Le.ZodLazy,...He(e)});class Sf extends Ke{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return me(n,{received:n.data,code:ae.invalid_literal,expected:this._def.value}),je}return{status:"valid",value:e.data}}get value(){return this._def.value}}Sf.create=(t,e)=>new Sf({value:t,typeName:Le.ZodLiteral,...He(e)});function rj(t,e){return new Xa({values:t,typeName:Le.ZodEnum,...He(e)})}class Xa extends Ke{constructor(){super(...arguments),Jd.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),i=this._def.values;return me(n,{expected:nt.joinValues(i),received:n.parsedType,code:ae.invalid_type}),je}if(gv(this,Jd)||ej(this,Jd,new Set(this._def.values)),!gv(this,Jd).has(e.data)){const n=this._getOrReturnCtx(e),i=this._def.values;return me(n,{received:n.data,code:ae.invalid_enum_value,options:i}),je}return si(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Xa.create(e,{...this._def,...n})}exclude(e,n=this._def){return Xa.create(this.options.filter(i=>!e.includes(i)),{...this._def,...n})}}Jd=new WeakMap;Xa.create=rj;class kf extends Ke{constructor(){super(...arguments),Zd.set(this,void 0)}_parse(e){const n=nt.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==we.string&&i.parsedType!==we.number){const r=nt.objectValues(n);return me(i,{expected:nt.joinValues(r),received:i.parsedType,code:ae.invalid_type}),je}if(gv(this,Zd)||ej(this,Zd,new Set(nt.getValidEnumValues(this._def.values))),!gv(this,Zd).has(e.data)){const r=nt.objectValues(n);return me(i,{received:i.data,code:ae.invalid_enum_value,options:r}),je}return si(e.data)}get enum(){return this._def.values}}Zd=new WeakMap;kf.create=(t,e)=>new kf({values:t,typeName:Le.ZodNativeEnum,...He(e)});class $c extends Ke{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==we.promise&&n.common.async===!1)return me(n,{code:ae.invalid_type,expected:we.promise,received:n.parsedType}),je;const i=n.parsedType===we.promise?n.data:Promise.resolve(n.data);return si(i.then(r=>this._def.type.parseAsync(r,{path:n.path,errorMap:n.common.contextualErrorMap})))}}$c.create=(t,e)=>new $c({type:t,typeName:Le.ZodPromise,...He(e)});class ss extends Ke{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Le.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:i}=this._processInputParams(e),r=this._def.effect||null,s={addIssue:o=>{me(i,o),o.fatal?n.abort():n.dirty()},get path(){return i.path}};if(s.addIssue=s.addIssue.bind(s),r.type==="preprocess"){const o=r.transform(i.data,s);if(i.common.async)return Promise.resolve(o).then(async a=>{if(n.value==="aborted")return je;const l=await this._def.schema._parseAsync({data:a,path:i.path,parent:i});return l.status==="aborted"?je:l.status==="dirty"||n.value==="dirty"?Gu(l.value):l});{if(n.value==="aborted")return je;const a=this._def.schema._parseSync({data:o,path:i.path,parent:i});return a.status==="aborted"?je:a.status==="dirty"||n.value==="dirty"?Gu(a.value):a}}if(r.type==="refinement"){const o=a=>{const l=r.refinement(a,s);if(i.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(i.common.async===!1){const a=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return a.status==="aborted"?je:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(a=>a.status==="aborted"?je:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(r.type==="transform")if(i.common.async===!1){const o=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!ff(o))return o;const a=r.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(o=>ff(o)?Promise.resolve(r.transform(o.value,s)).then(a=>({status:n.value,value:a})):o);nt.assertNever(r)}}ss.create=(t,e,n)=>new ss({schema:t,typeName:Le.ZodEffects,effect:e,...He(n)});ss.createWithPreprocess=(t,e,n)=>new ss({schema:e,effect:{type:"preprocess",transform:t},typeName:Le.ZodEffects,...He(n)});class js extends Ke{_parse(e){return this._getType(e)===we.undefined?si(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}js.create=(t,e)=>new js({innerType:t,typeName:Le.ZodOptional,...He(e)});class qa extends Ke{_parse(e){return this._getType(e)===we.null?si(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}qa.create=(t,e)=>new qa({innerType:t,typeName:Le.ZodNullable,...He(e)});class _f extends Ke{_parse(e){const{ctx:n}=this._processInputParams(e);let i=n.data;return n.parsedType===we.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}_f.create=(t,e)=>new _f({innerType:t,typeName:Le.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...He(e)});class Cf extends Ke{_parse(e){const{ctx:n}=this._processInputParams(e),i={...n,common:{...n.common,issues:[]}},r=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return pf(r)?r.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Xi(i.common.issues)},input:i.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Xi(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}Cf.create=(t,e)=>new Cf({innerType:t,typeName:Le.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...He(e)});class bv extends Ke{_parse(e){if(this._getType(e)!==we.nan){const i=this._getOrReturnCtx(e);return me(i,{code:ae.invalid_type,expected:we.nan,received:i.parsedType}),je}return{status:"valid",value:e.data}}}bv.create=t=>new bv({typeName:Le.ZodNaN,...He(t)});const GG=Symbol("zod_brand");class n_ extends Ke{_parse(e){const{ctx:n}=this._processInputParams(e),i=n.data;return this._def.type._parse({data:i,path:n.path,parent:n})}unwrap(){return this._def.type}}class sp extends Ke{_parse(e){const{status:n,ctx:i}=this._processInputParams(e);if(i.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return s.status==="aborted"?je:s.status==="dirty"?(n.dirty(),Gu(s.value)):this._def.out._parseAsync({data:s.value,path:i.path,parent:i})})();{const r=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return r.status==="aborted"?je:r.status==="dirty"?(n.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:i.path,parent:i})}}static create(e,n){return new sp({in:e,out:n,typeName:Le.ZodPipeline})}}class Ef extends Ke{_parse(e){const n=this._def.innerType._parse(e),i=r=>(ff(r)&&(r.value=Object.freeze(r.value)),r);return pf(n)?n.then(r=>i(r)):i(n)}unwrap(){return this._def.innerType}}Ef.create=(t,e)=>new Ef({innerType:t,typeName:Le.ZodReadonly,...He(e)});function sj(t,e={},n){return t?Bc.create().superRefine((i,r)=>{var s,o;if(!t(i)){const a=typeof e=="function"?e(i):typeof e=="string"?{message:e}:e,l=(o=(s=a.fatal)!==null&&s!==void 0?s:n)!==null&&o!==void 0?o:!0,u=typeof a=="string"?{message:a}:a;r.addIssue({code:"custom",...u,fatal:l})}}):Bc.create()}const KG={object:Lt.lazycreate};var Le;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Le||(Le={}));const XG=(t,e={message:`Input not instance of ${t.name}`})=>sj(n=>n instanceof t,e),oj=Kr.create,aj=Ga.create,qG=bv.create,YG=Ka.create,lj=mf.create,JG=tu.create,ZG=vv.create,QG=gf.create,eK=vf.create,tK=Bc.create,nK=$l.create,iK=Do.create,rK=yv.create,sK=Qr.create,oK=Lt.create,aK=Lt.strictCreate,lK=yf.create,uK=Ry.create,cK=wf.create,dK=zs.create,hK=bf.create,fK=wv.create,pK=nu.create,mK=hc.create,gK=xf.create,vK=Sf.create,yK=Xa.create,wK=kf.create,bK=$c.create,gT=ss.create,xK=js.create,SK=qa.create,kK=ss.createWithPreprocess,_K=sp.create,CK=()=>oj().optional(),EK=()=>aj().optional(),AK=()=>lj().optional(),PK={string:t=>Kr.create({...t,coerce:!0}),number:t=>Ga.create({...t,coerce:!0}),boolean:t=>mf.create({...t,coerce:!0}),bigint:t=>Ka.create({...t,coerce:!0}),date:t=>tu.create({...t,coerce:!0})},TK=je;var Ni=Object.freeze({__proto__:null,defaultErrorMap:Fc,setErrorMap:TG,getErrorMap:pv,makeIssue:mv,EMPTY_PATH:RG,addIssueToContext:me,ParseStatus:Gn,INVALID:je,DIRTY:Gu,OK:si,isAborted:w1,isDirty:b1,isValid:ff,isAsync:pf,get util(){return nt},get objectUtil(){return y1},ZodParsedType:we,getParsedType:oa,ZodType:Ke,datetimeRegex:ij,ZodString:Kr,ZodNumber:Ga,ZodBigInt:Ka,ZodBoolean:mf,ZodDate:tu,ZodSymbol:vv,ZodUndefined:gf,ZodNull:vf,ZodAny:Bc,ZodUnknown:$l,ZodNever:Do,ZodVoid:yv,ZodArray:Qr,ZodObject:Lt,ZodUnion:yf,ZodDiscriminatedUnion:Ry,ZodIntersection:wf,ZodTuple:zs,ZodRecord:bf,ZodMap:wv,ZodSet:nu,ZodFunction:hc,ZodLazy:xf,ZodLiteral:Sf,ZodEnum:Xa,ZodNativeEnum:kf,ZodPromise:$c,ZodEffects:ss,ZodTransformer:ss,ZodOptional:js,ZodNullable:qa,ZodDefault:_f,ZodCatch:Cf,ZodNaN:bv,BRAND:GG,ZodBranded:n_,ZodPipeline:sp,ZodReadonly:Ef,custom:sj,Schema:Ke,ZodSchema:Ke,late:KG,get ZodFirstPartyTypeKind(){return Le},coerce:PK,any:tK,array:sK,bigint:YG,boolean:lj,date:JG,discriminatedUnion:uK,effect:gT,enum:yK,function:mK,instanceof:XG,intersection:cK,lazy:gK,literal:vK,map:fK,nan:qG,nativeEnum:wK,never:iK,null:eK,nullable:SK,number:aj,object:oK,oboolean:AK,onumber:EK,optional:xK,ostring:CK,pipeline:_K,preprocess:kK,promise:bK,record:hK,set:pK,strictObject:aK,string:oj,symbol:ZG,transformer:gT,tuple:dK,undefined:QG,union:lK,unknown:nK,void:rK,NEVER:TK,ZodIssueCode:ae,quotelessJson:PG,ZodError:Xi});const uj=["randomize","clean","unchanged"],cj=["no-devices","keyboard-and-screen","pio-switches-and-leds","pio-printer","handshake"],S1=Ni.object({language:Ni.enum(ZL).catch(RK),editorFontSize:Ni.number().int().min(8).max(64).catch(14),dataOnLoad:Ni.enum(uj).catch("randomize"),devices:Ni.enum(cj).catch("no-devices"),animations:Ni.boolean().catch(!0),executionUnit:Ni.number().min(1).max(500).catch(150),clockSpeed:Ni.number().min(100).max(3e3).catch(1e3),printerSpeed:Ni.number().min(500).max(2e4).catch(5e3),filterBightness:Ni.number().min(0).catch(1),filterContrast:Ni.number().min(0).catch(1),filterInvert:Ni.boolean().catch(!1),filterSaturation:Ni.number().min(0).catch(1)}),Cu=S1.parse({});function RK(){const t=navigator.language.toLowerCase();for(const e of ZL)if(t.startsWith(e))return e;return"en"}const rl=CI("vonsim-settings",Cu,{getItem(t,e){try{const n=localStorage.getItem(t);return S1.parse(JSON.parse(n??""))}catch{return e}},setItem(t,e){localStorage.setItem(t,JSON.stringify(e))},removeItem(t){localStorage.removeItem(t)},subscribe(t,e,n){const i=r=>{if(r.storageArea===localStorage&&r.key===t){let s;try{s=S1.parse(JSON.parse(r.newValue??""))}catch{s=n}e(s)}};return window==null||window.addEventListener("storage",i),()=>window==null?void 0:window.removeEventListener("storage",i)}},{getOnInit:!0}),Si=()=>ee.get(rl),dj=()=>td(rl),NK=Ae(t=>t(rl).language),i_=()=>qt(NK),MK=Ae(t=>t(rl).editorFontSize),OK=()=>qt(MK);Ae(t=>t(rl).dataOnLoad);const DK=Ae(t=>t(rl).devices),IK=()=>qt(DK);Ae(t=>{const e=t(rl);return{executionUnit:e.executionUnit,clock:e.clockSpeed,printer:e.printerSpeed}});const LK=Ae(t=>{const e=t(rl);return[`brightness(${e.filterBightness})`,`contrast(${e.filterContrast})`,`invert(${e.filterInvert?1:0})`,`saturate(${e.filterSaturation})`].filter(Boolean).join(" ")}),jK=()=>qt(LK);function Af(t){const e=t.charCodeAt(0);return I.fitsUnsigned(e,8)?e:null}function r_(t){return I.fitsUnsigned(t,8)?String.fromCharCode(t):null}function hj(t){return FK.at(t)??null}const FK=["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","BS","HT","LF","VT","FF","CR","SO","SI","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","EM","SUB","ESC","FS","GS","RS","US","SPACE","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","DEL","XXX","XXX","BPH","NBH","IND","NEL","SSA","ESA","HTS","HTJ","VTS","PLD","PLU","RI","SS2","SS3","DCS","PU1","PU2","STS","CCH","MW","SPA","EPA","SOS","XXX","SCI","CSI","ST","OSC","PM","APC","NBSP","¡","¢","£","¤","¥","¦","§","¨","©","ª","«","¬","SHY","®","¯","°","±","²","³","´","µ","¶","·","¸","¹","º","»","¼","½","¾","¿","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","×","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","÷","ø","ù","ú","û","ü","ý","þ","ÿ"];var Mt,It;const et=class et{constructor(e,n){Re(this,Mt);Re(this,It);Y(this,Mt,e|0),Y(this,It,n)}get size(){return C(this,It)}is8bits(){return C(this,It)===8}is16bits(){return C(this,It)===16}get unsigned(){return C(this,Mt)}get signed(){return C(this,Mt)<=et.maxSignedValue(C(this,It))?C(this,Mt):C(this,Mt)-(et.maxValue(C(this,It))+1)}get low(){return this.is8bits()?this:et.fromUnsigned(C(this,Mt)&et.maxValue(8),8)}get high(){return this.is8bits()?new et(0,8):et.fromUnsigned(C(this,Mt)>>8&et.maxValue(8),8)}withLow(e){if(e.is16bits())throw new TypeError("Byte must be 8 bits");return et.fromUnsigned(C(this,Mt)&~et.maxValue(8)|e.unsigned,C(this,It))}withHigh(e){if(e.is16bits())throw new TypeError("Byte must be 8 bits");return et.fromUnsigned(C(this,Mt)&et.maxValue(8)|e.unsigned<<8,16)}bit(e){if(!Number.isSafeInteger(e)||e<0||e>=C(this,It))throw new RangeError(`Index ${e} out of bounds for byte of size ${C(this,It)}`);return(C(this,Mt)&1<<e)!==0}withBit(e,n){if(!Number.isSafeInteger(e)||e<0||e>=C(this,It))throw new RangeError(`Index ${e} out of bounds for byte of size ${C(this,It)}`);return n?et.fromUnsigned(C(this,Mt)|1<<e,C(this,It)):et.fromUnsigned(C(this,Mt)&~(1<<e),C(this,It))}add(e){return e=Number(e),et.fromUnsigned(C(this,Mt)+e,C(this,It))}isZero(){return this.unsigned===0}equals(e){return typeof e=="number"?e<0?this.signed===e:this.unsigned===e:C(this,Mt)===C(e,Mt)}toUint8Array(){return this.is8bits()?new Uint8Array([this.unsigned]):new Uint8Array([this.low.unsigned,this.high.unsigned])}toArray(){const e=new Array(C(this,It));for(let n=0;n<C(this,It);n++)e[n]=this.bit(n);return e}toString(e="int"){switch(e){case"hex":return C(this,Mt).toString(16).padStart(C(this,It)/4,"0").toUpperCase();case"bin":return C(this,Mt).toString(2).padStart(C(this,It),"0");case"int":return this.signed.toString(10);case"uint":return this.unsigned.toString(10);case"ascii":return C(this,It)===8?r_(C(this,Mt))??"---":this.low.toString("ascii")+this.high.toString("ascii");case"safe-ascii":return C(this,It)===8?hj(C(this,Mt))??"---":this.low.toString("safe-ascii")+" "+this.high.toString("safe-ascii")}}toJSON(){return C(this,Mt)}valueOf(){return C(this,Mt)}static minValue(){return 0}static maxValue(e){return 2**e-1}static minSignedValue(e){return-(2**(e-1))}static maxSignedValue(e){return 2**(e-1)-1}static fits(e,n){return Number.isSafeInteger(e)&&e>=et.minSignedValue(n)&&e<=et.maxValue(n)}static fitsUnsigned(e,n){return Number.isSafeInteger(e)&&e>=et.minValue()&&e<=et.maxValue(n)}static fitsSigned(e,n){return Number.isSafeInteger(e)&&e>=et.minSignedValue(n)&&e<=et.maxSignedValue(n)}static fromUnsigned(e,n){if(!et.fitsUnsigned(e,n))throw new RangeError(`Value ${e} does not fit in a ${n}-bit byte.`);return new et(e,n)}static fromSigned(e,n){if(!et.fitsSigned(e,n))throw new RangeError(`Value ${e} does not fit in a ${n}-bit byte.`);return e<0?new et(e+et.maxValue(n)+1,n):new et(e,n)}static fromNumber(e,n){return e<0?et.fromSigned(e,n):et.fromUnsigned(e,n)}static fromChar(e){const n=Af(e)??-1;return et.fromUnsigned(n,8)}static random(e){const n=Math.round(Math.random()*et.maxValue(e));return new et(n,e)}static zero(e){return new et(0,e)}};Mt=new WeakMap,It=new WeakMap;let I=et;var no;const ea=class ea{constructor(e){Re(this,no);Y(this,no,e)}get value(){return C(this,no).unsigned}get byte(){return C(this,no)}toString(e=!1){let n=C(this,no).toString("hex");return e&&(n+="h"),n.slice(-2)}toJSON(){return C(this,no).toJSON()}valueOf(){return C(this,no).valueOf()}static inRange(e){return e=Number(e),Number.isSafeInteger(e)&&e>=ea.MIN_ADDRESS&&e<=ea.MAX_ADDRESS}static from(e){if(e=Number(e),!ea.inRange(e))throw new RangeError(`Address ${e} is out of range.`);const n=I.fromUnsigned(e,16);return new ea(n)}static format(e,n=!0){if(e=Number(e),!Number.isSafeInteger(e)||e<0)return"????";let i=e.toString(16).padStart(4,"0").toUpperCase();return n&&(i+="h"),i.slice(-3)}};no=new WeakMap,oe(ea,"MIN_ADDRESS",0),oe(ea,"MAX_ADDRESS",32767);let ye=ea;var io;const ta=class ta{constructor(e){Re(this,io);Y(this,io,e)}get value(){return C(this,io).unsigned}get byte(){return C(this,io)}toString(e=!0){let n=C(this,io).toString("hex");return e&&(n+="h"),n}toJSON(){return C(this,io).toJSON()}valueOf(){return C(this,io).valueOf()}static inRange(e){return e=Number(e),Number.isSafeInteger(e)&&e>=ta.MIN_ADDRESS&&e<=ta.MAX_ADDRESS}static from(e){if(e=Number(e),!ta.inRange(e))throw new RangeError(`Address ${e} is out of range.`);const n=I.fromUnsigned(e,8);return new ta(n)}static format(e,n=!0){if(e=Number(e),!Number.isSafeInteger(e)||e<0)return"??";let i=e.toString(16).padStart(2,"0").toUpperCase();return n&&(i+="h"),i}};io=new WeakMap,oe(ta,"MIN_ADDRESS",0),oe(ta,"MAX_ADDRESS",127);let Yi=ta;function vT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function yT(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?vT(Object(n),!0).forEach(function(i){BK(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vT(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function BK(t,e,n){return e=$K(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $K(t){var e=zK(t,"string");return typeof e=="symbol"?e:String(e)}function zK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xv=fj({});function fj(t){return e.withOptions=n=>fj(yT(yT({},t),n)),e;function e(n,...i){const r=typeof n=="string"?[n]:n.raw,{escapeSpecialCharacters:s=Array.isArray(n)}=t;let o="";for(let u=0;u<r.length;u++){let c=r[u];s&&(c=c.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\\{/g,"{")),o+=c,u<i.length&&(o+=i[u])}const a=o.split(`
`);let l=null;for(const u of a){const c=u.match(/^(\s+)\S+/);if(c){const d=c[1].length;l?l=Math.min(l,d):l=d}}if(l!==null){const u=l;o=a.map(c=>c[0]===" "||c[0]==="	"?c.slice(u):c).join(`
`)}return o=o.trim(),s&&(o=o.replace(/\\n/g,`
`)),o}}const UK=ye.from(ye.MAX_ADDRESS).toString(),VK={generics:{clean:"Clean","io-register":(t,e)=>`${t} register (${Yi.format(e)})`,"byte-representation":{hex:"Hexadecimal",bin:"Binary",uint:"Unsigned integer",int:"Signed integer","safe-ascii":"ASCII"}},update:{"update-available":"There's a new version available!",reload:"Update"},messages:{"assemble-error":"Assemble error. Fix the errors and try again.","invalid-action":"Invalid action."},editor:{lintSummary:t=>t===0?"Ready to compile":t===1?"There's an error":`There're ${t} errors`,files:{unsupported:"Your browser doesn't support the FileSystem API","no-file":"No file open",open:"Open file",unsaved:"There are unsaved changes, do you want to discard them?","open-error":"Error opening file",save:"Save file","save-as":"Save file as","save-error":"Error saving file"},example:xv`
      ; Welcome to VonSim!
      ; This is an example program that calculates the first
      ; n numbers of the Fibonacci sequence, and stores them
      ; starting at memory position 1000h.
      
           n  equ 10    ; Calculate the first 10 numbers
      
              org 10h
      start   db 1
      
              org 20h
              mov bx, offset start + 1
              mov al, 0
              mov ah, start
      
      loop:   cmp bx, offset start + n
              jns finish
              mov cl, ah
              add cl, al
              mov al, ah
              mov ah, cl
              mov [bx], cl
              inc bx
              jmp loop
      finish: hlt
              end
    `},control:{action:{start:"Start",continue:"Continue",running:"Running...",run:{"cycle-change":"One cycle","end-of-instruction":"One instruction",infinity:"Until stop"},stop:"Stop"},tabs:{editor:"Editor",computer:"Computer"},zoom:{in:"Zoom in",out:"Zoom out"}},computer:{cpu:{name:"CPU",register:t=>`${t} register`,"control-unit":"Control unit",decoder:"Decoder",status:{fetching:"Fetching instruction...","fetching-operands":"Fetching operands...",executing:"Executing...",writeback:"Saving results...",interrupt:"Handling interrupt...",stopped:"Stopped","stopped-error":"Error","waiting-for-input":"Waiting for input...",int6:"Running INT 6...",int7:"Running INT 7..."}},memory:{name:"Memory",cell:t=>`Cell ${ye.format(t)}`,"fix-address":"Fix address","unfix-address":"Unfix address","address-must-be-integer":"Start address must be an hexadecimal integer.","address-out-of-range":`Start address must be less or equal to ${UK}.`,"address-increment":"Increment address (Page Up)","address-decrement":"Decrement address (Page Down)"},"chip-select":{name:"Chip select",mem:"mem",pic:"pic",timer:"timer",pio:"pio",handshake:"handshake"},f10:"F10 key",keyboard:"Keyboard",leds:"LEDs",printer:{name:"Printer",buffer:"Buffer"},screen:"Screen",switches:"Switches",handshake:{name:"Handshake",data:"Data",state:"State"},pic:"PIC",pio:{name:"PIO",port:t=>`Port ${t}`},timer:"Timer"},settings:{title:"Settings",language:{label:"Language"},editorFontSize:{label:"Editor font size",increase:"Increase font size",decrease:"Decrease font size"},dataOnLoad:{label:"Data on load",description:"What to do with the memory when loading a new program.",randomize:"Randomize",clean:"Empty",unchanged:"Unchanged"},devices:{label:"Devices",description:"Which preset of devices to use.","no-devices":"No devices","keyboard-and-screen":"Keyboard and screen","pio-switches-and-leds":"Switches and LEDs","pio-printer":"Printer (PIO)",handshake:"Printer (Handshake)"},animations:{label:"Animations",description:["Disabling animations, you get faster execution.","Only affects animations affected by the simulation speed (like the CPU).","Other animations (like the clock and the printer) will run at their own speed.","Be careful! Very high simulation speeds without animations can saturate the processor."].join(" ")},speeds:{executionUnit:"Simulation speed",clockSpeed:"Clock speed",printerSpeed:"Printer speed"},filters:{label:"Filters",description:"Filters applied to the page. Useful when you're using a projector.",revert:"Revert to default filters",brightness:"Brightness",contrast:"Contrast",invert:"Invert",saturation:"Saturation"},reset:"Reset settings"},footer:{documentation:"Documentation",copyright:"III-LIDI, FI, UNLP, UNER",issue:{report:"Report an issue",body:(t,e)=>xv`
        <!-- Please describe the problem you are having in as much detail as possible. -->
        <!-- Most importantly, add the steps to reproduce the problem. -->

        <details>
          <summary>Debug info (PLEASE, DO NOT DELETE)</summary>

          **Version**: [${"505e87e"}](https://github.com/vonsim/vonsim/commit/${"505e87e"})

          #### Program

          \`\`\`asm
          ${e.split(`
`).map(n=>n.trim()).join(`
`)}
          \`\`\`

          #### Settings

          ${Object.entries(t).map(([n,i])=>`- **${n}**: ${i}`).join(`
          `)}
          
        </details>
      `}}},HK=ye.from(ye.MAX_ADDRESS).toString(),WK={generics:{clean:"Limpiar","io-register":(t,e)=>`Registro ${t} (${Yi.format(e)})`,"byte-representation":{hex:"Hexadecimal",bin:"Binario",uint:"Entero sin signo",int:"Entero con signo","safe-ascii":"ASCII"}},update:{"update-available":"¡Hay una nueva versión disponible!",reload:"Actualizar"},messages:{"assemble-error":"Error de ensamblado. Solucione los errores y vuelva a intentar.","invalid-action":"Acción inválida."},editor:{lintSummary:t=>t===0?"Listo para compilar":t===1?"Hay un error":`Hay ${t} errores`,files:{unsupported:"Tu navegador no soporta la “FileSystem API”","no-file":"No hay ningún archivo abierto",open:"Abrir",unsaved:"Hay cambios sin guardar, ¿desea descartarlos?","open-error":"Error al abrir el archivo",save:"Guardar","save-as":"Guardar como","save-error":"Error al guardar el archivo"},example:xv`
      ; ¡Bienvenido a VonSim 8!
      ; Este es un ejemplo de código que suma dos variables z = x + y
      
      org 10h
        x  db 3
        y  db 2
        z  db 0
      org 20h
        mov al, x
        add al, y
        mov z, al
        hlt
      end
    `},control:{action:{start:"Iniciar",continue:"Continuar",running:"Ejecutando...",run:{"cycle-change":"Un ciclo","end-of-instruction":"Una instrucción",infinity:"Hasta el final"},stop:"Detener"},tabs:{editor:"Editor",computer:"Computadora"},zoom:{in:"Acercar",out:"Alejar"}},computer:{cpu:{name:"CPU",register:t=>`Registro ${t}`,"control-unit":"Unidad de control",decoder:"Decodificador",status:{fetching:"Leyendo instrucción...","fetching-operands":"Leyendo operandos...",executing:"Ejecutando...",writeback:"Escribiendo resultados...",interrupt:"Manejando interrupción...",stopped:"Detenido","stopped-error":"Error","waiting-for-input":"Esperando tecla...",int6:"Ejecutando INT 6...",int7:"Ejecutando INT 7..."}},memory:{name:"Memoria",cell:t=>`Celda ${ye.format(t)}`,"fix-address":"Fijar dirección","unfix-address":"Desfijar dirección","address-must-be-integer":"El valor de inicio debe ser un número entero hexadecimal.","address-out-of-range":`El valor de inicio debe ser menor o igual a ${HK}.`,"address-increment":"Incrementar dirección (Page Up)","address-decrement":"Decrementar dirección (Page Down)"},"chip-select":{name:"Chip select",mem:"mem",pic:"pic",timer:"timer",pio:"pio",handshake:"handshake"},f10:"Tecla F10",keyboard:"Teclado",leds:"Leds",printer:{name:"Impresora",buffer:"Buffer"},screen:"Pantalla",switches:"Llaves",handshake:{name:"Handshake",data:"Dato",state:"Estado"},pic:"PIC",pio:{name:"PIO",port:t=>`Puerto ${t}`},timer:"Timer"},settings:{title:"Configuración",language:{label:"Idioma"},editorFontSize:{label:"Tamaño de fuente del editor",increase:"Aumentar",decrease:"Disminuir"},dataOnLoad:{label:"Memoria al cargar",description:"Qué hacer con la memoria al cargar un nuevo programa.",randomize:"Aleatoria",clean:"Vaciar",unchanged:"Reusar"},devices:{label:"Dispositivos",description:"Qué conjunto de dispositivos usar.","no-devices":"Ninguno","keyboard-and-screen":"Teclado y pantalla","pio-switches-and-leds":"Llaves y luces","pio-printer":"Impresora (PIO)",handshake:"Impresora (Handshake)"},animations:{label:"Animaciones",description:["Inhabilitando las animaciones, se obtiene ejecución más rápida.","Solo afecta a las animaciones afectadas por la velocidad de simulación (como la CPU).","Otras animaciones (como el reloj y la impresora) se ejecutarán a su propia velocidad.","¡Cuidado! Velocidades de simulación muy altas sin animaciones puede saturar el procesador."].join(" ")},speeds:{executionUnit:"Velocidad de simulación",clockSpeed:"Velocidad del reloj",printerSpeed:"Velocidad de impresión"},filters:{label:"Filtros",description:"Filtros aplicados a la página. Útil cuando se usa un proyector.",revert:"Revertir a los valores por defecto",brightness:"Brillo",contrast:"Contraste",invert:"Invertir",saturation:"Saturación"},reset:"Restablecer configuración"},footer:{documentation:"Documentación",copyright:"III-LIDI, FI, UNLP, UNER",issue:{report:"Reportar un error",body:(t,e)=>xv`
        <!-- Por favor, describa el problema que está teniendo en la mayor cantidad de detalle posible. -->
        <!-- Por sobre todo, agregue los pasos para reproducir el problema. -->

        <details>
          <summary>Información extra (POR FAVOR, NO BORRAR)</summary>

          **Versión**: [${"505e87e"}](https://github.com/ruiz-jose/VonSim8/commit/${"505e87e"})

          #### Programa

          \`\`\`asm
          ${e.split(`
`).map(n=>n.trim()).join(`
`)}
          \`\`\`

          #### Configuración

          ${Object.entries(t).map(([n,i])=>`- **${n}**: ${i}`).join(`
          `)}
          
        </details>
      `}}},Ny=t_({en:VK,es:WK});function mt(){const t=i_();return S.useCallback((e,...n)=>Ny(t,e,...n),[t])}const GK=1,wT=5e3,gs=new Map,xh=[];function KK(){let t=0;for(const e of gs.keys())e>t&&(t=e);return t+1}function XK(){let t=1/0;for(const e of gs.keys())e<t&&(t=e);return t}function va(t,e=!0){switch(t.type){case"ADD_TOAST":{const{toastId:n,toast:i}=t,r=i.duration??wT,s=Number.isFinite(r)?setTimeout(()=>va({type:"DISMISS_TOAST",toastId:n}),r):null;gs.set(n,{...i,timeout:s,otherProps:{open:!0,onOpenChange:o=>{o||va({type:"DISMISS_TOAST",toastId:n})}}}),gs.size>GK&&va({type:"DISMISS_TOAST",toastId:XK()},!1);break}case"UPDATE_TOAST":{const{toastId:n,toast:i}=t,r=gs.get(n);if(!r)return;if(typeof i.duration=="number"){r.timeout!==null&&clearTimeout(r.timeout);const s=i.duration??wT,o=Number.isFinite(s)?setTimeout(()=>va({type:"DISMISS_TOAST",toastId:n}),s):null;gs.set(n,{...r,...i,timeout:o})}else gs.set(n,{...r,...i});break}case"DISMISS_TOAST":{const{toastId:n}=t,i=gs.get(n);if(!i)return;i.timeout!==null&&clearTimeout(i.timeout),gs.delete(n);break}default:{const n=t;throw new Error(`Unhandled action: ${n}`)}}if(e&&xh.length>0){const n=Array.from(gs.entries()).map(([i,r])=>({...r,id:i})).sort((i,r)=>r.id-i.id);for(const i of xh)i(n)}}function Gt(t){const e=KK(),n=r=>va({type:"UPDATE_TOAST",toastId:e,toast:{...r}}),i=()=>va({type:"DISMISS_TOAST",toastId:e});return va({type:"ADD_TOAST",toastId:e,toast:t}),{id:e,dismiss:i,update:n}}function qK(){const[t,e]=S.useState([]);return S.useEffect(()=>(xh.push(e),()=>{const n=xh.indexOf(e);n>-1&&xh.splice(n,1)}),[]),{toastList:t,toast:Gt,dismiss:n=>va({type:"DISMISS_TOAST",toastId:n})}}const My=CI("vonsim-program",Ny(Si().language,"editor.example"),void 0,{getOnInit:!0}),YK=()=>qt(My),JK=()=>ee.get(My),ZK=Dn.fromClass(class{constructor(t){this.view=t}update(t){t.docChanged&&ee.set(My,this.view.state.doc.toString())}}),Ed="showSaveFilePicker"in window,QK=Ae(null),pj=Ae(""),eX=Ae(t=>t(pj)!==t(My));function tX(){const t=mt(),[e,n]=td(QK),i=qt(eX),r=M2(pj),s=e&&i,o=S.useCallback(async()=>{if(!Ed){Gt({title:t("editor.files.unsupported"),variant:"error"});return}if(!(s&&!confirm(t("editor.files.unsaved"))))try{const[d]=await window.showOpenFilePicker({multiple:!1,excludeAcceptAllOption:!0,types:[{accept:{"text/plain":[".txt",".asm",".vonsim"]}}]});await d.requestPermission({mode:"readwrite"})==="granted"&&n(d);const p=await(await d.getFile()).text();r(p),window.codemirror.dispatch({changes:{from:0,to:window.codemirror.state.doc.length,insert:p}})}catch(d){console.error(d),Gt({title:t("editor.files.open-error"),variant:"error"})}},[t,s,n,r]);So(d=>d.ctrlKey&&d.key==="o",d=>{d.preventDefault(),o()},void 0,[o]);const a=S.useCallback(async d=>{var f,p;if(d.stopPropagation(),d.preventDefault(),!Ed){Gt({title:t("editor.files.unsupported"),variant:"error"});return}const h=(p=(f=d.dataTransfer)==null?void 0:f.items)==null?void 0:p[0];if(!(!h||h.kind!=="file")&&!(s&&!confirm(t("editor.files.unsaved"))))try{const m=await h.getAsFileSystemHandle();if(!m)throw new Error("File handle not found");await m.requestPermission({mode:"readwrite"})==="granted"&&n(m);const y=await(await m.getFile()).text();r(y),window.codemirror.dispatch({changes:{from:0,to:window.codemirror.state.doc.length,insert:y}})}catch(m){console.error(m),Gt({title:t("editor.files.open-error"),variant:"error"})}},[n,r,t,s]);Ym("drop",a,window),Ym("dragover",d=>{d.preventDefault(),d.stopPropagation()},window);const l=S.useCallback(async()=>{if(!Ed){Gt({title:t("editor.files.unsupported"),variant:"error"});return}if(s)try{const d=window.codemirror.state.doc.toString(),h=await e.createWritable({keepExistingData:!1});await h.write(d),await h.close(),r(d)}catch(d){console.error(d),Gt({title:t("editor.files.save-error"),variant:"error"})}},[t,s,e,r]),u=S.useCallback(async()=>{const d=window.codemirror.state.doc.toString(),h=(e==null?void 0:e.name)||`vonsim-${new Date().toISOString().slice(0,10)}.asm`;if(Ed)try{const f=await window.showSaveFilePicker({suggestedName:h,excludeAcceptAllOption:!0,types:[{accept:{"text/plain":[".txt",".asm",".vonsim"]}}]}),p=await f.requestPermission({mode:"readwrite"});if(p!=="granted")throw new Error(`Permission denied: ${p}`);n(f);const m=await f.createWritable({keepExistingData:!1});await m.write(d),await m.close(),r(d)}catch(f){console.error(f),Gt({title:t("editor.files.save-error"),variant:"error"})}else{const f=new Blob([d],{type:"text/plain"}),p=URL.createObjectURL(f),m=document.createElement("a");m.style.display="none",m.href=p,m.download=h,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(p)}},[t,e,n,r]);So(d=>d.ctrlKey&&d.key==="s",d=>{d.preventDefault(),Ed&&(e?l():u())},void 0,[e,l,u]),So(d=>d.ctrlKey&&d.shiftKey&&d.key==="S",d=>{d.preventDefault(),u()},void 0,[u]);const c=S.useCallback(d=>{s&&(d.preventDefault(),d.returnValue=t("editor.files.unsaved"))},[t,s]);return Ym("beforeunload",c,window),g.jsxs(qL,{children:[g.jsx(YL,{asChild:!0,children:g.jsxs("button",{className:Ue("flex items-center transition-colors hover:text-white",e&&"text-white"),children:[e?e.name:t("editor.files.no-file"),s&&g.jsx("span",{className:"ml-1 h-2 w-2 rounded-full bg-current"})]})}),g.jsxs(e_,{className:"w-64",align:"start",children:[g.jsxs(Bl,{onClick:o,children:[g.jsx("span",{className:"icon-[lucide--file-search-2] mr-2 h-4 w-4"}),t("editor.files.open"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"Ctrl+O"})]}),g.jsxs(Bl,{disabled:!s,onClick:l,children:[g.jsx("span",{className:"icon-[lucide--save] mr-2 h-4 w-4"}),t("editor.files.save"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"Ctrl+S"})]}),g.jsxs(Bl,{onClick:u,children:[g.jsx("span",{className:"icon-[lucide--save-all] mr-2 h-4 w-4"}),t("editor.files.save-as"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"Ctrl+Shift+S"})]})]})]})}function nX(){const t=mt(),e=iX();return g.jsxs("footer",{className:"px-2 py-1 text-center text-xs tracking-wider text-stone-500",children:[g.jsx("a",{href:"/VonSim8/docs",className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:t("footer.documentation")}),g.jsx("span",{className:"px-2",children:"·"}),g.jsx("a",{href:"https://ruiz-jose.github.io/VonSim8/",className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:"GitHub"}),g.jsx("span",{className:"px-2",children:"·"}),g.jsx("a",{href:e,className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:t("footer.issue.report")}),g.jsx("span",{className:"px-2 max-sm:hidden",children:"·"}),g.jsx("br",{className:"sm:hidden"}),g.jsxs("a",{href:"/docs#licencia",className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:["© Copyright 2017-",new Date().getFullYear()," — ",t("footer.copyright")]})]})}function iX(){const t=mt(),[e]=dj(),n=YK();return"https://github.com/ruiz-jose/VonSim8/issues/new?body="+encodeURIComponent(t("footer.issue.body",e,n))}function Sv(t,e,n){const i=[];for(let r=0;r<t.length;r++)try{const s=e(t[r],r,t);s&&(Array.isArray(s)?s.forEach(o=>o&&i.push(n(o,r,t))):i.push(n(s,r,t)))}catch(s){i.push(n(s,r,t))}return i}class sn{constructor(e,n){oe(this,"start");oe(this,"end");this.start=e|0,this.end=(n??e)|0}get range(){return[this.start,this.end]}toString(){let e=`${this.start}`;return this.end!==this.start&&(e+=`:${this.end}`),e}static merge(...e){const n=e.filter(Boolean);if(n.length===0)throw new Error("Cannot merge 0 positions");let i=n[0].start,r=n[0].end;for(const s of n)s.start<i&&(i=s.start),s.end>r&&(r=s.end);return new sn(i,r)}toJSON(){return this.range}}const bT=ye.from(ye.MAX_ADDRESS).toString(),rX=Yi.from(Yi.MAX_ADDRESS).toString(),sX={"address-has-code":t=>`Memory address ${t} has instructions. It cannot be used as a data address.`,"address-out-of-range":t=>`Memory address ${ye.format(t)} is out of range (max memory address: ${bT}).`,"cannot-accept-strings":t=>`${t} can't accept strings.`,"cannot-be-indirect":"This operand can't be an indirect memory address.","cannot-be-unassinged":t=>`${t} can't be unassigned.`,"cannot-be-word":"This operand can't be of 16 bits.","circular-reference":"Circular reference detected.","constant-must-have-a-label":"Constant must have a label.","constant-must-have-one-value":"Constant must have exactly one value.","destination-cannot-be-immediate":"The destination can't be an immediate value.","double-memory-access":"Can't access to a memory location twice in the same instruction.","duplicated-label":t=>`Duplicated label "${t}".`,"empty-program":"Empty program. The program must have, at least, an END statement.","end-must-be-the-last-statement":"END must be the last statement.","equ-not-found":t=>`EQU "${t}" not found.`,"expects-ax":"This operand should be AX or AL.","expects-dx":"The only valid register is DX.","expects-immediate":"This operand should be immediate.","expects-label":"This operand should be a label.","expects-no-operands":"This instruction doesn't expect any operands.","expects-one-operand":"This instruction expects one operand.","expects-two-operands":"This instruction expects two operands.","expects-word-register":"This instruction expects a 16-bits register as its operand.","instruction-out-of-range":t=>`This instruction would be placed in address ${ye.format(t)}, which is outside the memory range (max memory address: ${bT}).`,"invalid-interrupt":t=>`Invalid interrupt number ${t}.`,"io-address-out-of-range":t=>`I/O address ${t} is out of range (max I/O address: ${rX}).`,"label-not-found":t=>`Label "${t}" has not been defined.`,"label-should-be-a-number":t=>`Label ${t} should point to a EQU declaration or to a instruction. Maybe you ment to write OFFSET ${t}.`,"label-should-be-an-instruction":t=>`Label ${t} should point to a instruction.`,"missing-org":"No ORG before this instruction — cannot determine its location in memory.","must-have-one-or-more-values":t=>`${t} must have at least one value.`,"occupied-address":t=>`This instruction would be placed in address ${t}, which is already occupied.`,"offset-only-with-data-directive":"OFFSET can only be use with data directives.","reserved-address":t=>`This instruction would be placed in address ${t}, which is reserved by the system.`,"size-mismatch":(t,e)=>`The source (${t}-bit) and destination (${e}-bit) must be the same size.`,"unexpected-error":t=>`Unexpected error: ${String(t)}`,"unknown-size":"Addressing an unknown memory address with an immediate operand requires specifying the type of pointer with WORD PTR or BYTE PTR before the address.","value-out-of-range":(t,e)=>`The number ${t} cannot be represented with ${e} bits.`,lexer:{"character-too-long":"Character literals can only have one character.","empty-character":"Character literals can't be empty.","invalid-binary":"Invalid binary number. It should only contain 0s and 1s.","invalid-decimal":"Invalid decimal number. It should only contain digits.","only-ascii":"Only ASCII character are supported for characters literals and strings.","unexpected-character":t=>`Unexpected character "${t}".`,"unterminated-character":"Unterminated character.","unterminated-string":"Unterminated string."},parser:{"ambiguous-unary":"Ambiguous unary expression detected. Use parentheses to disambiguate.","expected-address-after-org":"Expected address after ORG.","expected-argument":"Expected argument.","expected-eos":"Expected end of statement.","expected-instruction":t=>`Expected instruction, got ${t.type}.`,"expected-label-after-offset":"Expected label after OFFSET.","expected-instruction-after-label":t=>`Expected instruction after label, got ${t.type}.`,"expected-literal-after-expression":t=>`Expected "${t}" after expression.`,"expected-literal-after-literal":(t,e)=>`Expected "${t}" after "${e}".`,"expected-type":(t,e)=>`Expected ${t}, got ${e}.`,"indirect-addressing-must-be-bx":"The only register supported for indirect addressing is BX.","unclosed-parenthesis":"Unclosed parenthesis.","unexpected-identifier":"Unexpected identifier. You may have forgotten a colon (:) to make it a label."}},xT=ye.from(ye.MAX_ADDRESS).toString(),oX=Yi.from(Yi.MAX_ADDRESS).toString(),aX={"address-has-code":t=>`La dirección de memoria ${ye.format(t)} tiene instrucciones. No se puede usar como dirección de datos.`,"address-out-of-range":t=>`La dirección de memoria ${ye.format(t)} está fuera de rango (dirección máxima de memoria: ${xT}).`,"cannot-accept-strings":t=>`${t} no puede aceptar cadenas de texto.`,"cannot-be-indirect":"Este operando no puede ser una dirección de memoria indirecta.","cannot-be-unassinged":t=>`${t} no puede estar sin asignar.`,"cannot-be-word":"Este operando no puede ser de 16 bits.","circular-reference":"Se detectó una referencia circular.","constant-must-have-a-label":"La constante debe tener una etiqueta.","constant-must-have-one-value":"La constante debe tener una exactamente un valor.","destination-cannot-be-immediate":"El destino no puede ser un valor inmediato.","double-memory-access":"No se puede acceder a una memoria dos veces en la misma instrucción.","duplicated-label":t=>`Etiqueta duplicada "${t}".`,"empty-program":"Programa vacío. El programa debe tener, al menos, una instrucción END.","end-must-be-the-last-statement":"END debe ser la última instrucción.","equ-not-found":t=>`EQU "${t}" no encontrado.`,"expects-ax":"Este operando debe ser AX o AL.","expects-dx":"El único registro válido es DX.","expects-immediate":"Este operando debe ser inmediato.","expects-label":"Este operando debe ser una etiqueta.","expects-no-operands":"Esta instrucción no espera ningún operando.","expects-one-operand":"Esta instrucción espera un operando.","expects-two-operands":"Esta instrucción espera dos operandos.","expects-word-register":"Esta instrucción espera un registro de 16 bits como su operando.","instruction-out-of-range":t=>`Esta instrucción se colocaría en la dirección ${ye.format(t)}, la cual se encuentra fuera del rango de memoria (dirección máxima de memoria: ${xT}).`,"invalid-interrupt":t=>`${t} no es un número de interrupción válido.`,"io-address-out-of-range":t=>`La dirección de E/S ${t} está fuera de rango (dirección máxima de memoria E/S: ${oX}).`,"label-not-found":t=>`La etiqueta "${t}" no ha sido definida.`,"label-should-be-a-number":t=>`La etiqueta ${t} debería apuntar a una constante EQU o a una instrucción. Quizás quiso escribir OFFSET ${t}.`,"label-should-be-an-instruction":t=>`La etiqueta ${t} debería apuntar a una instrucción.`,"missing-org":"No hay ningún ORG antes de esta instrucción, por lo que no se puede determinar su ubicación en memoria.","must-have-one-or-more-values":t=>`${t} debe tener al menos un valor.`,"occupied-address":t=>`Esta instrucción sería colocada en la dirección ${ye.format(t)}, la cual ya está ocupada.`,"offset-only-with-data-directive":"OFFSET solo puede ser usado con variables.","reserved-address":t=>`Esta instrucción sería colocada en la dirección ${ye.format(t)}, la cual ya está reservada por el sistema.`,"size-mismatch":(t,e)=>`La fuente (${t} bits) y el destino (${e} bits) deben ser del mismo tamaño.`,"unexpected-error":t=>`Error inesperado: ${String(t)}`,"unknown-size":"Acceder a una dirección de memoria desconocida con un operando inmediato requiere especificar el tipo de puntero con WORD PTR o BYTE PTR antes de la dirección.","value-out-of-range":(t,e)=>`El número ${t} no puede ser representado con ${e} bits.`,lexer:{"character-too-long":"El carácter solo puede contener un carácter.","empty-character":"Los carácter no puede estar vacío.","invalid-binary":"Número binario inválido. Solo puede contener ceros y unos.","invalid-decimal":"Número decimal inválido. Solo puede contener dígitos.","only-ascii":"Solo se soportan caracteres ASCII para caracteres y cadenas de texto.","unexpected-character":t=>`Carácter inesperado "${t}".`,"unterminated-character":"Carácter sin terminar.","unterminated-string":"Cadena sin terminar."},parser:{"ambiguous-unary":"Se detectó una expresión unaria ambigua. Use paréntesis para evitar ambigüedades.","expected-address-after-org":"Se esperaba una dirección después de ORG.","expected-argument":"Se esperaba un argumento.","expected-eos":"Se esperaba que la instrucción termine.","expected-instruction":t=>`Se esperaba una instrucción, se obtuvo ${t.type}.`,"expected-label-after-offset":"Se esperaba una etiqueta después de OFFSET.","expected-instruction-after-label":t=>`Se esperaba una instrucción después de la etiqueta, se obtuvo ${t.type}.`,"expected-literal-after-expression":t=>`Se esperaba "${t}" después de la expresión.`,"expected-literal-after-literal":(t,e)=>`Se esperaba "${t}" después de "${e}".`,"expected-type":(t,e)=>`Se esperaba ${t}, se obtuvo ${e}.`,"indirect-addressing-must-be-bx":"El único registro válido para el direccionamiento indirecto es BX.","unclosed-parenthesis":"Paréntesis sin cerrar.","unexpected-identifier":"Identificador inesperado. Tal vez te olvidaste agregar dos puntos (:) para hacerlo una etiqueta."}},lX=t_({en:sX,es:aX});class le extends Error{constructor(n,...i){super();oe(this,"code");oe(this,"context");oe(this,"position");this.code=n,this.context=i,this.position=null,n==="unexpected-error"&&console.error("[Unexpected Assembler Error]",...i)}at(n){return n&&(n instanceof sn?this.position=n:"position"in n?this.position=n.position:"meta"in n&&(this.position=n.meta.position)),this}translate(n){return lX(n,this.code,...this.context)}get message(){let n=this.translate("en");return this.position&&(n+=` (${this.position})`),n}toString(){return this.message}static from(n){return n instanceof le?n:new le("unexpected-error",n)}}const s_=[[0,I.fromUnsigned(40960,16)],[3,I.fromUnsigned(41728,16)],[6,I.fromUnsigned(42496,16)],[7,I.fromUnsigned(42752,16)]],uX=new Set(...s_.map(([t])=>[t*4,t*4+1,t*4+2,t*4+3]));var aa,vc;class cX{constructor(){oe(this,"codeMemory",new Set);oe(this,"labels",new Map);Re(this,aa,!1);Re(this,vc,!1)}loadStatements(e){if(C(this,aa))throw new Error("Tried to load statements twice");Y(this,aa,!0),this.labels.clear();const n=[];for(const i of e)if("label"in i&&i.label){if(this.labels.has(i.label)){n.push(new le("duplicated-label",i.label).at(i.position));continue}i.isInstruction()?this.labels.set(i.label,{type:"instruction",address:ye.from(0)}):i.directive==="EQU"?this.labels.set(i.label,{type:"EQU",constant:i}):this.labels.set(i.label,{type:i.directive,address:ye.from(0)})}return n}computeAddresses(e){if(C(this,vc))throw new Error("Tried to compute addresses twice");Y(this,vc,!0),this.codeMemory.clear();const n=new Set;let i=null;return Sv(e,s=>{if(s.isEnd()||s.isDataDirective()&&s.directive==="EQU")return;if(s.isOriginChange()){i=s.newAddress;return}if(i===null)throw new le("missing-org").at(s);const o=s.length;for(let l=0;l<o;l++){if(!ye.inRange(i+l))throw new le("instruction-out-of-range",i+l).at(s);const u=ye.from(i+l);if(n.has(u.value))throw new le("occupied-address",u).at(s);if(uX.has(u.value))throw new le("reserved-address",u).at(s);n.add(u.value),s.isInstruction()&&this.codeMemory.add(u.value)}const a=ye.from(i);s.setStart(a),s.label&&this.labels.set(s.label,{type:s.isInstruction()?"instruction":s.directive,address:a}),i+=o},le.from)}labelExists(e){if(!C(this,aa))throw new Error("Tried to check if label exists before loading statements");return this.labels.has(e)}getLabelType(e){var n;if(!C(this,aa))throw new Error("Tried to get type of label before loading statements");return(n=this.labels.get(e))==null?void 0:n.type}getLabelValue(e){if(!C(this,aa))throw new Error("Tried to get type of label before loading statements");const n=this.labels.get(e);if(n){if(n.type==="EQU")return n.constant.evaluate(this);if(!C(this,vc))throw new Error("Tried to get address of label before computing addresses");return n.address.value}}addressIsReserved(e){return e instanceof ye&&(e=e.value),this.codeMemory.has(e)}}aa=new WeakMap,vc=new WeakMap;const dX=["AL","BL","CL","DL","AH","BH","CH","DH"],mj=["AX","BX","CX","DX","SP"],kv=[...dX,...mj],o_=["DB","DW","EQU"],a_=["MOV","PUSH","POP","IN","OUT","PUSHF","POPF","ADD","ADC","INC","SUB","SBB","DEC","NEG","CMP","NOT","AND","OR","XOR","CALL","JMP","RET","JZ","JO","JS","JC","JNZ","JNO","JNS","JNC","INT","IRET","CLI","STI","NOP","HLT"],hX=["OFFSET","ORG","BYTE","WORD","PTR","END",...kv,...a_,...o_];class fX{constructor(e,n,i){oe(this,"type");oe(this,"lexeme");oe(this,"position");this.type=e,this.lexeme=n,this.position=i}toJSON(){return{type:this.type,lexeme:this.lexeme,position:this.position.toJSON()}}}class pX{constructor(e){oe(this,"scanned",!1);oe(this,"tokens",[]);oe(this,"position",new sn(0));this.source=e}scanTokens(){if(this.scanned)throw new Error("Scanner has already been used.");for(this.scanned=!0;!this.isAtEnd();){this.position=new sn(this.position.end);const e=this.advance();switch(e){case"(":this.addToken("LEFT_PAREN");continue;case")":this.addToken("RIGHT_PAREN");continue;case"[":this.addToken("LEFT_BRACKET");continue;case"]":this.addToken("RIGHT_BRACKET");continue;case",":this.addToken("COMMA");continue;case"?":this.addToken("QUESTION_MARK");continue;case"+":this.addToken("PLUS");continue;case"-":this.addToken("MINUS");continue;case"*":this.addToken("ASTERISK");continue;case"'":{let n=0;for(;this.peek()!=="'";){if(this.isAtEnd()||this.peek()===`
`)throw new le("lexer.unterminated-character").at(this.position);if(Af(this.peek())===null)throw new le("lexer.only-ascii").at(new sn(this.position.end,this.position.end+1));this.advance(),n++}if(this.advance(),n===0)throw new le("lexer.empty-character").at(this.position);if(n>=2)throw new le("lexer.character-too-long").at(this.position);this.addToken("CHARACTER");continue}case'"':for(;this.peek()!=='"';){if(this.isAtEnd()||this.peek()===`
`)throw new le("lexer.unterminated-string").at(this.position);if(Af(this.peek())===null)throw new le("lexer.only-ascii").at(new sn(this.position.end,this.position.end+1));this.advance()}this.advance(),this.addToken("STRING");continue;case";":for(;this.peek()!==`
`&&!this.isAtEnd();)this.advance();continue;case" ":case"\r":case"	":continue;case`
`:this.addToken("EOL");continue}if(this.isDigit(e)){for(;this.isDigit(this.peek())||this.peek()>="a"&&this.peek()<="f"||this.peek()>="A"&&this.peek()<="F";)this.advance();if(this.peek()==="H"||this.peek()==="h")this.advance();else{const n=this.source.slice(this.position.start,this.position.end);if(n.at(-1)==="b"||n.at(-1)==="B"){if(!/^[01]+b$/i.test(n))throw new le("lexer.invalid-binary").at(this.position)}else if(!/^\d+$/.test(n))throw new le("lexer.invalid-decimal").at(this.position)}this.addToken("NUMBER");continue}if(this.isAlpha(e)){for(;this.isAlphaNumeric(this.peek());)this.advance();const n=this.source.slice(this.position.start,this.position.end).toUpperCase();hX.includes(n)?this.addToken(n):this.peek()===":"?(this.advance(),this.addToken("LABEL")):this.addToken("IDENTIFIER");continue}throw new le("lexer.unexpected-character",e).at(this.position)}return this.position=new sn(this.position.end),this.addToken("EOF"),this.tokens}addToken(e){this.tokens.push(new fX(e,this.source.slice(this.position.start,this.position.end),this.position))}advance(){const e=this.source.charAt(this.position.end);return this.position=new sn(this.position.start,this.position.end+1),e}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}isAtEnd(){return this.position.end>=this.source.length}isDigit(e){return e>="0"&&e<="9"}peek(){return this.isAtEnd()?"\0":this.source.charAt(this.position.end)}}class _n{constructor(e){this.position=e}isNumberLiteral(){return this.type==="number-literal"}isLabel(){return this.type==="label"}isUnaryOperation(){return this.type==="unary-operation"}isBinaryOperation(){return this.type==="binary-operation"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}oe(_n,"numberLiteral",(...e)=>new mX(...e)),oe(_n,"label",(...e)=>new gX(...e)),oe(_n,"unaryOperation",(...e)=>new vX(...e)),oe(_n,"binaryOperation",(...e)=>new yX(...e));class mX extends _n{constructor(n,i){super(i);oe(this,"type","number-literal");this.value=n}evaluate(){return this.value}toJSON(){return{...super.toJSON(),value:this.value}}}let gX=class extends _n{constructor(n,i,r){super(r);oe(this,"type","label");this.value=n,this.offset=i}evaluate(n){if(!n.labelExists(this.value))throw new le("label-not-found",this.value).at(this.position);const i=n.getLabelType(this.value);if((i==="DB"||i==="DW")&&!this.offset)throw new le("label-should-be-a-number",this.value).at(this.position);if((i==="EQU"||i==="instruction")&&this.offset)throw new le("offset-only-with-data-directive").at(this.position);return n.getLabelValue(this.value)}toJSON(){return{...super.toJSON(),value:this.value,offset:this.offset}}};class vX extends _n{constructor(n,i,r){super(r);oe(this,"type","unary-operation");this.operator=n,this.right=i}evaluate(n){return this.operator==="+"?this.right.evaluate(n):-this.right.evaluate(n)}toJSON(){return{...super.toJSON(),operator:this.operator,right:this.right.toJSON()}}}class yX extends _n{constructor(n,i,r,s){super(s);oe(this,"type","binary-operation");this.left=n,this.operator=i,this.right=r}evaluate(n){return this.operator==="+"?this.left.evaluate(n)+this.right.evaluate(n):this.operator==="-"?this.left.evaluate(n)-this.right.evaluate(n):this.left.evaluate(n)*this.right.evaluate(n)}toJSON(){return{...super.toJSON(),operator:this.operator,left:this.left.toJSON(),right:this.right.toJSON()}}}class Oy{constructor(e){this.position=e}isOriginChange(){return this.type==="origin-change"}isEnd(){return this.type==="end"}isDataDirective(){return this.type==="data-directive"}isInstruction(){return this.type==="instruction"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}var ro;class gj extends Oy{constructor(n,i,r){super(r);oe(this,"type","data-directive");oe(this,"label");oe(this,"values");Re(this,ro,null);this.values=n,this.label=i}get start(){if(C(this,ro)===null)throw new Error("Start not set");return C(this,ro)}setStart(n){if(C(this,ro)!==null)throw new Error("Start already set");Y(this,ro,n)}toJSON(){return{...super.toJSON(),...C(this,ro)?{start:C(this,ro).toJSON()}:{},directive:this.directive,label:this.label}}}ro=new WeakMap;var Il,la,yc;class wX extends gj{constructor(n,i,r){super(n,i,r);oe(this,"directive","EQU");Re(this,Il,"not-processed");Re(this,la,null);Re(this,yc,null)}toJSON(){var n;return{...super.toJSON(),value:C(this,yc)??((n=C(this,la))==null?void 0:n.toJSON())??this.values.map(i=>i.toJSON())}}validate(){if(C(this,la))throw new Error("Constant already validated");if(!this.label)throw new le("constant-must-have-a-label").at(this);if(this.values.length!==1)throw new le("constant-must-have-one-value").at(this);const n=this.values[0];if(n.type==="string")throw new le("cannot-accept-strings","EQU").at(n);if(n.type==="unassigned")throw new le("cannot-be-unassinged","EQU").at(n);Y(this,la,n.value)}evaluateExpressions(n){if(!C(this,la))throw new Error("Constant not validated");if(C(this,Il)==="processed")return C(this,yc);if(C(this,Il)==="processing")throw new le("circular-reference").at(this.position);Y(this,Il,"processed");const i=C(this,la).evaluate(n);return Y(this,Il,"processed"),Y(this,yc,i),i}evaluate(n){return this.evaluateExpressions(n)}}Il=new WeakMap,la=new WeakMap,yc=new WeakMap;const Qd=Symbol("unassigned");var pi,Lr;class bX extends gj{constructor(n,i,r,s){super(i,r,s);oe(this,"size");Re(this,pi,null);Re(this,Lr,null);this.directive=n,this.size=n==="DB"?8:16}get length(){if(!C(this,pi))throw new Error("Data directive not validated");return C(this,pi).length*(this.size/8)}getValues(){if(!C(this,Lr))throw new Error("Data directive not evaluated");return C(this,Lr)}toJSON(){return{...super.toJSON(),values:(C(this,Lr)??C(this,pi)??this.values).map(n=>n===Qd?"?":n.toJSON())}}validate(){if(C(this,pi))throw new Error("Data directive already validated");Y(this,pi,[]);for(const n of this.values)if(n.isUnassigned())C(this,pi).push(Qd);else if(n.isString()){if(this.directive!=="DB")throw new le("cannot-accept-strings",this.directive).at(n);const i=n.value;for(let r=0;r<i.length;r++){const s=Af(i[r]);if(s===null)throw new Error("Invalid character, should not happen");const o=new sn(n.position.start+r,n.position.start+r+1),a=_n.numberLiteral(s,o);C(this,pi).push(a)}}else C(this,pi).push(n.value);if(C(this,pi).length===0)throw new le("must-have-one-or-more-values",this.directive).at(this)}evaluateExpressions(n){if(!C(this,pi))throw new Error("Data directive not validated");if(C(this,Lr))throw new Error("Data directive already evaluated");Y(this,Lr,[]);const i=Sv(C(this,pi),r=>{if(r===Qd)C(this,Lr).push(Qd);else{const s=r.evaluate(n);if(!I.fits(s,this.size))throw new le("value-out-of-range",s,this.size).at(this);const o=I.fromNumber(s,this.size);C(this,Lr).push(o)}},le.from);return i.length>0&&Y(this,Lr,null),i}}pi=new WeakMap,Lr=new WeakMap;class l_{constructor(e){this.position=e}isString(){return this.type==="string"}isUnassigned(){return this.type==="unassigned"}isNumberExpression(){return this.type==="number-expression"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}class xX extends l_{constructor(n,i){super(i);oe(this,"type","string");this.value=n}toJSON(){return{...super.toJSON(),value:this.value}}}class SX extends l_{constructor(n){super(n);oe(this,"type","unassigned")}}class kX extends l_{constructor(n){super(n.position);oe(this,"type","number-expression");this.value=n}toJSON(){return{...super.toJSON(),value:this.value.toJSON()}}}function _X(t,e,n){const i=sn.merge(t.position,...e.map(r=>r.position));switch(t.type){case"DB":case"DW":return new bX(t.type,e,n,i);case"EQU":return new wX(e,n,i)}}class CX extends Oy{constructor(n){super(n);oe(this,"type","end")}}function _l(t){switch(t){case"AL":case"AX":return 0;case"BL":case"BX":return 1;case"CL":case"CX":return 2;case"DL":case"DX":return 3;case"AH":case"SP":return 4;case"CH":return 5;case"DH":return 6;case"BH":return 7}}var so;class cu extends Oy{constructor(n,i,r){super(r);oe(this,"type","instruction");oe(this,"label");oe(this,"operands");Re(this,so,null);this.operands=n,this.label=i}get start(){if(C(this,so)===null)throw new Error("Start not set");return C(this,so)}setStart(n){if(C(this,so)!==null)throw new Error("Start already set");Y(this,so,n)}toJSON(){return{...super.toJSON(),...C(this,so)?{start:C(this,so).toJSON()}:{},instruction:this.instruction,label:this.label}}}so=new WeakMap;var jn,rr;class EX extends cu{constructor(n,i,r,s){super(i,r,s);Re(this,jn,null);Re(this,rr,null);this.instruction=n}get length(){if(!C(this,jn))throw new Error("Instruction not validated");const{mode:n,size:i,out:r,src:s}=C(this,jn);let o=1;return(n==="reg<-mem"&&s.mode==="direct"||(n==="mem<-reg"||n==="mem<-imd")&&r.mode==="direct")&&(o+=1),(n==="reg<-imd"||n==="mem<-imd")&&(o+=i/8),o}get operation(){if(!C(this,rr))throw new Error("Instruction not evaluated");return C(this,rr)}toBytes(){const{mode:n,size:i,out:r,src:s}=this.operation,o=[],a={MOV:0,AND:130,OR:132,XOR:134,ADD:64,ADC:138,SUB:140,SBB:142,CMP:144};switch(o[0]=a[this.instruction],i===16&&(o[0]|=1),n){case"reg<-reg":{o[0]|=(_l(r)&3)<<2,o[0]|=(_l(s)&3)<<0;break}case"reg<-mem":{s.mode==="direct"?(o[0]=16,o.push(s.address.byte.low.unsigned)):o[0]=17,o[0]|=(_l(r)&3)<<2;break}case"reg<-imd":{o[1]=72,o[1]|=_l(r)<<0,o.push(s.low.unsigned),i===16&&o.push(s.high.unsigned);break}case"mem<-reg":{r.mode==="direct"?(o[0]=64,o.push(r.address.byte.low.unsigned)):o[0]=65,o[0]|=(_l(s)&3)<<2;break}case"mem<-imd":{r.mode==="direct"?(o[1]=200,o.push(r.address.byte.low.unsigned),o.push(r.address.byte.high.unsigned)):o[1]=216,o.push(s.low.unsigned),i===16&&o.push(s.high.unsigned);break}default:return n}return new Uint8Array(o)}toJSON(){return{...super.toJSON(),...C(this,rr)??C(this,jn)??{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(C(this,jn))throw new Error("Instruction already validated");if(this.operands.length!==2)throw new le("expects-two-operands").at(this);const[i,r]=this.operands;if(i.isRegister()){if(r.isRegister()){if(i.size!==r.size)throw new le("size-mismatch",r.size,i.size).at(this);Y(this,jn,{mode:"reg<-reg",size:i.size,out:i.value,src:r.value});return}if(r.isDirectAddress()){if(r.size!=="auto"&&r.size!==i.size)throw new le("size-mismatch",r.size,i.size).at(this);Y(this,jn,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"direct",address:r.value}});return}if(r.isIndirectAddress()){if(r.size!=="auto"&&r.size!==i.size)throw new le("size-mismatch",r.size,i.size).at(this);Y(this,jn,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"indirect"}});return}const s=r.getAsDirectAddress(n);if(s){if(s.size!==i.size)throw new le("size-mismatch",s.size,i.size).at(this);Y(this,jn,{mode:"reg<-mem",size:i.size,out:i.value,src:{mode:"direct",address:s.expression}});return}Y(this,jn,{mode:"reg<-imd",size:i.size,out:i.value,src:r.value});return}else{let s,o;if(i.isIndirectAddress())s=i.size,o={mode:"indirect"};else if(i.isDirectAddress())s=i.size,o={mode:"direct",address:i.value};else{const a=i.getAsDirectAddress(n);if(a)s=a.size,o={mode:"direct",address:a.expression};else throw new le("destination-cannot-be-immediate").at(i)}if(r.isRegister()){if(s!=="auto"&&s!==r.size)throw new le("size-mismatch",s,r.size).at(this);Y(this,jn,{mode:"mem<-reg",size:r.size,out:o,src:r.value});return}if(r.isNumberExpression()){if(r.getAsDirectAddress(n))throw new le("double-memory-access").at(this);if(s==="auto")throw new le("unknown-size").at(i);Y(this,jn,{mode:"mem<-imd",size:s,out:o,src:r.value});return}throw new le("double-memory-access").at(this)}}evaluateExpressions(n){if(!C(this,jn))throw new Error("Instruction not validated");if(C(this,rr))throw new Error("Instruction aready evaluated");const{mode:i,size:r,out:s,src:o}=C(this,jn),a=l=>{const u=l.evaluate(n);if(!ye.inRange(u))throw new le("address-out-of-range",u).at(l);const c=ye.from(u);if(n.addressIsReserved(c))throw new le("address-has-code",c).at(l);return c};switch(i){case"reg<-reg":{Y(this,rr,{mode:i,size:r,out:s,src:o});return}case"reg<-mem":{Y(this,rr,{mode:i,size:r,out:s,src:o.mode==="direct"?{mode:"direct",address:a(o.address)}:{mode:"indirect"}});return}case"reg<-imd":{const l=o.evaluate(n);if(!I.fits(l,r))throw new le("value-out-of-range",l,r).at(o);const u=I.fromNumber(l,r);Y(this,rr,{mode:i,size:r,out:s,src:u});return}case"mem<-reg":{Y(this,rr,{mode:i,size:r,out:s.mode==="direct"?{mode:"direct",address:a(s.address)}:{mode:"indirect"},src:o});return}case"mem<-imd":{const l=o.evaluate(n);if(!I.fits(l,r))throw new le("value-out-of-range",l,r).at(o);const u=I.fromNumber(l,r);Y(this,rr,{mode:i,size:r,out:s.mode==="direct"?{mode:"direct",address:a(s.address)}:{mode:"indirect"},src:u});return}default:return i}}}jn=new WeakMap,rr=new WeakMap;var ws,oo;class AX extends cu{constructor(n,i,r,s){super(i,r,s);Re(this,ws,null);Re(this,oo,null);oe(this,"length",2);this.instruction=n}toBytes(){return new Uint8Array([26,this.value.unsigned])}get value(){if(!C(this,oo))throw new Error("Instruction not evaluated");return C(this,oo)}toJSON(){return{...super.toJSON(),...C(this,oo)?{value:C(this,oo).toJSON()}:C(this,ws)?{initialValue:C(this,ws).toJSON()}:{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(C(this,ws))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const n=this.operands[0];if(!n.isNumberExpression())throw new le("expects-immediate").at(n);Y(this,ws,n.value)}evaluateExpressions(n){if(!C(this,ws))throw new Error("Instruction not validated");if(C(this,oo))throw new Error("Instruction aready evaluated");const i=C(this,ws).evaluate(n);if(!I.fitsUnsigned(i,8))throw new le("invalid-interrupt",i).at(C(this,ws));Y(this,oo,I.fromUnsigned(i,8))}}ws=new WeakMap,oo=new WeakMap;var jr,ao,oN;let PX=(oN=class extends cu{constructor(n,i,r,s){super(i,r,s);Re(this,jr,null);Re(this,ao,null);this.instruction=n}get length(){if(!C(this,jr))throw new Error("Instruction not validated");return C(this,jr).port==="fixed"?2:1}toBytes(){const n=[],i={IN:80,OUT:84};return n[0]=i[this.instruction],this.operation.size===16&&(n[0]|=1),this.operation.port==="fixed"?n[1]=this.operation.address.value:n[0]|=2,new Uint8Array(n)}get operation(){if(C(this,ao)===null)throw new Error("Operation not set");return C(this,ao)}toJSON(){return{...super.toJSON(),...C(this,ao)??C(this,jr)??{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(C(this,jr))throw new Error("Instruction already validated");if(this.operands.length!==2)throw new le("expects-two-operands").at(this);const n=this.operands[this.instruction==="IN"?0:1],i=this.operands[this.instruction==="IN"?1:0];if(!n.isRegister()||n.value!=="AL"&&n.value!=="AX")throw new le("expects-ax").at(n);const r=n.value==="AX"?16:8;if(i.isRegister()){if(i.value!=="DX")throw new le("expects-dx").at(i);Y(this,jr,{port:"variable",size:r});return}if(i.isNumberExpression()){Y(this,jr,{port:"fixed",size:r,address:i.value});return}throw new le("expects-immediate").at(i)}evaluateExpressions(n){if(!C(this,jr))throw new Error("Instruction not validated");if(C(this,ao))throw new Error("Instruction aready evaluated");const i=C(this,jr);if(i.port==="fixed"){const r=i.address.evaluate(n);if(!Yi.inRange(r))throw new le("io-address-out-of-range",r).at(this);const s=Yi.from(r);Y(this,ao,{port:"fixed",size:i.size,address:s})}else Y(this,ao,{port:"variable",size:i.size})}},jr=new WeakMap,ao=new WeakMap,oN);var lo,uo,aN;let TX=(aN=class extends cu{constructor(n,i,r,s){super(i,r,s);Re(this,lo,null);Re(this,uo,null);oe(this,"length",3);this.instruction=n}toBytes(){const n=[],i={JC:32,JNC:33,JZ:34,JNZ:35,JS:36,JNS:37,JO:38,JNO:39,JMP:48,CALL:49};return n.push(i[this.instruction]),n.push(this.address.byte.low.unsigned),n.push(this.address.byte.high.unsigned),new Uint8Array(n)}get address(){if(C(this,uo)===null)throw new Error("Instruction not evaluated");return C(this,uo)}toJSON(){return{...super.toJSON(),...C(this,uo)?{address:C(this,uo).toJSON()}:C(this,lo)?{jumpTo:C(this,lo)}:{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(C(this,lo))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const i=this.operands[0];if(!i.isNumberExpression()||!i.value.isLabel())throw new le("expects-label").at(i);const r=i.value.value,s=n.getLabelType(r);if(!s)throw new le("label-not-found",r).at(i);if(s!=="instruction")throw new le("label-should-be-an-instruction",r).at(i);Y(this,lo,r)}evaluateExpressions(n){if(!C(this,lo))throw new Error("Instruction not validated");if(C(this,uo))throw new Error("Instruction aready evaluated");const i=n.getLabelValue(C(this,lo));if(!ye.inRange(i))throw new le("address-out-of-range",i).at(this);Y(this,uo,ye.from(i))}},lo=new WeakMap,uo=new WeakMap,aN);var bs,lN;let RX=(lN=class extends cu{constructor(n,i,r,s){super(i,r,s);Re(this,bs,null);oe(this,"length",1);this.instruction=n}toBytes(){let i={PUSH:96,POP:104}[this.instruction];return i|=_l(this.register),new Uint8Array([i])}get register(){if(!C(this,bs))throw new Error("Instruction not evaluated");return C(this,bs)}toJSON(){return{...super.toJSON(),...C(this,bs)?{register:C(this,bs)}:{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(C(this,bs))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const n=this.operands[0];if(!n.isRegister()||n.size!==16)throw new le("expects-word-register").at(n);Y(this,bs,n.value)}evaluateExpressions(){if(!C(this,bs))throw new Error("Instruction not validated")}},bs=new WeakMap,lN);var Di,xs;class NX extends cu{constructor(n,i,r,s){super(i,r,s);Re(this,Di,null);Re(this,xs,null);this.instruction=n}get length(){if(!C(this,Di))throw new Error("Instruction not validated");const{mode:n}=C(this,Di);let i=2;return n==="mem-direct"&&(i+=2),i}toBytes(){const n=[],i={NOT:64,NEG:66,INC:68,DEC:70};switch(n[0]=i[this.instruction],this.operation.size===16&&(n[0]|=1),this.operation.mode){case"reg":{n[1]=0,n[1]|=_l(this.operation.reg);break}case"mem-direct":{n[1]=192;const r=this.operation.address.byte;n.push(r.low.unsigned),n.push(r.high.unsigned);break}case"mem-indirect":{n[1]=208;break}default:return this.operation}return new Uint8Array(n)}get operation(){if(!C(this,xs))throw new Error("Instruction not evaluated");return C(this,xs)}toJSON(){return{...super.toJSON(),...C(this,xs)??C(this,Di)??{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(C(this,Di))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const i=this.operands[0];if(i.isRegister()){Y(this,Di,{mode:"reg",size:i.size,reg:i.value});return}if(i.isDirectAddress()){if(i.size==="auto")throw new le("unknown-size").at(i);Y(this,Di,{mode:"mem-direct",size:i.size,address:i.value});return}if(i.isIndirectAddress()){if(i.size==="auto")throw new le("unknown-size").at(i);Y(this,Di,{mode:"mem-indirect",size:i.size});return}const r=i.getAsDirectAddress(n);if(r){Y(this,Di,{mode:"mem-direct",size:r.size,address:r.expression});return}throw new le("destination-cannot-be-immediate").at(i)}evaluateExpressions(n){if(!C(this,Di))throw new Error("Instruction not validated");if(C(this,xs))throw new Error("Instruction aready evaluated");const i=C(this,Di);switch(i.mode){case"reg":{Y(this,xs,{mode:"reg",size:i.size,reg:i.reg});return}case"mem-direct":{const r=i.address.evaluate(n);if(!ye.inRange(r))throw new le("address-out-of-range",r).at(i.address);const s=ye.from(r);if(n.addressIsReserved(s))throw new le("address-has-code",s).at(i.address);Y(this,xs,{mode:"mem-direct",size:i.size,address:s});return}case"mem-indirect":{Y(this,xs,{mode:"mem-indirect",size:i.size});return}default:return i}}}Di=new WeakMap,xs=new WeakMap;var wc;class MX extends cu{constructor(n,i,r,s){super(i,r,s);Re(this,wc,!1);oe(this,"length",1);this.instruction=n}toBytes(){const n={PUSHF:112,POPF:120,RET:51,CLI:24,STI:25,IRET:59,NOP:16,HLT:17};return new Uint8Array([n[this.instruction]])}validate(){if(C(this,wc))throw new Error("Instruction already validated");if(this.operands.length>0)throw new le("expects-no-operands").at(this);Y(this,wc,!0)}evaluateExpressions(){if(!C(this,wc))throw new Error("Instruction not validated")}}wc=new WeakMap;class Dy{constructor(e){this.position=e}isRegister(){return this.type==="register"}isIndirectAddress(){return this.type==="indirect-address"}isDirectAddress(){return this.type==="direct-address"}isNumberExpression(){return this.type==="number-expression"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}class OX extends Dy{constructor(n){super(n.position);oe(this,"type","register");oe(this,"value");this.value=n.type}get size(){return mj.includes(this.value)?16:8}toJSON(){return{...super.toJSON(),value:this.value}}}class DX extends Dy{constructor(n,i){super(i);oe(this,"type","indirect-address");oe(this,"size");n?this.size=n==="BYTE"?8:16:this.size="auto"}toJSON(){return{...super.toJSON(),size:this.size}}}class IX extends Dy{constructor(n,i,r){super(r);oe(this,"type","direct-address");oe(this,"size");this.value=n,i?this.size=i==="BYTE"?8:16:this.size="auto"}toJSON(){return{...super.toJSON(),size:this.size,value:this.value.toJSON()}}}class _v extends Dy{constructor(n){super(n.position);oe(this,"type","number-expression");this.value=n}getAsDirectAddress(n){return _v.recursiveGetAsDirectAddress(this.value,n)}static recursiveGetAsDirectAddress(n,i){if(n.isLabel()){const r=n;if(r.offset)return!1;if(!i.labelExists(r.value))throw new le("label-not-found",r.value).at(n.position);const s=i.getLabelType(r.value),o=s==="DB"?8:s==="DW"?16:!1;return o?{size:o,expression:_n.label(r.value,!0,n.position)}:!1}else if(n.isBinaryOperation()){if(n.operator!=="+"&&n.operator!=="-")return!1;const r=_v.recursiveGetAsDirectAddress(n.left,i);return r?{size:r.size,expression:_n.binaryOperation(r.expression,n.operator,n.right,n.position)}:!1}return!1}toJSON(){return{...super.toJSON(),value:this.value.toJSON()}}}function ST(t,e,n){const i=sn.merge(t.position,...e.map(r=>r.position));switch(t.type){case"PUSHF":case"POPF":case"RET":case"IRET":case"CLI":case"STI":case"NOP":case"HLT":return new MX(t.type,e,n,i);case"MOV":case"ADD":case"ADC":case"SUB":case"SBB":case"CMP":case"AND":case"OR":case"XOR":return new EX(t.type,e,n,i);case"NEG":case"INC":case"DEC":case"NOT":return new NX(t.type,e,n,i);case"PUSH":case"POP":return new RX(t.type,e,n,i);case"CALL":case"JZ":case"JNZ":case"JS":case"JNS":case"JC":case"JNC":case"JO":case"JNO":case"JMP":return new TX(t.type,e,n,i);case"IN":case"OUT":return new PX(t.type,e,n,i);case"INT":return new AX(t.type,e,n,i)}}class LX extends Oy{constructor(n,i){super(i);oe(this,"type","origin-change");this.newAddress=n}toJSON(){return{...super.toJSON(),newAddress:this.newAddress}}}let jX=class{constructor(e){oe(this,"tokens");oe(this,"current",0);this.tokens=e}parse(){this.current=0;const e=[];for(;!this.isAtEnd();)this.match("EOL")||e.push(this.statement());return e}statement(){const e=this.originChangeStatement()??this.endStatement()??this.dataDirectiveStatement()??this.instructionStatement();if(!e){const n=this.peek();throw new le("parser.expected-instruction",n).at(n)}return e}originChangeStatement(){const e=this.match("ORG");if(!e)return null;const n=this.consume("NUMBER",new le("parser.expected-address-after-org")),i=this.parseNumber(n);return this.endOfStatement(),new LX(i,sn.merge(e.position,n.position))}endStatement(){const e=this.match("END");if(!e)return null;for(;!this.isAtEnd();)if(!this.match("EOL"))throw new le("end-must-be-the-last-statement").at(e);return new CX(e.position)}dataDirectiveStatement(){const e=this.match("IDENTIFIER"),n=this.match(...o_);if(e&&!n)throw new le("parser.unexpected-identifier").at(e);if(!n)return null;const i=(e==null?void 0:e.lexeme.toUpperCase())||null,r=[this.dataDirectiveValue()];for(;this.match("COMMA");)r.push(this.dataDirectiveValue());return this.endOfStatement(),_X(n,r,i)}dataDirectiveValue(){if(this.match("STRING")){const e=this.previous();return new xX(this.parseString(e),e.position)}if(this.match("QUESTION_MARK")){const e=this.previous();return new SX(e.position)}return new kX(this.numberExpression())}instructionStatement(){const e=this.match("LABEL");for(;this.match("EOL"););const n=this.match(...a_);if(e&&!n){const s=this.peek();throw new le("parser.expected-instruction-after-label",s).at(s)}if(!n)return null;const i=(e==null?void 0:e.lexeme.toUpperCase().slice(0,-1))||null;if(this.isAtEndOfStatement())return ST(n,[],i);const r=[this.instructionOperand()];for(;this.match("COMMA");)r.push(this.instructionOperand());return this.endOfStatement(),ST(n,r,i)}instructionOperand(){if(this.match(...kv)){const n=this.previous();return new OX(n)}const e=this.match("BYTE","WORD");if(e&&this.consume("PTR",new le("parser.expected-literal-after-literal","PTR",this.previous().type)),this.match("LEFT_BRACKET")){const n=this.previous();if(this.check(...kv)){this.consume("BX",new le("parser.indirect-addressing-must-be-bx"));const i=this.consume("RIGHT_BRACKET",new le("parser.expected-literal-after-literal","]","BX"));return new DX(e==null?void 0:e.type,sn.merge(e==null?void 0:e.position,n.position,i.position))}else{const i=this.numberExpression(),r=this.consume("RIGHT_BRACKET",new le("parser.expected-literal-after-expression","]"));return new IX(i,e==null?void 0:e.type,sn.merge(e==null?void 0:e.position,n.position,r.position))}}else if(e)throw new le("parser.expected-literal-after-literal","[","PTR");return new _v(this.numberExpression())}advance(){return this.tokens[this.current++]}check(...e){if(this.isAtEnd())return!1;for(const n of e)if(this.peek().type===n)return!0;return!1}consume(e,n){Array.isArray(e)||(e=[e]);const i=this.match(...e);if(i)return i;throw n||(n=new le("parser.expected-type",e.join(","),this.peek().type)),n.at(this.peek())}endOfStatement(){if(!this.isAtEnd()){if(this.check("EOL"))return this.advance();throw new le("parser.expected-eos").at(this.peek())}}isAtEnd(){return this.peek().type==="EOF"}isAtEndOfStatement(){return this.check("EOL")||this.isAtEnd()}match(...e){return this.check(...e)?this.advance():null}parseNumber(e){return e.lexeme.at(-1)==="h"||e.lexeme.at(-1)==="H"?parseInt(e.lexeme.slice(0,-1),16):e.lexeme.at(-1)==="b"||e.lexeme.at(-1)==="B"?parseInt(e.lexeme.slice(0,-1),2):parseInt(e.lexeme,10)}parseString(e){return e.lexeme.slice(1,-1)}peek(){return this.tokens[this.current]}previous(){return this.tokens[this.current-1]}primaryNE(){if(this.match("NUMBER")){const i=this.previous(),r=this.parseNumber(i);return _n.numberLiteral(r,i.position)}if(this.match("CHARACTER")){const i=this.previous(),r=Af(i.lexeme.slice(1,-1));return _n.numberLiteral(r,i.position)}if(this.match("LEFT_PAREN")){const i=this.numberExpression();return this.consume("RIGHT_PAREN",new le("parser.unclosed-parenthesis")),i}const e=this.match("OFFSET"),n=this.match("IDENTIFIER");if(e&&!n)throw new le("parser.expected-label-after-offset").at(this.peek());if(!n)throw new le("parser.expected-argument").at(this.peek());return _n.label(n.lexeme.toUpperCase(),e!==null,sn.merge(e==null?void 0:e.position,n.position))}unaryNE(){if(this.match("PLUS","MINUS")){const e=this.previous();if(this.check("PLUS","MINUS"))throw new le("parser.ambiguous-unary").at(this.peek());const n=this.unaryNE();return _n.unaryOperation(e.type==="PLUS"?"+":"-",n,sn.merge(e.position,n.position))}return this.primaryNE()}factorNE(){let e=this.unaryNE();for(;this.match("ASTERISK");){const n=this.unaryNE();e=_n.binaryOperation(e,"*",n,sn.merge(e.position,n.position))}return e}termNE(){let e=this.factorNE();for(;this.match("PLUS","MINUS");){const n=this.previous(),i=this.factorNE();e=_n.binaryOperation(e,n.type==="PLUS"?"+":"-",i,sn.merge(e.position,i.position))}return e}numberExpression(){return this.termNE()}};function vj(t){try{const n=new pX(t).scanTokens(),r=new jX(n).parse(),s=r.at(-1);if(!s)throw new le("empty-program");if(!s.isEnd())throw new le("end-must-be-the-last-statement").at(s);let o=[];const a=new cX;if(o=a.loadStatements(r),o.length>0)return{success:!1,errors:o};if(o=Sv(r,c=>{c.isOriginChange()||c.isEnd()||c.validate(a)},le.from),o.length>0)return{success:!1,errors:o};if(o=a.computeAddresses(r),o.length>0)return{success:!1,errors:o};const l=[],u=[];return o=Sv(r,c=>{if(c.isDataDirective())if(c.directive==="EQU")c.evaluateExpressions(a);else{const d=c.evaluateExpressions(a);return l.push(c),d}else c.isInstruction()&&(c.evaluateExpressions(a),u.push(c))},le.from),o.length>0?{success:!1,errors:o}:{success:!0,data:l,instructions:u}}catch(e){return{success:!1,errors:[le.from(e)]}}}class ci{constructor(e){oe(this,"computer");this.computer=e.computer}}const FX=t=>ye.format(t).slice(-2),BX=FX(ye.MAX_ADDRESS),$X={"address-has-instruction":t=>`Memory address ${ye.format(t)} has an instruction, and cannot be written.`,"address-is-reserved":t=>`Memory address ${ye.format(t)} is reserved, and cannot be written.`,"address-out-of-range":t=>`Memory address ${ye.format(t)} is out of range (max memory address: ${BX}).`,"device-not-connected":t=>`"${t}" is not connected to the computer.`,"io-memory-not-connected":t=>`Didn't found a module connected to I/O memory address ${Yi.format(t)}.`,"no-instruction":t=>`Expected instruction at memory address ${ye.format(t)} but none was found.`,"no-program":"No program loaded. Assemble before running.","stack-overflow":"Stack overflow","stack-underflow":"Stack underflow","unexpected-error":t=>`Unexpected error: ${String(t)}`},zX=ye.from(ye.MAX_ADDRESS).toString(),UX={"address-has-instruction":t=>`La dirección de memoria ${ye.format(t)} tiene una instrucción, y no se puede escribir.`,"address-is-reserved":t=>`La dirección de memoria ${ye.format(t)} está reservada, y no se puede escribir.`,"address-out-of-range":t=>`La dirección de memoria ${ye.format(t)} está fuera de rango (dirección máxima de memoria: ${zX}).`,"device-not-connected":t=>`"${t}" no está conectado a la computadora.`,"io-memory-not-connected":t=>`No se encontró ningún módulo conectado a la dirección de memoria E/S ${Yi.format(t)}.`,"no-instruction":t=>`Se esperaba una instrucción en la dirección de memoria ${ye.format(t)} pero no se encontró ninguna.`,"no-program":"No hay ningún programa cargado. Ensamblá antes de ejecutar.","stack-overflow":"Stack overflow","stack-underflow":"Stack underflow","unexpected-error":t=>`Error inesperado: ${String(t)}`},VX=t_({en:$X,es:UX});class Ze extends Error{constructor(n,...i){super();oe(this,"code");oe(this,"context");this.code=n,this.context=i,n==="unexpected-error"&&console.error("[Unexpected Simulator Error]",...i)}translate(n){return VX(n,this.code,...this.context)}get message(){return this.translate("en")}toString(){return this.message}static from(n){return n instanceof Ze?n:new Ze("unexpected-error",n)}}class zo{constructor(e){this.statement=e}get name(){return this.statement.instruction}get start(){return this.statement.start}get position(){return this.statement.position}*consumeInstruction(e,n){if(yield*e.cpu.setMAR("IP"),!(yield*e.cpu.useBus("mem-read"))){const r=e.cpu.getRegister("IP").toString("hex");throw new Ze("unexpected-error",`Could not read instruction byte at address ${r}h`)}yield*e.cpu.updateWordRegister("IP",r=>r.add(1)),yield*e.cpu.getMBR(n)}}var Kv,yj;class HX extends zo{constructor(){super(...arguments);Re(this,Kv)}get operation(){return this.statement.operation}*execute(n){const{mode:i,size:r,out:s,src:o}=this.operation;if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:gt(this,Kv,yj).call(this),willUse:{ri:i==="reg<-mem"||i==="mem<-reg"||i==="mem<-imd"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},i==="reg<-reg"||i==="reg<-mem"||i==="reg<-imd")r===8?yield*n.cpu.copyByteRegister(s,"left.l"):yield*n.cpu.copyWordRegister(s,"left");else{if(s.mode==="direct"?yield*this.consumeInstruction(n,"ri.l"):yield*n.cpu.copyWordRegister("BX","ri"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("left.l"),r===16){if(yield*n.cpu.updateWordRegister("ri",d=>d.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.h")}}if(i==="reg<-reg"||i==="mem<-reg")r===8?yield*n.cpu.copyByteRegister(o,"right.l"):yield*n.cpu.copyWordRegister(o,"right");else if(i==="reg<-imd"||i==="mem<-imd")yield*this.consumeInstruction(n,"right.l"),r===16&&(yield*this.consumeInstruction(n,"right.h"));else{if(o.mode==="direct"?yield*this.consumeInstruction(n,"ri.l"):yield*n.cpu.copyWordRegister("BX","ri"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("right.l"),r===16){if(yield*n.cpu.updateWordRegister("ri",d=>d.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("right.h")}}yield{type:"cpu:cycle.update",phase:"execute"};const a=r===8?n.cpu.getRegister("left.l"):n.cpu.getRegister("left"),l=r===8?n.cpu.getRegister("right.l"):n.cpu.getRegister("right");let u;const c={};switch(this.name){case"AND":case"OR":case"XOR":{const d=this.name==="AND"?a.signed&l.signed:this.name==="OR"?a.signed|l.signed:a.signed^l.signed;u=I.fromSigned(d,r),c.CF=!1,c.OF=!1;break}case"ADD":case"ADC":{const d=this.name==="ADC"&&n.cpu.getFlag("CF")?1:0,h=a.unsigned+l.unsigned+d;h>I.maxValue(r)?(c.CF=!0,u=I.fromUnsigned(h-I.maxValue(r)-1,r)):(c.CF=!1,u=I.fromUnsigned(h,r)),c.OF=a.signed>=0&&l.signed>=0&&u.signed<0||a.signed<0&&l.signed<0&&u.signed>=0;break}case"SUB":case"SBB":case"CMP":{const d=this.name==="SBB"&&n.cpu.getFlag("CF")?1:0,h=a.unsigned-l.unsigned-d;h<0?(c.CF=!0,u=I.fromUnsigned(h+I.maxValue(r)+1,r)):(c.CF=!1,u=I.fromUnsigned(h,r)),c.OF=a.signed>=0&&l.signed<0&&u.signed<0||a.signed<0&&l.signed>=0&&u.signed>=0;break}}if(c.ZF=u.isZero(),c.SF=u.signed<0,yield*n.cpu.aluExecute(this.name==="CMP"?"SUB":this.name,u,c),this.name==="CMP")return!0;if(yield{type:"cpu:cycle.update",phase:"writeback"},i==="reg<-reg"||i==="reg<-mem"||i==="reg<-imd")r===8?yield*n.cpu.copyByteRegister("result.l",s):yield*n.cpu.copyWordRegister("result",s);else{if(r===16){if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.h"),!(yield*n.cpu.useBus("mem-write")))return!1;yield*n.cpu.updateWordRegister("ri",d=>d.add(-1))}if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.l"),!(yield*n.cpu.useBus("mem-write")))return!1}return!0}}Kv=new WeakSet,yj=function(){const{mode:n,out:i,src:r}=this.operation;switch(n){case"reg<-reg":return[i,r];case"reg<-mem":{const s=r.mode==="direct"?r.address.toString():"BX";return[i,`[${s}]`]}case"reg<-imd":return[i,`${r.toString("hex")}h`];case"mem<-reg":return[`[${i.mode==="direct"?i.address.toString():"BX"}]`,r];case"mem<-imd":return[`[${i.mode==="direct"?i.address.toString():"BX"}]`,`${r.toString("hex")}h`];default:return n}};var Xv,wj;class WX extends zo{constructor(){super(...arguments);Re(this,Xv)}get operation(){return this.statement.operation}*execute(n){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:gt(this,Xv,wj).call(this),willUse:{ri:this.operation.mode==="mem-direct"||this.operation.mode==="mem-indirect"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},this.operation.mode==="reg")this.operation.size===8?yield*n.cpu.copyByteRegister(this.operation.reg,"left.l"):yield*n.cpu.copyWordRegister(this.operation.reg,"left");else{if(this.operation.mode==="mem-direct"?(yield*this.consumeInstruction(n,"ri.l"),yield*this.consumeInstruction(n,"ri.h")):yield*n.cpu.copyWordRegister("BX","ri"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("left.l"),this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",o=>o.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.h")}}yield{type:"cpu:cycle.update",phase:"execute"};const i=this.operation.size===8?n.cpu.getRegister("left.l"):n.cpu.getRegister("left");let r;const s={};switch(this.name){case"NOT":{r=I.fromSigned(~i.signed,this.operation.size),s.CF=!1,s.OF=!1;break}case"NEG":{r=I.fromSigned(-i.signed,this.operation.size),s.CF=!i.isZero(),s.OF=i.signed===I.minSignedValue(this.operation.size);break}case"INC":{yield*n.cpu.updateWordRegister("right",I.fromSigned(1,16));const o=i.unsigned+1;o>I.maxValue(this.operation.size)?(s.CF=!0,r=I.fromUnsigned(o-I.maxValue(this.operation.size)-1,this.operation.size)):(s.CF=!1,r=I.fromUnsigned(o,this.operation.size)),s.OF=i.signed>=0&&r.signed<0;break}case"DEC":{yield*n.cpu.updateWordRegister("right",I.fromSigned(1,16));const o=i.unsigned-1;o<0?(s.CF=!0,r=I.fromUnsigned(o+I.maxValue(this.operation.size)+1,this.operation.size)):(s.CF=!1,r=I.fromUnsigned(o,this.operation.size)),s.OF=i.signed<0&&r.signed>=0;break}}if(s.ZF=r.isZero(),s.SF=r.signed<0,yield*n.cpu.aluExecute(this.name==="INC"?"ADD":this.name==="DEC"?"SUB":this.name,r,s),yield{type:"cpu:cycle.update",phase:"writeback"},this.operation.mode==="reg")this.operation.size===8?yield*n.cpu.copyByteRegister("result.l",this.operation.reg):yield*n.cpu.copyWordRegister("result",this.operation.reg);else{if(this.operation.size===16){if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.h"),!(yield*n.cpu.useBus("mem-write")))return!1;yield*n.cpu.updateWordRegister("ri",o=>o.add(-1))}if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.l"),!(yield*n.cpu.useBus("mem-write")))return!1}return!0}}Xv=new WeakSet,wj=function(){switch(this.operation.mode){case"reg":return[this.operation.reg];case"mem-direct":return[`[${this.operation.address.toString()}]`];case"mem-indirect":return["[BX]"];default:return this.operation}};class GX extends zo{get number(){return this.statement.value}*execute(e){return yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[this.number.toString("uint")],willUse:{id:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},yield*super.consumeInstruction(e,"ri.l"),yield{type:"cpu:cycle.update",phase:"execute"},yield*e.cpu.startInterrupt(this.number)}}var qv,bj;class KX extends zo{constructor(){super(...arguments);Re(this,qv)}get operation(){return this.statement.operation}*execute(n){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:gt(this,qv,bj).call(this),willUse:{ri:!0}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},this.operation.port==="fixed")yield*n.cpu.updateWordRegister("ri",I.zero(16)),yield*super.consumeInstruction(n,"ri.l");else if(yield*n.cpu.copyWordRegister("DX","ri"),!n.cpu.getRegister("DX").high.isZero())return yield{type:"cpu:error",error:new Ze("io-memory-not-connected",n.cpu.getRegister("DX"))},!1;if(yield{type:"cpu:cycle.update",phase:"writeback"},this.name==="IN"){if(yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("io-read")))return!1;if(yield*n.cpu.getMBR("AL"),this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",i=>i.add(1)),yield*n.cpu.setMAR("ri"),!n.cpu.getRegister("ri.h").isZero())return yield{type:"cpu:error",error:new Ze("io-memory-not-connected",n.cpu.getRegister("ri"))},!1;if(!(yield*n.cpu.useBus("io-read")))return!1;yield*n.cpu.getMBR("AH")}}else{if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("AL"),!(yield*n.cpu.useBus("io-write")))return!1;if(this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",i=>i.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("AH"),!n.cpu.getRegister("ri.h").isZero())return yield{type:"cpu:error",error:new Ze("io-memory-not-connected",n.cpu.getRegister("ri"))},!1;if(!(yield*n.cpu.useBus("io-write")))return!1}}return!0}}qv=new WeakSet,bj=function(){const n=[];return this.operation.port==="variable"?n.push("DX"):n.push(this.operation.address.toString()),this.operation.size===8?n.push("AL"):n.push("AX"),this.name==="IN"?n.reverse():n};class XX extends zo{get jumpTo(){return this.statement.address}*execute(e){yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[this.jumpTo.toString()],willUse:{id:this.name==="CALL",ri:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},yield*super.consumeInstruction(e,"ri.l"),yield*super.consumeInstruction(e,"ri.h"),yield{type:"cpu:cycle.update",phase:"execute"};let n;switch(this.name){case"JC":n=e.cpu.getFlag("CF");break;case"JNC":n=!e.cpu.getFlag("CF");break;case"JZ":n=e.cpu.getFlag("ZF");break;case"JNZ":n=!e.cpu.getFlag("ZF");break;case"JS":n=e.cpu.getFlag("SF");break;case"JNS":n=!e.cpu.getFlag("SF");break;case"JO":n=e.cpu.getFlag("OF");break;case"JNO":n=!e.cpu.getFlag("OF");break;case"CALL":case"JMP":n=!0;break;default:return this.name}if(n){if(this.name==="CALL"&&(yield*e.cpu.copyWordRegister("IP","id"),!(yield*e.cpu.pushToStack())))return!1;yield*e.cpu.copyWordRegister("ri","IP")}return!0}}class qX extends zo{*execute(e){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[],willUse:{}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},this.name==="CLI")yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield*e.cpu.updateFLAGS({IF:!1});else if(this.name==="STI")yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield*e.cpu.updateFLAGS({IF:!0});else if(this.name==="HLT")return yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield{type:"cpu:halt"},!1;return!0}}function Cl(t){switch(t){case"AL":return["AX","low"];case"AH":return["AX","high"];case"BL":return["BX","low"];case"BH":return["BX","high"];case"CL":return["CX","low"];case"CH":return["CX","high"];case"DL":return["DX","low"];case"DH":return["DX","high"];default:{const[e,n]=t.split(".");return[e,n==="l"?"low":n==="h"?"high":null]}}}function YX(t){switch(t){case"AX":return["AL","AH"];case"BX":return["BL","BH"];case"CX":return["CL","CH"];case"DX":return["DL","DH"];case"SP":return["SP.l","SP.h"];case"IP":return["IP.l","IP.h"];case"ri":return["ri.l","ri.h"];case"id":return["id.l","id.h"];case"left":return["left.l","left.h"];case"right":return["right.l","right.h"];case"result":return["result.l","result.h"];case"FLAGS":return["FLAGS.l","FLAGS.h"];default:return[t,null]}}var Yv,xj;class JX extends zo{constructor(){super(...arguments);Re(this,Yv)}get operation(){return this.statement.operation}*execute(n){const{mode:i,size:r,out:s,src:o}=this.operation;switch(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:gt(this,Yv,xj).call(this),willUse:{ri:i==="reg<-mem"||i==="mem<-reg"||i==="mem<-imd",id:i==="reg<-mem"||i==="reg<-imd"||i==="mem<-imd"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},(this.operation.mode==="reg<-mem"||this.operation.mode==="mem<-reg"||this.operation.mode==="mem<-imd")&&((this.operation.mode==="reg<-mem"?this.operation.src.mode:this.operation.out.mode)==="direct"?yield*super.consumeInstruction(n,"ri.l"):yield*n.cpu.copyWordRegister("BX","ri")),(this.operation.mode==="reg<-imd"||this.operation.mode==="mem<-imd")&&(yield*super.consumeInstruction(n,"id.l"),this.operation.size===16&&(yield*super.consumeInstruction(n,"id.h"))),yield{type:"cpu:cycle.update",phase:"writeback"},i){case"reg<-reg":return r===8?yield*n.cpu.copyByteRegister(o,s):yield*n.cpu.copyWordRegister(o,s),!0;case"reg<-mem":return yield*n.cpu.setMAR("ri"),(yield*n.cpu.useBus("mem-read"))?(yield*n.cpu.getMBR("id.l"),r===16?yield*n.cpu.copyWordRegister("id",s):yield*n.cpu.copyByteRegister("id.l",s),yield*n.cpu.updateByteRegister("ri.h",I.zero(8)),!0):!1;case"reg<-imd":return r===8?yield*n.cpu.copyByteRegister("id.l",s):yield*n.cpu.copyWordRegister("id",s),!0;case"mem<-reg":{const[a]=YX(o);return yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR(a),!!(yield*n.cpu.useBus("mem-write"))}case"mem<-imd":return yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("id.l"),!(!(yield*n.cpu.useBus("mem-write"))||r===16&&(yield*n.cpu.updateWordRegister("ri",a=>a.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("id.h"),!(yield*n.cpu.useBus("mem-write"))));default:return i}}}Yv=new WeakSet,xj=function(){const{mode:n,out:i,src:r}=this.operation;switch(n){case"reg<-reg":return[i,r];case"reg<-mem":{const s=r.mode==="direct"?r.address.toString():"BX";return[i,`[${s}]`]}case"reg<-imd":return[i,`${r.toString("hex")}h`];case"mem<-reg":return[`[${i.mode==="direct"?i.address.toString():"BX"}]`,r];case"mem<-imd":return[`[${i.mode==="direct"?i.address.toString():"BX"}]`,`${r.toString("hex")}h`];default:return n}};class ZX extends zo{*execute(e){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[],willUse:{id:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},!(yield*e.cpu.popFromStack()))return!1;if(yield*e.cpu.copyWordRegister("id","IP"),this.name==="IRET"){if(!(yield*e.cpu.popFromStack()))return!1;yield*e.cpu.copyWordRegister("id","FLAGS")}return!0}}class QX extends zo{*execute(e){const n=this.statement.instruction==="PUSH"||this.statement.instruction==="POP"?this.statement.register:"FLAGS";return yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:n!=="FLAGS"?[n]:[],willUse:{id:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},this.name==="PUSH"||this.name==="PUSHF"?(yield*e.cpu.copyWordRegister(n,"id"),yield*e.cpu.pushToStack()):(yield*e.cpu.popFromStack())?(yield*e.cpu.copyWordRegister("id",n),!0):!1}}function eq(t){switch(t.instruction){case"MOV":return new JX(t);case"AND":case"OR":case"XOR":case"ADD":case"ADC":case"SUB":case"SBB":case"CMP":return new HX(t);case"NOT":case"NEG":case"INC":case"DEC":return new WX(t);case"IN":case"OUT":return new KX(t);case"PUSH":case"POP":case"PUSHF":case"POPF":return new QX(t);case"JC":case"JNC":case"JZ":case"JNZ":case"JS":case"JNS":case"JO":case"JNO":case"JMP":case"CALL":return new XX(t);case"RET":case"IRET":return new ZX(t);case"INT":return new GX(t);case"CLI":case"STI":case"NOP":case"HLT":return new qX(t)}}function tq(t){for(const[e,n]of s_)if(n.unsigned===t.unsigned)return e;return null}function*nq(t,e){switch(e){case 0:return yield{type:"cpu:int.0"},!1;case 3:{yield{type:"cpu:int.3"};break}case 6:{if(yield{type:"cpu:int.6"},!("keyboard"in t.io))return yield{type:"cpu:error",error:new Ze("device-not-connected","keyboard")},!1;yield*t.cpu.copyWordRegister("BX","ri");const n=yield*t.io.keyboard.readChar();if(yield*t.cpu.updateWordRegister("id",n.withHigh(I.zero(8))),yield*t.cpu.setMAR("ri"),yield*t.cpu.setMBR("id.l"),!(yield*t.cpu.useBus("mem-write")))return!1;break}case 7:{if(yield{type:"cpu:int.7"},!("screen"in t.io))return yield{type:"cpu:error",error:new Ze("device-not-connected","screen")},!1;if(yield*t.cpu.copyWordRegister("AX","id"),!(yield*t.cpu.pushToStack())||(yield*t.cpu.copyWordRegister("BX","id"),!(yield*t.cpu.pushToStack())))return!1;yield*t.cpu.copyByteRegister("AL","left.l"),yield*t.cpu.updateByteRegister("right.l",I.zero(8));const n=t.cpu.getRegister("AL");for(yield*t.cpu.aluExecute("SUB",n,{CF:!1,OF:!1,SF:n.signed<0,ZF:n.isZero()});!t.cpu.getRegister("AL").isZero();){if(yield*t.cpu.copyWordRegister("BX","ri"),yield*t.cpu.setMAR("ri"),!(yield*t.cpu.useBus("mem-read")))return!1;yield*t.cpu.getMBR("id.l");const i=t.cpu.getRegister("id.l");yield*t.io.screen.sendChar(i),yield*t.cpu.copyWordRegister("BX","left"),yield*t.cpu.updateWordRegister("right",I.fromUnsigned(1,16));const r=t.cpu.getRegister("BX").add(1);yield*t.cpu.aluExecute("ADD",r,{CF:!1,OF:r.signed<0,SF:r.signed<0,ZF:!1}),yield*t.cpu.copyWordRegister("result","BX"),yield*t.cpu.copyByteRegister("AL","left.l"),yield*t.cpu.updateByteRegister("right.l",I.fromUnsigned(1,8));const s=t.cpu.getRegister("AL").add(-1);yield*t.cpu.aluExecute("SUB",s,{CF:!1,OF:s.signed===I.maxSignedValue(8),SF:s.signed<0,ZF:s.isZero()}),yield*t.cpu.copyByteRegister("result.l","AL")}if(!(yield*t.cpu.popFromStack())||(yield*t.cpu.copyWordRegister("id","BX"),!(yield*t.cpu.popFromStack())))return!1;yield*t.cpu.copyWordRegister("id","AX");break}default:throw new Error("Invalid interrupt number")}return!(yield*t.cpu.popFromStack())||(yield*t.cpu.copyWordRegister("id","IP"),!(yield*t.cpu.popFromStack()))?!1:(yield*t.cpu.copyWordRegister("id","FLAGS"),!0)}var bc,ze,Ii,Xn,Yt,Eu,ir,uN;let iq=(uN=class extends ci{constructor(n){super(n);Re(this,Yt);Re(this,bc);Re(this,ze);Re(this,Ii);Re(this,Xn);n.data==="unchanged"?(Y(this,ze,C(n.previous.cpu,ze)),Y(this,Ii,C(n.previous.cpu,Ii)),Y(this,Xn,C(n.previous.cpu,Xn))):n.data==="randomize"?(Y(this,ze,{AX:I.random(16),BX:I.random(16),CX:I.random(16),DX:I.random(16),SP:I.random(16),IP:I.random(16),IR:I.random(8),ri:I.random(16),id:I.random(16),left:I.random(16),right:I.random(16),result:I.random(16),FLAGS:I.random(16)}),Y(this,Ii,I.random(16)),Y(this,Xn,I.random(8))):(Y(this,ze,{AX:I.zero(16),BX:I.zero(16),CX:I.zero(16),DX:I.zero(16),SP:I.zero(16),IP:I.zero(16),IR:I.zero(8),ri:I.zero(16),id:I.zero(16),left:I.zero(16),right:I.zero(16),result:I.zero(16),FLAGS:I.zero(16)}),Y(this,Ii,I.zero(16)),Y(this,Xn,I.zero(8))),C(this,ze).SP=I.fromUnsigned(ye.MAX_ADDRESS+1,16),C(this,ze).IP=I.fromUnsigned(32,16),C(this,ze).ri=I.fromUnsigned(0,16),C(this,ze).id=I.fromUnsigned(0,16),gt(this,Yt,ir).call(this,"IF",!0),Y(this,bc,new Map);for(const i of n.program.instructions){const r=eq(i);C(this,bc).set(r.start.value,r)}}*run(){for(;;){const n=C(this,ze).IP,i=tq(n);if(i!==null){if(!(yield*nq(this.computer,i)))return}else{const r=C(this,bc).get(n.unsigned);if(!r){yield{type:"cpu:error",error:new Ze("no-instruction",C(this,ze).IP)};return}if(!(yield*r.execute(this.computer)))return}if(this.getFlag("IF")&&"pic"in this.computer.io&&this.computer.io.pic.isINTRActive()){yield{type:"cpu:cycle.interrupt"};const r=yield*this.computer.io.pic.handleINTR();yield*this.getMBR("ri.l"),yield*this.updateByteRegister("ri.h",I.zero(8)),yield*this.startInterrupt(r)}yield{type:"cpu:cycle.end"}}}*startInterrupt(n){if(yield*this.copyWordRegister("FLAGS","id"),!(yield*this.pushToStack())||(yield*this.updateFLAGS({IF:!1}),yield*this.copyWordRegister("IP","id"),!(yield*this.pushToStack())))return!1;let i=I.fromUnsigned(n.unsigned*4,16);return yield*this.updateWordRegister("ri",i),yield*this.setMAR("ri"),!(yield*this.useBus("mem-read"))||(yield*this.getMBR("id.l"),i=i.add(1),yield*this.updateWordRegister("ri",i),yield*this.setMAR("ri"),!(yield*this.useBus("mem-read")))?!1:(yield*this.getMBR("id.h"),yield*this.copyWordRegister("id","IP"),!0)}toJSON(){return{...Object.entries(C(this,ze)).reduce((i,[r,s])=>({...i,[r]:s.toJSON()}),{}),MAR:C(this,Ii).toJSON(),MBR:C(this,Xn).toJSON()}}getRegister(n){const[i,r]=Cl(n);return r==="low"?C(this,ze)[i].low:r==="high"?C(this,ze)[i].high:C(this,ze)[i]}*copyByteRegister(n,i){const r=this.getRegister(n);gt(this,Yt,Eu).call(this,i,r),yield{type:"cpu:register.copy",size:8,src:n,dest:i}}*copyWordRegister(n,i){const r=this.getRegister(n);gt(this,Yt,Eu).call(this,i,r.withHigh(I.zero(8))),yield{type:"cpu:register.copy",size:16,src:n,dest:i}}*updateByteRegister(n,i){i=typeof i=="function"?i(this.getRegister(n)):i,gt(this,Yt,Eu).call(this,n,i),yield{type:"cpu:register.update",size:8,register:n,value:i}}*updateWordRegister(n,i){i=typeof i=="function"?i(this.getRegister(n)):i,gt(this,Yt,Eu).call(this,n,i),yield{type:"cpu:register.update",size:16,register:n,value:i}}getFlag(n){switch(n){case"CF":return C(this,ze).FLAGS.bit(0);case"ZF":return C(this,ze).FLAGS.bit(6);case"SF":return C(this,ze).FLAGS.bit(7);case"IF":return C(this,ze).FLAGS.bit(9);case"OF":return C(this,ze).FLAGS.bit(11);default:throw new TypeError(`Invalid flag ${n}`)}}*updateFLAGS(n){typeof n.CF=="boolean"&&gt(this,Yt,ir).call(this,"CF",n.CF),typeof n.ZF=="boolean"&&gt(this,Yt,ir).call(this,"ZF",n.ZF),typeof n.SF=="boolean"&&gt(this,Yt,ir).call(this,"SF",n.SF),typeof n.IF=="boolean"&&gt(this,Yt,ir).call(this,"IF",n.IF),typeof n.OF=="boolean"&&gt(this,Yt,ir).call(this,"OF",n.OF),yield{type:"cpu:register.update",size:16,register:"FLAGS",value:C(this,ze).FLAGS}}*aluExecute(n,i,r){C(this,ze).result=i.is8bits()?C(this,ze).result.withLow(i):i,typeof r.CF=="boolean"&&gt(this,Yt,ir).call(this,"CF",r.CF),typeof r.ZF=="boolean"&&gt(this,Yt,ir).call(this,"ZF",r.ZF),typeof r.SF=="boolean"&&gt(this,Yt,ir).call(this,"SF",r.SF),typeof r.IF=="boolean"&&gt(this,Yt,ir).call(this,"IF",r.IF),typeof r.OF=="boolean"&&gt(this,Yt,ir).call(this,"OF",r.OF),yield{type:"cpu:alu.execute",operation:n,size:i.size,result:C(this,ze).result,flags:C(this,ze).FLAGS}}*setMAR(n){const i=this.getRegister(n);Y(this,Ii,i.withHigh(I.zero(8))),yield{type:"cpu:mar.set",register:n}}*getMBR(n){gt(this,Yt,Eu).call(this,n,C(this,Xn)),yield{type:"cpu:mbr.get",register:n}}*setMBR(n){const i=this.getRegister(n);Y(this,Xn,i),yield{type:"cpu:mbr.set",register:n}}*useBus(n){switch(n){case"mem-read":{yield{type:"cpu:rd.on"};const i=yield*this.computer.memory.read(C(this,Ii));return i?(Y(this,Xn,i),yield{type:"bus:reset"},!0):!1}case"mem-write":return yield{type:"cpu:wr.on"},(yield*this.computer.memory.write(C(this,Ii),C(this,Xn)))?(yield{type:"bus:reset"},!0):!1;case"io-read":{yield{type:"cpu:iom.on"};const i=yield*this.computer.io.chipSelect(C(this,Ii).low);if(!i)return!1;yield{type:"cpu:rd.on"};const r=yield*this.computer.io.read(i);return r?(Y(this,Xn,r),yield{type:"bus:reset"},!0):!1}case"io-write":{yield{type:"cpu:iom.on"};const i=yield*this.computer.io.chipSelect(C(this,Ii).low);return!i||(yield{type:"cpu:wr.on"},!(yield*this.computer.io.write(i,C(this,Xn))))?!1:(yield{type:"bus:reset"},!0)}case"intr-read":{if(!("pic"in this.computer.io))return!1;const i=yield*this.computer.io.pic.handleINTR();return Y(this,Xn,i),yield{type:"bus:reset"},!0}default:return n}}*pushToStack(){let n=this.getRegister("SP");return ye.inRange(n.unsigned-1)?(n=n.add(-1),yield*this.updateWordRegister("SP",n),yield*this.setMAR("SP"),yield*this.setMBR("id.h"),(yield*this.useBus("mem-write"))?ye.inRange(n.unsigned-1)?(n=n.add(-1),yield*this.updateWordRegister("SP",n),yield*this.setMAR("SP"),yield*this.setMBR("id.l"),!!(yield*this.useBus("mem-write"))):(yield{type:"cpu:error",error:new Ze("stack-overflow")},!1):!1):(yield{type:"cpu:error",error:new Ze("stack-overflow")},!1)}*popFromStack(){let n=this.getRegister("SP");return ye.inRange(n)?(yield*this.setMAR("SP"),(yield*this.useBus("mem-read"))?(yield*this.getMBR("id.l"),n=n.add(1),yield*this.updateWordRegister("SP",n),ye.inRange(n)?(yield*this.setMAR("SP"),(yield*this.useBus("mem-read"))?(yield*this.getMBR("id.h"),n=n.add(1),yield*this.updateWordRegister("SP",n),!0):!1):(yield{type:"cpu:error",error:new Ze("stack-underflow")},!0)):!1):(yield{type:"cpu:error",error:new Ze("stack-underflow")},!1)}},bc=new WeakMap,ze=new WeakMap,Ii=new WeakMap,Xn=new WeakMap,Yt=new WeakSet,Eu=function(n,i){const[r,s]=Cl(n);if(s===null){if(C(this,ze)[r].size!==i.size)throw new TypeError(`Cannot set register ${n} with value ${i} of different size`);C(this,ze)[r]=i}else{if(!i.is8bits())throw new TypeError(`Cannot set register ${n} with value ${i} of different size`);s==="low"?C(this,ze)[r]=C(this,ze)[r].withLow(i):C(this,ze)[r]=C(this,ze)[r].withHigh(i)}},ir=function(n,i){switch(n){case"CF":C(this,ze).FLAGS=C(this,ze).FLAGS.withBit(0,i);return;case"ZF":C(this,ze).FLAGS=C(this,ze).FLAGS.withBit(6,i);return;case"SF":C(this,ze).FLAGS=C(this,ze).FLAGS.withBit(7,i);return;case"IF":C(this,ze).FLAGS=C(this,ze).FLAGS.withBit(9,i);return;case"OF":C(this,ze).FLAGS=C(this,ze).FLAGS.withBit(11,i);return;default:throw new TypeError(`Invalid flag ${n}`)}},uN),u_=class extends ci{*tick(){yield{type:"clock:tick"},yield*this.computer.io.timer.tick()}toJSON(){return null}},c_=class extends ci{*press(){yield{type:"f10:press"},yield*this.computer.io.pic.interrupt(0)}toJSON(){return null}};var xc,cN;let Iy=(cN=class extends ci{constructor(){super(...arguments);Re(this,xc,null)}*readChar(){yield{type:"keyboard:listen-key"};const n=C(this,xc);if(!n)throw new Error("INT 6 was not given a valid 8-bit character!");return yield{type:"keyboard:read",char:n},Y(this,xc,null),n}setLastCharRead(n){Y(this,xc,n)}toJSON(){return null}},xc=new WeakMap,cN);var Li,dN;let Ly=(dN=class extends ci{constructor(n){super(n);Re(this,Li);n.data==="unchanged"&&"screen"in n.previous.io?Y(this,Li,C(n.previous.io.screen,Li)):Y(this,Li,"")}clear(){return this.sendChar(I.fromUnsigned(12,8))}*sendChar(n){switch(n.unsigned){case 8:Y(this,Li,C(this,Li).slice(0,-1));break;case 10:Y(this,Li,C(this,Li)+`
`);break;case 12:Y(this,Li,"");break;default:Y(this,Li,C(this,Li)+r_(n.unsigned));break}yield{type:"screen:send-char",char:n,output:C(this,Li)}}toJSON(){return C(this,Li)}},Li=new WeakMap,dN);class jy extends ci{}var Gr,co,mi,qn,Fr,Fs,ug,cg;let d_=(Gr=class extends jy{constructor(n){super(n);Re(this,Fs);Re(this,co);Re(this,mi);Re(this,qn);Re(this,Fr);Y(this,co,I.fromUnsigned(255,8)),Y(this,mi,I.fromUnsigned(0,8)),Y(this,qn,I.fromUnsigned(0,8)),n.data==="unchanged"&&"pic"in n.previous.io?Y(this,Fr,C(n.previous.io.pic,Fr)):n.data==="randomize"?Y(this,Fr,new Array(Gr.LINES).fill(I.zero(8)).map(()=>I.random(8))):Y(this,Fr,new Array(Gr.LINES).fill(I.zero(8)))}chipSelect(n){const r=4+Gr.LINES;return n=Number(n)-32,n<0||n>=r?null:n===0?"EOI":n===1?"IMR":n===2?"IRR":n===3?"ISR":`INT${n-4}`}*read(n){yield{type:"pic:read",register:n};let i;if(n==="EOI")i=I.zero(8);else if(n==="IMR")i=C(this,co);else if(n==="IRR")i=C(this,mi);else if(n==="ISR")i=C(this,qn);else{const r=Number(n.slice(3));i=C(this,Fr)[r]}return yield{type:"pic:read.ok",value:i},i}*write(n,i){if(yield{type:"pic:write",register:n,value:i},n==="EOI")C(this,qn).isZero()||(yield{type:"pic:intr.off"},Y(this,qn,I.zero(8)),yield{type:"pic:register.update",register:"ISR",value:C(this,qn)},yield*gt(this,Fs,cg).call(this));else if(n==="IMR")Y(this,co,i),yield{type:"pic:register.update",register:"IMR",value:C(this,co)},yield*gt(this,Fs,cg).call(this);else if(!(n==="IRR"||n==="ISR")){const r=Number(n.slice(3));C(this,Fr)[r]=i,yield{type:"pic:register.update",register:n,value:i}}yield{type:"pic:write.ok"}}*interrupt(n){if(n<0||n>=Gr.LINES)throw new RangeError(`Invalid interrupt line ${n}`);C(this,mi).bit(n)||(Y(this,mi,C(this,mi).withBit(n,!0)),yield{type:"pic:register.update",register:"IRR",value:C(this,mi)},yield*gt(this,Fs,cg).call(this))}isINTRActive(){return C(this,qn).isZero()&&gt(this,Fs,ug).call(this)!==null}*handleINTR(){if(yield{type:"cpu:inta.on"},!C(this,qn).isZero())throw new Error("INTR line is active but ISR is not zero");const n=gt(this,Fs,ug).call(this);if(n===null)throw new Error("INTR line is active but no interrupt is pending");Y(this,qn,C(this,qn).withBit(n,!0)),yield{type:"pic:register.update",register:"ISR",value:C(this,qn)},Y(this,mi,C(this,mi).withBit(n,!1)),yield{type:"pic:register.update",register:"IRR",value:C(this,mi)},yield{type:"cpu:inta.off"},yield{type:"cpu:inta.on"};const i=C(this,Fr)[n];return yield{type:"pic:int.send",number:i},yield{type:"cpu:inta.off"},yield{type:"pic:intr.off"},i}toJSON(){return{IMR:C(this,co).toJSON(),IRR:C(this,mi).toJSON(),ISR:C(this,qn).toJSON(),lines:C(this,Fr).map(n=>n.toJSON())}}},co=new WeakMap,mi=new WeakMap,qn=new WeakMap,Fr=new WeakMap,Fs=new WeakSet,ug=function(){for(let n=0;n<Gr.LINES;n++)if(C(this,mi).bit(n)&&!C(this,co).bit(n))return n;return null},cg=function*(){C(this,qn).isZero()&&gt(this,Fs,ug).call(this)!==null&&(yield{type:"pic:intr.on"})},oe(Gr,"LINES",8),Gr);var Ss,ua,hN;let h_=(hN=class extends jy{constructor(n){super(n);Re(this,Ss);Re(this,ua);Y(this,Ss,I.zero(8)),Y(this,ua,I.zero(8))}chipSelect(n){return n=Number(n),n===16?"CONT":n===17?"COMP":null}*read(n){yield{type:"timer:read",register:n};let i;if(n==="CONT")i=C(this,Ss);else if(n==="COMP")i=C(this,ua);else return n;return yield{type:"timer:read.ok",value:i},i}*write(n,i){if(yield{type:"timer:write",register:n,value:i},n==="CONT")Y(this,Ss,i);else if(n==="COMP")Y(this,ua,i);else return n;yield{type:"timer:register.update",register:n,value:i},yield{type:"timer:write.ok"}}*tick(){const n=C(this,Ss).unsigned===I.maxValue(8)?I.zero(8):C(this,Ss).add(1);Y(this,Ss,n),yield{type:"timer:register.update",register:"CONT",value:n},C(this,ua).equals(n)?(yield{type:"timer:int.on"},yield*this.computer.io.pic.interrupt(1)):yield{type:"timer:int.off"}}toJSON(){return{CONT:C(this,Ss).toJSON(),COMP:C(this,ua).toJSON()}}},Ss=new WeakMap,ua=new WeakMap,hN);var ks,Yn,fN;let rq=(fN=class extends jy{constructor(n){super(n);Re(this,ks);Re(this,Yn);n.data==="unchanged"&&"handshake"in n.previous.io?Y(this,ks,I.zero(8)):n.data==="randomize"?Y(this,ks,I.random(8)):Y(this,ks,I.zero(8)),Y(this,Yn,I.zero(8))}get interrupts(){return C(this,Yn).bit(7)}get DATA(){return C(this,ks)}chipSelect(n){return n=Number(n),n===64?"DATA":n===65?"STATE":null}*read(n){yield{type:"handshake:read",register:n};let i;if(n==="DATA")i=C(this,ks);else if(n==="STATE")i=C(this,Yn);else return n;return yield{type:"handshake:read.ok",value:i},i}*write(n,i){if(yield{type:"handshake:write",register:n,value:i},n==="DATA")Y(this,ks,i),yield{type:"handshake:register.update",register:n,value:i},yield*this.computer.io.printer.setStrobe(!0),yield*this.computer.io.printer.setStrobe(!1);else if(n==="STATE")i=i.withBit(0,this.computer.io.printer.busy),Y(this,Yn,i),yield{type:"handshake:register.update",register:n,value:i},C(this,Yn).bit(1)?(yield*this.computer.io.printer.setStrobe(!0),yield*this.computer.io.printer.setStrobe(!1),Y(this,Yn,C(this,Yn).withBit(1,!1)),yield{type:"handshake:register.update",register:n,value:C(this,Yn)}):this.interrupts&&!this.computer.io.printer.busy?(yield{type:"handshake:int.on"},yield*this.computer.io.pic.interrupt(2)):yield{type:"handshake:int.off"};else return n;yield{type:"handshake:write.ok"}}*updateBusy(n){Y(this,Yn,C(this,Yn).withBit(0,n)),yield{type:"handshake:register.update",register:"STATE",value:C(this,Yn)},this.interrupts&&!n?(yield{type:"handshake:int.on"},yield*this.computer.io.pic.interrupt(2)):yield{type:"handshake:int.off"}}toJSON(){return{DATA:C(this,ks).toJSON(),STATE:C(this,Yn).toJSON()}}},ks=new WeakMap,Yn=new WeakMap,fN);var sr,ho,ca;const Ah=class Ah extends ci{constructor(n){super(n);Re(this,sr);Re(this,ho);Re(this,ca,!1);this.computer=n.computer,n.data==="unchanged"&&"printer"in n.previous.io?(Y(this,sr,C(n.previous.io.printer,sr)),Y(this,ho,C(n.previous.io.printer,ho)),Y(this,ca,C(n.previous.io.printer,ca))):(Y(this,sr,[]),Y(this,ho,""),Y(this,ca,!1))}get busy(){return C(this,sr).length>=Ah.BUFFER_SIZE}*setStrobe(n){const i=C(this,ca);if(i===n)return;if(Y(this,ca,n),n?yield{type:"printer:strobe.on"}:yield{type:"printer:strobe.off"},n&&!i&&!this.busy){const s=yield*this.readData();C(this,sr).push(s),yield{type:"printer:buffer.add",char:s},yield*this.updateBusy(!0),this.busy||(yield*this.updateBusy(!1))}}*clear(){Y(this,ho,""),yield{type:"printer:paper.replace"}}*print(){if(C(this,sr).length===0)return;const[n,...i]=C(this,sr);if(Y(this,sr,i),yield{type:"printer:buffer.pop",char:n},i.length===Ah.BUFFER_SIZE-1&&(yield*this.updateBusy(!1)),n.unsigned===12)yield*this.clear();else{const r=r_(n.unsigned);Y(this,ho,C(this,ho)+r),yield{type:"printer:paper.print",char:r}}}toJSON(){return{paper:C(this,ho),buffer:[...C(this,sr).map(n=>n.unsigned)]}}};sr=new WeakMap,ho=new WeakMap,ca=new WeakMap,oe(Ah,"BUFFER_SIZE",5);let Cv=Ah,sq=class extends Cv{*readData(){const e=this.computer.io.handshake.DATA;return yield{type:"printer:data.read",char:e},e}*updateBusy(e){e?yield{type:"printer:busy.on"}:yield{type:"printer:busy.off"},yield*this.computer.io.handshake.updateBusy(e)}},oq=class extends ci{constructor(n){super(n);oe(this,"clock");oe(this,"f10");oe(this,"keyboard");oe(this,"printer");oe(this,"screen");oe(this,"handshake");oe(this,"pic");oe(this,"timer");this.clock=new u_(n),this.f10=new c_(n),this.keyboard=new Iy(n),this.printer=new sq(n),this.screen=new Ly(n),this.handshake=new rq(n),this.pic=new d_(n),this.timer=new h_(n)}*chipSelect(n){const i=this.handshake.chipSelect(n);if(i)return yield{type:"bus:io.selected",chip:"handshake"},{chip:"handshake",register:i};const r=this.pic.chipSelect(n);if(r)return yield{type:"bus:io.selected",chip:"pic"},{chip:"pic",register:r};const s=this.timer.chipSelect(n);return s?(yield{type:"bus:io.selected",chip:"timer"},{chip:"timer",register:s}):(yield{type:"bus:io.error",error:new Ze("io-memory-not-connected",n)},null)}*read(n){const{chip:i,register:r}=n;return i==="handshake"?yield*this.handshake.read(r):i==="pic"?yield*this.pic.read(r):i==="timer"?yield*this.timer.read(r):(yield{type:"bus:io.error",error:new Ze("device-not-connected",i)},null)}*write(n,i){const{chip:r,register:s}=n;return r==="handshake"?(yield*this.handshake.write(s,i),!0):r==="pic"?(yield*this.pic.write(s,i),!0):r==="timer"?(yield*this.timer.write(s,i),!0):(yield{type:"bus:io.error",error:new Ze("device-not-connected",r)},!1)}toJSON(){return{clock:this.clock.toJSON(),f10:this.f10.toJSON(),keyboard:this.keyboard.toJSON(),printer:this.printer.toJSON(),screen:this.screen.toJSON(),handshake:this.handshake.toJSON(),pic:this.pic.toJSON(),timer:this.timer.toJSON()}}};class aq extends ci{constructor(n){super(n);oe(this,"keyboard");oe(this,"screen");this.keyboard=new Iy(n),this.screen=new Ly(n)}*chipSelect(n){return yield{type:"bus:io.error",error:new Ze("io-memory-not-connected",n)},null}*read(n){return yield{type:"bus:io.error",error:new Ze("device-not-connected",n.chip)},null}*write(n){return yield{type:"bus:io.error",error:new Ze("device-not-connected",n.chip)},!1}toJSON(){return{keyboard:this.keyboard.toJSON(),screen:this.screen.toJSON()}}}class lq extends ci{*chipSelect(e){return yield{type:"bus:io.error",error:new Ze("io-memory-not-connected",e)},null}*read(e){return yield{type:"bus:io.error",error:new Ze("device-not-connected",e.chip)},null}*write(e){return yield{type:"bus:io.error",error:new Ze("device-not-connected",e.chip)},!1}toJSON(){return{}}}class Sj extends jy{constructor(n){super(n);oe(this,"PA");oe(this,"PB");oe(this,"CA");oe(this,"CB");n.data==="unchanged"&&"pio"in n.previous.io?(this.PA=n.previous.io.pio.PA,this.PB=n.previous.io.pio.PB,this.CA=n.previous.io.pio.CA,this.CB=n.previous.io.pio.CB):n.data==="randomize"?(this.PA=I.random(8),this.PB=I.random(8),this.CA=I.random(8),this.CB=I.random(8)):(this.PA=I.zero(8),this.PB=I.zero(8),this.CA=I.zero(8),this.CB=I.zero(8))}chipSelect(n){return n=Number(n),n===48?"PA":n===49?"PB":n===50?"CA":n===51?"CB":null}*read(n){yield{type:"pio:read",register:n};let i;if(n==="PA")i=this.PA;else if(n==="PB")i=this.PB;else if(n==="CA")i=this.CA;else if(n==="CB")i=this.CB;else return n;return yield{type:"pio:read.ok",value:i},i}*write(n,i){if(yield{type:"pio:write",register:n,value:i},n==="PA")this.PA=i;else if(n==="PB")this.PB=i;else if(n==="CA")this.CA=i;else if(n==="CB")this.CB=i;else return n;yield{type:"pio:register.update",register:n,value:i},n==="PA"||n==="CA"?yield*this.updatePort("A"):yield*this.updatePort("B"),yield{type:"pio:write.ok"}}line(n,i){return n==="A"?this.CA.bit(i)?"input":"output":this.CB.bit(i)?"input":"output"}toJSON(){return{PA:this.PA.toJSON(),PB:this.PB.toJSON(),CA:this.CA.toJSON(),CB:this.CB.toJSON()}}}let uq=class extends Sj{constructor(e){super(e),this.PA=this.PA.withBit(1,!1)}readData(){const e=this.PB.unsigned&~this.CB.unsigned;return I.fromUnsigned(e,8)}*updatePort(e){if(e==="B")return;let n=this.PA.unsigned;const i=this.CA.unsigned,r=this.computer.io.printer.busy;n=n&~i,this.line("A",0)==="input"&&r&&(n|=1),n!==this.PA.unsigned&&(this.PA=I.fromUnsigned(n,8),yield{type:"pio:register.update",register:"PA",value:this.PA}),this.line("A",1)==="output"&&(yield*this.computer.io.printer.setStrobe(this.PA.bit(1)))}},cq=class extends Cv{*readData(){const e=this.computer.io.pio.readData();return yield{type:"printer:data.read",char:e},e}*updateBusy(e){e?yield{type:"printer:busy.on"}:yield{type:"printer:busy.off"},yield*this.computer.io.pio.updatePort("A")}};class dq extends ci{constructor(n){super(n);oe(this,"clock");oe(this,"f10");oe(this,"keyboard");oe(this,"printer");oe(this,"screen");oe(this,"pic");oe(this,"pio");oe(this,"timer");this.clock=new u_(n),this.f10=new c_(n),this.keyboard=new Iy(n),this.printer=new cq(n),this.screen=new Ly(n),this.pic=new d_(n),this.pio=new uq(n),this.timer=new h_(n)}*chipSelect(n){const i=this.pic.chipSelect(n);if(i)return yield{type:"bus:io.selected",chip:"pic"},{chip:"pic",register:i};const r=this.pio.chipSelect(n);if(r)return yield{type:"bus:io.selected",chip:"pio"},{chip:"pio",register:r};const s=this.timer.chipSelect(n);return s?(yield{type:"bus:io.selected",chip:"timer"},{chip:"timer",register:s}):(yield{type:"bus:io.error",error:new Ze("io-memory-not-connected",n)},null)}*read(n){const{chip:i,register:r}=n;return i==="pic"?yield*this.pic.read(r):i==="pio"?yield*this.pio.read(r):i==="timer"?yield*this.timer.read(r):(yield{type:"bus:io.error",error:new Ze("device-not-connected",i)},null)}*write(n,i){const{chip:r,register:s}=n;return r==="pic"?(yield*this.pic.write(s,i),!0):r==="pio"?(yield*this.pio.write(s,i),!0):r==="timer"?(yield*this.timer.write(s,i),!0):(yield{type:"bus:io.error",error:new Ze("device-not-connected",r)},!1)}toJSON(){return{clock:this.clock.toJSON(),f10:this.f10.toJSON(),keyboard:this.keyboard.toJSON(),printer:this.printer.toJSON(),screen:this.screen.toJSON(),pic:this.pic.toJSON(),pio:this.pio.toJSON(),timer:this.timer.toJSON()}}}var fo,pN;let hq=(pN=class extends ci{constructor(n){super(n);Re(this,fo);n.data==="unchanged"&&"leds"in n.previous.io?Y(this,fo,C(n.previous.io.leds,fo)):n.data==="randomize"?Y(this,fo,I.random(8)):Y(this,fo,I.zero(8))}get state(){return C(this,fo)}*update(n){yield{type:"leds:update",state:n}}toJSON(){return C(this,fo).toJSON()}},fo=new WeakMap,pN),fq=class extends Sj{*updatePort(e){if(e==="A"){const n=this.computer.io.switches.state.unsigned;let i=this.PA.unsigned;const r=this.CA.unsigned;i=n&r|i&~r,i!==this.PA.unsigned&&(this.PA=I.fromUnsigned(i,8),yield{type:"pio:register.update",register:"PA",value:this.PA})}else{let n=this.PB.unsigned;const i=this.CB.unsigned;n=n&~i,yield*this.computer.io.leds.update(I.fromUnsigned(n,8))}}};var or,mN;let pq=(mN=class extends ci{constructor(n){super(n);Re(this,or);this.computer=n.computer,n.data==="unchanged"&&"switches"in n.previous.io?Y(this,or,C(n.previous.io.switches,or)):n.data==="randomize"?Y(this,or,I.random(8)):Y(this,or,I.zero(8))}get state(){return C(this,or)}*toggle(n){Y(this,or,C(this,or).withBit(n,!C(this,or).bit(n))),yield{type:"switches:toggle",index:n},yield*this.computer.io.pio.updatePort("A")}toJSON(){return C(this,or).toJSON()}},or=new WeakMap,mN);class mq extends ci{constructor(n){super(n);oe(this,"clock");oe(this,"f10");oe(this,"keyboard");oe(this,"leds");oe(this,"screen");oe(this,"switches");oe(this,"pic");oe(this,"pio");oe(this,"timer");this.clock=new u_(n),this.f10=new c_(n),this.keyboard=new Iy(n),this.leds=new hq(n),this.screen=new Ly(n),this.switches=new pq(n),this.pic=new d_(n),this.pio=new fq(n),this.timer=new h_(n)}*chipSelect(n){const i=this.pic.chipSelect(n);if(i)return yield{type:"bus:io.selected",chip:"pic"},{chip:"pic",register:i};const r=this.pio.chipSelect(n);if(r)return yield{type:"bus:io.selected",chip:"pio"},{chip:"pio",register:r};const s=this.timer.chipSelect(n);return s?(yield{type:"bus:io.selected",chip:"timer"},{chip:"timer",register:s}):(yield{type:"bus:io.error",error:new Ze("io-memory-not-connected",n)},null)}*read(n){const{chip:i,register:r}=n;return i==="pic"?yield*this.pic.read(r):i==="pio"?yield*this.pio.read(r):i==="timer"?yield*this.timer.read(r):(yield{type:"bus:io.error",error:new Ze("device-not-connected",i)},null)}*write(n,i){const{chip:r,register:s}=n;return r==="pic"?(yield*this.pic.write(s,i),!0):r==="pio"?(yield*this.pio.write(s,i),!0):r==="timer"?(yield*this.timer.write(s,i),!0):(yield{type:"bus:io.error",error:new Ze("device-not-connected",r)},!1)}toJSON(){return{clock:this.clock.toJSON(),f10:this.f10.toJSON(),keyboard:this.keyboard.toJSON(),leds:this.leds.toJSON(),screen:this.screen.toJSON(),switches:this.switches.toJSON(),pic:this.pic.toJSON(),pio:this.pio.toJSON(),timer:this.timer.toJSON()}}}var Sa,gi,Sc,po;let gq=(Sa=class extends ci{constructor(n){super(n);Re(this,gi);Re(this,Sc);Re(this,po);n.data==="unchanged"?Y(this,gi,C(n.previous.memory,gi)):n.data==="randomize"?Y(this,gi,new Uint8Array(Sa.SIZE).map(()=>I.random(8).unsigned)):Y(this,gi,new Uint8Array(Sa.SIZE)),Y(this,po,new Set);for(const[i,r]of s_){const s=i*4;C(this,gi).set(r.toUint8Array(),s),C(this,gi).set(I.zero(16).toUint8Array(),s+2),C(this,po).add(s),C(this,po).add(s+1),C(this,po).add(s+2),C(this,po).add(s+3)}for(const i of n.program.data){let r=i.start.value;for(const s of i.getValues())s!==Qd&&C(this,gi).set(s.toUint8Array(),r),r+=i.size/8}Y(this,Sc,new Set);for(const i of n.program.instructions){C(this,gi).set(i.toBytes(),i.start.value);for(let r=0;r<i.length;r++)C(this,Sc).add(i.start.value+r)}}*read(n){if(n=Number(n),yield{type:"memory:read",address:n},!ye.inRange(n))return yield{type:"memory:read.error",error:new Ze("address-out-of-range",n)},null;const i=I.fromUnsigned(C(this,gi).at(n),8);return yield{type:"memory:read.ok",address:ye.from(n),value:i},i}*write(n,i){return n=Number(n),yield{type:"memory:write",address:n,value:i},ye.inRange(n)?C(this,Sc).has(n)?(yield{type:"memory:write.error",error:new Ze("address-has-instruction",n)},!1):C(this,po).has(n)?(yield{type:"memory:write.error",error:new Ze("address-is-reserved",n)},!1):(C(this,gi).set([i.unsigned],n),yield{type:"memory:write.ok",address:ye.from(n),value:i},!0):(yield{type:"memory:write.error",error:new Ze("address-out-of-range",n)},!1)}toJSON(){return[...C(this,gi)]}},gi=new WeakMap,Sc=new WeakMap,po=new WeakMap,oe(Sa,"SIZE",ye.MAX_ADDRESS+1),Sa);class kT{constructor(e){oe(this,"cpu");oe(this,"memory");oe(this,"io");const n={computer:this,...e};switch(this.cpu=new iq(n),this.memory=new gq(n),e.devices){case"no-devices":{this.io=new lq(n);break}case"keyboard-and-screen":{this.io=new aq(n);break}case"pio-switches-and-leds":{this.io=new mq(n);break}case"pio-printer":{this.io=new dq(n);break}case"handshake":{this.io=new oq(n);break}default:{const i=e.devices;throw new Error(`Unknown devices configuration: ${i}`)}}}toJSON(){return{cpu:this.cpu.toJSON(),memory:this.memory.toJSON(),io:this.io.toJSON()}}}var ut;class vq{constructor(){Re(this,ut,new kT({program:{data:[],instructions:[]},devices:"pio-switches-and-leds",data:"clean"}))}loadProgram(e){Y(this,ut,new kT({...e,previous:C(this,ut)}))}getComputerState(){var e;return((e=C(this,ut))==null?void 0:e.toJSON())||null}startCPU(){if(!C(this,ut))throw new Ze("no-program");return C(this,ut).cpu.run()}get devices(){if(!C(this,ut))throw new Error("No computer loaded!");return{clock:{connected:()=>"clock"in C(this,ut).io,tick:()=>{if("clock"in C(this,ut).io)return C(this,ut).io.clock.tick();console.warn("Called clock.tick() when no clock was connected to the computer")}},f10:{connected:()=>"f10"in C(this,ut).io,press:()=>{if("f10"in C(this,ut).io)return C(this,ut).io.f10.press();console.warn("Called f10.press() when no f10 was connected to the computer")}},keyboard:{connected:()=>"keyboard"in C(this,ut).io,readChar:e=>{if("keyboard"in C(this,ut).io)return C(this,ut).io.keyboard.setLastCharRead(e);console.warn("Called keyboard.press() when no keyboard was connected to the computer")}},leds:{connected:()=>"leds"in C(this,ut).io},printer:{connected:()=>"printer"in C(this,ut).io,clear:()=>{if("printer"in C(this,ut).io)return C(this,ut).io.printer.clear();console.warn("No printer connected to the computer!")},print:()=>{if("printer"in C(this,ut).io)return C(this,ut).io.printer.print();console.warn("No printer connected to the computer!")}},screen:{connected:()=>"screen"in C(this,ut).io,clear:()=>{if("screen"in C(this,ut).io)return C(this,ut).io.screen.clear();console.warn("Called screen.clear() when no screen was connected to the computer")}},switches:{connected:()=>"switches"in C(this,ut).io,toggle:e=>{if("switches"in C(this,ut).io)return C(this,ut).io.switches.toggle(e);console.warn("Called switches.toggle() when no switches were connected to the computer")}}}}}ut=new WeakMap;const kj=new qf;function _j(t){window.codemirror&&window.codemirror.dispatch({effects:kj.reconfigure(Je.readOnly.of(t))})}const k1=Xe.define(),yq=li.define({create(){return Ge.none},update(t,e){let n=t.map(e.changes);for(const i of e.effects)i.is(k1)&&(n=Ge.none,i.value!==null&&(n=n.update({add:[wq.range(i.value)]})));return n},provide:t=>Pe.decorations.from(t)}),wq=Ge.line({class:"!bg-mantis-400/10"});function Cj(t){if(window.codemirror)if(t===null)window.codemirror.dispatch({effects:k1.of(null)});else{const e=window.codemirror.state.doc.lineAt(t).from;window.codemirror.dispatch({effects:k1.of(e)})}}const Ej=Qu.init("phc_Iq0zy6d8IRJY2ts0uHNWlSbectCsUgQK77MLj3ypSdM",{api_host:"https://us.posthog.com",autocapture:!1,capture_pageview:!0,persistence:"memory"})||Qu,bw=Ae(I.zero(16)),xw=Ae(I.zero(16)),Sw=Ae(I.zero(16)),kw=Ae(I.zero(16)),_w=Ae(I.zero(16)),Cw=Ae(I.zero(16)),bq=Ae(I.zero(8)),Ew=Ae(I.zero(16)),Aw=Ae(I.zero(16)),Pw=Ae(I.zero(16)),Tw=Ae(I.zero(16)),Rw=Ae(I.zero(16)),Nw=Ae(I.zero(16)),Aj=Ae(I.zero(16)),Ev=Ae(I.zero(8)),er=t=>Ae(e=>e(t).low,(e,n,i)=>{const r=e(t),s=typeof i=="function"?i(r.low):i;n(t,r.withLow(s))}),tr=t=>Ae(e=>e(t).high,(e,n,i)=>{const r=e(t),s=typeof i=="function"?i(r.high):i;n(t,r.withHigh(s))}),At={AX:bw,AL:er(bw),AH:tr(bw),BX:xw,BL:er(xw),BH:tr(xw),CX:Sw,CL:er(Sw),CH:tr(Sw),DX:kw,DL:er(kw),DH:tr(kw),SP:_w,"SP.l":er(_w),"SP.h":tr(_w),IP:Cw,"IP.l":er(Cw),"IP.h":tr(Cw),IR:bq,ri:Ew,"ri.l":er(Ew),"ri.h":tr(Ew),id:Aw,"id.l":er(Aw),"id.h":tr(Aw),left:Pw,"left.l":er(Pw),"left.h":tr(Pw),right:Tw,"right.l":er(Tw),"right.h":tr(Tw),result:Rw,"result.l":er(Rw),"result.h":tr(Rw),FLAGS:Nw,"FLAGS.l":er(Nw),"FLAGS.h":tr(Nw),MAR:Aj,MBR:Ev},vs=Ae({phase:"stopped"}),Pj=Ae("ADD");function xq(t){ee.set(At.AX,I.fromUnsigned(t.cpu.AX,16)),ee.set(At.BX,I.fromUnsigned(t.cpu.BX,16)),ee.set(At.CX,I.fromUnsigned(t.cpu.CX,16)),ee.set(At.DX,I.fromUnsigned(t.cpu.DX,16)),ee.set(At.SP,I.fromUnsigned(t.cpu.SP,16)),ee.set(At.IP,I.fromUnsigned(t.cpu.IP,16)),ee.set(At.IR,I.fromUnsigned(t.cpu.IR,8)),ee.set(At.ri,I.fromUnsigned(t.cpu.ri,16)),ee.set(At.id,I.fromUnsigned(t.cpu.id,16)),ee.set(At.left,I.fromUnsigned(t.cpu.left,16)),ee.set(At.right,I.fromUnsigned(t.cpu.right,16)),ee.set(At.result,I.fromUnsigned(t.cpu.result,16)),ee.set(At.FLAGS,I.fromUnsigned(t.cpu.FLAGS,16)),ee.set(At.MAR,I.fromUnsigned(t.cpu.MAR,16)),ee.set(At.MBR,I.fromUnsigned(t.cpu.MBR,8)),ee.set(vs,{phase:"stopped"})}var f_=ap(),We=t=>op(t,f_),p_=ap();We.write=t=>op(t,p_);var Fy=ap();We.onStart=t=>op(t,Fy);var m_=ap();We.onFrame=t=>op(t,m_);var g_=ap();We.onFinish=t=>op(t,g_);var fc=[];We.setTimeout=(t,e)=>{const n=We.now()+e,i=()=>{const s=fc.findIndex(o=>o.cancel==i);~s&&fc.splice(s,1),wa-=~s?1:0},r={time:n,handler:t,cancel:i};return fc.splice(Tj(n),0,r),wa+=1,Rj(),r};var Tj=t=>~(~fc.findIndex(e=>e.time>t)||~fc.length);We.cancel=t=>{Fy.delete(t),m_.delete(t),g_.delete(t),f_.delete(t),p_.delete(t)};We.sync=t=>{_1=!0,We.batchedUpdates(t),_1=!1};We.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function i(...r){e=r,We.onStart(n)}return i.handler=t,i.cancel=()=>{Fy.delete(n),e=null},i};var v_=typeof window<"u"?window.requestAnimationFrame:()=>{};We.use=t=>v_=t;We.now=typeof performance<"u"?()=>performance.now():Date.now;We.batchedUpdates=t=>t();We.catch=console.error;We.frameLoop="always";We.advance=()=>{We.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):Mj()};var ya=-1,wa=0,_1=!1;function op(t,e){_1?(e.delete(t),t(0)):(e.add(t),Rj())}function Rj(){ya<0&&(ya=0,We.frameLoop!=="demand"&&v_(Nj))}function Sq(){ya=-1}function Nj(){~ya&&(v_(Nj),We.batchedUpdates(Mj))}function Mj(){const t=ya;ya=We.now();const e=Tj(ya);if(e&&(Oj(fc.splice(0,e),n=>n.handler()),wa-=e),!wa){Sq();return}Fy.flush(),f_.flush(t?Math.min(64,ya-t):16.667),m_.flush(),p_.flush(),g_.flush()}function ap(){let t=new Set,e=t;return{add(n){wa+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return wa-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,wa-=e.size,Oj(e,i=>i(n)&&t.add(i)),wa+=t.size,e=t)}}}function Oj(t,e){t.forEach(n=>{try{e(n)}catch(i){We.catch(i)}})}var kq=Object.defineProperty,_q=(t,e)=>{for(var n in e)kq(t,n,{get:e[n],enumerable:!0})},os={};_q(os,{assign:()=>Aq,colors:()=>Oa,createStringInterpolator:()=>w_,skipAnimation:()=>Lj,to:()=>Ij,willAdvance:()=>b_});function Cq(){}var Eq=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),ve={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function Qs(t,e){if(ve.arr(t)){if(!ve.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}var An=(t,e)=>t.forEach(e);function Ya(t,e,n){if(ve.arr(t)){for(let i=0;i<t.length;i++)e.call(n,t[i],`${i}`);return}for(const i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i)}var ba=t=>ve.und(t)?[]:ve.arr(t)?t:[t];function Dj(t,e){if(t.size){const n=Array.from(t);t.clear(),An(n,e)}}var hm=(t,...e)=>Dj(t,n=>n(...e)),y_=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),w_,Ij,Oa=null,Lj=!1,b_=Cq,Aq=t=>{t.to&&(Ij=t.to),t.now&&(We.now=t.now),t.colors!==void 0&&(Oa=t.colors),t.skipAnimation!=null&&(Lj=t.skipAnimation),t.createStringInterpolator&&(w_=t.createStringInterpolator),t.requestAnimationFrame&&We.use(t.requestAnimationFrame),t.batchedUpdates&&(We.batchedUpdates=t.batchedUpdates),t.willAdvance&&(b_=t.willAdvance),t.frameLoop&&(We.frameLoop=t.frameLoop)},Sh=new Set,fr=[],Mw=[],Av=0,By={get idle(){return!Sh.size&&!fr.length},start(t){Av>t.priority?(Sh.add(t),We.onStart(Pq)):(jj(t),We(C1))},advance:C1,sort(t){if(Av)We.onFrame(()=>By.sort(t));else{const e=fr.indexOf(t);~e&&(fr.splice(e,1),Fj(t))}},clear(){fr=[],Sh.clear()}};function Pq(){Sh.forEach(jj),Sh.clear(),We(C1)}function jj(t){fr.includes(t)||Fj(t)}function Fj(t){fr.splice(Tq(fr,e=>e.priority>t.priority),0,t)}function C1(t){const e=Mw;for(let n=0;n<fr.length;n++){const i=fr[n];Av=i.priority,i.idle||(b_(i),i.advance(t),i.idle||e.push(i))}return Av=0,Mw=fr,Mw.length=0,fr=e,fr.length>0}function Tq(t,e){const n=t.findIndex(e);return n<0?t.length:n}var Rq=(t,e,n)=>Math.min(Math.max(n,t),e),Nq={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},Xr="[-+]?\\d*\\.?\\d+",Pv=Xr+"%";function $y(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var Mq=new RegExp("rgb"+$y(Xr,Xr,Xr)),Oq=new RegExp("rgba"+$y(Xr,Xr,Xr,Xr)),Dq=new RegExp("hsl"+$y(Xr,Pv,Pv)),Iq=new RegExp("hsla"+$y(Xr,Pv,Pv,Xr)),Lq=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,jq=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Fq=/^#([0-9a-fA-F]{6})$/,Bq=/^#([0-9a-fA-F]{8})$/;function $q(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=Fq.exec(t))?parseInt(e[1]+"ff",16)>>>0:Oa&&Oa[t]!==void 0?Oa[t]:(e=Mq.exec(t))?(wu(e[1])<<24|wu(e[2])<<16|wu(e[3])<<8|255)>>>0:(e=Oq.exec(t))?(wu(e[1])<<24|wu(e[2])<<16|wu(e[3])<<8|ET(e[4]))>>>0:(e=Lq.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=Bq.exec(t))?parseInt(e[1],16)>>>0:(e=jq.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=Dq.exec(t))?(_T(CT(e[1]),fm(e[2]),fm(e[3]))|255)>>>0:(e=Iq.exec(t))?(_T(CT(e[1]),fm(e[2]),fm(e[3]))|ET(e[4]))>>>0:null}function Ow(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function _T(t,e,n){const i=n<.5?n*(1+e):n+e-n*e,r=2*n-i,s=Ow(r,i,t+1/3),o=Ow(r,i,t),a=Ow(r,i,t-1/3);return Math.round(s*255)<<24|Math.round(o*255)<<16|Math.round(a*255)<<8}function wu(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function CT(t){return(parseFloat(t)%360+360)%360/360}function ET(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function fm(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function AT(t){let e=$q(t);if(e===null)return t;e=e||0;const n=(e&4278190080)>>>24,i=(e&16711680)>>>16,r=(e&65280)>>>8,s=(e&255)/255;return`rgba(${n}, ${i}, ${r}, ${s})`}var Pf=(t,e,n)=>{if(ve.fun(t))return t;if(ve.arr(t))return Pf({range:t,output:e,extrapolate:n});if(ve.str(t.output[0]))return w_(t);const i=t,r=i.output,s=i.range||[0,1],o=i.extrapolateLeft||i.extrapolate||"extend",a=i.extrapolateRight||i.extrapolate||"extend",l=i.easing||(u=>u);return u=>{const c=Uq(u,s);return zq(u,s[c],s[c+1],r[c],r[c+1],l,o,a,i.map)}};function zq(t,e,n,i,r,s,o,a,l){let u=l?l(t):t;if(u<e){if(o==="identity")return u;o==="clamp"&&(u=e)}if(u>n){if(a==="identity")return u;a==="clamp"&&(u=n)}return i===r?i:e===n?t<=e?i:r:(e===-1/0?u=-u:n===1/0?u=u-e:u=(u-e)/(n-e),u=s(u),i===-1/0?u=-u:r===1/0?u=u+i:u=u*(r-i)+i,u)}function Uq(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}var Vq=(t,e="end")=>n=>{n=e==="end"?Math.min(n,.999):Math.max(n,.001);const i=n*t,r=e==="end"?Math.floor(i):Math.ceil(i);return Rq(0,1,r/t)},Tv=1.70158,pm=Tv*1.525,PT=Tv+1,TT=2*Math.PI/3,RT=2*Math.PI/4.5,mm=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,Bj={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>PT*t*t*t-Tv*t*t,easeOutBack:t=>1+PT*Math.pow(t-1,3)+Tv*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((pm+1)*2*t-pm)/2:(Math.pow(2*t-2,2)*((pm+1)*(t*2-2)+pm)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*TT),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*TT)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*RT))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*RT)/2+1,easeInBounce:t=>1-mm(1-t),easeOutBounce:mm,easeInOutBounce:t=>t<.5?(1-mm(1-2*t))/2:(1+mm(2*t-1))/2,steps:Vq},Tf=Symbol.for("FluidValue.get"),zc=Symbol.for("FluidValue.observers"),hr=t=>!!(t&&t[Tf]),yi=t=>t&&t[Tf]?t[Tf]():t,NT=t=>t[zc]||null;function Hq(t,e){t.eventObserved?t.eventObserved(e):t(e)}function Rf(t,e){const n=t[zc];n&&n.forEach(i=>{Hq(i,e)})}var $j=class{constructor(t){if(!t&&!(t=this.get))throw Error("Unknown getter");Wq(this,t)}},Wq=(t,e)=>zj(t,Tf,e);function zy(t,e){if(t[Tf]){let n=t[zc];n||zj(t,zc,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function Nf(t,e){const n=t[zc];if(n&&n.has(e)){const i=n.size-1;i?n.delete(e):t[zc]=null,t.observerRemoved&&t.observerRemoved(i,e)}}var zj=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),dg=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Gq=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,MT=new RegExp(`(${dg.source})(%|[a-z]+)`,"i"),Kq=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,Uy=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,Uj=t=>{const[e,n]=Xq(t);if(!e||y_())return t;const i=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(i)return i.trim();if(n&&n.startsWith("--")){const r=window.getComputedStyle(document.documentElement).getPropertyValue(n);return r||t}else{if(n&&Uy.test(n))return Uj(n);if(n)return n}return t},Xq=t=>{const e=Uy.exec(t);if(!e)return[,];const[,n,i]=e;return[n,i]},Dw,qq=(t,e,n,i,r)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(i)}, ${r})`,Vj=t=>{Dw||(Dw=Oa?new RegExp(`(${Object.keys(Oa).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(s=>yi(s).replace(Uy,Uj).replace(Gq,AT).replace(Dw,AT)),n=e.map(s=>s.match(dg).map(Number)),r=n[0].map((s,o)=>n.map(a=>{if(!(o in a))throw Error('The arity of each "output" value must be equal');return a[o]})).map(s=>Pf({...t,output:s}));return s=>{var l;const o=!MT.test(e[0])&&((l=e.find(u=>MT.test(u)))==null?void 0:l.replace(dg,""));let a=0;return e[0].replace(dg,()=>`${r[a++](s)}${o||""}`).replace(Kq,qq)}},Hj="react-spring: ",Wj=t=>{const e=t;let n=!1;if(typeof e!="function")throw new TypeError(`${Hj}once requires a function parameter`);return(...i)=>{n||(e(...i),n=!0)}},Yq=Wj(console.warn);function Jq(){Yq(`${Hj}The "interpolate" function is deprecated in v9 (use "to" instead)`)}Wj(console.warn);function Vy(t){return ve.str(t)&&(t[0]=="#"||/\d/.test(t)||!y_()&&Uy.test(t)||t in(Oa||{}))}var Gj=y_()?S.useEffect:S.useLayoutEffect,Zq=()=>{const t=S.useRef(!1);return Gj(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function Qq(){const t=S.useState()[1],e=Zq();return()=>{e.current&&t(Math.random())}}function eY(t,e){const[n]=S.useState(()=>({inputs:e,result:t()})),i=S.useRef(),r=i.current;let s=r;return s?e&&s.inputs&&tY(e,s.inputs)||(s={inputs:e,result:t()}):s=n,S.useEffect(()=>{i.current=s,r==n&&(n.inputs=n.result=void 0)},[s]),s.result}function tY(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var nY=t=>S.useEffect(t,iY),iY=[],Mf=Symbol.for("Animated:node"),rY=t=>!!t&&t[Mf]===t,ys=t=>t&&t[Mf],x_=(t,e)=>Eq(t,Mf,e),Hy=t=>t&&t[Mf]&&t[Mf].getPayload(),Kj=class{constructor(){x_(this,this)}getPayload(){return this.payload||[]}},lp=class extends Kj{constructor(t){super(),this._value=t,this.done=!0,this.durationProgress=0,ve.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new lp(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,e){return ve.num(t)&&(this.lastPosition=t,e&&(t=Math.round(t/e)*e,this.done&&(this.lastPosition=t))),this._value===t?!1:(this._value=t,!0)}reset(){const{done:t}=this;this.done=!1,ve.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}},Of=class extends lp{constructor(t){super(0),this._string=null,this._toString=Pf({output:[t,t]})}static create(t){return new Of(t)}getValue(){const t=this._string;return t??(this._string=this._toString(this._value))}setValue(t){if(ve.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else if(super.setValue(t))this._string=null;else return!1;return!0}reset(t){t&&(this._toString=Pf({output:[this.getValue(),t]})),this._value=0,super.reset()}},Rv={dependencies:null},Wy=class extends Kj{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const e={};return Ya(this.source,(n,i)=>{rY(n)?e[i]=n.getValue(t):hr(n)?e[i]=yi(n):t||(e[i]=n)}),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&An(this.payload,t=>t.reset())}_makePayload(t){if(t){const e=new Set;return Ya(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){Rv.dependencies&&hr(t)&&Rv.dependencies.add(t);const e=Hy(t);e&&An(e,n=>this.add(n))}},Xj=class extends Wy{constructor(t){super(t)}static create(t){return new Xj(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){const e=this.getPayload();return t.length==e.length?e.map((n,i)=>n.setValue(t[i])).some(Boolean):(super.setValue(t.map(sY)),!0)}};function sY(t){return(Vy(t)?Of:lp).create(t)}function E1(t){const e=ys(t);return e?e.constructor:ve.arr(t)?Xj:Vy(t)?Of:lp}var OT=(t,e)=>{const n=!ve.fun(t)||t.prototype&&t.prototype.isReactComponent;return S.forwardRef((i,r)=>{const s=S.useRef(null),o=n&&S.useCallback(p=>{s.current=lY(r,p)},[r]),[a,l]=aY(i,e),u=Qq(),c=()=>{const p=s.current;if(n&&!p)return;(p?e.applyAnimatedValues(p,a.getValue(!0)):!1)===!1&&u()},d=new oY(c,l),h=S.useRef();Gj(()=>(h.current=d,An(l,p=>zy(p,d)),()=>{h.current&&(An(h.current.deps,p=>Nf(p,h.current)),We.cancel(h.current.update))})),S.useEffect(c,[]),nY(()=>()=>{const p=h.current;An(p.deps,m=>Nf(m,p))});const f=e.getComponentProps(a.getValue());return S.createElement(t,{...f,ref:o})})},oY=class{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){t.type=="change"&&We.write(this.update)}};function aY(t,e){const n=new Set;return Rv.dependencies=n,t.style&&(t={...t,style:e.createAnimatedStyle(t.style)}),t=new Wy(t),Rv.dependencies=null,[t,n]}function lY(t,e){return t&&(ve.fun(t)?t(e):t.current=e),e}var DT=Symbol.for("AnimatedComponent"),uY=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=r=>new Wy(r),getComponentProps:i=r=>r}={})=>{const r={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:i},s=o=>{const a=IT(o)||"Anonymous";return ve.str(o)?o=s[o]||(s[o]=OT(o,r)):o=o[DT]||(o[DT]=OT(o,r)),o.displayName=`Animated(${a})`,o};return Ya(t,(o,a)=>{ve.arr(t)&&(a=IT(o)),s[a]=s(o)}),{animated:s}},IT=t=>ve.str(t)?t:t&&ve.str(t.displayName)?t.displayName:ve.fun(t)&&t.name||null;function El(t,...e){return ve.fun(t)?t(...e):t}var kh=(t,e)=>t===!0||!!(e&&t&&(ve.fun(t)?t(e):ba(t).includes(e))),qj=(t,e)=>ve.obj(t)?e&&t[e]:t,cY=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,dY=t=>t,Yj=(t,e=dY)=>{let n=hY;t.default&&t.default!==!0&&(t=t.default,n=Object.keys(t));const i={};for(const r of n){const s=e(t[r],r);ve.und(s)||(i[r]=s)}return i},hY=["config","onProps","onStart","onChange","onPause","onResume","onRest"],fY={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function pY(t){const e={};let n=0;if(Ya(t,(i,r)=>{fY[r]||(e[r]=i,n++)}),n)return e}function Jj(t){const e=pY(t);if(e){const n={to:e};return Ya(t,(i,r)=>r in e||(n[r]=i)),n}return{...t}}function Df(t){return t=yi(t),ve.arr(t)?t.map(Df):Vy(t)?os.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function A1(t){return ve.fun(t)||ve.arr(t)&&ve.obj(t[0])}var mY={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},P1={...mY.default,mass:1,damping:1,easing:Bj.linear,clamp:!1},gY=class{constructor(){this.velocity=0,Object.assign(this,P1)}};function vY(t,e,n){n&&(n={...n},LT(n,e),e={...n,...e}),LT(t,e),Object.assign(t,e);for(const o in P1)t[o]==null&&(t[o]=P1[o]);let{frequency:i,damping:r}=t;const{mass:s}=t;return ve.und(i)||(i<.01&&(i=.01),r<0&&(r=0),t.tension=Math.pow(2*Math.PI/i,2)*s,t.friction=4*Math.PI*r*s/i),t}function LT(t,e){if(!ve.und(e.decay))t.duration=void 0;else{const n=!ve.und(e.tension)||!ve.und(e.friction);(n||!ve.und(e.frequency)||!ve.und(e.damping)||!ve.und(e.mass))&&(t.duration=void 0,t.decay=void 0),n&&(t.frequency=void 0)}}var jT=[],yY=class{constructor(){this.changed=!1,this.values=jT,this.toValues=null,this.fromValues=jT,this.config=new gY,this.immediate=!1}};function wY(t,{key:e,props:n,defaultProps:i,state:r,actions:s}){return new Promise((o,a)=>{let l,u,c=kh(n.cancel??(i==null?void 0:i.cancel),e);if(c)f();else{ve.und(n.pause)||(r.paused=kh(n.pause,e));let p=i==null?void 0:i.pause;p!==!0&&(p=r.paused||kh(p,e)),l=El(n.delay||0,e),p?(r.resumeQueue.add(h),s.pause()):(s.resume(),h())}function d(){r.resumeQueue.add(h),r.timeouts.delete(u),u.cancel(),l=u.time-We.now()}function h(){l>0&&!os.skipAnimation?(r.delayed=!0,u=We.setTimeout(f,l),r.pauseQueue.add(d),r.timeouts.add(u)):f()}function f(){r.delayed&&(r.delayed=!1),r.pauseQueue.delete(d),r.timeouts.delete(u),t<=(r.cancelId||0)&&(c=!0);try{s.start({...n,callId:t,cancel:c},o)}catch(p){a(p)}}})}var bY=(t,e)=>e.length==1?e[0]:e.some(n=>n.cancelled)?_h(t.get()):e.every(n=>n.noop)?Zj(t.get()):Ur(t.get(),e.every(n=>n.finished)),Zj=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),Ur=(t,e,n=!1)=>({value:t,finished:e,cancelled:n}),_h=t=>({value:t,cancelled:!0,finished:!1});function xY(t,e,n,i){const{callId:r,parentId:s,onRest:o}=e,{asyncTo:a,promise:l}=n;return!s&&t===a&&!e.reset?l:n.promise=(async()=>{n.asyncId=r,n.asyncTo=t;const u=Yj(e,(w,v)=>v==="onRest"?void 0:w);let c,d;const h=new Promise((w,v)=>(c=w,d=v)),f=w=>{const v=r<=(n.cancelId||0)&&_h(i)||r!==n.asyncId&&Ur(i,!1);if(v)throw w.result=v,d(w),w},p=(w,v)=>{const y=new FT,b=new BT;return(async()=>{if(os.skipAnimation)throw T1(n),b.result=Ur(i,!1),d(b),b;f(y);const k=ve.obj(w)?{...w}:{...v,to:w};k.parentId=r,Ya(u,(E,A)=>{ve.und(k[A])&&(k[A]=E)});const _=await i.start(k);return f(y),n.paused&&await new Promise(E=>{n.resumeQueue.add(E)}),_})()};let m;if(os.skipAnimation)return T1(n),Ur(i,!1);try{let w;ve.arr(t)?w=(async v=>{for(const y of v)await p(y)})(t):w=Promise.resolve(t(p,i.stop.bind(i))),await Promise.all([w.then(c),h]),m=Ur(i.get(),!0,!1)}catch(w){if(w instanceof FT)m=w.result;else if(w instanceof BT)m=w.result;else throw w}finally{r==n.asyncId&&(n.asyncId=s,n.asyncTo=s?a:void 0,n.promise=s?l:void 0)}return ve.fun(o)&&We.batchedUpdates(()=>{o(m,i,i.item)}),m})()}function T1(t,e){Dj(t.timeouts,n=>n.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}var FT=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},BT=class extends Error{constructor(){super("SkipAnimationSignal")}},R1=t=>t instanceof S_,SY=1,S_=class extends $j{constructor(){super(...arguments),this.id=SY++,this._priority=0}get priority(){return this._priority}set priority(t){this._priority!=t&&(this._priority=t,this._onPriorityChange(t))}get(){const t=ys(this);return t&&t.getValue()}to(...t){return os.to(this,t)}interpolate(...t){return Jq(),os.to(this,t)}toJSON(){return this.get()}observerAdded(t){t==1&&this._attach()}observerRemoved(t){t==0&&this._detach()}_attach(){}_detach(){}_onChange(t,e=!1){Rf(this,{type:"change",parent:this,value:t,idle:e})}_onPriorityChange(t){this.idle||By.sort(this),Rf(this,{type:"priority",parent:this,priority:t})}},iu=Symbol.for("SpringPhase"),Qj=1,N1=2,M1=4,Iw=t=>(t[iu]&Qj)>0,Go=t=>(t[iu]&N1)>0,Ad=t=>(t[iu]&M1)>0,$T=(t,e)=>e?t[iu]|=N1|Qj:t[iu]&=~N1,zT=(t,e)=>e?t[iu]|=M1:t[iu]&=~M1,Et=class extends S_{constructor(t,e){if(super(),this.animation=new yY,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!ve.und(t)||!ve.und(e)){const n=ve.obj(t)?{...t}:{...e,from:t};ve.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(Go(this)||this._state.asyncTo)||Ad(this)}get goal(){return yi(this.animation.to)}get velocity(){const t=ys(this);return t instanceof lp?t.lastVelocity||0:t.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return Iw(this)}get isAnimating(){return Go(this)}get isPaused(){return Ad(this)}get isDelayed(){return this._state.delayed}advance(t){let e=!0,n=!1;const i=this.animation;let{toValues:r}=i;const{config:s}=i,o=Hy(i.to);!o&&hr(i.to)&&(r=ba(yi(i.to))),i.values.forEach((u,c)=>{if(u.done)return;const d=u.constructor==Of?1:o?o[c].lastPosition:r[c];let h=i.immediate,f=d;if(!h){if(f=u.lastPosition,s.tension<=0){u.done=!0;return}let p=u.elapsedTime+=t;const m=i.fromValues[c],w=u.v0!=null?u.v0:u.v0=ve.arr(s.velocity)?s.velocity[c]:s.velocity;let v;const y=s.precision||(m==d?.005:Math.min(1,Math.abs(d-m)*.001));if(ve.und(s.duration))if(s.decay){const b=s.decay===!0?.998:s.decay,k=Math.exp(-(1-b)*p);f=m+w/(1-b)*(1-k),h=Math.abs(u.lastPosition-f)<=y,v=w*k}else{v=u.lastVelocity==null?w:u.lastVelocity;const b=s.restVelocity||y/10,k=s.clamp?0:s.bounce,_=!ve.und(k),E=m==d?u.v0>0:m<d;let A,P=!1;const D=1,L=Math.ceil(t/D);for(let B=0;B<L&&(A=Math.abs(v)>b,!(!A&&(h=Math.abs(d-f)<=y,h)));++B){_&&(P=f==d||f>d==E,P&&(v=-v*k,f=d));const $=-s.tension*1e-6*(f-d),J=-s.friction*.001*v,z=($+J)/s.mass;v=v+z*D,f=f+v*D}}else{let b=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,u.durationProgress>0&&(u.elapsedTime=s.duration*u.durationProgress,p=u.elapsedTime+=t)),b=(s.progress||0)+p/this._memoizedDuration,b=b>1?1:b<0?0:b,u.durationProgress=b),f=m+s.easing(b)*(d-m),v=(f-u.lastPosition)/t,h=b==1}u.lastVelocity=v,Number.isNaN(f)&&(console.warn("Got NaN while animating:",this),h=!0)}o&&!o[c].done&&(h=!1),h?u.done=!0:e=!1,u.setValue(f,s.round)&&(n=!0)});const a=ys(this),l=a.getValue();if(e){const u=yi(i.to);(l!==u||n)&&!s.decay?(a.setValue(u),this._onChange(u)):n&&s.decay&&this._onChange(l),this._stop()}else n&&this._onChange(l)}set(t){return We.batchedUpdates(()=>{this._stop(),this._focus(t),this._set(t)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Go(this)){const{to:t,config:e}=this.animation;We.batchedUpdates(()=>{this._onStart(),e.decay||this._set(t,!1),this._stop()})}return this}update(t){return(this.queue||(this.queue=[])).push(t),this}start(t,e){let n;return ve.und(t)?(n=this.queue||[],this.queue=[]):n=[ve.obj(t)?t:{...e,to:t}],Promise.all(n.map(i=>this._update(i))).then(i=>bY(this,i))}stop(t){const{to:e}=this.animation;return this._focus(this.get()),T1(this._state,t&&this._lastCallId),We.batchedUpdates(()=>this._stop(e,t)),this}reset(){this._update({reset:!0})}eventObserved(t){t.type=="change"?this._start():t.type=="priority"&&(this.priority=t.priority+1)}_prepareNode(t){const e=this.key||"";let{to:n,from:i}=t;n=ve.obj(n)?n[e]:n,(n==null||A1(n))&&(n=void 0),i=ve.obj(i)?i[e]:i,i==null&&(i=void 0);const r={to:n,from:i};return Iw(this)||(t.reverse&&([n,i]=[i,n]),i=yi(i),ve.und(i)?ys(this)||this._set(n):this._set(i)),r}_update({...t},e){const{key:n,defaultProps:i}=this;t.default&&Object.assign(i,Yj(t,(o,a)=>/^on/.test(a)?qj(o,n):o)),VT(this,t,"onProps"),Td(this,"onProps",t,this);const r=this._prepareNode(t);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return wY(++this._lastCallId,{key:n,props:t,defaultProps:i,state:s,actions:{pause:()=>{Ad(this)||(zT(this,!0),hm(s.pauseQueue),Td(this,"onPause",Ur(this,Pd(this,this.animation.to)),this))},resume:()=>{Ad(this)&&(zT(this,!1),Go(this)&&this._resume(),hm(s.resumeQueue),Td(this,"onResume",Ur(this,Pd(this,this.animation.to)),this))},start:this._merge.bind(this,r)}}).then(o=>{if(t.loop&&o.finished&&!(e&&o.noop)){const a=kY(t);if(a)return this._update(a,!0)}return o})}_merge(t,e,n){if(e.cancel)return this.stop(!0),n(_h(this));const i=!ve.und(t.to),r=!ve.und(t.from);if(i||r)if(e.callId>this._lastToId)this._lastToId=e.callId;else return n(_h(this));const{key:s,defaultProps:o,animation:a}=this,{to:l,from:u}=a;let{to:c=l,from:d=u}=t;r&&!i&&(!e.default||ve.und(c))&&(c=d),e.reverse&&([c,d]=[d,c]);const h=!Qs(d,u);h&&(a.from=d),d=yi(d);const f=!Qs(c,l);f&&this._focus(c);const p=A1(e.to),{config:m}=a,{decay:w,velocity:v}=m;(i||r)&&(m.velocity=0),e.config&&!p&&vY(m,El(e.config,s),e.config!==o.config?El(o.config,s):void 0);let y=ys(this);if(!y||ve.und(c))return n(Ur(this,!0));const b=ve.und(e.reset)?r&&!e.default:!ve.und(d)&&kh(e.reset,s),k=b?d:this.get(),_=Df(c),E=ve.num(_)||ve.arr(_)||Vy(_),A=!p&&(!E||kh(o.immediate||e.immediate,s));if(f){const B=E1(c);if(B!==y.constructor)if(A)y=this._set(_);else throw Error(`Cannot animate between ${y.constructor.name} and ${B.name}, as the "to" prop suggests`)}const P=y.constructor;let D=hr(c),L=!1;if(!D){const B=b||!Iw(this)&&h;(f||B)&&(L=Qs(Df(k),_),D=!L),(!Qs(a.immediate,A)&&!A||!Qs(m.decay,w)||!Qs(m.velocity,v))&&(D=!0)}if(L&&Go(this)&&(a.changed&&!b?D=!0:D||this._stop(l)),!p&&((D||hr(l))&&(a.values=y.getPayload(),a.toValues=hr(c)?null:P==Of?[1]:ba(_)),a.immediate!=A&&(a.immediate=A,!A&&!b&&this._set(l)),D)){const{onRest:B}=a;An(CY,J=>VT(this,e,J));const $=Ur(this,Pd(this,l));hm(this._pendingCalls,$),this._pendingCalls.add(n),a.changed&&We.batchedUpdates(()=>{var J;a.changed=!b,B==null||B($,this),b?El(o.onRest,$):(J=a.onStart)==null||J.call(a,$,this)})}b&&this._set(k),p?n(xY(e.to,e,this._state,this)):D?this._start():Go(this)&&!f?this._pendingCalls.add(n):n(Zj(k))}_focus(t){const e=this.animation;t!==e.to&&(NT(this)&&this._detach(),e.to=t,NT(this)&&this._attach())}_attach(){let t=0;const{to:e}=this.animation;hr(e)&&(zy(e,this),R1(e)&&(t=e.priority+1)),this.priority=t}_detach(){const{to:t}=this.animation;hr(t)&&Nf(t,this)}_set(t,e=!0){const n=yi(t);if(!ve.und(n)){const i=ys(this);if(!i||!Qs(n,i.getValue())){const r=E1(n);!i||i.constructor!=r?x_(this,r.create(n)):i.setValue(n),i&&We.batchedUpdates(()=>{this._onChange(n,e)})}}return ys(this)}_onStart(){const t=this.animation;t.changed||(t.changed=!0,Td(this,"onStart",Ur(this,Pd(this,t.to)),this))}_onChange(t,e){e||(this._onStart(),El(this.animation.onChange,t,this)),El(this.defaultProps.onChange,t,this),super._onChange(t,e)}_start(){const t=this.animation;ys(this).reset(yi(t.to)),t.immediate||(t.fromValues=t.values.map(e=>e.lastPosition)),Go(this)||($T(this,!0),Ad(this)||this._resume())}_resume(){os.skipAnimation?this.finish():By.start(this)}_stop(t,e){if(Go(this)){$T(this,!1);const n=this.animation;An(n.values,r=>{r.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),Rf(this,{type:"idle",parent:this});const i=e?_h(this.get()):Ur(this.get(),Pd(this,t??n.to));hm(this._pendingCalls,i),n.changed&&(n.changed=!1,Td(this,"onRest",i,this))}}};function Pd(t,e){const n=Df(e),i=Df(t.get());return Qs(i,n)}function kY(t,e=t.loop,n=t.to){const i=El(e);if(i){const r=i!==!0&&Jj(i),s=(r||t).reverse,o=!r||r.reset;return _Y({...t,loop:e,default:!1,pause:void 0,to:!s||A1(n)?n:void 0,from:o?t.from:void 0,reset:o,...r})}}function _Y(t){const{to:e,from:n}=t=Jj(t),i=new Set;return ve.obj(e)&&UT(e,i),ve.obj(n)&&UT(n,i),t.keys=i.size?Array.from(i):null,t}function UT(t,e){Ya(t,(n,i)=>n!=null&&e.add(i))}var CY=["onStart","onRest","onChange","onPause","onResume"];function VT(t,e,n){t.animation[n]=e[n]!==cY(e,n)?qj(e[n],t.key):void 0}function Td(t,e,...n){var i,r,s,o;(r=(i=t.animation)[e])==null||r.call(i,...n),(o=(s=t.defaultProps)[e])==null||o.call(s,...n)}var k_=({children:t,...e})=>{const n=S.useContext(Nv),i=e.pause||!!n.pause,r=e.immediate||!!n.immediate;e=eY(()=>({pause:i,immediate:r}),[i,r]);const{Provider:s}=Nv;return S.createElement(s,{value:e},t)},Nv=EY(k_,{});k_.Provider=Nv.Provider;k_.Consumer=Nv.Consumer;function EY(t,e){return Object.assign(t,S.createContext(e)),t.Provider._context=t,t.Consumer._context=t,t}var AY=class extends S_{constructor(t,e){super(),this.source=t,this.idle=!0,this._active=new Set,this.calc=Pf(...e);const n=this._get(),i=E1(n);x_(this,i.create(n))}advance(t){const e=this._get(),n=this.get();Qs(e,n)||(ys(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&HT(this._active)&&Lw(this)}_get(){const t=ve.arr(this.source)?this.source.map(yi):ba(yi(this.source));return this.calc(...t)}_start(){this.idle&&!HT(this._active)&&(this.idle=!1,An(Hy(this),t=>{t.done=!1}),os.skipAnimation?(We.batchedUpdates(()=>this.advance()),Lw(this)):By.start(this))}_attach(){let t=1;An(ba(this.source),e=>{hr(e)&&zy(e,this),R1(e)&&(e.idle||this._active.add(e),t=Math.max(t,e.priority+1))}),this.priority=t,this._start()}_detach(){An(ba(this.source),t=>{hr(t)&&Nf(t,this)}),this._active.clear(),Lw(this)}eventObserved(t){t.type=="change"?t.idle?this.advance():(this._active.add(t.parent),this._start()):t.type=="idle"?this._active.delete(t.parent):t.type=="priority"&&(this.priority=ba(this.source).reduce((e,n)=>Math.max(e,(R1(n)?n.priority:0)+1),0))}};function PY(t){return t.idle!==!1}function HT(t){return!t.size||Array.from(t).every(PY)}function Lw(t){t.idle||(t.idle=!0,An(Hy(t),e=>{e.done=!0}),Rf(t,{type:"idle",parent:t}))}os.assign({createStringInterpolator:Vj,to:(t,e)=>new AY(t,e)});var eF=/^--/;function TY(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!eF.test(t)&&!(Ch.hasOwnProperty(t)&&Ch[t])?e+"px":(""+e).trim()}var WT={};function RY(t,e){if(!t.nodeType||!t.setAttribute)return!1;const n=t.nodeName==="filter"||t.parentNode&&t.parentNode.nodeName==="filter",{style:i,children:r,scrollTop:s,scrollLeft:o,viewBox:a,...l}=e,u=Object.values(l),c=Object.keys(l).map(d=>n||t.hasAttribute(d)?d:WT[d]||(WT[d]=d.replace(/([A-Z])/g,h=>"-"+h.toLowerCase())));r!==void 0&&(t.textContent=r);for(const d in i)if(i.hasOwnProperty(d)){const h=TY(d,i[d]);eF.test(d)?t.style.setProperty(d,h):t.style[d]=h}c.forEach((d,h)=>{t.setAttribute(d,u[h])}),s!==void 0&&(t.scrollTop=s),o!==void 0&&(t.scrollLeft=o),a!==void 0&&t.setAttribute("viewBox",a)}var Ch={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},NY=(t,e)=>t+e.charAt(0).toUpperCase()+e.substring(1),MY=["Webkit","Ms","Moz","O"];Ch=Object.keys(Ch).reduce((t,e)=>(MY.forEach(n=>t[NY(n,e)]=t[e]),t),Ch);var OY=/^(matrix|translate|scale|rotate|skew)/,DY=/^(translate)/,IY=/^(rotate|skew)/,jw=(t,e)=>ve.num(t)&&t!==0?t+e:t,hg=(t,e)=>ve.arr(t)?t.every(n=>hg(n,e)):ve.num(t)?t===e:parseFloat(t)===e,LY=class extends Wy{constructor({x:t,y:e,z:n,...i}){const r=[],s=[];(t||e||n)&&(r.push([t||0,e||0,n||0]),s.push(o=>[`translate3d(${o.map(a=>jw(a,"px")).join(",")})`,hg(o,0)])),Ya(i,(o,a)=>{if(a==="transform")r.push([o||""]),s.push(l=>[l,l===""]);else if(OY.test(a)){if(delete i[a],ve.und(o))return;const l=DY.test(a)?"px":IY.test(a)?"deg":"";r.push(ba(o)),s.push(a==="rotate3d"?([u,c,d,h])=>[`rotate3d(${u},${c},${d},${jw(h,l)})`,hg(h,0)]:u=>[`${a}(${u.map(c=>jw(c,l)).join(",")})`,hg(u,a.startsWith("scale")?1:0)])}}),r.length&&(i.transform=new jY(r,s)),super(i)}},jY=class extends $j{constructor(t,e){super(),this.inputs=t,this.transforms=e,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let t="",e=!0;return An(this.inputs,(n,i)=>{const r=yi(n[0]),[s,o]=this.transforms[i](ve.arr(r)?r:n.map(yi));t+=" "+s,e=e&&o}),e?"none":t}observerAdded(t){t==1&&An(this.inputs,e=>An(e,n=>hr(n)&&zy(n,this)))}observerRemoved(t){t==0&&An(this.inputs,e=>An(e,n=>hr(n)&&Nf(n,this)))}eventObserved(t){t.type=="change"&&(this._value=null),Rf(this,t)}},FY=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];os.assign({batchedUpdates:jo.unstable_batchedUpdates,createStringInterpolator:Vj,colors:Nq});var BY=uY(FY,{applyAnimatedValues:RY,createAnimatedStyle:t=>new LY(t),getComponentProps:({scrollTop:t,scrollLeft:e,...n})=>n}),Kt=BY.animated;const bt={blue:{500:"#3b82f6"},mantis:{400:"#82bd69"},red:{500:"#ef4444"},stone:{600:"#57534e",700:"#44403c",800:"#292524"},white:"#ffffff"},Qe=(t=bt.stone[800])=>({backgroundColor:new Et(t),opacity:new Et(1)}),cn=()=>({strokeDashoffset:new Et(1),opacity:new Et(1)}),__={bus:{address:{stroke:new Et(bt.stone[700])},data:{stroke:new Et(bt.stone[700])},rd:{stroke:new Et(bt.stone[700])},wr:{stroke:new Et(bt.stone[700])},iom:cn(),mem:{stroke:new Et(bt.red[500])},handshake:cn(),pic:cn(),pio:cn(),timer:cn(),intr:cn(),inta:cn(),int0:cn(),int1:cn(),int2:cn(),"switches->pio":cn(),"pio->leds":cn(),printer:{data:cn(),strobe:cn(),busy:cn()}},clock:{angle:new Et(0)},cpu:{internalBus:{address:{strokeDashoffset:new Et(1),opacity:new Et(1),path:new Et("")},data:{strokeDashoffset:new Et(1),opacity:new Et(1),path:new Et("")}},alu:{operands:cn(),results:cn(),cog:{rot:new Et(0)},operation:{backgroundColor:new Et(bt.stone[800])}},decoder:{path:cn(),progress:{progress:new Et(0),opacity:new Et(1)}},AX:Qe(),BX:Qe(),CX:Qe(),DX:Qe(),SP:Qe(),IP:Qe(),IR:Qe(),ri:Qe(),id:Qe(),left:Qe(),right:Qe(),result:Qe(),FLAGS:Qe(),MAR:Qe(),MBR:Qe()},handshake:{DATA:Qe(),STATE:Qe()},memory:{"operating-cell":{color:new Et(bt.white)}},pic:{IMR:Qe(),IRR:Qe(),ISR:Qe(),INT0:Qe(),INT1:Qe(),INT2:Qe(),INT3:Qe(),INT4:Qe(),INT5:Qe(),INT6:Qe(),INT7:Qe()},pio:{PA:Qe(),PB:Qe(),CA:Qe(),CB:Qe()},printer:{printing:{progress:new Et(0),opacity:new Et(1)}},timer:{CONT:Qe(),COMP:Qe()}};function ft(t){return JL(__,t)}function tF(t){const e={};for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];i instanceof Et?e[n]=i.get():e[n]=tF(i)}return e}const $Y=tF(__);function nF(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];i instanceof Et?i.set(e[n]):nF(t[n],e[n])}}const zY=()=>nF(__,$Y),If=new Set;async function tt(t,e){const n=ee.get(Nn);if(n.type==="stopped")return null;if(n.type==="paused")return await new Promise(s=>{const o=ee.sub(Nn,()=>{ee.get(Nn).type!=="paused"&&(o(),s())})}),await tt(t,e);const i=Si();if(!i.animations&&!e.forceMs)return null;const r={duration:e.forceMs?e.duration:e.duration*i.executionUnit,easing:Bj[e.easing]};return Array.isArray(t)||(t=[t]),await Promise.all(t.map(async({key:s,from:o,to:a})=>{if(a===void 0&&o===void 0)return null;const l=ft(s);if(a===void 0)return l.set(o);{If.add(s);const u=await ft(s).start({from:o,to:a,config:r});return If.delete(s),u}}))}const UY=()=>If.forEach(t=>ft(t).pause()),VY=()=>If.forEach(t=>ft(t).resume());function iF(){If.forEach(t=>{const e=ft(t);e.stop(!0),e.isPaused&&e.resume()}),setTimeout(()=>zY(),10)}async function ar(t,e=bt.mantis[400]){return await tt({key:`${t}.backgroundColor`,to:e},{duration:1,easing:"easeOutQuart"})}async function lr(t){return await tt({key:`${t}.backgroundColor`,to:bt.stone[800]},{duration:1,easing:"easeOutQuart"})}async function Uc(t){await tt({key:"bus.data.stroke",to:bt.mantis[400]},{duration:5,easing:"easeOutSine"}),await ar("cpu.MBR"),ee.set(Ev,t),await lr("cpu.MBR")}async function _r(t,e){return await tt([{key:`${t}.strokeDashoffset`,from:1,to:0},{key:`${t}.opacity`,from:1}],{duration:e,easing:"easeInOutSine"})}async function ti(t){return await tt({key:`${t}.opacity`,to:0},{duration:1,easing:"easeInSine"})}async function HY(t){switch(t.type){case"bus:io.selected":{await Promise.all([tt({key:"bus.mem.stroke",to:bt.stone[700]},{duration:1,easing:"easeInSine"}),_r(`bus.${t.chip}`,15)]);return}case"bus:io.error":{Hc(t.error);return}case"bus:reset":{await Promise.all([tt([{key:"bus.address.stroke",to:bt.stone[700]},{key:"bus.data.stroke",to:bt.stone[700]},{key:"bus.rd.stroke",to:bt.stone[700]},{key:"bus.wr.stroke",to:bt.stone[700]}],{duration:1,easing:"easeInSine"}),tt({key:"bus.mem.stroke",to:bt.red[500]},{duration:1,easing:"easeOutSine"}),ti("bus.iom"),ti("bus.handshake"),ti("bus.pio"),ti("bus.pic"),ti("bus.timer")]);return}default:return t}}async function WY(t){switch(t.type){case"clock:tick":return;default:return t.type}}function GY(t){switch(t){case"IP":return"M 451 309 H 575 V 349 H 698";case"SP":return"M 451 349 H 698";case"ri":return"M 454 388 H 575 V 349 H 698";default:throw new Error(`Invalid register ${t}`)}}function KY(){const{path:t,...e}=ft("cpu.internalBus.address");return g.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[g.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:["M 451 309 H 575 V 349","M 451 349 H 575","M 444 388 H 575 V 349","M 451 349 H 698"].join(" ")}),g.jsx(Kt.path,{d:t,className:"fill-none stroke-blue-500 stroke-bus",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:e})]})}var C_={exports:{}},pc=typeof Reflect=="object"?Reflect:null,GT=pc&&typeof pc.apply=="function"?pc.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},fg;pc&&typeof pc.ownKeys=="function"?fg=pc.ownKeys:Object.getOwnPropertySymbols?fg=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:fg=function(e){return Object.getOwnPropertyNames(e)};function XY(t){console&&console.warn&&console.warn(t)}var rF=Number.isNaN||function(e){return e!==e};function pt(){pt.init.call(this)}C_.exports=pt;C_.exports.once=ZY;pt.EventEmitter=pt;pt.prototype._events=void 0;pt.prototype._eventsCount=0;pt.prototype._maxListeners=void 0;var KT=10;function Gy(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(pt,"defaultMaxListeners",{enumerable:!0,get:function(){return KT},set:function(t){if(typeof t!="number"||t<0||rF(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");KT=t}});pt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};pt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||rF(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function sF(t){return t._maxListeners===void 0?pt.defaultMaxListeners:t._maxListeners}pt.prototype.getMaxListeners=function(){return sF(this)};pt.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")GT(l,this,n);else for(var u=l.length,c=cF(l,u),i=0;i<u;++i)GT(c[i],this,n);return!0};function oF(t,e,n,i){var r,s,o;if(Gy(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),r=sF(t),r>0&&o.length>r&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,XY(a)}return t}pt.prototype.addListener=function(e,n){return oF(this,e,n,!1)};pt.prototype.on=pt.prototype.addListener;pt.prototype.prependListener=function(e,n){return oF(this,e,n,!0)};function qY(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function aF(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=qY.bind(i);return r.listener=n,i.wrapFn=r,r}pt.prototype.once=function(e,n){return Gy(n),this.on(e,aF(this,e,n)),this};pt.prototype.prependOnceListener=function(e,n){return Gy(n),this.prependListener(e,aF(this,e,n)),this};pt.prototype.removeListener=function(e,n){var i,r,s,o,a;if(Gy(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===n||i[o].listener===n){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():YY(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};pt.prototype.off=pt.prototype.removeListener;pt.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(r=0;r<s.length;++r)o=s[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function lF(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?JY(r):cF(r,r.length)}pt.prototype.listeners=function(e){return lF(this,e,!0)};pt.prototype.rawListeners=function(e){return lF(this,e,!1)};pt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):uF.call(t,e)};pt.prototype.listenerCount=uF;function uF(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}pt.prototype.eventNames=function(){return this._eventsCount>0?fg(this._events):[]};function cF(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function YY(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function JY(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function ZY(t,e){return new Promise(function(n,i){function r(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}dF(t,e,s,{once:!0}),e!=="error"&&QY(t,r,{once:!0})})}function QY(t,e,n){typeof t.on=="function"&&dF(t,"error",e,n)}function dF(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var eJ=C_.exports;function Us(t){if(typeof t!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=t}typeof Symbol<"u"&&(Us.prototype[Symbol.iterator]=function(){return this});Us.of=function(){var t=arguments,e=t.length,n=0;return new Us(function(){return n>=e?{done:!0}:{done:!1,value:t[n++]}})};Us.empty=function(){var t=new Us(function(){return{done:!0}});return t};Us.fromSequence=function(t){var e=0,n=t.length;return new Us(function(){return e>=n?{done:!0}:{done:!1,value:t[e++]}})};Us.is=function(t){return t instanceof Us?!0:typeof t=="object"&&t!==null&&typeof t.next=="function"};var Ky=Us;const Nr=Jc(Ky);var Xy={};Xy.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";Xy.SYMBOL_SUPPORT=typeof Symbol<"u";var tJ=Ky,hF=Xy,nJ=hF.ARRAY_BUFFER_SUPPORT,iJ=hF.SYMBOL_SUPPORT;function rJ(t){return typeof t=="string"||Array.isArray(t)||nJ&&ArrayBuffer.isView(t)?tJ.fromSequence(t):typeof t!="object"||t===null?null:iJ&&typeof t[Symbol.iterator]=="function"?t[Symbol.iterator]():typeof t.next=="function"?t:null}var fF=function(e){var n=rJ(e);if(!n)throw new Error("obliterator: target is not iterable nor a valid iterator.");return n},sJ=fF,oJ=function(e,n){for(var i=arguments.length>1?n:1/0,r=i!==1/0?new Array(i):[],s,o=0,a=sJ(e);;){if(o===i)return r;if(s=a.next(),s.done)return o!==n&&(r.length=o),r;r[o++]=s.value}};const pF=Jc(oJ);var aJ=Ky,lJ=fF,uJ=function(){var e=arguments,n=null,i=-1;return new aJ(function(){var s=null;do{if(n===null){if(i++,i>=e.length)return{done:!0};n=lJ(e[i])}if(s=n.next(),s.done===!0){n=null;continue}break}while(!0);return s})};const _o=Jc(uJ);function cJ(){const t=arguments[0];for(let e=1,n=arguments.length;e<n;e++)if(arguments[e])for(const i in arguments[e])t[i]=arguments[e][i];return t}let on=cJ;typeof Object.assign=="function"&&(on=Object.assign);function Cr(t,e,n,i){const r=t._nodes.get(e);let s=null;return r&&(i==="mixed"?s=r.out&&r.out[n]||r.undirected&&r.undirected[n]:i==="directed"?s=r.out&&r.out[n]:s=r.undirected&&r.undirected[n]),s}function Pn(t){return typeof t=="object"&&t!==null}function mF(t){let e;for(e in t)return!1;return!0}function nr(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,writable:!0,value:n})}function Or(t,e,n){const i={enumerable:!0,configurable:!0};typeof n=="function"?i.get=n:(i.value=n,i.writable=!1),Object.defineProperty(t,e,i)}function XT(t){return!(!Pn(t)||t.attributes&&!Array.isArray(t.attributes))}function dJ(){let t=Math.floor(Math.random()*256)&255;return()=>t++}class E_ extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class ge extends E_{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ge.prototype.constructor)}}class ce extends E_{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ce.prototype.constructor)}}class De extends E_{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,De.prototype.constructor)}}function gF(t,e){this.key=t,this.attributes=e,this.clear()}gF.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function vF(t,e){this.key=t,this.attributes=e,this.clear()}vF.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function yF(t,e){this.key=t,this.attributes=e,this.clear()}yF.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function sd(t,e,n,i,r){this.key=e,this.attributes=r,this.undirected=t,this.source=n,this.target=i}sd.prototype.attach=function(){let t="out",e="in";this.undirected&&(t=e="undirected");const n=this.source.key,i=this.target.key;this.source[t][i]=this,!(this.undirected&&n===i)&&(this.target[e][n]=this)};sd.prototype.attachMulti=function(){let t="out",e="in";const n=this.source.key,i=this.target.key;this.undirected&&(t=e="undirected");const r=this.source[t],s=r[i];if(typeof s>"u"){r[i]=this,this.undirected&&n===i||(this.target[e][n]=this);return}s.previous=this,this.next=s,r[i]=this,this.target[e][n]=this};sd.prototype.detach=function(){const t=this.source.key,e=this.target.key;let n="out",i="in";this.undirected&&(n=i="undirected"),delete this.source[n][e],delete this.target[i][t]};sd.prototype.detachMulti=function(){const t=this.source.key,e=this.target.key;let n="out",i="in";this.undirected&&(n=i="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[n][e],delete this.target[i][t]):(this.next.previous=void 0,this.source[n][e]=this.next,this.target[i][t]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const wF=0,bF=1,hJ=2,xF=3;function Uo(t,e,n,i,r,s,o){let a,l,u,c;if(i=""+i,n===wF){if(a=t._nodes.get(i),!a)throw new ce(`Graph.${e}: could not find the "${i}" node in the graph.`);u=r,c=s}else if(n===xF){if(r=""+r,l=t._edges.get(r),!l)throw new ce(`Graph.${e}: could not find the "${r}" edge in the graph.`);const d=l.source.key,h=l.target.key;if(i===d)a=l.target;else if(i===h)a=l.source;else throw new ce(`Graph.${e}: the "${i}" node is not attached to the "${r}" edge (${d}, ${h}).`);u=s,c=o}else{if(l=t._edges.get(i),!l)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`);n===bF?a=l.source:a=l.target,u=r,c=s}return[a,u,c]}function fJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Uo(this,e,n,i,r,s);return o.attributes[a]}}function pJ(t,e,n){t.prototype[e]=function(i,r){const[s]=Uo(this,e,n,i,r);return s.attributes}}function mJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Uo(this,e,n,i,r,s);return o.attributes.hasOwnProperty(a)}}function gJ(t,e,n){t.prototype[e]=function(i,r,s,o){const[a,l,u]=Uo(this,e,n,i,r,s,o);return a.attributes[l]=u,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:l}),this}}function vJ(t,e,n){t.prototype[e]=function(i,r,s,o){const[a,l,u]=Uo(this,e,n,i,r,s,o);if(typeof u!="function")throw new ge(`Graph.${e}: updater should be a function.`);const c=a.attributes,d=u(c[l]);return c[l]=d,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:l}),this}}function yJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Uo(this,e,n,i,r,s);return delete o.attributes[a],this.emit("nodeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:a}),this}}function wJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Uo(this,e,n,i,r,s);if(!Pn(a))throw new ge(`Graph.${e}: provided attributes are not a plain object.`);return o.attributes=a,this.emit("nodeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function bJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Uo(this,e,n,i,r,s);if(!Pn(a))throw new ge(`Graph.${e}: provided attributes are not a plain object.`);return on(o.attributes,a),this.emit("nodeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:a}),this}}function xJ(t,e,n){t.prototype[e]=function(i,r,s){const[o,a]=Uo(this,e,n,i,r,s);if(typeof a!="function")throw new ge(`Graph.${e}: provided updater is not a function.`);return o.attributes=a(o.attributes),this.emit("nodeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const SJ=[{name:t=>`get${t}Attribute`,attacher:fJ},{name:t=>`get${t}Attributes`,attacher:pJ},{name:t=>`has${t}Attribute`,attacher:mJ},{name:t=>`set${t}Attribute`,attacher:gJ},{name:t=>`update${t}Attribute`,attacher:vJ},{name:t=>`remove${t}Attribute`,attacher:yJ},{name:t=>`replace${t}Attributes`,attacher:wJ},{name:t=>`merge${t}Attributes`,attacher:bJ},{name:t=>`update${t}Attributes`,attacher:xJ}];function kJ(t){SJ.forEach(function({name:e,attacher:n}){n(t,e("Node"),wF),n(t,e("Source"),bF),n(t,e("Target"),hJ),n(t,e("Opposite"),xF)})}function _J(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new De(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new De(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new De(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return s.attributes[r]}}function CJ(t,e,n){t.prototype[e]=function(i){let r;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new De(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new De(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+i,o=""+arguments[1];if(r=Cr(this,s,o,n),!r)throw new ce(`Graph.${e}: could not find an edge for the given path ("${s}" - "${o}").`)}else{if(n!=="mixed")throw new De(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,r=this._edges.get(i),!r)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return r.attributes}}function EJ(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new De(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new De(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new De(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return s.attributes.hasOwnProperty(r)}}function AJ(t,e,n){t.prototype[e]=function(i,r,s){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new De(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new De(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,l=""+r;if(r=arguments[2],s=arguments[3],o=Cr(this,a,l,n),!o)throw new ce(`Graph.${e}: could not find an edge for the given path ("${a}" - "${l}").`)}else{if(n!=="mixed")throw new De(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return o.attributes[r]=s,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}function PJ(t,e,n){t.prototype[e]=function(i,r,s){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new De(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new De(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,l=""+r;if(r=arguments[2],s=arguments[3],o=Cr(this,a,l,n),!o)throw new ce(`Graph.${e}: could not find an edge for the given path ("${a}" - "${l}").`)}else{if(n!=="mixed")throw new De(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,o=this._edges.get(i),!o)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(typeof s!="function")throw new ge(`Graph.${e}: updater should be a function.`);return o.attributes[r]=s(o.attributes[r]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}function TJ(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new De(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new De(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new De(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}return delete s.attributes[r],this.emit("edgeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:r}),this}}function RJ(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new De(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new De(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new De(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(!Pn(r))throw new ge(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=r,this.emit("edgeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function NJ(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new De(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new De(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new De(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(!Pn(r))throw new ge(`Graph.${e}: provided attributes are not a plain object.`);return on(s.attributes,r),this.emit("edgeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:r}),this}}function MJ(t,e,n){t.prototype[e]=function(i,r){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new De(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new De(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+r;if(r=arguments[2],s=Cr(this,o,a,n),!s)throw new ce(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new De(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(i=""+i,s=this._edges.get(i),!s)throw new ce(`Graph.${e}: could not find the "${i}" edge in the graph.`)}if(typeof r!="function")throw new ge(`Graph.${e}: provided updater is not a function.`);return s.attributes=r(s.attributes),this.emit("edgeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}const OJ=[{name:t=>`get${t}Attribute`,attacher:_J},{name:t=>`get${t}Attributes`,attacher:CJ},{name:t=>`has${t}Attribute`,attacher:EJ},{name:t=>`set${t}Attribute`,attacher:AJ},{name:t=>`update${t}Attribute`,attacher:PJ},{name:t=>`remove${t}Attribute`,attacher:TJ},{name:t=>`replace${t}Attributes`,attacher:RJ},{name:t=>`merge${t}Attributes`,attacher:NJ},{name:t=>`update${t}Attributes`,attacher:MJ}];function DJ(t){OJ.forEach(function({name:e,attacher:n}){n(t,e("Edge"),"mixed"),n(t,e("DirectedEdge"),"directed"),n(t,e("UndirectedEdge"),"undirected")})}const IJ=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function LJ(t,e,n,i){let r=!1;for(const s in e){if(s===i)continue;const o=e[s];if(r=n(o.key,o.attributes,o.source.key,o.target.key,o.source.attributes,o.target.attributes,o.undirected),t&&r)return o.key}}function jJ(t,e,n,i){let r,s,o,a=!1;for(const l in e)if(l!==i){r=e[l];do{if(s=r.source,o=r.target,a=n(r.key,r.attributes,s.key,o.key,s.attributes,o.attributes,r.undirected),t&&a)return r.key;r=r.next}while(r!==void 0)}}function Fw(t,e){const n=Object.keys(t),i=n.length;let r,s=0;return new Nr(function(){do if(r)r=r.next;else{if(s>=i)return{done:!0};const a=n[s++];if(a===e){r=void 0;continue}r=t[a]}while(!r);return{done:!1,value:{edge:r.key,attributes:r.attributes,source:r.source.key,target:r.target.key,sourceAttributes:r.source.attributes,targetAttributes:r.target.attributes,undirected:r.undirected}}})}function FJ(t,e,n,i){const r=e[n];if(!r)return;const s=r.source,o=r.target;if(i(r.key,r.attributes,s.key,o.key,s.attributes,o.attributes,r.undirected)&&t)return r.key}function BJ(t,e,n,i){let r=e[n];if(!r)return;let s=!1;do{if(s=i(r.key,r.attributes,r.source.key,r.target.key,r.source.attributes,r.target.attributes,r.undirected),t&&s)return r.key;r=r.next}while(r!==void 0)}function Bw(t,e){let n=t[e];return n.next!==void 0?new Nr(function(){if(!n)return{done:!0};const i={edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected};return n=n.next,{done:!1,value:i}}):Nr.of({edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected})}function $J(t,e){if(t.size===0)return[];if(e==="mixed"||e===t.type)return typeof Array.from=="function"?Array.from(t._edges.keys()):pF(t._edges.keys(),t._edges.size);const n=e==="undirected"?t.undirectedSize:t.directedSize,i=new Array(n),r=e==="undirected",s=t._edges.values();let o=0,a,l;for(;a=s.next(),a.done!==!0;)l=a.value,l.undirected===r&&(i[o++]=l.key);return i}function SF(t,e,n,i){if(e.size===0)return;const r=n!=="mixed"&&n!==e.type,s=n==="undirected";let o,a,l=!1;const u=e._edges.values();for(;o=u.next(),o.done!==!0;){if(a=o.value,r&&a.undirected!==s)continue;const{key:c,attributes:d,source:h,target:f}=a;if(l=i(c,d,h.key,f.key,h.attributes,f.attributes,a.undirected),t&&l)return c}}function zJ(t,e){if(t.size===0)return Nr.empty();const n=e!=="mixed"&&e!==t.type,i=e==="undirected",r=t._edges.values();return new Nr(function(){let o,a;for(;;){if(o=r.next(),o.done)return o;if(a=o.value,!(n&&a.undirected!==i))break}return{value:{edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected},done:!1}})}function A_(t,e,n,i,r,s){const o=e?jJ:LJ;let a;if(n!=="undirected"&&(i!=="out"&&(a=o(t,r.in,s),t&&a)||i!=="in"&&(a=o(t,r.out,s,i?void 0:r.key),t&&a))||n!=="directed"&&(a=o(t,r.undirected,s),t&&a))return a}function UJ(t,e,n,i){const r=[];return A_(!1,t,e,n,i,function(s){r.push(s)}),r}function VJ(t,e,n){let i=Nr.empty();return t!=="undirected"&&(e!=="out"&&typeof n.in<"u"&&(i=_o(i,Fw(n.in))),e!=="in"&&typeof n.out<"u"&&(i=_o(i,Fw(n.out,e?void 0:n.key)))),t!=="directed"&&typeof n.undirected<"u"&&(i=_o(i,Fw(n.undirected))),i}function P_(t,e,n,i,r,s,o){const a=n?BJ:FJ;let l;if(e!=="undirected"&&(typeof r.in<"u"&&i!=="out"&&(l=a(t,r.in,s,o),t&&l)||typeof r.out<"u"&&i!=="in"&&(i||r.key!==s)&&(l=a(t,r.out,s,o),t&&l))||e!=="directed"&&typeof r.undirected<"u"&&(l=a(t,r.undirected,s,o),t&&l))return l}function HJ(t,e,n,i,r){const s=[];return P_(!1,t,e,n,i,r,function(o){s.push(o)}),s}function WJ(t,e,n,i){let r=Nr.empty();return t!=="undirected"&&(typeof n.in<"u"&&e!=="out"&&i in n.in&&(r=_o(r,Bw(n.in,i))),typeof n.out<"u"&&e!=="in"&&i in n.out&&(e||n.key!==i)&&(r=_o(r,Bw(n.out,i)))),t!=="directed"&&typeof n.undirected<"u"&&i in n.undirected&&(r=_o(r,Bw(n.undirected,i))),r}function GJ(t,e){const{name:n,type:i,direction:r}=e;t.prototype[n]=function(s,o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];if(!arguments.length)return $J(this,i);if(arguments.length===1){s=""+s;const a=this._nodes.get(s);if(typeof a>"u")throw new ce(`Graph.${n}: could not find the "${s}" node in the graph.`);return UJ(this.multi,i==="mixed"?this.type:i,r,a)}if(arguments.length===2){s=""+s,o=""+o;const a=this._nodes.get(s);if(!a)throw new ce(`Graph.${n}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(o))throw new ce(`Graph.${n}:  could not find the "${o}" target node in the graph.`);return HJ(i,this.multi,r,a,o)}throw new ge(`Graph.${n}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function KJ(t,e){const{name:n,type:i,direction:r}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(u,c,d){if(!(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)){if(arguments.length===1)return d=u,SF(!1,this,i,d);if(arguments.length===2){u=""+u,d=c;const h=this._nodes.get(u);if(typeof h>"u")throw new ce(`Graph.${s}: could not find the "${u}" node in the graph.`);return A_(!1,this.multi,i==="mixed"?this.type:i,r,h,d)}if(arguments.length===3){u=""+u,c=""+c;const h=this._nodes.get(u);if(!h)throw new ce(`Graph.${s}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(c))throw new ce(`Graph.${s}:  could not find the "${c}" target node in the graph.`);return P_(!1,i,this.multi,r,h,c,d)}throw new ge(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop();let d;if(u.length===0){let h=0;i!=="directed"&&(h+=this.undirectedSize),i!=="undirected"&&(h+=this.directedSize),d=new Array(h);let f=0;u.push((p,m,w,v,y,b,k)=>{d[f++]=c(p,m,w,v,y,b,k)})}else d=[],u.push((h,f,p,m,w,v,y)=>{d.push(c(h,f,p,m,w,v,y))});return this[s].apply(this,u),d};const a="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop(),d=[];return u.push((h,f,p,m,w,v,y)=>{c(h,f,p,m,w,v,y)&&d.push(h)}),this[s].apply(this,u),d};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(){let u=Array.prototype.slice.call(arguments);if(u.length<2||u.length>4)throw new ge(`Graph.${l}: invalid number of arguments (expecting 2, 3 or 4 and got ${u.length}).`);if(typeof u[u.length-1]=="function"&&typeof u[u.length-2]!="function")throw new ge(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let c,d;u.length===2?(c=u[0],d=u[1],u=[]):u.length===3?(c=u[1],d=u[2],u=[u[0]]):u.length===4&&(c=u[2],d=u[3],u=[u[0],u[1]]);let h=d;return u.push((f,p,m,w,v,y,b)=>{h=c(h,f,p,m,w,v,y,b)}),this[s].apply(this,u),h}}function XJ(t,e){const{name:n,type:i,direction:r}=e,s="find"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(l,u,c){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return!1;if(arguments.length===1)return c=l,SF(!0,this,i,c);if(arguments.length===2){l=""+l,c=u;const d=this._nodes.get(l);if(typeof d>"u")throw new ce(`Graph.${s}: could not find the "${l}" node in the graph.`);return A_(!0,this.multi,i==="mixed"?this.type:i,r,d,c)}if(arguments.length===3){l=""+l,u=""+u;const d=this._nodes.get(l);if(!d)throw new ce(`Graph.${s}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(u))throw new ce(`Graph.${s}:  could not find the "${u}" target node in the graph.`);return P_(!0,i,this.multi,r,d,u,c)}throw new ge(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const o="some"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[o]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((d,h,f,p,m,w,v)=>u(d,h,f,p,m,w,v)),!!this[s].apply(this,l)};const a="every"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[a]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((d,h,f,p,m,w,v)=>!u(d,h,f,p,m,w,v)),!this[s].apply(this,l)}}function qJ(t,e){const{name:n,type:i,direction:r}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(o,a){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return Nr.empty();if(!arguments.length)return zJ(this,i);if(arguments.length===1){o=""+o;const l=this._nodes.get(o);if(!l)throw new ce(`Graph.${s}: could not find the "${o}" node in the graph.`);return VJ(i,r,l)}if(arguments.length===2){o=""+o,a=""+a;const l=this._nodes.get(o);if(!l)throw new ce(`Graph.${s}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new ce(`Graph.${s}:  could not find the "${a}" target node in the graph.`);return WJ(i,r,l,a)}throw new ge(`Graph.${s}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function YJ(t){IJ.forEach(e=>{GJ(t,e),KJ(t,e),XJ(t,e),qJ(t,e)})}const JJ=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function qy(){this.A=null,this.B=null}qy.prototype.wrap=function(t){this.A===null?this.A=t:this.B===null&&(this.B=t)};qy.prototype.has=function(t){return this.A!==null&&t in this.A||this.B!==null&&t in this.B};function Rd(t,e,n,i,r){for(const s in i){const o=i[s],a=o.source,l=o.target,u=a===n?l:a;if(e&&e.has(u.key))continue;const c=r(u.key,u.attributes);if(t&&c)return u.key}}function T_(t,e,n,i,r){if(e!=="mixed"){if(e==="undirected")return Rd(t,null,i,i.undirected,r);if(typeof n=="string")return Rd(t,null,i,i[n],r)}const s=new qy;let o;if(e!=="undirected"){if(n!=="out"){if(o=Rd(t,null,i,i.in,r),t&&o)return o;s.wrap(i.in)}if(n!=="in"){if(o=Rd(t,s,i,i.out,r),t&&o)return o;s.wrap(i.out)}}if(e!=="directed"&&(o=Rd(t,s,i,i.undirected,r),t&&o))return o}function ZJ(t,e,n){if(t!=="mixed"){if(t==="undirected")return Object.keys(n.undirected);if(typeof e=="string")return Object.keys(n[e])}const i=[];return T_(!1,t,e,n,function(r){i.push(r)}),i}function Nd(t,e,n){const i=Object.keys(n),r=i.length;let s=0;return new Nr(function(){let a=null;do{if(s>=r)return t&&t.wrap(n),{done:!0};const l=n[i[s++]],u=l.source,c=l.target;if(a=u===e?c:u,t&&t.has(a.key)){a=null;continue}}while(a===null);return{done:!1,value:{neighbor:a.key,attributes:a.attributes}}})}function QJ(t,e,n){if(t!=="mixed"){if(t==="undirected")return Nd(null,n,n.undirected);if(typeof e=="string")return Nd(null,n,n[e])}let i=Nr.empty();const r=new qy;return t!=="undirected"&&(e!=="out"&&(i=_o(i,Nd(r,n,n.in))),e!=="in"&&(i=_o(i,Nd(r,n,n.out)))),t!=="directed"&&(i=_o(i,Nd(r,n,n.undirected))),i}function eZ(t,e){const{name:n,type:i,direction:r}=e;t.prototype[n]=function(s){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];s=""+s;const o=this._nodes.get(s);if(typeof o>"u")throw new ce(`Graph.${n}: could not find the "${s}" node in the graph.`);return ZJ(i==="mixed"?this.type:i,r,o)}}function tZ(t,e){const{name:n,type:i,direction:r}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(u,c){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;u=""+u;const d=this._nodes.get(u);if(typeof d>"u")throw new ce(`Graph.${s}: could not find the "${u}" node in the graph.`);T_(!1,i==="mixed"?this.type:i,r,d,c)};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(u,c){const d=[];return this[s](u,(h,f)=>{d.push(c(h,f))}),d};const a="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(u,c){const d=[];return this[s](u,(h,f)=>{c(h,f)&&d.push(h)}),d};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(u,c,d){if(arguments.length<3)throw new ge(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let h=d;return this[s](u,(f,p)=>{h=c(h,f,p)}),h}}function nZ(t,e){const{name:n,type:i,direction:r}=e,s=n[0].toUpperCase()+n.slice(1,-1),o="find"+s;t.prototype[o]=function(u,c){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;u=""+u;const d=this._nodes.get(u);if(typeof d>"u")throw new ce(`Graph.${o}: could not find the "${u}" node in the graph.`);return T_(!0,i==="mixed"?this.type:i,r,d,c)};const a="some"+s;t.prototype[a]=function(u,c){return!!this[o](u,c)};const l="every"+s;t.prototype[l]=function(u,c){return!this[o](u,(h,f)=>!c(h,f))}}function iZ(t,e){const{name:n,type:i,direction:r}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return Nr.empty();o=""+o;const a=this._nodes.get(o);if(typeof a>"u")throw new ce(`Graph.${s}: could not find the "${o}" node in the graph.`);return QJ(i==="mixed"?this.type:i,r,a)}}function rZ(t){JJ.forEach(e=>{eZ(t,e),tZ(t,e),nZ(t,e),iZ(t,e)})}function gm(t,e,n,i,r){const s=i._nodes.values(),o=i.type;let a,l,u,c,d,h;for(;a=s.next(),a.done!==!0;){let f=!1;if(l=a.value,o!=="undirected"){c=l.out;for(u in c){d=c[u];do h=d.target,f=!0,r(l.key,h.key,l.attributes,h.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}if(o!=="directed"){c=l.undirected;for(u in c)if(!(e&&l.key>u)){d=c[u];do h=d.target,h.key!==u&&(h=d.source),f=!0,r(l.key,h.key,l.attributes,h.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}n&&!f&&r(l.key,null,l.attributes,null,null,null,null)}}function sZ(t,e){const n={key:t};return mF(e.attributes)||(n.attributes=on({},e.attributes)),n}function oZ(t,e,n){const i={key:e,source:n.source.key,target:n.target.key};return mF(n.attributes)||(i.attributes=on({},n.attributes)),t==="mixed"&&n.undirected&&(i.undirected=!0),i}function aZ(t){if(!Pn(t))throw new ge('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in t))throw new ge("Graph.import: serialized node is missing its key.");if("attributes"in t&&(!Pn(t.attributes)||t.attributes===null))throw new ge("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function lZ(t){if(!Pn(t))throw new ge('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in t))throw new ge("Graph.import: serialized edge is missing its source.");if(!("target"in t))throw new ge("Graph.import: serialized edge is missing its target.");if("attributes"in t&&(!Pn(t.attributes)||t.attributes===null))throw new ge("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in t&&typeof t.undirected!="boolean")throw new ge("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const uZ=dJ(),cZ=new Set(["directed","undirected","mixed"]),qT=new Set(["domain","_events","_eventsCount","_maxListeners"]),dZ=[{name:t=>`${t}Edge`,generateKey:!0},{name:t=>`${t}DirectedEdge`,generateKey:!0,type:"directed"},{name:t=>`${t}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:t=>`${t}EdgeWithKey`},{name:t=>`${t}DirectedEdgeWithKey`,type:"directed"},{name:t=>`${t}UndirectedEdgeWithKey`,type:"undirected"}],hZ={allowSelfLoops:!0,multi:!1,type:"mixed"};function fZ(t,e,n){if(n&&!Pn(n))throw new ge(`Graph.addNode: invalid attributes. Expecting an object but got "${n}"`);if(e=""+e,n=n||{},t._nodes.has(e))throw new De(`Graph.addNode: the "${e}" node already exist in the graph.`);const i=new t.NodeDataClass(e,n);return t._nodes.set(e,i),t.emit("nodeAdded",{key:e,attributes:n}),i}function YT(t,e,n){const i=new t.NodeDataClass(e,n);return t._nodes.set(e,i),t.emit("nodeAdded",{key:e,attributes:n}),i}function kF(t,e,n,i,r,s,o,a){if(!i&&t.type==="undirected")throw new De(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(i&&t.type==="directed")throw new De(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(a&&!Pn(a))throw new ge(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`);if(s=""+s,o=""+o,a=a||{},!t.allowSelfLoops&&s===o)throw new De(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const l=t._nodes.get(s),u=t._nodes.get(o);if(!l)throw new ce(`Graph.${e}: source node "${s}" not found.`);if(!u)throw new ce(`Graph.${e}: target node "${o}" not found.`);const c={key:null,undirected:i,source:s,target:o,attributes:a};if(n)r=t._edgeKeyGenerator();else if(r=""+r,t._edges.has(r))throw new De(`Graph.${e}: the "${r}" edge already exists in the graph.`);if(!t.multi&&(i?typeof l.undirected[o]<"u":typeof l.out[o]<"u"))throw new De(`Graph.${e}: an edge linking "${s}" to "${o}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const d=new sd(i,r,l,u,a);t._edges.set(r,d);const h=s===o;return i?(l.undirectedDegree++,u.undirectedDegree++,h&&(l.undirectedLoops++,t._undirectedSelfLoopCount++)):(l.outDegree++,u.inDegree++,h&&(l.directedLoops++,t._directedSelfLoopCount++)),t.multi?d.attachMulti():d.attach(),i?t._undirectedSize++:t._directedSize++,c.key=r,t.emit("edgeAdded",c),r}function pZ(t,e,n,i,r,s,o,a,l){if(!i&&t.type==="undirected")throw new De(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(i&&t.type==="directed")throw new De(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(a){if(l){if(typeof a!="function")throw new ge(`Graph.${e}: invalid updater function. Expecting a function but got "${a}"`)}else if(!Pn(a))throw new ge(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`)}s=""+s,o=""+o;let u;if(l&&(u=a,a=void 0),!t.allowSelfLoops&&s===o)throw new De(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let c=t._nodes.get(s),d=t._nodes.get(o),h,f;if(!n&&(h=t._edges.get(r),h)){if((h.source.key!==s||h.target.key!==o)&&(!i||h.source.key!==o||h.target.key!==s))throw new De(`Graph.${e}: inconsistency detected when attempting to merge the "${r}" edge with "${s}" source & "${o}" target vs. ("${h.source.key}", "${h.target.key}").`);f=h}if(!f&&!t.multi&&c&&(f=i?c.undirected[o]:c.out[o]),f){const y=[f.key,!1,!1,!1];if(l?!u:!a)return y;if(l){const b=f.attributes;f.attributes=u(b),t.emit("edgeAttributesUpdated",{type:"replace",key:f.key,attributes:f.attributes})}else on(f.attributes,a),t.emit("edgeAttributesUpdated",{type:"merge",key:f.key,attributes:f.attributes,data:a});return y}a=a||{},l&&u&&(a=u(a));const p={key:null,undirected:i,source:s,target:o,attributes:a};if(n)r=t._edgeKeyGenerator();else if(r=""+r,t._edges.has(r))throw new De(`Graph.${e}: the "${r}" edge already exists in the graph.`);let m=!1,w=!1;c||(c=YT(t,s,{}),m=!0,s===o&&(d=c,w=!0)),d||(d=YT(t,o,{}),w=!0),h=new sd(i,r,c,d,a),t._edges.set(r,h);const v=s===o;return i?(c.undirectedDegree++,d.undirectedDegree++,v&&(c.undirectedLoops++,t._undirectedSelfLoopCount++)):(c.outDegree++,d.inDegree++,v&&(c.directedLoops++,t._directedSelfLoopCount++)),t.multi?h.attachMulti():h.attach(),i?t._undirectedSize++:t._directedSize++,p.key=r,t.emit("edgeAdded",p),[r,!0,m,w]}function bu(t,e){t._edges.delete(e.key);const{source:n,target:i,attributes:r}=e,s=e.undirected,o=n===i;s?(n.undirectedDegree--,i.undirectedDegree--,o&&(n.undirectedLoops--,t._undirectedSelfLoopCount--)):(n.outDegree--,i.inDegree--,o&&(n.directedLoops--,t._directedSelfLoopCount--)),t.multi?e.detachMulti():e.detach(),s?t._undirectedSize--:t._directedSize--,t.emit("edgeDropped",{key:e.key,attributes:r,source:n.key,target:i.key,undirected:s})}class St extends eJ.EventEmitter{constructor(e){if(super(),e=on({},hZ,e),typeof e.multi!="boolean")throw new ge(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!cZ.has(e.type))throw new ge(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new ge(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const n=e.type==="mixed"?gF:e.type==="directed"?vF:yF;nr(this,"NodeDataClass",n);const i="geid_"+uZ()+"_";let r=0;const s=()=>{let o;do o=i+r++;while(this._edges.has(o));return o};nr(this,"_attributes",{}),nr(this,"_nodes",new Map),nr(this,"_edges",new Map),nr(this,"_directedSize",0),nr(this,"_undirectedSize",0),nr(this,"_directedSelfLoopCount",0),nr(this,"_undirectedSelfLoopCount",0),nr(this,"_edgeKeyGenerator",s),nr(this,"_options",e),qT.forEach(o=>nr(this,o,this[o])),Or(this,"order",()=>this._nodes.size),Or(this,"size",()=>this._edges.size),Or(this,"directedSize",()=>this._directedSize),Or(this,"undirectedSize",()=>this._undirectedSize),Or(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),Or(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),Or(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),Or(this,"multi",this._options.multi),Or(this,"type",this._options.type),Or(this,"allowSelfLoops",this._options.allowSelfLoops),Or(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,n){if(this.type==="undirected")return!1;if(arguments.length===1){const i=""+e,r=this._edges.get(i);return!!r&&!r.undirected}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?i.out.hasOwnProperty(n):!1}throw new ge(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,n){if(this.type==="directed")return!1;if(arguments.length===1){const i=""+e,r=this._edges.get(i);return!!r&&r.undirected}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?i.undirected.hasOwnProperty(n):!1}throw new ge(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,n){if(arguments.length===1){const i=""+e;return this._edges.has(i)}else if(arguments.length===2){e=""+e,n=""+n;const i=this._nodes.get(e);return i?typeof i.out<"u"&&i.out.hasOwnProperty(n)||typeof i.undirected<"u"&&i.undirected.hasOwnProperty(n):!1}throw new ge(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,n){if(this.type==="undirected")return;if(e=""+e,n=""+n,this.multi)throw new De("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const i=this._nodes.get(e);if(!i)throw new ce(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ce(`Graph.directedEdge: could not find the "${n}" target node in the graph.`);const r=i.out&&i.out[n]||void 0;if(r)return r.key}undirectedEdge(e,n){if(this.type==="directed")return;if(e=""+e,n=""+n,this.multi)throw new De("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const i=this._nodes.get(e);if(!i)throw new ce(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ce(`Graph.undirectedEdge: could not find the "${n}" target node in the graph.`);const r=i.undirected&&i.undirected[n]||void 0;if(r)return r.key}edge(e,n){if(this.multi)throw new De("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ce(`Graph.edge: could not find the "${n}" target node in the graph.`);const r=i.out&&i.out[n]||i.undirected&&i.undirected[n]||void 0;if(r)return r.key}areDirectedNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.in||n in i.out}areOutNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.out}areInNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in i.in}areUndirectedNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:n in i.undirected}areNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(n in i.in||n in i.out)||this.type!=="directed"&&n in i.undirected}areInboundNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in i.in||this.type!=="directed"&&n in i.undirected}areOutboundNeighbors(e,n){e=""+e,n=""+n;const i=this._nodes.get(e);if(!i)throw new ce(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in i.out||this.type!=="directed"&&n in i.undirected}inDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree}outDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree}directedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree}undirectedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree}inboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.inDegree),i}outboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.outDegree),i}degree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.degree: could not find the "${e}" node in the graph.`);let i=0;return this.type!=="directed"&&(i+=n.undirectedDegree),this.type!=="undirected"&&(i+=n.inDegree+n.outDegree),i}inDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree-n.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree-n.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree-n.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree-n.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.inDegree,r+=n.directedLoops),i-r}outboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.outDegree,r+=n.directedLoops),i-r}degreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let i=0,r=0;return this.type!=="directed"&&(i+=n.undirectedDegree,r+=n.undirectedLoops*2),this.type!=="undirected"&&(i+=n.inDegree+n.outDegree,r+=n.directedLoops*2),i-r}source(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.source: could not find the "${e}" edge in the graph.`);return n.source.key}target(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.target: could not find the "${e}" edge in the graph.`);return n.target.key}extremities(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[n.source.key,n.target.key]}opposite(e,n){e=""+e,n=""+n;const i=this._edges.get(n);if(!i)throw new ce(`Graph.opposite: could not find the "${n}" edge in the graph.`);const r=i.source.key,s=i.target.key;if(e===r)return s;if(e===s)return r;throw new ce(`Graph.opposite: the "${e}" node is not attached to the "${n}" edge (${r}, ${s}).`)}hasExtremity(e,n){e=""+e,n=""+n;const i=this._edges.get(e);if(!i)throw new ce(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return i.source.key===n||i.target.key===n}isUndirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return n.undirected}isDirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!n.undirected}isSelfLoop(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ce(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return n.source===n.target}addNode(e,n){return fZ(this,e,n).key}mergeNode(e,n){if(n&&!Pn(n))throw new ge(`Graph.mergeNode: invalid attributes. Expecting an object but got "${n}"`);e=""+e,n=n||{};let i=this._nodes.get(e);return i?(n&&(on(i.attributes,n),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:i.attributes,data:n})),[e,!1]):(i=new this.NodeDataClass(e,n),this._nodes.set(e,i),this.emit("nodeAdded",{key:e,attributes:n}),[e,!0])}updateNode(e,n){if(n&&typeof n!="function")throw new ge(`Graph.updateNode: invalid updater function. Expecting a function but got "${n}"`);e=""+e;let i=this._nodes.get(e);if(i){if(n){const s=i.attributes;i.attributes=n(s),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:i.attributes})}return[e,!1]}const r=n?n({}):{};return i=new this.NodeDataClass(e,r),this._nodes.set(e,i),this.emit("nodeAdded",{key:e,attributes:r}),[e,!0]}dropNode(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ce(`Graph.dropNode: could not find the "${e}" node in the graph.`);let i;if(this.type!=="undirected"){for(const r in n.out){i=n.out[r];do bu(this,i),i=i.next;while(i)}for(const r in n.in){i=n.in[r];do bu(this,i),i=i.next;while(i)}}if(this.type!=="directed")for(const r in n.undirected){i=n.undirected[r];do bu(this,i),i=i.next;while(i)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:n.attributes})}dropEdge(e){let n;if(arguments.length>1){const i=""+arguments[0],r=""+arguments[1];if(n=Cr(this,i,r,this.type),!n)throw new ce(`Graph.dropEdge: could not find the "${i}" -> "${r}" edge in the graph.`)}else if(e=""+e,n=this._edges.get(e),!n)throw new ce(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return bu(this,n),this}dropDirectedEdge(e,n){if(arguments.length<2)throw new De("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new De("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,n=""+n;const i=Cr(this,e,n,"directed");if(!i)throw new ce(`Graph.dropDirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return bu(this,i),this}dropUndirectedEdge(e,n){if(arguments.length<2)throw new De("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new De("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const i=Cr(this,e,n,"undirected");if(!i)throw new ce(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return bu(this,i),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let n;for(;n=e.next(),n.done!==!0;)n.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,n){return this._attributes[e]=n,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,n){if(typeof n!="function")throw new ge("Graph.updateAttribute: updater should be a function.");const i=this._attributes[e];return this._attributes[e]=n(i),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!Pn(e))throw new ge("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!Pn(e))throw new ge("Graph.mergeAttributes: provided attributes are not a plain object.");return on(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new ge("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,n){if(typeof e!="function")throw new ge("Graph.updateEachNodeAttributes: expecting an updater function.");if(n&&!XT(n))throw new ge("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._nodes.values();let r,s;for(;r=i.next(),r.done!==!0;)s=r.value,s.attributes=e(s.key,s.attributes);this.emit("eachNodeAttributesUpdated",{hints:n||null})}updateEachEdgeAttributes(e,n){if(typeof e!="function")throw new ge("Graph.updateEachEdgeAttributes: expecting an updater function.");if(n&&!XT(n))throw new ge("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._edges.values();let r,s,o,a;for(;r=i.next(),r.done!==!0;)s=r.value,o=s.source,a=s.target,s.attributes=e(s.key,s.attributes,o.key,a.key,o.attributes,a.attributes,s.undirected);this.emit("eachEdgeAttributesUpdated",{hints:n||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new ge("Graph.forEachAdjacencyEntry: expecting a callback.");gm(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new ge("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");gm(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new ge("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");gm(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new ge("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");gm(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):pF(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new ge("Graph.forEachNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)r=i.value,e(r.key,r.attributes)}findNode(e){if(typeof e!="function")throw new ge("Graph.findNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,e(r.key,r.attributes))return r.key}mapNodes(e){if(typeof e!="function")throw new ge("Graph.mapNode: expecting a callback.");const n=this._nodes.values();let i,r;const s=new Array(this.order);let o=0;for(;i=n.next(),i.done!==!0;)r=i.value,s[o++]=e(r.key,r.attributes);return s}someNode(e){if(typeof e!="function")throw new ge("Graph.someNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,e(r.key,r.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new ge("Graph.everyNode: expecting a callback.");const n=this._nodes.values();let i,r;for(;i=n.next(),i.done!==!0;)if(r=i.value,!e(r.key,r.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new ge("Graph.filterNodes: expecting a callback.");const n=this._nodes.values();let i,r;const s=[];for(;i=n.next(),i.done!==!0;)r=i.value,e(r.key,r.attributes)&&s.push(r.key);return s}reduceNodes(e,n){if(typeof e!="function")throw new ge("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new ge("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let i=n;const r=this._nodes.values();let s,o;for(;s=r.next(),s.done!==!0;)o=s.value,i=e(i,o.key,o.attributes);return i}nodeEntries(){const e=this._nodes.values();return new Nr(()=>{const n=e.next();if(n.done)return n;const i=n.value;return{value:{node:i.key,attributes:i.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let n=0;this._nodes.forEach((r,s)=>{e[n++]=sZ(s,r)});const i=new Array(this._edges.size);return n=0,this._edges.forEach((r,s)=>{i[n++]=oZ(this.type,s,r)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:i}}import(e,n=!1){if(e instanceof St)return e.forEachNode((l,u)=>{n?this.mergeNode(l,u):this.addNode(l,u)}),e.forEachEdge((l,u,c,d,h,f,p)=>{n?p?this.mergeUndirectedEdgeWithKey(l,c,d,u):this.mergeDirectedEdgeWithKey(l,c,d,u):p?this.addUndirectedEdgeWithKey(l,c,d,u):this.addDirectedEdgeWithKey(l,c,d,u)}),this;if(!Pn(e))throw new ge("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!Pn(e.attributes))throw new ge("Graph.import: invalid attributes. Expecting a plain object.");n?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let i,r,s,o,a;if(e.nodes){if(s=e.nodes,!Array.isArray(s))throw new ge("Graph.import: invalid nodes. Expecting an array.");for(i=0,r=s.length;i<r;i++){o=s[i],aZ(o);const{key:l,attributes:u}=o;n?this.mergeNode(l,u):this.addNode(l,u)}}if(e.edges){let l=!1;if(this.type==="undirected"&&(l=!0),s=e.edges,!Array.isArray(s))throw new ge("Graph.import: invalid edges. Expecting an array.");for(i=0,r=s.length;i<r;i++){a=s[i],lZ(a);const{source:u,target:c,attributes:d,undirected:h=l}=a;let f;"key"in a?(f=n?h?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:h?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,f.call(this,a.key,u,c,d)):(f=n?h?this.mergeUndirectedEdge:this.mergeDirectedEdge:h?this.addUndirectedEdge:this.addDirectedEdge,f.call(this,u,c,d))}}return this}nullCopy(e){const n=new St(on({},this._options,e));return n.replaceAttributes(on({},this.getAttributes())),n}emptyCopy(e){const n=this.nullCopy(e);return this._nodes.forEach((i,r)=>{const s=on({},i.attributes);i=new n.NodeDataClass(r,s),n._nodes.set(r,i)}),n}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new De(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new De("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new De("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const n=this.emptyCopy(e),i=this._edges.values();let r,s;for(;r=i.next(),r.done!==!0;)s=r.value,kF(n,"copy",!1,s.undirected,s.key,s.source.key,s.target.key,on({},s.attributes));return n}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((s,o)=>{e[o]=s.attributes});const n={},i={};this._edges.forEach((s,o)=>{const a=s.undirected?"--":"->";let l="",u=s.source.key,c=s.target.key,d;s.undirected&&u>c&&(d=u,u=c,c=d);const h=`(${u})${a}(${c})`;o.startsWith("geid_")?this.multi&&(typeof i[h]>"u"?i[h]=0:i[h]++,l+=`${i[h]}. `):l+=`[${o}]: `,l+=h,n[l]=s.attributes});const r={};for(const s in this)this.hasOwnProperty(s)&&!qT.has(s)&&typeof this[s]!="function"&&typeof s!="symbol"&&(r[s]=this[s]);return r.attributes=this._attributes,r.nodes=e,r.edges=n,nr(r,"constructor",this.constructor),r}}typeof Symbol<"u"&&(St.prototype[Symbol.for("nodejs.util.inspect.custom")]=St.prototype.inspect);dZ.forEach(t=>{["add","merge","update"].forEach(e=>{const n=t.name(e),i=e==="add"?kF:pZ;t.generateKey?St.prototype[n]=function(r,s,o){return i(this,n,!0,(t.type||this.type)==="undirected",null,r,s,o,e==="update")}:St.prototype[n]=function(r,s,o,a){return i(this,n,!1,(t.type||this.type)==="undirected",r,s,o,a,e==="update")}})});kJ(St);DJ(St);YJ(St);rZ(St);class _F extends St{constructor(e){const n=on({type:"directed"},e);if("multi"in n&&n.multi!==!1)throw new ge("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="directed")throw new ge('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class R_ extends St{constructor(e){const n=on({type:"undirected"},e);if("multi"in n&&n.multi!==!1)throw new ge("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="undirected")throw new ge('UndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class CF extends St{constructor(e){const n=on({multi:!0},e);if("multi"in n&&n.multi!==!0)throw new ge("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(n)}}class EF extends St{constructor(e){const n=on({type:"directed",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new ge("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="directed")throw new ge('MultiDirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class AF extends St{constructor(e){const n=on({type:"undirected",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new ge("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="undirected")throw new ge('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}function od(t){t.from=function(e,n){const i=on({},e.options,n),r=new t(i);return r.import(e),r}}od(St);od(_F);od(R_);od(CF);od(EF);od(AF);St.Graph=St;St.DirectedGraph=_F;St.UndirectedGraph=R_;St.MultiGraph=CF;St.MultiDirectedGraph=EF;St.MultiUndirectedGraph=AF;St.InvalidArgumentsGraphError=ge;St.NotFoundGraphError=ce;St.UsageGraphError=De;var mZ=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"},PF=Xy,gZ=PF.ARRAY_BUFFER_SUPPORT,vZ=PF.SYMBOL_SUPPORT,yZ=function(e,n){var i,r,s,o,a;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if(typeof n!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||gZ&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(s=0,o=e.length;s<o;s++)n(e[s],s);return}if(typeof e.forEach=="function"){e.forEach(n);return}if(vZ&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(i=e,s=0;a=i.next(),a.done!==!0;)n(a.value,s),s++;return}for(r in e)e.hasOwnProperty(r)&&n(e[r],r)},TF=Ky,wZ=yZ;function Qt(){this.clear()}Qt.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};Qt.prototype.enqueue=function(t){return this.items.push(t),++this.size};Qt.prototype.dequeue=function(){if(this.size){var t=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,t}};Qt.prototype.peek=function(){if(this.size)return this.items[this.offset]};Qt.prototype.forEach=function(t,e){e=arguments.length>1?e:this;for(var n=this.offset,i=0,r=this.items.length;n<r;n++,i++)t.call(e,this.items[n],i,this)};Qt.prototype.toArray=function(){return this.items.slice(this.offset)};Qt.prototype.values=function(){var t=this.items,e=this.offset;return new TF(function(){if(e>=t.length)return{done:!0};var n=t[e];return e++,{value:n,done:!1}})};Qt.prototype.entries=function(){var t=this.items,e=this.offset,n=0;return new TF(function(){if(e>=t.length)return{done:!0};var i=t[e];return e++,{value:[n++,i],done:!1}})};typeof Symbol<"u"&&(Qt.prototype[Symbol.iterator]=Qt.prototype.values);Qt.prototype.toString=function(){return this.toArray().join(",")};Qt.prototype.toJSON=function(){return this.toArray()};Qt.prototype.inspect=function(){var t=this.toArray();return Object.defineProperty(t,"constructor",{value:Qt,enumerable:!1}),t};typeof Symbol<"u"&&(Qt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Qt.prototype.inspect);Qt.from=function(t){var e=new Qt;return wZ(t,function(n){e.enqueue(n)}),e};Qt.of=function(){return Qt.from(arguments)};var bZ=function(e,n){var i=n.length;if(i!==0){var r=e.length;e.length+=i;for(var s=0;s<i;s++)e[r+s]=n[s]}},RF=mZ,xZ=bZ;function SZ(t,e,n){if(!RF(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');if(!t.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" target node does not exist in the given graph.');if(e=""+e,n=""+n,e===n)return[e];var i=t.inboundNeighbors.bind(t),r=t.outboundNeighbors.bind(t),s={},o={};s[e]=null,o[n]=null;var a=[e],l=[n],u,c,d,h,f,p,m,w,v=!1;e:for(;a.length&&l.length;)if(a.length<=l.length){for(u=a,a=[],f=0,m=u.length;f<m;f++)for(c=u[f],d=r(c),p=0,w=d.length;p<w;p++)if(h=d[p],h in s||(a.push(h),s[h]=c),h in o){v=!0;break e}}else for(u=l,l=[],f=0,m=u.length;f<m;f++)for(c=u[f],d=i(c),p=0,w=d.length;p<w;p++)if(h=d[p],h in o||(l.push(h),o[h]=c),h in s){v=!0;break e}if(!v)return null;for(var y=[];h;)y.unshift(h),h=s[h];for(h=o[y[y.length-1]];h;)y.push(h),h=o[h];return y.length?y:null}function NF(t,e,n){if(!RF(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!e.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" source node does not exist in the given graph.');n=""+n;var i=new Set,r={},s=0;r[n]=0;for(var o=[n],a,l,u;o.length!==0;){var c=[];for(a=0,l=o.length;a<l;a++)u=o[a],!i.has(u)&&(i.add(u),xZ(c,e[t](u)),r[u]=s);s++,o=c}return r}NF.bind(null,"outboundNeighbors");NF.bind(null,"neighbors");var kZ=SZ;const Ce=new R_({allowSelfLoops:!1});Ce.addNode("MBR",{position:[610,250]});Ce.addNode("AX",{position:[522,45]});Ce.addNode("BX",{position:[522,85]});Ce.addNode("CX",{position:[522,125]});Ce.addNode("DX",{position:[522,165]});Ce.addNode("id",{position:[522,205]});Ce.addNode("IP",{position:[451,309]});Ce.addNode("SP",{position:[451,349]});Ce.addNode("ri",{position:[451,388]});Ce.addNode("result",{position:[370,130]});Ce.addNode("FLAGS",{position:[250,225]});Ce.addNode("IR",{position:[205,272]});Ce.addNode("left",{position:[60,85]});Ce.addNode("right",{position:[60,145]});Ce.addNode("AX join",{position:[492,45]});Ce.addNode("BX join",{position:[492,85]});Ce.addNode("CX join",{position:[492,125]});Ce.addNode("DX join",{position:[492,165]});Ce.addNode("id join",{position:[492,205]});Ce.addNode("data mbr join",{position:[492,250]});Ce.addNode("IP join",{position:[421,309]});Ce.addNode("SP join",{position:[421,349]});Ce.addNode("ri join",{position:[421,388]});Ce.addNode("addresses mbr join",{position:[421,250]});Ce.addNode("result mbr join",{position:[370,250]});Ce.addNode("FLAGS mbr join",{position:[250,250]});Ce.addNode("IR mbr join",{position:[205,250]});Ce.addNode("left join",{position:[30,85]});Ce.addNode("right join",{position:[30,145]});Ce.addNode("operands mbr join",{position:[30,250]});Ce.addUndirectedEdge("AX","AX join");Ce.addUndirectedEdge("BX","BX join");Ce.addUndirectedEdge("CX","CX join");Ce.addUndirectedEdge("DX","DX join");Ce.addUndirectedEdge("id","id join");Ce.addUndirectedEdge("AX join","BX join");Ce.addUndirectedEdge("BX join","CX join");Ce.addUndirectedEdge("CX join","DX join");Ce.addUndirectedEdge("DX join","id join");Ce.addUndirectedEdge("id join","data mbr join");Ce.addUndirectedEdge("data mbr join","MBR");Ce.addUndirectedEdge("IP","IP join");Ce.addUndirectedEdge("SP","SP join");Ce.addUndirectedEdge("ri","ri join");Ce.addUndirectedEdge("IP join","SP join");Ce.addUndirectedEdge("SP join","ri join");Ce.addUndirectedEdge("IP join","addresses mbr join");Ce.addUndirectedEdge("addresses mbr join","data mbr join");Ce.addUndirectedEdge("result","result mbr join");Ce.addUndirectedEdge("result mbr join","addresses mbr join");Ce.addUndirectedEdge("FLAGS","FLAGS mbr join");Ce.addUndirectedEdge("FLAGS mbr join","result mbr join");Ce.addUndirectedEdge("IR","IR mbr join");Ce.addUndirectedEdge("IR mbr join","FLAGS mbr join");Ce.addUndirectedEdge("left","left join");Ce.addUndirectedEdge("right","right join");Ce.addUndirectedEdge("left join","right join");Ce.addUndirectedEdge("right join","operands mbr join");Ce.addUndirectedEdge("operands mbr join","IR mbr join");function _Z(t,e){const n=kZ(Ce,t,e);if(!n)throw new Error(`No path from ${t} to ${e}`);const i=Ce.getNodeAttribute(n[0],"position");let r=`M ${i[0]} ${i[1]}`;for(let s=1;s<n.length;s++){const[o,a]=Ce.getNodeAttribute(n[s],"position");r+=` L ${o} ${a}`}return r}function CZ(){const{path:t,...e}=ft("cpu.internalBus.data");return g.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[g.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:["M 60 85 H 30","V 250 H 610","M 60 145 H 30","M 370 130 V 250","M 250 225 V 250","M 33 85 H 220","M 32 145 H 220","M 272 115 h 28","M 250 145 v 46","M 205 250 V 272","M 205 300 V 320","M 451 388 H 421","V 250","M 451 349 H 421","M 451 309 H 421","M 522 45 H 492","V 250","M 522 85 H 492","M 522 125 H 492","M 522 165 H 492","M 522 205 H 492"].join(" ")}),g.jsx(Kt.path,{d:t,className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:e})]})}const $w=(t,e)=>{const n=_Z(t,e);return tt([{key:"cpu.internalBus.data.path",from:n},{key:"cpu.internalBus.data.opacity",from:1},{key:"cpu.internalBus.data.strokeDashoffset",from:1,to:0}],{duration:5,easing:"easeInOutSine"})},zw=()=>tt({key:"cpu.internalBus.data.opacity",to:0},{duration:1,easing:"easeInSine"});async function EZ(t){switch(t.type){case"cpu:alu.execute":{const e={duration:3,easing:"easeInOutSine"};await tt([{key:"cpu.alu.operands.opacity",from:1},{key:"cpu.alu.operands.strokeDashoffset",from:1,to:0}],e),ee.set(Pj,t.operation),await Promise.all([tt({key:"cpu.alu.operation.backgroundColor",to:bt.mantis[400]},{duration:1,easing:"easeOutQuart"}),tt({key:"cpu.alu.cog.rot",to:6},{duration:10,easing:"easeInOutCubic"})]),await Promise.all([tt({key:"cpu.alu.operation.backgroundColor",to:bt.stone[800]},{duration:1,easing:"easeOutQuart"}),tt([{key:"cpu.alu.results.opacity",from:1},{key:"cpu.alu.results.strokeDashoffset",from:1,to:0}],e)]),await Promise.all([ar("cpu.result"),ar("cpu.FLAGS")]),ee.set(At.FLAGS,t.flags),ee.set(At.result,t.result),await Promise.all([lr("cpu.result"),lr("cpu.FLAGS")]),await tt([{key:"cpu.alu.operands.opacity",to:0},{key:"cpu.alu.results.opacity",to:0}],{duration:1,easing:"easeInSine"});return}case"cpu:cycle.end":return;case"cpu:cycle.interrupt":{ee.set(vs,e=>"metadata"in e?{...e,phase:"interrupt"}:e),await tt([{key:"cpu.id.opacity",to:1},{key:"cpu.ri.opacity",to:1}],{duration:.5,easing:"easeInOutQuad"});return}case"cpu:cycle.start":{Cj(t.instruction.position.start),ee.set(vs,{phase:"fetching",metadata:t.instruction}),await tt([{key:"cpu.id.opacity",to:t.instruction.willUse.id?1:.4},{key:"cpu.ri.opacity",to:t.instruction.willUse.ri?1:.4}],{duration:.5,easing:"easeInOutQuad"});return}case"cpu:cycle.update":{ee.set(vs,e=>"metadata"in e?{...e,phase:t.phase==="execute"?"executing":t.phase==="writeback"?"writeback":t.next==="fetch-operands"?"fetching-operands":t.next==="execute"?"executing":t.next==="writeback"?"writeback":e.phase}:e);return}case"cpu:decode":{await tt([{key:"cpu.decoder.path.opacity",from:1},{key:"cpu.decoder.path.strokeDashoffset",from:1,to:0}],{duration:3,easing:"easeInOutSine"}),await tt([{key:"cpu.decoder.progress.opacity",from:1},{key:"cpu.decoder.progress.progress",from:0,to:1}],{duration:3,easing:"easeInOutSine"}),await tt([{key:"cpu.decoder.path.opacity",to:0},{key:"cpu.decoder.progress.opacity",to:0}],{duration:1,easing:"easeInSine"});return}case"cpu:error":{ee.set(vs,{phase:"stopped",error:t.error}),Hc(t.error);return}case"cpu:halt":case"cpu:int.0":{ee.set(vs,{phase:"stopped"}),Hc();return}case"cpu:int.3":{qs();return}case"cpu:int.6":{ee.set(vs,{phase:"int6"});return}case"cpu:int.7":{ee.set(vs,{phase:"int7"});return}case"cpu:inta.off":{await ti("bus.inta");return}case"cpu:inta.on":{await _r("bus.inta",10);return}case"cpu:rd.on":case"cpu:wr.on":{const e=t.type.slice(4,6);await tt({key:"bus.address.stroke",to:bt.blue[500]},{duration:5,easing:"easeInOutSine"}),await tt({key:`bus.${e}.stroke`,to:bt.red[500]},{duration:5,easing:"easeOutSine"});return}case"cpu:iom.on":{await _r("bus.iom",15);return}case"cpu:mar.set":{await tt([{key:"cpu.internalBus.address.path",from:GY(t.register)},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:5,easing:"easeInOutSine"}),await ar("cpu.MAR",bt.blue[500]),ee.set(Aj,ee.get(At[t.register])),await Promise.all([lr("cpu.MAR"),tt({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]);return}case"cpu:mbr.get":{const[e]=Cl(t.register);await $w("MBR",e),await ar(`cpu.${e}`),ee.set(At[t.register],ee.get(Ev)),await Promise.all([lr(`cpu.${e}`),zw()]);return}case"cpu:mbr.set":{const[e]=Cl(t.register);await $w(e,"MBR"),await ar("cpu.MBR"),ee.set(Ev,ee.get(At[t.register])),await tt({key:"bus.data.stroke",to:bt.mantis[400]},{duration:5,easing:"easeOutSine"}),await Promise.all([lr("cpu.MBR"),zw()]);return}case"cpu:register.copy":{const[e]=Cl(t.src),[n]=Cl(t.dest);e!==n&&await $w(e,n),await ar(`cpu.${n}`),ee.set(At[t.dest],ee.get(At[t.src])),await Promise.all([lr(`cpu.${n}`),e!==n&&zw()]);return}case"cpu:register.update":{const[e]=Cl(t.register);await ar(`cpu.${e}`),ee.set(At[t.register],t.value),await lr(`cpu.${e}`);return}default:return t}}async function AZ(t){switch(t.type){case"f10:press":await _r("bus.int0",2),await ti("bus.int0");return;default:return t.type}}const N_=Ae(I.zero(8)),M_=Ae(I.zero(8));function PZ(t){"handshake"in t.io&&(ee.set(N_,I.fromUnsigned(t.io.handshake.DATA,8)),ee.set(M_,I.fromUnsigned(t.io.handshake.STATE,8)))}async function TZ(t){switch(t.type){case"handshake:read":return;case"handshake:read.ok":{await Uc(t.value);return}case"handshake:write":case"handshake:register.update":{switch(await ar(`handshake.${t.register}`),t.register){case"DATA":{ee.set(N_,t.value);break}case"STATE":{ee.set(M_,t.value);break}default:return t.register}await lr(`handshake.${t.register}`);return}case"handshake:write.ok":return;case"handshake:int.off":{await ti("bus.int2");return}case"handshake:int.on":{await _r("bus.int2",10);return}default:return t}}async function RZ(t){switch(t.type){case"keyboard:listen-key":{ee.set(Nn,e=>e.type!=="running"||e.waitingForInput?e:{...e,waitingForInput:!0}),await new Promise(e=>{ee.sub(Nn,()=>{const n=ee.get(Nn);(n.type!=="running"||!n.waitingForInput)&&e()})});return}case"keyboard:read":return;default:return t}}const O_=Ae(I.zero(8));function NZ(t){"leds"in t.io&&ee.set(O_,I.fromUnsigned(t.io.leds,8))}async function MZ(t){switch(t.type){case"leds:update":{await _r("bus.pio->leds",2),ee.set(O_,t.state),await ti("bus.pio->leds");return}default:return t.type}}const D_=Ae(new Array(ye.MAX_ADDRESS+1).fill(I.zero(8))),Vc=Ae(ye.from(32)),MF=Ae(null),vm=16,OZ=Ae(t=>{const e=t(MF)??t(Vc);let n=e.value-e.value%vm,i=n+vm-1;i>ye.MAX_ADDRESS&&(i=ye.MAX_ADDRESS,n=i-vm+1);const r=t(D_),s=[];for(let o=0;o<vm;o++)s.push({address:ye.from(n+o),value:r[n+o]});return s});function DZ(t){ee.set(D_,t.memory.map(e=>I.fromUnsigned(e,8))),ee.set(Vc,ye.from(32))}async function IZ(t){switch(t.type){case"memory:read":return;case"memory:read.ok":{ee.set(Vc,ye.from(t.address)),await tt({key:"memory.operating-cell.color",to:bt.mantis[400]},{duration:1,easing:"easeOutQuart"}),await Uc(t.value),await tt({key:"memory.operating-cell.color",to:bt.white},{duration:1,easing:"easeOutQuart"});return}case"memory:write":return;case"memory:write.ok":{ee.set(Vc,ye.from(t.address)),await tt({key:"memory.operating-cell.color",to:bt.mantis[400]},{duration:1,easing:"easeOutQuart"}),ee.set(D_,e=>[...e.slice(0,t.address.value),t.value,...e.slice(t.address.value+1)]),await tt({key:"memory.operating-cell.color",to:bt.white},{duration:1,easing:"easeOutQuart"});return}case"memory:read.error":case"memory:write.error":{Hc(t.error);return}default:return t}}const I_=Ae(I.fromUnsigned(255,8)),L_=Ae(I.fromUnsigned(0,8)),j_=Ae(I.fromUnsigned(0,8)),Mv=[Ae(I.zero(8)),Ae(I.zero(8)),Ae(I.zero(8)),Ae(I.zero(8)),Ae(I.zero(8)),Ae(I.zero(8)),Ae(I.zero(8)),Ae(I.zero(8))];function LZ(t){if("pic"in t.io){ee.set(I_,I.fromUnsigned(t.io.pic.IMR,8)),ee.set(L_,I.fromUnsigned(t.io.pic.IRR,8)),ee.set(j_,I.fromUnsigned(t.io.pic.ISR,8));for(let e=0;e<Mv.length;e++)ee.set(Mv[e],I.fromUnsigned(t.io.pic.lines[e],8))}}async function jZ(t){switch(t.type){case"pic:read":return;case"pic:read.ok":{await Uc(t.value);return}case"pic:write":return;case"pic:register.update":{switch(await ar(`pic.${t.register}`),t.register){case"IMR":{ee.set(I_,t.value);break}case"IRR":{ee.set(L_,t.value);break}case"ISR":{ee.set(j_,t.value);break}case"INT0":case"INT1":case"INT2":case"INT3":case"INT4":case"INT5":case"INT6":case"INT7":{const e=Number(t.register.slice(3));ee.set(Mv[e],t.value);break}default:return t}await lr(`pic.${t.register}`);return}case"pic:write.ok":return;case"pic:intr.off":{await ti("bus.intr");return}case"pic:intr.on":{await _r("bus.intr",10);return}case"pic:int.send":{await Uc(t.number);return}default:return t}}const F_=Ae(I.zero(8)),B_=Ae(I.zero(8)),$_=Ae(I.zero(8)),z_=Ae(I.zero(8));function FZ(t){"pio"in t.io&&(ee.set(F_,I.fromUnsigned(t.io.pio.PA,8)),ee.set(B_,I.fromUnsigned(t.io.pio.PB,8)),ee.set($_,I.fromUnsigned(t.io.pio.CA,8)),ee.set(z_,I.fromUnsigned(t.io.pio.CB,8)))}async function BZ(t){switch(t.type){case"pio:read":return;case"pio:read.ok":{await Uc(t.value);return}case"pio:write":return;case"pio:register.update":{switch(await ar(`pio.${t.register}`),t.register){case"PA":{ee.set(F_,t.value);break}case"PB":{ee.set(B_,t.value);break}case"CA":{ee.set($_,t.value);break}case"CB":{ee.set(z_,t.value);break}default:return t.register}await lr(`pio.${t.register}`);return}case"pio:write.ok":return;default:return t}}const Ov=Ae([]),Dv=Ae("");function $Z(t){"printer"in t.io&&(ee.set(Ov,t.io.printer.buffer.map(e=>I.fromUnsigned(e,8))),ee.set(Dv,t.io.printer.paper))}async function zZ(t){switch(t.type){case"printer:buffer.add":{ee.set(Ov,e=>[...e,t.char]);return}case"printer:buffer.pop":{ee.set(Ov,e=>e.slice(1));return}case"printer:busy.off":{await ti("bus.printer.busy");return}case"printer:busy.on":{await _r("bus.printer.busy",15);return}case"printer:data.read":{await _r("bus.printer.data",15),await ti("bus.printer.data");return}case"printer:paper.print":{ee.set(Dv,e=>e+t.char);return}case"printer:paper.replace":{ee.set(Dv,"");return}case"printer:strobe.off":{await ti("bus.printer.strobe");return}case"printer:strobe.on":{await _r("bus.printer.strobe",15);return}default:return t}}const U_=Ae("");function UZ(t){"screen"in t.io&&ee.set(U_,t.io.screen)}async function VZ(t){switch(t.type){case"screen:send-char":{ee.set(U_,t.output);return}default:return t.type}}const V_=Ae(I.zero(8));function HZ(t){"switches"in t.io&&ee.set(V_,I.fromUnsigned(t.io.switches,8))}async function WZ(t){switch(t.type){case"switches:toggle":{ee.set(V_,e=>e.withBit(t.index,!e.bit(t.index))),await _r("bus.switches->pio",2),await ti("bus.switches->pio");return}default:return t.type}}const H_=Ae(I.zero(8)),W_=Ae(I.zero(8));function GZ(t){"timer"in t.io&&(ee.set(H_,I.fromUnsigned(t.io.timer.CONT,8)),ee.set(W_,I.fromUnsigned(t.io.timer.COMP,8)))}async function KZ(t){switch(t.type){case"timer:read":return;case"timer:read.ok":{await Uc(t.value);return}case"timer:write":return;case"timer:register.update":{switch(await ar(`timer.${t.register}`),t.register){case"CONT":{ee.set(H_,t.value);break}case"COMP":{ee.set(W_,t.value);break}default:return t.register}await lr(`timer.${t.register}`);return}case"timer:write.ok":return;case"timer:int.off":{await ti("bus.int1");return}case"timer:int.on":{await _r("bus.int1",10);return}default:return t}}const O1=new Set;async function XZ(t){YZ(t);const[e]=t.type.split(":",2);switch(O1.add(t.type),e){case"bus":{await HY(t);break}case"clock":{await WY(t);break}case"cpu":{await EZ(t);break}case"f10":{await AZ(t);break}case"handshake":{await TZ(t);break}case"keyboard":{await RZ(t);break}case"leds":{await MZ(t);break}case"memory":{await IZ(t);break}case"pic":{await jZ(t);break}case"pio":{await BZ(t);break}case"printer":{await zZ(t);break}case"screen":{await VZ(t);break}case"switches":{await WZ(t);break}case"timer":{await KZ(t);break}default:return e}O1.delete(t.type)}function JT(...t){for(const e of t)if(O1.has(e))return!0;return!1}const qZ={bus:"#2563eb",clock:"#65a30d",cpu:"#dc2626",f10:"#65a30d",handshake:"#2563eb",keyboard:"#65a30d",leds:"#65a30d",memory:"#f59e0b",pic:"#2563eb",pio:"#2563eb",printer:"#65a30d",screen:"#65a30d",switches:"#65a30d",timer:"#2563eb"};function YZ(t){const[e,n]=t.type.split(":",2);console.group(`%c ${e} %c ${n}`,`background: ${qZ[e]}; color: #fff; font-weight: bold;`,"background: unset; color: unset; font-weight: normal;");for(const i in t)if(i!=="type"&&Object.prototype.hasOwnProperty.call(t,i)){const r=t[i];r instanceof I?console.log(`${i}: %c${r.toString("hex")}h %c(Byte)`,"color: #8b5cf6;","color: #737373;"):r instanceof ye?console.log(`${i}: %c${r.toString()} %c(MemoryAddress)`,"color: #8b5cf6;","color: #737373;"):r instanceof Yi?console.log(`${i}: %c${r.toString()} %c(IOAddress)`,"color: #8b5cf6;","color: #737373;"):typeof r=="number"?console.log(`${i}: %c${r.toString(16)}h %c(number)`,"color: #8b5cf6;","color: #737373;"):typeof r=="string"?console.log(`${i}: %c"${r}" %c(string)`,"color: #f97316;","color: #737373;"):typeof r=="boolean"?console.log(`${i}: %c${r}`,"color: #06b6d4;"):r===null?console.log(`${i}: %cnull`,"color: #b91c1c;"):console.log(`${i}:`,r)}console.groupEnd()}const Fn=new vq,Nn=Ae({type:"stopped"});function JZ(t){const e=t.translate(Si().language);Gt({title:e,variant:"error"})}function Hc(t){t&&JZ(t),Cj(null),_j(!1),ee.set(Nn,{type:"stopped",error:t}),ee.set(vs,{phase:"stopped",error:t}),iF()}function qs(){ee.set(Nn,{type:"paused"}),UY()}function ZZ(){Gt({title:Ny(Si().language,"messages.assemble-error"),variant:"error"})}function xu(){Gt({title:Ny(Si().language,"messages.invalid-action"),variant:"error"})}function QZ(t){xq(t),DZ(t),PZ(t),LZ(t),FZ(t),GZ(t),NZ(t),$Z(t),UZ(t),HZ(t)}let Md=0;async function Al(t){try{for(;;){const e=ee.get(Nn),n=Si();if(e.type==="stopped")break;if(e.type==="paused"){await new Promise(r=>{const s=ee.sub(Nn,()=>{s(),r()})});continue}const i=t.next();if(i.done)break;if(await XZ(i.value),e.until==="cycle-change"){if(i.value.type==="cpu:cycle.end"){Md=0;continue}if(Md<3)i.value.type==="cpu:mar.set"?(Gt({title:"Etapa de captación (fetch):",description:"Paso 1: MAR ← IP",variant:"info"}),qs(),Md++):i.value.type==="cpu:register.update"?(Gt({title:"Etapa de captación (fetch):",description:"Paso 2: MDR ← read(Memoria[MAR]); IP ← IP + 1",variant:"info"}),qs(),Md++):i.value.type==="cpu:mbr.get"&&(Gt({title:"Etapa de captación (fetch):",description:"Paso 3: IR ← MBR",variant:"info"}),qs(),Md++);else if(i.value.type==="cpu:mar.set"){const r=i.value.register;Gt({title:"Etapa de ejecución (execute):",description:`MAR ← ${r}`,variant:"info"}),qs()}else if(i.value.type==="cpu:register.update")Gt({title:"Etapa de ejecución (execute):",description:"MDR ← read(Memoria[MAR]); IP ← IP + 1",variant:"info"}),qs();else if(i.value.type==="cpu:mbr.get"){const r=i.value.register;Gt({title:"Etapa de ejecución (execute):",description:`${r} ← MDR`,variant:"info"}),qs()}else if(i.value.type==="cpu:register.copy"){const r=i.value.src,s=i.value.dest;Gt({title:"Etapa de ejecución (execute):",description:`${s} ← ${r}`,variant:"info"}),qs()}}i.value.type==="cpu:cycle.update"||i.value.type==="cpu:cycle.interrupt"?e.until==="cycle-change"||n.animations||await new Promise(r=>setTimeout(r,n.executionUnit)):i.value.type==="cpu:cycle.end"&&(e.until==="cycle-change"||e.until==="end-of-instruction"?qs():n.animations||await new Promise(r=>setTimeout(r,n.executionUnit)))}t.return()}catch(e){const n=Ze.from(e);Hc(n)}}async function eQ(...t){const e=t[0],n=ee.get(Nn);switch(e){case"cpu.run":{if(n.type==="running")return xu();const i=t[1];if(n.type==="stopped"){if(!window.codemirror)return;const r=window.codemirror.state.doc.toString(),s=vj(r);if(!s.success)return ZZ();_j(!0),Fn.loadProgram({program:s,data:Si().dataOnLoad,devices:Si().devices}),QZ(Fn.getComputerState());const o=["Start CPU",{until:i,devices:Si().devices,language:Si().language,animations:Si().animations?"yes":"no"}];Ej.capture(...o),ee.set(Nn,{type:"running",until:i,waitingForInput:!1}),Al(Fn.startCPU()),tQ(),nQ()}else ee.set(Nn,{type:"running",until:i,waitingForInput:!1}),VY();return}case"cpu.stop":{Hc();return}case"f10.press":{if(!Fn.devices.f10.connected()||n.type!=="running")return xu();if(JT("f10:press"))return;Al(Fn.devices.f10.press());return}case"switch.toggle":{if(n.type!=="running"||!Fn.devices.switches.connected())return xu();if(JT("switches:toggle"))return;const i=t[1];Al(Fn.devices.switches.toggle(i));return}case"keyboard.sendChar":{if(n.type!=="running"||!n.waitingForInput)return xu();Fn.devices.keyboard.readChar(I.fromChar(t[1])),ee.set(Nn,{...n,waitingForInput:!1});return}case"screen.clean":{if(!Fn.devices.screen.connected())return xu();Al(Fn.devices.screen.clear());return}case"printer.clean":{if(!Fn.devices.printer.connected())return xu();Al(Fn.devices.printer.clear());return}default:return e}}async function tQ(){if(Fn.devices.clock.connected())for(;ee.get(Nn).type!=="stopped";){const t=Si().clockSpeed;await tt({key:"clock.angle",from:0,to:360},{duration:t,forceMs:!0,easing:"linear"}),Al(Fn.devices.clock.tick())}}async function nQ(){if(Fn.devices.printer.connected())for(;ee.get(Nn).type!=="stopped";){const t=Si().printerSpeed;await tt([{key:"printer.printing.opacity",from:1},{key:"printer.printing.progress",from:0,to:1}],{duration:t,forceMs:!0,easing:"easeInOutSine"}),await tt({key:"printer.printing.opacity",to:0},{duration:1,easing:"easeInSine"}),Al(Fn.devices.printer.print())}}function gn(){const t=qt(Nn),e=IK(),n=S.useMemo(()=>({preset:e,hasIOBus:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",clock:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",f10:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",keyboard:e==="keyboard-and-screen"||e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",handshake:e==="handshake",leds:e==="pio-switches-and-leds",pic:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",pio:e==="pio-switches-and-leds"||e==="pio-printer",printer:e==="pio-printer"||e==="handshake",screen:e==="keyboard-and-screen"||e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",switches:e==="pio-switches-and-leds",timer:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake"}),[e]);return{status:t,dispatch:eQ,devices:n}}function iQ({className:t}){const e=mt(),{status:n,dispatch:i}=gn(),r=S.useCallback(()=>{n.type!=="running"&&i("cpu.run","cycle-change")},[n.type,i]);So("F7",a=>{a.preventDefault(),r()},void 0,[r]);const s=S.useCallback(()=>{n.type!=="running"&&i("cpu.run","end-of-instruction")},[n.type,i]);So("F8",a=>{a.preventDefault(),s()},void 0,[s]);const o=S.useCallback(()=>{n.type!=="running"&&i("cpu.run","infinity")},[n.type,i]);return So("F4",a=>{a.preventDefault(),o()},void 0,[o]),g.jsxs("div",{className:Ue("flex items-center justify-center gap-4",t),children:[g.jsxs(qL,{children:[g.jsx(YL,{asChild:!0,children:g.jsx("button",{disabled:n.type==="running",className:"inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-mantis-500 px-3 text-sm text-white ring-offset-stone-900 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mantis-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",children:n.type==="stopped"?g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"icon-[lucide--play] mr-2 h-4 w-4"}),e("control.action.start")]}):n.type==="paused"?g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"icon-[lucide--play] mr-2 h-4 w-4"}),e("control.action.continue")]}):g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"icon-[lucide--refresh-cw] mr-2 h-4 w-4 animate-spin"}),e("control.action.running")]})})}),g.jsxs(e_,{className:"w-56",align:"start",children:[g.jsxs(Bl,{disabled:n.type==="running",onClick:r,children:[g.jsx("span",{className:"icon-[lucide--chevron-right] mr-2 h-4 w-4"}),e("control.action.run.cycle-change"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"F7"})]}),g.jsxs(Bl,{disabled:n.type==="running",onClick:s,children:[g.jsx("span",{className:"icon-[lucide--chevrons-right] mr-2 h-4 w-4"}),e("control.action.run.end-of-instruction"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"F8"})]}),g.jsxs(Bl,{disabled:n.type==="running",onClick:o,children:[g.jsx("span",{className:"icon-[lucide--infinity] mr-2 h-4 w-4"}),e("control.action.run.infinity"),g.jsx("div",{className:"grow"}),g.jsx("kbd",{className:"text-stone-600",children:"F4"})]})]})]}),g.jsxs("button",{disabled:n.type==="stopped",onClick:()=>i("cpu.stop"),className:"inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-mantis-500 px-3 text-sm text-white ring-offset-stone-900 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mantis-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",children:[g.jsx("span",{className:"icon-[lucide--stop-circle] mr-2 h-4 w-4"}),e("control.action.stop")]})]})}function Iv(t,[e,n]){return Math.min(n,Math.max(e,t))}function G_(t){const e=S.useRef({value:t,previous:t});return S.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var rQ="VisuallyHidden",Yy=S.forwardRef((t,e)=>g.jsx(Fe.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));Yy.displayName=rQ;var sQ=[" ","Enter","ArrowUp","ArrowDown"],oQ=[" ","Enter"],up="Select",[Jy,Zy,aQ]=Gf(up),[ad,voe]=ls(up,[aQ,rd]),Qy=rd(),[lQ,sl]=ad(up),[uQ,cQ]=ad(up),OF=t=>{const{__scopeSelect:e,children:n,open:i,defaultOpen:r,onOpenChange:s,value:o,defaultValue:a,onValueChange:l,dir:u,name:c,autoComplete:d,disabled:h,required:f}=t,p=Qy(e),[m,w]=S.useState(null),[v,y]=S.useState(null),[b,k]=S.useState(!1),_=Kf(u),[E=!1,A]=To({prop:i,defaultProp:r,onChange:s}),[P,D]=To({prop:o,defaultProp:a,onChange:l}),L=S.useRef(null),B=m?!!m.closest("form"):!0,[$,J]=S.useState(new Set),z=Array.from($).map(G=>G.props.value).join(";");return g.jsx(Uk,{...p,children:g.jsxs(lQ,{required:f,scope:e,trigger:m,onTriggerChange:w,valueNode:v,onValueNodeChange:y,valueNodeHasChildren:b,onValueNodeHasChildrenChange:k,contentId:Fa(),value:P,onValueChange:D,open:E,onOpenChange:A,dir:_,triggerPointerDownPosRef:L,disabled:h,children:[g.jsx(Jy.Provider,{scope:e,children:g.jsx(uQ,{scope:t.__scopeSelect,onNativeOptionAdd:S.useCallback(G=>{J(Q=>new Set(Q).add(G))},[]),onNativeOptionRemove:S.useCallback(G=>{J(Q=>{const ie=new Set(Q);return ie.delete(G),ie})},[]),children:n})}),B?g.jsxs(QF,{"aria-hidden":!0,required:f,tabIndex:-1,name:c,autoComplete:d,value:P,onChange:G=>D(G.target.value),disabled:h,children:[P===void 0?g.jsx("option",{value:""}):null,Array.from($)]},z):null]})})};OF.displayName=up;var DF="SelectTrigger",IF=S.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:i=!1,...r}=t,s=Qy(n),o=sl(DF,n),a=o.disabled||i,l=rt(e,o.onTriggerChange),u=Zy(n),[c,d,h]=eB(p=>{const m=u().filter(y=>!y.disabled),w=m.find(y=>y.value===o.value),v=tB(m,p,w);v!==void 0&&o.onValueChange(v.value)}),f=()=>{a||(o.onOpenChange(!0),h())};return g.jsx(Cy,{asChild:!0,...s,children:g.jsx(Fe.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":ZF(o.value)?"":void 0,...r,ref:l,onClick:fe(r.onClick,p=>{p.currentTarget.focus()}),onPointerDown:fe(r.onPointerDown,p=>{const m=p.target;m.hasPointerCapture(p.pointerId)&&m.releasePointerCapture(p.pointerId),p.button===0&&p.ctrlKey===!1&&(f(),o.triggerPointerDownPosRef.current={x:Math.round(p.pageX),y:Math.round(p.pageY)},p.preventDefault())}),onKeyDown:fe(r.onKeyDown,p=>{const m=c.current!=="";!(p.ctrlKey||p.altKey||p.metaKey)&&p.key.length===1&&d(p.key),!(m&&p.key===" ")&&sQ.includes(p.key)&&(f(),p.preventDefault())})})})});IF.displayName=DF;var LF="SelectValue",jF=S.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,children:s,placeholder:o="",...a}=t,l=sl(LF,n),{onValueNodeHasChildrenChange:u}=l,c=s!==void 0,d=rt(e,l.onValueNodeChange);return Hn(()=>{u(c)},[u,c]),g.jsx(Fe.span,{...a,ref:d,style:{pointerEvents:"none"},children:ZF(l.value)?g.jsx(g.Fragment,{children:o}):s})});jF.displayName=LF;var dQ="SelectIcon",FF=S.forwardRef((t,e)=>{const{__scopeSelect:n,children:i,...r}=t;return g.jsx(Fe.span,{"aria-hidden":!0,...r,ref:e,children:i||"▼"})});FF.displayName=dQ;var hQ="SelectPortal",BF=t=>g.jsx(np,{asChild:!0,...t});BF.displayName=hQ;var ru="SelectContent",$F=S.forwardRef((t,e)=>{const n=sl(ru,t.__scopeSelect),[i,r]=S.useState();if(Hn(()=>{r(new DocumentFragment)},[]),!n.open){const s=i;return s?jo.createPortal(g.jsx(zF,{scope:t.__scopeSelect,children:g.jsx(Jy.Slot,{scope:t.__scopeSelect,children:g.jsx("div",{children:t.children})})}),s):null}return g.jsx(UF,{...t,ref:e})});$F.displayName=ru;var eo=10,[zF,ol]=ad(ru),fQ="SelectContentImpl",UF=S.forwardRef((t,e)=>{const{__scopeSelect:n,position:i="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:s,onPointerDownOutside:o,side:a,sideOffset:l,align:u,alignOffset:c,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:m,avoidCollisions:w,...v}=t,y=sl(ru,n),[b,k]=S.useState(null),[_,E]=S.useState(null),A=rt(e,x=>k(x)),[P,D]=S.useState(null),[L,B]=S.useState(null),$=Zy(n),[J,z]=S.useState(!1),G=S.useRef(!1);S.useEffect(()=>{if(b)return Wk(b)},[b]),Mk();const Q=S.useCallback(x=>{const[T,...N]=$().map(U=>U.ref.current),[R]=N.slice(-1),W=document.activeElement;for(const U of x)if(U===W||(U==null||U.scrollIntoView({block:"nearest"}),U===T&&_&&(_.scrollTop=0),U===R&&_&&(_.scrollTop=_.scrollHeight),U==null||U.focus(),document.activeElement!==W))return},[$,_]),ie=S.useCallback(()=>Q([P,b]),[Q,P,b]);S.useEffect(()=>{J&&ie()},[J,ie]);const{onOpenChange:H,triggerPointerDownPosRef:j}=y;S.useEffect(()=>{if(b){let x={x:0,y:0};const T=R=>{var W,U;x={x:Math.abs(Math.round(R.pageX)-(((W=j.current)==null?void 0:W.x)??0)),y:Math.abs(Math.round(R.pageY)-(((U=j.current)==null?void 0:U.y)??0))}},N=R=>{x.x<=10&&x.y<=10?R.preventDefault():b.contains(R.target)||H(!1),document.removeEventListener("pointermove",T),j.current=null};return j.current!==null&&(document.addEventListener("pointermove",T),document.addEventListener("pointerup",N,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",T),document.removeEventListener("pointerup",N,{capture:!0})}}},[b,H,j]),S.useEffect(()=>{const x=()=>H(!1);return window.addEventListener("blur",x),window.addEventListener("resize",x),()=>{window.removeEventListener("blur",x),window.removeEventListener("resize",x)}},[H]);const[te,pe]=eB(x=>{const T=$().filter(W=>!W.disabled),N=T.find(W=>W.ref.current===document.activeElement),R=tB(T,x,N);R&&setTimeout(()=>R.ref.current.focus())}),q=S.useCallback((x,T,N)=>{const R=!G.current&&!N;(y.value!==void 0&&y.value===T||R)&&(D(x),R&&(G.current=!0))},[y.value]),ue=S.useCallback(()=>b==null?void 0:b.focus(),[b]),O=S.useCallback((x,T,N)=>{const R=!G.current&&!N;(y.value!==void 0&&y.value===T||R)&&B(x)},[y.value]),M=i==="popper"?D1:VF,F=M===D1?{side:a,sideOffset:l,align:u,alignOffset:c,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:m,avoidCollisions:w}:{};return g.jsx(zF,{scope:n,content:b,viewport:_,onViewportChange:E,itemRefCallback:q,selectedItem:P,onItemLeave:ue,itemTextRefCallback:O,focusSelectedItem:ie,selectedItemText:L,position:i,isPositioned:J,searchRef:te,children:g.jsx(Ay,{as:Xl,allowPinchZoom:!0,children:g.jsx(Sy,{asChild:!0,trapped:y.open,onMountAutoFocus:x=>{x.preventDefault()},onUnmountAutoFocus:fe(r,x=>{var T;(T=y.trigger)==null||T.focus({preventScroll:!0}),x.preventDefault()}),children:g.jsx(ep,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:x=>x.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:g.jsx(M,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:x=>x.preventDefault(),...v,...F,onPlaced:()=>z(!0),ref:A,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:fe(v.onKeyDown,x=>{const T=x.ctrlKey||x.altKey||x.metaKey;if(x.key==="Tab"&&x.preventDefault(),!T&&x.key.length===1&&pe(x.key),["ArrowUp","ArrowDown","Home","End"].includes(x.key)){let R=$().filter(W=>!W.disabled).map(W=>W.ref.current);if(["ArrowUp","End"].includes(x.key)&&(R=R.slice().reverse()),["ArrowUp","ArrowDown"].includes(x.key)){const W=x.target,U=R.indexOf(W);R=R.slice(U+1)}setTimeout(()=>Q(R)),x.preventDefault()}})})})})})})});UF.displayName=fQ;var pQ="SelectItemAlignedPosition",VF=S.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:i,...r}=t,s=sl(ru,n),o=ol(ru,n),[a,l]=S.useState(null),[u,c]=S.useState(null),d=rt(e,A=>c(A)),h=Zy(n),f=S.useRef(!1),p=S.useRef(!0),{viewport:m,selectedItem:w,selectedItemText:v,focusSelectedItem:y}=o,b=S.useCallback(()=>{if(s.trigger&&s.valueNode&&a&&u&&m&&w&&v){const A=s.trigger.getBoundingClientRect(),P=u.getBoundingClientRect(),D=s.valueNode.getBoundingClientRect(),L=v.getBoundingClientRect();if(s.dir!=="rtl"){const W=L.left-P.left,U=D.left-W,Z=A.left-U,K=A.width+Z,Se=Math.max(K,P.width),Oe=window.innerWidth-eo,Ie=Iv(U,[eo,Oe-Se]);a.style.minWidth=K+"px",a.style.left=Ie+"px"}else{const W=P.right-L.right,U=window.innerWidth-D.right-W,Z=window.innerWidth-A.right-U,K=A.width+Z,Se=Math.max(K,P.width),Oe=window.innerWidth-eo,Ie=Iv(U,[eo,Oe-Se]);a.style.minWidth=K+"px",a.style.right=Ie+"px"}const B=h(),$=window.innerHeight-eo*2,J=m.scrollHeight,z=window.getComputedStyle(u),G=parseInt(z.borderTopWidth,10),Q=parseInt(z.paddingTop,10),ie=parseInt(z.borderBottomWidth,10),H=parseInt(z.paddingBottom,10),j=G+Q+J+H+ie,te=Math.min(w.offsetHeight*5,j),pe=window.getComputedStyle(m),q=parseInt(pe.paddingTop,10),ue=parseInt(pe.paddingBottom,10),O=A.top+A.height/2-eo,M=$-O,F=w.offsetHeight/2,x=w.offsetTop+F,T=G+Q+x,N=j-T;if(T<=O){const W=w===B[B.length-1].ref.current;a.style.bottom="0px";const U=u.clientHeight-m.offsetTop-m.offsetHeight,Z=Math.max(M,F+(W?ue:0)+U+ie),K=T+Z;a.style.height=K+"px"}else{const W=w===B[0].ref.current;a.style.top="0px";const Z=Math.max(O,G+m.offsetTop+(W?q:0)+F)+N;a.style.height=Z+"px",m.scrollTop=T-O+m.offsetTop}a.style.margin=`${eo}px 0`,a.style.minHeight=te+"px",a.style.maxHeight=$+"px",i==null||i(),requestAnimationFrame(()=>f.current=!0)}},[h,s.trigger,s.valueNode,a,u,m,w,v,s.dir,i]);Hn(()=>b(),[b]);const[k,_]=S.useState();Hn(()=>{u&&_(window.getComputedStyle(u).zIndex)},[u]);const E=S.useCallback(A=>{A&&p.current===!0&&(b(),y==null||y(),p.current=!1)},[b,y]);return g.jsx(gQ,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:f,onScrollButtonChange:E,children:g.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:k},children:g.jsx(Fe.div,{...r,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});VF.displayName=pQ;var mQ="SelectPopperPosition",D1=S.forwardRef((t,e)=>{const{__scopeSelect:n,align:i="start",collisionPadding:r=eo,...s}=t,o=Qy(n);return g.jsx(Vk,{...o,...s,ref:e,align:i,collisionPadding:r,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});D1.displayName=mQ;var[gQ,K_]=ad(ru,{}),I1="SelectViewport",HF=S.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:i,...r}=t,s=ol(I1,n),o=K_(I1,n),a=rt(e,s.onViewportChange),l=S.useRef(0);return g.jsxs(g.Fragment,{children:[g.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),g.jsx(Jy.Slot,{scope:n,children:g.jsx(Fe.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:a,style:{position:"relative",flex:1,overflow:"auto",...r.style},onScroll:fe(r.onScroll,u=>{const c=u.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=o;if(h!=null&&h.current&&d){const f=Math.abs(l.current-c.scrollTop);if(f>0){const p=window.innerHeight-eo*2,m=parseFloat(d.style.minHeight),w=parseFloat(d.style.height),v=Math.max(m,w);if(v<p){const y=v+f,b=Math.min(p,y),k=y-b;d.style.height=b+"px",d.style.bottom==="0px"&&(c.scrollTop=k>0?k:0,d.style.justifyContent="flex-end")}}}l.current=c.scrollTop})})})]})});HF.displayName=I1;var WF="SelectGroup",[vQ,yQ]=ad(WF),wQ=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=Fa();return g.jsx(vQ,{scope:n,id:r,children:g.jsx(Fe.div,{role:"group","aria-labelledby":r,...i,ref:e})})});wQ.displayName=WF;var GF="SelectLabel",bQ=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=yQ(GF,n);return g.jsx(Fe.div,{id:r.id,...i,ref:e})});bQ.displayName=GF;var Lv="SelectItem",[xQ,KF]=ad(Lv),XF=S.forwardRef((t,e)=>{const{__scopeSelect:n,value:i,disabled:r=!1,textValue:s,...o}=t,a=sl(Lv,n),l=ol(Lv,n),u=a.value===i,[c,d]=S.useState(s??""),[h,f]=S.useState(!1),p=rt(e,v=>{var y;return(y=l.itemRefCallback)==null?void 0:y.call(l,v,i,r)}),m=Fa(),w=()=>{r||(a.onValueChange(i),a.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return g.jsx(xQ,{scope:n,value:i,disabled:r,textId:m,isSelected:u,onItemTextChange:S.useCallback(v=>{d(y=>y||((v==null?void 0:v.textContent)??"").trim())},[]),children:g.jsx(Jy.ItemSlot,{scope:n,value:i,disabled:r,textValue:c,children:g.jsx(Fe.div,{role:"option","aria-labelledby":m,"data-highlighted":h?"":void 0,"aria-selected":u&&h,"data-state":u?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...o,ref:p,onFocus:fe(o.onFocus,()=>f(!0)),onBlur:fe(o.onBlur,()=>f(!1)),onPointerUp:fe(o.onPointerUp,w),onPointerMove:fe(o.onPointerMove,v=>{var y;r?(y=l.onItemLeave)==null||y.call(l):v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:fe(o.onPointerLeave,v=>{var y;v.currentTarget===document.activeElement&&((y=l.onItemLeave)==null||y.call(l))}),onKeyDown:fe(o.onKeyDown,v=>{var b;((b=l.searchRef)==null?void 0:b.current)!==""&&v.key===" "||(oQ.includes(v.key)&&w(),v.key===" "&&v.preventDefault())})})})})});XF.displayName=Lv;var eh="SelectItemText",qF=S.forwardRef((t,e)=>{const{__scopeSelect:n,className:i,style:r,...s}=t,o=sl(eh,n),a=ol(eh,n),l=KF(eh,n),u=cQ(eh,n),[c,d]=S.useState(null),h=rt(e,v=>d(v),l.onItemTextChange,v=>{var y;return(y=a.itemTextRefCallback)==null?void 0:y.call(a,v,l.value,l.disabled)}),f=c==null?void 0:c.textContent,p=S.useMemo(()=>g.jsx("option",{value:l.value,disabled:l.disabled,children:f},l.value),[l.disabled,l.value,f]),{onNativeOptionAdd:m,onNativeOptionRemove:w}=u;return Hn(()=>(m(p),()=>w(p)),[m,w,p]),g.jsxs(g.Fragment,{children:[g.jsx(Fe.span,{id:l.textId,...s,ref:h}),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?jo.createPortal(s.children,o.valueNode):null]})});qF.displayName=eh;var YF="SelectItemIndicator",SQ=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return KF(YF,n).isSelected?g.jsx(Fe.span,{"aria-hidden":!0,...i,ref:e}):null});SQ.displayName=YF;var L1="SelectScrollUpButton",kQ=S.forwardRef((t,e)=>{const n=ol(L1,t.__scopeSelect),i=K_(L1,t.__scopeSelect),[r,s]=S.useState(!1),o=rt(e,i.onScrollButtonChange);return Hn(()=>{if(n.viewport&&n.isPositioned){let a=function(){const u=l.scrollTop>0;s(u)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?g.jsx(JF,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});kQ.displayName=L1;var j1="SelectScrollDownButton",_Q=S.forwardRef((t,e)=>{const n=ol(j1,t.__scopeSelect),i=K_(j1,t.__scopeSelect),[r,s]=S.useState(!1),o=rt(e,i.onScrollButtonChange);return Hn(()=>{if(n.viewport&&n.isPositioned){let a=function(){const u=l.scrollHeight-l.clientHeight,c=Math.ceil(l.scrollTop)<u;s(c)};const l=n.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),r?g.jsx(JF,{...t,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=n;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});_Q.displayName=j1;var JF=S.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:i,...r}=t,s=ol("SelectScrollButton",n),o=S.useRef(null),a=Zy(n),l=S.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return S.useEffect(()=>()=>l(),[l]),Hn(()=>{var c;const u=a().find(d=>d.ref.current===document.activeElement);(c=u==null?void 0:u.ref.current)==null||c.scrollIntoView({block:"nearest"})},[a]),g.jsx(Fe.div,{"aria-hidden":!0,...r,ref:e,style:{flexShrink:0,...r.style},onPointerDown:fe(r.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(i,50))}),onPointerMove:fe(r.onPointerMove,()=>{var u;(u=s.onItemLeave)==null||u.call(s),o.current===null&&(o.current=window.setInterval(i,50))}),onPointerLeave:fe(r.onPointerLeave,()=>{l()})})}),CQ="SelectSeparator",EQ=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t;return g.jsx(Fe.div,{"aria-hidden":!0,...i,ref:e})});EQ.displayName=CQ;var F1="SelectArrow",AQ=S.forwardRef((t,e)=>{const{__scopeSelect:n,...i}=t,r=Qy(n),s=sl(F1,n),o=ol(F1,n);return s.open&&o.position==="popper"?g.jsx(Hk,{...r,...i,ref:e}):null});AQ.displayName=F1;function ZF(t){return t===""||t===void 0}var QF=S.forwardRef((t,e)=>{const{value:n,...i}=t,r=S.useRef(null),s=rt(e,r),o=G_(n);return S.useEffect(()=>{const a=r.current,l=window.HTMLSelectElement.prototype,c=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==n&&c){const d=new Event("change",{bubbles:!0});c.call(a,n),a.dispatchEvent(d)}},[o,n]),g.jsx(Yy,{asChild:!0,children:g.jsx("select",{...i,ref:s,defaultValue:n})})});QF.displayName="BubbleSelect";function eB(t){const e=Wn(t),n=S.useRef(""),i=S.useRef(0),r=S.useCallback(o=>{const a=n.current+o;e(a),function l(u){n.current=u,window.clearTimeout(i.current),u!==""&&(i.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),s=S.useCallback(()=>{n.current="",window.clearTimeout(i.current)},[]);return S.useEffect(()=>()=>window.clearTimeout(i.current),[]),[n,r,s]}function tB(t,e,n){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=PQ(t,Math.max(s,0));r.length===1&&(o=o.filter(u=>u!==n));const l=o.find(u=>u.textValue.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function PQ(t,e){return t.map((n,i)=>t[(e+i)%t.length])}var TQ=OF,nB=IF,RQ=jF,NQ=FF,MQ=BF,iB=$F,OQ=HF,rB=XF,DQ=qF;const Uw=TQ,Vw=RQ,pg=S.forwardRef(({className:t,children:e,...n},i)=>g.jsxs(nB,{ref:i,className:Ue("flex h-10 items-center justify-between rounded-md border border-stone-600 bg-stone-900 px-3 py-2 text-sm ring-offset-stone-800 placeholder:text-stone-500 focus:outline-none focus:ring-2 focus:ring-stone-600 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:[e,g.jsx(NQ,{asChild:!0,children:g.jsx("span",{className:"icon-[lucide--chevron-down] h-4 w-4 opacity-50"})})]}));pg.displayName=nB.displayName;const mg=S.forwardRef(({className:t,children:e,position:n="popper",...i},r)=>g.jsx(MQ,{children:g.jsx(iB,{ref:r,className:Ue("relative z-50 min-w-[8rem] overflow-hidden rounded-md border border-stone-600 bg-stone-900 text-white shadow-md",t),position:n,...i,children:g.jsx(OQ,{className:"p-1",children:e})})}));mg.displayName=iB.displayName;const th=S.forwardRef(({className:t,children:e,...n},i)=>g.jsx(rB,{ref:i,className:Ue("w-full cursor-default select-none rounded-sm px-2 py-1.5 text-sm outline-none transition-colors duration-75 focus:bg-stone-800 focus:text-mantis-400 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:g.jsx(DQ,{children:e})}));th.displayName=rB.displayName;var sB=["PageUp","PageDown"],oB=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],aB={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ld="Slider",[B1,IQ,LQ]=Gf(ld),[lB,yoe]=ls(ld,[LQ]),[jQ,e0]=lB(ld),uB=S.forwardRef((t,e)=>{const{name:n,min:i=0,max:r=100,step:s=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:u=[i],value:c,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:f=!1,...p}=t,m=S.useRef(new Set),w=S.useRef(0),y=o==="horizontal"?FQ:BQ,[b=[],k]=To({prop:c,defaultProp:u,onChange:L=>{var $;($=[...m.current][w.current])==null||$.focus(),d(L)}}),_=S.useRef(b);function E(L){const B=HQ(b,L);D(L,B)}function A(L){D(L,w.current)}function P(){const L=_.current[w.current];b[w.current]!==L&&h(b)}function D(L,B,{commit:$}={commit:!1}){const J=XQ(s),z=qQ(Math.round((L-i)/s)*s+i,J),G=Iv(z,[i,r]);k((Q=[])=>{const ie=UQ(Q,G,B);if(KQ(ie,l*s)){w.current=ie.indexOf(G);const H=String(ie)!==String(Q);return H&&$&&h(ie),H?ie:Q}else return Q})}return g.jsx(jQ,{scope:t.__scopeSlider,name:n,disabled:a,min:i,max:r,valueIndexToChangeRef:w,thumbs:m.current,values:b,orientation:o,children:g.jsx(B1.Provider,{scope:t.__scopeSlider,children:g.jsx(B1.Slot,{scope:t.__scopeSlider,children:g.jsx(y,{"aria-disabled":a,"data-disabled":a?"":void 0,...p,ref:e,onPointerDown:fe(p.onPointerDown,()=>{a||(_.current=b)}),min:i,max:r,inverted:f,onSlideStart:a?void 0:E,onSlideMove:a?void 0:A,onSlideEnd:a?void 0:P,onHomeKeyDown:()=>!a&&D(i,0,{commit:!0}),onEndKeyDown:()=>!a&&D(r,b.length-1,{commit:!0}),onStepKeyDown:({event:L,direction:B})=>{if(!a){const z=sB.includes(L.key)||L.shiftKey&&oB.includes(L.key)?10:1,G=w.current,Q=b[G],ie=s*z*B;D(Q+ie,G,{commit:!0})}}})})})})});uB.displayName=ld;var[cB,dB]=lB(ld,{startEdge:"left",endEdge:"right",size:"width",direction:1}),FQ=S.forwardRef((t,e)=>{const{min:n,max:i,dir:r,inverted:s,onSlideStart:o,onSlideMove:a,onSlideEnd:l,onStepKeyDown:u,...c}=t,[d,h]=S.useState(null),f=rt(e,b=>h(b)),p=S.useRef(),m=Kf(r),w=m==="ltr",v=w&&!s||!w&&s;function y(b){const k=p.current||d.getBoundingClientRect(),_=[0,k.width],A=X_(_,v?[n,i]:[i,n]);return p.current=k,A(b-k.left)}return g.jsx(cB,{scope:t.__scopeSlider,startEdge:v?"left":"right",endEdge:v?"right":"left",direction:v?1:-1,size:"width",children:g.jsx(hB,{dir:m,"data-orientation":"horizontal",...c,ref:f,style:{...c.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:b=>{const k=y(b.clientX);o==null||o(k)},onSlideMove:b=>{const k=y(b.clientX);a==null||a(k)},onSlideEnd:()=>{p.current=void 0,l==null||l()},onStepKeyDown:b=>{const _=aB[v?"from-left":"from-right"].includes(b.key);u==null||u({event:b,direction:_?-1:1})}})})}),BQ=S.forwardRef((t,e)=>{const{min:n,max:i,inverted:r,onSlideStart:s,onSlideMove:o,onSlideEnd:a,onStepKeyDown:l,...u}=t,c=S.useRef(null),d=rt(e,c),h=S.useRef(),f=!r;function p(m){const w=h.current||c.current.getBoundingClientRect(),v=[0,w.height],b=X_(v,f?[i,n]:[n,i]);return h.current=w,b(m-w.top)}return g.jsx(cB,{scope:t.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:g.jsx(hB,{"data-orientation":"vertical",...u,ref:d,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:m=>{const w=p(m.clientY);s==null||s(w)},onSlideMove:m=>{const w=p(m.clientY);o==null||o(w)},onSlideEnd:()=>{h.current=void 0,a==null||a()},onStepKeyDown:m=>{const v=aB[f?"from-bottom":"from-top"].includes(m.key);l==null||l({event:m,direction:v?-1:1})}})})}),hB=S.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:i,onSlideMove:r,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:l,...u}=t,c=e0(ld,n);return g.jsx(Fe.span,{...u,ref:e,onKeyDown:fe(t.onKeyDown,d=>{d.key==="Home"?(o(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):sB.concat(oB).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:fe(t.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),c.thumbs.has(h)?h.focus():i(d)}),onPointerMove:fe(t.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&r(d)}),onPointerUp:fe(t.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),s(d))})})}),fB="SliderTrack",pB=S.forwardRef((t,e)=>{const{__scopeSlider:n,...i}=t,r=e0(fB,n);return g.jsx(Fe.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...i,ref:e})});pB.displayName=fB;var $1="SliderRange",mB=S.forwardRef((t,e)=>{const{__scopeSlider:n,...i}=t,r=e0($1,n),s=dB($1,n),o=S.useRef(null),a=rt(e,o),l=r.values.length,u=r.values.map(h=>vB(h,r.min,r.max)),c=l>1?Math.min(...u):0,d=100-Math.max(...u);return g.jsx(Fe.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...i,ref:a,style:{...t.style,[s.startEdge]:c+"%",[s.endEdge]:d+"%"}})});mB.displayName=$1;var z1="SliderThumb",gB=S.forwardRef((t,e)=>{const n=IQ(t.__scopeSlider),[i,r]=S.useState(null),s=rt(e,a=>r(a)),o=S.useMemo(()=>i?n().findIndex(a=>a.ref.current===i):-1,[n,i]);return g.jsx($Q,{...t,ref:s,index:o})}),$Q=S.forwardRef((t,e)=>{const{__scopeSlider:n,index:i,name:r,...s}=t,o=e0(z1,n),a=dB(z1,n),[l,u]=S.useState(null),c=rt(e,y=>u(y)),d=l?!!l.closest("form"):!0,h=Bk(l),f=o.values[i],p=f===void 0?0:vB(f,o.min,o.max),m=VQ(i,o.values.length),w=h==null?void 0:h[a.size],v=w?WQ(w,p,a.direction):0;return S.useEffect(()=>{if(l)return o.thumbs.add(l),()=>{o.thumbs.delete(l)}},[l,o.thumbs]),g.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${p}% + ${v}px)`},children:[g.jsx(B1.ItemSlot,{scope:t.__scopeSlider,children:g.jsx(Fe.span,{role:"slider","aria-label":t["aria-label"]||m,"aria-valuemin":o.min,"aria-valuenow":f,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...s,ref:c,style:f===void 0?{display:"none"}:t.style,onFocus:fe(t.onFocus,()=>{o.valueIndexToChangeRef.current=i})})}),d&&g.jsx(zQ,{name:r??(o.name?o.name+(o.values.length>1?"[]":""):void 0),value:f},i)]})});gB.displayName=z1;var zQ=t=>{const{value:e,...n}=t,i=S.useRef(null),r=G_(e);return S.useEffect(()=>{const s=i.current,o=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(o,"value").set;if(r!==e&&l){const u=new Event("input",{bubbles:!0});l.call(s,e),s.dispatchEvent(u)}},[r,e]),g.jsx("input",{style:{display:"none"},...n,ref:i,defaultValue:e})};function UQ(t=[],e,n){const i=[...t];return i[n]=e,i.sort((r,s)=>r-s)}function vB(t,e,n){const s=100/(n-e)*(t-e);return Iv(s,[0,100])}function VQ(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function HQ(t,e){if(t.length===1)return 0;const n=t.map(r=>Math.abs(r-e)),i=Math.min(...n);return n.indexOf(i)}function WQ(t,e,n){const i=t/2,s=X_([0,50],[0,i]);return(i-s(e)*n)*n}function GQ(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function KQ(t,e){if(e>0){const n=GQ(t);return Math.min(...n)>=e}return!0}function X_(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const i=(e[1]-e[0])/(t[1]-t[0]);return e[0]+i*(n-t[0])}}function XQ(t){return(String(t).split(".")[1]||"").length}function qQ(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}var yB=uB,YQ=pB,JQ=mB,ZQ=gB;const Sl=S.forwardRef(({className:t,...e},n)=>g.jsxs(yB,{ref:n,className:Ue("relative flex touch-none select-none items-center",t),...e,children:[g.jsx(YQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-stone-900",children:g.jsx(JQ,{className:"absolute h-full bg-mantis-400"})}),g.jsx(ZQ,{className:"block h-5 w-5 rounded-full border-2 border-stone-900 bg-mantis-400 ring-offset-stone-800 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Sl.displayName=yB.displayName;var q_="Switch",[QQ,woe]=ls(q_),[eee,tee]=QQ(q_),wB=S.forwardRef((t,e)=>{const{__scopeSwitch:n,name:i,checked:r,defaultChecked:s,required:o,disabled:a,value:l="on",onCheckedChange:u,...c}=t,[d,h]=S.useState(null),f=rt(e,y=>h(y)),p=S.useRef(!1),m=d?!!d.closest("form"):!0,[w=!1,v]=To({prop:r,defaultProp:s,onChange:u});return g.jsxs(eee,{scope:n,checked:w,disabled:a,children:[g.jsx(Fe.button,{type:"button",role:"switch","aria-checked":w,"aria-required":o,"data-state":SB(w),"data-disabled":a?"":void 0,disabled:a,value:l,...c,ref:f,onClick:fe(t.onClick,y=>{v(b=>!b),m&&(p.current=y.isPropagationStopped(),p.current||y.stopPropagation())})}),m&&g.jsx(nee,{control:d,bubbles:!p.current,name:i,value:l,checked:w,required:o,disabled:a,style:{transform:"translateX(-100%)"}})]})});wB.displayName=q_;var bB="SwitchThumb",xB=S.forwardRef((t,e)=>{const{__scopeSwitch:n,...i}=t,r=tee(bB,n);return g.jsx(Fe.span,{"data-state":SB(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:e})});xB.displayName=bB;var nee=t=>{const{control:e,checked:n,bubbles:i=!0,...r}=t,s=S.useRef(null),o=G_(n),a=Bk(e);return S.useEffect(()=>{const l=s.current,u=window.HTMLInputElement.prototype,d=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==n&&d){const h=new Event("click",{bubbles:i});d.call(l,n),l.dispatchEvent(h)}},[o,n,i]),g.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...r,tabIndex:-1,ref:s,style:{...t.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function SB(t){return t?"checked":"unchecked"}var kB=wB,iee=xB;const jv=S.forwardRef(({className:t,...e},n)=>g.jsx(kB,{className:Ue("peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-mantis-400 data-[state=unchecked]:bg-stone-900",t),...e,ref:n,children:g.jsx(iee,{className:Ue("pointer-events-none block h-5 w-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));jv.displayName=kB.displayName;const Y_=Ae(!1);function _B({className:t}){const e=mt(),[n,i]=dj(),{status:r}=gn();return g.jsxs("div",{className:Ue("overflow-auto scrollbar-stone-700",t),children:[g.jsxs("h3",{className:"flex items-center gap-2 border-b border-stone-600 py-2 pl-4 text-xl font-semibold",children:[g.jsx("span",{className:"icon-[lucide--settings] h-6 w-6"})," ",e("settings.title")]}),g.jsxs(Hs,{children:[g.jsx(Ws,{children:g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--languages] h-6 w-6"}),e("settings.language.label")]})}),g.jsxs(Uw,{value:n.language,onValueChange:s=>i(o=>({...o,language:s})),children:[g.jsx(pg,{className:"w-32",children:g.jsx(Vw,{})}),g.jsxs(mg,{children:[g.jsx(th,{value:"en",children:g.jsxs("span",{className:"inline-flex items-center gap-2",children:[g.jsx("span",{className:"icon-[circle-flags--uk] h-4 w-4"})," English"]})}),g.jsx(th,{value:"es",children:g.jsxs("span",{className:"inline-flex items-center gap-2",children:[g.jsx("span",{className:"icon-[circle-flags--ar] h-4 w-4"})," Español"]})})]})]})]}),g.jsxs(Hs,{children:[g.jsx(Ws,{children:g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--pilcrow-square] h-6 w-6"}),e("settings.editorFontSize.label")]})}),g.jsxs("div",{className:"flex items-center rounded-lg border border-stone-600 bg-stone-900",children:[g.jsx("button",{className:"m-0.5 flex h-8 w-8 items-center justify-center rounded-lg text-white transition-colors hover:enabled:bg-stone-800 disabled:cursor-not-allowed",disabled:n.editorFontSize<=8,onClick:()=>i(s=>({...s,editorFontSize:s.editorFontSize-1})),title:e("settings.editorFontSize.decrease"),children:g.jsx("span",{className:"icon-[lucide--minus] h-4 w-4"})}),g.jsx("span",{className:"w-8 text-center text-sm font-normal",children:n.editorFontSize}),g.jsx("button",{className:"m-0.5 flex h-8 w-8 items-center justify-center rounded-lg text-white transition-colors hover:enabled:bg-stone-800 disabled:cursor-not-allowed",disabled:n.editorFontSize>=64,onClick:()=>i(s=>({...s,editorFontSize:s.editorFontSize+1})),title:e("settings.editorFontSize.increase"),children:g.jsx("span",{className:"icon-[lucide--plus] h-4 w-4"})})]})]}),g.jsx("hr",{className:"border-stone-600"}),g.jsxs(Hs,{children:[g.jsxs(Ws,{children:[g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--memory-stick] h-6 w-6"}),e("settings.dataOnLoad.label")]}),g.jsx(ym,{children:e("settings.dataOnLoad.description")})]}),g.jsxs(Uw,{value:n.dataOnLoad,onValueChange:s=>i(o=>({...o,dataOnLoad:s})),children:[g.jsx(pg,{className:"w-32 min-w-[theme(width.32)]",children:g.jsx(Vw,{})}),g.jsx(mg,{children:uj.map(s=>g.jsx(th,{value:s,children:e(`settings.dataOnLoad.${s}`)},s))})]})]}),g.jsxs(Hs,{children:[g.jsxs(Ws,{children:[g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--monitor-smartphone] h-6 w-6"}),e("settings.devices.label")]}),g.jsx(ym,{children:e("settings.devices.description")})]}),g.jsxs(Uw,{value:n.devices,onValueChange:s=>i(o=>({...o,devices:s})),disabled:r.type!=="stopped",children:[g.jsx(pg,{className:"w-52 min-w-[theme(width.52)]",children:g.jsx(Vw,{})}),g.jsx(mg,{children:cj.map(s=>g.jsx(th,{value:s,children:e(`settings.devices.${s}`)},s))})]})]}),g.jsx("hr",{className:"border-stone-600"}),g.jsxs(Hs,{children:[g.jsxs(Ws,{children:[g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--rotate-3d] h-6 w-6"}),e("settings.animations.label")]}),g.jsx(ym,{children:e("settings.animations.description")})]}),g.jsx(jv,{className:"ml-8",checked:n.animations,onCheckedChange:s=>{i(o=>({...o,animations:s})),s===!1&&iF()}})]}),g.jsxs(Hs,{children:[g.jsx(Ws,{children:g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--gauge] h-6 w-6"}),e("settings.speeds.executionUnit")]})}),g.jsx(Sl,{className:"w-44",...Hw({value:n.executionUnit,onValueChange:s=>i(o=>({...o,executionUnit:s})),min:500,max:1})})]}),g.jsxs(Hs,{children:[g.jsx(Ws,{children:g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--clock] h-6 w-6"}),e("settings.speeds.clockSpeed")]})}),g.jsx(Sl,{className:"w-44",...Hw({value:n.clockSpeed,onValueChange:s=>i(o=>({...o,clockSpeed:s})),min:3e3,max:100})})]}),g.jsxs(Hs,{children:[g.jsx(Ws,{children:g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--printer] h-6 w-6"}),e("settings.speeds.printerSpeed")]})}),g.jsx(Sl,{className:"w-44",...Hw({value:n.printerSpeed,onValueChange:s=>i(o=>({...o,printerSpeed:s})),min:2e4,max:500})})]}),g.jsx("hr",{className:"border-stone-600"}),g.jsxs(Hs,{children:[g.jsxs(Ws,{children:[g.jsxs(Gs,{children:[g.jsx("span",{className:"icon-[lucide--contrast] h-6 w-6"}),e("settings.filters.label")]}),g.jsxs(ym,{children:[e("settings.filters.description"),g.jsx("button",{className:"mt-1 block text-mantis-400 transition-colors hover:text-mantis-300",onClick:()=>i(s=>({...s,filterBightness:Cu.filterBightness,filterContrast:Cu.filterContrast,filterInvert:Cu.filterInvert,filterSaturation:Cu.filterSaturation})),children:e("settings.filters.revert")})]})]}),g.jsxs("div",{className:"ml-8 grid w-64 grid-cols-[min-content,auto] items-center gap-2",children:[g.jsx("span",{className:"text-xs",children:e("settings.filters.brightness")}),g.jsx(Sl,{value:[n.filterBightness],onValueChange:([s])=>i(o=>({...o,filterBightness:s})),min:0,max:5,step:.05}),g.jsx("span",{className:"text-xs",children:e("settings.filters.contrast")}),g.jsx(Sl,{value:[n.filterContrast],onValueChange:([s])=>i(o=>({...o,filterContrast:s})),min:0,max:5,step:.05}),g.jsx("span",{className:"text-xs",children:e("settings.filters.invert")}),g.jsx(jv,{checked:n.filterInvert,onCheckedChange:s=>i(o=>({...o,filterInvert:s}))}),g.jsx("span",{className:"text-xs",children:e("settings.filters.saturation")}),g.jsx(Sl,{value:[n.filterSaturation],onValueChange:([s])=>i(o=>({...o,filterSaturation:s})),min:0,max:5,step:.05})]})]}),g.jsx("hr",{className:"border-stone-600"}),g.jsx("div",{className:"flex justify-end p-4",children:g.jsxs("button",{className:"inline-flex items-center gap-1 text-sm text-red-500 transition-colors hover:text-red-400",onClick:()=>i(s=>({...Cu,language:s.language,devices:s.devices})),children:[g.jsx("span",{className:"icon-[lucide--trash-2] h-4 w-4"}),e("settings.reset")]})})]})}function Hs({children:t}){return g.jsx("div",{className:"m-4 flex items-center justify-between gap-4",children:t})}function Ws({children:t}){return g.jsx("div",{className:"grow",children:t})}function Gs({children:t}){return g.jsx("p",{className:"flex items-center gap-2 font-medium",children:t})}function ym({children:t}){return g.jsx("p",{className:"mt-1 text-xs text-stone-400",children:t})}function Hw({value:t,onValueChange:e,min:n,max:i}){const r=Math.log(n),o=(Math.log(i)-r)/100;return{value:[(Math.log(t)-r)/o],onValueChange:a=>e(Math.exp(r+o*a[0])),min:0,max:100}}function ree(){const t=mt(),[e,n]=td(Y_);return g.jsxs("header",{className:"relative p-2 text-sm text-white",children:[g.jsx(iQ,{className:" absolute inset-0"}),g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex select-none items-center justify-center",children:[g.jsx("img",{src:"/VonSim8/favicon.svg",className:"mr-2 h-10 w-10"}),g.jsxs("h1",{className:"text-xl font-bold max-sm:hidden",children:["Von",g.jsx("span",{className:"text-mantis-400",children:"Sim"}),"8"]})]}),g.jsx("button",{className:Ue("h-min w-min rounded-full p-2 transition-colors focus:outline-stone-400",e?"bg-stone-700 hover:bg-stone-600 focus:bg-stone-600":"hover:bg-stone-800 focus:bg-stone-800"),title:t("settings.title"),onClick:()=>n(!e),children:g.jsx("span",{className:"icon-[lucide--settings] block h-6 w-6"})})]})]})}var J_="ToastProvider",[Z_,see,oee]=Gf("Toast"),[CB,boe]=ls("Toast",[oee]),[aee,t0]=CB(J_),EB=t=>{const{__scopeToast:e,label:n="Notification",duration:i=5e3,swipeDirection:r="right",swipeThreshold:s=50,children:o}=t,[a,l]=S.useState(null),[u,c]=S.useState(0),d=S.useRef(!1),h=S.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${J_}\`. Expected non-empty \`string\`.`),g.jsx(Z_.Provider,{scope:e,children:g.jsx(aee,{scope:e,label:n,duration:i,swipeDirection:r,swipeThreshold:s,toastCount:u,viewport:a,onViewportChange:l,onToastAdd:S.useCallback(()=>c(f=>f+1),[]),onToastRemove:S.useCallback(()=>c(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:o})})};EB.displayName=J_;var AB="ToastViewport",lee=["F8"],U1="toast.viewportPause",V1="toast.viewportResume",PB=S.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:i=lee,label:r="Notifications ({hotkey})",...s}=t,o=t0(AB,n),a=see(n),l=S.useRef(null),u=S.useRef(null),c=S.useRef(null),d=S.useRef(null),h=rt(e,d,o.onViewportChange),f=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;S.useEffect(()=>{const w=v=>{var b;i.every(k=>v[k]||v.code===k)&&((b=d.current)==null||b.focus())};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[i]),S.useEffect(()=>{const w=l.current,v=d.current;if(p&&w&&v){const y=()=>{if(!o.isClosePausedRef.current){const E=new CustomEvent(U1);v.dispatchEvent(E),o.isClosePausedRef.current=!0}},b=()=>{if(o.isClosePausedRef.current){const E=new CustomEvent(V1);v.dispatchEvent(E),o.isClosePausedRef.current=!1}},k=E=>{!w.contains(E.relatedTarget)&&b()},_=()=>{w.contains(document.activeElement)||b()};return w.addEventListener("focusin",y),w.addEventListener("focusout",k),w.addEventListener("pointermove",y),w.addEventListener("pointerleave",_),window.addEventListener("blur",y),window.addEventListener("focus",b),()=>{w.removeEventListener("focusin",y),w.removeEventListener("focusout",k),w.removeEventListener("pointermove",y),w.removeEventListener("pointerleave",_),window.removeEventListener("blur",y),window.removeEventListener("focus",b)}}},[p,o.isClosePausedRef]);const m=S.useCallback(({tabbingDirection:w})=>{const y=a().map(b=>{const k=b.ref.current,_=[k,...xee(k)];return w==="forwards"?_:_.reverse()});return(w==="forwards"?y.reverse():y).flat()},[a]);return S.useEffect(()=>{const w=d.current;if(w){const v=y=>{var _,E,A;const b=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!b){const P=document.activeElement,D=y.shiftKey;if(y.target===w&&D){(_=u.current)==null||_.focus();return}const $=m({tabbingDirection:D?"backwards":"forwards"}),J=$.findIndex(z=>z===P);Ww($.slice(J+1))?y.preventDefault():D?(E=u.current)==null||E.focus():(A=c.current)==null||A.focus()}};return w.addEventListener("keydown",v),()=>w.removeEventListener("keydown",v)}},[a,m]),g.jsxs(m9,{ref:l,role:"region","aria-label":r.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&g.jsx(H1,{ref:u,onFocusFromOutsideViewport:()=>{const w=m({tabbingDirection:"forwards"});Ww(w)}}),g.jsx(Z_.Slot,{scope:n,children:g.jsx(Fe.ol,{tabIndex:-1,...s,ref:h})}),p&&g.jsx(H1,{ref:c,onFocusFromOutsideViewport:()=>{const w=m({tabbingDirection:"backwards"});Ww(w)}})]})});PB.displayName=AB;var TB="ToastFocusProxy",H1=S.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:i,...r}=t,s=t0(TB,n);return g.jsx(Yy,{"aria-hidden":!0,tabIndex:0,...r,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const a=o.relatedTarget;!((u=s.viewport)!=null&&u.contains(a))&&i()}})});H1.displayName=TB;var n0="Toast",uee="toast.swipeStart",cee="toast.swipeMove",dee="toast.swipeCancel",hee="toast.swipeEnd",RB=S.forwardRef((t,e)=>{const{forceMount:n,open:i,defaultOpen:r,onOpenChange:s,...o}=t,[a=!0,l]=To({prop:i,defaultProp:r,onChange:s});return g.jsx(Fo,{present:n||a,children:g.jsx(mee,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:Wn(t.onPause),onResume:Wn(t.onResume),onSwipeStart:fe(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:fe(t.onSwipeMove,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:fe(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:fe(t.onSwipeEnd,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});RB.displayName=n0;var[fee,pee]=CB(n0,{onClose(){}}),mee=S.forwardRef((t,e)=>{const{__scopeToast:n,type:i="foreground",duration:r,open:s,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:u,onSwipeStart:c,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...p}=t,m=t0(n0,n),[w,v]=S.useState(null),y=rt(e,z=>v(z)),b=S.useRef(null),k=S.useRef(null),_=r||m.duration,E=S.useRef(0),A=S.useRef(_),P=S.useRef(0),{onToastAdd:D,onToastRemove:L}=m,B=Wn(()=>{var G;(w==null?void 0:w.contains(document.activeElement))&&((G=m.viewport)==null||G.focus()),o()}),$=S.useCallback(z=>{!z||z===1/0||(window.clearTimeout(P.current),E.current=new Date().getTime(),P.current=window.setTimeout(B,z))},[B]);S.useEffect(()=>{const z=m.viewport;if(z){const G=()=>{$(A.current),u==null||u()},Q=()=>{const ie=new Date().getTime()-E.current;A.current=A.current-ie,window.clearTimeout(P.current),l==null||l()};return z.addEventListener(U1,Q),z.addEventListener(V1,G),()=>{z.removeEventListener(U1,Q),z.removeEventListener(V1,G)}}},[m.viewport,_,l,u,$]),S.useEffect(()=>{s&&!m.isClosePausedRef.current&&$(_)},[s,_,m.isClosePausedRef,$]),S.useEffect(()=>(D(),()=>L()),[D,L]);const J=S.useMemo(()=>w?jB(w):null,[w]);return m.viewport?g.jsxs(g.Fragment,{children:[J&&g.jsx(gee,{__scopeToast:n,role:"status","aria-live":i==="foreground"?"assertive":"polite","aria-atomic":!0,children:J}),g.jsx(fee,{scope:n,onClose:B,children:jo.createPortal(g.jsx(Z_.ItemSlot,{scope:n,children:g.jsx(p9,{asChild:!0,onEscapeKeyDown:fe(a,()=>{m.isFocusedToastEscapeKeyDownRef.current||B(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:g.jsx(Fe.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":m.swipeDirection,...p,ref:y,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:fe(t.onKeyDown,z=>{z.key==="Escape"&&(a==null||a(z.nativeEvent),z.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,B()))}),onPointerDown:fe(t.onPointerDown,z=>{z.button===0&&(b.current={x:z.clientX,y:z.clientY})}),onPointerMove:fe(t.onPointerMove,z=>{if(!b.current)return;const G=z.clientX-b.current.x,Q=z.clientY-b.current.y,ie=!!k.current,H=["left","right"].includes(m.swipeDirection),j=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,te=H?j(0,G):0,pe=H?0:j(0,Q),q=z.pointerType==="touch"?10:2,ue={x:te,y:pe},O={originalEvent:z,delta:ue};ie?(k.current=ue,wm(cee,d,O,{discrete:!1})):ZT(ue,m.swipeDirection,q)?(k.current=ue,wm(uee,c,O,{discrete:!1}),z.target.setPointerCapture(z.pointerId)):(Math.abs(G)>q||Math.abs(Q)>q)&&(b.current=null)}),onPointerUp:fe(t.onPointerUp,z=>{const G=k.current,Q=z.target;if(Q.hasPointerCapture(z.pointerId)&&Q.releasePointerCapture(z.pointerId),k.current=null,b.current=null,G){const ie=z.currentTarget,H={originalEvent:z,delta:G};ZT(G,m.swipeDirection,m.swipeThreshold)?wm(hee,f,H,{discrete:!0}):wm(dee,h,H,{discrete:!0}),ie.addEventListener("click",j=>j.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),gee=t=>{const{__scopeToast:e,children:n,...i}=t,r=t0(n0,e),[s,o]=S.useState(!1),[a,l]=S.useState(!1);return wee(()=>o(!0)),S.useEffect(()=>{const u=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(u)},[]),a?null:g.jsx(np,{asChild:!0,children:g.jsx(Yy,{...i,children:s&&g.jsxs(g.Fragment,{children:[r.label," ",n]})})})},vee="ToastTitle",NB=S.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t;return g.jsx(Fe.div,{...i,ref:e})});NB.displayName=vee;var yee="ToastDescription",MB=S.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t;return g.jsx(Fe.div,{...i,ref:e})});MB.displayName=yee;var OB="ToastAction",DB=S.forwardRef((t,e)=>{const{altText:n,...i}=t;return n.trim()?g.jsx(LB,{altText:n,asChild:!0,children:g.jsx(Q_,{...i,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${OB}\`. Expected non-empty \`string\`.`),null)});DB.displayName=OB;var IB="ToastClose",Q_=S.forwardRef((t,e)=>{const{__scopeToast:n,...i}=t,r=pee(IB,n);return g.jsx(LB,{asChild:!0,children:g.jsx(Fe.button,{type:"button",...i,ref:e,onClick:fe(t.onClick,r.onClose)})})});Q_.displayName=IB;var LB=S.forwardRef((t,e)=>{const{__scopeToast:n,altText:i,...r}=t;return g.jsx(Fe.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":i||void 0,...r,ref:e})});function jB(t){const e=[];return Array.from(t.childNodes).forEach(i=>{if(i.nodeType===i.TEXT_NODE&&i.textContent&&e.push(i.textContent),bee(i)){const r=i.ariaHidden||i.hidden||i.style.display==="none",s=i.dataset.radixToastAnnounceExclude==="";if(!r)if(s){const o=i.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...jB(i))}}),e}function wm(t,e,n,{discrete:i}){const r=n.originalEvent.currentTarget,s=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),i?hk(r,s):r.dispatchEvent(s)}var ZT=(t,e,n=0)=>{const i=Math.abs(t.x),r=Math.abs(t.y),s=i>r;return e==="left"||e==="right"?s&&i>n:!s&&r>n};function wee(t=()=>{}){const e=Wn(t);Hn(()=>{let n=0,i=0;return n=window.requestAnimationFrame(()=>i=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(i)}},[e])}function bee(t){return t.nodeType===t.ELEMENT_NODE}function xee(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const r=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||r?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Ww(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var See=EB,FB=PB,BB=RB,$B=NB,zB=MB,UB=DB,VB=Q_;const kee=See,HB=S.forwardRef(({className:t,...e},n)=>g.jsx(FB,{ref:n,className:Ue("fixed inset-x-0 top-12 z-[100] mx-auto flex max-h-screen w-full flex-col p-4 md:max-w-[420px]",t),...e}));HB.displayName=FB.displayName;const WB=S.forwardRef(({className:t,variant:e="default",...n},i)=>g.jsx(BB,{ref:i,"data-variant":e,className:Ue("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-bottom-full data-[state=open]:slide-in-from-top-full",e==="default"&&"border border-stone-600 bg-stone-900 text-white",e==="error"&&"group bg-red-900 text-red-50",e==="info"&&"border border-green-500 border-stone-600 bg-stone-900 text-white",t),...n}));WB.displayName=BB.displayName;const GB=S.forwardRef(({className:t,...e},n)=>g.jsx(UB,{ref:n,className:Ue("inline-flex h-8 shrink-0 items-center justify-center rounded-md bg-mantis-500 px-3 text-sm font-medium ring-offset-stone-900 transition-colors hover:bg-mantis-400 focus:outline-none focus:ring-2 focus:ring-stone-600 focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50","group-data-[variant=error]:border group-data-[variant=error]:border-white/40 group-data-[variant=error]:hover:border-white/30  group-data-[variant=error]:hover:bg-red-700 group-data-[variant=error]:hover:text-white group-data-[variant=error]:focus:ring-white",t),...e}));GB.displayName=UB.displayName;const KB=S.forwardRef(({className:t,...e},n)=>g.jsx(VB,{ref:n,className:Ue("text-current/50 absolute right-2 top-2 rounded-md p-1 opacity-0 transition-opacity hover:text-current focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-data-[variant=error]:text-red-300 group-data-[variant=error]:hover:text-red-50 group-data-[variant=error]:focus:ring-red-400 group-data-[variant=error]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:g.jsx("span",{className:"icon-[lucide--x] block h-4 w-4"})}));KB.displayName=VB.displayName;const XB=S.forwardRef(({className:t,...e},n)=>g.jsx($B,{ref:n,className:Ue("text-sm font-semibold",t),...e}));XB.displayName=$B.displayName;const qB=S.forwardRef(({className:t,...e},n)=>g.jsx(zB,{ref:n,className:Ue("text-sm opacity-90",t),...e}));qB.displayName=zB.displayName;var gr=function(t,e){return Number(t.toFixed(e))},_ee=function(t,e){return e},Ot=function(t,e,n){n&&typeof n=="function"&&n(t,e)},Cee=function(t){return-Math.cos(t*Math.PI)/2+.5},Eee=function(t){return t},Aee=function(t){return t*t},Pee=function(t){return t*(2-t)},Tee=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},Ree=function(t){return t*t*t},Nee=function(t){return--t*t*t+1},Mee=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},Oee=function(t){return t*t*t*t},Dee=function(t){return 1- --t*t*t*t},Iee=function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},Lee=function(t){return t*t*t*t*t},jee=function(t){return 1+--t*t*t*t*t},Fee=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},YB={easeOut:Cee,linear:Eee,easeInQuad:Aee,easeOutQuad:Pee,easeInOutQuad:Tee,easeInCubic:Ree,easeOutCubic:Nee,easeInOutCubic:Mee,easeInQuart:Oee,easeOutQuart:Dee,easeInOutQuart:Iee,easeInQuint:Lee,easeOutQuint:jee,easeInOutQuint:Fee},JB=function(t){typeof t=="number"&&cancelAnimationFrame(t)},Ps=function(t){t.mounted&&(JB(t.animation),t.animate=!1,t.animation=null,t.velocity=null)};function ZB(t,e,n,i){if(t.mounted){var r=new Date().getTime(),s=1;Ps(t),t.animation=function(){if(!t.mounted)return JB(t.animation);var o=new Date().getTime()-r,a=o/n,l=YB[e],u=l(a);o>=n?(i(s),t.animation=null):t.animation&&(i(u),requestAnimationFrame(t.animation))},requestAnimationFrame(t.animation)}}function Bee(t){var e=t.scale,n=t.positionX,i=t.positionY;return!(Number.isNaN(e)||Number.isNaN(n)||Number.isNaN(i))}function al(t,e,n,i){var r=Bee(e);if(!(!t.mounted||!r)){var s=t.setTransformState,o=t.transformState,a=o.scale,l=o.positionX,u=o.positionY,c=e.scale-a,d=e.positionX-l,h=e.positionY-u;n===0?s(e.scale,e.positionX,e.positionY):ZB(t,i,n,function(f){var p=a+c*f,m=l+d*f,w=u+h*f;s(p,m,w)})}}function $ee(t,e,n){var i=t.offsetWidth,r=t.offsetHeight,s=e.offsetWidth,o=e.offsetHeight,a=s*n,l=o*n,u=i-a,c=r-l;return{wrapperWidth:i,wrapperHeight:r,newContentWidth:a,newDiffWidth:u,newContentHeight:l,newDiffHeight:c}}var zee=function(t,e,n,i,r,s,o){var a=t>e?n*(o?1:.5):0,l=i>r?s*(o?1:.5):0,u=t-e-a,c=a,d=i-r-l,h=l;return{minPositionX:u,maxPositionX:c,minPositionY:d,maxPositionY:h}},eC=function(t,e){var n=t.wrapperComponent,i=t.contentComponent,r=t.setup.centerZoomedOut;if(!n||!i)throw new Error("Components are not mounted");var s=$ee(n,i,e),o=s.wrapperWidth,a=s.wrapperHeight,l=s.newContentWidth,u=s.newDiffWidth,c=s.newContentHeight,d=s.newDiffHeight,h=zee(o,l,u,a,c,d,!!r);return h},W1=function(t,e,n,i){return i?t<e?gr(e,2):t>n?gr(n,2):gr(t,2):gr(t,2)},Wc=function(t,e){var n=eC(t,e);return t.bounds=n,n};function cp(t,e,n,i,r,s,o){var a=n.minPositionX,l=n.minPositionY,u=n.maxPositionX,c=n.maxPositionY,d=0,h=0;o&&(d=r,h=s);var f=W1(t,a-d,u+d,i),p=W1(e,l-h,c+h,i);return{x:f,y:p}}function i0(t,e,n,i,r,s){var o=t.transformState,a=o.scale,l=o.positionX,u=o.positionY,c=i-a;if(typeof e!="number"||typeof n!="number")return console.error("Mouse X and Y position were not provided!"),{x:l,y:u};var d=l-e*c,h=u-n*c,f=cp(d,h,r,s,0,0,null);return f}function dp(t,e,n,i,r){var s=r?i:0,o=e-s;return!Number.isNaN(n)&&t>=n?n:!Number.isNaN(e)&&t<=o?o:t}var QT=function(t,e){var n=t.setup.panning.excluded,i=t.isInitialized,r=t.wrapperComponent,s=e.target,o="shadowRoot"in s&&"composedPath"in e,a=o?e.composedPath().some(function(c){return c instanceof Element?r==null?void 0:r.contains(c):!1}):r==null?void 0:r.contains(s),l=i&&s&&a;if(!l)return!1;var u=r0(s,n);return!u},eR=function(t){var e=t.isInitialized,n=t.isPanning,i=t.setup,r=i.panning.disabled,s=e&&n&&!r;return!!s},Uee=function(t,e){var n=t.transformState,i=n.positionX,r=n.positionY;t.isPanning=!0;var s=e.clientX,o=e.clientY;t.startCoords={x:s-i,y:o-r}},Vee=function(t,e){var n=e.touches,i=t.transformState,r=i.positionX,s=i.positionY;t.isPanning=!0;var o=n.length===1;if(o){var a=n[0].clientX,l=n[0].clientY;t.startCoords={x:a-r,y:l-s}}};function Hee(t){var e=t.transformState,n=e.positionX,i=e.positionY,r=e.scale,s=t.setup,o=s.disabled,a=s.limitToBounds,l=s.centerZoomedOut,u=t.wrapperComponent;if(!(o||!u||!t.bounds)){var c=t.bounds,d=c.maxPositionX,h=c.minPositionX,f=c.maxPositionY,p=c.minPositionY,m=n>d||n<h,w=i>f||i<p,v=n>d?u.offsetWidth:t.setup.minPositionX||0,y=i>f?u.offsetHeight:t.setup.minPositionY||0,b=i0(t,v,y,r,t.bounds,a||l),k=b.x,_=b.y;return{scale:r,positionX:m?k:n,positionY:w?_:i}}}function QB(t,e,n,i,r){var s=t.setup.limitToBounds,o=t.wrapperComponent,a=t.bounds,l=t.transformState,u=l.scale,c=l.positionX,d=l.positionY;if(!(o===null||a===null||e===c&&n===d)){var h=cp(e,n,a,s,i,r,o),f=h.x,p=h.y;t.setTransformState(u,f,p)}}var Wee=function(t,e,n){var i=t.startCoords,r=t.transformState,s=t.setup.panning,o=s.lockAxisX,a=s.lockAxisY,l=r.positionX,u=r.positionY;if(!i)return{x:l,y:u};var c=e-i.x,d=n-i.y,h=o?l:c,f=a?u:d;return{x:h,y:f}},Ja=function(t,e){var n=t.setup,i=t.transformState,r=i.scale,s=n.minScale,o=n.disablePadding;return e>0&&r>=s&&!o?e:0},Gee=function(t){var e=t.mounted,n=t.setup,i=n.disabled,r=n.velocityAnimation,s=t.transformState.scale,o=r.disabled,a=!o||s>1||!i||e;return!!a},Kee=function(t){var e=t.mounted,n=t.velocity,i=t.bounds,r=t.setup,s=r.disabled,o=r.velocityAnimation,a=t.transformState.scale,l=o.disabled,u=!l||a>1||!s||e;return!(!u||!n||!i)};function Xee(t,e){var n=t.setup.velocityAnimation,i=n.equalToMove,r=n.animationTime,s=n.sensitivity;return i?r*e*s:r}function tR(t,e,n,i,r,s,o,a,l,u){if(r){if(e>o&&n>o){var c=o+(t-o)*u;return c>l?l:c<o?o:c}if(e<s&&n<s){var c=s+(t-s)*u;return c<a?a:c>s?s:c}}return i?e:W1(t,s,o,r)}function qee(t,e){var n=1;return e?Math.min(n,t.offsetWidth/window.innerWidth):n}function Yee(t,e){var n=Gee(t);if(n){var i=t.lastMousePosition,r=t.velocityTime,s=t.setup,o=t.wrapperComponent,a=s.velocityAnimation.equalToMove,l=Date.now();if(i&&r&&o){var u=qee(o,a),c=e.x-i.x,d=e.y-i.y,h=c/u,f=d/u,p=l-r,m=c*c+d*d,w=Math.sqrt(m)/p;t.velocity={velocityX:h,velocityY:f,total:w}}t.lastMousePosition=e,t.velocityTime=l}}function Jee(t){var e=t.velocity,n=t.bounds,i=t.setup,r=t.wrapperComponent,s=Kee(t);if(!(!s||!e||!n||!r)){var o=e.velocityX,a=e.velocityY,l=e.total,u=n.maxPositionX,c=n.minPositionX,d=n.maxPositionY,h=n.minPositionY,f=i.limitToBounds,p=i.alignmentAnimation,m=i.zoomAnimation,w=i.panning,v=w.lockAxisY,y=w.lockAxisX,b=m.animationType,k=p.sizeX,_=p.sizeY,E=p.velocityAlignmentTime,A=E,P=Xee(t,l),D=Math.max(P,A),L=Ja(t,k),B=Ja(t,_),$=L*r.offsetWidth/100,J=B*r.offsetHeight/100,z=u+$,G=c-$,Q=d+J,ie=h-J,H=t.transformState,j=new Date().getTime();ZB(t,b,D,function(te){var pe=t.transformState,q=pe.scale,ue=pe.positionX,O=pe.positionY,M=new Date().getTime()-j,F=M/A,x=YB[p.animationType],T=1-x(Math.min(1,F)),N=1-te,R=ue+o*N,W=O+a*N,U=tR(R,H.positionX,ue,y,f,c,u,G,z,T),Z=tR(W,H.positionY,O,v,f,h,d,ie,Q,T);(ue!==R||O!==W)&&t.setTransformState(q,U,Z)})}}function nR(t,e){var n=t.transformState.scale;Ps(t),Wc(t,n),window.TouchEvent!==void 0&&e instanceof TouchEvent?Vee(t,e):Uee(t,e)}function e$(t){var e=t.transformState.scale,n=t.setup,i=n.minScale,r=n.alignmentAnimation,s=r.disabled,o=r.sizeX,a=r.sizeY,l=r.animationTime,u=r.animationType,c=s||e<i||!o&&!a;if(!c){var d=Hee(t);d&&al(t,d,l,u)}}function iR(t,e,n){var i=t.startCoords,r=t.setup,s=r.alignmentAnimation,o=s.sizeX,a=s.sizeY;if(i){var l=Wee(t,e,n),u=l.x,c=l.y,d=Ja(t,o),h=Ja(t,a);Yee(t,{x:u,y:c}),QB(t,u,c,d,h)}}function Zee(t){if(t.isPanning){var e=t.setup.panning.velocityDisabled,n=t.velocity,i=t.wrapperComponent,r=t.contentComponent;t.isPanning=!1,t.animate=!1,t.animation=null;var s=i==null?void 0:i.getBoundingClientRect(),o=r==null?void 0:r.getBoundingClientRect(),a=(s==null?void 0:s.width)||0,l=(s==null?void 0:s.height)||0,u=(o==null?void 0:o.width)||0,c=(o==null?void 0:o.height)||0,d=a<u||l<c,h=!e&&n&&(n==null?void 0:n.total)>.1&&d;h?Jee(t):e$(t)}}function tC(t,e,n,i){var r=t.setup,s=r.minScale,o=r.maxScale,a=r.limitToBounds,l=dp(gr(e,2),s,o,0,!1),u=Wc(t,l),c=i0(t,n,i,l,u,a),d=c.x,h=c.y;return{scale:l,positionX:d,positionY:h}}function t$(t,e,n){var i=t.transformState.scale,r=t.wrapperComponent,s=t.setup,o=s.minScale,a=s.limitToBounds,l=s.zoomAnimation,u=l.disabled,c=l.animationTime,d=l.animationType,h=u||i>=o;if((i>=1||a)&&e$(t),!(h||!r||!t.mounted)){var f=e||r.offsetWidth/2,p=n||r.offsetHeight/2,m=tC(t,o,f,p);m&&al(t,m,c,d)}}var Da=function(){return Da=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Da.apply(this,arguments)};function rR(t,e,n){for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}var bm={previousScale:1,scale:1,positionX:0,positionY:0},Od={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},G1={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},n$=function(t){var e,n,i,r;return{previousScale:(e=t.initialScale)!==null&&e!==void 0?e:bm.scale,scale:(n=t.initialScale)!==null&&n!==void 0?n:bm.scale,positionX:(i=t.initialPositionX)!==null&&i!==void 0?i:bm.positionX,positionY:(r=t.initialPositionY)!==null&&r!==void 0?r:bm.positionY}},sR=function(t){var e=Da({},Od);return Object.keys(t).forEach(function(n){var i=typeof t[n]<"u",r=typeof Od[n]<"u";if(r&&i){var s=Object.prototype.toString.call(Od[n]),o=s==="[object Object]",a=s==="[object Array]";o?e[n]=Da(Da({},Od[n]),t[n]):a?e[n]=rR(rR([],Od[n],!0),t[n]):e[n]=t[n]}}),e},i$=function(t,e,n){var i=t.transformState.scale,r=t.wrapperComponent,s=t.setup,o=s.maxScale,a=s.minScale,l=s.zoomAnimation,u=s.smooth,c=l.size;if(!r)throw new Error("Wrapper is not mounted");var d=u?i*Math.exp(e*n):i+e*n,h=dp(gr(d,3),a,o,c,!1);return h};function r$(t,e,n,i,r){var s=t.wrapperComponent,o=t.transformState,a=o.scale,l=o.positionX,u=o.positionY;if(!s)return console.error("No WrapperComponent found");var c=s.offsetWidth,d=s.offsetHeight,h=(c/2-l)/a,f=(d/2-u)/a,p=i$(t,e,n),m=tC(t,p,h,f);if(!m)return console.error("Error during zoom event. New transformation state was not calculated.");al(t,m,i,r)}function s$(t,e,n,i){var r=t.setup,s=t.wrapperComponent,o=r.limitToBounds,a=n$(t.props),l=t.transformState,u=l.scale,c=l.positionX,d=l.positionY;if(s){var h=eC(t,a.scale),f=cp(a.positionX,a.positionY,h,o,0,0,s),p={scale:a.scale,positionX:f.x,positionY:f.y};u===a.scale&&c===a.positionX&&d===a.positionY||(i==null||i(),al(t,p,e,n))}}function Qee(t,e,n,i){var r=t.getBoundingClientRect(),s=e.getBoundingClientRect(),o=n.getBoundingClientRect(),a=s.x*i.scale,l=s.y*i.scale;return{x:(r.x-o.x+a)/i.scale,y:(r.y-o.y+l)/i.scale}}function ete(t,e,n){var i=t.wrapperComponent,r=t.contentComponent,s=t.transformState,o=t.setup,a=o.limitToBounds,l=o.minScale,u=o.maxScale;if(!i||!r)return s;var c=i.getBoundingClientRect(),d=e.getBoundingClientRect(),h=Qee(e,i,r,s),f=h.x,p=h.y,m=d.width/s.scale,w=d.height/s.scale,v=i.offsetWidth/m,y=i.offsetHeight/w,b=dp(n||Math.min(v,y),l,u,0,!1),k=(c.width-m*b)/2,_=(c.height-w*b)/2,E=(c.left-f)*b+k,A=(c.top-p)*b+_,P=eC(t,b),D=cp(E,A,P,a,0,0,i),L=D.x,B=D.y;return{positionX:L,positionY:B,scale:b}}var tte=function(t){return function(e,n,i){e===void 0&&(e=.5),n===void 0&&(n=300),i===void 0&&(i="easeOut"),r$(t,1,e,n,i)}},nte=function(t){return function(e,n,i){e===void 0&&(e=.5),n===void 0&&(n=300),i===void 0&&(i="easeOut"),r$(t,-1,e,n,i)}},ite=function(t){return function(e,n,i,r,s){r===void 0&&(r=300),s===void 0&&(s="easeOut");var o=t.transformState,a=o.positionX,l=o.positionY,u=o.scale,c=t.wrapperComponent,d=t.contentComponent,h=t.setup.disabled;if(!(h||!c||!d)){var f={positionX:Number.isNaN(e)?a:e,positionY:Number.isNaN(n)?l:n,scale:Number.isNaN(i)?u:i};al(t,f,r,s)}}},rte=function(t){return function(e,n){e===void 0&&(e=200),n===void 0&&(n="easeOut"),s$(t,e,n)}},ste=function(t){return function(e,n,i){n===void 0&&(n=200),i===void 0&&(i="easeOut");var r=t.transformState,s=t.wrapperComponent,o=t.contentComponent;if(s&&o){var a=o$(e||r.scale,s,o);al(t,a,n,i)}}},ote=function(t){return function(e,n,i,r){i===void 0&&(i=600),r===void 0&&(r="easeOut"),Ps(t);var s=t.wrapperComponent,o=typeof e=="string"?document.getElementById(e):e;if(s&&o&&s.contains(o)){var a=ete(t,o,n);al(t,a,i,r)}}},K1=function(t){return{instance:t,zoomIn:tte(t),zoomOut:nte(t),setTransform:ite(t),resetTransform:rte(t),centerView:ste(t),zoomToElement:ote(t)}},ate=function(t){return{instance:t,state:t.transformState}},vt=function(t){var e={};return Object.assign(e,ate(t)),Object.assign(e,K1(t)),e},Gw=!1;function Kw(){try{var t={get passive(){return Gw=!0,!1}};return t}catch{return Gw=!1,Gw}}var xm=".".concat(G1.wrapperClass),r0=function(t,e){return e.some(function(n){return t.matches("".concat(xm," ").concat(n,", ").concat(xm," .").concat(n,", ").concat(xm," ").concat(n," *, ").concat(xm," .").concat(n," *"))})},X1=function(t){t&&clearTimeout(t)},lte=function(t,e,n){return"translate(".concat(t,"px, ").concat(e,"px) scale(").concat(n,")")},o$=function(t,e,n){var i=n.offsetWidth*t,r=n.offsetHeight*t,s=(e.offsetWidth-i)/2,o=(e.offsetHeight-r)/2;return{scale:t,positionX:s,positionY:o}};function ute(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var cte=function(t,e){var n=t.setup.wheel,i=n.disabled,r=n.wheelDisabled,s=n.touchPadDisabled,o=n.excluded,a=t.isInitialized,l=t.isPanning,u=e.target,c=a&&!l&&!i&&u;if(!c||r&&!e.ctrlKey||s&&e.ctrlKey)return!1;var d=r0(u,o);return!d},dte=function(t){return t?t.deltaY<0?1:-1:0};function hte(t,e){var n=dte(t),i=_ee(e,n);return i}function a$(t,e,n){var i=e.getBoundingClientRect(),r=0,s=0;if("clientX"in t)r=(t.clientX-i.left)/n,s=(t.clientY-i.top)/n;else{var o=t.touches[0];r=(o.clientX-i.left)/n,s=(o.clientY-i.top)/n}return(Number.isNaN(r)||Number.isNaN(s))&&console.error("No mouse or touch offset found"),{x:r,y:s}}var fte=function(t,e,n,i,r){var s=t.transformState.scale,o=t.wrapperComponent,a=t.setup,l=a.maxScale,u=a.minScale,c=a.zoomAnimation,d=a.disablePadding,h=c.size,f=c.disabled;if(!o)throw new Error("Wrapper is not mounted");var p=s+e*n,m=i?!1:!f,w=dp(gr(p,3),u,l,h,m&&!d);return w},pte=function(t,e){var n=t.previousWheelEvent,i=t.transformState.scale,r=t.setup,s=r.maxScale,o=r.minScale;return n?i<s||i>o||Math.sign(n.deltaY)!==Math.sign(e.deltaY)||n.deltaY>0&&n.deltaY<e.deltaY||n.deltaY<0&&n.deltaY>e.deltaY||Math.sign(n.deltaY)!==Math.sign(e.deltaY):!1},mte=function(t,e){var n=t.setup.pinch,i=n.disabled,r=n.excluded,s=t.isInitialized,o=e.target,a=s&&!i&&o;if(!a)return!1;var l=r0(o,r);return!l},gte=function(t){var e=t.setup.pinch.disabled,n=t.isInitialized,i=t.pinchStartDistance,r=n&&!e&&i;return!!r},vte=function(t,e,n){var i=n.getBoundingClientRect(),r=t.touches,s=gr(r[0].clientX-i.left,5),o=gr(r[0].clientY-i.top,5),a=gr(r[1].clientX-i.left,5),l=gr(r[1].clientY-i.top,5);return{x:(s+a)/2/e,y:(o+l)/2/e}},l$=function(t){return Math.sqrt(Math.pow(t.touches[0].pageX-t.touches[1].pageX,2)+Math.pow(t.touches[0].pageY-t.touches[1].pageY,2))},yte=function(t,e){var n=t.pinchStartScale,i=t.pinchStartDistance,r=t.setup,s=r.maxScale,o=r.minScale,a=r.zoomAnimation,l=r.disablePadding,u=a.size,c=a.disabled;if(!n||i===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return t.transformState.scale;var d=e/i,h=d*n;return dp(gr(h,2),o,s,u,!c&&!l)},wte=160,bte=100,xte=function(t,e){var n=t.props,i=n.onWheelStart,r=n.onZoomStart;t.wheelStopEventTimer||(Ps(t),Ot(vt(t),e,i),Ot(vt(t),e,r))},Ste=function(t,e){var n=t.props,i=n.onWheel,r=n.onZoom,s=t.contentComponent,o=t.setup,a=t.transformState,l=a.scale,u=o.limitToBounds,c=o.centerZoomedOut,d=o.zoomAnimation,h=o.wheel,f=o.disablePadding,p=o.smooth,m=d.size,w=d.disabled,v=h.step,y=h.smoothStep;if(!s)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var b=hte(e,null),k=p?y*Math.abs(e.deltaY):v,_=fte(t,b,k,!e.ctrlKey);if(l!==_){var E=Wc(t,_),A=a$(e,s,l),P=w||m===0||c||f,D=u&&P,L=i0(t,A.x,A.y,_,E,D),B=L.x,$=L.y;t.previousWheelEvent=e,t.setTransformState(_,B,$),Ot(vt(t),e,i),Ot(vt(t),e,r)}},kte=function(t,e){var n=t.props,i=n.onWheelStop,r=n.onZoomStop;X1(t.wheelAnimationTimer),t.wheelAnimationTimer=setTimeout(function(){t.mounted&&(t$(t,e.x,e.y),t.wheelAnimationTimer=null)},bte);var s=pte(t,e);s&&(X1(t.wheelStopEventTimer),t.wheelStopEventTimer=setTimeout(function(){t.mounted&&(t.wheelStopEventTimer=null,Ot(vt(t),e,i),Ot(vt(t),e,r))},wte))},u$=function(t){for(var e=0,n=0,i=0;i<2;i+=1)e+=t.touches[i].clientX,n+=t.touches[i].clientY;var r=e/2,s=n/2;return{x:r,y:s}},_te=function(t,e){var n=l$(e);t.pinchStartDistance=n,t.lastDistance=n,t.pinchStartScale=t.transformState.scale,t.isPanning=!1;var i=u$(e);t.pinchLastCenterX=i.x,t.pinchLastCenterY=i.y,Ps(t)},Cte=function(t,e){var n=t.contentComponent,i=t.pinchStartDistance,r=t.wrapperComponent,s=t.transformState.scale,o=t.setup,a=o.limitToBounds,l=o.centerZoomedOut,u=o.zoomAnimation,c=o.alignmentAnimation,d=u.disabled,h=u.size;if(!(i===null||!n)){var f=vte(e,s,n);if(!(!Number.isFinite(f.x)||!Number.isFinite(f.y))){var p=l$(e),m=yte(t,p),w=u$(e),v=w.x-(t.pinchLastCenterX||0),y=w.y-(t.pinchLastCenterY||0);if(!(m===s&&v===0&&y===0)){t.pinchLastCenterX=w.x,t.pinchLastCenterY=w.y;var b=Wc(t,m),k=d||h===0||l,_=a&&k,E=i0(t,f.x,f.y,m,b,_),A=E.x,P=E.y;t.pinchMidpoint=f,t.lastDistance=p;var D=c.sizeX,L=c.sizeY,B=Ja(t,D),$=Ja(t,L),J=A+v,z=P+y,G=cp(J,z,b,a,B,$,r),Q=G.x,ie=G.y;t.setTransformState(m,Q,ie)}}}},Ete=function(t){var e=t.pinchMidpoint;t.velocity=null,t.lastDistance=null,t.pinchMidpoint=null,t.pinchStartScale=null,t.pinchStartDistance=null,t$(t,e==null?void 0:e.x,e==null?void 0:e.y)},c$=function(t,e){var n=t.props.onZoomStop,i=t.setup.doubleClick.animationTime;X1(t.doubleClickStopEventTimer),t.doubleClickStopEventTimer=setTimeout(function(){t.doubleClickStopEventTimer=null,Ot(vt(t),e,n)},i)},Ate=function(t,e){var n=t.props,i=n.onZoomStart,r=n.onZoom,s=t.setup.doubleClick,o=s.animationTime,a=s.animationType;Ot(vt(t),e,i),s$(t,o,a,function(){return Ot(vt(t),e,r)}),c$(t,e)};function Pte(t,e){return t==="toggle"?e===1?1:-1:t==="zoomOut"?-1:1}function Tte(t,e){var n=t.setup,i=t.doubleClickStopEventTimer,r=t.transformState,s=t.contentComponent,o=r.scale,a=t.props,l=a.onZoomStart,u=a.onZoom,c=n.doubleClick,d=c.disabled,h=c.mode,f=c.step,p=c.animationTime,m=c.animationType;if(!d&&!i){if(h==="reset")return Ate(t,e);if(!s)return console.error("No ContentComponent found");var w=Pte(h,t.transformState.scale),v=i$(t,w,f);if(o!==v){Ot(vt(t),e,l);var y=a$(e,s,o),b=tC(t,v,y.x,y.y);if(!b)return console.error("Error during zoom event. New transformation state was not calculated.");Ot(vt(t),e,u),al(t,b,p,m),c$(t,e)}}}var Rte=function(t,e){var n=t.isInitialized,i=t.setup,r=t.wrapperComponent,s=i.doubleClick,o=s.disabled,a=s.excluded,l=e.target,u=r==null?void 0:r.contains(l),c=n&&l&&u&&!o;if(!c)return!1;var d=r0(l,a);return!d},Nte=function(){function t(e){var n=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){n.initializeWindowEvents()},this.unmount=function(){n.cleanupWindowEvents()},this.update=function(i){n.props=i,Wc(n,n.transformState.scale),n.setup=sR(i)},this.initializeWindowEvents=function(){var i,r,s=Kw(),o=(i=n.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,a=o==null?void 0:o.defaultView;(r=n.wrapperComponent)===null||r===void 0||r.addEventListener("wheel",n.onWheelPanning,s),a==null||a.addEventListener("mousedown",n.onPanningStart,s),a==null||a.addEventListener("mousemove",n.onPanning,s),a==null||a.addEventListener("mouseup",n.onPanningStop,s),o==null||o.addEventListener("mouseleave",n.clearPanning,s),a==null||a.addEventListener("keyup",n.setKeyUnPressed,s),a==null||a.addEventListener("keydown",n.setKeyPressed,s)},this.cleanupWindowEvents=function(){var i,r,s=Kw(),o=(i=n.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,a=o==null?void 0:o.defaultView;a==null||a.removeEventListener("mousedown",n.onPanningStart,s),a==null||a.removeEventListener("mousemove",n.onPanning,s),a==null||a.removeEventListener("mouseup",n.onPanningStop,s),o==null||o.removeEventListener("mouseleave",n.clearPanning,s),a==null||a.removeEventListener("keyup",n.setKeyUnPressed,s),a==null||a.removeEventListener("keydown",n.setKeyPressed,s),document.removeEventListener("mouseleave",n.clearPanning,s),Ps(n),(r=n.observer)===null||r===void 0||r.disconnect()},this.handleInitializeWrapperEvents=function(i){var r=Kw();i.addEventListener("wheel",n.onWheelZoom,r),i.addEventListener("dblclick",n.onDoubleClick,r),i.addEventListener("touchstart",n.onTouchPanningStart,r),i.addEventListener("touchmove",n.onTouchPanning,r),i.addEventListener("touchend",n.onTouchPanningStop,r)},this.handleInitialize=function(i){var r=n.setup.centerOnInit;n.applyTransformation(),n.onInitCallbacks.forEach(function(s){return s(vt(n))}),r&&(n.setCenter(),n.observer=new ResizeObserver(function(){var s,o=i.offsetWidth,a=i.offsetHeight;(o>0||a>0)&&(n.onInitCallbacks.forEach(function(l){return l(vt(n))}),n.setCenter(),(s=n.observer)===null||s===void 0||s.disconnect())}),setTimeout(function(){var s;(s=n.observer)===null||s===void 0||s.disconnect()},5e3),n.observer.observe(i))},this.onWheelZoom=function(i){var r=n.setup.disabled;if(!r){var s=cte(n,i);if(s){var o=n.isPressingKeys(n.setup.wheel.activationKeys);o&&(xte(n,i),Ste(n,i),kte(n,i))}}},this.onWheelPanning=function(i){var r=n.setup,s=r.disabled,o=r.wheel,a=r.panning;if(!(!n.wrapperComponent||!n.contentComponent||s||!o.wheelDisabled||a.disabled||!a.wheelPanning||i.ctrlKey)){i.preventDefault(),i.stopPropagation();var l=n.transformState,u=l.positionX,c=l.positionY,d=u-i.deltaX,h=c-i.deltaY,f=a.lockAxisX?u:d,p=a.lockAxisY?c:h,m=n.setup.alignmentAnimation,w=m.sizeX,v=m.sizeY,y=Ja(n,w),b=Ja(n,v);f===u&&p===c||QB(n,f,p,y,b)}},this.onPanningStart=function(i){var r=n.setup.disabled,s=n.props.onPanningStart;if(!r){var o=QT(n,i);if(o){var a=n.isPressingKeys(n.setup.panning.activationKeys);a&&(i.button===0&&!n.setup.panning.allowLeftClickPan||i.button===1&&!n.setup.panning.allowMiddleClickPan||i.button===2&&!n.setup.panning.allowRightClickPan||(i.preventDefault(),i.stopPropagation(),Ps(n),nR(n,i),Ot(vt(n),i,s)))}}},this.onPanning=function(i){var r=n.setup.disabled,s=n.props.onPanning;if(!r){var o=eR(n);if(o){var a=n.isPressingKeys(n.setup.panning.activationKeys);a&&(i.preventDefault(),i.stopPropagation(),iR(n,i.clientX,i.clientY),Ot(vt(n),i,s))}}},this.onPanningStop=function(i){var r=n.props.onPanningStop;n.isPanning&&(Zee(n),Ot(vt(n),i,r))},this.onPinchStart=function(i){var r=n.setup.disabled,s=n.props,o=s.onPinchingStart,a=s.onZoomStart;if(!r){var l=mte(n,i);l&&(_te(n,i),Ps(n),Ot(vt(n),i,o),Ot(vt(n),i,a))}},this.onPinch=function(i){var r=n.setup.disabled,s=n.props,o=s.onPinching,a=s.onZoom;if(!r){var l=gte(n);l&&(i.preventDefault(),i.stopPropagation(),Cte(n,i),Ot(vt(n),i,o),Ot(vt(n),i,a))}},this.onPinchStop=function(i){var r=n.props,s=r.onPinchingStop,o=r.onZoomStop;n.pinchStartScale&&(Ete(n),Ot(vt(n),i,s),Ot(vt(n),i,o))},this.onTouchPanningStart=function(i){var r=n.setup.disabled,s=n.props.onPanningStart;if(!r){var o=QT(n,i);if(o){var a=n.lastTouch&&+new Date-n.lastTouch<200;if(!a){n.lastTouch=+new Date,Ps(n);var l=i.touches,u=l.length===1,c=l.length===2;u&&(Ps(n),nR(n,i),Ot(vt(n),i,s)),c&&n.onPinchStart(i)}}}},this.onTouchPanning=function(i){var r=n.setup.disabled,s=n.props.onPanning;if(n.isPanning&&i.touches.length===1){if(r)return;var o=eR(n);if(!o)return;i.preventDefault(),i.stopPropagation();var a=i.touches[0];iR(n,a.clientX,a.clientY),Ot(vt(n),i,s)}else i.touches.length>1&&n.onPinch(i)},this.onTouchPanningStop=function(i){n.onPanningStop(i),n.onPinchStop(i)},this.onDoubleClick=function(i){var r=n.setup.disabled;if(!r){var s=Rte(n,i);s&&Tte(n,i)}},this.clearPanning=function(i){n.isPanning&&n.onPanningStop(i)},this.setKeyPressed=function(i){n.pressedKeys[i.key]=!0},this.setKeyUnPressed=function(i){n.pressedKeys[i.key]=!1},this.isPressingKeys=function(i){return i.length?!!i.find(function(r){return n.pressedKeys[r]}):!0},this.setTransformState=function(i,r,s){var o=n.props.onTransformed;if(!Number.isNaN(i)&&!Number.isNaN(r)&&!Number.isNaN(s)){i!==n.transformState.scale&&(n.transformState.previousScale=n.transformState.scale,n.transformState.scale=i),n.transformState.positionX=r,n.transformState.positionY=s,n.applyTransformation();var a=vt(n);n.onChangeCallbacks.forEach(function(l){return l(a)}),Ot(a,{scale:i,positionX:r,positionY:s},o)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(n.wrapperComponent&&n.contentComponent){var i=o$(n.transformState.scale,n.wrapperComponent,n.contentComponent);n.setTransformState(i.scale,i.positionX,i.positionY)}},this.handleTransformStyles=function(i,r,s){return n.props.customTransform?n.props.customTransform(i,r,s):lte(i,r,s)},this.applyTransformation=function(){if(!(!n.mounted||!n.contentComponent)){var i=n.transformState,r=i.scale,s=i.positionX,o=i.positionY,a=n.handleTransformStyles(s,o,r);n.contentComponent.style.transform=a}},this.getContext=function(){return vt(n)},this.onChange=function(i){return n.onChangeCallbacks.has(i)||n.onChangeCallbacks.add(i),function(){n.onChangeCallbacks.delete(i)}},this.onInit=function(i){return n.onInitCallbacks.has(i)||n.onInitCallbacks.add(i),function(){n.onInitCallbacks.delete(i)}},this.init=function(i,r){n.cleanupWindowEvents(),n.wrapperComponent=i,n.contentComponent=r,Wc(n,n.transformState.scale),n.handleInitializeWrapperEvents(i),n.handleInitialize(r),n.initializeWindowEvents(),n.isInitialized=!0;var s=vt(n);Ot(s,void 0,n.props.onInit)},this.props=e,this.setup=sR(this.props),this.transformState=n$(this.props)}return t}(),nC=pn.createContext(null),Mte=function(t,e){return typeof t=="function"?t(e):t},Ote=pn.forwardRef(function(t,e){var n=S.useRef(new Nte(t)).current,i=Mte(t.children,K1(n));return S.useImperativeHandle(e,function(){return K1(n)},[n]),S.useEffect(function(){n.update(t)},[n,t]),pn.createElement(nC.Provider,{value:n},i)});pn.forwardRef(function(t,e){var n=S.useRef(null),i=S.useContext(nC);return S.useEffect(function(){return i.onChange(function(r){if(n.current){var s=0,o=0;n.current.style.transform=i.handleTransformStyles(s,o,1/r.instance.transformState.scale)}})},[i]),pn.createElement("div",Da({},t,{ref:ute([n,e])}))});function Dte(t,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n==="top"&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}var Ite=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,oR={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};Dte(Ite);var Lte=function(t){var e=t.children,n=t.wrapperClass,i=n===void 0?"":n,r=t.contentClass,s=r===void 0?"":r,o=t.wrapperStyle,a=t.contentStyle,l=t.wrapperProps,u=l===void 0?{}:l,c=t.contentProps,d=c===void 0?{}:c,h=S.useContext(nC),f=h.init,p=h.cleanupWindowEvents,m=S.useRef(null),w=S.useRef(null);return S.useEffect(function(){var v=m.current,y=w.current;return v!==null&&y!==null&&f&&(f==null||f(v,y)),function(){p==null||p()}},[]),pn.createElement("div",Da({},u,{ref:m,className:"".concat(G1.wrapperClass," ").concat(oR.wrapper," ").concat(i),style:o}),pn.createElement("div",Da({},d,{ref:w,className:"".concat(G1.contentClass," ").concat(oR.content," ").concat(s),style:a}),e))};function jte({wrapperRef:t}){const e=mt();return g.jsxs("div",{className:"absolute right-2 top-2 flex flex-col rounded-lg border border-stone-600 bg-stone-900 shadow",children:[g.jsx("button",{className:"m-0.5 flex h-8 w-8 items-center justify-center rounded-t-lg text-white transition-colors hover:enabled:bg-stone-800",onClick:()=>{var n;return(n=t.current)==null?void 0:n.zoomIn()},title:e("control.zoom.in"),children:g.jsx("span",{className:"icon-[lucide--zoom-in] h-4 w-4"})}),g.jsx("hr",{className:"border-stone-600"}),g.jsx("button",{className:"m-0.5 flex h-8 w-8 items-center justify-center rounded-b-lg text-white transition-colors hover:enabled:bg-stone-800",onClick:()=>{var n;return(n=t.current)==null?void 0:n.zoomOut()},title:e("control.zoom.out"),children:g.jsx("span",{className:"icon-[lucide--zoom-out] h-4 w-4"})})]})}function Fte(){const t=mt(),{devices:e}=gn();return e.hasIOBus?g.jsx("div",{className:"absolute left-[500px] top-[525px] z-10 h-[70px] w-[250px] rounded-lg border border-stone-600 bg-stone-900",children:g.jsx("span",{className:"block w-min whitespace-nowrap rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-lg text-white",children:t("computer.chip-select.name")})}):null}function Bte(){const{devices:t}=gn(),e=["M 380 420 H 800",t.hasIOBus&&"M 780 420 V 805",t.hasIOBus&&"M 450 805 H 900",t.hasIOBus&&"M 583 805 V 875"].filter(Boolean).join(" "),n=["M 380 440 H 800",t.hasIOBus&&"M 790 440 V 815",t.hasIOBus&&"M 450 815 H 900",t.hasIOBus&&"M 573 815 V 875"].filter(Boolean).join(" "),i="M 750 545 H 860 V 460";return g.jsxs("svg",{className:"pointer-events-none absolute inset-0 z-[15] h-full w-full",children:[g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:e}),g.jsx(Kt.path,{className:"fill-none stroke-[4px]",strokeLinejoin:"round",d:e,style:ft("bus.rd")}),g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:n}),g.jsx(Kt.path,{className:"fill-none stroke-[4px]",strokeLinejoin:"round",d:n,style:ft("bus.wr")}),t.hasIOBus&&g.jsxs(g.Fragment,{children:[g.jsx(dn,{springs:"bus.iom",d:"M 380 460 H 675 V 525"}),g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:i}),g.jsx(Kt.path,{className:"fill-none stroke-[4px]",strokeLinejoin:"round",d:i,style:ft("bus.mem")})]}),t.pic&&g.jsx(dn,{springs:"bus.pic",d:"M 521 595 V 730 H 450"}),t.timer&&g.jsx(dn,{springs:"bus.timer",d:"M 563 595 V 875"}),t.pio&&g.jsx(dn,{springs:"bus.pio",d:"M 612 595 V 730 H 900"}),t.handshake&&g.jsx(dn,{springs:"bus.handshake",d:"M 635 595 V 730 H 900"}),t.pic&&g.jsxs(g.Fragment,{children:[g.jsx(dn,{springs:"bus.intr",d:"M 110 700 V 470"}),g.jsx(dn,{springs:"bus.inta",d:"M 160 470 V 700"})]}),t.pic&&t.f10&&g.jsx(dn,{springs:"bus.int0",d:"M 145 950 V 900"}),t.pic&&t.timer&&g.jsx(dn,{springs:"bus.int1",d:"M 500 955 H 400 V 900"}),t.pic&&t.handshake&&g.jsx(dn,{springs:"bus.int2",d:"M 930 866 V 1050 H 300 V 900"}),t.preset==="pio-switches-and-leds"&&g.jsxs(g.Fragment,{children:[g.jsx(dn,{springs:"bus.switches->pio",d:"M 1300 768 H 1120"}),g.jsx(dn,{springs:"bus.pio->leds",d:"M 1120 858 H 1300"})]}),t.preset==="pio-printer"&&g.jsxs(g.Fragment,{children:[g.jsx(dn,{springs:"bus.printer.strobe",d:"M 1120 767 H 1250"}),g.jsx(dn,{springs:"bus.printer.busy",d:"M 1250 782 H 1120"}),g.jsx(dn,{springs:"bus.printer.data",d:"M 1120 837 H 1250"})]}),t.preset==="handshake"&&g.jsxs(g.Fragment,{children:[g.jsx(dn,{springs:"bus.printer.strobe",d:"M 1120 767 H 1250"}),g.jsx(dn,{springs:"bus.printer.busy",d:"M 1250 782 H 1120"}),g.jsx(dn,{springs:"bus.printer.data",d:"M 1120 837 H 1250"})]})]})}function dn({d:t,springs:e}){return g.jsxs(g.Fragment,{children:[g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:t}),g.jsx("path",{className:"fill-none stroke-stone-700 stroke-[4px]",strokeLinejoin:"round",d:t}),g.jsx(Kt.path,{d:t,className:"fill-none stroke-red-500 stroke-[4px]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:ft(e)})]})}function $te(){const t=mt(),{devices:e}=gn();return g.jsxs(g.Fragment,{children:[g.jsx(Mi,{className:"left-[384px] top-[403px]",children:"rd"}),g.jsx(Mi,{className:"left-[384px] top-[423px]",children:"wr"}),e.hasIOBus&&g.jsxs(g.Fragment,{children:[g.jsx(Mi,{className:"left-[384px] top-[443px]",children:"io/m"}),g.jsx(Mi,{className:"left-[715px] top-[538px]",children:t("computer.chip-select.mem")})]}),e.pic&&g.jsx(Mi,{className:"left-[510px] top-[573px]",children:t("computer.chip-select.pic")}),e.timer&&g.jsx(Mi,{className:"left-[545px] top-[573px]",children:t("computer.chip-select.timer")}),e.pio&&g.jsx(Mi,{className:"left-[600px] top-[573px]",children:t("computer.chip-select.pio")}),e.handshake&&g.jsx(Mi,{className:"left-[600px] top-[573px]",children:t("computer.chip-select.handshake")}),e.pic&&g.jsxs(g.Fragment,{children:[g.jsx(Mi,{className:"left-[75px] top-[478px]",children:"intr"}),g.jsx(Mi,{className:"left-[125px] top-[478px]",children:"inta"})]}),e.printer&&g.jsxs(g.Fragment,{children:[g.jsx(Mi,{className:"left-[1260px] top-[758px]",children:"strobe"}),g.jsx(Mi,{className:"left-[1260px] top-[773px]",children:"busy"}),g.jsx(Mi,{className:"left-[1260px] top-[828px]",children:"data"})]})]})}function Mi({className:t,children:e}){return g.jsx("span",{className:Ue("pointer-events-none absolute z-[15] block font-mono text-xs font-bold tracking-wider text-stone-400",t),children:e})}function zte(){const{devices:t}=gn(),e=["M 699 349 H 800",t.hasIOBus&&"M 725 349 V 770",t.hasIOBus&&"M 450 770 H 900",t.hasIOBus&&"M 618 770 V 875"].filter(Boolean).join(" "),n=["M 687 249 H 800",t.hasIOBus&&"M 765 249 V 790",t.hasIOBus&&"M 450 790 H 900",t.hasIOBus&&"M 598 790 V 875"].filter(Boolean).join(" ");return g.jsxs("svg",{className:"pointer-events-none absolute inset-0 z-[5] h-full w-full",children:[g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[14px]",strokeLinejoin:"round",d:n}),g.jsx(Kt.path,{className:"fill-none stroke-[12px]",strokeLinejoin:"round",d:n,style:ft("bus.data")}),g.jsx("path",{className:"fill-none stroke-stone-900 stroke-[14px]",strokeLinejoin:"round",d:e}),g.jsx(Kt.path,{className:"fill-none stroke-[12px]",strokeLinejoin:"round",d:e,style:ft("bus.address")})]})}function Ute(){return g.jsxs(g.Fragment,{children:[g.jsx(zte,{}),g.jsx(Bte,{}),g.jsx($te,{}),g.jsx(Fte,{})]})}function Vte(){const{devices:t}=gn();if(!t.clock)return null;const e=ft("clock.angle");return g.jsx("div",{className:"absolute left-[520px] top-[930px] z-10 h-12 w-12 rounded-full border border-stone-600 bg-stone-800 p-1 [&_*]:z-20",children:g.jsxs("svg",{viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-full w-full fill-none stroke-white stroke-2",children:[g.jsx("circle",{cx:"12",cy:"12",r:"10"}),g.jsx(Kt.line,{x1:e.to(n=>12+6*Math.sin(n*Math.PI/180)),y1:e.to(n=>12-6*Math.cos(n*Math.PI/180)),x2:12,y2:12})]})})}var iC="Popover",[d$,xoe]=ls(iC,[rd]),hp=rd(),[Hte,ll]=d$(iC),h$=t=>{const{__scopePopover:e,children:n,open:i,defaultOpen:r,onOpenChange:s,modal:o=!1}=t,a=hp(e),l=S.useRef(null),[u,c]=S.useState(!1),[d=!1,h]=To({prop:i,defaultProp:r,onChange:s});return g.jsx(Uk,{...a,children:g.jsx(Hte,{scope:e,contentId:Fa(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:S.useCallback(()=>h(f=>!f),[h]),hasCustomAnchor:u,onCustomAnchorAdd:S.useCallback(()=>c(!0),[]),onCustomAnchorRemove:S.useCallback(()=>c(!1),[]),modal:o,children:n})})};h$.displayName=iC;var f$="PopoverAnchor",Wte=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=ll(f$,n),s=hp(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=r;return S.useEffect(()=>(o(),()=>a()),[o,a]),g.jsx(Cy,{...s,...i,ref:e})});Wte.displayName=f$;var p$="PopoverTrigger",m$=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=ll(p$,n),s=hp(n),o=rt(e,r.triggerRef),a=g.jsx(Fe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":b$(r.open),...i,ref:o,onClick:fe(t.onClick,r.onOpenToggle)});return r.hasCustomAnchor?a:g.jsx(Cy,{asChild:!0,...s,children:a})});m$.displayName=p$;var rC="PopoverPortal",[Gte,Kte]=d$(rC,{forceMount:void 0}),g$=t=>{const{__scopePopover:e,forceMount:n,children:i,container:r}=t,s=ll(rC,e);return g.jsx(Gte,{scope:e,forceMount:n,children:g.jsx(Fo,{present:n||s.open,children:g.jsx(np,{asChild:!0,container:r,children:i})})})};g$.displayName=rC;var Gc="PopoverContent",v$=S.forwardRef((t,e)=>{const n=Kte(Gc,t.__scopePopover),{forceMount:i=n.forceMount,...r}=t,s=ll(Gc,t.__scopePopover);return g.jsx(Fo,{present:i||s.open,children:s.modal?g.jsx(Xte,{...r,ref:e}):g.jsx(qte,{...r,ref:e})})});v$.displayName=Gc;var Xte=S.forwardRef((t,e)=>{const n=ll(Gc,t.__scopePopover),i=S.useRef(null),r=rt(e,i),s=S.useRef(!1);return S.useEffect(()=>{const o=i.current;if(o)return Wk(o)},[]),g.jsx(Ay,{as:Xl,allowPinchZoom:!0,children:g.jsx(y$,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:fe(t.onCloseAutoFocus,o=>{var a;o.preventDefault(),s.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:fe(t.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,u=a.button===2||l;s.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:fe(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),qte=S.forwardRef((t,e)=>{const n=ll(Gc,t.__scopePopover),i=S.useRef(!1),r=S.useRef(!1);return g.jsx(y$,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,s),s.defaultPrevented||(i.current||(a=n.triggerRef.current)==null||a.focus(),s.preventDefault()),i.current=!1,r.current=!1},onInteractOutside:s=>{var l,u;(l=t.onInteractOutside)==null||l.call(t,s),s.defaultPrevented||(i.current=!0,s.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const o=s.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&r.current&&s.preventDefault()}})}),y$=S.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:r,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:u,onInteractOutside:c,...d}=t,h=ll(Gc,n),f=hp(n);return Mk(),g.jsx(Sy,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:r,onUnmountAutoFocus:s,children:g.jsx(ep,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:c,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:u,onDismiss:()=>h.onOpenChange(!1),children:g.jsx(Vk,{"data-state":b$(h.open),role:"dialog",id:h.contentId,...f,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),w$="PopoverClose",Yte=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=ll(w$,n);return g.jsx(Fe.button,{type:"button",...i,ref:e,onClick:fe(t.onClick,()=>r.onOpenChange(!1))})});Yte.displayName=w$;var Jte="PopoverArrow",Zte=S.forwardRef((t,e)=>{const{__scopePopover:n,...i}=t,r=hp(n);return g.jsx(Hk,{...r,...i,ref:e})});Zte.displayName=Jte;function b$(t){return t?"open":"closed"}var Qte=h$,ene=m$,tne=g$,x$=v$;const S$=Qte,k$=ene,sC=S.forwardRef(({className:t,align:e="center",sideOffset:n=4,...i},r)=>g.jsx(tne,{children:g.jsx(x$,{ref:r,align:e,sideOffset:n,className:Ue("z-50 w-72 rounded-md border border-stone-600 bg-stone-900 text-white shadow-md outline-none transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...i})}));sC.displayName=x$.displayName;function Hi({name:t,title:e,valueAtom:n,springs:i,emphasis:r=!1,className:s}){const o=mt(),a=qt(n),l=a.low,c={AX:"AL",BX:"BL",CX:"CL",DX:"DL"}[t]||t;return g.jsxs(S$,{children:[g.jsx(k$,{asChild:!0,children:g.jsxs(Kt.button,{title:e,className:Ue("flex w-min cursor-pointer items-center rounded-md border bg-stone-800 px-2 py-1 font-mono leading-none transition-opacity",r?"border-mantis-400 text-lg":"border-stone-600 text-base",s),style:ft(i),children:[g.jsx("span",{className:"mr-2 font-bold",children:c}),g.jsx("span",{className:"rounded bg-stone-900 p-0.5 font-light",children:l.toString("hex")})]})}),g.jsxs(sC,{className:"w-60",children:[g.jsx("p",{className:"px-4 py-2 font-medium text-white",children:e}),g.jsx("hr",{className:"border-stone-600"}),g.jsx("ul",{className:"px-4 py-2 text-sm",children:["hex","bin","uint","int","safe-ascii"].map(d=>g.jsxs("li",{children:[g.jsx("b",{className:"font-medium",children:o(`generics.byte-representation.${d}`)}),":"," ",g.jsx("span",{className:"font-mono text-mantis-400",children:a.toString(d)})]},d))})]})]})}function nne(){const t=qt(At.FLAGS),e=qt(Pj),n=t.bit(0),i=t.bit(6),r=t.bit(7),s=t.bit(9),o=t.bit(11);return g.jsxs(g.Fragment,{children:[g.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[g.jsx(Kt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 150 85 H 220",pathLength:1,strokeDasharray:1,style:ft("cpu.alu.operands")}),g.jsx(Kt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 159 145 H 220",pathLength:1,strokeDasharray:1,style:ft("cpu.alu.operands")}),g.jsx(Kt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 272 115 h 28",pathLength:1,strokeDasharray:1,style:ft("cpu.alu.results")}),g.jsx(Kt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 250 145 v 46",pathLength:1,strokeDasharray:1,style:ft("cpu.alu.results")}),g.jsx("path",{d:"M 220 65 v 40 l 17.32 10 l -17.32 10 v 40 l 51.96 -30 v -40 Z",className:"fill-stone-800 stroke-stone-600",strokeLinejoin:"round"})]}),g.jsx(Kt.span,{className:"icon-[lucide--settings] absolute left-[242px] top-[103px] block h-6 w-6 text-stone-300",style:{transform:ft("cpu.alu.cog").rot.to(a=>`rotate(${a*60}deg)`)}}),g.jsx(Kt.span,{className:"absolute left-[260px] top-[50px] flex w-min items-center rounded-md border border-stone-600 px-2 py-1 font-mono leading-none",style:ft("cpu.alu.operation"),children:e}),g.jsxs(Kt.div,{className:"absolute left-[165px] top-[190px] flex w-min items-center gap-1 rounded-md border border-mantis-400 bg-stone-800 px-2 py-1 font-mono leading-none",style:ft("cpu.FLAGS"),children:[g.jsx("span",{className:Ue("rounded p-1 font-light",n?"bg-mantis-400":"bg-stone-900"),children:"CF"}),g.jsx("span",{className:Ue("rounded p-1 font-light",i?"bg-mantis-400":"bg-stone-900"),children:"ZF"}),g.jsx("span",{className:Ue("rounded p-1 font-light",r?"bg-mantis-400":"bg-stone-900"),children:"SF"}),g.jsx("span",{className:Ue("rounded p-1 font-light",s?"bg-mantis-400":"bg-stone-900"),children:"IF"}),g.jsx("span",{className:Ue("rounded p-1 font-light",o?"bg-mantis-400":"bg-stone-900"),children:"OF"})]})]})}function ine(){const t=mt(),{status:e}=gn(),n=qt(vs),i=S.useMemo(()=>{if(!("metadata"in n)||n.metadata.operands.length===0)return"";if(n.phase==="fetching-operands"){let s=" __";for(let o=1;o<n.metadata.operands.length;o++)s+=", __";return s}else return" "+n.metadata.operands.join(", ")},[n]),r=S.useMemo(()=>e.type==="running"&&e.waitingForInput?"waiting-for-input":e.type==="stopped"?e.error?"stopped-error":"stopped":n.phase==="stopped"&&n.error?"stopped-error":n.phase,[e,n]);return g.jsxs(g.Fragment,{children:[g.jsx("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:g.jsx(Kt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 205 300 V 320",pathLength:1,strokeDasharray:1,style:ft("cpu.decoder.path")})}),g.jsx("div",{className:"absolute bottom-[172px] left-[30px] flex w-full items-start",children:g.jsx("span",{className:"block w-min whitespace-nowrap rounded-t-lg border border-b-0 border-stone-600 bg-mantis-500 px-2 pb-3 pt-1 text-xs tracking-wide text-white",children:t("computer.cpu.control-unit")})}),g.jsxs("div",{className:"absolute bottom-[30px] left-[30px] flex h-[150px] w-[350px] flex-col items-center rounded-lg border border-stone-600 bg-stone-800",children:[g.jsxs("div",{className:"overflow-hidden rounded-b-lg border border-t-0 border-stone-600 bg-stone-900 px-4",children:[g.jsx("span",{className:"text-sm leading-none",children:t("computer.cpu.decoder")}),g.jsx("div",{className:"my-1 h-1 w-full overflow-hidden rounded-full bg-stone-600",children:g.jsx(Kt.div,{className:"h-full bg-mantis-400",style:{width:ft("cpu.decoder.progress.progress").to(s=>`${s*100}%`),opacity:ft("cpu.decoder.progress.opacity")}})})]}),g.jsx("span",{className:Ue("mt-4 w-48 rounded-lg border border-stone-600 py-2 text-center text-sm leading-none transition-colors",r==="stopped-error"?"bg-red-500":r==="waiting-for-input"?"bg-amber-600":r==="int6"||r==="int7"?"bg-blue-600":"bg-stone-900"),children:t(`computer.cpu.status.${r}`)}),g.jsx("div",{className:"mt-4 w-64 overflow-hidden rounded-lg border border-stone-600 bg-stone-900 py-2",children:g.jsx("p",{className:"text-center font-mono",children:!("metadata"in n)||n.phase==="fetching"?g.jsx("span",{className:"italic text-stone-400",children:"???"}):g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"text-mantis-400",children:n.metadata.name}),g.jsx("span",{className:"text-white",children:i})]})})})]})]})}function rne(){const t=mt();return g.jsxs("div",{className:"absolute left-0 top-0 z-10 h-[500px] w-[650px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-3xl text-white",children:t("computer.cpu.name")}),g.jsx(KY,{}),g.jsx(CZ,{}),g.jsx(di,{name:"left",className:"left-[60px] top-[70px]"}),g.jsx(di,{name:"right",className:"left-[60px] top-[130px]"}),g.jsx(di,{name:"result",className:"left-[300px] top-[100px]"}),g.jsx(nne,{}),g.jsx(di,{name:"AX",emphasis:!0,className:"left-[520px] top-[30px]"}),g.jsx(di,{name:"BX",emphasis:!0,className:"left-[520px] top-[70px]"}),g.jsx(di,{name:"CX",emphasis:!0,className:"left-[520px] top-[110px]"}),g.jsx(di,{name:"DX",emphasis:!0,className:"left-[520px] top-[150px]"}),g.jsx(di,{name:"id",className:"left-[520px] top-[190px]"}),g.jsx(di,{name:"MBR",className:"right-[-38px] top-[233px]"}),g.jsx(di,{name:"IR",className:"left-[171px] top-[270px]"}),g.jsx(ine,{}),g.jsx(di,{name:"IP",emphasis:!0,className:"left-[450px] top-[292px]"}),g.jsx(di,{name:"SP",emphasis:!0,className:"left-[450px] top-[332px]"}),g.jsx(di,{name:"ri",className:"left-[450px] top-[372px]"}),g.jsx(di,{name:"MAR",className:"right-[-51px] top-[333px]"})]})}function di({name:t,emphasis:e,className:n}){const i=mt();return g.jsx(Hi,{name:t,valueAtom:At[t],springs:`cpu.${t}`,emphasis:e,title:i("computer.cpu.register",t),className:Ue("absolute",n)})}const sne="_pushable_1q0ek_2",one="_front_1q0ek_15",ane="_shadow_1q0ek_20",lne="_edge_1q0ek_52",Sm={pushable:sne,front:one,shadow:ane,edge:lne};function une(){const t=mt(),{status:e,dispatch:n,devices:i}=gn();return So("F10",r=>{r.preventDefault(),i.f10&&n("f10.press")},void 0,[n,i.f10]),i.f10?g.jsx("div",{className:"absolute left-[50px] top-[950px] z-10 flex h-min w-48 flex-col rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:g.jsxs("button",{className:Sm.pushable,disabled:e.type!=="running",onClick:()=>n("f10.press"),children:[g.jsx("div",{className:Sm.shadow}),g.jsx("div",{className:Sm.edge}),g.jsx("span",{className:Sm.front,children:t("computer.f10")})]})}):null}function cne(){const t=mt(),{devices:e}=gn();return e.handshake?g.jsxs("div",{className:"absolute left-[900px] top-[700px] z-10 h-min w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.handshake.name")}),g.jsx(Hi,{name:t("computer.handshake.state"),title:t("generics.io-register","STATE",65),valueAtom:M_,springs:"handshake.STATE",className:"mx-auto my-4"}),g.jsx("hr",{className:"border-stone-600"}),g.jsx(Hi,{name:t("computer.handshake.data"),title:t("generics.io-register","DATA",64),valueAtom:N_,springs:"handshake.DATA",className:"mx-auto my-4"})]}):null}var _$={exports:{}};/*!
 * 
 *   react-simple-keyboard v3.7.139 (index.modern.js - Modern Browsers bundle)
 *   https://github.com/hodgef/react-simple-keyboard
 *
 *   NOTE: This modern browsers bundle (index.modern.js) removes all polyfills
 *   included in the standard version. Use this if you are supporting
 *   modern browsers only. Otherwise, use the standard version (index.js).
 *
 *   Copyright (c) Francisco Hodge (https://github.com/hodgef) and project contributors.
 *
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */(function(t,e){(function(n,i){t.exports=i(S)})(J3,function(n){return function(){var i={651:function(a){a.exports=function(){var l={d:function(O,M){for(var F in M)l.o(M,F)&&!l.o(O,F)&&Object.defineProperty(O,F,{enumerable:!0,get:M[F]})},o:function(O,M){return Object.prototype.hasOwnProperty.call(O,M)},r:function(O){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(O,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(O,"__esModule",{value:!0})}},u={};function c(O){return function(M){if(Array.isArray(M))return h(M)}(O)||function(M){if(typeof Symbol<"u"&&M[Symbol.iterator]!=null||M["@@iterator"]!=null)return Array.from(M)}(O)||d(O)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function d(O,M){if(O){if(typeof O=="string")return h(O,M);var F={}.toString.call(O).slice(8,-1);return F==="Object"&&O.constructor&&(F=O.constructor.name),F==="Map"||F==="Set"?Array.from(O):F==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(F)?h(O,M):void 0}}function h(O,M){(M==null||M>O.length)&&(M=O.length);for(var F=0,x=Array(M);F<M;F++)x[F]=O[F];return x}function f(O){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},f(O)}function p(O,M){for(var F=0;F<M.length;F++){var x=M[F];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(O,w(x.key),x)}}function m(O,M,F){return(M=w(M))in O?Object.defineProperty(O,M,{value:F,enumerable:!0,configurable:!0,writable:!0}):O[M]=F,O}function w(O){var M=function(F,x){if(f(F)!="object"||!F)return F;var T=F[Symbol.toPrimitive];if(T!==void 0){var N=T.call(F,x||"default");if(f(N)!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(F)}(O,"string");return f(M)=="symbol"?M:M+""}l.r(u),l.d(u,{SimpleKeyboard:function(){return q},default:function(){return ue}});var v=function(){return O=function x(T){var N=T.getOptions,R=T.getCaretPosition,W=T.getCaretPositionEnd,U=T.dispatch;(function(Z,K){if(!(Z instanceof K))throw new TypeError("Cannot call a class as a function")})(this,x),m(this,"getOptions",void 0),m(this,"getCaretPosition",void 0),m(this,"getCaretPositionEnd",void 0),m(this,"dispatch",void 0),m(this,"maxLengthReached",void 0),m(this,"isStandardButton",function(Z){return Z&&!(Z[0]==="{"&&Z[Z.length-1]==="}")}),this.getOptions=N,this.getCaretPosition=R,this.getCaretPositionEnd=W,this.dispatch=U,x.bindMethods(x,this)},M=[{key:"getButtonType",value:function(x){return x.includes("{")&&x.includes("}")&&x!=="{//}"?"functionBtn":"standardBtn"}},{key:"getButtonClass",value:function(x){var T=this.getButtonType(x),N=x.replace("{","").replace("}",""),R="";return T!=="standardBtn"&&(R=" hg-button-".concat(N)),"hg-".concat(T).concat(R)}},{key:"getDefaultDiplay",value:function(){return{"{bksp}":"backspace","{backspace}":"backspace","{enter}":"< enter","{shift}":"shift","{shiftleft}":"shift","{shiftright}":"shift","{alt}":"alt","{s}":"shift","{tab}":"tab","{lock}":"caps","{capslock}":"caps","{accept}":"Submit","{space}":" ","{//}":" ","{esc}":"esc","{escape}":"esc","{f1}":"f1","{f2}":"f2","{f3}":"f3","{f4}":"f4","{f5}":"f5","{f6}":"f6","{f7}":"f7","{f8}":"f8","{f9}":"f9","{f10}":"f10","{f11}":"f11","{f12}":"f12","{numpaddivide}":"/","{numlock}":"lock","{arrowup}":"↑","{arrowleft}":"←","{arrowdown}":"↓","{arrowright}":"→","{prtscr}":"print","{scrolllock}":"scroll","{pause}":"pause","{insert}":"ins","{home}":"home","{pageup}":"up","{delete}":"del","{forwarddelete}":"del","{end}":"end","{pagedown}":"down","{numpadmultiply}":"*","{numpadsubtract}":"-","{numpadadd}":"+","{numpadenter}":"enter","{period}":".","{numpaddecimal}":".","{numpad0}":"0","{numpad1}":"1","{numpad2}":"2","{numpad3}":"3","{numpad4}":"4","{numpad5}":"5","{numpad6}":"6","{numpad7}":"7","{numpad8}":"8","{numpad9}":"9"}}},{key:"getButtonDisplayName",value:function(x,T){return(T=arguments.length>2&&arguments[2]!==void 0&&arguments[2]?Object.assign({},this.getDefaultDiplay(),T):T||this.getDefaultDiplay())[x]||x}},{key:"getUpdatedInput",value:function(x,T,N){var R=arguments.length>3&&arguments[3]!==void 0?arguments[3]:N,W=arguments.length>4&&arguments[4]!==void 0&&arguments[4],U=this.getOptions(),Z=[N,R,W],K=T;return(x==="{bksp}"||x==="{backspace}")&&K.length>0?K=this.removeAt.apply(this,[K].concat(Z)):(x==="{delete}"||x==="{forwarddelete}")&&K.length>0?K=this.removeForwardsAt.apply(this,[K].concat(Z)):x==="{space}"?K=this.addStringAt.apply(this,[K," "].concat(Z)):x!=="{tab}"||typeof U.tabCharOnTab=="boolean"&&U.tabCharOnTab===!1?x!=="{enter}"&&x!=="{numpadenter}"||!U.newLineOnEnter?x.includes("numpad")&&Number.isInteger(Number(x[x.length-2]))?K=this.addStringAt.apply(this,[K,x[x.length-2]].concat(Z)):x==="{numpaddivide}"?K=this.addStringAt.apply(this,[K,"/"].concat(Z)):x==="{numpadmultiply}"?K=this.addStringAt.apply(this,[K,"*"].concat(Z)):x==="{numpadsubtract}"?K=this.addStringAt.apply(this,[K,"-"].concat(Z)):x==="{numpadadd}"?K=this.addStringAt.apply(this,[K,"+"].concat(Z)):x==="{numpaddecimal}"?K=this.addStringAt.apply(this,[K,"."].concat(Z)):x==="{"||x==="}"?K=this.addStringAt.apply(this,[K,x].concat(Z)):x.includes("{")||x.includes("}")||(K=this.addStringAt.apply(this,[K,x].concat(Z))):K=this.addStringAt.apply(this,[K,`
`].concat(Z)):K=this.addStringAt.apply(this,[K,"	"].concat(Z)),U.debug&&console.log("Input will be: "+K),K}},{key:"updateCaretPos",value:function(x){var T=arguments.length>1&&arguments[1]!==void 0&&arguments[1],N=this.updateCaretPosAction(x,T);this.dispatch(function(R){R.setCaretPosition(N)})}},{key:"updateCaretPosAction",value:function(x){var T=arguments.length>1&&arguments[1]!==void 0&&arguments[1],N=this.getOptions(),R=this.getCaretPosition();return R!=null&&(T?R>0&&(R-=x):R+=x),N.debug&&console.log("Caret at:",R),R}},{key:"addStringAt",value:function(x,T){var N,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.length,W=arguments.length>3&&arguments[3]!==void 0?arguments[3]:x.length,U=arguments.length>4&&arguments[4]!==void 0&&arguments[4];return R||R===0?(N=[x.slice(0,R),T,x.slice(W)].join(""),this.isMaxLengthReached()||U&&this.updateCaretPos(T.length)):N=x+T,N}},{key:"removeAt",value:function(x){var T,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x.length,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.length,W=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(N===0&&R===0)return x;if(N===R){var U=/([\uD800-\uDBFF][\uDC00-\uDFFF])/g;N&&N>=0?x.substring(N-2,N).match(U)?(T=x.substr(0,N-2)+x.substr(N),W&&this.updateCaretPos(2,!0)):(T=x.substr(0,N-1)+x.substr(N),W&&this.updateCaretPos(1,!0)):x.slice(-2).match(U)?(T=x.slice(0,-2),W&&this.updateCaretPos(2,!0)):(T=x.slice(0,-1),W&&this.updateCaretPos(1,!0))}else T=x.slice(0,N)+x.slice(R),W&&this.dispatch(function(Z){Z.setCaretPosition(N)});return T}},{key:"removeForwardsAt",value:function(x){var T,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x.length,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.length,W=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return x!=null&&x.length&&N!==null?(N===R?T=x.substring(N,N+2).match(/([\uD800-\uDBFF][\uDC00-\uDFFF])/g)?x.substr(0,N)+x.substr(N+2):x.substr(0,N)+x.substr(N+1):(T=x.slice(0,N)+x.slice(R),W&&this.dispatch(function(U){U.setCaretPosition(N)})),T):x}},{key:"handleMaxLength",value:function(x,T){var N=this.getOptions(),R=N.maxLength,W=x[N.inputName||"default"],U=T.length-1>=R;if(T.length<=W.length)return!1;if(Number.isInteger(R))return N.debug&&console.log("maxLength (num) reached:",U),U?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1);if(f(R)==="object"){var Z=T.length-1>=R[N.inputName||"default"];return N.debug&&console.log("maxLength (obj) reached:",Z),Z?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1)}}},{key:"isMaxLengthReached",value:function(){return!!this.maxLengthReached}},{key:"isTouchDevice",value:function(){return"ontouchstart"in window||navigator.maxTouchPoints}},{key:"pointerEventsSupported",value:function(){return!!window.PointerEvent}},{key:"camelCase",value:function(x){return x?x.toLowerCase().trim().split(/[.\-_\s]/g).reduce(function(T,N){return N.length?T+N[0].toUpperCase()+N.slice(1):T}):""}},{key:"chunkArray",value:function(x,T){return c(Array(Math.ceil(x.length/T))).map(function(N,R){return x.slice(T*R,T+T*R)})}},{key:"escapeRegex",value:function(x){return x.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},{key:"getRtlOffset",value:function(x,T){var N=x,R=T.indexOf("‫");return R<x&&R!=-1&&N--,T.indexOf("‬")<x&&R!=-1&&N--,N<0?0:N}}],F=[{key:"bindMethods",value:function(x,T){var N,R=function(U,Z){var K=typeof Symbol<"u"&&U[Symbol.iterator]||U["@@iterator"];if(!K){if(Array.isArray(U)||(K=d(U))||Z){K&&(U=K);var Se=0,Oe=function(){};return{s:Oe,n:function(){return Se>=U.length?{done:!0}:{done:!1,value:U[Se++]}},e:function(he){throw he},f:Oe}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ie,Ne=!0,$e=!1;return{s:function(){K=K.call(U)},n:function(){var he=K.next();return Ne=he.done,he},e:function(he){$e=!0,Ie=he},f:function(){try{Ne||K.return==null||K.return()}finally{if($e)throw Ie}}}}(Object.getOwnPropertyNames(x.prototype));try{for(R.s();!(N=R.n()).done;){var W=N.value;W==="constructor"||W==="bindMethods"||(T[W]=T[W].bind(T))}}catch(U){R.e(U)}finally{R.f()}}}],M&&p(O.prototype,M),F&&p(O,F),Object.defineProperty(O,"prototype",{writable:!1}),O;var O,M,F}();m(v,"noop",function(){});var y=v;function b(O){return b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},b(O)}function k(O,M){for(var F=0;F<M.length;F++){var x=M[F];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(O,E(x.key),x)}}function _(O,M,F){return(M=E(M))in O?Object.defineProperty(O,M,{value:F,enumerable:!0,configurable:!0,writable:!0}):O[M]=F,O}function E(O){var M=function(F,x){if(b(F)!="object"||!F)return F;var T=F[Symbol.toPrimitive];if(T!==void 0){var N=T.call(F,x);if(b(N)!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(O,"string");return b(M)=="symbol"?M:M+""}var A=function(){return O=function x(T){var N=this,R=T.dispatch,W=T.getOptions;(function(U,Z){if(!(U instanceof Z))throw new TypeError("Cannot call a class as a function")})(this,x),_(this,"getOptions",void 0),_(this,"dispatch",void 0),_(this,"isModifierKey",function(U){return U.altKey||U.ctrlKey||U.shiftKey||["Tab","CapsLock","Esc","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(U.code||U.key||N.keyCodeToKey(U==null?void 0:U.keyCode))}),this.dispatch=R,this.getOptions=W,y.bindMethods(x,this)},M=[{key:"handleHighlightKeyDown",value:function(x){var T=this.getOptions();T.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(x)&&(x.preventDefault(),x.stopImmediatePropagation());var N=this.getSimpleKeyboardLayoutKey(x);this.dispatch(function(R){var W,U,Z=R.getButtonElement(N),K=R.getButtonElement("{".concat(N,"}"));if(Z)W=Z,U=N;else{if(!K)return;W=K,U="{".concat(N,"}")}var Se,Oe,Ie,Ne,$e=function(dt){dt.style.background=T.physicalKeyboardHighlightBgColor||"#dadce4",dt.style.color=T.physicalKeyboardHighlightTextColor||"black"};if(W)if(Array.isArray(W)){if(W.forEach(function(dt){return $e(dt)}),T.physicalKeyboardHighlightPress)if(T.physicalKeyboardHighlightPressUsePointerEvents)(Se=W[0])===null||Se===void 0||(Oe=Se.onpointerdown)===null||Oe===void 0||Oe.call(Se,x);else if(T.physicalKeyboardHighlightPressUseClick){var he;(he=W[0])===null||he===void 0||he.click()}else R.handleButtonClicked(U,x)}else $e(W),T.physicalKeyboardHighlightPress&&(T.physicalKeyboardHighlightPressUsePointerEvents?(Ie=W)===null||Ie===void 0||(Ne=Ie.onpointerdown)===null||Ne===void 0||Ne.call(Ie,x):T.physicalKeyboardHighlightPressUseClick?W.click():R.handleButtonClicked(U,x))})}},{key:"handleHighlightKeyUp",value:function(x){var T=this.getOptions();T.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(x)&&(x.preventDefault(),x.stopImmediatePropagation());var N=this.getSimpleKeyboardLayoutKey(x);this.dispatch(function(R){var W,U,Z,K=R.getButtonElement(N)||R.getButtonElement("{".concat(N,"}")),Se=function(Oe){Oe.removeAttribute&&Oe.removeAttribute("style")};K&&(Array.isArray(K)?(K.forEach(function(Oe){return Se(Oe)}),T.physicalKeyboardHighlightPressUsePointerEvents&&((W=K[0])===null||W===void 0||(U=W.onpointerup)===null||U===void 0||U.call(W,x))):(Se(K),T.physicalKeyboardHighlightPressUsePointerEvents&&(K==null||(Z=K.onpointerup)===null||Z===void 0||Z.call(K,x))))})}},{key:"getSimpleKeyboardLayoutKey",value:function(x){var T,N="",R=x.code||x.key||this.keyCodeToKey(x==null?void 0:x.keyCode);return(N=R!=null&&R.includes("Numpad")||R!=null&&R.includes("Shift")||R!=null&&R.includes("Space")||R!=null&&R.includes("Backspace")||R!=null&&R.includes("Control")||R!=null&&R.includes("Alt")||R!=null&&R.includes("Meta")?x.code||"":x.key||this.keyCodeToKey(x==null?void 0:x.keyCode)||"").length>1?(T=N)===null||T===void 0?void 0:T.toLowerCase():N}},{key:"keyCodeToKey",value:function(x){return{8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Meta",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"NumpadMultiply",107:"NumpadAdd",109:"NumpadSubtract",110:"NumpadDecimal",111:"NumpadDivide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[x]||""}}],M&&k(O.prototype,M),F&&k(O,F),Object.defineProperty(O,"prototype",{writable:!1}),O;var O,M,F}();function P(O){return P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},P(O)}function D(O,M){for(var F=0;F<M.length;F++){var x=M[F];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(O,B(x.key),x)}}function L(O,M,F){return(M=B(M))in O?Object.defineProperty(O,M,{value:F,enumerable:!0,configurable:!0,writable:!0}):O[M]=F,O}function B(O){var M=function(F,x){if(P(F)!="object"||!F)return F;var T=F[Symbol.toPrimitive];if(T!==void 0){var N=T.call(F,x);if(P(N)!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(O,"string");return P(M)=="symbol"?M:M+""}var $=function(){return O=function x(T){var N=T.utilities,R=T.options;(function(W,U){if(!(W instanceof U))throw new TypeError("Cannot call a class as a function")})(this,x),L(this,"utilities",void 0),L(this,"options",void 0),L(this,"candidateBoxElement",void 0),L(this,"pageIndex",0),L(this,"pageSize",void 0),this.utilities=N,this.options=R,y.bindMethods(x,this),this.pageSize=this.utilities.getOptions().layoutCandidatesPageSize||5},M=[{key:"destroy",value:function(){this.candidateBoxElement&&(this.candidateBoxElement.remove(),this.pageIndex=0)}},{key:"show",value:function(x){var T=this,N=x.candidateValue,R=x.targetElement,W=x.onSelect;if(N&&N.length){var U=this.utilities.chunkArray(N.split(" "),this.pageSize);this.renderPage({candidateListPages:U,targetElement:R,pageIndex:this.pageIndex,nbPages:U.length,onItemSelected:function(Z,K){W(Z,K),T.destroy()}})}}},{key:"renderPage",value:function(x){var T,N=this,R=x.candidateListPages,W=x.targetElement,U=x.pageIndex,Z=x.nbPages,K=x.onItemSelected;(T=this.candidateBoxElement)===null||T===void 0||T.remove(),this.candidateBoxElement=document.createElement("div"),this.candidateBoxElement.className="hg-candidate-box";var Se=document.createElement("ul");Se.className="hg-candidate-box-list",R[U].forEach(function(en){var hl,us=document.createElement("li"),Vo=function(){var Ho=new(N.options.useTouchEvents?TouchEvent:MouseEvent)("click");return Object.defineProperty(Ho,"target",{value:us}),Ho};us.className="hg-candidate-box-list-item",us.innerHTML=((hl=N.options.display)===null||hl===void 0?void 0:hl[en])||en,N.options.useTouchEvents?us.ontouchstart=function(Ho){return K(en,Ho||Vo())}:us.onclick=function(){var Ho=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Vo();return K(en,Ho)},Se.appendChild(us)});var Oe=U>0,Ie=document.createElement("div");Ie.classList.add("hg-candidate-box-prev"),Oe&&Ie.classList.add("hg-candidate-box-btn-active");var Ne=function(){Oe&&N.renderPage({candidateListPages:R,targetElement:W,pageIndex:U-1,nbPages:Z,onItemSelected:K})};this.options.useTouchEvents?Ie.ontouchstart=Ne:Ie.onclick=Ne,this.candidateBoxElement.appendChild(Ie),this.candidateBoxElement.appendChild(Se);var $e=U<Z-1,he=document.createElement("div");he.classList.add("hg-candidate-box-next"),$e&&he.classList.add("hg-candidate-box-btn-active");var dt=function(){$e&&N.renderPage({candidateListPages:R,targetElement:W,pageIndex:U+1,nbPages:Z,onItemSelected:K})};this.options.useTouchEvents?he.ontouchstart=dt:he.onclick=dt,this.candidateBoxElement.appendChild(he),W.prepend(this.candidateBoxElement)}}],M&&D(O.prototype,M),F&&D(O,F),Object.defineProperty(O,"prototype",{writable:!1}),O;var O,M,F}(),J=$;function z(O){return function(M){if(Array.isArray(M))return G(M)}(O)||function(M){if(typeof Symbol<"u"&&M[Symbol.iterator]!=null||M["@@iterator"]!=null)return Array.from(M)}(O)||function(M,F){if(M){if(typeof M=="string")return G(M,F);var x={}.toString.call(M).slice(8,-1);return x==="Object"&&M.constructor&&(x=M.constructor.name),x==="Map"||x==="Set"?Array.from(M):x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x)?G(M,F):void 0}}(O)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function G(O,M){(M==null||M>O.length)&&(M=O.length);for(var F=0,x=Array(M);F<M;F++)x[F]=O[F];return x}function Q(O){return Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},Q(O)}function ie(O,M){var F=Object.keys(O);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(O);M&&(x=x.filter(function(T){return Object.getOwnPropertyDescriptor(O,T).enumerable})),F.push.apply(F,x)}return F}function H(O,M){for(var F=0;F<M.length;F++){var x=M[F];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(O,te(x.key),x)}}function j(O,M,F){return(M=te(M))in O?Object.defineProperty(O,M,{value:F,enumerable:!0,configurable:!0,writable:!0}):O[M]=F,O}function te(O){var M=function(F,x){if(Q(F)!="object"||!F)return F;var T=F[Symbol.toPrimitive];if(T!==void 0){var N=T.call(F,x);if(Q(N)!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(O,"string");return Q(M)=="symbol"?M:M+""}var pe=function(){return O=function x(T,N){var R=this;if(function(Ne,$e){if(!(Ne instanceof $e))throw new TypeError("Cannot call a class as a function")}(this,x),j(this,"input",void 0),j(this,"options",void 0),j(this,"utilities",void 0),j(this,"caretPosition",void 0),j(this,"caretPositionEnd",void 0),j(this,"keyboardDOM",void 0),j(this,"keyboardPluginClasses",void 0),j(this,"keyboardDOMClass",void 0),j(this,"buttonElements",void 0),j(this,"currentInstanceName",void 0),j(this,"allKeyboardInstances",void 0),j(this,"keyboardInstanceNames",void 0),j(this,"isFirstKeyboardInstance",void 0),j(this,"physicalKeyboard",void 0),j(this,"modules",void 0),j(this,"activeButtonClass",void 0),j(this,"holdInteractionTimeout",void 0),j(this,"holdTimeout",void 0),j(this,"isMouseHold",void 0),j(this,"initialized",void 0),j(this,"candidateBox",void 0),j(this,"keyboardRowsDOM",void 0),j(this,"defaultName","default"),j(this,"activeInputElement",null),j(this,"handleParams",function(Ne,$e){var he,dt,en;if(typeof Ne=="string")he=Ne.split(".").join(""),dt=document.querySelector(".".concat(he)),en=$e;else if(Ne instanceof HTMLDivElement){if(!Ne.className)throw console.warn("Any DOM element passed as parameter must have a class."),new Error("KEYBOARD_DOM_CLASS_ERROR");he=Ne.className.split(" ")[0],dt=Ne,en=$e}else he="simple-keyboard",dt=document.querySelector(".".concat(he)),en=Ne;return{keyboardDOMClass:he,keyboardDOM:dt,options:en}}),j(this,"getOptions",function(){return R.options}),j(this,"getCaretPosition",function(){return R.caretPosition}),j(this,"getCaretPositionEnd",function(){return R.caretPositionEnd}),j(this,"registerModule",function(Ne,$e){R.modules[Ne]||(R.modules[Ne]={}),$e(R.modules[Ne])}),j(this,"getKeyboardClassString",function(){for(var Ne=arguments.length,$e=new Array(Ne),he=0;he<Ne;he++)$e[he]=arguments[he];return[R.keyboardDOMClass].concat($e).filter(function(dt){return!!dt}).join(" ")}),typeof window<"u"){var W=this.handleParams(T,N),U=W.keyboardDOMClass,Z=W.keyboardDOM,K=W.options,Se=K===void 0?{}:K;this.utilities=new y({getOptions:this.getOptions,getCaretPosition:this.getCaretPosition,getCaretPositionEnd:this.getCaretPositionEnd,dispatch:this.dispatch}),this.caretPosition=null,this.caretPositionEnd=null,this.keyboardDOM=Z,this.options=function(Ne){for(var $e=1;$e<arguments.length;$e++){var he=arguments[$e]!=null?arguments[$e]:{};$e%2?ie(Object(he),!0).forEach(function(dt){j(Ne,dt,he[dt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ne,Object.getOwnPropertyDescriptors(he)):ie(Object(he)).forEach(function(dt){Object.defineProperty(Ne,dt,Object.getOwnPropertyDescriptor(he,dt))})}return Ne}({layoutName:"default",theme:"hg-theme-default",inputName:"default",preventMouseDownDefault:!1,enableLayoutCandidates:!0,excludeFromLayout:{}},Se),this.keyboardPluginClasses="",y.bindMethods(x,this);var Oe=this.options.inputName,Ie=Oe===void 0?this.defaultName:Oe;if(this.input={},this.input[Ie]="",this.keyboardDOMClass=U,this.buttonElements={},window.SimpleKeyboardInstances||(window.SimpleKeyboardInstances={}),this.currentInstanceName=this.utilities.camelCase(this.keyboardDOMClass),window.SimpleKeyboardInstances[this.currentInstanceName]=this,this.allKeyboardInstances=window.SimpleKeyboardInstances,this.keyboardInstanceNames=Object.keys(window.SimpleKeyboardInstances),this.isFirstKeyboardInstance=this.keyboardInstanceNames[0]===this.currentInstanceName,this.physicalKeyboard=new A({dispatch:this.dispatch,getOptions:this.getOptions}),this.candidateBox=this.options.enableLayoutCandidates?new J({utilities:this.utilities,options:this.options}):null,!this.keyboardDOM)throw console.warn('".'.concat(U,'" was not found in the DOM.')),new Error("KEYBOARD_DOM_ERROR");this.render(),this.modules={},this.loadModules()}},M=[{key:"setCaretPosition",value:function(x){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x;this.caretPosition=x,this.caretPositionEnd=T}},{key:"getInputCandidates",value:function(x){var T=this,N=this.options,R=N.layoutCandidates,W=N.layoutCandidatesCaseSensitiveMatch;if(!R||Q(R)!=="object")return{};var U=Object.keys(R).filter(function(Se){var Oe=x.substring(0,T.getCaretPositionEnd()||0)||x,Ie=new RegExp("".concat(T.utilities.escapeRegex(Se),"$"),W?"g":"gi");return!!z(Oe.matchAll(Ie)).length});if(U.length>1){var Z=U.sort(function(Se,Oe){return Oe.length-Se.length})[0];return{candidateKey:Z,candidateValue:R[Z]}}if(U.length){var K=U[0];return{candidateKey:K,candidateValue:R[K]}}return{}}},{key:"showCandidatesBox",value:function(x,T,N){var R=this;this.candidateBox&&this.candidateBox.show({candidateValue:T,targetElement:N,onSelect:function(W,U){var Z=R.options,K=Z.layoutCandidatesCaseSensitiveMatch,Se=Z.disableCandidateNormalization,Oe=Z.enableLayoutCandidatesKeyPress,Ie=W;Se||(Ie=W.normalize("NFD")),typeof R.options.beforeInputUpdate=="function"&&R.options.beforeInputUpdate(R);var Ne=R.getInput(R.options.inputName,!0),$e=R.getCaretPositionEnd()||0,he=Ne.substring(0,$e||0)||Ne,dt=new RegExp("".concat(R.utilities.escapeRegex(x),"$"),K?"g":"gi"),en=he.replace(dt,Ie),hl=Ne.replace(he,en),us=en.length-he.length,Vo=($e||Ne.length)+us;Vo<0&&(Vo=0),R.setInput(hl,R.options.inputName,!0),R.setCaretPosition(Vo),Oe&&typeof R.options.onKeyPress=="function"&&R.options.onKeyPress(W,U),typeof R.options.onChange=="function"&&R.options.onChange(R.getInput(R.options.inputName,!0),U),typeof R.options.onChangeAll=="function"&&R.options.onChangeAll(R.getAllInputs(),U)}})}},{key:"handleButtonClicked",value:function(x,T){var N=this.options,R=N.inputName,W=R===void 0?this.defaultName:R,U=N.debug;if(x!=="{//}"){this.input[W]||(this.input[W]=""),typeof this.options.beforeInputUpdate=="function"&&this.options.beforeInputUpdate(this);var Z=this.utilities.getUpdatedInput(x,this.input[W],this.caretPosition,this.caretPositionEnd);if(this.utilities.isStandardButton(x)&&this.activeInputElement&&this.input[W]&&this.input[W]===Z&&this.caretPosition===0&&this.caretPositionEnd===Z.length)return this.setInput("",this.options.inputName,!0),this.setCaretPosition(0),this.activeInputElement.value="",this.activeInputElement.setSelectionRange(0,0),void this.handleButtonClicked(x,T);if(typeof this.options.onKeyPress=="function"&&this.options.onKeyPress(x,T),this.input[W]!==Z&&(!this.options.inputPattern||this.options.inputPattern&&this.inputPatternIsValid(Z))){if(this.options.maxLength&&this.utilities.handleMaxLength(this.input,Z))return;var K=this.utilities.getUpdatedInput(x,this.input[W],this.caretPosition,this.caretPositionEnd,!0);if(this.setInput(K,this.options.inputName,!0),U&&console.log("Input changed:",this.getAllInputs()),this.options.debug&&console.log("Caret at: ",this.getCaretPosition(),this.getCaretPositionEnd(),"(".concat(this.keyboardDOMClass,")"),T==null?void 0:T.type),this.options.syncInstanceInputs&&this.syncInstanceInputs(),typeof this.options.onChange=="function"&&this.options.onChange(this.getInput(this.options.inputName,!0),T),typeof this.options.onChangeAll=="function"&&this.options.onChangeAll(this.getAllInputs(),T),T!=null&&T.target&&this.options.enableLayoutCandidates){var Se,Oe=this.getInputCandidates(Z),Ie=Oe.candidateKey,Ne=Oe.candidateValue;Ie&&Ne?this.showCandidatesBox(Ie,Ne,this.keyboardDOM):(Se=this.candidateBox)===null||Se===void 0||Se.destroy()}}this.caretPositionEnd&&this.caretPosition!==this.caretPositionEnd&&(this.setCaretPosition(this.caretPositionEnd,this.caretPositionEnd),this.activeInputElement&&this.activeInputElement.setSelectionRange(this.caretPositionEnd,this.caretPositionEnd),this.options.debug&&console.log("Caret position aligned",this.caretPosition)),U&&console.log("Key pressed:",x)}}},{key:"getMouseHold",value:function(){return this.isMouseHold}},{key:"setMouseHold",value:function(x){this.options.syncInstanceInputs?this.dispatch(function(T){T.isMouseHold=x}):this.isMouseHold=x}},{key:"handleButtonMouseDown",value:function(x,T){var N=this;T&&(this.options.preventMouseDownDefault&&T.preventDefault(),this.options.stopMouseDownPropagation&&T.stopPropagation(),T.target.classList.add(this.activeButtonClass)),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdTimeout&&clearTimeout(this.holdTimeout),this.setMouseHold(!0),this.options.disableButtonHold||(this.holdTimeout=window.setTimeout(function(){(N.getMouseHold()&&(!x.includes("{")&&!x.includes("}")||x==="{delete}"||x==="{backspace}"||x==="{bksp}"||x==="{space}"||x==="{tab}")||x==="{arrowright}"||x==="{arrowleft}"||x==="{arrowup}"||x==="{arrowdown}")&&(N.options.debug&&console.log("Button held:",x),N.handleButtonHold(x)),clearTimeout(N.holdTimeout)},500))}},{key:"handleButtonMouseUp",value:function(x,T){var N=this;T&&(this.options.preventMouseUpDefault&&T.preventDefault&&T.preventDefault(),this.options.stopMouseUpPropagation&&T.stopPropagation&&T.stopPropagation(),!(T.target===this.keyboardDOM||T.target&&this.keyboardDOM.contains(T.target)||this.candidateBox&&this.candidateBox.candidateBoxElement&&(T.target===this.candidateBox.candidateBoxElement||T.target&&this.candidateBox.candidateBoxElement.contains(T.target)))&&this.candidateBox&&this.candidateBox.destroy()),this.recurseButtons(function(R){R.classList.remove(N.activeButtonClass)}),this.setMouseHold(!1),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),x&&typeof this.options.onKeyReleased=="function"&&this.options.onKeyReleased(x,T)}},{key:"handleKeyboardContainerMouseDown",value:function(x){this.options.preventMouseDownDefault&&x.preventDefault()}},{key:"handleButtonHold",value:function(x){var T=this;this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdInteractionTimeout=window.setTimeout(function(){T.getMouseHold()?(T.handleButtonClicked(x),T.handleButtonHold(x)):clearTimeout(T.holdInteractionTimeout)},100)}},{key:"syncInstanceInputs",value:function(){var x=this;this.dispatch(function(T){T.replaceInput(x.input),T.setCaretPosition(x.caretPosition,x.caretPositionEnd)})}},{key:"clearInput",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName;this.input[x]="",this.setCaretPosition(0),this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"getInput",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName,T=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.options.syncInstanceInputs&&!T&&this.syncInstanceInputs(),this.options.rtl?"‫"+this.input[x].replace("‫","").replace("‬","")+"‬":this.input[x]}},{key:"getAllInputs",value:function(){var x=this,T={};return Object.keys(this.input).forEach(function(N){T[N]=x.getInput(N,!0)}),T}},{key:"setInput",value:function(x){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.inputName||this.defaultName,N=arguments.length>2?arguments[2]:void 0;this.input[T]=x,!N&&this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"replaceInput",value:function(x){this.input=x}},{key:"setOptions",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},T=this.changedOptions(x);this.options=Object.assign(this.options,x),T.length&&(this.options.debug&&console.log("changedOptions",T),this.onSetOptions(T),this.render())}},{key:"changedOptions",value:function(x){var T=this;return Object.keys(x).filter(function(N){return JSON.stringify(x[N])!==JSON.stringify(T.options[N])})}},{key:"onSetOptions",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];x.includes("layoutName")&&this.candidateBox&&this.candidateBox.destroy(),(x.includes("layoutCandidatesPageSize")||x.includes("layoutCandidates"))&&this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=new J({utilities:this.utilities,options:this.options}))}},{key:"resetRows",value:function(){this.keyboardRowsDOM&&this.keyboardRowsDOM.remove(),this.keyboardDOM.className=this.keyboardDOMClass,this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.buttonElements={}}},{key:"dispatch",value:function(x){if(!window.SimpleKeyboardInstances)throw console.warn("SimpleKeyboardInstances is not defined. Dispatch cannot be called."),new Error("INSTANCES_VAR_ERROR");return Object.keys(window.SimpleKeyboardInstances).forEach(function(T){x(window.SimpleKeyboardInstances[T],T)})}},{key:"addButtonTheme",value:function(x,T){var N=this;T&&x&&(x.split(" ").forEach(function(R){T.split(" ").forEach(function(W){N.options.buttonTheme||(N.options.buttonTheme=[]);var U=!1;N.options.buttonTheme.map(function(Z){if(Z!=null&&Z.class.split(" ").includes(W)){U=!0;var K=Z.buttons.split(" ");K.includes(R)||(U=!0,K.push(R),Z.buttons=K.join(" "))}return Z}),U||N.options.buttonTheme.push({class:W,buttons:x})})}),this.render())}},{key:"removeButtonTheme",value:function(x,T){var N=this;if(!x&&!T)return this.options.buttonTheme=[],void this.render();x&&Array.isArray(this.options.buttonTheme)&&this.options.buttonTheme.length&&(x.split(" ").forEach(function(R){var W;(W=N.options)===null||W===void 0||(W=W.buttonTheme)===null||W===void 0||W.map(function(U,Z){if(U&&T&&T.includes(U.class)||!T){var K,Se,Oe=(K=U)===null||K===void 0?void 0:K.buttons.split(" ").filter(function(Ie){return Ie!==R});U&&Oe!=null&&Oe.length?U.buttons=Oe.join(" "):((Se=N.options.buttonTheme)===null||Se===void 0||Se.splice(Z,1),U=null)}return U})}),this.render())}},{key:"getButtonElement",value:function(x){var T,N=this.buttonElements[x];return N&&(T=N.length>1?N:N[0]),T}},{key:"inputPatternIsValid",value:function(x){var T,N=this.options.inputPattern;if((T=N instanceof RegExp?N:N[this.options.inputName||this.defaultName])&&x){var R=T.test(x);return this.options.debug&&console.log('inputPattern ("'.concat(T,'"): ').concat(R?"passed":"did not pass!")),R}return!0}},{key:"setEventListeners",value:function(){if(this.isFirstKeyboardInstance||!this.allKeyboardInstances){this.options.debug&&console.log("Caret handling started (".concat(this.keyboardDOMClass,")"));var x=this.options.physicalKeyboardHighlightPreventDefault,T=x!==void 0&&x;document.addEventListener("keyup",this.handleKeyUp,T),document.addEventListener("keydown",this.handleKeyDown,T),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchend",this.handleTouchEnd),document.addEventListener("selectionchange",this.handleSelectionChange),document.addEventListener("select",this.handleSelect)}}},{key:"handleKeyUp",value:function(x){this.caretEventHandler(x),this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyUp(x)}},{key:"handleKeyDown",value:function(x){this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyDown(x)}},{key:"handleMouseUp",value:function(x){this.caretEventHandler(x)}},{key:"handleTouchEnd",value:function(x){this.caretEventHandler(x)}},{key:"handleSelect",value:function(x){this.caretEventHandler(x)}},{key:"handleSelectionChange",value:function(x){navigator.userAgent.includes("Firefox")||this.caretEventHandler(x)}},{key:"caretEventHandler",value:function(x){var T,N=this;x.target.tagName&&(T=x.target.tagName.toLowerCase()),this.dispatch(function(R){var W=x.target===R.keyboardDOM||x.target&&R.keyboardDOM.contains(x.target);if(N.options.syncInstanceInputs&&Array.isArray(x.path)&&(W=x.path.some(function(K){var Se;return K==null||(Se=K.hasAttribute)===null||Se===void 0?void 0:Se.call(K,"data-skInstance")})),(T==="textarea"||T==="input"&&["text","search","url","tel","password"].includes(x.target.type))&&!R.options.disableCaretPositioning){var U=x.target.selectionStart,Z=x.target.selectionEnd;R.options.rtl&&(U=R.utilities.getRtlOffset(U,R.getInput()),Z=R.utilities.getRtlOffset(Z,R.getInput())),R.setCaretPosition(U,Z),R.activeInputElement=x.target,R.options.debug&&console.log("Caret at: ",R.getCaretPosition(),R.getCaretPositionEnd(),x&&x.target.tagName.toLowerCase(),"(".concat(R.keyboardDOMClass,")"),x==null?void 0:x.type)}else!R.options.disableCaretPositioning&&W||(x==null?void 0:x.type)==="selectionchange"||(R.setCaretPosition(null),R.activeInputElement=null,R.options.debug&&console.log('Caret position reset due to "'.concat(x==null?void 0:x.type,'" event'),x))})}},{key:"recurseButtons",value:function(x){var T=this;x&&Object.keys(this.buttonElements).forEach(function(N){return T.buttonElements[N].forEach(x)})}},{key:"destroy",value:function(){this.options.debug&&console.log("Destroying simple-keyboard instance: ".concat(this.currentInstanceName));var x=this.options.physicalKeyboardHighlightPreventDefault,T=x!==void 0&&x;document.removeEventListener("keyup",this.handleKeyUp,T),document.removeEventListener("keydown",this.handleKeyDown,T),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchend",this.handleTouchEnd),document.removeEventListener("select",this.handleSelect),document.removeEventListener("selectionchange",this.handleSelectionChange),document.onpointerup=null,document.ontouchend=null,document.ontouchcancel=null,document.onmouseup=null,this.recurseButtons(function(N){N&&(N.onpointerdown=null,N.onpointerup=null,N.onpointercancel=null,N.ontouchstart=null,N.ontouchend=null,N.ontouchcancel=null,N.onclick=null,N.onmousedown=null,N.onmouseup=null,N.remove(),N=null)}),this.keyboardDOM.onpointerdown=null,this.keyboardDOM.ontouchstart=null,this.keyboardDOM.onmousedown=null,this.resetRows(),this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=null),this.activeInputElement=null,this.keyboardDOM.removeAttribute("data-skInstance"),this.keyboardDOM.innerHTML="",window.SimpleKeyboardInstances[this.currentInstanceName]=null,delete window.SimpleKeyboardInstances[this.currentInstanceName],this.initialized=!1}},{key:"getButtonThemeClasses",value:function(x){var T=this.options.buttonTheme,N=[];return Array.isArray(T)&&T.forEach(function(R){if(R&&R.class&&typeof R.class=="string"&&R.buttons&&typeof R.buttons=="string"){var W=R.class.split(" ");R.buttons.split(" ").includes(x)&&(N=[].concat(z(N),z(W)))}else console.warn('Incorrect "buttonTheme". Please check the documentation.',R)}),N}},{key:"setDOMButtonAttributes",value:function(x,T){var N=this.options.buttonAttributes;Array.isArray(N)&&N.forEach(function(R){R.attribute&&typeof R.attribute=="string"&&R.value&&typeof R.value=="string"&&R.buttons&&typeof R.buttons=="string"?R.buttons.split(" ").includes(x)&&T(R.attribute,R.value):console.warn('Incorrect "buttonAttributes". Please check the documentation.',R)})}},{key:"onTouchDeviceDetected",value:function(){this.processAutoTouchEvents(),this.disableContextualWindow()}},{key:"disableContextualWindow",value:function(){window.oncontextmenu=function(x){if(x.target.classList.contains("hg-button"))return x.preventDefault(),x.stopPropagation(),!1}}},{key:"processAutoTouchEvents",value:function(){this.options.autoUseTouchEvents&&(this.options.useTouchEvents=!0,this.options.debug&&console.log("autoUseTouchEvents: Touch device detected, useTouchEvents enabled."))}},{key:"onInit",value:function(){this.options.debug&&console.log("".concat(this.keyboardDOMClass," Initialized")),this.setEventListeners(),typeof this.options.onInit=="function"&&this.options.onInit(this)}},{key:"beforeFirstRender",value:function(){this.utilities.isTouchDevice()&&this.onTouchDeviceDetected(),typeof this.options.beforeFirstRender=="function"&&this.options.beforeFirstRender(this),this.isFirstKeyboardInstance&&this.utilities.pointerEventsSupported()&&!this.options.useTouchEvents&&!this.options.useMouseEvents&&this.options.debug&&console.log("Using PointerEvents as it is supported by this browser"),this.options.useTouchEvents&&this.options.debug&&console.log("useTouchEvents has been enabled. Only touch events will be used.")}},{key:"beforeRender",value:function(){typeof this.options.beforeRender=="function"&&this.options.beforeRender(this)}},{key:"onRender",value:function(){typeof this.options.onRender=="function"&&this.options.onRender(this)}},{key:"onModulesLoaded",value:function(){typeof this.options.onModulesLoaded=="function"&&this.options.onModulesLoaded(this)}},{key:"loadModules",value:function(){var x=this;Array.isArray(this.options.modules)&&(this.options.modules.forEach(function(T){var N=new T(x);N.init&&N.init(x)}),this.keyboardPluginClasses="modules-loaded",this.render(),this.onModulesLoaded())}},{key:"getModuleProp",value:function(x,T){return!!this.modules[x]&&this.modules[x][T]}},{key:"getModulesList",value:function(){return Object.keys(this.modules)}},{key:"parseRowDOMContainers",value:function(x,T,N,R){var W=this,U=Array.from(x.children),Z=0;return U.length&&N.forEach(function(K,Se){var Oe=R[Se];if(!(Oe&&Oe>K))return!1;var Ie=K-Z,Ne=Oe-Z,$e=document.createElement("div");$e.className+="hg-button-container";var he="".concat(W.options.layoutName,"-r").concat(T,"c").concat(Se);$e.setAttribute("data-skUID",he);var dt=U.splice(Ie,Ne-Ie+1);Z=Ne-Ie,dt.forEach(function(en){return $e.appendChild(en)}),U.splice(Ie,0,$e),x.innerHTML="",U.forEach(function(en){return x.appendChild(en)}),W.options.debug&&console.log("rowDOMContainer",dt,Ie,Ne,Z+1)}),x}},{key:"render",value:function(){var x=this;this.resetRows(),this.initialized||this.beforeFirstRender(),this.beforeRender();var T="hg-layout-".concat(this.options.layoutName),N=this.options.layout||{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]},R=this.options.useTouchEvents||!1,W=R?"hg-touch-events":"",U=this.options.useMouseEvents||!1,Z=this.options.disableRowButtonContainers;this.keyboardDOM.className=this.getKeyboardClassString(this.options.theme,T,this.keyboardPluginClasses,W),this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.keyboardRowsDOM=document.createElement("div"),this.keyboardRowsDOM.className="hg-rows",N[this.options.layoutName||this.defaultName].forEach(function(K,Se){var Oe=K.split(" ");x.options.excludeFromLayout&&x.options.excludeFromLayout[x.options.layoutName||x.defaultName]&&(Oe=Oe.filter(function(he){return x.options.excludeFromLayout&&!x.options.excludeFromLayout[x.options.layoutName||x.defaultName].includes(he)}));var Ie=document.createElement("div");Ie.className+="hg-row";var Ne=[],$e=[];Oe.forEach(function(he,dt){var en,hl=!Z&&typeof he=="string"&&he.length>1&&he.indexOf("[")===0,us=!Z&&typeof he=="string"&&he.length>1&&he.indexOf("]")===he.length-1;hl&&(Ne.push(dt),he=he.replace(/\[/g,"")),us&&($e.push(dt),he=he.replace(/\]/g,""));var Vo=x.utilities.getButtonClass(he),Ho=x.utilities.getButtonDisplayName(he,x.options.display,x.options.mergeDisplay),W3=x.options.useButtonTag?"button":"div",vn=document.createElement(W3);vn.className+="hg-button ".concat(Vo),(en=vn.classList).add.apply(en,z(x.getButtonThemeClasses(he))),x.setDOMButtonAttributes(he,function(zt,K3){vn.setAttribute(zt,K3)}),x.activeButtonClass="hg-activeButton",!x.utilities.pointerEventsSupported()||R||U?R?(vn.ontouchstart=function(zt){x.handleButtonClicked(he,zt),x.handleButtonMouseDown(he,zt)},vn.ontouchend=function(zt){x.handleButtonMouseUp(he,zt)},vn.ontouchcancel=function(zt){x.handleButtonMouseUp(he,zt)}):(vn.onclick=function(zt){x.setMouseHold(!1),typeof x.options.onKeyReleased!="function"&&x.handleButtonClicked(he,zt)},vn.onmousedown=function(zt){typeof x.options.onKeyReleased!="function"||x.isMouseHold||x.handleButtonClicked(he,zt),x.handleButtonMouseDown(he,zt)},vn.onmouseup=function(zt){x.handleButtonMouseUp(he,zt)}):(vn.onpointerdown=function(zt){x.handleButtonClicked(he,zt),x.handleButtonMouseDown(he,zt)},vn.onpointerup=function(zt){x.handleButtonMouseUp(he,zt)},vn.onpointercancel=function(zt){x.handleButtonMouseUp(he,zt)}),vn.setAttribute("data-skBtn",he);var G3="".concat(x.options.layoutName,"-r").concat(Se,"b").concat(dt);vn.setAttribute("data-skBtnUID",G3);var AC=document.createElement("span");AC.innerHTML=Ho,vn.appendChild(AC),x.buttonElements[he]||(x.buttonElements[he]=[]),x.buttonElements[he].push(vn),Ie.appendChild(vn)}),Ie=x.parseRowDOMContainers(Ie,Se,Ne,$e),x.keyboardRowsDOM.appendChild(Ie)}),this.keyboardDOM.appendChild(this.keyboardRowsDOM),this.onRender(),this.initialized||(this.initialized=!0,!this.utilities.pointerEventsSupported()||R||U?R?(document.ontouchend=function(K){return x.handleButtonMouseUp(void 0,K)},document.ontouchcancel=function(K){return x.handleButtonMouseUp(void 0,K)},this.keyboardDOM.ontouchstart=function(K){return x.handleKeyboardContainerMouseDown(K)}):R||(document.onmouseup=function(K){return x.handleButtonMouseUp(void 0,K)},this.keyboardDOM.onmousedown=function(K){return x.handleKeyboardContainerMouseDown(K)}):(document.onpointerup=function(K){return x.handleButtonMouseUp(void 0,K)},this.keyboardDOM.onpointerdown=function(K){return x.handleKeyboardContainerMouseDown(K)}),this.onInit())}}],M&&H(O.prototype,M),F&&H(O,F),Object.defineProperty(O,"prototype",{writable:!1}),O;var O,M,F}(),q=pe,ue=q;return u}()},442:function(a){a.exports=n}},r={};function s(a){var l=r[a];if(l!==void 0)return l.exports;var u=r[a]={exports:{}};return i[a].call(u.exports,u,u.exports,s),u.exports}s.n=function(a){var l=a&&a.__esModule?function(){return a.default}:function(){return a};return s.d(l,{a:l}),l},s.d=function(a,l){for(var u in l)s.o(l,u)&&!s.o(a,u)&&Object.defineProperty(a,u,{enumerable:!0,get:l[u]})},s.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)},s.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var o={};return function(){s.r(o),s.d(o,{KeyboardReact:function(){return m},default:function(){return w}});var a=s(442);function l(v){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},l(v)}function u(v,y){var b=Object.keys(v);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(v);y&&(k=k.filter(function(_){return Object.getOwnPropertyDescriptor(v,_).enumerable})),b.push.apply(b,k)}return b}function c(v){for(var y=1;y<arguments.length;y++){var b=arguments[y]!=null?arguments[y]:{};y%2?u(Object(b),!0).forEach(function(k){d(v,k,b[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(b)):u(Object(b)).forEach(function(k){Object.defineProperty(v,k,Object.getOwnPropertyDescriptor(b,k))})}return v}function d(v,y,b){return(y=function(k){var _=function(E,A){if(l(E)!="object"||!E)return E;var P=E[Symbol.toPrimitive];if(P!==void 0){var D=P.call(E,A||"default");if(l(D)!="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(E)}(k,"string");return l(_)=="symbol"?_:_+""}(y))in v?Object.defineProperty(v,y,{value:b,enumerable:!0,configurable:!0,writable:!0}):v[y]=b,v}var h=function(v){return c(c({},v),{},{keyboardRef:null})},f=s(651),p=s.n(f),m=function(v){var y=v.baseClass||"react-simple-keyboard",b=a.useRef(null),k=a.useRef(null),_=a.useRef(null),E=a.useRef(v);return a.useEffect(function(){return function(){_.current&&_.current.destroy(),b.current=!1}},[]),a.useEffect(function(){var A=function($){return c(c({},$),{},{theme:"simple-keyboard ".concat($.theme||"hg-theme-default")})}(v);if(!b.current){b.current=!0,A.debug&&console.log("ReactSimpleKeyboard: Init");var P=k.current,D=".".concat(y);_.current=new(p())(P||D,A),A.keyboardRef&&A.keyboardRef(_.current)}var L=function($,J){var z=h(J),G=h($);return Object.keys(z).filter(function(Q){return z[Q]!==G[Q]})}(E.current,A);if(L.length){var B=_.current;E.current=A,B==null||B.setOptions(A),A.debug&&console.log("ReactSimpleKeyboard - setOptions called due to updated props:",L)}},[b,y,E,v]),a.createElement("div",{className:y,ref:k})},w=m}(),o}()})})(_$);var dne=_$.exports;const hne=Jc(dne),fne={en:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shiftleft} z x c v b n m , . / {shiftright}","{space}"],"en-shift":["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shiftleft} Z X C V B N M < > ? {shiftright}","{space}"],es:["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w e r t y u i o p ́ +","{lock} a s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W E R T Y U I O P ̈ *","{lock} A S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"],"es-accent":["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w é r t y ú í ó p ́ +","{lock} á s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-accent-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W É R T Y Ú Í Ó P ̈ *","{lock} Á S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"],"es-diaeresis-default":["| 1 2 3 4 5 6 7 8 9 0 ' ¿ {bksp}","{tab} q w e r t y ü i o p ́ +","{lock} a s d f g h j k l ñ { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-diaeresis-shift":['° ! " # $ % & / ( ) = ? ¡ {bksp}',"{tab} Q W E R T Y Ü I O P ̈ *","{lock} A S D F G H J K L Ñ [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"]},pne={en:{"{bksp}":"Backspace ⌫","{enter}":"Enter ↵","{shiftleft}":"Shift ⇧","{shiftright}":"Shift ⇧","{tab}":"Tab ⇥","{lock}":"Caps Lock ⇪","{space}":"Space"},es:{"{bksp}":"⌫","{enter}":"Intro ↵","{shiftleft}":"Shift ⇧","{shiftright}":"Shift ⇧","{tab}":"Tab ⇥","{lock}":"Bloq Mayús ⇪","{space}":"Espacio"}},aR="Á É Í Ó Ú á é í ó ú ́",lR="Ü ü ̈";function mne(){const t=i_(),e=mt(),{status:n,dispatch:i,devices:r}=gn(),[s,o]=S.useState("none"),[a,l]=S.useState(!1),[u,c]=S.useState(!1),d=S.useMemo(()=>[t,t==="es"&&(a&&"accent"||u&&"diaeresis"),s!=="none"&&"shift"].filter(Boolean).join("-"),[t,s,a,u]),h=S.useCallback(f=>{r.keyboard&&n.type==="running"&&n.waitingForInput&&i("keyboard.sendChar",f)},[n,i,r.keyboard]);return r.keyboard?g.jsxs("div",{className:"absolute left-[1200px] top-[300px] z-10 h-min w-[500px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-xl text-white",children:e("computer.keyboard")}),g.jsx(hne,{theme:Ue("hg-theme-vonsim",`hg-shift-${s}`,a&&"hg-accentDeadKey",u&&"hg-diaeresisDeadKey"),layoutName:d,layout:fne,display:pne[t],buttonTheme:[{class:"hg-accentDeadKeyButton",buttons:aR},{class:"hg-diaeresisDeadKeyButton",buttons:lR}],disableButtonHold:!0,onKeyPress:f=>{if(f==="{shiftleft}"||f==="{shiftright}"){o(p=>p==="none"?"once":"none");return}if(f==="{lock}"){o(p=>p==="none"?"lock":"none");return}if(t==="es"){if(a){aR.includes(f)&&(l(!1),s==="once"&&o("none"),h(f));return}else if(f==="́"){l(!0);return}if(u){lR.includes(f)&&(c(!1),s==="once"&&o("none"),h(f));return}else if(f==="̈"){c(!0);return}}s==="once"&&o("none"),h(f==="{bksp}"?"\b":f==="{enter}"?`
`:f==="{tab}"?"	":f==="{space}"?" ":f)}})]}):null}function gne(){const t=mt(),{devices:e}=gn(),n=qt(O_).toArray();return e.leds?g.jsxs("div",{className:"absolute left-[1300px] top-[828px] z-10 h-min w-min rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.leds")}),g.jsx("div",{className:"flex flex-row-reverse gap-2 p-4",children:n.map((i,r)=>g.jsx("div",{className:Ue("relative h-7 w-7 rounded-full transition",i?"bg-mantis-400":"bg-stone-700 shadow-inner shadow-stone-900"),children:g.jsx("div",{className:Ue("absolute inset-0 rounded-full bg-mantis-400 blur-sm transition",i?"opacity-100":"opacity-0")})},r))})]}):null}const C$=S.forwardRef(({className:t,type:e,...n},i)=>g.jsx("input",{type:e,className:Ue("flex h-10 w-full rounded-md border border-stone-600 bg-stone-900 px-3 py-2 text-sm ring-offset-stone-900 file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-stone-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:i,...n}));C$.displayName="Input";var vne="Label",E$=S.forwardRef((t,e)=>g.jsx(Fe.label,{...t,ref:e,onMouseDown:n=>{var r;n.target.closest("button, input, select, textarea")||((r=t.onMouseDown)==null||r.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));E$.displayName=vne;var A$=E$;const P$=S.forwardRef(({className:t,...e},n)=>g.jsx(A$,{ref:n,className:Ue("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...e}));P$.displayName=A$.displayName;function yne(){const t=mt(),e=qt(OZ),n=Math.ceil(e.length/2),i=qt(Vc),[r,s]=td(MF),o=S.useId(),[a,l]=S.useState(""),u=S.useCallback(()=>{const h=/^([\da-f]+)h?$/i.exec(a);if(!h||!h[1]){Gt({title:t("computer.memory.address-must-be-integer"),variant:"error"});return}let f=parseInt(h[1],16);if(f===ye.MAX_ADDRESS+1)f-=1;else if(!ye.inRange(f)){Gt({title:t("computer.memory.address-out-of-range"),variant:"error"});return}s(ye.from(f))},[t,a,s]),c=S.useCallback(()=>{try{let f=(r??i).value+e.length;f===ye.MAX_ADDRESS+1&&(f-=1);const p=ye.from(f);l(p.toString()),s(p)}catch{console.error("Invalid PageUp")}},[i,r,s,e.length]);So("PageUp",h=>{h.preventDefault(),c()},void 0,[c]);const d=S.useCallback(()=>{try{const h=r??i,f=ye.from(h.value-e.length);l(f.toString()),s(f)}catch{console.error("Invalid PageUp")}},[i,r,s,e.length]);return So("PageDown",h=>{h.preventDefault(),d()},void 0,[c]),g.jsxs("div",{className:"absolute left-[800px] top-0 z-10 h-[460px] w-[250px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-3xl text-white",children:t("computer.memory.name")}),g.jsxs("div",{className:"mx-4 my-2",children:[g.jsx(P$,{htmlFor:o,children:t("computer.memory.fix-address")}),g.jsxs("div",{className:"mt-1 flex items-center gap-1",children:[g.jsx("button",{className:"inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-mantis-500 px-2 text-sm text-white ring-offset-stone-900 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mantis-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",disabled:e.at(0).address.value===ye.MIN_ADDRESS,title:t("computer.memory.address-decrement"),onClick:d,children:g.jsx("span",{className:"icon-[lucide--chevron-left] h-4 w-4"})}),g.jsxs("div",{className:"relative",children:[g.jsx(C$,{className:"font-mono",placeholder:"20h",type:"text",enterKeyHint:"go",id:o,value:a,onChange:h=>l(h.currentTarget.value),onKeyDown:h=>{h.key==="Enter"&&u()}}),g.jsx("button",{title:t("computer.memory.unfix-address"),className:Ue("absolute right-2 top-3",!r&&"hidden"),onClick:()=>{l(""),s(null)},children:g.jsx("span",{className:"icon-[lucide--x] h-4 w-4 text-stone-500 transition-colors hover:text-stone-300"})})]}),g.jsx("button",{className:"inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-mantis-500 px-2 text-sm text-white ring-offset-stone-900 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mantis-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",disabled:e.at(-1).address.value===ye.MAX_ADDRESS,title:t("computer.memory.address-decrement"),onClick:c,children:g.jsx("span",{className:"icon-[lucide--chevron-right] h-4 w-4"})})]})]}),g.jsxs("div",{className:"m-4 flex w-min items-start overflow-hidden rounded-lg border border-stone-600",children:[g.jsx("table",{className:"border-r border-stone-600 font-mono text-lg",children:g.jsx("tbody",{children:e.slice(0,n).map((h,f)=>S.createElement(uR,{...h,key:f}))})}),g.jsx("table",{className:"font-mono text-lg",children:g.jsx("tbody",{children:e.slice(n).map((h,f)=>S.createElement(uR,{...h,key:f}))})})]})]})}function uR({address:t,value:e}){const n=mt(),i=qt(Vc),r=n("computer.memory.cell",t);return g.jsxs(S$,{children:[g.jsx(k$,{asChild:!0,children:g.jsxs(Kt.tr,{title:r,className:"cursor-pointer border-b border-stone-600 odd:bg-stone-900 even:bg-stone-800 last-of-type:border-b-0",style:t.value===i.value?ft("memory.operating-cell"):void 0,children:[g.jsx("td",{className:"border-r border-stone-600 px-2 py-1 font-thin",children:t.toString()}),g.jsx("td",{className:"border-r border-stone-600 px-2 py-1 last-of-type:border-r-0",children:e.toString("hex")})]})}),g.jsxs(sC,{className:"w-60",children:[g.jsx("p",{className:"px-4 py-2 font-medium text-white",children:r}),g.jsx("hr",{className:"border-stone-600"}),g.jsx("ul",{className:"px-4 py-2 text-sm",children:["hex","bin","uint","int","safe-ascii"].map(s=>g.jsxs("li",{children:[g.jsx("b",{className:"font-medium",children:n(`generics.byte-representation.${s}`)}),":"," ",g.jsx("span",{className:"font-mono text-mantis-400",children:e.toString(s)})]},s))})]})]})}function wne(){const t=mt(),{devices:e}=gn();return e.pic?g.jsxs("div",{className:"absolute left-0 top-[700px] z-10 flex h-[200px] w-[450px] flex-col rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsxs("div",{className:"flex items-start",children:[g.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.pic")}),g.jsxs("div",{className:"flex h-16 grow items-center justify-evenly",children:[g.jsx(Hi,{name:"IMR",title:t("generics.io-register","IMR",33),valueAtom:I_,springs:"pic.IMR",emphasis:!0}),g.jsx(Hi,{name:"IRR",title:t("generics.io-register","IRR",34),valueAtom:L_,springs:"pic.IRR",emphasis:!0}),g.jsx(Hi,{name:"ISR",title:t("generics.io-register","ISR",35),valueAtom:j_,springs:"pic.ISR",emphasis:!0})]})]}),g.jsx("hr",{className:"mb-2 border-stone-600"}),g.jsx("div",{className:"grid h-full w-full grid-cols-4 items-center",children:Mv.map((n,i)=>g.jsx(Hi,{name:`INT${i}`,title:t("generics.io-register",`INT${i}`,36+i),valueAtom:n,springs:`pic.INT${i}`,className:"mx-auto"},i))})]}):null}function bne(){const t=mt(),{devices:e}=gn();return e.pio?g.jsxs("div",{className:"absolute left-[900px] top-[700px] z-10 h-min w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"mb-2 block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.pio.name")}),g.jsx("hr",{className:"border-stone-600"}),g.jsxs("div",{className:"flex w-full items-center justify-evenly py-4",children:[g.jsx(Hi,{name:"PA",title:t("generics.io-register","PA",48),valueAtom:F_,springs:"pio.PA"}),g.jsx(Hi,{name:"CA",title:t("generics.io-register","CA",50),valueAtom:$_,springs:"pio.CA"})]}),g.jsx("hr",{className:"border-stone-600"}),g.jsxs("div",{className:"flex w-full items-center justify-evenly py-4",children:[g.jsx(Hi,{name:"PB",title:t("generics.io-register","PB",49),valueAtom:B_,springs:"pio.PB"}),g.jsx(Hi,{name:"CB",title:t("generics.io-register","CB",51),valueAtom:z_,springs:"pio.CB"})]})]}):null}const xne="_printer_fbkny_2",Sne="_shadow_fbkny_6",kne="_sides_fbkny_11",_ne="_front_fbkny_22",Cne="_trailContainer_fbkny_27",Ene="_trail_fbkny_27",Ane="_paper_fbkny_33",yl={printer:xne,shadow:Sne,sides:kne,front:_ne,trailContainer:Cne,trail:Ene,paper:Ane},Pne=Array.from({length:5},(t,e)=>e);function Tne(){const t=mt(),{devices:e}=gn(),n=qt(Ov),i=qt(Dv);return e.printer?g.jsx("div",{className:"absolute left-[1250px] top-[750px] z-10 flex h-min w-80 flex-col rounded-lg border border-stone-600 bg-stone-900 pl-16 [&_*]:z-20",children:g.jsxs("div",{className:yl.printer,title:t("computer.printer.name"),children:[g.jsx("div",{className:yl.shadow}),g.jsx("div",{className:yl.sides}),g.jsxs("div",{className:yl.front,children:[g.jsx("div",{className:yl.trailContainer,children:g.jsx("div",{className:yl.trail,children:g.jsx("pre",{className:yl.paper,children:i})})}),g.jsx("div",{className:"grid grid-cols-5 items-center justify-center",children:Pne.map(r=>{const s=n[r]?hj(n[r].unsigned):null;return g.jsx("span",{className:Ue("flex h-6 w-full items-center justify-center border-r border-zinc-300 text-center font-mono text-base font-medium leading-none text-white first-of-type:rounded-l-xl last-of-type:rounded-r-xl last-of-type:border-r-0",s===null?"bg-zinc-400":"bg-mantis-500"),children:s},r)})}),g.jsx("div",{className:"mx-auto mt-4 h-1 w-[70%] overflow-hidden rounded-full bg-zinc-600",children:g.jsx(Kt.div,{className:"h-full bg-mantis-400",style:{width:ft("printer.printing.progress").to(r=>`${r*100}%`),opacity:ft("printer.printing.opacity")}})})]})]})}):null}const Rne="_container_6nvz7_2",Nne="_text_6nvz7_22",cR={container:Rne,text:Nne};function Mne(){const t=mt(),{devices:e}=gn(),n=qt(U_);return e.screen?g.jsxs("div",{className:"absolute left-[1200px] top-0 z-10 h-min w-[500px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-xl text-white",children:t("computer.screen")}),g.jsx("div",{className:cR.container,children:g.jsx("pre",{className:cR.text,children:n})})]}):null}function One(){const t=mt(),{status:e,dispatch:n,devices:i}=gn(),r=qt(V_).toArray();return i.switches?g.jsxs("div",{className:"absolute left-[1300px] top-[698px] z-10 h-min w-min rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.switches")}),g.jsx("div",{className:"flex flex-row-reverse gap-3 p-4",children:r.map((s,o)=>g.jsx("div",{className:"w-6",children:g.jsx(jv,{checked:s,onCheckedChange:()=>n("switch.toggle",o),className:"-translate-x-3 -rotate-90 data-[state=unchecked]:!bg-stone-800",disabled:e.type!=="running"})},o))})]}):null}function Dne(){const t=mt(),{devices:e}=gn();return e.timer?g.jsxs("div",{className:"absolute left-[500px] top-[875px] z-10 flex h-[120px] w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[g.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.timer")}),g.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-evenly",children:[g.jsx(Hi,{name:"CONT",title:t("generics.io-register","CONT",16),valueAtom:H_,springs:"timer.CONT"}),g.jsx(Hi,{name:"COMP",title:t("generics.io-register","COMP",17),valueAtom:W_,springs:"timer.COMP"})]})]}):null}function T$(){const t=S.useRef(null);return g.jsx("div",{className:"relative h-full w-full",children:g.jsxs(Ote,{minScale:.3,initialScale:.75,ref:t,doubleClick:{disabled:!0},panning:{excluded:["input"]},children:[g.jsx(Lte,{wrapperClass:"!w-full !h-full",contentClass:"!p-[200px]",children:g.jsxs("div",{className:"relative h-[1300px] w-[1900px]",children:[g.jsx(Ute,{}),g.jsx(rne,{}),g.jsx(yne,{}),g.jsx(cne,{}),g.jsx(wne,{}),g.jsx(bne,{}),g.jsx(Dne,{}),g.jsx(Vte,{}),g.jsx(une,{}),g.jsx(mne,{}),g.jsx(gne,{}),g.jsx(Tne,{}),g.jsx(One,{}),g.jsx(Mne,{})]})}),g.jsx(jte,{wrapperRef:t})]})})}const Ine=1024;let Lne=0;class Xw{constructor(e,n){this.from=e,this.to=n}}class it{constructor(e={}){this.id=Lne++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Ri.match(e)),n=>{let i=e(n);return i===void 0?null:[this,i]}}}it.closedBy=new it({deserialize:t=>t.split(" ")});it.openedBy=new it({deserialize:t=>t.split(" ")});it.group=new it({deserialize:t=>t.split(" ")});it.isolate=new it({deserialize:t=>{if(t&&t!="rtl"&&t!="ltr"&&t!="auto")throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}});it.contextHash=new it({perNode:!0});it.lookAhead=new it({perNode:!0});it.mounted=new it({perNode:!0});class Fv{constructor(e,n,i){this.tree=e,this.overlay=n,this.parser=i}static get(e){return e&&e.props&&e.props[it.mounted.id]}}const jne=Object.create(null);class Ri{constructor(e,n,i,r=0){this.name=e,this.props=n,this.id=i,this.flags=r}static define(e){let n=e.props&&e.props.length?Object.create(null):jne,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new Ri(e.name||"",n,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let n=this.prop(it.group);return n?n.indexOf(e)>-1:!1}return this.id==e}static match(e){let n=Object.create(null);for(let i in e)for(let r of i.split(" "))n[r]=e[i];return i=>{for(let r=i.prop(it.group),s=-1;s<(r?r.length:0);s++){let o=n[s<0?i.name:r[s]];if(o)return o}}}}Ri.none=new Ri("",Object.create(null),0,8);class oC{constructor(e){this.types=e;for(let n=0;n<e.length;n++)if(e[n].id!=n)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let n=[];for(let i of this.types){let r=null;for(let s of e){let o=s(i);o&&(r||(r=Object.assign({},i.props)),r[o[0].id]=o[1])}n.push(r?new Ri(i.name,r,i.id,i.flags):i)}return new oC(n)}}const km=new WeakMap,dR=new WeakMap;var Cn;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"})(Cn||(Cn={}));class Ft{constructor(e,n,i,r,s){if(this.type=e,this.children=n,this.positions=i,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=Fv.get(this);if(e&&!e.overlay)return e.tree.toString();let n="";for(let i of this.children){let r=i.toString();r&&(n&&(n+=","),n+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}cursor(e=0){return new Y1(this.topNode,e)}cursorAt(e,n=0,i=0){let r=km.get(this)||this.topNode,s=new Y1(r);return s.moveTo(e,n),km.set(this,s._tree),s}get topNode(){return new Er(this,0,0,null)}resolve(e,n=0){let i=Lf(km.get(this)||this.topNode,e,n,!1);return km.set(this,i),i}resolveInner(e,n=0){let i=Lf(dR.get(this)||this.topNode,e,n,!0);return dR.set(this,i),i}resolveStack(e,n=0){return $ne(this,e,n)}iterate(e){let{enter:n,leave:i,from:r=0,to:s=this.length}=e,o=e.mode||0,a=(o&Cn.IncludeAnonymous)>0;for(let l=this.cursor(o|Cn.IncludeAnonymous);;){let u=!1;if(l.from<=s&&l.to>=r&&(!a&&l.type.isAnonymous||n(l)!==!1)){if(l.firstChild())continue;u=!0}for(;u&&i&&(a||!l.type.isAnonymous)&&i(l),!l.nextSibling();){if(!l.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let n in this.props)e.push([+n,this.props[n]]);return e}balance(e={}){return this.children.length<=8?this:uC(Ri.none,this.children,this.positions,0,this.children.length,0,this.length,(n,i,r)=>new Ft(this.type,n,i,r,this.propValues),e.makeTree||((n,i,r)=>new Ft(Ri.none,n,i,r)))}static build(e){return zne(e)}}Ft.empty=new Ft(Ri.none,[],[],0);class aC{constructor(e,n){this.buffer=e,this.index=n}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new aC(this.buffer,this.index)}}class Za{constructor(e,n,i){this.buffer=e,this.length=n,this.set=i}get type(){return Ri.none}toString(){let e=[];for(let n=0;n<this.buffer.length;)e.push(this.childString(n)),n=this.buffer[n+3];return e.join(",")}childString(e){let n=this.buffer[e],i=this.buffer[e+3],r=this.set.types[n],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,n,i,r,s){let{buffer:o}=this,a=-1;for(let l=e;l!=n&&!(R$(s,r,o[l+1],o[l+2])&&(a=l,i>0));l=o[l+3]);return a}slice(e,n,i){let r=this.buffer,s=new Uint16Array(n-e),o=0;for(let a=e,l=0;a<n;){s[l++]=r[a++],s[l++]=r[a++]-i;let u=s[l++]=r[a++]-i;s[l++]=r[a++]-e,o=Math.max(o,u)}return new Za(s,o,this.set)}}function R$(t,e,n,i){switch(t){case-2:return n<e;case-1:return i>=e&&n<e;case 0:return n<e&&i>e;case 1:return n<=e&&i>e;case 2:return i>e;case 4:return!0}}function Lf(t,e,n,i){for(var r;t.from==t.to||(n<1?t.from>=e:t.from>e)||(n>-1?t.to<=e:t.to<e);){let o=!i&&t instanceof Er&&t.index<0?null:t.parent;if(!o)return t;t=o}let s=i?0:Cn.IgnoreOverlays;if(i)for(let o=t,a=o.parent;a;o=a,a=o.parent)o instanceof Er&&o.index<0&&((r=a.enter(e,n,s))===null||r===void 0?void 0:r.from)!=o.from&&(t=a);for(;;){let o=t.enter(e,n,s);if(!o)return t;t=o}}class N${cursor(e=0){return new Y1(this,e)}getChild(e,n=null,i=null){let r=hR(this,e,n,i);return r.length?r[0]:null}getChildren(e,n=null,i=null){return hR(this,e,n,i)}resolve(e,n=0){return Lf(this,e,n,!1)}resolveInner(e,n=0){return Lf(this,e,n,!0)}matchContext(e){return q1(this,e)}enterUnfinishedNodesBefore(e){let n=this.childBefore(e),i=this;for(;n;){let r=n.lastChild;if(!r||r.to!=n.to)break;r.type.isError&&r.from==r.to?(i=n,n=r.prevSibling):n=r}return i}get node(){return this}get next(){return this.parent}}class Er extends N${constructor(e,n,i,r){super(),this._tree=e,this.from=n,this.index=i,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,n,i,r,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,u=n>0?a.length:-1;e!=u;e+=n){let c=a[e],d=l[e]+o.from;if(R$(r,i,d,d+c.length)){if(c instanceof Za){if(s&Cn.ExcludeBuffers)continue;let h=c.findChild(0,c.buffer.length,n,i-d,r);if(h>-1)return new xa(new Fne(o,c,e,d),null,h)}else if(s&Cn.IncludeAnonymous||!c.type.isAnonymous||lC(c)){let h;if(!(s&Cn.IgnoreMounts)&&(h=Fv.get(c))&&!h.overlay)return new Er(h.tree,d,e,o);let f=new Er(c,d,e,o);return s&Cn.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(n<0?c.children.length-1:0,n,i,r)}}}if(s&Cn.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+n:e=n<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,n,i=0){let r;if(!(i&Cn.IgnoreOverlays)&&(r=Fv.get(this._tree))&&r.overlay){let s=e-this.from;for(let{from:o,to:a}of r.overlay)if((n>0?o<=s:o<s)&&(n<0?a>=s:a>s))return new Er(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,n,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function hR(t,e,n,i){let r=t.cursor(),s=[];if(!r.firstChild())return s;if(n!=null){for(let o=!1;!o;)if(o=r.type.is(n),!r.nextSibling())return s}for(;;){if(i!=null&&r.type.is(i))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return i==null?s:[]}}function q1(t,e,n=e.length-1){for(let i=t.parent;n>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[n]&&e[n]!=i.name)return!1;n--}}return!0}class Fne{constructor(e,n,i,r){this.parent=e,this.buffer=n,this.index=i,this.start=r}}class xa extends N${get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,n,i){super(),this.context=e,this._parent=n,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,n,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,n-this.context.start,i);return s<0?null:new xa(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,n,i=0){if(i&Cn.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],n>0?1:-1,e-this.context.start,n);return s<0?null:new xa(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,n=e.buffer[this.index+3];return n<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new xa(this.context,this._parent,n):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new xa(this.context,this._parent,e.findChild(n,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],n=[],{buffer:i}=this.context,r=this.index+4,s=i.buffer[this.index+3];if(s>r){let o=i.buffer[this.index+1];e.push(i.slice(r,s,o)),n.push(0)}return new Ft(this.type,e,n,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function M$(t){if(!t.length)return null;let e=0,n=t[0];for(let s=1;s<t.length;s++){let o=t[s];(o.from>n.from||o.to<n.to)&&(n=o,e=s)}let i=n instanceof Er&&n.index<0?null:n.parent,r=t.slice();return i?r[e]=i:r.splice(e,1),new Bne(r,n)}class Bne{constructor(e,n){this.heads=e,this.node=n}get next(){return M$(this.heads)}}function $ne(t,e,n){let i=t.resolveInner(e,n),r=null;for(let s=i instanceof Er?i:i.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(r||(r=[i])).push(o.resolve(e,n)),s=o}else{let o=Fv.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new Er(o.tree,o.overlay[0].from+s.from,-1,s);(r||(r=[i])).push(Lf(a,e,n,!1))}}return r?M$(r):i}class Y1{get name(){return this.type.name}constructor(e,n=0){if(this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Er)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,n){this.index=e;let{start:i,buffer:r}=this.buffer;return this.type=n||r.set.types[r.buffer[e]],this.from=i+r.buffer[e+1],this.to=i+r.buffer[e+2],!0}yield(e){return e?e instanceof Er?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,n,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,n,i,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,n-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,n,i=this.mode){return this.buffer?i&Cn.ExcludeBuffers?!1:this.enterChild(1,e,n):this.yield(this._tree.enter(e,n,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Cn.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Cn.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:n}=this.buffer,i=this.stack.length-1;if(e<0){let r=i<0?0:this.stack[i]+4;if(this.index!=r)return this.yieldBuf(n.findChild(r,this.index,-1,0,4))}else{let r=n.buffer[this.index+3];if(r<(i<0?n.buffer.length:n.buffer[this.stack[i]+3]))return this.yieldBuf(r)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let n,i,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:n,parent:i}=r)}else({index:n,_parent:i}=this._tree);for(;i;{index:n,_parent:i}=i)if(n>-1)for(let s=n+e,o=e<0?-1:i._tree.children.length;s!=o;s+=e){let a=i._tree.children[s];if(this.mode&Cn.IncludeAnonymous||a instanceof Za||!a.type.isAnonymous||lC(a))return!1}return!0}move(e,n){if(n&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,n=0){for(;(this.from==this.to||(n<1?this.from>=e:this.from>e)||(n>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,n););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,n=null,i=0;if(e&&e.context==this.buffer)e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;n=o,i=s+1;break e}r=this.stack[--s]}for(let r=i;r<this.stack.length;r++)n=new xa(this.buffer,n,this.stack[r]);return this.bufferNode=new xa(this.buffer,n,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,n){for(let i=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(r=!0)}for(;r&&n&&n(this),r=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,r=!0}}}matchContext(e){if(!this.buffer)return q1(this.node,e);let{buffer:n}=this.buffer,{types:i}=n.set;for(let r=e.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return q1(this.node,e,r);let o=i[n.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}}function lC(t){return t.children.some(e=>e instanceof Za||!e.type.isAnonymous||lC(e))}function zne(t){var e;let{buffer:n,nodeSet:i,maxBufferLength:r=Ine,reused:s=[],minRepeatType:o=i.types.length}=t,a=Array.isArray(n)?new aC(n,n.length):n,l=i.types,u=0,c=0;function d(_,E,A,P,D,L){let{id:B,start:$,end:J,size:z}=a,G=c;for(;z<0;)if(a.next(),z==-1){let te=s[B];A.push(te),P.push($-_);return}else if(z==-3){u=B;return}else if(z==-4){c=B;return}else throw new RangeError(`Unrecognized record size: ${z}`);let Q=l[B],ie,H,j=$-_;if(J-$<=r&&(H=w(a.pos-E,D))){let te=new Uint16Array(H.size-H.skip),pe=a.pos-H.size,q=te.length;for(;a.pos>pe;)q=v(H.start,te,q);ie=new Za(te,J-H.start,i),j=H.start-_}else{let te=a.pos-z;a.next();let pe=[],q=[],ue=B>=o?B:-1,O=0,M=J;for(;a.pos>te;)ue>=0&&a.id==ue&&a.size>=0?(a.end<=M-r&&(p(pe,q,$,O,a.end,M,ue,G),O=pe.length,M=a.end),a.next()):L>2500?h($,te,pe,q):d($,te,pe,q,ue,L+1);if(ue>=0&&O>0&&O<pe.length&&p(pe,q,$,O,$,M,ue,G),pe.reverse(),q.reverse(),ue>-1&&O>0){let F=f(Q);ie=uC(Q,pe,q,0,pe.length,0,J-$,F,F)}else ie=m(Q,pe,q,J-$,G-J)}A.push(ie),P.push(j)}function h(_,E,A,P){let D=[],L=0,B=-1;for(;a.pos>E;){let{id:$,start:J,end:z,size:G}=a;if(G>4)a.next();else{if(B>-1&&J<B)break;B<0&&(B=z-r),D.push($,J,z),L++,a.next()}}if(L){let $=new Uint16Array(L*4),J=D[D.length-2];for(let z=D.length-3,G=0;z>=0;z-=3)$[G++]=D[z],$[G++]=D[z+1]-J,$[G++]=D[z+2]-J,$[G++]=G;A.push(new Za($,D[2]-J,i)),P.push(J-_)}}function f(_){return(E,A,P)=>{let D=0,L=E.length-1,B,$;if(L>=0&&(B=E[L])instanceof Ft){if(!L&&B.type==_&&B.length==P)return B;($=B.prop(it.lookAhead))&&(D=A[L]+B.length+$)}return m(_,E,A,P,D)}}function p(_,E,A,P,D,L,B,$){let J=[],z=[];for(;_.length>P;)J.push(_.pop()),z.push(E.pop()+A-D);_.push(m(i.types[B],J,z,L-D,$-L)),E.push(D-A)}function m(_,E,A,P,D=0,L){if(u){let B=[it.contextHash,u];L=L?[B].concat(L):[B]}if(D>25){let B=[it.lookAhead,D];L=L?[B].concat(L):[B]}return new Ft(_,E,A,P,L)}function w(_,E){let A=a.fork(),P=0,D=0,L=0,B=A.end-r,$={size:0,start:0,skip:0};e:for(let J=A.pos-_;A.pos>J;){let z=A.size;if(A.id==E&&z>=0){$.size=P,$.start=D,$.skip=L,L+=4,P+=4,A.next();continue}let G=A.pos-z;if(z<0||G<J||A.start<B)break;let Q=A.id>=o?4:0,ie=A.start;for(A.next();A.pos>G;){if(A.size<0)if(A.size==-3)Q+=4;else break e;else A.id>=o&&(Q+=4);A.next()}D=ie,P+=z,L+=Q}return(E<0||P==_)&&($.size=P,$.start=D,$.skip=L),$.size>4?$:void 0}function v(_,E,A){let{id:P,start:D,end:L,size:B}=a;if(a.next(),B>=0&&P<o){let $=A;if(B>4){let J=a.pos-(B-4);for(;a.pos>J;)A=v(_,E,A)}E[--A]=$,E[--A]=L-_,E[--A]=D-_,E[--A]=P}else B==-3?u=P:B==-4&&(c=P);return A}let y=[],b=[];for(;a.pos>0;)d(t.start||0,t.bufferStart||0,y,b,-1,0);let k=(e=t.length)!==null&&e!==void 0?e:y.length?b[0]+y[0].length:0;return new Ft(l[t.topID],y.reverse(),b.reverse(),k)}const fR=new WeakMap;function gg(t,e){if(!t.isAnonymous||e instanceof Za||e.type!=t)return 1;let n=fR.get(e);if(n==null){n=1;for(let i of e.children){if(i.type!=t||!(i instanceof Ft)){n=1;break}n+=gg(t,i)}fR.set(e,n)}return n}function uC(t,e,n,i,r,s,o,a,l){let u=0;for(let p=i;p<r;p++)u+=gg(t,e[p]);let c=Math.ceil(u*1.5/8),d=[],h=[];function f(p,m,w,v,y){for(let b=w;b<v;){let k=b,_=m[b],E=gg(t,p[b]);for(b++;b<v;b++){let A=gg(t,p[b]);if(E+A>=c)break;E+=A}if(b==k+1){if(E>c){let A=p[k];f(A.children,A.positions,0,A.children.length,m[k]+y);continue}d.push(p[k])}else{let A=m[b-1]+p[b-1].length-_;d.push(uC(t,p,m,k,b,_,A,null,l))}h.push(_+y-s)}}return f(e,n,i,r,0),(a||l)(d,h,o)}class zl{constructor(e,n,i,r,s=!1,o=!1){this.from=e,this.to=n,this.tree=i,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,n=[],i=!1){let r=[new zl(0,e.length,e,0,!1,i)];for(let s of n)s.to>e.length&&r.push(s);return r}static applyChanges(e,n,i=128){if(!n.length)return e;let r=[],s=1,o=e.length?e[0]:null;for(let a=0,l=0,u=0;;a++){let c=a<n.length?n[a]:null,d=c?c.fromA:1e9;if(d-l>=i)for(;o&&o.from<d;){let h=o;if(l>=h.from||d<=h.to||u){let f=Math.max(h.from,l)-u,p=Math.min(h.to,d)-u;h=f>=p?null:new zl(f,p,h.tree,h.offset+u,a>0,!!c)}if(h&&r.push(h),o.to>d)break;o=s<e.length?e[s++]:null}if(!c)break;l=c.toA,u=c.toA-c.toB}return r}}class O${startParse(e,n,i){return typeof e=="string"&&(e=new Une(e)),i=i?i.length?i.map(r=>new Xw(r.from,r.to)):[new Xw(0,0)]:[new Xw(0,e.length)],this.createParse(e,n||[],i)}parse(e,n,i){let r=this.startParse(e,n,i);for(;;){let s=r.advance();if(s)return s}}}class Une{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,n){return this.string.slice(e,n)}}new it({perNode:!0});let Vne=0;class Sn{constructor(e,n,i){this.set=e,this.base=n,this.modified=i,this.id=Vne++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let n=new Sn([],null,[]);if(n.set.push(n),e)for(let i of e.set)n.set.push(i);return n}static defineModifier(){let e=new Bv;return n=>n.modified.indexOf(e)>-1?n:Bv.get(n.base||n,n.modified.concat(e).sort((i,r)=>i.id-r.id))}}let Hne=0;class Bv{constructor(){this.instances=[],this.id=Hne++}static get(e,n){if(!n.length)return e;let i=n[0].instances.find(a=>a.base==e&&Wne(n,a.modified));if(i)return i;let r=[],s=new Sn(r,e,n);for(let a of n)a.instances.push(s);let o=Gne(n);for(let a of e.set)if(!a.modified.length)for(let l of o)r.push(Bv.get(a,l));return s}}function Wne(t,e){return t.length==e.length&&t.every((n,i)=>n==e[i])}function Gne(t){let e=[[]];for(let n=0;n<t.length;n++)for(let i=0,r=e.length;i<r;i++)e.push(e[i].concat(t[n]));return e.sort((n,i)=>i.length-n.length)}function Kne(t){let e=Object.create(null);for(let n in t){let i=t[n];Array.isArray(i)||(i=[i]);for(let r of n.split(" "))if(r){let s=[],o=2,a=r;for(let d=0;;){if(a=="..."&&d>0&&d+3==r.length){o=1;break}let h=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!h)throw new RangeError("Invalid path: "+r);if(s.push(h[0]=="*"?"":h[0][0]=='"'?JSON.parse(h[0]):h[0]),d+=h[0].length,d==r.length)break;let f=r[d++];if(d==r.length&&f=="!"){o=0;break}if(f!="/")throw new RangeError("Invalid path: "+r);a=r.slice(d)}let l=s.length-1,u=s[l];if(!u)throw new RangeError("Invalid path: "+r);let c=new $v(i,o,l>0?s.slice(0,l):null);e[u]=c.sort(e[u])}}return D$.add(e)}const D$=new it;class $v{constructor(e,n,i,r){this.tags=e,this.mode=n,this.context=i,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}$v.empty=new $v([],2,null);function I$(t,e){let n=Object.create(null);for(let s of t)if(!Array.isArray(s.tag))n[s.tag.id]=s.class;else for(let o of s.tag)n[o.id]=s.class;let{scope:i,all:r=null}=e||{};return{style:s=>{let o=r;for(let a of s)for(let l of a.set){let u=n[l.id];if(u){o=o?o+" "+u:u;break}}return o},scope:i}}function Xne(t,e){let n=null;for(let i of t){let r=i.style(e);r&&(n=n?n+" "+r:r)}return n}function qne(t,e,n,i=0,r=t.length){let s=new Yne(i,Array.isArray(e)?e:[e],n);s.highlightRange(t.cursor(),i,r,"",s.highlighters),s.flush(r)}class Yne{constructor(e,n,i){this.at=e,this.highlighters=n,this.span=i,this.class=""}startSpan(e,n){n!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=n)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,n,i,r,s){let{type:o,from:a,to:l}=e;if(a>=i||l<=n)return;o.isTop&&(s=this.highlighters.filter(f=>!f.scope||f.scope(o)));let u=r,c=Jne(e)||$v.empty,d=Xne(s,c.tags);if(d&&(u&&(u+=" "),u+=d,c.mode==1&&(r+=(r?" ":"")+d)),this.startSpan(Math.max(n,a),u),c.opaque)return;let h=e.tree&&e.tree.prop(it.mounted);if(h&&h.overlay){let f=e.node.enter(h.overlay[0].from+a,1),p=this.highlighters.filter(w=>!w.scope||w.scope(h.tree.type)),m=e.firstChild();for(let w=0,v=a;;w++){let y=w<h.overlay.length?h.overlay[w]:null,b=y?y.from+a:l,k=Math.max(n,v),_=Math.min(i,b);if(k<_&&m)for(;e.from<_&&(this.highlightRange(e,k,_,r,s),this.startSpan(Math.min(_,e.to),u),!(e.to>=b||!e.nextSibling())););if(!y||b>i)break;v=y.to+a,v>n&&(this.highlightRange(f.cursor(),Math.max(n,y.from+a),Math.min(i,v),"",p),this.startSpan(Math.min(i,v),u))}m&&e.parent()}else if(e.firstChild()){h&&(r="");do if(!(e.to<=n)){if(e.from>=i)break;this.highlightRange(e,n,i,r,s),this.startSpan(Math.min(i,e.to),u)}while(e.nextSibling());e.parent()}}}function Jne(t){let e=t.type.prop(D$);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}const de=Sn.define,_m=de(),Zo=de(),pR=de(Zo),mR=de(Zo),Qo=de(),Cm=de(Qo),qw=de(Qo),ps=de(),wl=de(ps),hs=de(),fs=de(),J1=de(),Dd=de(J1),Em=de(),Be={comment:_m,lineComment:de(_m),blockComment:de(_m),docComment:de(_m),name:Zo,variableName:de(Zo),typeName:pR,tagName:de(pR),propertyName:mR,attributeName:de(mR),className:de(Zo),labelName:de(Zo),namespace:de(Zo),macroName:de(Zo),literal:Qo,string:Cm,docString:de(Cm),character:de(Cm),attributeValue:de(Cm),number:qw,integer:de(qw),float:de(qw),bool:de(Qo),regexp:de(Qo),escape:de(Qo),color:de(Qo),url:de(Qo),keyword:hs,self:de(hs),null:de(hs),atom:de(hs),unit:de(hs),modifier:de(hs),operatorKeyword:de(hs),controlKeyword:de(hs),definitionKeyword:de(hs),moduleKeyword:de(hs),operator:fs,derefOperator:de(fs),arithmeticOperator:de(fs),logicOperator:de(fs),bitwiseOperator:de(fs),compareOperator:de(fs),updateOperator:de(fs),definitionOperator:de(fs),typeOperator:de(fs),controlOperator:de(fs),punctuation:J1,separator:de(J1),bracket:Dd,angleBracket:de(Dd),squareBracket:de(Dd),paren:de(Dd),brace:de(Dd),content:ps,heading:wl,heading1:de(wl),heading2:de(wl),heading3:de(wl),heading4:de(wl),heading5:de(wl),heading6:de(wl),contentSeparator:de(ps),list:de(ps),quote:de(ps),emphasis:de(ps),strong:de(ps),link:de(ps),monospace:de(ps),strikethrough:de(ps),inserted:de(),deleted:de(),changed:de(),invalid:de(),meta:Em,documentMeta:de(Em),annotation:de(Em),processingInstruction:de(Em),definition:Sn.defineModifier(),constant:Sn.defineModifier(),function:Sn.defineModifier(),standard:Sn.defineModifier(),local:Sn.defineModifier(),special:Sn.defineModifier()};I$([{tag:Be.link,class:"tok-link"},{tag:Be.heading,class:"tok-heading"},{tag:Be.emphasis,class:"tok-emphasis"},{tag:Be.strong,class:"tok-strong"},{tag:Be.keyword,class:"tok-keyword"},{tag:Be.atom,class:"tok-atom"},{tag:Be.bool,class:"tok-bool"},{tag:Be.url,class:"tok-url"},{tag:Be.labelName,class:"tok-labelName"},{tag:Be.inserted,class:"tok-inserted"},{tag:Be.deleted,class:"tok-deleted"},{tag:Be.literal,class:"tok-literal"},{tag:Be.string,class:"tok-string"},{tag:Be.number,class:"tok-number"},{tag:[Be.regexp,Be.escape,Be.special(Be.string)],class:"tok-string2"},{tag:Be.variableName,class:"tok-variableName"},{tag:Be.local(Be.variableName),class:"tok-variableName tok-local"},{tag:Be.definition(Be.variableName),class:"tok-variableName tok-definition"},{tag:Be.special(Be.variableName),class:"tok-variableName2"},{tag:Be.definition(Be.propertyName),class:"tok-propertyName tok-definition"},{tag:Be.typeName,class:"tok-typeName"},{tag:Be.namespace,class:"tok-namespace"},{tag:Be.className,class:"tok-className"},{tag:Be.macroName,class:"tok-macroName"},{tag:Be.propertyName,class:"tok-propertyName"},{tag:Be.operator,class:"tok-operator"},{tag:Be.comment,class:"tok-comment"},{tag:Be.meta,class:"tok-meta"},{tag:Be.invalid,class:"tok-invalid"},{tag:Be.punctuation,class:"tok-punctuation"}]);var Yw;const Ku=new it;function Zne(t){return _e.define({combine:t?e=>e.concat(t):void 0})}const Qne=new it;class qr{constructor(e,n,i=[],r=""){this.data=e,this.name=r,Je.prototype.hasOwnProperty("tree")||Object.defineProperty(Je.prototype,"tree",{get(){return as(this)}}),this.parser=n,this.extension=[qc.of(this),Je.languageData.of((s,o,a)=>{let l=gR(s,o,a),u=l.type.prop(Ku);if(!u)return[];let c=s.facet(u),d=l.type.prop(Qne);if(d){let h=l.resolve(o-l.from,a);for(let f of d)if(f.test(h,s)){let p=s.facet(f.facet);return f.type=="replace"?p:p.concat(c)}}return c})].concat(i)}isActiveAt(e,n,i=-1){return gR(e,n,i).type.prop(Ku)==this.data}findRegions(e){let n=e.facet(qc);if((n==null?void 0:n.data)==this.data)return[{from:0,to:e.doc.length}];if(!n||!n.allowsNesting)return[];let i=[],r=(s,o)=>{if(s.prop(Ku)==this.data){i.push({from:o,to:o+s.length});return}let a=s.prop(it.mounted);if(a){if(a.tree.prop(Ku)==this.data){if(a.overlay)for(let l of a.overlay)i.push({from:l.from+o,to:l.to+o});else i.push({from:o,to:o+s.length});return}else if(a.overlay){let l=i.length;if(r(a.tree,a.overlay[0].from+o),i.length>l)return}}for(let l=0;l<s.children.length;l++){let u=s.children[l];u instanceof Ft&&r(u,s.positions[l]+o)}};return r(as(e),0),i}get allowsNesting(){return!0}}qr.setState=Xe.define();function gR(t,e,n){let i=t.facet(qc),r=as(t).topNode;if(!i||i.allowsNesting)for(let s=r;s;s=s.enter(e,n,Cn.ExcludeBuffers))s.type.isTop&&(r=s);return r}function as(t){let e=t.field(qr.state,!1);return e?e.tree:Ft.empty}class eie{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,n){let i=this.cursorPos-this.string.length;return e<i||n>=this.cursorPos?this.doc.sliceString(e,n):this.string.slice(e-i,n-i)}}let Id=null;class Kc{constructor(e,n,i=[],r,s,o,a,l){this.parser=e,this.state=n,this.fragments=i,this.tree=r,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,n,i){return new Kc(e,n,[],Ft.empty,0,i,[],null)}startParse(){return this.parser.startParse(new eie(this.state.doc),this.fragments)}work(e,n){return n!=null&&n>=this.state.doc.length&&(n=void 0),this.tree!=Ft.empty&&this.isDone(n??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),n!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>n)&&n<this.state.doc.length&&this.parse.stopAt(n);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(zl.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(n??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,n;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(n=this.parse.advance()););}),this.treeLen=e,this.tree=n,this.fragments=this.withoutTempSkipped(zl.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let n=Id;Id=this;try{return e()}finally{Id=n}}withoutTempSkipped(e){for(let n;n=this.tempSkipped.pop();)e=vR(e,n.from,n.to);return e}changes(e,n){let{fragments:i,tree:r,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((u,c,d,h)=>l.push({fromA:u,toA:c,fromB:d,toB:h})),i=zl.applyChanges(i,l),r=Ft.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let u of this.skipped){let c=e.mapPos(u.from,1),d=e.mapPos(u.to,-1);c<d&&a.push({from:c,to:d})}}}return new Kc(this.parser,n,i,r,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let n=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:r,to:s}=this.skipped[i];r<e.to&&s>e.from&&(this.fragments=vR(this.fragments,r,s),this.skipped.splice(i--,1))}return this.skipped.length>=n?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,n){this.skipped.push({from:e,to:n})}static getSkippingParser(e){return new class extends O${createParse(n,i,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let l=Id;if(l){for(let u of r)l.tempSkipped.push(u);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new Ft(Ri.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let n=this.fragments;return this.treeLen>=e&&n.length&&n[0].from==0&&n[0].to>=e}static get(){return Id}}function vR(t,e,n){return zl.applyChanges(t,[{fromA:e,toA:n,fromB:e,toB:n}])}class Xc{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let n=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,i)||n.takeTree(),new Xc(n)}static init(e){let n=Math.min(3e3,e.doc.length),i=Kc.create(e.facet(qc).parser,e,{from:0,to:n});return i.work(20,n)||i.takeTree(),new Xc(i)}}qr.state=li.define({create:Xc.init,update(t,e){for(let n of e.effects)if(n.is(qr.setState))return n.value;return e.startState.facet(qc)!=e.state.facet(qc)?Xc.init(e.state):t.apply(e)}});let L$=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(L$=t=>{let e=-1,n=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(n):cancelIdleCallback(e)});const Jw=typeof navigator<"u"&&(!((Yw=navigator.scheduling)===null||Yw===void 0)&&Yw.isInputPending)?()=>navigator.scheduling.isInputPending():null,tie=Dn.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let n=this.view.state.field(qr.state).context;(n.updateViewport(e.view.viewport)||this.view.viewport.to>n.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(n)}scheduleWork(){if(this.working)return;let{state:e}=this.view,n=e.field(qr.state);(n.tree!=n.context.tree||!n.context.isDone(e.doc.length))&&(this.working=L$(this.work))}work(e){this.working=null;let n=Date.now();if(this.chunkEnd<n&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=n+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:r}}=this.view,s=i.field(qr.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Jw?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<r&&i.doc.length>r+1e3,l=s.context.work(()=>Jw&&Jw()||Date.now()>o,r+(a?0:1e5));this.chunkBudget-=Date.now()-n,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:qr.setState.of(new Xc(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(n=>Vi(this.view.state,n)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),qc=_e.define({combine(t){return t.length?t[0]:null},enables:t=>[qr.state,tie,Pe.contentAttributes.compute([t],e=>{let n=e.facet(t);return n&&n.name?{"data-language":n.name}:{}})]});class nie{constructor(e,n=[]){this.language=e,this.support=n,this.extension=[e,n]}}const j$=_e.define(),cC=_e.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(n=>n!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function su(t){let e=t.facet(cC);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function Z1(t,e){let n="",i=t.tabSize,r=t.facet(cC)[0];if(r=="	"){for(;e>=i;)n+="	",e-=i;r=" "}for(let s=0;s<e;s++)n+=r;return n}function iie(t,e){t instanceof Je&&(t=new dC(t));for(let i of t.state.facet(j$)){let r=i(t,e);if(r!==void 0)return r}let n=as(t.state);return n.length>=e?sie(t,n,e):null}class dC{constructor(e,n={}){this.state=e,this.options=n,this.unit=su(e)}lineAt(e,n=1){let i=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=i.from&&r<=i.to?s&&r==e?{text:"",from:e}:(n<0?r<e:r<=e)?{text:i.text.slice(r-i.from),from:r}:{text:i.text.slice(0,r-i.from),from:i.from}:i}textAfterPos(e,n=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:r}=this.lineAt(e,n);return i.slice(e-r,Math.min(i.length,e+100-r))}column(e,n=1){let{text:i,from:r}=this.lineAt(e,n),s=this.countColumn(i,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(s+=o-this.countColumn(i,i.search(/\S|$/))),s}countColumn(e,n=e.length){return Yf(e,this.state.tabSize,n)}lineIndent(e,n=1){let{text:i,from:r}=this.lineAt(e,n),s=this.options.overrideIndentation;if(s){let o=s(r);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const rie=new it;function sie(t,e,n){let i=e.resolveStack(n),r=i.node.enterUnfinishedNodesBefore(n);if(r!=i.node){let s=[];for(let o=r;o!=i.node;o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)i={node:s[o],next:i}}return F$(i,t,n)}function F$(t,e,n){for(let i=t;i;i=i.next){let r=aie(i.node);if(r)return r(hC.create(e,n,i))}return 0}function oie(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function aie(t){let e=t.type.prop(rie);if(e)return e;let n=t.firstChild,i;if(n&&(i=n.type.prop(it.closedBy))){let r=t.lastChild,s=r&&i.indexOf(r.name)>-1;return o=>die(o,!0,1,void 0,s&&!oie(o)?r.from:void 0)}return t.parent==null?lie:null}function lie(){return 0}class hC extends dC{constructor(e,n,i){super(e.state,e.options),this.base=e,this.pos=n,this.context=i}get node(){return this.context.node}static create(e,n,i){return new hC(e,n,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let n=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(n.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(uie(i,e))break;n=this.state.doc.lineAt(i.from)}return this.lineIndent(n.from)}continue(){return F$(this.context.next,this.base,this.pos)}}function uie(t,e){for(let n=e;n;n=n.parent)if(t==n)return!0;return!1}function cie(t){let e=t.node,n=e.childAfter(e.from),i=e.lastChild;if(!n)return null;let r=t.options.simulateBreak,s=t.state.doc.lineAt(n.from),o=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let a=n.to;;){let l=e.childAfter(a);if(!l||l==i)return null;if(!l.type.isSkipped)return l.from<o?n:null;a=l.to}}function die(t,e,n,i,r){let s=t.textAfter,o=s.match(/^\s*/)[0].length,a=r==t.pos+o,l=cie(t);return l?a?t.column(l.from):t.column(l.to):t.baseIndent+(a?0:t.unit*n)}const hie=_e.define(),fie=new it;function pie(t,e,n){let i=as(t);if(i.length<n)return null;let r=i.resolveStack(n,1),s=null;for(let o=r;o;o=o.next){let a=o.node;if(a.to<=n||a.from>n)continue;if(s&&a.from<e)break;let l=a.type.prop(fie);if(l&&(a.to<i.length-50||i.length==t.doc.length||!mie(a))){let u=l(a,t);u&&u.from<=n&&u.from>=e&&u.to>n&&(s=u)}}return s}function mie(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function B$(t,e,n){for(let i of t.facet(hie)){let r=i(t,e,n);if(r)return r}return pie(t,e,n)}function $$(t,e){let n=e.mapPos(t.from,1),i=e.mapPos(t.to,-1);return n>=i?void 0:{from:n,to:i}}const fC=Xe.define({map:$$}),s0=Xe.define({map:$$});function z$(t){let e=[];for(let{head:n}of t.state.selection.ranges)e.some(i=>i.from<=n&&i.to>=n)||e.push(t.lineBlockAt(n));return e}const fp=li.define({create(){return Ge.none},update(t,e){t=t.map(e.changes);for(let n of e.effects)if(n.is(fC)&&!gie(t,n.value.from,n.value.to)){let{preparePlaceholder:i}=e.state.facet(W$),r=i?Ge.replace({widget:new kie(i(e.state,n.value))}):yR;t=t.update({add:[r.range(n.value.from,n.value.to)]})}else n.is(s0)&&(t=t.update({filter:(i,r)=>n.value.from!=i||n.value.to!=r,filterFrom:n.value.from,filterTo:n.value.to}));if(e.selection){let n=!1,{head:i}=e.selection.main;t.between(i,i,(r,s)=>{r<i&&s>i&&(n=!0)}),n&&(t=t.update({filterFrom:i,filterTo:i,filter:(r,s)=>s<=i||r>=i}))}return t},provide:t=>Pe.decorations.from(t),toJSON(t,e){let n=[];return t.between(0,e.doc.length,(i,r)=>{n.push(i,r)}),n},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let n=0;n<t.length;){let i=t[n++],r=t[n++];if(typeof i!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(yR.range(i,r))}return Ge.set(e,!0)}});function U$(t,e,n){var i;let r=null;return(i=t.field(fp,!1))===null||i===void 0||i.between(e,n,(s,o)=>{(!r||r.from>s)&&(r={from:s,to:o})}),r}function gie(t,e,n){let i=!1;return t.between(e,e,(r,s)=>{r==e&&s==n&&(i=!0)}),i}function V$(t,e){return t.field(fp,!1)?e:e.concat(Xe.appendConfig.of(Sie()))}const vie=t=>{for(let e of z$(t)){let n=B$(t.state,e.from,e.to);if(n)return t.dispatch({effects:V$(t.state,[fC.of(n),H$(t,n)])}),!0}return!1},yie=t=>{if(!t.state.field(fp,!1))return!1;let e=[];for(let n of z$(t)){let i=U$(t.state,n.from,n.to);i&&e.push(s0.of(i),H$(t,i,!1))}return e.length&&t.dispatch({effects:e}),e.length>0};function H$(t,e,n=!0){let i=t.state.doc.lineAt(e.from).number,r=t.state.doc.lineAt(e.to).number;return Pe.announce.of(`${t.state.phrase(n?"Folded lines":"Unfolded lines")} ${i} ${t.state.phrase("to")} ${r}.`)}const wie=t=>{let{state:e}=t,n=[];for(let i=0;i<e.doc.length;){let r=t.lineBlockAt(i),s=B$(e,r.from,r.to);s&&n.push(fC.of(s)),i=(s?t.lineBlockAt(s.to):r).to+1}return n.length&&t.dispatch({effects:V$(t.state,n)}),!!n.length},bie=t=>{let e=t.state.field(fp,!1);if(!e||!e.size)return!1;let n=[];return e.between(0,t.state.doc.length,(i,r)=>{n.push(s0.of({from:i,to:r}))}),t.dispatch({effects:n}),!0},xie={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},W$=_e.define({combine(t){return nl(t,xie)}});function Sie(t){return[fp,_ie]}function G$(t,e){let{state:n}=t,i=n.facet(W$),r=o=>{let a=t.lineBlockAt(t.posAtDOM(o.target)),l=U$(t.state,a.from,a.to);l&&t.dispatch({effects:s0.of(l)}),o.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(t,r,e);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",n.phrase("folded code")),s.title=n.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}const yR=Ge.replace({widget:new class extends il{toDOM(t){return G$(t,null)}}});class kie extends il{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return G$(e,this.value)}}const _ie=Pe.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class o0{constructor(e,n){this.specs=e;let i;function r(a){let l=Ba.newName();return(i||(i=Object.create(null)))["."+l]=a,l}const s=typeof n.all=="string"?n.all:n.all?r(n.all):void 0,o=n.scope;this.scope=o instanceof qr?a=>a.prop(Ku)==o.data:o?a=>a==o:void 0,this.style=I$(e.map(a=>({tag:a.tag,class:a.class||r(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=i?new Ba(i):null,this.themeType=n.themeType}static define(e,n){return new o0(e,n||{})}}const Q1=_e.define(),Cie=_e.define({combine(t){return t.length?[t[0]]:null}});function Zw(t){let e=t.facet(Q1);return e.length?e:t.facet(Cie)}function Eie(t,e){let n=[Pie],i;return t instanceof o0&&(t.module&&n.push(Pe.styleModule.of(t.module)),i=t.themeType),i?n.push(Q1.computeN([Pe.darkTheme],r=>r.facet(Pe.darkTheme)==(i=="dark")?[t]:[])):n.push(Q1.of(t)),n}class Aie{constructor(e){this.markCache=Object.create(null),this.tree=as(e.state),this.decorations=this.buildDeco(e,Zw(e.state)),this.decoratedTo=e.viewport.to}update(e){let n=as(e.state),i=Zw(e.state),r=i!=Zw(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);n.length<s.to&&!r&&n.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(n!=this.tree||e.viewportChanged||r)&&(this.tree=n,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=s.to)}buildDeco(e,n){if(!n||!this.tree.length)return Ge.none;let i=new Yl;for(let{from:r,to:s}of e.visibleRanges)qne(this.tree,n,(o,a,l)=>{i.add(o,a,this.markCache[l]||(this.markCache[l]=Ge.mark({class:l})))},r,s);return i.finish()}}const Pie=Xf.high(Dn.fromClass(Aie,{decorations:t=>t.decorations})),Tie=1e4,Rie="()[]{}",Nie=new it;function eS(t,e,n){let i=t.prop(e<0?it.openedBy:it.closedBy);if(i)return i;if(t.name.length==1){let r=n.indexOf(t.name);if(r>-1&&r%2==(e<0?1:0))return[n[r+e]]}return null}function tS(t){let e=t.type.prop(Nie);return e?e(t.node):t}function Am(t,e,n,i={}){let r=i.maxScanDistance||Tie,s=i.brackets||Rie,o=as(t),a=o.resolveInner(e,n);for(let l=a;l;l=l.parent){let u=eS(l.type,n,s);if(u&&l.from<l.to){let c=tS(l);if(c&&(n>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return Mie(t,e,n,l,c,u,s)}}return Oie(t,e,n,o,a.type,r,s)}function Mie(t,e,n,i,r,s,o){let a=i.parent,l={from:r.from,to:r.to},u=0,c=a==null?void 0:a.cursor();if(c&&(n<0?c.childBefore(i.from):c.childAfter(i.to)))do if(n<0?c.to<=i.from:c.from>=i.to){if(u==0&&s.indexOf(c.type.name)>-1&&c.from<c.to){let d=tS(c);return{start:l,end:d?{from:d.from,to:d.to}:void 0,matched:!0}}else if(eS(c.type,n,o))u++;else if(eS(c.type,-n,o)){if(u==0){let d=tS(c);return{start:l,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1}}u--}}while(n<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function Oie(t,e,n,i,r,s,o){let a=n<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=n>0)return null;let u={from:n<0?e-1:e,to:n>0?e+1:e},c=t.doc.iterRange(e,n>0?t.doc.length:0),d=0;for(let h=0;!c.next().done&&h<=s;){let f=c.value;n<0&&(h+=f.length);let p=e+h*n;for(let m=n>0?0:f.length-1,w=n>0?f.length:-1;m!=w;m+=n){let v=o.indexOf(f[m]);if(!(v<0||i.resolveInner(p+m,1).type!=r))if(v%2==0==n>0)d++;else{if(d==1)return{start:u,end:{from:p+m,to:p+m+1},matched:v>>1==l>>1};d--}}n>0&&(h+=f.length)}return c.done?{start:u,matched:!1}:null}function wR(t,e,n,i=0,r=0){e==null&&(e=t.search(/[^\s\u00a0]/),e==-1&&(e=t.length));let s=r;for(let o=i;o<e;o++)t.charCodeAt(o)==9?s+=n-s%n:s++;return s}class K${constructor(e,n,i,r){this.string=e,this.tabSize=n,this.indentUnit=i,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let n=this.string.charAt(this.pos),i;if(typeof e=="string"?i=n==e:i=n&&(e instanceof RegExp?e.test(n):e(n)),i)return++this.pos,n}eatWhile(e){let n=this.pos;for(;this.eat(e););return this.pos>n}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let n=this.string.indexOf(e,this.pos);if(n>-1)return this.pos=n,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=wR(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:wR(this.string,null,this.tabSize)}match(e,n,i){if(typeof e=="string"){let r=o=>i?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return r(s)==r(e)?(n!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&n!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function Die(t){return{name:t.name||"",token:t.token,blankLine:t.blankLine||(()=>{}),startState:t.startState||(()=>!0),copyState:t.copyState||Iie,indent:t.indent||(()=>null),languageData:t.languageData||{},tokenTable:t.tokenTable||gC}}function Iie(t){if(typeof t!="object")return t;let e={};for(let n in t){let i=t[n];e[n]=i instanceof Array?i.slice():i}return e}const bR=new WeakMap;class pC extends qr{constructor(e){let n=Zne(e.languageData),i=Die(e),r,s=new class extends O${createParse(o,a,l){return new jie(r,o,a,l)}};super(n,s,[j$.of((o,a)=>this.getIndent(o,a))],e.name),this.topNode=$ie(n),r=this,this.streamParser=i,this.stateAfter=new it({perNode:!0}),this.tokenTable=e.tokenTable?new J$(i.tokenTable):Bie}static define(e){return new pC(e)}getIndent(e,n){let i=as(e.state),r=i.resolve(n);for(;r&&r.type!=this.topNode;)r=r.parent;if(!r)return null;let s,{overrideIndentation:o}=e.options;o&&(s=bR.get(e.state),s!=null&&s<n-1e4&&(s=void 0));let a=mC(this,i,0,r.from,s??n),l,u;if(a?(u=a.state,l=a.pos+1):(u=this.streamParser.startState(e.unit),l=0),n-l>1e4)return null;for(;l<n;){let d=e.state.doc.lineAt(l),h=Math.min(n,d.to);if(d.length){let f=o?o(d.from):-1,p=new K$(d.text,e.state.tabSize,e.unit,f<0?void 0:f);for(;p.pos<h-d.from;)q$(this.streamParser.token,p,u)}else this.streamParser.blankLine(u,e.unit);if(h==n)break;l=d.to+1}let c=e.lineAt(n);return o&&s==null&&bR.set(e.state,c.from),this.streamParser.indent(u,/^\s*(.*)/.exec(c.text)[1],e)}get allowsNesting(){return!1}}function mC(t,e,n,i,r){let s=n>=i&&n+e.length<=r&&e.prop(t.stateAfter);if(s)return{state:t.streamParser.copyState(s),pos:n+e.length};for(let o=e.children.length-1;o>=0;o--){let a=e.children[o],l=n+e.positions[o],u=a instanceof Ft&&l<r&&mC(t,a,l,i,r);if(u)return u}return null}function X$(t,e,n,i,r){if(r&&n<=0&&i>=e.length)return e;!r&&e.type==t.topNode&&(r=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],a=e.children[s],l;if(o<i&&a instanceof Ft){if(!(l=X$(t,a,n-o,i-o,r)))break;return r?new Ft(e.type,e.children.slice(0,s).concat(l),e.positions.slice(0,s+1),o+l.length):l}}return null}function Lie(t,e,n,i){for(let r of e){let s=r.from+(r.openStart?25:0),o=r.to-(r.openEnd?25:0),a=s<=n&&o>n&&mC(t,r.tree,0-r.offset,n,o),l;if(a&&(l=X$(t,r.tree,n+r.offset,a.pos+r.offset,!1)))return{state:a.state,tree:l}}return{state:t.streamParser.startState(i?su(i):4),tree:Ft.empty}}class jie{constructor(e,n,i,r){this.lang=e,this.input=n,this.fragments=i,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let s=Kc.get(),o=r[0].from,{state:a,tree:l}=Lie(e,i,o,s==null?void 0:s.state);this.state=a,this.parsedPos=this.chunkStart=o+l.length;for(let u=0;u<l.children.length;u++)this.chunks.push(l.children[u]),this.chunkPos.push(l.positions[u]);s&&this.parsedPos<s.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(su(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=Kc.get(),n=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),i=Math.min(n,this.chunkStart+2048);for(e&&(i=Math.min(i,e.viewport.to));this.parsedPos<i;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=n?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,n),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let n=this.input.chunk(e);if(this.input.lineChunks)n==`
`&&(n="");else{let i=n.indexOf(`
`);i>-1&&(n=n.slice(0,i))}return e+n.length<=this.to?n:n.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,n=this.lineAfter(e),i=e+n.length;for(let r=this.rangeIndex;;){let s=this.ranges[r].to;if(s>=i||(n=n.slice(0,s-(i-n.length)),r++,r==this.ranges.length))break;let o=this.ranges[r].from,a=this.lineAfter(o);n+=a,i=o+a.length}return{line:n,end:i}}skipGapsTo(e,n,i){for(;;){let r=this.ranges[this.rangeIndex].to,s=e+n;if(i>0?r>s:r>=s)break;let o=this.ranges[++this.rangeIndex].from;n+=o-r}return n}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,n,i,r,s){if(this.ranges.length>1){s=this.skipGapsTo(n,s,1),n+=s;let o=this.chunk.length;s=this.skipGapsTo(i,s,-1),i+=s,r+=this.chunk.length-o}return this.chunk.push(e,n,i,r),s}parseLine(e){let{line:n,end:i}=this.nextLine(),r=0,{streamParser:s}=this.lang,o=new K$(n,e?e.state.tabSize:4,e?su(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let a=q$(s.token,o,this.state);if(a&&(r=this.emitToken(this.lang.tokenTable.resolve(a),this.parsedPos+o.start,this.parsedPos+o.pos,4,r)),o.start>1e4)break}this.parsedPos=i,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Ft.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Fie,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Ft(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Ft(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function q$(t,e,n){e.start=e.pos;for(let i=0;i<10;i++){let r=t(e,n);if(e.pos>e.start)return r}throw new Error("Stream parser failed to advance stream.")}const gC=Object.create(null),jf=[Ri.none],Fie=new oC(jf),xR=[],SR=Object.create(null),Y$=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Y$[t]=Z$(gC,e);class J${constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),Y$)}resolve(e){return e?this.table[e]||(this.table[e]=Z$(this.extra,e)):0}}const Bie=new J$(gC);function Qw(t,e){xR.indexOf(t)>-1||(xR.push(t),console.warn(e))}function Z$(t,e){let n=[];for(let a of e.split(" ")){let l=[];for(let u of a.split(".")){let c=t[u]||Be[u];c?typeof c=="function"?l.length?l=l.map(c):Qw(u,`Modifier ${u} used at start of tag`):l.length?Qw(u,`Tag ${u} used as modifier`):l=Array.isArray(c)?c:[c]:Qw(u,`Unknown highlighting tag ${u}`)}for(let u of l)n.push(u)}if(!n.length)return 0;let i=e.replace(/ /g,"_"),r=i+" "+n.map(a=>a.id),s=SR[r];if(s)return s.id;let o=SR[r]=Ri.define({id:jf.length,name:i,props:[Kne({[i]:n})]});return jf.push(o),o.id}function $ie(t){let e=Ri.define({id:jf.length,name:"Document",props:[Ku.add(()=>t)],top:!0});return jf.push(e),e}Nt.RTL,Nt.LTR;const zie=t=>{let{state:e}=t,n=e.doc.lineAt(e.selection.main.from),i=vC(t.state,n.from);return i.line?Uie(t):i.block?Gie(t):!1};function pp(t,e){return({state:n,dispatch:i})=>{if(n.readOnly)return!1;let r=t(e,n);return r?(i(n.update(r)),!0):!1}}const Uie=pp(yC,0),Vie=pp(yC,1),Hie=pp(yC,2),Wie=pp(Q$,0),Gie=pp((t,e)=>Q$(t,e,Xie(e)),0);function vC(t,e){let n=t.languageDataAt("commentTokens",e);return n.length?n[0]:{}}const Ld=50;function Kie(t,{open:e,close:n},i,r){let s=t.sliceDoc(i-Ld,i),o=t.sliceDoc(r,r+Ld),a=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(o)[0].length,u=s.length-a;if(s.slice(u-e.length,u)==e&&o.slice(l,l+n.length)==n)return{open:{pos:i-a,margin:a&&1},close:{pos:r+l,margin:l&&1}};let c,d;r-i<=2*Ld?c=d=t.sliceDoc(i,r):(c=t.sliceDoc(i,i+Ld),d=t.sliceDoc(r-Ld,r));let h=/^\s*/.exec(c)[0].length,f=/\s*$/.exec(d)[0].length,p=d.length-f-n.length;return c.slice(h,h+e.length)==e&&d.slice(p,p+n.length)==n?{open:{pos:i+h+e.length,margin:/\s/.test(c.charAt(h+e.length))?1:0},close:{pos:r-f-n.length,margin:/\s/.test(d.charAt(p-1))?1:0}}:null}function Xie(t){let e=[];for(let n of t.selection.ranges){let i=t.doc.lineAt(n.from),r=n.to<=i.to?i:t.doc.lineAt(n.to),s=e.length-1;s>=0&&e[s].to>i.from?e[s].to=r.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:r.to})}return e}function Q$(t,e,n=e.selection.ranges){let i=n.map(s=>vC(e,s.from).block);if(!i.every(s=>s))return null;let r=n.map((s,o)=>Kie(e,i[o],s.from,s.to));if(t!=2&&!r.every(s=>s))return{changes:e.changes(n.map((s,o)=>r[o]?[]:[{from:s.from,insert:i[o].open+" "},{from:s.to,insert:" "+i[o].close}]))};if(t!=1&&r.some(s=>s)){let s=[];for(let o=0,a;o<r.length;o++)if(a=r[o]){let l=i[o],{open:u,close:c}=a;s.push({from:u.pos-l.open.length,to:u.pos+u.margin},{from:c.pos-c.margin,to:c.pos+l.close.length})}return{changes:s}}return null}function yC(t,e,n=e.selection.ranges){let i=[],r=-1;for(let{from:s,to:o}of n){let a=i.length,l=1e9,u=vC(e,s).line;if(u){for(let c=s;c<=o;){let d=e.doc.lineAt(c);if(d.from>r&&(s==o||o>d.from)){r=d.from;let h=/^\s*/.exec(d.text)[0].length,f=h==d.length,p=d.text.slice(h,h+u.length)==u?h:-1;h<d.text.length&&h<l&&(l=h),i.push({line:d,comment:p,token:u,indent:h,empty:f,single:!1})}c=d.to+1}if(l<1e9)for(let c=a;c<i.length;c++)i[c].indent<i[c].line.text.length&&(i[c].indent=l);i.length==a+1&&(i[a].single=!0)}}if(t!=2&&i.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:a,token:l,indent:u,empty:c,single:d}of i)(d||!c)&&s.push({from:a.from+u,insert:l+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(t!=1&&i.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:a,token:l}of i)if(a>=0){let u=o.from+a,c=u+l.length;o.text[c-o.from]==" "&&c++,s.push({from:u,to:c})}return{changes:s}}return null}const nS=Bo.define(),qie=Bo.define(),Yie=_e.define(),e3=_e.define({combine(t){return nl(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(i,r)=>e(i,r)||n(i,r)})}}),t3=li.define({create(){return Ms.empty},update(t,e){let n=e.state.facet(e3),i=e.annotation(nS);if(i){let l=Ei.fromTransaction(e,i.selection),u=i.side,c=u==0?t.undone:t.done;return l?c=zv(c,c.length,n.minDepth,l):c=r3(c,e.startState.selection),new Ms(u==0?i.rest:c,u==0?c:i.rest)}let r=e.annotation(qie);if((r=="full"||r=="before")&&(t=t.isolate()),e.annotation(un.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let s=Ei.fromTransaction(e),o=e.annotation(un.time),a=e.annotation(un.userEvent);return s?t=t.addChanges(s,o,a,n,e):e.selection&&(t=t.addSelection(e.startState.selection,o,a,n.newGroupDelay)),(r=="full"||r=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new Ms(t.done.map(Ei.fromJSON),t.undone.map(Ei.fromJSON))}});function Jie(t={}){return[t3,e3.of(t),Pe.domEventHandlers({beforeinput(e,n){let i=e.inputType=="historyUndo"?n3:e.inputType=="historyRedo"?iS:null;return i?(e.preventDefault(),i(n)):!1}})]}function wC(t,e){return function({state:n,dispatch:i}){if(!e&&n.readOnly)return!1;let r=n.field(t3,!1);if(!r)return!1;let s=r.pop(t,n,e);return s?(i(s),!0):!1}}const n3=wC(0,!1),iS=wC(1,!1),Zie=wC(0,!0);class Ei{constructor(e,n,i,r,s){this.changes=e,this.effects=n,this.mapped=i,this.startSelection=r,this.selectionsAfter=s}setSelAfter(e){return new Ei(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new Ei(e.changes&&rn.fromJSON(e.changes),[],e.mapped&&Ls.fromJSON(e.mapped),e.startSelection&&ne.fromJSON(e.startSelection),e.selectionsAfter.map(ne.fromJSON))}static fromTransaction(e,n){let i=vr;for(let r of e.startState.facet(Yie)){let s=r(e);s.length&&(i=i.concat(s))}return!i.length&&e.changes.empty?null:new Ei(e.changes.invert(e.startState.doc),i,void 0,n||e.startState.selection,vr)}static selection(e){return new Ei(void 0,vr,void 0,void 0,e)}}function zv(t,e,n,i){let r=e+1>n+20?e-n-1:0,s=t.slice(r,e);return s.push(i),s}function Qie(t,e){let n=[],i=!1;return t.iterChangedRanges((r,s)=>n.push(r,s)),e.iterChangedRanges((r,s,o,a)=>{for(let l=0;l<n.length;){let u=n[l++],c=n[l++];a>=u&&o<=c&&(i=!0)}}),i}function ere(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((n,i)=>n.empty!=e.ranges[i].empty).length===0}function i3(t,e){return t.length?e.length?t.concat(e):t:e}const vr=[],tre=200;function r3(t,e){if(t.length){let n=t[t.length-1],i=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-tre));return i.length&&i[i.length-1].eq(e)?t:(i.push(e),zv(t,t.length-1,1e9,n.setSelAfter(i)))}else return[Ei.selection([e])]}function nre(t){let e=t[t.length-1],n=t.slice();return n[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function eb(t,e){if(!t.length)return t;let n=t.length,i=vr;for(;n;){let r=ire(t[n-1],e,i);if(r.changes&&!r.changes.empty||r.effects.length){let s=t.slice(0,n);return s[n-1]=r,s}else e=r.mapped,n--,i=r.selectionsAfter}return i.length?[Ei.selection(i)]:vr}function ire(t,e,n){let i=i3(t.selectionsAfter.length?t.selectionsAfter.map(a=>a.map(e)):vr,n);if(!t.changes)return Ei.selection(i);let r=t.changes.map(e),s=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(s):s;return new Ei(r,Xe.mapEffects(t.effects,e),o,t.startSelection.map(s),i)}const rre=/^(input\.type|delete)($|\.)/;class Ms{constructor(e,n,i=0,r=void 0){this.done=e,this.undone=n,this.prevTime=i,this.prevUserEvent=r}isolate(){return this.prevTime?new Ms(this.done,this.undone):this}addChanges(e,n,i,r,s){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!i||rre.test(i))&&(!a.selectionsAfter.length&&n-this.prevTime<r.newGroupDelay&&r.joinToEvent(s,Qie(a.changes,e.changes))||i=="input.type.compose")?o=zv(o,o.length-1,r.minDepth,new Ei(e.changes.compose(a.changes),i3(e.effects,a.effects),a.mapped,a.startSelection,vr)):o=zv(o,o.length,r.minDepth,e),new Ms(o,vr,n,i)}addSelection(e,n,i,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:vr;return s.length>0&&n-this.prevTime<r&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&ere(s[s.length-1],e)?this:new Ms(r3(this.done,e),this.undone,n,i)}addMapping(e){return new Ms(eb(this.done,e),eb(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,i){let r=e==0?this.done:this.undone;if(r.length==0)return null;let s=r[r.length-1],o=s.selectionsAfter[0]||n.selection;if(i&&s.selectionsAfter.length)return n.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:nS.of({side:e,rest:nre(r),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let a=r.length==1?vr:r.slice(0,r.length-1);return s.mapped&&(a=eb(a,s.mapped)),n.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:nS.of({side:e,rest:a,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Ms.empty=new Ms(vr,vr);function mp(t,e){return ne.create(t.ranges.map(e),t.mainIndex)}function ul(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function du({state:t,dispatch:e},n){let i=mp(t.selection,n);return i.eq(t.selection,!0)?!1:(e(ul(t,i)),!0)}function a0(t,e){return ne.cursor(e?t.to:t.from)}function s3(t,e){return du(t,n=>n.empty?t.moveByChar(n,e):a0(n,e))}function cl(t){return t.textDirectionAt(t.state.selection.main.head)==Nt.LTR}const kR=t=>s3(t,!cl(t)),_R=t=>s3(t,cl(t));function o3(t,e){return du(t,n=>n.empty?t.moveByGroup(n,e):a0(n,e))}const sre=t=>o3(t,!cl(t)),ore=t=>o3(t,cl(t));function a3(t,e){return du(t,n=>{if(!n.empty)return a0(n,e);let i=t.moveVertically(n,e);return i.head!=n.head?i:t.moveToLineBoundary(n,e)})}const CR=t=>a3(t,!1),ER=t=>a3(t,!0);function l3(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,i=0,r;if(e){for(let s of t.state.facet(Pe.scrollMargins)){let o=s(t);o!=null&&o.top&&(n=Math.max(o==null?void 0:o.top,n)),o!=null&&o.bottom&&(i=Math.max(o==null?void 0:o.bottom,i))}r=t.scrollDOM.clientHeight-n-i}else r=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:i,selfScroll:e,height:Math.max(t.defaultLineHeight,r-5)}}function u3(t,e){let n=l3(t),{state:i}=t,r=mp(i.selection,o=>o.empty?t.moveVertically(o,e,n.height):a0(o,e));if(r.eq(i.selection))return!1;let s;if(n.selfScroll){let o=t.coordsAtPos(i.selection.main.head),a=t.scrollDOM.getBoundingClientRect(),l=a.top+n.marginTop,u=a.bottom-n.marginBottom;o&&o.top>l&&o.bottom<u&&(s=Pe.scrollIntoView(r.main.head,{y:"start",yMargin:o.top-l}))}return t.dispatch(ul(i,r),{effects:s}),!0}const tb=t=>u3(t,!1),nb=t=>u3(t,!0);function l0(t,e,n){let i=t.lineBlockAt(e.head),r=t.moveToLineBoundary(e,n);if(r.head==e.head&&r.head!=(n?i.to:i.from)&&(r=t.moveToLineBoundary(e,n,!1)),!n&&r.head==i.from&&i.length){let s=/^\s*/.exec(t.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&e.head!=i.from+s&&(r=ne.cursor(i.from+s))}return r}const AR=t=>du(t,e=>l0(t,e,!0)),PR=t=>du(t,e=>l0(t,e,!1)),are=t=>du(t,e=>ne.cursor(t.lineBlockAt(e.head).from,1)),lre=t=>du(t,e=>ne.cursor(t.lineBlockAt(e.head).to,-1));function ure(t,e,n){let i=!1,r=mp(t.selection,s=>{let o=Am(t,s.head,-1)||Am(t,s.head,1)||s.head>0&&Am(t,s.head-1,1)||s.head<t.doc.length&&Am(t,s.head+1,-1);if(!o||!o.end)return s;i=!0;let a=o.start.from==s.head?o.end.to:o.end.from;return ne.cursor(a)});return i?(e(ul(t,r)),!0):!1}const cre=({state:t,dispatch:e})=>ure(t,e);function dl(t,e){let n=mp(t.state.selection,i=>{let r=e(i);return ne.range(i.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return n.eq(t.state.selection)?!1:(t.dispatch(ul(t.state,n)),!0)}function c3(t,e){return dl(t,n=>t.moveByChar(n,e))}const TR=t=>c3(t,!cl(t)),RR=t=>c3(t,cl(t));function d3(t,e){return dl(t,n=>t.moveByGroup(n,e))}const dre=t=>d3(t,!cl(t)),hre=t=>d3(t,cl(t));function h3(t,e){return dl(t,n=>t.moveVertically(n,e))}const NR=t=>h3(t,!1),MR=t=>h3(t,!0);function f3(t,e){return dl(t,n=>t.moveVertically(n,e,l3(t).height))}const OR=t=>f3(t,!1),DR=t=>f3(t,!0),IR=t=>dl(t,e=>l0(t,e,!0)),LR=t=>dl(t,e=>l0(t,e,!1)),fre=t=>dl(t,e=>ne.cursor(t.lineBlockAt(e.head).from)),pre=t=>dl(t,e=>ne.cursor(t.lineBlockAt(e.head).to)),jR=({state:t,dispatch:e})=>(e(ul(t,{anchor:0})),!0),FR=({state:t,dispatch:e})=>(e(ul(t,{anchor:t.doc.length})),!0),BR=({state:t,dispatch:e})=>(e(ul(t,{anchor:t.selection.main.anchor,head:0})),!0),$R=({state:t,dispatch:e})=>(e(ul(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),mre=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),gre=({state:t,dispatch:e})=>{let n=c0(t).map(({from:i,to:r})=>ne.range(i,Math.min(r+1,t.doc.length)));return e(t.update({selection:ne.create(n),userEvent:"select"})),!0};function u0(t,e){if(t.state.readOnly)return!1;let n="delete.selection",{state:i}=t,r=i.changeByRange(s=>{let{from:o,to:a}=s;if(o==a){let l=e(s);l<o?(n="delete.backward",l=Pm(t,l,!1)):l>o&&(n="delete.forward",l=Pm(t,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=Pm(t,o,!1),a=Pm(t,a,!0);return o==a?{range:s}:{changes:{from:o,to:a},range:ne.cursor(o,o<s.head?-1:1)}});return r.changes.empty?!1:(t.dispatch(i.update(r,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?Pe.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function Pm(t,e,n){if(t instanceof Pe)for(let i of t.state.facet(Pe.atomicRanges).map(r=>r(t)))i.between(e,e,(r,s)=>{r<e&&s>e&&(e=n?s:r)});return e}const p3=(t,e,n)=>u0(t,i=>{let r=i.from,{state:s}=t,o=s.doc.lineAt(r),a,l;if(n&&!e&&r>o.from&&r<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,r-o.from))){if(a[a.length-1]=="	")return r-1;let u=Yf(a,s.tabSize),c=u%su(s)||su(s);for(let d=0;d<c&&a[a.length-1-d]==" ";d++)r--;l=r}else l=Tn(o.text,r-o.from,e,e)+o.from,l==r&&o.number!=(e?s.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,r-o.from))&&(l=Tn(o.text,l-o.from,!1,!1)+o.from);return l}),ib=t=>p3(t,!1,!0),zR=t=>p3(t,!0,!1),m3=(t,e)=>u0(t,n=>{let i=n.head,{state:r}=t,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let a=null;;){if(i==(e?s.to:s.from)){i==n.head&&s.number!=(e?r.doc.lines:1)&&(i+=e?1:-1);break}let l=Tn(s.text,i-s.from,e)+s.from,u=s.text.slice(Math.min(i,l)-s.from,Math.max(i,l)-s.from),c=o(u);if(a!=null&&c!=a)break;(u!=" "||i!=n.head)&&(a=c),i=l}return i}),UR=t=>m3(t,!1),vre=t=>m3(t,!0),VR=t=>u0(t,e=>{let n=t.lineBlockAt(e.head).to;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),yre=t=>u0(t,e=>{let n=t.lineBlockAt(e.head).from;return e.head>n?n:Math.max(0,e.head-1)}),wre=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:ot.of(["",""])},range:ne.cursor(i.from)}));return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},bre=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(i=>{if(!i.empty||i.from==0||i.from==t.doc.length)return{range:i};let r=i.from,s=t.doc.lineAt(r),o=r==s.from?r-1:Tn(s.text,r-s.from,!1)+s.from,a=r==s.to?r+1:Tn(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:a,insert:t.doc.slice(r,a).append(t.doc.slice(o,r))},range:ne.cursor(a)}});return n.changes.empty?!1:(e(t.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function c0(t){let e=[],n=-1;for(let i of t.selection.ranges){let r=t.doc.lineAt(i.from),s=t.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=t.doc.lineAt(i.to-1)),n>=r.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(i)}else e.push({from:r.from,to:s.to,ranges:[i]});n=s.number+1}return e}function g3(t,e,n){if(t.readOnly)return!1;let i=[],r=[];for(let s of c0(t)){if(n?s.to==t.doc.length:s.from==0)continue;let o=t.doc.lineAt(n?s.to+1:s.from-1),a=o.length+1;if(n){i.push({from:s.to,to:o.to},{from:s.from,insert:o.text+t.lineBreak});for(let l of s.ranges)r.push(ne.range(Math.min(t.doc.length,l.anchor+a),Math.min(t.doc.length,l.head+a)))}else{i.push({from:o.from,to:s.from},{from:s.to,insert:t.lineBreak+o.text});for(let l of s.ranges)r.push(ne.range(l.anchor-a,l.head-a))}}return i.length?(e(t.update({changes:i,scrollIntoView:!0,selection:ne.create(r,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const xre=({state:t,dispatch:e})=>g3(t,e,!1),Sre=({state:t,dispatch:e})=>g3(t,e,!0);function v3(t,e,n){if(t.readOnly)return!1;let i=[];for(let r of c0(t))n?i.push({from:r.from,insert:t.doc.slice(r.from,r.to)+t.lineBreak}):i.push({from:r.to,insert:t.lineBreak+t.doc.slice(r.from,r.to)});return e(t.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const kre=({state:t,dispatch:e})=>v3(t,e,!1),_re=({state:t,dispatch:e})=>v3(t,e,!0),Cre=t=>{if(t.state.readOnly)return!1;let{state:e}=t,n=e.changes(c0(e).map(({from:r,to:s})=>(r>0?r--:s<e.doc.length&&s++,{from:r,to:s}))),i=mp(e.selection,r=>{let s;if(t.lineWrapping){let o=t.lineBlockAt(r.head),a=t.coordsAtPos(r.head,r.assoc||1);a&&(s=o.bottom+t.documentTop-a.bottom+t.defaultLineHeight/2)}return t.moveVertically(r,!0,s)}).map(n);return t.dispatch({changes:n,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Ere(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=as(t).resolveInner(e),i=n.childBefore(e),r=n.childAfter(e),s;return i&&r&&i.to<=e&&r.from>=e&&(s=i.type.prop(it.closedBy))&&s.indexOf(r.name)>-1&&t.doc.lineAt(i.to).from==t.doc.lineAt(r.from).from&&!/\S/.test(t.sliceDoc(i.to,r.from))?{from:i.to,to:r.from}:null}const HR=Are(!1);function Are(t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let i=e.changeByRange(r=>{let{from:s,to:o}=r,a=e.doc.lineAt(s),l=!t&&s==o&&Ere(e,s);t&&(s=o=(o<=a.to?a:e.doc.lineAt(o)).to);let u=new dC(e,{simulateBreak:s,simulateDoubleBreak:!!l}),c=iie(u,s);for(c==null&&(c=Yf(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:s,to:o}=l:s>a.from&&s<a.from+100&&!/\S/.test(a.text.slice(0,s))&&(s=a.from);let d=["",Z1(e,c)];return l&&d.push(Z1(e,u.lineIndent(a.from,-1))),{changes:{from:s,to:o,insert:ot.of(d)},range:ne.cursor(s+1+d[1].length)}});return n(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function y3(t,e){let n=-1;return t.changeByRange(i=>{let r=[];for(let o=i.from;o<=i.to;){let a=t.doc.lineAt(o);a.number>n&&(i.empty||i.to>a.from)&&(e(a,r,i),n=a.number),o=a.to+1}let s=t.changes(r);return{changes:r,range:ne.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const rS=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(y3(t,(n,i)=>{i.push({from:n.from,insert:t.facet(cC)})}),{userEvent:"input.indent"})),!0),WR=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(y3(t,(n,i)=>{let r=/^\s*/.exec(n.text)[0];if(!r)return;let s=Yf(r,t.tabSize),o=0,a=Z1(t,Math.max(0,s-su(t)));for(;o<r.length&&o<a.length&&r.charCodeAt(o)==a.charCodeAt(o);)o++;i.push({from:n.from+o,to:n.from+r.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0);function kt(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var r=n[i];typeof r=="string"?t.setAttribute(i,r):r!=null&&(t[i]=r)}e++}for(;e<arguments.length;e++)w3(t,arguments[e]);return t}function w3(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)w3(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}const GR=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class Ff{constructor(e,n,i=0,r=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,r),this.bufferStart=i,this.normalize=s?a=>s(GR(a)):GR,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ei(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=yk(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Wr(e);let r=this.normalize(n);for(let s=0,o=i;;s++){let a=r.charCodeAt(s),l=this.match(a,o,this.bufferPos+this.bufferStart);if(s==r.length-1){if(l)return this.value=l,this;break}o==i&&s<n.length&&n.charCodeAt(s)==a&&o++}}}match(e,n,i){let r=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],a=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?r={from:this.matches[s+1],to:i}:(this.matches[s]++,a=!0)),a||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:n,to:i}:this.matches.push(1,n)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(Ff.prototype[Symbol.iterator]=function(){return this});const b3={from:-1,to:-1,match:/.*/.exec("")},bC="gm"+(/x/.unicode==null?"":"u");class x3{constructor(e,n,i,r=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=b3,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new S3(e,n,i,r,s);this.re=new RegExp(n,bC+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=Uv(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let i=this.curLineStart+n.index,r=i+n[0].length;if(this.matchPos=Uv(this.text,r+(i==r?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<r||i>this.value.to)&&(!this.test||this.test(i,r,n)))return this.value={from:i,to:r,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const rb=new WeakMap;class mc{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,i){let r=rb.get(e);if(!r||r.from>=i||r.to<=n){let a=new mc(n,e.sliceString(n,i));return rb.set(e,a),a}if(r.from==n&&r.to==i)return r;let{text:s,from:o}=r;return o>n&&(s=e.sliceString(n,o)+s,o=n),r.to<i&&(s+=e.sliceString(r.to,i)),rb.set(e,new mc(o,s)),new mc(n,s.slice(n-o,i-o))}}class S3{constructor(e,n,i,r,s){this.text=e,this.to=s,this.done=!1,this.value=b3,this.matchPos=Uv(e,r),this.re=new RegExp(n,bC+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=mc.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let i=this.flat.from+n.index,r=i+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,r,n)))return this.value={from:i,to:r,match:n},this.matchPos=Uv(this.text,r+(i==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=mc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(x3.prototype[Symbol.iterator]=S3.prototype[Symbol.iterator]=function(){return this});function Pre(t){try{return new RegExp(t,bC),!0}catch{return!1}}function Uv(t,e){if(e>=t.length)return e;let n=t.lineAt(e),i;for(;e<n.to&&(i=n.text.charCodeAt(e-n.from))>=56320&&i<57344;)e++;return e}function sS(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),n=kt("input",{class:"cm-textfield",name:"line",value:e}),i=kt("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),t.dispatch({effects:Vv.of(!1)}),t.focus()):s.keyCode==13&&(s.preventDefault(),r())},onsubmit:s=>{s.preventDefault(),r()}},kt("label",t.state.phrase("Go to line"),": ",n)," ",kt("button",{class:"cm-button",type:"submit"},t.state.phrase("go")));function r(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!s)return;let{state:o}=t,a=o.doc.lineAt(o.selection.main.head),[,l,u,c,d]=s,h=c?+c.slice(1):0,f=u?+u:a.number;if(u&&d){let w=f/100;l&&(w=w*(l=="-"?-1:1)+a.number/o.doc.lines),f=Math.round(o.doc.lines*w)}else u&&l&&(f=f*(l=="-"?-1:1)+a.number);let p=o.doc.line(Math.max(1,Math.min(o.doc.lines,f))),m=ne.cursor(p.from+Math.max(0,Math.min(h,p.length)));t.dispatch({effects:[Vv.of(!1),Pe.scrollIntoView(m.from,{y:"center"})],selection:m}),t.focus()}return{dom:i}}const Vv=Xe.define(),KR=li.define({create(){return!0},update(t,e){for(let n of e.effects)n.is(Vv)&&(t=n.value);return t},provide:t=>lf.from(t,e=>e?sS:null)}),Tre=t=>{let e=af(t,sS);if(!e){let n=[Vv.of(!0)];t.state.field(KR,!1)==null&&n.push(Xe.appendConfig.of([KR,Rre])),t.dispatch({effects:n}),e=af(t,sS)}return e&&e.dom.querySelector("input").select(),!0},Rre=Pe.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Nre=({state:t,dispatch:e})=>{let{selection:n}=t,i=ne.create(n.ranges.map(r=>t.wordAt(r.head)||ne.cursor(r.head)),n.mainIndex);return i.eq(n)?!1:(e(t.update({selection:i})),!0)};function Mre(t,e){let{main:n,ranges:i}=t.selection,r=t.wordAt(n.head),s=r&&r.from==n.from&&r.to==n.to;for(let o=!1,a=new Ff(t.doc,e,i[i.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new Ff(t.doc,e,0,Math.max(0,i[i.length-1].from-1)),o=!0}else{if(o&&i.some(l=>l.from==a.value.from))continue;if(s){let l=t.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const Ore=({state:t,dispatch:e})=>{let{ranges:n}=t.selection;if(n.some(s=>s.from===s.to))return Nre({state:t,dispatch:e});let i=t.sliceDoc(n[0].from,n[0].to);if(t.selection.ranges.some(s=>t.sliceDoc(s.from,s.to)!=i))return!1;let r=Mre(t,i);return r?(e(t.update({selection:t.selection.addRange(ne.range(r.from,r.to),!1),effects:Pe.scrollIntoView(r.to)})),!0):!1},ud=_e.define({combine(t){return nl(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Ure(e),scrollToMatch:e=>Pe.scrollIntoView(e)})}});class k3{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||Pre(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new jre(this):new Ire(this)}getCursor(e,n=0,i){let r=e.doc?e:Je.create({doc:e});return i==null&&(i=r.doc.length),this.regexp?Pu(this,r,n,i):Au(this,r,n,i)}}class _3{constructor(e){this.spec=e}}function Au(t,e,n,i){return new Ff(e.doc,t.unquoted,n,i,t.caseSensitive?void 0:r=>r.toLowerCase(),t.wholeWord?Dre(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function Dre(t,e){return(n,i,r,s)=>((s>n||s+r.length<i)&&(s=Math.max(0,n-2),r=t.sliceString(s,Math.min(t.length,i+2))),(e(Hv(r,n-s))!=Rn.Word||e(Wv(r,n-s))!=Rn.Word)&&(e(Wv(r,i-s))!=Rn.Word||e(Hv(r,i-s))!=Rn.Word))}class Ire extends _3{constructor(e){super(e)}nextMatch(e,n,i){let r=Au(this.spec,e,i,e.doc.length).nextOverlapping();return r.done&&(r=Au(this.spec,e,0,n).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,n,i){for(let r=i;;){let s=Math.max(n,r-1e4-this.spec.unquoted.length),o=Au(this.spec,e,s,r),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(s==n)return null;r-=1e4}}prevMatch(e,n,i){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let i=Au(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=n)return null;r.push(i.value)}return r}highlight(e,n,i,r){let s=Au(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}function Pu(t,e,n,i){return new x3(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?Lre(e.charCategorizer(e.selection.main.head)):void 0},n,i)}function Hv(t,e){return t.slice(Tn(t,e,!1),e)}function Wv(t,e){return t.slice(e,Tn(t,e))}function Lre(t){return(e,n,i)=>!i[0].length||(t(Hv(i.input,i.index))!=Rn.Word||t(Wv(i.input,i.index))!=Rn.Word)&&(t(Wv(i.input,i.index+i[0].length))!=Rn.Word||t(Hv(i.input,i.index+i[0].length))!=Rn.Word)}class jre extends _3{nextMatch(e,n,i){let r=Pu(this.spec,e,i,e.doc.length).next();return r.done&&(r=Pu(this.spec,e,0,n).next()),r.done?null:r.value}prevMatchInRange(e,n,i){for(let r=1;;r++){let s=Math.max(n,i-r*1e4),o=Pu(this.spec,e,s,i),a=null;for(;!o.next().done;)a=o.value;if(a&&(s==n||a.from>s+10))return a;if(s==n)return null}}prevMatch(e,n,i){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(n,i)=>i=="$"?"$":i=="&"?e.match[0]:i!="0"&&+i<e.match.length?e.match[i]:n)}matchAll(e,n){let i=Pu(this.spec,e,0,e.doc.length),r=[];for(;!i.next().done;){if(r.length>=n)return null;r.push(i.value)}return r}highlight(e,n,i,r){let s=Pu(this.spec,e,Math.max(0,n-250),Math.min(i+250,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}const Bf=Xe.define(),xC=Xe.define(),Ia=li.define({create(t){return new sb(oS(t).create(),null)},update(t,e){for(let n of e.effects)n.is(Bf)?t=new sb(n.value.create(),t.panel):n.is(xC)&&(t=new sb(t.query,n.value?SC:null));return t},provide:t=>lf.from(t,e=>e.panel)});class sb{constructor(e,n){this.query=e,this.panel=n}}const Fre=Ge.mark({class:"cm-searchMatch"}),Bre=Ge.mark({class:"cm-searchMatch cm-searchMatch-selected"}),$re=Dn.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(Ia))}update(t){let e=t.state.field(Ia);(e!=t.startState.field(Ia)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return Ge.none;let{view:n}=this,i=new Yl;for(let r=0,s=n.visibleRanges,o=s.length;r<o;r++){let{from:a,to:l}=s[r];for(;r<o-1&&l>s[r+1].from-2*250;)l=s[++r].to;t.highlight(n.state,a,l,(u,c)=>{let d=n.state.selection.ranges.some(h=>h.from==u&&h.to==c);i.add(u,c,d?Bre:Fre)})}return i.finish()}},{decorations:t=>t.decorations});function gp(t){return e=>{let n=e.state.field(Ia,!1);return n&&n.query.spec.valid?t(e,n):T3(e)}}const XR=gp((t,{query:e})=>{let{to:n}=t.state.selection.main,i=e.nextMatch(t.state,n,n);if(!i)return!1;let r=ne.single(i.from,i.to),s=t.state.facet(ud);return t.dispatch({selection:r,effects:[kC(t,i),s.scrollToMatch(r.main,t)],userEvent:"select.search"}),P3(t),!0}),qR=gp((t,{query:e})=>{let{state:n}=t,{from:i}=n.selection.main,r=e.prevMatch(n,i,i);if(!r)return!1;let s=ne.single(r.from,r.to),o=t.state.facet(ud);return t.dispatch({selection:s,effects:[kC(t,r),o.scrollToMatch(s.main,t)],userEvent:"select.search"}),P3(t),!0}),C3=gp((t,{query:e})=>{let n=e.matchAll(t.state,1e3);return!n||!n.length?!1:(t.dispatch({selection:ne.create(n.map(i=>ne.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),zre=({state:t,dispatch:e})=>{let n=t.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:i,to:r}=n.main,s=[],o=0;for(let a=new Ff(t.doc,t.sliceDoc(i,r));!a.next().done;){if(s.length>1e3)return!1;a.value.from==i&&(o=s.length),s.push(ne.range(a.value.from,a.value.to))}return e(t.update({selection:ne.create(s,o),userEvent:"select.search.matches"})),!0},YR=gp((t,{query:e})=>{let{state:n}=t,{from:i,to:r}=n.selection.main;if(n.readOnly)return!1;let s=e.nextMatch(n,i,i);if(!s)return!1;let o=[],a,l,u=[];if(s.from==i&&s.to==r&&(l=n.toText(e.getReplacement(s)),o.push({from:s.from,to:s.to,insert:l}),s=e.nextMatch(n,s.from,s.to),u.push(Pe.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(i).number)+"."))),s){let c=o.length==0||o[0].from>=s.to?0:s.to-s.from-l.length;a=ne.single(s.from-c,s.to-c),u.push(kC(t,s)),u.push(n.facet(ud).scrollToMatch(a.main,t))}return t.dispatch({changes:o,selection:a,effects:u,userEvent:"input.replace"}),!0}),E3=gp((t,{query:e})=>{if(t.state.readOnly)return!1;let n=e.matchAll(t.state,1e9).map(r=>{let{from:s,to:o}=r;return{from:s,to:o,insert:e.getReplacement(r)}});if(!n.length)return!1;let i=t.state.phrase("replaced $ matches",n.length)+".";return t.dispatch({changes:n,effects:Pe.announce.of(i),userEvent:"input.replace.all"}),!0});function SC(t){return t.state.facet(ud).createPanel(t)}function oS(t,e){var n,i,r,s,o;let a=t.selection.main,l=a.empty||a.to>a.from+100?"":t.sliceDoc(a.from,a.to);if(e&&!l)return e;let u=t.facet(ud);return new k3({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:u.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(i=e==null?void 0:e.caseSensitive)!==null&&i!==void 0?i:u.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:u.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:u.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:u.wholeWord})}function A3(t){let e=af(t,SC);return e&&e.dom.querySelector("[main-field]")}function P3(t){let e=A3(t);e&&e==t.root.activeElement&&e.select()}const T3=t=>{let e=t.state.field(Ia,!1);if(e&&e.panel){let n=A3(t);if(n&&n!=t.root.activeElement){let i=oS(t.state,e.query.spec);i.valid&&t.dispatch({effects:Bf.of(i)}),n.focus(),n.select()}}else t.dispatch({effects:[xC.of(!0),e?Bf.of(oS(t.state,e.query.spec)):Xe.appendConfig.of(Hre)]});return!0},R3=t=>{let e=t.state.field(Ia,!1);if(!e||!e.panel)return!1;let n=af(t,SC);return n&&n.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:xC.of(!1)}),!0};class Ure{constructor(e){this.view=e;let n=this.query=e.state.field(Ia).query.spec;this.commit=this.commit.bind(this),this.searchField=kt("input",{value:n.search,placeholder:Oi(e,"Find"),"aria-label":Oi(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=kt("input",{value:n.replace,placeholder:Oi(e,"Replace"),"aria-label":Oi(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=kt("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=kt("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=kt("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function i(r,s,o){return kt("button",{class:"cm-button",name:r,onclick:s,type:"button"},o)}this.dom=kt("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,i("next",()=>XR(e),[Oi(e,"next")]),i("prev",()=>qR(e),[Oi(e,"previous")]),i("select",()=>C3(e),[Oi(e,"all")]),kt("label",null,[this.caseField,Oi(e,"match case")]),kt("label",null,[this.reField,Oi(e,"regexp")]),kt("label",null,[this.wordField,Oi(e,"by word")]),...e.state.readOnly?[]:[kt("br"),this.replaceField,i("replace",()=>YR(e),[Oi(e,"replace")]),i("replaceAll",()=>E3(e),[Oi(e,"replace all")])],kt("button",{name:"close",onclick:()=>R3(e),"aria-label":Oi(e,"close"),type:"button"},["×"])])}commit(){let e=new k3({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Bf.of(e)}))}keydown(e){fH(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?qR:XR)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),YR(this.view))}update(e){for(let n of e.transactions)for(let i of n.effects)i.is(Bf)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(ud).top}}function Oi(t,e){return t.state.phrase(e)}const Tm=30,Rm=/[\s\.,:;?!]/;function kC(t,{from:e,to:n}){let i=t.state.doc.lineAt(e),r=t.state.doc.lineAt(n).to,s=Math.max(i.from,e-Tm),o=Math.min(r,n+Tm),a=t.state.sliceDoc(s,o);if(s!=i.from){for(let l=0;l<Tm;l++)if(!Rm.test(a[l+1])&&Rm.test(a[l])){a=a.slice(l);break}}if(o!=r){for(let l=a.length-1;l>a.length-Tm;l--)if(!Rm.test(a[l-1])&&Rm.test(a[l])){a=a.slice(0,l);break}}return Pe.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${i.number}.`)}const Vre=Pe.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Hre=[Ia,Xf.low($re),Vre];class Wre{constructor(e,n,i,r){this.state=e,this.pos=n,this.explicit=i,this.view=r,this.abortListeners=[]}tokenBefore(e){let n=as(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),i=Math.max(n.from,this.pos-250),r=n.text.slice(i-n.from,this.pos-n.from),s=r.search(N3(e,!1));return s<0?null:{from:i+s,to:this.pos,text:r.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,n){e=="abort"&&this.abortListeners&&this.abortListeners.push(n)}}function JR(t){let e=Object.keys(t).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Gre(t){let e=Object.create(null),n=Object.create(null);for(let{label:r}of t){e[r[0]]=!0;for(let s=1;s<r.length;s++)n[r[s]]=!0}let i=JR(e)+JR(n)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function Kre(t){let e=t.map(r=>typeof r=="string"?{label:r}:r),[n,i]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:Gre(e);return r=>{let s=r.matchBefore(i);return s||r.explicit?{from:s?s.from:r.pos,options:e,validFor:n}:null}}class ZR{constructor(e,n,i,r){this.completion=e,this.source=n,this.match=i,this.score=r}}function gc(t){return t.selection.main.from}function N3(t,e){var n;let{source:i}=t,r=e&&i[0]!="^",s=i[i.length-1]!="$";return!r&&!s?t:new RegExp(`${r?"^":""}(?:${i})${s?"$":""}`,(n=t.flags)!==null&&n!==void 0?n:t.ignoreCase?"i":"")}const M3=Bo.define();function Xre(t,e,n,i){let{main:r}=t.selection,s=n-r.from,o=i-r.from;return Object.assign(Object.assign({},t.changeByRange(a=>a!=r&&n!=i&&t.sliceDoc(a.from+s,a.from+o)!=t.sliceDoc(n,i)?{range:a}:{changes:{from:a.from+s,to:i==r.from?a.to:a.from+o,insert:e},range:ne.cursor(a.from+s+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const QR=new WeakMap;function qre(t){if(!Array.isArray(t))return t;let e=QR.get(t);return e||QR.set(t,e=Kre(t)),e}const O3=Xe.define(),_C=Xe.define();class Yre{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let i=ei(e,n),r=Wr(i);this.chars.push(i);let s=e.slice(n,n+r),o=s.toUpperCase();this.folded.push(ei(o==s?s.toLowerCase():o,0)),n+=r}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:n,folded:i,any:r,precise:s,byWord:o}=this;if(n.length==1){let y=ei(e,0),b=Wr(y),k=b==e.length?0:-100;if(y!=n[0])if(y==i[0])k+=-200;else return null;return this.ret(k,[0,b])}let a=e.indexOf(this.pattern);if(a==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=n.length,u=0;if(a<0){for(let y=0,b=Math.min(e.length,200);y<b&&u<l;){let k=ei(e,y);(k==n[u]||k==i[u])&&(r[u++]=y),y+=Wr(k)}if(u<l)return null}let c=0,d=0,h=!1,f=0,p=-1,m=-1,w=/[a-z]/.test(e),v=!0;for(let y=0,b=Math.min(e.length,200),k=0;y<b&&d<l;){let _=ei(e,y);a<0&&(c<l&&_==n[c]&&(s[c++]=y),f<l&&(_==n[f]||_==i[f]?(f==0&&(p=y),m=y+1,f++):f=0));let E,A=_<255?_>=48&&_<=57||_>=97&&_<=122?2:_>=65&&_<=90?1:0:(E=yk(_))!=E.toLowerCase()?1:E!=E.toUpperCase()?2:0;(!y||A==1&&w||k==0&&A!=0)&&(n[d]==_||i[d]==_&&(h=!0)?o[d++]=y:o.length&&(v=!1)),k=A,y+=Wr(_)}return d==l&&o[0]==0&&v?this.result(-100+(h?-200:0),o,e):f==l&&p==0?this.ret(-200-e.length+(m==e.length?0:-100),[0,m]):a>-1?this.ret(-700-e.length,[a,a+this.pattern.length]):f==l?this.ret(-900-e.length,[p,m]):d==l?this.result(-100+(h?-200:0)+-700+(v?0:-1100),o,e):n.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,n,i){let r=[],s=0;for(let o of n){let a=o+(this.astral?Wr(ei(i,o)):1);s&&r[s-1]==o?r[s-1]=a:(r[s++]=o,r[s++]=a)}return this.ret(e-i.length,r)}}class Jre{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let n=e.slice(0,this.pattern.length),i=n==this.pattern?0:n.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,n.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const Ts=_e.define({combine(t){return nl(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Zre,filterStrict:!1,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>i=>eN(e(i),n(i)),optionClass:(e,n)=>i=>eN(e(i),n(i)),addToOptions:(e,n)=>e.concat(n),filterStrict:(e,n)=>e||n})}});function eN(t,e){return t?e?t+" "+e:t:e}function Zre(t,e,n,i,r,s){let o=t.textDirection==Nt.RTL,a=o,l=!1,u="top",c,d,h=e.left-r.left,f=r.right-e.right,p=i.right-i.left,m=i.bottom-i.top;if(a&&h<Math.min(p,f)?a=!1:!a&&f<Math.min(p,h)&&(a=!0),p<=(a?h:f))c=Math.max(r.top,Math.min(n.top,r.bottom-m))-e.top,d=Math.min(400,a?h:f);else{l=!0,d=Math.min(400,(o?e.right:r.right-e.left)-30);let y=r.bottom-e.bottom;y>=m||y>e.top?c=n.bottom-e.top:(u="bottom",c=e.bottom-n.top)}let w=(e.bottom-e.top)/s.offsetHeight,v=(e.right-e.left)/s.offsetWidth;return{style:`${u}: ${c/w}px; max-width: ${d/v}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":a?"left":"right")}}function Qre(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(n){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),n.type&&i.classList.add(...n.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(n,i,r,s){let o=document.createElement("span");o.className="cm-completionLabel";let a=n.displayLabel||n.label,l=0;for(let u=0;u<s.length;){let c=s[u++],d=s[u++];c>l&&o.appendChild(document.createTextNode(a.slice(l,c)));let h=o.appendChild(document.createElement("span"));h.appendChild(document.createTextNode(a.slice(c,d))),h.className="cm-completionMatchedText",l=d}return l<a.length&&o.appendChild(document.createTextNode(a.slice(l))),o},position:50},{render(n){if(!n.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=n.detail,i},position:80}),e.sort((n,i)=>n.position-i.position).map(n=>n.render)}function ob(t,e,n){if(t<=n)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let r=Math.floor(e/n);return{from:r*n,to:(r+1)*n}}let i=Math.floor((t-e)/n);return{from:t-(i+1)*n,to:t-i*n}}class ese{constructor(e,n,i){this.view=e,this.stateField=n,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let r=e.state.field(n),{options:s,selected:o}=r.open,a=e.state.facet(Ts);this.optionContent=Qre(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=ob(s.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:u}=e.state.field(n).open;for(let c=l.target,d;c&&c!=this.dom;c=c.parentNode)if(c.nodeName=="LI"&&(d=/-(\d+)$/.exec(c.id))&&+d[1]<u.length){this.applyCompletion(e,u[+d[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let u=e.state.field(this.stateField,!1);u&&u.tooltip&&e.state.facet(Ts).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:_C.of(null)})}),this.showOptions(s,r.id)}mount(){this.updateSel()}showOptions(e,n){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,n,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var n;let i=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=r){let{options:s,selected:o,disabled:a}=i.open;(!r.open||r.open.options!=s)&&(this.range=ob(s.length,o,e.state.facet(Ts).maxRenderedOptions),this.showOptions(s,i.id)),this.updateSel(),a!=((n=r.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of n.split(" "))i&&this.dom.classList.add(i);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;if((n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=ob(n.options.length,n.selected,this.view.state.facet(Ts).maxRenderedOptions),this.showOptions(n.options,e.id)),this.updateSelectedOption(n.selected)){this.destroyInfo();let{completion:i}=n.options[n.selected],{info:r}=i;if(!r)return;let s=typeof r=="string"?document.createTextNode(r):r(i);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,i)}).catch(o=>Vi(this.view.state,o,"completion info")):this.addInfoPane(s,i)}}addInfoPane(e,n){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:s}=e;i.appendChild(r),this.infoDestroy=s||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let i=this.list.firstChild,r=this.range.from;i;i=i.nextSibling,r++)i.nodeName!="LI"||!i.id?r--:r==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),n=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return n&&nse(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.defaultView||window;s={left:0,top:0,right:o.innerWidth,bottom:o.innerHeight}}return r.top>Math.min(s.bottom,n.bottom)-10||r.bottom<Math.max(s.top,n.top)+10?null:this.view.state.facet(Ts).positionInfo(this.view,n,r,i,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,i){const r=document.createElement("ul");r.id=n,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));let s=null;for(let o=i.from;o<i.to;o++){let{completion:a,match:l}=e[o],{section:u}=a;if(u){let h=typeof u=="string"?u:u.name;if(h!=s&&(o>i.from||i.from==0))if(s=h,typeof u!="string"&&u.header)r.appendChild(u.header(u));else{let f=r.appendChild(document.createElement("completion-section"));f.textContent=h}}const c=r.appendChild(document.createElement("li"));c.id=n+"-"+o,c.setAttribute("role","option");let d=this.optionClass(a);d&&(c.className=d);for(let h of this.optionContent){let f=h(a,this.view.state,this.view,l);f&&c.appendChild(f)}}return i.from&&r.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function tse(t,e){return n=>new ese(n,t,e)}function nse(t,e){let n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),r=n.height/t.offsetHeight;i.top<n.top?t.scrollTop-=(n.top-i.top)/r:i.bottom>n.bottom&&(t.scrollTop+=(i.bottom-n.bottom)/r)}function tN(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function ise(t,e){let n=[],i=null,r=u=>{n.push(u);let{section:c}=u.completion;if(c){i||(i=[]);let d=typeof c=="string"?c:c.name;i.some(h=>h.name==d)||i.push(typeof c=="string"?{name:d}:c)}},s=e.facet(Ts);for(let u of t)if(u.hasResult()){let c=u.result.getMatch;if(u.result.filter===!1)for(let d of u.result.options)r(new ZR(d,u.source,c?c(d):[],1e9-n.length));else{let d=e.sliceDoc(u.from,u.to),h,f=s.filterStrict?new Jre(d):new Yre(d);for(let p of u.result.options)if(h=f.match(p.label)){let m=p.displayLabel?c?c(p,h.matched):[]:h.matched;r(new ZR(p,u.source,m,h.score+(p.boost||0)))}}}if(i){let u=Object.create(null),c=0,d=(h,f)=>{var p,m;return((p=h.rank)!==null&&p!==void 0?p:1e9)-((m=f.rank)!==null&&m!==void 0?m:1e9)||(h.name<f.name?-1:1)};for(let h of i.sort(d))c-=1e5,u[h.name]=c;for(let h of n){let{section:f}=h.completion;f&&(h.score+=u[typeof f=="string"?f:f.name])}}let o=[],a=null,l=s.compareCompletions;for(let u of n.sort((c,d)=>d.score-c.score||l(c.completion,d.completion))){let c=u.completion;!a||a.label!=c.label||a.detail!=c.detail||a.type!=null&&c.type!=null&&a.type!=c.type||a.apply!=c.apply||a.boost!=c.boost?o.push(u):tN(u.completion)>tN(a)&&(o[o.length-1]=u),a=u.completion}return o}class Xu{constructor(e,n,i,r,s,o){this.options=e,this.attrs=n,this.tooltip=i,this.timestamp=r,this.selected=s,this.disabled=o}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new Xu(this.options,nN(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,i,r,s){let o=ise(e,n);if(!o.length)return r&&e.some(l=>l.state==1)?new Xu(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;let a=n.facet(Ts).selectOnOpen?0:-1;if(r&&r.selected!=a&&r.selected!=-1){let l=r.options[r.selected].completion;for(let u=0;u<o.length;u++)if(o[u].completion==l){a=u;break}}return new Xu(o,nN(i,a),{pos:e.reduce((l,u)=>u.hasResult()?Math.min(l,u.from):l,1e8),create:dse,above:s.aboveCursor},r?r.timestamp:Date.now(),a,!1)}map(e){return new Xu(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Gv{constructor(e,n,i){this.active=e,this.id=n,this.open=i}static start(){return new Gv(ase,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,i=n.facet(Ts),s=(i.override||n.languageDataAt("autocomplete",gc(n)).map(qre)).map(a=>(this.active.find(u=>u.source==a)||new pr(a,this.active.some(u=>u.state!=0)?1:0)).update(e,i));s.length==this.active.length&&s.every((a,l)=>a==this.active[l])&&(s=this.active);let o=this.open;o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(a=>a.hasResult()&&e.changes.touchesRange(a.from,a.to))||!rse(s,this.active)?o=Xu.build(s,n,this.id,o,i):o&&o.disabled&&!s.some(a=>a.state==1)&&(o=null),!o&&s.every(a=>a.state!=1)&&s.some(a=>a.hasResult())&&(s=s.map(a=>a.hasResult()?new pr(a.source,0):a));for(let a of e.effects)a.is(D3)&&(o=o&&o.setSelected(a.value,this.id));return s==this.active&&o==this.open?this:new Gv(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?sse:ose}}function rse(t,e){if(t==e)return!0;for(let n=0,i=0;;){for(;n<t.length&&!t[n].hasResult;)n++;for(;i<e.length&&!e[i].hasResult;)i++;let r=n==t.length,s=i==e.length;if(r||s)return r==s;if(t[n++].result!=e[i++].result)return!1}}const sse={"aria-autocomplete":"list"},ose={};function nN(t,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(n["aria-activedescendant"]=t+"-"+e),n}const ase=[];function lse(t,e){if(t.isUserEvent("input.complete")){let i=t.annotation(M3);if(i&&e.activateOnCompletion(i))return 12}let n=t.isUserEvent("input.type");return n&&e.activateOnTyping?5:n?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class pr{constructor(e,n,i=-1){this.source=e,this.state=n,this.explicitPos=i}hasResult(){return!1}update(e,n){let i=lse(e,n),r=this;(i&8||i&16&&this.touches(e))&&(r=new pr(r.source,0)),i&4&&r.state==0&&(r=new pr(this.source,1)),r=r.updateFor(e,i);for(let s of e.effects)if(s.is(O3))r=new pr(r.source,1,s.value?gc(e.state):-1);else if(s.is(_C))r=new pr(r.source,0);else if(s.is(cse))for(let o of s.value)o.source==r.source&&(r=o);return r}updateFor(e,n){return this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new pr(this.source,this.state,e.mapPos(this.explicitPos))}touches(e){return e.changes.touchesRange(gc(e.state))}}class Eh extends pr{constructor(e,n,i,r,s){super(e,2,n),this.result=i,this.from=r,this.to=s}hasResult(){return!0}updateFor(e,n){var i;if(!(n&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=gc(e.state);if((this.explicitPos<0?a<=s:a<this.from)||a>o||!r||n&2&&gc(e.startState)==this.from)return new pr(this.source,n&4?1:0);let l=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return use(r.validFor,e.state,s,o)?new Eh(this.source,l,r,s,o):r.update&&(r=r.update(r,s,o,new Wre(e.state,a,l>=0)))?new Eh(this.source,l,r,r.from,(i=r.to)!==null&&i!==void 0?i:gc(e.state)):new pr(this.source,1,l)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Eh(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new pr(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function use(t,e,n,i){if(!t)return!1;let r=e.sliceDoc(n,i);return typeof t=="function"?t(r,n,i,e):N3(t,!0).test(r)}const cse=Xe.define({map(t,e){return t.map(n=>n.map(e))}}),D3=Xe.define(),cd=li.define({create(){return Gv.start()},update(t,e){return t.update(e)},provide:t=>[Rk.from(t,e=>e.tooltip),Pe.contentAttributes.from(t,e=>e.attrs)]});function I3(t,e){const n=e.completion.apply||e.completion.label;let i=t.state.field(cd).active.find(r=>r.source==e.source);return i instanceof Eh?(typeof n=="string"?t.dispatch(Object.assign(Object.assign({},Xre(t.state,n,i.from,i.to)),{annotations:M3.of(e.completion)})):n(t,e.completion,i.from,i.to),!0):!1}const dse=tse(cd,I3);function Nm(t,e="option"){return n=>{let i=n.state.field(cd,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<n.state.facet(Ts).interactionDelay)return!1;let r=1,s;e=="page"&&(s=WH(n,i.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=i.open.options,a=i.open.selected>-1?i.open.selected+r*(t?1:-1):t?0:o-1;return a<0?a=e=="page"?0:o-1:a>=o&&(a=e=="page"?o-1:0),n.dispatch({effects:D3.of(a)}),!0}}const iN=t=>{let e=t.state.field(cd,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(Ts).interactionDelay?!1:I3(t,e.open.options[e.open.selected])},hse=t=>t.state.field(cd,!1)?(t.dispatch({effects:O3.of(!0)}),!0):!1,fse=t=>{let e=t.state.field(cd,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(t.dispatch({effects:_C.of(null)}),!0)},L3={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},j3=new class extends ql{};j3.startSide=1;j3.endSide=-1;const ab="()[]{}<>";function pse(t){for(let e=0;e<ab.length;e+=2)if(ab.charCodeAt(e)==t)return ab.charAt(e+1);return yk(t<128?t:t+1)}function mse(t,e){return t.languageDataAt("closeBrackets",e)[0]||L3}const gse=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=mse(t,t.selection.main.head).brackets||L3.brackets,r=null,s=t.changeByRange(o=>{if(o.empty){let a=yse(t.doc,o.head);for(let l of i)if(l==a&&vse(t.doc,o.head)==pse(ei(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:ne.cursor(o.head-l.length)}}return{range:r=o}});return r||e(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!r};function vse(t,e){let n=t.sliceString(e,e+2);return n.slice(0,Wr(ei(n,0)))}function yse(t,e){let n=t.sliceString(e-2,e);return Wr(ei(n,0))==n.length?n:n.slice(1)}class wse{constructor(e,n,i){this.from=e,this.to=n,this.diagnostic=i}}class Pl{constructor(e,n,i){this.diagnostics=e,this.panel=n,this.selected=i}static init(e,n,i){let r=e,s=i.facet(Os).markerFilter;s&&(r=s(r,i));let o=Ge.set(r.map(a=>a.from==a.to||a.from==a.to-1&&i.doc.lineAt(a.from).to==a.from?Ge.widget({widget:new Tse(a),diagnostic:a}).range(a.from):Ge.mark({attributes:{class:"cm-lintRange cm-lintRange-"+a.severity+(a.markClass?" "+a.markClass:"")},diagnostic:a}).range(a.from,a.to)),!0);return new Pl(o,n,Yc(o))}}function Yc(t,e=null,n=0){let i=null;return t.between(n,1e9,(r,s,{spec:o})=>{if(!(e&&o.diagnostic!=e))return i=new wse(r,s,o.diagnostic),!1}),i}function bse(t,e){let n=e.pos,i=e.end||n,r=t.state.facet(Os).hideOn(t,n,i);if(r!=null)return r;let s=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(o=>o.is(CC))||t.changes.touchesRange(s.from,Math.max(s.to,i)))}function F3(t,e){return t.field(Wi,!1)?e:e.concat(Xe.appendConfig.of(U3))}function xse(t,e){return{effects:F3(t,[CC.of(e)])}}const CC=Xe.define(),EC=Xe.define(),B3=Xe.define(),Wi=li.define({create(){return new Pl(Ge.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let n=t.diagnostics.map(e.changes),i=null,r=t.panel;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);i=Yc(n,t.selected.diagnostic,s)||Yc(n,null,s)}!n.size&&r&&e.state.facet(Os).autoPanel&&(r=null),t=new Pl(n,r,i)}for(let n of e.effects)if(n.is(CC)){let i=e.state.facet(Os).autoPanel?n.value.length?$f.open:null:t.panel;t=Pl.init(n.value,i,e.state)}else n.is(EC)?t=new Pl(t.diagnostics,n.value?$f.open:null,t.selected):n.is(B3)&&(t=new Pl(t.diagnostics,t.panel,n.value));return t},provide:t=>[lf.from(t,e=>e.panel),Pe.decorations.from(t,e=>e.diagnostics)]}),Sse=Ge.mark({class:"cm-lintRange cm-lintRange-active"});function kse(t,e,n){let{diagnostics:i}=t.state.field(Wi),r=[],s=2e8,o=0;i.between(e-(n<0?1:0),e+(n>0?1:0),(l,u,{spec:c})=>{e>=l&&e<=u&&(l==u||(e>l||n>0)&&(e<u||n<0))&&(r.push(c.diagnostic),s=Math.min(l,s),o=Math.max(u,o))});let a=t.state.facet(Os).tooltipFilter;return a&&(r=a(r,t.state)),r.length?{pos:s,end:o,above:t.state.doc.lineAt(s).to<o,create(){return{dom:_se(t,r)}}}:null}function _se(t,e){return kt("ul",{class:"cm-tooltip-lint"},e.map(n=>z3(t,n,!1)))}const Cse=t=>{let e=t.state.field(Wi,!1);(!e||!e.panel)&&t.dispatch({effects:F3(t.state,[EC.of(!0)])});let n=af(t,$f.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},rN=t=>{let e=t.state.field(Wi,!1);return!e||!e.panel?!1:(t.dispatch({effects:EC.of(!1)}),!0)},Ese=t=>{let e=t.state.field(Wi,!1);if(!e)return!1;let n=t.state.selection.main,i=e.diagnostics.iter(n.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==n.from&&i.to==n.to)?!1:(t.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},Ase=Dn.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(Os);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);let t=Date.now();if(t<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:e}=this.view,{sources:n}=e.facet(Os);n.length&&Promise.all(n.map(i=>Promise.resolve(i(this.view)))).then(i=>{let r=i.reduce((s,o)=>s.concat(o));this.view.state.doc==e.doc&&this.view.dispatch(xse(this.view.state,r))},i=>{Vi(this.view.state,i)})}}update(t){let e=t.state.facet(Os);(t.docChanged||e!=t.startState.facet(Os)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),Os=_e.define({combine(t){return Object.assign({sources:t.map(e=>e.source).filter(e=>e!=null)},nl(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,n)=>e?n?i=>e(i)||n(i):e:n}))}});function Pse(t,e={}){return[Os.of({source:t,config:e}),Ase,U3]}function $3(t){let e=[];if(t)e:for(let{name:n}of t){for(let i=0;i<n.length;i++){let r=n[i];if(/[a-zA-Z]/.test(r)&&!e.some(s=>s.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function z3(t,e,n){var i;let r=n?$3(e.actions):[];return kt("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},kt("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((s,o)=>{let a=!1,l=h=>{if(h.preventDefault(),a)return;a=!0;let f=Yc(t.state.field(Wi).diagnostics,e);f&&s.apply(t,f.from,f.to)},{name:u}=s,c=r[o]?u.indexOf(r[o]):-1,d=c<0?u:[u.slice(0,c),kt("u",u.slice(c,c+1)),u.slice(c+1)];return kt("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${u}${c<0?"":` (access key "${r[o]})"`}.`},d)}),e.source&&kt("div",{class:"cm-diagnosticSource"},e.source))}class Tse extends il{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return kt("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class sN{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=z3(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class $f{constructor(e){this.view=e,this.items=[];let n=r=>{if(r.keyCode==27)rN(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=$3(s.actions);for(let a=0;a<o.length;a++)if(o[a].toUpperCase().charCodeAt(0)==r.keyCode){let l=Yc(this.view.state.field(Wi).diagnostics,s);l&&s.actions[a].apply(e,l.from,l.to)}}else return;r.preventDefault()},i=r=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(r.target)&&this.moveSelection(s)};this.list=kt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:i}),this.dom=kt("div",{class:"cm-panel-lint"},this.list,kt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>rN(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(Wi).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(Wi),i=0,r=!1,s=null;for(e.between(0,this.view.state.doc.length,(o,a,{spec:l})=>{let u=-1,c;for(let d=i;d<this.items.length;d++)if(this.items[d].diagnostic==l.diagnostic){u=d;break}u<0?(c=new sN(this.view,l.diagnostic),this.items.splice(i,0,c),r=!0):(c=this.items[u],u>i&&(this.items.splice(i,u-i),r=!0)),n&&c.diagnostic==n.diagnostic?c.dom.hasAttribute("aria-selected")||(c.dom.setAttribute("aria-selected","true"),s=c):c.dom.hasAttribute("aria-selected")&&c.dom.removeAttribute("aria-selected"),i++});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new sN(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:a})=>{let l=a.height/this.list.offsetHeight;o.top<a.top?this.list.scrollTop-=(a.top-o.top)/l:o.bottom>a.bottom&&(this.list.scrollTop+=(o.bottom-a.bottom)/l)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function n(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)n();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(Wi),i=Yc(n.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:B3.of(i)})}static open(e){return new $f(e)}}function Rse(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function Mm(t){return Rse(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const Nse=Pe.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Mm("#d11")},".cm-lintRange-warning":{backgroundImage:Mm("orange")},".cm-lintRange-info":{backgroundImage:Mm("#999")},".cm-lintRange-hint":{backgroundImage:Mm("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),U3=[Wi,Pe.decorations.compute([Wi],t=>{let{selected:e,panel:n}=t.field(Wi);return!e||!n||e.from==e.to?Ge.none:Ge.set([Sse.range(e.from,e.to)])}),HH(kse,{hideOn:bse}),Nse],V3=t=>e=>{const n=t==="down";let i=e.state.selection;for(const r of i.ranges)i=i.addRange(e.moveVertically(r,n));return e.dispatch({selection:i}),!0},Mse=V3("up"),Ose=V3("down"),Dse=t=>{let e=null;for(const n of t.state.selection.ranges)if(!n.empty)for(let i=n.from;i<=n.to;){const r=t.state.doc.lineAt(i),s=Math.min(r.to,n.to);e?e=e.addRange(ne.range(s,s)):e=ne.single(s),i=r.to+1}return e?(t.dispatch({selection:e}),!0):!1},Ise=[{key:"Ctrl-Space",run:hse},{key:"Escape",run:fse},{key:"ArrowDown",run:Nm(!0)},{key:"ArrowUp",run:Nm(!1)},{key:"PageDown",run:Nm(!0,"page")},{key:"PageUp",run:Nm(!1,"page")},{key:"Enter",run:iN},{key:"Tab",run:iN},{key:"Mod-f",run:T3,scope:"editor search-panel"},{key:"Escape",run:R3,scope:"editor search-panel"},{key:"Alt-Enter",run:C3,scope:"editor search-panel"},{key:"Mod-Alt-Enter",run:E3,scope:"editor search-panel"},{key:"Ctrl-g",run:Tre},{key:"Mod-d",run:Ore,preventDefault:!0},{key:"Shift-Mod-l",run:zre},{key:"Enter",run:HR,shift:HR},{key:"ArrowLeft",run:kR,shift:TR,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:sre,shift:dre},{key:"ArrowRight",run:_R,shift:RR,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:ore,shift:hre},{key:"ArrowUp",run:CR,shift:NR,preventDefault:!0},{key:"ArrowDown",run:ER,shift:MR,preventDefault:!0},{key:"Home",run:PR,shift:LR},{mac:"Cmd-ArrowLeft",run:PR,shift:LR},{key:"Mod-Home",run:jR,shift:BR},{mac:"Cmd-ArrowUp",run:jR,shift:BR},{key:"PageUp",run:tb,shift:OR},{mac:"Ctrl-ArrowUp",run:tb,shift:OR},{key:"PageDown",run:nb,shift:DR},{mac:"Ctrl-ArrowDown",run:nb,shift:DR},{key:"End",run:AR,shift:IR},{mac:"Cmd-ArrowRight",run:AR,shift:IR},{key:"Mod-Alt-ArrowUp",linux:"Shift-Alt-ArrowUp",run:Mse,preventDefault:!0},{key:"Mod-Alt-ArrowDown",linux:"Shift-Alt-ArrowDown",run:Ose,preventDefault:!0},{key:"Shift-Alt-i",run:Dse},{key:"Mod-End",run:FR,shift:$R},{mac:"Cmd-ArrowDown",run:FR,shift:$R},{key:"Mod-a",run:mre},{key:"Backspace",run:gse},{key:"Backspace",run:ib,shift:ib},{key:"Delete",run:zR},{key:"Mod-Backspace",mac:"Alt-Backspace",run:UR},{key:"Mod-Delete",mac:"Alt-Delete",run:vre},{mac:"Mod-Backspace",run:yre},{mac:"Mod-Delete",run:VR},{mac:"Ctrl-b",run:kR,shift:TR,preventDefault:!0},{mac:"Ctrl-f",run:_R,shift:RR},{mac:"Ctrl-p",run:CR,shift:NR},{mac:"Ctrl-n",run:ER,shift:MR},{mac:"Ctrl-a",run:are,shift:fre},{mac:"Ctrl-e",run:lre,shift:pre},{mac:"Ctrl-d",run:zR},{mac:"Ctrl-h",run:ib},{mac:"Ctrl-k",run:VR},{mac:"Ctrl-Alt-h",run:UR},{mac:"Ctrl-o",run:wre},{mac:"Ctrl-t",run:bre},{mac:"Ctrl-v",run:nb},{mac:"Alt-v",run:tb},{key:"Shift-Mod-k",run:Cre},{key:"Alt-ArrowDown",run:Sre},{key:"Alt-ArrowUp",run:xre},{win:"Shift-Alt-ArrowDown",mac:"Shift-Alt-ArrowDown",run:_re},{win:"Shift-Alt-ArrowUp",mac:"Shift-Alt-ArrowUp",run:kre},{key:"Mod-l",run:gre,preventDefault:!0},{key:"Shift-Mod-\\",run:cre},{key:"Tab",run:rS,shift:WR,preventDefault:!0},{key:"Mod-[",run:WR},{key:"Mod-]",run:rS},{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:vie},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:yie},{key:"Mod-k Mod-0",run:wie},{key:"Mod-k Mod-j",run:bie},{key:"Mod-k Mod-c",run:Vie},{key:"Mod-k Mod-u",run:Hie},{key:"Mod-/",run:zie},{key:"Shift-Alt-a",run:Wie},{key:"Mod-z",run:n3,preventDefault:!0},{key:"Mod-y",run:iS,preventDefault:!0},{key:"Mod-Shift-z",run:iS,preventDefault:!0},{key:"Mod-u",run:Zie,preventDefault:!0},{key:"Mod-Shift-m",run:Cse},{key:"F8",run:Ese}],aS=Ae(0);function Lse(){const t=mt(),e=qt(aS);return g.jsxs("div",{className:"flex items-center justify-between border-t border-stone-600 bg-stone-800 px-3 font-sans text-xs tracking-wider text-stone-400",children:[g.jsx(tX,{}),g.jsx("span",{className:Ue(e>0&&"font-semibold text-red-400"),children:t("editor.lintSummary",e)})]})}const fi={character:Be.character,comment:Be.comment,"data-directive":Sn.define(),identifier:Be.variableName,instruction:Sn.define(),label:Be.labelName,number:Be.number,operator:Be.operator,offset:Sn.define(),"ptr-size":Sn.define(),punctuation:Be.punctuation,register:Sn.define(),special:Sn.define(),string:Be.string,unassigned:Sn.define()},jse=pC.define({name:"vonsim",token:t=>{if(t.eatSpace())return null;if(t.match(/[01]+b\b/i)||t.match(/\d[a-f\d]*h\b/i)||t.match(/\d+\b/))return"number";if(t.match(/'[^'\n]'/))return"character";if(t.eat('"'))return t.eatWhile(/[^"\n]/),t.eat('"'),"string";if(t.eat(/[*+-]/))return"operator";if(t.eat(/[(),[\]]/))return"punctuation";if(t.eat("?"))return"unassigned";if(t.eat(";"))return t.skipToEnd(),"comment";if(t.eat(/[a-z_]/i)){t.eatWhile(/\w/);const e=t.current().toUpperCase();return e==="ORG"||e==="END"?"special":e==="OFFSET"?"offset":e==="BYTE"||e==="WORD"||e==="PTR"?"ptr-size":o_.includes(e)?"data-directive":a_.includes(e)?"instruction":kv.includes(e)?"register":t.eat(":")?"label":"identifier"}return t.next(),null},languageData:{commentTokens:{line:";"},closeBrackets:{brackets:["(","[",'"']}},tokenTable:fi}),Fse=Eie(o0.define([{tag:fi.character,class:"text-orange-300"},{tag:fi.comment,class:"text-stone-500 italic"},{tag:fi["data-directive"],class:"text-rose-400/80"},{tag:fi.instruction,class:"text-mantis-400"},{tag:fi.number,class:"text-cyan-300/60"},{tag:fi.operator,class:"text-rose-300"},{tag:fi.offset,class:"text-rose-400/80 italic"},{tag:fi["ptr-size"],class:"text-rose-400/80 italic"},{tag:fi.punctuation,class:"text-stone-600"},{tag:fi.register,class:"text-emerald-400/80"},{tag:fi.special,class:"text-yellow-300/80"},{tag:fi.string,class:"text-orange-300"},{tag:fi.unassigned,class:"text-rose-400/80"}])),Bse=Pse(t=>{const e=t.state.doc.toString(),n=vj(e);if(n.success)return ee.set(aS,0),[];const i=Si().language,r=n.errors.map(s=>{var l,u;const o=((l=s.position)==null?void 0:l.start)??0,a=((u=s.position)==null?void 0:u.end)??e.length;return{message:s.translate(i),severity:"error",from:o,to:a}});return ee.set(aS,r.length),r},{delay:200});function $se(){return new nie(jse,[Fse,Bse])}function H3({className:t}){const[e,n]=S.useState(),i=OK(),r=S.useCallback(s=>{s&&n(s)},[]);return S.useEffect(()=>{if(e)return window.codemirror=new Pe({state:Je.create({doc:JK(),extensions:[Je.tabSize.of(2),kj.of(Je.readOnly.of(!1)),ZK,QH(),yq,n9(),PH(),Jie(),wH(),Pe.domEventHandlers({drop:s=>s.preventDefault()}),Je.allowMultipleSelections.of(!0),DH(),pI.of([{key:"Escape",run:s=>(s.dispatch({selection:ne.create([s.state.selection.main],0)}),!0)},{key:"Tab",run:s=>s.state.selection.ranges.some(o=>!o.empty)?rS(s):(s.dispatch(s.state.update(s.state.replaceSelection(" ".repeat(s.state.tabSize)),{scrollIntoView:!0,userEvent:"input"})),!0)},...Ise]),$se()]}),parent:e}),()=>{var s;return(s=window.codemirror)==null?void 0:s.destroy()}},[e]),g.jsxs("div",{className:Ue("flex flex-col",t),children:[g.jsx("div",{ref:r,className:"grow overflow-auto font-mono",style:{fontSize:`${i}px`,lineHeight:1.25}}),g.jsx(Lse,{})]})}function zse(){const t=i_(),e=mt(),n=jK(),i=fU("(max-width: 640px)"),{updateServiceWorker:r}=yU({onNeedRefresh(){Gt({title:e("update.update-available"),action:g.jsx(GB,{altText:e("update.reload"),onClick:()=>r(!0),children:e("update.reload")}),duration:1/0})}});return g.jsxs("div",{className:"flex h-screen w-screen flex-col bg-stone-900 text-white",lang:t,style:{filter:n},children:[g.jsx(ree,{}),i?g.jsx(Vse,{}):g.jsx(Use,{}),g.jsx(nX,{})]})}function Use(){const[t]=td(Y_);return g.jsxs(Y2,{autoSaveId:"layout",direction:"horizontal",tagName:"main",className:"overflow-auto px-2",children:[g.jsx(qm,{id:"panel-editor",order:1,minSize:30,tagName:"section",className:"rounded-lg border border-stone-600 bg-stone-800",children:g.jsx(H3,{className:"h-full w-full"})}),g.jsx(Mx,{className:"w-2"}),g.jsx(qm,{id:"panel-computer",order:2,minSize:20,tagName:"section",className:"computer-background rounded-lg border border-stone-600",children:g.jsx(T$,{})}),t&&g.jsxs(g.Fragment,{children:[g.jsx(Mx,{className:"w-2"}),g.jsx(qm,{id:"panel-settings",order:3,minSize:30,tagName:"section",className:"rounded-lg border border-stone-600 bg-stone-800",children:g.jsx(_B,{className:"h-full w-full"})})]})]})}function Vse(){const t=mt(),[e,n]=S.useState("editor"),[i,r]=td(Y_),s=i?"settings":e,o=a=>{i&&r(!1),n(a)};return g.jsx(k2,{value:s,onValueChange:o,asChild:!0,children:g.jsxs(g.Fragment,{children:[g.jsx(Xm,{value:"editor",asChild:!0,children:g.jsx("section",{className:"mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden",children:g.jsx(H3,{className:"h-full w-full"})})}),g.jsx(Xm,{value:"computer",asChild:!0,children:g.jsx("section",{className:"computer-background mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden",children:g.jsx(T$,{})})}),g.jsx(Xm,{value:"settings",asChild:!0,children:g.jsx("section",{className:"mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden",children:g.jsx(_B,{className:"h-full w-full"})})}),g.jsxs(C2,{className:"grid grid-cols-2 gap-2 p-2",children:[g.jsxs(Rx,{value:"editor",className:"inline-flex items-center justify-center rounded-lg py-2 text-sm font-semibold text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-stone-700 data-[state=active]:text-white",children:[g.jsx("span",{className:"icon-[lucide--file-terminal] mr-2 h-4 w-4"}),t("control.tabs.editor")]}),g.jsxs(Rx,{value:"computer",className:"inline-flex items-center justify-center rounded-lg py-2 text-sm font-semibold text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-stone-700 data-[state=active]:text-white",children:[g.jsx("span",{className:"icon-[lucide--computer] mr-2 h-4 w-4"}),t("control.tabs.computer")]})]})]})})}function Hse(){const{toastList:t}=qK();return g.jsxs(kee,{children:[t.map(({id:e,title:n,description:i,action:r,variant:s,otherProps:o})=>g.jsxs(WB,{...o,variant:s,children:[g.jsxs("div",{className:"grid gap-1",children:[n&&g.jsx(XB,{children:n}),i&&g.jsx(qB,{children:i})]}),r,g.jsx(KB,{})]},e)),g.jsx(HB,{})]})}window.codemirror=null;Ib.createRoot(document.getElementById("root")).render(g.jsx(pn.StrictMode,{children:g.jsxs(q5,{client:Ej,children:[g.jsx(AG,{children:g.jsx(zse,{})}),g.jsx(Hse,{})]})}));
